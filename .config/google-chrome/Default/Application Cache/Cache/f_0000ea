Type.registerNamespace("_at");_at.$139=function(n,t,i,r){_at.$139.initializeBase(this);this.$5N=n;this.$2Bf=t;this.$1n=i;this.$CC=r};_at.$139.prototype={$2Bf:null,$1n:null,$CC:null,$5N:null,$3vA:null,$5ZC:function(n){var t=new _g.$13A(this.$2D);n.$3jv(this.$5N,this.$2Bf,this.$1n,this.$CC,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{_a.$4.$1G(n,"result");this.$3vA=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_at.$XV).$A5F().$A5G(function(){return _at.$2Z.get_$I()});var u=this;n.$Ad(IAttachmentViewModelFactory).$A5G(function(){return new _at.$Ob(n.$6OW(IInferenceTracker),n.$6OW(_y.$M),n.$6OW(_at.$XV),n.$6OW(_a.$p),n.$6OW(_a.NativeBridge),n.$A3W(IAttachmentProviderItemViewModelFactory),n.$6OW(_a.$3O),n.$A3W(IAttachmentPreviewViewModelFactory),n.$A3W(IItemStoreGetterFactory),n.$6OW(IUriFileAttachmentViewModelFactory))});var f=this;n.$Ad(_at.$10r).$A5E(IUriFileAttachmentViewModelFactory).$A5F().$A5G(function(){return new _at.$10r(n.$6OW(_a.$XM),n.$6OW(_a.$43),n.$6OW(IInferenceTracker),n.$6OW(_a.$3O),n.$A3W(IAttachmentPreviewViewModelFactory),n.$A3W(IItemStoreGetterFactory))})},$7sM:function(){return null}};_at.$3b=function(n){this.$$d_$3vI=Function.createDelegate(this,this.$3vI);this.$$d_$5Lr=Function.createDelegate(this,this.$5Lr);this.$$d_$A1Q=Function.createDelegate(this,this.$A1Q);this.$$d_$A1R=Function.createDelegate(this,this.$A1R);this.$$d_$818=Function.createDelegate(this,this.$818);this.$7d=0;_at.$3b.initializeBase(this,[n]);this.set_$Bw("about:blank");this.set_$W(-1);this.get_$G().load(this.$$d_$818)};function $3Uq(n,t,i,r){n.set_$3QO(t);n.set_$DT(i);n.set_$2FG(r);n.$7d=3;n.get_$3T7().$n();n.$3hY=!1}function $6jF(n){var t=n.get_$G()[0];t.contentWindow.document.body.innerHTML="";n.$wQ=t.contentWindow.document.createElement("form");n.$wQ.method="POST";n.$wQ.encType="multipart/form-data";n.$wQ.encoding="multipart/form-data";$6jE(n,n.$wQ);n.$Mr=$(t.contentWindow.document.createElement("input"));n.$Mr.attr("type","file");n.$Mr.attr("name","fileInput");var i=this;n.$Mr.change(function(t){n.$3vI()});_a.UserAgent.getInstance().$8l&&n.$Mr[0].attachEvent("onchange",n.$$d_$3vI);n.$wQ.appendChild(n.$Mr[0])}function $6jE(n,t){n.get_$G()[0].contentWindow.document.body.appendChild(t)}function $6jG(n,t){var i=t.lastIndexOf("\\");return t.substr(i+1)}function $4ft(n){_js.Trace.logInfo(_at.$3b.$A,"Uploading attachment via form submit.");$2CQ(n,"parentItemId",n.get_$9Z().Id);$2CQ(n,"parentChangeKey",n.get_$9Z().ChangeKey);$2CQ(n,"isInline",n.get_$9L().get_$6D().toString());$2CQ(n,"X-OWA-CANARY",_a.$3R.$1CC());n.$wQ.submit();n.$7d=2}function $2CQ(n,t,i){var r=$(n.$wQ.ownerDocument.createElement("input"));r.attr("type","hidden");r.attr("name",t);r.val(i);n.$wQ.appendChild(r[0])}_at.$3b.prototype={$wQ:null,$Mr:null,$436:!1,$1f:null,$Tk:0,$2e8:null,$3hY:!1,$3T5:null,get_$9L:function(){return this.$U(_at.$3b.$3eU)},set_$9L:function(n){this.$K(_at.$3b.$3eU,n);return n},get_$9Z:function(){return this.$U(_at.$3b.$4MI)},set_$9Z:function(n){this.$K(_at.$3b.$4MI,n);return n},get_$2n:function(){return this.$U(_at.$3b.$1Cw)},set_$2n:function(n){n||(this.$7d=-1);this.$K(_at.$3b.$1Cw,n);return n},get_$2u6:function(){return this.$U(_at.$3b.$3qv)},set_$2u6:function(n){this.$K(_at.$3b.$3qv,n);return n},get_$2Bd:function(){return this.$U(_at.$3b.$3T6)},set_$2Bd:function(n){this.$K(_at.$3b.$3T6,n);return n},get_$6ei:function(){return this.$3T5},set_$6ei:function(n){if(this.$3T5===n)return n;this.$3T5=n;$N(this,"UploadAndShareAttachmentCommand");return n},get_$3T7:function(){return this.$U(_at.$3b.$4cv)},set_$3T7:function(n){this.$K(_at.$3b.$4cv,n);return n},get_$DT:function(){return this.$1f},set_$DT:function(n){this.$1f=n;$N(this,"Error");return n},get_$2FG:function(){return this.$Tk},set_$2FG:function(n){this.$Tk=n;$N(this,"AttachmentError");return n},get_$3QO:function(){return this.$2e8},set_$3QO:function(n){this.$2e8=n;$N(this,"SuccessResponse");return n},$4JH:function(){_js.$E.prototype.$4JH.call(this);this.$K(_at.$3b.$3T6,new _C(this.$$d_$A1R,_at.$3b.$A));this.set_$6ei(new _C(this.$$d_$A1Q,_at.$3b.$A))},$818:function(n){if(this.$7d){if(this.$7d===2){_js.Trace.logInfo(_at.$3b.$A,"Response received.");var t="";try{t=this.get_$G()[0].contentWindow.document.body.innerText}catch(i){if(!(_a.UserAgent.getInstance().$8l&&i.number===-2146828218)){_js.Trace.logException(_at.$3b.$A,i,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$436)_js.$9.$a(t)&&$3Uq(this,null,"Error sending the attachment upload form",1);else{var u=this,r=this;_at.$BN.$80e(t,this.get_$9L(),this.get_$9Z(),_g.$1U.$v,function(n){_js.Trace.logInfo(_at.$3b.$A,"HandleCreateAttachmentResponse completed.");$3Uq(u,n,null,0)},function(n,t){_js.Trace.logInfo(_at.$3b.$A,"HandleCreateAttachmentResponse failed: {0}",n.message);var i=1;if(n.ResponseCode){var u=n.ResponseCode.toString();r.get_$9L().get_$6D()&&u==="ErrorInvalidOperation"?i=4:u==="ErrorMessageSizeExceeded"&&(i=3)}var f=_at.$81.$5QW(t)||_at.$81.$2LV(n);$3Uq(r,null,f,i)})}}}else{_js.Trace.logInfo(_at.$3b.$A,"Initializing.");this.$7d=1;$6jF(this);_js.$J.get_$I().$1w(_at.$3b.$A,"ExecuteOpenFilePicker",this.$$d_$5Lr,0)}},$3vI:function(){if(!this.$3hY){this.$3hY=!0;var n=this.$Mr[0].value;if(!_js.$9.$a(n)){this.get_$9L().set_$1L($6jG(this,n));this.get_$2u6().$n()}}},$5Lr:function(){this.$Mr[0].click()},$A1R:function(){this.$436=!1;this.$wQ.action=_g.$5r.get_$56o();$4ft(this)},$A1Q:function(){this.$436=!0;this.$wQ.action=_g.$5r.get_$7RI();$2CQ(this,"subscriptionId",this.get_$Z().get_$Hn());$4ft(this)}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1IU=function(){};_at.$1IU.registerInterface("_at.$1IU");_at.$5n=function(n,t){this.$Kj=n||_at.$5n.$7yY();this.$2cb=t;this.$1BL=this.$2cb?this.$Kj.DirectFileAccessOnPublicComputersEnabled:this.$Kj.DirectFileAccessOnPrivateComputersEnabled;if(this.$1BL){this.$5Ml=_at.$5n.$5Fc(this.$Kj.BlockedFileTypes,this.$Kj.ForceSaveFileTypes,this.$Kj.AllowedFileTypes);this.$65F=_at.$5n.$5Fc(this.$Kj.BlockedMimeTypes,this.$Kj.ForceSaveMimeTypes,this.$Kj.AllowedMimeTypes)}this.$6Io=_at.$5n.$7aG(this.$Kj.ActionForUnknownFileAndMIMETypes)};_at.$5n.get_$I=function(){_at.$5n.$v||(_at.$5n.$v=new _at.$5n(_g.$V.get_$I().get_$56w(),_g.$V.get_$I().get_$9n5()));return _at.$5n.$v};_at.$5n.$7aG=function(n){var t;try{t=_js.$1g.$Q9(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$5n.$5Rw=function(n,t){return n[t]||0};_at.$5n.$5Fc=function(n,t,i){var r={};_at.$5n.$3cG(r,i,3);_at.$5n.$3cG(r,t,2);_at.$5n.$3cG(r,n,1);return r};_at.$5n.$3cG=function(n,t,i){if(t)for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];n[e]=i}};_at.$5n.$7yY=function(){var n=new _g.$Zb;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$5n.$1to=function(n,t){if(!n)return!1;for(var r=n,u=r.length,i=0;i<u;++i){var f=r[i];if(f===t)return!0}return!1};function $6j0(n,t,i){var r=_at.$5n.$5Rw(n.$5Ml,t);if(r===1)return 1;var u=_at.$5n.$5Rw(n.$65F,i);return u===1?1:r===2||u===2?2:r===3||u===3?3:n.$6Io}function $6j3(n,t){var i=n.$2cb?n.$Kj.WacViewingOnPublicComputersEnabled:n.$Kj.WacViewingOnPrivateComputersEnabled;return i&&$6j5(n,t)}function $6j2(n,t,i){var r=n.$2cb?n.$Kj.WebReadyDocumentViewingOnPublicComputersEnabled:n.$Kj.WebReadyDocumentViewingOnPrivateComputersEnabled;return r&&$6j4(n,t,i)}function $6j1(n,t,i,r){return!i&&!r?!1:t?i?n.$Kj.ForceWacViewingFirstOnPublicComputers:n.$Kj.ForceWebReadyDocumentViewingFirstOnPublicComputers:i?n.$Kj.ForceWacViewingFirstOnPrivateComputers:n.$Kj.ForceWebReadyDocumentViewingFirstOnPrivateComputers}function $6j5(n,t){return _at.$5n.$1to(n.$Kj.WacViewableFileTypes,t)}function $6j4(n,t,i){if(_js.$9.$a(t)){if(!_js.$9.$a(i))return n.$Kj.WebReadyDocumentViewingForAllSupportedTypes?_at.$5n.$1to(n.$Kj.WebReadyDocumentViewingSupportedMimeTypes,i):_at.$5n.$1to(n.$Kj.WebReadyMimeTypes,i)}else return n.$Kj.WebReadyDocumentViewingForAllSupportedTypes?_at.$5n.$1to(n.$Kj.WebReadyDocumentViewingSupportedFileTypes,t):_at.$5n.$1to(n.$Kj.WebReadyFileTypes,t);return!1}_at.$5n.prototype={$2cb:!1,$1BL:!1,$6Io:0,$Kj:null,$5Ml:null,$65F:null,$2wG:function(n,t,i){$6(i)&&(i=!0);$6(n)||(n=n.toLowerCase());var f;f=this.$1BL?$6j0(this,n,t):1;var u=!1;var r=!1;var e=!1;var o=!1;if(i){$6j3(this,n)&&(r=!0);$6j2(this,n,t)&&(u=!0);e=$6j1(this,this.$2cb,r,u);r&&this.$Kj.WacEditableFileTypes&&n&&n.indexOf("xls")===-1&&(o=_at.$5n.$1to(this.$Kj.WacEditableFileTypes,n))}return new _at.$11f(this.$1BL,f,r,u,e,o)}};_at.$11f=function(n,t,i,r,u,f){!n;this.$1BL=n;this.$lR=t;this.$1md=i;this.$1Im=r;this.$2un=u;this.$4dp=f};_at.$11f.prototype={$lR:0,$1BL:!1,$2un:!1,$1md:!1,$1Im:!1,$4dp:!1,get_$43n:function(){return this.$1Im||this.$1md},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$lR,this.$1BL,this.$1md,this.$1Im,this.$2un,this.$4dp)}};_at.$va=function(){this.$1pg=new FileReader};_at.$va.prototype={$1pg:null,$5Lb:null,get_$DT:function(){return this.$1pg.error},get_$1tP:function(){return this.$5Lb},get_$gq:function(){return this.$1pg.result},get_$6C1:function(){return this.$1pg.onloadend},set_$6C1:function(n){this.$1pg.onloadend=n;return n},$6Lo:function(n){var t=n;this.$1pg.readAsDataURL(t.$2FW)},$4PO:function(n,t,i,r){var u=this;this.set_$6C1(function(){if(!u.get_$DT()&&u.get_$gq()){var n=u.get_$gq().indexOf(",");var f=u.get_$gq().substring(n+1,u.get_$gq().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$gq().substring(0,n).indexOf("base64")!==-1?t(f):t(_a.$9N.$EX(f))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$DT());i()}});try{this.$6Lo(n)}catch(f){this.$5Lb=f;_a.UserAgent.getInstance().$L2&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logException(r,f,"Unexpected exception was thrown by FileReader.ReadAsDataURL.");i()}}};_at.$vb=function(){};_at.$vb.prototype={$3k8:function(){return new _at.$va}};_at.$BN=function(n,t,i){_at.$BN.initializeBase(this);this.$lk=n;this.$1B=t;this.$Ix=i};_at.$BN.$80e=function(n,t,i,r,u,f){try{var e=JsonParser.deserialize(n);if(e&&e.Body)if(e.Body.ResponseMessages){var s=e.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$BN.$A,"Got a attachment error response with {0}",s.ResponseCode);var a=s.MessageText;var l={};l.ResponseCode=s.ResponseCode;f(Error.create(a,l),null)}else{var o=s.Attachments[0];t.set_$3i(o.AttachmentId);i.Id=o.AttachmentId.RootItemId;i.ChangeKey=o.AttachmentId.RootItemChangeKey;t.set_$4k(o.Size||0);t.set_$Bf(o.ContentType);t.get_$6D()&&t.set_$Ge(o.ContentId);u(e)}}else{_js.Trace.logError(_at.$BN.$A,"Got no response message in the body; assuming it is a fault response");var c=e;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$BN.$A,"Got no response or response without body");f(Error.create(""),null)}}catch(h){_js.Trace.logError(_at.$BN.$A,"Got exception processing response: {0}, exception: {1}",n,h);n===""&&(h=Error.create(""));f(h,null)}};_at.$BN.$6KM=function(n,t,i){t.set_$3i(n.Attachments[0].AttachmentId);t.get_$6D()&&t.set_$Ge(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$4k(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey};function $4fq(n,t){_at.$BN.$6KM(t,n.$1B,n.$Ix)}function $4fp(n){var r=new _g.$1q(n.$Ix.Id);r.ChangeKey=n.$Ix.ChangeKey;var i=n.$1B.$2LI();var t=new _g.$W2(r);t.Attachments=[i];t.RequireImageType=i.IsInline;t.IncludeContentIdInResponse=i.IsInline;t.ClientSupportsIrm=!0;return new _g.$W1(n.get_$6u(),t)}_at.$BN.prototype={$lk:0,$1B:null,$Ix:null,$DH:null,$7yH:function(){if(this.$1f||!this.$5s||!this.$5s.response){_js.Trace.logInfo(_at.$BN.$A,"No success response because there's an error, or action is not complete.  Error: {0}",this.$1f);return null}return this.$5s.response.result},$5ZC:function(n){var t=new _g.$uv(this.$2D);t.clientStoreItem=this.$lk;t.isQueued=!1;t.palContext=new _g.$r6(!1);this.$DH=$4fp(this);n.$1LK(this.$DH,t,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){$4fq(this,n)}};_at.$13B=function(n,t,i){_at.$13B.initializeBase(this,[n,t,i]);var r=t.$FZ;this.$5Gm=r};_at.$13B.prototype={$5Gm:null,$5ZC:function(n){var i=$4fp(this);var t=new _g.$uv(this.$2D);t.clientStoreItem=this.$lk;t.isQueued=!0;t.palContext=new _g.$r6(!0);t.dataFile=this.$5Gm.$OH();n.$1LK(i,t,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){$4fq(this,n)}};_at.$13h=function(n,t,i){_at.$13h.initializeBase(this);this.$lk=n;this.$1B=t;this.$Ix=i;this.$8e=t.get_$3i()||t.get_$Ag()};_at.$13h.prototype={$lk:0,$1B:null,$8e:null,$Ix:null,$4Os:function(n){this.$Ix.Id=n.RootItemId.RootItemId;this.$Ix.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1B.get_$Ag()&&this.$1B.set_$3i(this.$1B.get_$Ag())},$5ZC:function(n){var i=new _g.$W8;i.ClientSupportsIrm=!0;var r=new _g.$13i(this.$2D);r.itemContexts=new Array(1);var t=new _g.$13j;t.clientStoreItem=this.$lk;t.parentItemId=new _g.$1q(this.$Ix.Id);t.parentItemId.ChangeKey=this.$Ix.ChangeKey;i.AttachmentIds=[new _g.$Ae(this.$8e.Id)];var u=new _g.$aj(this.get_$6u());u.Body=i;r.itemContexts[0]=t;n.$1Z2(u,r,this.$$d_$A6H,this.$$d_$9RZ)}};_at.$bn=function(n){_at.$bn.initializeBase(this);_a.$6.$1c(_at.$bn.$A,"DownloadAttachment");this.$8e=n};_at.$bn.prototype={$8e:null,$2qS:null,$5ZC:function(n){var i=new _g.$150(this.$2D);var t=new _g.$bp(this.get_$6u());t.Body.AttachmentIds=[new _g.$Ae(this.$8e)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$15.get_$8EO();n.$3sY(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){var t=n.Attachments.length;if(t!==1){_js.Trace.logWarning(_a.$0.$1N,"GetAttachment response length = {0}",t);return}var i=n.Attachments[0];if(!i){_js.Trace.logWarning(_a.$0.$1N,"GetAttachment response contained null attachment");return}var r=_a.$1G.$A4y(_g.$8F,i);this.$2qS=r.get_$3q();if(!this.$2qS){_js.Trace.logWarning(_a.$0.$1N,"GetAttachment response contained null item");return}_js.Trace.logInfo(_a.$0.$1N,"GetAttachment succeeded for '{0}' on '{1}'",r.get_$1L(),this.$2qS.get_$2i());_a.$6.$1E(null,"DownloadAttachment")}};_at.$Ln=function(n,t){_at.$Ln.initializeBase(this);this.$1p=n;this.$1B=t;this.$8e=t.get_$3i()||t.get_$Ag();if(!_g.$4x.isInstanceOfType(t)&&!_g.$8F.isInstanceOfType(t)&&!_g.$8z.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};function $4fs(n){var t=new XMLHttpRequest;var i=String.format(_g.$8F.isInstanceOfType(n.$1B)?_g.$5r.get_$1Wo():_g.$5r.get_$7RG(),encodeURIComponent(n.$8e.Id));var r=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var i=$3Up(n,t.responseText);_g.$4x.isInstanceOfType(n.$1B)?n.$1B.set_$Ca(i):_g.$8F.isInstanceOfType(n.$1B)&&n.$1B.set_$IH(i);$Hp(n,null)}else{var r=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$8e.Id,t.responseText,t.statusText);_js.Trace.logError(n.$1p,r);$Hp(n,Error.create(r))}};t.open("GET",i,!0);_a.$s.$6Yf(t);t.send(null);return 1}function $3Up(n,t){if(t.startsWith("data:")){var i=";base64,";var r=t.indexOf(i);return t.substr(r+i.length)}else return t}_at.$Ln.prototype={$1p:null,$1B:null,$8e:null,$6AP:function(){if(_g.$4x.isInstanceOfType(this.$1B)){var n=this.$1B;if(_a.$17F.isInstanceOfType(n.$FZ)){var r=n.$FZ;var u=new _at.$vb;var f=u.$3k8();var t=this,i=this;f.$4PO(r,function(i){n.set_$Ca($3Up(t,i));$Hp(t,null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1L());_js.Trace.logWarning(i.$1p,t);$Hp(i,Error.create(t))},this.$1p);return 1}else return $4fs(this)}else return _g.$8F.isInstanceOfType(this.$1B)?$4fs(this):_h.$10y.prototype.$6AP.call(this)},$6Kg:function(n,t,i){var r=this.$1B;if(_js.$9.$a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$i().Id)));else{r.set_$IH($3Up(this,n));t()}},$5ZC:function(n){n.$3tf(this.$1B.get_$i(),null,this.$$d_$A6H,this.$$d_$9RZ)}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1I8=function(){};_at.$1I8.registerInterface("_at.$1I8");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$1I9=function(){};_at.$1I9.registerInterface("_at.$1I9");_at.$XV=function(){};_at.$XV.registerInterface("_at.$XV");_at.$11d=function(n,t){_at.$11d.initializeBase(this,[1,"VM.Attachment.DeleteStarted"]);this.set_$4k(n);this.set_$8EF(t)};_at.$11d.prototype={get_$4k:function(){return this.$U("s")},set_$4k:function(n){$1M(this,"s",n);return n},get_$8EF:function(){return this.$U("w")},set_$8EF:function(n){$1M(this,"w",n);return n}};_at.$CJ=function(n,t,i,r,u){this.$Mp=_js.$9.$a(n)?"#":n;this.$WY=t;this.$Kn=i;this.$6g=r;this.$8Cc=u;this.$2E=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1N,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$6g,this.$WY,this.$2E,this.$Mp)};_at.$CJ.get_$5Vd=function(){_at.$CJ.$2xr||(_at.$CJ.$2xr=new _at.$CJ("#",!0,null,!0,!1));return _at.$CJ.$2xr};_at.$CJ.$E=function(n,t,i){_a.$4.$J(n,"viewModel");_a.$4.$J(i,"owaShell");var r;var u;var f;if(t){var e,o,s;_at.$CJ.$7Ti(n,e={val:u},o={val:r},s={val:f});u=e.val;r=o.val;f=s.val}else{var h,c,l;_at.$CJ.$58Y(n,h={val:u},c={val:r},l={val:f});u=h.val;r=c.val;f=l.val}if(_at.$2n.isInstanceOfType(n)){var a=n;a.$k9.get_$1AG()&&(r=!0)}return new _at.$CJ(u,r,f,!1,t)};_at.$CJ.$58Y=function(n,t,i,r){var u=!1;if(_at.$2n.isInstanceOfType(n)){var f=n;u=f.$k9.get_$1AG()}if(!n.$IK.$1BL||u||n.$IK.$2un||n.$1B.get_$I3()){i.val=!0;t.val="#";r.val=n.$k4;return}switch(n.$IK.$lR){case 3:i.val=!1;t.val=n.$Mp;r.val=n.$6U7;break;case 2:i.val=!0;r.val=n.$k4;t.val=n.$Mp;break;case 1:i.val=!0;t.val="#";r.val=n.$k4;break;case 0:default:i.val=!0;t.val="#";r.val=n.$k4;break}};_at.$CJ.$7Ti=function(n,t,i,r){if(n.$1B.get_$I3()){i.val=!0;t.val="#";r.val=n.$k4;return}switch(n.get_$CD()){case 5:i.val=!0;t.val="#";r.val=n.$6FD;break;case 3:i.val=!0;t.val="#";r.val=n.$1Re;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$IK.$lR===3?new _C(function(){n.$6X&&n.$6X.$9oM(n)},_a.$0.$1N):n.$k4;break;default:_at.$CJ.$58Y(n,t,i,r);break}};_at.$CJ.prototype={$WY:!1,$Mp:null,$Kn:null,$2E:null,$6g:!1,$8Cc:!1};_at.$11e=function(n,t,i,r,u){_at.$11e.initializeBase(this,[1,"VM.Attachment.Open"]);this.set_$4k(n);this.set_$6In(t);this.set_$Cz(i)};_at.$11e.prototype={get_$4k:function(){return this.$U("s")},set_$4k:function(n){$1M(this,"s",n);return n},get_$6In:function(){return this.$U("pl")},set_$6In:function(n){$1M(this,"pl",n);return n},get_$Cz:function(){return this.$U("ro")},set_$Cz:function(n){$1M(this,"ro",n);return n}};_at.$11g=function(n,t,i,r){_at.$11g.initializeBase(this,[1,"VM.Attachment.ServerDeleteCompleted"]);this.set_$Wo(n);this.set_$4k(t);this.set_$66R(i);this.set_$Bf(r||"")};_at.$11g.prototype={get_$4k:function(){return this.$U("s")},set_$4k:function(n){$1M(this,"s",n);return n},get_$Wo:function(){return this.$U("suc")},set_$Wo:function(n){$1M(this,"suc",n);return n},get_$66R:function(){return this.$U("nl")},set_$66R:function(n){$1M(this,"nl",n);return n},get_$Bf:function(){return this.$U("ct")},set_$Bf:function(n){$1M(this,"ct",n);return n}};_at.$11i=function(n,t,i,r,u){_at.$11i.initializeBase(this,[1,"VM.Attachment.SingleUploadCompleted"]);this.set_$Wo(n);this.set_$4k(t);this.set_$6In(i);this.set_$66R(r);this.set_$Bf(u||"")};_at.$11i.prototype={get_$4k:function(){return this.$U("s")},set_$4k:function(n){$1M(this,"s",n);return n},get_$Wo:function(){return this.$U("suc")},set_$Wo:function(n){$1M(this,"suc",n);return n},get_$6In:function(){return this.$U("pl")},set_$6In:function(n){$1M(this,"pl",n);return n},get_$66R:function(){return this.$U("nl")},set_$66R:function(n){$1M(this,"nl",n);return n},get_$Bf:function(){return this.$U("ct")},set_$Bf:function(n){$1M(this,"ct",n);return n}};_at.$De=function(){};_at.$De.$6c4=function(n,t,i,r,u){if(_a.$g.get_$Qz()){var f=new _at.$11e(n,t,i,r,u);_a.$g.$8s.$AN(f)}};_at.$De.$9wO=function(n,t){if(_a.$g.get_$Qz()){var i=new _at.$11d(n,t);_a.$g.$8s.$AN(i)}};_at.$De.$9wW=function(n,t,i,r){if(_a.$g.get_$Qz()){var u=new _at.$11g(n,t,i,r);_a.$g.$8s.$AN(u)}};_at.$De.$2BG=function(n){if(_a.$g.get_$Qz()){var t=new _at.$11l(n);_a.$g.$8s.$AN(t)}};_at.$De.$9wX=function(n,t,i,r,u){if(_a.$g.get_$Qz()){var f=new _at.$11i(n,t,i,r,u);_a.$g.$8s.$AN(f)}};_at.$11l=function(n){_at.$11l.initializeBase(this,[1,"VM.Attachment.UploadStarted"]);$1M(this,"t",n)};_at.$2n=function(n,t,i,r,u,f,e,o,s,h,c,l){_at.$2n.initializeBase(this,[n,t,i,r,u,e,s,h,c]);_a.$4.$l(f,"palDownloadManager");_a.$4.$l(o,"nativeBridge");_a.$4.$l(l,"itemStoreGetter");this.$k9=f;this.$12=o;this.$1zH=l;this.$1B&&$4fh(this,null,this.$1B.get_$3i())};function $6j6(n){_js.Trace.logInfo(_at.$2n.$A,"OpenAttachmentUsingPAL, download status={0}",n.$1hw);if(!n.$6X.$32g(n.$59)){_js.Trace.logWarning(_at.$2n.$A,"The context has changed from "+n.$59+" to "+n.$6X.get_$lq()+", opening attachment using PAL has been skipped.");return}if(n.$6X.get_$3zq()||!n.$5H){_js.Trace.logInfo(_at.$2n.$A,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",n.$6X.get_$3zq(),n.$5H);return}var t=_at.$RX.$7dy(n);_js.Trace.logInfo(_at.$2n.$A,"PAL attachment download parameters: {0}",t.toString());switch(n.$1hw){case 0:case 1:n.$69v(0);_js.Trace.logInfo(_at.$2n.$A,"Starting PAL attachment download.");n.$k9.$5Jq(t);break;case 3:case 2:_js.Trace.logInfo(_at.$2n.$A,"Canceling PAL attachment download.");n.$k9.$9b(t);break;case 4:_js.Trace.logInfo(_at.$2n.$A,"PAL attachment download complete.");var i=this;n.$1zH.$E(function(){var i=n.$1zH.get_$1g().$E(_g.$V.get_$I().get_$1I().get_$DM());_at.$BT.$4L3(n.$12,i.get_$1K9(),n.$56t,t.$1g7,t.$1MZ,function(){_js.Trace.logInfo(_at.$2n.$A,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$2n.$A,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$4M8(1);var i=_at.$BT.$7tZ(t);$10i(n,i)})});break;default:break}}function $4fh(n,t,i){if(n.$k9)if(_g.$8F.isInstanceOfType(n.$1B)){_js.Trace.logInfo(_at.$2n.$A,"ItemAttachment for PAL status:Downloaded");n.set_$4M8(4)}else{!$6(t)&&t.Id&&n.$k9.$2BR(t.Id);!$6(i)&&i.Id&&n.$k9.$IU(i.Id,n)}}function $6j7(n){if(n.$1B&&n.$1B.get_$3i()&&!_g.$8F.isInstanceOfType(n.$1B)){_js.Trace.logInfo(_at.$2n.$A,"Unsubscribing for attachment with name {0} and id {1}",n.$1B.get_$1L(),n.$1B.get_$3i());n.$k9.$2BR(n.$1B.get_$3i().Id)}}function $4fg(n,t,i){var r;var u=t;if(t>=1073741824){u/=1073741824;r=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(t>=1048576){u/=1048576;r=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(t>=1024){u/=1024;r=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else r=_u.Strings.l_SizeWithByteAbbreviation_Text;var f=String.format(r,Math.round(u*Math.pow(10,i))/Math.pow(10,i));return String.format('<span class="progressValueNoWrap">{0}</span>',f)}function $6j8(n){_js.Trace.logInfo(_at.$2n.$A,"Submitting action for PAL attachment upload.");var t=new _at.$13B(2,n.$1B,n.$6X.get_$9Z());t.add_$1x(n.$$d_$2pb);t.add_$2m(n.$$d_$5E4);OwaApplication.$1W.$z(t)}_at.$2n.prototype={$12:null,$k9:null,$1zH:null,$56t:null,$1hw:0,$2Y4:null,get_$4M8:function(){return this.$1hw},set_$4M8:function(n){this.$1hw=n;$3(this,"PALAttachmentDownloadStatus");return n},get_$9Sz:function(){return this.$2Y4},set_$9Sz:function(n){this.$2Y4=n;$3(this,"PALAttachmentCurrentDowloadedBytes");return n},get_$68L:function(){return _at.$1T.prototype.get_$68L.call(this)||_g.$4x.isInstanceOfType(this.$1B)&&_a.$8G.isInstanceOfType(this.$1B.$FZ)},get_$428:function(){var n=_at.$1T.prototype.get_$428.call(this);if(n&&this.$12.$V2){var t=this.$12.$9Q.get_$1M9().$2n(2);_js.Trace.logInfo(_at.$2n.$A,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$4Vh:function(){return this.get_$428()?!1:this.$k9.get_$1AG()},$4cK:function(){$6j7(this)},$1hZ:function(n){_js.Trace.logInfo(_at.$2n.$A,"Got attachment status {0}",n);this.set_$4M8(n)},$69v:function(n){this.set_$9Sz(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,$4fg(this,n,1),$4fg(this,this.$1B.get_$4k(),0)))},$TA:function(n){_js.Trace.logWarning(_at.$2n.$A,"Unable to download attachment with name {0} and error is {1}",this.$1B.get_$1L(),n);$10i(this,n)},$68i:function(n){_js.Trace.logInfo(_at.$2n.$A,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$56t=n},$6ej:function(n){_a.$8G.isInstanceOfType(n.$FZ)?$6j8(this):_at.$1T.prototype.$6ej.call(this,n)},$5I0:function(n){if(_a.$8G.isInstanceOfType(n.$FZ)){_js.Trace.logInfo(_at.$2n.$A,"Deleting file attachment via PAL.");var t=n.$FZ;this.$12.$f0.$12F(t.get_$1B4())}else _at.$1T.prototype.$5I0.call(this,n)},$4L3:function(){if(this.$k9.get_$1AG()){_js.Trace.logInfo(_at.$2n.$A,"Will use PAL to open attachment.");$6j6(this)}else _at.$1T.prototype.$4L3.call(this)},$68h:function(n,t){$4fh(this,n,t);_at.$1T.prototype.$68h.call(this,n,t)}};_at.$1T=function(n,t,i,r,u,f,e,o,s){this.$$d_$A1U=Function.createDelegate(this,this.$A1U);this.$$d_$5Mj=Function.createDelegate(this,this.$5Mj);this.$$d_$4UL=Function.createDelegate(this,this.$4UL);this.$$d_$5Hw=Function.createDelegate(this,this.$5Hw);this.$$d_$7hS=Function.createDelegate(this,this.$7hS);this.$$d_$56x=Function.createDelegate(this,this.$56x);this.$$d_$7b9=Function.createDelegate(this,this.$7b9);this.$$d_$9F5=Function.createDelegate(this,this.$9F5);this.$$d_$1Z2=Function.createDelegate(this,this.$1Z2);this.$$d_$9Rt=Function.createDelegate(this,this.$9Rt);this.$$d_$9Rp=Function.createDelegate(this,this.$9Rp);this.$$d_$6F6=Function.createDelegate(this,this.$6F6);this.$$d_$3Gh=Function.createDelegate(this,this.$3Gh);this.$$d_$9kL=Function.createDelegate(this,this.$9kL);this.$$d_$Re=Function.createDelegate(this,this.$Re);this.$$d_$5E4=Function.createDelegate(this,this.$5E4);this.$$d_$2pb=Function.createDelegate(this,this.$2pb);this.$3qu=new _at.$vb;this.$WS=2;_at.$1T.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_at.$1T.initializeBase(this);this.$2L=f;this.$1J=o;this.$11D=s;this.set_$9L(n);this.$C=t;this.set_$9TA(u);this.$13=e;_g.$4x.isInstanceOfType(n)&&(this.$12u=n.get_$Ca());u&&(this.$59=u.get_$lq());this.$5H=i;this.$9f=r;this.set_$1AF(!this.$5H);this.set_$5Mf(_a.$6c.$U6(n.get_$1L()));this.$IK=_at.$5n.get_$I().$2wG(this.$mJ,this.$1B.get_$Bf(),_y.$8s.$43o(this.$C,this.$13));this.$1B&&this.$1B.get_$3i()&&this.set_$1he(this.$IK.get_$43n()&&!this.$1B.get_$I3()&&!this.$1B.get_$rX());this.$3Sn();this.$2Ba();this.$6eD();$4fl(this);$3Un(this);this.$k4=new _C(this.$$d_$Re,_at.$1T.$A);this.$6U7=new _C(this.$$d_$9kL,_at.$1T.$A);this.$6FD=new _C(this.$$d_$3Gh,_at.$1T.$A);this.$1Re=new _C(this.$$d_$6F6,_at.$1T.$A);this.$4L9=new _C(this.$$d_$9Rp,_at.$1T.$A);this.$5j1=new _C(this.$$d_$9Rt,_at.$1T.$A);if(!this.get_$88T()){this.$JN=new _C(this.$$d_$1Z2,_at.$1T.$A);this.$3Fb=new _C(this.$$d_$9F5,_at.$1T.$A);this.$3Ff=new _C(this.$$d_$7b9,_at.$1T.$A)}this.$eG=new _y.$hT;this.$bA()};function $1VY(n,t,i,r){_js.Trace.logWarning(_at.$1T.$A,"create failed with error: {0}, {1}",t,i);n.$FD=!0;n.$Tk=t;n.$2mB=i;n.$6X&&n.$6X.$32g(n.$59)&&n.$6X.$1H6(n,!1)}function $10i(n,t){n.$1z?n.get_$Cg().$32(0,t,null):_a.$4b.$32(t,1)}function $6jC(n){if(n.$C.get_$L()!=="TouchNarrow"){var t=new _0365m.$2b(new Array(0));n.get_$4Po()&&!n.$5H&&t.$1C.$D(new _0365m.$m(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,n.$5j1));t.$1C.$D(new _0365m.$m(_nbs.NonBootStrings.l_Download_LowerCase_Text,null,n.$k4));n.set_$2HM(t)}}function $4fj(n,t){_js.Trace.logInfo(_at.$1T.$A,"Submitting server action for file attachment with content.");var i=new _at.$BN(2,t,n.$6X.get_$9Z());i.add_$1x(n.$$d_$2pb);i.add_$2m(n.$$d_$5E4);OwaApplication.$1W.$z(i)}function $4fm(n,t){var i=n.$5GD=n.$3qu.$3k8();i.$4PO(t,n.$$d_$4UL,n.$$d_$5Mj,_at.$1T.$A)}function $6jD(n){_js.Trace.logInfo(_at.$1T.$A,"Submitting action for item attachment.");var i=n.$1B;var t=new _at.$BN(2,i,n.$6X.get_$9Z());t.add_$1x(n.$$d_$2pb);t.add_$2m(n.$$d_$5E4);OwaApplication.$1W.$z(t)}function $4fk(n){_js.Trace.logInfo(_at.$1T.$A,"Starting attachment upload.");var t=this,i=this;_g.$1U.$v.$2th("CreateAttachment",n.$$d_$A1U,$6j9(n),function(n){_js.Trace.logInfo(_at.$1T.$A,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1T.$A,"Enqueueing upload attachment failed: {0}",t.message);$1VY(n,1,_at.$81.$2LV(t),!0);$2gH(n,null)})}function $6j9(n){var t=n.$6X.get_$9Z();var i=new _g.$1q(t.Id);i.ChangeKey=t.ChangeKey;var r=new _g.$W2(i);return new _g.$W1(null,r)}function $2gH(n,t){var i=n.$FD?_y.$tl.toString(n.$Tk):"";_js.Trace.logInfo(_at.$1T.$A,"Attachment create completed. Status: {0}",i);if(n.$4PA){t&&n.set_$3T9(t.$7yH());n.$4PA(n.$2Be)}n.set_$6ek(!1);n.set_$1he(!n.$FD&&n.$IK.get_$43n()&&!n.$1B.get_$I3()&&!n.$1B.get_$rX());$6jC(n);_at.$De.$9wX(!n.$FD,n.$1B.get_$4k(),n.$IK.$lR,n.$1B.get_$1L().length,n.$1B.get_$Bf());if(_g.$8F.isInstanceOfType(n.$1B)){n.$6X.$1H6(n,!1);n.set_$9L(t.$1B);n.$3Sn();n.$6X.$10y(n)}if(!n.$FD&&(n.$13.get_$56v()||_g.$8z.isInstanceOfType(n.$1B)||_g.$BA.isInstanceOfType(n.$1B)||_g.$4x.isInstanceOfType(n.$1B)&&_y.$js.isInstanceOfType(n.$1B.$FZ))){_js.Trace.logInfo(_at.$1T.$A,"Incrementing parent well size.");(!t||n.$6X.$32g(n.$59))&&n.$6X.$UE(n.$1B.get_$4k());$4fl(n)}$Dp(n,"OnUploadCompleteEvent",n)}function $3Um(n){$6jB(n);n.$1B?n.$1B.get_$3i()?_js.Trace.logInfo(_at.$1T.$A,"SafeOpenAttachment: Name={0}, ID={1}",n.$1B.get_$1L(),n.$1B.get_$3i().Id):_js.Trace.logWarning(_at.$1T.$A,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1T.$A,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1T.$A,"SafeOpenAttachment: Policy={0}",n.$IK.toString());if(n.$IK.$2un){_js.Trace.logInfo(_at.$1T.$A,"Attachment policy forces browser viewing.");n.$C.get_$L()==="Mouse"?$10i(n,_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):$10i(n,_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!n.$IK.$1BL){$10i(n,_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(n.$IK.$lR===1){$10i(n,_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(n.$1B.get_$I3()){var i=_a.$s.$qh();_js.Trace.logInfo(_a.$0.$4A,"Saving S/MIME attachment {0}.",n.$1B.get_$1L());var r=_g.$4x.isInstanceOfType(n.$1B)?n.$1B.get_$Ca():n.$1B.get_$IH();var u=i.SaveFile(n.$1B.get_$1L(),r);u?_js.Trace.logInfo(_a.$0.$4A,"S/MIME attachment {0} is saved successfully.",n.$1B.get_$1L()):_js.Trace.logWarning(_a.$0.$4A,"S/MIME attachment {0} is not saved. Check the log of S/MIME plugin instead.",n.$1B.get_$1L());return}else if(n.$1B.get_$rX()){var f=_a.$s.$qh();var t=n.$1B;f.SaveFile(t.get_$1L(),t.get_$Ca());return}if(n.$IK.$lR===2){$6jA(n);return}n.$4L3()}function $6jA(n){if(n.$C.get_$L()==="Mouse"){_js.Trace.logInfo(_at.$1T.$A,"Attachment policy forces save.");n.$13.get_$7z()?$10i(n,_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):$10i(n,_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1T.$A,"Attachment policy forces save, but device doesn't support download.");$10i(n,_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}}function $4fi(n,t){var i=n.$8e;i!==t&&n.$68h(i,t)}function $4fl(n){n.set_$2cX(n.$1i5||_g.$8z.isInstanceOfType(n.$1B)&&!n.$1B.get_$4k()||_g.$4x.isInstanceOfType(n.$1B)&&_y.$js.isInstanceOfType(n.$1B.$FZ)&&!n.$1B.get_$4k())}function $3Un(n){n.get_$4Po()&&(n.$WS===2?n.set_$6W8(!0):n.set_$6W8(!1))}function $6jB(n){if(!n.$1B.get_$I3()&&!n.$1B.get_$rX()&&n.get_$68L()){var t=_g.$1U.$v.$qi(n.$1B.get_$3i());n.$1B.get_$3i().Id!==t.Id&&n.$1B.set_$3i(t)}}function $3Ul(n,t){var i=new _a.$6U;i.$7a("E",n.$mJ);i.$5Z("S",n.$1B.get_$4k());var r="A";_at.$HJ.isInstanceOfType(n)?r="C":n.get_$CD()===5?r="T":n.$1B.get_$6D()&&(r="I");i.$7a("T",r);i.$5Z("O",t?1:0);return i.toString()}_at.$1T.prototype={$k4:null,$6U7:null,$6FD:null,$1Re:null,$4L9:null,$JN:null,$3Fb:null,$3Ff:null,$5j1:null,$eG:null,$5H:!1,$9f:!1,$C:null,$13:null,$59:null,$1J:null,$11D:null,$2L:null,$1B:null,$Mp:null,$1z0:!1,$2GK:!1,$4cw:!1,$6F7:!1,$IK:null,$6X:null,$3G:!1,$bK:!1,$2AH:null,$3QI:null,$19p:0,$137:null,$1Mt:0,$2Be:null,$8e:null,$1i5:!1,$FD:!1,$Tk:0,$2mB:null,$OM:!1,$mJ:null,$4PA:null,$UF:null,$4W0:!1,$3OR:!1,$2yd:null,$1ln:null,$DA:null,$2Os:!1,$12u:null,$1pR:null,$1K7:null,$v6:null,$mo:!1,$5GD:null,$1BF:null,$1z:null,add_$1Rd:function(n){this.$2N("OnUploadCompleteEvent",n)},remove_$1Rd:function(n){this.$2P("OnUploadCompleteEvent",n)},add_$1RX:function(n){this.$2N("OnDeleteCompleteEvent",n)},remove_$1RX:function(n){this.$2P("OnDeleteCompleteEvent",n)},add_$24y:function(n){this.$2N("OnDownloadCompleteEvent",n)},remove_$24y:function(n){this.$2P("OnDownloadCompleteEvent",n)},get_$3eG:function(){return this.$1K7},set_$3eG:function(n){this.$1K7=n;return n},get_$CD:function(){this.$19p||(this.$19p=this.$5Pb());return this.$19p},set_$CD:function(n){n!==this.$19p&&(this.$19p=n);return n},get_$9L:function(){return this.$1B},set_$9L:function(n){var t=this.$1B;if(t!==n){$6(t)||t.remove_$7q(this.$$d_$56x);this.$1B=n;var i=$6(n);if(!i){n.add_$7q(this.$$d_$56x);_js.Trace.logInfo(_a.$0.$1N,"Attachment: {0}",n.get_$1L())}$4fi(this,i?null:n.get_$3i());$3(this,"Attachment");$3(this,"ReferenceAttachment");$3Un(this)}return n},get_$Fo:function(){return this.$WS},set_$Fo:function(n){if(this.$WS!==n){this.$WS=n;$3Un(this)}return n},get_$4Po:function(){return _g.$BA.isInstanceOfType(this.$1B)?this.$1B:null},get_$2O:function(){return this.$3G},set_$2O:function(n){this.$3G=n;$3(this,"IsSelected");return n},get_$3oY:function(){return this.$Mp},set_$3oY:function(n){if(this.$Mp!==n){this.$Mp=n;_js.Trace.logInfo(_at.$1T.$A,"Attachment download URL: {0}",this.$Mp);$3(this,"DownloadUrl")}return n},get_$8Dv:function(){return this.$1z0},set_$8Dv:function(n){if(this.$1z0!==n){this.$1z0=n;$3(this,"IsTriggeredPolicyTip")}return n},get_$1AF:function(){return this.$2GK},set_$1AF:function(n){this.$2GK=n;$3(this,"CanDelete");return n},get_$6ek:function(){return this.$4cw},set_$6ek:function(n){this.$5H||this.set_$1AF(!n);this.$4cw=n;$3(this,"UploadInProgress");return n},get_$1he:function(){return this.$6F7},set_$1he:function(n){this.$6F7=n;$3(this,"OpenDocumentInBrowserLinkVisible");return n},get_$87s:function(){return this.$6X},get_$9TA:function(){return this.$6X},set_$9TA:function(n){this.$6X=n;$3(this,"ParentWell");return n},get_$Ry:function(){return this.$bK},set_$Ry:function(n){if(this.$bK!==n){this.$bK=n;this.$6X&&this.$6X.$825(this);$3(this,"ShouldBeHidden")}return n},get_$6HQ:function(){return this.$1i5},set_$6HQ:function(n){if(this.$1i5!==n){this.$1i5=n;$3(this,"PendingNonHtml5Upload")}return n},get_$2cX:function(){return this.$4W0},set_$2cX:function(n){if(this.$4W0!==n){this.$4W0=n;$3(this,"ShouldSizeBeHidden")}return n},get_$5e9:function(){return!1},get_$6W8:function(){return this.$3OR},set_$6W8:function(n){if(this.$3OR!==n){this.$3OR=n;$3(this,"ShowEditPermissions")}return n},get_$5Mf:function(){return this.$mJ},set_$5Mf:function(n){if(this.$mJ!==n){this.$mJ=n;$3(this,"FileExtension")}return n},get_$4YK:function(){return this.$2AH},set_$4YK:function(n){this.$2AH=n;$3(this,"SubmitUploadFormCommand");return n},get_$9sU:function(){return this.$3QI},set_$9sU:function(n){this.$3QI=n;$3(this,"SubmitUploadAndShareFormCommand");return n},get_$Hn:function(){throw Error.notImplemented("This getter must be overridden");},set_$Hn:function(n){throw Error.notImplemented("This setter must be overriden");return n},get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},set_$Cg:function(n){this.$1z=n;return n},get_$1Z4:function(){return this.$JN},get_$3ry:function(){return this.$137},set_$3ry:function(n){this.$137=n;_js.Trace.logWarning(_at.$1T.$A,"Attachment form upload error: {0}",this.$137);$3(this,"FormUploadError");return n},get_$3rx:function(){return this.$1Mt},set_$3rx:function(n){this.$1Mt=n;_js.Trace.logWarning(_at.$1T.$A,"Attachment form upload error code: {0}",this.$1Mt);$3(this,"FormUploadAttachmentError");return n},get_$3T9:function(){return this.$2Be},set_$3T9:function(n){this.$2Be=n;$3(this,"UploadSuccessResponse");return n},get_$68L:function(){return!1},get_$6FQ:function(){return this.$FD},get_$2FG:function(){return this.$Tk},get_$Xm:function(){return this.$UF},set_$Xm:function(n){this.$UF=n;return n},get_$mZ:function(){var n=_y.$8s.$2vL(this.$1B.get_$3i(),this.$9f,_g.$5r.get_$5Wz());_js.Trace.logInfo(_at.$1T.$A,"Image preview URL: {0}",n);return n},get_$UJ:function(){return this.$13.get_$rB()},get_$2OS:function(){return this.$13.get_$rA()},get_$1xN:function(){return this.get_$CD()!==2&&this.get_$CD()!==1||this.$1B.get_$6D()?!1:this.$IK.$lR===3},get_$40A:function(){return this.get_$CD()!==2?!1:this.$IK.$lR===3},get_$3vk:function(){return this.get_$CD()!==2&&this.get_$CD()!==4},get_$3vm:function(){return!this.$1B.get_$I3()&&(this.get_$CD()===2||this.get_$CD()===1)},get_$3xC:function(){if(this.$2yd)return this.$2yd;var n;n=this.get_$428()?this.get_$CD()===5||this.$C.get_$L()!=="TouchNarrow"&&(!this.$9f||this.$9f&&this.get_$CD()!==3):this.get_$CD()===5||this.$C.get_$L()==="Mouse"&&this.get_$CD()!==3;_js.Trace.logInfo(_at.$1T.$A,"IconLinkViewModel preview = {0}",n);this.$2yd=_at.$CJ.$E(this,n,this.$C);return this.$2yd},get_$4aB:function(){if(this.$1ln)return this.$1ln;if(this.$C.get_$L()!=="Mouse"){this.$1ln=_at.$CJ.get_$5Vd();return this.$1ln}var t=!1;var n=!1;if(this.$1B.get_$I3()){n=_g.$8F.isInstanceOfType(this.$1B);t=_g.$8F.isInstanceOfType(this.$1B)}else switch(this.get_$CD()){case 3:n=!1;t=this.get_$5ae()?!1:!this.$9f;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1T.$A,"TextLinkViewModel is hidden");this.$1ln=_at.$CJ.get_$5Vd()}else{_js.Trace.logInfo(_at.$1T.$A,"TextLinkViewModel preview = {0}",t);this.$1ln=_at.$CJ.$E(this,t,this.$C)}return this.$1ln},get_$2HM:function(){if(!this.$DA){var n=new Array(0);this.$DA=new _0365m.$2b(n)}return this.$DA},set_$2HM:function(n){this.$DA=n;$3(this,"ContextMenu");return n},get_$er:function(){return this.$C.get_$L()!=="Mouse"},get_$4v:function(){var n=this.get_$CD();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1B.get_$1L();case 5:return _nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},get_$30U:function(){return this.$2Os},set_$30U:function(n){if(this.$2Os!==n){this.$2Os=n;this.$2Ba()}return n},get_$146:function(){return this.$OM},set_$146:function(n){if(this.$OM!==n){this.$OM=n;$3(this,"IsDeleted")}return n},get_$1Zh:function(){_a.$4.$9n(this.get_$CD()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1B.get_$CD()},get_$5ae:function(){return!!this.$1J&&(this.$1J.$3u("DocCollab")||this.$1J.$3u("ModernAttachments"))},get_$89r:function(){return!!this.$1J&&this.$1J.$3u("AttachmentsFilePicker")},get_$428:function(){return this.get_$5ae()&&this.$C.get_$L()!=="TouchNarrow"&&(this.$IK.$1md||this.get_$CD()===1)},get_$7RO:function(){return this.$1pR},set_$7RO:function(n){if(this.$1pR!==n){this.$1pR=n;$3(this,"AttachmentPreviewViewModel")}return n},get_$ff:function(){return this.$mo},set_$ff:function(n){this.$mo=n;n&&this.set_$1he(!1);return n},get_$88T:function(){return!this.$6X},get_$7Un:function(){_js.Trace.logInfo(_at.$1T.$A,"Attachment class: {0}",this.$19p);var n;switch(this.get_$CD()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1T.$A,"Embedded item class: {0}",this.get_$1Zh());switch(this.get_$1Zh()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1T.$A,"Can open: {0}",n);return n},$2Ba:function(){this.$6X?this.set_$Ry(this.$2Os||this.$1B.get_$6D()&&this.$6X.get_$83p()):this.set_$Ry(this.$2Os||this.$1B.get_$6D());this.set_$Ry(this.$bK||this.$1B.get_$xO())},$9F5:function(){_js.Trace.logInfo(_at.$1T.$A,"File selected.");this.set_$30U(!1);this.$6X&&this.$6X.$9F4(this)},$2Bc:function(){_js.Trace.logInfo(_at.$1T.$A,"submitting upload to server");this.$FD=!1;if(_g.$4x.isInstanceOfType(this.$1B)){var n=this.$1B;this.$6ej(n)}else(_g.$8z.isInstanceOfType(this.$1B)||_g.$8F.isInstanceOfType(this.$1B)||_g.$BA.isInstanceOfType(this.$1B))&&$4fk(this)},$4YJ:function(){_js.Trace.logInfo(_at.$1T.$A,"submitting delete to server");this.$FD=!1;var n=new _at.$13h(2,this.$1B,this.$6X.get_$9Z());n.add_$1x(this.$$d_$7hS);n.add_$2m(this.$$d_$5Hw);OwaApplication.$1W.$z(n)},$3tN:function(){var r=this.$1B;var u=r.$FZ;var n=this.$3qu.$3k8();var t=this;n.set_$6C1(function(){if(n.get_$DT())_js.Trace.logWarning(_at.$1T.$A,"HTML5 file reader attach failed with error code {0}",n.get_$DT());else{var i=n.get_$gq().indexOf(",");var r=n.get_$gq().substring(i+1,n.get_$gq().length);t.$12u=n.get_$gq().substring(0,i).indexOf("base64")!==-1?r:_a.$9N.$EX(r);$Dp(t,"OnUploadCompleteEvent",t)}});try{n.$6Lo(u)}catch(i){this.$13.get_$rB()&&i.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1T.$A,"Firefox: failed to read an attachment. Exception: {0}",i.message):_js.Trace.logException(_at.$1T.$A,i,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$4PB:function(){this.$12u=null;$Dp(this,"OnDeleteCompleteEvent",this)},$2II:function(){var n=new _a.$6U;n.$7a("E",this.$mJ);n.$5Z("S",this.$1B.get_$4k());return n.toString()},$12b:function(){_js.Trace.logInfo(_at.$1T.$A,"Getting attachment content from server");this.$FD=!1;var n=new _at.$Ln(_at.$1T.$A,this.$1B);var t=this;n.add_$2m(function(){$Dp(t,"OnDownloadCompleteEvent",t);t.set_$1he(!1)});var i=this;n.add_$1x(function(){_js.Trace.logWarning(_at.$1T.$A,"Download failed with error: {0}",n.$1f.message);i.$FD=!0;i.$mo||i.$2pb(n)});OwaApplication.$1W.$z(n)},$5Yo:function(n){if(_g.$8z.isInstanceOfType(this.$1B)){_js.Trace.logInfo(_at.$1T.$A,"Uploading item attachment.");$6jD(this)}else if(_g.$8F.isInstanceOfType(this.$1B)&&this.$1B.get_$I3()){var t=this.$1B;var r=_g.$4x.$5Om(t,t.get_$IH());_js.Trace.logInfo(_at.$1T.$A,"Uploading item attachment as file attachment with content.");$4fj(this,r)}else if(_g.$4x.isInstanceOfType(this.$1B)){var i=this.$1B;if(this.$12u){_js.Trace.logInfo(_at.$1T.$A,"Uploading file attachment with pasted image from clipboard.");this.$4UL(this.$12u)}else if(i.get_$Ca()){_js.Trace.logInfo(_at.$1T.$A,"Uploading file attachment with content.");this.$4UL(null)}else if(this.$13.get_$2mC()){_js.Trace.logInfo(_at.$1T.$A,"Uploading HTML5 file attachment.");$4fm(this,i.$FZ)}else{_js.Trace.logInfo(_at.$1T.$A,"Uploading Non-HTML5 file attachment.");this.$A1T()}}else if(this.$13.get_$2mC()&&_g.$BA.isInstanceOfType(this.$1B)){var u=this.$1B;_js.Trace.logInfo(_at.$1T.$A,"Uploading HTML5 reference attachment.");$4fm(this,u.$FZ)}else{_js.Trace.logError(_at.$1T.$A,"Unsupported upload type.");n(null)}},$5Pb:function(){var n=0;if(_g.$4x.isInstanceOfType(this.$1B))if(this.$IK.get_$43n())n=3;else if(this.$IK.$lR===1)n=4;else{var t,i;(i=_y.$8s.$4Vu(this.$1B,t={val:n}),n=t.val,i)||(n=6)}else n=_g.$8F.isInstanceOfType(this.$1B)?5:_g.$8z.isInstanceOfType(this.$1B)?0:4;return n},$3Sn:function(){var n=!!this.$1B.get_$3i();var t=n?this.$1B.get_$3i().Id:null;var i=t?_bc.$Bd.$5a9(t):!1;var r=this.$IK.$lR===1;_js.Trace.logInfo(_at.$1T.$A,"UpdateDownloadUrl: idExists={0}, isClientId={1}, isDiscovery={2}, policyInfo: {3}",n,i,this.$9f,this.$IK.toString());!n||r||i||this.$1B.get_$rX()?this.set_$3oY(null):this.set_$3oY(_y.$8s.$2vL(this.$1B.get_$3i(),this.$9f))},$2pb:function(n){$1VY(this,1,_at.$81.$2vg(n),!0)},$5E4:function(n){$2gH(this,n)},$6eD:function(){this.set_$6HQ(!this.$5H&&this.$13.get_$56v()&&$6(this.$1B.get_$3i())&&!_g.$8z.isInstanceOfType(this.$1B))},$56x:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$5Mf(_a.$6c.$U6(this.$1B.get_$1L()));if(t==="ContentType"||t==="Name"){this.$IK=_at.$5n.get_$I().$2wG(this.$mJ,this.$1B.get_$Bf(),this.$C.get_$L()==="Mouse"||this.$13.get_$1dA());this.$2Ba()}if(t==="AttachmentId"){$4fi(this,this.$1B.get_$3i());this.$6eD()}this.$3Sn()}},$4UL:function(n){var t=this.$1B;n&&t.set_$Ca(n);$4fj(this,t)},$A1T:function(){this.$2AH.$n()},$7b9:function(){_js.$9.$a(this.$137)||$1VY(this,this.$1Mt,this.$137,!1);$2gH(this,null)},$6ej:function(n){$4fk(this)},$5I0:function(n){_js.Trace.logInfo(_at.$1T.$A,"Not a PAL file attachment.")},$4L3:function(){_js.Trace.logInfo(_at.$1T.$A,"Opening attachment with download URL {0}",this.$Mp);this.$eG.$Re(this.$Mp)},$68h:function(n,t){this.$8e=t;_js.Trace.logInfo(_at.$1T.$A,"Attachment ID: {0}",this.$8e?this.$8e.Id:"null")},$9Rt:function(){this.$6X.$9Rx(this)},$1Z2:function(){_js.Trace.logInfo(_at.$1T.$A,"Deleting attachment.");this.$1BF=_a.$6.$1c(_a.$0.$1N,"AttachmentDeleteAttachment",!0);this.set_$146(!0);var n=!!this.$1B.get_$3i()&&!!this.$1B.get_$3i().Id&&!this.$1B.get_$3i().Id.startsWith("smime-");if(n){_js.Trace.logInfo(_at.$1T.$A,"Deleting attachment from server.");this.$6X.$1H6(this,!1);this.$6X.$170(this)}else if(this.$4cw)_js.Trace.logError(_at.$1T.$A,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");else{if(_g.$4x.isInstanceOfType(this.$1B)){var t=this.$1B;this.$5I0(t)}else _js.Trace.logInfo(_at.$1T.$A,"Not a file attachment.");this.$6X.$1H6(this,!0);_a.$6.$1E(this.$1BF,null,"",null,$3Ul(this,!1));this.$1BF=null}_at.$De.$9wO(this.$1B.get_$4k(),!n)},$A1U:function(n,t,i){this.set_$6ek(!0);if(this.$OM){_js.Trace.logInfo(_at.$1T.$A,"Attachment skipped because it's been deleted while it was pending.",this.$1B.get_$1L());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$6X.get_$9Z().Id=r.Id;this.$6X.get_$9Z().ChangeKey=r.ChangeKey;this.$4PA=t;this.$5Yo(t)},$5Mj:function(){$1VY(this,2,_at.$81.$7ta(this.$5GD),!1);$2gH(this,null)},$7hS:function(n){_js.Trace.logWarning(_at.$1T.$A,"delete failed with error: {0}",n.$1f.message);this.$FD=!0;this.set_$146(!1);this.$6X.$32g(this.$59)&&!this.$mo&&this.$6X.$10y(this);if(this.$1BF){_a.$6.$1E(this.$1BF,null,_at.$81.$2vg(n),n?n.$A6R():null,$3Ul(this,!0));this.$1BF=null}},$5Hw:function(n){$Dp(this,"OnDeleteCompleteEvent",this);_at.$De.$9wW(this.$FD,this.$1B.get_$4k(),this.$1B.get_$1L().length,this.$1B.get_$Bf());if(this.$1BF){_a.$6.$1E(this.$1BF,null,"",n?n.$A6R():null,$3Ul(this,!0));this.$1BF=null}},$9kL:function(){_y.$A7.$3O5=this.$C.get_$L()==="Mouse"&&this.$C.get_$9A()&&!this.get_$5e9();this.$2L&&this.$6X&&this.$6X.get_$9Z()&&this.$2L.$3Gd(this.$6X.get_$9Z())},$Re:function(){if(this.$1B.get_$3i())if(_g.$8F.isInstanceOfType(this.$1B))this.$3Gh();else if(_g.$4x.isInstanceOfType(this.$1B))$3Um(this);else if(_g.$8z.isInstanceOfType(this.$1B)){var n=this.$1B;n.get_$i()?this.$3Gh():n.get_$L1()?this.$3Gh():$3Um(this)}else $3Um(this);_at.$De.$6c4(this.$1B.get_$4k(),this.$IK.$lR,this.$5H,!1,!1)},$3Gh:function(){if(!this.get_$7Un()){_js.Trace.logInfo(_at.$1T.$A,"Unsupported item.");$10i(this,_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}var t=this.$1B.get_$3i().Id;var n=null;_g.$8F.isInstanceOfType(this.$1B)?n=this.$1B.get_$IH():_g.$8z.isInstanceOfType(this.$1B)&&(n=this.$1B.get_$IH());this.$1B.get_$rX()&&_a.$s.$7TJ(t,[this.$1B.get_$Am().DateTimeReceived,n]);var i={};i.AttachmentItemID=t;_js.Trace.logInfo(_at.$1T.$A,"Opening item attachment in pop-out window.");this.$C.$62(_y.$pd,null,i,_y.$48.get_$UP())},$6F6:function(){if(this.$1pR){this.$1pR.$LR();return}if(this.$11D){var n=this;this.$11D.$E(function(t){if(!n.$6X){_js.Trace.logError(_a.$0.$1N,"OpenDocumentInBrowser: Parent well is null.");return}n.set_$7RO(t.$E(n,n.$6X.get_$572()));n.$1pR.$LR()})}_at.$De.$6c4(this.$1B.get_$4k(),this.$IK.$lR,this.$5H,!0,this.$IK.$1md)},$9Rp:function(){this.$1B.get_$3i()&&(this.get_$428()&&this.$C.get_$L()==="Mouse"?this.$6F6():this.$k4.$n())}};_at.$Ob=function(n,t,i,r,u,f,e,o,s,h){this.$A2R=_at.$2n;_a.$4.$J(t,"owaShell");_a.$4.$J(i,"palDownloadManager");_a.$4.$J(r,"userAgent");_a.$4.$J(u,"nativeBridge");_a.$4.$J(s,"itemStoreGetterFactory");this.$2L=n;this.$C=t;this.$k9=i;this.$13=r;this.$12=u;this.$2FK=f;this.$1J=e;this.$11D=o;this.$1zH=s;this.$4cx=h};function $4fn(n,t,i,r,u,f,e,o){var s=this;n.$3jt(t[i],u,f,e,function(s){Array.add(r,s);i<t.length-1?$4fn(n,t,i+1,r,u,f,e,o):o(r)})}function $4fo(n){return n.$1J?n.$1J.$3u("AttachmentsFilePicker"):!1}_at.$Ob.prototype={$C:null,$13:null,$k9:null,$12:null,$1J:null,$11D:null,$1zH:null,$2L:null,$2FK:null,$2mF:null,$A2R:null,$4cx:null,$E:function(n,t,i,r){if($4fo(this)&&(_g.$BA.isInstanceOfType(n)||_g.$4x.isInstanceOfType(n)&&_y.$Td.isInstanceOfType(n.$FZ))){if(!this.$2mF&&this.$2FK){var u=this;this.$2FK.$E(function(n){u.$2mF=n})}_a.$4.$l(this.$2mF,"attachmentProviderItemViewModelFactory");return this.$2mF.$E(n,this.$C,t,i,r,this.$13)}else if(_g.$4x.isInstanceOfType(n)&&_y.$js.isInstanceOfType(n.$FZ)){_a.$4.$l(this.$4cx,"uriFileAttachmentViewModelFactory");return this.$4cx.$E(n,this.$C,t,i,r,this.$13)}else return new _at.$2n(n,this.$C,t,i,r,this.$k9,this.$2L,this.$12,this.$13,this.$1J,this.$11D,this.$1zH)},$3jt:function(n,t,i,r,u){if($4fo(this)&&this.$2FK&&(_g.$BA.isInstanceOfType(n)||_g.$4x.isInstanceOfType(n)&&_y.$Td.isInstanceOfType(n.$FZ))){var f=this;var e=function(e){var o=e.$E(n,f.$C,t,i,r,f.$13);u(o)};this.$2FK.$E(e)}else{var o=new _at.$2n(n,this.$C,t,i,r,this.$k9,this.$2L,this.$12,this.$13,this.$1J,this.$11D,this.$1zH);u(o)}},$7b6:function(n,t,i,r,u){if(!n){u(null);return}if(!n.length){u(new Array(0));return}$4fn(this,n,0,new Array(0),t,i,r,u)}};_at.$81=function(){};_at.$81.$2vg=function(n){var t;if(n){if(_h.$pF.isInstanceOfType(n)&&(t=n.get_$1Jc())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$81.$5QW(r);if(i)return i}if(t.response.statusCode)return _at.$81.$3rt(t.response.statusCode)}}if(n.$1f)return _at.$81.$2LV(n.$1f)}return"UnknownError"};_at.$81.$2LV=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$81.$5QX(t.toString());if(t=n.ErrorCode)return _at.$81.$3rt(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError"};_at.$81.$5QW=function(n){if(n){if(n.ResponseCode)return n.ResponseCode.toString();if(n.StackTrace)return _at.$81.$5QX(n.StackTrace);if(n.ErrorCode)return _at.$81.$3rt(n.ErrorCode)}return null};_at.$81.$5QX=function(n){var t;var i;if((t=n.indexOf(":"))!==-1||(t=n.indexOf("\n"))!==-1){i=n.substr(0,t);if((t=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(t));r&&(i=i+"@"+r[0].substr(0,r[0].length-1))}}else i=n;return i};_at.$81.$3rt=function(n){return"HTTP_"+n};_at.$81.$7ta=function(n){var t=n.get_$DT();if(t){var i;i=Number.isInstanceOfType(t)?t:t.code;return i>=1&&i<_at.$81.$3qt.length?_at.$81.$3qt[i]:_at.$81.$2LV(t)}return n.get_$1tP()?_at.$81.$2LV(n.get_$1tP()):"UnknownError"};_at.$HJ=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$7b8=Function.createDelegate(this,this.$7b8);this.$$d_$7bB=Function.createDelegate(this,this.$7bB);this.$$d_$7R5=Function.createDelegate(this,this.$7R5);_at.$HJ.initializeBase(this,[n,t,i,r,u,s,f,h,c]);this.$FC=e;this.$k=o};function $2gI(n){var t=_g.$1U.$MG;t?t.$9Zm(n.get_$Hn(),n.$$d_$7R5,n.get_$Bw()):n.$FC.$1H0(n.get_$Hn(),_a.$0.$5d,n.get_$Bw(),n.$$d_$7R5,0)}function $4fr(n,t){var r=null;if(t&&t.ResponseMessages&&t.ResponseMessages.Items&&t.ResponseMessages.Items.length)if(t.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+t.ResponseMessages.Items[0].ResponseCode;else{var i=t.ResponseMessages.Items[0];n.$1B.set_$4k(i.Attachments[0].Size);_at.$BN.$6KM(i,n.$1B,n.$6X.get_$9Z());if(_g.$BA.isInstanceOfType(n.$1B)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var u=i.Attachments[0];u.AttachLongPathName&&n.$1B.set_$1Wk(u.AttachLongPathName);n.$1B.set_$1L(u.Name)}}else r="The response message received is null";return r}_at.$HJ.prototype={$k:null,$FC:null,$6dH:function(){var n=_g.$1U.$MG;n?n.$9y7(this.get_$Hn(),this.$$d_$7R5):this.$FC.$1mN(this.get_$Hn(),this.$$d_$7R5)},$5E4:function(n){this.$6dH();_at.$1T.prototype.$5E4.call(this,n)},$6eD:function(){this.set_$6HQ(!1)},$7bB:function(n){},$7b8:function(n){this.$2pb(n);this.$5E4(null)},$7R5:function(n){var t=null;var i=n;t=n?$4fr(this,i.Response):"The notification received is null";if(t){i&&(t+=". AttachmentProviderResultCode = "+i.ResultCode);$1VY(this,1,t,!0)}else this.$9XQ(i);this.$5E4(null)},$9XQ:function(n){}};_at.$tE=function(n,t,i,r,u,f,e,o,s,h,c){_at.$tE.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.$tE.$2LH=function(){return"UriFileAttachmentNotification"+(_a.$7.get_$29().$5R()+_a.$8q.$3JU(0,1e3)).toString()};_at.$tE.prototype={$CC:null,get_$Hn:function(){this.$CC||(this.$CC=_at.$tE.$2LH());return this.$CC},set_$Hn:function(n){this.$CC=n;return n},get_$Bw:function(){return"UriFileAttachmentViewModel"},$5Yo:function(n){if(_g.$4x.isInstanceOfType(this.$1B)&&_y.$js.isInstanceOfType(this.$1B.$FZ)){_js.Trace.logInfo(_a.$0.$5d,"Uploading attachment from URL");var i=this.$1B.$FZ;$2gI(this);var t=new _at.$139(this.$6X.get_$9Z(),i.get_$A1a(),i.get_$1L(),this.get_$Hn());t.add_$2C(this.$$d_$7bB);t.add_$1x(this.$$d_$7b8);this.$k.$z(t)}else{_js.Trace.logError(_a.$0.$5d,"Unsupported upload type detected in addFileAttachment");n(null)}}};_at.$10r=function(n,t,i,r,u,f){this.$FC=n;this.$k=t;this.$2L=i;this.$1J=r;this.$11D=u};_at.$10r.prototype={$FC:null,$k:null,$2L:null,$1J:null,$11D:null,$E:function(n,t,i,r,u,f){return new _at.$tE(n,t,i,r,u,f,this.$FC,this.$k,this.$2L,this.$1J,this.$11D)}};_at.$FG=function(n){this.$1p=n;this.$2Qe={};this.$1PC=new(_0365f.$o.$$(_at.$RX))};function $3Uo(n,t){_a.$4.$J(t,"parameter");_a.$4.$J(t.$8e,"AttachmentId")}function $1nC(n,t,i){}_at.$FG.prototype={$1p:null,$2Qe:null,$1PC:null,get_$B:function(){return this.$1PC.get_$B()},$7G:function(n){_a.$4.$1G(n,"attachmentId");return n in this.$2Qe},$D:function(n){$3Uo(this,n);if(!this.$7G(n.$8e)){$1nC(this,"FastLookupQueue. Adding {0}",n);this.$1PC.$D(n);this.$2Qe[n.$8e]=""}},$72:function(n,t){$3Uo(this,t);if(!this.$7G(t.$8e)){$1nC(this,"FastLookupQueue. InsertAt {0}",t);this.$1PC.$A3U(n,t);this.$2Qe[t.$8e]=""}},$7iH:function(){$1nC(this,"FastLookupQueue. DeQueue. Current count {0}",this.get_$B());if(this.get_$B()>0){var n=this.$1PC.get_$3q(0);this.$34(n);return n}else return null},$34:function(n){$3Uo(this,n);$1nC(this,"FastLookupQueue. Remove. Current count {0}",this.get_$B());if(this.$7G(n.$8e)){$1nC(this,"FastLookupQueue. Remove. Found {0}",n);delete this.$2Qe[n.$8e];for(var i=-1,t=0;t<this.$1PC.get_$B();t++)if(this.$1PC.get_$3q(t).$8e===n.$8e){i=t;break}if(i!==-1){this.$1PC.$68(i);$1nC(this,"FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$B())}}}};_at.$BT=function(){};_at.$BT.$4L3=function(n,t,i,r,u,f,e){_a.$4.$J(n,"initNativeBridge");_a.$4.$J(t,"initClientStore");_a.$4.$J(i,"initAttachmentInfoRecord");_a.$4.$1G(r,"initMimeType");_a.$4.$1G(u,"fileName");_a.$4.$J(f,"initOnOpenAttachmentSuccess");_a.$4.$J(e,"initOnOpenAttachmentError");if(_at.$BT.$324){_js.Trace.logInfo(_at.$BT.$A,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$BT.$A,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$BT.$324=!0;n.$9Q.$9Rl(i.DataID,r,u,function(n){_at.$BT.$9Kf(n,i,t,f,e)});t.$5Pd(i.AttachmentId,function(n){},null)};_at.$BT.$7tZ=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$BT.$A,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$BT.$9Kf=function(n,t,i,r,u){_at.$BT.$324=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$5Hr(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$BT.$A,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$BT.$A,"OnOpenDocument succeeded");r()}};_at.$2Z=function(n,t,i){this.$$d_$9E8=Function.createDelegate(this,this.$9E8);this.$$d_$9Jq=Function.createDelegate(this,this.$9Jq);this.$$d_$6Dp=Function.createDelegate(this,this.$6Dp);_a.$4.$J(n,"initNativeBridge");var r=t?t.get_$4YA():null;this.$12=n;this.$3i0=i;this.$2t=_a.UserAgent.getInstance().$422(r,n);$4fv(this,t)};_at.$2Z.get_$I=function(){if(!_at.$2Z.$v){var n=_bc.$XT.isInstanceOfType(_g.$1U.$v)?_g.$1U.$v:null;_at.$2Z.$v=new _at.$2Z(_a.NativeBridge.get_$I(),n?n.get_$A8().get_$1K9():null,n?n.get_$7RE():null)}return _at.$2Z.$v};function $6jI(n,t){var i=null;switch(t){case 0:break;case 7:break;case 3:i=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,u=this;n.$3i0.$7W6(n.$6Y,n.$12,function(){_js.Trace.logInfo(_at.$2Z.$A,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$2Z.$A,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});i=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:i=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:i=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:i=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:i=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return i}function $4fv(n,t){if(n.$2t){n.$6Y=t;n.$qG=new _at.$FG(_at.$2Z.$A);n.$1ss={};n.$11Y=null;n.$Ib=null;n.$2qE=0}}function $4fu(n){_js.Trace.logInfo(_at.$2Z.$A,"CancelCurrentDownload, canceling the current download");n.$12.$ar.$7UP();n.$11Y=n.$Ib;n.$Ib=null}function $2gK(n){_js.Trace.logInfo(_at.$2Z.$A,"Inside StartDownloadInternal");if(n.$11Y)_js.Trace.logInfo(_at.$2Z.$A,"Still waiting for the canceled download to get canceled.");else if(n.$Ib)_js.Trace.logInfo(_at.$2Z.$A,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$2Z.$A,"StartDownloadInternal, pending items in queue {0}",n.$qG.get_$B());n.$Ib=n.$qG.$7iH();n.$2qE=0;if(n.$Ib){_js.Trace.logInfo(_at.$2Z.$A,"Starting download {0}",n.$Ib);$1J4(n,n.$Ib,3);var t=this;n.$3i0.$9rS(n.$6Y,n.$12,n.$$d_$6Dp,function(t){_js.Trace.logWarning(_at.$2Z.$A,"Scheduled cleanup failed due to error {0}",t);n.$6Dp()})}else _js.Trace.logInfo(_at.$2Z.$A,"Download queue is empty.")}}function $1J4(n,t,i){var r=this;$2gJ(n,t,function(n){n.$1hZ(i)})}function $4fw(n,t,i){var r=this;$2gJ(n,t,function(n){_js.Trace.logWarning(_at.$2Z.$A,"Raising OnError event with error {0} for attachment {1}",i,t);n.$TA(i)})}function $2gJ(n,t,i){var r=n.$1ss[t.$8e];r&&i(r)}function $6jJ(n,t){var i=null;if(_bc.$Bd.$5a9(t.$8e)){_js.Trace.logInfo(_at.$2Z.$A,"The attachment is not uploaded to the server yet. {0}",t);i=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$a(t.$4MK)){_js.Trace.logInfo(_at.$2Z.$A,"Attachment is a quick message {0}",t);i=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$a(t.$1g7)){_js.Trace.logInfo(_at.$2Z.$A,"Attachment does not have content type set. {0}",t);i=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$9.$a(t.$mJ)){_js.Trace.logInfo(_at.$2Z.$A,"Attachment does not have a valid file name {0}.",t);i=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(n.$qG.get_$B()===10){_js.Trace.logInfo(_at.$2Z.$A,"download queue max size reached. Rejecting attachment with params {0}.",t);i=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return i}function $6jH(n,t,i){if(n.$Ib&&t===n.$Ib.$8e){_js.Trace.logInfo(_at.$2Z.$A,"FindStatusAndFireCallback. currently downloading attachment with id {0}",t);i.$1hZ(3)}else if(n.$qG.$7G(t)){_js.Trace.logInfo(_at.$2Z.$A,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",t);i.$1hZ(2)}else{var r=this,u=this;n.$6Y.$6P3(t,function(n){if(n){_js.Trace.logInfo(_at.$2Z.$A,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",n.DataID,n.AttachmentId);i.$1hZ(4);i.$68i(n)}else{_js.Trace.logInfo(_at.$2Z.$A,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",t);i.$1hZ(1)}},function(n){_js.Trace.logWarning(_at.$2Z.$A,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",n,t);i.$1hZ(1)})}}_at.$2Z.prototype={$2t:!1,$qG:null,$Ib:null,$11Y:null,$2qE:0,$1ss:null,$12:null,$3i0:null,$6Y:null,get_$1AG:function(){if(!this.$2t&&_g.$1U.$v){var n=_bc.$XT.isInstanceOfType(_g.$1U.$v)?_g.$1U.$v:null;this.$2t=_a.UserAgent.getInstance().$422(n?n.get_$5a():null,this.$12);$4fv(this,n?n.get_$A8().get_$1K9():null)}return this.$2t},$IU:function(n,t){_a.$4.$1G(n,"attachmentId");_a.$4.$J(t,"callbacks");if(this.get_$1AG()){this.$1ss[n]=t;$6jH(this,n,t)}else _js.Trace.logInfo(_at.$2Z.$A,"PAL does not support download.")},$2BR:function(n){_a.$4.$1G(n,"attachmentId");this.get_$1AG()&&n in this.$1ss&&delete this.$1ss[n]},$5Jq:function(n){_a.$4.$J(n,"parameters");_a.$4.$J(n.$8e,"AttachmentId");_a.$4.$J(n.$Mp,"DownloadUrl");_js.Trace.logInfo(_at.$2Z.$A,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$1AG()){if(!(n.$8e in this.$1ss))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=$6jJ(this,n);if(_js.$9.$a(t)){if((!this.$Ib||this.$Ib.$8e!==n.$8e)&&!this.$qG.$7G(n.$8e)){_js.Trace.logInfo(_at.$2Z.$A,"Starting download for {0}",n);if(n.$5bU){this.$qG.$72(0,n);if(this.$Ib){$4fu(this);this.$qG.$72(1,this.$11Y);$1J4(this,this.$11Y,2)}else{$1J4(this,n,2);$2gK(this)}}else{this.$qG.$D(n);$1J4(this,n,2);$2gK(this)}}}else $4fw(this,n,t)}},$9b:function(n){_a.$4.$J(n,"parameters");_a.$4.$J(n.$8e,"AttachmentId");_js.Trace.logInfo(_at.$2Z.$A,"Cancel download for parameters {0}",n);if(this.get_$1AG())if(this.$qG.$7G(n.$8e)){this.$qG.$34(n);_js.Trace.logInfo(_at.$2Z.$A,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$qG.get_$B());$1J4(this,n,1)}else if(this.$Ib&&this.$Ib.$8e===n.$8e){_js.Trace.logInfo(_at.$2Z.$A,"Current Download was canceled. {0}",this.$Ib);$4fu(this);$1J4(this,this.$11Y,1)}},$6Dp:function(){_js.Trace.logInfo(_at.$2Z.$A,"Starting the download now for {0}",this.$Ib);if(this.$11Y){this.$11Y=null;$2gK(this)}else this.$12.$ar.$7k5(this.$Ib.$Mp,1,this.$Ib.$mJ,this.$Ib.$1g7,this.$$d_$9Jq,this.$$d_$9E8)},$9Jq:function(n){if(this.$Ib){this.$2qE+=n;var t=this;$2gJ(this,this.$Ib,function(n){n.$69v(t.$2qE)})}},$9E8:function(n,t,i){_js.Trace.logInfo(_at.$2Z.$A,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$Ib);if(this.$11Y)this.$11Y=null;else if(n||t!==200){var f=$6jI(this,n);_js.$9.$a(f)||$4fw(this,this.$Ib,f);$1J4(this,this.$Ib,1)}else{var r=this.$Ib;var u=new AttachmentInfoRecord(this.$Ib.$8e,i,this.$Ib.$3eY,_a.$7.get_utcNow().$5R(),this.$Ib.$4MK,0,_a.$7.$5P4(_a.$7.get_utcNow()),!0);var e=this,o=this;this.$6Y.$6QF(u,function(n){_js.Trace.logInfo(_at.$2Z.$A,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$2Z.$A,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});$1J4(this,r,4);var s=this;$2gJ(this,r,function(n){_js.Trace.logInfo(_at.$2Z.$A,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$68i(u)})}this.$Ib=null;$2gK(this)}};_at.$RX=function(){};_at.$RX.$7dy=function(n){_a.$4.$J(n,"viewModel");_a.$4.$J(n.$Mp,"DownloadUrl should not be empty");var t=null;n.$6X&&n.$6X.get_$9Z()&&(t=n.$6X.get_$9Z().Id);return _at.$RX.$5FD(n.$1B,n.$1B.get_$1L(),n.$1B.get_$Bf(),n.$Mp,t,!1)};_at.$RX.$5FD=function(n,t,i,r,u,f){_a.$4.$J(n,"attachment");_a.$4.$J(n.get_$3i(),"attachmentId");_a.$4.$J(r,"downloadUrl");_a.$4.$J(r,"destinationFileName");var e=new _at.$RX;e.$8e=n.get_$3i().Id;e.$3eY=n.get_$4k();e.$1MZ=t;e.$mJ=_a.$6c.$U6(e.$1MZ);e.$1g7=i;e.$Mp=_a.Uri.$4RZ(r);e.$4MK=u;e.$5bU=f;_js.$9.$a(e.$1g7)&&!_a.UserAgent.getInstance().$iq&&(e.$1g7="fakeMimeType");return e};_at.$RX.prototype={$1g7:null,$1MZ:null,$mJ:null,$8e:null,$4MK:null,$Mp:null,$3eY:0,$5bU:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1MZ,this.$3eY,this.$1g7,this.$8e)}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$mi=function(){};_at.$mi.prototype={$36:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$5DQ:function(n,t){throw Error.notImplemented();}};_at.$14D=function(){};_at.$14D.prototype={};_at.$14D.registerEnum("_at.$14D",!1);_at.$my=function(){};_at.$my.prototype={$36:function(n,t){var i=n;var r=_js.$1g.$o2(_a.$VX,t.toString());return i!==r},$5DQ:function(n,t){throw Error.notImplemented();}};_at.$n4=function(){};_at.$n4.prototype={$36:function(n,t){var i=n;return!i||!i.$1B?"":_js.$9.$a(i.$1B.get_$3R4())?i.get_$mZ():"data:"+i.$1B.get_$6aw()+";base64,"+i.$1B.get_$3R4()},$5DQ:function(n,t){throw Error.notImplemented();}};_at.$r7=function(){};_at.$r7.prototype={$36:function(n,t){var i=n;var r=!0;try{var u=_js.$1g.$o2(_at.$14D,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$5DQ:function(n,t){throw Error.notImplemented();}};_at.$139.registerClass("_at.$139",_h.$F3.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1In);_at.$3b.registerClass("_at.$3b",_b.$I6);_at.$5n.registerClass("_at.$5n");_at.$11f.registerClass("_at.$11f");_at.$va.registerClass("_at.$va",null,_at.$1IU);_at.$vb.registerClass("_at.$vb");_at.$BN.registerClass("_at.$BN",_h.$JQ.$$(_g.$T3,_g.$ZZ));_at.$13B.registerClass("_at.$13B",_at.$BN);_at.$13h.registerClass("_at.$13h",_h.$JQ.$$(_g.$T6,_g.$al));_at.$bn.registerClass("_at.$bn",_h.$JQ.$$(_g.$WV,_g.$ZZ));_at.$Ln.registerClass("_at.$Ln",_h.$F3.$$(String));_at.$11d.registerClass("_at.$11d",_a.$T);_at.$11d.prototype.$9a=_a.$T.prototype.$9a;_at.$CJ.registerClass("_at.$CJ");_at.$11e.registerClass("_at.$11e",_a.$T);_at.$11e.prototype.$9a=_a.$T.prototype.$9a;_at.$11g.registerClass("_at.$11g",_a.$T);_at.$11g.prototype.$9a=_a.$T.prototype.$9a;_at.$11i.registerClass("_at.$11i",_a.$T);_at.$11i.prototype.$9a=_a.$T.prototype.$9a;_at.$De.registerClass("_at.$De");_at.$11l.registerClass("_at.$11l",_a.$T);_at.$11l.prototype.$9a=_a.$T.prototype.$9a;_at.$1T.registerClass("_at.$1T",_a.$F2,_y.$jM,_js.$x6);_at.$2n.registerClass("_at.$2n",_at.$1T,_at.$1I9);_at.$Ob.registerClass("_at.$Ob",null,IAttachmentViewModelFactory);_at.$81.registerClass("_at.$81");_at.$HJ.registerClass("_at.$HJ",_at.$1T);_at.$tE.registerClass("_at.$tE",_at.$HJ);_at.$10r.registerClass("_at.$10r",null,IUriFileAttachmentViewModelFactory);_at.$FG.registerClass("_at.$FG");_at.$BT.registerClass("_at.$BT");_at.$2Z.registerClass("_at.$2Z",null,_at.$XV);_at.$RX.registerClass("_at.$RX");_at.$mi.registerClass("_at.$mi",null,_js.$1J5);_at.$my.registerClass("_at.$my",null,_js.$1J5);_at.$n4.registerClass("_at.$n4",null,_js.$1J5);_at.$r7.registerClass("_at.$r7",null,_js.$1J5);_at.$3b.$3eU=new _H("Attachment",_g.Attachment,_at.$3b);_at.$3b.$4MI=new _H("ParentItemId",_g.$1q,_at.$3b);_at.$3b.$1Cw=new _H("IsEnabled",Boolean,_at.$3b);_at.$3b.$3qv=new _H("FileSelectedCommand",_js.$DC,_at.$3b);_at.$3b.$3T6=new _H("UploadAttachmentCommand",_js.$DC,_at.$3b);_at.$3b.$4cv=new _H("UploadCompletedCommand",_js.$DC,_at.$3b);_at.$3b.$A=_a.$0.$1N;_at.$5n.$v=null;_at.$BN.$A=_a.$0.$1N;_at.$bn.$A=_a.$0.$1N;_at.$CJ.$2xr=null;_at.$2n.$A=_a.$0.$1N;_at.$1T.$A=_a.$0.$1N;_at.$81.$3qt=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$BT.$A=_a.$0.$1N;_at.$BT.$324=!1;_at.$2Z.$A=_a.$0.$1N;_at.$2Z.$v=null