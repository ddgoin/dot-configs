Type.registerNamespace("_e");_e.$3q=function(){};_e.$3q.$1Sr=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),i);_a.$2s.$jE(t,function(){_e.$5y.$1Sr(u)})})};_e.$3q.$Wo=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),i);_a.$2s.$jE(t,function(){u(n)})})};_e.$3q.$A1O=function(n,t,i){i&&(t.onupgradeneeded=function(t){var r=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),n);_a.$2s.$jE(r,function(){i(t)})})};_e.$3q.$zd=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),i);_a.$2s.$jE(t,function(){_e.$5y.$ze(n.target.error.name,u)})})};_e.$3q.$DT=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),i);_a.$2s.$jE(t,function(){u(n)})})};function CoreStorageComponent(){}CoreStorageComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_e.$1I).$A5E(_e.$wV).$A5F().$A5G(function(){return _e.$1I.get_$I()});var u=this;n.$Ad(_a.$wN).$A5G(function(){var i=new _a.$gp(n.$6OW(_js.$CQ),n.$6OW(_a.$SV),n.$6OW(_a.$7G));var t=n.$6OW(_a.NativeBridge);var r=new _a.$1AA(n.$6OW(_a.UserAgent),t);return _e.$Vh.$E(r,i,t)});var f=this;n.$Ad(IClientStore).$A5F().$A5G(function(){return new _e.$1n(256,n.$6OW(_e.$wV),n.$6OW(_a.$wN),n.$6OW(_a.$3O))});var e=this;n.$Ad(IAttachmentsCleanupManager).$A5F().$A5G(function(){return _e.$5O.$1CB()});var o=this;n.$Ad(IInlineImageItemStore).$A5G(function(){return new _e.$x4(n.$6OW(IClientStore),_e.$1n.$7e)});var s=this;n.$Ad(IAttachmentInfoItemStore).$A5G(function(){return new _e.$tm(n.$6OW(IClientStore),_e.$1n.$7e)});var h=this;n.$Ad(_e.$xe).$A5E(IItemStoreGetterFactory).$A5G(function(){return new _e.$xe(n.$6OW(IClientStore))});var c=this;n.$Ad(_e.$mj).$A5F().$A5G(function(){return new _e.$mj(n.$6OW(_a.NativeBridge))})},$7sM:function(){return[new _a.$65(_e.$mj,2,8)]}};_e.$7f=function(){};_e.$7f.$E=function(n,t){var i=_e.$7f.$5Ev(n);var r=_e.$7f.$5Ev(t);return i+"\x01"+r};_e.$7f.$5Ev=function(n){return String.isInstanceOfType(n)?"S"+_e.$7f.$9ey(n):Number.isInstanceOfType(n)?"N"+_e.$7f.$7dB(n):Boolean.isInstanceOfType(n)?"B"+_e.$7f.$7bH(n):null};_e.$7f.$9ey=function(n){if(n.indexOf("\x01")>=0){_js.Trace.logWarning(_a.$0.$Cv,"A composite key is being constructed with the composite key meta-character and will be stripped of the character.  Consequently, sorts and filters, will ignore that character in any comparisons. {0}",n);return n.replace("\x01","")}else return n};_e.$7f.$7dB=function(n){n>0xfffffffffffff&&(n=0xfffffffffffff);n<_e.$7f.$4XB&&(n=_e.$7f.$4XB);if(n>=0){var i=n.toString(16);var u=13-i.length;var t=new Sys.StringBuilder;t.append("P");for(var r=0;r<u;++r)t.append("0");t.append(i);return t.toString()}else{var f=0xfffffffffffff+n+1;var e=f.toString(16);return"N"+e}};_e.$7f.$7bH=function(n){return n.toString()};_e.$5O=function(){$1nm(this)};_e.$5O.$1CB=function(){_e.$5O.$v||(_e.$5O.$v=new _e.$5O);return _e.$5O.$v};function $6yL(n,t,i,r,u){var f;var o={};var s=[];for(f=0;f<u.length;f++)o[u[f]]=0;var h=_a.$7.get_utcNow().$2o(-3).$5R();for(f=0;f<r.length;f++){var e=r[f];e.LastAccessedDateTime<h?Array.add(s,e.AttachmentId):e.DataID in o?o[e.DataID]=1:Array.add(s,e.AttachmentId)}for(f=0;f<u.length;f++)o[u[f]]||i.$f0.$12F(u[f]);_e.$4q.$5Hs(s,t)}function $3XW(n,t,i,r){if(n.$30g||!t.$V2){_js.Trace.logWarning(_e.$5O.$A,"Already executing or the native bridge is not ready");$2hn(n,r,Error.create("Already executing the cleanup or NativeBridge is not ready yet."));return!1}else{n.$30g=!0;return!0}}function $4oT(n,t,i){var r=this;t.$f0.$5PN(1,function(r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];t.$f0.$12F(o)}$4oS(n,i);$1nm(n)})}function $1nm(n){n.$30g=!1}function $2hn(n,t,i){t&&t(i)}function $4oS(n,t){t&&t()}_e.$5O.prototype={$30g:!1,get_$89i:function(){return this.$30g},$7W7:function(n,t,i){_a.$4.$J(n,"nativeBridge");_js.Trace.logInfo(_e.$5O.$A,"CleanAllPalAttachments start");$3XW(this,n,t,i)&&$4oT(this,n,t)},$7W6:function(n,t,i,r){_a.$4.$J(n,"attachmentStore");_a.$4.$J(t,"initNativeBridge");_js.Trace.logInfo(_e.$5O.$A,"CleanAllPalAttachmentInfoAndAttachments start");if($3XW(this,t,i,r)){var u=this,f=this;_e.$4q.$5PP(n,function(f){n.$BT(new _a.$6j("SyncConversationItemsReadFlagModule.CleanAllPalAttachmentInfoAndAttachments"),function(t){if(f)for(var r=f,u=r.length,i=0;i<u;++i){var e=r[i];n.$Ht(t,_e.$1h.$5f(e.AttachmentId))}},function(){$4oT(u,t,i)},function(n){_e.$1f.$D6(n,function(t){_js.Trace.logWarning(_e.$5O.$A,"Error occurred during cleanup call {0}",n);$2hn(u,r,t.$SQ());$1nm(u)})})},function(n){_js.Trace.logWarning(_e.$5O.$A,"Error in DB while retrieving all non inline attachment info {0}",n);$2hn(f,r,n.$SQ());$1nm(f)})}},$9rS:function(n,t,i,r){_a.$4.$J(n,"store");_a.$4.$J(t,"nativeBridge");_js.Trace.logInfo(_e.$5O.$A,"AttachmentCleanupManager.StartCleanUp start");if($3XW(this,t,i,r)){var f=null;var e=null;var u=this,o=this;_e.$4q.$5PP(n,function(r){f=r;t.$f0.$5PN(1,function(r){e=r;$6yL(u,n,t,f,e);$4oS(u,i);$1nm(u)})},function(n){_js.Trace.logWarning(_e.$5O.$A,"Error in DB during StartScheduledCleanup {0}",n);$2hn(o,r,n.$SQ());$1nm(o)})}}};var ItemShapeType=function(){};ItemShapeType.prototype={};ItemShapeType.registerEnum("ItemShapeType",!1);_e.$13t=function(){};_e.$13t.prototype={};_e.$13t.registerEnum("_e.$13t",!1);_e.$1FO=function(){};_e.$1FO.registerInterface("_e.$1FO");_e.$wV=function(){};_e.$wV.registerInterface("_e.$wV");_e.$wm=function(){};_e.$wm.registerInterface("_e.$wm");_e.$wn=function(){};_e.$wn.registerInterface("_e.$wn");_e.$1FT=function(){};_e.$1FT.registerInterface("_e.$1FT");_e.$1FS=function(){};_e.$1FS.registerInterface("_e.$1FS");function AddressbookPostalAddress(){}function AddressbookEmailAddressInfo(){}AddressbookEmailAddressInfo.prototype={EmailAddress:null,EmailAddressProperty:"FolderId"};function AddressbookPhoneNumberInfo(){}AddressbookPhoneNumberInfo.prototype={PhoneNumber:null,PhoneNumberProperty:"FolderId",PhoneNumberType:0};function AddressbookPostalAddressInfo(){}AddressbookPostalAddressInfo.prototype={PostalAddress:null,PostalAddressProperty:"FolderId",PostalAddressType:0};_e.$11G=function(n){_e.$11G.initializeBase(this);this.$Ln=n};_e.$11G.prototype={$Ln:null,$9XU:function(n,t,i,r,u){var f=n.PersonaId.Id;switch(u){case 1:var e=_e.$5m.$7cM(n);this.$Ln.$6QO(f,JsonParser.serialize(e));break;case 2:this.$Ln.$1Ly(f);break}}};_e.$mz=function(n,t){this.$1pT=[];_e.$mz.initializeBase(this);_a.$4.$J(n,"attachmentItemStore");_a.$4.$J(t,"inlineImageItemStore");this.$1KB=n;this.$2zM=t};_e.$mz.prototype={$1KB:null,$2zM:null,$3Rh:0,$6Hg:function(n){this.$2v3(n)},$4N2:function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"emailCleanupContext");_a.$4.$J(t.$2Ir,"emailCleanupContext.DeletedMessages");_a.$4.$J(i,"completedCallback");_js.Trace.logInfo(_a.$0.$5a,"Start inline attachment periodic cleanup");Array.clear(this.$1pT);this.$3Rh=0;var r=this;this.$7WE(n,t.$2Ir,function(){t.$Cc.set_$9vF(_e.$CM.get_$1ru()-(t.$1Xp+t.$Cc.get_$2ei()+t.$Cc.get_$3RE()+t.$Cc.get_$4aY()));t.$Cc.set_$67o(r.$3Rh);i()})},$7WE:function(n,t,i){var u=n.$Dg(_e.$1I.get_$I().$19r.get_$1L());var f=new _a.$8J(null,null);if(!t.$A3p()){i();return}var r=this;u.$It(f,function(u){u.$B(function(n){_js.Trace.logInfo(_a.$0.$5a,"Number of attachments to process is {0}",n)},null);var f=[];r.$5Am(u,t,f,function(){_e.$CM.$A5K(_bc.$pL,n,r.$1KB,f);_e.$CM.$A5K(_bc.$17T,n,r.$2zM,f);_js.Trace.logInfo(_a.$0.$5a,"Completed cleaning inline attachments for given messages, total: {0}",f.length);i()})},null)},$5An:function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"messageIds");_a.$4.$7t(i,0,t.length,"currentMessageIndex");_a.$4.$J(r,"completedCallback");if(!t.length){r();return}var u=this;this.$5PO(n,t[i].get_$1dL().toString(),function(f){f&&Array.addRange(u.$1pT,f);++i;if(i===t.length){var o=u.$1pT;u.$3Rh=u.$1pT.length;for(var s=o,c=s.length,e=0;e<c;++e){var h=s[e];u.$1KB.$Ht(n,h);u.$2zM.$Ht(n,h)}_js.Trace.logInfo(_a.$0.$5a,"Completed cleaning inline attachments for given messages, total attachments cleaned: {0} for total messages: {1}",o.length,t.length);Array.clear(u.$1pT);r()}else u.$5An(n,t,i,r)})},$2v3:function(n){_a.$4.$J(n,"tx");_js.Trace.logInfo(_a.$0.$5a,"Performing attachment and inline image cleanup");this.$1KB.$pk(n);this.$2zM.$pk(n)},$5PO:function(n,t,i){_e.$4q.$5PO(n,t,this.$1KB,i,null)},$5Am:function(n,t,i,r){var u=this;n.$Dd(50,function(f,e,o){for(var s=0;s<e.length;++s){var h=u.$1KB.$13C(e[s]);if(h.get_$20().AttachmentType===1&&t.get_$3q(h.get_$20().MessageID)){Array.add(i,h.get_$1y());u.$3Rh++}}e.length===50?u.$5Am(n,t,i,r):r()},null)}};_e.$4q=function(){_e.$4q.initializeBase(this)};_e.$4q.$6P3=function(n,t,i,r){_a.$4.$1G(n,"id");_a.$4.$J(t,"store");_a.$4.$J(i,"successCallback");var u=null;t.$BT(new _a.$6j("AttachmentInfoItem.RetrieveRecord"),function(i){t.$Fy(i,_e.$1h.$5f(n),function(n){n&&(u=n.get_$20())},null)},function(){i(u)},function(n){_e.$1f.$D6(n,r)})};_e.$4q.$5Pd=function(n,t,i,r){_a.$4.$1G(n,"id");_a.$4.$J(t,"store");_a.$4.$J(i,"successCallback");var u=null;t.$BT(new _a.$6j("AttachmentInfoItem.GetAttachmentInfoAndUpdateTime"),function(i){t.$1Ih(i,_e.$1h.$5f(n),function(t){if($6(t)){_js.Trace.logInfo(_e.$1n.$A,"Message with id {0} not found in local store",n);return}u=t;u.LastAccessedDateTime=_a.$7.get_utcNow().$5R()})},function(){i(u)},function(n){_e.$1f.$D6(n,r)})};_e.$4q.$6QF=function(n,t,i,r){_a.$4.$J(n,"record");_a.$4.$J(t,"store");var u=null;var f=t.$4cP(n);t.$BT(new _a.$6j("AttachmentInfoItem.SaveAttachmentInfo"),function(n){f.$E7(n,function(n){u=n})},function(){_e.$1f.$A4S(_a.$pP,u,i)},function(n){_e.$1f.$D6(n,r)})};_e.$4q.$5Hr=function(n,t){_a.$4.$1G(n,"attachmentId");_a.$4.$J(t,"store");_e.$4q.$5Hs([n],t)};_e.$4q.$5Hs=function(n,t){_a.$4.$J(n,"attachmentIds");_a.$4.$J(t,"store");t.$BT(new _a.$6j("AttachmentInfoItem.DeleteAttachmentInfoWithIds"),function(i){for(var u=n,f=u.length,r=0;r<f;++r){var e=u[r];t.$Ht(i,_e.$1h.$5f(e))}},function(){},function(n){_js.Trace.logError(_e.$1n.$A,"DeleteAttachmentInfoWithIds failed with error {0}",n.$3v)})};_e.$4q.$5PP=function(n,t,i){_a.$4.$J(n,"store");_a.$4.$J(t,"successCallback");var r=[];n.$BT(new _a.$6j("AttachmentInfoItem.GetAllNonInlineAttachmentInfoRecords"),function(t){var u=t.$Dg(_e.$1I.get_$I().$19r.get_$1L());var f=new _a.$8k(_e.$4q.$3ee,0);var e=new _a.$8J(f,null);u.$It(e,function(t){_e.$4q.$6Lq(n,t,r,_e.$1f.$Zb(i))},_e.$1f.$Zb(i))},function(){t(r)},_e.$1f.$Zb(i))};_e.$4q.$5PO=function(n,t,i,r,u){_a.$4.$J(n,"tx");_a.$4.$1G(t,"messageId");_a.$4.$J(r,"successCallback");var f=[];var h=n.$Dg(_e.$1I.get_$I().$19r.get_$1L());var e=new _a.$8k(_e.$4q.$47Q,t);var o=new _a.$8J(e,null);var s=100;_e.$y.$6LN(_e.$4q,n,o,s,function(n,t,u,e){if(u)for(var o=0;o<u.length;o++){var s=i.$13C(u[o]);s.get_$20().AttachmentType===1&&Array.add(f,s.get_$1y())}e&&r(f)},_e.$1f.$Zb(u))};_e.$4q.$7bA=function(n,t,i,r,u){return new AttachmentInfoRecord(n.AttachmentId.Id,"InlineAttachmentId",n.Size,_a.$7.get_utcNow().$5R(),t,u?1:0,i,r)};_e.$4q.$7rh=function(n,t){var i;i=n!==1||t?n===1&&t?1:n||t?3:2:0;return i};_e.$4q.$6Lq=function(n,t,i,r){var u=100;t.$Dd(u,function(u,f,e){for(var o=0;o<f.length;++o){var s=n.$13C(f[o]);Array.add(i,s.get_$20())}f.length>0&&_e.$4q.$6Lq(n,t,i,r)},r)};_e.$4q.prototype={get_$i1:function(){return _e.$1I.get_$I().$19r},$A22:function(n){_a.$4.$1G(n.AttachmentId,"AttachmentId");_a.$4.$1G(n.DataID,"DataID");_a.$4.$1G(n.MessageID,"MessageID");_a.$4.$1G(n.MessageReceivedDateTime,"MessageReceivedDateTime");_a.$4.$J(n.AttachmentType,"AttachmentType");if(n.LastAccessedDateTime<=0)throw Error.argument("LastAccessedDateTime","LastAccessedDateTime must be set to a valid value");},$7ne:function(n){return _e.$1h.$5f(n.AttachmentId)},$7ni:function(n){return new AttachmentInfoMetadata(_e.$4q.$7rh(n.AttachmentType,n.Synced))}};function AttachmentInfoMetadata(n){AttachmentInfoMetadata.initializeBase(this);_a.$4.$J(n,"attachmentTypeAndSyncStatus");this.AttachmentTypeAndSyncStatus=n}AttachmentInfoMetadata.prototype={AttachmentTypeAndSyncStatus:0};_e.$tm=function(n,t){_e.$tm.initializeBase(this,[n,t])};_e.$tm.prototype={$5Pd:function(n,t,i){_e.$4q.$5Pd(n,this,t,i)},$5Hr:function(n){_e.$4q.$5Hr(n,this)},$6QF:function(n,t,i){_e.$4q.$6QF(n,this,t,i)},$6P3:function(n,t,i){_e.$4q.$6P3(n,this,t,i)}};_e.$F5=function(n){this.$1ry={};_a.$4.$J(n,"eventAggregator");this.$M=n};function $6yM(n){var t=n.$1ry;for(var i in t){var r={key:i,value:t[i]};var u=r.value;delete n.$1ry[u.get_$uD().toLowerCase()]}}function $1JC(n,t){n.$1ry[t.get_$uD().toLowerCase()]=t}_e.$F5.prototype={$M:null,$IU:function(n,t){_a.$4.$J(n,"clientStore");_a.$4.$J(n.get_$127(),"database");_a.$4.$1G(t,"timeZoneId");this.$18g(n.get_$127());this.$8GV(n,t);var i=this.$1ry;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.$IU()}},$18g:function(n){_a.$4.$J(n,"offline store");var t=this.$1ry;for(var i in t){var r={key:i,value:t[i]};var u=r.value;u.$18g()}$6yM(this)},$8GV:function(n,t){var i=new _e.$Tt(n,t);$1JC(this,new _e.$bk(n,i,t,this.$M));$1JC(this,new _e.$rz(n,i,t,this.$M));$1JC(this,new _e.$Sf(n,i,t,this.$M));$1JC(this,new _e.$UY(n,i,t,this.$M));$1JC(this,new _e.$1A3(n,i,t,this.$M));$1JC(this,new _e.$19R(n,i,t,this.$M));$1JC(this,new _e.$131(n,i,t,this.$M));$1JC(this,new _e.$UP(n,i,t,this.$M))}};_e.$LZ=function(n){this.$1Sk=new(_0365f.$o.$$(String));_a.$4.$J(n,"emailCleanupContext");this.$7I=n};function $6z8(n,t,i){var r=this;n.get_$3Qh().$Fy(t,_e.$1h.$5f(n.$7I.$3jH),function(r){if(r){n.$5DK=r.get_$20();var u=t.$Dg(_e.$1I.get_$I().$i3.get_$1L());var f=new _a.$8J(null,null);u.$It(f,function(r){r.$B(function(n){},null);var u=[];$4og(n,t,r,u,i)},null)}else i()},null)}function $4og(n,t,i,r,u){var f=this;i.$Dd(100,function(f,e,o){for(var s=0;s<e.length;++s){var h=n.get_$3jL().$13C(e[s]);var c=h.get_$20();var l=c.ConversationId.Id;if($6z9(n,c))if(n.$7I.$Cc.get_$2Wv()<50){n.$1Sk.$D(l);var a;(a=n.$7I.$Cc).set_$2Wv(a.get_$2Wv()+1);Array.add(r,h.get_$1y())}else{var v;(v=n.$7I.$Cc).set_$3Ef(v.get_$3Ef()+1)}else n.$7I.$2E0.set_$3q(l,!0)}if(e.length===100)$4og(n,t,i,r,u);else{_js.Trace.logInfo(_a.$0.$5a,"Number of conversations left uncleaned in this batch is {0}",n.$7I.$Cc.get_$3Ef());n.get_$3jL().$7iA(t,r);u()}},null)}function $6z9(n,t){var i=n.get_$7Zw().get_$3q(t.FolderId.Id);return $6(i)||_a.$7.$42(t.LastDeliveryTime).$5R()<i}function $6z7(n,t,i){var r=[];var u=this,f=this;n.get_$4ax().$5Mp(t,"ConversationItem",r,function(t){if(!n.$1Sk.$7G(t.Id)&&!n.$7I.$2E0.get_$3q(t.Id)){n.$7I.$Cc.set_$2Wy(n.$7I.$Cc.get_$2Wy()+1);n.$1Sk.$D(t.Id)}},function(){if(!n.$1Sk.get_$B()){i();return}for(var u=0,r=0;r<n.$1Sk.get_$B();r++)n.get_$5DE().$Fy(t,_e.$1h.$5f(n.$1Sk.get_$3q(r)),function(r){u++;if(r&&!n.$7I.$2E0.get_$3q(r.get_$20().ConversationId.Id)){for(var l=r.get_$20(),o=l.ConversationNodes,a=o.length,f=0;f<a;++f)for(var s=o[f],e=0;e<s.Items.length;e++){var h=s.Items[e];n.$7I.$2SL.set_$3q(h.ItemId.Id,h)}var c;(c=n.$7I.$Cc).set_$3Ee(c.get_$3Ee()+1);r.$2Iu(t)}u===n.$1Sk.get_$B()&&i()},null)})}_e.$LZ.prototype={$7I:null,$5DK:null,$2pM:null,get_$7Zw:function(){if(!this.$2pM){this.$2pM=_a.$3n.$$(Number).$8A();var t=this.$5DK.ModuleSpecificContext;if(t)for(var i=t,u=i.length,n=0;n<u;++n){var r=i[n];this.$2pM.set_$3q(r.FolderId.Id,_a.$7.$42(r.OldestDeliveryTime).$5R())}}return this.$2pM},get_$3jL:function(){return this.$7I.$A8.get_$JM()},get_$5DE:function(){return this.$7I.$A8.get_$HP()},get_$3Qh:function(){return this.$7I.$A8.get_$oo()},get_$4ax:function(){return this.$7I.$A8.get_$4aw()},$2v3:function(n){_js.Trace.logInfo(_a.$0.$5a,"Starting full module conversation cleanup");this.get_$3jL().$pk(n);this.get_$5DE().$pk(n);this.get_$3Qh().$Ht(n,_e.$1h.$5f(this.$7I.$3jH))},$4N2:function(n,t){_js.Trace.logInfo(_a.$0.$5a,"Starting periodic conversation cleanup");var i=this;$6z8(this,n,function(){i.$7I.$Cc.set_$2ei(_e.$CM.get_$1ru()-i.$7I.$1Xp);_js.Trace.logInfo(_a.$0.$5a,"Completed cleaning conversations, number cleaned = {0}, time taken = {1} ms",i.$7I.$Cc.get_$2Wv(),i.$7I.$Cc.get_$2ei());$6z7(i,n,function(){i.$7I.$Cc.set_$3RE(_e.$CM.get_$1ru()-(i.$7I.$1Xp+i.$7I.$Cc.get_$2ei()));_js.Trace.logInfo(_a.$0.$5a,"Completed cleaning conversation nodes, number cleaned = {0}, time taken = {1} ms",i.$7I.$Cc.get_$3Ee(),i.$7I.$Cc.get_$3RE());t()})})}};function CustomSyncData(n,t){this.IsDataSynced=n;this.ItemShape=t}CustomSyncData.prototype={IsDataSynced:null,ItemShape:0};_e.$4R=function(n){_e.$4R.initializeBase(this,[1,"EmailCleanup"]);$1M(this,_e.$4R.$5Ar,_a.$iC.toString(n))};_e.$4R.prototype={get_$3Rg:function(){return this.$U(_e.$4R.$4b6)||0},set_$3Rg:function(n){$1M(this,_e.$4R.$4b6,n);return n},get_$6be:function(){return this.$U(_e.$4R.$4b5)||0},set_$6be:function(n){$1M(this,_e.$4R.$4b5,n);return n},get_$2ei:function(){return this.$U(_e.$4R.$4aa)||0},set_$2ei:function(n){$1M(this,_e.$4R.$4aa,n);return n},get_$2Wv:function(){return this.$U(_e.$4R.$4I0)||0},set_$2Wv:function(n){$1M(this,_e.$4R.$4I0,n);return n},get_$3Ef:function(){return this.$U(_e.$4R.$4I1)||0},set_$3Ef:function(n){$1M(this,_e.$4R.$4I1,n);return n},get_$3RE:function(){return this.$U(_e.$4R.$4aZ)||0},set_$3RE:function(n){$1M(this,_e.$4R.$4aZ,n);return n},get_$3Ee:function(){return this.$U(_e.$4R.$4Hz)||0},set_$3Ee:function(n){$1M(this,_e.$4R.$4Hz,n);return n},get_$4aY:function(){return this.$U(_e.$4R.$4ab)||0},set_$4aY:function(n){$1M(this,_e.$4R.$4ab,n);return n},get_$1gs:function(){return this.$U(_e.$4R.$4I3)||0},set_$1gs:function(n){$1M(this,_e.$4R.$4I3,n);return n},get_$9vF:function(){return this.$U(_e.$4R.$4aX)||0},set_$9vF:function(n){$1M(this,_e.$4R.$4aX,n);return n},get_$67o:function(){return this.$U(_e.$4R.$4I2)||0},set_$67o:function(n){$1M(this,_e.$4R.$4I2,n);return n},get_$2Wy:function(){return this.$U(_e.$4R.$4I4)||0},set_$2Wy:function(n){$1M(this,_e.$4R.$4I4,n);return n}};_e.$14J=function(n,t,i,r,u,f,e,o,s){this.$2E0=_a.$3n.$$(Boolean).$8A();this.$2SL=_a.$3n.$$(_g.$7k).$8A();this.$2Ir=_a.$3n.$$(Boolean).$8A();_a.$4.$J(t,"itemStoreGetter");_a.$4.$1G(i,"converationSyncStateId");_a.$4.$1G(r,"messageSyncStateId");_a.$4.$J(u,"folderMappings");_a.$4.$J(f,"datapointTracker");_a.$4.$7t(e,0,2147483647,"syncMinimum");_a.$4.$7t(o,0,2147483647,"syncWindow");_a.$4.$J(s,"localStorageAdapter");this.$3i1=n;this.$A8=t;this.$3jH=i;this.$47V=r;this.$5Nx=u;this.$m6=f;this.$186=e;this.$2AV=o;this.$1dj=s;this.$Cc=new _e.$4R(n)};_e.$14J.prototype={$186:0,$2AV:0,$3i1:0,$3jH:null,$47V:null,$A8:null,$5Nx:null,$m6:null,$Cc:null,$1Xp:0,$1dj:null,$9sT:function(){this.$m6.get_$2n()&&this.$m6.$AN(this.$Cc)}};_e.$CM=function(n){_e.$CM.initializeBase(this);_a.$4.$J(n,"emailCleanupContext");this.$qN=n};_e.$CM.get_$1ru=function(){return _a.$7.get_$29().$5R()};_e.$CM.$A5K=function(n,t,i,r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];i.$Ht(t,o)}};function $6za(n,t){_js.Trace.logInfo(_a.$0.$5a,"Starting full module email cleanup because of cleanupType = {0}",_a.$iC.toString(n.$qN.$3i1));n.get_$5D8().$2v3(t);n.get_$5kc().$2v3(t);n.get_$56l().$2v3(t)}function $6zb(n,t){_js.Trace.logInfo(_a.$0.$5a,"Starting periodic email cleanup");n.$qN.$1Xp=_e.$CM.get_$1ru();var i=this;n.get_$5D8().$4N2(t,function(){n.get_$5kc().$4N2(t,function(){n.get_$56l().$4N2(t,n.$qN,function(){n.$qN.$Cc.set_$3Rg(_e.$CM.get_$1ru()-n.$qN.$1Xp);_js.Trace.logInfo(_a.$0.$5a,"Completed full cleanup (before transaction complete), time taken {0} ms",n.$qN.$Cc.get_$6be())})})})}_e.$CM.prototype={$qN:null,$3jI:null,$47O:null,$1pP:null,$1KA:null,$3yB:null,get_$5D8:function(){this.$3jI||(this.$3jI=new _e.$LZ(this.$qN));return this.$3jI},get_$5kc:function(){this.$47O||(this.$47O=new _e.$FU(this.$qN));return this.$47O},get_$7RK:function(){this.$1KA||(this.$1KA=this.$qN.$A8.get_$1K9());return this.$1KA},get_$86Q:function(){this.$3yB||(this.$3yB=this.$qN.$A8.get_$3y9());return this.$3yB},get_$56l:function(){this.$1pP||(this.$1pP=new _e.$mz(this.get_$7RK(),this.get_$86Q()));return this.$1pP},$6Hg:function(n){_a.$4.$J(n,"tx");switch(this.$qN.$3i1){case 2:$6zb(this,n);break;case 4:case 1:case 3:$6za(this,n);break;default:break}}};_e.$FU=function(n){this.$3rk=_a.$3n.$$(Boolean).$8A();_a.$4.$J(n,"emailCleanupContext");this.$7I=n};function $70R(n,t,i){var r=this;n.get_$3Qh().$Fy(t,_e.$1h.$5f(n.$7I.$47V),function(r){if(r){var u=_a.$1V.$A4v(MultiFolderSyncState,r.get_$20());n.$4Mx=u.PerFolderSyncStateContainer;var s=0;var f=[];var e=u.PerFolderSyncStateContainer;for(var o in e){var h={key:o,value:e[o]};Array.add(f,h.value)}$4pF(n,t,f,s,function(){$70T(n,t,function(){i()})})}else i()},null)}function $4pF(n,t,i,r,u){if(!i.length){u();return}var f=this;$70S(n,t,i[r],function(){var f=i[r].Id;n.$3rk.set_$3q(f,!0);r++;r===i.length?u():$4pF(n,t,i,r,u)})}function $70T(n,t,i){var r=[];var u=this,f=this;n.get_$4ax().$5Mp(t,"MessageItem",r,function(t){n.$7I.$Cc.set_$2Wy(n.$7I.$Cc.get_$2Wy()+1);n.$7I.$2SL.set_$3q(t.Id,t.Data)},function(){n.$7I.$2SL.$A3q(function(i,r){var u;var f,e;if(e=$4pG(n,r,f={val:u}),u=f.val,e){var o;(o=n.$7I.$Cc).set_$1gs(o.get_$1gs()+1);var s=_e.$1h.$5f(r.ItemId.Id);n.$7I.$2Ir.set_$3q(r.ItemId.Id,!0);n.get_$36H().$Ht(t,s)}});i()})}function $70S(n,t,i,r){_js.Trace.logInfo(_a.$0.$5a,"Starting to cleanup messages for folder {0}",i.Id);var u=i.Id;var f=t.$Dg(_e.$1I.get_$I().$xt.get_$1L());var e=new _a.$8k(MessageItemMetadata.$1Rm(),u);var o=new _a.$8J(e,[new _a.$IL(MessageItemMetadata.$29s(),0)]);var s=this;f.$It(o,function(i){var u=[];$4pE(n,t,i,u,function(){_e.$CM.$A5K(_bc.$Lx,t,n.get_$36H(),u);r()})},null)}function $4pE(n,t,i,r,u){var f=this;i.$Dd(10,function(f,e,o){for(var s=!1,h=0;h<e.length;++h){var l=n.get_$36H().$13C(e[h]);var c=l.get_$20();s=!1;var a,v;if(v=$4pG(n,c,a={val:s}),s=a.val,v){var y;(y=n.$7I.$Cc).set_$1gs(y.get_$1gs()+1);n.$7I.$2SL.$34(c.ItemId.Id);n.$7I.$2Ir.set_$3q(c.ItemId.Id,!0);Array.add(r,l.get_$1y())}if(!s)break}e.length===10&&n.$7I.$Cc.get_$1gs()<150&&s?$4pE(n,t,i,r,u):u()},null)}function $4pG(n,t,i){if(n.$7I.$5Nx.idToName(t.ParentFolderId)==="outbox"){i.val=!1;return!1}var u=n.$4Mx?n.$4Mx[t.ParentFolderId.Id]:null;var f=u?u.ModuleSpecificContext:null;var r;if(f){r=_a.$7.$42(t.DateTimeReceived).$5R()>=_a.$7.$42(f.OldestReceivedTime).$5R();i.val=!r}else{r=!1;i.val=!1}return!r&&!n.$7I.$2E0.$Mj(t.ConversationId.Id)&&!n.$3rk.$Mj(t.ParentFolderId.Id)}_e.$FU.prototype={$7I:null,$4Mx:null,get_$36H:function(){return this.$7I.$A8.get_$52()},get_$3Qh:function(){return this.$7I.$A8.get_$oo()},get_$4ax:function(){return this.$7I.$A8.get_$4aw()},$2v3:function(n){_js.Trace.logInfo(_a.$0.$5a,"Performing full module message cleanup");this.get_$36H().$pk(n);this.get_$3Qh().$Ht(n,_e.$1h.$5f(this.$7I.$47V))},$4N2:function(n,t){_js.Trace.logInfo(_a.$0.$5a,"Starting periodic message cleanup");var i=this;$70R(this,n,function(){i.$7I.$Cc.set_$4aY(_e.$CM.get_$1ru()-(i.$7I.$1Xp+i.$7I.$Cc.get_$2ei()+i.$7I.$Cc.get_$3RE()));_js.Trace.logInfo(_a.$0.$5a,"Completed cleaning messages, number cleaned = {0}, time taken = {1} ms",i.$7I.$Cc.get_$1gs(),i.$7I.$Cc.get_$4aY());t()})}};_e.$N1=function(n,t){_e.$N1.$$(this.$$gta["_e.$N1"].TItem,this.$$gta["_e.$N1"].TCreate).initializeBase(this);_a.$4.$J(n,"itemStore");_a.$4.$J(t,"creates");this.$Gt=n;this.$3l4=t};_e.$N1.$$=function(n,t){var i="$N1"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$N1"]={TItem:n,TCreate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$N1.apply(this,r)};u.registerClass("_e."+i,_e.$3V);var f=_e.$N1.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$N1.prototype={$Gt:null,$3l4:null,get_$5fi:function(){return this.$Gt},get_$A5J:function(){return this.$3l4},$6Hg:function(n){_a.$4.$J(n,"tx");this.$Gt.$pk(n);_e.$3V.$A4T(this.$$gta["_e.$N1"].TItem,this.$$gta["_e.$N1"].TCreate,this.$Gt,n,this.$3l4,null)}};_e.$bj=function(n,t){_e.$bj.initializeBase(this,[n,t])};_e.$bj.prototype={$2NT:function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"folderId");_a.$4.$7t(i,0,2147483647,"totalCount");_a.$4.$7t(r,0,2147483647,"unreadCount");var u=this;this.$Fy(n,_e.$1h.$5f(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$LV,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1V.$A4v(_g.$EA,u.get_$20());f.TotalCount+=i;f.UnreadCount+=r;u.$E7(n,null)},null)},$5HD:function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"folderId");_a.$4.$7t(i,0,2147483647,"totalCount");_a.$4.$7t(r,0,2147483647,"unreadCount");var u=this;this.$Fy(n,_e.$1h.$5f(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$LV,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1V.$A4v(_g.$EA,u.get_$20());f.TotalCount>=i?f.TotalCount-=i:_js.Trace.logError(_a.$0.$LV,"Folder {0} total count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.TotalCount);f.UnreadCount>=r?f.UnreadCount-=r:_js.Trace.logError(_a.$0.$LV,"Folder {0} unread count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.UnreadCount);u.$E7(n,null)},null)},$6du:function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"folderId");_a.$4.$7t(i,0,2147483647,"totalCount");_a.$4.$7t(r,0,2147483647,"unreadCount");var u=this;this.$Fy(n,_e.$1h.$5f(t.Id),function(t){if(t){var u=t.get_$20();!$6(i)&&i>=0?u.TotalCount=i:_js.Trace.logError(_a.$0.$LV,"Folder {0} total count is being updated to an invalid value {1}",u.DisplayName,i);u.__type===_g.$EA._dataContractName&&(!$6(r)&&r>=0?u.UnreadCount=r:_js.Trace.logError(_a.$0.$LV,"Folder {0} unread count is being updated to an invalid value {1}",u.DisplayName,r));t.$E7(n,null)}},null)},$7tu:function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"folderId");var r=this;this.$Fy(n,_e.$1h.$5f(t.Id),function(n){if(!n){_js.Trace.logWarning(_a.$0.$LV,"Folder with id {0} not found in client store",t.Id);return}var r=_a.$1V.$A4v(_g.$EA,n.get_$20());i(r.TotalCount,r.UnreadCount)},null)}};_e.$Tt=function(n,t){_a.$4.$J(n,"clientStore");_a.$4.$1G(t,"timeZoneId");this.$7F=n;this.$7e=t;var i=this;this.$2G=new(_0365f.$4D.$$(_bc.$17I))(function(){return new _e.$bj(i.$7F,i.$7e)});var r=this;this.$5Ns=new(_0365f.$4D.$$(_bc.$17H))(function(){return new _e.$TP(r.$7F,r.$7e)});var u=this;this.$2cB=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$xU)))(function(){return new(_e.$7j.$$(_bc.$xU,_e.$62))(u.$7F,u.$7e)});var f=this;this.$10O=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$q1)))(function(){return new(_e.$7j.$$(_bc.$q1,_e.$LI))(f.$7F,f.$7e)});var e=this;this.$3o=new(_0365f.$4D.$$(_bc.$16z))(function(){return new _e.$Qa(e.$7F,e.$7e)});var o=this;this.$3v=new(_0365f.$4D.$$(_bc.$17b))(function(){return new _e.$kF(o.$7F,o.$7e)});var s=this;this.$6G2=new(_0365f.$4D.$$(_bc.$182))(function(){return new _e.$1A4(s.$7F,s.$7e)});var h=this;this.$6bY=new(_0365f.$4D.$$(_bc.$18Y))(function(){return new _e.$10h(h.$7F,h.$7e)});var c=this;this.$56s=new(_0365f.$4D.$$(IAttachmentInfoItemStore))(function(){return new _e.$tm(c.$7F,c.$7e)});var l=this;this.$5Xt=new(_0365f.$4D.$$(IInlineImageItemStore))(function(){return new _e.$x4(l.$7F,l.$7e)});var a=this;this.$6k=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$jN)))(function(){return new(_e.$7j.$$(_bc.$jN,_e.$Oo))(a.$7F,a.$7e)});var v=this;this.$Bb=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$Lt)))(function(){return new(_e.$7j.$$(_bc.$Lt,_e.$5w))(v.$7F,v.$7e)});var y=this;this.$598=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$Kp)))(function(){return new(_e.$7j.$$(_bc.$Kp,_e.$Dh))(y.$7F,y.$7e)});var p=this;this.$5C7=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$pQ)))(function(){return new(_e.$7j.$$(_bc.$pQ,_e.$LW))(p.$7F,p.$7e)});var w=this;this.$6Gv=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$pt)))(function(){return new(_e.$7j.$$(_bc.$pt,_e.$2Q))(w.$7F,w.$7e)});var b=this;this.$54H=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$wJ)))(function(){return new(_e.$7j.$$(_bc.$wJ,_e.$11E))(b.$7F,b.$7e)});var k=this;this.$54I=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$wK)))(function(){return new(_e.$7j.$$(_bc.$wK,_e.$11F))(k.$7F,k.$7e)});var d=this;this.$6bC=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$jr)))(function(){return new(_e.$7j.$$(_bc.$jr,_e.$Q7))(d.$7F,d.$7e)});var g=this;this.$6Mk=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$XW)))(function(){return new(_e.$7j.$$(_bc.$XW,_e.$Aa))(g.$7F,g.$7e)});var nt=this;this.$6HT=new(_0365f.$4D.$$(_bc.$Bm.$$(_bc.$d5)))(function(){return new(_e.$7j.$$(_bc.$d5,_e.$Gm))(nt.$7F,nt.$7e)});var tt=this;this.$6I1=new(_0365f.$4D.$$(_bc.$184))(function(){return _e.$6H.$E(tt)})};_e.$Tt.prototype={$7F:null,$7e:null,$2G:null,$5Ns:null,$2cB:null,$10O:null,$3o:null,$3v:null,$6G2:null,$6bY:null,$56s:null,$5Xt:null,$6k:null,$Bb:null,$598:null,$5C7:null,$6Gv:null,$54H:null,$54I:null,$6bC:null,$6Mk:null,$6HT:null,$6I1:null,get_$5a:function(){return this.$7F},get_$2x:function(){return this.$2G.get_$1g()},get_$5Nt:function(){return this.$5Ns.get_$1g()},get_$6US:function(){return this.$2cB.get_$1g()},get_$oo:function(){return this.$10O.get_$1g()},get_$1K9:function(){return this.$56s.get_$1g()},get_$3y9:function(){return this.$5Xt.get_$1g()},get_$JM:function(){return this.$3o.get_$1g()},get_$HP:function(){return this.$6k.get_$1g()},get_$1k:function(){return this.$Bb.get_$1g()},get_$lc:function(){return this.$598.get_$1g()},get_$52:function(){return this.$3v.get_$1g()},get_$gd:function(){return this.$6G2.get_$1g()},get_$gn:function(){return this.$6Mk.get_$1g()},get_$4aw:function(){return this.$6bY.get_$1g()},get_$3ig:function(){return this.$5C7.get_$1g()},get_$6Gw:function(){return this.$6Gv.get_$1g()},get_$7OM:function(){return this.$54H.get_$1g()},get_$7ON:function(){return this.$54I.get_$1g()},get_$1lx:function(){return this.$6bC.get_$1g()},get_$4Mo:function(){return this.$6HT.get_$1g()},get_$1s:function(){return this.$6I1.get_$1g()},$BT:function(n,t,i,r){this.$7F.get_$127().$BT(n,t,i,r)}};_e.$xe=function(n){this.$7F=n};_e.$xe.prototype={$7F:null,$E:function(n){return new _e.$Tt(this.$7F,n)}};_e.$Xe=function(n,t,i){this.$1TE=1;_e.$Xe.$$(this.$$gta["_e.$Xe"].TItem,this.$$gta["_e.$Xe"].TUpdate).initializeBase(this);_a.$4.$J(n,"itemStore");_a.$4.$J(t,"updates");_a.$4.$J(i,"deletedIds");this.$Gt=n;this.$1VB=t;this.$1sC=i};_e.$Xe.$$=function(n,t){var i="$Xe"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$Xe"]={TItem:n,TUpdate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$Xe.apply(this,r)};u.registerClass("_e."+i,_e.$3V,_e.$xP);var f=_e.$Xe.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$Xe.prototype={$Gt:null,$1sC:null,$1VB:null,$12L:null,$33u:null,get_$A5L:function(){return this.$1TE},set_$A5L:function(n){this.$1TE=n;return n},get_$5IS:function(){return this.$12L?_0365f.$58.$B(this.$12L):0},get_$3Jm:function(){return this.$33u?this.$33u.length:0},get_$5fi:function(){return this.$Gt},get_$A5M:function(){return this.$1VB},set_$A5M:function(n){this.$1VB=n;return n},get_$A5N:function(){return this.$1sC},$6Hg:function(n){_a.$4.$J(n,"tx");this.$4N6(n,null)},$A5O:function(n){_a.$4.$9n(this.$1TE!==1&&!!this.$1TE,"This method should not be used to persist changes in sync code or service command");var t=this,r=this,i=this;this.$Gt.$BT(new _a.$6j("ItemSyncChangeUpdater.PersistChangesFromNonSyncSources",!1),function(n){t.$6Hg(n)},function(){_e.$1f.$kR(n)},function(n){_js.Trace.logWarning(_e.$1n.$A,"Unable to save non sync data to the clientStore. SaveMode={0}, error={1}",i.$1TE,n.$3v)})},$4N6:function(n,t){_a.$4.$J(n,"tx");var i=!1;var r=!1;var f=this;var u=function(){i&&r&&_e.$1f.$kR(t)};var e=this;_e.$3V.$A4U(this.$$gta["_e.$Xe"].TItem,this.$$gta["_e.$Xe"].TUpdate,this.$Gt,n,this.$1VB,function(){i=!0;u()},this.$1TE);var o=this;_e.$3V.$A4X(this.$$gta["_e.$Xe"].TItem,n,this.$Gt,this.$1sC,function(){r=!0;u()})},$9YM:function(n,t,i){this.$12L={};_e.$3V.$9YM(this.$$gta["_e.$Xe"].TItem,n,this.$Gt,t,this.$12L,i)},$9UF:function(n){if(this.$33u)for(var i=this.$33u,r=i.length,t=0;t<r;++t){var u=i[t];var f=this;_e.$3V.$A4V(this.$$gta["_e.$Xe"].TItem,this.$$gta["_e.$Xe"].TUpdate,this.$Gt,n,u,null,function(n){})}},$A5P:function(n){if(this.$1TE===1){var t=new _a.$Nf(_e.$y.$2av,10,1,0);this.$Gt.$1s9(n,t,null)}}};_e.$HX=function(){_e.$HX.initializeBase(this)};_e.$HX.$1ud=function(n){return n.OutboxItemContext};_e.$HX.$6T8=function(n,t,i,r){_js.Trace.logInfo(r,"SetOutboxItemActionId: ItemId {0} Action Id {1}",t.Id,i);n.$BT(new _a.$6j("OutboxItem.SetActionId",!1),function(u){n.$Fy(u,_e.$1h.$5f(t.Id),function(n){if(!n||!n.get_$20()){var f=String.format("Unable to set Action id. Outbox item {0} was not found in the client store",t.Id);_js.Trace.logError(r,f);throw Error.invalidOperation(f);}_js.Trace.logInfo(r,"SetOutboxItemActionId - Item found: {0}. Updating actionId={1}",t.Id,i);n.get_$Lh().ActionId=i;n.$E7(u,null)},null)},function(){},function(n){_e.$1f.$D6(n,function(n){_e.$HX.$823(n,t,i,r)})})};_e.$HX.$823=function(n,t,i,r){var u=String.format("Unable to set Action id. Error '{0}' ItemId {1} Action Id {2}",n.get_$52(),t.Id,i.toString());_js.Trace.logError(r,u);throw Error.invalidOperation(u);};_e.$HX.$2fT=function(n,t,i,r,u,f){_a.$4.$J(n,"transaction");_a.$4.$J(i,"outboxItemStore");_a.$4.$J(i,"outboxItemId");_js.Trace.logInfo(r,"UpdateOutboxItemContext: OutboxItem Id={0} responseCode={1} sendAction={2} ",i.Id,u,f);t.$Fy(n,_e.$1h.$5f(i.Id),function(t){if(!t){var e=String.format("Unable to update outbox context. Outbox item {0} was not found in the client store",i.Id);_js.Trace.logError(r,e);throw Error.invalidOperation(e);}if(f!==undefined){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating sendAction={1}.",i.Id,f);t.get_$Lh().SendAction=f}if(t.get_$Lh().LastResponseCode==="NoError"||u!=="ErrorInvalidIdMalformed"){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating responseCode={1}.",i.Id,u);t.get_$Lh().LastResponseCode=u}t.$E7(n,null)},null)};_e.$HX.prototype={get_$Lh:function(){return _e.$HX.$1ud(this.get_$20())},get_$i1:function(){return _e.$1I.get_$I().$25g},$85W:function(n,t,i,r){var u=new _bc.OutboxItemContext;u.SendAction=n;u.ParentConversationNodeId=t;u.ComplianceId=i;u.LastResponseCode=r;this.get_$20().OutboxItemContext=u},$9ag:function(){this.get_$20().OutboxItemContext=undefined}};_e.$1A4=function(n,t){_e.$1A4.initializeBase(this,[n,t])};_e.$1A4.prototype={get_$uD:function(){return _e.$1I.get_$I().$25g.get_$1L()},$6do:function(n,t,i,r){_e.$HX.$2fT(n,this,t,i,r)},$5Sz:function(n,t){var i=this;this.get_$A5h().$Fy(n,_e.$1h.$5f(this.get_$r()),function(n){var i=0;n&&(i=n.get_$20().TotalCount);t(i)},null)},$4Ot:function(n,t){for(var i=0;i<n.length;++i){var r=this.$13C(n[i]);var u=r.get_$20();Array.add(t,u)}_js.Trace.logInfo(_e.$1n.$A,"GetItems: Returning {0} results to the caller",t.length)}};_e.$Gm=function(){_e.$Gm.initializeBase(this)};_e.$Gm.$1am=function(n,t,i){_a.$4.$J(n,"peopleFilterItemStore");_a.$4.$J(t,"successCallback");_a.$4.$J(i,"errorCallback");var r=[];n.$BT(new _a.$6j("PeopleFilterItem.GetPeopleFilters"),function(t){var i=t.$Dg(_e.$1I.get_$I().$2YI.get_$1L());var u=new _a.$4o("Data.SortGroupPriority");var f=new _a.$8J(null,[new _a.$IL(u,0)]);i.$It(f,function(t){t.$Dd(100,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$13C(i[f]))},null)},null)},function(){t(r)},function(n){_e.$1f.$D6(n,i)})};function $3Xk(n,t){var i=_g.$28.$3p(t.FolderId);if(_g.$3S.isInstanceOfType(i)){var r=i;return r.Id}else if(_g.$Mn.isInstanceOfType(i)){var u=i;return u.Id}else throw Error.invalidOperation("unpexpected type for data.FolderId: "+i.__type);}_e.$Gm.prototype={get_$i1:function(){return _e.$1I.get_$I().$2YI},$3tD:function(){return $3Xk(this,this.get_$20())},$A22:function(n){_a.$4.$J(n.FolderId,"FolderId");var t=$3Xk(this,n);_a.$4.$1G(t,"Id")},$7ne:function(n){return _e.$1h.$5f($3Xk(this,n))},$7ni:function(n){return new ItemMetadata}};function PersistedDataRecord(){}PersistedDataRecord.prototype={Data:null,Metadata:null};_e.$y=function(){this.$$d_$2Iu=Function.createDelegate(this,this.$2Iu)};_e.$y.$qa=function(n,t,i,r){_a.$4.$J(t,"store");_a.$4.$J(i,"data");_a.$4.$1G(r,"dataTimeZoneId");var u=new n;u.$6dU(i);u.$1Cm(t,u.$9yP(i),i,r,r);return u};_e.$y.$13C=function(n,t,i,r){_a.$4.$J(t,"store");_a.$4.$J(i,"e");_a.$4.$J(r,"destinationTimeZoneId");return _e.$y.$A4P(n,t,i.$4s,i.$27,r)};_e.$y.$Fy=function(n,t,i,r,u,f){_a.$4.$J(i,"tx");_a.$4.$J(t,"store");_a.$4.$J(r,"id");_a.$4.$J(u,"destinationTimeZoneId");_a.$4.$J(f,"successCallback");var e=new n;var o=i.$Dg(e.get_$i1().get_$1L());_e.$y.$3ya(e,t,o,r,u,function(n){f(n)},null)};_e.$y.$7SO=function(n,t,i,r,u,f,e){_a.$4.$J(t,"store");_a.$4.$J(i,"tx");_a.$4.$J(r,"ids");_a.$4.$J(u,"destinationTimeZoneId");_a.$4.$J(f,"successCallback");for(var s=[],h=0,c=i.$Dg(_e.$y.$A4Q(n)),o=0;o<r.length;++o){var l=new n;_e.$y.$3ya(l,t,c,r[o],u,function(n){n&&Array.add(s,n);++h===r.length&&f(s)},function(n){e(n)})}};_e.$y.$1Ih=function(n,t,i,r,u,f){_a.$4.$J(t,"store");_a.$4.$J(i,"tx");_a.$4.$J(r,"id");_a.$4.$J(f,"updaterCallback");var e=new n;_e.$y.$87V(e,t,i,r,u,f)};_e.$y.$A4N=function(n,t,i,r){_a.$4.$J(t,"tx");_a.$4.$J(i,"id");_e.$y.$5YZ(t,i,_e.$y.$A4Q(n),r)};_e.$y.$1s9=function(n,t,i,r){_a.$4.$J(t,"tx");_a.$4.$J(i,"filter");var u=new(_0365f.$o.$$(_a.$Nn));_e.$y.$A4O(n,t,i,100,function(t,i,f,e){f.length&&u.$69(f);if(e){var h=n.getName();if(u.get_$B())for(var c=0,o=0;o<u.get_$B();o++){var s=u.get_$3q(o);i.$iD(s,function(){++c===u.get_$B()&&r&&r()},function(n){_js.Trace.logError(_e.$y.$A,"DeleteByFilterIn<{0}>: An error occured during deleting item #{1} (Id: {2}; Error: {3}-{4}).",h,o,s,n.$VZ,n.$3v)})}else r&&r()}},null)};_e.$y.$6LN=function(n,t,i,r,u,f){_a.$4.$J(t,"tx");if(r<1)throw Error.argumentOutOfRange("batchSize",r,"Batch size should be a positive integer.");var o=_e.$y.$A4Q(n);var e=t.$Dg(o);e.$It(i,function(n){_e.$y.$5fl(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$y.$A4O=function(n,t,i,r,u,f){_a.$4.$J(t,"tx");_a.$4.$J(i,"filter");var o=_e.$y.$A4Q(n);var e=t.$Dg(o);e.$3xH(i,function(n){_e.$y.$5fk(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$y.$pk=function(n,t){_a.$4.$J(t,"tx");_e.$y.$5YV(t,_e.$y.$A4Q(n))};_e.$y.$A4P=function(n,t,i,r,u){var f=new n;f.$1Cm(t,_e.$1h.$3sA(i),r.Data,_e.$1n.$7e,u);return f};_e.$y.$A4Q=function(n){var t=new n;return t.get_$i1().get_$1L()};_e.$y.$5YZ=function(n,t,i,r){var u=n.$Dg(i);u.$iD(t.$3Ra(),r,null)};_e.$y.$5fl=function(n,t,i,r){n.$Dd(t,function(u,f,e){i(u,f,e);e||_e.$y.$5fl(n,t,i,r)},r)};_e.$y.$5fk=function(n,t,i,r){n.$Dd(t,function(u,f,e){i(u,f,e);e||_e.$y.$5fk(n,t,i,r)},r)};_e.$y.$5YV=function(n,t){var i=n.$Dg(t);i.$1r(null,null)};_e.$y.$3ya=function(n,t,i,r,u,f,e){i.$3x(r.$3Ra(),function(i){var e=i;if(e){n.$1Cm(t,r,e.Data,_e.$1n.$7e,u);f(n)}else f(null)},function(n){_e.$1f.$D6(n,e)})};_e.$y.$87V=function(n,t,i,r,u,f){var e=i.$Dg(n.get_$i1().get_$1L());_e.$y.$3ya(n,t,e,r,u,function(n){var t=n?n.$10:null;f(t);n&&n.$E7(i,null)},null)};function $70N(n,t){var i;var r=new PersistedDataRecord;r.Data=n.$10;if(n.$7e!==t){i=_0365f.$58.$3p(r);n.$9yO(i.Data,n.$7e,t)}else i=r;return i}function $70O(n,t,i){var r=_a.$7.$Zp(_a.$7.get_utcNow());switch(i){case 1:_e.$y.$5ge.$28n(t,r);break;default:_e.$y.$5gZ.$28n(t,r);break}_e.$y.$2av.$28n(t,i)}function $70P(n,t){for(var e=n.get_$i1().get_$2NY(),s=e.length,u=0;u<s;++u)for(var h=e[u],o=h.$2KZ,c=o.length,f=0;f<c;++f){var i=o[f];var r=i.$5r.$1C8(t);if(r){if(Number.isInstanceOfType(r)){if(i.$AK!==1)throw Error.argumentType(i.$5r.$5r,Object.getType(r),Number);}else if(String.isInstanceOfType(r)&&i.$AK)throw Error.argumentType(i.$5r.$5r,Object.getType(r),String);}else i.$5r.$28n(t,_a.$ju.$7h4(i.$AK))}}_e.$y.prototype={$10:null,$7e:null,$6Y:null,$4s:null,get_$1y:function(){return this.$4s},get_$4cO:function(){return this.$10},$E7:function(n,t){this.$6dU(this.$10);this.$3Ln(n,0,t)},$2Iu:function(n){_a.$4.$J(n,"tx");_e.$y.$5YZ(n,this.$4s,this.get_$i1().get_$1L(),null)},$3Ln:function(n,t,i){_a.$4.$J(n,"tx");var r=$70N(this,_e.$1n.$7e);$70O(this,r,t);r.Metadata=this.$9yQ(r.Data);$70P(this,r);var u=n.$Dg(this.get_$i1().get_$1L());var f=this;u.$9YL(this.$4s.$3Ra(),r,function(n){_e.$1f.$A4S(_a.$pP,_e.$1h.$3sA(n),i)},null)},$1Cm:function(n,t,i,r,u){_a.$4.$J(n,"store");_a.$4.$J(i,"data");_a.$4.$J(t,"id");_a.$4.$1G(r,"sourceTimeZoneId");_a.$4.$1G(u,"destinationTimeZoneId");this.$6Y=n;this.$4s=t;this.$10=i;this.$7e=u}};_e.$t3=function(){_e.$t3.$$(this.$$gta["_e.$t3"].R).initializeBase(this)};_e.$t3.$$=function(n){var t="$t3"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$t3"]={R:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$t3.apply(this,i)};r.registerClass("_e."+t,_e.$y,_bc.$q4.$$(n),_bc.$17U);var u=_e.$t3.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$t3.prototype={get_$20:function(){return this.$10},$9yP:function(n){return this.$7ne(n)},$9yQ:function(n){return this.$7ni(n)},$6dU:function(n){this.$A22(n)},$9yO:function(n,t,i){this.$5AK(n,t,i)},$1Cm:function(n,t,i,r,u){_e.$y.prototype.$1Cm.call(this,n,t,i,r,u);this.$5AK(this.get_$20(),r,u)},$5AK:function(n,t,i){var u=this.$$gta["_e.$t3"].R;var f="changeTimeZone";var r=u[f];$6(r)||r(n,t,i,this.$6Y.get_$Ta())}};_e.$Aa=function(){_e.$Aa.initializeBase(this)};_e.$Aa.$wc=function(n,t,i,r,u,f){_a.$4.$J(n,"reminderItemStore");_a.$4.$J(u,"successCallback");_a.$4.$7t(t,_e.$Aa.$65S,_e.$Aa.$35t,"maxRemindersToReturn");_a.$4.$1G(r,"endTime");_js.$9.$a(i)&&(i=_a.$7.$EZ(new _a.$7(0,1,1)));if(_a.$7.$42(i).$2R(_a.$7.$42(r))>0)throw Error.argumentOutOfRange("beginTime","beginTime is greater than endTime");t||(t=_e.$Aa.$35t);var e=[];n.$BT(new _a.$6j("ReminderItem.GetReminders"),function(u){var s=u.$Dg(_e.$1I.get_$I().$1Sh.get_$1L());var o=_e.$Aa.$4QJ;var h=new _a.$Xf(o,n.$2vz(i),n.$2vz(r),0);var c=new _a.$8J(h,[new _a.$IL(o,0)]);s.$It(c,function(i){i.$Dd(t,function(t,i,r){for(var u=0;u<i.length;++u)Array.add(e,n.$13C(i[u]))},_e.$1f.$Zb(f))},_e.$1f.$Zb(f))},function(){u(e)},_e.$1f.$Zb(f))};_e.$Aa.prototype={get_$i1:function(){return _e.$1I.get_$I().$1Sh},$A22:function(n){_a.$4.$J(n.ItemId,"ReminderType.ItemId");_a.$4.$J(n.UID,"ReminderType.UID");_a.$4.$1G(n.ItemId.Id,"ReminderType.ItemId.Id");_a.$4.$1G(n.ReminderTime,"ReminderType.ReminderTime")},$7ne:function(n){return _e.$1h.$5f(n.ItemId.Id)},$7ni:function(n){return new ItemMetadata}};_e.$1h=function(n){this.$4s=new _a.$Nn(n)};_e.$1h.$5f=function(n){_a.$4.$1G(n,"id");return new _e.$1h(n)};_e.$1h.$5Ol=function(n){return new _e.$1h(n)};_e.$1h.$66i=function(){return new _e.$1h(null)};_e.$1h.$3sA=function(n){return new _e.$1h(n.$Tc())};_e.$1h.prototype={$4s:null,get_$1dL:function(){return this.$4s.$Tc()},$3Ra:function(){return this.$4s},toString:function(){return this.$4s.toString()}};_e.$GO=function(){_e.$GO.initializeBase(this)};_e.$GO.$40r=function(n){_a.$4.$J(n,"actionRecord");_a.$4.$J(n.request,"actionRecord.Request");return n.request.methodName!=="LogDatapoint"};_e.$GO.prototype={get_$i1:function(){return _e.$1I.get_$I().$10t},$7ne:function(n){return n.id?_e.$1h.$5Ol(n.id):_e.$1h.$66i()},$7ni:function(n){return new ActionItemMetadata(_e.$GO.$40r(n))},$A22:function(n){},$1Cm:function(n,t,i,r,u){var f=i;if(f.request.actionHandler){_js.Trace.logWarning(_a.$0.$ZJ,"An ActionItem with id={0} has an ActionHandler.  It is being removed.",t.get_$1dL());f=_0365f.$2t.$3p(f,!0);f.request.actionHandler=null}_e.$t3.prototype.$1Cm.call(this,n,t,f,r,u)}};function ActionItemMetadata(n){ActionItemMetadata.initializeBase(this);this.IsHighPriority=n.toString()}ActionItemMetadata.$40s=function(){return new _a.$4o("Metadata.IsHighPriority")};ActionItemMetadata.prototype={IsHighPriority:null};_e.$5m=function(){};_e.$5m.$7ay=function(n,t){var i=new AddressbookOperation;i.Type=n;i.PersonaId=t;return i};_e.$5m.$7cM=function(n){var t=_e.$5m.$5FF(n);var i=_e.$5m.$5PQ(n.AttributionsArray);var r=_e.$5m.$5MN([n.Emails1Array,n.Emails2Array,n.Emails3Array],i,["PersonaEmails1","PersonaEmails2","PersonaEmails3"]);r.length>0&&(t.Emails=r);var u=_e.$5m.$1ta([n.BusinessPhoneNumbersArray,n.BusinessPhoneNumbers2Array],i,["PersonaBusinessPhoneNumbers","PersonaBusinessPhoneNumbers2"]);u.length>0&&(t.BusinessPhoneNumbers=u);var f=_e.$5m.$1ta([n.HomePhonesArray,n.HomePhones2Array],i,["PersonaHomePhones","PersonaHomePhones2"]);f.length>0&&(t.HomePhoneNumbers=f);var e=_e.$5m.$1ta([n.MobilePhonesArray,n.MobilePhones2Array,n.CarPhonesArray],i,["PersonaMobilePhones","PersonaMobilePhones2","PersonaCarPhones"]);e.length>0&&(t.MobilePhoneNumbers=e);var o=_e.$5m.$1tb(n.BusinessAddressesArray,["PersonaBusinessAddresses"]);o.length>0&&(t.BusinessPostalAddresses=o);var s=_e.$5m.$1tb(n.HomeAddressesArray,["PersonaHomeAddresses"]);s.length>0&&(t.HomePostalAddresses=s);var h=_e.$5m.$1tb(n.OtherAddressesArray,["PersonaOtherAddresses"]);h.length>0&&(t.OtherPostalAddresses=h);return t};_e.$5m.$7az=function(n){var t=_e.$5m.$5FF(n);var i=_e.$5m.$5PQ(n.AttributionsArray);var r=_e.$5m.$5MN([n.Emails1Array,n.Emails2Array,n.Emails3Array],i,null);r.length>0&&(t.Emails=r);var u=_e.$5m.$1ta([n.BusinessPhoneNumbersArray,n.BusinessPhoneNumbers2Array],i,null);u.length>0&&(t.BusinessPhoneNumbers=u);var f=_e.$5m.$1ta([n.HomePhonesArray,n.HomePhones2Array],i,null);f.length>0&&(t.HomePhoneNumbers=f);var e=_e.$5m.$1ta([n.MobilePhonesArray,n.MobilePhones2Array,n.CarPhonesArray],i,null);e.length>0&&(t.MobilePhoneNumbers=e);var o=_e.$5m.$1tb(n.BusinessAddressesArray,null);o.length>0&&(t.BusinessPostalAddresses=o);var s=_e.$5m.$1tb(n.HomeAddressesArray,null);s.length>0&&(t.HomePostalAddresses=s);var h=_e.$5m.$1tb(n.OtherAddressesArray,null);h.length>0&&(t.OtherPostalAddresses=h);return t};_e.$5m.$54J=function(n){_a.$4.$J(n,"persona");_a.$4.$J(n.PersonaId,"persona.PersonaId");_a.$4.$1G(n.PersonaId.Id,"persona.PersonaId.Id");return n.PersonaId.Id};_e.$5m.$5FF=function(n){_a.$4.$J(n,"persona");var t=new AddressbookPersona;t.PersonaId=_e.$5m.$54J(n);$6(n.GivenName)||(t.FirstName=n.GivenName);$6(n.YomiFirstName)||(t.YomiFirstName=n.YomiFirstName);$6(n.MiddleName)||(t.MiddleName=n.MiddleName);$6(n.Surname)||(t.LastName=n.Surname);$6(n.YomiLastName)||(t.YomiLastName=n.YomiLastName);$6(n.DisplayNamePrefix)||(t.NamePrefix=n.DisplayNamePrefix);$6(n.Generation)||(t.NameSuffix=n.Generation);$6(n.Nickname)||(t.Nickname=n.Nickname);$6(n.DisplayName)||(t.DisplayName=n.DisplayName);$6(n.CompanyName)||(t.CompanyName=n.CompanyName);return t};_e.$5m.$5PQ=function(n){var t=new(_0365f.$o.$$(String));if(!n)return t;for(var i=0;i<n.length;i++){var r=n[i];(r.DisplayName==="Facebook"||r.DisplayName==="LinkedIn")&&t.$D(r.Id)}return t};_e.$5m.$A4M=function(n,t,i,r){for(var o=[],u=0,s=t,a=s.length,f=0;f<a;++f){var h=s[f];if($6(h)){u++;continue}for(var c=h,v=c.length,e=0;e<v;++e){var l=c[e];$6(l)||i(l,o,u)}u++}return o};_e.$5m.$5MN=function(n,t,i){return _e.$5m.$A4M(_g.$Bg,n,function(n,r,u){if(!$6(n.Value)&&!_js.$9.$18(n.Value.EmailAddress))for(var f=0;f<n.Attributions.length;f++)if(!t.$7G(n.Attributions[f]))if(i){var e=new AddressbookEmailAddressInfo;e.EmailAddress=_g.$2L.$qe(n.Value);e.EmailAddressProperty=i[u];r[r.length]=e;break}else{r[r.length]=_g.$2L.$qe(n.Value);break}},i)};_e.$5m.$1ta=function(n,t,i){return _e.$5m.$A4M(_g.$5L,n,function(n,r,u){if(!$6(n.Value)&&!_js.$9.$18(n.Value.Number))for(var e=0;e<n.Attributions.length;e++)if(!t.$7G(n.Attributions[e]))if(i){var f=new AddressbookPhoneNumberInfo;f.PhoneNumber=n.Value.Number;f.PhoneNumberProperty=i[u];f.PhoneNumberType=_e.$5m.$7wS(i[u]);r[r.length]=f;break}else{r[r.length]=n.Value.Number;break}},i)};_e.$5m.$1tb=function(n,t){return _e.$5m.$A4M(_g.$Es,[n],function(n,i,r){if(!$6(n.Value)){var f=new AddressbookPostalAddress;var u=n.Value;$6(u.State)||(f.State=u.State);$6(u.City)||(f.City=u.City);$6(u.Street)||(f.Street=u.Street);$6(u.Country)||(f.Country=u.Country);$6(u.PostalCode)||(f.PostalCode=u.PostalCode);if(t){var e=new AddressbookPostalAddressInfo;e.PostalAddress=f;e.PostalAddressProperty=t[r];e.PostalAddressType=_e.$5m.$7wb(t[r]);i[i.length]=e}else i[i.length]=f}},t)};_e.$5m.$7wS=function(n){switch(n){case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return 3;case"PersonaHomePhones":case"PersonaHomePhones2":return 1;case"PersonaCarPhones":return 9;case"PersonaMobilePhones":case"PersonaMobilePhones2":return 2;default:return 2}};_e.$5m.$7wb=function(n){switch(n){case"PersonaHomeAddresses":return 1;case"PersonaBusinessAddresses":return 2;case"PersonaOtherAddresses":return 3;default:return 3}};_e.$11E=function(){_e.$11E.initializeBase(this)};_e.$11E.prototype={get_$i1:function(){return _e.$1I.get_$I().$2EH},$7ne:function(n){return _e.$1h.$66i()},$7ni:function(n){return new ItemMetadata},$A22:function(n){_a.$4.$l(n,"data");_a.$4.$1G(n.PersonaId,"data.PersonaId");_a.$4.$l(n.Type,"data.Type");_a.$4.$ou(n.Type,0,"data.Type is invalid")}};_e.$11F=function(){_e.$11F.initializeBase(this)};_e.$11F.prototype={get_$i1:function(){return _e.$1I.get_$I().$2EI},$7ne:function(n){return _e.$1h.$5f(n.PersonaId)},$7ni:function(n){return new ItemMetadata},$A22:function(n){_a.$4.$l(n,"data");_a.$4.$1G(n.PersonaId,"data.PersonaId")}};_e.$OV=function(){};function $3XU(n,t,i,r,u,f){_js.$9.$a(t.PersonaId.Id)||n.$9XU(t,i,r,u,f)}function $6yE(n,t){if(_js.$9.$a(t.PersonaId.Id))return!1;for(var u=_g.$28.$Bi("contacts").Id,r=t.FolderIds,f=r.length,i=0;i<f;++i){var e=r[i];if(e.Id===u)return!0}return!1}_e.$OV.prototype={$9Mb:function(n,t,i,r){_a.$4.$J(i,"addressbookOperationItemStore");_a.$4.$J(r,"addressbookPersonaItemStore");$6yE(this,n)?$3XU(this,n,t,i,r,1):$3XU(this,n,t,i,r,2)},$6A0:function(n,t,i,r){_a.$4.$J(i,"addressbookOperationItemStore");_a.$4.$J(r,"addressbookPersonaItemStore");$3XU(this,n,t,i,r,2)},$9XU:function(n,t,i,r,u){var f=_e.$5m.$7ay(u,n.PersonaId.Id);var e=i.$qa(f);e.$E7(t,null);if(u===2)r.$Ht(t,_e.$1h.$5f(_e.$5m.$54J(n)));else{var o=_e.$5m.$7az(n);var s=r.$qa(o);s.$E7(t,null)}}};_e.$oD=function(n,t,i,r,u,f){this.$$d_$16H=Function.createDelegate(this,this.$16H);this.$$d_$5U3=Function.createDelegate(this,this.$5U3);_a.$4.$J(n,"clientStore");_a.$4.$J(t,"getter");_a.$4.$1G(i,"timeZoneId");_a.$4.$J(u,"eventAggregator");this.$7F=n;this.$5Su=t;this.$7e=i;this.$4YQ=r;this.$M=u;this.$1Lv=f};_e.$oD.$$=function(n){var t="$oD"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$oD"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$oD.apply(this,i)};r.registerClass("_e."+t,null,_a.$175);var u=_e.$oD.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$oD.prototype={$7F:null,$5Su:null,$7e:null,$4YQ:!1,$M:null,$1Lv:0,$1sD:null,$Gt:null,get_$4YA:function(){return this.$7F},get_$3RG:function(){return this.$7e},$IU:function(){_js.Trace.logInfo(_a.$0.$Q4,"Subscribing to {0} DB notification handler callback",this.get_$uD());this.$7F.get_$127().$IU(this.get_$uD(),this.$$d_$5U3);this.$9se()},$18g:function(){_js.Trace.logInfo(_a.$0.$Q4,"Unsubscribing from {0} DB notification handler callback",this.get_$uD());this.$7F.get_$127().$18g(this.get_$uD());this.$9yN()},$7nv:function(n){return n},$9mL:function(n,t){return!1},$A4R:function(n){return this.$1sD[n.toString()]},$5U3:function(n,t,i){_a.$4.$1G(n,"objectStoreName");_a.$4.$J(t,"notificationData");_js.Trace.logInfo(_a.$0.$Q4,"{0} offline store genereated notification. Add Event Count: {1}. Update Event Count: {2}. Delete Event Count: {3}",this.get_$uD(),t.get_$lB().length,t.get_$lg().length,t.get_$12G().length);var r=this.$7nv(t);if(r.get_$5VN()){this.$M.$9Yf(_a.$ai,new _a.$ai(this.$1Lv));this.$9mL(i,r)&&this.$5PD(i,r);this.$4Vi_0(i)&&this.$7qk(r)}this.$5At()},$4Vi_0:function(n){return!n||n.$2vC},$5PD:function(n,t){_js.Trace.logInfo(_a.$0.$Q4,"{0} raise DbTransactionItemInfoEvent SyncInitiatorId: {1}.",this.get_$uD(),n.$1UW);var i=new _a.$ih(n.$1UW,t.get_$lB(),t.get_$lg());this.$M.$9Yf(_a.$ih,i)},$9se:function(){if(this.$4YQ&&!this.$Gt){_js.Trace.logInfo(_a.$0.$Q4,String.format("Subscribed to delete observation for store : {0}",this.get_$uD()));this.$Gt=this.$2vy(this.$5Su);this.$1sD={};this.$Gt.add_$6dS(this.$$d_$16H)}},$9yN:function(){_js.Trace.logInfo(_a.$0.$Q4,String.format("Unsubscribed to delete observation for store : {0}",this.get_$uD()));this.$4YQ&&this.$Gt&&this.$Gt.remove_$6dS(this.$$d_$16H);this.$5At()},$16H:function(n,t){if(this.$4Vi_0(t.get_$BT().get_$1IW())){var i=t.get_$3q();var r=this;n.$1mO(t.get_$BT(),i,function(n){n&&(r.$1sD[i.toString()]=n)},null)}},$5At:function(){this.$1sD&&_0365f.$58.$B(this.$1sD)>0&&(this.$1sD={})}};_e.$Sf=function(n,t,i,r){_e.$Sf.initializeBase(this,[n,t,i,!0,r,2])};function $3XZ(n,t,i){for(var e=i,h=e.length,u=0;u<h;++u){var f=e[u];var r=null;var o="";if(t==="RowDeleted"){var s=n.$A4R(f.$4s);if(!s){_js.Trace.logInfo(_a.$0.$Q4,String.format("Calendar item not present in client store with id: {0}",f.$4s.toString()));return}r=s.get_$20()}else{var c=f.$27;r=c.Data;_g.$6O.changeTimeZone(r,_e.$1n.$7e,n.get_$3RG(),n.get_$4YA().get_$Ta())}o=r.ParentFolderId.Id;_e.$2l.$7qQ(t,o,r)}}_e.$Sf.prototype={get_$uD:function(){return _e.$1I.get_$I().$vF.get_$1L()},$7qk:function(n){$3XZ(this,"RowAdded",n.get_$lB());$3XZ(this,"RowModified",n.get_$lg());$3XZ(this,"RowDeleted",n.get_$12G())},$9mL:function(n,t){return!!n&&n.$1uU},$2vy:function(n){return n.get_$1k()}};_e.$bk=function(n,t,i,r){_e.$bk.initializeBase(this,[n,t,i,!1,r,0])};function $4p2(n,t){for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];var o=e.$27;var i=o.Data;_e.$2l.$2vA(i.FolderId.Id,i.ParentFolderId.Id,"RowModified","clientStore",i.TotalCount,i.UnreadCount,n.get_$2cQ())}}_e.$bk.prototype={get_$uD:function(){return _e.$1I.get_$I().$131.get_$1L()},get_$2cQ:function(){return!1},$7qk:function(n){$4p2(this,n.get_$lB());$4p2(this,n.get_$lg())},$2vy:function(n){return n.get_$2x()}};_e.$rz=function(n,t,i,r){_e.$rz.initializeBase(this,[n,t,i,!1,r,1])};_e.$rz.$4Vi=function(n){return n.get_$lB().length>0||n.get_$lg().length>0||n.get_$12G().length>0};_e.$rz.prototype={get_$uD:function(){return _e.$1I.get_$I().$1Sh.get_$1L()},get_$2cQ:function(){return!0},$7qk:function(n){_e.$rz.$4Vi(n)&&_e.$2l.$2LG(this.get_$2cQ())},$2vy:function(n){return n.get_$gn()}};_e.$5w=function(){_e.$5w.initializeBase(this)};_e.$5w.$1MW=function(n){return _e.$5w.$5MO(n.ItemId)};_e.$5w.$5MO=function(n){return _e.$1h.$5f(n.Id)};_e.$5w.$7SN=function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"calendarItemStore");_a.$4.$J(i,"uid");var u=new _a.$8k(_e.$5w.$18d,i);var f=[new _a.$IL(_a.$4o.$4s,0)];var e=new _a.$8J(u,f);_e.$y.$6LN(_e.$5w,n,e,52,function(n,u,f,e){_js.Trace.logInfo(_e.$5w.$A,"BindMultipleByUidIn - Uid:{0}, Query results:{1}",i,f.length);for(var o=0;o<f.length;o++){var s=t.$13C(f[o]);r(s,!!(e&o===f.length-1))}},null)};_e.$5w.$58Z=function(n){var t=_a.$7.$42(n.Start);var i=_a.$7.$42(n.End);return Math.floor(i.$5z(t)/36e5)};function $4oX(n){var r=n.get_$1V4();var i=n.get_$y();var t=_a.$7.$42(i);if(r>0){t=t.$4F().$2o(r);i=_a.$7.$EZ(t)}n.$3d4=i;n.$3d6=t}_e.$5w.prototype={$2si:0,$3d4:null,$3d6:null,get_$28:function(){return this.get_$20().ParentFolderId.Id},get_$y:function(){return this.get_$20().Start},get_$3d5:function(){this.$3d4||$4oX(this);return this.$3d4},get_$54j:function(){this.$3d6||$4oX(this);return this.$3d6},get_$AW:function(){return this.$2si>24},get_$5fS:function(){return this.get_$AW()?Math.ceil(this.$2si/24):1},get_$18c:function(){return this.get_$20().UID},get_$1u:function(){return this.get_$20().End},get_$1V4:function(){return this.get_$20().unfoldedIndex},get_$5V:function(){return this.get_$20().IsAllDayEvent},get_$5K1:function(){return this.$2si},get_$i1:function(){return _e.$1I.get_$I().$vF},$A22:function(n){_a.$4.$J(n.ItemId,"ItemId");_a.$4.$J(n.ParentFolderId,"ParentFolderId");_a.$4.$J(n.UID,"UID");_a.$4.$1G(n.ItemId.Id,"ItemId.Id");_a.$4.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$4.$1G(n.Start,"Start");_a.$4.$1G(n.End,"End")},$7ne:function(n){return _e.$5w.$1MW(n)},$1Cm:function(n,t,i,r,u){this.$2si=_e.$5w.$58Z(i);_e.$t3.prototype.$1Cm.call(this,n,t,i,r,u)},$7ni:function(n){return new CalendarItemMetadata(_e.$5w.$58Z(n))}};function CalendarItemMetadata(n){CalendarItemMetadata.initializeBase(this);this.DurationInHours=n}CalendarItemMetadata.prototype={DurationInHours:0};_e.$Dh=function(){_e.$Dh.initializeBase(this)};_e.$Dh.$3fU=function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"calendarRecurrenceMasterItemStore");_a.$4.$J(i,"uid");_a.$4.$J(r,"successCallback");var u=n.$Dg(_e.$1I.get_$I().$1A7.get_$1L());var f=new _a.$8k(_e.$Dh.$18d,i);var e=new _a.$8J(f,null);u.$It(e,function(n){n.$Dd(2,function(n,i,u){if(i.length===1)r(t.$13C(i[0]));else{_a.$4.$7t(i.length,0,0,"UID should be unique.");r(null)}},null)},null)};_e.$Dh.$1MW=function(n){return _e.$1h.$5f(n.ItemId.Id)};_e.$Dh.prototype={get_$9xj:function(){return this.get_$20().UID},get_$i1:function(){return _e.$1I.get_$I().$1A7},$A22:function(n){_a.$4.$J(n.ItemId,"ItemId");_a.$4.$1G(n.ItemId.Id,"ItemId.Id");_a.$4.$J(n.UID,"UID")},$7ne:function(n){return _e.$Dh.$1MW(n)},$7ni:function(n){return new ItemMetadata}};_e.$5a=function(n){this.$6Y=n};function $4oU(n,t){return new _a.$Nf(_e.$5w.$2A4,t,1,0)}function $2ho(n,t,i,r,u){var f=this;n.$6Y.$BT(new _a.$6j("Calendar.QueryCalendarItemsInTransaction"),function(n){var r=n.$Dg(_e.$1I.get_$I().$vF.get_$1L());var f=[new _a.$IL(_e.$5w.$2A4,0)];var e=new _a.$8J(t,f);r.$It(e,i,u)},r,u)}function $6yO(n,t,i){for(var f=_a.$6.acss(_e.$5a.$A,"FindItems_MergeResults"),u=i,e=u.length,r=0;r<e;++r){var o=u[r];var s=this;_0365f.$F4.$2zT(t,o,function(n,t){var i=n.get_$y();var r=t.get_$y();return i.localeCompare(r)})}_a.$6.aces(f);return t}function $6yQ(n,t,i,r,u,f,e,o){var s=_a.$6.acss(_e.$5a.$A,"ReadCalendarViewShortDurationItems");var h=n.$6Y.$2vz(r);var c=_a.$7.$42(h);var l=c.$2EB(-25);var a=l.$99();var v=n.$6Y.$2vz(u);var y=new _a.$Xf(_e.$5w.$2A4,a,v,2);var p=[new _a.$IL(_e.$5w.$2A4,0)];var w=new _a.$8J(y,p);var b=new _e.$5a.$9m8(i,r,u);$4oV(n,t,w,b,f,e,o);_a.$6.aces(s)}function $6yP(n,t,i,r,u,f,e,o){var s=_a.$6.acss(_e.$5a.$A,"ReadCalendarViewLongDurationItems");var h=new _a.$Nf(_e.$5w.$2sj,25,1,0);var c=new _a.$8J(h,null);var l=new _e.$5a.$8HD(i,r,u);$4oV(n,t,c,l,f,e,o);_a.$6.aces(s)}function $4oV(n,t,i,r,u,f,e){var o=String.format("ReadCalendarViewItems_{0}",i.$7W.get_$U3().$5r);var s=_a.$6.acsa(_e.$5a.$A,o,!0);var h=this;t.$It(i,function(t){_a.$6.acea(s);$3XY(n,t,r,u,f,e)},e)}function $3XY(n,t,i,r,u,f){var e=_a.$6.acsa(_e.$5a.$A,"FindItems_ReadCalendarViewQueryResult_",!0);var o=this;t.$Dd(350,function(o,s,h){_js.Trace.logInfo(_e.$5a.$A,"resultSet.Length = "+s.length);if(s.length>0){var c=_a.$6.acss(_e.$5a.$A,"ProcessCalendarViewQueryResult_"+s.length);$3XX(n,s,i,r,u);_a.$6.aces(c)}_a.$6.acea(e);h||$3XY(n,t,i,r,u,f)},f)}function $3XX(n,t,i,r,u){for(var o=_a.$6.acss(_e.$5a.$A,"FindItem_ProcessCalendarViewQueryResult_"+t.length),f=0;f<t.length;f++){var e=$6yN(n,t[f],r);i.$8D8(e)&&Array.add(u,e)}_a.$6.aces(o)}function $6yN(n,t,i){var o=t.$27;var u=o.Data;var r=new _g.$6O;r.ItemId=u.ItemId;for(var s=i.AdditionalProperties,c=s.length,f=0;f<c;++f){var h=s[f];switch(h.FieldURI){case"ItemParentId":r.ParentFolderId=u.ParentFolderId;break;case"Sensitivity":r.Sensitivity=u.Sensitivity;break;case"AppointmentState":r.AppointmentState=u.AppointmentState;break;case"IsCancelled":r.IsCancelled=u.IsCancelled;break;case"IsSeriesCancelled":r.IsSeriesCancelled=u.IsSeriesCancelled;break;case"HasAttachments":r.HasAttachments=u.HasAttachments;break;case"LegacyFreeBusyStatus":r.FreeBusyType=u.FreeBusyType;break;case"CalendarItemType":r.CalendarItemType=u.CalendarItemType;break;case"Start":r.Start=u.Start;r.StartWallClock=u.StartWallClock;r.StartTimeZoneId=u.StartTimeZoneId;break;case"End":r.End=u.End;r.EndWallClock=u.EndWallClock;r.EndTimeZoneId=u.EndTimeZoneId;break;case"MyResponseType":r.ResponseType=u.ResponseType;break;case"IsAllDayEvent":r.IsAllDayEvent=u.IsAllDayEvent;break;case"EnhancedLocation":r.Location=u.Location;break;case"Organizer":r.Organizer=u.Organizer;break;case"AppointmentReplyTime":r.AppointmentReplyTime=u.AppointmentReplyTime;break;case"Subject":r.Subject=u.Subject;break;case"IsMeeting":r.IsMeeting=u.IsMeeting;break;case"UID":r.UID=u.UID;break;case"InstanceKey":r.InstanceKey=u.InstanceKey;break;case"ItemEffectiveRights":r.EffectiveRights=u.EffectiveRights;break;case"JoinOnlineMeetingUrl":r.JoinOnlineMeetingUrl=u.JoinOnlineMeetingUrl;break;case"ConversationId":r.ConversationId=u.ConversationId;break;case"CalendarIsResponseRequested":r.IsResponseRequested=u.IsResponseRequested;break;case"Categories":r.Categories=u.Categories;break;case"IsRecurring":r.IsRecurring=u.IsRecurring;break;case"IsOrganizer":r.IsOrganizer=u.IsOrganizer;break;default:throw Error.invalidOperation(String.format("Invalid calendar shape property URI: {0}",h.FieldURI));}}var e=new PersistedDataRecord;e.Data=r;e.Metadata=o.Metadata;var l=new _a.$f3(t.$4s,e);return n.$6Y.$13C(l)}_e.$5a.prototype={$6Y:null,$5Pr:function(n,t,i,r,u,f){_a.$4.$J(r,"shape");_a.$4.$Js(r.BaseShape,"IdOnly","shape.BaseShape");var l=this;var e=function(n){_e.$1f.$D6(n,f)};var o=[];var s=[];var h=this,c=this;this.$6Y.$BT(new _a.$6j("Calendar.GetCalendarView"),function(u){var f=u.$Dg(_e.$1I.get_$I().$vF.get_$1L());$6yP(h,f,n,t,i,r,s,e);$6yQ(h,f,n,t,i,r,o,e)},function(){u($6yO(c,o,s))},e)},$7vW:function(n,t,i,r){var e=new _a.$Nf(_e.$5w.$2sj,24,0,0);var s=this;var u=function(n){_e.$1f.$D6(n,r)};var f=[];var o=this,h=this;$2ho(this,e,function(i){var r=new _e.$5a.$3gg(n);$3XY(o,i,r,t,f,u)},function(){i(f)},u)},$7rA:function(n,t,i,r,u,f){_a.$4.$J(n,"calendarFolderId");_a.$4.$J(t,"initialDate");_a.$4.$J(r,"shape");_a.$4.$Js(r.BaseShape,"IdOnly","shape.BaseShape");_a.$4.$J(u,"successCallback");var c=this;var e=function(n){_e.$1f.$D6(n,f)};var o=[];var s=0;var h=this,l=this;$2ho(this,null,function(u){u.$B(function(n){s=n},e);var f=$4oU(h,t);u.$1jv(0,f,function(t){t&&u.$Dd(i,function(t,i,u){var f=new _e.$5a.$3gg(n);$3XX(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$7r9:function(n,t,i,r,u,f){_a.$4.$J(r,"shape");_a.$4.$Js(r.BaseShape,"IdOnly","shape.BaseShape");var c=this;var e=function(n){_e.$1f.$D6(n,f)};var o=[];var s=0;var h=this,l=this;$2ho(this,null,function(u){u.$B(function(n){s=n},e);u.$1U9(t,function(){u.$Dd(i,function(t,i,u){var f=new _e.$5a.$3gg(n);$3XX(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$9gB:function(n,t,i){_a.$4.$J(n,"date");_a.$4.$J(t,"successCallback");var r=-1;var e=this;var u=function(n){_e.$1f.$D6(n,i)};var f=this,o=this;$2ho(this,null,function(t){var i=$4oU(f,n);t.$1jv(0,i,function(n){r=t.get_$Iv()},u)},function(){t(r)},u)}};_e.$5a.$3gg=function(n){this.$2k=n};_e.$5a.$3gg.prototype={$2k:null,$8D8:function(n){return n.get_$28()===this.$2k&&this.$5Yl(n)},$5Yl:function(n){return!0}};_e.$5a.$A5I=function(n,t,i){_e.$5a.$A5I.initializeBase(this,[n]);this.$5hx=t;this.$5hw=i};_e.$5a.$A5I.prototype={$5hx:null,$5hw:null,$5Yl:function(n){return _e.$5a.$3gg.prototype.$5Yl.call(this,n)&&this.$8As(n)},$8As:function(n){var t=n.get_$1u().localeCompare(this.$5hx);var i=n.get_$y().localeCompare(this.$5hw);return t>0&&i<0||!t&&n.get_$y()===n.get_$1u()}};_e.$5a.$9m8=function(n,t,i){_e.$5a.$9m8.initializeBase(this,[n,t,i])};_e.$5a.$9m8.prototype={$5Yl:function(n){return _e.$5a.$A5I.prototype.$5Yl.call(this,n)&&n.get_$5K1()<25}};_e.$5a.$8HD=function(n,t,i){_e.$5a.$8HD.initializeBase(this,[n,t,i])};_e.$5a.$8HD.prototype={$5Yl:function(n){return _e.$5a.$A5I.prototype.$5Yl.call(this,n)&&n.get_$5K1()>=25}};_e.$127=function(n,t,i){_e.$127.initializeBase(this);_a.$4.$J(n,"calendarRecurrenceMasterItemStore");_a.$4.$J(t,"calendarItemStore");this.$599=n;this.$1A6=t;this.$6aO=i};_e.$127.prototype={$599:null,$1A6:null,$6aO:null,$6Hg:function(n){_a.$4.$J(n,"tx");this.$599.$pk(n);this.$1A6.$pk(n);this.$6aO.$Ht(n,_e.$1h.$5f("CalendarSyncState"))}};_e.$a0=function(n,t){_a.$4.$J(n,"calendarItemStore");_a.$4.$J(t,"calendarRecurrenceMasterStore");this.$1A6=n;this.$1qL=t};_e.$a0.$8A=function(n){_a.$4.$J(n,"itemStoreGetter");return new _e.$a0(n.get_$1k(),n.get_$lc())};_e.$a0.prototype={$1A6:null,$1qL:null,$5I9:function(n,t,i){var r=this;this.$5I5(n,t,function(t){t?r.$1qL.$2rM(n,t.get_$1y(),i):i()})},$5I5:function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"id");var r=this;this.$1qL.$Fy(n,t,function(t){if(t){var u=new _a.$8k(_e.$5w.$18d,t.get_$9xj());r.$1A6.$1s9(n,u,function(){_e.$1f.$A4S(_bc.$Kp,t,i)})}else _e.$1f.$A4S(_bc.$Kp,t,i)},null)}};_e.$Sp=function(n){_e.$Sp.$$(this.$$gta["_e.$Sp"].TItem).initializeBase(this);_a.$4.$J(n,"itemStore");this.$Gt=n};_e.$Sp.$$=function(n){var t="$Sp"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$Sp"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$Sp.apply(this,i)};r.registerClass("_e."+t,_e.$3V);var u=_e.$Sp.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$Sp.prototype={$Gt:null,$6Hg:function(n){_a.$4.$J(n,"tx");this.$Gt.$pk(n)}};_e.$1n=function(n,t,i,r){this.$3m9="owa_offline_db";this.$5p=new Sys.EventHandlerList;this.$5Gk=n;this.$zq=t;this.$5H5=i;this.$5B=r};function $6yd(n,t,i,r){var f=this;var u=function(n){r(new _e.$1f(n).$SQ())};var e=this;t.$9Rk(n.$3m9,n.$5Gk,function(t){t.get_$39()!==n.$mO().get_$39()?$6yg(n,t,function(){n.$3Lu=!0;$4od(n,t);$4oc(n,i,r)},u):$6yh(n,t,function(){$4od(n,t);$6yf(n,i,r)},u)},u)}function $6yh(n,t,i,r){for(var f={},h=t.get_$1RS(),e=0;e<h.length;++e)f[h[e]]=null;var u=new(_0365f.$o.$$(_e.$wn));var o=new(_0365f.$o.$$(_e.$wm));$6ya(n,t,f,u,o);for(var s=0;s<u.get_$B();++s)delete f[u.get_$3q(s).get_$1L()];var c=$6yZ(n,f);if(u.get_$B()||o.get_$B()||c.length){n.$3Lu=!0;var l=this;t.$3ha(n.$mO().get_$39(),$4ob(n),function(t){$6yX(n,t,o);$6yY(n,t,u);$6yW(n,t,c)},i,r)}else i()}function $4ob(n){return _e.$1I.$7TW(n.$mO(),n.$5B)}function $6ya(n,t,i,r,u){for(var e=_0365f.$58.$3p(i),h=n.$mO(),c=n.$mO().get_$1DT(),o=0;o<c.length;++o){var s=c[o];s.get_$1L()in e&&!$6ye(n,t,s)&&delete e[s.get_$1L()]}var l=e;for(var a in l){var v={key:a,value:l[a]};var f=h.$7xS(v.key);if(f){r.$7G(f)||r.$D(f);f.get_$1sM().$3ip(r,u)}else r.$D(new _e.$Ct(v.key,"obsolete",new Array(0),new Array(0),_e.$9F.$Q2,0,0,!1,new _e.$9C(h)))}}function $6ye(n,t,i){var r=!1;t.$7vl(i.get_$1L())!==i.get_$39()?r=!0:$6yb(n,t,i)&&(r=!0);return r}function $6yb(n,t,i){for(var s=!1,e=i.get_$1te(),h=e.length,u=0;u<h;++u){var r=e[u];var o=r.$2KU;var f=n.$5B.$3u(o);var c=Array.indexOf(t.get_$1oZ(),o)>=0;if(f!==c)if(!r.$3Jg&&f)return!0;else if(r.$3Jg!==1||f){if(r.$3Jg===2)return!0}else return!0}return s}function $6yY(n,t,i){for(var r=0;r<i.get_$B();++r){_js.Trace.logInfo(_e.$1n.$A,"removing object store {0}",i.get_$3q(r).get_$1L());t.$6NB(i.get_$3q(r).get_$1L())}}function $6yX(n,t,i){for(var u=0;u<i.get_$B();++u){var r=i.get_$3q(u);_js.Trace.logInfo(_e.$1n.$A,"removing item {0} from store {1}",r.get_$1y().get_$1dL(),r.get_$5fi().get_$1L());t.$Cl(r.get_$5fi().get_$1L(),r.get_$1y().$3Ra())}}function $6yW(n,t,i){for(var r=0;r<i.length;++r){_js.Trace.logInfo(_e.$1n.$A,"creating object store {0}",i[r].$1n);$4oa(n,i[r],t)}}function $6yZ(n,t){for(var r=[],i=0;i<n.$mO().get_$1DT().length;++i){var u=n.$mO().get_$1DT()[i];u.get_$1L()in t||Array.add(r,u)}return r}function $6yg(n,t,i,r){_js.Trace.logInfo(_e.$1n.$A,"Wiping db.  Actual version '{0}' not equal to desired version '{1}'",t.get_$39(),n.$mO().get_$39());var u=this;t.$6gf(function(){_js.Trace.logInfo(_e.$1n.$A,"Now changing the schema of the database.");t.$3ha(n.$mO().get_$39(),$4ob(n),function(t){for(var i=0;i<n.$mO().get_$1DT().length;++i)$4oa(n,n.$mO().get_$1DT()[i],t)},i,r)},r)}function $6yf(n,t,i){var r=_e.$AB.$2L8(n);var u=this;r.$7sj(function(r){if(_js.$9.$a(r))$4oc(n,t,i);else{n.$1w9=r;t()}},i)}function $4oc(n,t,i){n.$1w9=(_a.$7.get_$29().$5R().toString()+Math.random().toString().substr(2)).substr(0,32);var r=_e.$AB.$2L8(n);var u=this;$70i(r,n.$1w9,t,function(t){_js.Trace.logError(_e.$1n.$A,"Unexpected error setting the DatabaseId: {0}",t.message);n.$1w9=null;n.$6d6(function(){i(t)},function(n){_js.Trace.logError(_e.$1n.$A,"Failed to uninstall database after failing to set the database Id: {0}",n.message);i(Error.create(t.message+" "+n.message))})})}function $4oa(n,t,i){i.$7ds(t.get_$1L(),t.get_$39(),t.get_$84e()===1,t.get_$7SR());$6yU(n,t,i);$6yV(n,t,i)}function $6yU(n,t,i){for(var u=t.get_$2NY(),e=u.length,r=0;r<e;++r){var f=u[r];i.$5Eo(t.get_$1L()+"_"+f.$1n,t.get_$1L(),f.$2KZ)}}function $6yV(n,t,i){for(var e=t.get_$1te(),h=e.length,r=0;r<h;++r){var u=e[r];if(n.$5B.$3u(u.$2KU))for(var o=u.$2NX,c=o.length,f=0;f<c;++f){var s=o[f];i.$5Eo(t.get_$1L()+"_"+u.$2KU+"_"+s.$1n,t.get_$1L(),s.$2KZ)}}}function $4od(n,t){n.$i8=t;n.$7bM()}function $6yc(n){if(n.$i8){n.$1rz&&n.$1rz.$18g(n.$i8);n.$i8.$4cI()}n.$2Gv&&n.$2Gv.dispose();n.$2Gv=null;n.$1rz=null;n.$i8=null;n.$1w9=null;n.set_$fZ(!1)}_e.$1n.prototype={$5Gk:0,$5H5:null,$zq:null,$5B:null,$i8:null,$1w9:null,$1rz:null,$3zO:!1,$ov:null,$3Lu:!1,$2Gv:null,add_$2zw:function(n){this.$5p.addHandler("IsAvailable",n)},remove_$2zw:function(n){this.$5p.removeHandler("IsAvailable",n)},get_$fZ:function(){return this.$3zO},set_$fZ:function(n){if(n!==this.$3zO){this.$3zO=n;var t=this.$5p.getHandler("IsAvailable");t&&t(this.$3Lu)}return n},get_$127:function(){return this.$i8},get_$84b:function(){return this.$1w9},get_$Ta:function(){return this.get_$7Wi()},get_$7Wi:function(){this.$ov||(this.$ov=new _a.$9u);return this.$ov},get_$1qm:function(){return this.$2Gv},$ii:function(n){return _e.$1h.$5f(n)},$5hq:function(n,t,i,r){var u=this;_e.$Q7.$2M9(n,t,function(n){for(var r=new Array(n.length),t=0;t<n.length;t++)r[t]=n[t].get_$20();u.$ov.$2zC(r);_e.$1f.$kR(i)},r)},$3yS:function(n,t){_a.$4.$J(n,"succeededCallback");_a.$4.$J(t,"failedCallback");var r=this.$5Pk();_a.$4.$J(r,"Databases are not supported by this browser. Check UserAgent.OfflineSupported before calling Install.");this.$3Lu=!1;var i=this,u=this;$6yd(this,r,function(){i.set_$fZ(!0);i.$ov=new _a.$9u;var r=new(_e.$7j.$$(_bc.$jr,_e.$Q7))(i,_e.$1n.$7e);r.$BT(new _a.$6j("ClientStore.Install.LoadTimeZones"),function(n){var t=n.$Dg(i.$mO().get_$9vI().get_$1L());i.$5hq(r,n,function(){_js.Trace.logInfo(_e.$1n.$A,"The time zone offsets table has been loaded")},function(n){_js.Trace.logError(_e.$1n.$A,"Failed to load the time zone offsets table: {0}",n.get_$52())})},function(){n()},function(n){var r=Error.create(n.$3v);_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Install: {0}",r.message);i.$c1();t(r)})},function(n){_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Install: {0}",n.message);u.$c1();t(n)})},$6d6:function(n,t){_a.$4.$J(n,"succeededCallback");_a.$4.$J(t,"failedCallback");var i=this.$5Pk();if(this.$i8){this.$i8.$4X();this.$i8=null}var r=this,u=this;i.$7hP(this.$3m9,function(){r.$c1();n()},function(n){_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Uninstall: {0}",n.$3v);t(new _e.$1f(n).$SQ())})},$c1:function(){_js.Trace.logInfo(_e.$1n.$A,"Disposing the current database, without wiping data.");$6yc(this)},$9sW:function(n,t){_a.$4.$1G(n,"timezoneId");_a.$4.$J(t,"eventAggregator");if(!this.$1rz){this.$1rz=new _e.$F5(t);this.$1rz.$IU(this,n)}},$5Pk:function(){return this.$5H5},$mO:function(){return this.$zq},$7bM:function(){this.$2Gv=new _e.$Sr(this.$mO().get_$7TL(),this.$i8)}};_e.$Sr=function(n,t){this.$$d_$1h5=Function.createDelegate(this,this.$1h5);this.$$d_$16H=Function.createDelegate(this,this.$16H);this.$$d_$1h4=Function.createDelegate(this,this.$1h4);this.$$d_$5U3=Function.createDelegate(this,this.$5U3);_e.$Sr.resolveInheritance();this.dispose=this.$1Q;_e.$Sr.initializeBase(this);this.$1A3={};this.$i8=t;this.$11T=n;$6yi(this)};function $6yi(n){n.$4YD=new Array(n.$11T.length);for(var t=0;t<n.$11T.length;t++){var i=n.$11T[t];n.$1A3[i]={};_js.Trace.logInfo(_a.$0.$1qm,"Subscribing DB notification and observer to store {0}",i);n.$i8.$IU(i,n.$$d_$5U3);var r=n.$i8.$5FC(i);n.$4YD[t]=r;r.add_$1h4(n.$$d_$1h4);r.add_$16H(n.$$d_$16H);r.add_$1h5(n.$$d_$1h5)}}function $4oe(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];t[e.$4s.toString()]=e.$27.Data}}_e.$Sr.prototype={$11T:null,$1A3:null,$4YD:null,$i8:null,$4c:function(){for(var n=0;n<this.$11T.length;n++){var i=this.$11T[n];this.$i8.$18g(i);var t=this.$4YD[n];t.remove_$1h4(this.$$d_$1h4);t.remove_$16H(this.$$d_$16H);t.remove_$1h5(this.$$d_$1h5);delete this.$1A3[i]}},$3c:function(n,t){var i=null;var r=this.$1A3[n];r&&(i=r[t]);return i},$2bk:function(n,t,i){var r=this.$1A3[n];r&&(r[t]=i)},$1h5:function(n,t){var i=n.$Z2;var r=this.$1A3[i];delete r[t.get_$1y().toString()]},$16H:function(n,t){var i=n.$Z2;var r=this.$1A3[i];delete r[t.get_$1y().toString()]},$1h4:function(n,t){_js.Trace.logInfo(_a.$0.$1qm,"Clearing cache: {0}, count: {2}",n.$Z2);this.$1A3[n.$Z2]={}},$5U3:function(n,t,i){var r=this.$1A3[n];$4oe(this,r,t.get_$lB(),n);$4oe(this,r,t.get_$lg(),n)}};_e.$1f=function(n){this.$9a=this.toString;this.$1py=n;if(n.$VZ===3){_js.Trace.logWarning(_e.$1n.$A,"QuotaError handled.");var t=_e.$1f.$3JR.getHandler(_a.$WH.toString(3));$6(t)||t()}};_e.$1f.add_$4KX=function(n){_e.$1f.$7OA(n)};_e.$1f.remove_$4KX=function(n){_e.$1f.$6NH(n)};_e.$1f.$A4S=function(n,t,i){i&&i(t)};_e.$1f.$kR=function(n){n&&n()};_e.$1f.$D6=function(n,t){var i=new _e.$1f(n);t&&t(i)};_e.$1f.$5EE=function(n){return function(t){n(t.$SQ())}};_e.$1f.$Zb=function(n){return function(t){_e.$1f.$D6(t,n)}};_e.$1f.$7OA=function(n){_e.$1f.$3JR.addHandler(_a.$WH.toString(3),n)};_e.$1f.$6NH=function(n){_e.$1f.$3JR.removeHandler(_a.$WH.toString(3),n)};_e.$1f.prototype={$1py:null,get_$52:function(){return this.$1py.$3v},get_$8Du:function(){return this.$1py.$VZ===4},get_$8Co:function(){return this.$1py.$VZ===3},$SQ:function(){var n=this;n.__type="clientStoreError";n.isTransientError=this.$1py.$VZ===4||this.$1py.$VZ===3;return Error.create(this.get_$52(),n)},toString:function(){return this.get_$52()}};_e.$LW=function(){_e.$LW.initializeBase(this)};_e.$LW.$3qa=function(n){_a.$4.$J(n,"id");_a.$4.$1G(n.Id,"id.Id");return _e.$1h.$5f(n.Id)};_e.$LW.$5AG=function(n,t,i,r){_g.$Cz.changeTimeZone(n,t,i,r)};_e.$LW.prototype={get_$i1:function(){return _e.$1I.get_$I().$1Y8},$7ne:function(n){return _e.$LW.$3qa(n.PersonaId)},$7ni:function(n){return new ItemMetadata},$A22:function(n){_a.$4.$J(n.PersonaId,"PersonaId");_a.$4.$1G(n.PersonaId.Id,"PersonaId.Id")},$5AK:function(n,t,i){_e.$LW.$5AG(n,t,i,this.$6Y.get_$Ta())}};_e.$131=function(n,t,i,r){_e.$131.initializeBase(this,[n,t,i,!1,r,6])};_e.$131.prototype={get_$uD:function(){return _e.$1I.get_$I().$i3.get_$1L()},$7qk:function(n){},$2vy:function(n){return n.get_$JM()}};_e.$Qa=function(n,t){_e.$Qa.initializeBase(this,[n,t])};_e.$Qa.$3u3=function(n,t){var i;i=t==="Clutter"?new _a.$8k(ConversationItemMetadata.$1Rl(),_e.$7f.$E(n,!0)):t==="NoClutter"?new _a.$8k(ConversationItemMetadata.$1Rl(),_e.$7f.$E(n,!1)):new _a.$8k(ConversationItemMetadata.$1Rm(),n);return i};_e.$Qa.prototype={$3jM:null,get_$uD:function(){return _e.$1I.get_$I().$i3.get_$1L()},$2rM:function(n,t,i){this.$5YY(n,t,!0,i)},$7iA:function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];this.$5YY(n,f,!1,null)}},$4co:function(n,t,i){_e.$6n.$4co(n,this,t,i)},$5Q5:function(n,t,i,r,u,f){_a.$4.$J(n,"folderId");_a.$4.$J(t,"request");_a.$4.$J(i,"actionContext");_a.$4.$J(r,"conversationViewData");_a.$4.$J(u,"successCallback");this.$3jM=r;var e=this;_e.$dN.prototype.$A5c.call(this,t.Paging,_e.$6n.get_$2zV(),function(){var i=_e.$Qa.$3u3(n,t.ClutterFilter);return new _a.$8J(i,[new _a.$IL(ConversationItemMetadata.$2Ql(),1)])},u,f)},$5Sz:function(n,t){t(this.$3jM.TotalConversationsInView)},$4Ot:function(n,t){_js.Trace.logInfo(_e.$1n.$A,"GetItems: Processing {0} query results",n.length);for(var r=this.$5Se(this.$3jM.OldestDeliveryTime),e=_a.$7.$42(r).$5R(),i=0;i<n.length;++i){var u=this.$13C(n[i]);var f=u.get_$20();var o=_a.$7.$42(f.LastDeliveryTime).$5R();if(o>=e)Array.add(t,f);else{_js.Trace.logInfo(_e.$1n.$A,"Ignoring items outside the sync window, lastDeliveryTime = {0}, oldestLastDeliveryTime = {1}",u.get_$20().LastDeliveryTime,r);break}}},$5YY:function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"id");if(i){var u=this;this.$Fy(n,t,function(i){if(i){var f=i.get_$20();var e=new _e.$10h(u.get_$4YA(),u.get_$3RG());var o=TombstonedItemRecord.$E(f.ConversationId.Id,"ConversationItem",null);var s=e.$qa(o);s.$E7(n,null)}_e.$7j.prototype.$2rM.call(u,n,t,r)},null)}else _e.$7j.prototype.$2rM.call(this,n,t,r)}};_e.$uq=function(n,t){_e.$uq.initializeBase(this,[n,"ConversationNodeSyncStateId"]);_a.$4.$7t(t,0,10,"maxDirtyConversationsToGet");this.get_$bV().$5jk=t};_e.$uq.prototype={$7fA:function(n){return new _e.$aL(this.$8y.get_$oo(),this.$8y.get_$JM(),this.$8y.get_$HP())}};_e.$1I=function(){this.$131=$6ys(this);this.$1UY=$6z0(this);this.$i3=$6yr(this);this.$2B6=$6z2(this);this.$2HR=$6yq(this);this.$xt=$6yu(this);this.$25g=$6yv(this);this.$10t=$6yj(this);this.$1Rq=$6yw(this);this.$1Y8=$6yp(this);this.$vF=$6yn(this);this.$1A7=$6yo(this);this.$2EH=$6yk(this);this.$2EI=$6yl(this);this.$2cC=$6yz(this);this.$2YI=$6yx(this);this.$1Sh=$6yy(this);this.$19r=$6ym(this);this.$2B2=$6z1(this);this.$2Np=$6yt(this);var n=$10n(this,"FolderHierarchySyncStateId");var t=$10n(this,"ConversationSyncStateId");var i=$10n(this,"MessageSyncStateId");var r=$10n(this,"RemindersSyncStateId");var u=$10n(this,"PeopleFiltersSyncStateId");var f=$10n(this,"PeopleSyncStateId");var e=$10n(this,"CalendarSyncState");var o=$10n(this,"TimeZoneOffsetsSyncStateId");var h=$10n(this,"OwaUserConfigurationSyncStateId");var s=$10n(this,"AttachmentsStateId");this.$131.$Lm.$IX(n).$3cX(1);this.$1UY.$Lm.$3cX(1);this.$i3.$Lm.$IX(t).$eT(this.$2HR).$eT(this.$19r).$eT(this.$xt).$eT(this.$2B6);this.$2B6.$Lm.$WN();this.$2HR.$Lm.$eT(this.$i3);this.$xt.$Lm.$IX(i).$eT(this.$19r).$eT(this.$i3).$eT(this.$2B6);this.$1Rq.$Lm.$eT(this.$1Y8);this.$1Y8.$Lm.$IX(f).$eT(this.$1Rq);this.$vF.$Lm.$IX(e).$eT(this.$1A7);this.$1A7.$Lm.$eT(this.$vF);this.$2EH.$Lm.$eT(this.$2EI);this.$2EI.$Lm.$eT(this.$2EH);this.$2cC.$Lm.$53O();this.$2B2.$Lm.$IX(o).$53O();this.$19r.$Lm.$IX(s).$eT(this.$2Np);this.$1Sh.$Lm.$IX(r);this.$2YI.$Lm.$IX(u);this.$2Np.$Lm.$WN();this.$25g.$Lm.$WN();this.$10t.$Lm.$WN();this.$1zI=[this.$1UY,this.$131,this.$i3,this.$2B6,this.$2HR,this.$xt,this.$25g,this.$10t,this.$1Rq,this.$1Y8,this.$vF,this.$1A7,this.$2EH,this.$2EI,this.$2cC,this.$2YI,this.$1Sh,this.$19r,this.$2B2,this.$2Np]};_e.$1I.get_$I=function(){return _e.$1I.$v||(_e.$1I.$v=new _e.$1I)};_e.$1I.$7TW=function(n,t){_a.$4.$J(n,"client store schema");_a.$4.$J(t,"flight manager");for(var f={},e=[],o=n.get_$1DT(),h=o.length,r=0;r<h;++r)for(var c=o[r],s=c.get_$1te(),l=s.length,u=0;u<l;++u){var a=s[u];var i=a.$2KU;if(t.$3u(i)&&!(i in f)){f[i]=null;Array.add(e,i)}}return e};function $6z0(n){return new _e.$Ct("Sync","15.0.0612.00",null,null,null,0,1,!0,new _e.$9C(n))}function $6ys(n){var i=[new _a.$5H(FolderItemMetadata.$1Rm(),0),new _a.$5H(FolderItemMetadata.$2uh(),1)];var r=[new _a.$5H(FolderItemMetadata.$2uh(),1)];var u=[new _a.$5H(FolderItemMetadata.$5JW(),0)];var t=[new _e.$6P("ParentId",i),new _e.$6P("FolderPosition",r),new _e.$6P("DistinguishedFolderId",u)];var f=new _e.$9F("SuperStart",t,2);return new _e.$Ct("Folders","15.0.0742.00",t,null,[f],0,1,!1,new _e.$9C(n))}function $6yr(n){var t=[new _a.$5H(ConversationItemMetadata.$1Rm(),0),new _a.$5H(ConversationItemMetadata.$2Ql(),0)];var i=[new _a.$5H(ConversationItemMetadata.$1Rl(),0),new _a.$5H(ConversationItemMetadata.$2Ql(),0)];var r=[new _a.$5H(_e.$6n.get_$2rv(),1),new _a.$5H(ConversationItemMetadata.$2Ql(),0)];var u=[new _a.$5H(_e.$6n.get_$2rv(),1)];var f=[new _a.$5H(_e.$6n.get_$3jJ(),0)];var e=[new _a.$5H(_e.$6n.get_$2zV(),0)];var o=[new _e.$6P("ParentIdDateTimeSort",t),new _e.$6P("ParentIdAndClutterDateTimeSort",i),new _e.$6P("DirtyState",r),new _e.$6P("DirtyStateIndexAloneField",u),new _e.$6P("ConversationId",f),new _e.$6P("InstanceKey",e),new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct("Conversations","15.0.0710.00",o,null,null,0,1,!1,new _e.$9C(n))}function $6z2(n){var t=[new _a.$5H(_e.$mO.get_$5fj(),0)];var i=[new _e.$6P("ItemType",t)];return new _e.$Ct("TombstonedItems","15.0.0503.00",i,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yq(n){var t=[new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct("ConversationNodes","15.0.0760.00",t,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yu(n){return $4of(n,"Messages",1)}function $6yv(n){return $4of(n,"Outbox",0)}function $4of(n,t,i){_a.$4.$1G("name",t);var r=[new _a.$5H(MessageItemMetadata.$1Rm(),0),new _a.$5H(MessageItemMetadata.$29s(),0)];var u=[new _a.$5H(MessageItemMetadata.$1Rl(),0),new _a.$5H(MessageItemMetadata.$29s(),0)];var f=[new _a.$5H(MessageItemMetadata.$5aU(),0),new _a.$5H(MessageItemMetadata.$29s(),0)];var e=[new _a.$5H(_e.$Bt.get_$2zV(),0)];var o=[new _e.$6P("DateTime",r),new _e.$6P("DateTimeAndClutter",u),new _e.$6P("IsDataSynced",f),new _e.$6P("InstanceKey",e),new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct(t,"15.0.0710.00",o,null,_e.$9F.$Q2,0,i,!1,new _e.$9C(n))}function $6yj(n){var t=[new _a.$5H(_e.$GO.$2dp,1)];var i=[new _a.$5H(ActionItemMetadata.$40s(),0)];var r=[new _e.$6P("State",t),new _e.$6P("IsHighPriority",i)];return new _e.$Ct("Actions","15.0.0526.00",r,null,null,1,0,!1,new _e.$9C(n))}function $6yw(n){var t=[new _a.$5H(_e.$2Q.$3I2,0)];var i=[new _a.$5H(_e.$2Q.$1u7,0)];var r=[new _a.$5H(_e.$2Q.$1BP,0)];var u=[new _a.$5H(_e.$2Q.$1M4,0)];var f=[new _a.$5H(_e.$2Q.$1u7,0),new _a.$5H(_e.$2Q.$1BP,0)];var e=[new _a.$5H(_e.$2Q.$1u7,0),new _a.$5H(_e.$2Q.$1M4,0)];var o=[new _a.$5H(_e.$2Q.$2oq,0),new _a.$5H(_e.$2Q.$1BP,0)];var s=[new _a.$5H(_e.$2Q.$2oq,0),new _a.$5H(_e.$2Q.$1M4,0)];var h=[new _a.$5H(_e.$2Q.$2yP,0),new _a.$5H(_e.$2Q.$1BP,0)];var c=[new _a.$5H(_e.$2Q.$2yP,0),new _a.$5H(_e.$2Q.$1M4,0)];var l=[new _a.$5H(_e.$2Q.$3UB,0),new _a.$5H(_e.$2Q.$1BP,0)];var a=[new _a.$5H(_e.$2Q.$3UB,0),new _a.$5H(_e.$2Q.$1M4,0)];var v=[new _a.$5H(_e.$2Q.$2q6,0),new _a.$5H(_e.$2Q.$1BP,0)];var y=[new _a.$5H(_e.$2Q.$2q6,0),new _a.$5H(_e.$2Q.$1M4,0)];var p=[new _a.$5H(_e.$2Q.$4Q6,1),new _a.$5H(_e.$2Q.$1BP,0)];var w=[new _a.$5H(_e.$2Q.$3o2,0)];var b=[new _a.$5H(_e.$2Q.$3o0,0)];var k=[new _e.$6P("PersonaId",t),new _e.$6P("FolderId",i),new _e.$6P("DisplayNameFirstLast",r),new _e.$6P("DisplayNameLastFirst",u),new _e.$6P("ActualLastFirst",w),new _e.$6P("ActualFirstLast",b),new _e.$6P("CompanyNameFirstLast",o),new _e.$6P("CompanyNameLastFirst",s),new _e.$6P("HomeCityFirstLast",h),new _e.$6P("HomeCityLastFirst",c),new _e.$6P("WorkCityFirstLast",l),new _e.$6P("WorkCityLastFirst",a),new _e.$6P("CreationTimeFirstLast",v),new _e.$6P("CreationTimeLastFirst",y),new _e.$6P("RelevanceScoreFirstLast",p),new _e.$6P("SaveMode",_e.$1I.$1TF),new _e.$6P("FolderIdDisplayNameFirstLast",f),new _e.$6P("FolderIdDisplayNameLastFirst",e)];return new _e.$Ct("PartialPersona","15.0.0692.00",k,null,null,0,1,!1,new _e.$9C(n))}function $6yp(n){var t=[new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct("CompletePersona","15.0.0692.00",t,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yn(n){var t=[new _a.$5H(_e.$5w.$2A4,0)];var i=[new _a.$5H(_e.$5w.$2sj,1)];var r=[new _a.$5H(_e.$5w.$3pV,0)];var u=[new _a.$5H(_e.$5w.$18d,0)];var f=[new _e.$6P("ShortDurationCalendarViewItemsIndices",t),new _e.$6P("LongDurationCalendarViewItemsIndices",i),new _e.$6P("PrunningFields",r),new _e.$6P("RecurrenceIndices",u),new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct("CalendarItem","15.0.0594.00",f,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yo(n){var t=[new _a.$5H(_e.$Dh.$18d,0)];var i=[new _e.$6P("RecurrenceIndices",t),new _e.$6P("SaveMode",_e.$1I.$1TF)];return new _e.$Ct("CalendarRecurrenceMaster","15.0.0594.00",i,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yk(n){return new _e.$Ct("AddressbookOperation","15.0.0239.00",null,null,_e.$9F.$Q2,1,1,!1,new _e.$9C(n))}function $6yl(n){return new _e.$Ct("AddressbookPersona","15.0.0239.00",null,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yz(n){return new _e.$Ct("Settings","15.0.0380.00",null,null,_e.$9F.$Q2,0,0,!1,new _e.$9C(n))}function $6yx(n){var t=new _a.$4o("Data.SortGroupPriority");var i=[new _a.$5H(t,1)];var r=[new _e.$6P("sortGroupPriorityIndex",i)];return new _e.$Ct("PeopleFilter","15.0.0441.00",r,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6ym(n){var t=[new _a.$5H(_e.$4q.$47Q,0)];var i=[new _a.$5H(_e.$4q.$47S,0)];var r=[new _a.$5H(_e.$4q.$3ee,1)];var u=[new _a.$5H(_e.$4q.$3ed,1)];var f=[new _a.$5H(_e.$4q.$3ed,1),new _a.$5H(_e.$4q.$47S,0)];var e=[new _e.$6P("messageIdFields",t),new _e.$6P("messageReceivedDateTimeFields",i),new _e.$6P("attachmentTypeFields",r),new _e.$6P("attachmentTypeAndSyncStatusFields",u),new _e.$6P("attachmentTypeAndSyncStatusByMessageRecievedDateTimeFields",f)];return new _e.$Ct("AttachmentInfo","15.0.0557.00",e,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6yy(n){var t=[new _a.$5H(_e.$Aa.$4QJ,0)];var i=[new _a.$5H(_e.$Aa.$18d,0)];var r=[new _e.$6P("ReminderTime",t),new _e.$6P("RecurrenceIndices",i)];return new _e.$Ct("Reminders","15.0.0575.00",r,null,_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $6z1(n){return new _e.$Ct("TimeZoneOffsets","15.0.0314.00",null,null,_e.$9F.$Q2,0,0,!1,new _e.$9C(n))}function $6yt(n){return new _e.$Ct("InlineImages","15.0.0557.00",null,[_e.$jZ.$57m],_e.$9F.$Q2,0,1,!1,new _e.$9C(n))}function $10n(n,t){return new _e.$18V(_e.$1h.$5f(t),n.$1UY,new _e.$9C(n))}_e.$1I.prototype={$1zI:null,$11T:null,$131:null,$1UY:null,$i3:null,$2B6:null,$2HR:null,$xt:null,$25g:null,$10t:null,$1Rq:null,$1Y8:null,$vF:null,$1A7:null,$2EH:null,$2EI:null,$2cC:null,$2YI:null,$1Sh:null,$19r:null,$2B2:null,$2Np:null,get_$39:function(){return _e.$1I.$Bx},get_$1DT:function(){return this.$1zI},get_$7TL:function(){if(!this.$11T){this.$11T=new Array(0);for(var t=this.$1zI,r=t.length,n=0;n<r;++n){var i=t[n];i.$5Zx&&Array.add(this.$11T,i.$1n)}}return this.$11T},get_$9vI:function(){return this.$2B2},$7xS:function(n){for(var t=0;t<this.$1zI.length;++t)if(this.$1zI[t].get_$1L().toLowerCase()===n.toLowerCase())return this.$1zI[t];return null}};_e.$9C=function(n){this.$2KH=new(_0365f.$o.$$(_e.$wn));this.$2KG=new(_0365f.$o.$$(_e.$wm));this.$1vM=new(_0365f.$o.$$(_e.$13t));this.$zq=n;this.$2ky=!1};function $6z6(n,t,i){if(n.$2ky)for(var u=n.$zq.get_$1DT(),f=u.length,r=0;r<f;++r){var e=u[r];$3Xc(n,e,t,i)}else{$6z3(n,t,i);$6z4(n,t,i)}}function $6z5(n,t,i){for(var r=0;r<n.$2KG.get_$B();++r){var u=n.$2KG.get_$3q(r);if(!i.$7G(u)){i.$D(u);u.get_$1sM().$3ip(t,i)}}}function $6z4(n,t,i){for(var r=0;r<n.$zq.get_$1DT().length;++r){var u=n.$zq.get_$1DT()[r];n.$1vM.$7G(u.get_$7iE())&&$3Xc(n,u,t,i)}}function $6z3(n,t,i){for(var r=0;r<n.$2KH.get_$B();++r){var u=n.$2KH.get_$3q(r);$3Xc(n,u,t,i)}}function $3Xc(n,t,i,r){if(!i.$7G(t)){i.$D(t);t.get_$1sM().$3ip(i,r)}}_e.$9C.prototype={$2KH:null,$2KG:null,$1vM:null,$zq:null,$2ky:!1,$eT:function(n){this.$2KH.$D(n);return this},$53O:function(){this.$2ky=!0;return this},$IX:function(n){this.$2KG.$D(n);return this},$WN:function(){this.$2KG.$1r();this.$2KH.$1r();this.$1vM.$1r();this.$2ky=!1},$3cX:function(n){if(!n)throw Error.invalidOperation("cannot add dependency on 'none'");this.$1vM.$D(n);return this},$3ip:function(n,t){$6z6(this,n,t);$6z5(this,n,t)}};_e.$TP=function(n,t){_e.$TP.initializeBase(this,[n,t])};function $3Xd(n,t,i){var r=this;t.$Dd(50,function(r,u,f){for(var e=0;e<u.length;++e)Array.add(i,n.$13C(u[e]));u.length>0&&$3Xd(n,t,i)},null)}_e.$TP.prototype={$7yF:function(n,t,i){_a.$4.$J(t,"successCallback");var r=[];var u=this,f=this,e=this;this.$BT(new _a.$6j("FolderHierarchy.GetSubfolders"),function(t){var i=t.$Dg(_e.$1I.get_$I().$131.get_$1L());var f=new _a.$8k(FolderItemMetadata.$1Rm(),n);var e=new _a.$8J(f,[new _a.$IL(FolderItemMetadata.$2uh(),0)]);i.$It(e,function(n){$3Xd(u,n,r)},null)},function(){t(r)},function(n){_e.$1f.$D6(n,i)})},$7rG:function(n,t){_a.$4.$J(n,"successCallback");var i=[];var r=this,u=this,f=this;this.$BT(new _a.$6j("FolderHierarchy.GetAllFolders"),function(n){var t=n.$Dg(_e.$1I.get_$I().$131.get_$1L());var u=new _a.$8J(null,[new _a.$IL(FolderItemMetadata.$2uh(),0)]);t.$It(u,function(n){$3Xd(r,n,i)},null)},function(){n(i)},function(n){_e.$1f.$D6(n,t)})}};_e.$8C=function(){_e.$8C.initializeBase(this)};_e.$8C.$7ng=function(n){_a.$4.$J(n,"id");_a.$4.$1G(n.Id,"id.Id");return _e.$1h.$5f(n.Id)};_e.$8C.$1MW=function(n){_a.$4.$J(n,"data");return _e.$8C.$7ng(n.FolderId)};_e.$8C.$1aP=function(n,t,i,r){_a.$4.$J(n,"folderItemStore");_a.$4.$J(i,"successCallback");var u=t;_a.$4.$1G(u,"distinguishedFolderId");var f=null;n.$BT(new _a.$6j("FolderItem.FromDistinguishedFolderId"),function(t){var i=t.$Dg(_e.$1I.get_$I().$131.get_$1L());var r=new _a.$8k(FolderItemMetadata.$5JW(),u);var e=new _a.$8J(r,null);i.$It(e,function(t){t.$Dd(2,function(t,i,r){i.length>0&&(f=n.$13C(i[0]))},null)},null)},function(){i(f)},function(n){_e.$1f.$D6(n,r)})};_e.$8C.$3tF=function(n){return n.__FolderPositionIndex};_e.$8C.$6Te=function(n,t){n.__FolderPositionIndex=t};_e.$8C.prototype={get_$i1:function(){return _e.$1I.get_$I().$131},$A22:function(n){_a.$4.$J(n.FolderId,"FolderId");_a.$4.$1G(n.FolderId.Id,"FolderId.Id");_a.$4.$J(n.ParentFolderId,"ParentFolderId");_a.$4.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$4.$l(_e.$8C.$3tF(n),"FolderPositionIndex");_a.$4.$7t(_e.$8C.$3tF(n),0,2147483647,"FolderPositionIndex")},$7ne:function(n){return _e.$8C.$1MW(n)},$7ni:function(n){var t=_js.$9.$a(n.DistinguishedFolderId)?_e.$8C.$4Hc:n.DistinguishedFolderId;return new FolderItemMetadata(n.ParentFolderId.Id,t,_e.$8C.$3tF(n))}};_e.$E9=function(n){_e.$E9.initializeBase(this,[n])};_e.$E9.$13B=function(n,t){_a.$4.$J(n,"folderId");_a.$4.$1G(n.Id,"folderId.Id");_a.$4.$J(t,"itemId");_a.$4.$1G(t.Id,"itemId.Id");return new _e.$E9(n.Id+":"+t.Id)};function FolderItemMetadata(n,t,i){FolderItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.DistinguishedFolderId=t;this.FolderPositionIndex=i}FolderItemMetadata.$1Rm=function(){return new _a.$4o("Metadata.ParentClientStoreId")};FolderItemMetadata.$5JW=function(){return new _a.$4o("Metadata.DistinguishedFolderId")};FolderItemMetadata.$2uh=function(){return new _a.$4o("Metadata.FolderPositionIndex")};FolderItemMetadata.prototype={ParentClientStoreId:null,DistinguishedFolderId:null,FolderPositionIndex:0};_e.$jZ=function(){_e.$jZ.initializeBase(this)};_e.$jZ.prototype={get_$i1:function(){return _e.$1I.get_$I().$2Np},$3uV:function(){var n=_a.$ht.$E(this.get_$20().Blob);return n.$3uV()},$7ne:function(n){return _e.$1h.$5f(n.Id)},$7ni:function(n){return new ItemMetadata},$A22:function(n){}};_e.$x4=function(n,t){_e.$x4.initializeBase(this,[n,t])};_e.$6P=function(n,t){_a.$4.$1G(n,"name");_a.$4.$J(t,"fields");_a.$4.$7t(t.length,1,2,"fields must be a 1 or 2 length array");this.$1n=n;this.$2KZ=t};_e.$6P.prototype={$1n:null,$2KZ:null};function ItemMetadata(){}_e.$18V=function(n,t,i){this.$4s=n;this.$Gt=t;this.$Lm=i};_e.$18V.prototype={$4s:null,$Gt:null,$Lm:null,get_$1y:function(){return this.$4s},get_$5fi:function(){return this.$Gt},get_$1sM:function(){return this.$Lm}};_e.$Ct=function(n,t,i,r,u,f,e,o,s){_a.$4.$1G(n,"name");this.$1n=n.toLowerCase();this.$Bx=t;this.$5We=f;this.$1KJ=r||[];this.$2NX=i||[];this.$wG=u||_e.$9F.$Q2;this.$5IF=e;this.$5Zx=o;this.$Lm=s;$70Q(this)};function $70Q(n){if(n.$1KJ.length>0){for(var u={},f=n.$2NX,h=f.length,t=0;t<h;++t)for(var c=f[t],e=c.$2KZ,l=e.length,i=0;i<l;++i){var a=e[i];u[a.$5r.$5r]=1}for(var o=n.$1KJ,v=o.length,r=0;r<v;++r){var s=o[r];if(s.$5r in u)throw Error.invalidOperation(String.format("The path {0} is declared as both an index and a blob",s.$5r));}}}_e.$Ct.prototype={$1n:null,$Bx:null,$2NX:null,$1KJ:null,$5We:0,$5IF:0,$5Zx:!1,$Lm:null,$wG:null,get_$1L:function(){return this.$1n},get_$39:function(){return this.$Bx},get_$2NY:function(){return this.$2NX},get_$7SR:function(){return this.$1KJ},get_$84e:function(){return this.$5We},get_$7iE:function(){return this.$5IF},get_$1sM:function(){return this.$Lm},get_$1te:function(){return this.$wG}};_e.$9F=function(n,t,i){this.$2KU=n;this.$2NX=t||new Array(0);this.$3Jg=i};_e.$9F.prototype={$2KU:null,$2NX:null,$3Jg:0};_e.$7j=function(n,t){this.$$d_$9s9=Function.createDelegate(this,this.$9s9);this.$$d_$98q=Function.createDelegate(this,this.$98q);this.$$d_$98r=Function.createDelegate(this,this.$98r);this.$$d_$98s=Function.createDelegate(this,this.$98s);this.add_onBeforePut=this.add_$1h5;this.remove_onBeforePut=this.remove_$1h5;this.add_onBeforeDelete=this.add_$16H;this.remove_onBeforeDelete=this.remove_$16H;this.add_onBeforeClear=this.add_$1h4;this.remove_onBeforeClear=this.remove_$1h4;this.bindMultipleIn=this.$7SO;_a.$4.$J(n,"store");_a.$4.$1G(t,"timeZoneId");this.$4G=new Sys.EventHandlerList;this.$6Y=n;this.$7e=t;this.$zq=(new this.$$gta["_e.$7j"].TItem).get_$i1()};_e.$7j.$$=function(n,t){var r="$7j"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[r]){var i=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$7j"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$7j.apply(this,r)};i.registerClass("_e."+r,null,_bc.$Bm.$$(n),_bc.$17W);var f=_e.$7j.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(i.prototype[u.key]=u.value)}i.$9YK="OnPut";i.$7hR="OnDelete";i.$7WJ="OnClear";i.$7Rt="OnAvailable"}return _e[r]};_e.$7j.prototype={$6Y:null,$7e:null,$zq:null,$4G:null,$4YN:0,$dE:null,add_$1h5:function(n){var t=this;this.$2kW("OnPut",n,function(){t.$dE.add_$1h5(t.$$d_$98s)})},remove_$1h5:function(n){var t=this;this.$3KQ("OnPut",n,function(){t.$dE.remove_$1h5(t.$$d_$98s)})},add_$16H:function(n){var t=this;this.$2kW("OnDelete",n,function(){t.$dE.add_$16H(t.$$d_$98r)})},remove_$16H:function(n){var t=this;this.$3KQ("OnDelete",n,function(){t.$dE.remove_$16H(t.$$d_$98r)})},add_$1h4:function(n){var t=this;this.$2kW("OnClear",n,function(){t.$dE.add_$1h4(t.$$d_$98q)})},remove_$1h4:function(n){var t=this;this.$3KQ("OnClear",n,function(){t.$dE.remove_$1h4(t.$$d_$98q)})},add_$68q:function(n){var t=this;this.$1Jk("OnAvailable",n,function(){t.$6Y.add_$2zw(t.$$d_$9s9)});this.get_$fZ()&&n(this)},remove_$68q:function(n){var t=this;this.$3KM("OnAvailable",n,function(){t.$6Y.remove_$2zw(t.$$d_$9s9)})},add_$6dS:function(n){var t=this;this.$2kW("OnDelete",n,function(){t.$dE.add_$16H(t.$$d_$98r)})},remove_$6dS:function(n){var t=this;this.$3KQ("OnDelete",n,function(){t.$dE.remove_$16H(t.$$d_$98r)})},get_$fZ:function(){return this.$6Y.get_$fZ()},get_$3RG:function(){return this.$7e},get_$4YA:function(){return this.$6Y},$BT:function(n,t,i,r){this.$6Y.get_$127().$BT(n,t,i,r)},$Fy:function(n,t,i,r){var u=this;_e.$y.$Fy(this.$$gta["_e.$7j"].TItem,this.$6Y,n,t,this.$7e,function(n){u.$6de(n,t);i(n)})},$A3T:function(n,t,i,r){var u=this.$7sm(t);u?i(u):this.$Fy(n,t,i,r)},$7SO:function(n,t,i,r){var u=this;_e.$y.$7SO(this.$$gta["_e.$7j"].TItem,this.$6Y,n,t,this.$7e,function(n){i(n)},r)},$tl:function(n,t,i,r){if(!this.$$gta["_e.$7j"].TItem.isInstanceOfType(t))throw Error.argumentNull("data");var u=t;u.$3Ln(n,i,r)},$1Ih:function(n,t,i){_e.$y.$1Ih(this.$$gta["_e.$7j"].TItem,this.$6Y,n,t,this.$7e,i)},$Ht:function(n,t){this.$2rM(n,t,null)},$2rM:function(n,t,i){_e.$y.$A4N(this.$$gta["_e.$7j"].TItem,n,t,i)},$pk:function(n){_e.$y.$pk(this.$$gta["_e.$7j"].TItem,n)},$1s9:function(n,t,i){_e.$y.$1s9(this.$$gta["_e.$7j"].TItem,n,t,i)},$6LN:function(n,t,i,r,u){_e.$y.$6LN(this.$$gta["_e.$7j"].TItem,n,t,i,r,u)},$NT:function(n,t,i){_a.$4.$J(n,"tx");var r=n.$Dg(this.$zq.get_$1L());r.$It(t,i,null)},$qa:function(n){return _e.$y.$qa(this.$$gta["_e.$7j"].TItem,this.$6Y,n,this.$7e)},$13C:function(n){return _e.$y.$13C(this.$$gta["_e.$7j"].TItem,this.$6Y,n,this.$7e)},$5Se:function(n){return this.$6Y.get_$Ta().$36(_e.$1n.$7e,this.$7e,n)},$2vz:function(n){return this.$6Y.get_$Ta().$36(this.$7e,_e.$1n.$7e,n)},$1mO:function(n,t,i,r){this.$Fy(n,t,i,r)},$6dT:function(n,t,i,r){this.$tl(n,t,i,r)},$4cP:function(n){return this.$qa(n)},$2kW:function(n,t,i){this.$4YN++||(this.$dE=this.$6Y.get_$127().$5FC(this.$zq.get_$1L()));this.$1Jk(n,t,i)},$3KQ:function(n,t,i){this.$3KM(n,t,i);--this.$4YN<=0&&this.$7jM()},$1Jk:function(n,t,i){this.$4G.getHandler(n)||i();this.$4G.addHandler(n,t)},$3KM:function(n,t,i){this.$4G.removeHandler(n,t);this.$4G.getHandler(n)||i()},$7jM:function(){this.$4YN=0;if(this.$dE){this.$dE.$1Q();this.$dE=null}},$9s9:function(n){if(this.$6Y.get_$fZ()){var t=this.$4G.getHandler("OnAvailable");t&&t(this)}},$98s:function(n,t){var i=this.$4G.getHandler("OnPut");if(i){var r=new(_e.$PL.$$(this.$$gta["_e.$7j"].TInterface))(t.get_$BT(),_e.$y.$A4P(this.$$gta["_e.$7j"].TItem,this.$6Y,t.get_$1y(),t.get_$20(),this.$7e));i(this,r)}},$98r:function(n,t){var i=this.$4G.getHandler("OnDelete");if(i){var r=new(_e.$PL.$$(_a.$pP))(t.get_$BT(),_e.$1h.$3sA(t.get_$1y()));i(this,r)}},$98q:function(n,t){var i=this.$4G.getHandler("OnClear");if(i){var r=new(_e.$PL.$$(this.$$gta["_e.$7j"].TInterface))(t.get_$BT(),this.$$gta["_e.$7j"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7j"].TInterface)?0:this.$$gta["_e.$7j"].TInterface===Boolean?!1:null);i(this,r)}},$7sm:function(n){var t=this.$$gta["_e.$7j"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7j"].TInterface)?0:this.$$gta["_e.$7j"].TInterface===Boolean?!1:null;var i=this.$6Y.get_$1qm().$3c(this.$zq.get_$1L(),n.toString());i&&(t=this.$qa(i));return t},$6de:function(n,t){n&&this.$6Y.get_$1qm().$2bk(this.$zq.get_$1L(),t.toString(),n.$10)}};_e.$PL=function(n,t){this.$P=this.$$gta["_e.$PL"].T===Number||Type.isEnum(this.$$gta["_e.$PL"].T)?0:this.$$gta["_e.$PL"].T===Boolean?!1:null;_e.$PL.$$(this.$$gta["_e.$PL"].T).initializeBase(this);this.$BH=n;this.$P=t};_e.$PL.$$=function(n){var t="$PL"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$PL"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$PL.apply(this,i)};r.registerClass("_e."+t,Sys.EventArgs,_bc.$pe.$$(n),_bc.$17X);var u=_e.$PL.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$PL.prototype={$BH:null,get_$BT:function(){return this.$BH},get_$3q:function(){return this.$P}};_e.$dE=function(n,t){_a.$4.$J(t,"syncStateId");this.$8y=new _e.$Tt(n,_e.$1n.$7e);this.$6aN=this.$7fA(t)};_e.$dE.prototype={$6aN:null,$8y:null,get_$bV:function(){return this.$6aN},get_$A8:function(){return this.$8y},$2wU:function(n,t){var i=this;this.get_$bV().$2M6(function(t){var r=i.get_$bV().$5Sm(t);n(r)},t)},$9tT:function(n,t,i,r,u,f,e){_js.Trace.logInfo(_e.$dE.$A,"SyncTo");_a.$4.$J(n,"syncState");var o=this,s=this,h=this;this.$8y.$BT(new _a.$6j("ItemSynchronizer.SyncTo",!1,t,i,r),function(t){o.$5Yz(t,n,u)},function(){_e.$1f.$kR(f)},function(n){_e.$1f.$D6(n,e)})},$c1:function(n,t,i,r){var u=this,f=this,e=this;this.$8y.$BT(new _a.$6j("ItemSynchronizer.Cleanup",!1),function(i){t.$6Hg(i);n!==2&&u.get_$bV().$7i3(i)},function(){_e.$1f.$kR(i)},function(n){_js.Trace.logError(_e.$1n.$A,"Database cleanup failed. Code = {0}, Message = {1}",n.$VZ,n.$3v);_e.$1f.$D6(n,r)})},$6M2:function(n,t,i,r,u){var e=this,f=this,o=this;this.$8y.$BT(new _a.$6j("ItemSynchronizer.ReconcileClientData",!1),function(i){n.$9YM(i,t,function(){})},function(){i(function(){f.$8y.$BT(new _a.$6j("ItemSynchronizer.ReconsileClientData",!1),function(t){n.$9UF(t)},function(){_e.$1f.$kR(r)},function(n){_e.$1f.$D6(n,u)})})},function(n){_e.$1f.$D6(n,u)})},$7fA:function(n){return new _e.$mA(this.$8y.get_$oo(),n)},$5Yz:function(n,t,i){i.$6Hg(n);this.get_$bV().$4N7(n,t)}};_e.$dN=function(n,t){_e.$dN.$$(this.$$gta["_e.$dN"].TInterface,this.$$gta["_e.$dN"].TItem,this.$$gta["_e.$dN"].TResult).initializeBase(this,[n,t])};_e.$dN.$$=function(n,t,i){var r="$dN"+"$3"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!_e[r]){var f=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$dN"]={TInterface:n,TItem:t,TResult:i};for(var u=[],r=0;r<arguments.length;++r)u[r]=arguments[r];_e.$dN.apply(this,u)};f.registerClass("_e."+r,_e.$7j.$$(n,t));var e=_e.$dN.prototype;for(var o in e){var u={key:o,value:e[o]};"constructor"!==u.key&&(f.prototype[u.key]=u.value)}}return _e[r]};_e.$dN.prototype={$A5c:function(n,t,i,r,u){_a.$4.$J(n,"paging");_a.$4.$J(t,"seekToConditionKeyKeyPath");_a.$4.$J(i,"queryCreatorCallback");_a.$4.$J(r,"successCallback");if(_g.$C8.isInstanceOfType(n))this.$7uU(n,i,r,u);else if(_g.$KG.isInstanceOfType(n))this.$7xa(n,t,i,r,u);else throw Error.invalidOperation(String.format("Unsupported paging type {0} provided",n));},$7uU:function(n,t,i,r){_a.$4.$7t(n.Offset,0,Number.MAX_VALUE,"offset");_a.$4.$7t(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");_a.$4.$9n(n.BasePoint==="Beginning","Unsupported paging type provided");var s=n.MaxEntriesReturned;var e=n.Offset;var h=n.BasePoint;var o=new Array(0);var u=0;var f=this,c=this,l=this;this.$BT(new _a.$6j("ListViewItemStore.GetIndexedPageViewItems"),function(n){f.$5Sz(n,function(i){u=i;_a.$4.$7t(u,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetIndexedPageViewItems: totalItemsInView={0}, basePoint={1}, maxEntriesToReturn={2}, offset={3}",u,h,s,e);var r=n.$Dg(f.get_$uD());var c=t();r.$It(c,function(n){f.$5Lt(n,e,s,function(n,t,i){f.$4Ot(t,o)})},null)})},function(){i(o,u,e+o.length)},function(n){_e.$1f.$D6(n,r)})},$7xa:function(n,t,i,r,u){_a.$4.$7t(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");var o=n.MaxEntriesReturned;var v=n.BasePoint;var l=v==="Beginning";var s=!1;var h=0;var y=n.Condition.Item.FieldURIOrConstant.Item;var a=y.Value;var c=new Array(0);var e=0;var f=this,p=this,w=this;this.$BT(new _a.$6j("ListViewItemStore.GetSeekToConditionPageViewItems"),function(n){f.$5Sz(n,function(r){e=r;_a.$4.$7t(e,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionPageViewItems: totalItemsInView={0}, isSeekNextRequest={1}, basePoint={2}, maxEntriesToReturn={3}, seekToConditionKeyPath={4}, seekToConditionKeyValue={5}",e,l,v,o,t.$5r,a);var u=n.$Dg(f.get_$uD());var y=i();u.$It(y,function(n){l?f.$7n9(n,t,a,o,function(n,t,i){h=i;s=n;n&&f.$4Ot(t,c)}):f.$5SR(n,t,a,function(n,t){s=n;if(n){h=t;var i=Math.max(0,t-o+1);u.$It(y,function(n){f.$5Lt(n,i,o,function(n,t,i){f.$4Ot(t,c)})},null)}else _js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionKeyOffset: row NOT found offset={0}, maxEntriesToReturn={1}",t,o)})},null)})},function(){var n;n=l?s?h+c.length:e:s?Math.max(0,e-h-1):0;r(c,e,n)},function(n){_e.$1f.$D6(n,u)})},$5SR:function(n,t,i,r){var u=this;n.$1jv(0,new _a.$8k(t,i),function(t){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionKeyOffset: result offset={0}",n.get_$Iv());r(t,n.get_$Iv())},null)},$7n9:function(n,t,i,r,u){var f=this;this.$5SR(n,t,i,function(t,i){if(t)n.$Dd(r,function(n,f,e){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToConditionQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",i,r,f.length);u(t,f,i)},null);else{_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToConditionQuery: row NOT found offset={0}, maxEntriesToReturn={1}",i,r);u(t,null,i)}})},$5Lt:function(n,t,i,r){var u=this;n.$1U9(t,function(){n.$Dd(i,function(n,u,f){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToIndexQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",t,i,u.length);r(n,u,f)},null)},null)}};_e.$19R=function(n,t,i,r){_e.$19R.initializeBase(this,[n,t,i,!0,r,4])};_e.$19R.prototype={get_$uD:function(){return _e.$1I.get_$I().$xt.get_$1L()},get_$2cQ:function(){return!0},$7qk:function(n){var t=null;if(n.get_$lB().length>0){var r=n.get_$lB()[0].$27;t=r.Data}else if(n.get_$lg().length>0){var u=n.get_$lg()[0].$27;t=_a.$1V.$A4v(_g.$7k,u.Data)}else if(n.get_$12G().length>0){var i=this.$A4R(n.get_$12G()[0].$4s);i&&(t=i.get_$20())}t&&t.IsDraft&&this.$7qj(t.ParentFolderId.Id)},$9mL:function(n,t){return!!n&&n.$1uU},$2vy:function(n){return n.get_$52()},$7qj:function(n){_e.$2l.$2vF(n,"clientStore",this.get_$2cQ())}};_e.$y2=function(n,t){_e.$y2.initializeBase(this,[n,"MessageItemSyncStateId"]);_a.$4.$7t(t,0,10,"maxUnsyncedItemsToGet");this.get_$bV().$5k3=t};_e.$y2.prototype={$7fA:function(n){return new _e.$kG(this.$8y.get_$oo(),this.$8y.get_$52())}};_e.$19S=function(n,t,i,r,u){_e.$19S.initializeBase(this,[n,i,u]);_a.$4.$J(t,"attachmentItemStore");_a.$4.$J(r,"attachments");this.$1KB=t;this.$9M=r};_e.$19S.prototype={$1KB:null,$9M:null,$6Hg:function(n){_a.$4.$J(n,"tx");var i=[];var r=this,t=this;_e.$3V.$A4Y(_bc.$Lx,_g.$7k,this.get_$5fi(),n,this.get_$A5M(),function(n){return _e.$1h.$5f(n.ItemId.Id)},function(r){for(var o=t.get_$A5M(),s=o.length,f=0;f<s;++f){var u=o[f];var e=r.$Mj(u.ItemId.Id)?r.get_$3q(u.ItemId.Id).get_$20():null;if(e&&u.ItemId.ChangeKey===e.ItemId.ChangeKey){var h=_g.$RF.$5Di(e,u);Array.add(i,h)}else Array.add(i,u)}t.set_$A5M(i);_e.$3V.$A4T(_bc.$pL,AttachmentInfoRecord,t.$1KB,n,t.$9M,null);_e.$Xe.prototype.$6Hg.call(t,n)})}};_e.$kG=function(n,t){_a.$4.$J(n,"syncStateItemStore");_a.$4.$J(t,"messageItemStore");this.$2eK=n;this.$2SK=t};_e.$kG.$9xS=function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"messageItemStore");_a.$4.$J(i,"itemIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];t.$Fy(n,_e.$1h.$5f(e.Id),function(i){if(i){var r=MessageItemRecord.$2LB(i.get_$20());r.CustomSyncData.IsDataSynced=CustomSyncData.$1rs;t.$tl(n,i,1,null)}},null)}};_e.$kG.prototype={$2eK:null,$2SK:null,$5k3:0,$2M6:function(n,t){_a.$4.$J(n,"successCallback");var i=this,r=this;_e.$Bt.$7yu(this.$2SK,this.$5k3,_g.$h.$1i,function(t,r,u){var f=i.$2eK.$qa(new MessageItemSyncState(t,r,u));n(f)},function(n){_js.Trace.logError(_e.$1n.$A,"ClientStore returned error while trying to fetch unsyned item list. Error = {0}",n.get_$52());t&&t(n)})},$9xa:function(n,t,i,r){r()},$3SM:function(n,t){t()},$4N7:function(n,t){_e.$kG.$9xS(n,this.$2SK,t.$6A)},$7i3:function(n){throw Error.notImplemented("NYI");},$2LT:function(){return new MessageItemSyncState([],{},!1)},$5Sm:function(n){return $6(n)?this.$2LT():n.get_$20()},$5QT:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$19f=function(n,t){_e.$19f.initializeBase(this,[n,t])};_e.$19f.prototype={$2LT:function(){return new MultiFolderSyncState(this.$2AU)},$5QT:function(n){return new SyncState(n,"")}};_e.$y9=function(n,t){_e.$y9.initializeBase(this,[n,t])};_e.$y9.prototype={$7fA:function(n){return new _e.$19f(this.$8y.get_$oo(),n)}};_e.$2l=function(){};_e.$2l.$2vF=function(n,t,i){_e.$2l.$2vA(n,null,"Reload",t,_e.$2l.$x0,_e.$2l.$x0,i)};_e.$2l.$2vA=function(n,t,i,r,u,f,e){_a.$4.$1G(n,"folderId");var o=new _a.$16k;o.id="HierarchyNotification";o.type="HierarchyNotification";o.folderId=n;o.parentFolderId=t;o.EventType=i;o.itemCount=u;o.unreadCount=f;o.clientGenerated=!0;o.forceSynchronousProcessing=!e;_a.$g.$8r("Reload.Notification.Source."+r);_e.$2l.$1vP(o)};_e.$2l.$2LG=function(n){var t=new _a.$1BQ;t.id="ReminderNotification";t.type="ReminderNotification";t.clientGenerated=!0;t.shouldGetReminders=!0;t.forceSynchronousProcessing=!n;_js.Trace.logInfo(_a.$0.$Q4,"Time: {0}, Cache client reminder notification",_a.$7.get_$29().toString());_e.$2l.$1vP(t)};_e.$2l.$5P7=function(n,t,i){_a.$4.$1G(n,"folderId");var r=new _g.$1Bi;r.clientGenerated=!0;r.FolderId=n;r.EventType=t;r.id="RowNotification"+n;r.type="RowNotification";r.forceSynchronousProcessing=!i;_e.$2l.$1vP(r)};_e.$2l.$5PG=function(n){var t=new _a.$1A7;t.id="OwaUserConfigurationNotification";t.type="OwaUserConfigurationNotification";t.clientGenerated=!0;t.reload=n;_e.$2l.$1vP(t)};_e.$2l.$3sL=function(n){_a.$4.$J(n,"response");var t=new _g.$14r;t.id="FolderHierarchyNotification";t.type="FolderHierarchyNotification";t.clientGenerated=!0;t.folderHierarchy=n;_e.$2l.$1vP(t)};_e.$2l.$7qQ=function(n,t,i){_a.$4.$1G(t,"GenerateCalendarItemNotification:folderId");_a.$4.$l(i,"GenerateCalendarItemNotification:calendarItem");var r=new _g.$12G;r.clientGenerated=!0;r.EventType=n;r.id="CalendarItemNotification"+t;r.type="CalendarItemNotification";r.FolderId=t;r.Item=i;r.Reload=!1;r.forceSynchronousProcessing=!0;_e.$2l.$1vP(r)};_e.$2l.$1vP=function(n){_a.$4.$Js(n.clientGenerated,!0,"notification.ClientGenerated");OwaApplication.get_$Rb().$wj(n)};_e.$1A3=function(n,t,i,r){_e.$1A3.initializeBase(this,[n,t,i,!0,r,5])};_e.$1A3.prototype={get_$uD:function(){return _e.$1I.get_$I().$25g.get_$1L()},get_$2cQ:function(){return!0},$7qk:function(n){var t=null;if(n.get_$lB().length>0){var r=n.get_$lB()[0].$27;t=r.Data}else if(n.get_$lg().length>0){var u=n.get_$lg()[0].$27;t=u.Data}else if(n.get_$12G().length>0){var i=this.$A4R(n.get_$12G()[0].$4s);i&&(t=i.get_$20())}t&&_e.$2l.$2vF(t.ParentFolderId.Id,"serviceCommand",this.get_$2cQ())},$2vy:function(n){return n.get_$gd()}};_e.$UP=function(n,t,i,r){_e.$UP.initializeBase(this,[n,t,i,!1,r,7])};function $3Xj(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];e.$4s.toString()==="OwaUserConfiguration.1"&&t.$6M3(e,r)}}_e.$UP.prototype={get_$uD:function(){return _e.$1I.get_$I().$2cC.get_$1L()},$7nv:function(n){var t=new _a.$yG;$3Xj(this,t,n.get_$lB(),0);$3Xj(this,t,n.get_$lg(),1);$3Xj(this,t,n.get_$12G(),2);return t},$7qk:function(n){},$2vy:function(n){return n.get_$6US()}};_e.$LI=function(){_e.$LI.initializeBase(this)};_e.$LI.$7yO=function(n,t,i){_a.$4.$J(n,"syncStateItemStore");_a.$4.$J(t,"successCallback");var r=[];n.$BT(new _a.$6j("SyncStateItem.GetSyncStates"),function(t){var u=t.$Dg(_e.$1I.get_$I().$1UY.get_$1L());var f=new _a.$8J(null,null);u.$It(f,function(t){t.$Dd(_e.$LI.$5k1,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$13C(i[f]))},_e.$1f.$Zb(i))},_e.$1f.$Zb(i))},function(){t(r)},_e.$1f.$Zb(i))};_e.$LI.prototype={get_$i1:function(){return _e.$1I.get_$I().$1UY},$A22:function(n){_a.$4.$1G(n.Id,"id")},$7ne:function(n){return _e.$1h.$5f(n.Id)},$7ni:function(n){return new ItemMetadata}};_e.$3V=function(){};_e.$3V.$A4T=function(n,t,i,r,u,f){_e.$3V.$A4U(n,t,i,r,u,f,1)};_e.$3V.$A4U=function(n,t,i,r,u,f,e){if(!u||!u.length){_e.$1f.$kR(f);return}for(var c=0,s=function(){++c===u.length&&_e.$1f.$kR(f)},o=0;o<u.length;o++){var h=u[o];$6(h)?s():_e.$3V.$A4W(n,t,i,r,h,null,function(){s()},e)}};_e.$3V.$A4V=function(n,t,i,r,u,f,e){_e.$3V.$A4W(n,t,i,r,u,f,e,1)};_e.$3V.$A4W=function(n,t,i,r,u,f,e,o){var s=i.$4cP(u);f?f(s,r,e):i.$6dT(r,s,o,e)};_e.$3V.$A4X=function(n,t,i,r,u){if(!r||!r.length){_e.$1f.$kR(u);return}for(var s=0,e=function(){++s===r.length&&_e.$1f.$kR(u)},f=0;f<r.length;f++){var o=r[f];o?i.$2rM(t,o,function(){e()}):e()}};_e.$3V.$A4Y=function(n,t,i,r,u,f,e){var h=0;var o=_a.$3n.$$(n).$8A();u&&u.length||e(o);for(var s=0;s<u.length;s++)i.$1mO(r,f(u[s]),function(n){h++;n&&o.set_$3q(n.get_$1y().get_$1dL().toString(),n);h===u.length&&e(o)},null)};_e.$3V.$9YM=function(n,t,i,r,u,f){var e=new _a.$8k(_e.$y.$2av,0);var o=new _a.$8J(e,null);i.$6LN(t,o,r,function(t,i,r,e){for(var c=n.getName(),s=r.length,o=0;o<s;o++){var h=r[o].$4s.$Tc();_js.Trace.logWarning(_e.$3V.$A,"Dirty item (type: {0}) #{1}/{2}: {3}",c,o,s,h);u[h]=null}e&&f()},null)};_e.$3V.$3rq=function(n,t){var i=n;for(var r in i){var u={key:r,value:i[r]};t(u.key)}};_e.$mA=function(n,t){_a.$4.$J(n,"store");_a.$4.$J(t,"syncStateId");this.$6Y=n;this.$2AU=t};_e.$mA.prototype={$6Y:null,$2AU:null,$2M6:function(n,t){_a.$4.$J(n,"successCallback");var i=null;var r=this,u=this,f=this;this.$6Y.$BT(new _a.$6j("SyncStateProvider.GetState"),function(n){r.$5Sd(n,function(n){i=n})},function(){n(i)},function(n){_e.$1f.$D6(n,t)})},$5Sd:function(n,t){_a.$4.$J(t,"successCallback");this.$6Y.$A3T(n,_e.$1h.$5f(this.$2AU),t,null)},$9xY:function(n,t){var i=this;this.$3SM(function(t){t.IsSynced=n},t)},$9xa:function(n,t,i,r){var u=this;this.$3SM(function(r){r.Diagnostics.SyncType=n;r.Diagnostics.SyncInProgress=t;r.Diagnostics.SyncError=i?i.message:""},r)},$4N7:function(n,t){var i=this.$6Y.$qa(t);i.$E7(n,null)},$7i3:function(n){this.$6Y.$Ht(n,_e.$1h.$5f(this.$2AU))},$2LT:function(){return new SyncState(this.$2AU,"")},$5Sm:function(n){return $6(n)?this.$2LT():n.get_$20()},$3SM:function(n,t){_a.$4.$J(n,"updateDelegate");_a.$4.$J(t,"completedCallback");var i=this,r=this,u=this;this.$6Y.$BT(new _a.$6j("SyncStateProvicer.TryUpdateSyncStateProperties"),function(t){i.$6Y.$A3T(t,_e.$1h.$5f(i.$2AU),function(r){var u=i.$5Sm(r);n(u);i.$4N7(t,u)},null)},function(){t()},function(n){t()})},$5QT:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$1Dy=function(){};_e.$1Dy.prototype={$2v9:function(n){_a.$4.$J(n,"folderIds");_a.$4.$7t(n.length,1,100,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_e.$1n.$A,"Generating onSync hierarchy notification. FolderId: {0}",r);_e.$2l.$2vF(r,"sync",!1)}},$2LG:function(){_js.Trace.logInfo(_a.$0.$Q4,"Generating onSync reminder notification");_e.$2l.$2LG(!0)},$7qn:function(n){_a.$4.$J(n,"folderIds");_a.$4.$Js(n.length>0,!0,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_a.$0.$Q4,"Generating onSync persona notification. FolderId: {0}",r);_e.$2l.$5P7(r,"RowModified",!0)}},$5PG:function(n){_js.Trace.logInfo(_a.$0.$Q4,"Generating onSync owa user configuration notification.");_e.$2l.$5PG(n)},$3sL:function(n){_a.$4.$J(n,"response");_js.Trace.logInfo(_a.$0.$Q4,"Generating onSync folder hierarchy notification.");_e.$2l.$3sL(n)}};_e.$6n=function(){_e.$6n.initializeBase(this)};_e.$6n.get_$3jJ=function(){return new _a.$4o("Data.ConversationId.Id")};_e.$6n.get_$2zV=function(){return new _a.$4o("Data.InstanceKey")};_e.$6n.get_$2rv=function(){return new _a.$4o("Data.DirtyState")};_e.$6n.$1MW=function(n){_a.$4.$J(n,"data");return _e.$E9.$13B(n.FolderId,n.ConversationId)};_e.$6n.$7tA=function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(r,"successCallback");_a.$4.$7t(i,0,100,"maxEntriesToReturn");var u=[];var f={};var e={};var o=n.$Dg(_e.$1I.get_$I().$i3.get_$1L());var s=new _a.$8k(_e.$6n.get_$2rv(),2);var h=new _a.$8J(s,[new _a.$IL(ConversationItemMetadata.$2Ql(),1)]);o.$It(h,function(n){n.$Dd(i*2,function(n,o,s){for(var v=0,l=o,y=l.length,c=0;c<y;++c){var p=l[c];var a=t.$13C(p);var h=a.get_$20().ConversationId.Id;if($6(e[h])){if(v++>=i)break;Array.add(u,new _g.$1q(h));f[h]=a.get_$20().LastModifiedTime;e[h]=!0}}r(u,f)},null)},null)};_e.$6n.$3sr=function(n,t,i,r){_a.$4.$J(n,"tx");_a.$4.$J(t,"conversationItemStore");_a.$4.$J(i,"conversationId");_a.$4.$1G(i.Id,"conversationId.Id");_a.$4.$J(r,"successCallback");var f=n.$Dg(_e.$1I.get_$I().$i3.get_$1L());var e=new _a.$8k(_e.$6n.get_$3jJ(),i.Id);var o=new _a.$8J(e,null);var u=[];f.$It(o,function(n){n.$Dd(100,function(n,i,f){for(var o=i,s=o.length,e=0;e<s;++e){var h=o[e];Array.add(u,t.$13C(h))}r(u)},null)},null)};_e.$6n.$4co=function(n,t,i,r){var o=100;var s=new _a.$8J(new _a.$8k(_e.$6n.get_$2rv(),1),null);var u=[];var f={};var e={};t.$6LN(n,s,o,function(o,s,h,c){for(var y=h,w=y.length,v=0;v<w;++v){var b=y[v];var l=t.$13C(b);var k=l.get_$20().ConversationId.Id;e[k]=l.get_$20().LastModifiedTime;if(l.get_$20().GlobalItemReadFlags)for(var a=0;a<l.get_$20().GlobalItemIds.length;a++){var p=l.get_$20().GlobalItemIds[a];Array.add(u,p);f[p.Id]=l.get_$20().GlobalItemReadFlags[a]}l.set_$5J0(0);t.$tl(n,l,1,null)}if(c){_e.$6n.$9zp(n,i,e);_e.$6n.$4cp(n,r,u,0,f)}},null)};_e.$6n.$9zp=function(n,t,i){var r=i;for(var u in r){var f={key:u,value:r[u]};t.$Fy(n,_e.$1h.$5f(f.key),function(r){if(r){var u=i[r.get_$20().ConversationId.Id];r.get_$20().LastModifiedTime=u;t.$tl(n,r,1,function(n){})}else _js.Trace.logWarning(_e.$1n.$A,"Can't find ConversationNode with id:{0}",f.key)},null)}};_e.$6n.$4cp=function(n,t,i,r,u){var f=10;r+f>i.length&&(f=i.length-r);if(f)for(var o=0,e=0,s=0;s<f;s++){o++;t.$Fy(n,_e.$1h.$5f(i[r+s].Id),function(s){if(s){o--;if(s.get_$20().IsRead!==u[s.get_$20().ItemId.Id]){s.get_$20().IsRead=u[s.get_$20().ItemId.Id];e++;t.$tl(n,s,1,function(o){e--;e||_e.$6n.$4cp(n,t,i,r+f,u)})}else o||e||_e.$6n.$4cp(n,t,i,r+f,u)}},null)}};_e.$6n.prototype={get_$5J0:function(){return this.get_$20().DirtyState},set_$5J0:function(n){this.get_$20().DirtyState=n;return n},get_$i1:function(){return _e.$1I.get_$I().$i3},$A22:function(n){_a.$4.$J(n.ConversationId,"ConversationId");_a.$4.$1G(n.ConversationId.Id,"ConversationId.Id");_a.$4.$1G(n.LastDeliveryTime,"LastDeliveryTime");_a.$4.$J(n.FolderId,"FolderId");_a.$4.$J(n.FolderId.Id,"FolderId.Id")},$7ne:function(n){return _e.$6n.$1MW(n)},$7ni:function(n){var t=$6(n.HasClutter)?!1:n.HasClutter;return new ConversationItemMetadata(n.FolderId.Id,t,n.LastDeliveryTime)}};function ConversationItemMetadata(n,t,i){ConversationItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.ParentClientStoreIdAndClutter=_e.$7f.$E(n,t);this.LastDeliveryTime=i}ConversationItemMetadata.$1Rm=function(){return new _a.$4o("Metadata.ParentClientStoreId")};ConversationItemMetadata.$1Rl=function(){return new _a.$4o("Metadata.ParentClientStoreIdAndClutter")};ConversationItemMetadata.$2Ql=function(){return new _a.$4o("Metadata.LastDeliveryTime")};ConversationItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,LastDeliveryTime:null};_e.$Oo=function(){_e.$Oo.initializeBase(this)};_e.$Oo.$5F4=function(n){_a.$4.$J(n,"originalItem");var t=new _g.$7k;t.ItemId=n.ItemId;t.ConversationId=n.ConversationId;t.ParentFolderId=n.ParentFolderId;t.DateTimeCreated=n.DateTimeCreated;t.DateTimeSent=n.DateTimeSent;t.DateTimeReceived=n.DateTimeReceived;t.__PlaceHolderItem=!0;return t};_e.$Oo.$1MW=function(n){_a.$4.$J(n,"data");_a.$4.$J(n.ConversationId,"data.ConversationId");return _e.$Oo.$7nf(n.ConversationId)};_e.$Oo.$7nf=function(n){_a.$4.$J(n,"conversationId");_a.$4.$1G(n.Id,"conversationId.Id");return _e.$1h.$5f(n.Id)};_e.$Oo.prototype={get_$i1:function(){return _e.$1I.get_$I().$2HR},$A22:function(n){_a.$4.$J(n.ConversationId,"ConversationId");_a.$4.$1G(n.ConversationId.Id,"ConversationId.Id");_a.$4.$1G(n.SyncState,"SyncState");_a.$4.$J(n.ConversationNodes,"ConversationNodes");_a.$4.$ou(n.ConversationNodes.length,0,"ConversationNodes.Length");_a.$4.$J(n.LastModifiedTime,"LastModifiedTime")},$7ne:function(n){return _e.$Oo.$1MW(n)},$7ni:function(n){return new ItemMetadata}};_e.$aL=function(n,t,i){_a.$4.$J(n,"syncStateItemStore");_a.$4.$J(t,"conversationItemStore");_a.$4.$J(t,"conversationNodeItemStore");this.$2eK=n;this.$1rE=t;this.$5DC=i};_e.$aL.$9xR=function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"conversationItemStore");_a.$4.$J(i,"conversationIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];var o=n.$Dg(_e.$1I.get_$I().$i3.get_$1L());var s=new _a.$8k(_e.$6n.get_$3jJ(),e.Id);var h=new _a.$8J(s,null);o.$It(h,function(i){i.$Dd(100,function(i,r,u){for(var e=r,s=e.length,f=0;f<s;++f){var h=e[f];var o=t.$13C(h);o.set_$5J0(0);t.$tl(n,o,1,null)}},null)},null)}};_e.$aL.prototype={$2eK:null,$1rE:null,$5DC:null,$5jk:0,$2M6:function(n,t){_a.$4.$J(n,"successCallback");var r=null;var i=this,u=this,f=this;this.$1rE.$BT(new _a.$6j("ConversationSyncStateProvider.GetState"),function(n){_e.$6n.$7tA(n,i.$1rE,i.$5jk,function(t,u){var o=0;var f={};if(t.length)for(var e=0;e<t.length;e++)i.$5DC.$Fy(n,_e.$1h.$5f(t[e].Id),function(n){n&&(f[n.get_$20().ConversationId.Id]=n.get_$20().SyncState);++o===t.length&&(r=i.$2eK.$qa(new ConversationItemSyncState(t,u,f)))},null);else r=i.$2eK.$qa(new ConversationItemSyncState(t,u,f))})},function(){n(r)},function(n){_js.Trace.logError(_e.$1n.$A,"ClientStore returned error while trying to fetch dirty conversation list or conversation sync state. Error = {0}",n.$3v);t&&t(new _e.$1f(n))})},$9xa:function(n,t,i,r){r()},$3SM:function(n,t){t()},$4N7:function(n,t){_e.$aL.$9xR(n,this.$1rE,t.$6A)},$7i3:function(n){throw Error.notImplemented("NYI");},$2LT:function(){return new ConversationItemSyncState([],{},{})},$5Sm:function(n){return $6(n)?this.$2LT():n.get_$20()},$5QT:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$Bt=function(){_e.$Bt.initializeBase(this)};_e.$Bt.get_$2zV=function(){return new _a.$4o("Data.InstanceKey")};_e.$Bt.$1MW=function(n){_a.$4.$J(n,"data");_a.$4.$J(n.ItemId,"data.ItemId");_a.$4.$1G(n.ItemId.Id,"data.ItemId.Id");return _e.$1h.$5f(n.ItemId.Id)};_e.$Bt.$7yu=function(n,t,i,r,u){_a.$4.$J(i,"folderMappings");_a.$4.$J(r,"successCallback");_a.$4.$7t(t,0,10,"maxEntriesToReturn");var f=[];var e=0;var s={};var o=!1;n.$BT(new _a.$6j("MessageItem.GetUnsyncedItems"),function(r){var u=r.$Dg(_e.$1I.get_$I().$xt.get_$1L());var h=new _a.$8k(MessageItemMetadata.$5aU(),"false");var c=new _a.$8J(h,[new _a.$IL(MessageItemMetadata.$29s(),1)]);u.$It(c,function(r){r.$Dd(t*3,function(r,u,h){while(f.length<t&&e<u.length){var a=u[e];var c=n.$13C(a).get_$20();var l=c.ItemId.Id;e||(o=i.doesIdEqualName(c.ParentFolderId,"drafts"));if(o===i.doesIdEqualName(c.ParentFolderId,"drafts")){Array.add(f,new _g.$1q(l));s[l]=c.ItemId.ChangeKey}e++}},null)},null)},function(){_js.Trace.logInfo(_e.$1n.$A,"Found {0} unsynced items",f.length);r(f,s,o)},function(n){_e.$1f.$D6(n,u)})};_e.$Bt.$7XX=function(n,t){_a.$4.$J(n,"item");var i=MessageItemRecord.$2LB(n);return!$6(i.CustomSyncData)&&i.CustomSyncData.ItemShape>t};_e.$Bt.$2bn=function(n,t,i){_a.$4.$J(n,"item");_a.$4.$J(t,"isDataSynced");MessageItemRecord.$2LB(n).CustomSyncData=new CustomSyncData(t,i)};_e.$Bt.$7y4=function(n){if(_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"sentitems")){$6(n.DateTimeSent)&&_js.Trace.logError(_a.$0.$5a,"For item with item id {0}, the parent folder id is sent items folder i.e. {1} and the date time sent is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeSent}else if(_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"drafts")||_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"outbox")){$6(n.DateTimeCreated)&&_js.Trace.logError(_a.$0.$5a,"For item with item id {0}, the parent folder id is drafts or outbox folder i.e. {1} and the date time created is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeCreated}return n.DateTimeReceived};_e.$Bt.prototype={get_$i1:function(){return _e.$1I.get_$I().$xt},$5AK:function(n,t,i){var r=null;if(n.__type===_g.$IC._dataContractName)r=_g.$IC.changeTimeZone;else if(n.__type===_g.$Kt._dataContractName){if(t!==i&&n){r=_g.$Kt.changeTimeZone;var u=n;if(u.ChangeHighlights){u.ChangeHighlights.Start=this.$6Y.get_$Ta().$36(t,i,u.ChangeHighlights.Start);u.ChangeHighlights.End=this.$6Y.get_$Ta().$36(t,i,u.ChangeHighlights.End)}}}else n.__type===_g.$Jw._dataContractName?r=_g.$Jw.changeTimeZone:n.__type===_g.$MC._dataContractName&&(r=_g.$MC.changeTimeZone);r?r(n,t,i,this.$6Y.get_$Ta()):_e.$t3.prototype.$5AK.call(this,n,t,i);if(n.ExtendedProperty)for(var o=n.ExtendedProperty,s=o.length,e=0;e<s;++e){var f=o[e];f.ExtendedFieldURI.PropertyTag===_g.$l.get_$j9().PropertyTag&&f.Value&&(f.Value=this.$6Y.get_$Ta().$36(t,i,f.Value))}},$A22:function(n){_a.$4.$J(n.ItemId,"itemId");_a.$4.$1G(n.ItemId.Id,"itemId.Id");_a.$4.$1G(n.ItemId.ChangeKey,"itemId.ChangeKey");_a.$4.$J(n.ParentFolderId,"ParentFolderId");_a.$4.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$4.$1G(n.DateTimeReceived,"DateTimeReceived");_a.$4.$1G(n.InstanceKey,"InstanceKey");var t=MessageItemRecord.$2LB(n);$6(t.CustomSyncData)&&_e.$Bt.$2bn(n,CustomSyncData.$1rs,2)},$7ne:function(n){return _e.$Bt.$1MW(n)},$7ni:function(n){var t=_e.$Bt.$7y4(n);var i=$6(n.IsClutter)?!1:n.IsClutter;return new MessageItemMetadata(n.ParentFolderId.Id,t,i,MessageItemRecord.$2LB(n).CustomSyncData.IsDataSynced)}};function MessageItemMetadata(n,t,i,r){MessageItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.SortDateTime=t;this.ParentClientStoreIdAndClutter=_e.$7f.$E(n,i);this.IsDataSynced=r}MessageItemMetadata.$1Rm=function(){return new _a.$4o("Metadata.ParentClientStoreId")};MessageItemMetadata.$1Rl=function(){return new _a.$4o("Metadata.ParentClientStoreIdAndClutter")};MessageItemMetadata.$29s=function(){return new _a.$4o("Metadata.SortDateTime")};MessageItemMetadata.$5aU=function(){return new _a.$4o("Metadata.IsDataSynced")};MessageItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,SortDateTime:null,IsDataSynced:null};_e.$kF=function(n,t){_e.$kF.initializeBase(this,[n,t])};_e.$kF.prototype={get_$uD:function(){return _e.$1I.get_$I().$xt.get_$1L()},$4cf:function(n,t,i){var r=this;this.$1Ih(n,t,function(n){if($6(n)){_js.Trace.logWarning(_a.$0.$5a,"Message with id {0} not found in local store",t);return}_e.$Op.$4cf(n,i)})}};_e.$U6=function(n,t){_e.$U6.$$(this.$$gta["_e.$U6"].TInterface,this.$$gta["_e.$U6"].TItem).initializeBase(this,[n,t])};_e.$U6.$$=function(n,t){var i="$U6"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var r=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$U6"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$U6.apply(this,r)};r.registerClass("_e."+i,_e.$dN.$$(n,t,_g.$7k));var f=_e.$U6.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(r.prototype[u.key]=u.value)}r.$3u3=function(n,t){var i;i=t==="Clutter"?new _a.$8k(MessageItemMetadata.$1Rl(),_e.$7f.$E(n,!0)):t==="NoClutter"?new _a.$8k(MessageItemMetadata.$1Rl(),_e.$7f.$E(n,!1)):new _a.$8k(MessageItemMetadata.$1Rm(),n);return i}}return _e[i]};_e.$U6.prototype={$2k:null,$5Nv:null,$47U:null,get_$r:function(){return this.$2k},get_$A5h:function(){return this.$5Nv},$5RS:function(n,t,i,r,u,f,e){_a.$4.$J(n,"folderId");_a.$4.$J(t,"folderItemStore");_a.$4.$J(i,"request");_a.$4.$J(r,"actionContext");_a.$4.$J(f,"successCallback");this.$2k=n;this.$5Nv=t;this.$47U=u;var o=this;_e.$dN.prototype.$A5c.call(this,i.Paging,_e.$Bt.get_$2zV(),function(){var t=_e.$U6.$$(o.$$gta["_e.$U6"].TInterface,o.$$gta["_e.$U6"].TItem).$3u3(n,i.ClutterFilter);return new _a.$8J(t,[new _a.$IL(MessageItemMetadata.$29s(),1)])},f,e)},$5Sz:function(n,t){t(this.$47U.TotalCount)},$4Ot:function(n,t){for(var u=this.$5Se(this.$47U.OldestReceivedTime),f=_a.$7.$42(u).$J8().$5R(),i=0;i<n.length;++i){var e=this.$13C(n[i]);var r=e.get_$20();var o=_a.$7.$42(r.DateTimeReceived).$J8().$5R();if(o>=f){this.$97w(r);Array.add(t,r)}else break}_js.Trace.logInfo(_e.$1n.$A,"GetItems: Returning {0} results to the caller",t.length)},$97w:function(n){n.Body=null;n.NormalizedBody=null;n.UniqueBody=null;n.Attachments=null;n.ToRecipients=null;n.CcRecipients=null;n.BccRecipients=null}};_e.$2Q=function(){_e.$2Q.initializeBase(this)};_e.$2Q.$7nh=function(n,t){_a.$4.$J(n,"folderId");_a.$4.$J(t,"personaId");return _e.$E9.$13B(n,t)};_e.$2Q.$3fl=function(n,t,i,r,u,f,e){_a.$4.$J(n,"store");_a.$4.$J(r,"folderId");_a.$4.$J(f,"successCallback");if(t<0)throw Error.argumentOutOfRange("offset");if(i<0)throw Error.argumentOutOfRange("maxItemsToReturn");var h=_e.$2Q.$5Df(u);var o=[];var s=0;n.$BT(new _a.$6j("PartialPersonaItem.BrowsePeople"),function(u){var f=u.$Dg(_e.$1I.get_$I().$1Rq.get_$1L());var e=new _a.$8k(_e.$2Q.$1u7,r.Id);var c=new _a.$8J(e,h);f.$It(c,function(r){r.$B(function(n){s=n},null);r.$1U9(t,function(){r.$Dd(i,function(t,i,r){for(var f=i,e=f.length,u=0;u<e;++u){var s=f[u];var h=n.$13C(s);Array.add(o,h.get_$20().Persona)}},null)},null)},null)},function(){f(o,s)},function(n){_e.$1f.$D6(n,e)})};_e.$2Q.$5Df=function(n){var i=null;if(!$6(n)){i=new Array(n.length);for(var t=0;t<n.length;t++){var r=_e.$2Q.$5SY(n[t].Path.FieldURI);var u=n[t].Order==="Ascending"?0:1;i[t]=new _a.$IL(r,u)}}return i};_e.$2Q.$7aS=function(n,t){var i=n.Item;var r=i.Item.FieldURI;var u=_e.$2Q.$5SY(r);var f=i.FieldURIOrConstant.Item.Value;var e=_e.$2Q.$8Hw(f,t);return new _a.$Nf(u,e,1,0)};_e.$2Q.$5SY=function(n){switch(n){case"PersonaCompanyName":return _e.$2Q.$2oq;case"PersonaHomeCity":return _e.$2Q.$2yP;case"PersonaCreationTime":return _e.$2Q.$2q6;case"PersonaRelevanceScore":return _e.$2Q.$4Q6;case"PersonaDisplayNameFirstLast":return _e.$2Q.$1BP;case"PersonaDisplayNameLastFirst":return _e.$2Q.$1M4;case"PersonaWorkCity":return _e.$2Q.$3UB;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};_e.$2Q.$8Hw=function(n,t){return t[n]};_e.$2Q.prototype={get_$i1:function(){return _e.$1I.get_$I().$1Rq},$7ne:function(n){return _e.$2Q.$7nh(n.FolderId,n.Persona.PersonaId)},$7ni:function(n){return new ItemMetadata},$A22:function(n){_a.$4.$J(n.FolderId,"FolderId");_a.$4.$1G(n.FolderId.Id,"FolderId.Id");_a.$4.$J(n.Persona.PersonaId,"Persona.PersonaId");_a.$4.$1G(n.Persona.PersonaId.Id,"Persona.PersonaId.Id")},$5AK:function(n,t,i){_e.$LW.$5AG(n.Persona,t,i,this.$6Y.get_$Ta())}};_e.$UY=function(n,t,i,r){_e.$UY.initializeBase(this,[n,t,i,!0,r,3])};function $3Xl(n,t,i){for(var o=i,l=o.length,r=0;r<l;++r){var u=o[r];var f=null;if(t==="RowDeleted"){var s=n.$A4R(u.$4s);if(!s){_js.Trace.logInfo(_a.$0.$Q4,String.format("PersonaType item not present in client store id: {0}",u.$4s.toString()));return}f=s.get_$20()}else{var a=u.$27;f=a.Data}for(var h=f.FolderIds,v=h.length,e=0;e<v;++e){var c=h[e];c&&_e.$2l.$5P7(c.Id,t,n.get_$2cQ())}}}_e.$UY.prototype={get_$uD:function(){return _e.$1I.get_$I().$1Y8.get_$1L()},get_$2cQ:function(){return!0},$7qk:function(n){$3Xl(this,"RowAdded",n.get_$lB());$3Xl(this,"RowModified",n.get_$lg());$3Xl(this,"RowDeleted",n.get_$12G())},$2vy:function(n){return n.get_$3ig()}};_e.$1Ae=function(n){_e.$1Ae.initializeBase(this);this.$6Y=n};_e.$1Ae.prototype={$6Y:null,$6Hg:function(n){this.$6Y.$pk(n)}};_e.$6H=function(n,t,i,r,u){_a.$4.$J(n,"completePersonaItemStore");_a.$4.$J(t,"partialPersonaItemStore");_a.$4.$J(i,"addressbookOperationItemStore");_a.$4.$J(r,"addressbookPersonaItemStore");_a.$4.$J(u,"clientStoreSettings");this.$1qz=n;this.$tF=t;this.$3cm=i;this.$3cn=r;this.$5BH=u};_e.$6H.$$cctor=function(){_e.$6H.$2Gp=[]};_e.$6H.$E=function(n){_a.$4.$l(n,"storeGetter");return new _e.$6H(n.get_$3ig(),n.get_$6Gw(),n.get_$7OM(),n.get_$7ON(),new _e.$AB(n))};_e.$6H.$9Zj=function(n){_a.$4.$J(n,"observer");Array.add(_e.$6H.$2Gp,n)};function $70e(n,t){var i=t.DisplayNameLastFirst||"";if(_js.$9.$18(i)){i+=t.Surname||"";i+=t.GivenName||""}return i}function $70d(n,t){var i=t.DisplayNameFirstLast||"";if(_js.$9.$18(i)){i+=t.GivenName||"";i+=t.Surname||""}return i}function $4pI(n,t,i,r,u){var f=$70a(n,i,r);var e=this;n.$tF.$NT(t,f,function(t){t.$Dd(1,function(t,f,e){$70g(n,i,r,f);u()},null)})}function $70g(n,t,i,r){if(r.length>0){var u=n.$tF.$13C(r[0]);if(i===1){t.DisplayNameFirstLastSortKey=(u.get_$20().Persona.DisplayNameFirstLastSortKey||"")+"00";t.DisplayNameFirstLastHeader=u.get_$20().Persona.DisplayNameFirstLastHeader}else{t.DisplayNameLastFirstSortKey=(u.get_$20().Persona.DisplayNameLastFirstSortKey||"")+"00";t.DisplayNameLastFirstHeader=u.get_$20().Persona.DisplayNameLastFirstHeader}}}function $70a(n,t,i){var r=null;var u=null;if(i===1){r=_e.$2Q.$3o0;u=$70d(n,t)}else{r=_e.$2Q.$3o2;u=$70e(n,t)}var f=new _a.$Nf(r,u,0,1);return new _a.$8J(f,[new _a.$IL(r,1)])}function $70c(n,t,i){var r=new PartialPersonaRecord(t,i);return n.$tF.$qa(r)}function $70b(n,t){var i=new _g.$Cz;i.PersonaId=t.PersonaId;i.ADObjectId=t.ADObjectId;i.PersonaTypeString=t.PersonaTypeString;i.EmailAddress=t.EmailAddress;i.CompanyName=t.CompanyName;i.DisplayName=t.DisplayName;i.DisplayNameFirstLast=t.DisplayNameFirstLast;i.DisplayNameLastFirst=t.DisplayNameLastFirst;i.GivenName=t.GivenName;i.Surname=t.Surname;i.EmailAddresses=t.EmailAddresses;i.ImAddress=t.ImAddress;i.FileAs=t.FileAs;i.HomeCity=t.HomeCity;i.WorkCity=t.WorkCity;i.CreationTimeString=t.CreationTimeString;i.DisplayNameFirstLastHeader=t.DisplayNameFirstLastHeader;i.DisplayNameLastFirstHeader=t.DisplayNameLastFirstHeader;i.RelevanceScore=t.RelevanceScore;i.ThirdPartyPhotoUrlsArray=t.ThirdPartyPhotoUrlsArray;i.AttributionsArray=t.AttributionsArray;i.Alias=t.Alias;i.CompanyNameSortKey=t.CompanyNameSortKey;i.DisplayNameFirstLastSortKey=t.DisplayNameFirstLastSortKey;i.DisplayNameLastFirstSortKey=t.DisplayNameLastFirstSortKey;i.HomeCitySortKey=t.HomeCitySortKey;i.WorkCitySortKey=t.WorkCitySortKey;return i}function $70f(n,t,i){_e.$6H.$4XP?i(_e.$6H.$4XP):n.$5BH.$7wN(t,i)}_e.$6H.prototype={$1qz:null,$tF:null,$3cm:null,$3cn:null,$5BH:null,$3fl:function(n,t,i,r,u,f){_e.$2Q.$3fl(this.$tF,n,t,i,r,u,f)},$9g9:function(n,t,i,r,u){_a.$4.$J(n,"condition");_a.$4.$J(t,"folderId");_a.$4.$J(i,"sortParams");_a.$4.$J(r,"successCallback");var f=-1;var e=this,o=this,s=this;this.$tF.$BT(new _a.$6j("PersonaStore.SeekToCondition"),function(r){$70f(e,r,function(u){var e=_e.$2Q.$5Df(i);var o=_e.$2Q.$7aS(n,u);var s=r.$Dg(_e.$1I.get_$I().$1Rq.get_$1L());var h=new _a.$8k(_e.$2Q.$1u7,t.Id);var c=new _a.$8J(h,e);s.$It(c,function(n){n.$1jv(0,o,function(t){f=n.get_$Iv()},null)},null)})},function(){r(f)},function(n){_e.$1f.$D6(n,u)})},$Fy:function(n,t,i,r){var u=this;this.$1qz.$Fy(n,_e.$LW.$3qa(t),function(n){i(n?n.get_$20():null)},r)},$tl:function(n,t,i,r){var f=null;var s=this.$1qz.$qa(t);var c=this;this.$1qz.$tl(n,s,i,function(n){f=new _g.$1q(n.toString())});var e={};var h=new _a.$8k(_e.$2Q.$3I2,t.PersonaId.Id);var u=this;this.$tF.$6LN(n,new _a.$8J(h,null),100,function(o,s,h,c){for(var v=h,d=v.length,l=0;l<d;++l){var g=v[l];var y=u.$tF.$13C(g);e[y.get_$20().FolderId.Id]=y.get_$1y()}if(c){for(var nt=$70b(u,t),tt=0,p=t.FolderIds,it=p.length,a=0;a<it;++a){var w=p[a];delete e[w.Id];var rt=$70c(u,nt,w);u.$tF.$tl(n,rt,i,function(n){++tt===t.FolderIds.length&&f&&_e.$1f.$A4S(_g.$1q,f,r)})}var b=e;for(var k in b){var ut={key:k,value:b[k]};u.$tF.$Ht(n,ut.value)}}},null);var o=this;Array.forEach(_e.$6H.$2Gp,function(i){var r=i;r.$9Mb(t,n,o.$3cm,o.$3cn)})},$Ht:function(n,t){var i=this;this.$Fy(n,t,function(r){i.$1qz.$Ht(n,_e.$LW.$3qa(t));var u=new _a.$8k(_e.$2Q.$3I2,t.Id);i.$tF.$1s9(n,u,null);r&&Array.forEach(_e.$6H.$2Gp,function(t){var u=t;u.$6A0(r,n,i.$3cm,i.$3cn)})},null)},$pk:function(n){this.$1qz.$pk(n);this.$tF.$pk(n)},$5PE:function(n,t,i){var r=2;var u=0;var f=this;$4pI(this,n,t,1,function(){++u===r&&i()});var e=this;$4pI(this,n,t,0,function(){++u===r&&i()})}};_e.$ee=function(n,t,i,r,u,f,e){_e.$ee.initializeBase(this);this.$6Y=n;this.$5C8=i;this.$6Gx=r;this.$FP=t;this.$1VB=u;this.$1sC=f;this.$44S=e};function $4pJ(n,t,i){for(var f=0,e=n.$1VB.length-i,r=Math.min(e,5),u=0;u<r;u++){var o=n.$1VB[i+u];var s=this;n.$6Y.$tl(t,o,1,function(){++f===r&&$4pJ(n,t,i+r)})}}_e.$ee.prototype={$6Y:null,$1VB:null,$1sC:null,$5C8:null,$6Gx:null,$2JD:null,$1iy:null,$44S:null,$FP:null,get_$5IS:function(){return this.$2JD?_0365f.$58.$B(this.$2JD):0},get_$3Jm:function(){return this.$1iy?this.$1iy.length:0},$9YM:function(n,t,i){this.$2JD={};var r=this;_e.$3V.$9YM(_bc.$pQ,n,this.$5C8,t,this.$2JD,function(){_e.$3V.$9YM(_bc.$pt,n,r.$6Gx,t,r.$2JD,i)})},$9UF:function(n){},$6Hg:function(n){this.$1VB&&$4pJ(this,n,0);if(this.$1sC)for(var i=this.$1sC,r=i.length,t=0;t<r;++t){var u=i[t];this.$6Y.$Ht(n,u)}this.$44S&&this.$FP.$9kG(n,this.$44S,null)}};function ConfigChangeCleanupModuleItem(n,t){_a.$4.$J(t,"syncManagerStartTime");this.ModuleType=n;this.SyncManagerStartTime=t}ConfigChangeCleanupModuleItem.prototype={ModuleType:0,SyncManagerStartTime:null};function MessageItemRecord(){MessageItemRecord.initializeBase(this)}MessageItemRecord.$2LB=function(n){return n};MessageItemRecord.prototype={CustomSyncData:null};_e.$62=function(){_e.$62.initializeBase(this)};_e.$62.$U=function(n,t,i,r,u){var f=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;t.$BT(new _a.$6j(String.format("SettingItem.GetValue({0})",i)),function(r){_e.$62.$A5f(n,t,r,i,function(n){f=n})},function(){r(f)},_e.$1f.$Zb(u))};_e.$62.$A5f=function(n,t,i,r,u){t.$Fy(i,_e.$1h.$5f(r),function(t){if(t){var i=t.get_$20();u(i.Value)}else u(n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},null)};_e.$62.$K=function(n,t,i,r,u,f){t.$BT(new _a.$6j(String.format("SettingItem.SetValue({0})",i)),function(u){_e.$62.$A5g(n,t,u,i,r,null)},function(){u()},_e.$1f.$Zb(_e.$1f.$5EE(f)))};_e.$62.$A5g=function(n,t,i,r,u,f){var e=new SettingRecord;e.Id=r;e.Value=u;var o=t.$qa(e);o.$E7(i,function(){_e.$1f.$kR(f)})};_e.$62.$2rU=function(n,t){_e.$y.$A4N(_e.$62,n,_e.$1h.$5f(t),null)};_e.$62.prototype={get_$i1:function(){return _e.$1I.get_$I().$2cC},$7ni:function(n){return new ItemMetadata},$7ne:function(n){return _e.$1h.$5f(n.Id)},$A22:function(n){}};_e.$AB=function(n){this.$6Y=n.get_$6US();this.$6bD=n.get_$1lx()};_e.$AB.$2L8=function(n){var t=new _e.$Tt(n,_e.$1n.$7e);return new _e.$AB(t)};_e.$AB.$7hE=function(n){_e.$62.$2rU(n,"CalendarFolders")};_e.$AB.$7hT=function(n){_e.$62.$2rU(n,"FavoriteFolders")};_e.$AB.$7hr=function(n){_e.$62.$2rU(n,"OtherMailboxConfiguration")};function $4pL(n){_js.Trace.logInfo(_a.$0.$5a,"Mark email data as outdated");var t=new _e.$k0(_a.$7G.$E());t.$3cZ(11,"")}function $70i(n,t,i,r){_e.$62.$K(String,n.$6Y,"DatabaseId",t,i,r)}_e.$AB.prototype={$6Y:null,$6bD:null,$7sj:function(n,t){var i=this;_e.$62.$U(String,this.$6Y,"DatabaseId",n,function(n){t(n.$SQ())})},$7wm:function(n,t){var i=this;_e.$62.$U(Boolean,this.$6Y,"Provisioned",n,function(n){t(n.$SQ())})},$qg:function(n,t){_e.$62.$U(_g.$L3,this.$6Y,"OwaUserConfiguration.1",n,t)},$9kO:function(n,t,i){_e.$62.$K(Boolean,this.$6Y,"Provisioned",n,t,i)},$1kS:function(n,t){var i=this,r=this;this.$qg(function(r){if(r){(r.UserOptions.ConversationSortOrder!==n.ConversationSortOrder||r.UserOptions.HideDeletedItems!==n.HideDeletedItems)&&$4pL(i);r.UserOptions.ConversationSortOrder=n.ConversationSortOrder;r.UserOptions.HideDeletedItems=n.HideDeletedItems;r.UserOptions.ShowSenderOnTopInListView=n.ShowSenderOnTopInListView;r.UserOptions.ShowPreviewTextInListView=n.ShowPreviewTextInListView;r.UserOptions.ShowInferenceUiElements=n.ShowInferenceUiElements;i.$6Y.$BT(new _a.$6j("Settings.SetLayoutSettings"),function(n){i.$3NQ(n,r,null)},function(){_js.Trace.logInfo(_a.$0.$5a,"SetLayoutSettings to offline store succeeded");t()},function(n){_js.Trace.logError(_a.$0.$5a,"SetLayoutSettings to offline store failed with dbError: {0}",n.$3v);t()})}else{_js.Trace.logWarning(_a.$0.$5a,"When user changes the UserConfig via inline settings, the OwaUserConfiguration has not been synced yet");t()}},function(n){_js.Trace.logError(_a.$0.$5a,"Mark email data outdated when we failed to GetOwaUserConfiguration with clientStoreError: {0}",n.get_$52());$4pL(r);t()})},$3NQ:function(n,t,i){_e.$62.$A5g(_g.$L3,this.$6Y,n,"OwaUserConfiguration.1",t,i)},$9k9:function(n,t,i){var r=this;this.$qg(function(u){if(u){u.ViewStateConfiguration||(u.ViewStateConfiguration=new _g.$UR);n(u.ViewStateConfiguration);r.$6Y.$BT(new _a.$6j("Settings.SetOwaViewStateConfiguration"),function(n){r.$3NQ(n,u,null)},function(){t()},function(n){i(new _e.$1f(n))})}else t()},i)},$3NU:function(n,t){var i=this,r=this;this.$qg(function(r){if(r){r.UserOptions.TimeZone=n;i.$6Y.$BT(new _a.$6j("Settings.SetTimeZone"),function(t){_e.$Q7.$2M9(i.$6bD,t,function(u){for(var f=0;f<u.length;f++)u[f].get_$20().TimeZoneId===n&&(r.UserOptions.MailboxTimeZoneOffset=[u[f].get_$20()]);i.$3NQ(t,r,null)},function(n){_js.Trace.logError(_a.$0.$5a,"Failed to load the time zone offsets table: {0}",n.get_$52())})},function(){_js.Trace.logInfo(_a.$0.$5a,"SetTimeZone {0} to offline store succeeded",n);t()},function(i){_js.Trace.logError(_a.$0.$5a,"SetTimeZone {0} to offline store failed with dbError: {1}",n,i.$3v);t()})}else t()},function(i){_js.Trace.logError(_a.$0.$5a,"SetTimeZone can't retrieve OwaUserConfiguration from offline store, new timezone {0} can't be updated to offline store. ClientStoreError is {1}",n,i.get_$52());t()})},$7uO:function(n,t){_e.$62.$A5f(_g.$pW,this.$6Y,n,"IdentityCorrelationTable",t)},$9jL:function(n,t,i){_e.$62.$A5g(_g.$pW,this.$6Y,n,"IdentityCorrelationTable",t,i)},$7WO:function(n,t){_e.$62.$2rU(n,"IdentityCorrelationTable")},$1ua:function(n,t){_e.$62.$U(_g.$Jh,this.$6Y,"CalendarFolders",n,t)},$9iK:function(n,t,i){_e.$62.$A5g(_g.$Jh,this.$6Y,n,"CalendarFolders",t,i)},$2vj:function(n,t){_e.$62.$U(_g.$P5,this.$6Y,"FavoriteFolders",n,t)},$13L:function(n,t){_e.$62.$U(_g.$RV,this.$6Y,"OtherMailboxConfiguration",n,t)},$9im:function(n,t,i){_e.$62.$A5g(_g.$P5,this.$6Y,n,"FavoriteFolders",t,i)},$9k6:function(n,t,i){_e.$62.$A5g(_g.$RV,this.$6Y,n,"OtherMailboxConfiguration",t,i)},$7uh:function(n,t){_e.$62.$A5f(Boolean,this.$6Y,n,"IsOfflineComponentReadyToUse",t)},$9jd:function(n,t,i){_e.$62.$A5g(Boolean,this.$6Y,n,"IsOfflineComponentReadyToUse",t,i)},$7wN:function(n,t){_e.$62.$A5f(Object,this.$6Y,n,"PersonaJumpHeaderMappings",t)},$9kG:function(n,t,i){_e.$62.$A5g(Object,this.$6Y,n,"PersonaJumpHeaderMappings",t,i)}};_e.$Q7=function(){_e.$Q7.initializeBase(this)};_e.$Q7.$2M9=function(n,t,i,r){_a.$4.$J(n,"timeZoneOffsetsItemStore");_a.$4.$J(i,"successCallback");var u=[];var f=t.$Dg(_e.$1I.get_$I().$2B2.get_$1L());f.$It(null,function(t){t.$Dd(1e3,function(t,r,f){for(var e=0;e<r.length;++e)Array.add(u,n.$13C(r[e]));i(u)},null)},function(n){_e.$1f.$D6(n,r)})};_e.$Q7.prototype={get_$i1:function(){return _e.$1I.get_$I().$2B2},$A22:function(n){_a.$4.$J(n.TimeZoneId,"TimeZoneId")},$7ne:function(n){return _e.$1h.$5f(n.TimeZoneId)},$7ni:function(n){return new ItemMetadata}};_e.$mO=function(){_e.$mO.initializeBase(this)};_e.$mO.get_$5fj=function(){return new _a.$4o("Data.TombstoneType")};_e.$mO.prototype={get_$i1:function(){return _e.$1I.get_$I().$2B6},$7ni:function(n){return new ItemMetadata},$7ne:function(n){return _e.$1h.$5f(n.Id)},$A22:function(n){_a.$4.$1G(n.Id,"id")}};_e.$10h=function(n,t){_e.$10h.initializeBase(this,[n,t])};_e.$10h.prototype={$5Mp:function(n,t,i,r,u){_a.$4.$J(n,"tx");_a.$4.$J(i,"tombstonedItemsToBeDeleted");_a.$4.$J(r,"perItemCallback");_a.$4.$J(u,"completedCallback");var e=100;var o=[];var s=new _a.$8k(_e.$mO.get_$5fj(),t);var h=new _a.$8J(s,null);var f=this;this.$6LN(n,h,e,function(t,e,s,h){_js.Trace.logInfo(_e.$1n.$A,"Found {0} tombstoned items",o.length);for(var l=s,v=l.length,c=0;c<v;++c){var y=l[c];var a=f.$13C(y);r(a.get_$20());Array.add(i,a.get_$1y())}if(h){_e.$CM.$A5K(_bc.$18X,n,f,i);u()}},null)}};_e.$xP=function(){};_e.$xP.registerInterface("_e.$xP");_e.$12H=function(n){_e.$12H.initializeBase(this,[n,"CalendarSyncState"]);this.$46u=750};_e.$12H.prototype={$46u:0,$5Yz:function(n,t,i){var r=t;var f=i;if(r.TryToIncrementWindowSizeOnNextSync){_js.Trace.logInfo(_a.$0.$1Ox,"CalendarSyncState.TryToIncrementWindowSizeOnNextSync is true. Need to count the existing items in the store.");var u=this;f.$4N6(n,function(){_e.$7y.$7yD(n,function(t){if(t>=u.$46u){_js.Trace.logInfo(_a.$0.$1Ox,"Calendar sync have exceeded the limit ({0} stored items,) and therefore won't grow the sync window anymore (Approximate Window Size: {1} months).",u.$46u,r.ApproximateWindowSize);r.TryToIncrementWindowSizeOnNextSync=!1}else _js.Trace.logInfo(_a.$0.$1Ox,"The number of stored calendar items ({0}) are below the limit --> Sync will try to grow the window on next attempt.",t);u.get_$bV().$4N7(n,r)},function(n){_js.Trace.logError(_a.$0.$1Ox,"Unable to count the existing items in the store (Error: {0}).",n.$9a())})})}else _e.$dE.prototype.$5Yz.call(this,n,t,i)}};_e.$7y=function(n,t,i,r,u,f,e,o,s){this.$$d_$7hp=Function.createDelegate(this,this.$7hp);_e.$7y.initializeBase(this);this.$1iy=_a.$3n.$$(_g.$6O).$8A();this.$8y=n;this.$vJ=_e.$a0.$8A(n);this.$6VL=t;this.$4ZG=i;this.$2fU=r;this.$3Jt=u;this.$6M9=f;this.$1sH=e;this.$33i=o;this.$1Ib=s};_e.$7y.$7yD=function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"callback");var u=-1;var f=-1;var r=function(n){_e.$1f.$D6(n,i)};var e=n.$Dg(_e.$1I.get_$I().$vF.get_$1L());e.$3xH(null,function(n){n.$B(function(n){f!==-1?t(n+f):u=n},r)},r);var o=n.$Dg(_e.$1I.get_$I().$1A7.get_$1L());o.$3xH(null,function(n){n.$B(function(n){u!==-1?t(n+u):f=n},r)},r)};_e.$7y.$35D=function(n){};function $6yS(n,t,i){var r=this;n.$A5b(_g.$1q,t,n.$1sH,_e.$5w.$5MO,!0,function(){n.$A5b(_g.$6O,t,n.$6M9,_e.$Dh.$1MW,!1,function(){n.$A5b(_g.$6O,t,n.$2fU,function(n){return n.CalendarItemType==="Single"?_e.$Dh.$1MW(n):null},!1,i)})})}function $3Xb(n,t,i,r,u){var o=n.$3Jt.length-i;var f=Math.min(o,r);_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Persisting reucrrence masters with instances (startIndex: {0}; remaining: {1}; count: {2})...",i,o,f);if(f)for(var s=0,e=0;e<f;e++){var c=n.$3Jt[i+e];var h=$4oY(n,c);if(h){var l=this;_e.$3V.$A4V(_bc.$Kp,_g.$7k,n.$vJ.$1qL,t,h,n.$$d_$7hp,function(e){_e.$7y.$35D(e);++s===f&&$3Xb(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3V.$A,"CalendarSyncChangeUpdater: The data is null/undefined in the RecurrenceMastersWithInstances list.");++s===f&&$3Xb(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Done persisting {0} recurrence masters...",n.$3Jt.length);u()}}function $3Xa(n,t,i,r,u){var s=n.$2fU.length-i;var f=Math.min(s,r);_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Persisting updates (startIndex: {0}; remaining: {1}; count: {2})...",i,s,f);if(f)for(var h=0,e=0;e<f;e++){var c=n.$2fU[i+e];var o=$4oY(n,c);if(o){var l=this;_e.$3V.$A4V(_bc.$Lt,_g.$7k,n.$vJ.$1A6,t,o,null,function(e){_e.$7y.$35D(e);++h===f&&$3Xa(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3V.$A,"CalendarSyncChangeUpdater: The data is '{0}' in the UpdatedItems list.",o);++h===f&&$3Xa(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Done persisting {0} updates.",n.$2fU.length);_e.$1f.$kR(u)}}function $4oZ(n,t){for(var r=n.$1sH,u=r.length,i=0;i<u;++i){var f=r[i];if(f.Id===t)return!0}return!1}function $4oY(n,t){var i;if($4oZ(n,t.ItemId.Id)){_js.Trace.logInfo(_e.$3V.$A,"Item present in delete list: {0}",t.ItemId.Id);return null}if(t.CalendarItemType==="Occurrence"){var r=n.$1Ib.get_$3q(t.UID);if(r)if($4oZ(n,r)){_js.Trace.logWarning(_e.$3V.$A,"The master item is deleted for the occurrence with Id {0}",t.ItemId.Id);return null}else{i=n.$33i.get_$3q(r);i.ItemId=t.ItemId;i.CalendarItemType=t.CalendarItemType;i.Start=t.Start;i.StartWallClock=t.StartWallClock;i.End=t.End;i.EndWallClock=t.EndWallClock;i.Recurrence=undefined;i.IsRecurring=!0;i.ItemClass="IPM.Appointment.Occurrence"}else{_js.Trace.logInfo(_e.$3V.$A,"The master item is not downloaded for the occurrence with UID {0}",t.UID);i=n.$33i.get_$3q(t.ItemId.Id)}}else i=n.$33i.get_$3q(t.ItemId.Id);if(!i){var u=String.format("Could not find the data for item (Type: {0}; ID: {1}; UID: {2}).",t.CalendarItemType,t.ItemId.Id,t.UID);_js.Trace.logError(_e.$3V.$A,u);throw Error.create(u);}return i}function $6yT(n,t,i){if(n.$6VL){_js.Trace.logInfo(_e.$3V.$A,"Prune calendar items ending before (not including) the sync window's start time ('{0}')...",n.$4ZG);var r=new _a.$Nf(_e.$5w.$3pV,n.$4ZG,0,1);var u=this;n.$vJ.$1A6.$1s9(t,r,function(){i()})}else i()}_e.$7y.prototype={$vJ:null,$2fU:null,$3Jt:null,$6M9:null,$1sH:null,$33i:null,$1Ib:null,$4ZG:null,$6VL:!1,$8y:null,$12L:null,$1iy:null,get_$5IS:function(){return this.$12L?_0365f.$58.$B(this.$12L):0},get_$3Jm:function(){return this.$1iy?this.$1iy.$A3p():0},$9YM:function(n,t,i){this.$12L={};var r=this;_e.$3V.$9YM(_bc.$Kp,n,this.$8y.get_$lc(),t,this.$12L,function(){_e.$3V.$9YM(_bc.$Lt,n,r.$8y.get_$1k(),t,r.$12L,i)})},$3rq:function(n){_e.$3V.$3rq(this.$12L,n)},$9UF:function(n){var t=this;this.$3rq(function(i){var r=t.$1iy.get_$3q(i);$6(r)?_js.Trace.logInfo(_e.$3V.$A,"Item data not found to reconcile (Id: {0}).",i):r.CalendarItemType==="RecurringMaster"?_e.$3V.$A4V(_bc.$Kp,_g.$6O,t.$vJ.$1qL,n,r,null,_e.$7y.$35D):_e.$3V.$A4V(_bc.$Lt,_g.$6O,t.$vJ.$1A6,n,r,null,_e.$7y.$35D)})},$6Hg:function(n){this.$4N6(n,null)},$4N6:function(n,t){var i=this;$6yT(this,n,function(){_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Successfully finished prunning calendar items.");$6yS(i,n,function(){_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Successfully finished persisting deletes.");$3Xb(i,n,0,1,function(){_js.Trace.logInfo(_e.$3V.$A,"CalendarSyncChangeUpdater: Successfully finished persisting recurrence masters.");$3Xa(i,n,0,25,t)})})})},$A5b:function(n,t,i,r,u,f){var e=i.length;if(i&&e){var o;var a=this;var h=function(n){a.$vJ.$5I9(t,n,function(){--e||f()})};if(u){var v=this;o=function(n){v.$vJ.$1A6.$2rM(t,n,function(){h(n)})}}else o=h;for(var c=i,y=c.length,s=0;s<y;++s){var p=c[s];var l=r(p);l?o(l):e===1?f():--e}}else f()},$7hp:function(n,t,i){var r=this;this.$vJ.$5I5(t,n.get_$1y(),function(u){u||r.$vJ.$1A6.$Ht(t,n.get_$1y());r.$vJ.$1qL.$tl(t,n,1,i)})}};_e.$i6=function(n,t,i){_e.$i6.initializeBase(this);_a.$4.$l(n,"calendarFolderId");_a.$4.$l(t,"windowStart");_a.$4.$l(i,"windowEnd");t.localeCompare(i)>0&&Error.argumentOutOfRange("windowStart",t,String.format("Window start has to be less than window end ({0}).",i));this.$58q=n;this.$1Iy=t;this.$1VR=i};_e.$i6.prototype={$58q:null,$1Iy:null,$1VR:null};_e.$np=function(n){_e.$np.initializeBase(this);_a.$4.$J(n,"cleaner");this.$5Ah=n};_e.$np.prototype={$5Ah:null,$6Hg:function(n){_a.$4.$J(n,"tx");this.$5Ah(n)}};function ConversationItemSyncState(n,t,i){ConversationItemSyncState.initializeBase(this,["ConversationNodeSyncStateId",n,t]);this.$5DL=i}ConversationItemSyncState.prototype={$5DL:null};_e.$aI=function(n,t,i,r,u){_e.$aI.initializeBase(this);_a.$4.$J(n,"itemStoreGetter");_a.$4.$J(t,"conversationChanges");_a.$4.$J(i,"itemChanges");_a.$4.$J(r,"itemIds");_a.$4.$J(u,"attachments");this.$8y=n;this.$5D7=t;this.$5fQ=i;this.$BN=r;this.$9M=u};function $6zE(n,t,i,r,u,f){_a.$4.$J(t,"tx");var e=this;$6zF(n,t,i,f,function(){var f=[];_e.$3V.$A4Y(_bc.$Lx,_g.$7k,n.get_$5kd(),t,r,function(n){return _e.$1h.$5f(n.ItemId.Id)},function(e){for(var l=r,a=l.length,o=0;o<a;++o){var s=l[o];var h=e.$Mj(s.ItemId.Id)?e.get_$3q(s.ItemId.Id).get_$20():null;var c=_g.$ur.$8JS(h,s);h&&(c=_g.$RF.$5Di(h,c));Array.add(f,c)}_e.$3V.$A4T(_bc.$jN,_g.$aK,n.get_$5DD(),t,i,null);_e.$3V.$A4T(_bc.$Lx,_g.$7k,n.get_$5kd(),t,f,null);_e.$3V.$A4T(_bc.$pL,AttachmentInfoRecord,n.get_$7RL(),t,u,null)})})}function $6zF(n,t,i,r,u){for(var o=0,e=i,s=e.length,f=0;f<s;++f){var h=e[f];var c=this;n.get_$5DD().$Fy(t,_e.$1h.$5f(h.ConversationId.Id),function(f){if(f){var h=f.get_$20();if(h.ConversationNodes)for(var c=h.ConversationNodes,y=c.length,e=0;e<y;++e)for(var l=c[e],s=0;s<l.Items.length;s++){var a=l.Items[s];var v=a.ItemId.Id;if(!r.get_$3q(v)){var p=n.get_$4ax().$qa(TombstonedItemRecord.$E(v,"MessageItem",a));p.$3Ln(t,1,null)}}}++o===i.length&&u()},null)}}_e.$aI.prototype={$8y:null,$5D7:null,$5fQ:null,$BN:null,$9M:null,$2ru:null,$3nj:null,$5DJ:null,$8EY:null,get_$5IS:function(){return this.$2ru?_0365f.$58.$B(this.$2ru)+_0365f.$58.$B(this.$3nj):0},get_$3Jm:function(){return this.$5DJ?this.$5DJ.length+this.$8EY.length:0},get_$5kd:function(){return this.$8y.get_$52()},get_$5DD:function(){return this.$8y.get_$HP()},get_$7RL:function(){return this.$8y.get_$1K9()},get_$4ax:function(){return this.$8y.get_$4aw()},$6Hg:function(n){$6zE(this,n,this.$5D7,this.$5fQ,this.$9M,this.$BN)},$9YM:function(n,t,i){this.$2ru={};this.$3nj={};var r=this;_e.$3V.$9YM(_bc.$jN,n,this.$8y.get_$HP(),t,this.$2ru,function(){_e.$3V.$9YM(_bc.$Lx,n,r.$8y.get_$52(),t,r.$3nj,i)})},$9UF:function(n){}};_e.$T0=function(n,t,i){_e.$T0.initializeBase(this,[n,t,i])};function $6zG(n,t,i){if(!t.GlobalItemChangeKeys||!t.GlobalItemReadFlags||!i.GlobalItemChangeKeys||!i.GlobalItemReadFlags)return!1;for(var f=0;f<t.GlobalItemIds.length;f++);for(var e=0;e<i.GlobalItemIds.length;e++);if(t.GlobalItemIds.length!==i.GlobalItemIds.length)return!1;var u=t.GlobalItemIds.length;if(t.GlobalItemChangeKeys.length!==u||i.GlobalItemChangeKeys.length!==u)return!1;for(var r=0;r<u;r++)if(t.GlobalItemIds[r].Id!==i.GlobalItemIds[r].Id||t.GlobalItemChangeKeys[r]!==i.GlobalItemChangeKeys[r])return!1;return!0}function $6zH(n,t,i){if(!n.get_$A5M().length){i();return}var r=[];var u=this,f=this;_e.$3V.$A4Y(_bc.$16y,_g.$W0,n.get_$5fi(),t,n.get_$A5M(),function(n){return _e.$E9.$13B(n.FolderId,n.ConversationId)},function(t){for(var o=n.get_$A5M(),h=o.length,e=0;e<h;++e){var u=o[e];var s=_e.$E9.$13B(u.FolderId,u.ConversationId);u.DirtyState=2;var f=t.$Mj(s.get_$1dL().toString())?t.get_$3q(s.get_$1dL().toString()).get_$20():null;if(f){if(n.get_$A5L()!==11&&n.get_$A5L()!==10||f.LastModifiedTime!==u.LastModifiedTime){f.DirtyState!==2&&$6zG(n,u,f)&&(u.DirtyState=1);Array.add(r,u)}}else Array.add(r,u)}n.set_$A5M(r);i()})}_e.$T0.prototype={$6Hg:function(n){var t=this;$6zH(this,n,function(){_e.$Xe.prototype.$4N6.call(t,n,function(){t.$A5P(n)})})}};function EmailItemSyncState(n,t,i){EmailItemSyncState.initializeBase(this,[n,""]);_a.$4.$J(t,"itemIds");this.$5AD=i;this.$6A=t}EmailItemSyncState.prototype={$6A:null,$5AD:null};_e.$14s=function(n,t,i,r){_e.$14s.initializeBase(this,[n,t]);_a.$4.$1G(i,"outboxFolderId");_a.$4.$7t(r,0,2147483647,"outboxFolderPositionIndex");this.$16T=i;this.$3H9=r};_e.$14s.prototype={$16T:null,$3H9:0,$6Hg:function(n){_a.$4.$J(n,"tx");var t=this;this.get_$5fi().$1mO(n,_e.$1h.$5f(this.$16T),function(i){var u=i;var r=t.get_$A5J()[t.$3H9];if(u){r.TotalCount=u.get_$20().TotalCount;r.UnreadCount=u.get_$20().UnreadCount}else{r.TotalCount=0;r.UnreadCount=0}_e.$N1.prototype.$6Hg.call(t,n)},null)}};function MessageItemSyncState(n,t,i){MessageItemSyncState.initializeBase(this,["MessageItemSyncStateId",n,t]);this.$45P=i}MessageItemSyncState.prototype={$45P:!1};_e.$U7=function(n,t,i,r,u){_e.$U7.initializeBase(this,[n,t,i]);this.$26v=r;this.$1pP=u};function $70V(n,t){for(var i=0;i<n.$26v.length;i++){var r=n.$26v[i];var u=this;n.get_$5fi().$1mO(t,_e.$1h.$5f(r.ItemId.Id),function(n){var i=n;if(i){i.get_$20().IsRead=r.IsRead;i.$3Ln(t,1,null)}},null)}}function $70U(n,t,i){var r;if(t&&i.ItemId.ChangeKey===t.ItemId.ChangeKey){r=_g.$RF.$5Dl(i,t);if((n.get_$A5L()===11||n.get_$A5L()===10)&&t.IsRead===i.IsRead)return null}else r=i;_e.$Bt.$2bn(r,"false",0);return r}_e.$U7.prototype={$26v:null,$1pP:null,$6Hg:function(n){_a.$4.$J(n,"tx");var i=[];var r=this,t=this;_e.$3V.$A4Y(_bc.$Lx,_g.$7k,this.get_$5fi(),n,this.get_$A5M(),function(n){return _e.$1h.$5f(n.ItemId.Id)},function(r){for(var e=t.get_$A5M(),s=e.length,u=0;u<s;++u){var f=e[u];var h=r.$Mj(f.ItemId.Id)?r.get_$3q(f.ItemId.Id).get_$20():null;var o=$70U(t,h,f);o&&Array.add(i,o)}t.set_$A5M(i);t.$1pP&&t.$1pP.$5An(n,t.get_$A5N(),0,function(){});$70V(t,n);_e.$Xe.prototype.$4N6.call(t,n,function(){t.$A5P(n)})})}};_e.$Mf=function(n,t){this.$2cB=this.$$gta["_e.$Mf"].TItem===Number||Type.isEnum(this.$$gta["_e.$Mf"].TItem)?0:this.$$gta["_e.$Mf"].TItem===Boolean?!1:null;_e.$Mf.$$(this.$$gta["_e.$Mf"].TItem).initializeBase(this);_a.$4.$J(n,"setting");_a.$4.$J(t,"persister");this.$2cB=n;this.$6Hi=t};_e.$Mf.$$=function(n){var t="$Mf"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$Mf"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$Mf.apply(this,i)};r.registerClass("_e."+t,_e.$3V);var u=_e.$Mf.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$Mf.prototype={$6Hi:null,$6Hg:function(n){_a.$4.$J(n,"tx");this.$6Hi(this.$2cB,n)}};_e.$3c=function(){this.$$d_$9jb=Function.createDelegate(this,this.$9jb);this.$2k0={};_e.$3c.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_e.$3c.initializeBase(this);this.add_$4Rc(this.$$d_$9jb);this.add_$6Nn(this.$$d_$9jb)};function $6yB(n,t){var i=t.request.actionHandler;if(i){n.$2k0[t.id.toString()]=i;t.request.hasActionHandler=!0}}function $6yD(n,t){t.request.hasActionHandler&&(t.request.actionHandler=n.$2k0[t.id.toString()])}function $6yC(n,t){delete n.$2k0[t.toString()]}function $6y9(n,t){_e.$GO.$40r(t)?n.set_$3wm(n.$13a+1):n.$1ds++}function $6yA(n,t){_e.$GO.$40r(t)?n.$13a<=0?_js.Trace.logWarning(_e.$3c.$A,"Trying to decrement HighPriorityActionCount when it is already <= 0, value = {0}",n.$13a):n.set_$3wm(n.$13a-1):n.$1ds<=0?_js.Trace.logWarning(_e.$3c.$A,"Trying to decrement LowPriorityActionCount when it is already <= 0, value = {0}",n.$1ds):n.$1ds--}_e.$3c.prototype={$13a:0,$1ds:0,add_$8FB:function(n){this.$Y(_e.$3c.$2Qo.$1n,n)},remove_$8FB:function(n){this.$u(_e.$3c.$2Qo.$1n,n)},add_$6Nn:function(n){this.$Y(_e.$3c.$2aG.$1n,n)},remove_$6Nn:function(n){this.$u(_e.$3c.$2aG.$1n,n)},add_$4Rc:function(n){this.$Y(_e.$3c.$2aR.$1n,n)},remove_$4Rc:function(n){this.$u(_e.$3c.$2aR.$1n,n)},add_$59m:function(n){this.$Y(_e.$3c.$2GQ.$1n,n)},remove_$59m:function(n){this.$Y(_e.$3c.$2GQ.$1n,n)},add_$5an:function(n){this.$Y(_e.$3c.$2Ov.$1n,n)},remove_$5an:function(n){this.$Y(_e.$3c.$2Ov.$1n,n)},add_$9H1:function(n){this.$2N("HighPriorityActionEmptyChanged",n)},remove_$9H1:function(n){this.$2P("HighPriorityActionEmptyChanged",n)},get_$5gQ:function(){return this.$U(_e.$3c.$2Qo)},set_$5gQ:function(n){this.$K(_e.$3c.$2Qo,n);return n},get_$2aF:function(){return this.$U(_e.$3c.$2aG)},set_$2aF:function(n){this.$K(_e.$3c.$2aG,n);return n},get_$zj:function(){return this.$U(_e.$3c.$2aR)},set_$zj:function(n){this.$K(_e.$3c.$2aR,n);return n},get_$1qW:function(){return this.$U(_e.$3c.$2GQ)},set_$1qW:function(n){this.$K(_e.$3c.$2GQ,n);return n},get_$CL:function(){return this.$U(_e.$3c.$2Ov)},set_$CL:function(n){this.$K(_e.$3c.$2Ov,n);return n},get_$318:function(){return this.$13a>0},get_$3wm:function(){return this.$13a},set_$3wm:function(n){var t=this.$13a;this.$13a=n;(t<=0&&this.$13a>0||t>0&&this.$13a<=0)&&$eM(this,"HighPriorityActionEmptyChanged");return n},get_$8HJ:function(){return this.$1ds},set_$8HJ:function(n){this.$1ds=n;return n},$3pZ:function(n,t,i){var r=new _g.$3x(n);var u=this;this.$7lt(r,function(n){r.id=n;_js.Trace.logInfo(_e.$3c.$A,"{0} enqueued",_g.$3x.$U9(r));$6yB(u,r);u.set_$5gQ(r);u.set_$2aF(!0);$6y9(u,r);t(r)},i)},$7vd:function(n,t){var i=this;this.$7ve(function(t){if(t){_js.Trace.logInfo(_e.$3c.$A,"{0} retrieved as next request.",_g.$3x.$U9(t));$6yD(i,t)}else{_js.Trace.logInfo(_e.$3c.$A,"No requests available.");i.set_$2aF(!1)}n(t)},t)},$7vf:function(n,t){var i=this;this.$7vg(function(t){if(t)_js.Trace.logInfo(_e.$3c.$A,"{0} retrieved as next response.",_g.$3x.$U9(t));else{_js.Trace.logInfo(_e.$3c.$A,"No responses available.");i.set_$zj(!1)}n(t)},t)},$5PR:function(n,t){this.$7rI(n,t)},$34:function(n,t,i,r){$6yC(this,n);var u=this;this.$9b0(r,n,function(i,r){if(i){_js.Trace.logInfo(_e.$3c.$A,"Action Record {0} removed.",n);$6yA(u,r)}else _js.Trace.logInfo(_e.$3c.$A,"Action Record {0} was not present.",n);t(i)},i)},$9kV:function(n,t,i){n.state=1;var r=this;this.$6e4(n,function(){_js.Trace.logInfo(_e.$3c.$A,"{0} response saved.",_g.$3x.$U9(n));r.set_$zj(!0);t()},i)},$A0k:function(n,t,i){n.state=0;var r=this;this.$6e4(n,function(){_js.Trace.logInfo(_e.$3c.$A,"{0} updated in the database.",_g.$3x.$U9(n));t()},i)},$9jb:function(n,t){_js.Trace.logInfo(_e.$3c.$A,"RequestAvailable : {0}",this.get_$2aF());_js.Trace.logInfo(_e.$3c.$A,"ResponseAvailable: {0}",this.get_$zj());this.set_$CL(!this.get_$2aF()&&!this.get_$zj())}};_e.$Fh=function(n,t){this.$$d_$9re=Function.createDelegate(this,this.$9re);this.$$d_$9MS=Function.createDelegate(this,this.$9MS);this.$$d_$9MT=Function.createDelegate(this,this.$9MT);this.$$d_$9F0=Function.createDelegate(this,this.$9F0);this.$$d_$9F1=Function.createDelegate(this,this.$9F1);this.$vt="";this.$1p=t;this.$HL=n};function $2Cq(n){if(!n.$4Oo&&n.get_$82Q()&&n.get_$7Uj()){n.$4Oo=!0;n.$vt="Fetching next record...";n.$7nq(n.$$d_$9F1,n.$$d_$9F0)}}function $2hm(n){n.$4Oo=!1;n.set_$5Fp(null);$2Cq(n)}_e.$Fh.prototype={$HL:null,$vs:null,$4Oo:!1,$1p:null,get_$7fb:function(){return this.$vs?this.$vs.id:0},get_$5Fp:function(){return this.$vs},set_$5Fp:function(n){this.$vs=n;this.$vt=_g.$3x.$U9(n);return n},$9re:function(n,t){$2Cq(this)},$9F1:function(n){this.set_$5Fp(n);this.$vs?this.$9XA(this.$$d_$9MT,this.$$d_$9MS):$2hm(this)},$9F0:function(n){_js.Trace.logWarning(this.$1p,"Failed to fetch next record: {0}",n.message);$2hm(this)},$9MT:function(){$2hm(this)},$9MS:function(n){_js.Trace.logWarning(this.$1p,"Processing of {0} failed: {1}",this.$vt,n.message);$2hm(this)}};_e.$Hw=function(n){_e.$Hw.initializeBase(this,[n.$54x]);_a.$4.$J(n.$7F,"clientStore");this.$75=n};_e.$Hw.prototype={$75:null,$19e:function(n,t,i,r){var u=new _e.$AI(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$19e.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"ApplyConversationAction was rejected by the offline proxy.");_g.$9K.prototype.$19e.call(e,n,t,i,r)})},$1LK:function(n,t,i,r){if(t.isQueued){var u=new _e.$Op(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1LK.call(f,n,t,function(n,t){n.response=_g.$BE.$wS(u.$30,-2);i(n,u.$30)},r)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"CreateAttachment was rejected by the offline proxy.");e.$75.get_$KQ().$1LK(n,t,i,r)})}else this.$75.get_$KQ().$1LK(n,t,i,r)},$ly:function(n,t,i,r){if(t.isQueued){this.$75.get_$1NZ().$1mS(n);var u=new _e.$17(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$ly.call(f,n,t,function(r,f){n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&u.$6Tz(t.itemIds[0],r.id);r.response=_g.$BE.$wS(u.$30,-2);i(r,u.$30)},r)},r,function(){e.$75.get_$KQ().$ly(n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else this.$75.get_$KQ().$ly(n,t,i,r)},$1rQ:function(n,t,i,r){var u=new _e.$Oq(t,this.$75,n.Body.PropertyUpdates,n.Body.ParentFolderId,n.Body.PersonTypeString,this.$75.get_$DK());var f=this,o=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1rQ.call(f,n,t,function(n,t){n.response=_g.$BE.$wS(u.get_$1s(),-2);i(n,u.get_$1s())},function(n){var t=new _bc.$GC(0,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)})},function(n){var t=new _bc.$GC(0,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)},function(){_g.$9K.prototype.$1rQ.call(e,n,t,function(n,t){n.response=_g.$BE.$wS(null,-2);i(n,t)},function(n){var t=new _bc.$GC(0,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)})})},$1Ly:function(n,t,i,r,u){i.personaId=n=this.$75.get_$1NZ().$qi(n);var f=new _e.$au(i,this.$75,n,this.$75.get_$DK());var e=this,o=this;f.$A3v(function(){_g.$9K.prototype.$1Ly.call(e,n,t,i,r,u)},u,function(){_g.$9K.prototype.$1Ly.call(o,n,t,i,r,u)})},$1Z2:function(n,t,i,r){var u=new _e.$Hy(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1Z2.call(f,n,t,function(n,t){n.response=_g.$BE.$wS(u.$30,-2);i(n,u.$30)},r)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"DeleteAttachment service command was rejected by the offline proxy.");_g.$9K.prototype.$1Z2.call(e,n,t,i,r)})},$1tB:function(n,t,i,r){var u=new _e.$AN(t,this.$75,n,_g.$h.$1i,this.$75.get_$DK());var f=this,o=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1tB.call(f,n,t,i,r)},function(n){_js.Trace.logError(_a.$0.$LV,"EmptyFolder service command failed. Exception: {0}",n);var t=new _bc.$GC(u.$Fq,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$LV,"EmptyFolder service command was rejected by the offline proxy.");e.$75.get_$KQ().$1tB(n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$2uB:function(n,t,i,r){var u=new _e.$B0(t,this.$75,n,this.$75.get_$DK(),_g.$h.$1i,this.$75.$Ax);var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$2uB.call(f,n,t,i,r)})},$1ua:function(n,t,i){var r=new _e.$TT(n,this.$75,this.$75.get_$DK());var f=this,u=this;r.$A3v(function(){t(null,r.$30)},i,function(){_g.$9K.prototype.$1ua.call(u,n,t,i)})},$2Lb:function(n,t,i,r){var u=new _e.$P6(t,this.$75,n,this.$75.get_$DK());var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$2Lb.call(f,n,t,i,r)})},$wK:function(n,t,i,r){var u=new _e.$TK(t,this.$75,n,this.$75.get_$DK());var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$wK.call(f,n,t,i,r)})},$2Kj:function(n,t,i,r){var u=new _e.$3G(t,this.$75,n,this.$75.get_$DK(),_g.$h.$1i);var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$2Kj.call(f,n,t,i,r)})},$1a7:function(n,t,i,r){var u=new _e.$AO(t,this.$75,n,this.$75.get_$DK());var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$1a7.call(f,n,t,i,r)})},$1ue:function(n,t,i,r){var u=new _e.$AQ(t,this.$75,n);var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$1ue.call(f,n,t,i,r)})},$1am:function(n,t,i){var r=new _e.$15u(n,this.$75,this.$75.get_$DK());var f=this,u=this;r.$A3v(function(){t(null,r.$Cm)},i,function(){_g.$9K.prototype.$1am.call(u,n,t,i)})},$2Lw:function(n,t,i,r){var u=new _e.$15w(t,this.$75,n,this.$75.get_$DK());var o=this;var f=function(){i(null,u.$30)};var e=this;u.$A3v(f,r,function(){u.$3qh?_g.$9K.prototype.$2Lw.call(e,n,t,i,function(n){_js.Trace.logWarning(_a.$0.$LV,"GetPersona service command failed on the server. Falling back to the client store. Error: {0}",n.message);u.$A3v(f,r,function(){r(n)})}):_g.$9K.prototype.$2Lw.call(e,n,t,i,r)})},$l2:function(n,t,i,r){this.$75.get_$1NZ().$1mS(n);if(t.clientStoreItem===1){var u=new _e.$71(t,this.$75,n);var e=this,o=this;u.$A3v(function(){_g.$9K.prototype.$l2.call(e,n,t,function(n,t){n.response=_g.$BE.$wS(u.$30,-2);i(n,u.$30)},r)},r,function(){o.$75.get_$KQ().$l2(n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else{var f=new _e.$3w(t,this.$75,n);var s=this,h=this;f.$A3v(function(){_g.$9K.prototype.$l2.call(s,n,t,function(r,u){r.response=_g.$BE.$wS(f.$30,-2);n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&f.$6Tz(t.itemIds[0],r.id);i(r,f.$30)},r)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"UpdateItem service command was rejected by the offline proxy.");h.$75.get_$KQ().$l2(n,t,i,r)})}},$3x:function(n,t,i,r){this.$75.$fV.$1mS(n);var u=new _e.$6W(t,this.$75,n);var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$3x.call(f,n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$iD:function(n,t,i,r){this.$75.get_$1NZ().$1mS(n);var u=new _e.$9f(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$iD.call(f,n,t,i,r)},r,function(){e.$75.get_$KQ().$iD(n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$wc:function(n,t,i,r){var u=new _e.$TW(t,this.$75,n,this.$75.get_$DK());var e=this,f=this;u.$A3v(function(){i(null,u.$30)},r,function(){_g.$9K.prototype.$wc.call(f,n,t,i,r)})},$2YL:function(n,t,i,r){var u=new _e.$8I(t,this.$75,n,this.$75.get_$DK());var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$2YL.call(f,n,t,function(n){n.response=_g.$BE.$wS(u.$30,-2);i(n)},r)},r,function(){e.$75.get_$KQ().$2YL(n,t,i,r)})},$1mU:function(n,t,i,r){t.personaId=n.Body.PersonaId=this.$75.get_$1NZ().$qi(n.Body.PersonaId);var u=new _e.$1F1(t,this.$75,n.Body.PersonaId,n.Body.PropertyUpdates,n.Body.PersonTypeString);var f=this,o=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1mU.call(f,n,t,function(n,t){n.response=_g.$BE.$wS(u.get_$1s(),-2);i(n,u.get_$1s())},function(n){var t=new _bc.$GC(0,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)})},function(n){var t=new _bc.$GC(0,n);var i=Error.create(_e.$Hw.$1gx,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$LV,"UpdatePersona service command was rejected by the offline proxy.");_g.$9K.prototype.$1mU.call(e,n,t,i,r)})},$qg:function(n,t,i){var r=new _e.$PA(n,this.$75);var f=this,u=this;r.$A3v(function(){t(null,r.$c)},i,function(){_g.$9K.prototype.$qg.call(u,n,t,i)})},$2Bb:function(n,t,i,r){var u=new _e.$tD(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$2Bb.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"UpdateUserConfiguration service command was rejected by the offline proxy.");_g.$9K.prototype.$2Bb.call(e,n,t,i,r)})},$1kS:function(n,t,i,r){var u=this;_g.$9K.prototype.$1kS.call(this,n,t,function(f,e){var o=new _e.$fs(t,u.$75,n);o.$A3v(function(){i(f,e)},r,function(){r(Error.create("SetLayoutSettings was rejected by the offline proxy."))})},r)},$3NU:function(n,t,i,r){var u=this;_g.$9K.prototype.$3NU.call(this,n,t,function(f,e){var o=new _e.$1Ck(t,u.$75,n);o.$A3v(function(){i(f,e)},r,function(){_js.Trace.logWarning(_a.$0.$LV,"SetTimeZone service command was rejected by the offline proxy.")})},r)},$2LZ:function(n,t,i){var r=new _e.$oj(n,this.$75,this.$75.get_$DK());var f=this,u=this;r.$A3v(function(){t(null,r.$30)},i,function(){_g.$9K.prototype.$2LZ.call(u,n,t,i)})},$13L:function(n,t,i){var r=new _e.$op(n,this.$75,this.$75.get_$DK());var f=this,u=this;r.$A3v(function(){t(null,r.$30)},i,function(){_g.$9K.prototype.$13L.call(u,n,t,i)})},$1Qz:function(n,t,i,r){var u=new _e.$MF(t,this.$75,n);var f=this,e=this;u.$A3v(function(){_g.$9K.prototype.$1Qz.call(f,n,t,i,r)},r,function(){e.$75.get_$KQ().$1Qz(n,t,i,function(n){var t=new _bc.$GC(u.$Fq,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}};_e.$k0=function(n){this.$4t=n};_e.$k0.prototype={$4t:null,get_$7lI:function(){var n=this.get_$1r4();if(n)for(var t=0;t<n.length;t++){var i=n[t];if(i.ModuleType===11)return!0}return!1},get_$1r4:function(){return this.$A4Z(Array,"ConfigChangeCleanupModuleList")},set_$1r4:function(n){n&&this.$4t.$DI("ConfigChangeCleanupModuleList",JsonParser.serialize(n));return n},$3cZ:function(n,t){var u=new ConfigChangeCleanupModuleItem(n,t);var i=this.get_$1r4();if(i){for(var f=!1,e=i,o=e.length,r=0;r<o;++r){var s=e[r];if(s.ModuleType===n){f=!0;break}}f||Array.add(i,u)}else i=[u];this.set_$1r4(i)},$6N6:function(n){var t=this.get_$1r4();if(t)for(var i=0;i<t.length;i++){var r=t[i];if(r.ModuleType===n){Array.removeAt(t,i);this.set_$1r4(t);return}}_js.Trace.logWarning(_a.$0.$1lR,"We didn't find {0} in the cleanup module list",n)},$7sJ:function(n){var t=null;var i=this.get_$1r4();if(i){t=[];for(var r=0;r<i.length;r++){var u=i[r];u.SyncManagerStartTime!==n&&Array.add(t,u.ModuleType)}}return t},$A4Z:function(n,t){var i=this.$4t.$3x(t);return i?JsonParser.deserialize(i):n===Number||Type.isEnum(n)?0:n===Boolean?!1:null}};_e.$68=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6gP=Function.createDelegate(this,this.$6gP);_e.$68.resolveInheritance();this.dispose=this.$1Q;_e.$68.initializeBase(this,[n,i,r,u,f]);_a.$4.$1G(t,"timeZoneId");this.$7e=t;this.$8y=new _e.$Tt(n,t);this.$6Sz=new _e.$1CH(this.$8y);this.$2ZJ=o?"MOWA":"DOWA";this.$2J3=s;this.$2J9=h;this.$Ax=l;this.$4K=a;_js.Trace.logInfo(_e.$68.$A,"Protocol: {0}",this.$2ZJ);_js.Trace.logInfo(_e.$68.$A,"DeviceId: {0}",this.$2J3);_js.Trace.logInfo(_e.$68.$A,"DeviceType: {0}",this.$2J9);Sys.Net.WebRequestManager.add_invokingRequest(this.$$d_$6gP);this.$6p=new _e.$AB(this.$8y);this.$fV=new _g.$Lv;c&&this.$fV.$6Tu(c);this.get_$KQ().$fV=this.$fV;this.$HL=e;this.$Rm=new _e.$1B9(e,this.$fV);this.$54x=new _g.$11M(this.get_$KQ(),this.$Rm);this.$5BG=new _e.$Hw(this)};function $4pH(n,t){if(t){var i=this;n.$6p.$9jL(t,n.$fV.$5F2(),function(){_js.Trace.logInfo(_e.$68.$A,"Identity correlation table persisted.")})}}_e.$68.prototype={$6p:null,$Rm:null,$54x:null,$5BG:null,$fV:null,$4K:null,$2ZJ:null,$2J3:null,$2J9:null,$8y:null,$6Sz:null,$HL:null,$7e:null,$1cb:!1,$6Nr:null,$9dS:null,$Ax:null,$2ti:null,get_$7nC:function(){return this.$2ti},set_$7nC:function(n){this.$2ti=n;return n},get_$3U2:function(){return this.$5BG},get_$7RE:function(){return _e.$5O.$1CB()},get_$9hu:function(){return this.$6Sz},get_$ZJ:function(){return this.$HL},set_$ZJ:function(n){this.$HL=n;return n},get_$1NZ:function(){return this.$fV},get_$A8:function(){return this.$8y},get_$DK:function(){return this.$4K.$ic()},get_$DM:function(){return this.$7e},set_$DM:function(n){this.$7e=n;return n},get_$8C5:function(){return this.$1cb},$9rk:function(n){this.$6Nr=new _e.$s8(this,n,this.$M);this.$9dS=new _e.$fP(this.$HL,this.$$d_$26f,this.$M)},$2HU:function(n,t,i){this.$fV.$2HU(t,i);$4pH(this,n)},$2HV:function(n,t,i){this.$fV.$2HV(t,i);$4pH(this,n)},$qi:function(n){return this.$fV.$qi(n)},$6NN:function(n,t,i){var r=!1;var f=!1;var u=this,e=this,o=this;this.$7F.get_$127().$BT(new _a.$6j("OfflineMailboxDataContext.RemoveSendAction"),function(i){u.$8y.get_$gd().$Fy(i,_e.$1h.$5f(n),function(e){if(!e||!e.get_$20()){_js.Trace.logWarning(_e.$68.$A,"RemoveSendAction - Outbox item not found: {0}",n);t(r,f,null,null);return}_js.Trace.logInfo(_e.$68.$A,"RemoveSendAction - Item found: {0}",n);var o=e.get_$Lh();if(!o){_js.Trace.logWarning(_e.$68.$A,"RemoveSendAction - Outbox item context is null: {0}",n);r=!0;t(r,f,null,null);return}_js.Trace.logInfo(_e.$68.$A,"RemoveSendAction - Calling ActionQueue.Remove, action {0}: {1}",o.ActionId,n);u.$HL.$34(o.ActionId,function(i){_js.Trace.logInfo(_e.$68.$A,"RemoveSendAction - Removed Action {0} for item {1}. Results {2}",o.ActionId,n,i);r=o.ActionId!==u.$6Nr.get_$7fb();t(r,o.SendAction===1,o.ParentConversationNodeId,o.ComplianceId)},function(n){_js.Trace.logError(_e.$68.$A,"Failed to remove action from action queue, action id = {0}, Error = {1}",o.ActionId,n.message)},i)},null)},function(){_js.Trace.logInfo(_e.$68.$A,"RemoveSendAction succeeded for outbox item id {0}.",n)},function(n){_js.Trace.logError(_e.$68.$A,"RemoveSendAction failed. Error code: '{0}'  Error message: '{1}'",n.$VZ,n.$3v);var t=new _e.$1f(n);i(t.$SQ())})},$2th:function(n,t,i,r,u){if(!this.$2ti||this.$2ti()){_js.Trace.logInfo(_e.$68.$A,"ExecuteWithActionQueue enqueueing: {0}",n);var f=new _g.$Z8(n,i,null);f.actionHandler=t;f.hasActionHandler=!0;this.$HL.$3pZ(f,r,u)}else _g.$1U.prototype.$2th.call(this,n,t,i,r,u)},$3nQ:function(){_js.Trace.logInfo(_e.$68.$A,"Deprovisioning {0}-{1}-{2}",this.$2ZJ,this.$2J3,this.$2J9);this.$HL.set_$1qW(!1);var t=new _g.$b4(this.$2J3,this.$2J9);t.HasPAL=this.$2ZJ==="MOWA";var n=new _g.$Jo("Exchange2013");n.TimeZoneContext=new _g.$LJ;n.TimeZoneContext.TimeZoneDefinition=new _g.$JG;n.TimeZoneContext.TimeZoneDefinition.Id=this.$7e;var i=this,r=this;this.get_$KQ().$3nQ(new _g.$b2(n,t),null,function(n,t){"Success"===t.Body.ResponseMessages.Items[0].ResponseClass?_js.Trace.logInfo(_e.$68.$A,"...deprovisioning succeeded."):_js.Trace.logError(_e.$68.$A,"Deprovision command failed. We're explicitly ignoring this failure. {0}",t.Body.ResponseMessages.Items[0].MessageText);Sys.Net.WebRequestManager.remove_invokingRequest(i.$$d_$6gP)},function(n){_js.Trace.logError(_e.$68.$A,"Deprovision call failed. We're explicitly ignoring this failure. {0}",n)})},$6Tp:function(n,t,i){if(this.$1cb===n){_js.Trace.logWarning(_e.$68.$A,"IsOfflineComponentReadyToUse: value ({0}) has not changed. Skipping the write to the store.",this.$1cb);_e.$1f.$kR(t)}else{var r=this,u=this,f=this;this.$8y.$BT(new _a.$6j("OfflineMailboxDataContext.SetIsOfflineComponentReadyToUse"),function(t){r.$6p.$9jd(t,n,null)},function(){u.$1cb=n;_js.Trace.logInfo(_e.$68.$A,"Successfully saved the new value for IsOfflineComponentReadyToUse: {0}",n);_e.$1f.$kR(t)},function(t){_js.Trace.logError(_e.$68.$A,"IsOfflineComponentReadyToUse: Failed to persist the new value {0} and reverting to the old value {1}. Error: {2}",n,f.$1cb,t.$3v);_e.$1f.$D6(t,i)})}},$8Ga:function(n){var t=this,i=this,r=this;this.$8y.$BT(new _a.$6j("OfflineMailboxDataContext.LoadIsOfflineComponentReadyToUse"),function(n){t.$6p.$7uh(n,function(n){t.$1cb=n})},function(){i.$1cb?_js.Trace.logInfo(_e.$68.$A,"Offline component is ready to use."):_js.Trace.logWarning(_e.$68.$A,"Offline is enabled but not ready to use yet.");n()},function(t){_js.Trace.logError(_e.$68.$A,"IsOfflineComponentReadyToUse: Failed to fetch the setting. Falling back to kiosk mode. Error: {0}",t.$3v);n()})},$6gP:function(n,t){t.get_webRequest().get_headers()["X-OWA-Protocol"]=this.$2ZJ;t.get_webRequest().get_headers()["X-OWA-DeviceId"]=this.$2J3;t.get_webRequest().get_headers()["X-OWA-DeviceType"]=this.$2J9},$4c:function(){Sys.Net.WebRequestManager.remove_invokingRequest(this.$$d_$6gP);_g.$1U.prototype.$4c.call(this)}};_e.$1B9=function(n,t){_e.$1B9.initializeBase(this);_a.$4.$J(n,"actionQueue");_a.$4.$J(t,"identityCorrelationTable");this.$HL=n;this.$fV=t};_e.$1B9.prototype={$HL:null,$fV:null,$h:function(n,t,i,r,u,f){var e=this;this.$r6(t,i,r,function(t){u(t,n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},f)},$r6:function(n,t,i,r,u){_a.$4.$J(r,"invokeSucceeded");_a.$4.$J(u,"invokeFailed");var f=new _g.$Z8(n,t,i);this.$fV.$1mS(t);this.$HL.$3pZ(f,r,u)}};_e.$s8=function(n,t,i){this.$$d_$80Z=Function.createDelegate(this,this.$80Z);this.$$d_$7Mr=Function.createDelegate(this,this.$7Mr);_e.$s8.initializeBase(this,[n.$HL,_a.$0.$4R7]);this.$Pu=n;this.$Be=n.$Be;this.$1Fx=n.get_$KQ();this.$27Z=n.$27Z;this.$5fp=t;var r=this;i.$IU(_a.$kV,function(n){_js.Trace.logInfo(r.$1p,"RequestQueueProcessor received NonBootModelResponseProcessorReady event");r.$HL.add_$6Nn(r.$$d_$9re);r.$HL.add_$8FB(r.$$d_$7Mr);r.$HL.add_$4Rc(r.$$d_$9re);r.$HL.add_$59m(r.$$d_$9re);i.$IU(_a.$Su,r.$$d_$80Z);$2Cq(r)})};function $70h(n,t,i){var r=n.$vs;var f=_a.$7.get_$29();var e=n.$27Z.$6V1(r,n.$Pu);_g.$3x.$4Pf(r,f.$J8());if(e){_js.Trace.logInfo(n.$1p,"Saving {0} response.",n.$vt);n.$HL.$9kV(r,t,i)}else{var u=3e4;r.response.fault&&r.response.fault.BackOffPeriodInMs&&(u=Math.min(r.response.fault.BackOffPeriodInMs,u));_js.Trace.logWarning(n.$1p,"Response from {0} was rejected. Updating count and delaying {1} ms before trying again.",n.$vt,u);_g.$Ch.$1mA(r,!1,0);var o=this;n.$HL.$A0k(r,function(){n.$5fp.$1w(n.$1p,"SetResponse",t,u)},i)}}_e.$s8.prototype={$27Z:null,$Pu:null,$Be:null,$1Fx:null,$5fp:null,get_$82Q:function(){return this.$HL.get_$2aF()},get_$7Uj:function(){if(this.$HL.get_$1qW())if(this.$Be.$Pf)if(this.$HL.get_$zj()){_js.Trace.logInfo(this.$1p,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the action queue has pending responses.");return!1}else return!0;else{_js.Trace.logInfo(this.$1p,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the application has lost network connectivity.");return!1}else{_js.Trace.logInfo(this.$1p,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7nq:function(n,t){this.$HL.$7vd(n,t)},$9XA:function(n,t){_js.Trace.logInfo(this.$1p,"Processing {0} with an online call.",this.$vt);var i=this;this.$1Fx.$3yq(this.$vs,function(){_js.Trace.logInfo(i.$1p,"Online processing of {0} completed.",_g.$3x.$U9(i.$vs));$70h(i,n,t)})},$7Mr:function(n,t){_js.Trace.logInfo(this.$1p,"Ensuring connectivity to process {0}",_g.$3x.$U9(this.$HL.get_$5gQ()));this.$Be.$2rb()},$80Z:function(n){$2Cq(this)}};_e.$fP=function(n,t,i){_e.$fP.initializeBase(this,[n,_a.$0.$4Ri]);_a.$4.$J(t,"processResponse");_a.$4.$J(i,"eventAggregator");this.$3J1=t;var r=this;i.$IU(_a.$kV,function(n){_js.Trace.logInfo(r.$1p,"ResponseQueueProcessor received NonBootModelResponseProcessorReady event");r.$HL.add_$4Rc(r.$$d_$9re);r.$HL.add_$59m(r.$$d_$9re);$2Cq(r)})};function $4pK(n,t,i){_js.Trace.logInfo(n.$1p,"Removing {0} from the action queue.",n.$vt);var r=n.$vs;_g.$Ch.$1mA(r,!0,0);var u=this;n.$HL.$34(r.id,function(n){t()},i,null)}_e.$fP.prototype={$3J1:null,get_$82Q:function(){return this.$HL.get_$zj()},get_$7Uj:function(){if(this.$HL.get_$1qW())return!0;else{_js.Trace.logInfo(this.$1p,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7nq:function(n,t){this.$HL.$7vf(n,t)},$9XA:function(n,t){_js.Trace.logInfo(this.$1p,"Processing response from {0}.",this.$vt);var u=_a.$7.get_$29();var i=this,r=this;this.$3J1(this.$vs,function(){_js.Trace.logInfo(i.$1p,"Processing response from {0} succeeded.",i.$vt);_g.$3x.$4Pf(i.$vs,u.$J8());$4pK(i,n,t)},function(i){_js.Trace.logWarning(r.$1p,"Processing response from {0} failed: {1}",r.$vt,i.message);$4pK(r,n,t)})}};_e.$6E=function(n){_e.$6E.initializeBase(this);_a.$4.$J(n,"clientStore");this.$6Y=new(_e.$7j.$$(_bc.$16p,_e.$GO))(n,"UTC")};function $6zU(n,t){var i=t.$Dg(_e.$1I.get_$I().$10t.get_$1L());var r=new _a.$8k(ActionItemMetadata.$40s(),"true");var u=new _a.$8J(r,null);var f=this,e=this;i.$It(u,function(t){t.$B(function(t){n.set_$3wm(t)},null)},function(n){_js.Trace.logError(_a.$0.$8G,"Unable to retreive the number of high priority actions from the clientstore. Error = {0}",n.$3v)})}function $6zV(n,t){var i=t.$Dg(_e.$1I.get_$I().$10t.get_$1L());var r=new _a.$8k(ActionItemMetadata.$40s(),"false");var u=new _a.$8J(r,null);var f=this,e=this;i.$It(u,function(t){t.$B(function(t){n.$1ds=t},null)},function(n){_js.Trace.logError(_a.$0.$8G,"Unable to retrieve the number of low priority actions from the clientstore. Error = {0}",n.$3v)})}function $4ot(n,t,i,r){var u=null;var f=this,e=this;$2hr(n,function(i,r){$4ou(n,i,r,t,function(n){u=n})},function(){i(u)},r)}function $4ou(n,t,i,r,u){var f=this;i.$It(r,function(n){n.$Dd(1,function(n,t,i){if(t.length>0){var f=t[0].$27;var r=f.Data;r.id=t[0].$4s.$Tc();u(r)}else u(null)},null)},null)}function $4ov(n,t,i,r){var u=!1;var f=null;var e=_e.$1h.$5Ol(i);var o=this;n.$6Y.$Fy(t,e,function(n){if(n){u=!0;n.$2Iu(t)}f=u?n.get_$20():null;r(u,f)},null)}function $2hr(n,t,i,r){var u=this,f=this,e=this;n.$6Y.$BT(new _a.$6j("DatabaseActionQueue.ExecuteTransaction"),function(n){var i=n.$Dg(_e.$1I.get_$I().$10t.get_$1L());t(n,i)},function(){i()},function(n){var t=Error.create(n.$3v,n);r(t)})}_e.$6E.prototype={$6Y:null,$89X:function(n,t){var i=n.$Dg(_e.$1I.get_$I().$10t.get_$1L());var r=new _a.$Xf(_e.$GO.$2dp,0,1,0);var u=new _a.$8J(r,_e.$6E.$2dV);var f=this;$4ou(this,n,i,u,function(n){t(!n)})},$85O:function(n){$6zU(this,n);$6zV(this,n)},$7lt:function(n,t,i){var r=this.$6Y.$qa(n);delete n.id;var u=this,f=this;$2hr(this,function(t,i){r.$E7(t,function(t){n.id=t.get_$1dL()})},function(){t(n.id)},i)},$7ve:function(n,t){$4ot(this,_e.$6E.$674,n,t)},$7vg:function(n,t){$4ot(this,_e.$6E.$676,n,t)},$7rI:function(n,t){var i=[];var r=this,u=this;$2hr(this,function(n,t){t.$It(_e.$6E.$559,function(n){n.$Dd(1e3,function(n,t,r){for(var u=0;u<t.length;++u){var e=t[u].$27;var f=e.Data;f.id=t[u].$4s.$Tc();Array.add(i,f)}},null)},null)},function(){n(i)},t)},$9b0:function(n,t,i,r){var u=!1;var f=null;if(n)$4ov(this,n,t,i);else{var e=this,o=this;$2hr(this,function(n,i){$4ov(e,n,t,function(n,t){u=n;f=t})},function(){i(u,f)},r)}},$6e4:function(n,t,i){var r=this;this.$7lt(n,function(n){t()},i)}};_e.$mj=function(n){_a.$4.$l(n,"nativeBridge");this.$12=n;var t=this;this.$12.add_$3G4(function(){t.get_$54F()&&_e.$6H.$9Zj(t.get_$54F())})};_e.$mj.prototype={$12:null,$dE:null,get_$54F:function(){if(!this.$dE)switch(this.$12.$Wx.get_$2kZ().get_$2kY()){case 1:this.$dE=new _e.$OV;break;case 2:this.$dE=new _e.$11G(this.$12.$Wx);break;case 0:break}return this.$dE}};_e.$Vh=function(){};_e.$Vh.$E=function(n,t,i){var r=null;n.get_$9sw()?r=_e.$Vh.$7dh(t,i):n.get_$4e1()?r=_e.$Vh.$7bJ(t):n.get_$2NW()&&(r=new _e.$171(n.get_$2NW(),t));return r};_e.$Vh.$7bJ=function(n){var t=window.self;return new _e.$lt(t,n)};_e.$Vh.$7dh=function(n,t){var i=new _e.$1D6(t.$10H,_js.$J.get_$I());return new _e.$lt(i,n)};_e.$1Fm=function(){};_e.$1Fm.registerInterface("_e.$1Fm");_e.$wb=function(){};_e.$1Fi=function(){};_e.$1Fi.registerInterface("_e.$1Fi");_e.$1Fh=function(){};_e.$1Fh.registerInterface("_e.$1Fh");_e.$1Fj=function(){};_e.$1Fj.registerInterface("_e.$1Fj");_e.$1Fl=function(){};_e.$1Fl.registerInterface("_e.$1Fl");_e.$5f=function(n,t,i){this.$fG=n;this.$1n=t;this.$2C9=i;$3Xf(this);this.$2f4=0};function $4p5(n,t,i){var r=n.$fG.open(n.$1n);_e.$3q.$zd(Object,_a.$XA,"IdbBrowserDb.Initialize",r,i);var u=this;_e.$3q.$Wo(Object,_a.$XA,"IdbBrowserDb.Initialize",r,function(r){n.$Mm=r.target.result;if($707(n)){var u=n.$Mm.transaction(n.$Mm.objectStoreNames,"readwrite");_e.$NV.$IU("IdbBrowserDb.Initialize",u,t,i);$70A(n,u)}else _e.$5y.$1Sr(t)})}function $707(n){return $4p7(n)&&$4p4(n)}function $4p4(n){return Array.indexOf(n.$Mm.objectStoreNames,"__indexes")>=0}function $4p7(n){return Array.indexOf(n.$Mm.objectStoreNames,"__versions")>=0}function $705(n){$4p7(n)||n.$Mm.createObjectStore("__versions",_a.$UI.$7pr());$4p4(n)||n.$Mm.createObjectStore("__indexes",_a.$UI.$7pc())}function $70A(n,t){$70D(n,t);$709(n,t);$70C(n,t)}function $709(n,t){var i=t.objectStore("__indexes");var r=i.openCursor(_a.$76.$1Jp(),"next");var u=this;_e.$3q.$Wo(_a.$FO,_a.$Iu,"IdbBrowserDb.PopulateIndexInformation",r,function(t){if(t.target.result){var i=t.target.result.value;var r=_e.$NU.$E(i);n.$73.$1oo(i.storeName,r);_a.$Qu.$Dd(t.target.result)}})}function $70D(n,t){var i=t.objectStore("__versions");$708(n,i);$70B(n,i)}function $70B(n,t){for(var i=0;i<n.$Mm.objectStoreNames.length;++i)if(!n.$Mm.objectStoreNames[i].startsWith("__")){var r=t.get(n.$Mm.objectStoreNames[i]);var u=this;_e.$3q.$Wo(_a.$FP,Object,"IdbBrowserDb.PopulateObjectStoreVersion",r,function(t){var i=t.target.result;n.$73.$D(i.name,i.version)})}}function $70C(n,t){var i=t.objectStore("__versions");var r=i.get("__settings");var u=this;_e.$3q.$Wo(_a.$FP,Object,"IdbBrowserDb.PopulateSettingsInformation",r,function(t){var i=t.target.result;i&&(n.$2O1=i)})}function $708(n,t){var i=t.get("__db");var r=this;_e.$3q.$Wo(_a.$FP,Object,"",i,function(t){_e.$5y.$1Sr(function(){var i=t.target.result;n.$Bx=i.version})})}function $703(n,t,i,r){var u=new _e.$pV(n.$Mm,r,i);try{t(u)}catch(f){_js.Trace.logError(_a.$0.$Cv,"aborting transaction due to exception during schema update: "+f.message);r.abort()}}function $70F(n,t,i){var r=i.objectStore("__versions");r.put(new _e.$wd("__db",t),"__db")}function $70E(n,t,i){var u=i.objectStore("__versions");var r=$702(n,n.$2O1);r.$1oZ=t;u.put(r,"__settings")}function $706(n,t,i,r,u,f){var s=n.$73.$3p();var h=n.$Mm.version+1;n.$Mm.close();$3Xf(n);var e=n.$fG.open(n.$1n,h);var o="IdbBrowserDb.InternalChangeSchema";var c=this;_e.$3q.$A1O(o,e,function(u){n.$Mm=u.target.result;$70G(n,t,i,s,u.target.transaction,r,f)});_e.$3q.$1Sr(Object,_a.$XA,o,e,u);_e.$3q.$zd(Object,_a.$XA,o,e,f)}function $70G(n,t,i,r,u,f,e){var o=this;_e.$NV.$IU("UpgradeDatabaseVersion",u,function(){n.$73=r;n.$Bx=t;n.$2O1.$1oZ=i},e);$705(n);$70F(n,t,u);$70E(n,i,u);$703(n,f,r,u)}function $3Xg(n,t){if(!n.$73.$1lD(t))throw Error.invalidOperation("The object store "+t+" does not exist.");}function $701(n){}function $4p6(n){return!!n.$Mm}function $3Xf(n){n.$Mm=null;n.$Bx="";n.$2O1=new _e.$wb;n.$73=new _e.$wa;n.$MT=new _a.$yK(n);n.$gZ=new _a.$SG}function $704(n,t,i){$4p6(n)?t():$4p5(n,t,i)}function $702(n,t){var i=new _e.$wb;i.$1oZ=t.$1oZ;return i}_e.$5f.prototype={$fG:null,$1n:null,$2C9:null,$MT:null,$gZ:null,$Bx:null,$2O1:null,$Mm:null,$73:null,$2f4:0,get_$39:function(){return this.$Bx},get_$1RS:function(){return this.$73.get_$1RS()},get_$1oZ:function(){return this.$2O1.$1oZ||new Array(0)},$3ha:function(n,t,i,r,u){var f=this;$704(this,function(){$706(f,n,t,i,r,u)},u)},$BT:function(n,t,i,r){$701(this);var u=this.$2f4++;var f=this.$Mm.transaction(this.get_$1RS(),"readwrite");var e=new _e.$172(f,this.$73,this.$MT,this.$gZ,n);this.$2C9.$46i(u);_js.Trace.logInfo(_a.$0.$Cv,"starting transaction {0}",n.$Z8);var o=this,s=this;_e.$NV.$IU(n.$Z8,f,function(){_js.Trace.logInfo(_a.$0.$Cv,"transaction {0} ended in success.",n.$Z8);o.$2C9.$20O(u);e.$3JE();_e.$5y.$1Sr(i)},function(t){_js.Trace.logInfo(_a.$0.$Cv,"transaction {0} ended in error.",n.$Z8);s.$2C9.$20O(u);t=e.$2jq?new _a.$Au(5,"Transaction manually aborted."):t;_e.$5y.$D6(t,r)});try{t(e)}catch(h){_js.Trace.logException(_a.$0.$Cv,h,"IDB caught an exception on the transaction callback and will abort.");f.abort()}},$6gf:function(n,t){this.$4X();var i=this.$fG.deleteDatabase(this.$1n);_e.$3q.$1Sr(Object,_a.$XA,"IdbBrowserDb.Wipe",i,n);_e.$3q.$zd(Object,_a.$XA,"IdbBrowserDb.Wipe",i,t)},$4X:function(){if($4p6(this)){this.$Mm.close();$3Xf(this)}},$IU:function(n,t){_a.$4.$1G(n,"objectStoreName");_a.$4.$J(t,"notificationCallback");n=n.toLowerCase();$3Xg(this,n);this.$MT.$IU(n,t)},$18g:function(n){_a.$4.$1G(n,"objectStoreName");n=n.toLowerCase();this.$MT.$18g(n)},$4cI:function(){this.$MT.$4cI()},$7vl:function(n){_a.$4.$1G(n,"objectStoreName");n=n.toLowerCase();$3Xg(this,n);return this.$73.$1aq(n)},$5FC:function(n){_a.$4.$1G(n,"objectStoreName");n=n.toLowerCase();$3Xg(this,n);var t=new _e.$5f.$84a(n,this.$gZ);this.$gZ.$53y(t);return t}};_e.$5f.$84a=function(n,t){_e.$5f.$84a.initializeBase(this,[n,t])};_e.$5y=function(n,t){_e.$5y.initializeBase(this,[n,t])};_e.$5y.$ze=function(n,t){var i=n;var r=_e.$5y.$9wd(n);_js.Trace.logError(_a.$0.$Cv,"IndexedDb Error: {0}",i);_e.$5y.$zd(r,i,t)};_e.$5y.$zd=function(n,t,i){_e.$5y.$D6(new _e.$5y(n,t),i)};_e.$5y.$D6=function(n,t){t&&t(n)};_e.$5y.$1Sr=function(n){n&&n()};_e.$5y.$kR=function(n,t,i){i&&i(t)};_e.$5y.$9wd=function(n){var t=0;switch(n){case"UnknownError":t=0;break;case"ConstraintError":t=1;break;case"DataError":t=0;break;case"TransactionInactiveError":t=0;break;case"ReadOnlyError":t=1;break;case"VersionError":t=0;break;case"NotFoundError":t=2;break;case"InvalidStateError":t=0;break;case"InvalidAccessError":t=0;break;case"TimeoutError":t=4;break;case"AbortError":t=5;break;case"QuotaExceededError":t=3;break;case"SyntaxError":t=0;break;case"DataCloneError":t=1;break}return t};_e.$171=function(n,t){_e.$171.initializeBase(this);this.$fG=n;this.$2C9=t};_e.$171.prototype={$fG:null,$2C9:null,$9Rk:function(n,t,i,r){_a.$4.$J(i,"successCallback");_a.$4.$1G(n,"name");var u=new _e.$5f(this.$fG,n,this.$2C9);var f=this;$4p5(u,function(){i(u)},r)},$7hP:function(n,t,i){_a.$4.$J(t,"successCallback");_a.$4.$1G(n,"name");this.$fG.deleteDatabase(n);t()}};_e.$GZ=function(n,t,i,r){this.$Ai=n;this.$1G9=t;this.$73=i;this.$su=r};_e.$GZ.$6fT=function(n){_a.$4.$J(n,"id");var t=n.$Tc();_a.$4.$J(t,"id must be provided");_a.$4.$1G(t.toString(),"id must be provided");return t};function $4p9(n,t,i,r){var u=t?new _a.$8J(t.$7W,null):null;var f=this;_e.$2I.$E(n.$Ai.get_$3xD(),n.$1G9,n.$73,u,1,function(n){i(n)},r)}function $4p8(n,t){$70H(n,t);$70I(n,t)}function $70I(n,t){if(t.$GX)for(var i=0;i<t.$GX.length;++i)if(!n.$73.$2Mf(t.$GX[i].$HH.$5r)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$GX[i].$HH.$5r);_a.$Au.$1IM(1,r)}}function $70H(n,t){if(t.$7W)for(var r=t.$7W.$1jq,i=0;i<r.length;++i)if(!n.$73.$2Mf(r[i].$5r)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5r);_a.$Au.$1IM(1,u)}}_e.$GZ.prototype={$Ai:null,$1G9:null,$73:null,$su:null,$44b:0,get_$1L:function(){return this.$73.get_$1L()},$3x:function(n,t,i){var r=_e.$GZ.$6fT(n);_a.$4.$J(t,"successCallback");var u=this.$1G9.get(r);var f="IdbBrowserDbObjectStore.GetItem";var e=this;_e.$3q.$DT(_a.$FP,Object,f,u,function(n){_js.Trace.logError(_a.$0.$Cv,"Error getting object from store:{0} with id:{1}. Error:{2}",e.get_$1L(),r,n.target.error);_e.$5y.$ze(n.target.error.name,i)});var o=this;_e.$3q.$Wo(_a.$FP,Object,f,u,function(n){var i=null;var r=n.target.result;r&&(i=r.data);_e.$5y.$kR(Object,i,t)})},$iD:function(n,t,i){this.$su.$16H(this,n);this.$Ai.get_$1RM()(this.get_$1L(),2,n,null);var f=_e.$GZ.$6fT(n);var r=_a.$FP.$34(this.$1G9,f);var u="IdbBrowserDbObjectStore.DeleteItem";_e.$3q.$1Sr(_a.$FP,Boolean,u,r,t);var e=this;_e.$3q.$DT(_a.$FP,Boolean,u,r,function(t){_js.Trace.logError(_a.$0.$Cv,"Error deleting from object store:{0} the id:{1}. ErrorCode:{2}",e.get_$1L(),n.$Tc(),t.target.error);_e.$5y.$ze(t.target.error.name,i)})},$1r:function(n,t){this.$su.$1h4(this);var i=this.$1G9.clear();var r="IdbBrowserDbObjectStore.Clear";_e.$3q.$1Sr(_a.$FP,Object,r,i,n);var u=this;_e.$3q.$DT(_a.$FP,Object,r,i,function(n){_js.Trace.logError(_a.$0.$Cv,"Error clearing from object store:{0}. ErrorCode:{1}",u.get_$1L(),n.target.error);_e.$5y.$ze(n.target.error.name,t)})},$9YL:function(n,t,i,r){_a.$4.$J(t,"json");this.$su.$1h5(this,n,t);for(var s=new _e.$179(t,{}),e=0;e<this.$73.get_$2NY().length;++e)this.$73.get_$2NY()[e].$7QN(s,n,this.get_$1L());var u=n.$Tc();if(u===null){var o=_a.$7.get_utcNow().$5R();o<=this.$44b&&(o=this.$44b+1);u=this.$44b=o}var h=!0;var y=!1;if(this.$Ai.get_$1IW().$4UM){var c=this.$1G9.count(_a.$76.$6CB(u));var l="IdbBrowserDbObjectStore.Count";var p=this;_e.$3q.$zd(_a.$FO,Number,l,c,function(t){_js.Trace.logInfo(_a.$0.$5a,"Database query with ClientStoreId = {0} failed with error: {1}",n.toString(),t.$3v)});var w=this;_e.$3q.$Wo(_a.$FO,Number,l,c,function(n){h=!!n.target.result})}var a=this.$1G9.put(s,u);var v="IdbBrowserDbObjectStore.Put";_e.$3q.$zd(_a.$FP,Object,v,a,r);var f=this;_e.$3q.$Wo(_a.$FP,Object,v,a,function(r){y=!0;_e.$5y.$kR(_a.$Nn,new _a.$Nn(r.target.result),i);h?f.$Ai.get_$1RM()(f.get_$1L(),1,n,t):f.$Ai.get_$1RM()(f.get_$1L(),0,n,t)})},$It:function(n,t,i){_a.$4.$J(t,"successCallback");n&&$4p8(this,n);var r=this;$4p9(this,n,function(u){_e.$2I.$E(r.$Ai.get_$3xD(),r.$1G9,r.$73,n,0,function(n){var i=new _e.$178(r.$Ai,n,u);_e.$5y.$kR(_a.$187,i,t)},i)},i)},$3xH:function(n,t,i){_a.$4.$J(t,"successCallback");var r=n?new _a.$8J(n,null):null;r&&$4p8(this,r);var u=this;$4p9(this,r,function(n){_e.$2I.$E(u.$Ai.get_$3xD(),u.$1G9,u.$73,r,1,function(i){var r=new _e.$177(u.$Ai,i,n);_e.$5y.$kR(_a.$186,r,t)},i)},i)}};_e.$172=function(n,t,i,r,u){this.$2ye=n;this.$su=new _a.$SF(this,r);this.$73=t;this.$1Fo=new _a.$yI(i);this.$e6=u};_e.$172.prototype={$2ye:null,$73:null,$su:null,$1Fo:null,$e6:null,$2jq:!1,get_$1IW:function(){return this.$e6},get_$3xD:function(){return this.$2ye},get_$1RM:function(){return this.$1Fo.$$d_$9Ya},$3JE:function(){this.$1Fo.$3JE(this.$e6)},$Dg:function(n){n=n.toLowerCase();if(!this.$73.$1lD(n))throw Error.invalidOperation("storeName "+n+" does not exist.");var t=this.$2ye.objectStore(n);return new _e.$GZ(this,t,this.$73.$7yC(n),this.$su)},$2Do:function(){this.$2jq=!0;this.$2ye.abort()}};_e.$173=function(n,t){_e.$173.initializeBase(this,[n,t,new _a.$4o("metadata."+n)])};_e.$173.prototype={$7QN:function(n,t,i){_e.$NU.$4dG(this.$kp[0],n,t,i);_e.$NU.$4dG(this.$kp[1],n,t,i);var r=this.$kp[0].$1C8(n.data);var u=this.$kp[1].$1C8(n.data);n.metadata[this.$2NZ]=_e.$7f.$E(r,u)}};_e.$NU=function(n,t,i){this.$2NZ=n;this.$kp=new Array(0);this.$5gF=i;for(var r=0;r<t.length;++r)Array.add(this.$kp,new _a.$4o(t[r]))};_e.$NU.$E=function(n){if(n.keyPaths.length===1)return new _e.$17B(n.indexName,n.keyPaths);else if(n.keyPaths.length===2)return new _e.$173(n.indexName,n.keyPaths);else throw Error.argument("fields","composite keys can only have two columns");};_e.$NU.$4dG=function(n,t,i,r){var u=n.$1C8(t.data);if($6(u)){var f=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",n.$5r,r,i.$Tc());_js.Trace.logError(_a.$0.$Cv,f);throw Error.invalidOperation(f);}if(!String.isInstanceOfType(u)&&!Number.isInstanceOfType(u)){var e=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",n.$5r,r,i.$Tc(),Object.getType(u).getName());throw Error.invalidOperation(e);}};_e.$NU.prototype={$2NZ:null,$kp:null,$5gF:null};_e.$174=function(n,t,i,r){this.storeName=n;this.indexName=t;this.keyPaths=new Array(i.length);this.storeVersion=r;for(var u=0;u<i.length;++u)this.keyPaths[u]=i[u].$5r.$5r};_e.$174.prototype={storeName:null,indexName:null,keyPaths:null,storeVersion:null};_e.$wa=function(){this.$st={}};_e.$wa.prototype={$st:null,get_$1RS:function(){var n=[];var t=this.$st;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.key)}return n},$1aq:function(n){return this.$st[n].get_$39()},$7yC:function(n){return this.$st[n]},$D:function(n,t){this.$st[n]=new _e.$wa.$5LF(n,t)},$1lD:function(n){return n in this.$st},$3p:function(){var n=new _e.$wa;n.$st={};var t=this.$st;for(var i in t){var r={key:i,value:t[i]};var u=r.value;n.$st[r.key]=u.$3p()}return n},$34:function(n){delete this.$st[n]},$1oo:function(n,t){var i=this.$st[n];i.$1oo(t)},$5XJ:function(n,t){var i=this.$st[n];return i.$5XJ(t)}};_e.$wa.$5LF=function(n,t){this.$1n=n;this.$Bx=t;this.$3xi={};this.$4X6={};this.$3in={};this.$2Eb=[];this.$3xh=[]};_e.$wa.$5LF.prototype={$Bx:null,$1n:null,$3xi:null,$4X6:null,$3in:null,$2Eb:null,$3xh:null,get_$1L:function(){return this.$1n},get_$39:function(){return this.$Bx},get_$2NY:function(){return this.$3xh},$1oo:function(n){this.$3xi[n.$2NZ]=n;for(var t=0;t<n.$kp.length;++t)Array.indexOf(this.$2Eb,n.$kp[t].$5r)<0&&Array.add(this.$2Eb,n.$kp[t].$5r);n.$kp.length===1?this.$4X6[n.$kp[0].$5r]=n:this.$3in[n.$kp[0].$5r+n.$kp[1].$5r]=n;Array.add(this.$3xh,n)},$5XJ:function(n){return n in this.$3xi},$2Mf:function(n){if(n===_a.$4o.$4s.$5r)return!0;else{for(var t=0;t<this.$2Eb.length;++t)if(this.$2Eb[t]===n)return!0;return!1}},$1ug:function(n,t){var i=null;if(t.$5r===_a.$4o.$4s.$5r)i=n;else{var r=this.$4X6[t.$5r];r&&(i=n.index(r.$2NZ))}return i},$2vX:function(n,t,i){var r=null;if(t===i)r=this.$1ug(n,t);else{var u=this.$3in[t.$5r+i.$5r];u&&(r=n.index(u.$2NZ))}return r},$3p:function(){for(var t=new _e.$wa.$5LF(this.$1n,this.$Bx),i=this.get_$2NY(),r=i.length,n=0;n<r;++n){var u=i[n];t.$1oo(u)}return t}};_e.$Lu=function(n,t){_e.$Lu.initializeBase(this,[null]);_a.$4.$J(n,"idbCursorRequest");this.$Gq=new(_e.$ct.$$(_a.$Iu))(n,t)};_e.$Lu.prototype={$Gq:null,get_$879:function(){return this.$Gq.get_$1Yh()},get_$5YX:function(){return this.$Gq.get_$1As()},get_$878:function(){return this.$Gq.get_$3lT()},$B:function(n,t){this.$Gq.$B(n,t)},$5Yw:function(n,t,i){this.$Gq.$1U9(n,t,i)},$3yf:function(n,t){this.$Gq.$Dd(n,t)},$49:function(n,t){this.$Gq.$49(n,t)}};_e.$ct=function(n,t){this.$$d_$81V=Function.createDelegate(this,this.$81V);this.$$d_$81W=Function.createDelegate(this,this.$81W);_a.$4.$J(n,"idbCursorRequest");this.$1i4=null;this.$wr=n;this.$tW=t;var i="IdbQueryCursorStrategyImpl";_e.$3q.$Wo(_a.$FO,this.$$gta["_e.$ct"].TCursor,i,this.$wr,this.$$d_$81W);_e.$3q.$DT(_a.$FO,this.$$gta["_e.$ct"].TCursor,i,this.$wr,this.$$d_$81V)};_e.$ct.$$=function(n){var t="$ct"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$ct"]={TCursor:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$ct.apply(this,i)};r.registerClass("_e."+t);var u=_e.$ct.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$ct.prototype={$wr:null,$tW:null,$1i4:null,get_$1Yh:function(){var n=null;this.$wr.result&&(n=this.$wr.result.value);return n},get_$1As:function(){var n=null;this.$wr.result&&(n=this.$wr.result.primaryKey);return n},get_$3lT:function(){return""},$B:function(n,t){var i="IdbQueryCursorStrategyImpl.Count";var r=this.$tW?this.$wr.source.count(this.$tW):this.$wr.source.count();_e.$3q.$zd(_a.$FO,Number,i,r,t);var u=this;_e.$3q.$Wo(_a.$FO,Number,i,r,function(t){_e.$5y.$kR(Number,t.target.result,n)})},$1U9:function(n,t,i){this.$1i4=new _e.$wc(t,i);this.$wr.result.advance(n)},$Dd:function(n,t){this.$1i4=new _e.$wc(n,t);_a.$Qu.$Dd(this.$wr.result)},$49:function(n,t){n()},$81W:function(n){var t=this;_e.$5y.$1Sr(function(){var n=t.$1i4;t.$1i4=null;n.get_$Wo()()})},$81V:function(n){var t=this.$1i4;this.$1i4=null;t.get_$DT()(n.target.error)}};_e.$wc=function(n,t){this.$6Zk=n;this.$1f=t};_e.$wc.prototype={$6Zk:null,$1f:null,get_$Wo:function(){return this.$6Zk},get_$DT:function(){return this.$1f}};_e.$jP=function(n,t){_e.$jP.initializeBase(this,[t]);this.$7W=n};_e.$jP.prototype={$7W:null,get_$879:function(){return this.$Pd.get_$1Yh()},get_$5YX:function(){return this.$Pd.get_$1As()},get_$878:function(){return this.$Pd.get_$3lT()},$3yf:function(n,t){var i=this,r=this;this.$Pd.$Dd(function(){i.$Pd.$Ou===2?n():i.$7W.$5dv(i.$Pd.get_$1As(),i.$Pd.get_$1Yh().data)?n():i.$3yf(n,t)},function(n){t(n)})}};_e.$176=function(n,t){_e.$176.initializeBase(this,[t]);this.$2wo=n};_e.$176.prototype={$2wo:null,get_$879:function(){return this.$Pd.get_$1Yh()},get_$5YX:function(){return this.$Pd.get_$1As()},get_$878:function(){for(var t="",n=0;n<this.$2wo.length;++n){var i=this.$2wo[n].$5r===_a.$4o.$4s.$5r?this.$Pd.get_$1As():this.$2wo[n].$1C8(this.$Pd.get_$1Yh().data);$6(i)||(t+=i.toString())}return t},$3yf:function(n,t){this.$Pd.$Dd(n,t)}};_e.$177=function(n,t,i){this.$$d_$5SC=Function.createDelegate(this,this.$5SC);this.$Gq=new _e.$Qv(n,t,i)};_e.$177.prototype={$Gq:null,$B:function(n,t){this.$Gq.$B(n,t)},$Dd:function(n,t,i){this.$Gq.$Dd(_a.$Nn,n,this.$$d_$5SC,t,i)},$5SC:function(n){return new _a.$Nn(n.get_$1As())}};_e.$178=function(n,t,i){this.$$d_$5SC=Function.createDelegate(this,this.$5SC);this.$Gq=new _e.$Qv(n,t,i)};_e.$178.prototype={$Gq:null,get_$Iv:function(){return this.$Gq.$8o},$B:function(n,t){this.$Gq.$B(n,t)},$Dd:function(n,t,i){_a.$4.$J(t,"successCallback");var r=this;this.$Gq.$Dd(_a.$f3,n,this.$$d_$5SC,function(n,i,r){t(n,i,r)},i)},$1jv:function(n,t,i,r){this.$Gq.$1jv(n,t,i,r)},$1U9:function(n,t,i){this.$Gq.$1U9(n,t,i)},$5SC:function(n){var t=n.get_$1Yh();var i=n.get_$1As();return new _a.$f3(new _a.$Nn(i),t.data)}};_e.$Qv=function(n,t,i){this.$Ai=n;this.$1lE=t;this.$5Du=i;this.$8o=0};function $3Xh(n){if(n.$16d>0)throw Error.invalidOperation("an asynchronous operation is already in progress");}_e.$Qv.prototype={$Ai:null,$1lE:null,$5Du:null,$8o:0,$16d:0,$B:function(n,t){this.$5Du.$B(n,t)},$Dd:function(n,t,i,r,u){_a.$4.$J(r,"successCallback");$3Xh(this);if(this.$1lE.get_$3R()===2)r(this.$Ai,[],!0);else{this.$16d++;var f=this,e=this;this.$A3r(n,t,[],i,function(n,t,i){f.$16d--;r&&r(n,t,i)},function(n){e.$16d--;u&&u(n)})}},$1jv:function(n,t,i,r){_a.$4.$J(i,"successCallback");_a.$4.$J(t,"condition");$3Xh(this);this.$16d++;var u=this,f=this;this.$1lE.$1jv(t,function(n,t){u.$8o+=t;u.$16d--;!n&&t>0&&u.$8o--;i&&i(n)},function(n){f.$16d--;r&&r(n)})},$1U9:function(n,t,i){this.$8o+=n;$3Xh(this);this.$16d++;var r=this,u=this;this.$1lE.$1U9(n,function(){r.$16d--;t&&t()},function(n){u.$16d--;i&&i(n)})},$A3r:function(n,t,i,r,u,f){var e=this,o=this;this.$1lE.$Dd(function(){e.$8o++;if(e.$1lE.get_$3R()===2)u(e.$Ai,i,!0);else{Array.add(i,r(e.$1lE));t--;t>0?e.$A3r(n,t,i,r,u,f):u(e.$Ai,i,!1)}},function(n){_e.$5y.$ze(n.name,f)})}};_e.$Cr=function(n,t,i,r){this.$$d_$7XY=Function.createDelegate(this,this.$7XY);_e.$Cr.initializeBase(this,[[t],r]);this.$4IF=n;this.$HH=t;this.$Fs=i;this.$1vG=0;this.$1NL=new Array(0)};function $70J(n,t,i){n.$1NL=new Array(0);n.$1vG=0;var r="";if(n.$Pd.$Ou===2)t();else{r=n.$Pd.get_$3lT();$4pA(n,r,t,i)}}function $4pA(n,t,i,r){if(n.$Pd.$Ou===1&&n.$Pd.get_$3lT()===t){var u=n.$HH.$5r===_a.$4o.$4s.$5r?n.$Pd.get_$1As():n.$HH.$1C8(n.$Pd.get_$1Yh().data);Array.add(n.$1NL,new _e.$Cr.$9rA(n.$Pd.get_$1As(),u));var f=this;n.$Pd.$Dd(function(){$4pA(n,t,i,r)},r)}else{$70L(n);i()}}function $70L(n){n.$1NL.length>0&&n.$1NL.sort(n.$$d_$7XY)}function $70K(n,t,i){var u=n.$1NL[n.$1vG].get_$R();var r=n.$4IF.get(u);n.$1NL[n.$1vG]=null;n.$1vG++;var f="IdbQuerySortStrategy.Next";var e=this;_e.$3q.$Wo(_a.$FP,Object,f,r,function(i){$4pB(n,u,i.target.result);t()});var o=this;_e.$3q.$DT(_a.$FP,Object,f,r,function(){i(r.error)})}function $4pB(n,t,i){n.$5G4=t;n.$5GF=i;n.$5Fz=i?n.$HH.$1C8(i.data):null}_e.$Cr.prototype={$4IF:null,$HH:null,$Fs:0,$5GF:null,$5G4:null,$5Fz:null,$1NL:null,$1vG:0,get_$879:function(){return this.$5GF},get_$5YX:function(){return this.$5G4},get_$878:function(){return this.$5Fz.toString()},$3yf:function(n,t){$4pB(this,null,null);if(this.$1vG<this.$1NL.length)$70K(this,n,t);else if(this.$Pd.$Ou===2)n();else{var i=this;$70J(this,function(){i.$3yf(n,t)},t)}},$49:function(n,t){var i=this;this.$Pd.$Dd(function(){i.$3yf(n,t)},t)},$7XY:function(n,t){var i=n;var r=t;return this.$Fs?r.$5C4(i):i.$5C4(r)}};_e.$Cr.$9rA=function(n,t){this.$CP=n;this.$6Y8=t};_e.$Cr.$9rA.prototype={$CP:null,$6Y8:null,get_$R:function(){return this.$CP},get_$17v:function(){return this.$6Y8},$5C4:function(n){return Number.isInstanceOfType(this.get_$17v())&&Number.isInstanceOfType(n.get_$17v())?this.get_$17v()-n.get_$17v():String.isInstanceOfType(this.get_$17v())&&String.isInstanceOfType(n.get_$17v())?this.get_$17v()===n.get_$17v()?0:this.get_$17v()>n.get_$17v()?1:-1:0}};_e.$2I=function(n){this.$Pd=n;this.$Ou=0;this.$2HC=null};_e.$2I.$E=function(n,t,i,r,u,f,e){_a.$4.$J(t,"object store");_a.$4.$J(f,"success");f=_e.$2I.$7R9(n,f,e);_e.$2I.$8C3(r)?_e.$2I.$5ER(t,u,f):_e.$2I.$89Y(r)?_e.$2I.$7cH(t,i,r,u,f):_e.$2I.$8B1(r)?_e.$2I.$7dK(t,i,r,u,f):_e.$2I.$8Cp(r)&&_e.$2I.$7eI(t,i,r,u,f)};_e.$2I.$7cH=function(n,t,i,r,u){switch(_e.$2I.$3tl(i)){case 0:_e.$2I.$5ER(n,r,u);break;case 1:_e.$2I.$7cI(n,t,i,r,u);break;case 2:_e.$2I.$7cG(n,t,i,u);break}};_e.$2I.$7dK=function(n,t,i,r,u){switch(_e.$2I.$3tl(i)){case 0:_e.$2I.$7dM(n,t,i,r,u);break;case 1:_e.$2I.$7dN(n,t,i,u);break;case 2:_e.$2I.$7dL(n,t,i,u);break}};_e.$2I.$7eI=function(n,t,i,r,u){switch(_e.$2I.$3tl(i)){case 0:_e.$2I.$7eK(n,t,i,r,u);break;case 1:_e.$2I.$7eL(n,t,i,u);break;case 2:_e.$2I.$7eJ(n,t,i,u);break}};_e.$2I.$5ER=function(n,t,i){_e.$2I.$7bs(n,i)};_e.$2I.$7cI=function(n,t,i,r,u){var f=i.$GX[0].$HH;var e=i.$GX[0].$Fs;var o=t.$1ug(n,f);o?_e.$2I.$1rM(n,o,e,null,r,u):_e.$2I.$7br(n,u,f,e)};_e.$2I.$7cG=function(n,t,i,r){var u=t.$2vX(n,i.$GX[0].$HH,i.$GX[1].$HH);var f=i.$GX[0].$Fs;var e=i.$GX[1].$Fs;f===e&&u?_e.$2I.$1rM(n,u,f,null,0,r):_e.$2I.$7bq(n,i.$GX[0],i.$GX[1],r)};_e.$2I.$7dM=function(n,t,i,r,u){_e.$2I.$5ET(n,t,i,r,u)};_e.$2I.$7dN=function(n,t,i,r){var u=i.$7W;var f=i.$GX[0];if(u.get_$U3().$5r===f.$HH.$5r){var e=t.$1ug(n,u.get_$U3());if(e){var s=_e.$2I.$2pz(u);_e.$2I.$1rM(n,e,f.$Fs,s,0,r)}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}",u.get_$U3().$5r);_e.$2I.$3k4(n,u,f,r)}}else{var o=t.$2vX(n,u.get_$U3(),f.$HH);if(o){var h=_a.$76.$1ps(_e.$7f.$E(u.$uH,""),_e.$7f.$E(u.$uH,"￿"),!0,!0);_e.$2I.$1rM(n,o,f.$Fs,h,0,r)}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}:{1}",u.get_$U3().$5r,f.$HH.$5r);_e.$2I.$3k4(n,u,f,r)}}};_e.$2I.$7dL=function(n,t,i,r){var u=i.$7W;var f=i.$GX[0];var e=i.$GX[1];var o=t.$2vX(n,u.get_$U3(),f.$HH);if(o){var s=_a.$76.$1ps(_e.$7f.$E(u.$uH,""),_e.$7f.$E(u.$uH,"￿"),!0,!0);_e.$2I.$7d6(n,o,u,s,_e.$2I.$3lz(f.$Fs),[u.get_$U3(),f.$HH],e,r)}else if(f.$Fs===e.$Fs){o=t.$2vX(n,f.$HH,e.$HH);if(o)_e.$2I.$7d5(n,o,null,u,r);else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}:{1}",f.$HH.$5r,e.$HH.$5r);_e.$2I.$3k3(n,u,f,e,r)}}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}:{1}",u.get_$U3().$5r,f.$HH.$5r);_e.$2I.$3k3(n,u,f,e,r)}};_e.$2I.$7eK=function(n,t,i,r,u){_e.$2I.$5ET(n,t,i,r,u)};_e.$2I.$7eL=function(n,t,i,r){var u=i.$7W;var f=i.$GX[0];var e=t.$1ug(n,u.get_$U3());if(e){var o=_e.$2I.$2pz(u);u.get_$U3().$5r===f.$HH.$5r?_e.$2I.$1rM(n,e,f.$Fs,o,0,r):_e.$2I.$7d8(n,e,o,f,r)}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}",u.get_$U3().$5r);_e.$2I.$3k4(n,u,f,r)}};_e.$2I.$7eJ=function(n,t,i,r){var u=i.$7W;var f=i.$GX[0];var e=i.$GX[1];var o=t.$1ug(n,u.get_$U3());if(o){var s=_e.$2I.$2pz(u);_e.$2I.$7d7(n,o,s,f,e,r)}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}",u.get_$U3().$5r);_e.$2I.$3k3(n,u,f,e,r)}};_e.$2I.$5ET=function(n,t,i,r,u){var f=t.$1ug(n,i.$7W.$1jq[0]);if(f){var e=_e.$2I.$2pz(i.$7W);_e.$2I.$1rM(n,f,0,e,r,u)}else{_js.Trace.logWarning(_a.$0.$Cv,"This query would run faster with an index on {0}",i.$7W.$1jq[0].$5r);_e.$2I.$7bp(n,i.$7W,u)}};_e.$2I.$7d8=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Index) strategy.");var f=t.openCursor(i,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateIndexSortStrategy",f,function(t){var f=new _e.$Lu(t.target,i);var e=new _e.$Cr(n,r.$HH,r.$Fs,f);u(e)})};_e.$2I.$7d5=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$Cv,"Creating Filter(Index) strategy.");var f=t.openCursor(i,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateIndexFilterStrategy",f,function(n){var t=new _e.$Lu(n.target,i);var f=new _e.$jP(r,t);u(f)})};_e.$2I.$7d7=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Sort(Index)) strategy.");var e=t.openCursor(i,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateIndexSortSortStrategy",e,function(t){var e=new _e.$Lu(t.target,i);var o=new _e.$Cr(n,r.$HH,r.$Fs,e);var s=new _e.$Cr(n,u.$HH,u.$Fs,o);f(s)})};_e.$2I.$7d6=function(n,t,i,r,u,f,e,o){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Group((Index)) strategy.");var s=t.openCursor(r,u);_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateIndexGroupSortStrategy",s,function(t){var i=new _e.$Lu(t.target,r);var u=new _e.$176(f,i);var s=new _e.$Cr(n,e.$HH,e.$Fs,u);o(s)})};_e.$2I.$3k4=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Filter((Cursor)) strategy.");var u=_a.$76.$1Jp();var f=n.openCursor(u,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorFilterSortStrategy",f,function(f){var e=new _e.$Lu(f.target,u);var o=new _e.$jP(t,e);var s=new _e.$Cr(n,i.$HH,i.$Fs,o);r(s)})};_e.$2I.$3k3=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Sort(Filter((Cursor))) strategy.");var f=_a.$76.$1Jp();var e=n.openCursor(f,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorFilterSortSortStrategy",e,function(e){var o=new _e.$Lu(e.target,f);var s=new _e.$jP(t,o);var h=new _e.$Cr(n,i.$HH,i.$Fs,s);var c=new _e.$Cr(n,r.$HH,r.$Fs,h);u(c)})};_e.$2I.$7bp=function(n,t,i){_js.Trace.logInfo(_a.$0.$Cv,"Creating Filter(Cursor) strategy.");var r=_a.$76.$1Jp();var u=n.openCursor(r,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorFilterStrategy",u,function(n){var u=new _e.$Lu(n.target,r);var f=new _e.$jP(t,u);i(f)})};_e.$2I.$7bq=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Sort(Cursor)) strategy.");var u=_a.$76.$1Jp();var f=n.openCursor(u,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorSortSortStrategy",f,function(f){var e=new _e.$Lu(f.target,u);var o=new _e.$Cr(n,t.$HH,t.$Fs,e);var s=new _e.$Cr(n,i.$HH,i.$Fs,o);r(s)})};_e.$2I.$7br=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$Cv,"Creating Sort(Cursor) strategy.");var u=_a.$76.$1Jp();var f=n.openCursor(u,_e.$2I.$3lz(r));_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorSortStrategy",f,function(f){var e=new _e.$Lu(f.target,u);var o=new _e.$Cr(n,i,r,e);t(o)})};_e.$2I.$1rM=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$Cv,"Creating Index strategy.");var e=t.openCursor(r,_e.$2I.$3lz(i));_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateIndexStrategy",e,function(n){f(new _e.$Lu(n.target,r))})};_e.$2I.$7bs=function(n,t){_js.Trace.logInfo(_a.$0.$Cv,"Creating Cursor strategy.");var i=_a.$76.$1Jp();var r=n.openCursor(i,"next");_e.$3q.$Wo(_a.$FO,_a.$Iu,"CreateCursorStrategy",r,function(n){t(new _e.$Lu(n.target,i))})};_e.$2I.$3tl=function(n){return n.$GX&&n.$GX.length?n.$GX.length===1?1:n.$GX.length===2?2:0:0};_e.$2I.$8B1=function(n){return!!n&&!!n.$7W&&_a.$8k.isInstanceOfType(n.$7W)};_e.$2I.$89Y=function(n){return!!n&&!n.$7W};_e.$2I.$8C3=function(n){return!n};_e.$2I.$8Cp=function(n){return!!n&&!!n.$7W&&(_a.$Xf.isInstanceOfType(n.$7W)||_a.$Nf.isInstanceOfType(n.$7W))};_e.$2I.$3lz=function(n){return n?"prev":"next"};_e.$2I.$2pz=function(n){var i=null;if(_a.$Xf.isInstanceOfType(n)){var t=n;switch(t.$1bj){case 0:i=_a.$76.$1ps(t.$14a,t.$17P,!1,!1);break;case 3:i=_a.$76.$1ps(t.$14a,t.$17P,!0,!0);break;case 1:i=_a.$76.$1ps(t.$14a,t.$17P,!0,!1);break;case 2:i=_a.$76.$1ps(t.$14a,t.$17P,!1,!0);break;default:break}}else if(_a.$Nf.isInstanceOfType(n)){var r=n;var u=!r.$1pr;i=r.$3Gn?_a.$76.$A1Y(r.$1KN,u):_a.$76.$8HG(r.$1KN,u)}else if(_a.$8k.isInstanceOfType(n)){var f=n;i=_a.$76.$6CB(f.$uH)}return i};_e.$2I.$7R9=function(n,t,i){var r=n.onerror;n.onerror=function(t){n.onerror=r;_e.$5y.$ze(t.target.error.name,i);r&&r(t)};var u=t;t=function(t){n.onerror=r;u(t)};return t};function $4pC(n,t,i,r){if(n.$Ou===2)i(t);else{var u=this,f=this;n.$Dd(function(){$4pC(n,t+1,i,r)},function(n){_e.$5y.$ze(n.name,r)})}}function $4pD(n,t,i,r,u){var f=n.$Ou?1:0;var e=this,o=this;n.$Dd(function(){i+=f;if(n.$Ou===2)r(!1,i);else if(t.$5dv(n.get_$1As(),n.get_$1Yh().data)){n.$Ou=0;r(!0,i)}else $4pD(n,t,i,r,u)},function(n){_e.$5y.$ze(n.name,u)})}function $3Xi(n){if(!n.$Ou)throw Error.invalidOperation("cannot ask for value before calling next");}function $2ht(n){n.$Ou=n.get_$5YX()!==null?1:2}_e.$2I.prototype={$Pd:null,$Ou:0,$2HC:0,get_$1Yh:function(){$3Xi(this);return this.get_$879()},get_$1As:function(){$3Xi(this);return this.get_$5YX()},get_$3lT:function(){$3Xi(this);return this.get_$878()},get_$3R:function(){return this.$Ou},$B:function(n,t){if(this.$2HC===null){_js.Trace.logWarning(_a.$0.$Cv,"Asking for Count on anything other than a cusor strategy will require query traversal.");var i=this;$4pC(this,0,function(t){i.$2HC=t;n(i.$2HC)},t)}else n(this.$2HC)},$Dd:function(n,t){switch(this.$Ou){case 0:var i=this;this.$49(function(){$2ht(i);n()},t);break;case 1:var r=this;this.$3yf(function(){$2ht(r);n()},t);break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}},$1jv:function(n,t,i){$4pD(this,n,0,t,i)},$1U9:function(n,t,i){if(n&&this.$Ou!==2)switch(this.$Ou){case 0:var r=this,f=this;this.$49(function(){$2ht(r);r.$1U9(n-1,t,i)},function(n){_e.$5y.$ze(n.name,i)});break;case 1:var u=this,e=this;this.$5Yw(n,function(){$2ht(u);_e.$5y.$1Sr(t)},function(n){_e.$5y.$ze(n.name,i)});break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}else _e.$5y.$1Sr(t)},$49:function(n,t){this.$3yf(n,t)},$5Yw:function(n,t,i){if(n&&this.$Ou!==2){var r=this;this.$Dd(function(){r.$5Yw(n-1,t,i)},i)}else t()}};_e.$179=function(n,t){this.data=n;this.metadata=t};_e.$179.prototype={data:null,metadata:null};_e.$pV=function(n,t,i){this.$Mm=n;this.$Ai=t;this.$73=i;this.$4dK=t.objectStore("__versions");this.$3xj=t.objectStore("__indexes")};function $70M(n,t,i){var r=!1;if(i.storeName===t){r=!0;if(n.$73.$1lD(t)){var u=n.$73.$1aq(t);var f=i.storeVersion||"";u===f&&(r=!1)}}return r}_e.$pV.prototype={$Mm:null,$Ai:null,$4dK:null,$3xj:null,$73:null,$7ds:function(n,t,i,r){if(this.$73.$1lD(n))throw Error.invalidOperation("the object store: "+n+" already exists.");if(n.startsWith("__"))throw Error.invalidOperation("the object store: "+n+" begins with the reserved prefix __.");this.$Mm.createObjectStore(n,new _a.$UI(null,i));this.$73.$D(n,t);this.$4dK.put(new _e.$wd(n,t),n)},$6NB:function(n){if(this.$73.$1lD(n)){var r=this.$Mm.deleteObjectStore(n);this.$73.$34(n);var u=_a.$FP.$34(this.$4dK,n);var t=this.$3xj.openCursor(_a.$76.$1Jp(),"next");var i=this;_e.$3q.$Wo(_a.$FO,_a.$Iu,"RemoveObjectStore",t,function(t){if(t.target.result){var r=t.target.result.value;$70M(i,n,r)&&_a.$Qu.$34(t.target.result);_a.$Qu.$Dd(t.target.result)}})}},$Cl:function(n,t){if(this.$73.$1lD(n)){var i=t.$Tc();var r=this.$Ai.objectStore(n);_a.$FP.$34(r,i)}},$5Eo:function(n,t,i){if(!this.$73.$1lD(t))throw Error.invalidOperation("the object store: "+t+" does not exist.");if(this.$73.$5XJ(t,n))throw Error.invalidOperation("the object store: "+t+" already has index "+n+" declared.");var f=this.$73.$1aq(t);var r=new _e.$174(t,n,i,f);this.$3xj.put(r);var e=this.$Ai.objectStore(t);var u=_e.$NU.$E(r);e.createIndex(n,u.$5gF.$5r,_a.$Tk.$3mi);this.$73.$1oo(r.storeName,u)}};_e.$17B=function(n,t){_e.$17B.initializeBase(this,[n,t,new _a.$4o("data."+t[0])])};_e.$17B.prototype={$7QN:function(n,t,i){_e.$NU.$4dG(this.$kp[0],n,t,i)}};_e.$NV=function(){};_e.$NV.$IU=function(n,t,i,r){t.oncomplete=function(){_js.Trace.logInfo(_a.$0.$Cv,"idb transaction successfully completed");var t=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),n);_a.$2s.$jE(t,function(){_e.$5y.$1Sr(i)})};t.onabort=function(t){_js.Trace.logInfo(_a.$0.$Cv,"idb transaction aborted!");var i="AbortError";if(t.target.error){i=t.target.error.name;_js.Trace.logError(_a.$0.$Cv,"aborted due to error: "+i)}var u=new _a.$JI(_a.$2s.$13E(_a.$0.$Cv),n);_a.$2s.$jE(u,function(){_e.$5y.$ze(i,r)})}};_e.$wd=function(n,t){this.name=n.toLowerCase();this.version=t};_e.$wd.prototype={name:null,version:null};_e.$1Fk=function(){};_e.$1Fk.registerInterface("_e.$1Fk");_e.$1Fn=function(){};_e.$1Fn.registerInterface("_e.$1Fn");_e.$BC=function(n,t){this.$$d_$87X=Function.createDelegate(this,this.$87X);this.$Mm=n;this.$73=_e.$Fe.$vn();this.$MT=new _a.$yK(this);this.$gZ=new _a.$SG;this.$Bx="";this.$18q=t;this.$2f4=0;this.$1oY=new Array(0)};_e.$BC.$7b2=function(n,t,i){var r=null;try{r=new _e.$8K(t,i);n(r)}finally{r&&r.$1Q()}};_e.$BC.$7dt=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT, {2} TEXT, {3} TEXT)","__OBJECTSTORE","StoreName","IndexName","IndexKeyPath");var i=new Array(0);_e.$54.$Gl(n,"SqlBrowserDb.CreateObjectStoreMetaTable",t,i,null,null)};_e.$BC.$7fM=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__VERSIONS","EntityName","VersionName");var i=new Array(0);_e.$54.$Gl(n,"SqlBrowserDb.CreateVersionMetaTable",t,i,null,null)};_e.$BC.$7bD=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__BLOBS","StoreName","Blobs");var i=new Array(0);_e.$54.$Gl(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$BC.$7eq=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__SETTINGS","Id","Value");var i=new Array(0);_e.$54.$Gl(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$BC.$A1K=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__VERSIONS","EntityName","VersionName");var r=["db",t];_e.$54.$Gl(n,"SqlBrowserDb.UpdateVersionMetaTable",i,r,null,null)};_e.$BC.$9yU=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__SETTINGS","Id","Value");var r=["Features",JsonParser.serialize(t)];_e.$54.$Gl(n,"SqlBrowserDb.UpdateActivatedFeatures",i,r,null,null)};function $70j(n,t){var r=null;var u=null;var f=null;var e=null;var i=String.format("SELECT * FROM {0}","__OBJECTSTORE");var o=new Array(0);var s=this;_e.$54.$Gl(t,"SqlBrowserDb.PopulateMetadataFromDatabase1",i,o,function(t,i){r=i;$2hu(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__VERSIONS");var h=this;_e.$54.$Gl(t,"SqlBrowserDb.PopulateMetadataFromDatabas2",i,o,function(t,i){u=i;$2hu(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__BLOBS");var c=this;_e.$54.$Gl(t,"SqlBrowserDb.PopulateMetadataFromDatabase3",i,o,function(t,i){f=i;$2hu(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__SETTINGS");var l=this;_e.$54.$Gl(t,"SqlBrowserDb.PopulateMetadataFromDatabase4",i,o,function(t,i){e=i;$2hu(n,r,u,f,e)},null)}function $2hu(n,t,i,r,u){if(t&&i&&r&&u){n.$73=_e.$Fe.$7cm(t,i,r);$70l(n,i);$70k(n,u)}}function $70l(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.EntityName==="db"){n.$Bx=r.VersionName;break}}}function $70k(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.Id==="Features"){var u=r.Value;n.$1oY=JsonParser.deserialize(u);break}}n.$1oY=n.$1oY||new Array(0)}_e.$BC.prototype={$Mm:null,$18q:null,$73:null,$MT:null,$gZ:null,$Bx:null,$1oY:null,$2f4:0,get_$39:function(){return this.$Bx},get_$1RS:function(){return this.$73.get_$1RS()},get_$1oZ:function(){return this.$1oY},$3ha:function(n,t,i,r,u){var o=this.$73.$3p();var e=this.$2f4++;this.$18q.$46i(e);var h=this,s=this,f=this;this.$Mm.transaction(function(r){_e.$BC.$7b2(i,r,o);_e.$BC.$A1K(r,n);_e.$BC.$9yU(r,t)},function(n){s.$18q.$20O(e);_e.$Ba.$2aE(n,u)},function(){f.$18q.$20O(e);f.$73=o.$3p();f.$Bx=n;f.$1oY=t;r&&r()})},$BT:function(n,t,i,r){var u=null;var f=this.$2f4++;this.$18q.$46i(f);var e=this,o=this,s=this;this.$Mm.transaction(function(i){_js.Trace.logInfo(_a.$0.$dt,"queuing transaction {0} with id {1}",n.$Z8,f);u=new _e.$54(i,e.$73,e.$MT,e.$gZ,n);t(u)},function(t){var i=_a.$6.aes(_a.$0.$dt,"SqlDbFailure");try{_js.Trace.logInfo(_a.$0.$dt,"transaction {0} ended in error.",n.$Z8);o.$18q.$20O(f);u&&u.$2jq?_e.$Ba.$zd(5,"transaction aborted",r):_e.$Ba.$893(t)?o.$18q.$8If():u&&u.get_$5gR()?_e.$Ba.$2aE(u.get_$5gR(),r):_e.$Ba.$2aE(t,r)}finally{_a.$6.aee(i)}},function(){_js.Trace.logInfo(_a.$0.$dt,"transaction {0} with id {1} ended in success.",n.$Z8,f);var t=_a.$6.aes(_a.$0.$dt,"SqlDbSuccess");try{s.$18q.$20O(f);u&&u.$3JE();_e.$Ba.$9cA(i,u.$e6.$Z8)}finally{_a.$6.aee(t)}})},$6gf:function(n,t){var i=this,r=this;this.$3ha("",new Array(0),this.$$d_$87X,function(){n&&n()},function(n){t&&t(n)})},$IU:function(n,t){this.$MT.$IU(n,t)},$18g:function(n){this.$MT.$18g(n)},$4cI:function(){this.$MT.$4cI()},$5FC:function(n){if(!this.$73.$1tn(n))throw Error.invalidOperation(String.format("The object store {0} does not exist",n));var t=new _e.$BC.$9rN(n,this.$gZ);this.$gZ.$53y(t);return t},$49:function(n,t){_a.$4.$J(n,"success");var i=this,r=this,u=this;this.$Mm.transaction(function(n){_e.$BC.$7dt(n);_e.$BC.$7fM(n);_e.$BC.$7bD(n);_e.$BC.$7eq(n);$70j(i,n)},function(n){_e.$Ba.$2aE(n,t)},function(){n()})},$7vl:function(n){var t=this.$73.$1tn(n);t||Error.invalidOperation(String.format("The storeName {0} doesn't exist",n));return t.$Bx},$4X:function(){},$87X:function(n){for(var t=n,r=this.get_$1RS(),i=0;i<r.length;++i)t.$6NB(r[i]);t.$9YH();t.$9YJ();t.$9YG();t.$9YI()}};_e.$BC.$9rN=function(n,t){_e.$BC.$9rN.initializeBase(this,[n,t])};_e.$Ba=function(n,t){_e.$Ba.initializeBase(this,[n,t])};_e.$Ba.$2aE=function(n,t){var i=n.message;var r=_e.$Ba.$9we(n);_js.Trace.logError(_a.$0.$dt,"SQL Error - code "+r+": {0}",i);_e.$Ba.$zd(r,i,t)};_e.$Ba.$zd=function(n,t,i){if(i){var r=new _a.$JI(_a.$2s.$13E(_a.$0.$dt),"SQLBrowserDBError.ReportError");r.$2KA=r.$2D+"_"+t;_a.$2s.$jE(r,function(){i(new _e.$Ba(n,t))})}};_e.$Ba.$9c9=function(n,t,i,r){if(n){var u=new _a.$JI(_a.$2s.$13E(_a.$0.$dt),"SQLBrowserDBError.ReportStatementSuccess_"+r);_a.$2s.$jE(u,function(){n(t,i)})}};_e.$Ba.$9cA=function(n,t){if(n){var i=new _a.$JI(_a.$2s.$13E(_a.$0.$dt),"SQLBrowserDBError.ReportTransactionSuccess_"+t);_a.$2s.$jE(i,function(){n()})}};_e.$Ba.$893=function(n){var t=n.code;var i=(n.message||"").toLowerCase();var r=!t&&i.indexOf("closed")>=0;_js.Trace.logWarning(_a.$0.$dt,"returning {0} for the sql error with code {1} and message {2} in IsDatabaseClosedError.",r,t,i);return r};_e.$Ba.$9we=function(n){var t=0;switch(n.code){case 6:t=1;break;case 1:t=0;break;case 4:t=3;break;case 5:t=0;break;case 7:t=4;break;case 3:t=0;break;case 0:t=0;break;case 2:t=0;break}return t};_e.$lt=function(n,t){_e.$lt.initializeBase(this);this.$6gb=n;this.$18q=t};function $70m(n,t,i,r,u){_a.$4.$1G(t,"name");r.val=null;u.val="";try{r.val=n.$6gb.openDatabase(t,"",_u.Strings.l_OWA_Text,i*1048576,null)}catch(f){u.val=f.message;r.val=null}return!!r.val}_e.$lt.prototype={$6gb:null,$18q:null,$9Rk:function(n,t,i,r){_a.$4.$J(i,"success");var u;var f;var e,o,s;if(s=$70m(this,n,t,e={val:u},o={val:f}),u=e.val,f=o.val,s){var h=new _e.$BC(u,this.$18q);var c=this,l=this;h.$49(function(){i(h)},function(n){r&&r(n)})}else r&&r(new _a.$Au(0,f))},$7hP:function(n,t,i){var r=this,u=this;this.$9Rk(n,5,function(n){n.$6gf(function(){t()},function(n){i&&i(n)})},function(n){i&&i(n)})}};_e.$DX=function(n,t,i,r){this.$Ai=n;this.$73=t;this.$26o=i;this.$su=r};_e.$DX.$7qW=function(n,t){var i=null;n.rows.length&&(i=_e.$g2.$2LU(0,n,t).$27);return i};function $4pM(n,t){if(t){$70q(n,t);$70r(n,t)}}function $70r(n,t){if(t.$GX)for(var i=0;i<t.$GX.length;++i)if(!n.$73.$2Mf(t.$GX[i].$HH.$5r)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$GX[i].$HH.$5r);_a.$Au.$1IM(1,r)}}function $70q(n,t){if(t.$7W)for(var r=t.$7W.$1jq,i=0;i<r.length;++i)if(!n.$73.$2Mf(r[i].$5r)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5r);_a.$Au.$1IM(1,u)}}function $70o(n,t,i){var r=[];var f={};Array.add(r,t);for(var e=0;e<n.$73.get_$29o().length;++e){var o=n.$73.get_$29o()[e];var p=o.$1C8(i);f[o.$5r]=p;o.$7hU(i)}try{Array.add(r,JsonParser.serialize(i));for(var s=0;s<n.get_$1wO().length;++s){var h=n.get_$1wO()[s];var c=f[h];$70t(n,t,h,c);$70u(n,t,h,c);Array.add(r,c)}for(var l=0;l<n.$73.get_$2Fk().length;++l){var v=n.$73.get_$2Fk()[l].$5r;var u=f[v];u=undefined===u?null:u;$70s(n,t,v,u);Array.add(r,u)}}finally{for(var a=0;a<n.$73.get_$29o().length;++a){var y=n.$73.get_$29o()[a];var w=f[y.$5r];y.$28n(i,w)}}return r}function $70t(n,t,i,r){if($6(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",i,n.$73.get_$nn(),t);_a.$Au.$1IM(1,u)}}function $70s(n,t,i,r){if(r&&!String.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a blob store {1} but it is not a string {2}",i,n.$73.get_$nn(),t);_a.$Au.$1IM(1,u)}}function $70u(n,t,i,r){if(!String.isInstanceOfType(r)&&!Number.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",i,n.$73.get_$nn(),t,Object.getType(r).getName());_a.$Au.$1IM(1,u)}}function $70p(n){for(var t=new Sys.StringBuilder("(?, ?"),i=0;i<n.get_$1wO().length;++i)t.append(", ?");for(var r=0;r<n.$73.get_$2Fk().length;++r)t.append(", ?");t.append(")");return t.toString()}function $70n(n){for(var t=new Sys.StringBuilder(String.format("({0}, {1}",_e.$Ex.$16A,"json")),i=0;i<n.get_$1wO().length;++i)t.append(String.format(", [{0}]",n.get_$1wO()[i]));for(var r=0;r<n.$73.get_$2Fk().length;++r)t.append(String.format(", [{0}]",n.$73.get_$2Fk()[r].$5r));t.append(")");return t.toString()}_e.$DX.prototype={$Ai:null,$73:null,$26o:null,$su:null,get_$1L:function(){return this.$73.get_$nn()},get_$1wO:function(){return this.$73.get_$1wO()},$3x:function(n,t,i){_a.$4.$J(n,"id must be provided");_a.$4.$J(n.$Tc(),"id must be provided");_a.$4.$J(t,"success callback must be provided");var r=n.$Tc();_a.$4.$J(r,"id must be provided");_a.$4.$1G(r.toString(),"id must be provided");var u=String.format("SELECT * FROM [{0}] WHERE {1} = ?",this.$73.get_$nn(),_e.$Ex.$16A);var f=[r];var e=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,u,f,function(n,i){var r=_e.$DX.$7qW(i,e.$73.get_$29o());t(r)},i)},$iD:function(n,t,i){_a.$4.$J(n,"id must be provided");var r=n.$Tc();_a.$4.$J(r,"id must be provided");_a.$4.$1G(r.toString(),"id must be provided");var f=String.format("DELETE FROM [{0}] WHERE {1} = ?",this.$73.get_$nn(),_e.$Ex.$16A);var e=[r];this.$su.$16H(this,n);var u=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,f,e,function(){u.$26o&&u.$26o(u.get_$1L(),2,n,null);t&&t()},i)},$1r:function(n,t){var i=String.format("DELETE FROM [{0}]",this.$73.get_$nn());var r=[];this.$su.$1h4(this);var u=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,i,r,function(){n&&n()},t)},$9YL:function(n,t,i,r){_a.$4.$J(n,"id must be provided");_a.$4.$J(t,"json must be provided");var f=!0;var e=!1;if(this.$Ai.$e6.$4UM){var o=String.format("SELECT COUNT(*) FROM [{0}] WHERE {1} = ?",this.$73.get_$nn(),_e.$Ex.$16A);var s=[n.$Tc()];var l=this,a=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,o,s,function(n,t){var i=t.rows.item(0)["COUNT(*)"];f=!!i},function(t){_js.Trace.logInfo(_a.$0.$5a,"Database query with ClientStoreId = {0} failed with error: {1}",n.toString(),t.$3v)})}var h=String.format("INSERT OR REPLACE INTO [{0}] {1} VALUES {2}",this.$73.get_$nn(),$70n(this),$70p(this));var c=$70o(this,n.$Tc(),t);this.$su.$1h5(this,n,t);var u=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,h,c,function(r,o){e=!0;u.$26o&&(f?u.$26o(u.get_$1L(),1,n,t):u.$26o(u.get_$1L(),0,n,t));n.$Tc()||(n=new _a.$Nn(o.insertId));i&&i(n)},r)},$It:function(n,t,i){_a.$4.$J(t,"success");$4pM(this,n);t(new _e.$g2(this.$Ai,n,this.$73.get_$nn(),this.$73.get_$29o()))},$3xH:function(n,t,i){_a.$4.$J(t,"success");var r=new _a.$8J(n,null);$4pM(this,r);t(new _e.$g1(this.$Ai,r,this.$73.get_$nn()))}};_e.$54=function(n,t,i,r,u){this.$Ai=n;this.$73=t;this.$su=new _a.$SF(this,r);this.$1Fo=null;this.$e6=u;i&&(this.$1Fo=new _a.$yI(i))};_e.$54.$Gl=function(n,t,i,r,u,f){var s="";var h="";if(_js.Trace.$2t&&_js.Trace.$Td===5){for(var e="{ ",o=0;o<r.length;++o){e+=r[o]?r[o].toString():"null";o<r.length-1&&(e+=", ")}e+=" }";s=String.format("ExecuteSql => {0} {1}",i,e.substr(0,50));h=String.format("ExecuteSql => {0} {1}",i,e.substr(0,256))}n.executeSql(i,r,function(n,i){var r=_a.$6.aes(_a.$0.$dt,"ExecuteSqlSuccess");try{_e.$Ba.$9c9(u,n,i,t)}finally{_a.$6.aee(r)}},function(t,r){var u=_a.$6.aes(_a.$0.$dt,"ExecuteSqlFailure");try{n.lastBrowserDbTransactionError=r;i!=="BOGUS SQL STATEMENT TO FORCE ROLLBACK"&&_e.$Ba.$2aE(r,f);return!0}finally{_a.$6.aee(u)}})};_e.$54.prototype={$Ai:null,$73:null,$1Fo:null,$su:null,$e6:null,$2jq:!1,get_$1IW:function(){return this.$e6},get_$5gR:function(){return this.$Ai.lastBrowserDbTransactionError},get_$7mT:function(){var n=null;this.$1Fo&&(n=this.$1Fo.$$d_$9Ya);return n},$2Do:function(){this.$2jq=!0;_e.$54.$Gl(this.$Ai,"SqlBrowserDbTransaction.Abort","BOGUS SQL STATEMENT TO FORCE ROLLBACK",[],null,null)},$Dg:function(n){var t=this.$73.$7vk(n);if(!t)throw Error.invalidOperation(String.format("Object store {0} does not exist",n));return new _e.$DX(this,t,this.get_$7mT(),this.$su)},$3JE:function(){this.$1Fo&&this.$1Fo.$3JE(this.$e6)}};_e.$Ex=function(){};_e.$1D3=function(n,t,i){_e.$1D3.initializeBase(this,[n,t,i]);this.$7W=n.$7W};_e.$1D3.prototype={$7W:null,get_$A2u:function(){return"WHERE ["+this.$7W.get_$U3().$5r+"] = ?"},get_$6gY:function(){return[this.$7W.$uH]}};_e.$1D4=function(n,t,i){_e.$1D4.initializeBase(this,[n,t,i]);this.$7W=n.$7W};_e.$1D4.prototype={$7W:null,get_$A2u:function(){var n=" ["+this.$7W.get_$U3().$5r+"] ";return"WHERE"+n+this.get_$8Fn()+" ? AND"+n+this.get_$9e7()+" ?"},get_$6gY:function(){return[this.$7W.$14a,this.$7W.$17P]},get_$8Fn:function(){var n=">";this.$7W.$1bj&&this.$7W.$1bj!==2||(n+="=");return n},get_$9e7:function(){var n="<";this.$7W.$1bj&&this.$7W.$1bj!==1||(n+="=");return n}};_e.$1D5=function(n,t,i){_e.$1D5.initializeBase(this,[n,t,i]);this.$7W=n.$7W};_e.$1D5.prototype={$7W:null,get_$A2u:function(){var n;switch(this.$7W.$3Gn){case 0:n=this.$7W.$1pr===1?">=":">";break;case 1:n=this.$7W.$1pr===1?"<=":"<";break;default:throw Error.invalidOperation("OperatorType is not supported.");}return"WHERE ["+this.$7W.get_$U3().$5r+"] "+n+" ?"},get_$6gY:function(){return[this.$7W.$1KN]}};_e.$Fe=function(){this.$wE=[]};_e.$Fe.$vn=function(){return new _e.$Fe};_e.$Fe.$7cm=function(n,t,i){for(var c=new _e.$Fe,l={},r={},u=0;u<t.rows.length;++u){var a=t.rows.item(u);var v=a.EntityName.toLowerCase();l[v]=a.VersionName;r[v]=null}for(var f=0;f<i.rows.length;++f){for(var y=i.rows.item(f),nt=y.StoreName.toLowerCase(),tt=JsonParser.deserialize(y.Blobs),p=[],w=tt,it=w.length,e=0;e<it;++e){var rt=w[e];Array.add(p,new _a.$4o(rt))}r[nt]=p}for(var b=n.rows,o=0;o<b.length;++o){var s=b.item(o);var h=s.StoreName;var k=s.IndexName;var d=s.IndexKeyPath;var g=$4pQ(c,h,l[h.toLowerCase()],r[h.toLowerCase()]);_js.$9.$a(k)||g.$1oo(k);_js.$9.$a(d)||g.$53o(new _a.$4o(d))}return c};function $2hv(n,t){return n.$wE[t]}function $4pQ(n,t,i,r){var u=n.$1tn(t);if(!u){u=new _e.$10B(t,i,r);Array.add(n.$wE,u)}return u}_e.$Fe.prototype={get_$1RS:function(){for(var t=[],n=0;n<this.$wE.length;++n){var i=$2hv(this,n);Array.add(t,i.$Z2)}return t},$D:function(n,t,i){$4pQ(this,n,t,i)},$34:function(n){for(var t=0;t<this.$wE.length;++t){var i=$2hv(this,t);if(i.$30c(n.$Z2)){Array.removeAt(this.$wE,t);break}}},$3p:function(){for(var t=new _e.$Fe,n=0;n<this.$wE.length;++n){var i=$2hv(this,n);Array.add(t.$wE,i.$3p())}return t},$3qI:function(n){return!!this.$1tn(n)},$1tn:function(n){for(var i=null,t=0;t<this.$wE.length;++t){var r=$2hv(this,t);if(r.$30c(n)){i=r;break}}return i},$7vk:function(n){return this.$1tn(n)}};_e.$10B=function(n,t,i){this.$Z2=n;this.$Bx=t;this.$1KJ=i||[];this.$1l6=Array.clone(this.$1KJ);this.$2Na={};this.$1wN={}};_e.$10B.prototype={$Z2:null,$Bx:null,$1KJ:null,$1l6:null,$2Na:null,$1wN:null,get_$nn:function(){return this.$Z2},get_$1wO:function(){var n=[];var t=this.$1wN;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.value)}return n},get_$29o:function(){return this.$1l6},get_$2Fk:function(){return this.$1KJ},$30c:function(n){return this.$Z2.toLowerCase()===n.toLowerCase()},$3p:function(){var n=new _e.$10B(this.$Z2,this.$Bx,this.$1KJ);n.$2Na=_0365f.$58.$3p(this.$2Na);n.$1wN=_0365f.$58.$3p(this.$1wN);n.$1l6=Array.clone(this.$1l6);return n},$1oo:function(n){this.$2Na[n.toLowerCase()]=n},$53o:function(n){this.$1wN[n.$5r.toLowerCase()]=n.$5r;Array.add(this.$1l6,n)},$82i:function(n){return n.toLowerCase()in this.$2Na},$2Mf:function(n){return n.toLowerCase()in this.$1wN||n.toLowerCase()===_e.$Ex.$16A}};_e.$Gu=function(n,t,i){this.$4J=n;this.$Z2=t;this.$6Uh=i};_e.$Gu.$E=function(n,t,i){var r=null;n&&n.$7W?_a.$8k.isInstanceOfType(n.$7W)?r=new _e.$1D3(n,t,i):_a.$Xf.isInstanceOfType(n.$7W)?r=new _e.$1D4(n,t,i):_a.$Nf.isInstanceOfType(n.$7W)&&(r=new _e.$1D5(n,t,i)):r=new _e.$Gu(n,t,i);return r};_e.$Gu.$7y5=function(n){return n?"DESC":"ASC"};function $714(n){return!!n.$4J&&!!n.$4J.$GX&&n.$4J.$GX.length>0}function $2hw(n,t){var i="SELECT "+t+" FROM ["+n.$Z2+"]";var r=n.get_$A2u();r&&(i+=" "+r);var u=n.get_$9SO();u&&(i+=" "+u);return i}_e.$Gu.prototype={$4J:null,$Z2:null,$6Uh:0,get_$9h3:function(){return this.$6Uh===1?$2hw(this,"*"):$2hw(this,_e.$Ex.$16A)},get_$9gK:function(){return $2hw(this,"COUNT(*)")},get_$4Xf:function(){var n=[];this.get_$6gY()&&Array.addRange(n,this.get_$6gY());return n},get_$A2u:function(){return""},get_$6gY:function(){return[]},get_$9SO:function(){var t="";if($714(this)){t="ORDER BY";for(var n=0;n<this.$4J.$GX.length;++n){var i=this.$4J.$GX[n];t+=" ["+i.$HH.$5r+"] "+_e.$Gu.$7y5(i.$Fs)+(n<this.$4J.$GX.length-1?",":"")}}return t},$9go:function(){for(var n=[],t=0;t<arguments.length;++t)n[t]=arguments[t];for(var r="",i=0;i<n.length;++i){r+="["+n[i].$5r+"]";i+1<n.length&&(r+=", ")}return $2hw(this,r)}};_e.$g1=function(n,t,i){this.$Gq=new _e.$LG(n,_e.$Gu.$E(t,i,0))};_e.$g1.$2LU=function(n,t){var i=t.rows.item(n);var r=i[_e.$Ex.$16A];return new _a.$Nn(r)};_e.$g1.prototype={$Gq:null,$B:function(n,t){this.$Gq.$B(n,t)},$Dd:function(n,t,i){this.$Gq.$Dd(_a.$Nn,n,_e.$g1.$2LU,t,i)}};_e.$g2=function(n,t,i,r){this.$Gq=new _e.$LG(n,_e.$Gu.$E(t,i,1));this.$1l6=r};_e.$g2.$2LU=function(n,t,i){for(var u=t.rows.item(n),s=u.json,f=JsonParser.deserialize(s),e=i,h=e.length,r=0;r<h;++r){var o=e[r];var c=u[o.$5r];o.$28n(f,c)}return new _a.$f3(_e.$g1.$2LU(n,t),f)};_e.$g2.prototype={$Gq:null,$1l6:null,get_$Iv:function(){return this.$Gq.$8o},$B:function(n,t){this.$Gq.$B(n,t)},$Dd:function(n,t,i){var f=this;var r=t?function(n,i,r){t(n,i,r)}:null;var u=this;this.$Gq.$Dd(_a.$f3,n,function(n,t){return _e.$g2.$2LU(n,t,u.$1l6)},r,i)},$1jv:function(n,t,i,r){this.$Gq.$1jv(n,t,i,r)},$1U9:function(n,t,i){this.$Gq.$1U9(n,t,i)}};_e.$LG=function(n,t){this.$Ai=n;this.$1lA=t};_e.$LG.$7o6=function(n,t){for(var i=0;i<n.rows.length;++i)if(t.$8D9(n.rows.item(i)))return i;return-1};_e.$LG.$58E=function(n,t,i){var r=String.format(" LIMIT {0} OFFSET {1}",i,t);return n+r};function $4pR(n){if(n.$1my)throw Error.invalidOperation("An async operation is currently in progress");}_e.$LG.prototype={$1lA:null,$Ai:null,$8o:0,$1my:!1,$B:function(n,t){var i=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,this.$1lA.get_$9gK(),this.$1lA.get_$4Xf(),function(t,i){var r=i.rows.item(0)["COUNT(*)"];n(r)},t)},$Dd:function(n,t,i,r,u){$4pR(this);this.$1my=!0;var e=_e.$LG.$58E(this.$1lA.get_$9h3(),this.$8o,t);this.$8o=this.$8o+t;var f=this,o=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,e,this.$1lA.get_$4Xf(),function(n,u){f.$1my=!1;if(r){for(var o=u.rows.length,h=_a.$6.ads(_a.$0.$dt,"SqlQueryResultImpl.Next_BuildResultsFromRow_"+o),s=new Array(o),e=0;e<o;++e){var c=i(e,u);s[e]=c}_a.$6.ade(h);r(f.$Ai,s,s.length<t)}},function(n){o.$1my=!1;u&&u(n)})},$1jv:function(n,t,i,r){$4pR(this);_a.$4.$J(t,"condition cannot be null");this.$1my=!0;this.$5Yt(t,this.$8o,i,r)},$1U9:function(n,t,i){this.$8o+=n;t()},$5Yt:function(n,t,i,r){var f;var e=_e.$LG.$58E((f=this.$1lA).$9go.apply(f,n.$1jq),t,500);var u=this,o=this;_e.$54.$Gl(this.$Ai.$Ai,this.$Ai.$e6.$Z8,e,this.$1lA.get_$4Xf(),function(f,e){var o=_e.$LG.$7o6(e,n);var s=o!==-1;var h=e.rows.length>0;if(s||!h){u.$1my=!1;u.$8o=t+o;i(s)}else u.$5Yt(n,t+e.rows.length,i,r)},function(n){o.$1my=!1;r&&r(n)})}};_e.$8K=function(n,t){_e.$8K.initializeBase(this);this.$BH=n;this.$1gu=t};_e.$8K.$7Vg=function(n){if(n.startsWith("__"))throw Error.create("An object store cannot be created with a name beginning with __");};_e.$8K.$7Sq=function(n){for(var t="(",i=0;i<n.length;++i){i>0&&(t+=", ");t+=String.format("[{0}]",n[i].$5r.$5r)}t+=")";return t};_e.$8K.$7Vp=function(n){if(n.length>2)throw Error.invalidOperation("Cannot create a multi-column index with more than two fields");};_e.$8K.$7Vk=function(n,t){if(n.$82i(t))throw Error.invalidOperation(String.format("The index {0} already exists",t));};function $71A(n,t,i,r){for(var u=0;u<i.length;++u){var f=i[u];if(!r.$2Mf(f.$5r.$5r)){$719(n,r,f);$716(n,r,t,f)}}}function $71C(n,t,i,r){var u=i?"INTEGER PRIMARY KEY AUTOINCREMENT":"TEXT PRIMARY KEY";var f=$71E(n,r);var e=String.format("CREATE TABLE [{0}]({1} {3}, {2} BLOB"+f+")",t,_e.$Ex.$16A,"json",u);var o=new Array(0);_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.CreateUnderlyingObjectStoreTable",e,o,null,null)}function $71E(n,t){var u="";if(t&&t.length>0){for(var i=new Sys.StringBuilder,r=0;r<t.length;++r){i.append(", [");i.append(t[r].$5r);i.append("] BLOB")}u=i.toString()}return u}function $718(n,t,i){var r=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?, ?)","__VERSIONS","EntityName","VersionName");var u=[t,i];_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.AddStoreVersionToVersionsTable",r,u,null,null)}function $715(n,t,i,r){var f="[]";if(r){for(var e=[],o=r,s=o.length,u=0;u<s;++u){var h=o[u];Array.add(e,h.$5r)}f=JsonParser.serialize(e)}var c=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?,?)","__BLOBS","StoreName","Blobs");var l=[t,f];_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.AddBlobPathsToBlobTable",c,l,null,null)}function $717(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t,"",""];_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.AddStoreNameToObjectStoreMetadata",u,f,null,null);n.$1gu.$D(t,i,r)}function $71F(n,t){var i=String.format("DELETE FROM {0} WHERE {1} = ?","__OBJECTSTORE","StoreName");var r=[t.$Z2];_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.RemoveStoreNameFromObjectStoreMetadata",i,r,null,null);n.$1gu.$34(t)}function $4pT(n,t){var i=String.format("DROP TABLE IF EXISTS [{0}]",t);var r=new Array(0);_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.RemoveUnderlyingObjectStoreTable",i,r,null,null)}function $71D(n,t){if(n.$1gu.$3qI(t)){var i=new _e.$Ba(1,String.format("The object store {0} already exists.",t));throw Error.create(i.$3v,i);}}function $4pS(n,t){var i=n.$1gu.$1tn(t);if(!i){var r=new _e.$Ba(1,String.format("The object store {0} was not found.",t));throw Error.create(r.$3v,r);}return i}function $71B(n,t,i,r){var u=_e.$8K.$7Sq(r);var f=String.format("CREATE INDEX [{0}] ON [{1}] {2}",t,i.get_$nn(),u);var e=new Array(0);_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.CreateSqlIndexOnColumns",f,e,null,null)}function $716(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t.$Z2,i,r.$5r.$5r];_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.AddIndexInformationToMetaTable",u,f,null,null);t.$53o(r.$5r)}function $719(n,t,i){var r=String.format("ALTER TABLE [{0}] ADD COLUMN [{1}] {2}",t.get_$nn(),i.$5r.$5r,_a.$ju.$9a(i.$AK));var u=new Array(0);_e.$54.$Gl(n.$BH,"SqlSchemaUpdater.AlterTableToAddColumnForIndex",r,u,null,null)}_e.$8K.prototype={$1gu:null,$BH:null,$7ds:function(n,t,i,r){$71D(this,n);_e.$8K.$7Vg(n);$4pT(this,n);$71C(this,n,i,r);$718(this,n,t);$715(this,n,t,r);$717(this,n,t,r)},$6NB:function(n){if(this.$1gu.$3qI(n)){var t=$4pS(this,n);$4pT(this,t.$Z2);$71F(this,t)}},$Cl:function(n,t){if(this.$1gu.$3qI(n)){var i=String.format("DELETE FROM [{0}] WHERE {1} = ?",n,_e.$Ex.$16A);var r=[t.$Tc()];_e.$54.$Gl(this.$BH,"SqlSchemaUpdater.RemoveItem",i,r,null,null)}},$5Eo:function(n,t,i){_e.$8K.$7Vp(i);var r=$4pS(this,t);_e.$8K.$7Vk(r,n);$71A(this,n,i,r);$71B(this,n,r,i);r.$1oo(n)},$9YH:function(){var n=String.format("DELETE FROM {0}","__OBJECTSTORE");var t=new Array(0);_e.$54.$Gl(this.$BH,"SqlSchemaUpdater.PurgeObjectStoreMetadata",n,t,null,null)},$9YJ:function(){var n=String.format("DELETE FROM {0}","__VERSIONS");var t=new Array(0);_e.$54.$Gl(this.$BH,"SqlSchemaUpdater.PurgeVersionMetadata",n,t,null,null)},$9YG:function(){var n=String.format("DELETE FROM {0}","__BLOBS");var t=new Array(0);_e.$54.$Gl(this.$BH,"SqlSchemaUpdater.PurgeBlobMetadata",n,t,null,null)},$9YI:function(){var n=String.format("DELETE FROM {0}","__SETTINGS");var t=new Array(0);_e.$54.$Gl(this.$BH,"SqlSchemaUpdater.PurgeSettingsMetadata",n,t,null,null)},$4c:function(){this.$BH=null}};_e.$fz=function(n,t){this.transaction=this.$BT;this.$10H=n;this.$2Qb=t;this.$3S3=[];this.$3S4=!1};function $4pN(n){if(!n.$3S4&&n.$3S3.length>0){n.$3S4=!0;var t=Array.dequeue(n.$3S3);var i=this;t.$9ra(function(){n.$3S4=!1;$4pN(n)})}}_e.$fz.prototype={$10H:null,$2Qb:null,$3S4:!1,$3S3:null,$BT:function(n,t,i){_a.$4.$J(n,"transaction");var r=new _e.$55(this.$10H,this.$2Qb,i,t);try{n(r);Array.enqueue(this.$3S3,r);$4pN(this)}catch(u){_js.Trace.logException(_a.$0.$dt,u,"Exception caught in transaction callback.");if(t){var f=String.format("Exception caught in transaction callback. {0}",u.message);var e=new _a.$yB(0,f);t(e)}}}};_e.$1D1=function(n){_e.$1D1.initializeBase(this);this.insertId=n.insertId;this.rowsAffected=n.rowsAffected;this.rows=new _e.$1D2(n)};_e.$1D2=function(n){_e.$1D2.initializeBase(this);this.length=n.rows.length;this.$3Dj=n};_e.$1D2.prototype={$3Dj:null,item:function(n){for(var i={},r=this.$3Dj.rows[n],t=0;t<this.$3Dj.columnNames.length;++t){var u=this.$3Dj.columnNames[t];i[u]=r[t]}return i}};_e.$lu=function(n,t,i,r){_a.$4.$1G(n,"sql");_a.$4.$J(t,"args");_a.$4.$J(i,"successCallback");_a.$4.$J(r,"errorCallback");this.$6Ya=n;this.$1pI=t;this.$6Zl=i;this.$5LI=r};_e.$lu.prototype={$6Ya:null,$1pI:null,$6Zl:null,$5LI:null,$7Oc:function(n){var t=this,i=this;n.$7OJ(this.$6Ya,this.$1pI,function(n){t.$6Zl(n)},function(n){i.$5LI(n)})}};_e.$55=function(n,t,i,r){this.$$d_$5CA=Function.createDelegate(this,this.$5CA);this.executeSql=this.$Gl;this.$10H=n;this.$2Qb=t;this.$4Ks=$710(this,i);this.$4JZ=$70z(this,r);this.$7d=0;this.$171=[];$711(this,r)};function $70v(n){_js.Trace.logInfo(_e.$55.$A,"Committing transaction");$3Xm(n,1);n.$7d=2;var i=this,r=this;var t=new _e.$lu("COMMIT TRANSACTION",[],function(){n.$5CA()},function(t){_js.Trace.logError(_e.$55.$A,"Commit error: {0}",t.message);$3Xn(n,t)});Array.enqueue(n.$171,t);$2Cr(n)}function $3Xn(n,t){$4pO(n);n.$4JZ&&n.$4JZ(t)}function $4pO(n){n.$10H=null;n.$4JN&&n.$4JN()}function $713(n,t){var i=new _a.$yB(0,"Exception occurred on a transaction callback. "+t.message);$4pP(n,i)}function $4pP(n,t){_js.Trace.logInfo(_e.$55.$A,"Rolling back transaction");$3Xm(n,1);n.$7d=2;Array.clear(n.$171);var r=this,u=this;var i=new _e.$lu("ROLLBACK TRANSACTION",[],function(){$3Xn(n,t)},function(i){_js.Trace.logWarning(_e.$55.$A,"Rollback error: {0}",i.message);$3Xn(n,t)});Array.enqueue(n.$171,i);$2Cr(n)}function $70z(n,t){if(t){var i=this;return function(n){try{t(n)}catch(i){_js.Trace.logException(_e.$55.$A,i,"Exception during transaction error callback.")}}}else return null}function $710(n,t){if(t){var i=this;return function(){try{t()}catch(n){_js.Trace.logException(_e.$55.$A,n,"Exception during transaction success callback.")}}}else return null}function $70y(n,t){var i=this;return function(i){n.$7d!==2&&t&&$712(n,t,i)}}function $70x(n,t){var i=this;return function(i){n.$7d!==2&&$4pP(n,i);t&&t(n,i)}}function $712(n,t,i){try{t(n,new _e.$1D1(i))}catch(r){_js.Trace.logException(_e.$55.$A,r,"Exception during transaction callback.");$713(n,r)}}function $70w(n){n.$171.length||$70v(n)}function $711(n,t){var r=this,u=this;var i=new _e.$lu("BEGIN IMMEDIATE TRANSACTION",[],function(){},function(n){_js.Trace.logError(_e.$55.$A,"BEGIN error: {0}",n.message);t&&t(n)});Array.enqueue(n.$171,i)}function $2Cr(n){if(!n.$409&&n.$171.length>0){for(var t=n.$10H.$7bC();n.$171.length>0&&t.get_$5LS()<4194304;){var i=Array.dequeue(n.$171);i.$7Oc(t)}n.$409=!0;var r=this;t.$n(function(){n.$409=!1;n.$7d!==2&&$70w(n);$2Cr(n)})}}function $3Xm(n,t){if(n.$7d!==t)throw Error.invalidOperation(String.format("transaction state expected {0}.  Actual {1}.",t,n.$7d));}_e.$55.prototype={$2Qb:null,$4Ks:null,$4JZ:null,$10H:null,$4JN:null,$7d:0,$171:null,$409:!1,$5Lu:!1,$42B:!1,$Gl:function(n,t,i,r){this.$5Lu=!0;if(this.$7d===2)throw Error.invalidOperation("ExecuteSql cannot be invoked on a completed transaction.");var f=new _e.$lu(n,t,$70y(this,i),$70x(this,r));Array.enqueue(this.$171,f);if(this.$7d&&!this.$42B){this.$42B=!0;var u=this;this.$2Qb.$1w(_a.$0.$2dd,"ExecuteSql",function(){u.$42B=!1;$2Cr(u)},0)}},$9ra:function(n){$3Xm(this,0);this.$4JN=n;if(this.$5Lu){_js.Trace.logInfo(_e.$55.$A,"Starting transaction.");this.$7d=1;$2Cr(this)}else{this.$7d=2;this.$2Qb.$1w(_a.$0.$2dd,"ExecuteSql",this.$$d_$5CA,0)}},$5CA:function(){$4pO(this);this.$4Ks&&this.$4Ks()}};_e.$1D6=function(n,t){this.openDatabase=this.$9Rk;this.$10H=n;this.$6gm=t};_e.$1D6.prototype={$10H:null,$6gm:null,$9Rk:function(n,t,i,r,u){return new _e.$fz(this.$10H,this.$6gm)}};_e.$AI=function(n,t,i){_e.$AI.initializeBase(this,[n,t,i,i.Body.ConversationActions.length])};function $6yF(n,t,i,r){var u=_e.$E9.$13B(t,n.$Qk.ConversationId);var f=this,e=this;n.$BT(function(t){n.$BH=t;n.get_$A8().get_$JM().$Fy(n.$BH,u,function(t){$4oR(n,t,u)},null)},function(){i()},_e.$1f.$Zb(r))}function $6yG(n,t,i){n.$5bN=!0;var r=this,u=this;n.$BT(function(t){n.$BH=t;_e.$6n.$3sr(t,n.get_$A8().get_$JM(),n.$Qk.ConversationId,function(t){for(var r=t,f=r.length,i=0;i<f;++i){var u=r[i];var e=_e.$E9.$13B(u.get_$20().FolderId,n.$Qk.ConversationId);$4oR(n,u,e)}})},function(){t()},_e.$1f.$Zb(i))}function $4oR(n,t,i){if(t){var r=t.get_$20();var u=r.FolderId;var f=this;n.get_$A8().get_$2x().$Fy(n.$BH,_e.$1h.$5f(u.Id),function(u){$6yI(n,u,r);$6yH(n,i,t,r);$6yK(n,r)},null)}}function $6yI(n,t,i){if(t){var f=t.get_$20();var r=f;switch(n.$Qk.Action){case"Delete":case"AlwaysDelete":case"Move":i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);r.TotalCount-=i.MessageCount;break;case"SetReadState":if(n.$Qk.IsRead)i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);else{var u=i.MessageCount;i.UnreadCount>0&&(u=i.MessageCount-i.UnreadCount);r.UnreadCount+=u}break;default:_js.Trace.logInfo(_e.$AI.$A,"{0} not implemented in client store.",n.$Qk.Action);break}t.$E7(n.$BH,null)}}function $6yH(n,t,i,r){switch(n.$Qk.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$A8().get_$JM().$Ht(n.$BH,t);break;case"SetReadState":r.UnreadCount=n.$Qk.IsRead?0:r.MessageCount;n.$5bN&&(r.GlobalUnreadCount=n.$Qk.IsRead?0:r.GlobalMessageCount);n.get_$A8().get_$JM().$tl(n.$BH,i,0,null);break;case"Flag":r.FlagStatus=n.$Qk.Flag.FlagStatus;n.get_$A8().get_$JM().$tl(n.$BH,i,0,null);break;case"SetClutterState":r.HasClutter=n.$Qk.IsClutter;n.get_$A8().get_$JM().$tl(n.$BH,i,0,null);break;default:_js.Trace.logInfo(_e.$AI.$A,"UpdateConversation: {0} not implemented in client store.",n.$Qk.Action);break}}function $6yK(n,t){var i=t.ItemIds;if(i)for(var u=i.length,r=0;r<u;r++){var f=i[r];$6yJ(n,f)}}function $6yJ(n,t){if(t&&t.Id){var i=_e.$1h.$5f(t.Id);switch(n.$Qk.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$A8().get_$52().$Ht(n.$BH,i);break;case"SetReadState":var r=this;$3XV(n,i,function(t,i){i.get_$20().IsRead=n.$Qk.IsRead});break;case"Flag":var u=this;$3XV(n,i,function(t,i){i.get_$20().Flag=n.$Qk.Flag});break;case"SetClutterState":var f=this;$3XV(n,i,function(t,i){i.get_$20().IsClutter=n.$Qk.IsClutter});break;default:_js.Trace.logInfo(_e.$AI.$A,"UpdateMessages: {0} not implemented in client store.",n.$Qk.Action);break}}}function $3XV(n,t,i){var r=this;n.get_$A8().get_$52().$Fy(n.$BH,t,function(t){if(t){i(n.$Qk,t);t.$E7(n.$BH,null)}},null)}_e.$AI.prototype={$BH:null,$Qk:null,$5bN:!1,get_$RI:function(){return"ApplyConversationAction"},$7VR:function(n,t,i){this.$n(n,t,i)},$7mn:function(n,t,i,r){this.$Qk=this.get_$1Ss().Body.ConversationActions[n];if(this.get_$A3u()&&this.get_$A3u().isActionGlobal)$6yG(this,t,i);else{var u=null;if(this.$Qk.ContextFolderId)u=this.$Qk.ContextFolderId.BaseFolderId;else if(this.get_$A3u()&&this.get_$A3u().folderIdForInstanceKeysToRemoveFromPendingOperations)u=new _g.$3S(this.get_$A3u().folderIdForInstanceKeysToRemoveFromPendingOperations);else{_js.Trace.logInfo(_a.$0.$LV,"This action {0}:{1} does not contain a valid folder id. Completing the service command without performing any real action.",this.get_$RI(),this.$Qk.Action);t();return}$6yF(this,u,t,i)}}};_e.$Zh=function(n,t,i){_e.$Zh.$$(this.$$gta["_e.$Zh"].TRequest,this.$$gta["_e.$Zh"].TActionContext).initializeBase(this,[n,t]);_a.$4.$l(i,"request");_a.$4.$l(i.Header,"request.Header");_a.$4.$l(i.Header.TimeZoneContext,"request.Header.TimeZoneContext");_a.$4.$l(i.Header.TimeZoneContext.TimeZoneDefinition,"request.Header.TimeZoneContext.TimeZoneDefinition");this.$DH=i};_e.$Zh.$$=function(n,t){var i="$Zh"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$Zh"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$Zh.apply(this,r)};u.registerClass("_e."+i,_e.$61.$$(t));var f=_e.$Zh.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$Zh.prototype={$DH:null,get_timeZone:function(){return this.$DH.Header.TimeZoneContext.TimeZoneDefinition.Id},get_$1Ss:function(){return this.$DH}};_e.$nH=function(n,t,i,r,u){_e.$nH.$$(this.$$gta["_e.$nH"].TRequest,this.$$gta["_e.$nH"].TActionContext).initializeBase(this,[n,t,i,r]);this.$1p=u};_e.$nH.$$=function(n,t){var i="$nH"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$nH"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$nH.apply(this,r)};u.registerClass("_e."+i,_e.$e9.$$(n,t));var f=_e.$nH.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$nH.prototype={$2vB_3:!1,$4LH:null,$1p:null,get_$nv:function(){this.$4LH||(this.$4LH=this.$7xo());return this.$4LH},$A6A:function(n,t,i,r,u){var e=null;_js.Trace.logInfo(this.$1p,"Opening transaction to move message to Outbox. {0}",this.$6bu);var f=this,s=this,o=this;this.$BT(function(i){if(n){_js.Trace.logInfo(f.$1p,"Getting message to move to Outbox. {0}",f.$6bu);f.get_$A8().get_$52().$Fy(i,_e.$1h.$5f(n.Id),function(n){_js.Trace.logInfo(f.$1p,"Calling getMessageToSaveCallback. {0}",f.$6bu);e=t(n,i);_js.Trace.logInfo(f.$1p,"Checking for existing Outbox item before save. {0}",f.$6bu);f.$9fD(e,n,i);_js.Trace.logInfo(f.$1p,"Deleting message from Drafts. {0}",f.$6bu);f.$7hQ(n,i);f.$5Hq(e,i)},null)}else{_js.Trace.logInfo(f.$1p,"Calling getMessageToSaveCallback. {0}",f.$6bu);e=t(null,i);_js.Trace.logInfo(f.$1p,"Saving message to Outbox. {0}",f.$6bu);f.$6QL(e,null,!0,i);f.$5Hq(e,i)}},function(){_js.Trace.logInfo(s.$1p,"Successfully moved message to Outbox. {0}",s.$6bu);s.$6Os(e);r()},function(n){_js.Trace.logInfo(o.$1p,"Reporting store error. {0}",o.$6bu);o.$6Os(e);o.$A3w(i,new _e.$1f(n),u)})},$A6B:function(n,t,i,r,u){_js.Trace.logInfo(this.$1p,"Opening transaction to move Outbox item to Drafts. {0}",this.$6bu);var o=this,f=this,e=this;this.$BT(function(i){o.$87I(i,n,t)},function(){if(f.$2vB_3){_js.Trace.logInfo(f.$1p,"Generating notifications to refresh inbox count. {0}",f.$6bu);_e.$2l.$2vA(f.get_$nv().$1bS.Id,null,"Reload","serviceCommand",_e.$2l.$x0,_e.$2l.$x0,!0)}_js.Trace.logInfo(f.$1p,"Successfully moved message from outbox to drafts. {0}",f.$6bu);r()},function(n){_js.Trace.logInfo(e.$1p,"Reporting store error {0}. {1}",n.$3v,e.$6bu);e.$A3w(i,new _e.$1f(n),u)})},$A6C:function(n){var u=10;var e="; ";var f;var t="";f=n?n.length<=u?n.length:u:0;for(var i=0;i<=f-1;i++){var r=n[i].Name;if(r&&r.length>0){var o=t.length?e:"";t+=o+r}}return t},$87I:function(n,t,i){_js.Trace.logInfo(this.$1p,"Getting OutboxItem for move back to Drafts. {0}",this.$6bu);var r=this;this.get_$A8().get_$gd().$Fy(n,_e.$1h.$5f(this.get_$nv().$Oq.Id),function(u){var e=null;var o=null;var s=null;if(u){e=u.get_$20().NormalizedBody;o=u.get_$20().UniqueBody;s=u.get_$20().Preview;_js.Trace.logInfo(r.$1p,"Deleting OutboxItem. {0}",r.$6bu);r.get_$52().$1sG(n,null,"HardDelete",u,null,r.get_$46A(),!0)}else _js.Trace.logWarning(_e.$1n.$A,"Outbox item with id {0} was not found in the client store. {1}",r.get_$nv().$Oq.Id,r.$6bu);_js.Trace.logInfo(r.$1p,"Calling getMessageToSaveCallback. {0}",r.$6bu);var f=t(n);f.get_$20().NormalizedBody=e;f.get_$20().UniqueBody=o;f.get_$20().Preview=s;if(i){_js.Trace.logInfo(r.$1p,"Saving item to drafts. {0}",r.$6bu);r.$3Lo(f,!0,n)}else{_js.Trace.logInfo(r.$1p,"Checking for existing draft before save. {0}",r.$6bu);r.$9fE(f,n)}},null)},$6QN:function(n,t,i){this.$9kU(n,t);n.$E7(i,null)},$9kU:function(n,t){n.$85W(this.$7xk(),t,this.$7x7(),"NoError");var i=n.get_$20();i.IsRead=!0},$6Os:function(n){if(n){n.$9ag();_a.$1V.$A4v(_g.$9n,n.get_$20()).IsRead=undefined}},$9fD:function(n,t,i){var r=this;this.get_$A8().get_$gd().$Fy(i,_e.$1h.$5f(n.get_$20().ItemId.Id),function(u){var f=!1;u?_js.Trace.logWarning(r.$1p,"Message from Drafts is already in the Outbox. Folder count won't be incremented since message will be replaced. {0}",r.$6bu):f=!0;r.$6QL(n,t,f,i)},null)},$6QL:function(n,t,i,r){_js.Trace.logInfo(this.$1p,"Moving to outbox: Id="+(n.get_$1y()?n.get_$1y().toString():"null")+"; ItemId="+(n.get_$20()?JsonParser.serialize(n.get_$20().ItemId):"null")+"; Subject="+(n.get_$20()?n.get_$20().Subject:"null"));if(t&&t.get_$20().ConversationId){var f=t.get_$20();_js.Trace.logInfo(this.$1p,"Removing item part from conversation for conversation id={0}. {1}",f.ConversationId.Id,this.$6bu);var u=this;this.get_$JM().$4QS(r,f.ConversationId,f.ParentFolderId,f,this.get_$46A(),function(t){_js.Trace.logInfo(u.$1p,"Removed item part from conversation. ParentConversationNodeId={0}. {1}",t||"null",u.$6bu);_js.Trace.logInfo(u.$1p,"Saving item to Outbox. {0}",u.$6bu);u.$6QN(n,t,r)})}else{_js.Trace.logInfo(this.$1p,"Saving item to Outbox. {0}",this.$6bu);this.$6QN(n,null,r)}if(i){_js.Trace.logInfo(this.$1p,"Incrementing Outbox folder count. {0}",this.$6bu);this.get_$A8().get_$2x().$2NT(r,n.get_$20().ParentFolderId,1,0)}},$7hQ:function(n,t){if(n){_js.Trace.logInfo(this.$1p,"Draft message found - deleting from Drafts. {0}",this.$6bu);this.get_$52().$1sG(t,this.get_$JM(),"HardDelete",n,null,this.get_$46A(),!0)}else _js.Trace.logInfo(this.$1p,"Draft message not found. {0}",this.$6bu)},$5Hq:function(n,t){if(n&&n.get_$20()&&_e.$17.$5Zd(n.get_$20().__type)){var i=n.get_$20();if(i.ReferenceItemId&&i.ReferenceItemId.__type===_g.$1q._dataContractName){_js.Trace.logInfo(this.$1p,"Deleting approval request message with id {0}. {1}",i.ReferenceItemId.Id,this.$6bu);this.get_$52().$3nE(t,this.get_$JM(),"HardDelete",i.ReferenceItemId,null,this.get_$46A())}}},$9fE:function(n,t){var i=this;this.get_$A8().get_$52().$Fy(t,_e.$1h.$5f(n.get_$20().ItemId.Id),function(r){if(r)if(r.get_$20().ConversationId){_js.Trace.logInfo(i.$1p,"Draft message with id {0} was found in the client store. Removing from conversation {1}",n.get_$20().ItemId.Id,i.$6bu);var u=r.get_$20();i.get_$JM().$4QS(t,u.ConversationId,u.ParentFolderId,u,i.get_$46A(),function(r){_js.Trace.logInfo(i.$1p,"RemoveItemPartFromConversation success callback. {0}",i.$6bu);i.$3Lo(n,!1,t)})}else{_js.Trace.logInfo(i.$1p,"Draft message with id {0} was found in the client store. It does not have a ConversationId. {1}",n.get_$20().ItemId.Id,i.$6bu);i.$3Lo(n,!1,t)}else{_js.Trace.logInfo(i.$1p,"Draft message with id {0} was not found in the client store. {1}",n.get_$20().ItemId.Id,i.$6bu);i.$3Lo(n,!0,t)}},null)},$3Lo:function(n,t,i){_js.Trace.logInfo(this.$1p,"Saving to Drafts via update: Id={0}; ItemId={1}; Subject={2}. {3}",n.get_$1y()?n.get_$1y().toString():"null",n.get_$20()?JsonParser.serialize(n.get_$20().ItemId):"null",n.get_$20()?n.get_$20().Subject:"null",this.$6bu);n.$E7(i,null);if(t){_js.Trace.logInfo(this.$1p,"Increment drafts folder count after message is moved to drafts. {0}",this.$6bu);this.get_$A8().get_$2x().$2NT(i,n.get_$20().ParentFolderId,1,0)}if(!!(!!this.get_$nv().$Cr&!!this.get_$nv().$Yd)){_js.Trace.logInfo(this.$1p,"Adding item to conversation. {0}",this.$6bu);this.$7No(i,n.get_$20())}},$7No:function(n,t){if(!this.get_$nv().$Yd){_js.Trace.logInfo(this.$1p,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var i=this;this.get_$JM().$53r(n,this.get_$nv().$Cr,t,this.get_$nv().$Yd,this.get_$nv().$33m,this.get_$46A(),function(n){if(n){_js.Trace.logInfo(i.$1p,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$nv().$Cr.Id,i.get_$nv().$Yd);i.$2vB_3=!0}else _js.Trace.logInfo(i.$1p,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$nv().$Cr.Id,i.get_$nv().$Yd)})}};_e.$Op=function(n,t,i){_e.$Op.initializeBase(this,[n,t,i,i.Body.Attachments.length]);this.get_$A3u().parentItemId=this.get_$1Ss().Body.ParentItemId;this.get_$A3u().attachmentIds=new Array(this.get_$A5t());this.$E6=new _g.$ZZ;this.$E6.ResponseCode="NoError";this.$E6.ResponseClass="Success";this.$E6.Attachments=new Array(this.get_$A5t());this.$30=new _g.$T3;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=[this.$E6]};_e.$Op.$4cf=function(n,t){var i=n;$6(i.Attachments)&&(i.Attachments=[]);i.HasAttachments=!0;Array.add(i.Attachments,t)};_e.$Op.prototype={$30:null,$E6:null,get_$RI:function(){return"CreateAttachment"},$7VR:function(n,t,i){this.$n(n,t,i)},$7mn:function(n,t,i,r){if(this.get_$A3u().clientStoreItem===2){var u=this.get_$1Ss().Body.Attachments[n];var f=this.get_$1Ss().Body.ParentItemId;var s=new _bc.$Bd;var e=s.get_$3i();this.get_$A3u().attachmentIds[n]=e;u.AttachmentId=new _g.$Ae(e.Id);this.$E6.Attachments[n]=u;var o=this,h=this,c=this;this.$BT(function(n){o.get_$A8().get_$52().$4cf(n,o.get_$A8().get_$5a().$ii(f.Id),u)},function(){_js.Trace.logInfo(_e.$Op.$A,"Successfully updated message with server id {0} in local store.",f.Id);u.AttachmentId.RootItemId=f.Id;u.AttachmentId.RootItemChangeKey=f.ChangeKey;t()},function(n){_e.$1f.$D6(n,i)})}else{_js.Trace.logWarning(_e.$Op.$A,"ClientStoreItem type {0} is not supported.",this.get_$A3u().clientStoreItem);t();return}}};_e.$17=function(n,t,i){this.$2aV=null;this.$Fq=0;_e.$17.initializeBase(this,[n,t,i,i.Body.Items.length,_e.$17.$A]);this.get_$A3u().itemIds=new Array(i.Body.Items.length);this.get_$A3u().uIds=new Array(i.Body.Items.length);this.get_$A3u().createdCalendarItemIds=new Array(i.Body.Items.length);this.$9G=new Array(this.get_$A5t());this.$30=new _g.$T5;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};_e.$17.$4Uq=function(n,t,i){var r=null;$6(i)?t&&t.BodyType==="Text"&&!$6(t.Value)&&(r=t.Value):r=i;if(!$6(r)){var f=_a.$1b.$1Af(r,!0);var u=new _g.$6R("HTML",f);n.NormalizedBody=u;n.UniqueBody=u;n.Preview=r}};_e.$17.$1yo=function(n){return n===_g.$IS._dataContractName||n===_g.$HK._dataContractName||n===_g.$Gr._dataContractName||n===_g.$Hh._dataContractName};_e.$17.$5Zd=function(n){return n===_g.$LM._dataContractName||n===_g.$Pq._dataContractName};_e.$17.$8BR=function(n){return n===_g.$Ml._dataContractName||n===_g.$NA._dataContractName||n===_g.$OQ._dataContractName};_e.$17.$1an=function(n,t,i,r){t.val=n.__type===_g.$Ml._dataContractName;i.val=n.__type===_g.$OQ._dataContractName;r.val=n.__type===_g.$NA._dataContractName};function $6zL(n,t,i,r,u){_js.Trace.logInfo(_e.$17.$A,"ExecuteMessageItemStep");if(n.get_$A3u()&&n.get_$A3u().explicitLogonUser){_js.Trace.logInfo(_e.$17.$A,"MessageRequest - operations on this mailbox is not supported in offline: {0}",n.get_$A3u().explicitLogonUser);n.$80=!0;n.$Fq=17;r();return}_a.$4.$J(n.get_$A3u().parentFolderId,"ParentFolderId");$6zS(n,t);n.$A5u(t.ItemId);n.get_$1Ss().Body.MessageDisposition==="SaveOnly"&&(n.$9G[i].Items[0].ItemId=t.ItemId);var e=!1;var f=null;if(_e.$17.$1yo(t.__type)){e=!0;f=t}if(n.get_$1Ss().Body.MessageDisposition==="SendAndSaveCopy"){var o=null;var s=null;if(e){var h=this;o=function(t,r){n.get_$A3u().itemIds[i]=f.ItemId;t&&(f.ConversationId=t.get_$20().ConversationId);return n.get_$A8().get_$gd().$qa(f)};s=f.UpdateResponseItemId}else{var c=this;o=function(r,u){var f=n.get_$A8().get_$gd().$qa(t);n.get_$A3u().itemIds[i]=t.ItemId;return f}}_js.Trace.logInfo(_e.$17.$A,"Moving item to Outbox. {0}",n.$6bu);var l=this,a=this;n.$A6A(s,o,n.$9G[i],function(){$1JD(n,t);r()},function(i){$1JD(n,t);u(i)})}else if(n.get_$A3u().outboxItemId){_js.Trace.logInfo(_e.$17.$A,"Moving a message from Outbox back to Drafts. {0}",n.$6bu);var v=this,y=this,p=this;n.$A6B(function(r){var u=n.get_$A8().get_$52().$qa(t);n.get_$A3u().itemIds[i]=t.ItemId;return u},!e,n.$9G[i],function(){$1JD(n,t);r()},function(i){$1JD(n,t);u(i)})}else if(e){_js.Trace.logInfo(_e.$17.$A,"Creating a SmartResponse for ReferenceItemId={0}. {1}",JsonParser.serialize(f.ReferenceItemId),n.$6bu);if(f.UpdateResponseItemId)if(n.get_$1Ss().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$17.$A,"Updating an existing SmartResponse. {0}",n.$6bu);$6zT(n,f,i,r,u)}else throw Error.invalidOperation("Unknown SmartResponse operation.");else{_js.Trace.logInfo(_e.$17.$A,"Creating a SmartResponse in Drafts. {0}",n.$6bu);$4oo(n,t,i,r,u)}}else{_js.Trace.logInfo(_e.$17.$A,"Creating a message in the Drafts or Outbox. {0}",n.$6bu);$4oo(n,t,i,r,u)}}function $4on(n,t,i){if(!$6(n.get_$A3u().clientStoreBodyValue)){n.$3LB=t.val.Value;n.$2aV=t.val.BodyType;t.val=new _g.$6R(i,n.get_$A3u().clientStoreBodyValue);n.get_$A3u().clientStoreBodyValue=null}}function $6zT(n,t,i,r,u){n.get_$A3u().itemIds[i]=t.UpdateResponseItemId;_js.Trace.logInfo(_e.$17.$A,"Opening transaction to update a SmartResponse. {0}",n.$6bu);var f=this,e=this,o=this;n.$A3x(new _a.$6j("CreateItem.UpdateSmartResponse",!1),function(i){_js.Trace.logInfo(_e.$17.$A,"Updating SmartResponse. {0}",n.$6bu);n.get_$A8().get_$52().$1Ih(i,_e.$1h.$5f(t.ItemId.Id),function(i){if($6(i)){_js.Trace.logWarning(_e.$17.$A,"Message with id {0} not found in local store",t.ItemId.Id);return}_js.Trace.logInfo(_e.$17.$A,"Retrieved SmartResponse from the local store for update. {0}",n.$6bu);var r=i;r.__type=t.__type;r.ReferenceItemId=t.ReferenceItemId;r.NewBodyContent=t.NewBodyContent;r.BccRecipients=t.BccRecipients;r.CcRecipients=t.CcRecipients;r.ToRecipients=t.ToRecipients;r.From=t.From;r.Subject=t.Subject;r.Importance=t.Importance;r.NormalizedBody=t.NormalizedBody;r.UniqueBody=r.NormalizedBody;r.Preview=t.Preview;r.RightsManagementLicenseData=t.RightsManagementLicenseData;if(t.ExtendedProperty)for(var e=0;e<t.ExtendedProperty.length;e++){var f=t.ExtendedProperty[e];var u=f.ExtendedFieldURI;u.DistinguishedPropertySetId==="Common"?u.PropertyId===34229?_e.$3w.$Rw(r,u,f.Value):u.PropertyId===34232?_e.$3w.$Rw(r,u,f.Value):u.PropertyId===34230?_e.$3w.$Rw(r,u,f.Value):u.PropertyId===34231&&_e.$3w.$Rw(r,u,f.Value):u.DistinguishedPropertySetId==="PublicStrings"&&u.PropertyName.startsWith("cecp-")&&_e.$3w.$Rw(r,u,f.Value)}_js.Trace.logInfo(_e.$17.$A,"Smart response with updates going to client store via create: ReferenceItemId={0}; Subject={1}. {2}",JsonParser.serialize(r.ReferenceItemId),r.Subject,n.$6bu)})},function(){_js.Trace.logInfo(_e.$17.$A,"Successfully updated message in local store. {0}",n.$6bu);$1JD(n,t);r()},function(i){_js.Trace.logInfo(_e.$17.$A,"Reporting store error. {0}",n.$6bu);$1JD(n,t);_e.$1f.$D6(i,u)})}function $4oo(n,t,i,r,u){var f=n.get_$A8().get_$52().$qa(t);n.get_$A3u().itemIds[i]=t.ItemId;var e=null;_js.Trace.logInfo(_e.$17.$A,"Opening transaction to save message item via create. Id={0}; Subject={1}; {2}",f.get_$1y()?f.get_$1y().toString():"null",t.Subject,n.$6bu);var o=this,s=this,h=this;n.$BT(function(i){_js.Trace.logInfo(_e.$17.$A,"Saving item. {0}",n.$6bu);f.$E7(i,function(n){e=n});_js.Trace.logInfo(_e.$17.$A,"Incrementing folder count. {0}",n.$6bu);n.get_$A8().get_$2x().$2NT(i,t.ParentFolderId,1,0);if(_e.$17.$1yo(t.__type)&&n.get_$1Ss().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$17.$A,"Adding item (SmartResponse) to conversation. {0}",n.$6bu);$6zI(n,i,t)}},function(){_js.Trace.logInfo(_e.$17.$A,"Successfully created message in local store id={0}. {1}",e,n.$6bu);$1JD(n,t);if(n.$2vB){_js.Trace.logInfo(_e.$17.$A,"Generating notifications to refresh inbox count. {0}",n.$6bu);_e.$2l.$2vA(n.get_$A3u().inboxFolderId.Id,null,"Reload","serviceCommand",_e.$2l.$x0,_e.$2l.$x0,!0)}_js.Trace.logInfo(_e.$17.$A,"Calling succeededCallback. {0}",n.$6bu);r()},function(r){_js.Trace.logInfo(_e.$17.$A,"Reporting store error {0}. {1}",r.$3v,n.$6bu);$1JD(n,t);n.$A3w(n.$9G[i],new _e.$1f(r),u)})}function $6zI(n,t,i){if(!n.get_$A3u().parentConversationNodeId){_js.Trace.logInfo(_e.$17.$A,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var r=this;n.get_$JM().$53r(t,n.get_$A3u().conversationId,i,n.get_$A3u().parentConversationNodeId,n.get_$A3u().itemPartsOrderDescending,n.get_$46A(),function(t){if(t){_js.Trace.logInfo(_e.$17.$A,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$A3u().conversationId.Id,n.get_$A3u().parentConversationNodeId);n.$2vB=!0}else _js.Trace.logInfo(_e.$17.$A,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$A3u().conversationId.Id,n.get_$A3u().parentConversationNodeId)})}function $6zJ(n,t,i,r,u){var f=t;if($6zP(n,f)){n.$80=!0;n.$Fq=1;r()}else if(f.Recurrence){n.$80=!0;n.$Fq=2;r()}else if($6zO(n,f)){n.$80=!0;n.$Fq=10;r()}else{var e=this,o=this;n.get_$A3t().$8Am(f.Start,f.End,function(){var t=_0365f.$2t.$3p(f,!0,!0);t.ParentFolderId||(t.ParentFolderId=n.get_$A3u().calendarFolderId);$6zR(n,t,i,r,u)},function(){n.$80=!0;n.$Fq=11;r()})}}function $6zO(n,t){return!!t.ParentFolderId&&t.ParentFolderId.Id!==n.get_$A3u().calendarFolderId.Id||!!n.get_$1Ss().Body.SavedItemFolderId&&n.get_$1Ss().Body.SavedItemFolderId.BaseFolderId.__type===_g.$3S._dataContractName&&n.get_$1Ss().Body.SavedItemFolderId.BaseFolderId.Id!==n.get_$A3u().calendarFolderId.Id}function $6zS(n,t){var r=_e.$17.$1yo(t.__type);var i=r?t:null;var u=new _bc.$Bd;t.InstanceKey=u.get_$Ea();t.ItemId=r&&i.UpdateResponseItemId?i.UpdateResponseItemId:u.$5N;n.get_$1Ss().Body.MessageDisposition==="SendAndSaveCopy"&&(t.ItemId=_bc.OutboxItemContext.$5Da(t.ItemId,_e.$17.$A));t.DateTimeCreated=_a.$7.$EZ(_a.$7.get_$29());t.DateTimeReceived=t.DateTimeCreated;t.LastModifiedTime=_a.$7.$EZ(_a.$7.get_$29());t.ParentFolderId=n.get_$A3u().parentFolderId;var o=r?i.NewBodyContent:null;var s=n.get_$A3u().bodySubstring||"";_e.$17.$4Uq(t,o,s);if(r){var f;$4on(n,f={val:i.NewBodyContent},i.NewBodyContent.BodyType);i.NewBodyContent=f.val}else{var e;$4on(n,e={val:t.Body},"Text");t.Body=e.val}n.get_$1Ss().Body.MessageDisposition==="SaveOnly"&&(t.IsDraft=!0);t.RightsManagementLicenseData=n.get_$A3u().rightsManagementLicenseData;n.get_$A3u().conversationId&&(t.ConversationId=n.get_$A3u().conversationId);_e.$17.$5Zd(t.__type)&&(t.ItemClass=t.__type===_g.$LM._dataContractName?"IPM.Note.Microsoft.Approval.Reply.Approve":"IPM.Note.Microsoft.Approval.Reply.Reject");t.DisplayTo=n.$A6C(t.ToRecipients)}function $1JD(n,t){t.ItemId=undefined;t.InstanceKey=undefined;t.DateTimeCreated=undefined;t.DateTimeReceived=undefined;t.LastModifiedTime=undefined;t.ParentFolderId=undefined;t.NormalizedBody=undefined;t.UniqueBody=undefined;t.Preview=undefined;t.IsDraft=undefined;t.ConversationId=undefined;t.InternetMessageId=undefined;t.ItemClass=undefined;t.DisplayTo=undefined;n.$3LB&&(_e.$17.$1yo(t.__type)?t.NewBodyContent.Value=n.$3LB:t.Body.Value=n.$3LB);n.$2aV!==null&&(_e.$17.$1yo(t.__type)?t.NewBodyContent.BodyType=n.$2aV:t.Body.BodyType=n.$2aV);t.RightsManagementLicenseData=undefined}function $6zR(n,t,i,r,u){var e=new _bc.$Bd;var f=e.$5N;$4oj(n,t);t.ItemId=f;t.UID=e.get_$18c();t.IsMeeting=!1;t.HasAttachments=!1;t.ResponseType="Organizer";t.IsOrganizer=!0;t.ResponseObjects=new Array(1);t.ResponseObjects[0]=new _g.$HK;t.Organizer=new _g.$BY;t.Organizer.Mailbox=new _g.$1l;t.Organizer.Mailbox.EmailAddress=n.get_$A3u().userEmailAddress;t.Organizer.Mailbox.Name=n.get_$A3u().userDisplayName;t.Organizer.Mailbox.RoutingType="SMTP";t.Organizer.Mailbox.MailboxType="Mailbox";t.StartWallClock=t.Start;t.StartTimeZoneId=n.get_$1Ss().Header.TimeZoneContext.TimeZoneDefinition.Id;t.EndWallClock=t.End;t.EndTimeZoneId=n.get_$1Ss().Header.TimeZoneContext.TimeZoneDefinition.Id;_e.$AK.$4O8(t);var o=n.get_$A8().get_$1k().$qa(t);var s=this,h=this,c=this;n.$BT(function(i){o.$E7(i,function(r){_js.Trace.logInfo(_e.$17.$A,"Successfully created calendar item with id {0} to local store.",r.toString());if(t.ReminderIsSet){_js.Trace.logInfo(_e.$17.$A,"A reminder is set on calendar item with Id {0}. Creating a reminder.",f.Id);n.get_$A3t().$4Sc(i,t,f,function(n){_js.Trace.logInfo(_e.$17.$A,"Successfully created reminder for calendar item with id {0} to local store.",r.toString())})}})},function(){_js.Trace.logInfo(_e.$17.$A,"Successfully created calendar item and reminder with id {0} to local store.",f);n.$9G[i].Items[0].ItemId=f;n.get_$A3u().itemIds[i]=f;n.get_$A3u().uIds[i]=e.get_$18c();r()},function(t){n.$A3w(n.$9G[i],new _e.$1f(t),u)})}function $6zP(n,t){return!$6(t.RequiredAttendees)&&t.RequiredAttendees.length>0||!$6(t.OptionalAttendees)&&t.OptionalAttendees.length>0}function $6zK(n,t,i,r,u){if(!_e.$17.$8BR(t.__type)){_js.Trace.logWarning(_e.$17.$A,"MeetingRequest - Response type not support in offline: {0}",t.__type);n.$80=!0;n.$Fq=15;r();return}var f=t;var h,c,l;var a,v,y;_e.$17.$1an(f,a={val:h},v={val:c},y={val:l});h=a.val;c=v.val;l=y.val;if(f.ReferenceItemId.__type!==_g.$1q._dataContractName&&f.ReferenceItemId.__type!==_g.$7U._dataContractName){n.$80=!0;n.$Fq=14;r();return}var e=f.ReferenceItemId;var s=_a.$7.$EZ(_a.$7.get_$29());if(n.get_$A3u().isReferencedItemMeetingRequest){n.$9G[i].Items=new Array(3);var o=_e.$1h.$5f(e.Id);var p=this,w=this,b=this;n.$BT(function(t){n.get_$A8().get_$52().$Fy(t,o,function(r){if($6(r)||$6(r.get_$20())){_js.Trace.logWarning(_e.$17.$A,"MeetingRequest - Message with id {0} not found in local store",o);n.$80=!0;return}var u=r.get_$20();if(u.IsDelegated){_js.Trace.logInfo(_e.$17.$A,"MeetingRequest - Message with id {0} is delegated and will not be processed by offline service command",o);n.$80=!0;n.$Fq=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$17.$A,"MeetingRequest - Message with id {0} is out of date and should not be used to respond to a meeting request",o);return}u.ResponseType=$4ol(n,f);u.FreeBusyType=$4ok(n,f,u.IntendedFreeBusyStatus);u.AppointmentReplyTime=s;var e=new _g.$Kt;e.ItemId=u.ItemId;n.$9G[i].Items[2]=e;n.get_$52().$1sG(t,n.get_$JM(),"MoveToDeletedItems",r,n.get_$A3u().deletedItemsFolderId,n.get_$46A());$6zQ(n,t,i,r,f,s)},null)},function(){_js.Trace.logInfo(_e.$17.$A,"Successfully responded to message with id {0}.",o);r()},function(t){if(n.$80&&t.$VZ===5)u(new _e.$1f(t));else{_js.Trace.logError(_e.$17.$A,"MeetingRequest - Error while processing message with id:{0}. Error: {1}",o,t.$3v);n.$A3w(n.$9G[i],new _e.$1f(t),u)}})}else{n.$9G[i].Items=new Array(2);var k=this,d=this,g=this;n.$BT(function(t){e.__type===_g.$7U._dataContractName?n.get_$A3t().$5RO(t,e,function(r){_e.$Dh.$3fU(t,n.get_$A8().get_$lc(),r,function(u){if(!u||!u.get_$20()){_js.Trace.logWarning(_e.$17.$A,"MeetingRequest - Calendar master item with uid {0} could not be found in client store.",r);n.$80=!0;return}_js.Trace.logInfo(_e.$17.$A,"MeetingRequest - Calendar master item with uid {0} found in client store.",r);$4os(n,t,i,u,f,s);$6zN(n,f,u)})},function(){n.$80=!0}):$4om(n,t,_e.$1h.$5f(e.Id),i,f,s,null)},function(){e.__type===_g.$7U._dataContractName?_js.Trace.logInfo(_e.$17.$A,"Successfully responded to calendar master item with occurrence id {0}.",e.OccurrenceId):_js.Trace.logInfo(_e.$17.$A,"Successfully responded to calendar item with id {0}.",e.Id);r()},function(t){if(n.$80&&t.$VZ===5)u(new _e.$1f(t));else{e.__type===_g.$7U._dataContractName?_js.Trace.logError(_e.$17.$A,"MeetingRequest - Error while processing calendar master item with ocurrence id:{0}. Error: {1}",e.OccurrenceId,t.$3v):_js.Trace.logError(_e.$17.$A,"MeetingRequest - Error while processing calendar item with id:{0}. Error: {1}",e.Id,t.$3v);n.$A3w(n.$9G[i],new _e.$1f(t),u)}})}}function $6zQ(n,t,i,r,u,f){var e=r.get_$20();if($6(e.AssociatedCalendarItemId)||$6(e.AssociatedCalendarItemId.Id)){if(e.CalendarItemType!=="Single"){var o=String.format("MeetingRequest: No associated calendar item found in meeting request. Cannot create recurring meeting calendar item for the recurring meeting request with id {0}. The call should be forwarded to online proxy. Rolling back.",e.ItemId.Id);_js.Trace.logWarning(_e.$17.$A,o);n.$80=!0;n.$Fq=4;t.$2Do();return}$4oh(n,t,i,r,u,f,!1)}else{var s=_e.$1h.$5f(e.AssociatedCalendarItemId.Id);$4om(n,t,s,i,u,f,r)}}function $4om(n,t,i,r,u,f,e){if(n.get_$A3u().referencedCalendarItemType==="RecurringMaster"){var o=this;n.get_$A8().get_$lc().$Fy(t,i,function(e){if($6(e)||$6(e.get_$20()))if(n.get_$A3u().isReferencedItemMeetingRequest){var o=String.format("MeetingRequest: Recurring master with id {0} not found. Cannot create recurring meeting calendar item for a recurring meeting request. The call should be forwarded to online proxy. Rolling back.",i);_js.Trace.logWarning(_e.$17.$A,o);n.$80=!0;n.$Fq=4;t.$2Do();return}else{_js.Trace.logWarning(_e.$17.$A,"MeetingRequest: Recurring master with id {0} not found in local store.",i);n.$80=!0;return}$4os(n,t,r,e,u,f)},null)}else{var s=this;n.get_$A8().get_$1k().$Fy(t,i,function(o){if($6(o)||$6(o.get_$20())){if(n.get_$A3u().isReferencedItemMeetingRequest&&n.get_$A3u().referencedCalendarItemType==="Single"){_js.Trace.logWarning(_e.$17.$A,"MeetingRequest - Calendar with id {0} not found in local store, creating one while sync doesn't happen.",i);$4oh(n,t,r,e,u,f,!0)}else{_js.Trace.logWarning(_e.$17.$A,"MeetingRequest - Calendar with id {0} not found in local store",i);n.$80=!0}return}$4op(n,t,r,o,u,f)},null)}}function $4oj(n,t){var i=new _g.$Qg;i.CreateAssociated=!1;i.CreateContents=!1;i.CreateHierarchy=!1;i.Delete=!0;i.Modify=!0;i.Read=!0;i.ViewPrivateItems=!0;t.EffectiveRights=i;t.CalendarItemType="Single";t.IsCancelled=!1}function $4oh(n,t,i,r,u,f,e){var s=r.get_$20();var o=new _g.$6O;$4oj(n,o);var c=new _bc.$Bd;var h;h=e?s.AssociatedCalendarItemId:c.$5N;o.ParentFolderId=n.get_$A3u().calendarFolderId;o.ItemId=h;o.UID=c.get_$18c();o.ResponseType=s.ResponseType;o.Start=s.Start;o.End=s.End;o.ResponseObjects=s.ResponseObjects;o.IsResponseRequested=s.IsResponseRequested;o.ConversationId=s.ConversationId;o.Subject=s.Subject;o.IsMeeting=!0;o.Organizer=s.From;o.IsOrganizer=s.IsOrganizer;o.Location=s.Location;o.HasAttachments=s.HasAttachments;o.Body=s.UniqueBody;o.ReminderIsSet=!0;o.ReminderMinutesBeforeStart=5;o.StartWallClock=s.StartWallClock;o.StartTimeZoneId=s.StartTimeZoneId;o.EndWallClock=s.EndWallClock;o.EndTimeZoneId=s.EndTimeZoneId;_e.$AK.$4O8(o);var l=n.get_$A8().get_$1k().$qa(o);var a=this;l.$E7(t,function(a){_js.Trace.logInfo(_e.$17.$A,"Successfully created calendar item with id {0} to local store.",a.toString());n.get_$A3u().createdCalendarItemIds[i]=h;n.get_$A3u().uIds[i]=c.get_$18c();var v=new _g.$6O;v.ItemId=h;n.$9G[i].Items[0]=v;if(o.ReminderIsSet){_js.Trace.logInfo(_e.$17.$A,"A reminder is set on calendar item with Id {0}. Creating a reminder.",h.Id);n.get_$A3t().$4Sc(t,o,h,function(n){_js.Trace.logInfo(_e.$17.$A,"Successfully created reminder for calendar item with id {0} to local store.",a.toString())})}if(!e){_js.Trace.logInfo(_e.$17.$A,"Created calendar item without associated calendar item id. Updating meeting request with new value.");s.AssociatedCalendarItemId=o.ItemId;r.$E7(t,function(n){_js.Trace.logInfo(_e.$17.$A,"Successfully updated meeting request {0} with new Associated calendar item id {1}.",n,s.AssociatedCalendarItemId.Id)})}$4op(n,t,i,l,u,f)})}function $4os(n,t,i,r,u,f){var o,s,h;var c,l,a;_e.$17.$1an(u,c={val:o},l={val:s},a={val:h});o=c.val;s=l.val;h=a.val;var e=r.get_$20();var v=new _g.$6O;v.ItemId=e.ItemId;n.$9G[i].Items[0]=v;$4or(n,e,u,f);if(o||s){var y=this;_e.$5w.$7SN(t,n.get_$A8().get_$1k(),e.UID,function(i,r){var e=i.get_$20();(e.CalendarItemType==="Occurrence"||h)&&$4oq(n,t,i,u,f)});var p=this;r.$E7(t,function(n){_js.Trace.logInfo(_e.$17.$A,"Successfully updated calendar master item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$17.$A,"Response is declient, deleting occurrences/exceptions and reminders for master item with id {0}.",r.get_$1y());n.get_$A3t().$3n0(t,r.get_$1y(),r.get_$20());_js.Trace.logInfo(_e.$17.$A,"Response is decline, deleting calendar master item with id {0}.",r.get_$1y());n.get_$A8().get_$lc().$Ht(t,r.get_$1y())}$4oi(n,t,i,e,u,f)}function $4op(n,t,i,r,u,f){var e=r.get_$20();var o=new _g.$6O;o.ItemId=e.ItemId;n.$9G[i].Items[0]=o;$4oq(n,t,r,u,f);$4oi(n,t,i,e,u,f)}function $4oq(n,t,i,r,u){var f,e,o;var s,h,c;_e.$17.$1an(r,s={val:f},h={val:e},c={val:o});f=s.val;e=h.val;o=c.val;var l=i.get_$20();$4or(n,l,r,u);if(f||e){var a=this;i.$E7(t,function(n){_js.Trace.logInfo(_e.$17.$A,"Successfully updated calendar item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$17.$A,"Response is decline, deleting calendar item with id {0}.",i.get_$1y());n.get_$A8().get_$1k().$Ht(t,i.get_$1y());_js.Trace.logInfo(_e.$17.$A,"Response is decline, deleting reminder with id {0}.",i.get_$1y());n.get_$A8().get_$gn().$Ht(t,i.get_$1y())}}function $4or(n,t,i,r){n.get_$A3u().referencedCalendarItemType!=="RecurringMaster"&&i.ReferenceItemId.__type!==_g.$7U._dataContractName&&t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception");t.ResponseType=$4ol(n,i);t.FreeBusyType=$4ok(n,i,t.IntendedFreeBusyStatus);t.AppointmentReplyTime=r}function $4oi(n,t,i,r,u,f){var l=!1;var h,c,a;var v,y,p;_e.$17.$1an(u,v={val:h},y={val:c},p={val:a});h=v.val;c=y.val;a=p.val;var e=new _g.$Jw;var w=new _bc.$Bd;var b=w.$5N;_js.Trace.logInfo(_e.$17.$A,"Create meeting response called. Populating properties.");e.ItemId=b;e.InstanceKey=w.get_$Ea();e.DateTimeCreated=f;e.DateTimeReceived=f;e.LastModifiedTime=f;e.Start=r.Start;e.End=r.End;e.Location=r.Location;e.Sensitivity=r.Sensitivity;e.Importance=r.Importance;e.AssociatedCalendarItemId=r.ItemId;e.Body=r.Body;e.ToRecipients=[r.Organizer.Mailbox];var o=new _g.$BY;o.Mailbox=new _g.$1l;o.Mailbox.EmailAddress=n.get_$A3u().userEmailAddress;o.Mailbox.Name=n.get_$A3u().userDisplayName;o.Mailbox.RoutingType="SMTP";o.Mailbox.MailboxType="Mailbox";e.From=o;e.Sender=o;e.IsRead=!0;e.HasAttachments=!1;if(n.get_$1Ss().Body.MessageDisposition==="SaveOnly"){e.IsDraft=!0;e.ParentFolderId=n.get_$A3u().draftsFolderId}else{e.IsDraft=!1;e.ParentFolderId=n.get_$A3u().outboxFolderId;l=!0}e.ResponseType=r.ResponseType;var s;if(h){e.ItemClass="IPM.Schedule.Meeting.Resp.Pos";s=_u.Strings.l_AcceptForResponseMessageSubject_Text}else if(c){e.ItemClass="IPM.Schedule.Meeting.Resp.Tent";s=_u.Strings.l_TentativeForResponseMessageSubject_Text}else{e.ItemClass="IPM.Schedule.Meeting.Resp.Neg";s=_u.Strings.l_DeclineForResponseMessageSubject_Text}e.Subject=s+r.Subject;e.ResponseObjects=[new _g.$Hh,new _g.$Gr,new _g.$HK];var k;k=l?n.get_$A8().get_$gd().$qa(e):n.get_$A8().get_$52().$qa(e);_js.Trace.logInfo(_e.$17.$A,"Saving meeting response with id {0} into client store.",e.ItemId.Id);var d=this;k.$E7(t,function(r){_js.Trace.logInfo(_e.$17.$A,"Successfully saved meeting response with id {0} into client store.",e.ItemId.Id);var u=new _g.$Jw;u.ItemId=e.ItemId;n.$9G[i].Items[1]=u;n.get_$A3u().itemIds[i]=b;n.get_$A8().get_$2x().$2NT(t,e.ParentFolderId,1,0)})}function $4ol(n,t){var i=null;var r,u,f;var e,o,s;_e.$17.$1an(t,e={val:r},o={val:u},s={val:f});r=e.val;u=o.val;f=s.val;if(r)i="Accept";else if(u)i="Tentative";else if(f)i="Decline";else throw Error.argumentType("responseItem has invalid response type");return i}function $4ok(n,t,i){var r=null;$6(i)&&(i="NoData");var u,f,e;var o,s,h;_e.$17.$1an(t,o={val:u},s={val:f},h={val:e});u=o.val;f=s.val;e=h.val;if(f)r=i==="Free"?"Free":"Tentative";else if(u)r=i==="NoData"?"Busy":i;else if(e)r="Free";else throw Error.argumentType("responseItem has invalid response type");return r}function $6zN(n,t,i){var u=t.ReferenceItemId;_js.Trace.logInfo(_e.$17.$A,"MeetingRequest - Filling Conflict Info for master for occurrence with id {0}",u.OccurrenceId);var r=i.get_$20();t.AdditionalInfo||(t.AdditionalInfo=new _g.$Xc);t.AdditionalInfo.Organizer=r.Organizer;t.AdditionalInfo.Start=r.Start;t.AdditionalInfo.End=r.End;t.AdditionalInfo.Subject=r.Subject;t.AdditionalInfo.IsResponseRequested=r.IsResponseRequested;t.AdditionalInfo.ConversationId=r.ConversationId;t.AdditionalInfo.Recurrence=r.Recurrence;t.AdditionalInfo.Location=r.Location}function $6zM(n,t,i,r,u){if(!(t.__type===_g.$Pr._dataContractName)){_js.Trace.logWarning(_e.$17.$A,"Remove item wasn't supposed to receive an item type that's not a RemoveItemType : {0}.",Object.getType(t));throw Error.argumentType("item",Object.getType(t),Object.getType(new _g.$Pr),"Remove item wasn't supposed to receive an item type that's not a RemoveItemType.");}var o=t;var e=o.ReferenceItemId;var f=_e.$1h.$5f(e.Id);var s=this,h=this,c=this;n.$BT(function(t){n.get_$A8().get_$52().$Fy(t,f,function(r){if($6(r)||$6(r.get_$20())){_js.Trace.logWarning(_e.$17.$A,"RemoveItem - Message with id {0} not found in local store",f);n.$80=!0;return}_js.Trace.logInfo(_e.$17.$A,"RemoveItem - Cancellation message with id {0} found in client store.",f);var u=r.get_$20();if(u.IsDelegated){_js.Trace.logInfo(_e.$17.$A,"RemoveItem - Message with id {0} is delegated and will not be processed by offline service command",f);n.$80=!0;n.$Fq=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$17.$A,"RemoveItem - Message with id {0} is out of date and should not be used to respond to a meeting request",f);return}if($6(u.AssociatedCalendarItemId)){_js.Trace.logWarning(_e.$17.$A,"RemoveItem - Meeting cancelation message doesn't have associated calendar item and cannot be processed offline",f);n.$80=!0;return}n.get_$52().$1sG(t,n.get_$JM(),"MoveToDeletedItems",r,_g.$28.$Bi("deleteditems"),n.get_$46A());n.get_$A3u().referencedCalendarItemType==="RecurringMaster"?n.$A6S(_bc.$Kp,t,u.AssociatedCalendarItemId,n.get_$A8().get_$lc()):n.$A6S(_bc.$Lt,t,u.AssociatedCalendarItemId,n.get_$A8().get_$1k());n.$9G[i].Items=new Array(2);var e=new _g.$MC;e.ItemId=u.ItemId;n.$9G[i].Items[0]=e;var o=new _g.$6O;o.ItemId=u.AssociatedCalendarItemId;n.$9G[i].Items[1]=o},null)},function(){_js.Trace.logInfo(_e.$17.$A,"Successfully remove item from calendar referred by cancellation message with id {0}.",e.Id);r()},function(t){if(n.$80&&t.$VZ===5)u(new _e.$1f(t));else{_js.Trace.logError(_e.$17.$A,"RemoveItem - Error while processing message with id:{0}. Error: {1}",e.Id,t.$3v);n.$A3w(n.$9G[i],new _e.$1f(t),u)}})}_e.$17.prototype={$30:null,$9G:null,$3LB:null,$80:!1,$2vB:!1,get_$RI:function(){return"CreateItem"},$6Tz:function(n,t){_e.$HX.$6T8(this.get_$A8().get_$gd(),n,t,_e.$17.$A)},$7xo:function(){return _e.$YY.$7cj(this.get_$A3u())},$7x7:function(){return this.get_$1Ss().Body.ComplianceId},$7xk:function(){return 0},$7VR:function(n,t,i){if(this.get_$A3u().clientStoreItem){var r=this,u=this;this.$n(function(){if(r.$80){_js.Trace.logInfo(_e.$17.$A,"CreateItem: Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else{r.get_$A3u().clientStoreItem===4&&(r.get_$1Ss().Body.GenerateResponseMessageOnFailure=!0);n()}},function(n){if(u.$80){_js.Trace.logInfo(_e.$17.$A,"CreateItem: Rollback happened. Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else t(n)},i)}else{_js.Trace.logWarning(_e.$17.$A,"The item will not be created in the local store because ClientStoreItem.None was passed.");i(-1)}},$7mn:function(n,t,i,r){if(this.$80){t();return}var u=this.get_$1Ss().Body.Items[n];var f=new _g.$Xb;f.ResponseCode="NoError";f.ResponseClass="Success";f.Items=[new _g.$7k];this.$9G[n]=f;if(this.get_$A3u().clientStoreItem===2)$6zL(this,u,n,t,i);else if(this.get_$A3u().clientStoreItem===1)$6zJ(this,u,n,t,i);else if(this.get_$A3u().clientStoreItem===4)$6zK(this,u,n,t,i);else if(this.get_$A3u().clientStoreItem===5)$6zM(this,u,n,t,i);else{_js.Trace.logWarning(_e.$17.$A,"ClientStoreItem type {0} is not supported.",this.get_$A3u().clientStoreItem);t();return}},$A6S:function(n,t,i,r){var u=this;r.$Fy(t,_e.$1h.$5f(i.Id),function(r){if(!r||!r.get_$20()){_js.Trace.logWarning(_e.$17.$A,"RemoveItem - Associated calendar item (type: '{0}') with id {1} could no be found in client store. Rolling back transaction.",n.getName(),i.Id);u.$80=!0;u.$Fq=13;t.$2Do();return}_js.Trace.logInfo(_e.$17.$A,"RemoveItem - Associated calendar item (type: '{0}') with id {1} found in client store. Deleting it.",n.getName(),i.Id);u.get_$A3t().$3n0(t,r.get_$1y(),r.get_$20())},null)}};_e.$K=function(){};_e.$K.$55x=function(n,t){for(var r=[],k=n.AttributionsArray,sf=k.length,l=0;l<sf;++l){var d=k[l];d.IsWritable&&Array.add(r,d.Id)}if(!r.length){var hf=n.AttributionsArray.length;var o=new _g.$Mt(hf.toString(),new _g.$1q("TEMPID"),"Outlook");o.IsWritable=!0;o.IsQuickContact=!1;o.IsHidden=!1;o.FolderId=null;for(var a=new Array(n.AttributionsArray.length+1),h=0;h<n.AttributionsArray.length;++h)a[h]=n.AttributionsArray[h];a[n.AttributionsArray.length]=o;n.AttributionsArray=a;Array.add(r,o.Id)}for(var u=!1,g=!1,f=!1,s=!1,nt="",tt="",it="",rt=t,cf=rt.length,v=0;v<cf;++v){var i=rt[v];var ut=i.Path;if(!ut)break;switch(ut.FieldURI){case"PersonaFileAsIds":var ft;_e.$K.$A3y(_g.$3J,Object,r,ft={val:n.FileAsIdsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.FileAsIdsArray=ft.val;if(n.FileAsId===i.OldValue||_js.$9.$18(n.FileAsId)&&_js.$9.$18(i.OldValue)){n.FileAsId=i.NewValue;u=!0}break;case"PersonaDisplayNamePrefixes":var et;_e.$K.$A3y(_g.$3J,Object,r,et={val:n.DisplayNamePrefixesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.DisplayNamePrefixesArray=et.val;if(n.DisplayNamePrefix===i.OldValue||_js.$9.$18(n.DisplayNamePrefix)&&_js.$9.$18(i.OldValue)){n.DisplayNamePrefix=i.NewValue;u=!0}break;case"PersonaGivenNames":var ot;_e.$K.$A3y(_g.$3J,Object,r,ot={val:n.GivenNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.GivenNamesArray=ot.val;if(n.GivenName===i.OldValue||_js.$9.$18(n.GivenName)&&_js.$9.$18(i.OldValue)){n.GivenName=i.NewValue;u=!0}break;case"PersonaMiddleNames":var st;_e.$K.$A3y(_g.$3J,Object,r,st={val:n.MiddleNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.MiddleNamesArray=st.val;if(n.MiddleName===i.OldValue||_js.$9.$18(n.MiddleName)&&_js.$9.$18(i.OldValue)){n.MiddleName=i.NewValue;u=!0}break;case"PersonaSurnames":var ht;_e.$K.$A3y(_g.$3J,Object,r,ht={val:n.SurnamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.SurnamesArray=ht.val;if(n.Surname===i.OldValue||_js.$9.$18(n.Surname)&&_js.$9.$18(i.OldValue)){n.Surname=i.NewValue;u=!0}break;case"PersonaDisplayNames":var ct;_e.$K.$A3y(_g.$3J,Object,r,ct={val:n.DisplayNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.DisplayNamesArray=ct.val;if(n.DisplayName===i.OldValue||_js.$9.$18(n.DisplayName)&&_js.$9.$18(i.OldValue)){n.DisplayName=i.NewValue;u=!0;g=!0}break;case"PersonaGenerations":var lt;_e.$K.$A3y(_g.$3J,Object,r,lt={val:n.GenerationsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.GenerationsArray=lt.val;if(n.Generation===i.OldValue||_js.$9.$18(n.Generation)&&_js.$9.$18(i.OldValue)){n.Generation=i.NewValue;u=!0}break;case"PersonaNicknames":var at;_e.$K.$A3y(_g.$3J,Object,r,at={val:n.NicknamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.NicknamesArray=at.val;if(n.Nickname===i.OldValue||_js.$9.$18(n.Nickname)&&_js.$9.$18(i.OldValue)){n.Nickname=i.NewValue;u=!0}break;case"PersonaInitials":var vt;_e.$K.$A3y(_g.$3J,Object,r,vt={val:n.InitialsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.InitialsArray=vt.val;break;case"PersonaYomiCompanyNames":var yt;_e.$K.$A3y(_g.$3J,Object,r,yt={val:n.YomiCompanyNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.YomiCompanyNamesArray=yt.val;break;case"PersonaYomiFirstNames":var pt;_e.$K.$A3y(_g.$3J,Object,r,pt={val:n.YomiFirstNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.YomiFirstNamesArray=pt.val;if(n.YomiFirstName===i.OldValue||_js.$9.$18(n.YomiFirstName)&&_js.$9.$18(i.OldValue)){n.YomiFirstName=i.NewValue;u=!0}break;case"PersonaYomiLastNames":var wt;_e.$K.$A3y(_g.$3J,Object,r,wt={val:n.YomiLastNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.YomiLastNamesArray=wt.val;if(n.YomiLastName===i.OldValue||_js.$9.$18(n.YomiLastName)&&_js.$9.$18(i.OldValue)){n.YomiLastName=i.NewValue;u=!0}break;case"PersonaBusinessPhoneNumbers":var bt;_e.$K.$A3y(_g.$5L,Number,r,bt={val:n.BusinessPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$XG,"Business",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.BusinessPhoneNumbersArray=bt.val;s=!0;break;case"PersonaBusinessPhoneNumbers2":var kt;_e.$K.$A3y(_g.$5L,Number,r,kt={val:n.BusinessPhoneNumbers2Array},i.OldValue,i.NewValue,_e.$K.$XG,"Business",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.BusinessPhoneNumbers2Array=kt.val;break;case"PersonaHomePhones":var dt;_e.$K.$A3y(_g.$5L,Number,r,dt={val:n.HomePhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Home",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.HomePhonesArray=dt.val;s=!0;break;case"PersonaHomePhones2":var gt;_e.$K.$A3y(_g.$5L,Number,r,gt={val:n.HomePhones2Array},i.OldValue,i.NewValue,_e.$K.$XG,"Home",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.HomePhones2Array=gt.val;break;case"PersonaMobilePhones":var ni;_e.$K.$A3y(_g.$5L,Number,r,ni={val:n.MobilePhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Mobile",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.MobilePhonesArray=ni.val;s=!0;break;case"PersonaAssistantPhoneNumbers":var ti;_e.$K.$A3y(_g.$5L,Number,r,ti={val:n.AssistantPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$XG,"Assistant",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.AssistantPhoneNumbersArray=ti.val;break;case"PersonaCallbackPhones":var ii;_e.$K.$A3y(_g.$5L,Number,r,ii={val:n.CallbackPhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Callback",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.CallbackPhonesArray=ii.val;break;case"PersonaCarPhones":var ri;_e.$K.$A3y(_g.$5L,Number,r,ri={val:n.CarPhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Car",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.CarPhonesArray=ri.val;break;case"PersonaHomeFaxes":var ui;_e.$K.$A3y(_g.$5L,Number,r,ui={val:n.HomeFaxesArray},i.OldValue,i.NewValue,_e.$K.$XG,"HomeFax",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.HomeFaxesArray=ui.val;break;case"PersonaOrganizationMainPhones":var fi;_e.$K.$A3y(_g.$5L,Number,r,fi={val:n.OrganizationMainPhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"OrganizationMain",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.OrganizationMainPhonesArray=fi.val;break;case"PersonaOtherFaxes":var ei;_e.$K.$A3y(_g.$5L,Number,r,ei={val:n.OtherFaxesArray},i.OldValue,i.NewValue,_e.$K.$XG,"OtherFax",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.OtherFaxesArray=ei.val;break;case"PersonaOtherTelephones":var oi;_e.$K.$A3y(_g.$5L,Number,r,oi={val:n.OtherTelephonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Other",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.OtherTelephonesArray=oi.val;s=!0;break;case"PersonaOtherPhones2":var si;_e.$K.$A3y(_g.$5L,Number,r,si={val:n.OtherPhones2Array},i.OldValue,i.NewValue,_e.$K.$XG,"Other",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.OtherPhones2Array=si.val;break;case"PersonaPagers":var hi;_e.$K.$A3y(_g.$5L,Number,r,hi={val:n.PagersArray},i.OldValue,i.NewValue,_e.$K.$XG,"Pager",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.PagersArray=hi.val;break;case"PersonaRadioPhones":var ci;_e.$K.$A3y(_g.$5L,Number,r,ci={val:n.RadioPhonesArray},i.OldValue,i.NewValue,_e.$K.$XG,"Radio",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.RadioPhonesArray=ci.val;break;case"PersonaTelexNumbers":var li;_e.$K.$A3y(_g.$5L,Number,r,li={val:n.TelexNumbersArray},i.OldValue,i.NewValue,_e.$K.$XG,"Telex",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.TelexNumbersArray=li.val;break;case"PersonaTTYTDDPhoneNumbers":var ai;_e.$K.$A3y(_g.$5L,Number,r,ai={val:n.TTYTDDPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$XG,"TTYTDD",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.TTYTDDPhoneNumbersArray=ai.val;break;case"PersonaWorkFaxes":var vi;_e.$K.$A3y(_g.$5L,Number,r,vi={val:n.WorkFaxesArray},i.OldValue,i.NewValue,_e.$K.$XG,"BusinessFax",_e.$K.$XH,_e.$K.$Xd,_e.$K.$Yx,_e.$K.$Xa,_e.$K.$Yw);n.WorkFaxesArray=vi.val;break;case"PersonaEmails1":var yi=new _g.$1l;yi.EmailAddress=i.OldValue;var pi=new _g.$1l;pi.EmailAddress=i.NewValue;var wi;_e.$K.$A3y(_g.$Bg,Object,r,wi={val:n.Emails1Array},yi,pi,_e.$K.$1Ah,0,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails1Array=wi.val;f=!0;nt=i.OldValue;break;case"PersonaEmails1DisplayNames":var bi=new _g.$1l;bi.Name=i.OldValue;var ki=new _g.$1l;ki.Name=i.NewValue;var di;_e.$K.$A3y(_g.$Bg,Object,r,di={val:n.Emails1Array},bi,ki,_e.$K.$1Ah,1,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails1Array=di.val;f=!0;break;case"PersonaEmails1OriginalDisplayNames":var gi=new _g.$1l;gi.OriginalDisplayName=i.OldValue;var nr=new _g.$1l;nr.OriginalDisplayName=i.NewValue;var tr;_e.$K.$A3y(_g.$Bg,Object,r,tr={val:n.Emails1Array},gi,nr,_e.$K.$1Ah,2,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails1Array=tr.val;f=!0;break;case"PersonaEmails2":var ir=new _g.$1l;ir.EmailAddress=i.OldValue;var rr=new _g.$1l;rr.EmailAddress=i.NewValue;var ur;_e.$K.$A3y(_g.$Bg,Object,r,ur={val:n.Emails2Array},ir,rr,_e.$K.$1Ah,0,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails2Array=ur.val;f=!0;tt=i.OldValue;break;case"PersonaEmails2DisplayNames":var fr=new _g.$1l;fr.Name=i.OldValue;var er=new _g.$1l;er.Name=i.NewValue;var or;_e.$K.$A3y(_g.$Bg,Object,r,or={val:n.Emails2Array},fr,er,_e.$K.$1Ah,1,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails2Array=or.val;f=!0;break;case"PersonaEmails2OriginalDisplayNames":var sr=new _g.$1l;sr.OriginalDisplayName=i.OldValue;var hr=new _g.$1l;hr.OriginalDisplayName=i.NewValue;var cr;_e.$K.$A3y(_g.$Bg,Object,r,cr={val:n.Emails2Array},sr,hr,_e.$K.$1Ah,2,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails2Array=cr.val;f=!0;break;case"PersonaEmails3":var lr=new _g.$1l;lr.EmailAddress=i.OldValue;var ar=new _g.$1l;ar.EmailAddress=i.NewValue;var vr;_e.$K.$A3y(_g.$Bg,Object,r,vr={val:n.Emails3Array},lr,ar,_e.$K.$1Ah,0,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails3Array=vr.val;f=!0;it=i.OldValue;break;case"PersonaEmails3DisplayNames":var yr=new _g.$1l;yr.Name=i.OldValue;var pr=new _g.$1l;pr.Name=i.NewValue;var wr;_e.$K.$A3y(_g.$Bg,Object,r,wr={val:n.Emails3Array},yr,pr,_e.$K.$1Ah,1,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails3Array=wr.val;f=!0;break;case"PersonaEmails3OriginalDisplayNames":var br=new _g.$1l;br.OriginalDisplayName=i.OldValue;var kr=new _g.$1l;kr.OriginalDisplayName=i.NewValue;var dr;_e.$K.$A3y(_g.$Bg,Object,r,dr={val:n.Emails3Array},br,kr,_e.$K.$1Ah,2,_e.$K.$1Ai,_e.$K.$1CH,_e.$K.$1Hj,_e.$K.$1C2,_e.$K.$1Hd);n.Emails3Array=dr.val;f=!0;break;case"PersonaBusinessHomePages":var gr;_e.$K.$A3y(_g.$3J,Object,r,gr={val:n.BusinessHomePagesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.BusinessHomePagesArray=gr.val;break;case"PersonaPersonalHomePages":var nu;_e.$K.$A3y(_g.$3J,Object,r,nu={val:n.PersonalHomePagesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.PersonalHomePagesArray=nu.val;break;case"PersonaOfficeLocations":var tu;_e.$K.$A3y(_g.$3J,Object,r,tu={val:n.OfficeLocationsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.OfficeLocationsArray=tu.val;break;case"PersonaImAddresses":var iu;_e.$K.$A3y(_g.$3J,Object,r,iu={val:n.ImAddressesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.ImAddressesArray=iu.val;(n.ImAddress===i.OldValue||_js.$9.$18(n.ImAddress)&&_js.$9.$18(i.OldValue))&&(n.ImAddress=i.NewValue);break;case"PersonaBusinessAddresses":var ru;_e.$K.$A3y(_g.$Es,Number,r,ru={val:n.BusinessAddressesArray},i.OldValue,i.NewValue,_e.$K.$3kp,"Business",_e.$K.$3kq,_e.$K.$3ua,_e.$K.$4VN,_e.$K.$3sb,_e.$K.$4Ug);n.BusinessAddressesArray=ru.val;break;case"PersonaHomeAddresses":var uu;_e.$K.$A3y(_g.$Es,Number,r,uu={val:n.HomeAddressesArray},i.OldValue,i.NewValue,_e.$K.$3kp,"Home",_e.$K.$3kq,_e.$K.$3ua,_e.$K.$4VN,_e.$K.$3sb,_e.$K.$4Ug);n.HomeAddressesArray=uu.val;break;case"PersonaOtherAddresses":var fu;_e.$K.$A3y(_g.$Es,Number,r,fu={val:n.OtherAddressesArray},i.OldValue,i.NewValue,_e.$K.$3kp,"Other",_e.$K.$3kq,_e.$K.$3ua,_e.$K.$4VN,_e.$K.$3sb,_e.$K.$4Ug);n.OtherAddressesArray=fu.val;break;case"PersonaTitles":var eu;_e.$K.$A3y(_g.$3J,Object,r,eu={val:n.TitlesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.TitlesArray=eu.val;(n.Title===i.OldValue||_js.$9.$18(n.Title)&&_js.$9.$18(i.OldValue))&&(n.Title=i.NewValue);break;case"PersonaDepartments":var ou;_e.$K.$A3y(_g.$3J,Object,r,ou={val:n.DepartmentsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.DepartmentsArray=ou.val;(n.Department===i.OldValue||_js.$9.$18(n.Department)&&_js.$9.$18(i.OldValue))&&(n.Department=i.NewValue);break;case"PersonaCompanyNames":var su;_e.$K.$A3y(_g.$3J,Object,r,su={val:n.CompanyNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.CompanyNamesArray=su.val;if(n.CompanyName===i.OldValue||_js.$9.$18(n.CompanyName)&&_js.$9.$18(i.OldValue)){n.CompanyName=i.NewValue;n.CompanyNameSortKey=null}break;case"PersonaManagers":var hu;_e.$K.$A3y(_g.$3J,Object,r,hu={val:n.ManagersArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.ManagersArray=hu.val;break;case"PersonaAssistantNames":var cu;_e.$K.$A3y(_g.$3J,Object,r,cu={val:n.AssistantNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.AssistantNamesArray=cu.val;break;case"PersonaProfessions":var lu;_e.$K.$A3y(_g.$3J,Object,r,lu={val:n.ProfessionsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.ProfessionsArray=lu.val;break;case"PersonaBodies":var au;_e.$K.$A3y(_g.$JR,Object,r,au={val:n.BodiesArray},i.OldValue,i.NewValue,_e.$K.$7bF,null,_e.$K.$7bG,_e.$K.$7z6,_e.$K.$9lE,_e.$K.$7rl,_e.$K.$9iB);n.BodiesArray=au.val;break;case"PersonaSpouseNames":var vu;_e.$K.$A3y(_g.$3J,Object,r,vu={val:n.SpouseNamesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.SpouseNamesArray=vu.val;break;case"PersonaChildren":var yu;_e.$K.$A3y(_g.$KJ,Object,r,yu={val:n.ChildrenArray},i.OldValue,i.NewValue,_e.$K.$7ey,null,_e.$K.$7ez,_e.$K.$7z7,_e.$K.$9lF,_e.$K.$7rm,_e.$K.$9iC);n.ChildrenArray=yu.val;break;case"PersonaHobbies":var pu;_e.$K.$A3y(_g.$3J,Object,r,pu={val:n.HobbiesArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.HobbiesArray=pu.val;break;case"PersonaSchools":var wu;_e.$K.$A3y(_g.$3J,Object,r,wu={val:n.SchoolsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.SchoolsArray=wu.val;break;case"PersonaWeddingAnniversariesLocal":var bu;_e.$K.$A3y(_g.$3J,Object,r,bu={val:n.WeddingAnniversariesLocalArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.WeddingAnniversariesLocalArray=bu.val;break;case"PersonaBirthdaysLocal":var ku;_e.$K.$A3y(_g.$3J,Object,r,ku={val:n.BirthdaysLocalArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.BirthdaysLocalArray=ku.val;break;case"PersonaLocations":var du;_e.$K.$A3y(_g.$3J,Object,r,du={val:n.LocationsArray},i.OldValue,i.NewValue,_e.$K.$K2,null,_e.$K.$K3,_e.$K.$K8,_e.$K.$KX,_e.$K.$K6,_e.$K.$KV);n.LocationsArray=du.val;(n.Location===i.OldValue||_js.$9.$18(n.Location)&&_js.$9.$18(i.OldValue))&&(n.Location=i.NewValue);break;case"PersonaType":(n.PersonaTypeString===i.OldValue||_js.$9.$18(n.PersonaTypeString)&&_js.$9.$18(i.OldValue))&&(n.PersonaTypeString=i.NewValue);break;default:break}}if(u){g||(n.DisplayName=_g.$6u.$3g9(n.DisplayNamePrefix,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.YomiFirstName,n.YomiLastName));n.FileAs=_g.$6u.$7Te(n.FileAsId,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.DisplayName,n.CompanyName)}if(f){var e=[];if(!$6(n.Emails1Array))for(var gu=n.Emails1Array,lf=gu.length,y=0;y<lf;++y){var nf=gu[y];var af=nf.Value.Name===nt;_e.$K.$3cT(e,nf,af)}if(!$6(n.Emails2Array))for(var tf=n.Emails2Array,vf=tf.length,p=0;p<vf;++p){var rf=tf[p];var yf=rf.Value.Name===tt;_e.$K.$3cT(e,rf,yf)}if(!$6(n.Emails3Array))for(var uf=n.Emails3Array,pf=uf.length,w=0;w<pf;++w){var ff=uf[w];var wf=ff.Value.Name===it;_e.$K.$3cT(e,ff,wf)}if(e.length>0){for(var b=new Array(e.length),c=0;c<e.length;++c)b[c]=e[c];n.EmailAddresses=b;n.EmailAddress=b[0]}}if(u||f||s){var ef,of;_g.$6u.$3gA(n.GivenName,n.MiddleName,n.Surname,n.DisplayName,n.CompanyName,n.EmailAddress,n.MobilePhonesArray,n.HomePhonesArray,n.BusinessPhoneNumbersArray,n.OtherTelephonesArray,_e.$K.$7tN,_e.$K.$fN,ef={val:n.DisplayNameFirstLast},of={val:n.DisplayNameLastFirst});n.DisplayNameFirstLast=ef.val;n.DisplayNameLastFirst=of.val;n.DisplayNameFirstLastSortKey=null;n.DisplayNameLastFirstSortKey=null;n.DisplayNameFirstLastHeader=_e.$K.$2YU;n.DisplayNameLastFirstHeader=_e.$K.$2YU}};_e.$K.$7tr=function(n){var t=null;$6(n)||n.length>0&&!$6(n[0].Value)&&!_js.$9.$18(n[0].Value.Number)&&(t=n[0].Value.Number);return t};_e.$K.$7tN=function(n){var t=null;$6(n)||_js.$9.$18(n.EmailAddress)||(t=n.RoutingType.toUpperCase()==="EX"?n.OriginalDisplayName:n.EmailAddress);return t};_e.$K.$fN=function(n){if(Array.isInstanceOfType(n)){var t=n;return _e.$K.$7tr(t)}return null};_e.$K.$3cT=function(n,t,i){($6(t.Value.Name)||i)&&(t.Value.Name=t.Value.EmailAddress);$6(t.Value.RoutingType)&&(t.Value.RoutingType="SMTP");Array.add(n,t.Value)};_e.$K.$K2=function(n,t){return new _g.$3J(n)};_e.$K.$K3=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$K8=function(n){return n.Value};_e.$K.$KX=function(n,t,i){n.Value=t};_e.$K.$K6=function(n){return n.Attributions};_e.$K.$KV=function(n,t){n.Attributions=t};_e.$K.$7ey=function(n,t){var i=new _g.$KJ;i.Values=n.split(",;");return i};_e.$K.$7ez=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$7z7=function(n){return n.Values.join(", ")};_e.$K.$9lF=function(n,t,i){n.Values=t.split(",;")};_e.$K.$7rm=function(n){return n.Attributions};_e.$K.$9iC=function(n,t){n.Attributions=t};_e.$K.$XG=function(n,t){return new _g.$5L(new _g.$3C(n,t))};_e.$K.$XH=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$Xd=function(n){return n.Value.Number};_e.$K.$Yx=function(n,t,i){var r=n.Value.Type;n.Value=new _g.$3C(t,r)};_e.$K.$Xa=function(n){return n.Attributions};_e.$K.$Yw=function(n,t){n.Attributions=t};_e.$K.$1Ah=function(n,t){var i=new _g.$Bg;i.Value=n;return i};_e.$K.$1Ai=function(n){for(var i=new(_0365f.$o.$$(_g.$Bg)),t=0;t<n.length;++t){var r=_e.$K.$5FY(n[t]);_e.$K.$18(r)||i.$D(n[t])}return i.get_$B()>0?i.$6Z():null};_e.$K.$1CH=function(n){return _e.$K.$5FY(n)};_e.$K.$5FY=function(n){var t=new _g.$1l;t.Name=n.Value.Name;t.EmailAddress=n.Value.EmailAddress;t.RoutingType=n.Value.RoutingType;t.OriginalDisplayName=n.Value.OriginalDisplayName;return t};_e.$K.$1Hj=function(n,t,i){n.Value||(n.Value=new _g.$1l);var r=t;var u=i;switch(u){case 1:n.Value.Name=r.Name;break;case 2:n.Value.OriginalDisplayName=r.OriginalDisplayName;break;case 0:n.Value.EmailAddress=r.EmailAddress;if(n.Value.EmailAddress===""){n.Value.Name="";n.Value.RoutingType=""}break;default:throw Error.notImplemented("Invalid enum type: "+_e.$K.$2sz.toString(u));}};_e.$K.$1C2=function(n){return n.Attributions};_e.$K.$1Hd=function(n,t){n.Attributions=t};_e.$K.$3kp=function(n,t){var i=_g.$Ri.$5CV(n,t);return new _g.$Es(i)};_e.$K.$3kq=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$3ua=function(n){var t=n.Value;return _g.$Ri.$5CT(t.Street,t.City,t.State,t.PostalCode,t.Country)};_e.$K.$4VN=function(n,t,i){var r=_g.$Ri.$5CV(t,n.Value.Type);n.Value=r};_e.$K.$3sb=function(n){return n.Attributions};_e.$K.$4Ug=function(n,t){n.Attributions=t};_e.$K.$7bF=function(n,t){var i=new _g.$6R("Text",n);return new _g.$JR(i)};_e.$K.$7bG=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$7z6=function(n){return n.Value.Value};_e.$K.$9lE=function(n,t,i){var r=new _g.$6R("Text",t);n.Value=r};_e.$K.$7rl=function(n){return n.Attributions};_e.$K.$9iB=function(n,t){n.Attributions=t};_e.$K.$A3y=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v=[];if(r.val&&r.val.length)for(var st=r.val,wt=st.length,g=0;g<wt;++g){var y=st[g];var nt=h(y);var ht=l(y);if(_e.$K.$18(nt)&&_e.$K.$18(u)||_e.$K.$7Qc(u,nt,o)){for(var tt=!1,it=!1,ct=ht,bt=ct.length,rt=0;rt<bt;++rt){var kt=ct[rt];Array.contains(i,kt)?tt=!0:it=!0}if(tt&&!it){if(!_e.$K.$8EC(f)){c(y,f,o);Array.add(v,y)}}else if(tt&&it){for(var lt=e(f,o),at=e(nt,o),w=[],b=[],vt=ht,dt=vt.length,ut=0;ut<dt;++ut){var ft=vt[ut];Array.contains(i,ft)?Array.add(w,ft):Array.add(b,ft)}for(var yt=new Array(w.length),k=0;k<w.length;++k)yt[k]=w[k];a(lt,yt);for(var pt=new Array(b.length),d=0;d<b.length;++d)pt[d]=b[d];a(at,pt);_e.$K.$18(f)||Array.add(v,lt);Array.add(v,at)}else Array.add(v,y)}else Array.add(v,y)}else if(!_e.$K.$18(f)){for(var et=e(f,o),ot=new Array(i.length),p=0;p<i.length;++p)ot[p]=i[p];a(et,ot);Array.add(v,et)}r.val=v.length>0?s(v):null};_e.$K.$7Qc=function(n,t,i){if(!$6(n)&&!$6(t)){if(String.isInstanceOfType(n))return t===n;if(_g.$2L.$Xr(n)){var r=n;var u=t;var f=i;switch(f){case 0:return _js.$9.$18(r.EmailAddress)&&_js.$9.$18(u.EmailAddress)?!0:u.EmailAddress===r.EmailAddress;case 1:return _js.$9.$18(r.Name)&&_js.$9.$18(u.Name)?!0:u.Name===r.Name;case 2:return _js.$9.$18(r.OriginalDisplayName)&&_js.$9.$18(u.OriginalDisplayName)?!0:u.OriginalDisplayName===r.OriginalDisplayName;default:throw Error.notImplemented("Invalid enum type: "+_e.$K.$2sz.toString(f));}}throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());}return!1};_e.$K.$18=function(n){if($6(n))return!0;if(String.isInstanceOfType(n))return _js.$9.$18(n);if(_g.$2L.$Xr(n))return _js.$9.$18(n.EmailAddress)&&_js.$9.$18(n.Name);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$K.$8EC=function(n){if(String.isInstanceOfType(n))return _e.$K.$18(n);if(_g.$2L.$Xr(n))return $6(n);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$K.$2sz=function(){};_e.$K.$2sz.prototype={address:0,name:1,originalDisplayName:2};_e.$K.$2sz.registerEnum("_e.$K.$2sz",!1);_e.$t9=function(n,t,i,r){_e.$t9.$$(this.$$gta["_e.$t9"].TActionContext).initializeBase(this,[n,t]);this.$2ZI=i;this.$6I2=r};_e.$t9.$$=function(n){var t="$t9"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$t9"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$t9.apply(this,i)};r.registerClass("_e."+t,_e.$61.$$(n));var u=_e.$t9.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$t9.prototype={$2ZI:null,$14:null,$6I2:null,get_$1s:function(){return this.$14},set_$1s:function(n){this.$14=n;return n},get_$A5Z:function(){return this.$2ZI},set_$A5Z:function(n){this.$2ZI=n;return n},get_$A5a:function(){return this.$6I2}};_e.$Oq=function(n,t,i,r,u,f){_e.$Oq.initializeBase(this,[n,t,i,u]);_a.$4.$l(i,"propertyUpdates");_a.$4.$l(r,"parentFolder");_a.$4.$l(n.personaId,"actionContext.PersonaId");_a.$4.$1G(n.personaId.Id,"actionContext.PersonaId.Id");this.$NR=r;this.$4K=f};_e.$Oq.prototype={$NR:null,$4K:null,$2k:null,get_$RI:function(){return"CreatePersona"},$7VR:function(n,t,i){if(this.get_$A5a()===_e.$K.$3oC){i(-1);return}var r=this.$NR.BaseFolderId;if(_g.$7P.isInstanceOfType(r)){var u=this;this.$4K.$So(2,new _a.$KL,function(f){if(f){var e=r.Id;_e.$8C.$1aP(u.get_$A8().get_$2x(),e,function(r){if(r){u.$2k=r.get_$20().FolderId;u.$n(n,t,i)}else{_js.Trace.logWarning(_e.$Oq.$A,"Couldn't find a folder with the distinguished id '{0}', so reject this command.",e);i(-1)}},function(n){_js.Trace.logError(_e.$Oq.$A,"Couldn't find a folder with the distinguished id because of failure: '{0}'",n.get_$52());t(n.$SQ())})}else{_js.Trace.logWarning(_e.$Oq.$A,"Couldn't find a folder with the distinguished id because folder hierarchy wasn't synced.");i(-1)}})}else{this.$2k=r;this.$n(n,t,i)}},$7n1:function(n,t,i){var r=new _g.$Cz;r.PersonaId=this.get_$A3u().personaId;r.PersonaTypeString="Person";r.FolderIds=[this.$2k];this.get_$A3u().createPersonaUnderMyContactsFolder&&Array.add(r.FolderIds,_g.$28.$Bi("mycontacts"));r.CreationTimeString=_a.$7.$EZ(_a.$7.get_$29());r.DisplayNameFirstLastHeader=_e.$K.$2YU;r.DisplayNameLastFirstHeader=_e.$K.$2YU;r.FileAsId="LastCommaFirst";var u=new _g.$Mt("0",new _g.$1q(this.get_$A3u().personaId.Id),"Outlook");u.IsWritable=!0;u.IsQuickContact=!1;u.IsHidden=!1;u.FolderId=null;r.AttributionsArray=[u];_e.$K.$55x(r,this.get_$A5Z());var f=this,e=this,o=this;this.$BT(function(n){var t=_e.$6H.$E(f.get_$A8());t.$5PE(n,r,function(){t.$tl(n,r,0,null)});f.set_$1s(r)},function(){n()},function(n){_e.$1f.$D6(n,function(n){t(n)})})}};_e.$au=function(n,t,i,r){_e.$au.initializeBase(this,[n,t]);_a.$4.$l(i,"personaId");this.$CR=i;this.$4K=r};_e.$au.prototype={$CR:null,$4K:null,get_$RI:function(){return"DeletePersona"},$7VR:function(n,t,i){var r=this;this.$4K.$So(8,new _a.$KL,function(u){if(u)r.$n(n,t,i);else{_js.Trace.logWarning(_e.$au.$A,"Couldn't find the persona because people module wasn't synced.");i(-1)}})},$7n1:function(n,t,i){var r=this,u=this,f=this;this.$BT(function(n){var t=_e.$6H.$E(r.get_$A8());t.$Fy(n,r.$CR,function(i){$6(i)?_a.$Au.$1IM(2,"PersonaId to delete is not present in persona store"):t.$Ht(n,i.PersonaId)},null)},function(){n()},function(n){_e.$1f.$D6(n,t)})}};_e.$Hy=function(n,t,i){_e.$Hy.initializeBase(this,[n,t,i,i.Body.AttachmentIds.length]);this.$9G=new Array(this.get_$A5t());this.$30=new _g.$T6;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};function $6zW(n,t,i,r){var u=t;if($6(u.Attachments)){_js.Trace.logWarning(_e.$Hy.$A,"Item with id {0} has no attachments in local store",u.ItemId.Id);return}var f=$6zX(n,u,i);r.deletedAttachment=f;if(!f){_js.Trace.logWarning(_e.$Hy.$A,"Attachment with id {0} not found on item with id {1} in local store",i,u.ItemId.Id);return}if(!u.Attachments.length){u.Attachments=undefined;u.HasAttachments=!1}}function $6zX(n,t,i){for(var f=t.Attachments,e=f.length,r=0;r<e;++r){var u=f[r];if(u.AttachmentId.Id===i){Array.remove(t.Attachments,u);return u}}return null}_e.$Hy.prototype={$30:null,$9G:null,get_$RI:function(){return"DeleteAttachment"},$7VR:function(n,t,i){this.$n(n,t,i)},$7mn:function(n,t,i,r){var f=this.get_$A3u().itemContexts[n];if(f.clientStoreItem===2){var u=new _g.$al;u.ResponseCode="NoError";u.ResponseClass="Success";var e=f.parentItemId;u.RootItemId=new _g.$fS;u.RootItemId.RootItemId=e.Id;u.RootItemId.RootItemChangeKey=e.ChangeKey;this.$9G[n]=u;var o=this,s=this,h=this;this.$BT(function(t){o.get_$A8().get_$52().$1Ih(t,_e.$1h.$5f(e.Id),function(t){if($6(t)){_js.Trace.logWarning(_e.$Hy.$A,"Message with id {0} not found in local store",e.Id);return}$6zW(o,t,o.get_$1Ss().Body.AttachmentIds[n].Id,f)})},function(){t()},function(n){_e.$1f.$D6(n,i)})}else{_js.Trace.logWarning(_e.$Hy.$A,"ClientStoreItem type {0} is not supported.",f.clientStoreItem);t();return}}};_e.$9f=function(n,t,i){this.$Fq=0;_e.$9f.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $6zY(n,t,i,r){if(t.__type!==_g.$1q._dataContractName&&t.__type!==_g.$7U._dataContractName){n.$80=!0;n.$Fq=14;i();return}var u=this,f=this,e=this;n.$BT(function(i){if(t.__type===_g.$7U._dataContractName)n.get_$A3t().$5RO(i,t,function(t){_e.$Dh.$3fU(i,n.get_$A8().get_$lc(),t,function(r){if(!r||!r.get_$20()){_js.Trace.logWarning(_e.$9f.$A,"DeleteCalendarItem - Calendar master item with uid {0} could not be found in client store.",t);n.$80=!0;return}_js.Trace.logInfo(_e.$9f.$A,"DeleteCalendarItem - Calendar master item with uid {0} found in client store. Deleting it.",t);n.$A5z(_bc.$Kp,i,r)})},function(){n.$80=!0});else{var u=t;var r=_e.$1h.$5f(u.Id);n.get_$A3u().isReferencedItemRecurringMaster?n.$A5y(_bc.$Kp,i,r,n.get_$A8().get_$lc()):n.$A5y(_bc.$Lt,i,r,n.get_$A8().get_$1k())}},function(){if(t.__type===_g.$7U._dataContractName)_js.Trace.logInfo(_e.$9f.$A,"Successfully deleted calendar master, occurrences, exceptions and reminders with from master of occurrence with id {0} from local store.",t.OccurrenceId);else{var r=t;n.get_$A3u().isReferencedItemRecurringMaster?_js.Trace.logInfo(_e.$9f.$A,"Successfully deleted calendar master, occurrences, exceptions and reminders with from calendar master with id {0} from local store.",r.Id):_js.Trace.logInfo(_e.$9f.$A,"Successfully deleted calendar item and reminder with id {0} from local store.",r.Id)}i()},function(n){r(new _e.$1f(new _a.$Au(0,n.$3v)))})}function $6zZ(n,t,i,r){var u=this,f=this;n.$BT(function(i){n.get_$52().$3nE(i,n.get_$JM(),n.get_$1Ss().Body.DeleteType,t,_g.$28.$Bi("deleteditems"),n.get_$46A())},function(){i()},_e.$1f.$Zb(r))}_e.$9f.prototype={$80:!1,get_$RI:function(){return"DeleteItem"},$7VR:function(n,t,i){if(this.get_$A3u().clientStoreItem){var r=this;this.$n(function(){r.$80?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$9f.$A,"ClientStoreItem.None was passed. Request will be sent to the server.");n()}},$7mn:function(n,t,i,r){if(this.$80){t();return}var f=this.get_$1Ss().Body.ItemIds[n];if(this.get_$A3u().clientStoreItem===2){var u=f;_js.Trace.logInfo(_e.$9f.$A,"Step {0} called for delete message item with id {1}",n.toString(),u.Id);var e=this,o=this;$6zZ(this,u,function(){_js.Trace.logInfo(_e.$9f.$A,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}else if(this.get_$A3u().clientStoreItem===1){_js.Trace.logInfo(_e.$9f.$A,"Step {0} called for deleting an calendar item",n.toString());$6zY(this,f,t,i)}else{_js.Trace.logWarning(_e.$9f.$A,"ClientStoreItem {0} is not supported.",this.get_$A3u().clientStoreItem);t()}},$A5y:function(n,t,i,r){var u=this;r.$Fy(t,i,function(r){if(!r||!r.get_$20()){_js.Trace.logWarning(_e.$9f.$A,"Calendar item (type: {0}) with id {1} could no be found in client store.",n.getName(),i);u.$80=!0;return}_js.Trace.logInfo(_e.$9f.$A,"Calendar item (type: {0}) with id {1} found in client store. Deleting it.",n.getName(),r.get_$1y());u.$A5z(n,t,r)},null)},$A5z:function(n,t,i){if(i.get_$20().IsMeeting){_js.Trace.logInfo(_e.$9f.$A,"Offline delete calendar item with id {0} was rejected because it's a meeting. Request will go directly to the server.",i.get_$1y());this.$80=!0;this.$Fq=5;return}this.get_$A3t().$3n0(t,i.get_$1y(),i.get_$20())}};_e.$AN=function(n,t,i,r,u){this.$Fq=0;this.$24m=-1;_e.$AN.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);_a.$4.$l(r,"folderMappings");_a.$4.$l(u,"syncManager");this.$1i=r;this.$4K=u};_e.$AN.$42o=function(n,t,i,r){if(t&&t.explicitLogonUser){_js.Trace.logInfo(_e.$AN.$A,"Not-supported: Offline EmptyFolder only supports primary mailbox, other mailbox calls are not supported.");i.val=307;r.val=17;return!1}if(!t.$3zu){_js.Trace.logInfo(_e.$AN.$A,"Not-supported: Offline EmptyFolder currently only supports conversation view.");i.val=312;r.val=20;return!1}i.val=-1;r.val=0;return!0};_e.$AN.$7tv=function(n,t){for(var i=null,u=t,e=u.length,r=0;r<e;++r){var f=u[r];if(f.FolderId.Id===n.Id){i=f;break}}return i&&!_js.$9.$a(i.LastSuccessfulSyncTime)?_a.$7.$42(i.LastSuccessfulSyncTime):null};function $2hs(n,t,i,r){n.$24m=i;n.$Fq=r;t(n.$24m)}function $6zc(n,t,i,r,u){var f=this,e=this;n.$BT(function(i){n.get_$A3u().$3zu?n.get_$A8().get_$JM().$1s9(i,_e.$Qa.$3u3(t.Id,n.get_$A3u().$AR),function(){$6zd(n,t,i)}):$2hs(n,u,312,20)},function(){i()},_e.$1f.$Zb(r))}function $6zd(n,t,i){n.get_$A3u().$AR==="All"&&n.get_$A8().get_$2x().$6du(i,t,0,0)}_e.$AN.prototype={$1i:null,$4K:null,get_$RI:function(){return"EmptyFolder"},$7VR:function(n,t,i){var r,u,f;(f=_e.$AN.$42o(this.get_$1Ss().Body,this.get_$A3u(),r={val:this.$24m},u={val:this.$Fq}),this.$24m=r.val,this.$Fq=u.val,f)?this.$n(n,t,i):$2hs(this,i,this.$24m,this.$Fq)},$7mn:function(n,t,i,r){var f=this.get_$A3u().$AR!=="All"?this.get_$A3u().$6YF:this.get_$1Ss().Body.FolderIds[n];_a.$4.$J(f,"FolderId for current step cannot be null");var u=null;if(_g.$7P.isInstanceOfType(f)){var o=f;u=this.$1i.nameToId(o.Id)}else u=f;_a.$4.$9n(!!u,"[EmptyFolder::ExecuteCurrentStep] currentFolderId should not be null.");var e=this;this.$4K.$1d5(4,new _bc.$Hz(u),function(n,f){_js.Trace.logInfo(_e.$AN.$A,"Offline EmptyFolder only supports synced folders.");if(n){var o=_e.$AN.$7tv(u,f);_js.Trace.logInfo(_e.$AN.$A,"[EmptyFolder::ExecuteCurrentStep] folderLastSyncTime = '{0}'",o?o.toString():"null");if(o){e.get_$1Ss().Body.ClientLastSyncTime=o.$99();$6zc(e,u,t,i,r)}else{_js.Trace.logError(_e.$AN.$A,"[EmptyFolder::ExecuteCurrentStep] folderLastSyncTime is null for synced folder '{0}'.",u.Id);$2hs(e,r,301,19)}}else{_js.Trace.logInfo(_e.$AN.$A,"[EmptyFolder::ExecuteCurrentStep] Offline EmptyFolder service command only supports synced folders.");$2hs(e,r,301,18)}})}};_e.$AO=function(n,t,i,r){this.$Jh=-1;_e.$AO.initializeBase(this,[n,t,i]);_a.$4.$J(i.Body.ParentFolderId,"ParentFolderId");_a.$4.$J(i.Body.Paging,"Paging");_a.$4.$l(r,"syncManager");this.$4K=r;this.$30=new _g.$Oy;this.$30.Header=_e.$8d.$Wc;this.$30.Body=new _g.$WN};_e.$AO.$$cctor=function(){_e.$61.$$(_g.$FI).$A3s("FindConversation")};function $6zf(n,t,i,r){r.val=null;for(var f=!0,s=i,l=s.length,o=0;o<l;++o){var h=s[o];if(h.FolderId.Id===n.$2k.Id){r.val=h;break}}if(r.val)if(_g.$C8.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>r.val.SyncMinimum&&n.$rF()){_js.Trace.logInfo(_e.$AO.$A,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,r.val.SyncMinimum,n.$rF());f=!1}}else if(_g.$KG.isInstanceOfType(t.Paging)){var e=t.Paging;if(e.MaxEntriesReturned<=0||e.MaxEntriesReturned>r.val.SyncMinimum&&n.$rF()){_js.Trace.logInfo(_e.$AO.$A,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",e.MaxEntriesReturned,e.BasePoint,r.val.SyncMinimum,n.$rF());f=!1}else if(e.BasePoint==="Beginning"){var c=n.get_$A8().get_$JM().$5Se(r.val.OldestDeliveryTime);var a=_a.$7.$42(c).$5R();var v=_a.$7.$42(n.get_$A3u().itemLastDeliveryTime).$5R();if(v<a){_js.Trace.logInfo(_e.$AO.$A,"Requested item's last delivery time [{0}] is less than the oldest synced item's last delivery time [{1}]. Rejecting the request.",n.get_$A3u().itemLastDeliveryTime,c);f=!1}}}else{_js.Trace.logInfo(_e.$AO.$A,"Non-supported paging type. PagingType={0}",t.Paging);f=!1}else{_js.Trace.logInfo(_e.$AO.$A,"Could not find the conversation view data for the folder specified");f=!1}return f}function $6ze(n,t,i,r){n.$30.Body.ResponseCode="NoError";n.$30.Body.ResponseClass="Success";n.$30.Body.Conversations=t;n.$30.Body.TotalConversationsInView=i;n.$30.Body.IndexedOffset=r}_e.$AO.prototype={$4K:null,$30:null,$2k:null,$80:!1,get_$RI:function(){return"FindConversation"},$7VR:function(n,t,i){var r,u;if(!(u=_g.$FI.$42o(this.get_$1Ss().Body,this.get_$A3u(),r={val:this.$Jh}),this.$Jh=r.val,u)){_js.Trace.logInfo(_e.$AO.$A,"Not-supported: Request contains query string or view filter or explicit logon or from filter.");i(this.$Jh);return}this.$2k=this.$3tD(this.get_$1Ss().Body.ParentFolderId.BaseFolderId);var f=this;this.$n(function(){if(f.$80){_js.Trace.logInfo(_e.$AO.$A,"Client store unable to fulfil request. Forwarding request to the server.");i(f.$Jh)}else n()},t,i)},$7n1:function(n,t,i){var r=this;this.$1d5(4,new _bc.$Hz(this.$2k),function(i,u){var f=null;var e,o;if(!i||!(o=$6zf(r,r.get_$1Ss().Body,u,e={val:f}),f=e.val,o)){r.$80=!0;r.$Jh=i?100:301;_js.Trace.logInfo(_e.$AO.$A,"Rejecting the request to the server with RejectCode {0}",_0365f.$RR.toString(r.$Jh));n();return}_js.Trace.logInfo(_e.$AO.$A,"FindConversationAction is trying to use client store to get {0} rows",r.get_$1Ss().Body.Paging.MaxEntriesReturned);r.get_$A8().get_$JM().$5Q5(r.$2k.Id,r.get_$1Ss().Body,r.get_$A3u(),f,function(t,i,u){_js.Trace.logInfo(_e.$AO.$A,"Obtained {0} conversations from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",t.length,f.MoreItemsOnServer,r.$rF());var e=r.get_$1Ss().Body.Paging.MaxEntriesReturned;if(t.length<e&&f.MoreItemsOnServer&&r.$rF()||!t.length&&f.MoreItemsOnServer){_js.Trace.logInfo(_e.$AO.$A,"The client store was requested {0} rows but returned only {1} AND there are more changes on the server. Hence, rejecting the request to the server.",e,t.length);r.$80=!0;r.$Jh=302;n();return}_js.Trace.logInfo(_e.$AO.$A,"FindConversationAction is returning {0} rows from client store. TotalConversationsInView={1}, indexOffset={2}",t.length,f.TotalConversationsInView,u);$6ze(r,t,f.TotalConversationsInView,u);n()},function(n){r.$A3w(r.$30.Body,n,t)})})},$1d5:function(n,t,i){this.$4K.$1d5(n,t,i)},$rF:function(){return _g.$1U.$v.$Be.$Pf}};_e.$B0=function(n,t,i,r,u,f){_e.$B0.initializeBase(this,[n,t,i,i.Body.ParentFolderIds.length]);_a.$4.$l(r,"syncManager");_a.$4.$l(u,"folderMappings");_a.$4.$l(f,"sessionSettings");this.$4K=r;this.$1i=u;this.$Ax=f;this.$9G=new Array(this.get_$A5t());this.$30=new _g.$Qk;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};function $6zi(n,t,i,r,u,f){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with shallow traversal for folder {0} in client store.",t);var e=this,o=this;i.$7yF(t,function(i){$6zg(n,t,r,u,f,i)},function(t){n.$A3w(r,t,f)})}function $6zh(n,t,i,r,u,f){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with deep traversal for folder {0} in client store.",t);if(n.$1i.doesIdEqualName(new _g.$3S(t),"msgfolderroot")){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with deep traversal for msgfolderroot in client store.");var o=this,s=this;i.$7rG(function(t){var i=t[0].get_$20();Array.removeAt(t,0);$4ow(n,r,t,i);u()},function(t){n.$A3w(r,t,f)})}else{var e="Deep traversal is supported only for msgrootFolder. Actual folderId = "+t;_js.Trace.logError(_e.$B0.$A,e);f(new _e.$1f(new _a.$Au(1,e)))}}function $6zg(n,t,i,r,u,f){var e=this,o=this,s=this;n.$BT(function(r){n.get_$A8().get_$2x().$Fy(r,_e.$1h.$5f(t),function(r){if(!r){_js.Trace.logWarning(_a.$0.$LV,"Could not find folder with id = {0} in the ClientStore",t);return}$4ow(n,i,f,r.get_$20())},null)},function(){r()},function(n){i.ResponseCode="ErrorDataSourceOperation";i.ResponseClass="Error";i.MessageText=n.$3v;_e.$1f.$D6(n,u)})}function $4ow(n,t,i,r){for(var f=t.RootFolder.Folders,u=0;u<i.length;++u)f[f.length]=i[u].get_$20();t.RootFolder.ParentFolder=r}function $6zj(n,t){if(_g.$7P.isInstanceOfType(t)){var i=t;var r=i.Id;if(r==="archivemsgfolderroot"||i.Mailbox&&n.$Ax&&i.Mailbox.EmailAddress!==n.$Ax.get_$Aj())return!1}else if(n.$1i.doesIdEqualName(t,"archivemsgfolderroot"))return!1;return!0}_e.$B0.prototype={$4K:null,$1i:null,$30:null,$9G:null,$80:!1,$Ax:null,get_$RI:function(){return"FindFolder"},$7VR:function(n,t,i){var r=this;this.$4K.$So(2,new _a.$KL,function(u){if(u){var f=r.get_$1Ss().Body.Traversal;if(f!=="Deep"&&f!=="Shallow"){_js.Trace.logInfo(_e.$B0.$A,"Rejecting request: FindFolder requested with unsupported traversal {0}.",f);i(-1)}else r.$n(function(){r.$80?i(-1):n()},t,i)}else i(-1)})},$7mn:function(n,t,i,r){var f=this.get_$1Ss().Body.ParentFolderIds[n];if(!$6zj(this,f)){_js.Trace.logInfo(_e.$B0.$A,"Not-supported: Request with DistinguishedFolderId.");this.$80=!0;t();return}if(_g.$7P.isInstanceOfType(f)){var s=f.Id;var e=String.format("Failed to find distinguished folder with id '{0}'",s);_js.Trace.logError(_e.$B0.$A,e);i(new _e.$1f(new _a.$Au(2,e)))}else{var o=f.Id;var u=new _g.$bY;u.ResponseCode="NoError";u.ResponseClass="Success";u.RootFolder=new _g.$bV;this.$9G[n]=u;this.get_$1Ss().Body.Traversal==="Shallow"?$6zi(this,o,this.get_$A8().get_$5Nt(),u,t,i):this.get_$1Ss().Body.Traversal==="Deep"&&$6zh(this,o,this.get_$A8().get_$5Nt(),u,t,i)}}};_e.$3G=function(n,t,i,r,u){_e.$3G.initializeBase(this,[n,t,i]);_a.$4.$l(r,"syncManager");_a.$4.$l(u,"folderMappings");this.$4K=r;this.$1i=u;this.$30=new _g.$Kk;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=new Array(1)};_e.$3G.$$cctor=function(){_e.$61.$$(_g.$9E).$A3s("FindItem")};_e.$3G.$5C0=function(n,t){var r=n;var u=t;var f=r.get_$54j();var e=u.get_$54j();var i=f.$93(e);if(i)return i;!r.get_$AW()&&u.get_$AW()?i=1:r.get_$AW()&&!u.get_$AW()&&(i=-1);if(i)return i;i=u.get_$5fS()-r.get_$5fS();return i?i:f.$2R(e)};_e.$3G.$8Jb=function(n,t,i,r){for(var e=n.length,o=e>0?n[e-1]:null,s=t.length,u=i;u<s;u++){var f=t[u];if(o&&f.get_$3d5().localeCompare(o.get_$y())<=0)_0365f.$F4.$2zT(n,f,_e.$3G.$5C0);else if(n.length<r)Array.add(n,f);else break}};function $6zp(n){var r=!1;var t=_g.$9E.$5Ph(n.get_$1Ss().Body);if(_g.$7P.isInstanceOfType(t)){var i=t;if($6(i.Mailbox)){n.$2k=n.$1i.nameToId(i.Id);n.$12X=i.Id;n.$2sS=!0;r=!0;_js.Trace.logInfo(_e.$3G.$A,"Converted distinguished folder id '{0}' to actual folder id '{1}'",n.$12X,n.$2k.Id)}else _js.Trace.logInfo(_e.$3G.$A,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",i.Mailbox.EmailAddress)}else if(_g.$3S.isInstanceOfType(t)){n.$2k=t;r=!0}else _js.Trace.logWarning(_e.$3G.$A,"FolderId {0} is not of a known folder type.",t);return r}function $6zl(n,t,i,r){_js.Trace.logInfo(_e.$3G.$A,"FindCalendarItemsByIndex");if(n.get_$1Ss().Body.Paging.MaxEntriesReturned<0)throw Error.invalidOperation("FindCalendarItemsByIndex called with a negative MaxEntriesReturned in the paging.");var f=new _e.$5a(n.get_$A8().get_$1k());var u=n.get_$1Ss().Body.Paging;var e=u.Condition.$6R9;if(u.Offset){var s=_a.$6.acsa(_a.$0.$102,"FindCalendarItemsByIndex_SeekToConditionWithOffset",!0);var l=this,a=this;f.$9gB(e,function(e){_a.$6.acea(s);n.get_$A3u().firstMatchingRowIndex=e;n.get_$A3u().loadedStartIndex=Math.max(0,e+u.Offset);var o=new _g.$C8("Beginning");o.Offset=n.get_$A3u().loadedStartIndex;o.MaxEntriesReturned=u.MaxEntriesReturned;$6zn(n,t,f,o,i,r)},function(i){n.$A3w(t,i,r)})}else{var o=_a.$6.acsa(_a.$0.$102,"FindCalendarItemsByIndex_SeekToConditionNoOffset",!0);var h=this,c=this;f.$7rA(n.$2k.Id,e,u.MaxEntriesReturned,n.get_$1Ss().Body.ItemShape,function(e,s){_a.$6.acea(o);$4oy(n,t,i,r,f,e,s,u.MaxEntriesReturned)},function(i){n.$A3w(t,i,r)})}}function $6zq(n,t,i,r){if(_e.$3G.$3Dc&&!n.get_$A3u().isReload){i(_e.$3G.$3Dc);return}var u=this;t.$7vW(n.$2k.Id,n.get_$1Ss().Body.ItemShape,function(t){for(var l=t.length,a=_a.$6.acss(_a.$0.$102,"UnfoldMultidayItems_ProcessMultidayEvents_"+l),r=[],u=0,v=t.length;u<v;u++){var s=t[u];var f=s.get_$20();var e=_a.$7.$42(f.Start);var o=_a.$7.$42(f.End);s.get_$5V()&&(o=o.$9K(-1));for(var h=1;e.$93(o)<0;){e=e.$2o(1);var y=_0365f.$2t.$3p(f);var c=n.get_$A8().get_$1k().$qa(y);c.get_$20().unfoldedIndex=h;_0365f.$F4.$2zT(r,c,_e.$3G.$5C0);h++}}_e.$3G.$3Dc=r;_a.$6.aces(a);i(r)},r)}function $4oy(n,t,i,r,u,f,e,o){var s=_a.$6.acsa(_a.$0.$102,"ProcessAgendaViewItems_UnfoldMultidayItems",!0);var h=this;$6zq(n,u,function(r){_a.$6.acea(s);var c=r.length;var y=_a.$6.acss(_a.$0.$102,"ProcessAgendaViewItems_ProcessUnfoldedMultidayItems_"+c);if(e>0){var p=n.get_$A3u().loadedStartIndex;var h;n.get_$A3u().tableSize=e+c;var w=f[0];var b=w.get_$y();for(h=0;h<c;h++){var k=r[h];if(b.localeCompare(k.get_$3d5())<0)break}_e.$3G.$8Jb(f,r,h,o);var l=n.get_$1Ss().Body.Paging;var d=l.Condition.$2bE;var u;var a=f.length;for(u=0;u<a;u++){var g=f[u];if(g.get_$3d5().localeCompare(d)>=0)break}u===a&&u--;n.get_$A3u().firstMatchingRowIndex=u+p+h;n.get_$A3u().loadedStartIndex=Math.max(0,n.get_$A3u().firstMatchingRowIndex+l.Offset);var v=Math.max(u+l.Offset,0);var nt=v+o;var tt=f;f=tt.slice(v,nt);_js.Trace.logInfo(_e.$3G.$A,"GetCalendarItemsByIndex will return {0} items.",f.length)}else{n.get_$A3u().firstMatchingRowIndex=0;n.get_$A3u().loadedStartIndex=0}_a.$6.aces(y);$4p0(n,t,i,f)},r)}function $6zn(n,t,i,r,u,f){var e=_a.$6.acsa(_a.$0.$102,"GetCalendarItemsByIndex",!0);var o=this,s=this;i.$7r9(n.$2k.Id,r.Offset,r.MaxEntriesReturned,n.get_$1Ss().Body.ItemShape,function(o,s){_a.$6.acea(e);$4oy(n,t,u,f,i,o,s,r.MaxEntriesReturned)},function(i){n.$A3w(t,i,f)})}function $6zk(n,t,i,r){_js.Trace.logInfo(_e.$3G.$A,"FindItem for CalendarPageView is trying to fetch data from the client store");var u=n.get_$1Ss().Body.Paging;var f=new _e.$5a(n.get_$A8().get_$1k());var e=_a.$6.acsa(_e.$3G.$A,"FindItem_GetCalendarView",!0);var o=this,s=this;f.$5Pr(n.$2k.Id,u.StartDate,u.EndDate,n.get_$1Ss().Body.ItemShape,function(r){_a.$6.acea(e);var u=_a.$6.acss(_e.$3G.$A,"GetCalendarView_Success");$4p0(n,t,i,r);_a.$6.aces(u)},function(i){n.$A3w(t,i,r)})}function $4p0(n,t,i,r){var f=_a.$6.acss(_e.$3G.$A,"AddingtoResponseMsg_"+r.length);t.RootFolder.Items=new Array(r.length);for(var u=0;u<r.length;u++)t.RootFolder.Items[u]=r[u].get_$20();_a.$6.aces(f);i()}function $6zm(n,t,i,r){var u=n.get_$1Ss().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$3G.$A,"FindItem for folder outbox is trying to fetch {0} items from the client store",u);var f=this,e=this;n.get_$A8().get_$gd().$5RS(n.$2k.Id,n.get_$A8().get_$2x(),n.get_$1Ss().Body,n.get_$A3u(),null,function(r,u,f){$4oz(n,t,r,u,f);_js.Trace.logInfo(_e.$3G.$A,"FindItemAction is returning {0} rows from client store, total count={1}, indexOffset={2}",r.length,u,f);i()},function(t){n.$A3w(n.$30.Body.ResponseMessages.Items[0],t,r)})}function $4ox(n,t,i,r){var u=n.get_$1Ss().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$3G.$A,"FindItem for folder '{0}' is trying to fetch {1} items from the client store",n.$12X,u);var f=this;n.$1d5(5,new _bc.$Hz(n.$2k),function(f,e){var o=e;if(!f||!$6zo(n,n.get_$1Ss().Body,o)){_js.Trace.logInfo(_e.$3G.$A,"The folder is not synced in date mode or the request cannot be processed offline. Hence, rejecting the request to the server. isSynced={0}",f);n.$4HE=!0;i();return}n.get_$A8().get_$52().$5RS(n.$2k.Id,n.get_$A8().get_$2x(),n.get_$1Ss().Body,n.get_$A3u(),o,function(r,f,e){_js.Trace.logInfo(_e.$3G.$A,"Obtained {0} messages from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",r.length,o.MoreItemsOnServer,n.$rF());if(r.length<u&&o.MoreItemsOnServer&&n.$rF()||!r.length&&o.MoreItemsOnServer){_js.Trace.logInfo(_e.$3G.$A,"The client store was requested {0} rows but returned only {1} AND we are CONNECTED. Hence, rejecting the request to the server.",u,r.length);n.$4HE=!0;i();return}$4oz(n,t,r,o.TotalCount,e);_js.Trace.logInfo(_e.$3G.$A,"FindItemAction is returning {0} rows from client store",r.length);i()},function(t){n.$A3w(n.$30.Body.ResponseMessages.Items[0],t,r)})})}function $6zo(n,t,i){var r=!0;if(i)if(_g.$C8.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>i.SyncMinimum&&n.$rF()){_js.Trace.logInfo(_e.$3G.$A,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,i.SyncMinimum,n.$rF());r=!1}}else if(_g.$KG.isInstanceOfType(t.Paging)){var f=t.Paging;if(_g.$Nb.isInstanceOfType(f.Condition.Item)){if(f.MaxEntriesReturned<=0||f.MaxEntriesReturned>i.SyncMinimum&&n.$rF()){_js.Trace.logInfo(_e.$3G.$A,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",f.MaxEntriesReturned,f.BasePoint,i.SyncMinimum,n.$rF());r=!1}else if(f.BasePoint==="Beginning"){var e=n.get_$A8().get_$52().$5Se(i.OldestReceivedTime);var o=_a.$7.$42(e).$5R();var s=_a.$7.$42(n.get_$A3u().itemReceivedTime).$5R();if(s<o){_js.Trace.logInfo(_e.$3G.$A,"Requested item's received time [{0}] is less than the oldest synced item's receivedtime [{1}]. Rejecting the request to the server.",n.get_$A3u().itemReceivedTime,e);r=!1}}}else{_js.Trace.logInfo(_e.$3G.$A,"Non-supported SeekToConditionPageView paging values. Paging type is {0}",Object.getType(f.Condition.Item));r=!1}}else{_js.Trace.logInfo(_e.$3G.$A,"Non-supported paging type. PagingType={0}",t.Paging);r=!1}else{_js.Trace.logInfo(_e.$3G.$A,"Rejecting request to the server as message sync state context for the folder '{0}' is null.",n.$2k.Id);r=!1}return r}function $4oz(n,t,i,r,u){var f=_a.$6.acss(_a.$0.$102,"FindItem:ProcessMessages");t.RootFolder.Items=i;t.RootFolder.TotalItemsInView=r;t.RootFolder.IndexedPagingOffset=u;_a.$6.aces(f)}_e.$3G.prototype={$4K:null,$1i:null,$30:null,$2k:null,$12X:"calendar",$2sS:!1,$4HE:!1,get_$RI:function(){return"FindItem"},get_$9mY:function(){return _g.$9E.$5cL(this.get_$1Ss().Body)},$7VR:function(n,t,i){var f=_a.$6.acsa(_a.$0.$102,"FindItemCheckAndExecute-Preprocessing",!0);var e=this;var u=function(){e.$n(function(){e.$4HE?i(-1):n()},t,i)};if($6zp(this))if(_g.$KX.isInstanceOfType(this.get_$1Ss().Body.Paging)){var r=this.get_$1Ss().Body.Paging;var s=this;this.$So(10,new _e.$i6(this.$2k.Id,r.StartDate,r.EndDate),function(n){if(n){_a.$6.acea(f);_js.Trace.logInfo(_e.$3G.$A,"Processing the request by the offline store as the calendar module is synced.");u()}else{_js.Trace.logInfo(_e.$3G.$A,"Rejecting the call as the calendar folder is not synced OR the date range is not synced. FolderId='{0}', StartDate={1}, EndDate={2}, ",s.$2k.Id,r.StartDate,r.EndDate);i(-1)}})}else if(this.$2sS&&this.$12X==="calendar")if(_g.$JB.isInstanceOfType(this.get_$1Ss().Body.Paging)){_a.$6.acea(f);_js.Trace.logInfo(_e.$3G.$A,"Processing the request by the offline store as the view is offline-only.");u()}else{var o=String.format("{0} isn't supported for calendar folders.",Object.getType(this.get_$1Ss().Body.Paging));_js.Trace.logInfo(_e.$3G.$A,o);t(Error.invalidOperation(o))}else if(this.get_$9mY())u();else{_js.Trace.logInfo(_e.$3G.$A,"Rejecting the call as it is not supported in the client store");i(-1)}else{_js.Trace.logWarning(_e.$3G.$A,"Rejecting the call as parent folder id is not valid.");i(-1)}},$7n1:function(n,t,i){var r=new _g.$P0;r.ResponseCode="NoError";r.ResponseClass="Success";r.RootFolder=new _g.$Oz;this.$30.Body.ResponseMessages.Items[0]=r;var u=this.get_$1Ss().Body.Paging;if(_g.$KX.isInstanceOfType(u))$6zk(this,r,n,t);else if(this.$2sS&&this.$12X==="calendar"&&_g.$JB.isInstanceOfType(this.get_$1Ss().Body.Paging))$6zl(this,r,n,t);else if(_g.$9E.$5eS(u)||_g.$9E.$5eU(u)){_js.Trace.logInfo(_e.$3G.$A,"FindItem for {0} paging is using client store",Object.getType(u));if(this.$2sS)if(this.$12X==="outbox")$6zm(this,r,n,t);else if(this.$12X==="calendar")throw Error.invalidOperation("FindItem with IndexedPageView isn't supported for calendar folders.");else $4ox(this,r,n,t);else $4ox(this,r,n,t)}else{var f=String.format("FindItem called with invalid folder ID and paging. FID={0}, Paging={1}",this.$2k.Id,Object.getType(u));throw Error.invalidOperation(f);}},$So:function(n,t,i){this.$4K.$So(n,t,i)},$1d5:function(n,t,i){this.$4K.$1d5(n,t,i)},$rF:function(){return _g.$1U.$v.$Be.$Pf}};_e.$TK=function(n,t,i,r){_e.$TK.initializeBase(this,[n,t,i]);_a.$4.$l(r,"syncManager");this.$4K=r;this.$30=new _g.$TM;this.$30.Header=_e.$8d.$Wc};_e.$TK.$89H=function(n){return _g.$7P.isInstanceOfType(n)&&n.Id==="directory"};function $4p1(n,t,i,r,u){var f=this,e=this;t.$3fl(i.Offset,i.MaxEntriesReturned,n.$2k,n.get_$1Ss().Body.SortOrder,function(t,u){n.$30.Body.ResponseCode="NoError";n.$30.Body.ResponseClass="Success";n.$30.Body.ResultSet=t;n.$30.Body.TotalNumberOfPeopleInView=u;n.$30.Body.FirstLoadedRowIndex=i.Offset;r()},function(t){n.$30.Body.ResponseCode="ErrorDataSourceOperation";n.$30.Body.ResponseClass="Error";n.$30.Body.MessageText=t.get_$52();u(t)})}_e.$TK.prototype={$4K:null,$30:null,$2k:null,get_$RI:function(){return"FindPeople"},$7VR:function(n,t,i){var r=this.get_$1Ss().Body.ParentFolderId?this.get_$1Ss().Body.ParentFolderId.BaseFolderId:null;var f=_g.$3S.isInstanceOfType(r);if(!_js.$9.$a(this.get_$1Ss().Body.QueryString)||this.get_$1Ss().Body.Restriction||this.get_$1Ss().Body.AggregationRestriction||!f||_e.$TK.$89H(r)||_g.$9E.$42D(r))i(-1);else{var u=this;this.$4K.$So(8,new _a.$KL,function(f){if(f)if(_g.$7P.isInstanceOfType(r))_a.$4.$9n(!1,"FindPeople is not supported with DistinguishedFolderId as ParentFolderId, offending Folder Id: "+r.Id);else{u.$2k=r;u.$n(n,t,i)}else i(-1)})}},$7n1:function(n,t,i){_a.$4.$7t(this.get_$1Ss().Body.SortOrder.length,1,2,"expecting 1 - 2 sort columns");_a.$4.$9n(_g.$C8.isInstanceOfType(this.get_$1Ss().Body.IndexedPageItemView)||_g.$JB.isInstanceOfType(this.get_$1Ss().Body.IndexedPageItemView),"Browse People only support IndexedPageView or SeekToConditionWithOffsetPageView.");var r=_e.$6H.$E(this.get_$A8());if(_g.$C8.isInstanceOfType(this.get_$1Ss().Body.IndexedPageItemView)){var o=this.get_$1Ss().Body.IndexedPageItemView;$4p1(this,r,o,n,t);return}var s=_a.$6.acsa(_a.$0.$9t,"FindPeople.SeekToCondition",!0);var u=this.get_$1Ss().Body.IndexedPageItemView;var e=this,f=this;r.$9g9(u.Condition,this.$2k,this.get_$1Ss().Body.SortOrder,function(i){_a.$6.acea(s);e.$30.Body.FirstMatchingRowIndex=i;var f=new _g.$C8("Beginning");f.Offset=Math.max(0,i+u.Offset);f.MaxEntriesReturned=u.MaxEntriesReturned;$4p1(e,r,f,n,t)},function(n){f.$30.Body.ResponseCode="ErrorDataSourceOperation";f.$30.Body.ResponseClass="Error";f.$30.Body.MessageText=n.get_$52();t(n)})}};_e.$P6=function(n,t,i,r){this.$Jh=-1;_e.$P6.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);this.$4K=r;this.$9G=new Array(this.get_$A5t());this.$30=new _g.$TU;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};_e.$P6.prototype={$4K:null,$30:null,$9G:null,$80:!1,get_$RI:function(){return"GetFolder"},$7VR:function(n,t,i){var r=this;this.$4K.$So(2,new _a.$KL,function(u){u?r.$n(function(){r.$80?i(r.$Jh):n()},t,i):i(301)})},$7mn:function(n,t,i,r){var e=this.get_$1Ss().Body.FolderIds[n];var u=new _g.$bi;u.ResponseCode="NoError";u.ResponseClass="Success";u.Folders=new Array(0);this.$9G[n]=u;var o=u.Folders;if(_g.$7P.isInstanceOfType(e)){var f=e;if(f.Id==="archivemsgfolderroot"){this.$80=!0;this.$Jh=100;t()}else if(f.Mailbox){_js.Trace.logInfo(_e.$P6.$A,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",f.Mailbox.EmailAddress);this.$80=!0;this.$Jh=100;t()}else{var h=this,c=this;_e.$8C.$1aP(this.get_$A8().get_$2x(),f.Id,function(n){if(n)o[o.length]=n.get_$20();else{_js.Trace.logWarning(_e.$P6.$A,"Could not find folder with DistinguishedFolderId = {0} in the ClientStore",f.Id);var i=new _g.$EA;i.DisplayName=_e.$8C.$4Hc}t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.get_$52();i(n)})}}else{var s=this,l=this,a=this;this.$BT(function(n){s.get_$A8().get_$2x().$Fy(n,_e.$1h.$5f(e.Id),function(n){if(n)o[o.length]=n.get_$20();else{_js.Trace.logInfo(_e.$P6.$A,"Could not find folder with id = {0} in the ClientStore - rejecting command.",e.Id);s.$80=!0;s.$Jh=302}},null)},function(){t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.$3v;_e.$1f.$D6(n,i)})}}};_e.$TT=function(n,t,i){_e.$TT.initializeBase(this,[n,t]);_a.$4.$l(i,"syncManager");this.$4K=i;this.$30=null};_e.$TT.prototype={$4K:null,$30:null,get_$RI:function(){return"GetCalendarFolders"},$7VR:function(n,t,i){var r=this;this.$4K.$So(9,new _a.$KL,function(u){if(u){_js.Trace.logInfo(_e.$TT.$A,"Executing offline GetCalendarFolders command.");r.$n(n,t,i)}else{_js.Trace.logInfo(_e.$TT.$A,"Offline GetCalendarFolders command rejected.");i(301)}})},$7n1:function(n,t,i){var r=this;this.get_$4VF().$1ua(function(t){r.$30=t;n()},t)}};_e.$AQ=function(n,t,i){this.$Jh=-1;this.$444={};_e.$AQ.initializeBase(this,[n,t,i]);_a.$4.$J(n.lastModifiedTimeDictionary,"lastModifiedTimeDictionary");this.$30=new _g.$Qn;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk};_e.$AQ.$$cctor=function(){_e.$61.$$(_g.$jD).$A3s("GetConversationItems")};function $6zs(n,t){for(var e=n.$2HQ.get_$20().ConversationId.Id,u=n.$2HQ.get_$20().ConversationNodes,o=u.length,i=0;i<o;++i)for(var f=u[i],r=0;r<f.Items.length;r++){var s=f.Items[r];n.$3Rj++;var h=this;n.get_$A8().get_$52().$Fy(t,_e.$1h.$5f(s.ItemId.Id),function(t){if(t&&_e.$Bt.$7XX(t.get_$20(),0)){_js.Trace.logInfo(_e.$AQ.$A,"Adding item with id '{0}' to the dictionary for conversation with id '{1}'",t.get_$20().ItemId.Id,e);n.$444[t.get_$20().ItemId.Id]=t.get_$20();n.$4b8++}},null)}}function $6zt(n){for(var u=n.$2HQ.get_$20().ConversationNodes,f=u.length,i=0;i<f;++i)for(var r=u[i],t=0;t<r.Items.length;t++){var e=n.$444[r.Items[t].ItemId.Id];r.Items[t]=e}}function $6zr(n,t){n.$30.Body.ResponseMessages.Items=new Array(t.length);for(var i=0;i<t.length;i++){var r=new _g.$c2;r.ResponseCode="NoError";r.ResponseClass="Success";r.Conversation=t[i].get_$20();n.$30.Body.ResponseMessages.Items[i]=r}}function $6zu(n,t){for(var u=t,o=u.length,r=0;r<o;++r){var i=u[r];var f=n.get_$A3u().lastModifiedTimeDictionary[i.get_$20().ConversationId.Id];var e=_a.$7.$42(i.get_$20().LastModifiedTime).$5R();if(e<f){_js.Trace.logInfo(_e.$AQ.$A,"LastModifiedTime does not match for conversation with id {0}, client store item value = {1}:{2}, requested value = {3}",i.get_$20().ConversationId.Id,i.get_$20().LastModifiedTime,e,f);return!0}}return!1}_e.$AQ.prototype={$30:null,$80:!1,$3Rj:0,$4b8:0,$2HQ:null,get_$RI:function(){return"GetConversationItems"},$7VR:function(n,t,i){var r=this.get_$A3u().currentUserOptionsSortOrder;if($6(r)||r===this.get_$1Ss().Body.SortOrder)if($6(this.get_$A3u().currentUserOptionsIgnoringDeletedItems)||this.get_$A3u().currentUserOptionsIgnoringDeletedItems===this.get_$A3u().requestIgnoringDeleteditems)if(this.get_$1Ss().Body.MaxItemsToReturn<=20){var u=this;this.$n(function(){if(u.$80){_js.Trace.logInfo(_e.$AQ.$A,"Client store unable to fulfil request. Forwarding request to the server.");i(u.$Jh)}else n()},t,i)}else{_js.Trace.logInfo(_e.$AQ.$A,"{0} requested item parts is greater than {1} itemparts supported by the clientstore. Hence, rejecting the request",this.get_$1Ss().Body.MaxItemsToReturn,20);i(100)}else{_js.Trace.logInfo(_e.$AQ.$A,"Request specified a Hide Deleted Items option of {0} while the current UserOptions has Hided Deleted Items set to {1}, rejecting the request",this.get_$A3u().requestIgnoringDeleteditems,this.get_$A3u().currentUserOptionsIgnoringDeletedItems);i(304)}else{_js.Trace.logInfo(_e.$AQ.$A,"Request specified SortOrder of {0} while the current UserOptions has set SortOrder to {1}, rejecting the request",this.get_$1Ss().Body.SortOrder,r);i(304)}},$7n1:function(n,t,i){var e=this.get_$1Ss().Body.Conversations;_a.$4.$7t(e.length,1,1,"Invalid number of conversations requested. Number = "+e.length);var o=new _e.$k0(_a.$7G.$E());if(o.get_$7lI()){_js.Trace.logInfo(_e.$AQ.$A,"Offline email data is outdated, forwarding request to the server.");this.$80=!0;this.$Jh=301;n()}else{var f=_e.$1h.$5f(e[0].ConversationId.Id);var u=this,r=this,s=this;this.$BT(function(n){u.get_$A8().get_$HP().$Fy(n,f,function(t){u.$2HQ=t;if(t&&!$6zu(u,[t]))$6zs(u,n);else{u.$80=!0;u.$Jh=t?306:305;_js.Trace.logInfo(_e.$AQ.$A,"id '{0}' rejectCode: {1}, forwarding request to the server",f,_0365f.$RR.toString(u.$Jh))}},null)},function(){if(!r.$80&&r.$3Rj>0&&r.$3Rj===r.$4b8){_js.Trace.logInfo(_e.$AQ.$A,"All items found for conversation with id '{0}'. Providing data to the caller",f);$6zt(r);$6zr(r,[r.$2HQ]);n()}else{_js.Trace.logInfo(_e.$AQ.$A,"Couldn't find all items for conversation with id '{0}', forwarding request to the server. Total items requested = {1}, total items found = {2}",f,r.$3Rj,r.$4b8);r.$80=!0;r.$Jh=302;n()}},function(n){t(new _e.$1f(new _a.$Au(0,n.$3v)))})}}};_e.$oj=function(n,t,i){_e.$oj.initializeBase(this,[n,t]);_a.$4.$l(i,"syncManager");this.$4K=i;this.$30=null};_e.$oj.prototype={$4K:null,$30:null,get_$RI:function(){return"GetFavoriteFolders"},$7VR:function(n,t,i){var r=this;this.$4K.$So(6,new _a.$KL,function(u){u?r.$n(n,t,i):i(301)})},$7n1:function(n,t,i){var r=this;this.get_$4VF().$2vj(function(t){r.$30=t;n()},t)}};_e.$6W=function(n,t,i){this.$Jh=-1;this.$Fq=0;_e.$6W.initializeBase(this,[n,t,i,i.Body.ItemIds.length]);this.$9G=new Array(this.get_$A5t());this.$30=new _g.$Qo;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};_e.$6W.$$cctor=function(){_e.$61.$$(_g.$Wl).$A3s("GetItem")};function $6zx(n,t,i){return _bc.$Lx.isInstanceOfType(t)?$6zy(n,t,i):_bc.$Lt.isInstanceOfType(t)?$6zv(n,t,i):_bc.$Kp.isInstanceOfType(t)?$6zw(n,t,i):!0}function $6zz(n,t,i,r,u){var f=null;var e=null;var o=this,s=this,h=this;n.$BT(function(i){n.get_$A8().get_$1k().$Fy(i,_e.$1h.$5f(t.OccurrenceId),function(r){if(r&&r.get_$20()){f=r.get_$18c();_e.$Dh.$3fU(i,n.get_$A8().get_$lc(),f,function(n){e=n})}else _js.Trace.logInfo(_e.$6W.$A,"GetCalendarItem: Occurrence with id {0} not found in local store",t.OccurrenceId)},null)},function(){if(f)$3Xe(n,f,e,i,r);else{n.$80=!0;n.$Jh=302;r()}},function(t){_e.$1f.$D6(t,function(t){n.$A3w(i,t,u)})})}function $3Xe(n,t,i,r,u){var f=_a.$6.acss(_a.$0.$2vx,"CheckAndReturnItemFromClientStore");r.ResponseCode="NoError";r.ResponseClass="Success";r.Items=new Array(0);var e=r.Items;if(i&&i.get_$4cO())if($6zx(n,i,n.get_$1Ss().Body.ItemShape)){_js.Trace.logInfo(_e.$6W.$A,"Item {0} retrieved for local store satisfies request.",i.get_$1y());e[0]=i.get_$4cO()}else{_js.Trace.logWarning(_e.$6W.$A,"Item {0} retrieved for local store does not satisfy request.",i.get_$1y());n.$80=!0;n.$Jh=303}else{_js.Trace.logInfo(_e.$6W.$A,"Item with id {0} not found in local store",t);n.$80=!0;n.$Jh=302}u();_a.$6.aces(f)}function $6zy(n,t,i){var r=t.get_$20();var u=!1;if(n.get_$A3u().requireNormalizedBody&&!t.get_$20().NormalizedBody){_js.Trace.logInfo(_e.$6W.$A,"Item with id {0} does not contain the NormalizedBody shape. So rejecting to server.",t.get_$1y());n.$80=!0;n.$Jh=303}else if(i.BodyType){if(r.Body)if(r.Body.BodyType==="HTML"&&i.BodyType==="HTML"||r.Body.BodyType==="Text"&&i.BodyType==="Text"){_js.Trace.logInfo(_e.$6W.$A,"Message body type matches response shape body type. ItemId: {0} body type: {1}",r.ItemId.Id,r.Body.BodyType);u=!0}else _js.Trace.logInfo(_e.$6W.$A,"Message body type doesn't match response shape body type. ItemId: {0}  Message body type: {1}  Response shape body type: {2}",r.ItemId.Id,r.Body.BodyType,i.BodyType);else if(_e.$17.$1yo(r.__type)){var f=t.get_$20();if(f.NewBodyContent){_js.Trace.logInfo(_e.$6W.$A,"Item is a SmartResponse. ItemId: {0}",r.ItemId.Id);u=!0}else throw Error.invalidOperation(String.format("SmartResponse.NewBodyContent is undefined. ItemId: {0}",r.ItemId.Id));}}else u=!0;return u}function $6zv(n,t,i){return $4p3(n,t.get_$20(),i)}function $6zw(n,t,i){return $4p3(n,t.get_$20(),i)}function $4p3(n,t,i){if(i.BodyType==="Text"){t.TextBody||(t.TextBody=new _g.$6R("Text",t.Preview));t.Body=t.TextBody}if(t.Body.IsTruncated){_js.Trace.logWarning(_a.$0.$6y,"Truncated body type {0} on item with id {1}. Rejecting call.",t.Body.BodyType,t.ItemId.Id);n.$Fq=16;return!1}t.TextBody=undefined;return!0}_e.$6W.prototype={$30:null,$9G:null,$80:!1,get_$RI:function(){return"GetItem"},$7VR:function(n,t,i){if(this.get_$A3u().clientStoreItem){var r=this;this.$n(function(){r.$80?i(r.$Jh):n()},t,i)}else{_js.Trace.logInfo(_e.$6W.$A,"ClientStoreItem.None was passed. Request will be sent to the server.");i(100)}},$7mn:function(n,t,i,r){if(this.$80){t();return}var u=new _g.$Xb;this.$9G[n]=u;var f=this.get_$1Ss().Body.ItemIds[n];if(this.get_$A3u().clientStoreItem===2)this.$A60(_bc.$Lx,f,u,this.get_$A8().get_$52(),t,i);else if(this.get_$A3u().clientStoreItem===3)this.$A60(_bc.$181,f,u,this.get_$A8().get_$gd(),t,i);else if(this.get_$A3u().clientStoreItem===1)if(f.__type===_g.$7U._dataContractName){var c=f;$6zz(this,c,u,t,i)}else if(f.__type===_g.$Uk._dataContractName){_js.Trace.logInfo(_e.$6W.$A,"GetCalendarItem: RecurringMasterItemIdRanges isn't supported on offline getitem service command. Rejecting call.");this.$80=!0;this.$Jh=100;t()}else{var o=null;var s=f;var e=_e.$1h.$5f(s.Id);var h=this,l=this,a=this;this.$BT(function(n){_js.Trace.logInfo(_e.$6W.$A,"GetCalendarItem: Trying to find item with Id {0} in CalendarItem table",e);h.get_$A8().get_$1k().$Fy(n,e,function(t){if($6(t)||$6(t.get_$20())){_js.Trace.logInfo(_e.$6W.$A,"GetCalendarItem: Trying to find item with Id {0} in CalendarRecurrenceMaster table",e);h.get_$A8().get_$lc().$Fy(n,e,function(n){o=n},null)}else o=t},null)},function(){$3Xe(l,s.Id,o,u,t)},function(n){_e.$1f.$D6(n,function(n){a.$A3w(u,n,i)})})}else{this.$80=!0;this.$Jh=100;t()}},$A60:function(n,t,i,r,u,f){var e=t;_js.Trace.logInfo(_e.$6W.$A,"GetItem called for id {1}",e.Id);var o=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;var c=this,s=this,h=this;this.$BT(function(n){r.$1mO(n,_e.$1h.$5f(e.Id),function(n){o=n},null)},function(){$3Xe(s,e.Id,o,i,u)},function(n){_js.Trace.logInfo(_e.$6W.$A,"GetItem. Reporting store error {0}. id {1}",n.$3v,e.Id);h.$A3w(i,new _e.$1f(n),f)})}};_e.$PA=function(n,t){_e.$PA.initializeBase(this,[n,t])};_e.$PA.prototype={$c:null,get_$RI:function(){return"GetOwaUserConfiguration"},$7VR:function(n,t,i){var r=this,u=this;this.get_$4VF().$qg(function(u){r.$c=u;if(r.$c)r.$n(n,t,i);else{_js.Trace.logInfo(_e.$PA.$A,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}},function(n){_js.Trace.logInfo(_e.$PA.$A,"GetOwaUserconfiguration: Failed to load : {0}",n.get_$52());t(Error.create(n.get_$52()))})},$7n1:function(n,t,i){if(this.$c)n();else{_js.Trace.logInfo(_e.$PA.$A,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}}};_e.$op=function(n,t,i){_e.$op.initializeBase(this,[n,t]);_a.$4.$l(i,"syncManager");this.$4K=i;this.$30=null};_e.$op.prototype={$4K:null,$30:null,get_$RI:function(){return"GetOtherMailboxConfiguration"},$7VR:function(n,t,i){var r=this;this.$4K.$So(13,new _a.$KL,function(u){u?r.$n(n,t,i):i(301)})},$7n1:function(n,t,i){var r=this;this.get_$4VF().$13L(function(t){r.$30=t;n()},t)}};_e.$15u=function(n,t,i){_e.$15u.initializeBase(this,[n,t]);_a.$4.$l(i,"syncManager");this.$4K=i};_e.$15u.prototype={$4K:null,$Cm:null,get_$RI:function(){return"GetPeopleFilters"},$7VR:function(n,t,i){var r=this;this.$4K.$So(7,new _a.$KL,function(u){u?r.$n(n,t,i):i(301)})},$7n1:function(n,t,i){var r=this,u=this;_e.$Gm.$1am(this.get_$A8().get_$4Mo(),function(t){r.$Cm=new Array(t.length);for(var i=0;i<t.length;++i)r.$Cm[i]=t[i].get_$20();n()},function(n){t(n)})}};_e.$15w=function(n,t,i,r){_e.$15w.initializeBase(this,[n,t,i]);_a.$4.$l(r,"syncManager");this.$4K=r;this.$30=new _g.$TV;this.$30.Header=_e.$8d.$Wc};_e.$15w.prototype={$4K:null,$30:null,$3qh:!1,get_$RI:function(){return"GetPersona"},$7VR:function(n,t,i){if(this.get_$1Ss().Body.EmailAddress){i(100);return}if(this.get_$A3u().hasGALComponent){this.$3qh=!0;i(303);return}_a.$4.$l(this.get_$1Ss().Body.PersonaId,"PersonaId");_a.$4.$l(this.get_$1Ss().Body.PersonaId.Id,"PersonaId.Id");var r=this;this.$4K.$So(8,new _a.$KL,function(u){u?r.$n(function(){if(r.$30.Body.Persona)if(r.$30.Body.Persona.ADObjectId){r.$3qh=!0;i(303)}else n();else i(302)},t,i):i(301)})},$7n1:function(n,t,i){var r=this,f=this,u=this;this.$BT(function(n){var t=_e.$6H.$E(r.get_$A8());t.$Fy(n,r.get_$1Ss().Body.PersonaId,function(n){if(n){r.$30.Body.ResponseCode="NoError";r.$30.Body.ResponseClass="Success";r.$30.Body.Persona=n}else{r.$30.Body.ResponseCode="ErrorItemNotFound";r.$30.Body.ResponseClass="Error"}},null)},function(){n()},function(n){_e.$1f.$D6(n,function(n){u.$A3w(u.$30.Body,n,t)})})}};_e.$MF=function(n,t,i){this.$Fq=0;_e.$MF.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $70W(n,t,i,r){var u=this,f=this;n.$BT(function(i){n.get_$52().$3nE(i,n.get_$JM(),"HardDelete",t,null,n.get_$46A())},function(){i()},_e.$1f.$Zb(r))}_e.$MF.prototype={$80:!1,get_$RI:function(){return"MoveItem"},$7VR:function(n,t,i){if(this.get_$A3u().clientStoreItem===2){var r=this;this.$n(function(){r.$80?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$MF.$A,"ClientStoreItem.{0} was passed. Request will be sent to the server.",this.get_$A3u().clientStoreItem);i(-1)}},$7mn:function(n,t,i,r){if(this.$80){t();return}var f=this.get_$1Ss().Body.ItemIds[n];if(!_g.$1q.isInstanceOfType(f)){this.$80=!0;this.$Fq=12;t();return}var u=f;_js.Trace.logInfo(_e.$MF.$A,"Step {0} called for id {1}",n.toString(),u.Id);var e=this,o=this;$70W(this,u,function(){_js.Trace.logInfo(_e.$MF.$A,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}};_e.$e9=function(n,t,i,r){this.$$d_$2tg=Function.createDelegate(this,this.$2tg);this.$A2=-1;this.$6bu="";_e.$e9.$$(this.$$gta["_e.$e9"].TRequest,this.$$gta["_e.$e9"].TActionContext).initializeBase(this,[n,t,i]);this.$4Y4=r};_e.$e9.$$=function(n,t){var i="$e9"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$e9"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$e9.apply(this,r)};u.registerClass("_e."+i,_e.$Zh.$$(n,t));var f=_e.$e9.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$e9.prototype={$4Y4:0,$5Lm:null,$5Lk:null,$5Ll:null,get_$A5t:function(){return this.$4Y4},$7n1:function(n,t,i){this.$5Lm=n;this.$5Lk=t;this.$5Ll=i;this.$2tg()},$A5u:function(n){_a.$4.$J(n,"itemId");this.$6bu="ItemId ="+JsonParser.serialize(n)},$2tg:function(){this.$A2++;this.$A2===this.$4Y4?this.$5Lm():this.$7mn(this.$A2,this.$$d_$2tg,this.$5Lk,this.$5Ll)}};_e.$8I=function(n,t,i,r){_e.$8I.initializeBase(this,[n,t,i]);_a.$4.$l(r,"syncManager");this.$4K=r;this.$30=new _g.$Ny;this.$30.Header=_e.$8d.$Wc};function $70X(n,t,i){var r=n.get_$A8().get_$gn();var u=this;r.$Fy(t,_e.$1h.$5f(i.Id),function(u){if(!u||!u.get_$20()){_js.Trace.logWarning(_e.$8I.$A,"PerformReminderAction-Dismiss: Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction-Dismiss: Reminder item with id {0} found in client store. Dismissing it.",u.get_$1y());r.$Ht(t,u.get_$1y());_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction-Dismiss: Successfully deleted (dismissed) reminder item with id {0} from client store.",u.get_$1y());$70Z(n,t,i,u.get_$20())},null)}function $70Z(n,t,i,r){var u=this;n.get_$A8().get_$1k().$1Ih(t,_e.$1h.$5f(i.Id),function(n){if($6(n)){var u=String.format("PerformReminderAction-Dismiss: Calendar item with id {0} not found in local store. Calendar item couldn't be updated for reminder with Subject:{1}, Reminder Time: {2}, Start date:{3}, End date {4}.",i.Id,r.Subject,r.ReminderTime.toString(),r.StartDate.toString(),r.EndDate.toString());_js.Trace.logWarning(_e.$8I.$A,u);return}var t=n;t.ReminderIsSet=!1;_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction-Dismiss: Successfully updated calendar item with id {0} from client store.",t.ItemId.Id)})}function $70Y(n,t,i,r){var u=this;n.get_$A8().get_$gn().$1Ih(t,_e.$1h.$5f(i.Id),function(n){if($6(n)){_js.Trace.logWarning(_e.$8I.$A,"PerformReminderAction-Snooze: Reminder item with id {0} not found in local store",i.Id);return}var t=n;t.ReminderTime=_a.$7.$Zp(r);_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction-Snooze: Successfully updated (snooze) reminder item with id {0} from client store.",t.ItemId.Id)})}_e.$8I.prototype={$4K:null,$30:null,get_$RI:function(){return"PerformReminderAction"},$7VR:function(n,t,i){var r=this;this.$4K.$So(3,new _a.$KL,function(u){if(u)r.$n(n,t,i);else{_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction: Rejecting the call as the reminder module is not synced");i(-1)}})},$7n1:function(n,t,i){var r=this,u=this,f=this;this.$BT(function(n){for(var u=r.get_$1Ss().Body.ReminderItemActions,e=u.length,i=0;i<e;++i){var t=u[i];var f=t.ItemId;if(t.ActionType)if(t.ActionType===1){var o=_a.$7.$42(t.NewReminderTime);$70Y(r,n,f,o)}else throw Error.argument("ActionType",String.format("Reminder Action Type not supported {0}",_g.$zT.toString(t.ActionType)));else $70X(r,n,f)}},function(){_js.Trace.logInfo(_e.$8I.$A,"PerformReminderAction: Successfully performed reminder actions to local store.");u.$30.Body.ResponseCode="NoError";u.$30.Body.ResponseClass="Success";n()},function(n){_js.Trace.logError(_e.$8I.$A,"PerformReminderAction: Failed to perform reminder actions to local store.");var i=new _e.$1f(new _a.$Au(0,n.$3v));f.$A3w(f.$30.Body,i,t)})}};_e.$8d=function(){};_e.$8d.$$cctor=function(){_e.$8d.$Wc=new _g.$dF;_e.$8d.$Wc.ServerVersionInfo=new _g.$fg;_e.$8d.$Wc.ServerVersionInfo.Version="Exchange2013"};_e.$61=function(n,t){_a.$4.$J(n,"actionContext");_a.$4.$J(t.get_$A8(),"serviceCommandContext.ItemStoreGetter");_a.$4.$1G(t.get_$DM(),"serviceCommandContext.TimeZone");this.$Nq=n;this.$6Sy=t;this.$8y=t.get_$A8()};_e.$61.$$=function(n){var i="$61"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[i]){var t=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$61"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$61.apply(this,i)};t.registerClass("_e."+i);var u=_e.$61.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$A3s=function(n){_a.$4.$9n(!t.$Z5[0][n],"PerfCounter for "+n+" already exists");var r=new _a.$9p("Svc","BHits",4,!1,n);t.$Z5[0][n]=r;var i=new _a.$9p("Svc","SHits",2,!1,n);i.set_$1iB(r);t.$Z5[1][n]=i;i=new _a.$9p("Svc","FHits",2,!1,n);i.set_$1iB(r);t.$Z5[2][n]=i;i=new _a.$9p("Svc","RHits",2,!1,n);i.set_$1iB(r);t.$Z5[3][n]=i};t.$2yx=function(n,t){var i=t[n];i&&i.$13l()};t.$Z5=new Array(4);t.$$cctor=function(){for(var n=0;n<4;n++)t.$Z5[n]={}};t.$$cctor()}return _e[i]};_e.$61.prototype={$Nq:null,$6Sy:null,$2SJ:null,$2pP:null,$3gL:null,$FP:null,$8y:null,$3Kl:null,$2rk:null,get_$52:function(){this.$2SJ||(this.$2SJ=new _e.$kE(this.$8y));return this.$2SJ},get_$JM:function(){this.$2pP||(this.$2pP=new _e.$C5(this.$8y));return this.$2pP},get_$A3t:function(){this.$3gL||(this.$3gL=new _e.$AK(this.$8y));return this.$3gL},get_$A3u:function(){return this.$Nq},get_$7ic:function(){return this.$2rk},set_$7ic:function(n){this.$3Kl&&(this.$3Kl.$1sS=n);this.$2rk=n;return n},get_$4VF:function(){this.$FP||(this.$FP=new _e.$AB(this.$8y));return this.$FP},get_$A8:function(){return this.$8y},get_$46A:function(){return _g.$1U.$v},$A3v:function(n,t,i){var o=_g.$3d.$3uM(this.$Nq);this.$3Kl=OwaApplication.get_$1Su().$6Ns(this.get_$RI(),!0,o);_e.$61.$$(this.$$gta["_e.$61"].TActionContext).$2yx(this.get_$RI(),_e.$61.$$(this.$$gta["_e.$61"].TActionContext).$Z5[0]);if(this.$6Sy.get_$8C5()){var f=null;var s=_a.$6.ads(_a.$0.$EM,"OfflineInvoke_"+this.get_$RI());var u=this,r=this,e=this;this.$7VR(function(){_a.$6.are(f);var t=_a.$6.aes(_a.$0.$EM,"OfflineResponse_"+u.get_$RI());try{u.$3ih(200);n()}finally{_e.$61.$$(u.$$gta["_e.$61"].TActionContext).$2yx(u.get_$RI(),_e.$61.$$(u.$$gta["_e.$61"].TActionContext).$Z5[1]);_a.$6.aee(t)}},function(n){_a.$6.are(f);var i=_a.$6.aes(_a.$0.$EM,"OfflineResponseFailed_"+r.get_$RI());try{r.set_$7ic(n.message);r.$3ih(500);t(n)}finally{_e.$61.$$(r.$$gta["_e.$61"].TActionContext).$2yx(r.get_$RI(),_e.$61.$$(r.$$gta["_e.$61"].TActionContext).$Z5[2]);_a.$6.aee(i)}},function(n){_a.$6.are(f);var t=_a.$6.aes(_a.$0.$EM,"OfflineResponseRejected_"+e.get_$RI()+"_"+_0365f.$RR.toString(n));try{e.$6MY(n,i)}finally{_a.$6.aee(t)}});_a.$6.ade(s);f=_a.$6.ars(_a.$0.$EM,"OfflineRequest_"+this.get_$RI())}else{var h=_a.$6.ads(_a.$0.$EM,"CommandRejected_"+this.get_$RI());_js.Trace.logWarning(_a.$0.$LV,"The offline component is not ready to use yet. {0} is rejected.",this.get_$RI());this.$6MY(1,i);_a.$6.ade(h)}},$n:function(n,t,i){var r=this;this.$7n1(n,function(n){t(n.$SQ())},i)},$A3w:function(n,t,i){n.ResponseCode="ErrorDataSourceOperation";n.ResponseClass="Error";n.MessageText=t.get_$52();_js.Trace.logError(_a.$0.$LV,"Processing clientstore error '{0}' in servicecommand {1}",t.get_$52(),this.get_$RI());i(t)},$BT:function(n,t,i){this.$8y.$BT(new _a.$6j(this.get_$RI()),n,t,i)},$A3x:function(n,t,i,r){this.$8y.$BT(n,t,i,r)},$3tD:function(n){return _g.$7P.isInstanceOfType(n)?_g.$h.$1i.nameToId(n.Id):n},$3ih:function(n){_js.Trace.logInfo(_a.$0.$LV,"ServiceCommand {0} completed. Status {1}. Details {2}",this.get_$RI(),n,this.$2rk);OwaApplication.get_$1Su().$6No(this.$3Kl,n,this.$2rk,null,null,null,null)},$6MY:function(n,t){_e.$61.$$(this.$$gta["_e.$61"].TActionContext).$2yx(this.get_$RI(),_e.$61.$$(this.$$gta["_e.$61"].TActionContext).$Z5[3]);_js.Trace.logInfo(_a.$0.$LV,"Rejecting the service command '{0}' from the offline component (Reason: {1})...",this.get_$RI(),_0365f.$RR.toString(n));this.$3ih(302);this.$Nq.offlineRejectCode=n;t()}};_e.$fs=function(n,t,i){_e.$fs.initializeBase(this,[n,t]);this.$3EB=i};_e.$fs.prototype={$3EB:null,get_$RI:function(){return"SetLayoutSettings"},$7VR:function(n,t,i){this.$n(n,t,i)},$7n1:function(n,t,i){_js.Trace.logInfo(_e.$fs.$A,"SetLayoutSettings ExecuteInternal invoked.");this.get_$4VF().$1kS(this.$3EB,n)}};_e.$1Ck=function(n,t,i){_e.$1Ck.initializeBase(this,[n,t]);this.$2Wc=i};_e.$1Ck.prototype={$2Wc:null,get_$RI:function(){return"SetTimeZone"},$7VR:function(n,t,i){this.$n(n,t,i)},$7n1:function(n,t,i){this.get_$4VF().$3NU(this.$2Wc,n)}};_e.$71=function(n,t,i){this.$Fq=0;_e.$71.initializeBase(this,[n,t,i,i.Body.ItemChanges.length]);this.$9G=new Array(this.get_$A5t());this.$30=new _g.$SM;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G};function $71G(n,t,i,r){r.val=0;if(t.IsMeeting){r.val=6;return!0}else if(t.CalendarItemType==="RecurringMaster"){r.val=7;return!0}for(var u=0;u<i.length;u++)if(i[u].Path.__type===_g.$1X._dataContractName){var f=i[u].Path;switch(f.FieldURI){case"RequiredAttendees":case"OptionalAttendees":case"Resources":r.val=9;return!0;case"Recurrence":r.val=t.CalendarItemType==="Single"?2:8;return!0}}return!1}function $71I(n,t,i,r,u){var e=!1;r.val=i.StartWallClock;u.val=i.EndWallClock;for(var f=0;f<t.length;f++)if(t[f].__type===_g.$6z._dataContractName&&t[f].Item.__type===_g.$6O._dataContractName&&t[f].Path.__type===_g.$1X._dataContractName){var o=t[f].Item;var s=t[f].Path;switch(s.FieldURI){case"Start":r.val=o.Start;e=!0;break;case"End":u.val=o.End;e=!0;break}}return e}function $71L(n,t,i){for(var r=0;r<i.length;r++)if(i[r].__type===_g.$6z._dataContractName)$71J(n,t,i[r]);else if(i[r].__type===_g.$Ee._dataContractName)$71H(n,t,i[r]);else break;t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception")}function $71J(n,t,i){var u=null;if(i.Path.__type===_g.$1X._dataContractName)u=i.Path;else if(i.Path.__type===_g.$CN._dataContractName){var e=i.Item.ExtendedProperty;if(!e){_js.Trace.logWarning(_e.$71.$A,"UpdateCalendarItem-SetCalendarItemProperty: ignoring null extended properties.");return}for(var o=e,s=o.length,f=0;f<s;++f){var h=o[f];_e.$3w.$1kQ(t,h)}return}else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));var r=null;if(i.Item.__type===_g.$6O._dataContractName)r=i.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property update item type {0} is not supported.",Object.getType(i.Item).getName()));switch(u.FieldURI){case"Subject":t.Subject=r.Subject;break;case"Body":t.Body=r.Body;_e.$AK.$4O8(t);break;case"IsAllDayEvent":t.IsAllDayEvent=r.IsAllDayEvent;break;case"StartTimeZone":t.StartTimeZoneId=r.StartTimeZone.Id;break;case"Start":t.Start=r.Start;t.StartWallClock=r.Start;break;case"EndTimeZone":t.EndTimeZoneId=r.EndTimeZone.Id;break;case"End":t.End=r.End;t.EndWallClock=r.End;break;case"LegacyFreeBusyStatus":t.FreeBusyType=r.FreeBusyType;break;case"ReminderIsSet":t.ReminderIsSet=r.ReminderIsSet;break;case"ReminderMinutesBeforeStart":t.ReminderMinutesBeforeStart=r.ReminderMinutesBeforeStart;break;case"Sensitivity":t.Sensitivity=r.Sensitivity;break;case"Location":case"EnhancedLocation":t.Location=r.Location;break;case"Categories":t.Categories=r.Categories;break;case"InboxReminders":t.InboxReminders=r.InboxReminders;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-SetProperty: Field uri {0} is not supported.",u.FieldURI));}}function $71H(n,t,i){var r=null;if(i.Path.__type===_g.$1X._dataContractName)r=i.Path;else throw Error.argument(String.format("UpdateCalendarItem-DeleteProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));switch(r.FieldURI){case"Location":case"EnhancedLocation":t.Location=null;break;case"InboxReminders":t.InboxReminders=null;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-DeleteProperty: Field uri {0} is not supported.",r.FieldURI));}}function $71M(n,t,i,r){var u=_e.$1h.$5f(i.ItemId.Id);var f=n.get_$A8().get_$gn();if(i.ReminderIsSet){var e=this;f.$1Ih(t,u,function(f){if($6(f)){_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Reminder is set but no reminder with id {0} was found in local store. Creating a reminder.",i.ItemId.Id);n.get_$A3t().$4Sc(t,i,i.ItemId,function(n){_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Reminder with id {0} created successfuly.",n)})}else{_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Reminder with id {0} found. Updating properties.",u);var e=f;$71N(n,e,i,r)}})}else{_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Reminder not set on calendar item with id {0}. Deleting reminder if one exist.",i.ItemId.Id);f.$Ht(t,u)}}function $71N(n,t,i,r){for(var u=0;u<r.length;u++)r[u].__type===_g.$6z._dataContractName?$71K(n,t,i,r[u]):_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Property update type {0} is not handled for reminders.",Object.getType(r[u]).getName())}function $71K(n,t,i,r){var f=null;if(r.Path.__type===_g.$1X._dataContractName)f=r.Path;else if(r.Path.__type===_g.$CN._dataContractName){_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem-SetReminderItemProperty: ExtendedPropertyUri is not handled for reminders.");return}else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property path type {0} is not supported.",Object.getType(r.Path).getName()));var u=null;if(r.Item.__type===_g.$6O._dataContractName)u=r.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property update item type {0} is not supported.",Object.getType(r.Item).getName()));switch(f.FieldURI){case"Subject":t.Subject=u.Subject;break;case"Start":var e=_a.$7.$42(u.Start);t.StartDate=u.Start;t.ReminderTime=_a.$7.$Zp(e.$BX(-i.ReminderMinutesBeforeStart));break;case"ReminderMinutesBeforeStart":var o=_a.$7.$42(t.StartDate);t.ReminderTime=_a.$7.$Zp(o.$BX(-i.ReminderMinutesBeforeStart));break;case"End":t.EndDate=u.End;break;case"EnhancedLocation":t.Location=u.Location?u.Location.DisplayName:null;break;default:_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem-SetReminderItemProperty: Field uri {0} is not handled for reminders.",f.FieldURI);break}}_e.$71.prototype={$30:null,$9G:null,$80:!1,get_$RI:function(){return"UpdateCalendarItem"},$7VR:function(n,t,i){if(this.get_$A3u().clientStoreItem===1){var r=this;this.$n(function(){if(r.$80){_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: Call rejected by updated calendar item service command. The call should be forwarded to online proxy.");i(-1)}else n()},t,i)}else throw Error.argument("ClientStoreItem",String.format("ClientStoreItem {0} is not supported.",this.get_$A3u().clientStoreItem));},$7mn:function(n,t,i,r){if(this.$80){t();return}var o=this.get_$1Ss().Body.ItemChanges[n];var u=o.ItemId;_js.Trace.logInfo(_e.$71.$A,"Step {0} called for id {1}",n.toString(),u.Id);var e=new _g.$Ys;e.ResponseCode="NoError";e.ResponseClass="Success";e.Items=[new _g.$7k];e.Items[0].ItemId=u;this.$9G[n]=e;var f=this,s=this,h=this;this.$BT(function(n){if(f.get_$A3u().isReferencedItemRecurring)if(u.__type===_g.$7U._dataContractName){_js.Trace.logInfo(_e.$71.$A,"UpdateCalendarItem: RecurringMasterItemId isn't supported on offline updateitem service command. Rejecting call.");f.$80=!0}else f.$A6D(_bc.$Kp,n,u,o.Updates,f.get_$A8().get_$lc());else f.$A6D(_bc.$Lt,n,u,o.Updates,f.get_$A8().get_$1k())},function(){_js.Trace.logInfo(_e.$71.$A,"Successfully updated calendar item with server id {0} in local store.",u.Id);t()},function(n){_js.Trace.logError(_e.$71.$A,"Failed to updated calendar item with server id {0} in local store. Error: {1}.",u.Id,n.$3v);i(new _e.$1f(new _a.$Au(0,n.$3v)))})},$A6D:function(n,t,i,r,u){var f=this;u.$Fy(t,_e.$1h.$5f(i.Id),function(u){if($6(u)){_js.Trace.logWarning(_e.$71.$A,"UpdateCalendarItem: Calendar item (type: '{0}') with id {1} was not found in local store",n.getName(),i.Id);f.$80=!0}else{var e,o;var s,h,c;(c=$71I(f,r,u.get_$20(),s={val:e},h={val:o}),e=s.val,o=h.val,c)?f.get_$A3t().$8An(t,e,o,function(){f.$A6E(n,t,u,r)},function(){f.$80=!0;f.$Fq=11}):f.$A6E(n,t,u,r)}},null)},$A6E:function(n,t,i,r){var u;var f=i.get_$20();var e,o;if(o=$71G(this,f,r,e={val:u}),u=e.val,o){this.$80=!0;this.$Fq=u}else{$71L(this,f,r);$71M(this,t,f,r);i.$E7(t,null)}}};_e.$3w=function(n,t,i){_e.$3w.initializeBase(this,[n,t,i,i.Body.ItemChanges.length,_e.$3w.$A]);this.$9G=new Array(this.get_$A5t());this.$30=new _g.$SM;this.$30.Header=_e.$8d.$Wc;this.$30.Body.ResponseMessages=new _g.$Fk;this.$30.Body.ResponseMessages.Items=this.$9G;this.get_$A3u().itemIds=new Array(i.Body.ItemChanges.length)};_e.$3w.$Rw=function(n,t,i){var r=new _g.$Cq;r.ExtendedFieldURI=t;r.Value=i;_e.$3w.$1kQ(n,r)};_e.$3w.$1kQ=function(n,t){if($6(n.ExtendedProperty)){n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}else{for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}};function $71T(n,t,i,r,u,f){_js.Trace.logInfo(_e.$3w.$A,"Opening a transaction to update a MessageItem. {0}",n.$6bu);var e=this,o=this,s=this;n.$A3x(new _a.$6j("UpdateItem.UpdateMessageItem",!1),function(r){_js.Trace.logInfo(_e.$3w.$A,"Getting a MessageItem for update. {0}",n.$6bu);n.get_$A8().get_$52().$1Ih(r,_e.$1h.$5f(i.Id),function(u){if($6(u)){_js.Trace.logWarning(_e.$3w.$A,"Message with id {0} was not found in client store. {1}",i.Id,n.$6bu);return}_js.Trace.logInfo(_e.$3w.$A,"MessageItem retrieved for update. {0}",n.$6bu);$4pW(n,r,u,t.Updates);var f=u;$6(n.get_$A3u().bodySubstring)||_e.$17.$4Uq(f,null,n.get_$A3u().bodySubstring);_js.Trace.logInfo(_e.$3w.$A,"Message with updates going to client store via update ItemId={0}; Subject{1}. {2}",JsonParser.serialize(f.ItemId),f.Subject,n.$6bu)})},function(){_js.Trace.logInfo(_e.$3w.$A,"Successfully updated message in local store. {0}",n.$6bu);u()},function(t){_js.Trace.logInfo(_e.$3w.$A,"Reporting store error {0}. {1}",t.$3v,n.$6bu);n.$A3w(n.$9G[r],new _e.$1f(t),f)})}function $4pW(n,t,i,r){$4pU(n,t,i,r);var u=i;n.get_$A3u().isUpdatingRightsManagementLicenseData&&(u.RightsManagementLicenseData=n.get_$A3u().rightsManagementLicenseData);u.LastModifiedTime=_a.$7.$EZ(_a.$7.get_$29())}function $71P(n,t,i,r,u,f){_a.$4.$J(n.get_$A3u().outboxFolderId,"OutboxFolderId");var o=!!u;var e;if(o)e=_0365f.$58.$3p(u.get_$20());else{_js.Trace.logInfo(_e.$3w.$A,"Message with id {0} not found in local store",t.Id);e=new _g.$9n}$4pV(n,e,t,n.get_$A3u().outboxFolderId,!1,o);e.ItemId=_bc.OutboxItemContext.$5Da(e.ItemId,_e.$3w.$A);n.get_$A3u().itemIds[r]=e.ItemId;$4pU(n,f,e,i.Updates);return n.get_$A8().get_$gd().$qa(e)}function $4pV(n,t,i,r,u,f){if(!f){t.DateTimeCreated=_a.$7.$EZ(_a.$7.get_$29());t.DateTimeReceived||(t.DateTimeReceived=t.DateTimeCreated);t.ItemId=new _g.$1q(i.Id);t.ItemId.ChangeKey=i.ChangeKey;t.InstanceKey=(new _bc.$Bd).get_$Ea()}t.ParentFolderId=r;_e.$17.$4Uq(t,null,n.get_$A3u().bodySubstring);t.IsDraft=u;n.get_$A3u().isUpdatingRightsManagementLicenseData&&(t.RightsManagementLicenseData=n.get_$A3u().rightsManagementLicenseData);n.get_$A3u().conversationId&&(t.ConversationId=n.get_$A3u().conversationId)}function $4pU(n,t,i,r){for(var u=i,o=0;o<r.length;o++){var s=r[o];if(s&&s.__type===_g.$Ee._dataContractName){var a=s.Path;if("From"===a.FieldURI){u.From=null;continue}else{var c=s.Path;if(c.DistinguishedPropertySetId==="Sharing"&&c.PropertyId===35356)continue}}var h=r[o];var l=h.Path;var f=h.Item;if(!l||!f)break;switch(l.FieldURI){case"BccRecipients":u.BccRecipients=f.BccRecipients;break;case"Body":u.Body=f.Body.BodyType==="HTML"?new _g.$6R(n.get_$A3u().isTextBodyValue?"Text":f.Body.BodyType,n.get_$A3u().clientStoreBodyValue):f.Body;(u.__type===_g.$Gr._dataContractName||u.__type===_g.$Hh._dataContractName||u.__type===_g.$HK._dataContractName)&&(u.__type=_g.$9n._dataContractName);break;case"CcRecipients":u.CcRecipients=f.CcRecipients;break;case"Importance":u.Importance=f.Importance;break;case"Subject":u.Subject=f.Subject;break;case"From":u.From=f.From;break;case"ToRecipients":u.ToRecipients=f.ToRecipients;u.DisplayTo=n.$A6C(f.ToRecipients);break;case"IsRead":$71S(n,t,u,f.IsRead);break;case"Flag":$71Q(n,t,u,f.Flag);break;case"ItemPolicyTag":u.PolicyTag=f.PolicyTag;break;case"ItemArchiveTag":u.ArchiveTag=f.ArchiveTag;break;case"Sensitivity":u.Sensitivity=f.Sensitivity;break;case"IsDeliveryReceiptRequested":u.IsDeliveryReceiptRequested=f.IsDeliveryReceiptRequested;break;case"IsReadReceiptRequested":u.IsReadReceiptRequested=f.IsReadReceiptRequested;break;case"IsClutter":$71R(n,t,u,f.IsClutter);break;case"ItemClass":u.ItemClass=f.ItemClass;break;case"QuickCaptureReminders":u.QuickCaptureReminders=f.QuickCaptureReminders;break;case"MimeContent":u.MimeContent=f.MimeContent;break;default:var e=h.Path;if(e.DistinguishedPropertySetId==="Sharing"&&e.PropertyId===35356)continue;if(e.DistinguishedPropertySetId==="Common")if(e.PropertyId===34229){_e.$3w.$Rw(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34232){_e.$3w.$Rw(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34230){_e.$3w.$Rw(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34231){_e.$3w.$Rw(u,e,f.ExtendedProperty[0].Value);break}if(e.DistinguishedPropertySetId==="InternetHeaders"&&(e.PropertyName==="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification"||e.PropertyName==="X-Ms-Exchange-Organization-Dlp-FalsePositive"))break;if(e.DistinguishedPropertySetId==="PublicStrings"&&e.PropertyName.startsWith("cecp-")){_e.$3w.$Rw(u,e,f.ExtendedProperty[0].Value);break}break}}}function $71R(n,t,i,r){if(i.IsClutter!==r){i.IsClutter=r;if(i.ConversationId&&i.ConversationId.Id){var u=_e.$E9.$13B(i.ParentFolderId,i.ConversationId);var f=this;n.get_$A8().get_$JM().$Fy(t,u,function(n){if(n){for(var u=n.get_$20(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e&&(!r||!u.HasClutter)){u.HasClutter=r;n.$E7(t,null)}}},null)}}}function $71S(n,t,i,r){if(i.IsRead!==r){i.IsRead=r;var u=this;n.get_$A8().get_$2x().$Fy(t,_e.$1h.$5f(i.ParentFolderId.Id),function(u){if(u){var f=u.get_$20();r&&f.UnreadCount>0?f.UnreadCount--:r||f.UnreadCount++;u.$E7(t,null);if(i.ConversationId&&i.ConversationId.Id){var e=_e.$E9.$13B(i.ParentFolderId,i.ConversationId);n.get_$A8().get_$JM().$Fy(t,e,function(n){if(n){for(var u=n.get_$20(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e){r&&u.UnreadCount>0?u.UnreadCount--:r||u.UnreadCount++;n.$E7(t,null)}}},null)}}},null)}}function $71Q(n,t,i,r){_a.$4.$ou(n.get_$A3u().flag,null,"UpdateItemContext.Flag can't be null when Flag is being updated.");_a.$4.$Js(n.get_$A3u().flag.FlagStatus,r.FlagStatus,"UpdateItemContext.Flag.FlagStatus should match the FlagStatus in SetItemPropertyUpdate.");i.Flag=n.get_$A3u().flag;if(i.ConversationId){var u=_e.$E9.$13B(i.ParentFolderId,i.ConversationId);var f=this;n.get_$A8().get_$JM().$Fy(t,u,function(u){if(u)if(n.get_$A3u().isFlagConversation){u.get_$20().FlagStatus=n.get_$A3u().flag.FlagStatus;u.$E7(t,null)}else $71O(n,t,i,r.FlagStatus,u)},null)}}function $71O(n,t,i,r,u){for(var f=u.get_$20(),o=[],s=!1,e=0;e<f.ItemIds.length;e++)f.ItemIds[e].Id===i.ItemId.Id?s=!0:Array.add(o,_e.$1h.$5f(f.ItemIds[e].Id));if(s){var h=f.FlagStatus;if(r>=h||!o.length){f.FlagStatus=r;u.$E7(t,null);return}var c=this,l=this;n.get_$A8().get_$52().$7SO(t,o,function(n){for(var i=0;i<n.length;i++){n[i].get_$20().Flag.FlagStatus>r&&(r=n[i].get_$20().Flag.FlagStatus);if(r==="Flagged"){f.FlagStatus=r;u.$E7(t,null);break}}f.FlagStatus=r;u.$E7(t,null)},function(n){_js.Trace.logError(_e.$3w.$A,"Error binding to messages in conversation with id {0}, Error {1}",f.ConversationId.Id,n.get_$52())})}}_e.$3w.prototype={$30:null,$9G:null,get_$RI:function(){return"UpdateItem"},$6Tz:function(n,t){_e.$HX.$6T8(this.get_$A8().get_$gd(),n,t,_e.$3w.$A)},$7xo:function(){return _e.$YY.$7cn(this.get_$A3u())},$7x7:function(){return this.get_$1Ss().Body.ComplianceId},$7xk:function(){return 1},$7VR:function(n,t,i){this.$n(n,t,i)},$7n1:function(n,t,i){var r=this;_e.$e9.prototype.$7n1.call(this,function(){r.get_$A3u().clientStoreBodyValue=null;n()},t,i)},$7mn:function(n,t,i,r){var e=this.get_$1Ss().Body.ItemChanges[n];var u=e.ItemId;this.$A5u(u);_js.Trace.logInfo(_e.$3w.$A,"ExecuteCurrentStep called for step={0}. {1}",n.toString(),this.$6bu);var f=new _g.$Ys;f.ResponseCode="NoError";f.ResponseClass="Success";if(this.get_$1Ss().Body.MessageDisposition==="SaveOnly"){f.Items=[new _g.$7k];f.Items[0].ItemId=u}this.$9G[n]=f;if(!this.get_$A3u().clientStoreItem){_js.Trace.logInfo(_e.$3w.$A,"ClientStoreItem.None was passed. Request will be sent to the server. {0}",this.$6bu);t();return}if(this.get_$A3u().clientStoreItem===2)if(this.get_$1Ss().Body.MessageDisposition==="SendAndSaveCopy"){_js.Trace.logInfo(_e.$3w.$A,"Moving Draft item to Outbox. {0}",this.$6bu);var s=this;this.$A6A(u,function(t,i){return $71P(s,u,e,n,t,i)},f,t,i)}else if(this.get_$A3u().outboxItemId){_js.Trace.logInfo(_e.$3w.$A,"Moving Outbox item back to Drafts. {0}",this.$6bu);var o=this;this.$A6B(function(n){var t=new _g.$9n;$4pV(o,t,u,o.get_$A3u().parentFolderId,!0,!1);var i=o.get_$A8().get_$52().$qa(t);$4pW(o,n,i.get_$20(),e.Updates);return i},!1,this.$9G[n],t,i)}else{_js.Trace.logInfo(_e.$3w.$A,"Updating MessageItem. {0}",this.$6bu);$71T(this,e,u,n,t,i)}else{_js.Trace.logWarning(_e.$3w.$A,"ClientStoreItem is not supported. ClientStoreItem={0}. {1}",this.get_$A3u().clientStoreItem,this.$6bu);t()}}};_e.$1F1=function(n,t,i,r,u){_e.$1F1.initializeBase(this,[n,t,r,u]);_a.$4.$l(i,"personaId");_a.$4.$1G(i.Id,"personaId.Id");this.$CR=i};_e.$1F1.prototype={$CR:null,get_$RI:function(){return"UpdatePersona"},$7VR:function(n,t,i){if(this.get_$A5a()===_e.$K.$3oC){i(-1);return}this.$n(n,t,i)},$7n1:function(n,t,i){var r=this,u=this,f=this;this.$BT(function(n){var t=_e.$6H.$E(r.get_$A8());t.$Fy(n,r.$CR,function(i){if(!$6(i)){_e.$K.$55x(i,r.get_$A5Z());t.$5PE(n,i,function(){t.$tl(n,i,0,null)})}r.set_$1s(i)},null)},function(){n()},function(n){_e.$1f.$D6(n,t)})}};_e.$TW=function(n,t,i,r){_e.$TW.initializeBase(this,[n,t,i]);_a.$4.$l(r,"syncManager");this.$4K=r;this.$30=new _g.$NJ;this.$30.Header=_e.$8d.$Wc};function $700(n){return n.get_$1Ss().Body.ReminderType===1||n.get_$1Ss().Body.ReminderType===2||n.get_$1Ss().Body.ReminderType===3?!1:!0}_e.$TW.prototype={$30:null,$4K:null,get_$RI:function(){return"GetReminders"},$7VR:function(n,t,i){if($700(this)){var r=this;this.$So(3,new _a.$KL,function(u){if(u)r.$n(n,t,i);else{_js.Trace.logInfo(_e.$TW.$A,"Rejecting the call as the reminderm module is not synced");i(301)}})}else i(100)},$7n1:function(n,t,i){var r=this,u=this;_e.$Aa.$wc(this.get_$A8().get_$gn(),this.get_$1Ss().Body.MaxItems,this.get_$1Ss().Body.BeginTime,this.get_$1Ss().Body.EndTime,function(t){r.$30.Body.ResponseCode="NoError";r.$30.Body.ResponseClass="Success";r.$30.Body.Reminders=new Array(t.length);for(var i=0;i<t.length;++i){var u=t[i].get_$20();r.$30.Body.Reminders[i]=u}n()},function(n){u.$30.Body.ResponseCode="ErrorDataSourceOperation";u.$30.Body.ResponseClass="Error";u.$30.Body.MessageText=n.get_$52();t(n)})},$So:function(n,t,i){this.$4K.$So(n,t,i)}};_e.$tD=function(n,t,i){this.$$d_$A1L=Function.createDelegate(this,this.$A1L);_e.$tD.initializeBase(this,[n,t,i])};_e.$tD.prototype={get_$RI:function(){return"UpdateViewStateConfiguration"},$7VR:function(n,t,i){this.$n(n,t,i)},$7n1:function(n,t,i){this.get_$4VF().$9k9(this.$$d_$A1L,n,t)},$A1L:function(n){for(var r=this.get_$1Ss().Body.UserConfiguration.Dictionary,u=r.length,i=0;i<u;++i){var t=r[i];switch(t.DictionaryKey.Value[0]){case"CalendarViewTypeNarrow":n.CalendarViewTypeNarrow=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeWide":n.CalendarViewTypeWide=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeDesktop":n.CalendarViewTypeDesktop=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarSidePanelIsExpanded":n.CalendarSidePanelIsExpanded=Boolean.parse(t.DictionaryValue.Value[0]);break;case"FolderViewState":n.FolderViewState=t.DictionaryValue.Value;break;case"SchedulingViewType":n.SchedulingViewType=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SchedulingLastUsedRoomListName":n.SchedulingLastUsedRoomListName=t.DictionaryValue.Value[0];break;case"SchedulingLastUsedRoomListEmailAddress":n.SchedulingLastUsedRoomListEmailAddress=t.DictionaryValue.Value[0];break;case"SearchHistory":n.SearchHistory=t.DictionaryValue.Value;break;case"CalendarSidePanelMonthPickerCount":n.CalendarSidePanelMonthPickerCount=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SelectedCalendarsDesktop":n.SelectedCalendarsDesktop=t.DictionaryValue.Value;break;case"SelectedCalendarsTWide":n.SelectedCalendarsTWide=t.DictionaryValue.Value;break;case"SelectedCalendarsTNarrow":n.SelectedCalendarsTNarrow=t.DictionaryValue.Value;break;case"AttachmentsFilePickerViewTypeMouse":n.AttachmentsFilePickerViewTypeForMouse=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"AttachmentsFilePickerViewTypeTouch":n.AttachmentsFilePickerViewTypeForTouch=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"BookmarkedWeatherLocations":n.BookmarkedWeatherLocations=t.DictionaryValue.Value;break;case"CurrentWeatherLocationBookmarkIndex":n.CurrentWeatherLocationBookmarkIndex=Number.parseInvariant(t.DictionaryValue.Value[0]);break}}}};_e.$AK=function(n){_e.$AK.initializeBase(this,[n])};_e.$AK.$4O8=function(n){if(n.Body&&n.Body.Value)if(n.Body.BodyType==="Text"){n.TextBody=n.Body;var f=_a.$1b.$1Af(n.TextBody.Value);n.Body=new _g.$6R("HTML",f);_js.Trace.logInfo(_a.$0.$6y,"Created Body from TextBody for new created item with client id {0}",n.ItemId.Id)}else{var i=_a.$1b.$7nc(n.Body.Value);i||(i=n.Body.Value);var t=null;var r,u;if(u=_a.$1b.$7aD(i,r={val:t}),t=r.val,u)_js.Trace.logInfo(_a.$0.$6y,"Created TextBody from body for new created item with client id {0}",n.ItemId.Id);else{_js.Trace.logWarning(_a.$0.$6y,"HTML body couldn't be converted to TEXT for item with client id {0}. Setting Text body to empty.",n.ItemId.Id);t=""}n.TextBody=new _g.$6R("Text",t)}};function $4oW(n,t,i,r,u,f){if($6(t)){_js.Trace.logWarning(_e.$AK.$A,"No calendar sync state was found. Considering item outside sync range.");f();return}var e=t.get_$20();if(!e.IsSynced){_js.Trace.logInfo(_e.$AK.$A,"Calendar isn't synced. Considering item outside sync range.");f();return}var o=_a.$7.$42(i);var s=_a.$7.$42(r);var h=_a.$7.$42(e.WindowStart);var c=_a.$7.$42(e.WindowEnd);s.$2R(h)<0||o.$2R(c)>0?f():u()}function $6yR(n,t,i){var r=n.$8y.get_$gn();var u=this;r.$Fy(t,i,function(n){if(!n||!n.get_$20()){_js.Trace.logWarning(_e.$AK.$A,"Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$AK.$A,"Reminder item with id {0} found in client store. Deleting it.",n.get_$1y());r.$Ht(t,i);_js.Trace.logInfo(_e.$AK.$A,"Successfully deleted reminder item with id {0} from client store.",n.get_$1y())},null)}_e.$AK.prototype={$4Sc:function(n,t,i,r){var f=_a.$7.$42(t.Start);var e=_a.$7.$Zp(f.$BX(-t.ReminderMinutesBeforeStart));var u=new _g.$O8(t.Subject,e,t.Start,t.End,i,t.UID);t.Location&&(u.Location=t.Location.DisplayName);var o=this.$8y.get_$gn().$qa(u);o.$E7(n,r)},$3n0:function(n,t,i){var r=this.$8y.get_$1k();if(i.CalendarItemType==="RecurringMaster"){_js.Trace.logInfo(_e.$AK.$A,"Item {0} is a recurring master. Deleteting occurrences/exceptions and master",t);var u=_e.$a0.$8A(this.$8y);var e=this;u.$5I9(n,t,function(){});var f=new _a.$8k(_e.$Aa.$18d,i.UID);var o=this;this.$8y.get_$gn().$1s9(n,f,function(){});this.$8y.get_$lc().$Ht(n,t)}else{r.$Ht(n,t);$6yR(this,n,t)}},$8Am:function(n,t,i,r){var u=new _e.$mA(this.$8y.get_$oo(),"CalendarSyncState");var f=this,e=this;u.$2M6(function(u){$4oW(f,u,n,t,i,r)},function(n){r()})},$8An:function(n,t,i,r,u){var f=new _e.$mA(this.$8y.get_$oo(),"CalendarSyncState");var e=this;f.$5Sd(n,function(n){$4oW(e,n,t,i,r,u)})},$5RO:function(n,t,i,r){var u=this;this.$8y.get_$1k().$Fy(n,_e.$1h.$5f(t.OccurrenceId),function(n){if(!n||!n.get_$20()){_js.Trace.logWarning(_e.$AK.$A,"Occurrence item with id {0} could no be found in client store.",t.OccurrenceId);r();return}_js.Trace.logInfo(_e.$AK.$A,"Occurrence item with id {0} found in client store. Master Uid is {1}.",n.get_$1y(),n.get_$18c());i(n.get_$18c())},null)}};_e.$C5=function(n){_e.$C5.initializeBase(this,[n])};function $6zA(n,t,i,r,u,f,e){var o=this;n.$8y.get_$HP().$Fy(t,_e.$1h.$5f(i.Id),function(i){if(!i){_js.Trace.logInfo(_e.$1n.$A,"ConversationNodeItem not found in the clientstore. Hence, not adding the itempart");e(!1);return}var o=i.get_$20();var h=(new _bc.$Bd).$5N.Id;var s=new _g.$Sy(h);s.ParentInternetMessageId=u;var c=_e.$Oo.$5F4(r);s.Items=[c];f?Array.insert(o.ConversationNodes,0,s):Array.add(o.ConversationNodes,s);o.LastModifiedTime=$2hq(n,o.LastModifiedTime);i.$E7(t,null);_js.Trace.logInfo(_e.$1n.$A,"Successfully updated and saved the conversationNodeItem");e(!0)},null)}function $6zB(n,t,i,r,u,f){var e=this;n.$8y.get_$HP().$Fy(t,_e.$1h.$5f(i.Id),function(e){if(!e){_js.Trace.logInfo(_e.$1n.$A,"ConversationNodeItem not found in the clientstore. Hence, not removing the itempart");f(null);return}for(var o=e.get_$20(),a=null,l=!1,c=0;c<o.ConversationNodes.length;c++){var s=o.ConversationNodes[c];if(s.Items.length===1&&$2hp(n,s.Items[0].ItemId,r.ItemId,u)){a=s.ParentInternetMessageId;_js.Trace.logInfo(_e.$1n.$A,"Removing the whole ConversationNode at index {0}",c);Array.removeAt(o.ConversationNodes,c);l=!0;break}else for(var h=0,h=0;h<s.Items.length;h++){var v=s.Items[h];if($2hp(n,v.ItemId,r.ItemId,u)){_js.Trace.logInfo(_e.$1n.$A,"Removing the item at index {0}",h);Array.removeAt(s.Items,h);l=!0;break}}if(l)break}if(l){o.LastModifiedTime=$2hq(n,o.LastModifiedTime);if(o.ConversationNodes.length){e.$E7(t,null);_js.Trace.logInfo(_e.$1n.$A,"Successfully removed item from the conversationNode")}f(a)}else{_js.Trace.logInfo(_e.$1n.$A,"ItemId {0} not removed from conversationNode with id {0}",r.ItemId.Id,i.Id);f(null)}},null)}function $6zC(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1n.$A,"Update metadata properties for all conversations with id {0} for addition. The itempart added has id {1}",i,r.ItemId.Id);var e=this;_e.$6n.$3sr(t,n.$8y.get_$JM(),i,function(i){for(var c=i,y=c.length,s=0;s<y;++s){for(var l=c[s],u=l.get_$20(),a=u.GlobalItemIds,p=a.length,h=0;h<p;++h){var w=a[h];if($2hp(n,w,r.ItemId,f))throw Error.invalidOperation(String.format("itempart is already a part of the conversation, id = {0}, GlobalItemIds = [{1}]",r.ItemId.Id,u.GlobalItemIds.join(",")));}var e=new _g.$1q(r.ItemId.Id);e.ChangeKey=r.ItemId.ChangeKey;Array.add(u.GlobalItemIds,e);if(r.IsDraft&&!r.IsSubmitted)if(u.DraftItemIds){for(var v=!1,o=0;o<u.DraftItemIds.length;o++)if(u.DraftItemIds[o].Id===e.Id){v=!0;u.DraftItemIds[o]=e;break}v||Array.add(u.DraftItemIds,e)}else u.DraftItemIds=[e];u.GlobalMessageCount++;u.LastModifiedTime=$2hq(n,u.LastModifiedTime);l.$E7(t,null)}})}function $6zD(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1n.$A,"Update metadata properties for all conversations with id {0} for remove. The itempart removed has id {1}",i,u.ItemId.Id);var e=this;_e.$6n.$3sr(t,n.$8y.get_$JM(),i,function(i){for(var a=i,p=a.length,c=0;c<p;++c){for(var l=a[c],e=l.get_$20(),v=!1,o=0;o<e.GlobalItemIds.length;o++){var y=e.GlobalItemIds[o];if(y.Id===u.ItemId.Id){Array.removeAt(e.GlobalItemIds,o);if(e.DraftItemIds)for(var s=0;s<e.DraftItemIds.length;s++)e.DraftItemIds[s].Id===y.Id&&Array.removeAt(e.DraftItemIds,s);v=!0}}if(v){if(e.GlobalMessageCount<=0)throw Error.invalidOperation("conversation.GlobalMessageCount "+e.GlobalMessageCount+" is less than or equal to 0");e.GlobalMessageCount--;if(!$6(u.IsRead)&&!u.IsRead){if(e.GlobalUnreadCount<=0)throw Error.invalidOperation("conversation.GlobalUnreadCount "+e.GlobalUnreadCount+" is less than or equal to 0");e.GlobalUnreadCount--}if(e.MessageCount<=0)throw Error.invalidOperation("conversation.MessageCount "+e.MessageCount+" is less than or equal to 0");if(e.FolderId.Id===r.Id){e.MessageCount--;if(!$6(u.IsRead)&&!u.IsRead){if(e.UnreadCount<=0)throw Error.invalidOperation("conversation.UnreadCount "+e.UnreadCount+" is less than or equal to 0");e.UnreadCount--}for(var h=0;h<e.ItemIds.length;h++)$2hp(n,e.ItemIds[h],u.ItemId,f)&&Array.removeAt(e.ItemIds,h)}e.LastModifiedTime=$2hq(n,e.LastModifiedTime);if(e.ItemIds.length){l.$E7(t,null);_js.Trace.logInfo(_e.$1n.$A,"Saved the updated conversation object")}else{e.MessageCount&&_js.Trace.logWarning(_e.$1n.$A,"ConversationHelper.UpdateConversationMetadataForRemove, Conversation.ItemIds.length == 0 but conversation MessageCount = {0}",e.MessageCount);l.$2Iu(t);_js.Trace.logInfo(_e.$1n.$A,"Last itemPart for this folder in this conversation, hence deleted the listView entry for this conversation")}}else _js.Trace.logInfo(_e.$1n.$A,"ItemPart not found in the GlobalItemIds list, conversation JSON = {0}",JsonParser.serialize(e))}})}function $2hp(n,t,i,r){return t.Id===i.Id||t.Id===r.$qi(i).Id||r.$qi(t).Id===i.Id}function $2hq(n,t){return _a.$7.$42(t).$9K(1).$99()}_e.$C5.prototype={$53r:function(n,t,i,r,u,f,e){_a.$4.$J(n,"tx");_a.$4.$J(t,"conversationId");_a.$4.$J(i,"itemPartToAdd");_a.$4.$1G(r,"parentConversationNodeId");_a.$4.$J(f,"mailboxDataContext");_a.$4.$J(e,"successCallback");_js.Trace.logInfo(_e.$1n.$A,"Adding itemPart with id {0} to conversation with id {1}",i.ItemId.Id,t.Id);var o=this;$6zA(this,n,t,i,r,u,function(u){if(!u){_js.Trace.logInfo(_e.$1n.$A,"ConversationNode not found in the clientstore. Hence, not updating conversation metadata properties also");e(!1);return}$6zC(o,n,t,i,r,f);if(i.ConversationId&&i.ConversationId!==t)throw Error.invalidOperation(String.format("The itemPartToAdd already has a different conversationId. conversationId = {0}, itemPartToAdd.ConversationId = {1}",t.Id,i.ConversationId.Id));else i.ConversationId=t;_js.Trace.logInfo(_e.$1n.$A,"Successfully added itempart to the conversation");e(!0)})},$4QS:function(n,t,i,r,u,f){_a.$4.$J(t,"conversationId");_a.$4.$J(i,"itemOriginalParentFolderId");_a.$4.$J(r,"itemPartToRemove");_a.$4.$J(u,"mailboxDataContext");_a.$4.$J(f,"successCallback");_js.Trace.logInfo(_e.$1n.$A,"Removing itemPart with id {0} from conversation with id {1}",r.ItemId.Id,t);var e=this;$6zB(this,n,t,r,u,function(o){_js.Trace.logInfo(_e.$1n.$A,"Successfully updated the conversationNodeItem. Retreived parentConversationIndex = ",o);$6zD(e,n,t,i,r,u);f(o)})}};_e.$kE=function(n){_e.$kE.initializeBase(this,[n])};_e.$kE.$7yt=function(n,t){return!n.IsRead&&!_g.$h.$1i.doesIdEqualName(t,"outbox")&&!_g.$h.$1i.doesIdEqualName(t,"drafts")?1:0};_e.$kE.prototype={$3nE:function(n,t,i,r,u,f){_a.$4.$J(n,"tx");_a.$4.$J(t,"conversationHelper");_a.$4.$J(r,"messageItemId");_a.$4.$J(f,"mailboxDataContext");var e=this;this.$8y.get_$52().$Fy(n,_e.$1h.$5f(r.Id),function(o){if(!o){_js.Trace.logWarning(_e.$1n.$A,"Message item with id {0} was not found in the client store.",r.Id);return}e.$1sG(n,t,i,o,u,f)},null)},$3nF:function(n,t,i){_a.$4.$J(n,"tx");_a.$4.$J(t,"outboxItemId");_a.$4.$J(i,"mailboxDataContext");var r=this;this.$8y.get_$gd().$Fy(n,_e.$1h.$5f(t.Id),function(u){if(!u){_js.Trace.logWarning(_e.$1n.$A,"Outbox item with id {0} was not found in the client store.",t.Id);return}r.$1sG(n,null,"HardDelete",u,null,i,!0)},null)},$1sG:function(n,t,i,r,u,f,e){_a.$4.$J(n,"tx");_a.$4.$J(f,"mailboxDataContext");e||_a.$4.$J(t,"conversationHelper");_a.$4.$J(r,"messageItem");i==="MoveToDeletedItems"&&_a.$4.$J(u,"deletedItemsFolderId");var o=r.get_$20();var c=o.IsRead?0:1;var s=new _g.$3S(o.ParentFolderId.Id);var h=_e.$kE.$7yt(o,s);if(i==="MoveToDeletedItems"&&o.ParentFolderId.Id!==u.Id){o.ParentFolderId=u;r.$E7(n,null);this.$8y.get_$2x().$5HD(n,s,1,h);this.$8y.get_$2x().$2NT(n,o.ParentFolderId,1,c)}else{_js.Trace.logInfo(_a.$0.$LV,"Deleting the message with id {0}",o.ItemId.Id);r.$2Iu(n);this.$8y.get_$2x().$5HD(n,s,1,h)}if(!e&&o.ConversationId){var l=this;t.$4QS(n,o.ConversationId,s,o,f,function(n){})}}};_e.$YY=function(){};_e.$YY.$7cj=function(n){var t=new _e.$YY;t.$1bS=n.inboxFolderId;t.$16T=n.outboxFolderId;t.$Oq=n.outboxItemId;t.$GL=n.parentFolderId;t.$Cr=n.conversationId;t.$Yd=n.parentConversationNodeId;t.$33m=n.itemPartsOrderDescending;return t};_e.$YY.$7cn=function(n){var t=new _e.$YY;t.$1bS=n.inboxFolderId;t.$16T=n.outboxFolderId;t.$Oq=n.outboxItemId;t.$GL=n.parentFolderId;t.$Cr=n.conversationId;t.$Yd=n.parentConversationNodeId;t.$33m=n.itemPartsOrderDescending;return t};_e.$YY.prototype={$1bS:null,$16T:null,$Oq:null,$GL:null,$Cr:null,$Yd:null,$33m:!1,get_inboxFolderId:function(){return this.$1bS},get_outboxFolderId:function(){return this.$16T},get_outboxItemId:function(){return this.$Oq},get_parentFolderId:function(){return this.$GL},get_conversationId:function(){return this.$Cr},get_parentConversationNodeId:function(){return this.$Yd},get_itemPartsOrderDescending:function(){return this.$33m}};_e.$1JM=function(n){_a.$4.$J(n,"itemStoreGetter");this.$8y=n};_e.$1JM.prototype={$8y:null};_e.$1CH=function(n){this.$2SJ=new _e.$kE(n);this.$2pP=new _e.$C5(n)};_e.$1CH.prototype={$2SJ:null,$2pP:null,$3te:function(){return this.$2SJ}};_e.$3q.registerClass("_e.$3q");CoreStorageComponent.registerClass("CoreStorageComponent",null,_a.$1In);_e.$7f.registerClass("_e.$7f");_e.$5O.registerClass("_e.$5O",null,IAttachmentsCleanupManager);AddressbookPostalAddress.registerClass("AddressbookPostalAddress");AddressbookEmailAddressInfo.registerClass("AddressbookEmailAddressInfo");AddressbookPhoneNumberInfo.registerClass("AddressbookPhoneNumberInfo");AddressbookPostalAddressInfo.registerClass("AddressbookPostalAddressInfo");_e.$OV.registerClass("_e.$OV");_e.$11G.registerClass("_e.$11G",_e.$OV);_e.$3V.registerClass("_e.$3V");_e.$mz.registerClass("_e.$mz",_e.$3V);_e.$y.registerClass("_e.$y",null,_bc.$17U);_e.$4q.registerClass("_e.$4q",_e.$t3.$$(AttachmentInfoRecord),_bc.$pL,_bc.$17U);ItemMetadata.registerClass("ItemMetadata");AttachmentInfoMetadata.registerClass("AttachmentInfoMetadata",ItemMetadata);_e.$tm.registerClass("_e.$tm",_e.$7j.$$(_bc.$pL,_e.$4q),IAttachmentInfoItemStore,_bc.$17W);_e.$F5.registerClass("_e.$F5");_e.$LZ.registerClass("_e.$LZ");CustomSyncData.registerClass("CustomSyncData");_e.$4R.registerClass("_e.$4R",_a.$T);_e.$4R.prototype.$9a=_a.$T.prototype.$9a;_e.$14J.registerClass("_e.$14J");_e.$CM.registerClass("_e.$CM",_e.$3V);_e.$FU.registerClass("_e.$FU");_e.$8C.registerClass("_e.$8C",_e.$t3.$$(_g.$11x),_bc.$1Hp,_bc.$17U);_e.$bj.registerClass("_e.$bj",_e.$7j.$$(_bc.$1Hp,_e.$8C),_bc.$17I,_bc.$17W);_e.$Tt.registerClass("_e.$Tt",null,_bc.$1Hq);_e.$xe.registerClass("_e.$xe",null,IItemStoreGetterFactory);_e.$Bt.registerClass("_e.$Bt",_e.$t3.$$(_g.$7k),_bc.$Lx,_bc.$17U);_e.$HX.registerClass("_e.$HX",_e.$Bt,_bc.$181,_bc.$Lx,_bc.$17U);_e.$1A4.registerClass("_e.$1A4",_e.$U6.$$(_bc.$181,_e.$HX),_bc.$182,_bc.$17W);_e.$Gm.registerClass("_e.$Gm",_e.$t3.$$(_g.$eY),_bc.$d5,_bc.$17U);PersistedDataRecord.registerClass("PersistedDataRecord");_e.$Aa.registerClass("_e.$Aa",_e.$t3.$$(_g.$O8),_bc.$XW,_bc.$17U);_e.$1h.registerClass("_e.$1h",null,_a.$pP);_e.$GO.registerClass("_e.$GO",_e.$t3.$$(_g.$3x),_bc.$16p,_bc.$17U);ActionItemMetadata.registerClass("ActionItemMetadata",ItemMetadata);_e.$5m.registerClass("_e.$5m");_e.$11E.registerClass("_e.$11E",_e.$t3.$$(AddressbookOperation),_bc.$wJ,_bc.$17U);_e.$11F.registerClass("_e.$11F",_e.$t3.$$(AddressbookPersona),_bc.$wK,_bc.$17U);_e.$Sf.registerClass("_e.$Sf",_e.$oD.$$(_bc.$Lt));_e.$bk.registerClass("_e.$bk",_e.$oD.$$(_bc.$1Hp));_e.$rz.registerClass("_e.$rz",_e.$oD.$$(_bc.$XW));_e.$5w.registerClass("_e.$5w",_e.$t3.$$(_g.$6O),_bc.$Lt,_bc.$1Hu,_bc.$17U);CalendarItemMetadata.registerClass("CalendarItemMetadata",ItemMetadata);_e.$Dh.registerClass("_e.$Dh",_e.$t3.$$(_g.$6O),_bc.$Kp,_bc.$1Hu,_bc.$17U);_e.$5a.registerClass("_e.$5a");_e.$5a.$3gg.registerClass("_e.$5a.$3gg");_e.$5a.$A5I.registerClass("_e.$5a.$A5I",_e.$5a.$3gg);_e.$5a.$9m8.registerClass("_e.$5a.$9m8",_e.$5a.$A5I);_e.$5a.$8HD.registerClass("_e.$5a.$8HD",_e.$5a.$A5I);_e.$127.registerClass("_e.$127",_e.$3V);_e.$a0.registerClass("_e.$a0");_e.$1n.registerClass("_e.$1n",null,IClientStore);_e.$Sr.registerClass("_e.$Sr",_js.$147,_a.$1H6,Sys.IDisposable);_e.$1f.registerClass("_e.$1f",null,_bc.$1Hr);_e.$LW.registerClass("_e.$LW",_e.$t3.$$(_g.$Cz),_bc.$pQ,_bc.$17U);_e.$131.registerClass("_e.$131",_e.$oD.$$(_bc.$16y));_e.$6n.registerClass("_e.$6n",_e.$t3.$$(_g.$W0),_bc.$16y,_bc.$17U);_e.$Qa.registerClass("_e.$Qa",_e.$dN.$$(_bc.$16y,_e.$6n,_g.$W0),_bc.$16z,_bc.$17W);_e.$dE.registerClass("_e.$dE",null,_e.$1FT);_e.$uq.registerClass("_e.$uq",_e.$dE);_e.$1I.registerClass("_e.$1I",null,_e.$wV);_e.$9C.registerClass("_e.$9C",null,_e.$1FO);_e.$TP.registerClass("_e.$TP",_e.$7j.$$(_bc.$1Hp,_e.$8C),_bc.$17H,_bc.$17W);_e.$E9.registerClass("_e.$E9",_e.$1h);_e.$E9.prototype.toString=_e.$1h.prototype.toString;FolderItemMetadata.registerClass("FolderItemMetadata",ItemMetadata);_e.$jZ.registerClass("_e.$jZ",_e.$t3.$$(InlineImageRecord),_bc.$17T,_bc.$17U);_e.$x4.registerClass("_e.$x4",_e.$7j.$$(_bc.$17T,_e.$jZ),IInlineImageItemStore,_bc.$17W);_e.$6P.registerClass("_e.$6P");_e.$18V.registerClass("_e.$18V",null,_e.$wm);_e.$Ct.registerClass("_e.$Ct",null,_e.$wn);_e.$9F.registerClass("_e.$9F");_e.$19R.registerClass("_e.$19R",_e.$oD.$$(_bc.$Lx));_e.$y2.registerClass("_e.$y2",_e.$dE);_e.$19S.registerClass("_e.$19S",_e.$Xe.$$(_bc.$Lx,_g.$7k));_e.$kG.registerClass("_e.$kG",null,_e.$1FS);_e.$mA.registerClass("_e.$mA",null,_e.$1FS);_e.$19f.registerClass("_e.$19f",_e.$mA);_e.$y9.registerClass("_e.$y9",_e.$dE);_e.$2l.registerClass("_e.$2l");_e.$1A3.registerClass("_e.$1A3",_e.$oD.$$(_bc.$181));_e.$UP.registerClass("_e.$UP",_e.$oD.$$(_bc.$xU));_e.$LI.registerClass("_e.$LI",_e.$t3.$$(SyncState),_bc.$q1,_bc.$17U);_e.$1Dy.registerClass("_e.$1Dy");ConversationItemMetadata.registerClass("ConversationItemMetadata",ItemMetadata);_e.$Oo.registerClass("_e.$Oo",_e.$t3.$$(_g.$aK),_bc.$jN,_bc.$17U);_e.$aL.registerClass("_e.$aL",null,_e.$1FS);MessageItemMetadata.registerClass("MessageItemMetadata",ItemMetadata);_e.$kF.registerClass("_e.$kF",_e.$U6.$$(_bc.$Lx,_e.$Bt),_bc.$17b,_bc.$17W);_e.$2Q.registerClass("_e.$2Q",_e.$t3.$$(PartialPersonaRecord),_bc.$pt,_bc.$17U);_e.$UY.registerClass("_e.$UY",_e.$oD.$$(_bc.$pQ));_e.$1Ae.registerClass("_e.$1Ae",_e.$3V);_e.$6H.registerClass("_e.$6H",null,_bc.$184);_e.$ee.registerClass("_e.$ee",_e.$3V,_e.$xP);ConfigChangeCleanupModuleItem.registerClass("ConfigChangeCleanupModuleItem");MessageItemRecord.registerClass("MessageItemRecord",_g.$7k);_e.$62.registerClass("_e.$62",_e.$t3.$$(SettingRecord),_bc.$xU,_bc.$17U);_e.$AB.registerClass("_e.$AB",null,_bc.$1I2);_e.$Q7.registerClass("_e.$Q7",_e.$t3.$$(_g.$Yo),_bc.$jr,_bc.$17U);_e.$mO.registerClass("_e.$mO",_e.$t3.$$(TombstonedItemRecord),_bc.$18X,_bc.$17U);_e.$10h.registerClass("_e.$10h",_e.$7j.$$(_bc.$18X,_e.$mO),_bc.$18Y,_bc.$17W);_e.$12H.registerClass("_e.$12H",_e.$dE);_e.$7y.registerClass("_e.$7y",_e.$3V,_e.$xP);_e.$i6.registerClass("_e.$i6",_a.$KL);_e.$np.registerClass("_e.$np",_e.$3V);EmailItemSyncState.registerClass("EmailItemSyncState",SyncState);ConversationItemSyncState.registerClass("ConversationItemSyncState",EmailItemSyncState);_e.$aI.registerClass("_e.$aI",_e.$3V,_e.$xP);_e.$T0.registerClass("_e.$T0",_e.$Xe.$$(_bc.$16y,_g.$W0));_e.$14s.registerClass("_e.$14s",_e.$N1.$$(_bc.$1Hp,_g.$11x));MessageItemSyncState.registerClass("MessageItemSyncState",EmailItemSyncState);_e.$U7.registerClass("_e.$U7",_e.$Xe.$$(_bc.$Lx,_g.$7k));_e.$3c.registerClass("_e.$3c",_js.$8,_bc.$1I3,_js.$x6);_e.$Fh.registerClass("_e.$Fh");_e.$Hw.registerClass("_e.$Hw",_g.$9K,_g.$1Hn);_e.$k0.registerClass("_e.$k0");_e.$68.registerClass("_e.$68",_g.$1U,_bc.$XT,_g.$1HT,Sys.IDisposable,_bc.$1I6);_e.$1B9.registerClass("_e.$1B9",_g.$1JB,_g.$1Hn);_e.$s8.registerClass("_e.$s8",_e.$Fh);_e.$fP.registerClass("_e.$fP",_e.$Fh);_e.$6E.registerClass("_e.$6E",_e.$3c);_e.$mj.registerClass("_e.$mj");_e.$Vh.registerClass("_e.$Vh",null,_a.$wN);_e.$wb.registerClass("_e.$wb");_e.$5f.registerClass("_e.$5f",null,_a.$1Gv);_e.$5f.$84a.registerClass("_e.$5f.$84a",_a.$Yp);_e.$5y.registerClass("_e.$5y",_a.$Au);_e.$171.registerClass("_e.$171",_e.$Vh);_e.$GZ.registerClass("_e.$GZ",null,_a.$1Gw);_e.$172.registerClass("_e.$172",null,_e.$1Fm,_a.$1Gt);_e.$NU.registerClass("_e.$NU");_e.$173.registerClass("_e.$173",_e.$NU);_e.$174.registerClass("_e.$174");_e.$wa.registerClass("_e.$wa",null,_e.$1Fi);_e.$wa.$5LF.registerClass("_e.$wa.$5LF",null,_e.$1Fh);_e.$2I.registerClass("_e.$2I",null,_e.$1Fj,_e.$1Fl);_e.$Lu.registerClass("_e.$Lu",_e.$2I);_e.$wc.registerClass("_e.$wc");_e.$jP.registerClass("_e.$jP",_e.$2I);_e.$176.registerClass("_e.$176",_e.$2I);_e.$177.registerClass("_e.$177",null,_a.$186);_e.$178.registerClass("_e.$178",null,_a.$187);_e.$Qv.registerClass("_e.$Qv");_e.$Cr.registerClass("_e.$Cr",_e.$176);_e.$Cr.$9rA.registerClass("_e.$Cr.$9rA");_e.$179.registerClass("_e.$179");_e.$pV.registerClass("_e.$pV",null,_a.$1Gu);_e.$17B.registerClass("_e.$17B",_e.$NU);_e.$NV.registerClass("_e.$NV");_e.$wd.registerClass("_e.$wd");_e.$BC.registerClass("_e.$BC",null,_a.$1Gv);_e.$BC.$9rN.registerClass("_e.$BC.$9rN",_a.$Yp);_e.$Ba.registerClass("_e.$Ba",_a.$Au);_e.$lt.registerClass("_e.$lt",_e.$Vh);_e.$DX.registerClass("_e.$DX",null,_a.$1Gw);_e.$54.registerClass("_e.$54",null,_a.$1Gt);_e.$Ex.registerClass("_e.$Ex");_e.$Gu.registerClass("_e.$Gu");_e.$1D3.registerClass("_e.$1D3",_e.$Gu);_e.$1D4.registerClass("_e.$1D4",_e.$Gu);_e.$1D5.registerClass("_e.$1D5",_e.$Gu);_e.$Fe.registerClass("_e.$Fe",null,_e.$1Fk);_e.$10B.registerClass("_e.$10B",null,_e.$1Fn);_e.$g1.registerClass("_e.$g1",null,_a.$186);_e.$g2.registerClass("_e.$g2",null,_a.$187);_e.$LG.registerClass("_e.$LG");_e.$8K.registerClass("_e.$8K",_js.$147,_a.$1Gu);_e.$fz.registerClass("_e.$fz",null,_a.$1I1);_e.$1D1.registerClass("_e.$1D1",_a.ISqlResultSet);_e.$1D2.registerClass("_e.$1D2",_a.ISqlResultSetRowList);_e.$lu.registerClass("_e.$lu");_e.$55.registerClass("_e.$55",null,_a.$1Hy);_e.$1D6.registerClass("_e.$1D6",null,_a.$1Hz);_e.$AI.registerClass("_e.$AI",_e.$e9.$$(_g.$VU,_g.$te));_e.$Op.registerClass("_e.$Op",_e.$e9.$$(_g.$W1,_g.$uv));_e.$17.registerClass("_e.$17",_e.$nH.$$(_g.$ab,_g.$13F));_e.$K.registerClass("_e.$K");_e.$Oq.registerClass("_e.$Oq",_e.$t9.$$(_g.$13M));_e.$au.registerClass("_e.$au",_e.$61.$$(_g.$13o));_e.$Hy.registerClass("_e.$Hy",_e.$e9.$$(_g.$aj,_g.$13i));_e.$9f.registerClass("_e.$9f",_e.$e9.$$(_g.$aq,_g.$13n));_e.$AN.registerClass("_e.$AN",_e.$e9.$$(_g.$bG,_g.$14L));_e.$AO.registerClass("_e.$AO",_e.$Zh.$$(_g.$bT,_g.$FI));_e.$B0.registerClass("_e.$B0",_e.$e9.$$(_g.$bU,_g.$14e));_e.$3G.registerClass("_e.$3G",_e.$Zh.$$(_g.$Lk,_g.$9E));_e.$TK.registerClass("_e.$TK",_e.$Zh.$$(_g.$ba,_g.$14g));_e.$P6.registerClass("_e.$P6",_e.$e9.$$(_g.$Wi,_g.$vy));_e.$TT.registerClass("_e.$TT",_e.$61.$$(_g.$15B));_e.$AQ.registerClass("_e.$AQ",_e.$Zh.$$(_g.$c0,_g.$jD));_e.$oj.registerClass("_e.$oj",_e.$61.$$(_g.$vx));_e.$6W.registerClass("_e.$6W",_e.$e9.$$(_g.$P8,_g.$Wl));_e.$PA.registerClass("_e.$PA",_e.$61.$$(_g.$w2));_e.$op.registerClass("_e.$op",_e.$61.$$(_g.$15r));_e.$15u.registerClass("_e.$15u",_e.$61.$$(_g.$w3));_e.$15w.registerClass("_e.$15w",_e.$Zh.$$(_g.$cP,_g.$15x));_e.$MF.registerClass("_e.$MF",_e.$e9.$$(_g.$e5,_g.$19e));_e.$8I.registerClass("_e.$8I",_e.$Zh.$$(_g.$Nx,_g.$1AW));_e.$8d.registerClass("_e.$8d");_e.$fs.registerClass("_e.$fs",_e.$61.$$(_g.$1CV));_e.$1Ck.registerClass("_e.$1Ck",_e.$61.$$(_g.$1Cm));_e.$71.registerClass("_e.$71",_e.$e9.$$(_g.$h8,_g.$1Ex));_e.$3w.registerClass("_e.$3w",_e.$nH.$$(_g.$h8,_g.$1Ex));_e.$1F1.registerClass("_e.$1F1",_e.$t9.$$(_g.$1F2));_e.$TW.registerClass("_e.$TW",_e.$Zh.$$(_g.$Lp,_g.$w4));_e.$tD.registerClass("_e.$tD",_e.$Zh.$$(_g.$hF,_g.$1F3));_e.$1JM.registerClass("_e.$1JM");_e.$AK.registerClass("_e.$AK",_e.$1JM);_e.$C5.registerClass("_e.$C5",_e.$1JM,_bc.$1I4);_e.$kE.registerClass("_e.$kE",_e.$1JM,_bc.$1I5);_e.$YY.registerClass("_e.$YY");_e.$1CH.registerClass("_e.$1CH",null,_bc.$1I7);_e.$7f.$4XB=-0xffffffffffff;_e.$5O.$A=_a.$0.$3eV;_e.$5O.$v=null;_e.$4q.$47Q=new _a.$4o("Data.MessageID");_e.$4q.$47S=new _a.$4o("Data.MessageReceivedDateTime");_e.$4q.$3ee=new _a.$4o("Data.AttachmentType");_e.$4q.$3ed=new _a.$4o("Metadata.AttachmentTypeAndSyncStatus");CustomSyncData.$1rs="";_e.$4R.$5Ar="ct";_e.$4R.$4b6="tct";_e.$4R.$4b5="tctbtc";_e.$4R.$4aa="tcc";_e.$4R.$4I0="ncc";_e.$4R.$4I1="nccnc";_e.$4R.$4aZ="tcnc";_e.$4R.$4Hz="ncnc";_e.$4R.$4ab="tcm";_e.$4R.$4I3="nmc";_e.$4R.$4aX="tcia";_e.$4R.$4I2="noiac";_e.$4R.$4I4="notick";_e.$y.$A=_a.$0.$4Y9;_e.$y.$2av=new _a.$4o("Data.SaveMode");_e.$y.$5gZ=new _a.$4o("Data.LastModifiedOnClient");_e.$y.$5ge=new _a.$4o("Data.LastSynchronizedToServer");_e.$Aa.$35t=200;_e.$Aa.$65S=0;_e.$Aa.$4QJ=new _a.$4o("Data.ReminderTime");_e.$Aa.$18d=new _a.$4o("Data.UID");_e.$GO.$2dp=new _a.$4o("Data.state");_e.$5w.$A=_a.$0.$4Y8;_e.$5w.$2A4=new _a.$4o("Data.Start");_e.$5w.$3pV=new _a.$4o("Data.End");_e.$5w.$18d=new _a.$4o("Data.UID");_e.$5w.$2sj=new _a.$4o("Metadata.DurationInHours");_e.$Dh.$18d=new _a.$4o("Data.UID");_e.$5a.$A=_a.$0.$1k;_e.$1n.$A=_a.$0.$5a;_e.$1n.$7e="UTC";_e.$1f.$3JR=new Sys.EventHandlerList;_e.$1I.$Bx="15.00.0342.00";_e.$1I.$v=null;_e.$1I.$1TF=[new _a.$5H(_e.$y.$2av,1)];_e.$8C.$4Hc="";_e.$jZ.$57m=new _a.$4o("Data.Blob");_e.$Ct.$7g4=new Array(0);_e.$9F.$Q2=new Array(0);_e.$dE.$A=_a.$0.$1Ox;_e.$2l.$x0=-1;_e.$LI.$5k1=100;_e.$3V.$A=_a.$0.$4Yw;_e.$6n.$7a4="ConversationTopic";_e.$2Q.$1u7=new _a.$4o("Data.FolderId.Id");_e.$2Q.$3I2=new _a.$4o("Data.Persona.PersonaId.Id");_e.$2Q.$3o0=new _a.$4o("Data.Persona.DisplayNameFirstLast");_e.$2Q.$1BP=new _a.$4o("Data.Persona.DisplayNameFirstLastSortKey");_e.$2Q.$3o2=new _a.$4o("Data.Persona.DisplayNameLastFirst");_e.$2Q.$1M4=new _a.$4o("Data.Persona.DisplayNameLastFirstSortKey");_e.$2Q.$7XN=new _a.$4o("Data.Persona.CompanyName");_e.$2Q.$2oq=new _a.$4o("Data.Persona.CompanyNameSortKey");_e.$2Q.$84J=new _a.$4o("Data.Persona.HomeCity");_e.$2Q.$2yP=new _a.$4o("Data.Persona.HomeCitySortKey");_e.$2Q.$A35=new _a.$4o("Data.Persona.WorkCity");_e.$2Q.$3UB=new _a.$4o("Data.Persona.WorkCitySortKey");_e.$2Q.$2q6=new _a.$4o("Data.Persona.CreationTimeString");_e.$2Q.$4Q6=new _a.$4o("Data.Persona.RelevanceScore");_e.$6H.$2Gp=null;_e.$6H.$4XP=null;_e.$6H.$$cctor();_e.$3c.$A=_a.$0.$ZJ;_e.$3c.$2Qo=new _H("LastEnqueuedAction",_g.$3x,_e.$3c);_e.$3c.$2aG=new _H("RequestAvailable",Boolean,_e.$3c,!0);_e.$3c.$2aR=new _H("ResponseAvailable",Boolean,_e.$3c,!0);_e.$3c.$2GQ=new _H("CanProcess",Boolean,_e.$3c,!0);_e.$3c.$2Ov=new _H("IsEmpty",Boolean,_e.$3c,!1);_e.$Hw.$1gx="OfflineErrorInfo";_e.$68.$A=_a.$0.$4IN;_e.$6E.$2dV=[new _a.$IL(_a.$4o.$4s,0)];_e.$6E.$673=new _a.$8k(_e.$GO.$2dp,0);_e.$6E.$674=new _a.$8J(_e.$6E.$673,_e.$6E.$2dV);_e.$6E.$675=new _a.$8k(_e.$GO.$2dp,1);_e.$6E.$676=new _a.$8J(_e.$6E.$675,_e.$6E.$2dV);_e.$6E.$559=new _a.$8J(null,_e.$6E.$2dV);_e.$Ex.$16A=_a.$4o.$4s.$5r;_e.$55.$A=_a.$0.$2dd;_e.$AI.$A=_a.$0.$19e;_e.$Op.$A=_a.$0.$1N;_e.$17.$A=_a.$0.$3kQ;_e.$K.$2YU="#";_e.$K.$3oC="DistributionList";_e.$Oq.$A=_a.$0.$4UW;_e.$au.$A=_a.$0.$4UX;_e.$Hy.$A=_a.$0.$1N;_e.$9f.$A=_a.$0.$3nD;_e.$AN.$A=_a.$0.$LV;_e.$AO.$A=_a.$0.$3qy;_e.$AO.$$cctor();_e.$B0.$A=_a.$0.$3qz;_e.$3G.$A=_a.$0.$102;_e.$3G.$3Dc=null;_e.$3G.$$cctor();_e.$P6.$A=_a.$0.$3tG;_e.$TT.$A=_a.$0.$3sh;_e.$AQ.$A=_a.$0.$3st;_e.$AQ.$$cctor();_e.$oj.$A=_a.$0.$2vj;_e.$6W.$A=_a.$0.$2vx;_e.$6W.$$cctor();_e.$PA.$A=_a.$0.$4UY;_e.$op.$A=_a.$0.$13L;_e.$MF.$A=_a.$0.$4Gj;_e.$8I.$A=_a.$0.$4Ua;_e.$8d.$Wc=null;_e.$8d.$$cctor();_e.$fs.$A=_a.$0.$1kS;_e.$71.$A=_a.$0.$4cV;_e.$3w.$A=_a.$0.$4ce;_e.$TW.$A=_a.$0.$4UZ;_e.$tD.$A=_a.$0.$4Ub;_e.$AK.$A=_a.$0.$3gZ