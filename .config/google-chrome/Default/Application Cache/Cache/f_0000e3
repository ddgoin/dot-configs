Type.registerNamespace("_z");_z.$8P=function(n){this.$$d_$5UC=Function.createDelegate(this,this.$5UC);this.$$d_$9IF=Function.createDelegate(this,this.$9IF);this.$$d_$817=Function.createDelegate(this,this.$817);this.$$d_$3NM=Function.createDelegate(this,this.$3NM);this.$$d_$3yM=Function.createDelegate(this,this.$3yM);this.$$d_$7sR=Function.createDelegate(this,this.$7sR);this.$$d_$7yc=Function.createDelegate(this,this.$7yc);this.$$d_$7wq=Function.createDelegate(this,this.$7wq);this.$$d_$Ek=Function.createDelegate(this,this.$Ek);this.$1Bb=new _b.$tG;_z.$8P.initializeBase(this,[n]);this.$1N9=null;this.$2M8=null;this.$1C4=null;this.$sy=null;this.$180=null;this.$wv=null;this.$kS=null;this.$29J=!1};function $52J(n,t){if(n.$12c)if(t){var i=n.get_$G().find("iframe").get(0);$6(i)||$6(i.contentWindow)||$6(i.contentWindow.document)||$6(i.contentWindow.document.documentElement)?_js.Trace.logWarning(_a.$0.$3b,"Editor - BindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible."):n.$12c.$2Fh($(i.contentWindow.document.documentElement)[0])}else{var r=n.get_$G().find("textarea").get(0);r?n.$12c.$2Fh($(r)[0]):_js.Trace.logWarning(_a.$0.$3b,"Editor - BindHtml5Droppable's textarea is not accessible.")}}function $52L(n,t){if(n.$12c)if(t){var i=n.get_$G().find("iframe").get(0);i&&i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement?n.$12c.$4c0($(i.contentWindow.document.documentElement)[0]):_js.Trace.logWarning(_a.$0.$3b,"Editor - UnbindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible.")}else{var r=n.get_$G().find("textarea").get(0);r?n.$12c.$4c0($(r)[0]):_js.Trace.logWarning(_a.$0.$3b,"Editor - UnbindHtml5Droppable's textarea is not accessible.")}}function $52K(n,t){n.$X7=new _b.$Dc(t)}function $3bf(n,t){if(!n.$3sE&&n.$X7){var i=n.$X7.$3tq();var r=n.$X7.$3tp();var u=n.$X7.$7vE();var f=n.$X7.$7vD();n.$3sE=t.offsetParent.offsetHeight-t.offsetTop-i-r-u-f}return n.$3sE}function $7LS(n,t){if(_d.$pn.isInstanceOfType(t)){var i=t;n.$6L8(i.$10,i.$6Na)}else if(_d.$re.isInstanceOfType(t)){var r=t;n.$9Y6(r.$10)}else if(_d.$x7.isInstanceOfType(t)){var u=t;n.$9Y5(u.$571)}else n.$7ml(t)}function $7LT(n){_js.Trace.logInfo(_a.$0.$3b,"Editor ResetInsertCommandProperty From null to the insertCommand");$N(n,"ResizeCommand")}_z.$8P.prototype={$CN:!1,$29J:!1,$1d9:!1,$2ZS:null,$EB:null,$6V0:null,$5Nk:null,$1N9:null,$2M8:null,$1C4:null,$7A:!1,$N5:!1,$180:null,$sy:null,$uf:!1,$wv:null,$Sm:!1,$1ZZ:null,$GU:null,$19b:null,$El:null,$17I:null,$EW:null,$1wb:null,$3Ty:!1,$4Vw:!1,$12c:null,$kS:null,$13u:null,$br:null,$VY:0,$ll:null,$1hB:null,$w:null,$1g9:0,$65I:0,$4GG:0,$fd:!1,$X7:null,$cD:!1,$rh:0,$3sE:0,$wD:"0",$3O4:!1,$Xc:null,$L6:!0,$Nm:null,get_$9mb:function(){return this.$4Vw},set_$9mb:function(n){if(this.$4Vw!==n){this.$7QC(n);this.$4Vw=n}return n},get_$4RN:function(){return this.$kS},set_$4RN:function(n){if(!this.$kS){this.$kS=new _C(this.$$d_$Ek,this.get_$1b());$N(this,"ResizeCommand")}return n},get_$a4:function(){return this.$13u},set_$a4:function(n){if(n!==this.$13u){this.$13u=n;$N(this,"InputFiles")}return n},get_$1KH:function(){return this.$br},set_$1KH:function(n){if(n!==this.$br){this.$br=n;$N(this,"Base64ImageContent")}return n},get_$2Gw:function(){return this.$VY},set_$2Gw:function(n){if(n!==this.$VY){this.$VY=n;$N(this,"ClipboardImageSize")}return n},get_$2Gx:function(){return this.$ll},set_$2Gx:function(n){if(n!==this.$ll){this.$ll=n;$N(this,"ClipboardImageType")}return n},get_$Ca:function(){return this.$EB},set_$Ca:function(n){if(n!==this.$EB){this.$EB=n;$N(this,"Content")}return n},get_$3u5:function(){return this.$1N9},set_$3u5:function(n){if(!this.$1N9){this.$1N9=new _C(this.$$d_$7wq,this.get_$1b());$N(this,"GetRawContentCommand")}return n},get_$1yL:function(){return this.$CN},set_$1yL:function(n){if(this.$CN!==n){this.$CN=n;this.$9Y4();$N(this,"IsPlainTextContent")}return n},get_$4WE:function(){return this.$29J},set_$4WE:function(n){this.$29J!==n&&(this.$29J=n);return n},get_$7yd:function(){return this.$2M8},set_$7yd:function(n){if(!this.$2M8){this.$2M8=new _C(this.$$d_$7yc,this.get_$1b());$N(this,"GetTextContentCommand")}return n},get_$2vV:function(){return this.$1C4},set_$2vV:function(n){if(!this.$1C4){this.$1C4=new _C(this.$$d_$7sR,this.get_$1b());$N(this,"GetContentCommand")}return n},get_$2dv:function(){return this.$180},set_$2dv:function(n){if(this.$180!==n){this.$180=n;$N(this,"StringAttachContent")}return n},get_$2C8:function(){return this.$uf},set_$2C8:function(n){if(this.$uf!==n){this.$uf=n;$N(this,"WasStringAttachments")}return n},get_$5YA:function(){return this.$1wb},set_$5YA:function(n){if(this.$1wb!==n){this.$1wb=n;$N(this,"InsertionContent");this.get_$GB()||(this.$3Ty=!0)}return n},get_$86j:function(){return this.$wv},set_$86j:function(n){if(!this.$wv){this.$wv=new _C(this.$$d_$3yM,this.get_$1b());$N(this,"InsertContentCommand")}return n},get_$4Ys:function(){return""},set_$4Ys:function(n){this.$6a1(!0,n);return n},get_$4Yu:function(){return""},set_$4Yu:function(n){this.$6a1(!1,n);return n},get_$1t3:function(){return null},set_$1t3:function(n){return n},get_$Cf:function(){return this.$7A},set_$Cf:function(n){this.$7A=n;$N(this,"IsInitialized");return n},get_$rT:function(){return this.$N5},set_$rT:function(n){this.$N5=n;$N(this,"IsReady");return n},get_$EH:function(){return this.$1d9},set_$EH:function(n){if(this.$1d9!==n){this.$1d9=n;if(n&&this.get_$Z()){var t=this.get_$Z().$d.get_$40();(t===1||t===2||t===3)&&this.$9dd()}}return n},get_$1Gk:function(){return this.$2ZS},set_$1Gk:function(n){this.$2ZS=n;_js.$9.$a(this.$2ZS)||this.$1d9||this.$9kP();return n},get_$3tW:function(){return this.$Xc},set_$3tW:function(n){if(n!==this.$Xc){this.$Xc=n;$N(this,"GetLinkPreviewRequest")}return n},get_$1zg:function(){return null},set_$1zg:function(n){n&&this.$86m(n);return n},get_$18v:function(){return this.$Nm},set_$18v:function(n){if(n!==this.$Nm){this.$Nm=n;$N(this,"YouTubePlayerAnchorClicked")}return n},get_$2ng:function(){return null},set_$2ng:function(n){n&&$7LS(this,n);return n},get_$1cA:function(){return this.$fd},set_$1cA:function(n){if(n!==this.$fd){this.$fd=n;$N(this,"IsExtendable")}return n},get_$5KK:function(){return this.$wD},set_$5KK:function(n){if(this.$wD!==n){this.$wD=n;$N(this,"EditorTabIndex")}return n},get_$1P:function(){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.Text does not have an implementation for get Text(), inheriting classes can override this if needed.");return""},set_$1P:function(n){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.Text does not have an implementation for set Text(), inheriting classes can override this if needed.");return n},get_$oc:function(){return this.$6V0},set_$oc:function(n){this.$6V0=n;return n},get_$1u6:function(){return this.$5Nk},set_$1u6:function(n){this.$5Nk=n;return n},get_$2AL:function(){return!1},$GN:function(){this.$Sm=!0},$kK:function(){this.$Sm=!1},$Uz:function(){},$3yM:function(){if(_js.$9.$a(this.$1wb)){_js.Trace.logInfo(_a.$0.$3b,"Attempt to insert empty content, operation ignored.");return}if(this.get_$GB())this.$3Ty=!1;else{this.$3Ty=!0;return}this.$6L8(this.$1wb,!1)},$6a1:function(n,t){this.$9Y7(n,t)},$Ek:function(){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.Resize does not have an implementation for Resize(), inheriting classes can override this if needed.")},$9xq:function(n){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.UnbindCommands does not have an implementation for UnbindCommands(), inheriting classes can override this if needed.")},$57h:function(n){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.BindCommands does not have an implementation for BindCommands(), inheriting classes can override this if needed.")},$Ms:function(){_js.Trace.logWarning(_a.$0.$3b,"AbstractEditor.Focus is not implemented");return!1},$9il:function(n){this.$12c=n},$99n:function(){},$99m:function(){},$9H8:function(n){n.dataTransfer.dropEffect=this.$1Bb.$36("move",null)},$9H6:function(n){n.dataTransfer.dropEffect=this.$1Bb.$36("move",null)},$9H7:function(n){n.dataTransfer.dropEffect=this.$1Bb.$36("move",null)},$9HA:function(n,t){var i=!1;t.val=!1;if(!$6(n)&&!$6(n.dataTransfer)){var u=n.dataTransfer;var r=n.dataTransfer.getData("Text");if(_js.$9.$18(r))if(_a.UserAgent.getInstance().get_$2Kc()){if(!$6(u.files)){this.set_$a4(new _h.$WM(u.files));if(this.$1hB){this.$1hB.$n();t.val=!0}i=!0}}else{_js.Trace.logInfo(_a.$0.$3b,"Your browser does not support FileAPI, so drag-and-drop functionality is not available.");if(this.$w){this.$w.$5S(680);this.$w.$2a(680)}i=!0}else if(this.$sy&&r.startsWith("{")&&r.endsWith("}")){this.set_$2dv(r);this.$sy.$n();i=this.$uf;t.val=i;this.set_$2C8(!1)}}return i},$9dd:function(){},$9Y6:function(n){},$9Y5:function(n){},$9Y7:function(n,t){},$7QC:function(n){},$9Y4:function(){},$9kP:function(){},$7ml:function(n){},$86m:function(n){},$5UC:function(n){this.$3NM()},$9IF:function(n){var t=new _a.$AE(n);if(t&&!!(t.get_$6R()===9&!t.$LW())){this.set_$5YA("    ");this.$3yM();t.$9v()}this.$3NM()},$4JH:function(){_js.Trace.logInfo(_a.$0.$3b,"Editor - DataContextUpdated");_js.$E.prototype.$4JH.call(this);if(!this.get_$Z()){this.$1C4=null;this.$1N9=null;this.$wv=null}$7LT(this)},$Hd:function(){this.$3Ty&&this.$3yM();_js.$5.prototype.$Hd.call(this)},$4c:function(){_js.$E.prototype.$4c.call(this);if(this.$12c){this.$12c.$1Q();this.$12c=null}},$817:function(n){_js.$J.get_$I().$1w(_a.$0.$3b,"HandleHeightEvent",this.$$d_$3NM,0)}};_z.$8B=function(n,t){this.$$d_$80q=Function.createDelegate(this,this.$80q);this.$$d_$5UC=Function.createDelegate(this,this.$5UC);this.$$d_$5U6=Function.createDelegate(this,this.$5U6);_z.$8B.initializeBase(this,[n]);this.$C=t;this.$yv=null;this.$9I=$(window.document.createElement("Textarea"));$52K(this,this.$9I);var i=this;this.$9I.change(function(n){$7LU(i)});this.$9I.addClass("textarea");this.get_$G().append(this.$9I);this.set_$1cA(!0);this.$5U7=new _C(this.$$d_$5U6,this.get_$1b())};_z.$8B.$5dS=function(n){var t=n.instance;if(n.newValue){t.$9I.attr("readonly","true");t.$9I.addClass("textboxDisabled")}else{t.$9I.removeAttr("readonly");t.$9I.removeClass("textboxDisabled")}};function $7LU(n){n.$yv&&n.$yv.$n()}function $52M(n){n.$9I.unbind("paste");n.$9I.unbind("cut");n.$9I.unbind("keyup");n.$9I.unbind("keydown");_a.UserAgent.getInstance().$8l&&n.$9I.unbind("beforedeactivate")}function $52N(n,t){n.$9I.val(t);n.set_$Ca(t);n.$3NM()}function $3bg(n){if(!n.$25a){n.$25a=n.$9I.css("height");_js.Trace.logInfo(_a.$0.$3b,"ExtendableEditor get original height "+n.$25a)}}_z.$8B.prototype={$yv:null,$lW:null,$9I:null,$Qo:null,$Fh:null,$2tP:!1,$5U7:null,$1NR:!1,$C:null,$25a:null,$1Yy:!1,$2Ik:!1,$4Rm:!1,get_$Cz:function(){return this.$U(_z.$8B.$1yS)},set_$Cz:function(n){this.$K(_z.$8B.$1yS,n);return n},get_$J4:function(){return this.$U(_z.$8B.$28q)},set_$J4:function(n){this.$K(_z.$8B.$28q,n);return n},get_$69a:function(){return this.$yv},set_$69a:function(n){if(this.$yv!==n){this.$yv=n;$N(this,"OnContentChangedCommand")}return n},get_$3JW:function(){return this.$EB},set_$3JW:function(n){if(n!==this.$EB){$52N(this,n);$9J(this,"RawContent","TextContent")}return n},get_$6ao:function(){return this.$EB},set_$6ao:function(n){n!==this.$EB&&$52N(this,n);return n},get_$1t3:function(){return this.$Qo},set_$1t3:function(n){if(this.$Qo!==n){if(this.$Qo&&this.$Qo.length>0)for(var r=this.$Qo.split(" "),t=0;t<r.length;t++)this.$9I.removeClass(r[t]);this.$Qo=n;if(this.$Qo&&this.$Qo.length>0)for(var u=this.$Qo.split(" "),i=0;i<u.length;i++)this.$9I.addClass(u[i]);"TouchNarrow"===this.$C.get_$L()&&this.$9I.css("line-height",String.format("23{0}","px"));$N(this,"EditorCssClass")}return n},get_$If:function(){return this.$Fh},set_$If:function(n){this.$Fh=n;$N(this,"EnterCommand");return n},get_$7m0:function(){return this.$2tP},set_$7m0:function(n){this.$2tP=n;$N(this,"EnterWithoutLineBreak");return n},$3NM:function(){if(this.$fd)if(this.$Sm&&this.$X7&&this.get_$Z()&&!this.get_$Z().$iy){this.$cD=!1;$3bg(this);var n;var t=!1;if(this.$rh){n=this.$X7.$3uB();_js.Trace.logInfo(_a.$0.$3b,"ExtendableEditor get current scroll height "+n.toString()+", last scroll height "+this.$rh.toString())}else{this.$rh=this.$X7.$3uB();n=this.$rh;t=!0;_js.Trace.logInfo(_a.$0.$3b,"ExtendableEditor get current scroll height and setup last scroll height to "+n.toString())}if(n){if(n!==this.$rh||t){var i=this.$X7.$3tq();var r=this.$X7.$3tp();var u=n-i-r;this.$9I.css("height",u+"px");_js.Trace.logInfo(_a.$0.$3b,"ExtendableEditor set new height "+u.toString()+" = Scroll height "+n.toString()+" - padding top "+i.toString()+" - padding bottom "+r.toString());this.$rh=n}}else{this.$cD=!0;_js.Trace.logInfo(_a.$0.$3b,"ExtendableEditor has scroll height 0, which means it is not visible yet, set the deferred set height flag.")}}else{this.$cD=!0;_js.Trace.logInfo(_a.$0.$3b,"Remember a deferred request to set height")}else _js.Trace.logInfo(_a.$0.$3b,"Skip SetHeight since the ExtendableEditor is not extendable")},$Ek:function(){if(!this.$3O4){var i=this.$X7.$3uB();var r=this.$X7.$3tq();var u=this.$X7.$3tp();var t=i-r-u;var n=-1;switch(this.$C.get_$L()){case"TouchWide":n=this.$65I;break;case"TouchNarrow":n=this.$4GG;break;default:throw Error.argument("Current layout","Unsupported layout: "+this.$C.get_$L());}t<n&&(t=n);$3bg(this);this.$9I.css("height",t+"px")}},$GN:function(){_js.Trace.logInfo(_a.$0.$j,"ExtendableEditor.PostTransitionIn");_z.$8P.prototype.$GN.call(this);this.$4VM();if(_a.UserAgent.getInstance().$D9.get_$4l()===5||_a.UserAgent.getInstance().$D9.get_$4l()===3&&_y.$v.$v.get_$L()!=="Mouse"){var n=this;_js.$J.get_$I().$1w(_a.$0.$j,"RemoveBodyFocusHandler",function(){n.$3NL()},500)}else this.$3NL();this.$cD&&this.$3NM()},$Ms:function(){this.$9I.focus();return!0},$7SW:function(){this.$9I.blur()},$4VM:function(){if(!this.$1NR){this.$9I.bind("paste",this.$$d_$817);this.$9I.bind("cut",this.$$d_$817);this.$9I.keydown(this.$$d_$9IF);this.$9I.keyup(this.$$d_$5UC);_a.UserAgent.getInstance().$8l&&this.$9I.bind("beforedeactivate",this.$$d_$80q);this.$1NR=!0}},$3NL:function(){var n=this.$9I?this.$9I[0]:null;if(this.$4Rm||this.$2Ik){_js.Trace.logInfo(_a.$0.$3b,"Skipping set full screen height and reset deferred set full screen height since we have already restored original height or has a deferred restore.");this.$1Yy=!1}else if(n&&n.offsetParent&&this.$X7){this.$1Yy=!1;$3bg(this);var t=$3bf(this,n);this.$9I.css("height",t+"px");_js.Trace.logInfo(_a.$0.$3b,"Set full screen height "+t);this.$rh=0;this.$3NM()}else{_js.Trace.logInfo(_a.$0.$3b,"Skipping set height to full screen, set deferred flag");this.$1Yy=!0}},$9dd:function(){this.$1Yy=!1;if(this.$9I&&this.$25a&&this.$Sm&&this.get_$Z()&&!this.get_$Z().$iy){this.$2Ik=!1;this.$4Rm=!0;_js.Trace.logInfo(_a.$0.$3b,"Restore to original height "+this.$25a);this.$9I.css("height",this.$25a);this.$rh=0;this.$3NM()}else{this.$2Ik=!0;_js.Trace.logInfo(_a.$0.$3b,"Skip restore to original height")}},$Hd:function(){_z.$8P.prototype.$Hd.call(this);this.set_$Ng(2);this.$Sm&&this.$4VM();this.get_$J4()&&this.$Ms();this.$2Ik?this.$9dd():this.$1Yy&&this.$3NL();this.$cD&&this.$3NM();this.$9I&&!_js.$9.$a(this.$1ZZ)&&this.$9I.attr("aria-label",this.$1ZZ);if(this.$9I&&this.$wD){var n=this.$9I.get(0);var t=parseInt(this.$wD);n.tabIndex=t}this.set_$Cf(!0)},$Iw:function(){$52M(this);this.set_$Cf(!1);this.$1NR=!1;this.$4Rm=!1;this.$1Yy=!1;this.get_$Z()&&_d.$Am.isInstanceOfType(this.get_$Z())&&this.$C&&"TouchNarrow"===this.$C.get_$L()&&this.get_$Z().$9dl()},$5UC:function(n){if(!this.$2tP&&this.$Fh&&this.$Fh.$2M){var t=new _a.$AE(n);t.get_$6R()!==13||t.$LW()||this.$5U6()}this.get_$Z()&&_d.$Am.isInstanceOfType(this.get_$Z())&&this.$C&&"TouchNarrow"===this.$C.get_$L()&&this.get_$Z().$9Tj();_z.$8P.prototype.$5UC.call(this,n)},$80q:function(n){$6(window.document.selection)||(this.$lW=document.selection.createRange())},$4c:function(){$52M(this);this.$1NR=!1;_z.$8P.prototype.$4c.call(this)},$6L8:function(n,t){var r;var u;var f=this.$9I.val();if($6(window.document.selection)){r=this.$9I.prop("selectionStart");u=t?this.$9I.prop("selectionEnd"):r;this.$9I.val(f.substring(0,r)+n+f.substr(u));this.$9I.get(0).focus();if(t){var e=r+n.length;this.$9I.prop("selectionStart",e);this.$9I.prop("selectionEnd",e)}}else{this.$9I.get(0).focus();var i=this.$lW;if(!i)if(document.selection.type!=="None")i=document.selection.createRange();else{var o=this.$9I.get(0);i=o.createTextRange();i.collapse(!1)}var s=i.duplicate();i.text=n;i.collapse(!0);i.moveToBookmark(s.getBookmark());try{i.select()}catch(h){_js.Trace.logException(this.get_$1b(),h,"Failed to select range")}}this.$7wq();this.$3NM()},$7yc:function(){this.$7sR()},$7wq:function(){this.$7sR()},$7sR:function(){this.set_$Ca(this.$9I.val());$N(this,"RawContent");$N(this,"TextContent")},$iX:function(){if(!this.$2tP)return _js.$E.prototype.$iX.call(this);var n=new _o365c.$P;n.set_$R("ENTER");n.$25=0;n.$5T=this.$5U7;n.$Yj=!0;var t=new _o365c.$1S;t.set_$26([n]);return[t]},$9Y6:function(n){var t=this.$9I.val();var i=this.$9I.prop("selectionStart");var r=this.$9I.prop("selectionEnd");this.$9I.val(n+t);this.$9I.prop("selectionStart",i+n.length);this.$9I.prop("selectionEnd",r+n.length);this.$7wq();this.$3NM()},$5U6:function(){if(this.$Fh&&this.$Fh.$2M){var n=this.$9I.val();_js.$9.$a(n)||(n=n.trimEnd());this.set_$Ca(n);this.$Fh.$n();this.$9I.val("")}}};_z.$8P.registerClass("_z.$8P",_js.$5,_b.$17R);_z.$8B.registerClass("_z.$8B",_z.$8P);_z.$8B.$1yS=new _H("IsReadOnly",Boolean,_z.$8B,!1,_z.$8B.$5dS,null);_z.$8B.$28q=new _H("SetFocusOnActive",Boolean,_z.$8B)