Type.registerNamespace("_e");_e.$3e=function(){};_e.$3e.$1LB=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),i);_a.$2i.$fG(t,function(){_e.$5h.$1LB(u)})})};_e.$3e.$4BQ=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),i);_a.$2i.$fG(t,function(){u(n)})})};_e.$3e.$9Fi=function(n,t,i){i&&(t.onupgradeneeded=function(t){var r=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),n);_a.$2i.$fG(r,function(){i(t)})})};_e.$3e.$uD=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),i);_a.$2i.$fG(t,function(){_e.$5h.$uE(n.target.error.name,u)})})};_e.$3e.$Qs=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),i);_a.$2i.$fG(t,function(){u(n)})})};function CoreStorageComponent(){}CoreStorageComponent.prototype={$1QB:function(n,t,i){var r=this;n.$9V(_e.$1E).$9Iy(_e.$rk).$9Iz().$9J0(function(){return _e.$1E.get_$L()});var u=this;n.$9V(_a.$rf).$9J0(function(){var t=new _a.$dm(n.$5uT(_js.$Cm),n.$5uT(_a.$Pu),n.$5uT(_a.$69));return _e.$Sw.$I(n.$5uT(_a.UserAgent),t)});var f=this;n.$9V(IClientStore).$9Iz().$9J0(function(){return new _e.$1a(256,n.$5uT(_e.$rk),n.$5uT(_a.$rf),n.$5uT(_a.$5X))});var e=this;n.$9V(IAttachmentsCleanupManager).$9Iz().$9J0(function(){return _e.$53.$1Fc()});var o=this;n.$9V(IInlineImageItemStore).$9J0(function(){return new _e.$sH(n.$5uT(IClientStore),_e.$1a.$6t)});var s=this;n.$9V(IAttachmentInfoItemStore).$9J0(function(){return new _e.$pN(n.$5uT(IClientStore),_e.$1a.$6t)});var h=this;n.$9V(_e.$sj).$9Iy(IItemStoreGetterFactory).$9J0(function(){return new _e.$sj(n.$5uT(IClientStore))})},$7Is:function(){return[]}};_e.$7C=function(){};_e.$7C.$I=function(n,t){var i=_e.$7C.$4op(n);var r=_e.$7C.$4op(t);return i+"\x01"+r};_e.$7C.$4op=function(n){return String.isInstanceOfType(n)?"S"+_e.$7C.$8uT(n):Number.isInstanceOfType(n)?"N"+_e.$7C.$74c(n):Boolean.isInstanceOfType(n)?"B"+_e.$7C.$72o(n):null};_e.$7C.$8uT=function(n){if(n.indexOf("\x01")>=0){_js.Trace.logWarning(_a.$0.$C0,"A composite key is being constructed with the composite key meta-character and will be stripped of the character.  Consequently, sorts and filters, will ignore that character in any comparisons. {0}",n);return n.replace("\x01","")}else return n};_e.$7C.$74c=function(n){n>0xfffffffffffff&&(n=0xfffffffffffff);n<_e.$7C.$49y&&(n=_e.$7C.$49y);if(n>=0){var i=n.toString(16);var u=13-i.length;var t=new Sys.StringBuilder;t.append("P");for(var r=0;r<u;++r)t.append("0");t.append(i);return t.toString()}else{var f=0xfffffffffffff+n+1;var e=f.toString(16);return"N"+e}};_e.$7C.$72o=function(n){return n.toString()};_e.$53=function(){$1eE(this)};_e.$53.$1Fc=function(){_e.$53.$g||(_e.$53.$g=new _e.$53);return _e.$53.$g};function $6TD(n,t,i,r,u){var f;var o={};var s=[];for(f=0;f<u.length;f++)o[u[f]]=0;var h=_a.$7.get_utcNow().$2q(-3).$55();for(f=0;f<r.length;f++){var e=r[f];e.LastAccessedDateTime<h?Array.add(s,e.AttachmentId):e.DataID in o?o[e.DataID]=1:Array.add(s,e.AttachmentId)}for(f=0;f<u.length;f++)o[u[f]]||i.$Wb.$1EY(u[f]);_e.$4W.$4re(s,t)}function $3G4(n,t,i,r){if(n.$2mH||!t.$VZ){_js.Trace.logWarning(_e.$53.$D,"Already executing or the native bridge is not ready");$2US(n,r,Error.create("Already executing the cleanup or NativeBridge is not ready yet."));return!1}else{n.$2mH=!0;return!0}}function $4Q3(n,t,i){var r=this;t.$Wb.$4yw(1,function(r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];t.$Wb.$1EY(o)}$4Q2(n,i);$1eE(n)})}function $1eE(n){n.$2mH=!1}function $2US(n,t,i){t&&t(i)}function $4Q2(n,t){t&&t()}_e.$53.prototype={$2mH:!1,get_$7Yy:function(){return this.$2mH},$6xs:function(n,t,i){_a.$3.$M(n,"nativeBridge");_js.Trace.logInfo(_e.$53.$D,"CleanAllPalAttachments start");$3G4(this,n,t,i)&&$4Q3(this,n,t)},$6xr:function(n,t,i,r){_a.$3.$M(n,"attachmentStore");_a.$3.$M(t,"initNativeBridge");_js.Trace.logInfo(_e.$53.$D,"CleanAllPalAttachmentInfoAndAttachments start");if($3G4(this,t,i,r)){var u=this,f=this;_e.$4W.$4yy(n,function(f){n.$AK(new _a.$6L("SyncConversationItemsReadFlagModule.CleanAllPalAttachmentInfoAndAttachments"),function(t){if(f)for(var r=f,u=r.length,i=0;i<u;++i){var e=r[i];n.$GW(t,_e.$1X.$54(e.AttachmentId))}},function(){$4Q3(u,t,i)},function(n){_e.$1W.$BC(n,function(t){_js.Trace.logWarning(_e.$53.$D,"Error occurred during cleanup call {0}",n);$2US(u,r,t.$IU());$1eE(u)})})},function(n){_js.Trace.logWarning(_e.$53.$D,"Error in DB while retrieving all non inline attachment info {0}",n);$2US(f,r,n.$IU());$1eE(f)})}},$96H:function(n,t,i,r){_a.$3.$M(n,"store");_a.$3.$M(t,"nativeBridge");_js.Trace.logInfo(_e.$53.$D,"AttachmentCleanupManager.StartCleanUp start");if($3G4(this,t,i,r)){var f=null;var e=null;var u=this,o=this;_e.$4W.$4yy(n,function(r){f=r;t.$Wb.$4yw(1,function(r){e=r;$6TD(u,n,t,f,e);$4Q2(u,i);$1eE(u)})},function(n){_js.Trace.logWarning(_e.$53.$D,"Error in DB during StartScheduledCleanup {0}",n);$2US(o,r,n.$IU());$1eE(o)})}}};var ItemShapeType=function(){};ItemShapeType.prototype={};ItemShapeType.registerEnum("ItemShapeType",!1);_e.$yP=function(){};_e.$yP.prototype={};_e.$yP.registerEnum("_e.$yP",!1);_e.$1AL=function(){};_e.$1AL.registerInterface("_e.$1AL");_e.$rk=function(){};_e.$rk.registerInterface("_e.$rk");_e.$s1=function(){};_e.$s1.registerInterface("_e.$s1");_e.$s2=function(){};_e.$s2.registerInterface("_e.$s2");_e.$1AK=function(){};_e.$1AK.registerInterface("_e.$1AK");_e.$19x=function(){};_e.$19x.registerInterface("_e.$19x");function AddressbookPostalAddress(){}_e.$vp=function(n){_e.$vp.initializeBase(this);this.$E9=n};_e.$vp.prototype={$E9:null,$8nU:function(n,t,i,r,u){var f=n.PersonaId.Id;switch(u){case 1:var e=_e.$8U.$4nu(n);this.$E9.$5wQ(f,JsonParser.serialize(e));break;case 2:this.$E9.$1EZ(f);break}}};_e.$jL=function(n,t){this.$1fw=[];_e.$jL.initializeBase(this);_a.$3.$M(n,"attachmentItemStore");_a.$3.$M(t,"inlineImageItemStore");this.$1D1=n;this.$2l2=t};_e.$jL.prototype={$1D1:null,$2l2:null,$3Al:0,$5nz:function(n){this.$2h9(n)},$40y:function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"emailCleanupContext");_a.$3.$M(t.$27I,"emailCleanupContext.DeletedMessages");_a.$3.$M(i,"completedCallback");_js.Trace.logInfo(_a.$0.$57,"Start inline attachment periodic cleanup");Array.clear(this.$1fw);this.$3Al=0;var r=this;this.$6xz(n,t.$27I,function(){t.$BM.set_$99g(_e.$BY.get_$1iM()-(t.$1Ps+t.$BM.get_$2RR()+t.$BM.get_$3AM()+t.$BM.get_$4DI()));t.$BM.set_$5fH(r.$3Al);i()})},$6xz:function(n,t,i){var u=n.$CU(_e.$1E.get_$L().$13Y.get_$1Q());var f=new _a.$7m(null,null);if(!t.$9J3()){i();return}var r=this;u.$HQ(f,function(u){u.$F(function(n){_js.Trace.logInfo(_a.$0.$57,"Number of attachments to process is {0}",n)},null);var f=[];r.$4kl(u,t,f,function(){_e.$BY.$9JK(_bc.$lO,n,r.$1D1,f);_e.$BY.$9JK(_bc.$11v,n,r.$2l2,f);_js.Trace.logInfo(_a.$0.$57,"Completed cleaning inline attachments for given messages, total: {0}",f.length);i()})},null)},$4km:function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"messageIds");_a.$3.$6v(i,0,t.length,"currentMessageIndex");_a.$3.$M(r,"completedCallback");if(!t.length){r();return}var u=this;this.$4yx(n,t[i].get_$1V2().toString(),function(f){f&&Array.addRange(u.$1fw,f);++i;if(i===t.length){var o=u.$1fw;u.$3Al=u.$1fw.length;for(var s=o,c=s.length,e=0;e<c;++e){var h=s[e];u.$1D1.$GW(n,h);u.$2l2.$GW(n,h)}_js.Trace.logInfo(_a.$0.$57,"Completed cleaning inline attachments for given messages, total attachments cleaned: {0} for total messages: {1}",o.length,t.length);Array.clear(u.$1fw);r()}else u.$4km(n,t,i,r)})},$2h9:function(n){_a.$3.$M(n,"tx");_js.Trace.logInfo(_a.$0.$57,"Performing attachment and inline image cleanup");this.$1D1.$l3(n);this.$2l2.$l3(n)},$4yx:function(n,t,i){_e.$4W.$4yx(n,t,this.$1D1,i,null)},$4kl:function(n,t,i,r){var u=this;n.$CS(50,function(f,e,o){for(var s=0;s<e.length;++s){var h=u.$1D1.$xM(e[s]);if(h.get_$1s().AttachmentType===1&&t.get_$48(h.get_$1s().MessageID)){Array.add(i,h.get_$1y());u.$3Al++}}e.length===50?u.$4kl(n,t,i,r):r()},null)}};_e.$4W=function(){_e.$4W.initializeBase(this)};_e.$4W.$5v1=function(n,t,i,r){_a.$3.$1C(n,"id");_a.$3.$M(t,"store");_a.$3.$M(i,"successCallback");var u=null;t.$AK(new _a.$6L("AttachmentInfoItem.RetrieveRecord"),function(i){t.$Da(i,_e.$1X.$54(n),function(n){n&&(u=n.get_$1s())},null)},function(){i(u)},function(n){_e.$1W.$BC(n,r)})};_e.$4W.$4z9=function(n,t,i,r){_a.$3.$1C(n,"id");_a.$3.$M(t,"store");_a.$3.$M(i,"successCallback");var u=null;t.$AK(new _a.$6L("AttachmentInfoItem.GetAttachmentInfoAndUpdateTime"),function(i){t.$1BX(i,_e.$1X.$54(n),function(t){if($8(t)){_js.Trace.logInfo(_e.$1a.$D,"Message with id {0} not found in local store",n);return}u=t;u.LastAccessedDateTime=_a.$7.get_utcNow().$55()})},function(){i(u)},function(n){_e.$1W.$BC(n,r)})};_e.$4W.$5wI=function(n,t,i,r){_a.$3.$M(n,"record");_a.$3.$M(t,"store");var u=null;var f=t.$4F6(n);t.$AK(new _a.$6L("AttachmentInfoItem.SaveAttachmentInfo"),function(n){f.$Cn(n,function(n){u=n})},function(){_e.$1W.$9I9(_a.$lT,u,i)},function(n){_e.$1W.$BC(n,r)})};_e.$4W.$4rd=function(n,t){_a.$3.$1C(n,"attachmentId");_a.$3.$M(t,"store");_e.$4W.$4re([n],t)};_e.$4W.$4re=function(n,t){_a.$3.$M(n,"attachmentIds");_a.$3.$M(t,"store");t.$AK(new _a.$6L("AttachmentInfoItem.DeleteAttachmentInfoWithIds"),function(i){for(var u=n,f=u.length,r=0;r<f;++r){var e=u[r];t.$GW(i,_e.$1X.$54(e))}},function(){},function(n){_js.Trace.logError(_e.$1a.$D,"DeleteAttachmentInfoWithIds failed with error {0}",n.$4P)})};_e.$4W.$4yy=function(n,t,i){_a.$3.$M(n,"store");_a.$3.$M(t,"successCallback");var r=[];n.$AK(new _a.$6L("AttachmentInfoItem.GetAllNonInlineAttachmentInfoRecords"),function(t){var u=t.$CU(_e.$1E.get_$L().$13Y.get_$1Q());var f=new _a.$86(_e.$4W.$3MM,0);var e=new _a.$7m(f,null);u.$HQ(e,function(t){_e.$4W.$5rn(n,t,r,_e.$1W.$WX(i))},_e.$1W.$WX(i))},function(){t(r)},_e.$1W.$WX(i))};_e.$4W.$4yx=function(n,t,i,r,u){_a.$3.$M(n,"tx");_a.$3.$1C(t,"messageId");_a.$3.$M(r,"successCallback");var f=[];var h=n.$CU(_e.$1E.get_$L().$13Y.get_$1Q());var e=new _a.$86(_e.$4W.$3mq,t);var o=new _a.$7m(e,null);var s=100;_e.$w.$5rO(_e.$4W,n,o,s,function(n,t,u,e){if(u)for(var o=0;o<u.length;o++){var s=i.$xM(u[o]);s.get_$1s().AttachmentType===1&&Array.add(f,s.get_$1y())}e&&r(f)},_e.$1W.$WX(u))};_e.$4W.$72h=function(n,t,i,r,u){return new AttachmentInfoRecord(n.AttachmentId.Id,"InlineAttachmentId",n.Size,_a.$7.get_utcNow().$55(),t,u?1:0,i,r)};_e.$4W.$7IK=function(n,t){var i;i=n!==1||t?n===1&&t?1:n||t?3:2:0;return i};_e.$4W.$5rn=function(n,t,i,r){var u=100;t.$CS(u,function(u,f,e){for(var o=0;o<f.length;++o){var s=n.$xM(f[o]);Array.add(i,s.get_$1s())}f.length>0&&_e.$4W.$5rn(n,t,i,r)},r)};_e.$4W.prototype={get_$e0:function(){return _e.$1E.get_$L().$13Y},$9GG:function(n){_a.$3.$1C(n.AttachmentId,"AttachmentId");_a.$3.$1C(n.DataID,"DataID");_a.$3.$1C(n.MessageID,"MessageID");_a.$3.$1C(n.MessageReceivedDateTime,"MessageReceivedDateTime");_a.$3.$M(n.AttachmentType,"AttachmentType");if(n.LastAccessedDateTime<=0)throw Error.argument("LastAccessedDateTime","LastAccessedDateTime must be set to a valid value");},$7ET:function(n){return _e.$1X.$54(n.AttachmentId)},$7EX:function(n){return new AttachmentInfoMetadata(_e.$4W.$7IK(n.AttachmentType,n.Synced))}};function AttachmentInfoMetadata(n){AttachmentInfoMetadata.initializeBase(this);_a.$3.$M(n,"attachmentTypeAndSyncStatus");this.AttachmentTypeAndSyncStatus=n}AttachmentInfoMetadata.prototype={AttachmentTypeAndSyncStatus:0};_e.$pN=function(n,t){_e.$pN.initializeBase(this,[n,t])};_e.$pN.prototype={$4z9:function(n,t,i){_e.$4W.$4z9(n,this,t,i)},$4rd:function(n){_e.$4W.$4rd(n,this)},$5wI:function(n,t,i){_e.$4W.$5wI(n,this,t,i)},$5v1:function(n,t,i){_e.$4W.$5v1(n,this,t,i)}};_e.$Dy=function(n){this.$1iQ={};_a.$3.$M(n,"eventAggregator");this.$S=n};function $6TE(n){var t=n.$1iQ;for(var i in t){var r={key:i,value:t[i]};var u=r.value;delete n.$1iQ[u.get_$us().toLowerCase()]}}function $1By(n,t){n.$1iQ[t.get_$us().toLowerCase()]=t}_e.$Dy.prototype={$S:null,$HX:function(n,t){_a.$3.$M(n,"clientStore");_a.$3.$M(n.get_$wQ(),"database");_a.$3.$1C(t,"timeZoneId");this.$12Z(n.get_$wQ());this.$7fA(n,t);var i=this.$1iQ;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.$HX()}},$12Z:function(n){_a.$3.$M(n,"offline store");var t=this.$1iQ;for(var i in t){var r={key:i,value:t[i]};var u=r.value;u.$12Z()}$6TE(this)},$7fA:function(n,t){var i=new _e.$RG(n,t);$1By(this,new _e.$Yr(n,i,t,this.$S));$1By(this,new _e.$nn(n,i,t,this.$S));$1By(this,new _e.$Q4(n,i,t,this.$S));$1By(this,new _e.$Rx(n,i,t,this.$S));$1By(this,new _e.$14D(n,i,t,this.$S));$1By(this,new _e.$13g(n,i,t,this.$S));$1By(this,new _e.$xY(n,i,t,this.$S));$1By(this,new _e.$Rl(n,i,t,this.$S))}};_e.$K0=function(n){this.$1L5=new(_0365f.$s.$$(String));_a.$3.$M(n,"emailCleanupContext");this.$6U=n};function $6U0(n,t,i){var r=this;n.get_$39p().$Da(t,_e.$1X.$54(n.$6U.$3Qa),function(r){if(r){n.$4nK=r.get_$1s();var u=t.$CU(_e.$1E.get_$L().$e1.get_$1Q());var f=new _a.$7m(null,null);u.$HQ(f,function(r){r.$F(function(n){},null);var u=[];$4QG(n,t,r,u,i)},null)}else i()},null)}function $4QG(n,t,i,r,u){var f=this;i.$CS(100,function(f,e,o){for(var s=0;s<e.length;++s){var h=n.get_$3Qf().$xM(e[s]);var c=h.get_$1s();var l=c.ConversationId.Id;if($6U1(n,c))if(n.$6U.$BM.get_$2KT()<50){n.$1L5.$H(l);var a;(a=n.$6U.$BM).set_$2KT(a.get_$2KT()+1);Array.add(r,h.get_$1y())}else{var v;(v=n.$6U.$BM).set_$2yr(v.get_$2yr()+1)}else n.$6U.$22u.set_$48(l,!0)}if(e.length===100)$4QG(n,t,i,r,u);else{_js.Trace.logInfo(_a.$0.$57,"Number of conversations left uncleaned in this batch is {0}",n.$6U.$BM.get_$2yr());n.get_$3Qf().$79J(t,r);u()}},null)}function $6U1(n,t){var i=n.get_$71X().get_$48(t.FolderId.Id);return $8(i)||_a.$7.$4Y(t.LastDeliveryTime).$55()<i}function $6Tz(n,t,i){var r=[];var u=this,f=this;n.get_$4Dn().$4wU(t,"ConversationItem",r,function(t){if(!n.$1L5.$6l(t.Id)&&!n.$6U.$22u.get_$48(t.Id)){n.$6U.$BM.set_$2KV(n.$6U.$BM.get_$2KV()+1);n.$1L5.$H(t.Id)}},function(){if(!n.$1L5.get_$F()){i();return}for(var u=0,r=0;r<n.$1L5.get_$F();r++)n.get_$4nD().$Da(t,_e.$1X.$54(n.$1L5.get_$48(r)),function(r){u++;if(r&&!n.$6U.$22u.get_$48(r.get_$1s().ConversationId.Id)){for(var l=r.get_$1s(),o=l.ConversationNodes,a=o.length,f=0;f<a;++f)for(var s=o[f],e=0;e<s.Items.length;e++){var h=s.Items[e];n.$6U.$2GL.set_$48(h.ItemId.Id,h)}var c;(c=n.$6U.$BM).set_$2yq(c.get_$2yq()+1);r.$27L(t)}u===n.$1L5.get_$F()&&i()},null)})}_e.$K0.prototype={$6U:null,$4nK:null,$2bT:null,get_$71X:function(){if(!this.$2bT){this.$2bT=_a.$5H.$$(Number).$8M();var t=this.$4nK.ModuleSpecificContext;if(t)for(var i=t,u=i.length,n=0;n<u;++n){var r=i[n];this.$2bT.set_$48(r.FolderId.Id,_a.$7.$4Y(r.OldestDeliveryTime).$55())}}return this.$2bT},get_$3Qf:function(){return this.$6U.$95.get_$Hh()},get_$4nD:function(){return this.$6U.$95.get_$Hi()},get_$39p:function(){return this.$6U.$95.get_$kC()},get_$4Dn:function(){return this.$6U.$95.get_$4Dm()},$2h9:function(n){_js.Trace.logInfo(_a.$0.$57,"Starting full module conversation cleanup");this.get_$3Qf().$l3(n);this.get_$4nD().$l3(n);this.get_$39p().$GW(n,_e.$1X.$54(this.$6U.$3Qa))},$40y:function(n,t){_js.Trace.logInfo(_a.$0.$57,"Starting periodic conversation cleanup");var i=this;$6U0(this,n,function(){i.$6U.$BM.set_$2RR(_e.$BY.get_$1iM()-i.$6U.$1Ps);_js.Trace.logInfo(_a.$0.$57,"Completed cleaning conversations, number cleaned = {0}, time taken = {1} ms",i.$6U.$BM.get_$2KT(),i.$6U.$BM.get_$2RR());$6Tz(i,n,function(){i.$6U.$BM.set_$3AM(_e.$BY.get_$1iM()-(i.$6U.$1Ps+i.$6U.$BM.get_$2RR()));_js.Trace.logInfo(_a.$0.$57,"Completed cleaning conversation nodes, number cleaned = {0}, time taken = {1} ms",i.$6U.$BM.get_$2yq(),i.$6U.$BM.get_$3AM());t()})})}};function CustomSyncData(n,t){this.IsDataSynced=n;this.ItemShape=t}CustomSyncData.prototype={IsDataSynced:null,ItemShape:0};_e.$48=function(n){_e.$48.initializeBase(this,[1,"EmailCleanup"]);$1O(this,_e.$48.$4kq,_a.$ez.toString(n))};_e.$48.prototype={get_$3Ak:function(){return this.$W(_e.$48.$4Dw)||0},set_$3Ak:function(n){$1O(this,_e.$48.$4Dw,n);return n},get_$66s:function(){return this.$W(_e.$48.$4Dv)||0},set_$66s:function(n){$1O(this,_e.$48.$4Dv,n);return n},get_$2RR:function(){return this.$W(_e.$48.$4DK)||0},set_$2RR:function(n){$1O(this,_e.$48.$4DK,n);return n},get_$2KT:function(){return this.$W(_e.$48.$3wr)||0},set_$2KT:function(n){$1O(this,_e.$48.$3wr,n);return n},get_$2yr:function(){return this.$W(_e.$48.$3ws)||0},set_$2yr:function(n){$1O(this,_e.$48.$3ws,n);return n},get_$3AM:function(){return this.$W(_e.$48.$4DJ)||0},set_$3AM:function(n){$1O(this,_e.$48.$4DJ,n);return n},get_$2yq:function(){return this.$W(_e.$48.$3wq)||0},set_$2yq:function(n){$1O(this,_e.$48.$3wq,n);return n},get_$4DI:function(){return this.$W(_e.$48.$4DL)||0},set_$4DI:function(n){$1O(this,_e.$48.$4DL,n);return n},get_$1YC:function(){return this.$W(_e.$48.$3wu)||0},set_$1YC:function(n){$1O(this,_e.$48.$3wu,n);return n},get_$99g:function(){return this.$W(_e.$48.$4DH)||0},set_$99g:function(n){$1O(this,_e.$48.$4DH,n);return n},get_$5fH:function(){return this.$W(_e.$48.$3wt)||0},set_$5fH:function(n){$1O(this,_e.$48.$3wt,n);return n},get_$2KV:function(){return this.$W(_e.$48.$3wv)||0},set_$2KV:function(n){$1O(this,_e.$48.$3wv,n);return n}};_e.$yp=function(n,t,i,r,u,f,e,o,s){this.$22u=_a.$5H.$$(Boolean).$8M();this.$2GL=_a.$5H.$$(_g.$7q).$8M();this.$27I=_a.$5H.$$(Boolean).$8M();_a.$3.$M(t,"itemStoreGetter");_a.$3.$1C(i,"converationSyncStateId");_a.$3.$1C(r,"messageSyncStateId");_a.$3.$M(u,"folderMappings");_a.$3.$M(f,"datapointTracker");_a.$3.$6v(e,0,2147483647,"syncMinimum");_a.$3.$6v(o,0,2147483647,"syncWindow");_a.$3.$M(s,"localStorageAdapter");this.$3PN=n;this.$95=t;this.$3Qa=i;this.$3mt=r;this.$4xY=u;this.$hk=f;this.$11y=e;this.$1ze=o;this.$1VN=s;this.$BM=new _e.$48(n)};_e.$yp.prototype={$11y:0,$1ze:0,$3PN:0,$3Qa:null,$3mt:null,$95:null,$4xY:null,$hk:null,$BM:null,$1Ps:0,$1VN:null,$97A:function(){this.$hk.get_$2l()&&this.$hk.$A7(this.$BM)}};_e.$BY=function(n){_e.$BY.initializeBase(this);_a.$3.$M(n,"emailCleanupContext");this.$lf=n};_e.$BY.get_$1iM=function(){return _a.$7.get_$2M().$55()};_e.$BY.$9JK=function(n,t,i,r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];i.$GW(t,o)}};function $6US(n,t){_js.Trace.logInfo(_a.$0.$57,"Starting full module email cleanup because of cleanupType = {0}",_a.$ez.toString(n.$lf.$3PN));n.get_$4n7().$2h9(t);n.get_$5Ja().$2h9(t);n.get_$4gn().$2h9(t)}function $6UT(n,t){_js.Trace.logInfo(_a.$0.$57,"Starting periodic email cleanup");n.$lf.$1Ps=_e.$BY.get_$1iM();var i=this;n.get_$4n7().$40y(t,function(){n.get_$5Ja().$40y(t,function(){n.get_$4gn().$40y(t,n.$lf,function(){n.$lf.$BM.set_$3Ak(_e.$BY.get_$1iM()-n.$lf.$1Ps);_js.Trace.logInfo(_a.$0.$57,"Completed full cleanup (before transaction complete), time taken {0} ms",n.$lf.$BM.get_$66s())})})})}_e.$BY.prototype={$lf:null,$3Qb:null,$3mo:null,$1fp:null,$1D0:null,$3eF:null,get_$4n7:function(){this.$3Qb||(this.$3Qb=new _e.$K0(this.$lf));return this.$3Qb},get_$5Ja:function(){this.$3mo||(this.$3mo=new _e.$EG(this.$lf));return this.$3mo},get_$6td:function(){this.$1D0||(this.$1D0=this.$lf.$95.get_$1Cz());return this.$1D0},get_$7Vt:function(){this.$3eF||(this.$3eF=this.$lf.$95.get_$3eD());return this.$3eF},get_$4gn:function(){this.$1fp||(this.$1fp=new _e.$jL(this.get_$6td(),this.get_$7Vt()));return this.$1fp},$5nz:function(n){_a.$3.$M(n,"tx");switch(this.$lf.$3PN){case 2:$6UT(this,n);break;case 4:case 1:case 3:$6US(this,n);break;default:break}}};_e.$EG=function(n){this.$3YK=_a.$5H.$$(Boolean).$8M();_a.$3.$M(n,"emailCleanupContext");this.$6U=n};function $6VJ(n,t,i){var r=this;n.get_$39p().$Da(t,_e.$1X.$54(n.$6U.$3mt),function(r){if(r){var u=_a.$1U.$9Iv(MultiFolderSyncState,r.get_$1s());n.$40v=u.PerFolderSyncStateContainer;var s=0;var f=[];var e=u.PerFolderSyncStateContainer;for(var o in e){var h={key:o,value:e[o]};Array.add(f,h.value)}$4Qp(n,t,f,s,function(){$6VL(n,t,function(){i()})})}else i()},null)}function $4Qp(n,t,i,r,u){if(!i.length){u();return}var f=this;$6VK(n,t,i[r],function(){var f=i[r].Id;n.$3YK.set_$48(f,!0);r++;r===i.length?u():$4Qp(n,t,i,r,u)})}function $6VL(n,t,i){var r=[];var u=this,f=this;n.get_$4Dn().$4wU(t,"MessageItem",r,function(t){n.$6U.$BM.set_$2KV(n.$6U.$BM.get_$2KV()+1);n.$6U.$2GL.set_$48(t.Id,t.Data)},function(){n.$6U.$2GL.$9J4(function(i,r){var u;var f,e;if(e=$4Qq(n,r,f={val:u}),u=f.val,e){var o;(o=n.$6U.$BM).set_$1YC(o.get_$1YC()+1);var s=_e.$1X.$54(r.ItemId.Id);n.$6U.$27I.set_$48(r.ItemId.Id,!0);n.get_$2rY().$GW(t,s)}});i()})}function $6VK(n,t,i,r){_js.Trace.logInfo(_a.$0.$57,"Starting to cleanup messages for folder {0}",i.Id);var u=i.Id;var f=t.$CU(_e.$1E.get_$L().$si.get_$1Q());var e=new _a.$86(MessageItemMetadata.$1KC(),u);var o=new _a.$7m(e,[new _a.$Gy(MessageItemMetadata.$1z2(),0)]);var s=this;f.$HQ(o,function(i){var u=[];$4Qo(n,t,i,u,function(){_e.$BY.$9JK(_bc.$KG,t,n.get_$2rY(),u);r()})},null)}function $4Qo(n,t,i,r,u){var f=this;i.$CS(10,function(f,e,o){for(var s=!1,h=0;h<e.length;++h){var l=n.get_$2rY().$xM(e[h]);var c=l.get_$1s();s=!1;var a,v;if(v=$4Qq(n,c,a={val:s}),s=a.val,v){var y;(y=n.$6U.$BM).set_$1YC(y.get_$1YC()+1);n.$6U.$2GL.$3Q(c.ItemId.Id);n.$6U.$27I.set_$48(c.ItemId.Id,!0);Array.add(r,l.get_$1y())}if(!s)break}e.length===10&&n.$6U.$BM.get_$1YC()<150&&s?$4Qo(n,t,i,r,u):u()},null)}function $4Qq(n,t,i){if(n.$6U.$4xY.idToName(t.ParentFolderId)==="outbox"){i.val=!1;return!1}var u=n.$40v?n.$40v[t.ParentFolderId.Id]:null;var f=u?u.ModuleSpecificContext:null;var r;if(f){r=_a.$7.$4Y(t.DateTimeReceived).$55()>=_a.$7.$4Y(f.OldestReceivedTime).$55();i.val=!r}else{r=!1;i.val=!1}return!r&&!n.$6U.$22u.$Lg(t.ConversationId.Id)&&!n.$3YK.$Lg(t.ParentFolderId.Id)}_e.$EG.prototype={$6U:null,$40v:null,get_$2rY:function(){return this.$6U.$95.get_$4i()},get_$39p:function(){return this.$6U.$95.get_$kC()},get_$4Dn:function(){return this.$6U.$95.get_$4Dm()},$2h9:function(n){_js.Trace.logInfo(_a.$0.$57,"Performing full module message cleanup");this.get_$2rY().$l3(n);this.get_$39p().$GW(n,_e.$1X.$54(this.$6U.$3mt))},$40y:function(n,t){_js.Trace.logInfo(_a.$0.$57,"Starting periodic message cleanup");var i=this;$6VJ(this,n,function(){i.$6U.$BM.set_$4DI(_e.$BY.get_$1iM()-(i.$6U.$1Ps+i.$6U.$BM.get_$2RR()+i.$6U.$BM.get_$3AM()));_js.Trace.logInfo(_a.$0.$57,"Completed cleaning messages, number cleaned = {0}, time taken = {1} ms",i.$6U.$BM.get_$1YC(),i.$6U.$BM.get_$4DI());t()})}};_e.$LE=function(n,t){_e.$LE.$$(this.$$gta["_e.$LE"].TItem,this.$$gta["_e.$LE"].TCreate).initializeBase(this);_a.$3.$M(n,"itemStore");_a.$3.$M(t,"creates");this.$FP=n;this.$3SE=t};_e.$LE.$$=function(n,t){var i="$LE"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$LE"]={TItem:n,TCreate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$LE.apply(this,r)};u.registerClass("_e."+i,_e.$3E);var f=_e.$LE.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$LE.prototype={$FP:null,$3SE:null,get_$5Ep:function(){return this.$FP},get_$9JQ:function(){return this.$3SE},$5nz:function(n){_a.$3.$M(n,"tx");this.$FP.$l3(n);_e.$3E.$9IB(this.$$gta["_e.$LE"].TItem,this.$$gta["_e.$LE"].TCreate,this.$FP,n,this.$3SE,null)}};_e.$Yq=function(n,t){_e.$Yq.initializeBase(this,[n,t])};_e.$Yq.prototype={$2Bh:function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"folderId");_a.$3.$6v(i,0,2147483647,"totalCount");_a.$3.$6v(r,0,2147483647,"unreadCount");var u=this;this.$Da(n,_e.$1X.$54(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$Jo,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1U.$9Iv(_g.$D9,u.get_$1s());f.TotalCount+=i;f.UnreadCount+=r;u.$Cn(n,null)},null)},$4r4:function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"folderId");_a.$3.$6v(i,0,2147483647,"totalCount");_a.$3.$6v(r,0,2147483647,"unreadCount");var u=this;this.$Da(n,_e.$1X.$54(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$Jo,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1U.$9Iv(_g.$D9,u.get_$1s());f.TotalCount>=i?f.TotalCount-=i:_js.Trace.logError(_a.$0.$Jo,"Folder {0} total count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.TotalCount);f.UnreadCount>=r?f.UnreadCount-=r:_js.Trace.logError(_a.$0.$Jo,"Folder {0} unread count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.UnreadCount);u.$Cn(n,null)},null)},$693:function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"folderId");_a.$3.$6v(i,0,2147483647,"totalCount");_a.$3.$6v(r,0,2147483647,"unreadCount");var u=this;this.$Da(n,_e.$1X.$54(t.Id),function(t){if(t){var u=t.get_$1s();!$8(i)&&i>=0?u.TotalCount=i:_js.Trace.logError(_a.$0.$Jo,"Folder {0} total count is being updated to an invalid value {1}",u.DisplayName,i);u.__type===_g.$D9._dataContractName&&(!$8(r)&&r>=0?u.UnreadCount=r:_js.Trace.logError(_a.$0.$Jo,"Folder {0} unread count is being updated to an invalid value {1}",u.DisplayName,r));t.$Cn(n,null)}},null)},$7KJ:function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"folderId");var r=this;this.$Da(n,_e.$1X.$54(t.Id),function(n){if(!n){_js.Trace.logWarning(_a.$0.$Jo,"Folder with id {0} not found in client store",t.Id);return}var r=_a.$1U.$9Iv(_g.$D9,n.get_$1s());i(r.TotalCount,r.UnreadCount)},null)}};_e.$RG=function(n,t){_a.$3.$M(n,"clientStore");_a.$3.$1C(t,"timeZoneId");this.$6T=n;this.$6t=t;var i=this;this.$2B=new(_0365f.$3k.$$(_bc.$11j))(function(){return new _e.$Yq(i.$6T,i.$6t)});var r=this;this.$4xU=new(_0365f.$3k.$$(_bc.$11i))(function(){return new _e.$Qk(r.$6T,r.$6t)});var u=this;this.$2PL=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$sa)))(function(){return new(_e.$7E.$$(_bc.$sa,_e.$5l))(u.$6T,u.$6t)});var f=this;this.$uw=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$m4)))(function(){return new(_e.$7E.$$(_bc.$m4,_e.$Jg))(f.$6T,f.$6t)});var e=this;this.$3r=new(_0365f.$3k.$$(_bc.$11Q))(function(){return new _e.$OA(e.$6T,e.$6t)});var o=this;this.$4P=new(_0365f.$3k.$$(_bc.$123))(function(){return new _e.$gp(o.$6T,o.$6t)});var s=this;this.$5mR=new(_0365f.$3k.$$(_bc.$12N))(function(){return new _e.$14E(s.$6T,s.$6t)});var h=this;this.$66m=new(_0365f.$3k.$$(_bc.$12n))(function(){return new _e.$vG(h.$6T,h.$6t)});var c=this;this.$4gw=new(_0365f.$3k.$$(IAttachmentInfoItemStore))(function(){return new _e.$pN(c.$6T,c.$6t)});var l=this;this.$57K=new(_0365f.$3k.$$(IInlineImageItemStore))(function(){return new _e.$sH(l.$6T,l.$6t)});var a=this;this.$6P=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$g3)))(function(){return new(_e.$7E.$$(_bc.$g3,_e.$Ma))(a.$6T,a.$6t)});var v=this;this.$Fs=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$KB)))(function(){return new(_e.$7E.$$(_bc.$KB,_e.$5f))(v.$6T,v.$6t)});var y=this;this.$4j9=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$JF)))(function(){return new(_e.$7E.$$(_bc.$JF,_e.$Ch))(y.$6T,y.$6t)});var p=this;this.$4m4=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$lU)))(function(){return new(_e.$7E.$$(_bc.$lU,_e.$Jx))(p.$6T,p.$6t)});var w=this;this.$5nD=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$lx)))(function(){return new(_e.$7E.$$(_bc.$lx,_e.$2M))(w.$6T,w.$6t)});var b=this;this.$4eM=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$rb)))(function(){return new(_e.$7E.$$(_bc.$rb,_e.$vn))(b.$6T,b.$6t)});var k=this;this.$4eN=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$rc)))(function(){return new(_e.$7E.$$(_bc.$rc,_e.$vo))(k.$6T,k.$6t)});var d=this;this.$66P=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$gV)))(function(){return new(_e.$7E.$$(_bc.$gV,_e.$Nq))(d.$6T,d.$6t)});var g=this;this.$5sc=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$Um)))(function(){return new(_e.$7E.$$(_bc.$Um,_e.$9k))(g.$6T,g.$6t)});var nt=this;this.$5nm=new(_0365f.$3k.$$(_bc.$B1.$$(_bc.$aF)))(function(){return new(_e.$7E.$$(_bc.$aF,_e.$FW))(nt.$6T,nt.$6t)});var tt=this;this.$5oK=new(_0365f.$3k.$$(_bc.$12P))(function(){return _e.$5T.$I(tt)})};_e.$RG.prototype={$6T:null,$6t:null,$2B:null,$4xU:null,$2PL:null,$uw:null,$3r:null,$4P:null,$5mR:null,$66m:null,$4gw:null,$57K:null,$6P:null,$Fs:null,$4j9:null,$4m4:null,$5nD:null,$4eM:null,$4eN:null,$66P:null,$5sc:null,$5nm:null,$5oK:null,get_$57:function(){return this.$6T},get_$2j:function(){return this.$2B.get_$1d()},get_$4xV:function(){return this.$4xU.get_$1d()},get_$605:function(){return this.$2PL.get_$1d()},get_$kC:function(){return this.$uw.get_$1d()},get_$1Cz:function(){return this.$4gw.get_$1d()},get_$3eD:function(){return this.$57K.get_$1d()},get_$Hh:function(){return this.$3r.get_$1d()},get_$Hi:function(){return this.$6P.get_$1d()},get_$1o:function(){return this.$Fs.get_$1d()},get_$hL:function(){return this.$4j9.get_$1d()},get_$4i:function(){return this.$4P.get_$1d()},get_$ch:function(){return this.$5mR.get_$1d()},get_$jj:function(){return this.$5sc.get_$1d()},get_$4Dm:function(){return this.$66m.get_$1d()},get_$3Q1:function(){return this.$4m4.get_$1d()},get_$5nE:function(){return this.$5nD.get_$1d()},get_$6ql:function(){return this.$4eM.get_$1d()},get_$6qm:function(){return this.$4eN.get_$1d()},get_$206:function(){return this.$66P.get_$1d()},get_$40j:function(){return this.$5nm.get_$1d()},get_$1v:function(){return this.$5oK.get_$1d()},$AK:function(n,t,i,r){this.$6T.get_$wQ().$AK(n,t,i,r)}};_e.$sj=function(n){this.$6T=n};_e.$sj.prototype={$6T:null,$I:function(n){return new _e.$RG(this.$6T,n)}};_e.$Us=function(n,t,i){this.$1LT=1;_e.$Us.$$(this.$$gta["_e.$Us"].TItem,this.$$gta["_e.$Us"].TUpdate).initializeBase(this);_a.$3.$M(n,"itemStore");_a.$3.$M(t,"updates");_a.$3.$M(i,"deletedIds");this.$FP=n;this.$1ND=t;this.$1if=i};_e.$Us.$$=function(n,t){var i="$Us"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$Us"]={TItem:n,TUpdate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$Us.apply(this,r)};u.registerClass("_e."+i,_e.$3E,_e.$sV);var f=_e.$Us.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$Us.prototype={$FP:null,$1if:null,$1ND:null,$wd:null,$2pK:null,get_$9JL:function(){return this.$1LT},set_$9JL:function(n){this.$1LT=n;return n},get_$4sJ:function(){return this.$wd?_0365f.$57.$F(this.$wd):0},get_$33d:function(){return this.$2pK?this.$2pK.length:0},get_$5Ep:function(){return this.$FP},get_$9JM:function(){return this.$1ND},set_$9JM:function(n){this.$1ND=n;return n},get_$9JN:function(){return this.$1if},$5nz:function(n){_a.$3.$M(n,"tx");this.$412(n,null)},$9JO:function(n){_a.$3.$8z(this.$1LT!==1&&!!this.$1LT,"This method should not be used to persist changes in sync code or service command");var t=this,r=this,i=this;this.$FP.$AK(new _a.$6L("ItemSyncChangeUpdater.PersistChangesFromNonSyncSources",!1),function(n){t.$5nz(n)},function(){_e.$1W.$gK(n)},function(n){_js.Trace.logWarning(_e.$1a.$D,"Unable to save non sync data to the clientStore. SaveMode={0}, error={1}",i.$1LT,n.$4P)})},$412:function(n,t){_a.$3.$M(n,"tx");var i=!1;var r=!1;var f=this;var u=function(){i&&r&&_e.$1W.$gK(t)};var e=this;_e.$3E.$9IC(this.$$gta["_e.$Us"].TItem,this.$$gta["_e.$Us"].TUpdate,this.$FP,n,this.$1ND,function(){i=!0;u()},this.$1LT);var o=this;_e.$3E.$9IF(this.$$gta["_e.$Us"].TItem,n,this.$FP,this.$1if,function(){r=!0;u()})},$8oH:function(n,t,i){this.$wd={};_e.$3E.$8oH(this.$$gta["_e.$Us"].TItem,n,this.$FP,t,this.$wd,i)},$8kN:function(n){if(this.$2pK)for(var i=this.$2pK,r=i.length,t=0;t<r;++t){var u=i[t];var f=this;_e.$3E.$9ID(this.$$gta["_e.$Us"].TItem,this.$$gta["_e.$Us"].TUpdate,this.$FP,n,u,null,function(n){})}},$9JP:function(n){if(this.$1LT===1){var t=new _a.$Li(_e.$w.$2O9,10,1,0);this.$FP.$1ia(n,t,null)}}};_e.$GB=function(){_e.$GB.initializeBase(this)};_e.$GB.$1SQ=function(n){return n.OutboxItemContext};_e.$GB.$5yr=function(n,t,i,r){_js.Trace.logInfo(r,"SetOutboxItemActionId: ItemId {0} Action Id {1}",t.Id,i);n.$AK(new _a.$6L("OutboxItem.SetActionId",!1),function(u){n.$Da(u,_e.$1X.$54(t.Id),function(n){if(!n||!n.get_$1s()){var f=String.format("Unable to set Action id. Outbox item {0} was not found in the client store",t.Id);_js.Trace.logError(r,f);throw Error.invalidOperation(f);}_js.Trace.logInfo(r,"SetOutboxItemActionId - Item found: {0}. Updating actionId={1}",t.Id,i);n.get_$SW().ActionId=i;n.$Cn(u,null)},null)},function(){},function(n){_e.$1W.$BC(n,function(n){_e.$GB.$7Rq(n,t,i,r)})})};_e.$GB.$7Rq=function(n,t,i,r){var u=String.format("Unable to set Action id. Error '{0}' ItemId {1} Action Id {2}",n.get_$4i(),t.Id,i.toString());_js.Trace.logError(r,u);throw Error.invalidOperation(u);};_e.$GB.$2SF=function(n,t,i,r,u,f){_a.$3.$M(n,"transaction");_a.$3.$M(i,"outboxItemStore");_a.$3.$M(i,"outboxItemId");_js.Trace.logInfo(r,"UpdateOutboxItemContext: OutboxItem Id={0} responseCode={1} sendAction={2} ",i.Id,u,f);t.$Da(n,_e.$1X.$54(i.Id),function(t){if(!t){var e=String.format("Unable to update outbox context. Outbox item {0} was not found in the client store",i.Id);_js.Trace.logError(r,e);throw Error.invalidOperation(e);}if(f!==undefined){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating sendAction={1}.",i.Id,f);t.get_$SW().SendAction=f}if(t.get_$SW().LastResponseCode==="NoError"||u!=="ErrorInvalidIdMalformed"){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating responseCode={1}.",i.Id,u);t.get_$SW().LastResponseCode=u}t.$Cn(n,null)},null)};_e.$GB.prototype={get_$SW:function(){return _e.$GB.$1SQ(this.get_$1s())},get_$e0:function(){return _e.$1E.get_$L().$1v6},$7Uz:function(n,t,i,r){var u=new _bc.OutboxItemContext;u.SendAction=n;u.ParentConversationNodeId=t;u.ComplianceId=i;u.LastResponseCode=r;this.get_$1s().OutboxItemContext=u},$8qW:function(){this.get_$1s().OutboxItemContext=undefined}};_e.$14E=function(n,t){_e.$14E.initializeBase(this,[n,t])};_e.$14E.prototype={get_$us:function(){return _e.$1E.get_$L().$1v6.get_$1Q()},$68y:function(n,t,i,r){_e.$GB.$2SF(n,this,t,i,r)},$52d:function(n,t){var i=this;this.get_$9Je().$Da(n,_e.$1X.$54(this.get_$n()),function(n){var i=0;n&&(i=n.get_$1s().TotalCount);t(i)},null)},$42i:function(n,t){for(var i=0;i<n.length;++i){var r=this.$xM(n[i]);var u=r.get_$1s();Array.add(t,u)}_js.Trace.logInfo(_e.$1a.$D,"GetItems: Returning {0} results to the caller",t.length)}};_e.$FW=function(){_e.$FW.initializeBase(this)};_e.$FW.$1Sg=function(n,t,i){_a.$3.$M(n,"peopleFilterItemStore");_a.$3.$M(t,"successCallback");_a.$3.$M(i,"errorCallback");var r=[];n.$AK(new _a.$6L("PeopleFilterItem.GetPeopleFilters"),function(t){var i=t.$CU(_e.$1E.get_$L().$2Lj.get_$1Q());var u=new _a.$4U("Data.SortGroupPriority");var f=new _a.$7m(null,[new _a.$Gy(u,0)]);i.$HQ(f,function(t){t.$CS(100,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$xM(i[f]))},null)},null)},function(){t(r)},function(n){_e.$1W.$BC(n,i)})};function $3GI(n,t){var i=_g.$1v.$46(t.FolderId);if(_g.$3J.isInstanceOfType(i)){var r=i;return r.Id}else if(_g.$L2.isInstanceOfType(i)){var u=i;return u.Id}else throw Error.invalidOperation("unpexpected type for data.FolderId: "+i.__type);}_e.$FW.prototype={get_$e0:function(){return _e.$1E.get_$L().$2Lj},$3Zf:function(){return $3GI(this,this.get_$1s())},$9GG:function(n){_a.$3.$M(n.FolderId,"FolderId");var t=$3GI(this,n);_a.$3.$1C(t,"Id")},$7ET:function(n){return _e.$1X.$54($3GI(this,n))},$7EX:function(n){return new ItemMetadata}};function PersistedDataRecord(){}PersistedDataRecord.prototype={Data:null,Metadata:null};_e.$w=function(){this.$$d_$27L=Function.createDelegate(this,this.$27L)};_e.$w.$lp=function(n,t,i,r){_a.$3.$M(t,"store");_a.$3.$M(i,"data");_a.$3.$1C(r,"dataTimeZoneId");var u=new n;u.$68j(i);u.$16B(t,u.$9Cn(i),i,r,r);return u};_e.$w.$xM=function(n,t,i,r){_a.$3.$M(t,"store");_a.$3.$M(i,"e");_a.$3.$M(r,"destinationTimeZoneId");return _e.$w.$9Hx(n,t,i.$5U,i.$24,r)};_e.$w.$Da=function(n,t,i,r,u,f){_a.$3.$M(i,"tx");_a.$3.$M(t,"store");_a.$3.$M(r,"id");_a.$3.$M(u,"destinationTimeZoneId");_a.$3.$M(f,"successCallback");var e=new n;var o=i.$CU(e.get_$e0().get_$1Q());_e.$w.$3ec(e,t,o,r,u,function(n){f(n)},null)};_e.$w.$6ua=function(n,t,i,r,u,f,e){_a.$3.$M(t,"store");_a.$3.$M(i,"tx");_a.$3.$M(r,"ids");_a.$3.$M(u,"destinationTimeZoneId");_a.$3.$M(f,"successCallback");for(var s=[],h=0,c=i.$CU(_e.$w.$9Hy(n)),o=0;o<r.length;++o){var l=new n;_e.$w.$3ec(l,t,c,r[o],u,function(n){n&&Array.add(s,n);++h===r.length&&f(s)},function(n){e(n)})}};_e.$w.$1BX=function(n,t,i,r,u,f){_a.$3.$M(t,"store");_a.$3.$M(i,"tx");_a.$3.$M(r,"id");_a.$3.$M(f,"updaterCallback");var e=new n;_e.$w.$7Wt(e,t,i,r,u,f)};_e.$w.$9Hv=function(n,t,i,r){_a.$3.$M(t,"tx");_a.$3.$M(i,"id");_e.$w.$57x(t,i,_e.$w.$9Hy(n),r)};_e.$w.$1ia=function(n,t,i,r){_a.$3.$M(t,"tx");_a.$3.$M(i,"filter");var u=new(_0365f.$s.$$(_a.$Lr));_e.$w.$9Hw(n,t,i,100,function(t,i,f,e){f.length&&u.$6G(f);if(e){var h=n.getName();if(u.get_$F())for(var c=0,o=0;o<u.get_$F();o++){var s=u.get_$48(o);i.$eA(s,function(){++c===u.get_$F()&&r&&r()},function(n){_js.Trace.logError(_e.$w.$D,"DeleteByFilterIn<{0}>: An error occured during deleting item #{1} (Id: {2}; Error: {3}-{4}).",h,o,s,n.$SU,n.$4P)})}else r&&r()}},null)};_e.$w.$5rO=function(n,t,i,r,u,f){_a.$3.$M(t,"tx");if(r<1)throw Error.argumentOutOfRange("batchSize",r,"Batch size should be a positive integer.");var o=_e.$w.$9Hy(n);var e=t.$CU(o);e.$HQ(i,function(n){_e.$w.$5Es(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$w.$9Hw=function(n,t,i,r,u,f){_a.$3.$M(t,"tx");_a.$3.$M(i,"filter");var o=_e.$w.$9Hy(n);var e=t.$CU(o);e.$3dH(i,function(n){_e.$w.$5Er(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$w.$l3=function(n,t){_a.$3.$M(t,"tx");_e.$w.$57t(t,_e.$w.$9Hy(n))};_e.$w.$9Hx=function(n,t,i,r,u){var f=new n;f.$16B(t,_e.$1X.$3Yf(i),r.Data,_e.$1a.$6t,u);return f};_e.$w.$9Hy=function(n){var t=new n;return t.get_$e0().get_$1Q()};_e.$w.$57x=function(n,t,i,r){var u=n.$CU(i);u.$eA(t.$3Ae(),r,null)};_e.$w.$5Es=function(n,t,i,r){n.$CS(t,function(u,f,e){i(u,f,e);e||_e.$w.$5Es(n,t,i,r)},r)};_e.$w.$5Er=function(n,t,i,r){n.$CS(t,function(u,f,e){i(u,f,e);e||_e.$w.$5Er(n,t,i,r)},r)};_e.$w.$57t=function(n,t){var i=n.$CU(t);i.$1u(null,null)};_e.$w.$3ec=function(n,t,i,r,u,f,e){i.$3k(r.$3Ae(),function(i){var e=i;if(e){n.$16B(t,r,e.Data,_e.$1a.$6t,u);f(n)}else f(null)},function(n){_e.$1W.$BC(n,e)})};_e.$w.$7Wt=function(n,t,i,r,u,f){var e=i.$CU(n.get_$e0().get_$1Q());_e.$w.$3ec(n,t,e,r,u,function(n){var t=n?n.$x:null;f(t);n&&n.$Cn(i,null)},null)};function $6VF(n,t){var i;var r=new PersistedDataRecord;r.Data=n.$x;if(n.$6t!==t){i=_0365f.$57.$46(r);n.$9Cm(i.Data,n.$6t,t)}else i=r;return i}function $6VG(n,t,i){var r=_a.$7.$eV(_a.$7.get_utcNow());switch(i){case 1:_e.$w.$5Fo.$1xz(t,r);break;default:_e.$w.$5Fk.$1xz(t,r);break}_e.$w.$2O9.$1xz(t,i)}function $6VH(n,t){for(var e=n.get_$e0().get_$2Bl(),s=e.length,u=0;u<s;++u)for(var h=e[u],o=h.$28x,c=o.length,f=0;f<c;++f){var i=o[f];var r=i.$5M.$15Z(t);if(r){if(Number.isInstanceOfType(r)){if(i.$7b!==1)throw Error.argumentType(i.$5M.$5M,Object.getType(r),Number);}else if(String.isInstanceOfType(r)&&i.$7b)throw Error.argumentType(i.$5M.$5M,Object.getType(r),String);}else i.$5M.$1xz(t,_a.$gY.$78G(i.$7b))}}_e.$w.prototype={$x:null,$6t:null,$64:null,$5U:null,get_$1y:function(){return this.$5U},get_$4F5:function(){return this.$x},$Cn:function(n,t){this.$68j(this.$x);this.$35R(n,0,t)},$27L:function(n){_a.$3.$M(n,"tx");_e.$w.$57x(n,this.$5U,this.get_$e0().get_$1Q(),null)},$35R:function(n,t,i){_a.$3.$M(n,"tx");var r=$6VF(this,_e.$1a.$6t);$6VG(this,r,t);r.Metadata=this.$9Co(r.Data);$6VH(this,r);var u=n.$CU(this.get_$e0().get_$1Q());var f=this;u.$8oG(this.$5U.$3Ae(),r,function(n){_e.$1W.$9I9(_a.$lT,_e.$1X.$3Yf(n),i)},null)},$16B:function(n,t,i,r,u){_a.$3.$M(n,"store");_a.$3.$M(i,"data");_a.$3.$M(t,"id");_a.$3.$1C(r,"sourceTimeZoneId");_a.$3.$1C(u,"destinationTimeZoneId");this.$64=n;this.$5U=t;this.$x=i;this.$6t=u}};_e.$ok=function(){_e.$ok.$$(this.$$gta["_e.$ok"].R).initializeBase(this)};_e.$ok.$$=function(n){var t="$ok"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$ok"]={R:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$ok.apply(this,i)};r.registerClass("_e."+t,_e.$w,_bc.$m8.$$(n),_bc.$11w);var u=_e.$ok.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$ok.prototype={get_$1s:function(){return this.$x},$9Cn:function(n){return this.$7ET(n)},$9Co:function(n){return this.$7EX(n)},$68j:function(n){this.$9GG(n)},$9Cm:function(n,t,i){this.$4kO(n,t,i)},$16B:function(n,t,i,r,u){_e.$w.prototype.$16B.call(this,n,t,i,r,u);this.$4kO(this.get_$1s(),r,u)},$4kO:function(n,t,i){var u=this.$$gta["_e.$ok"].R;var f="changeTimeZone";var r=u[f];$8(r)||r(n,t,i,this.$64.get_$Vz())}};_e.$9k=function(){_e.$9k.initializeBase(this)};_e.$9k.$15f=function(n,t,i,r,u,f){_a.$3.$M(n,"reminderItemStore");_a.$3.$M(u,"successCallback");_a.$3.$6v(t,_e.$9k.$5d2,_e.$9k.$2rD,"maxRemindersToReturn");_a.$3.$1C(r,"endTime");_js.$8.$c(i)&&(i=_a.$7.$Eb(new _a.$7(0,1,1)));if(_a.$7.$4Y(i).$2Y(_a.$7.$4Y(r))>0)throw Error.argumentOutOfRange("beginTime","beginTime is greater than endTime");t||(t=_e.$9k.$2rD);var e=[];n.$AK(new _a.$6L("ReminderItem.GetReminders"),function(u){var s=u.$CU(_e.$1E.get_$L().$1L3.get_$1Q());var o=_e.$9k.$444;var h=new _a.$Ut(o,n.$2hu(i),n.$2hu(r),0);var c=new _a.$7m(h,[new _a.$Gy(o,0)]);s.$HQ(c,function(i){i.$CS(t,function(t,i,r){for(var u=0;u<i.length;++u)Array.add(e,n.$xM(i[u]))},_e.$1W.$WX(f))},_e.$1W.$WX(f))},function(){u(e)},_e.$1W.$WX(f))};_e.$9k.prototype={get_$e0:function(){return _e.$1E.get_$L().$1L3},$9GG:function(n){_a.$3.$M(n.ItemId,"ReminderType.ItemId");_a.$3.$M(n.UID,"ReminderType.UID");_a.$3.$1C(n.ItemId.Id,"ReminderType.ItemId.Id");_a.$3.$1C(n.ReminderTime,"ReminderType.ReminderTime")},$7ET:function(n){return _e.$1X.$54(n.ItemId.Id)},$7EX:function(n){return new ItemMetadata}};_e.$1X=function(n){this.$5U=new _a.$Lr(n)};_e.$1X.$54=function(n){_a.$3.$1C(n,"id");return new _e.$1X(n)};_e.$1X.$4yM=function(n){return new _e.$1X(n)};_e.$1X.$5eI=function(){return new _e.$1X(null)};_e.$1X.$3Yf=function(n){return new _e.$1X(n.$SH())};_e.$1X.prototype={$5U:null,get_$1V2:function(){return this.$5U.$SH()},$3Ae:function(){return this.$5U},toString:function(){return this.$5U.toString()}};_e.$F3=function(){_e.$F3.initializeBase(this)};_e.$F3.$3gh=function(n){_a.$3.$M(n,"actionRecord");_a.$3.$M(n.request,"actionRecord.Request");return n.request.methodName!=="LogDatapoint"};_e.$F3.prototype={get_$e0:function(){return _e.$1E.get_$L().$vM},$7ET:function(n){return n.id?_e.$1X.$4yM(n.id):_e.$1X.$5eI()},$7EX:function(n){return new ActionItemMetadata(_e.$F3.$3gh(n))},$9GG:function(n){},$16B:function(n,t,i,r,u){var f=i;if(f.request.actionHandler){_js.Trace.logWarning(_a.$0.$YC,"An ActionItem with id={0} has an ActionHandler.  It is being removed.",t.get_$1V2());f=_0365f.$2t.$46(f,!0);f.request.actionHandler=null}_e.$ok.prototype.$16B.call(this,n,t,f,r,u)}};function ActionItemMetadata(n){ActionItemMetadata.initializeBase(this);this.IsHighPriority=n.toString()}ActionItemMetadata.$3gi=function(){return new _a.$4U("Metadata.IsHighPriority")};ActionItemMetadata.prototype={IsHighPriority:null};_e.$8U=function(){};_e.$8U.$72X=function(n,t){var i=new AddressbookOperation;i.Type=n;i.PersonaId=t;return i};_e.$8U.$4nu=function(n){_a.$3.$M(n,"persona");var t=new AddressbookPersona;t.PersonaId=_e.$8U.$4eO(n);$8(n.GivenName)||(t.FirstName=n.GivenName);$8(n.YomiFirstName)||(t.YomiFirstName=n.YomiFirstName);$8(n.MiddleName)||(t.MiddleName=n.MiddleName);$8(n.Surname)||(t.LastName=n.Surname);$8(n.YomiLastName)||(t.YomiLastName=n.YomiLastName);$8(n.DisplayNamePrefix)||(t.NamePrefix=n.DisplayNamePrefix);$8(n.Generation)||(t.NameSuffix=n.Generation);$8(n.Nickname)||(t.Nickname=n.Nickname);$8(n.DisplayName)||(t.DisplayName=n.DisplayName);$8(n.CompanyName)||(t.CompanyName=n.CompanyName);var i=_e.$8U.$7Hu(n.AttributionsArray);var r=_e.$8U.$7EQ([n.Emails1Array,n.Emails2Array,n.Emails3Array],i);r.length>0&&(t.Emails=r);var u=_e.$8U.$3XH([n.BusinessPhoneNumbersArray,n.BusinessPhoneNumbers2Array],i);u.length>0&&(t.BusinessPhoneNumbers=u);var f=_e.$8U.$3XH([n.HomePhonesArray,n.HomePhones2Array],i);f.length>0&&(t.HomePhoneNumbers=f);var e=_e.$8U.$3XH([n.MobilePhonesArray,n.MobilePhones2Array,n.CarPhonesArray],i);e.length>0&&(t.MobilePhoneNumbers=e);var o=_e.$8U.$3XI(n.BusinessAddressesArray);o.length>0&&(t.BusinessPostalAddresses=o);var s=_e.$8U.$3XI(n.HomeAddressesArray);s.length>0&&(t.HomePostalAddresses=s);var h=_e.$8U.$3XI(n.OtherAddressesArray);h.length>0&&(t.OtherPostalAddresses=h);return t};_e.$8U.$4eO=function(n){_a.$3.$M(n,"persona");_a.$3.$M(n.PersonaId,"persona.PersonaId");_a.$3.$1C(n.PersonaId.Id,"persona.PersonaId.Id");return n.PersonaId.Id};_e.$8U.$7Hu=function(n){var t=new(_0365f.$s.$$(String));if(!n)return t;for(var i=0;i<n.length;i++){var r=n[i];(r.DisplayName==="Facebook"||r.DisplayName==="LinkedIn")&&t.$H(r.Id)}return t};_e.$8U.$9Hz=function(n,t,i){for(var f=[],e=t,c=e.length,r=0;r<c;++r){var o=e[r];if(!$8(o))for(var s=o,l=s.length,u=0;u<l;++u){var h=s[u];$8(h)||i(h,f)}}return f};_e.$8U.$7EQ=function(n,t){return _e.$8U.$9Hz(_g.$At,n,function(n,i){if(!$8(n.Value)&&!_js.$8.$14(n.Value.EmailAddress))for(var r=0;r<n.Attributions.length;r++)if(!t.$6l(n.Attributions[r])){i[i.length]=_g.$2I.$rS(n.Value);break}})};_e.$8U.$3XH=function(n,t){return _e.$8U.$9Hz(_g.$52,n,function(n,i){if(!$8(n.Value)&&!_js.$8.$14(n.Value.Number))for(var r=0;r<n.Attributions.length;r++)if(!t.$6l(n.Attributions[r])){i[i.length]=n.Value.Number;break}})};_e.$8U.$3XI=function(n){return _e.$8U.$9Hz(_g.$Dp,[n],function(n,t){if(!$8(n.Value)){var r=new AddressbookPostalAddress;var i=n.Value;$8(i.State)||(r.State=i.State);$8(i.City)||(r.City=i.City);$8(i.Street)||(r.Street=i.Street);$8(i.Country)||(r.Country=i.Country);$8(i.PostalCode)||(r.PostalCode=i.PostalCode);t[t.length]=r}})};_e.$vn=function(){_e.$vn.initializeBase(this)};_e.$vn.prototype={get_$e0:function(){return _e.$1E.get_$L().$239},$7ET:function(n){return _e.$1X.$5eI()},$7EX:function(n){return new ItemMetadata},$9GG:function(n){_a.$3.$17(n,"data");_a.$3.$1C(n.PersonaId,"data.PersonaId");_a.$3.$17(n.Type,"data.Type");_a.$3.$kI(n.Type,0,"data.Type is invalid")}};_e.$vo=function(){_e.$vo.initializeBase(this)};_e.$vo.prototype={get_$e0:function(){return _e.$1E.get_$L().$23A},$7ET:function(n){return _e.$1X.$54(n.PersonaId)},$7EX:function(n){return new ItemMetadata},$9GG:function(n){_a.$3.$17(n,"data");_a.$3.$1C(n.PersonaId,"data.PersonaId")}};_e.$MK=function(){};function $3G2(n,t,i,r,u,f){_js.$8.$c(t.PersonaId.Id)||n.$8nU(t,i,r,u,f)}function $6T6(n,t){if(_js.$8.$c(t.PersonaId.Id))return!1;for(var u=_g.$1v.$9K("contacts").Id,r=t.FolderIds,f=r.length,i=0;i<f;++i){var e=r[i];if(e.Id===u)return!0}return!1}_e.$MK.prototype={$8dF:function(n,t,i,r){_a.$3.$M(i,"addressbookOperationItemStore");_a.$3.$M(r,"addressbookPersonaItemStore");$6T6(this,n)?$3G2(this,n,t,i,r,1):$3G2(this,n,t,i,r,2)},$5h7:function(n,t,i,r){_a.$3.$M(i,"addressbookOperationItemStore");_a.$3.$M(r,"addressbookPersonaItemStore");$3G2(this,n,t,i,r,2)},$8nU:function(n,t,i,r,u){var f=_e.$8U.$72X(u,n.PersonaId.Id);var e=i.$lp(f);e.$Cn(t,null);if(u===2)r.$GW(t,_e.$1X.$54(_e.$8U.$4eO(n)));else{var o=_e.$8U.$4nu(n);var s=r.$lp(o);s.$Cn(t,null)}}};_e.$kP=function(n,t,i,r,u,f){this.$$d_$10I=Function.createDelegate(this,this.$10I);this.$$d_$53e=Function.createDelegate(this,this.$53e);_a.$3.$M(n,"clientStore");_a.$3.$M(t,"getter");_a.$3.$1C(i,"timeZoneId");_a.$3.$M(u,"eventAggregator");this.$6T=n;this.$52X=t;this.$6t=i;this.$4BG=r;this.$S=u;this.$1EU=f};_e.$kP.$$=function(n){var t="$kP"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$kP"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$kP.apply(this,i)};r.registerClass("_e."+t,null,_a.$11W);var u=_e.$kP.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$kP.prototype={$6T:null,$52X:null,$6t:null,$4BG:!1,$S:null,$1EU:0,$1ig:null,$FP:null,get_$4B1:function(){return this.$6T},get_$3AN:function(){return this.$6t},$HX:function(){_js.Trace.logInfo(_a.$0.$XV,"Subscribing to {0} DB notification handler callback",this.get_$us());this.$6T.get_$wQ().$HX(this.get_$us(),this.$$d_$53e);this.$97M()},$12Z:function(){_js.Trace.logInfo(_a.$0.$XV,"Unsubscribing from {0} DB notification handler callback",this.get_$us());this.$6T.get_$wQ().$12Z(this.get_$us());this.$9Cl()},$7El:function(n){return n},$9IA:function(n){return this.$1ig[n.toString()]},$53e:function(n,t,i){_a.$3.$1C(n,"objectStoreName");_a.$3.$M(t,"notificationData");_js.Trace.logInfo(_a.$0.$XV,"{0} offline store genereated notification. Add Event Count: {1}. Update Event Count: {2}. Delete Event Count: {3}",this.get_$us(),t.get_$ka().length,t.get_$l1().length,t.get_$wX().length);var r=this.$7El(t);if(r.get_$54u()){this.$S.$8oV(_a.$Xp,new _a.$Xp(this.$1EU));this.$48a_0(i)&&this.$7HR(r)}this.$4ks()},$48a_0:function(n){return!n||n.$2hI},$97M:function(){if(this.$4BG&&!this.$FP){_js.Trace.logInfo(_a.$0.$XV,String.format("Subscribed to delete observation for store : {0}",this.get_$us()));this.$FP=this.$2ht(this.$52X);this.$1ig={};this.$FP.add_$68h(this.$$d_$10I)}},$9Cl:function(){_js.Trace.logInfo(_a.$0.$XV,String.format("Unsubscribed to delete observation for store : {0}",this.get_$us()));this.$4BG&&this.$FP&&this.$FP.remove_$68h(this.$$d_$10I);this.$4ks()},$10I:function(n,t){if(this.$48a_0(t.get_$AK().get_$1N1())){var i=t.get_$48();var r=this;n.$1d0(t.get_$AK(),i,function(n){n&&(r.$1ig[i.toString()]=n)},null)}},$4ks:function(){this.$1ig&&_0365f.$57.$F(this.$1ig)>0&&(this.$1ig={})}};_e.$Q4=function(n,t,i,r){_e.$Q4.initializeBase(this,[n,t,i,!0,r,2])};function $3G7(n,t,i){for(var e=i,h=e.length,u=0;u<h;++u){var f=e[u];var r=null;var o="";if(t==="RowDeleted"){var s=n.$9IA(f.$5U);if(!s){_js.Trace.logInfo(_a.$0.$XV,String.format("Calendar item not present in client store with id: {0}",f.$5U.toString()));return}r=s.get_$1s()}else{var c=f.$24;r=c.Data;_g.$6P.changeTimeZone(r,_e.$1a.$6t,n.get_$3AN(),n.get_$4B1().get_$Vz())}o=r.ParentFolderId.Id;_e.$2a.$7H7(t,o,r)}}_e.$Q4.prototype={get_$us:function(){return _e.$1E.get_$L().$qH.get_$1Q()},$7HR:function(n){$3G7(this,"RowAdded",n.get_$ka());$3G7(this,"RowModified",n.get_$l1());$3G7(this,"RowDeleted",n.get_$wX())},$2ht:function(n){return n.get_$1o()}};_e.$Yr=function(n,t,i,r){_e.$Yr.initializeBase(this,[n,t,i,!1,r,0])};function $4Qc(n,t){for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];var o=e.$24;var i=o.Data;_e.$2a.$2hG(i.FolderId.Id,i.ParentFolderId.Id,"RowModified","clientStore",i.TotalCount,i.UnreadCount,n.get_$2Pa())}}_e.$Yr.prototype={get_$us:function(){return _e.$1E.get_$L().$xG.get_$1Q()},get_$2Pa:function(){return!1},$7HR:function(n){$4Qc(this,n.get_$ka());$4Qc(this,n.get_$l1())},$2ht:function(n){return n.get_$2j()}};_e.$nn=function(n,t,i,r){_e.$nn.initializeBase(this,[n,t,i,!1,r,1])};_e.$nn.$48a=function(n){return n.get_$ka().length>0||n.get_$l1().length>0||n.get_$wX().length>0};_e.$nn.prototype={get_$us:function(){return _e.$1E.get_$L().$1L3.get_$1Q()},get_$2Pa:function(){return!0},$7HR:function(n){_e.$nn.$48a(n)&&_e.$2a.$29d(this.get_$2Pa())},$2ht:function(n){return n.get_$jj()}};_e.$5f=function(){_e.$5f.initializeBase(this)};_e.$5f.$1F6=function(n){return _e.$5f.$4w2(n.ItemId)};_e.$5f.$4w2=function(n){return _e.$1X.$54(n.Id)};_e.$5f.$6uZ=function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"calendarItemStore");_a.$3.$M(i,"uid");var u=new _a.$86(_e.$5f.$12W,i);var f=[new _a.$Gy(_a.$4U.$5U,0)];var e=new _a.$7m(u,f);_e.$w.$5rO(_e.$5f,n,e,52,function(n,u,f,e){_js.Trace.logInfo(_e.$5f.$D,"BindMultipleByUidIn - Uid:{0}, Query results:{1}",i,f.length);for(var o=0;o<f.length;o++){var s=t.$xM(f[o]);r(s,!!(e&o===f.length-1))}},null)};_e.$5f.$4ib=function(n){var t=_a.$7.$4Y(n.Start);var i=_a.$7.$4Y(n.End);return Math.floor(i.$6E(t)/36e5)};function $4Q7(n){var r=n.get_$1N5();var i=n.get_$10();var t=_a.$7.$4Y(i);if(r>0){t=t.$3u().$2q(r);i=_a.$7.$Eb(t)}n.$3Kq=i;n.$3Ks=t}_e.$5f.prototype={$2en:0,$3Kq:null,$3Ks:null,get_$22:function(){return this.get_$1s().ParentFolderId.Id},get_$10:function(){return this.get_$1s().Start},get_$3Kr:function(){this.$3Kq||$4Q7(this);return this.$3Kq},get_$4el:function(){this.$3Ks||$4Q7(this);return this.$3Ks},get_$9w:function(){return this.$2en>24},get_$5EZ:function(){return this.get_$9w()?Math.ceil(this.$2en/24):1},get_$12V:function(){return this.get_$1s().UID},get_$23:function(){return this.get_$1s().End},get_$1N5:function(){return this.get_$1s().unfoldedIndex},get_$5m:function(){return this.get_$1s().IsAllDayEvent},get_$4tw:function(){return this.$2en},get_$e0:function(){return _e.$1E.get_$L().$qH},$9GG:function(n){_a.$3.$M(n.ItemId,"ItemId");_a.$3.$M(n.ParentFolderId,"ParentFolderId");_a.$3.$M(n.UID,"UID");_a.$3.$1C(n.ItemId.Id,"ItemId.Id");_a.$3.$1C(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$1C(n.Start,"Start");_a.$3.$1C(n.End,"End")},$7ET:function(n){return _e.$5f.$1F6(n)},$16B:function(n,t,i,r,u){this.$2en=_e.$5f.$4ib(i);_e.$ok.prototype.$16B.call(this,n,t,i,r,u)},$7EX:function(n){return new CalendarItemMetadata(_e.$5f.$4ib(n))}};function CalendarItemMetadata(n){CalendarItemMetadata.initializeBase(this);this.DurationInHours=n}CalendarItemMetadata.prototype={DurationInHours:0};_e.$Ch=function(){_e.$Ch.initializeBase(this)};_e.$Ch.$3N8=function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"calendarRecurrenceMasterItemStore");_a.$3.$M(i,"uid");_a.$3.$M(r,"successCallback");var u=n.$CU(_e.$1E.get_$L().$13o.get_$1Q());var f=new _a.$86(_e.$Ch.$12W,i);var e=new _a.$7m(f,null);u.$HQ(e,function(n){n.$CS(2,function(n,i,u){if(i.length===1)r(t.$xM(i[0]));else{_a.$3.$6v(i.length,0,0,"UID should be unique.");r(null)}},null)},null)};_e.$Ch.$1F6=function(n){return _e.$1X.$54(n.ItemId.Id)};_e.$Ch.prototype={get_$9C6:function(){return this.get_$1s().UID},get_$e0:function(){return _e.$1E.get_$L().$13o},$9GG:function(n){_a.$3.$M(n.ItemId,"ItemId");_a.$3.$1C(n.ItemId.Id,"ItemId.Id");_a.$3.$M(n.UID,"UID")},$7ET:function(n){return _e.$Ch.$1F6(n)},$7EX:function(n){return new ItemMetadata}};_e.$5e=function(n){this.$64=n};function $4Q4(n,t){return new _a.$Li(_e.$5f.$1zD,t,1,0)}function $2UT(n,t,i,r,u){var f=this;n.$64.$AK(new _a.$6L("Calendar.QueryCalendarItemsInTransaction"),function(n){var r=n.$CU(_e.$1E.get_$L().$qH.get_$1Q());var f=[new _a.$Gy(_e.$5f.$1zD,0)];var e=new _a.$7m(t,f);r.$HQ(e,i,u)},r,u)}function $6TG(n,t,i){for(var f=_a.$5.acss(_e.$5e.$D,"FindItems_MergeResults"),u=i,e=u.length,r=0;r<e;++r){var o=u[r];var s=this;_0365f.$F4.$2l9(t,o,function(n,t){var i=n.get_$10();var r=t.get_$10();return i.localeCompare(r)})}_a.$5.aces(f);return t}function $6TI(n,t,i,r,u,f,e,o){var s=_a.$5.acss(_e.$5e.$D,"ReadCalendarViewShortDurationItems");var h=n.$64.$2hu(r);var c=_a.$7.$4Y(h);var l=c.$3KQ(-25);var a=l.$8r();var v=n.$64.$2hu(u);var y=new _a.$Ut(_e.$5f.$1zD,a,v,2);var p=[new _a.$Gy(_e.$5f.$1zD,0)];var w=new _a.$7m(y,p);var b=new _e.$5e.$915(i,r,u);$4Q5(n,t,w,b,f,e,o);_a.$5.aces(s)}function $6TH(n,t,i,r,u,f,e,o){var s=_a.$5.acss(_e.$5e.$D,"ReadCalendarViewLongDurationItems");var h=new _a.$Li(_e.$5f.$2eo,25,1,0);var c=new _a.$7m(h,null);var l=new _e.$5e.$7fx(i,r,u);$4Q5(n,t,c,l,f,e,o);_a.$5.aces(s)}function $4Q5(n,t,i,r,u,f,e){var o=String.format("ReadCalendarViewItems_{0}",i.$6f.get_$Qv().$5M);var s=_a.$5.acsa(_e.$5e.$D,o,!0);var h=this;t.$HQ(i,function(t){_a.$5.acea(s);$3G6(n,t,r,u,f,e)},e)}function $3G6(n,t,i,r,u,f){var e=_a.$5.acsa(_e.$5e.$D,"FindItems_ReadCalendarViewQueryResult_",!0);var o=this;t.$CS(350,function(o,s,h){_js.Trace.logInfo(_e.$5e.$D,"resultSet.Length = "+s.length);if(s.length>0){var c=_a.$5.acss(_e.$5e.$D,"ProcessCalendarViewQueryResult_"+s.length);$3G5(n,s,i,r,u);_a.$5.aces(c)}_a.$5.acea(e);h||$3G6(n,t,i,r,u,f)},f)}function $3G5(n,t,i,r,u){for(var o=_a.$5.acss(_e.$5e.$D,"FindItem_ProcessCalendarViewQueryResult_"+t.length),f=0;f<t.length;f++){var e=$6TF(n,t[f],r);i.$7cA(e)&&Array.add(u,e)}_a.$5.aces(o)}function $6TF(n,t,i){var o=t.$24;var u=o.Data;var r=new _g.$6P;r.ItemId=u.ItemId;for(var s=i.AdditionalProperties,c=s.length,f=0;f<c;++f){var h=s[f];switch(h.FieldURI){case"ItemParentId":r.ParentFolderId=u.ParentFolderId;break;case"Sensitivity":r.Sensitivity=u.Sensitivity;break;case"AppointmentState":r.AppointmentState=u.AppointmentState;break;case"IsCancelled":r.IsCancelled=u.IsCancelled;break;case"IsSeriesCancelled":r.IsSeriesCancelled=u.IsSeriesCancelled;break;case"HasAttachments":r.HasAttachments=u.HasAttachments;break;case"LegacyFreeBusyStatus":r.FreeBusyType=u.FreeBusyType;break;case"CalendarItemType":r.CalendarItemType=u.CalendarItemType;break;case"Start":r.Start=u.Start;r.StartWallClock=u.StartWallClock;r.StartTimeZoneId=u.StartTimeZoneId;break;case"End":r.End=u.End;r.EndWallClock=u.EndWallClock;r.EndTimeZoneId=u.EndTimeZoneId;break;case"MyResponseType":r.ResponseType=u.ResponseType;break;case"IsAllDayEvent":r.IsAllDayEvent=u.IsAllDayEvent;break;case"EnhancedLocation":r.Location=u.Location;break;case"Organizer":r.Organizer=u.Organizer;break;case"AppointmentReplyTime":r.AppointmentReplyTime=u.AppointmentReplyTime;break;case"Subject":r.Subject=u.Subject;break;case"IsMeeting":r.IsMeeting=u.IsMeeting;break;case"UID":r.UID=u.UID;break;case"InstanceKey":r.InstanceKey=u.InstanceKey;break;case"ItemEffectiveRights":r.EffectiveRights=u.EffectiveRights;break;case"JoinOnlineMeetingUrl":r.JoinOnlineMeetingUrl=u.JoinOnlineMeetingUrl;break;case"ConversationId":r.ConversationId=u.ConversationId;break;case"CalendarIsResponseRequested":r.IsResponseRequested=u.IsResponseRequested;break;case"Categories":r.Categories=u.Categories;break;case"IsRecurring":r.IsRecurring=u.IsRecurring;break;case"IsOrganizer":r.IsOrganizer=u.IsOrganizer;break;default:throw Error.invalidOperation(String.format("Invalid calendar shape property URI: {0}",h.FieldURI));}}var e=new PersistedDataRecord;e.Data=r;e.Metadata=o.Metadata;var l=new _a.$c5(t.$5U,e);return n.$64.$xM(l)}_e.$5e.prototype={$64:null,$4zP:function(n,t,i,r,u,f){_a.$3.$M(r,"shape");_a.$3.$HZ(r.BaseShape,"IdOnly","shape.BaseShape");var l=this;var e=function(n){_e.$1W.$BC(n,f)};var o=[];var s=[];var h=this,c=this;this.$64.$AK(new _a.$6L("Calendar.GetCalendarView"),function(u){var f=u.$CU(_e.$1E.get_$L().$qH.get_$1Q());$6TH(h,f,n,t,i,r,s,e);$6TI(h,f,n,t,i,r,o,e)},function(){u($6TG(c,o,s))},e)},$7Lp:function(n,t,i,r){var e=new _a.$Li(_e.$5f.$2eo,24,0,0);var s=this;var u=function(n){_e.$1W.$BC(n,r)};var f=[];var o=this,h=this;$2UT(this,e,function(i){var r=new _e.$5e.$3OH(n);$3G6(o,i,r,t,f,u)},function(){i(f)},u)},$7Hp:function(n,t,i,r,u,f){_a.$3.$M(n,"calendarFolderId");_a.$3.$M(t,"initialDate");_a.$3.$M(r,"shape");_a.$3.$HZ(r.BaseShape,"IdOnly","shape.BaseShape");_a.$3.$M(u,"successCallback");var c=this;var e=function(n){_e.$1W.$BC(n,f)};var o=[];var s=0;var h=this,l=this;$2UT(this,null,function(u){u.$F(function(n){s=n},e);var f=$4Q4(h,t);u.$1ar(0,f,function(t){t&&u.$CS(i,function(t,i,u){var f=new _e.$5e.$3OH(n);$3G5(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$7Ho:function(n,t,i,r,u,f){_a.$3.$M(r,"shape");_a.$3.$HZ(r.BaseShape,"IdOnly","shape.BaseShape");var c=this;var e=function(n){_e.$1W.$BC(n,f)};var o=[];var s=0;var h=this,l=this;$2UT(this,null,function(u){u.$F(function(n){s=n},e);u.$1MM(t,function(){u.$CS(i,function(t,i,u){var f=new _e.$5e.$3OH(n);$3G5(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$8vV:function(n,t,i){_a.$3.$M(n,"date");_a.$3.$M(t,"successCallback");var r=-1;var e=this;var u=function(n){_e.$1W.$BC(n,i)};var f=this,o=this;$2UT(this,null,function(t){var i=$4Q4(f,n);t.$1ar(0,i,function(n){r=t.get_$MG()},u)},function(){t(r)},u)}};_e.$5e.$3OH=function(n){this.$2i=n};_e.$5e.$3OH.prototype={$2i:null,$7cA:function(n){return n.get_$22()===this.$2i&&this.$58A(n)},$58A:function(n){return!0}};_e.$5e.$9JJ=function(n,t,i){_e.$5e.$9JJ.initializeBase(this,[n]);this.$5H0=t;this.$5Gz=i};_e.$5e.$9JJ.prototype={$5H0:null,$5Gz:null,$58A:function(n){return _e.$5e.$3OH.prototype.$58A.call(this,n)&&this.$7a2(n)},$7a2:function(n){var t=n.get_$23().localeCompare(this.$5H0);var i=n.get_$10().localeCompare(this.$5Gz);return t>0&&i<0||!t&&n.get_$10()===n.get_$23()}};_e.$5e.$915=function(n,t,i){_e.$5e.$915.initializeBase(this,[n,t,i])};_e.$5e.$915.prototype={$58A:function(n){return _e.$5e.$9JJ.prototype.$58A.call(this,n)&&n.get_$4tw()<25}};_e.$5e.$7fx=function(n,t,i){_e.$5e.$7fx.initializeBase(this,[n,t,i])};_e.$5e.$7fx.prototype={$58A:function(n){return _e.$5e.$9JJ.prototype.$58A.call(this,n)&&n.get_$4tw()>=25}};_e.$wh=function(n,t,i){_e.$wh.initializeBase(this);_a.$3.$M(n,"calendarRecurrenceMasterItemStore");_a.$3.$M(t,"calendarItemStore");this.$4jA=n;this.$13n=t;this.$65Z=i};_e.$wh.prototype={$4jA:null,$13n:null,$65Z:null,$5nz:function(n){_a.$3.$M(n,"tx");this.$4jA.$l3(n);this.$13n.$l3(n);this.$65Z.$GW(n,_e.$1X.$54("CalendarSyncState"))}};_e.$XA=function(n,t){_a.$3.$M(n,"calendarItemStore");_a.$3.$M(t,"calendarRecurrenceMasterStore");this.$13n=n;this.$1go=t};_e.$XA.$8M=function(n){_a.$3.$M(n,"itemStoreGetter");return new _e.$XA(n.get_$1o(),n.get_$hL())};_e.$XA.prototype={$13n:null,$1go:null,$4rz:function(n,t,i){var r=this;this.$4rt(n,t,function(t){t?r.$1go.$2dM(n,t.get_$1y(),i):i()})},$4rt:function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"id");var r=this;this.$1go.$Da(n,t,function(t){if(t){var u=new _a.$86(_e.$5f.$12W,t.get_$9C6());r.$13n.$1ia(n,u,function(){_e.$1W.$9I9(_bc.$JF,t,i)})}else _e.$1W.$9I9(_bc.$JF,t,i)},null)}};_e.$QB=function(n){_e.$QB.$$(this.$$gta["_e.$QB"].TItem).initializeBase(this);_a.$3.$M(n,"itemStore");this.$FP=n};_e.$QB.$$=function(n){var t="$QB"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$QB"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$QB.apply(this,i)};r.registerClass("_e."+t,_e.$3E);var u=_e.$QB.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$QB.prototype={$FP:null,$5nz:function(n){_a.$3.$M(n,"tx");this.$FP.$l3(n)}};_e.$1a=function(n,t,i,r){this.$3TG="owa_offline_db";this.$5T=new Sys.EventHandlerList;this.$4qY=n;this.$uQ=t;this.$4qw=i;this.$87=r};function $6TV(n,t,i,r){var f=this;var u=function(n){r(new _e.$1W(n).$IU())};var e=this;t.$8hy(n.$3TG,n.$4qY,function(t){t.get_$3Z()!==n.$i4().get_$3Z()?$6TY(n,t,function(){n.$35Z=!0;$4QD(n,t);$4QC(n,i,r)},u):$6TZ(n,t,function(){$4QD(n,t);$6TX(n,i,r)},u)},u)}function $6TZ(n,t,i,r){for(var f={},h=t.get_$1Jo(),e=0;e<h.length;++e)f[h[e]]=null;var u=new(_0365f.$s.$$(_e.$s2));var o=new(_0365f.$s.$$(_e.$s1));$6TS(n,t,f,u,o);for(var s=0;s<u.get_$F();++s)delete f[u.get_$48(s).get_$1Q()];var c=$6TR(n,f);if(u.get_$F()||o.get_$F()||c.length){n.$35Z=!0;var l=this;t.$3P1(n.$i4().get_$3Z(),$4QB(n),function(t){$6TP(n,t,o);$6TQ(n,t,u);$6TO(n,t,c)},i,r)}else i()}function $4QB(n){return _e.$1E.$6vV(n.$i4(),n.$87)}function $6TS(n,t,i,r,u){for(var e=_0365f.$57.$46(i),h=n.$i4(),c=n.$i4().get_$16o(),o=0;o<c.length;++o){var s=c[o];s.get_$1Q()in e&&!$6TW(n,t,s)&&delete e[s.get_$1Q()]}var l=e;for(var a in l){var v={key:a,value:l[a]};var f=h.$7Ne(v.key);if(f){r.$6l(f)||r.$H(f);f.get_$1ip().$3QC(r,u)}else r.$H(new _e.$Bz(v.key,"obsolete",new Array(0),new Array(0),_e.$8l.$Ne,0,0,!1,new _e.$8Z(h)))}}function $6TW(n,t,i){var r=!1;t.$7M3(i.get_$1Q())!==i.get_$3Z()?r=!0:$6TT(n,t,i)&&(r=!0);return r}function $6TT(n,t,i){for(var s=!1,e=i.get_$2g3(),h=e.length,u=0;u<h;++u){var r=e[u];var o=r.$28s;var f=n.$87.$7x(o);var c=Array.indexOf(t.get_$1ey(),o)>=0;if(f!==c)if(!r.$33Z&&f)return!0;else if(r.$33Z!==1||f){if(r.$33Z===2)return!0}else return!0}return s}function $6TQ(n,t,i){for(var r=0;r<i.get_$F();++r){_js.Trace.logInfo(_e.$1a.$D,"removing object store {0}",i.get_$48(r).get_$1Q());t.$5t3(i.get_$48(r).get_$1Q())}}function $6TP(n,t,i){for(var u=0;u<i.get_$F();++u){var r=i.get_$48(u);_js.Trace.logInfo(_e.$1a.$D,"removing item {0} from store {1}",r.get_$1y().get_$1V2(),r.get_$5Ep().get_$1Q());t.$BB(r.get_$5Ep().get_$1Q(),r.get_$1y().$3Ae())}}function $6TO(n,t,i){for(var r=0;r<i.length;++r){_js.Trace.logInfo(_e.$1a.$D,"creating object store {0}",i[r].$1j);$4QA(n,i[r],t)}}function $6TR(n,t){for(var r=[],i=0;i<n.$i4().get_$16o().length;++i){var u=n.$i4().get_$16o()[i];u.get_$1Q()in t||Array.add(r,u)}return r}function $6TY(n,t,i,r){_js.Trace.logInfo(_e.$1a.$D,"Wiping db.  Actual version '{0}' not equal to desired version '{1}'",t.get_$3Z(),n.$i4().get_$3Z());var u=this;t.$6Bk(function(){_js.Trace.logInfo(_e.$1a.$D,"Now changing the schema of the database.");t.$3P1(n.$i4().get_$3Z(),$4QB(n),function(t){for(var i=0;i<n.$i4().get_$16o().length;++i)$4QA(n,n.$i4().get_$16o()[i],t)},i,r)},r)}function $6TX(n,t,i){var r=_e.$9O.$29U(n);var u=this;r.$7JG(function(r){if(_js.$8.$c(r))$4QC(n,t,i);else{n.$1lx=r;t()}},i)}function $4QC(n,t,i){n.$1lx=(_a.$7.get_$2M().$55().toString()+Math.random().toString().substr(2)).substr(0,32);var r=_e.$9O.$29U(n);var u=this;$6Va(r,n.$1lx,t,function(t){_js.Trace.logError(_e.$1a.$D,"Unexpected error setting the DatabaseId: {0}",t.message);n.$1lx=null;n.$68N(function(){i(t)},function(n){_js.Trace.logError(_e.$1a.$D,"Failed to uninstall database after failing to set the database Id: {0}",n.message);i(Error.create(t.message+" "+n.message))})})}function $4QA(n,t,i){i.$75G(t.get_$1Q(),t.get_$3Z(),t.get_$7UC()===1,t.get_$6uc());$6TM(n,t,i);$6TN(n,t,i)}function $6TM(n,t,i){for(var u=t.get_$2Bl(),e=u.length,r=0;r<e;++r){var f=u[r];i.$4og(t.get_$1Q()+"_"+f.$1j,t.get_$1Q(),f.$28x)}}function $6TN(n,t,i){for(var e=t.get_$2g3(),h=e.length,r=0;r<h;++r){var u=e[r];if(n.$87.$7x(u.$28s))for(var o=u.$2Bk,c=o.length,f=0;f<c;++f){var s=o[f];i.$4og(t.get_$1Q()+"_"+u.$28s+"_"+s.$1j,t.get_$1Q(),s.$28x)}}}function $4QD(n,t){n.$e7=t;n.$72t()}function $6TU(n){if(n.$e7){n.$1iR&&n.$1iR.$12Z(n.$e7);n.$e7.$4F0()}n.$25Y&&n.$25Y.dispose();n.$25Y=null;n.$1iR=null;n.$e7=null;n.$1lx=null;n.set_$rx(!1)}_e.$1a.prototype={$4qY:0,$4qw:null,$uQ:null,$87:null,$e7:null,$1lx:null,$1iR:null,$3fO:!1,$1BF:null,$35Z:!1,$25Y:null,add_$2lU:function(n){this.$5T.addHandler("IsAvailable",n)},remove_$2lU:function(n){this.$5T.removeHandler("IsAvailable",n)},get_$rx:function(){return this.$3fO},set_$rx:function(n){if(n!==this.$3fO){this.$3fO=n;var t=this.$5T.getHandler("IsAvailable");t&&t(this.$35Z)}return n},get_$wQ:function(){return this.$e7},get_$7U9:function(){return this.$1lx},get_$Vz:function(){return this.get_$6yR()},get_$6yR:function(){this.$1BF||(this.$1BF=new _a.$Cv);return this.$1BF},get_$25Z:function(){return this.$25Y},$el:function(n){return _e.$1X.$54(n)},$5Gs:function(n,t,i,r){var u=this;_e.$Nq.$2AX(n,t,function(n){for(var r=new Array(n.length),t=0;t<n.length;t++)r[t]=n[t].get_$1s();u.$1BF.$3e0(r);_e.$1W.$gK(i)},r)},$3eV:function(n,t){_a.$3.$M(n,"succeededCallback");_a.$3.$M(t,"failedCallback");var r=this.$4zH();_a.$3.$M(r,"Databases are not supported by this browser. Check UserAgent.OfflineSupported before calling Install.");this.$35Z=!1;var i=this,u=this;$6TV(this,r,function(){i.set_$rx(!0);i.$1BF=new _a.$Cv;var r=new(_e.$7E.$$(_bc.$gV,_e.$Nq))(i,_e.$1a.$6t);r.$AK(new _a.$6L("ClientStore.Install.LoadTimeZones"),function(n){var t=n.$CU(i.$i4().get_$99j().get_$1Q());i.$5Gs(r,n,function(){_js.Trace.logInfo(_e.$1a.$D,"The time zone offsets table has been loaded")},function(n){_js.Trace.logError(_e.$1a.$D,"Failed to load the time zone offsets table: {0}",n.get_$4i())})},function(){n()},function(n){var r=Error.create(n.$4P);_js.Trace.logError(_e.$1a.$D,"Unexpected error during ClientStore Install: {0}",r.message);i.$YX();t(r)})},function(n){_js.Trace.logError(_e.$1a.$D,"Unexpected error during ClientStore Install: {0}",n.message);u.$YX();t(n)})},$68N:function(n,t){_a.$3.$M(n,"succeededCallback");_a.$3.$M(t,"failedCallback");var i=this.$4zH();if(this.$e7){this.$e7.$5H();this.$e7=null}var r=this,u=this;i.$78b(this.$3TG,function(){r.$YX();n()},function(n){_js.Trace.logError(_e.$1a.$D,"Unexpected error during ClientStore Uninstall: {0}",n.$4P);t(new _e.$1W(n).$IU())})},$YX:function(){_js.Trace.logInfo(_e.$1a.$D,"Disposing the current database, without wiping data.");$6TU(this)},$97E:function(n,t){_a.$3.$1C(n,"timezoneId");_a.$3.$M(t,"eventAggregator");if(!this.$1iR){this.$1iR=new _e.$Dy(t);this.$1iR.$HX(this,n)}},$4zH:function(){return this.$4qw},$i4:function(){return this.$uQ},$72t:function(){this.$25Y=new _e.$QD(this.$i4().get_$6vL(),this.$e7)}};_e.$QD=function(n,t){this.$$d_$1YP=Function.createDelegate(this,this.$1YP);this.$$d_$10I=Function.createDelegate(this,this.$10I);this.$$d_$1YO=Function.createDelegate(this,this.$1YO);this.$$d_$53e=Function.createDelegate(this,this.$53e);_e.$QD.resolveInheritance();this.dispose=this.$1M;_e.$QD.initializeBase(this);this.$13k={};this.$e7=t;this.$vi=n;$6Ta(this)};function $6Ta(n){n.$4B4=new Array(n.$vi.length);for(var t=0;t<n.$vi.length;t++){var i=n.$vi[t];n.$13k[i]={};_js.Trace.logInfo(_a.$0.$25Z,"Subscribing DB notification and observer to store {0}",i);n.$e7.$HX(i,n.$$d_$53e);var r=n.$e7.$4p2(i);n.$4B4[t]=r;r.add_$1YO(n.$$d_$1YO);r.add_$10I(n.$$d_$10I);r.add_$1YP(n.$$d_$1YP)}}function $4QE(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];t[e.$5U.toString()]=e.$24.Data}}_e.$QD.prototype={$vi:null,$13k:null,$4B4:null,$e7:null,$59:function(){for(var n=0;n<this.$vi.length;n++){var i=this.$vi[n];this.$e7.$12Z(i);var t=this.$4B4[n];t.remove_$1YO(this.$$d_$1YO);t.remove_$10I(this.$$d_$10I);t.remove_$1YP(this.$$d_$1YP);delete this.$13k[i]}},$3S:function(n,t){var i=null;var r=this.$13k[n];r&&(i=r[t]);return i},$2Ox:function(n,t,i){var r=this.$13k[n];r&&(r[t]=i)},$1YP:function(n,t){var i=n.$Vv;var r=this.$13k[i];delete r[t.get_$1y().toString()]},$10I:function(n,t){var i=n.$Vv;var r=this.$13k[i];delete r[t.get_$1y().toString()]},$1YO:function(n,t){_js.Trace.logInfo(_a.$0.$25Z,"Clearing cache: {0}, count: {2}",n.$Vv);this.$13k[n.$Vv]={}},$53e:function(n,t,i){var r=this.$13k[n];$4QE(this,r,t.get_$ka(),n);$4QE(this,r,t.get_$l1(),n)}};_e.$1W=function(n){this.$J7=this.toString;this.$1gR=n;if(n.$SU===3){_js.Trace.logWarning(_e.$1a.$D,"QuotaError handled.");var t=_e.$1W.$33I.getHandler(_a.$Td.toString(3));$8(t)||t()}};_e.$1W.add_$3ym=function(n){_e.$1W.$6qa(n)};_e.$1W.remove_$3ym=function(n){_e.$1W.$5t8(n)};_e.$1W.$9I9=function(n,t,i){i&&i(t)};_e.$1W.$gK=function(n){n&&n()};_e.$1W.$BC=function(n,t){var i=new _e.$1W(n);t&&t(i)};_e.$1W.$4oA=function(n){return function(t){n(t.$IU())}};_e.$1W.$WX=function(n){return function(t){_e.$1W.$BC(t,n)}};_e.$1W.$6qa=function(n){_e.$1W.$33I.addHandler(_a.$Td.toString(3),n)};_e.$1W.$5t8=function(n){_e.$1W.$33I.removeHandler(_a.$Td.toString(3),n)};_e.$1W.prototype={$1gR:null,get_$4i:function(){return this.$1gR.$4P},get_$7cs:function(){return this.$1gR.$SU===4},get_$7br:function(){return this.$1gR.$SU===3},$IU:function(){var n=this;n.__type="clientStoreError";n.isTransientError=this.$1gR.$SU===4||this.$1gR.$SU===3;return Error.create(this.get_$4i(),n)},toString:function(){return this.get_$4i()}};_e.$Jx=function(){_e.$Jx.initializeBase(this)};_e.$Jx.$3XJ=function(n){_a.$3.$M(n,"id");_a.$3.$1C(n.Id,"id.Id");return _e.$1X.$54(n.Id)};_e.$Jx.$4kK=function(n,t,i,r){_g.$C3.changeTimeZone(n,t,i,r)};_e.$Jx.prototype={get_$e0:function(){return _e.$1E.get_$L().$1Q7},$7ET:function(n){return _e.$Jx.$3XJ(n.PersonaId)},$7EX:function(n){return new ItemMetadata},$9GG:function(n){_a.$3.$M(n.PersonaId,"PersonaId");_a.$3.$1C(n.PersonaId.Id,"PersonaId.Id")},$4kO:function(n,t,i){_e.$Jx.$4kK(n,t,i,this.$64.get_$Vz())}};_e.$xY=function(n,t,i,r){_e.$xY.initializeBase(this,[n,t,i,!1,r,6])};_e.$xY.prototype={get_$us:function(){return _e.$1E.get_$L().$e1.get_$1Q()},$7HR:function(n){},$2ht:function(n){return n.get_$Hh()}};_e.$OA=function(n,t){_e.$OA.initializeBase(this,[n,t])};_e.$OA.$3aX=function(n,t){var i;i=t==="Clutter"?new _a.$86(ConversationItemMetadata.$1KB(),_e.$7C.$I(n,!0)):t==="NoClutter"?new _a.$86(ConversationItemMetadata.$1KB(),_e.$7C.$I(n,!1)):new _a.$86(ConversationItemMetadata.$1KC(),n);return i};_e.$OA.prototype={$3Qg:null,get_$us:function(){return _e.$1E.get_$L().$e1.get_$1Q()},$2dM:function(n,t,i){this.$57w(n,t,!0,i)},$79J:function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];this.$57w(n,f,!1,null)}},$4FO:function(n,t,i){_e.$6O.$4FO(n,this,t,i)},$4ze:function(n,t,i,r,u,f){_a.$3.$M(n,"folderId");_a.$3.$M(t,"request");_a.$3.$M(i,"actionContext");_a.$3.$M(r,"conversationViewData");_a.$3.$M(u,"successCallback");this.$3Qg=r;var e=this;_e.$aV.prototype.$9JB.call(this,t.Paging,_e.$6O.get_$2lB(),function(){var i=_e.$OA.$3aX(n,t.ClutterFilter);return new _a.$7m(i,[new _a.$Gy(ConversationItemMetadata.$2Ev(),1)])},u,f)},$52d:function(n,t){t(this.$3Qg.TotalConversationsInView)},$42i:function(n,t){_js.Trace.logInfo(_e.$1a.$D,"GetItems: Processing {0} query results",n.length);for(var r=this.$52F(this.$3Qg.OldestDeliveryTime),e=_a.$7.$4Y(r).$55(),i=0;i<n.length;++i){var u=this.$xM(n[i]);var f=u.get_$1s();var o=_a.$7.$4Y(f.LastDeliveryTime).$55();if(o>=e)Array.add(t,f);else{_js.Trace.logInfo(_e.$1a.$D,"Ignoring items outside the sync window, lastDeliveryTime = {0}, oldestLastDeliveryTime = {1}",u.get_$1s().LastDeliveryTime,r);break}}},$57w:function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"id");if(i){var u=this;this.$Da(n,t,function(i){if(i){var f=i.get_$1s();var e=new _e.$vG(u.get_$4B1(),u.get_$3AN());var o=TombstonedItemRecord.$I(f.ConversationId.Id,"ConversationItem",null);var s=e.$lp(o);s.$Cn(n,null)}_e.$7E.prototype.$2dM.call(u,n,t,r)},null)}else _e.$7E.prototype.$2dM.call(this,n,t,r)}};_e.$qK=function(n,t){_e.$qK.initializeBase(this,[n,"ConversationNodeSyncStateId"]);_a.$3.$6v(t,0,10,"maxDirtyConversationsToGet");this.get_$Y1().$5Il=t};_e.$qK.prototype={$76T:function(n){return new _e.$XS(this.$7y.get_$kC(),this.$7y.get_$Hh(),this.$7y.get_$Hi())}};_e.$1E=function(){this.$xG=$6Tk(this);this.$1Md=$6Ts(this);this.$e1=$6Tj(this);this.$20B=$6Tu(this);this.$261=$6Ti(this);this.$si=$6Tm(this);this.$1v6=$6Tn(this);this.$vM=$6Tb(this);this.$1KF=$6To(this);this.$1Q7=$6Th(this);this.$qH=$6Tf(this);this.$13o=$6Tg(this);this.$239=$6Tc(this);this.$23A=$6Td(this);this.$2PM=$6Tr(this);this.$2Lj=$6Tp(this);this.$1L3=$6Tq(this);this.$13Y=$6Te(this);this.$207=$6Tt(this);this.$2C1=$6Tl(this);var n=$vG(this,"FolderHierarchySyncStateId");var t=$vG(this,"ConversationSyncStateId");var i=$vG(this,"MessageSyncStateId");var r=$vG(this,"RemindersSyncStateId");var u=$vG(this,"PeopleFiltersSyncStateId");var f=$vG(this,"PeopleSyncStateId");var e=$vG(this,"CalendarSyncState");var o=$vG(this,"TimeZoneOffsetsSyncStateId");var h=$vG(this,"OwaUserConfigurationSyncStateId");var s=$vG(this,"AttachmentsStateId");this.$xG.$Jz.$H0(n).$3KP(1);this.$1Md.$Jz.$3KP(1);this.$e1.$Jz.$H0(t).$as(this.$261).$as(this.$13Y).$as(this.$si).$as(this.$20B);this.$20B.$Jz.$VO();this.$261.$Jz.$as(this.$e1);this.$si.$Jz.$H0(i).$as(this.$13Y).$as(this.$e1).$as(this.$20B);this.$1KF.$Jz.$as(this.$1Q7);this.$1Q7.$Jz.$H0(f).$as(this.$1KF);this.$qH.$Jz.$H0(e).$as(this.$13o);this.$13o.$Jz.$as(this.$qH);this.$239.$Jz.$as(this.$23A);this.$23A.$Jz.$as(this.$239);this.$2PM.$Jz.$4dY();this.$207.$Jz.$H0(o).$4dY();this.$13Y.$Jz.$H0(s).$as(this.$2C1);this.$1L3.$Jz.$H0(r);this.$2Lj.$Jz.$H0(u);this.$2C1.$Jz.$VO();this.$1v6.$Jz.$VO();this.$vM.$Jz.$VO();this.$1oz=[this.$1Md,this.$xG,this.$e1,this.$20B,this.$261,this.$si,this.$1v6,this.$vM,this.$1KF,this.$1Q7,this.$qH,this.$13o,this.$239,this.$23A,this.$2PM,this.$2Lj,this.$1L3,this.$13Y,this.$207,this.$2C1]};_e.$1E.get_$L=function(){return _e.$1E.$g||(_e.$1E.$g=new _e.$1E)};_e.$1E.$6vV=function(n,t){_a.$3.$M(n,"client store schema");_a.$3.$M(t,"flight manager");for(var f={},e=[],o=n.get_$16o(),h=o.length,r=0;r<h;++r)for(var c=o[r],s=c.get_$2g3(),l=s.length,u=0;u<l;++u){var a=s[u];var i=a.$28s;if(t.$7x(i)&&!(i in f)){f[i]=null;Array.add(e,i)}}return e};function $6Ts(n){return new _e.$Bz("Sync","15.0.0612.00",null,null,null,0,1,!0,new _e.$8Z(n))}function $6Tk(n){var t=[new _a.$4y(FolderItemMetadata.$1KC(),0),new _a.$4y(FolderItemMetadata.$2gq(),1)];var i=[new _a.$4y(FolderItemMetadata.$2gq(),1)];var r=[new _a.$4y(FolderItemMetadata.$4tT(),0)];var u=[new _e.$63("ParentId",t),new _e.$63("FolderPosition",i),new _e.$63("DistinguishedFolderId",r)];return new _e.$Bz("Folders","15.0.0742.00",u,null,null,0,1,!1,new _e.$8Z(n))}function $6Tj(n){var t=[new _a.$4y(ConversationItemMetadata.$1KC(),0),new _a.$4y(ConversationItemMetadata.$2Ev(),0)];var i=[new _a.$4y(ConversationItemMetadata.$1KB(),0),new _a.$4y(ConversationItemMetadata.$2Ev(),0)];var r=[new _a.$4y(_e.$6O.get_$2dw(),1),new _a.$4y(ConversationItemMetadata.$2Ev(),0)];var u=[new _a.$4y(_e.$6O.get_$2dw(),1)];var f=[new _a.$4y(_e.$6O.get_$3Qc(),0)];var e=[new _a.$4y(_e.$6O.get_$2lB(),0)];var o=[new _e.$63("ParentIdDateTimeSort",t),new _e.$63("ParentIdAndClutterDateTimeSort",i),new _e.$63("DirtyState",r),new _e.$63("DirtyStateIndexAloneField",u),new _e.$63("ConversationId",f),new _e.$63("InstanceKey",e),new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz("Conversations","15.0.0710.00",o,null,null,0,1,!1,new _e.$8Z(n))}function $6Tu(n){var t=[new _a.$4y(_e.$in.get_$5Eq(),0)];var i=[new _e.$63("ItemType",t)];return new _e.$Bz("TombstonedItems","15.0.0503.00",i,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Ti(n){var t=[new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz("ConversationNodes","15.0.0760.00",t,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tm(n){return $4QF(n,"Messages",1)}function $6Tn(n){return $4QF(n,"Outbox",0)}function $4QF(n,t,i){_a.$3.$1C("name",t);var r=[new _a.$4y(MessageItemMetadata.$1KC(),0),new _a.$4y(MessageItemMetadata.$1z2(),0)];var u=[new _a.$4y(MessageItemMetadata.$1KB(),0),new _a.$4y(MessageItemMetadata.$1z2(),0)];var f=[new _a.$4y(MessageItemMetadata.$59j(),0),new _a.$4y(MessageItemMetadata.$1z2(),0)];var e=[new _a.$4y(_e.$B6.get_$2lB(),0)];var o=[new _e.$63("DateTime",r),new _e.$63("DateTimeAndClutter",u),new _e.$63("IsDataSynced",f),new _e.$63("InstanceKey",e),new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz(t,"15.0.0710.00",o,null,_e.$8l.$Ne,0,i,!1,new _e.$8Z(n))}function $6Tb(n){var t=[new _a.$4y(_e.$F3.$2Qn,1)];var i=[new _a.$4y(ActionItemMetadata.$3gi(),0)];var r=[new _e.$63("State",t),new _e.$63("IsHighPriority",i)];return new _e.$Bz("Actions","15.0.0526.00",r,null,null,1,0,!1,new _e.$8Z(n))}function $6To(n){var t=[new _a.$4y(_e.$2M.$31v,0)];var i=[new _a.$4y(_e.$2M.$1kG,0)];var r=[new _a.$4y(_e.$2M.$14t,0)];var u=[new _a.$4y(_e.$2M.$1Eg,0)];var f=[new _a.$4y(_e.$2M.$1kG,0),new _a.$4y(_e.$2M.$14t,0)];var e=[new _a.$4y(_e.$2M.$1kG,0),new _a.$4y(_e.$2M.$1Eg,0)];var o=[new _a.$4y(_e.$2M.$2ay,0),new _a.$4y(_e.$2M.$14t,0)];var s=[new _a.$4y(_e.$2M.$2ay,0),new _a.$4y(_e.$2M.$1Eg,0)];var h=[new _a.$4y(_e.$2M.$2kB,0),new _a.$4y(_e.$2M.$14t,0)];var c=[new _a.$4y(_e.$2M.$2kB,0),new _a.$4y(_e.$2M.$1Eg,0)];var l=[new _a.$4y(_e.$2M.$3Cn,0),new _a.$4y(_e.$2M.$14t,0)];var a=[new _a.$4y(_e.$2M.$3Cn,0),new _a.$4y(_e.$2M.$1Eg,0)];var v=[new _a.$4y(_e.$2M.$2c6,0),new _a.$4y(_e.$2M.$14t,0)];var y=[new _a.$4y(_e.$2M.$2c6,0),new _a.$4y(_e.$2M.$1Eg,0)];var p=[new _a.$4y(_e.$2M.$43s,1),new _a.$4y(_e.$2M.$14t,0)];var w=[new _a.$4y(_e.$2M.$3V0,0)];var b=[new _a.$4y(_e.$2M.$3Uy,0)];var k=[new _e.$63("PersonaId",t),new _e.$63("FolderId",i),new _e.$63("DisplayNameFirstLast",r),new _e.$63("DisplayNameLastFirst",u),new _e.$63("ActualLastFirst",w),new _e.$63("ActualFirstLast",b),new _e.$63("CompanyNameFirstLast",o),new _e.$63("CompanyNameLastFirst",s),new _e.$63("HomeCityFirstLast",h),new _e.$63("HomeCityLastFirst",c),new _e.$63("WorkCityFirstLast",l),new _e.$63("WorkCityLastFirst",a),new _e.$63("CreationTimeFirstLast",v),new _e.$63("CreationTimeLastFirst",y),new _e.$63("RelevanceScoreFirstLast",p),new _e.$63("SaveMode",_e.$1E.$1LU),new _e.$63("FolderIdDisplayNameFirstLast",f),new _e.$63("FolderIdDisplayNameLastFirst",e)];return new _e.$Bz("PartialPersona","15.0.0692.00",k,null,null,0,1,!1,new _e.$8Z(n))}function $6Th(n){var t=[new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz("CompletePersona","15.0.0692.00",t,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tf(n){var t=[new _a.$4y(_e.$5f.$1zD,0)];var i=[new _a.$4y(_e.$5f.$2eo,1)];var r=[new _a.$4y(_e.$5f.$3WK,0)];var u=[new _a.$4y(_e.$5f.$12W,0)];var f=[new _e.$63("ShortDurationCalendarViewItemsIndices",t),new _e.$63("LongDurationCalendarViewItemsIndices",i),new _e.$63("PrunningFields",r),new _e.$63("RecurrenceIndices",u),new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz("CalendarItem","15.0.0594.00",f,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tg(n){var t=[new _a.$4y(_e.$Ch.$12W,0)];var i=[new _e.$63("RecurrenceIndices",t),new _e.$63("SaveMode",_e.$1E.$1LU)];return new _e.$Bz("CalendarRecurrenceMaster","15.0.0594.00",i,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tc(n){return new _e.$Bz("AddressbookOperation","15.0.0239.00",null,null,_e.$8l.$Ne,1,1,!1,new _e.$8Z(n))}function $6Td(n){return new _e.$Bz("AddressbookPersona","15.0.0239.00",null,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tr(n){return new _e.$Bz("Settings","15.0.0380.00",null,null,_e.$8l.$Ne,0,0,!1,new _e.$8Z(n))}function $6Tp(n){var t=new _a.$4U("Data.SortGroupPriority");var i=[new _a.$4y(t,1)];var r=[new _e.$63("sortGroupPriorityIndex",i)];return new _e.$Bz("PeopleFilter","15.0.0441.00",r,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Te(n){var t=[new _a.$4y(_e.$4W.$3mq,0)];var i=[new _a.$4y(_e.$4W.$3mr,0)];var r=[new _a.$4y(_e.$4W.$3MM,1)];var u=[new _a.$4y(_e.$4W.$3ML,1)];var f=[new _a.$4y(_e.$4W.$3ML,1),new _a.$4y(_e.$4W.$3mr,0)];var e=[new _e.$63("messageIdFields",t),new _e.$63("messageReceivedDateTimeFields",i),new _e.$63("attachmentTypeFields",r),new _e.$63("attachmentTypeAndSyncStatusFields",u),new _e.$63("attachmentTypeAndSyncStatusByMessageRecievedDateTimeFields",f)];return new _e.$Bz("AttachmentInfo","15.0.0557.00",e,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tq(n){var t=[new _a.$4y(_e.$9k.$444,0)];var i=[new _a.$4y(_e.$9k.$12W,0)];var r=[new _e.$63("ReminderTime",t),new _e.$63("RecurrenceIndices",i)];return new _e.$Bz("Reminders","15.0.0575.00",r,null,_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $6Tt(n){return new _e.$Bz("TimeZoneOffsets","15.0.0314.00",null,null,_e.$8l.$Ne,0,0,!1,new _e.$8Z(n))}function $6Tl(n){return new _e.$Bz("InlineImages","15.0.0557.00",null,[_e.$gG.$4ho],_e.$8l.$Ne,0,1,!1,new _e.$8Z(n))}function $vG(n,t){return new _e.$12k(_e.$1X.$54(t),n.$1Md,new _e.$8Z(n))}_e.$1E.prototype={$1oz:null,$vi:null,$xG:null,$1Md:null,$e1:null,$20B:null,$261:null,$si:null,$1v6:null,$vM:null,$1KF:null,$1Q7:null,$qH:null,$13o:null,$239:null,$23A:null,$2PM:null,$2Lj:null,$1L3:null,$13Y:null,$207:null,$2C1:null,get_$3Z:function(){return _e.$1E.$8b},get_$16o:function(){return this.$1oz},get_$6vL:function(){if(!this.$vi){this.$vi=new Array(0);for(var t=this.$1oz,r=t.length,n=0;n<r;++n){var i=t[n];i.$59D&&Array.add(this.$vi,i.$1j)}}return this.$vi},get_$99j:function(){return this.$207},$7Ne:function(n){for(var t=0;t<this.$1oz.length;++t)if(this.$1oz[t].get_$1Q().toLowerCase()===n.toLowerCase())return this.$1oz[t];return null}};_e.$8Z=function(n){this.$28e=new(_0365f.$s.$$(_e.$s2));this.$28c=new(_0365f.$s.$$(_e.$s1));this.$1lL=new(_0365f.$s.$$(_e.$yP));this.$uQ=n;this.$2XP=!1};function $6Ty(n,t,i){if(n.$2XP)for(var u=n.$uQ.get_$16o(),f=u.length,r=0;r<f;++r){var e=u[r];$3GA(n,e,t,i)}else{$6Tv(n,t,i);$6Tw(n,t,i)}}function $6Tx(n,t,i){for(var r=0;r<n.$28c.get_$F();++r){var u=n.$28c.get_$48(r);if(!i.$6l(u)){i.$H(u);u.get_$1ip().$3QC(t,i)}}}function $6Tw(n,t,i){for(var r=0;r<n.$uQ.get_$16o().length;++r){var u=n.$uQ.get_$16o()[r];n.$1lL.$6l(u.get_$79N())&&$3GA(n,u,t,i)}}function $6Tv(n,t,i){for(var r=0;r<n.$28e.get_$F();++r){var u=n.$28e.get_$48(r);$3GA(n,u,t,i)}}function $3GA(n,t,i,r){if(!i.$6l(t)){i.$H(t);t.get_$1ip().$3QC(i,r)}}_e.$8Z.prototype={$28e:null,$28c:null,$1lL:null,$uQ:null,$2XP:!1,$as:function(n){this.$28e.$H(n);return this},$4dY:function(){this.$2XP=!0;return this},$H0:function(n){this.$28c.$H(n);return this},$VO:function(){this.$28c.$1u();this.$28e.$1u();this.$1lL.$1u();this.$2XP=!1},$3KP:function(n){if(!n)throw Error.invalidOperation("cannot add dependency on 'none'");this.$1lL.$H(n);return this},$3QC:function(n,t){$6Ty(this,n,t);$6Tx(this,n,t)}};_e.$Qk=function(n,t){_e.$Qk.initializeBase(this,[n,t])};function $3GB(n,t,i){var r=this;t.$CS(50,function(r,u,f){for(var e=0;e<u.length;++e)Array.add(i,n.$xM(u[e]));u.length>0&&$3GB(n,t,i)},null)}_e.$Qk.prototype={$7OR:function(n,t,i){_a.$3.$M(t,"successCallback");var r=[];var u=this,f=this,e=this;this.$AK(new _a.$6L("FolderHierarchy.GetSubfolders"),function(t){var i=t.$CU(_e.$1E.get_$L().$xG.get_$1Q());var f=new _a.$86(FolderItemMetadata.$1KC(),n);var e=new _a.$7m(f,[new _a.$Gy(FolderItemMetadata.$2gq(),0)]);i.$HQ(e,function(n){$3GB(u,n,r)},null)},function(){t(r)},function(n){_e.$1W.$BC(n,i)})},$7Ht:function(n,t){_a.$3.$M(n,"successCallback");var i=[];var r=this,u=this,f=this;this.$AK(new _a.$6L("FolderHierarchy.GetAllFolders"),function(n){var t=n.$CU(_e.$1E.get_$L().$xG.get_$1Q());var u=new _a.$7m(null,[new _a.$Gy(FolderItemMetadata.$2gq(),0)]);t.$HQ(u,function(n){$3GB(r,n,i)},null)},function(){n(i)},function(n){_e.$1W.$BC(n,t)})}};_e.$7i=function(){_e.$7i.initializeBase(this)};_e.$7i.$7EV=function(n){_a.$3.$M(n,"id");_a.$3.$1C(n.Id,"id.Id");return _e.$1X.$54(n.Id)};_e.$7i.$1F6=function(n){_a.$3.$M(n,"data");return _e.$7i.$7EV(n.FolderId)};_e.$7i.$1SK=function(n,t,i,r){_a.$3.$M(n,"folderItemStore");_a.$3.$M(i,"successCallback");var u=t;_a.$3.$1C(u,"distinguishedFolderId");var f=null;n.$AK(new _a.$6L("FolderItem.FromDistinguishedFolderId"),function(t){var i=t.$CU(_e.$1E.get_$L().$xG.get_$1Q());var r=new _a.$86(FolderItemMetadata.$4tT(),u);var e=new _a.$7m(r,null);i.$HQ(e,function(t){t.$CS(2,function(t,i,r){i.length>0&&(f=n.$xM(i[0]))},null)},null)},function(){i(f)},function(n){_e.$1W.$BC(n,r)})};_e.$7i.$3Zh=function(n){return n.__FolderPositionIndex};_e.$7i.$5zL=function(n,t){n.__FolderPositionIndex=t};_e.$7i.prototype={get_$e0:function(){return _e.$1E.get_$L().$xG},$9GG:function(n){_a.$3.$M(n.FolderId,"FolderId");_a.$3.$1C(n.FolderId.Id,"FolderId.Id");_a.$3.$M(n.ParentFolderId,"ParentFolderId");_a.$3.$1C(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$17(_e.$7i.$3Zh(n),"FolderPositionIndex");_a.$3.$6v(_e.$7i.$3Zh(n),0,2147483647,"FolderPositionIndex")},$7ET:function(n){return _e.$7i.$1F6(n)},$7EX:function(n){var t=_js.$8.$c(n.DistinguishedFolderId)?_e.$7i.$3wU:n.DistinguishedFolderId;return new FolderItemMetadata(n.ParentFolderId.Id,t,_e.$7i.$3Zh(n))}};_e.$D8=function(n){_e.$D8.initializeBase(this,[n])};_e.$D8.$xL=function(n,t){_a.$3.$M(n,"folderId");_a.$3.$1C(n.Id,"folderId.Id");_a.$3.$M(t,"itemId");_a.$3.$1C(t.Id,"itemId.Id");return new _e.$D8(n.Id+":"+t.Id)};function FolderItemMetadata(n,t,i){FolderItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.DistinguishedFolderId=t;this.FolderPositionIndex=i}FolderItemMetadata.$1KC=function(){return new _a.$4U("Metadata.ParentClientStoreId")};FolderItemMetadata.$4tT=function(){return new _a.$4U("Metadata.DistinguishedFolderId")};FolderItemMetadata.$2gq=function(){return new _a.$4U("Metadata.FolderPositionIndex")};FolderItemMetadata.prototype={ParentClientStoreId:null,DistinguishedFolderId:null,FolderPositionIndex:0};_e.$gG=function(){_e.$gG.initializeBase(this)};_e.$gG.prototype={get_$e0:function(){return _e.$1E.get_$L().$2C1},$3av:function(){var n=_a.$ej.$I(this.get_$1s().Blob);return n.$3av()},$7ET:function(n){return _e.$1X.$54(n.Id)},$7EX:function(n){return new ItemMetadata},$9GG:function(n){}};_e.$sH=function(n,t){_e.$sH.initializeBase(this,[n,t])};_e.$63=function(n,t){_a.$3.$1C(n,"name");_a.$3.$M(t,"fields");_a.$3.$6v(t.length,1,2,"fields must be a 1 or 2 length array");this.$1j=n;this.$28x=t};_e.$63.prototype={$1j:null,$28x:null};function ItemMetadata(){}_e.$12k=function(n,t,i){this.$5U=n;this.$FP=t;this.$Jz=i};_e.$12k.prototype={$5U:null,$FP:null,$Jz:null,get_$1y:function(){return this.$5U},get_$5Ep:function(){return this.$FP},get_$1ip:function(){return this.$Jz}};_e.$Bz=function(n,t,i,r,u,f,e,o,s){_a.$3.$1C(n,"name");this.$1j=n.toLowerCase();this.$8b=t;this.$565=f;this.$1D6=r||[];this.$2Bk=i||[];this.$lj=u||_e.$8l.$Ne;this.$4s6=e;this.$59D=o;this.$Jz=s;$6VI(this)};function $6VI(n){if(n.$1D6.length>0){for(var u={},f=n.$2Bk,h=f.length,t=0;t<h;++t)for(var c=f[t],e=c.$28x,l=e.length,i=0;i<l;++i){var a=e[i];u[a.$5M.$5M]=1}for(var o=n.$1D6,v=o.length,r=0;r<v;++r){var s=o[r];if(s.$5M in u)throw Error.invalidOperation(String.format("The path {0} is declared as both an index and a blob",s.$5M));}}}_e.$Bz.prototype={$1j:null,$8b:null,$2Bk:null,$1D6:null,$565:0,$4s6:0,$59D:!1,$Jz:null,$lj:null,get_$1Q:function(){return this.$1j},get_$3Z:function(){return this.$8b},get_$2Bl:function(){return this.$2Bk},get_$6uc:function(){return this.$1D6},get_$7UC:function(){return this.$565},get_$79N:function(){return this.$4s6},get_$1ip:function(){return this.$Jz},get_$2g3:function(){return this.$lj}};_e.$8l=function(n,t,i){this.$28s=n;this.$2Bk=t||new Array(0);this.$33Z=i};_e.$8l.prototype={$28s:null,$2Bk:null,$33Z:0};_e.$7E=function(n,t){this.$$d_$96q=Function.createDelegate(this,this.$96q);this.$$d_$8Qi=Function.createDelegate(this,this.$8Qi);this.$$d_$8Qj=Function.createDelegate(this,this.$8Qj);this.$$d_$8Qk=Function.createDelegate(this,this.$8Qk);this.add_onBeforePut=this.add_$1YP;this.remove_onBeforePut=this.remove_$1YP;this.add_onBeforeDelete=this.add_$10I;this.remove_onBeforeDelete=this.remove_$10I;this.add_onBeforeClear=this.add_$1YO;this.remove_onBeforeClear=this.remove_$1YO;this.bindMultipleIn=this.$6ua;_a.$3.$M(n,"store");_a.$3.$1C(t,"timeZoneId");this.$47=new Sys.EventHandlerList;this.$64=n;this.$6t=t;this.$uQ=(new this.$$gta["_e.$7E"].TItem).get_$e0()};_e.$7E.$$=function(n,t){var r="$7E"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[r]){var i=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$7E"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$7E.apply(this,r)};i.registerClass("_e."+r,null,_bc.$B1.$$(n),_bc.$11x);var f=_e.$7E.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(i.prototype[u.key]=u.value)}i.$8oF="OnPut";i.$78d="OnDelete";i.$6y5="OnClear";i.$6u8="OnAvailable"}return _e[r]};_e.$7E.prototype={$64:null,$6t:null,$uQ:null,$47:null,$4BD:0,$Zm:null,add_$1YP:function(n){var t=this;this.$2X1("OnPut",n,function(){t.$Zm.add_$1YP(t.$$d_$8Qk)})},remove_$1YP:function(n){var t=this;this.$34E("OnPut",n,function(){t.$Zm.remove_$1YP(t.$$d_$8Qk)})},add_$10I:function(n){var t=this;this.$2X1("OnDelete",n,function(){t.$Zm.add_$10I(t.$$d_$8Qj)})},remove_$10I:function(n){var t=this;this.$34E("OnDelete",n,function(){t.$Zm.remove_$10I(t.$$d_$8Qj)})},add_$1YO:function(n){var t=this;this.$2X1("OnClear",n,function(){t.$Zm.add_$1YO(t.$$d_$8Qi)})},remove_$1YO:function(n){var t=this;this.$34E("OnClear",n,function(){t.$Zm.remove_$1YO(t.$$d_$8Qi)})},add_$5g4:function(n){var t=this;this.$2Ws("OnAvailable",n,function(){t.$64.add_$2lU(t.$$d_$96q)});this.get_$rx()&&n(this)},remove_$5g4:function(n){var t=this;this.$5sr("OnAvailable",n,function(){t.$64.remove_$2lU(t.$$d_$96q)})},add_$68h:function(n){var t=this;this.$2X1("OnDelete",n,function(){t.$Zm.add_$10I(t.$$d_$8Qj)})},remove_$68h:function(n){var t=this;this.$34E("OnDelete",n,function(){t.$Zm.remove_$10I(t.$$d_$8Qj)})},get_$rx:function(){return this.$64.get_$rx()},get_$3AN:function(){return this.$6t},get_$4B1:function(){return this.$64},$AK:function(n,t,i,r){this.$64.get_$wQ().$AK(n,t,i,r)},$Da:function(n,t,i,r){var u=this;_e.$w.$Da(this.$$gta["_e.$7E"].TItem,this.$64,n,t,this.$6t,function(n){u.$68r(n,t);i(n)})},$9HW:function(n,t,i,r){var u=this.$7JI(t);u?i(u):this.$Da(n,t,i,r)},$6ua:function(n,t,i,r){var u=this;_e.$w.$6ua(this.$$gta["_e.$7E"].TItem,this.$64,n,t,this.$6t,function(n){i(n)},r)},$gO:function(n,t,i,r){if(!this.$$gta["_e.$7E"].TItem.isInstanceOfType(t))throw Error.argumentNull("data");var u=t;u.$35R(n,i,r)},$1BX:function(n,t,i){_e.$w.$1BX(this.$$gta["_e.$7E"].TItem,this.$64,n,t,this.$6t,i)},$GW:function(n,t){this.$2dM(n,t,null)},$2dM:function(n,t,i){_e.$w.$9Hv(this.$$gta["_e.$7E"].TItem,n,t,i)},$l3:function(n){_e.$w.$l3(this.$$gta["_e.$7E"].TItem,n)},$1ia:function(n,t,i){_e.$w.$1ia(this.$$gta["_e.$7E"].TItem,n,t,i)},$5rO:function(n,t,i,r,u){_e.$w.$5rO(this.$$gta["_e.$7E"].TItem,n,t,i,r,u)},$QL:function(n,t,i){_a.$3.$M(n,"tx");var r=n.$CU(this.$uQ.get_$1Q());r.$HQ(t,i,null)},$lp:function(n){return _e.$w.$lp(this.$$gta["_e.$7E"].TItem,this.$64,n,this.$6t)},$xM:function(n){return _e.$w.$xM(this.$$gta["_e.$7E"].TItem,this.$64,n,this.$6t)},$52F:function(n){return this.$64.get_$Vz().$39(_e.$1a.$6t,this.$6t,n)},$2hu:function(n){return this.$64.get_$Vz().$39(this.$6t,_e.$1a.$6t,n)},$1d0:function(n,t,i,r){this.$Da(n,t,i,r)},$68i:function(n,t,i,r){this.$gO(n,t,i,r)},$4F6:function(n){return this.$lp(n)},$2X1:function(n,t,i){this.$4BD++||(this.$Zm=this.$64.get_$wQ().$4p2(this.$uQ.get_$1Q()));this.$2Ws(n,t,i)},$34E:function(n,t,i){this.$5sr(n,t,i);--this.$4BD<=0&&this.$7AW()},$2Ws:function(n,t,i){this.$47.getHandler(n)||i();this.$47.addHandler(n,t)},$5sr:function(n,t,i){this.$47.removeHandler(n,t);this.$47.getHandler(n)||i()},$7AW:function(){this.$4BD=0;if(this.$Zm){this.$Zm.$1M();this.$Zm=null}},$96q:function(n){if(this.$64.get_$rx()){var t=this.$47.getHandler("OnAvailable");t&&t(this)}},$8Qk:function(n,t){var i=this.$47.getHandler("OnPut");if(i){var r=new(_e.$N6.$$(this.$$gta["_e.$7E"].TInterface))(t.get_$AK(),_e.$w.$9Hx(this.$$gta["_e.$7E"].TItem,this.$64,t.get_$1y(),t.get_$1s(),this.$6t));i(this,r)}},$8Qj:function(n,t){var i=this.$47.getHandler("OnDelete");if(i){var r=new(_e.$N6.$$(_a.$lT))(t.get_$AK(),_e.$1X.$3Yf(t.get_$1y()));i(this,r)}},$8Qi:function(n,t){var i=this.$47.getHandler("OnClear");if(i){var r=new(_e.$N6.$$(this.$$gta["_e.$7E"].TInterface))(t.get_$AK(),this.$$gta["_e.$7E"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7E"].TInterface)?0:this.$$gta["_e.$7E"].TInterface===Boolean?!1:null);i(this,r)}},$7JI:function(n){var t=this.$$gta["_e.$7E"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7E"].TInterface)?0:this.$$gta["_e.$7E"].TInterface===Boolean?!1:null;var i=this.$64.get_$25Z().$3S(this.$uQ.get_$1Q(),n.toString());i&&(t=this.$lp(i));return t},$68r:function(n,t){n&&this.$64.get_$25Z().$2Ox(this.$uQ.get_$1Q(),t.toString(),n.$x)}};_e.$N6=function(n,t){this.$P=this.$$gta["_e.$N6"].T===Number||Type.isEnum(this.$$gta["_e.$N6"].T)?0:this.$$gta["_e.$N6"].T===Boolean?!1:null;_e.$N6.$$(this.$$gta["_e.$N6"].T).initializeBase(this);this.$A5=n;this.$P=t};_e.$N6.$$=function(n){var t="$N6"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$N6"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$N6.apply(this,i)};r.registerClass("_e."+t,Sys.EventArgs,_bc.$lg.$$(n),_bc.$11y);var u=_e.$N6.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$N6.prototype={$A5:null,get_$AK:function(){return this.$A5},get_$48:function(){return this.$P}};_e.$aN=function(n,t){_a.$3.$M(t,"syncStateId");this.$7y=new _e.$RG(n,_e.$1a.$6t);this.$65Y=this.$76T(t)};_e.$aN.prototype={$65Y:null,$7y:null,get_$Y1:function(){return this.$65Y},get_$95:function(){return this.$7y},$2iL:function(n,t){var i=this;this.get_$Y1().$2AU(function(t){var r=i.get_$Y1().$52P(t);n(r)},t)},$987:function(n,t,i,r){_js.Trace.logInfo(_e.$aN.$D,"SyncTo");_a.$3.$M(n,"syncState");var u=this,f=this,e=this;this.$7y.$AK(new _a.$6L("ItemSynchronizer.SyncTo",!1),function(i){u.$58M(i,n,t)},function(){_e.$1W.$gK(i)},function(n){_e.$1W.$BC(n,r)})},$YX:function(n,t,i,r){var u=this,f=this,e=this;this.$7y.$AK(new _a.$6L("ItemSynchronizer.Cleanup",!1),function(i){t.$5nz(i);n!==2&&u.get_$Y1().$79C(i)},function(){_e.$1W.$gK(i)},function(n){_js.Trace.logError(_e.$1a.$D,"Database cleanup failed. Code = {0}, Message = {1}",n.$SU,n.$4P);_e.$1W.$BC(n,r)})},$5ry:function(n,t,i,r,u){var e=this,f=this,o=this;this.$7y.$AK(new _a.$6L("ItemSynchronizer.ReconcileClientData",!1),function(i){n.$8oH(i,t,function(){})},function(){i(function(){f.$7y.$AK(new _a.$6L("ItemSynchronizer.ReconsileClientData",!1),function(t){n.$8kN(t)},function(){_e.$1W.$gK(r)},function(n){_e.$1W.$BC(n,u)})})},function(n){_e.$1W.$BC(n,u)})},$76T:function(n){return new _e.$id(this.$7y.get_$kC(),n)},$58M:function(n,t,i){i.$5nz(n);this.get_$Y1().$413(n,t)}};_e.$aV=function(n,t){_e.$aV.$$(this.$$gta["_e.$aV"].TInterface,this.$$gta["_e.$aV"].TItem,this.$$gta["_e.$aV"].TResult).initializeBase(this,[n,t])};_e.$aV.$$=function(n,t,i){var r="$aV"+"$3"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!_e[r]){var f=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$aV"]={TInterface:n,TItem:t,TResult:i};for(var u=[],r=0;r<arguments.length;++r)u[r]=arguments[r];_e.$aV.apply(this,u)};f.registerClass("_e."+r,_e.$7E.$$(n,t));var e=_e.$aV.prototype;for(var o in e){var u={key:o,value:e[o]};"constructor"!==u.key&&(f.prototype[u.key]=u.value)}}return _e[r]};_e.$aV.prototype={$9JB:function(n,t,i,r,u){_a.$3.$M(n,"paging");_a.$3.$M(t,"seekToConditionKeyKeyPath");_a.$3.$M(i,"queryCreatorCallback");_a.$3.$M(r,"successCallback");if(_g.$BL.isInstanceOfType(n))this.$7Kq(n,i,r,u);else if(_g.$Je.isInstanceOfType(n))this.$7No(n,t,i,r,u);else throw Error.invalidOperation(String.format("Unsupported paging type {0} provided",n));},$7Kq:function(n,t,i,r){_a.$3.$6v(n.Offset,0,Number.MAX_VALUE,"offset");_a.$3.$6v(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");_a.$3.$8z(n.BasePoint==="Beginning","Unsupported paging type provided");var s=n.MaxEntriesReturned;var e=n.Offset;var h=n.BasePoint;var o=new Array(0);var u=0;var f=this,c=this,l=this;this.$AK(new _a.$6L("ListViewItemStore.GetIndexedPageViewItems"),function(n){f.$52d(n,function(i){u=i;_a.$3.$6v(u,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.GetIndexedPageViewItems: totalItemsInView={0}, basePoint={1}, maxEntriesToReturn={2}, offset={3}",u,h,s,e);var r=n.$CU(f.get_$us());var c=t();r.$HQ(c,function(n){f.$4vc(n,e,s,function(n,t,i){f.$42i(t,o)})},null)})},function(){i(o,u,e+o.length)},function(n){_e.$1W.$BC(n,r)})},$7No:function(n,t,i,r,u){_a.$3.$6v(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");var o=n.MaxEntriesReturned;var v=n.BasePoint;var l=v==="Beginning";var s=!1;var h=0;var y=n.Condition.Item.FieldURIOrConstant.Item;var a=y.Value;var c=new Array(0);var e=0;var f=this,p=this,w=this;this.$AK(new _a.$6L("ListViewItemStore.GetSeekToConditionPageViewItems"),function(n){f.$52d(n,function(r){e=r;_a.$3.$6v(e,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.GetSeekToConditionPageViewItems: totalItemsInView={0}, isSeekNextRequest={1}, basePoint={2}, maxEntriesToReturn={3}, seekToConditionKeyPath={4}, seekToConditionKeyValue={5}",e,l,v,o,t.$5M,a);var u=n.$CU(f.get_$us());var y=i();u.$HQ(y,function(n){l?f.$7E0(n,t,a,o,function(n,t,i){h=i;s=n;n&&f.$42i(t,c)}):f.$521(n,t,a,function(n,t){s=n;if(n){h=t;var i=Math.max(0,t-o+1);u.$HQ(y,function(n){f.$4vc(n,i,o,function(n,t,i){f.$42i(t,c)})},null)}else _js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.GetSeekToConditionKeyOffset: row NOT found offset={0}, maxEntriesToReturn={1}",t,o)})},null)})},function(){var n;n=l?s?h+c.length:e:s?Math.max(0,e-h-1):0;r(c,e,n)},function(n){_e.$1W.$BC(n,u)})},$521:function(n,t,i,r){var u=this;n.$1ar(0,new _a.$86(t,i),function(t){_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.GetSeekToConditionKeyOffset: result offset={0}",n.get_$MG());r(t,n.get_$MG())},null)},$7E0:function(n,t,i,r,u){var f=this;this.$521(n,t,i,function(t,i){if(t)n.$CS(r,function(n,f,e){_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.ExecuteSeekToConditionQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",i,r,f.length);u(t,f,i)},null);else{_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.ExecuteSeekToConditionQuery: row NOT found offset={0}, maxEntriesToReturn={1}",i,r);u(t,null,i)}})},$4vc:function(n,t,i,r){var u=this;n.$1MM(t,function(){n.$CS(i,function(n,u,f){_js.Trace.logInfo(_e.$1a.$D,"ListViewItemStore.ExecuteSeekToIndexQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",t,i,u.length);r(n,u,f)},null)},null)}};_e.$13g=function(n,t,i,r){_e.$13g.initializeBase(this,[n,t,i,!0,r,4])};_e.$13g.prototype={get_$us:function(){return _e.$1E.get_$L().$si.get_$1Q()},get_$2Pa:function(){return!0},$7HR:function(n){var t=null;if(n.get_$ka().length>0){var r=n.get_$ka()[0].$24;t=r.Data}else if(n.get_$l1().length>0){var u=n.get_$l1()[0].$24;t=_a.$1U.$9Iv(_g.$7q,u.Data)}else if(n.get_$wX().length>0){var i=this.$9IA(n.get_$wX()[0].$5U);i&&(t=i.get_$1s())}t&&t.IsDraft&&this.$7HQ(t.ParentFolderId.Id)},$2ht:function(n){return n.get_$4i()},$7HQ:function(n){_e.$2a.$2hL(n,"clientStore",this.get_$2Pa())}};_e.$t1=function(n,t){_e.$t1.initializeBase(this,[n,"MessageItemSyncStateId"]);_a.$3.$6v(t,0,10,"maxUnsyncedItemsToGet");this.get_$Y1().$5J4=t};_e.$t1.prototype={$76T:function(n){return new _e.$gq(this.$7y.get_$kC(),this.$7y.get_$4i())}};_e.$13h=function(n,t,i,r,u){_e.$13h.initializeBase(this,[n,i,u]);_a.$3.$M(t,"attachmentItemStore");_a.$3.$M(r,"attachments");this.$1D1=t;this.$CD=r};_e.$13h.prototype={$1D1:null,$CD:null,$5nz:function(n){_a.$3.$M(n,"tx");var i=[];var r=this,t=this;_e.$3E.$9IG(_bc.$KG,_g.$7q,this.get_$5Ep(),n,this.get_$9JM(),function(n){return _e.$1X.$54(n.ItemId.Id)},function(r){for(var o=t.get_$9JM(),s=o.length,f=0;f<s;++f){var u=o[f];var e=r.$Lg(u.ItemId.Id)?r.get_$48(u.ItemId.Id).get_$1s():null;if(e&&u.ItemId.ChangeKey===e.ItemId.ChangeKey){var h=_g.$Om.$4nf(e,u);Array.add(i,h)}else Array.add(i,u)}t.set_$9JM(i);_e.$3E.$9IB(_bc.$lO,AttachmentInfoRecord,t.$1D1,n,t.$CD,null);_e.$Us.prototype.$5nz.call(t,n)})}};_e.$gq=function(n,t){_a.$3.$M(n,"syncStateItemStore");_a.$3.$M(t,"messageItemStore");this.$2RA=n;this.$2GK=t};_e.$gq.$9Bt=function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"messageItemStore");_a.$3.$M(i,"itemIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];t.$Da(n,_e.$1X.$54(e.Id),function(i){if(i){var r=MessageItemRecord.$29X(i.get_$1s());r.CustomSyncData.IsDataSynced=CustomSyncData.$1iL;t.$gO(n,i,1,null)}},null)}};_e.$gq.prototype={$2RA:null,$2GK:null,$5J4:0,$2AU:function(n,t){_a.$3.$M(n,"successCallback");var i=this,r=this;_e.$B6.$7P2(this.$2GK,this.$5J4,_g.$g.$1i,function(t,r,u){var f=i.$2RA.$lp(new MessageItemSyncState(t,r,u));n(f)},function(n){_js.Trace.logError(_e.$1a.$D,"ClientStore returned error while trying to fetch unsyned item list. Error = {0}",n.get_$4i());t&&t(n)})},$9C0:function(n,t,i,r){r()},$3BI:function(n,t){t()},$413:function(n,t){_e.$gq.$9Bt(n,this.$2GK,t.$5n)},$79C:function(n){throw Error.notImplemented("NYI");},$29q:function(){return new MessageItemSyncState([],{},!1)},$52P:function(n){return $8(n)?this.$29q():n.get_$1s()},$503:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$13t=function(n,t){_e.$13t.initializeBase(this,[n,t])};_e.$13t.prototype={$29q:function(){return new MultiFolderSyncState(this.$1zd)},$503:function(n){return new SyncState(n,"")}};_e.$tA=function(n,t){_e.$tA.initializeBase(this,[n,t])};_e.$tA.prototype={$76T:function(n){return new _e.$13t(this.$7y.get_$kC(),n)}};_e.$2a=function(){};_e.$2a.$2hL=function(n,t,i){_e.$2a.$2hG(n,null,"Reload",t,_e.$2a.$rv,_e.$2a.$rv,i)};_e.$2a.$2hG=function(n,t,i,r,u,f,e){_a.$3.$1C(n,"folderId");var o=new _a.$11C;o.id="HierarchyNotification";o.type="HierarchyNotification";o.folderId=n;o.parentFolderId=t;o.EventType=i;o.itemCount=u;o.unreadCount=f;o.clientGenerated=!0;o.forceSynchronousProcessing=!e;_a.$b.$7W("Reload.Notification.Source."+r);_e.$2a.$1lN(o)};_e.$2a.$29d=function(n){var t=new _a.$15U;t.id="ReminderNotification";t.type="ReminderNotification";t.clientGenerated=!0;t.shouldGetReminders=!0;t.forceSynchronousProcessing=!n;_js.Trace.logInfo(_a.$0.$XV,"Time: {0}, Cache client reminder notification",_a.$7.get_$2M().toString());_e.$2a.$1lN(t)};_e.$2a.$4yg=function(n,t,i){_a.$3.$1C(n,"folderId");var r=new _g.$15n;r.clientGenerated=!0;r.FolderId=n;r.EventType=t;r.id="RowNotification"+n;r.type="RowNotification";r.forceSynchronousProcessing=!i;_e.$2a.$1lN(r)};_e.$2a.$4yo=function(n){var t=new _a.$14H;t.id="OwaUserConfigurationNotification";t.type="OwaUserConfigurationNotification";t.clientGenerated=!0;t.reload=n;_e.$2a.$1lN(t)};_e.$2a.$3Yr=function(n){_a.$3.$M(n,"response");var t=new _g.$zO;t.id="FolderHierarchyNotification";t.type="FolderHierarchyNotification";t.clientGenerated=!0;t.folderHierarchy=n;_e.$2a.$1lN(t)};_e.$2a.$7H7=function(n,t,i){_a.$3.$1C(t,"GenerateCalendarItemNotification:folderId");_a.$3.$17(i,"GenerateCalendarItemNotification:calendarItem");var r=new _g.$wr;r.clientGenerated=!0;r.EventType=n;r.id="CalendarItemNotification"+t;r.type="CalendarItemNotification";r.FolderId=t;r.Item=i;r.Reload=!1;r.forceSynchronousProcessing=!0;_e.$2a.$1lN(r)};_e.$2a.$1lN=function(n){_a.$3.$HZ(n.clientGenerated,!0,"notification.ClientGenerated");OwaApplication.get_$Rk().$rc(n)};_e.$14D=function(n,t,i,r){_e.$14D.initializeBase(this,[n,t,i,!0,r,5])};_e.$14D.prototype={get_$us:function(){return _e.$1E.get_$L().$1v6.get_$1Q()},get_$2Pa:function(){return!0},$7HR:function(n){var t=null;if(n.get_$ka().length>0){var r=n.get_$ka()[0].$24;t=r.Data}else if(n.get_$l1().length>0){var u=n.get_$l1()[0].$24;t=u.Data}else if(n.get_$wX().length>0){var i=this.$9IA(n.get_$wX()[0].$5U);i&&(t=i.get_$1s())}t&&_e.$2a.$2hL(t.ParentFolderId.Id,"serviceCommand",this.get_$2Pa())},$2ht:function(n){return n.get_$ch()}};_e.$Rl=function(n,t,i,r){_e.$Rl.initializeBase(this,[n,t,i,!1,r,7])};function $3GH(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];e.$5U.toString()==="OwaUserConfiguration.1"&&t.$5rz(e,r)}}_e.$Rl.prototype={get_$us:function(){return _e.$1E.get_$L().$2PM.get_$1Q()},$7El:function(n){var t=new _a.$tG;$3GH(this,t,n.get_$ka(),0);$3GH(this,t,n.get_$l1(),1);$3GH(this,t,n.get_$wX(),2);return t},$7HR:function(n){},$2ht:function(n){return n.get_$605()}};_e.$Jg=function(){_e.$Jg.initializeBase(this)};_e.$Jg.$7Ob=function(n,t,i){_a.$3.$M(n,"syncStateItemStore");_a.$3.$M(t,"successCallback");var r=[];n.$AK(new _a.$6L("SyncStateItem.GetSyncStates"),function(t){var u=t.$CU(_e.$1E.get_$L().$1Md.get_$1Q());var f=new _a.$7m(null,null);u.$HQ(f,function(t){t.$CS(_e.$Jg.$5J2,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$xM(i[f]))},_e.$1W.$WX(i))},_e.$1W.$WX(i))},function(){t(r)},_e.$1W.$WX(i))};_e.$Jg.prototype={get_$e0:function(){return _e.$1E.get_$L().$1Md},$9GG:function(n){_a.$3.$1C(n.Id,"id")},$7ET:function(n){return _e.$1X.$54(n.Id)},$7EX:function(n){return new ItemMetadata}};_e.$3E=function(){};_e.$3E.$9IB=function(n,t,i,r,u,f){_e.$3E.$9IC(n,t,i,r,u,f,1)};_e.$3E.$9IC=function(n,t,i,r,u,f,e){if(!u||!u.length){_e.$1W.$gK(f);return}for(var c=0,s=function(){++c===u.length&&_e.$1W.$gK(f)},o=0;o<u.length;o++){var h=u[o];$8(h)?s():_e.$3E.$9IE(n,t,i,r,h,null,function(){s()},e)}};_e.$3E.$9ID=function(n,t,i,r,u,f,e){_e.$3E.$9IE(n,t,i,r,u,f,e,1)};_e.$3E.$9IE=function(n,t,i,r,u,f,e,o){var s=i.$4F6(u);f?f(s,r,e):i.$68i(r,s,o,e)};_e.$3E.$9IF=function(n,t,i,r,u){if(!r||!r.length){_e.$1W.$gK(u);return}for(var s=0,e=function(){++s===r.length&&_e.$1W.$gK(u)},f=0;f<r.length;f++){var o=r[f];o?i.$2dM(t,o,function(){e()}):e()}};_e.$3E.$9IG=function(n,t,i,r,u,f,e){var h=0;var o=_a.$5H.$$(n).$8M();u&&u.length||e(o);for(var s=0;s<u.length;s++)i.$1d0(r,f(u[s]),function(n){h++;n&&o.set_$48(n.get_$1y().get_$1V2().toString(),n);h===u.length&&e(o)},null)};_e.$3E.$8oH=function(n,t,i,r,u,f){var e=new _a.$86(_e.$w.$2O9,0);var o=new _a.$7m(e,null);i.$5rO(t,o,r,function(t,i,r,e){for(var c=n.getName(),s=r.length,o=0;o<s;o++){var h=r[o].$5U.$SH();_js.Trace.logWarning(_e.$3E.$D,"Dirty item (type: {0}) #{1}/{2}: {3}",c,o,s,h);u[h]=null}e&&f()},null)};_e.$3E.$3YQ=function(n,t){var i=n;for(var r in i){var u={key:r,value:i[r]};t(u.key)}};_e.$id=function(n,t){_a.$3.$M(n,"store");_a.$3.$M(t,"syncStateId");this.$64=n;this.$1zd=t};_e.$id.prototype={$64:null,$1zd:null,$2AU:function(n,t){_a.$3.$M(n,"successCallback");var i=null;var r=this,u=this,f=this;this.$64.$AK(new _a.$6L("SyncStateProvider.GetState"),function(n){r.$52D(n,function(n){i=n})},function(){n(i)},function(n){_e.$1W.$BC(n,t)})},$52D:function(n,t){_a.$3.$M(t,"successCallback");this.$64.$9HW(n,_e.$1X.$54(this.$1zd),t,null)},$9Bz:function(n,t){var i=this;this.$3BI(function(t){t.IsSynced=n},t)},$9C0:function(n,t,i,r){var u=this;this.$3BI(function(r){r.Diagnostics.SyncType=n;r.Diagnostics.SyncInProgress=t;r.Diagnostics.SyncError=i?i.message:""},r)},$413:function(n,t){var i=this.$64.$lp(t);i.$Cn(n,null)},$79C:function(n){this.$64.$GW(n,_e.$1X.$54(this.$1zd))},$29q:function(){return new SyncState(this.$1zd,"")},$52P:function(n){return $8(n)?this.$29q():n.get_$1s()},$3BI:function(n,t){_a.$3.$M(n,"updateDelegate");_a.$3.$M(t,"completedCallback");var i=this,r=this,u=this;this.$64.$AK(new _a.$6L("SyncStateProvicer.TryUpdateSyncStateProperties"),function(t){i.$64.$9HW(t,_e.$1X.$54(i.$1zd),function(r){var u=i.$52P(r);n(u);i.$413(t,u)},null)},function(){t()},function(n){t()})},$503:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$17w=function(){};_e.$17w.prototype={$2hF:function(n){_a.$3.$M(n,"folderIds");_a.$3.$6v(n.length,1,100,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_e.$1a.$D,"Generating onSync hierarchy notification. FolderId: {0}",r);_e.$2a.$2hL(r,"sync",!1)}},$29d:function(){_js.Trace.logInfo(_a.$0.$XV,"Generating onSync reminder notification");_e.$2a.$29d(!0)},$7HU:function(n){_a.$3.$M(n,"folderIds");_a.$3.$HZ(n.length>0,!0,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_a.$0.$XV,"Generating onSync persona notification. FolderId: {0}",r);_e.$2a.$4yg(r,"RowModified",!0)}},$4yo:function(n){_js.Trace.logInfo(_a.$0.$XV,"Generating onSync owa user configuration notification.");_e.$2a.$4yo(n)},$3Yr:function(n){_a.$3.$M(n,"response");_js.Trace.logInfo(_a.$0.$XV,"Generating onSync folder hierarchy notification.");_e.$2a.$3Yr(n)}};_e.$6O=function(){_e.$6O.initializeBase(this)};_e.$6O.get_$3Qc=function(){return new _a.$4U("Data.ConversationId.Id")};_e.$6O.get_$2lB=function(){return new _a.$4U("Data.InstanceKey")};_e.$6O.get_$2dw=function(){return new _a.$4U("Data.DirtyState")};_e.$6O.$1F6=function(n){_a.$3.$M(n,"data");return _e.$D8.$xL(n.FolderId,n.ConversationId)};_e.$6O.$7Jc=function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(r,"successCallback");_a.$3.$6v(i,0,100,"maxEntriesToReturn");var u=[];var f={};var e={};var o=n.$CU(_e.$1E.get_$L().$e1.get_$1Q());var s=new _a.$86(_e.$6O.get_$2dw(),2);var h=new _a.$7m(s,[new _a.$Gy(ConversationItemMetadata.$2Ev(),1)]);o.$HQ(h,function(n){n.$CS(i*2,function(n,o,s){for(var v=0,l=o,y=l.length,c=0;c<y;++c){var p=l[c];var a=t.$xM(p);var h=a.get_$1s().ConversationId.Id;if($8(e[h])){if(v++>=i)break;Array.add(u,new _g.$1j(h));f[h]=a.get_$1s().LastModifiedTime;e[h]=!0}}r(u,f)},null)},null)};_e.$6O.$3ZJ=function(n,t,i,r){_a.$3.$M(n,"tx");_a.$3.$M(t,"conversationItemStore");_a.$3.$M(i,"conversationId");_a.$3.$1C(i.Id,"conversationId.Id");_a.$3.$M(r,"successCallback");var f=n.$CU(_e.$1E.get_$L().$e1.get_$1Q());var e=new _a.$86(_e.$6O.get_$3Qc(),i.Id);var o=new _a.$7m(e,null);var u=[];f.$HQ(o,function(n){n.$CS(100,function(n,i,f){for(var o=i,s=o.length,e=0;e<s;++e){var h=o[e];Array.add(u,t.$xM(h))}r(u)},null)},null)};_e.$6O.$4FO=function(n,t,i,r){var o=100;var s=new _a.$7m(new _a.$86(_e.$6O.get_$2dw(),1),null);var u=[];var f={};var e={};t.$5rO(n,s,o,function(o,s,h,c){for(var y=h,w=y.length,v=0;v<w;++v){var b=y[v];var l=t.$xM(b);var k=l.get_$1s().ConversationId.Id;e[k]=l.get_$1s().LastModifiedTime;if(l.get_$1s().GlobalItemReadFlags)for(var a=0;a<l.get_$1s().GlobalItemIds.length;a++){var p=l.get_$1s().GlobalItemIds[a];Array.add(u,p);f[p.Id]=l.get_$1s().GlobalItemReadFlags[a]}l.set_$4ss(0);t.$gO(n,l,1,null)}if(c){_e.$6O.$9EE(n,i,e);_e.$6O.$4FP(n,r,u,0,f)}},null)};_e.$6O.$9EE=function(n,t,i){var r=i;for(var u in r){var f={key:u,value:r[u]};t.$Da(n,_e.$1X.$54(f.key),function(r){if(r){var u=i[r.get_$1s().ConversationId.Id];r.get_$1s().LastModifiedTime=u;t.$gO(n,r,1,function(n){})}else _js.Trace.logWarning(_e.$1a.$D,"Can't find ConversationNode with id:{0}",f.key)},null)}};_e.$6O.$4FP=function(n,t,i,r,u){var f=10;r+f>i.length&&(f=i.length-r);if(f)for(var o=0,e=0,s=0;s<f;s++){o++;t.$Da(n,_e.$1X.$54(i[r+s].Id),function(s){if(s){o--;if(s.get_$1s().IsRead!==u[s.get_$1s().ItemId.Id]){s.get_$1s().IsRead=u[s.get_$1s().ItemId.Id];e++;t.$gO(n,s,1,function(o){e--;e||_e.$6O.$4FP(n,t,i,r+f,u)})}else o||e||_e.$6O.$4FP(n,t,i,r+f,u)}},null)}};_e.$6O.prototype={get_$4ss:function(){return this.get_$1s().DirtyState},set_$4ss:function(n){this.get_$1s().DirtyState=n;return n},get_$e0:function(){return _e.$1E.get_$L().$e1},$9GG:function(n){_a.$3.$M(n.ConversationId,"ConversationId");_a.$3.$1C(n.ConversationId.Id,"ConversationId.Id");_a.$3.$1C(n.LastDeliveryTime,"LastDeliveryTime");_a.$3.$M(n.FolderId,"FolderId");_a.$3.$M(n.FolderId.Id,"FolderId.Id")},$7ET:function(n){return _e.$6O.$1F6(n)},$7EX:function(n){var t=$8(n.HasClutter)?!1:n.HasClutter;return new ConversationItemMetadata(n.FolderId.Id,t,n.LastDeliveryTime)}};function ConversationItemMetadata(n,t,i){ConversationItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.ParentClientStoreIdAndClutter=_e.$7C.$I(n,t);this.LastDeliveryTime=i}ConversationItemMetadata.$1KC=function(){return new _a.$4U("Metadata.ParentClientStoreId")};ConversationItemMetadata.$1KB=function(){return new _a.$4U("Metadata.ParentClientStoreIdAndClutter")};ConversationItemMetadata.$2Ev=function(){return new _a.$4U("Metadata.LastDeliveryTime")};ConversationItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,LastDeliveryTime:null};_e.$Ma=function(){_e.$Ma.initializeBase(this)};_e.$Ma.$4ow=function(n){_a.$3.$M(n,"originalItem");var t=new _g.$7q;t.ItemId=n.ItemId;t.ConversationId=n.ConversationId;t.ParentFolderId=n.ParentFolderId;t.DateTimeCreated=n.DateTimeCreated;t.DateTimeSent=n.DateTimeSent;t.DateTimeReceived=n.DateTimeReceived;t.__PlaceHolderItem=!0;return t};_e.$Ma.$1F6=function(n){_a.$3.$M(n,"data");_a.$3.$M(n.ConversationId,"data.ConversationId");return _e.$Ma.$7EU(n.ConversationId)};_e.$Ma.$7EU=function(n){_a.$3.$M(n,"conversationId");_a.$3.$1C(n.Id,"conversationId.Id");return _e.$1X.$54(n.Id)};_e.$Ma.prototype={get_$e0:function(){return _e.$1E.get_$L().$261},$9GG:function(n){_a.$3.$M(n.ConversationId,"ConversationId");_a.$3.$1C(n.ConversationId.Id,"ConversationId.Id");_a.$3.$1C(n.SyncState,"SyncState");_a.$3.$M(n.ConversationNodes,"ConversationNodes");_a.$3.$kI(n.ConversationNodes.length,0,"ConversationNodes.Length");_a.$3.$M(n.LastModifiedTime,"LastModifiedTime")},$7ET:function(n){return _e.$Ma.$1F6(n)},$7EX:function(n){return new ItemMetadata}};_e.$XS=function(n,t,i){_a.$3.$M(n,"syncStateItemStore");_a.$3.$M(t,"conversationItemStore");_a.$3.$M(t,"conversationNodeItemStore");this.$2RA=n;this.$1hd=t;this.$4nB=i};_e.$XS.$9Bs=function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"conversationItemStore");_a.$3.$M(i,"conversationIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];var o=n.$CU(_e.$1E.get_$L().$e1.get_$1Q());var s=new _a.$86(_e.$6O.get_$3Qc(),e.Id);var h=new _a.$7m(s,null);o.$HQ(h,function(i){i.$CS(100,function(i,r,u){for(var e=r,s=e.length,f=0;f<s;++f){var h=e[f];var o=t.$xM(h);o.set_$4ss(0);t.$gO(n,o,1,null)}},null)},null)}};_e.$XS.prototype={$2RA:null,$1hd:null,$4nB:null,$5Il:0,$2AU:function(n,t){_a.$3.$M(n,"successCallback");var r=null;var i=this,u=this,f=this;this.$1hd.$AK(new _a.$6L("ConversationSyncStateProvider.GetState"),function(n){_e.$6O.$7Jc(n,i.$1hd,i.$5Il,function(t,u){var o=0;var f={};if(t.length)for(var e=0;e<t.length;e++)i.$4nB.$Da(n,_e.$1X.$54(t[e].Id),function(n){n&&(f[n.get_$1s().ConversationId.Id]=n.get_$1s().SyncState);++o===t.length&&(r=i.$2RA.$lp(new ConversationItemSyncState(t,u,f)))},null);else r=i.$2RA.$lp(new ConversationItemSyncState(t,u,f))})},function(){n(r)},function(n){_js.Trace.logError(_e.$1a.$D,"ClientStore returned error while trying to fetch dirty conversation list or conversation sync state. Error = {0}",n.$4P);t&&t(new _e.$1W(n))})},$9C0:function(n,t,i,r){r()},$3BI:function(n,t){t()},$413:function(n,t){_e.$XS.$9Bs(n,this.$1hd,t.$5n)},$79C:function(n){throw Error.notImplemented("NYI");},$29q:function(){return new ConversationItemSyncState([],{},{})},$52P:function(n){return $8(n)?this.$29q():n.get_$1s()},$503:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$B6=function(){_e.$B6.initializeBase(this)};_e.$B6.get_$2lB=function(){return new _a.$4U("Data.InstanceKey")};_e.$B6.$1F6=function(n){_a.$3.$M(n,"data");_a.$3.$M(n.ItemId,"data.ItemId");_a.$3.$1C(n.ItemId.Id,"data.ItemId.Id");return _e.$1X.$54(n.ItemId.Id)};_e.$B6.$7P2=function(n,t,i,r,u){_a.$3.$M(i,"folderMappings");_a.$3.$M(r,"successCallback");_a.$3.$6v(t,0,10,"maxEntriesToReturn");var f=[];var e=0;var s={};var o=!1;n.$AK(new _a.$6L("MessageItem.GetUnsyncedItems"),function(r){var u=r.$CU(_e.$1E.get_$L().$si.get_$1Q());var h=new _a.$86(MessageItemMetadata.$59j(),"false");var c=new _a.$7m(h,[new _a.$Gy(MessageItemMetadata.$1z2(),1)]);u.$HQ(c,function(r){r.$CS(t*3,function(r,u,h){while(f.length<t&&e<u.length){var a=u[e];var c=n.$xM(a).get_$1s();var l=c.ItemId.Id;e||(o=i.doesIdEqualName(c.ParentFolderId,"drafts"));if(o===i.doesIdEqualName(c.ParentFolderId,"drafts")){Array.add(f,new _g.$1j(l));s[l]=c.ItemId.ChangeKey}e++}},null)},null)},function(){_js.Trace.logInfo(_e.$1a.$D,"Found {0} unsynced items",f.length);r(f,s,o)},function(n){_e.$1W.$BC(n,u)})};_e.$B6.$6z7=function(n,t){_a.$3.$M(n,"item");var i=MessageItemRecord.$29X(n);return!$8(i.CustomSyncData)&&i.CustomSyncData.ItemShape>t};_e.$B6.$2P1=function(n,t,i){_a.$3.$M(n,"item");_a.$3.$M(t,"isDataSynced");MessageItemRecord.$29X(n).CustomSyncData=new CustomSyncData(t,i)};_e.$B6.$7OH=function(n){if(_g.$g.$1i.doesIdEqualName(n.ParentFolderId,"sentitems")){$8(n.DateTimeSent)&&_js.Trace.logError(_a.$0.$57,"For item with item id {0}, the parent folder id is sent items folder i.e. {1} and the date time sent is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeSent}else if(_g.$g.$1i.doesIdEqualName(n.ParentFolderId,"drafts")||_g.$g.$1i.doesIdEqualName(n.ParentFolderId,"outbox")){$8(n.DateTimeCreated)&&_js.Trace.logError(_a.$0.$57,"For item with item id {0}, the parent folder id is drafts or outbox folder i.e. {1} and the date time created is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeCreated}return n.DateTimeReceived};_e.$B6.prototype={get_$e0:function(){return _e.$1E.get_$L().$si},$4kO:function(n,t,i){var r=null;if(n.__type===_g.$Gn._dataContractName)r=_g.$Gn.changeTimeZone;else if(n.__type===_g.$JJ._dataContractName){if(t!==i&&n){r=_g.$JJ.changeTimeZone;var u=n;if(u.ChangeHighlights){u.ChangeHighlights.Start=this.$64.get_$Vz().$39(t,i,u.ChangeHighlights.Start);u.ChangeHighlights.End=this.$64.get_$Vz().$39(t,i,u.ChangeHighlights.End)}}}else n.__type===_g.$IR._dataContractName?r=_g.$IR.changeTimeZone:n.__type===_g.$KT._dataContractName&&(r=_g.$KT.changeTimeZone);r?r(n,t,i,this.$64.get_$Vz()):_e.$ok.prototype.$4kO.call(this,n,t,i);if(n.ExtendedProperty)for(var o=n.ExtendedProperty,s=o.length,e=0;e<s;++e){var f=o[e];f.ExtendedFieldURI.PropertyTag===_g.$h.get_$f9().PropertyTag&&f.Value&&(f.Value=this.$64.get_$Vz().$39(t,i,f.Value))}},$9GG:function(n){_a.$3.$M(n.ItemId,"itemId");_a.$3.$1C(n.ItemId.Id,"itemId.Id");_a.$3.$1C(n.ItemId.ChangeKey,"itemId.ChangeKey");_a.$3.$M(n.ParentFolderId,"ParentFolderId");_a.$3.$1C(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$1C(n.DateTimeReceived,"DateTimeReceived");_a.$3.$1C(n.InstanceKey,"InstanceKey");var t=MessageItemRecord.$29X(n);$8(t.CustomSyncData)&&_e.$B6.$2P1(n,CustomSyncData.$1iL,2)},$7ET:function(n){return _e.$B6.$1F6(n)},$7EX:function(n){var t=_e.$B6.$7OH(n);var i=$8(n.IsClutter)?!1:n.IsClutter;return new MessageItemMetadata(n.ParentFolderId.Id,t,i,MessageItemRecord.$29X(n).CustomSyncData.IsDataSynced)}};function MessageItemMetadata(n,t,i,r){MessageItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.SortDateTime=t;this.ParentClientStoreIdAndClutter=_e.$7C.$I(n,i);this.IsDataSynced=r}MessageItemMetadata.$1KC=function(){return new _a.$4U("Metadata.ParentClientStoreId")};MessageItemMetadata.$1KB=function(){return new _a.$4U("Metadata.ParentClientStoreIdAndClutter")};MessageItemMetadata.$1z2=function(){return new _a.$4U("Metadata.SortDateTime")};MessageItemMetadata.$59j=function(){return new _a.$4U("Metadata.IsDataSynced")};MessageItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,SortDateTime:null,IsDataSynced:null};_e.$gp=function(n,t){_e.$gp.initializeBase(this,[n,t])};_e.$gp.prototype={get_$us:function(){return _e.$1E.get_$L().$si.get_$1Q()},$4FI:function(n,t,i){var r=this;this.$1BX(n,t,function(n){if($8(n)){_js.Trace.logWarning(_a.$0.$57,"Message with id {0} not found in local store",t);return}_e.$Mb.$4FI(n,i)})}};_e.$RT=function(n,t){_e.$RT.$$(this.$$gta["_e.$RT"].TInterface,this.$$gta["_e.$RT"].TItem).initializeBase(this,[n,t])};_e.$RT.$$=function(n,t){var i="$RT"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var r=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$RT"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$RT.apply(this,r)};r.registerClass("_e."+i,_e.$aV.$$(n,t,_g.$7q));var f=_e.$RT.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(r.prototype[u.key]=u.value)}r.$3aX=function(n,t){var i;i=t==="Clutter"?new _a.$86(MessageItemMetadata.$1KB(),_e.$7C.$I(n,!0)):t==="NoClutter"?new _a.$86(MessageItemMetadata.$1KB(),_e.$7C.$I(n,!1)):new _a.$86(MessageItemMetadata.$1KC(),n);return i}}return _e[i]};_e.$RT.prototype={$2i:null,$4xW:null,$3ms:null,get_$n:function(){return this.$2i},get_$9Je:function(){return this.$4xW},$50z:function(n,t,i,r,u,f,e){_a.$3.$M(n,"folderId");_a.$3.$M(t,"folderItemStore");_a.$3.$M(i,"request");_a.$3.$M(r,"actionContext");_a.$3.$M(f,"successCallback");this.$2i=n;this.$4xW=t;this.$3ms=u;var o=this;_e.$aV.prototype.$9JB.call(this,i.Paging,_e.$B6.get_$2lB(),function(){var t=_e.$RT.$$(o.$$gta["_e.$RT"].TInterface,o.$$gta["_e.$RT"].TItem).$3aX(n,i.ClutterFilter);return new _a.$7m(t,[new _a.$Gy(MessageItemMetadata.$1z2(),1)])},f,e)},$52d:function(n,t){t(this.$3ms.TotalCount)},$42i:function(n,t){for(var u=this.$52F(this.$3ms.OldestReceivedTime),f=_a.$7.$4Y(u).$aY().$55(),i=0;i<n.length;++i){var e=this.$xM(n[i]);var r=e.get_$1s();var o=_a.$7.$4Y(r.DateTimeReceived).$aY().$55();if(o>=f){this.$8QQ(r);Array.add(t,r)}else break}_js.Trace.logInfo(_e.$1a.$D,"GetItems: Returning {0} results to the caller",t.length)},$8QQ:function(n){n.Body=null;n.NormalizedBody=null;n.UniqueBody=null;n.Attachments=null;n.ToRecipients=null;n.CcRecipients=null;n.BccRecipients=null}};_e.$2M=function(){_e.$2M.initializeBase(this)};_e.$2M.$7EW=function(n,t){_a.$3.$M(n,"folderId");_a.$3.$M(t,"personaId");return _e.$D8.$xL(n,t)};_e.$2M.$3NP=function(n,t,i,r,u,f,e){_a.$3.$M(n,"store");_a.$3.$M(r,"folderId");_a.$3.$M(f,"successCallback");if(t<0)throw Error.argumentOutOfRange("offset");if(i<0)throw Error.argumentOutOfRange("maxItemsToReturn");var h=_e.$2M.$4nc(u);var o=[];var s=0;n.$AK(new _a.$6L("PartialPersonaItem.BrowsePeople"),function(u){var f=u.$CU(_e.$1E.get_$L().$1KF.get_$1Q());var e=new _a.$86(_e.$2M.$1kG,r.Id);var c=new _a.$7m(e,h);f.$HQ(c,function(r){r.$F(function(n){s=n},null);r.$1MM(t,function(){r.$CS(i,function(t,i,r){for(var f=i,e=f.length,u=0;u<e;++u){var s=f[u];var h=n.$xM(s);Array.add(o,h.get_$1s().Persona)}},null)},null)},null)},function(){f(o,s)},function(n){_e.$1W.$BC(n,e)})};_e.$2M.$4nc=function(n){var i=null;if(!$8(n)){i=new Array(n.length);for(var t=0;t<n.length;t++){var r=_e.$2M.$528(n[t].Path.FieldURI);var u=n[t].Order==="Ascending"?0:1;i[t]=new _a.$Gy(r,u)}}return i};_e.$2M.$723=function(n,t){var i=n.Item;var r=i.Item.FieldURI;var u=_e.$2M.$528(r);var f=i.FieldURIOrConstant.Item.Value;var e=_e.$2M.$7gm(f,t);return new _a.$Li(u,e,1,0)};_e.$2M.$528=function(n){switch(n){case"PersonaCompanyName":return _e.$2M.$2ay;case"PersonaHomeCity":return _e.$2M.$2kB;case"PersonaCreationTime":return _e.$2M.$2c6;case"PersonaRelevanceScore":return _e.$2M.$43s;case"PersonaDisplayNameFirstLast":return _e.$2M.$14t;case"PersonaDisplayNameLastFirst":return _e.$2M.$1Eg;case"PersonaWorkCity":return _e.$2M.$3Cn;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};_e.$2M.$7gm=function(n,t){return t[n]};_e.$2M.prototype={get_$e0:function(){return _e.$1E.get_$L().$1KF},$7ET:function(n){return _e.$2M.$7EW(n.FolderId,n.Persona.PersonaId)},$7EX:function(n){return new ItemMetadata},$9GG:function(n){_a.$3.$M(n.FolderId,"FolderId");_a.$3.$1C(n.FolderId.Id,"FolderId.Id");_a.$3.$M(n.Persona.PersonaId,"Persona.PersonaId");_a.$3.$1C(n.Persona.PersonaId.Id,"Persona.PersonaId.Id")},$4kO:function(n,t,i){_e.$Jx.$4kK(n.Persona,t,i,this.$64.get_$Vz())}};_e.$Rx=function(n,t,i,r){_e.$Rx.initializeBase(this,[n,t,i,!0,r,3])};function $3GJ(n,t,i){for(var o=i,l=o.length,r=0;r<l;++r){var u=o[r];var f=null;if(t==="RowDeleted"){var s=n.$9IA(u.$5U);if(!s){_js.Trace.logInfo(_a.$0.$XV,String.format("PersonaType item not present in client store id: {0}",u.$5U.toString()));return}f=s.get_$1s()}else{var a=u.$24;f=a.Data}for(var h=f.FolderIds,v=h.length,e=0;e<v;++e){var c=h[e];c&&_e.$2a.$4yg(c.Id,t,n.get_$2Pa())}}}_e.$Rx.prototype={get_$us:function(){return _e.$1E.get_$L().$1Q7.get_$1Q()},get_$2Pa:function(){return!0},$7HR:function(n){$3GJ(this,"RowAdded",n.get_$ka());$3GJ(this,"RowModified",n.get_$l1());$3GJ(this,"RowDeleted",n.get_$wX())},$2ht:function(n){return n.get_$3Q1()}};_e.$14p=function(n){_e.$14p.initializeBase(this);this.$64=n};_e.$14p.prototype={$64:null,$5nz:function(n){this.$64.$l3(n)}};_e.$5T=function(n,t,i,r,u){_a.$3.$M(n,"completePersonaItemStore");_a.$3.$M(t,"partialPersonaItemStore");_a.$3.$M(i,"addressbookOperationItemStore");_a.$3.$M(r,"addressbookPersonaItemStore");_a.$3.$M(u,"clientStoreSettings");this.$1hN=n;this.$oH=t;this.$3Kc=i;this.$3Kd=r;this.$4lH=u};_e.$5T.$$cctor=function(){_e.$5T.$25S=[];_a.NativeBridge.get_$L().add_$308(function(){_e.$Jj.get_$L().get_$4eK()&&_e.$5T.$8pd(_e.$Jj.get_$L().get_$4eK())})};_e.$5T.$I=function(n){_a.$3.$17(n,"storeGetter");return new _e.$5T(n.get_$3Q1(),n.get_$5nE(),n.get_$6ql(),n.get_$6qm(),new _e.$9O(n))};_e.$5T.$8pd=function(n){_a.$3.$M(n,"observer");Array.add(_e.$5T.$25S,n)};function $6VW(n,t){var i=t.DisplayNameLastFirst||"";if(_js.$8.$14(i)){i+=t.Surname||"";i+=t.GivenName||""}return i}function $6VV(n,t){var i=t.DisplayNameFirstLast||"";if(_js.$8.$14(i)){i+=t.GivenName||"";i+=t.Surname||""}return i}function $4Qs(n,t,i,r,u){var f=$6VS(n,i,r);var e=this;n.$oH.$QL(t,f,function(t){t.$CS(1,function(t,f,e){$6VY(n,i,r,f);u()},null)})}function $6VY(n,t,i,r){if(r.length>0){var u=n.$oH.$xM(r[0]);if(i===1){t.DisplayNameFirstLastSortKey=(u.get_$1s().Persona.DisplayNameFirstLastSortKey||"")+"00";t.DisplayNameFirstLastHeader=u.get_$1s().Persona.DisplayNameFirstLastHeader}else{t.DisplayNameLastFirstSortKey=(u.get_$1s().Persona.DisplayNameLastFirstSortKey||"")+"00";t.DisplayNameLastFirstHeader=u.get_$1s().Persona.DisplayNameLastFirstHeader}}}function $6VS(n,t,i){var r=null;var u=null;if(i===1){r=_e.$2M.$3Uy;u=$6VV(n,t)}else{r=_e.$2M.$3V0;u=$6VW(n,t)}var f=new _a.$Li(r,u,0,1);return new _a.$7m(f,[new _a.$Gy(r,1)])}function $6VU(n,t,i){var r=new PartialPersonaRecord(t,i);return n.$oH.$lp(r)}function $6VT(n,t){var i=new _g.$C3;i.PersonaId=t.PersonaId;i.ADObjectId=t.ADObjectId;i.PersonaTypeString=t.PersonaTypeString;i.EmailAddress=t.EmailAddress;i.CompanyName=t.CompanyName;i.DisplayName=t.DisplayName;i.DisplayNameFirstLast=t.DisplayNameFirstLast;i.DisplayNameLastFirst=t.DisplayNameLastFirst;i.GivenName=t.GivenName;i.Surname=t.Surname;i.EmailAddresses=t.EmailAddresses;i.ImAddress=t.ImAddress;i.FileAs=t.FileAs;i.HomeCity=t.HomeCity;i.WorkCity=t.WorkCity;i.CreationTimeString=t.CreationTimeString;i.IsFavorite=t.IsFavorite;i.DisplayNameFirstLastHeader=t.DisplayNameFirstLastHeader;i.DisplayNameLastFirstHeader=t.DisplayNameLastFirstHeader;i.RelevanceScore=t.RelevanceScore;i.ThirdPartyPhotoUrlsArray=t.ThirdPartyPhotoUrlsArray;i.AttributionsArray=t.AttributionsArray;i.Alias=t.Alias;i.CompanyNameSortKey=t.CompanyNameSortKey;i.DisplayNameFirstLastSortKey=t.DisplayNameFirstLastSortKey;i.DisplayNameLastFirstSortKey=t.DisplayNameLastFirstSortKey;i.HomeCitySortKey=t.HomeCitySortKey;i.WorkCitySortKey=t.WorkCitySortKey;return i}function $6VX(n,t,i){_e.$5T.$4AJ?i(_e.$5T.$4AJ):n.$4lH.$7Mg(t,i)}_e.$5T.prototype={$1hN:null,$oH:null,$3Kc:null,$3Kd:null,$4lH:null,$3NP:function(n,t,i,r,u,f){_e.$2M.$3NP(this.$oH,n,t,i,r,u,f)},$8vT:function(n,t,i,r,u){_a.$3.$M(n,"condition");_a.$3.$M(t,"folderId");_a.$3.$M(i,"sortParams");_a.$3.$M(r,"successCallback");var f=-1;var e=this,o=this,s=this;this.$oH.$AK(new _a.$6L("PersonaStore.SeekToCondition"),function(r){$6VX(e,r,function(u){var e=_e.$2M.$4nc(i);var o=_e.$2M.$723(n,u);var s=r.$CU(_e.$1E.get_$L().$1KF.get_$1Q());var h=new _a.$86(_e.$2M.$1kG,t.Id);var c=new _a.$7m(h,e);s.$HQ(c,function(n){n.$1ar(0,o,function(t){f=n.get_$MG()},null)},null)})},function(){r(f)},function(n){_e.$1W.$BC(n,u)})},$Da:function(n,t,i,r){var u=this;this.$1hN.$Da(n,_e.$Jx.$3XJ(t),function(n){i(n?n.get_$1s():null)},r)},$gO:function(n,t,i,r){var f=null;var s=this.$1hN.$lp(t);var c=this;this.$1hN.$gO(n,s,i,function(n){f=new _g.$1j(n.toString())});var e={};var h=new _a.$86(_e.$2M.$31v,t.PersonaId.Id);var u=this;this.$oH.$5rO(n,new _a.$7m(h,null),100,function(o,s,h,c){for(var v=h,d=v.length,l=0;l<d;++l){var g=v[l];var y=u.$oH.$xM(g);e[y.get_$1s().FolderId.Id]=y.get_$1y()}if(c){for(var nt=$6VT(u,t),tt=0,p=t.FolderIds,it=p.length,a=0;a<it;++a){var w=p[a];delete e[w.Id];var rt=$6VU(u,nt,w);u.$oH.$gO(n,rt,i,function(n){++tt===t.FolderIds.length&&f&&_e.$1W.$9I9(_g.$1j,f,r)})}var b=e;for(var k in b){var ut={key:k,value:b[k]};u.$oH.$GW(n,ut.value)}}},null);var o=this;Array.forEach(_e.$5T.$25S,function(i){var r=i;r.$8dF(t,n,o.$3Kc,o.$3Kd)})},$GW:function(n,t){var i=this;this.$Da(n,t,function(r){i.$1hN.$GW(n,_e.$Jx.$3XJ(t));var u=new _a.$86(_e.$2M.$31v,t.Id);i.$oH.$1ia(n,u,null);r&&Array.forEach(_e.$5T.$25S,function(t){var u=t;u.$5h7(r,n,i.$3Kc,i.$3Kd)})},null)},$l3:function(n){this.$1hN.$l3(n);this.$oH.$l3(n)},$4ym:function(n,t,i){var r=2;var u=0;var f=this;$4Qs(this,n,t,1,function(){++u===r&&i()});var e=this;$4Qs(this,n,t,0,function(){++u===r&&i()})}};_e.$bj=function(n,t,i,r,u,f,e){_e.$bj.initializeBase(this);this.$64=n;this.$4m5=i;this.$5nF=r;this.$Dv=t;this.$1ND=u;this.$1if=f;this.$3jz=e};function $4Qt(n,t,i){for(var f=0,e=n.$1ND.length-i,r=Math.min(e,5),u=0;u<r;u++){var o=n.$1ND[i+u];var s=this;n.$64.$gO(t,o,1,function(){++f===r&&$4Qt(n,t,i+r)})}}_e.$bj.prototype={$64:null,$1ND:null,$1if:null,$4m5:null,$5nF:null,$27b:null,$1a7:null,$3jz:null,$Dv:null,get_$4sJ:function(){return this.$27b?_0365f.$57.$F(this.$27b):0},get_$33d:function(){return this.$1a7?this.$1a7.length:0},$8oH:function(n,t,i){this.$27b={};var r=this;_e.$3E.$8oH(_bc.$lU,n,this.$4m5,t,this.$27b,function(){_e.$3E.$8oH(_bc.$lx,n,r.$5nF,t,r.$27b,i)})},$8kN:function(n){},$5nz:function(n){this.$1ND&&$4Qt(this,n,0);if(this.$1if)for(var i=this.$1if,r=i.length,t=0;t<r;++t){var u=i[t];this.$64.$GW(n,u)}this.$3jz&&this.$Dv.$8zO(n,this.$3jz,null)}};function ConfigChangeCleanupModuleItem(n,t){_a.$3.$M(t,"syncManagerStartTime");this.ModuleType=n;this.SyncManagerStartTime=t}ConfigChangeCleanupModuleItem.prototype={ModuleType:0,SyncManagerStartTime:null};function MessageItemRecord(){MessageItemRecord.initializeBase(this)}MessageItemRecord.$29X=function(n){return n};MessageItemRecord.prototype={CustomSyncData:null};_e.$5l=function(){_e.$5l.initializeBase(this)};_e.$5l.$W=function(n,t,i,r,u){var f=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;t.$AK(new _a.$6L(String.format("SettingItem.GetValue({0})",i)),function(r){_e.$5l.$9Jc(n,t,r,i,function(n){f=n})},function(){r(f)},_e.$1W.$WX(u))};_e.$5l.$9Jc=function(n,t,i,r,u){t.$Da(i,_e.$1X.$54(r),function(t){if(t){var i=t.get_$1s();u(i.Value)}else u(n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},null)};_e.$5l.$N=function(n,t,i,r,u,f){t.$AK(new _a.$6L(String.format("SettingItem.SetValue({0})",i)),function(u){_e.$5l.$9Jd(n,t,u,i,r,null)},function(){u()},_e.$1W.$WX(_e.$1W.$4oA(f)))};_e.$5l.$9Jd=function(n,t,i,r,u,f){var e=new SettingRecord;e.Id=r;e.Value=u;var o=t.$lp(e);o.$Cn(i,function(){_e.$1W.$gK(f)})};_e.$5l.$2dU=function(n,t){_e.$w.$9Hv(_e.$5l,n,_e.$1X.$54(t),null)};_e.$5l.prototype={get_$e0:function(){return _e.$1E.get_$L().$2PM},$7EX:function(n){return new ItemMetadata},$7ET:function(n){return _e.$1X.$54(n.Id)},$9GG:function(n){}};_e.$9O=function(n){this.$64=n.get_$605();this.$66Q=n.get_$206()};_e.$9O.$29U=function(n){var t=new _e.$RG(n,_e.$1a.$6t);return new _e.$9O(t)};_e.$9O.$78Q=function(n){_e.$5l.$2dU(n,"CalendarFolders")};_e.$9O.$78f=function(n){_e.$5l.$2dU(n,"FavoriteFolders")};_e.$9O.$790=function(n){_e.$5l.$2dU(n,"OtherMailboxConfiguration")};function $4Qv(n){_js.Trace.logInfo(_a.$0.$57,"Mark email data as outdated");var t=new _e.$ge(_a.$69.$I());t.$3KR(11,"")}function $6Va(n,t,i,r){_e.$5l.$N(String,n.$64,"DatabaseId",t,i,r)}_e.$9O.prototype={$64:null,$66Q:null,$7JG:function(n,t){var i=this;_e.$5l.$W(String,this.$64,"DatabaseId",n,function(n){t(n.$IU())})},$7N3:function(n,t){var i=this;_e.$5l.$W(Boolean,this.$64,"Provisioned",n,function(n){t(n.$IU())})},$lu:function(n,t){_e.$5l.$W(_g.$JU,this.$64,"OwaUserConfiguration.1",n,t)},$8zW:function(n,t,i){_e.$5l.$N(Boolean,this.$64,"Provisioned",n,t,i)},$1y8:function(n,t){var i=this,r=this;this.$lu(function(r){if(r){(r.UserOptions.ConversationSortOrder!==n.ConversationSortOrder||r.UserOptions.HideDeletedItems!==n.HideDeletedItems)&&$4Qv(i);r.UserOptions.ConversationSortOrder=n.ConversationSortOrder;r.UserOptions.HideDeletedItems=n.HideDeletedItems;r.UserOptions.ShowSenderOnTopInListView=n.ShowSenderOnTopInListView;r.UserOptions.ShowPreviewTextInListView=n.ShowPreviewTextInListView;r.UserOptions.ShowInferenceUiElements=n.ShowInferenceUiElements;i.$64.$AK(new _a.$6L("Settings.SetLayoutSettings"),function(n){i.$36j(n,r,null)},function(){_js.Trace.logInfo(_a.$0.$57,"SetLayoutSettings to offline store succeeded");t()},function(n){_js.Trace.logError(_a.$0.$57,"SetLayoutSettings to offline store failed with dbError: {0}",n.$4P);t()})}else{_js.Trace.logWarning(_a.$0.$57,"When user changes the UserConfig via inline settings, the OwaUserConfiguration has not been synced yet");t()}},function(n){_js.Trace.logError(_a.$0.$57,"Mark email data outdated when we failed to GetOwaUserConfiguration with clientStoreError: {0}",n.get_$4i());$4Qv(r);t()})},$36j:function(n,t,i){_e.$5l.$9Jd(_g.$JU,this.$64,n,"OwaUserConfiguration.1",t,i)},$8zH:function(n,t,i){var r=this;this.$lu(function(u){if(u){u.ViewStateConfiguration||(u.ViewStateConfiguration=new _g.$Rm);n(u.ViewStateConfiguration);r.$64.$AK(new _a.$6L("Settings.SetOwaViewStateConfiguration"),function(n){r.$36j(n,u,null)},function(){t()},function(n){i(new _e.$1W(n))})}else t()},i)},$36n:function(n,t){var i=this,r=this;this.$lu(function(r){if(r){r.UserOptions.TimeZone=n;i.$64.$AK(new _a.$6L("Settings.SetTimeZone"),function(t){_e.$Nq.$2AX(i.$66Q,t,function(u){for(var f=0;f<u.length;f++)u[f].get_$1s().TimeZoneId===n&&(r.UserOptions.MailboxTimeZoneOffset=[u[f].get_$1s()]);i.$36j(t,r,null)},function(n){_js.Trace.logError(_a.$0.$57,"Failed to load the time zone offsets table: {0}",n.get_$4i())})},function(){_js.Trace.logInfo(_a.$0.$57,"SetTimeZone {0} to offline store succeeded",n);t()},function(i){_js.Trace.logError(_a.$0.$57,"SetTimeZone {0} to offline store failed with dbError: {1}",n,i.$4P);t()})}else t()},function(i){_js.Trace.logError(_a.$0.$57,"SetTimeZone can't retrieve OwaUserConfiguration from offline store, new timezone {0} can't be updated to offline store. ClientStoreError is {1}",n,i.get_$4i());t()})},$7Kk:function(n,t){_e.$5l.$9Jc(_g.$la,this.$64,n,"IdentityCorrelationTable",t)},$8yY:function(n,t,i){_e.$5l.$9Jd(_g.$la,this.$64,n,"IdentityCorrelationTable",t,i)},$6y9:function(n,t){_e.$5l.$2dU(n,"IdentityCorrelationTable")},$1ki:function(n,t){_e.$5l.$W(_g.$Mq,this.$64,"CalendarFolders",n,t)},$8xZ:function(n,t,i){_e.$5l.$9Jd(_g.$Mq,this.$64,n,"CalendarFolders",t,i)},$3ZY:function(n,t){_e.$5l.$W(_g.$Mr,this.$64,"FavoriteFolders",n,t)},$15b:function(n,t){_e.$5l.$W(_g.$Oy,this.$64,"OtherMailboxConfiguration",n,t)},$8y2:function(n,t,i){_e.$5l.$9Jd(_g.$Mr,this.$64,n,"FavoriteFolders",t,i)},$8zE:function(n,t,i){_e.$5l.$9Jd(_g.$Oy,this.$64,n,"OtherMailboxConfiguration",t,i)},$7L2:function(n,t){_e.$5l.$9Jc(Boolean,this.$64,n,"IsOfflineComponentReadyToUse",t)},$8yn:function(n,t,i){_e.$5l.$9Jd(Boolean,this.$64,n,"IsOfflineComponentReadyToUse",t,i)},$7Mg:function(n,t){_e.$5l.$9Jc(Object,this.$64,n,"PersonaJumpHeaderMappings",t)},$8zO:function(n,t,i){_e.$5l.$9Jd(Object,this.$64,n,"PersonaJumpHeaderMappings",t,i)}};_e.$Nq=function(){_e.$Nq.initializeBase(this)};_e.$Nq.$2AX=function(n,t,i,r){_a.$3.$M(n,"timeZoneOffsetsItemStore");_a.$3.$M(i,"successCallback");var u=[];var f=t.$CU(_e.$1E.get_$L().$207.get_$1Q());f.$HQ(null,function(t){t.$CS(1e3,function(t,r,f){for(var e=0;e<r.length;++e)Array.add(u,n.$xM(r[e]));i(u)},null)},function(n){_e.$1W.$BC(n,r)})};_e.$Nq.prototype={get_$e0:function(){return _e.$1E.get_$L().$207},$9GG:function(n){_a.$3.$M(n.TimeZoneId,"TimeZoneId")},$7ET:function(n){return _e.$1X.$54(n.TimeZoneId)},$7EX:function(n){return new ItemMetadata}};_e.$in=function(){_e.$in.initializeBase(this)};_e.$in.get_$5Eq=function(){return new _a.$4U("Data.TombstoneType")};_e.$in.prototype={get_$e0:function(){return _e.$1E.get_$L().$20B},$7EX:function(n){return new ItemMetadata},$7ET:function(n){return _e.$1X.$54(n.Id)},$9GG:function(n){_a.$3.$1C(n.Id,"id")}};_e.$vG=function(n,t){_e.$vG.initializeBase(this,[n,t])};_e.$vG.prototype={$4wU:function(n,t,i,r,u){_a.$3.$M(n,"tx");_a.$3.$M(i,"tombstonedItemsToBeDeleted");_a.$3.$M(r,"perItemCallback");_a.$3.$M(u,"completedCallback");var e=100;var o=[];var s=new _a.$86(_e.$in.get_$5Eq(),t);var h=new _a.$7m(s,null);var f=this;this.$5rO(n,h,e,function(t,e,s,h){_js.Trace.logInfo(_e.$1a.$D,"Found {0} tombstoned items",o.length);for(var l=s,v=l.length,c=0;c<v;++c){var y=l[c];var a=f.$xM(y);r(a.get_$1s());Array.add(i,a.get_$1y())}if(h){_e.$BY.$9JK(_bc.$12m,n,f,i);u()}},null)}};_e.$sV=function(){};_e.$sV.registerInterface("_e.$sV");_e.$ws=function(n){_e.$ws.initializeBase(this,[n,"CalendarSyncState"]);this.$3mK=750};_e.$ws.prototype={$3mK:0,$58M:function(n,t,i){var r=t;var f=i;if(r.TryToIncrementWindowSizeOnNextSync){_js.Trace.logInfo(_a.$0.$1Uy,"CalendarSyncState.TryToIncrementWindowSizeOnNextSync is true. Need to count the existing items in the store.");var u=this;f.$412(n,function(){_e.$7T.$7OP(n,function(t){if(t>=u.$3mK){_js.Trace.logInfo(_a.$0.$1Uy,"Calendar sync have exceeded the limit ({0} stored items,) and therefore won't grow the sync window anymore (Approximate Window Size: {1} months).",u.$3mK,r.ApproximateWindowSize);r.TryToIncrementWindowSizeOnNextSync=!1}else _js.Trace.logInfo(_a.$0.$1Uy,"The number of stored calendar items ({0}) are below the limit --> Sync will try to grow the window on next attempt.",t);u.get_$Y1().$413(n,r)},function(n){_js.Trace.logError(_a.$0.$1Uy,"Unable to count the existing items in the store (Error: {0}).",n.$J7())})})}else _e.$aN.prototype.$58M.call(this,n,t,i)}};_e.$7T=function(n,t,i,r,u,f,e,o,s){this.$$d_$78y=Function.createDelegate(this,this.$78y);_e.$7T.initializeBase(this);this.$1a7=_a.$5H.$$(_g.$6P).$8M();this.$7y=n;this.$qK=_e.$XA.$8M(n);this.$60w=t;this.$4C7=i;this.$2SG=r;this.$33k=u;this.$5s5=f;this.$1ik=e;this.$2p9=o;this.$1BP=s};_e.$7T.$7OP=function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"callback");var u=-1;var f=-1;var r=function(n){_e.$1W.$BC(n,i)};var e=n.$CU(_e.$1E.get_$L().$qH.get_$1Q());e.$3dH(null,function(n){n.$F(function(n){f!==-1?t(n+f):u=n},r)},r);var o=n.$CU(_e.$1E.get_$L().$13o.get_$1Q());o.$3dH(null,function(n){n.$F(function(n){u!==-1?t(n+u):f=n},r)},r)};_e.$7T.$2qS=function(n){};function $6TK(n,t,i){var r=this;n.$9JC(_g.$1j,t,n.$1ik,_e.$5f.$4w2,!0,function(){n.$9JC(_g.$6P,t,n.$5s5,_e.$Ch.$1F6,!1,function(){n.$9JC(_g.$6P,t,n.$2SG,function(n){return n.CalendarItemType==="Single"?_e.$Ch.$1F6(n):null},!1,i)})})}function $3G9(n,t,i,r,u){var o=n.$33k.length-i;var f=Math.min(o,r);_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Persisting reucrrence masters with instances (startIndex: {0}; remaining: {1}; count: {2})...",i,o,f);if(f)for(var s=0,e=0;e<f;e++){var c=n.$33k[i+e];var h=$4Q8(n,c);if(h){var l=this;_e.$3E.$9ID(_bc.$JF,_g.$7q,n.$qK.$1go,t,h,n.$$d_$78y,function(e){_e.$7T.$2qS(e);++s===f&&$3G9(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3E.$D,"CalendarSyncChangeUpdater: The data is null/undefined in the RecurrenceMastersWithInstances list.");++s===f&&$3G9(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Done persisting {0} recurrence masters...",n.$33k.length);u()}}function $3G8(n,t,i,r,u){var s=n.$2SG.length-i;var f=Math.min(s,r);_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Persisting updates (startIndex: {0}; remaining: {1}; count: {2})...",i,s,f);if(f)for(var h=0,e=0;e<f;e++){var c=n.$2SG[i+e];var o=$4Q8(n,c);if(o){var l=this;_e.$3E.$9ID(_bc.$KB,_g.$7q,n.$qK.$13n,t,o,null,function(e){_e.$7T.$2qS(e);++h===f&&$3G8(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3E.$D,"CalendarSyncChangeUpdater: The data is '{0}' in the UpdatedItems list.",o);++h===f&&$3G8(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Done persisting {0} updates.",n.$2SG.length);_e.$1W.$gK(u)}}function $4Q9(n,t){for(var r=n.$1ik,u=r.length,i=0;i<u;++i){var f=r[i];if(f.Id===t)return!0}return!1}function $4Q8(n,t){var i;if($4Q9(n,t.ItemId.Id)){_js.Trace.logInfo(_e.$3E.$D,"Item present in delete list: {0}",t.ItemId.Id);return null}if(t.CalendarItemType==="Occurrence"){var r=n.$1BP.get_$48(t.UID);if(r)if($4Q9(n,r)){_js.Trace.logWarning(_e.$3E.$D,"The master item is deleted for the occurrence with Id {0}",t.ItemId.Id);return null}else{i=n.$2p9.get_$48(r);i.ItemId=t.ItemId;i.CalendarItemType=t.CalendarItemType;i.Start=t.Start;i.StartWallClock=t.StartWallClock;i.End=t.End;i.EndWallClock=t.EndWallClock;i.Recurrence=undefined;i.IsRecurring=!0;i.ItemClass="IPM.Appointment.Occurrence"}else{_js.Trace.logInfo(_e.$3E.$D,"The master item is not downloaded for the occurrence with UID {0}",t.UID);i=n.$2p9.get_$48(t.ItemId.Id)}}else i=n.$2p9.get_$48(t.ItemId.Id);if(!i){var u=String.format("Could not find the data for item (Type: {0}; ID: {1}; UID: {2}).",t.CalendarItemType,t.ItemId.Id,t.UID);_js.Trace.logError(_e.$3E.$D,u);throw Error.create(u);}return i}function $6TL(n,t,i){if(n.$60w){_js.Trace.logInfo(_e.$3E.$D,"Prune calendar items ending before (not including) the sync window's start time ('{0}')...",n.$4C7);var r=new _a.$Li(_e.$5f.$3WK,n.$4C7,0,1);var u=this;n.$qK.$13n.$1ia(t,r,function(){i()})}else i()}_e.$7T.prototype={$qK:null,$2SG:null,$33k:null,$5s5:null,$1ik:null,$2p9:null,$1BP:null,$4C7:null,$60w:!1,$7y:null,$wd:null,$1a7:null,get_$4sJ:function(){return this.$wd?_0365f.$57.$F(this.$wd):0},get_$33d:function(){return this.$1a7?this.$1a7.$9J3():0},$8oH:function(n,t,i){this.$wd={};var r=this;_e.$3E.$8oH(_bc.$JF,n,this.$7y.get_$hL(),t,this.$wd,function(){_e.$3E.$8oH(_bc.$KB,n,r.$7y.get_$1o(),t,r.$wd,i)})},$3YQ:function(n){_e.$3E.$3YQ(this.$wd,n)},$8kN:function(n){var t=this;this.$3YQ(function(i){var r=t.$1a7.get_$48(i);$8(r)?_js.Trace.logInfo(_e.$3E.$D,"Item data not found to reconcile (Id: {0}).",i):r.CalendarItemType==="RecurringMaster"?_e.$3E.$9ID(_bc.$JF,_g.$6P,t.$qK.$1go,n,r,null,_e.$7T.$2qS):_e.$3E.$9ID(_bc.$KB,_g.$6P,t.$qK.$13n,n,r,null,_e.$7T.$2qS)})},$5nz:function(n){this.$412(n,null)},$412:function(n,t){var i=this;$6TL(this,n,function(){_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Successfully finished prunning calendar items.");$6TK(i,n,function(){_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Successfully finished persisting deletes.");$3G9(i,n,0,1,function(){_js.Trace.logInfo(_e.$3E.$D,"CalendarSyncChangeUpdater: Successfully finished persisting recurrence masters.");$3G8(i,n,0,25,t)})})})},$9JC:function(n,t,i,r,u,f){var e=i.length;if(i&&e){var o;var a=this;var h=function(n){a.$qK.$4rz(t,n,function(){--e||f()})};if(u){var v=this;o=function(n){v.$qK.$13n.$2dM(t,n,function(){h(n)})}}else o=h;for(var c=i,y=c.length,s=0;s<y;++s){var p=c[s];var l=r(p);l?o(l):e===1?f():--e}}else f()},$78y:function(n,t,i){var r=this;this.$qK.$4rt(t,n.get_$1y(),function(u){u||r.$qK.$13n.$GW(t,n.get_$1y());r.$qK.$1go.$gO(t,n,1,i)})}};_e.$eu=function(n,t,i){_e.$eu.initializeBase(this);_a.$3.$17(n,"calendarFolderId");_a.$3.$17(t,"windowStart");_a.$3.$17(i,"windowEnd");t.localeCompare(i)>0&&Error.argumentOutOfRange("windowStart",t,String.format("Window start has to be less than window end ({0}).",i));this.$4ir=n;this.$1Bk=t;this.$1NW=i};_e.$eu.prototype={$4ir:null,$1Bk:null,$1NW:null};_e.$k2=function(n){_e.$k2.initializeBase(this);_a.$3.$M(n,"cleaner");this.$4kf=n};_e.$k2.prototype={$4kf:null,$5nz:function(n){_a.$3.$M(n,"tx");this.$4kf(n)}};function ConversationItemSyncState(n,t,i){ConversationItemSyncState.initializeBase(this,["ConversationNodeSyncStateId",n,t]);this.$4nL=i}ConversationItemSyncState.prototype={$4nL:null};_e.$XP=function(n,t,i,r,u){_e.$XP.initializeBase(this);_a.$3.$M(n,"itemStoreGetter");_a.$3.$M(t,"conversationChanges");_a.$3.$M(i,"itemChanges");_a.$3.$M(r,"itemIds");_a.$3.$M(u,"attachments");this.$7y=n;this.$4n6=t;this.$5EW=i;this.$CN=r;this.$CD=u};function $6U6(n,t,i,r,u,f){_a.$3.$M(t,"tx");var e=this;$6U7(n,t,i,f,function(){var f=[];_e.$3E.$9IG(_bc.$KG,_g.$7q,n.get_$5Jb(),t,r,function(n){return _e.$1X.$54(n.ItemId.Id)},function(e){for(var l=r,a=l.length,o=0;o<a;++o){var s=l[o];var h=e.$Lg(s.ItemId.Id)?e.get_$48(s.ItemId.Id).get_$1s():null;var c=_g.$qL.$7iA(h,s);h&&(c=_g.$Om.$4nf(h,c));Array.add(f,c)}_e.$3E.$9IB(_bc.$g3,_g.$XR,n.get_$4nC(),t,i,null);_e.$3E.$9IB(_bc.$KG,_g.$7q,n.get_$5Jb(),t,f,null);_e.$3E.$9IB(_bc.$lO,AttachmentInfoRecord,n.get_$6te(),t,u,null)})})}function $6U7(n,t,i,r,u){for(var o=0,e=i,s=e.length,f=0;f<s;++f){var h=e[f];var c=this;n.get_$4nC().$Da(t,_e.$1X.$54(h.ConversationId.Id),function(f){if(f){var h=f.get_$1s();if(h.ConversationNodes)for(var c=h.ConversationNodes,y=c.length,e=0;e<y;++e)for(var l=c[e],s=0;s<l.Items.length;s++){var a=l.Items[s];var v=a.ItemId.Id;if(!r.get_$48(v)){var p=n.get_$4Dn().$lp(TombstonedItemRecord.$I(v,"MessageItem",a));p.$35R(t,1,null)}}}++o===i.length&&u()},null)}}_e.$XP.prototype={$7y:null,$4n6:null,$5EW:null,$CN:null,$CD:null,$2dv:null,$3Uf:null,$4nI:null,$7dY:null,get_$4sJ:function(){return this.$2dv?_0365f.$57.$F(this.$2dv)+_0365f.$57.$F(this.$3Uf):0},get_$33d:function(){return this.$4nI?this.$4nI.length+this.$7dY.length:0},get_$5Jb:function(){return this.$7y.get_$4i()},get_$4nC:function(){return this.$7y.get_$Hi()},get_$6te:function(){return this.$7y.get_$1Cz()},get_$4Dn:function(){return this.$7y.get_$4Dm()},$5nz:function(n){$6U6(this,n,this.$4n6,this.$5EW,this.$CD,this.$CN)},$8oH:function(n,t,i){this.$2dv={};this.$3Uf={};var r=this;_e.$3E.$8oH(_bc.$g3,n,this.$7y.get_$Hi(),t,this.$2dv,function(){_e.$3E.$8oH(_bc.$KG,n,r.$7y.get_$4i(),t,r.$3Uf,i)})},$8kN:function(n){}};_e.$QM=function(n,t,i){_e.$QM.initializeBase(this,[n,t,i])};function $6U8(n,t,i){if(!t.GlobalItemChangeKeys||!t.GlobalItemReadFlags||!i.GlobalItemChangeKeys||!i.GlobalItemReadFlags)return!1;for(var f=0;f<t.GlobalItemIds.length;f++);for(var e=0;e<i.GlobalItemIds.length;e++);if(t.GlobalItemIds.length!==i.GlobalItemIds.length)return!1;var u=t.GlobalItemIds.length;if(t.GlobalItemChangeKeys.length!==u||i.GlobalItemChangeKeys.length!==u)return!1;for(var r=0;r<u;r++)if(t.GlobalItemIds[r].Id!==i.GlobalItemIds[r].Id||t.GlobalItemChangeKeys[r]!==i.GlobalItemChangeKeys[r])return!1;return!0}function $6U9(n,t,i){if(!n.get_$9JM().length){i();return}var r=[];var u=this,f=this;_e.$3E.$9IG(_bc.$11P,_g.$TI,n.get_$5Ep(),t,n.get_$9JM(),function(n){return _e.$D8.$xL(n.FolderId,n.ConversationId)},function(t){for(var o=n.get_$9JM(),h=o.length,e=0;e<h;++e){var u=o[e];var s=_e.$D8.$xL(u.FolderId,u.ConversationId);u.DirtyState=2;var f=t.$Lg(s.get_$1V2().toString())?t.get_$48(s.get_$1V2().toString()).get_$1s():null;if(f){if(n.get_$9JL()!==11&&n.get_$9JL()!==10||f.LastModifiedTime!==u.LastModifiedTime){f.DirtyState!==2&&$6U8(n,u,f)&&(u.DirtyState=1);Array.add(r,u)}}else Array.add(r,u)}n.set_$9JM(r);i()})}_e.$QM.prototype={$5nz:function(n){var t=this;$6U9(this,n,function(){_e.$Us.prototype.$412.call(t,n,function(){t.$9JP(n)})})}};function EmailItemSyncState(n,t,i){EmailItemSyncState.initializeBase(this,[n,""]);_a.$3.$M(t,"itemIds");this.$4kH=i;this.$5n=t}EmailItemSyncState.prototype={$5n:null,$4kH:null};_e.$zP=function(n,t,i,r){_e.$zP.initializeBase(this,[n,t]);_a.$3.$1C(i,"outboxFolderId");_a.$3.$6v(r,0,2147483647,"outboxFolderPositionIndex");this.$10U=i;this.$31B=r};_e.$zP.prototype={$10U:null,$31B:0,$5nz:function(n){_a.$3.$M(n,"tx");var t=this;this.get_$5Ep().$1d0(n,_e.$1X.$54(this.$10U),function(i){var u=i;var r=t.get_$9JQ()[t.$31B];if(u){r.TotalCount=u.get_$1s().TotalCount;r.UnreadCount=u.get_$1s().UnreadCount}else{r.TotalCount=0;r.UnreadCount=0}_e.$LE.prototype.$5nz.call(t,n)},null)}};function MessageItemSyncState(n,t,i){MessageItemSyncState.initializeBase(this,["MessageItemSyncStateId",n,t]);this.$3kv=i}MessageItemSyncState.prototype={$3kv:!1};_e.$RU=function(n,t,i,r,u){_e.$RU.initializeBase(this,[n,t,i]);this.$1wH=r;this.$1fp=u};function $6VN(n,t){for(var i=0;i<n.$1wH.length;i++){var r=n.$1wH[i];var u=this;n.get_$5Ep().$1d0(t,_e.$1X.$54(r.ItemId.Id),function(n){var i=n;if(i){i.get_$1s().IsRead=r.IsRead;i.$35R(t,1,null)}},null)}}function $6VM(n,t,i){var r;if(t&&i.ItemId.ChangeKey===t.ItemId.ChangeKey){r=_g.$Om.$4ni(i,t);if((n.get_$9JL()===11||n.get_$9JL()===10)&&t.IsRead===i.IsRead)return null}else r=i;_e.$B6.$2P1(r,"false",0);return r}_e.$RU.prototype={$1wH:null,$1fp:null,$5nz:function(n){_a.$3.$M(n,"tx");var i=[];var r=this,t=this;_e.$3E.$9IG(_bc.$KG,_g.$7q,this.get_$5Ep(),n,this.get_$9JM(),function(n){return _e.$1X.$54(n.ItemId.Id)},function(r){for(var e=t.get_$9JM(),s=e.length,u=0;u<s;++u){var f=e[u];var h=r.$Lg(f.ItemId.Id)?r.get_$48(f.ItemId.Id).get_$1s():null;var o=$6VM(t,h,f);o&&Array.add(i,o)}t.set_$9JM(i);t.$1fp&&t.$1fp.$4km(n,t.get_$9JN(),0,function(){});$6VN(t,n);_e.$Us.prototype.$412.call(t,n,function(){t.$9JP(n)})})}};_e.$Ku=function(n,t){this.$2PL=this.$$gta["_e.$Ku"].TItem===Number||Type.isEnum(this.$$gta["_e.$Ku"].TItem)?0:this.$$gta["_e.$Ku"].TItem===Boolean?!1:null;_e.$Ku.$$(this.$$gta["_e.$Ku"].TItem).initializeBase(this);_a.$3.$M(n,"setting");_a.$3.$M(t,"persister");this.$2PL=n;this.$5o1=t};_e.$Ku.$$=function(n){var t="$Ku"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$Ku"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$Ku.apply(this,i)};r.registerClass("_e."+t,_e.$3E);var u=_e.$Ku.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$Ku.prototype={$5o1:null,$5nz:function(n){_a.$3.$M(n,"tx");this.$5o1(this.$2PL,n)}};_e.$3M=function(){this.$$d_$8yl=Function.createDelegate(this,this.$8yl);this.$2WY={};_e.$3M.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_e.$3M.initializeBase(this);this.add_$456(this.$$d_$8yl);this.add_$5tj(this.$$d_$8yl)};function $6T3(n,t){var i=t.request.actionHandler;if(i){n.$2WY[t.id.toString()]=i;t.request.hasActionHandler=!0}}function $6T5(n,t){t.request.hasActionHandler&&(t.request.actionHandler=n.$2WY[t.id.toString()])}function $6T4(n,t){delete n.$2WY[t.toString()]}function $6T1(n,t){_e.$F3.$3gh(t)?n.$1lo++:n.$1VU++}function $6T2(n,t){_e.$F3.$3gh(t)?n.$1lo<=0?_js.Trace.logWarning(_e.$3M.$D,"Trying to decrement HighPriorityActionCount when it is already <= 0, value = {0}",n.$1lo):n.$1lo--:n.$1VU<=0?_js.Trace.logWarning(_e.$3M.$D,"Trying to decrement LowPriorityActionCount when it is already <= 0, value = {0}",n.$1VU):n.$1VU--}_e.$3M.prototype={$1lo:0,$1VU:0,add_$7e4:function(n){this.$a(_e.$3M.$2Ey.$1j,n)},remove_$7e4:function(n){this.$w(_e.$3M.$2Ey.$1j,n)},add_$5tj:function(n){this.$a(_e.$3M.$2Nd.$1j,n)},remove_$5tj:function(n){this.$w(_e.$3M.$2Nd.$1j,n)},add_$456:function(n){this.$a(_e.$3M.$2Nk.$1j,n)},remove_$456:function(n){this.$w(_e.$3M.$2Nk.$1j,n)},add_$4jq:function(n){this.$a(_e.$3M.$256.$1j,n)},remove_$4jq:function(n){this.$a(_e.$3M.$256.$1j,n)},add_$3gD:function(n){this.$a(_e.$3M.$2D5.$1j,n)},remove_$3gD:function(n){this.$a(_e.$3M.$2D5.$1j,n)},get_$5Fc:function(){return this.$W(_e.$3M.$2Ey)},set_$5Fc:function(n){this.$N(_e.$3M.$2Ey,n);return n},get_$2Nc:function(){return this.$W(_e.$3M.$2Nd)},set_$2Nc:function(n){this.$N(_e.$3M.$2Nd,n);return n},get_$1wr:function(){return this.$W(_e.$3M.$2Nk)},set_$1wr:function(n){this.$N(_e.$3M.$2Nk,n);return n},get_$1gx:function(){return this.$W(_e.$3M.$256)},set_$1gx:function(n){this.$N(_e.$3M.$256,n);return n},get_$C2:function(){return this.$W(_e.$3M.$2D5)},set_$C2:function(n){this.$N(_e.$3M.$2D5,n);return n},get_$5Ac:function(){return this.$1lo>0},get_$7g3:function(){return this.$1VU},set_$7g3:function(n){this.$1VU=n;return n},$3WN:function(n,t,i){var r=new _g.$47(n);var u=this;this.$7Cm(r,function(n){r.id=n;_js.Trace.logInfo(_e.$3M.$D,"{0} enqueued",_g.$47.$R1(r));$6T3(u,r);u.set_$5Fc(r);u.set_$2Nc(!0);$6T1(u,r);t(r)},i)},$7Lu:function(n,t){var i=this;this.$7Lv(function(t){if(t){_js.Trace.logInfo(_e.$3M.$D,"{0} retrieved as next request.",_g.$47.$R1(t));$6T5(i,t)}else{_js.Trace.logInfo(_e.$3M.$D,"No requests available.");i.set_$2Nc(!1)}n(t)},t)},$7Lw:function(n,t){var i=this;this.$7Lx(function(t){if(t)_js.Trace.logInfo(_e.$3M.$D,"{0} retrieved as next response.",_g.$47.$R1(t));else{_js.Trace.logInfo(_e.$3M.$D,"No responses available.");i.set_$1wr(!1)}n(t)},t)},$4yz:function(n,t){this.$7Hv(n,t)},$3Q:function(n,t,i,r){$6T4(this,n);var u=this;this.$8qn(r,n,function(i,r){if(i){_js.Trace.logInfo(_e.$3M.$D,"Action Record {0} removed.",n);$6T2(u,r)}else _js.Trace.logInfo(_e.$3M.$D,"Action Record {0} was not present.",n);t(i)},i)},$8zd:function(n,t,i){n.state=1;var r=this;this.$69A(n,function(){_js.Trace.logInfo(_e.$3M.$D,"{0} response saved.",_g.$47.$R1(n));r.set_$1wr(!0);t()},i)},$9F5:function(n,t,i){n.state=0;var r=this;this.$69A(n,function(){_js.Trace.logInfo(_e.$3M.$D,"{0} updated in the database.",_g.$47.$R1(n));t()},i)},$8yl:function(n,t){_js.Trace.logInfo(_e.$3M.$D,"RequestAvailable : {0}",this.get_$2Nc());_js.Trace.logInfo(_e.$3M.$D,"ResponseAvailable: {0}",this.get_$1wr());this.set_$C2(!this.get_$2Nc()&&!this.get_$1wr())}};_e.$ES=function(n,t){this.$$d_$96R=Function.createDelegate(this,this.$96R);this.$$d_$8d8=Function.createDelegate(this,this.$8d8);this.$$d_$8d9=Function.createDelegate(this,this.$8d9);this.$$d_$8WI=Function.createDelegate(this,this.$8WI);this.$$d_$8WJ=Function.createDelegate(this,this.$8WJ);this.$qs="";this.$1n=t;this.$Fp=n};function $21q(n){if(!n.$42c&&n.get_$7SA()&&n.get_$6wY()){n.$42c=!0;n.$qs="Fetching next record...";n.$7Eg(n.$$d_$8WJ,n.$$d_$8WI)}}function $2UR(n){n.$42c=!1;n.set_$4pe(null);$21q(n)}_e.$ES.prototype={$Fp:null,$qr:null,$42c:!1,$1n:null,get_$76r:function(){return this.$qr?this.$qr.id:0},get_$4pe:function(){return this.$qr},set_$4pe:function(n){this.$qr=n;this.$qs=_g.$47.$R1(n);return n},$96R:function(n,t){$21q(this)},$8WJ:function(n){this.set_$4pe(n);this.$qr?this.$8nB(this.$$d_$8d9,this.$$d_$8d8):$2UR(this)},$8WI:function(n){_js.Trace.logWarning(this.$1n,"Failed to fetch next record: {0}",n.message);$2UR(this)},$8d9:function(){$2UR(this)},$8d8:function(n){_js.Trace.logWarning(this.$1n,"Processing of {0} failed: {1}",this.$qs,n.message);$2UR(this)}};_e.$BW=function(n){_e.$BW.initializeBase(this,[n.$4ez]);_a.$3.$M(n.$6T,"clientStore");this.$6C=n};_e.$BW.$2lH=function(n,t){var i=new _bc.$Ep(0,t);var r=Error.create(_e.$BW.$1Jq,i);n(r)};_e.$BW.prototype={$6C:null,$1fA:function(n,t,i,r){_a.$3.$M(n,"instantMessageBuddy");var u=new _e.$WO(t,this.$6C,n.PersonaId,this.$6C.get_$Bq());var f=this,o=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1fA.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(t,-2);i(n,t)},function(n){_e.$BW.$2lH(r,n)})},function(n){_e.$BW.$2lH(r,n)},function(){_js.Trace.logWarning(_a.$0.$Jo,"AddFavorite service command was rejected by the offline proxy.");_g.$7Y.prototype.$1fA.call(e,n,t,i,r)})},$1Ci:function(n,t,i,r){var u=new _e.$9T(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1Ci.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"ApplyConversationAction was rejected by the offline proxy.");_g.$7Y.prototype.$1Ci.call(e,n,t,i,r)})},$1E1:function(n,t,i,r){if(t.isQueued){var u=new _e.$Mb(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1E1.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(u.$2n,-2);i(n,u.$2n)},r)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"CreateAttachment was rejected by the offline proxy.");e.$6C.get_$KH().$1E1(n,t,i,r)})}else this.$6C.get_$KH().$1E1(n,t,i,r)},$hh:function(n,t,i,r){if(t.isQueued){this.$6C.get_$1TG().$1d3(n);var u=new _e.$16(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$hh.call(f,n,t,function(r,f){n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&u.$5zf(t.itemIds[0],r.id);r.response=_g.$9H.$i0(u.$2n,-2);i(r,u.$2n)},r)},r,function(){e.$6C.get_$KH().$hh(n,t,i,function(n){var t=new _bc.$Ep(u.$Iw,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else this.$6C.get_$KH().$hh(n,t,i,r)},$1ho:function(n,t,i,r){var u=new _e.$Mc(t,this.$6C,n.Body.PropertyUpdates,n.Body.ParentFolderId,n.Body.PersonTypeString,this.$6C.get_$Bq());var f=this,o=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1ho.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(u.get_$1v(),-2);i(n,u.get_$1v())},function(n){var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)})},function(n){var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)},function(){_g.$7Y.prototype.$1ho.call(e,n,t,function(n,t){n.response=_g.$9H.$i0(null,-2);i(n,t)},function(n){var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)})})},$1EZ:function(n,t,i,r,u){i.personaId=n=this.$6C.get_$1TG().$lw(n);var f=new _e.$Y1(i,this.$6C,n,this.$6C.get_$Bq());var e=this,o=this;f.$9I6(function(){_g.$7Y.prototype.$1EZ.call(e,n,t,i,r,u)},u,function(){_g.$7Y.prototype.$1EZ.call(o,n,t,i,r,u)})},$1R1:function(n,t,i,r){var u=new _e.$GZ(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1R1.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(u.$2n,-2);i(n,u.$2n)},r)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"DeleteAttachment service command was rejected by the offline proxy.");_g.$7Y.prototype.$1R1.call(e,n,t,i,r)})},$1jZ:function(n,t,i,r){var u=new _e.$FA(t,this.$6C,n,_g.$g.$1i,this.$6C.get_$Bq());var f=this,o=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1jZ.call(f,n,t,i,r)},function(n){_js.Trace.logError(_a.$0.$Jo,"EmptyFolder service command failed. Exception: {0}",n);var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$Jo,"EmptyFolder service command was rejected by the offline proxy.");_g.$7Y.prototype.$1jZ.call(e,n,t,i,r)})},$2gK:function(n,t,i,r){var u=new _e.$A7(t,this.$6C,n,this.$6C.get_$Bq(),_g.$g.$1i,this.$6C.$Bo);var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$2gK.call(f,n,t,i,r)})},$1ki:function(n,t,i){var r=new _e.$Qn(n,this.$6C,this.$6C.get_$Bq());var f=this,u=this;r.$9I6(function(){t(null,r.$2n)},i,function(){_g.$7Y.prototype.$1ki.call(u,n,t,i)})},$29w:function(n,t,i,r){var u=new _e.$Ms(t,this.$6C,n,this.$6C.get_$Bq());var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$29w.call(f,n,t,i,r)})},$xA:function(n,t,i,r){var u=new _e.$Qf(t,this.$6C,n,this.$6C.get_$Bq());var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$xA.call(f,n,t,i,r)})},$296:function(n,t,i,r){var u=new _e.$2w(t,this.$6C,n,this.$6C.get_$Bq(),_g.$g.$1i);var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$296.call(f,n,t,i,r)})},$1Rz:function(n,t,i,r){var u=new _e.$9Y(t,this.$6C,n,this.$6C.get_$Bq());var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$1Rz.call(f,n,t,i,r)})},$1kn:function(n,t,i,r){var u=new _e.$9a(t,this.$6C,n);var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$1kn.call(f,n,t,i,r)})},$1Sg:function(n,t,i){var r=new _e.$10N(n,this.$6C,this.$6C.get_$Bq());var f=this,u=this;r.$9I6(function(){t(null,r.$As)},i,function(){_g.$7Y.prototype.$1Sg.call(u,n,t,i)})},$2AH:function(n,t,i,r){var u=new _e.$10P(t,this.$6C,n,this.$6C.get_$Bq());var o=this;var f=function(){i(null,u.$2n)};var e=this;u.$9I6(f,r,function(){u.$3XQ?_g.$7Y.prototype.$2AH.call(e,n,t,i,function(n){_js.Trace.logWarning(_a.$0.$Jo,"GetPersona service command failed on the server. Falling back to the client store. Error: {0}",n.message);u.$9I6(f,r,function(){r(n)})}):_g.$7Y.prototype.$2AH.call(e,n,t,i,r)})},$gu:function(n,t,i,r){this.$6C.get_$1TG().$1d3(n);if(t.clientStoreItem===1){var u=new _e.$7A(t,this.$6C,n);var e=this,o=this;u.$9I6(function(){_g.$7Y.prototype.$gu.call(e,n,t,function(n,t){n.response=_g.$9H.$i0(u.$2n,-2);i(n,u.$2n)},r)},r,function(){o.$6C.get_$KH().$gu(n,t,i,function(n){var t=new _bc.$Ep(u.$Iw,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else{var f=new _e.$3s(t,this.$6C,n);var s=this,h=this;f.$9I6(function(){_g.$7Y.prototype.$gu.call(s,n,t,function(r,u){r.response=_g.$9H.$i0(f.$2n,-2);n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&f.$5zf(t.itemIds[0],r.id);i(r,f.$2n)},r)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"UpdateItem service command was rejected by the offline proxy.");h.$6C.get_$KH().$gu(n,t,i,r)})}},$3k:function(n,t,i,r){this.$6C.$bc.$1d3(n);var u=new _e.$68(t,this.$6C,n);var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$3k.call(f,n,t,i,function(n){var t=new _bc.$Ep(u.$Iw,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$eA:function(n,t,i,r){this.$6C.get_$1TG().$1d3(n);var u=new _e.$8x(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$eA.call(f,n,t,i,r)},r,function(){e.$6C.get_$KH().$eA(n,t,i,function(n){var t=new _bc.$Ep(u.$Iw,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$15f:function(n,t,i,r){var u=new _e.$Qq(t,this.$6C,n,this.$6C.get_$Bq());var e=this,f=this;u.$9I6(function(){i(null,u.$2n)},r,function(){_g.$7Y.prototype.$15f.call(f,n,t,i,r)})},$2Ln:function(n,t,i,r){var u=new _e.$9C(t,this.$6C,n,this.$6C.get_$Bq());var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$2Ln.call(f,n,t,function(n){n.response=_g.$9H.$i0(u.$2n,-2);i(n)},r)},r,function(){e.$6C.get_$KH().$2Ln(n,t,i,r)})},$2NP:function(n,t,i,r){var u=new _e.$cI(t,this.$6C,n,this.$6C.get_$Bq());var f=this,o=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$2NP.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(t,-2);i(n,t)},function(n){_e.$BW.$2lH(r,n)})},function(n){_e.$BW.$2lH(r,n)},function(){_js.Trace.logWarning(_a.$0.$Jo,"RemoveFavorite service command was rejected by the offline proxy.");_g.$7Y.prototype.$2NP.call(e,n,t,i,r)})},$1d5:function(n,t,i,r){t.personaId=n.Body.PersonaId=this.$6C.get_$1TG().$lw(n.Body.PersonaId);var u=new _e.$18s(t,this.$6C,n.Body.PersonaId,n.Body.PropertyUpdates,n.Body.PersonTypeString);var f=this,o=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1d5.call(f,n,t,function(n,t){n.response=_g.$9H.$i0(u.get_$1v(),-2);i(n,u.get_$1v())},function(n){var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)})},function(n){var t=new _bc.$Ep(0,n);var i=Error.create(_e.$BW.$1Jq,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$Jo,"UpdatePersona service command was rejected by the offline proxy.");_g.$7Y.prototype.$1d5.call(e,n,t,i,r)})},$lu:function(n,t,i){var r=new _e.$Mw(n,this.$6C);var f=this,u=this;r.$9I6(function(){t(null,r.$t)},i,function(){_g.$7Y.prototype.$lu.call(u,n,t,i)})},$20g:function(n,t,i,r){var u=new _e.$ou(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$20g.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"UpdateUserConfiguration service command was rejected by the offline proxy.");_g.$7Y.prototype.$20g.call(e,n,t,i,r)})},$1y8:function(n,t,i,r){var u=this;_g.$7Y.prototype.$1y8.call(this,n,t,function(f,e){var o=new _e.$ct(t,u.$6C,n);o.$9I6(function(){i(f,e)},r,function(){r(Error.create("SetLayoutSettings was rejected by the offline proxy."))})},r)},$36n:function(n,t,i,r){var u=this;_g.$7Y.prototype.$36n.call(this,n,t,function(f,e){var o=new _e.$16l(t,u.$6C,n);o.$9I6(function(){i(f,e)},r,function(){_js.Trace.logWarning(_a.$0.$Jo,"SetTimeZone service command was rejected by the offline proxy.")})},r)},$29v:function(n,t,i){var r=new _e.$kv(n,this.$6C,this.$6C.get_$Bq());var f=this,u=this;r.$9I6(function(){t(null,r.$2n)},i,function(){_g.$7Y.prototype.$29v.call(u,n,t,i)})},$15b:function(n,t,i){var r=new _e.$kz(n,this.$6C,this.$6C.get_$Bq());var f=this,u=this;r.$9I6(function(){t(null,r.$2n)},i,function(){_g.$7Y.prototype.$15b.call(u,n,t,i)})},$1JO:function(n,t,i,r){var u=new _e.$KW(t,this.$6C,n);var f=this,e=this;u.$9I6(function(){_g.$7Y.prototype.$1JO.call(f,n,t,i,r)},r,function(){e.$6C.get_$KH().$1JO(n,t,i,function(n){var t=new _bc.$Ep(u.$Iw,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}};_e.$ge=function(n){this.$4N=n};_e.$ge.prototype={$4N:null,get_$7C9:function(){var n=this.get_$1hS();if(n)for(var t=0;t<n.length;t++){var i=n[t];if(i.ModuleType===11)return!0}return!1},get_$1hS:function(){return this.$9I1(Array,"ConfigChangeCleanupModuleList")},set_$1hS:function(n){n&&this.$4N.$Bp("ConfigChangeCleanupModuleList",JsonParser.serialize(n));return n},$3KR:function(n,t){var u=new ConfigChangeCleanupModuleItem(n,t);var i=this.get_$1hS();if(i){for(var f=!1,e=i,o=e.length,r=0;r<o;++r){var s=e[r];if(s.ModuleType===n){f=!0;break}}f||Array.add(i,u)}else i=[u];this.set_$1hS(i)},$5sx:function(n){var t=this.get_$1hS();if(t)for(var i=0;i<t.length;i++){var r=t[i];if(r.ModuleType===n){Array.removeAt(t,i);this.set_$1hS(t);return}}_js.Trace.logWarning(_a.$0.$1zZ,"We didn't find {0} in the cleanup module list",n)},$7Ip:function(n){var t=null;var i=this.get_$1hS();if(i){t=[];for(var r=0;r<i.length;r++){var u=i[r];u.SyncManagerStartTime!==n&&Array.add(t,u.ModuleType)}}return t},$9I1:function(n,t){var i=this.$4N.$3k(t);return i?JsonParser.deserialize(i):n===Number||Type.isEnum(n)?0:n===Boolean?!1:null}};_e.$5s=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6BR=Function.createDelegate(this,this.$6BR);_e.$5s.resolveInheritance();this.dispose=this.$1M;_e.$5s.initializeBase(this,[n,i,r,u,f]);_a.$3.$1C(t,"timeZoneId");this.$6t=t;this.$7y=new _e.$RG(n,t);this.$5yk=new _e.$16M(this.$7y);this.$2Mi=o?"MOWA":"DOWA";this.$27V=s;this.$27Z=h;this.$Bo=l;this.$3x=a;_js.Trace.logInfo(_e.$5s.$D,"Protocol: {0}",this.$2Mi);_js.Trace.logInfo(_e.$5s.$D,"DeviceId: {0}",this.$27V);_js.Trace.logInfo(_e.$5s.$D,"DeviceType: {0}",this.$27Z);Sys.Net.WebRequestManager.add_invokingRequest(this.$$d_$6BR);this.$6H=new _e.$9O(this.$7y);this.$bc=new _g.$KD;c&&this.$bc.$5za(c);this.get_$KH().$bc=this.$bc;this.$Fp=e;this.$ML=new _e.$15G(e,this.$bc);this.$4ez=new _g.$vv(this.get_$KH(),this.$ML);this.$4lG=new _e.$BW(this)};function $4Qr(n,t){if(t){var i=this;n.$6H.$8yY(t,n.$bc.$4ou(),function(){_js.Trace.logInfo(_e.$5s.$D,"Identity correlation table persisted.")})}}_e.$5s.prototype={$6H:null,$ML:null,$4ez:null,$4lG:null,$bc:null,$3x:null,$2Mi:null,$27V:null,$27Z:null,$7y:null,$5yk:null,$Fp:null,$6t:null,$1UK:!1,$5tn:null,$8t4:null,$Bo:null,$2fq:null,get_$7E2:function(){return this.$2fq},set_$7E2:function(n){this.$2fq=n;return n},get_$3Cf:function(){return this.$4lG},get_$6tW:function(){return _e.$53.$1Fc()},get_$8xB:function(){return this.$5yk},get_$YC:function(){return this.$Fp},set_$YC:function(n){this.$Fp=n;return n},get_$1TG:function(){return this.$bc},get_$95:function(){return this.$7y},get_$Bq:function(){return this.$3x.$ed()},get_$IJ:function(){return this.$6t},set_$IJ:function(n){this.$6t=n;return n},get_$7b9:function(){return this.$1UK},$96U:function(n){this.$5tn=new _e.$nx(this,n,this.$S);this.$8t4=new _e.$cP(this.$Fp,this.$$d_$2Mc,this.$S)},$264:function(n,t,i){this.$bc.$264(t,i);$4Qr(this,n)},$265:function(n,t,i){this.$bc.$265(t,i);$4Qr(this,n)},$lw:function(n){return this.$bc.$lw(n)},$5tE:function(n,t,i){var r=!1;var f=!1;var u=this,e=this,o=this;this.$6T.get_$wQ().$AK(new _a.$6L("OfflineMailboxDataContext.RemoveSendAction"),function(i){u.$7y.get_$ch().$Da(i,_e.$1X.$54(n),function(e){if(!e||!e.get_$1s()){_js.Trace.logWarning(_e.$5s.$D,"RemoveSendAction - Outbox item not found: {0}",n);t(r,f,null,null);return}_js.Trace.logInfo(_e.$5s.$D,"RemoveSendAction - Item found: {0}",n);var o=e.get_$SW();if(!o){_js.Trace.logWarning(_e.$5s.$D,"RemoveSendAction - Outbox item context is null: {0}",n);r=!0;t(r,f,null,null);return}_js.Trace.logInfo(_e.$5s.$D,"RemoveSendAction - Calling ActionQueue.Remove, action {0}: {1}",o.ActionId,n);u.$Fp.$3Q(o.ActionId,function(i){_js.Trace.logInfo(_e.$5s.$D,"RemoveSendAction - Removed Action {0} for item {1}. Results {2}",o.ActionId,n,i);r=o.ActionId!==u.$5tn.get_$76r();t(r,o.SendAction===1,o.ParentConversationNodeId,o.ComplianceId)},function(n){_js.Trace.logError(_e.$5s.$D,"Failed to remove action from action queue, action id = {0}, Error = {1}",o.ActionId,n.message)},i)},null)},function(){_js.Trace.logInfo(_e.$5s.$D,"RemoveSendAction succeeded for outbox item id {0}.",n)},function(n){_js.Trace.logError(_e.$5s.$D,"RemoveSendAction failed. Error code: '{0}'  Error message: '{1}'",n.$SU,n.$4P);var t=new _e.$1W(n);i(t.$IU())})},$28a:function(n,t,i,r,u){if(!this.$2fq||this.$2fq()){_js.Trace.logInfo(_e.$5s.$D,"ExecuteWithActionQueue enqueueing: {0}",n);var f=new _g.$eQ(n,i,null);f.actionHandler=t;f.hasActionHandler=!0;this.$Fp.$3WN(f,r,u)}else _g.$1Q.prototype.$28a.call(this,n,t,i,r,u)},$3UO:function(){_js.Trace.logInfo(_e.$5s.$D,"Deprovisioning {0}-{1}-{2}",this.$2Mi,this.$27V,this.$27Z);this.$Fp.set_$1gx(!1);var t=new _g.$YA(this.$27V,this.$27Z);t.HasPAL=this.$2Mi==="MOWA";var n=new _g.$RI("Exchange2013");n.TimeZoneContext=new _g.$SV;n.TimeZoneContext.TimeZoneDefinition=new _g.$Np;n.TimeZoneContext.TimeZoneDefinition.Id=this.$6t;var i=this,r=this;this.get_$KH().$3UO(new _g.$Y8(n,t),null,function(n,t){"Success"===t.Body.ResponseMessages.Items[0].ResponseClass?_js.Trace.logInfo(_e.$5s.$D,"...deprovisioning succeeded."):_js.Trace.logError(_e.$5s.$D,"Deprovision command failed. We're explicitly ignoring this failure. {0}",t.Body.ResponseMessages.Items[0].MessageText);Sys.Net.WebRequestManager.remove_invokingRequest(i.$$d_$6BR)},function(n){_js.Trace.logError(_e.$5s.$D,"Deprovision call failed. We're explicitly ignoring this failure. {0}",n)})},$5zW:function(n,t,i){if(this.$1UK===n){_js.Trace.logWarning(_e.$5s.$D,"IsOfflineComponentReadyToUse: value ({0}) has not changed. Skipping the write to the store.",this.$1UK);_e.$1W.$gK(t)}else{var r=this,u=this,f=this;this.$7y.$AK(new _a.$6L("OfflineMailboxDataContext.SetIsOfflineComponentReadyToUse"),function(t){r.$6H.$8yn(t,n,null)},function(){u.$1UK=n;_js.Trace.logInfo(_e.$5s.$D,"Successfully saved the new value for IsOfflineComponentReadyToUse: {0}",n);_e.$1W.$gK(t)},function(t){_js.Trace.logError(_e.$5s.$D,"IsOfflineComponentReadyToUse: Failed to persist the new value {0} and reverting to the old value {1}. Error: {2}",n,f.$1UK,t.$4P);_e.$1W.$BC(t,i)})}},$7fF:function(n){var t=this,i=this,r=this;this.$7y.$AK(new _a.$6L("OfflineMailboxDataContext.LoadIsOfflineComponentReadyToUse"),function(n){t.$6H.$7L2(n,function(n){t.$1UK=n})},function(){i.$1UK?_js.Trace.logInfo(_e.$5s.$D,"Offline component is ready to use."):_js.Trace.logWarning(_e.$5s.$D,"Offline is enabled but not ready to use yet.");n()},function(t){_js.Trace.logError(_e.$5s.$D,"IsOfflineComponentReadyToUse: Failed to fetch the setting. Falling back to kiosk mode. Error: {0}",t.$4P);n()})},$6BR:function(n,t){t.get_webRequest().get_headers()["X-OWA-Protocol"]=this.$2Mi;t.get_webRequest().get_headers()["X-OWA-DeviceId"]=this.$27V;t.get_webRequest().get_headers()["X-OWA-DeviceType"]=this.$27Z},$59:function(){Sys.Net.WebRequestManager.remove_invokingRequest(this.$$d_$6BR);_g.$1Q.prototype.$59.call(this)}};_e.$15G=function(n,t){_e.$15G.initializeBase(this);_a.$3.$M(n,"actionQueue");_a.$3.$M(t,"identityCorrelationTable");this.$Fp=n;this.$bc=t};_e.$15G.prototype={$Fp:null,$bc:null,$k:function(n,t,i,r,u,f){var e=this;this.$eu(t,i,r,function(t){u(t,n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},f)},$eu:function(n,t,i,r,u){_a.$3.$M(r,"invokeSucceeded");_a.$3.$M(u,"invokeFailed");var f=new _g.$eQ(n,t,i);this.$bc.$1d3(t);this.$Fp.$3WN(f,r,u)}};_e.$nx=function(n,t,i){this.$$d_$7QN=Function.createDelegate(this,this.$7QN);this.$$d_$6pU=Function.createDelegate(this,this.$6pU);_e.$nx.initializeBase(this,[n.$Fp,_a.$0.$5to]);this.$NU=n;this.$AS=n.$AS;this.$18x=n.get_$KH();this.$1wt=n.$1wt;this.$5Ew=t;var r=this;i.$HX(_a.$h3,function(n){_js.Trace.logInfo(r.$1n,"RequestQueueProcessor received NonBootModelResponseProcessorReady event");r.$Fp.add_$5tj(r.$$d_$96R);r.$Fp.add_$7e4(r.$$d_$6pU);r.$Fp.add_$456(r.$$d_$96R);r.$Fp.add_$4jq(r.$$d_$96R);i.$HX(_a.$QG,r.$$d_$7QN);$21q(r)})};function $6VZ(n,t,i){var r=n.$qr;var f=_a.$7.get_$2M();var e=n.$1wt.$60d(r,n.$NU);_g.$47.$43P(r,f);if(e){_js.Trace.logInfo(n.$1n,"Saving {0} response.",n.$qs);n.$Fp.$8zd(r,t,i)}else{var u=3e4;r.response.fault&&r.response.fault.BackOffPeriodInMs&&(u=Math.min(r.response.fault.BackOffPeriodInMs,u));_js.Trace.logWarning(n.$1n,"Response from {0} was rejected. Updating count and delaying {1} ms before trying again.",n.$qs,u);_g.$CB.$1cq(r,!1,0);var o=this;n.$Fp.$9F5(r,function(){n.$5Ew.$21(n.$1n,"SetResponse",t,u)},i)}}_e.$nx.prototype={$1wt:null,$NU:null,$AS:null,$18x:null,$5Ew:null,get_$7SA:function(){return this.$Fp.get_$2Nc()},get_$6wY:function(){if(this.$Fp.get_$1gx())if(this.$AS.$NF)if(this.$Fp.get_$1wr()){_js.Trace.logInfo(this.$1n,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the action queue has pending responses.");return!1}else return!0;else{_js.Trace.logInfo(this.$1n,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the application has lost network connectivity.");return!1}else{_js.Trace.logInfo(this.$1n,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7Eg:function(n,t){this.$Fp.$7Lu(n,t)},$8nB:function(n,t){_js.Trace.logInfo(this.$1n,"Processing {0} with an online call.",this.$qs);var i=this;this.$18x.$3eu(this.$qr,function(){_js.Trace.logInfo(i.$1n,"Online processing of {0} completed.",_g.$47.$R1(i.$qr));$6VZ(i,n,t)})},$6pU:function(n,t){_js.Trace.logInfo(this.$1n,"Ensuring connectivity to process {0}",_g.$47.$R1(this.$Fp.get_$5Fc()));this.$AS.$2db()},$7QN:function(n){$21q(this)}};_e.$cP=function(n,t,i){_e.$cP.initializeBase(this,[n,_a.$0.$5ug]);_a.$3.$M(t,"processResponse");_a.$3.$M(i,"eventAggregator");this.$32x=t;var r=this;i.$HX(_a.$h3,function(n){_js.Trace.logInfo(r.$1n,"ResponseQueueProcessor received NonBootModelResponseProcessorReady event");r.$Fp.add_$456(r.$$d_$96R);r.$Fp.add_$4jq(r.$$d_$96R);$21q(r)})};function $4Qu(n,t,i){_js.Trace.logInfo(n.$1n,"Removing {0} from the action queue.",n.$qs);var r=n.$qr;_g.$CB.$1cq(r,!0,0);var u=this;n.$Fp.$3Q(r.id,function(n){t()},i,null)}_e.$cP.prototype={$32x:null,get_$7SA:function(){return this.$Fp.get_$1wr()},get_$6wY:function(){if(this.$Fp.get_$1gx())return!0;else{_js.Trace.logInfo(this.$1n,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7Eg:function(n,t){this.$Fp.$7Lw(n,t)},$8nB:function(n,t){_js.Trace.logInfo(this.$1n,"Processing response from {0}.",this.$qs);var u=_a.$7.get_$2M();var i=this,r=this;this.$32x(this.$qr,function(){_js.Trace.logInfo(i.$1n,"Processing response from {0} succeeded.",i.$qs);_g.$47.$43P(i.$qr,u);$4Qu(i,n,t)},function(i){_js.Trace.logWarning(r.$1n,"Processing response from {0} failed: {1}",r.$qs,i.message);$4Qu(r,n,t)})}};_e.$5v=function(n){_e.$5v.initializeBase(this);_a.$3.$M(n,"clientStore");this.$64=new(_e.$7E.$$(_bc.$11G,_e.$F3))(n,"UTC")};function $6UM(n,t){var i=t.$CU(_e.$1E.get_$L().$vM.get_$1Q());var r=new _a.$86(ActionItemMetadata.$3gi(),"true");var u=new _a.$7m(r,null);var f=this,e=this;i.$HQ(u,function(t){t.$F(function(t){n.$1lo=t},null)},function(n){_js.Trace.logError(_a.$0.$6k,"Unable to retreive the number of high priority actions from the clientstore. Error = {0}",n.$4P)})}function $6UN(n,t){var i=t.$CU(_e.$1E.get_$L().$vM.get_$1Q());var r=new _a.$86(ActionItemMetadata.$3gi(),"false");var u=new _a.$7m(r,null);var f=this,e=this;i.$HQ(u,function(t){t.$F(function(t){n.$1VU=t},null)},function(n){_js.Trace.logError(_a.$0.$6k,"Unable to retrieve the number of low priority actions from the clientstore. Error = {0}",n.$4P)})}function $4QT(n,t,i,r){var u=null;var f=this,e=this;$2UW(n,function(i,r){$4QU(n,i,r,t,function(n){u=n})},function(){i(u)},r)}function $4QU(n,t,i,r,u){var f=this;i.$HQ(r,function(n){n.$CS(1,function(n,t,i){if(t.length>0){var f=t[0].$24;var r=f.Data;r.id=t[0].$5U.$SH();u(r)}else u(null)},null)},null)}function $4QV(n,t,i,r){var u=!1;var f=null;var e=_e.$1X.$4yM(i);var o=this;n.$64.$Da(t,e,function(n){if(n){u=!0;n.$27L(t)}f=u?n.get_$1s():null;r(u,f)},null)}function $2UW(n,t,i,r){var u=this,f=this,e=this;n.$64.$AK(new _a.$6L("DatabaseActionQueue.ExecuteTransaction"),function(n){var i=n.$CU(_e.$1E.get_$L().$vM.get_$1Q());t(n,i)},function(){i()},function(n){var t=Error.create(n.$4P,n);r(t)})}_e.$5v.prototype={$64:null,$7Yo:function(n,t){var i=n.$CU(_e.$1E.get_$L().$vM.get_$1Q());var r=new _a.$Ut(_e.$F3.$2Qn,0,1,0);var u=new _a.$7m(r,_e.$5v.$2QV);var f=this;$4QU(this,n,i,u,function(n){t(!n)})},$7Uq:function(n){$6UM(this,n);$6UN(this,n)},$7Cm:function(n,t,i){var r=this.$64.$lp(n);delete n.id;var u=this,f=this;$2UW(this,function(t,i){r.$Cn(t,function(t){n.id=t.get_$1V2()})},function(){t(n.id)},i)},$7Lv:function(n,t){$4QT(this,_e.$5v.$5ed,n,t)},$7Lx:function(n,t){$4QT(this,_e.$5v.$5ef,n,t)},$7Hv:function(n,t){var i=[];var r=this,u=this;$2UW(this,function(n,t){t.$HQ(_e.$5v.$4fA,function(n){n.$CS(1e3,function(n,t,r){for(var u=0;u<t.length;++u){var e=t[u].$24;var f=e.Data;f.id=t[u].$5U.$SH();Array.add(i,f)}},null)},null)},function(){n(i)},t)},$8qn:function(n,t,i,r){var u=!1;var f=null;if(n)$4QV(this,n,t,i);else{var e=this,o=this;$2UW(this,function(n,i){$4QV(e,n,t,function(n,t){u=n;f=t})},function(){i(u,f)},r)}},$69A:function(n,t,i){var r=this;this.$7Cm(n,function(n){t()},i)}};_e.$Jj=function(n){this.$E9=n||_a.NativeBridge.get_$L().$WB};_e.$Jj.get_$L=function(){return _e.$Jj.$g||(_e.$Jj.$g=new _e.$Jj)};_e.$Jj.prototype={$E9:null,$Zm:null,get_$4eK:function(){if(!this.$Zm)switch(this.$E9.get_$2X5().get_$2X4()){case 1:this.$Zm=new _e.$MK;break;case 2:this.$Zm=new _e.$vp(this.$E9);break;case 0:break}return this.$Zm}};_e.$Sw=function(){};_e.$Sw.$I=function(n,t){var i=null;n.get_$97c()?i=_e.$Sw.$756(i,t):n.get_$6BS()?i=_e.$Sw.$72q(i,t):n.get_$2kj()&&(i=new _e.$11S(n.get_$2kj(),t));return i};_e.$Sw.$72q=function(n,t){var i=window.self;n=new _e.$iL(i,t);return n};_e.$Sw.$756=function(n,t){var i=_a.NativeBridge.get_$L().$uq;var r=new _e.$179(i,_js.$K.get_$L());n=new _e.$iL(r,t);return n};_e.$1A6=function(){};_e.$1A6.registerInterface("_e.$1A6");_e.$rr=function(){};_e.$1A5=function(){};_e.$1A5.registerInterface("_e.$1A5");_e.$1A3=function(){};_e.$1A3.registerInterface("_e.$1A3");_e.$1A2=function(){};_e.$1A2.registerInterface("_e.$1A2");_e.$1A1=function(){};_e.$1A1.registerInterface("_e.$1A1");_e.$5P=function(n,t,i){this.$bS=n;this.$1j=t;this.$21B=i;$3GD(this);this.$2Rl=0};function $4Qf(n,t,i){var r=n.$bS.open(n.$1j);_e.$3e.$uD(Object,_a.$UY,"IdbBrowserDb.Initialize",r,i);var u=this;_e.$3e.$4BQ(Object,_a.$UY,"IdbBrowserDb.Initialize",r,function(r){n.$Kg=r.target.result;if($6Uz(n)){var u=n.$Kg.transaction(n.$Kg.objectStoreNames,"readwrite");_e.$LZ.$HX("IdbBrowserDb.Initialize",u,t,i);$6V2(n,u)}else _e.$5h.$1LB(t)})}function $6Uz(n){return $4Qh(n)&&$4Qe(n)}function $4Qe(n){return Array.indexOf(n.$Kg.objectStoreNames,"__indexes")>=0}function $4Qh(n){return Array.indexOf(n.$Kg.objectStoreNames,"__versions")>=0}function $6Ux(n){$4Qh(n)||n.$Kg.createObjectStore("__versions",_a.$Rf.$7Ge());$4Qe(n)||n.$Kg.createObjectStore("__indexes",_a.$Rf.$7GS())}function $6V2(n,t){$6V5(n,t);$6V1(n,t);$6V4(n,t)}function $6V1(n,t){var i=t.objectStore("__indexes");var r=i.openCursor(_a.$6y.$1CZ(),"next");var u=this;_e.$3e.$4BQ(_a.$FI,_a.$HW,"IdbBrowserDb.PopulateIndexInformation",r,function(t){if(t.target.result){var i=t.target.result.value;var r=_e.$LY.$I(i);n.$6R.$1fB(i.storeName,r);_a.$OT.$CS(t.target.result)}})}function $6V5(n,t){var i=t.objectStore("__versions");$6V0(n,i);$6V3(n,i)}function $6V3(n,t){for(var i=0;i<n.$Kg.objectStoreNames.length;++i)if(!n.$Kg.objectStoreNames[i].startsWith("__")){var r=t.get(n.$Kg.objectStoreNames[i]);var u=this;_e.$3e.$4BQ(_a.$EC,Object,"IdbBrowserDb.PopulateObjectStoreVersion",r,function(t){var i=t.target.result;n.$6R.$H(i.name,i.version)})}}function $6V4(n,t){var i=t.objectStore("__versions");var r=i.get("__settings");var u=this;_e.$3e.$4BQ(_a.$EC,Object,"IdbBrowserDb.PopulateSettingsInformation",r,function(t){var i=t.target.result;i&&(n.$2CF=i)})}function $6V0(n,t){var i=t.get("__db");var r=this;_e.$3e.$4BQ(_a.$EC,Object,"",i,function(t){_e.$5h.$1LB(function(){var i=t.target.result;n.$8b=i.version})})}function $6Uv(n,t,i,r){var u=new _e.$lZ(n.$Kg,r,i);try{t(u)}catch(f){_js.Trace.logError(_a.$0.$C0,"aborting transaction due to exception during schema update: "+f.message);r.abort()}}function $6V7(n,t,i){var r=i.objectStore("__versions");r.put(new _e.$rt("__db",t),"__db")}function $6V6(n,t,i){var u=i.objectStore("__versions");var r=$6Uu(n,n.$2CF);r.$1ey=t;u.put(r,"__settings")}function $6Uy(n,t,i,r,u,f){var s=n.$6R.$46();var h=n.$Kg.version+1;n.$Kg.close();$3GD(n);var e=n.$bS.open(n.$1j,h);var o="IdbBrowserDb.InternalChangeSchema";var c=this;_e.$3e.$9Fi(o,e,function(u){n.$Kg=u.target.result;$6V8(n,t,i,s,u.target.transaction,r,f)});_e.$3e.$1LB(Object,_a.$UY,o,e,u);_e.$3e.$uD(Object,_a.$UY,o,e,f)}function $6V8(n,t,i,r,u,f,e){var o=this;_e.$LZ.$HX("UpgradeDatabaseVersion",u,function(){n.$6R=r;n.$8b=t;n.$2CF.$1ey=i},e);$6Ux(n);$6V7(n,t,u);$6V6(n,i,u);$6Uv(n,f,r,u)}function $3GE(n,t){if(!n.$6R.$1bz(t))throw Error.invalidOperation("The object store "+t+" does not exist.");}function $6Ut(n){}function $4Qg(n){return!!n.$Kg}function $3GD(n){n.$Kg=null;n.$8b="";n.$2CF=new _e.$rr;n.$6R=new _e.$rq;n.$LO=new _a.$tK(n);n.$cd=new _a.$Pf}function $6Uw(n,t,i){$4Qg(n)?t():$4Qf(n,t,i)}function $6Uu(n,t){var i=new _e.$rr;i.$1ey=t.$1ey;return i}_e.$5P.prototype={$bS:null,$1j:null,$21B:null,$LO:null,$cd:null,$8b:null,$2CF:null,$Kg:null,$6R:null,$2Rl:0,get_$3Z:function(){return this.$8b},get_$1Jo:function(){return this.$6R.get_$1Jo()},get_$1ey:function(){return this.$2CF.$1ey||new Array(0)},$3P1:function(n,t,i,r,u){var f=this;$6Uw(this,function(){$6Uy(f,n,t,i,r,u)},u)},$AK:function(n,t,i,r){$6Ut(this);var u=this.$2Rl++;var f=this.$Kg.transaction(this.get_$1Jo(),"readwrite");var e=new _e.$11T(f,this.$6R,this.$LO,this.$cd,n);this.$21B.$3m8(u);_js.Trace.logInfo(_a.$0.$C0,"starting transaction {0}",n.$Y6);var o=this,s=this;_e.$LZ.$HX(n.$Y6,f,function(){_js.Trace.logInfo(_a.$0.$C0,"transaction {0} ended in success.",n.$Y6);o.$21B.$1py(u);e.$33A();_e.$5h.$1LB(i)},function(t){_js.Trace.logInfo(_a.$0.$C0,"transaction {0} ended in error.",n.$Y6);s.$21B.$1py(u);t=e.$2WK?new _a.$8t(5,"Transaction manually aborted."):t;_e.$5h.$BC(t,r)});try{t(e)}catch(h){_js.Trace.logException(_a.$0.$C0,h,"IDB caught an exception on the transaction callback and will abort.");f.abort()}},$6Bk:function(n,t){this.$5H();var i=this.$bS.deleteDatabase(this.$1j);_e.$3e.$1LB(Object,_a.$UY,"IdbBrowserDb.Wipe",i,n);_e.$3e.$uD(Object,_a.$UY,"IdbBrowserDb.Wipe",i,t)},$5H:function(){if($4Qg(this)){this.$Kg.close();$3GD(this)}},$HX:function(n,t){_a.$3.$1C(n,"objectStoreName");_a.$3.$M(t,"notificationCallback");n=n.toLowerCase();$3GE(this,n);this.$LO.$HX(n,t)},$12Z:function(n){_a.$3.$1C(n,"objectStoreName");n=n.toLowerCase();this.$LO.$12Z(n)},$4F0:function(){this.$LO.$4F0()},$7M3:function(n){_a.$3.$1C(n,"objectStoreName");n=n.toLowerCase();$3GE(this,n);return this.$6R.$3b2(n)},$4p2:function(n){_a.$3.$1C(n,"objectStoreName");n=n.toLowerCase();$3GE(this,n);var t=new _e.$5P.$7U8(n,this.$cd);this.$cd.$4e4(t);return t}};_e.$5P.$7U8=function(n,t){_e.$5P.$7U8.initializeBase(this,[n,t])};_e.$5h=function(n,t){_e.$5h.initializeBase(this,[n,t])};_e.$5h.$uE=function(n,t){var i=n;var r=_e.$5h.$9B3(n);_js.Trace.logError(_a.$0.$C0,"IndexedDb Error: {0}",i);_e.$5h.$uD(r,i,t)};_e.$5h.$uD=function(n,t,i){_e.$5h.$BC(new _e.$5h(n,t),i)};_e.$5h.$BC=function(n,t){t&&t(n)};_e.$5h.$1LB=function(n){n&&n()};_e.$5h.$gK=function(n,t,i){i&&i(t)};_e.$5h.$9B3=function(n){var t=0;switch(n){case"UnknownError":t=0;break;case"ConstraintError":t=1;break;case"DataError":t=0;break;case"TransactionInactiveError":t=0;break;case"ReadOnlyError":t=1;break;case"VersionError":t=0;break;case"NotFoundError":t=2;break;case"InvalidStateError":t=0;break;case"InvalidAccessError":t=0;break;case"TimeoutError":t=4;break;case"AbortError":t=5;break;case"QuotaExceededError":t=3;break;case"SyntaxError":t=0;break;case"DataCloneError":t=1;break}return t};_e.$11S=function(n,t){_e.$11S.initializeBase(this);this.$bS=n;this.$21B=t};_e.$11S.prototype={$bS:null,$21B:null,$8hy:function(n,t,i,r){_a.$3.$M(i,"successCallback");_a.$3.$1C(n,"name");var u=new _e.$5P(this.$bS,n,this.$21B);var f=this;$4Qf(u,function(){i(u)},r)},$78b:function(n,t,i){_a.$3.$M(t,"successCallback");_a.$3.$1C(n,"name");this.$bS.deleteDatabase(n);t()}};_e.$FH=function(n,t,i,r){this.$BH=n;this.$1K3=t;this.$6R=i;this.$o4=r};_e.$FH.$6AV=function(n){_a.$3.$M(n,"id");var t=n.$SH();_a.$3.$M(t,"id must be provided");_a.$3.$1C(t.toString(),"id must be provided");return t};function $4Qj(n,t,i,r){var u=t?new _a.$7m(t.$6f,null):null;var f=this;_e.$2A.$I(n.$BH.get_$3dD(),n.$1K3,n.$6R,u,1,function(n){i(n)},r)}function $4Qi(n,t){$6V9(n,t);$6VA(n,t)}function $6VA(n,t){if(t.$F2)for(var i=0;i<t.$F2.length;++i)if(!n.$6R.$2B1(t.$F2[i].$Fl.$5M)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$F2[i].$Fl.$5M);_a.$8t.$v0(1,r)}}function $6V9(n,t){if(t.$6f)for(var r=t.$6f.$1al,i=0;i<r.length;++i)if(!n.$6R.$2B1(r[i].$5M)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5M);_a.$8t.$v0(1,u)}}_e.$FH.prototype={$BH:null,$1K3:null,$6R:null,$o4:null,$3k8:0,get_$1Q:function(){return this.$6R.get_$1Q()},$3k:function(n,t,i){var r=_e.$FH.$6AV(n);_a.$3.$M(t,"successCallback");var u=this.$1K3.get(r);var f="IdbBrowserDbObjectStore.GetItem";var e=this;_e.$3e.$Qs(_a.$EC,Object,f,u,function(n){_js.Trace.logError(_a.$0.$C0,"Error getting object from store:{0} with id:{1}. Error:{2}",e.get_$1Q(),r,n.target.error);_e.$5h.$uE(n.target.error.name,i)});var o=this;_e.$3e.$4BQ(_a.$EC,Object,f,u,function(n){var i=null;var r=n.target.result;r&&(i=r.data);_e.$5h.$gK(Object,i,t)})},$eA:function(n,t,i){this.$o4.$10I(this,n);this.$BH.get_$2yf()(this.get_$1Q(),2,n,null);var f=_e.$FH.$6AV(n);var r=_a.$EC.$3Q(this.$1K3,f);var u="IdbBrowserDbObjectStore.DeleteItem";_e.$3e.$1LB(_a.$EC,Boolean,u,r,t);var e=this;_e.$3e.$Qs(_a.$EC,Boolean,u,r,function(t){_js.Trace.logError(_a.$0.$C0,"Error deleting from object store:{0} the id:{1}. ErrorCode:{2}",e.get_$1Q(),n.$SH(),t.target.error);_e.$5h.$uE(t.target.error.name,i)})},$1u:function(n,t){this.$o4.$1YO(this);var i=this.$1K3.clear();var r="IdbBrowserDbObjectStore.Clear";_e.$3e.$1LB(_a.$EC,Object,r,i,n);var u=this;_e.$3e.$Qs(_a.$EC,Object,r,i,function(n){_js.Trace.logError(_a.$0.$C0,"Error clearing from object store:{0}. ErrorCode:{1}",u.get_$1Q(),n.target.error);_e.$5h.$uE(n.target.error.name,t)})},$8oG:function(n,t,i,r){_a.$3.$M(t,"json");this.$o4.$1YP(this,n,t);this.$BH.get_$2yf()(this.get_$1Q(),1,n,t);for(var o=new _e.$11a(t,{}),u=0;u<this.$6R.get_$2Bl().length;++u)this.$6R.get_$2Bl()[u].$6sf(o,n,this.get_$1Q());var f=n.$SH();if(f===null){var e=_a.$7.get_utcNow().$55();e<=this.$3k8&&(e=this.$3k8+1);f=this.$3k8=e}var s=this.$1K3.put(o,f);var h="IdbBrowserDbObjectStore.Put";_e.$3e.$uD(_a.$EC,Object,h,s,r);var c=this;_e.$3e.$4BQ(_a.$EC,Object,h,s,function(n){_e.$5h.$gK(_a.$Lr,new _a.$Lr(n.target.result),i)})},$HQ:function(n,t,i){_a.$3.$M(t,"successCallback");n&&$4Qi(this,n);var r=this;$4Qj(this,n,function(u){_e.$2A.$I(r.$BH.get_$3dD(),r.$1K3,r.$6R,n,0,function(n){var i=new _e.$11Z(r.$BH,n,u);_e.$5h.$gK(_a.$12S,i,t)},i)},i)},$3dH:function(n,t,i){_a.$3.$M(t,"successCallback");var r=n?new _a.$7m(n,null):null;r&&$4Qi(this,r);var u=this;$4Qj(this,r,function(n){_e.$2A.$I(u.$BH.get_$3dD(),u.$1K3,u.$6R,r,1,function(i){var r=new _e.$11Y(u.$BH,i,n);_e.$5h.$gK(_a.$12R,r,t)},i)},i)}};_e.$11T=function(n,t,i,r,u){this.$2kT=n;this.$o4=new _a.$Pe(this,r);this.$6R=t;this.$18n=new _a.$tI(i);this.$gn=u};_e.$11T.prototype={$2kT:null,$6R:null,$o4:null,$18n:null,$gn:null,$2WK:!1,get_$1N1:function(){return this.$gn},get_$3dD:function(){return this.$2kT},get_$2yf:function(){return this.$18n.$$d_$8oS},$33A:function(){this.$18n.$33A(this.$gn)},$CU:function(n){n=n.toLowerCase();if(!this.$6R.$1bz(n))throw Error.invalidOperation("storeName "+n+" does not exist.");var t=this.$2kT.objectStore(n);return new _e.$FH(this,t,this.$6R.$7OO(n),this.$o4)},$2WJ:function(){this.$2WK=!0;this.$2kT.abort()}};_e.$11U=function(n,t){_e.$11U.initializeBase(this,[n,t,new _a.$4U("metadata."+n)])};_e.$11U.prototype={$6sf:function(n,t,i){_e.$LY.$4Ft(this.$ge[0],n,t,i);_e.$LY.$4Ft(this.$ge[1],n,t,i);var r=this.$ge[0].$15Z(n.data);var u=this.$ge[1].$15Z(n.data);n.metadata[this.$2Bm]=_e.$7C.$I(r,u)}};_e.$LY=function(n,t,i){this.$2Bm=n;this.$ge=new Array(0);this.$5FR=i;for(var r=0;r<t.length;++r)Array.add(this.$ge,new _a.$4U(t[r]))};_e.$LY.$I=function(n){if(n.keyPaths.length===1)return new _e.$11c(n.indexName,n.keyPaths);else if(n.keyPaths.length===2)return new _e.$11U(n.indexName,n.keyPaths);else throw Error.argument("fields","composite keys can only have two columns");};_e.$LY.$4Ft=function(n,t,i,r){var u=n.$15Z(t.data);if($8(u)){var f=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",n.$5M,r,i.$SH());_js.Trace.logError(_a.$0.$C0,f);throw Error.invalidOperation(f);}if(!String.isInstanceOfType(u)&&!Number.isInstanceOfType(u)){var e=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",n.$5M,r,i.$SH(),Object.getType(u).getName());throw Error.invalidOperation(e);}};_e.$LY.prototype={$2Bm:null,$ge:null,$5FR:null};_e.$11V=function(n,t,i,r){this.storeName=n;this.indexName=t;this.keyPaths=new Array(i.length);this.storeVersion=r;for(var u=0;u<i.length;++u)this.keyPaths[u]=i[u].$5M.$5M};_e.$11V.prototype={storeName:null,indexName:null,keyPaths:null,storeVersion:null};_e.$rq=function(){this.$o3={}};_e.$rq.prototype={$o3:null,get_$1Jo:function(){var n=[];var t=this.$o3;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.key)}return n},$3b2:function(n){return this.$o3[n].get_$3Z()},$7OO:function(n){return this.$o3[n]},$H:function(n,t){this.$o3[n]=new _e.$rq.$4ux(n,t)},$1bz:function(n){return n in this.$o3},$46:function(){var n=new _e.$rq;n.$o3={};var t=this.$o3;for(var i in t){var r={key:i,value:t[i]};var u=r.value;n.$o3[r.key]=u.$46()}return n},$3Q:function(n){delete this.$o3[n]},$1fB:function(n,t){var i=this.$o3[n];i.$1fB(t)},$56m:function(n,t){var i=this.$o3[n];return i.$56m(t)}};_e.$rq.$4ux=function(n,t){this.$1j=n;this.$8b=t;this.$3dg={};this.$49s={};this.$3QA={};this.$23R=[];this.$3df=[]};_e.$rq.$4ux.prototype={$8b:null,$1j:null,$3dg:null,$49s:null,$3QA:null,$23R:null,$3df:null,get_$1Q:function(){return this.$1j},get_$3Z:function(){return this.$8b},get_$2Bl:function(){return this.$3df},$1fB:function(n){this.$3dg[n.$2Bm]=n;for(var t=0;t<n.$ge.length;++t)Array.indexOf(this.$23R,n.$ge[t].$5M)<0&&Array.add(this.$23R,n.$ge[t].$5M);n.$ge.length===1?this.$49s[n.$ge[0].$5M]=n:this.$3QA[n.$ge[0].$5M+n.$ge[1].$5M]=n;Array.add(this.$3df,n)},$56m:function(n){return n in this.$3dg},$2B1:function(n){if(n===_a.$4U.$5U.$5M)return!0;else{for(var t=0;t<this.$23R.length;++t)if(this.$23R[t]===n)return!0;return!1}},$1kp:function(n,t){var i=null;if(t.$5M===_a.$4U.$5U.$5M)i=n;else{var r=this.$49s[t.$5M];r&&(i=n.index(r.$2Bm))}return i},$2hd:function(n,t,i){var r=null;if(t===i)r=this.$1kp(n,t);else{var u=this.$3QA[t.$5M+i.$5M];u&&(r=n.index(u.$2Bm))}return r},$46:function(){for(var t=new _e.$rq.$4ux(this.$1j,this.$8b),i=this.get_$2Bl(),r=i.length,n=0;n<r;++n){var u=i[n];t.$1fB(u)}return t}};_e.$KC=function(n,t){_e.$KC.initializeBase(this,[null]);_a.$3.$M(n,"idbCursorRequest");this.$FM=new(_e.$a3.$$(_a.$HW))(n,t)};_e.$KC.prototype={$FM:null,get_$7WY:function(){return this.$FM.get_$1Qf()},get_$57v:function(){return this.$FM.get_$14O()},get_$7WX:function(){return this.$FM.get_$3Se()},$F:function(n,t){this.$FM.$F(n,t)},$58J:function(n,t,i){this.$FM.$1MM(n,t,i)},$3eh:function(n,t){this.$FM.$CS(n,t)},$3v:function(n,t){this.$FM.$3v(n,t)}};_e.$a3=function(n,t){this.$$d_$7RK=Function.createDelegate(this,this.$7RK);this.$$d_$7RL=Function.createDelegate(this,this.$7RL);_a.$3.$M(n,"idbCursorRequest");this.$1ZI=null;this.$rl=n;this.$ob=t;var i="IdbQueryCursorStrategyImpl";_e.$3e.$4BQ(_a.$FI,this.$$gta["_e.$a3"].TCursor,i,this.$rl,this.$$d_$7RL);_e.$3e.$Qs(_a.$FI,this.$$gta["_e.$a3"].TCursor,i,this.$rl,this.$$d_$7RK)};_e.$a3.$$=function(n){var t="$a3"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$a3"]={TCursor:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$a3.apply(this,i)};r.registerClass("_e."+t);var u=_e.$a3.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$a3.prototype={$rl:null,$ob:null,$1ZI:null,get_$1Qf:function(){var n=null;this.$rl.result&&(n=this.$rl.result.value);return n},get_$14O:function(){var n=null;this.$rl.result&&(n=this.$rl.result.primaryKey);return n},get_$3Se:function(){return""},$F:function(n,t){var i="IdbQueryCursorStrategyImpl.Count";var r=this.$ob?this.$rl.source.count(this.$ob):this.$rl.source.count();_e.$3e.$uD(_a.$FI,Number,i,r,t);var u=this;_e.$3e.$4BQ(_a.$FI,Number,i,r,function(t){_e.$5h.$gK(Number,t.target.result,n)})},$1MM:function(n,t,i){this.$1ZI=new _e.$rs(t,i);this.$rl.result.advance(n)},$CS:function(n,t){this.$1ZI=new _e.$rs(n,t);_a.$OT.$CS(this.$rl.result)},$3v:function(n,t){n()},$7RL:function(n){var t=this;_e.$5h.$1LB(function(){var n=t.$1ZI;t.$1ZI=null;n.get_$4BQ()()})},$7RK:function(n){var t=this.$1ZI;this.$1ZI=null;t.get_$Qs()(n.target.error)}};_e.$rs=function(n,t){this.$64w=n;this.$1b=t};_e.$rs.prototype={$64w:null,$1b:null,get_$4BQ:function(){return this.$64w},get_$Qs:function(){return this.$1b}};_e.$g4=function(n,t){_e.$g4.initializeBase(this,[t]);this.$6f=n};_e.$g4.prototype={$6f:null,get_$7WY:function(){return this.$ND.get_$1Qf()},get_$57v:function(){return this.$ND.get_$14O()},get_$7WX:function(){return this.$ND.get_$3Se()},$3eh:function(n,t){var i=this,r=this;this.$ND.$CS(function(){i.$ND.$MK===2?n():i.$6f.$5Cy(i.$ND.get_$14O(),i.$ND.get_$1Qf().data)?n():i.$3eh(n,t)},function(n){t(n)})}};_e.$11X=function(n,t){_e.$11X.initializeBase(this,[t]);this.$2ib=n};_e.$11X.prototype={$2ib:null,get_$7WY:function(){return this.$ND.get_$1Qf()},get_$57v:function(){return this.$ND.get_$14O()},get_$7WX:function(){for(var t="",n=0;n<this.$2ib.length;++n){var i=this.$2ib[n].$5M===_a.$4U.$5U.$5M?this.$ND.get_$14O():this.$2ib[n].$15Z(this.$ND.get_$1Qf().data);$8(i)||(t+=i.toString())}return t},$3eh:function(n,t){this.$ND.$CS(n,t)}};_e.$11Y=function(n,t,i){this.$$d_$51n=Function.createDelegate(this,this.$51n);this.$FM=new _e.$OU(n,t,i)};_e.$11Y.prototype={$FM:null,$F:function(n,t){this.$FM.$F(n,t)},$CS:function(n,t,i){this.$FM.$CS(_a.$Lr,n,this.$$d_$51n,t,i)},$51n:function(n){return new _a.$Lr(n.get_$14O())}};_e.$11Z=function(n,t,i){this.$$d_$51n=Function.createDelegate(this,this.$51n);this.$FM=new _e.$OU(n,t,i)};_e.$11Z.prototype={$FM:null,get_$MG:function(){return this.$FM.$89},$F:function(n,t){this.$FM.$F(n,t)},$CS:function(n,t,i){_a.$3.$M(t,"successCallback");var r=this;this.$FM.$CS(_a.$c5,n,this.$$d_$51n,function(n,i,r){t(n,i,r)},i)},$1ar:function(n,t,i,r){this.$FM.$1ar(n,t,i,r)},$1MM:function(n,t,i){this.$FM.$1MM(n,t,i)},$51n:function(n){var t=n.get_$1Qf();var i=n.get_$14O();return new _a.$c5(new _a.$Lr(i),t.data)}};_e.$OU=function(n,t,i){this.$BH=n;this.$1c0=t;this.$4ns=i;this.$89=0};function $3GF(n){if(n.$10g>0)throw Error.invalidOperation("an asynchronous operation is already in progress");}_e.$OU.prototype={$BH:null,$1c0:null,$4ns:null,$89:0,$10g:0,$F:function(n,t){this.$4ns.$F(n,t)},$CS:function(n,t,i,r,u){_a.$3.$M(r,"successCallback");$3GF(this);if(this.$1c0.get_$3I()===2)r(this.$BH,[],!0);else{this.$10g++;var f=this,e=this;this.$9I0(n,t,[],i,function(n,t,i){f.$10g--;r&&r(n,t,i)},function(n){e.$10g--;u&&u(n)})}},$1ar:function(n,t,i,r){_a.$3.$M(i,"successCallback");_a.$3.$M(t,"condition");$3GF(this);this.$10g++;var u=this,f=this;this.$1c0.$1ar(t,function(n,t){u.$89+=t;u.$10g--;!n&&t>0&&u.$89--;i&&i(n)},function(n){f.$10g--;r&&r(n)})},$1MM:function(n,t,i){this.$89+=n;$3GF(this);this.$10g++;var r=this,u=this;this.$1c0.$1MM(n,function(){r.$10g--;t&&t()},function(n){u.$10g--;i&&i(n)})},$9I0:function(n,t,i,r,u,f){var e=this,o=this;this.$1c0.$CS(function(){e.$89++;if(e.$1c0.get_$3I()===2)u(e.$BH,i,!0);else{Array.add(i,r(e.$1c0));t--;t>0?e.$9I0(n,t,i,r,u,f):u(e.$BH,i,!1)}},function(n){_e.$5h.$uE(n.name,f)})}};_e.$By=function(n,t,i,r){this.$$d_$6z9=Function.createDelegate(this,this.$6z9);_e.$By.initializeBase(this,[[t],r]);this.$3x2=n;this.$Fl=t;this.$EM=i;this.$1lH=0;this.$1Fu=new Array(0)};function $6VB(n,t,i){n.$1Fu=new Array(0);n.$1lH=0;var r="";if(n.$ND.$MK===2)t();else{r=n.$ND.get_$3Se();$4Qk(n,r,t,i)}}function $4Qk(n,t,i,r){if(n.$ND.$MK===1&&n.$ND.get_$3Se()===t){var u=n.$Fl.$5M===_a.$4U.$5U.$5M?n.$ND.get_$14O():n.$Fl.$15Z(n.$ND.get_$1Qf().data);Array.add(n.$1Fu,new _e.$By.$962(n.$ND.get_$14O(),u));var f=this;n.$ND.$CS(function(){$4Qk(n,t,i,r)},r)}else{$6VD(n);i()}}function $6VD(n){n.$1Fu.length>0&&n.$1Fu.sort(n.$$d_$6z9)}function $6VC(n,t,i){var u=n.$1Fu[n.$1lH].get_$T();var r=n.$3x2.get(u);n.$1Fu[n.$1lH]=null;n.$1lH++;var f="IdbQuerySortStrategy.Next";var e=this;_e.$3e.$4BQ(_a.$EC,Object,f,r,function(i){$4Ql(n,u,i.target.result);t()});var o=this;_e.$3e.$Qs(_a.$EC,Object,f,r,function(){i(r.error)})}function $4Ql(n,t,i){n.$4pu=t;n.$4q4=i;n.$4pp=i?n.$Fl.$15Z(i.data):null}_e.$By.prototype={$3x2:null,$Fl:null,$EM:0,$4q4:null,$4pu:null,$4pp:null,$1Fu:null,$1lH:0,get_$7WY:function(){return this.$4q4},get_$57v:function(){return this.$4pu},get_$7WX:function(){return this.$4pp.toString()},$3eh:function(n,t){$4Ql(this,null,null);if(this.$1lH<this.$1Fu.length)$6VC(this,n,t);else if(this.$ND.$MK===2)n();else{var i=this;$6VB(this,function(){i.$3eh(n,t)},t)}},$3v:function(n,t){var i=this;this.$ND.$CS(function(){i.$3eh(n,t)},t)},$6z9:function(n,t){var i=n;var r=t;return this.$EM?r.$4m2(i):i.$4m2(r)}};_e.$By.$962=function(n,t){this.$AV=n;this.$63N=t};_e.$By.$962.prototype={$AV:null,$63N:null,get_$T:function(){return this.$AV},get_$11o:function(){return this.$63N},$4m2:function(n){return Number.isInstanceOfType(this.get_$11o())&&Number.isInstanceOfType(n.get_$11o())?this.get_$11o()-n.get_$11o():String.isInstanceOfType(this.get_$11o())&&String.isInstanceOfType(n.get_$11o())?this.get_$11o()===n.get_$11o()?0:this.get_$11o()>n.get_$11o()?1:-1:0}};_e.$2A=function(n){this.$ND=n;this.$MK=0;this.$25r=null};_e.$2A.$I=function(n,t,i,r,u,f,e){_a.$3.$M(t,"object store");_a.$3.$M(f,"success");f=_e.$2A.$6tU(n,f,e);_e.$2A.$7b7(r)?_e.$2A.$4oM(t,u,f):_e.$2A.$7Yp(r)?_e.$2A.$73m(t,i,r,u,f):_e.$2A.$7aB(r)?_e.$2A.$74l(t,i,r,u,f):_e.$2A.$7bs(r)&&_e.$2A.$75d(t,i,r,u,f)};_e.$2A.$73m=function(n,t,i,r,u){switch(_e.$2A.$3aD(i)){case 0:_e.$2A.$4oM(n,r,u);break;case 1:_e.$2A.$73n(n,t,i,r,u);break;case 2:_e.$2A.$73l(n,t,i,u);break}};_e.$2A.$74l=function(n,t,i,r,u){switch(_e.$2A.$3aD(i)){case 0:_e.$2A.$74n(n,t,i,r,u);break;case 1:_e.$2A.$74o(n,t,i,u);break;case 2:_e.$2A.$74m(n,t,i,u);break}};_e.$2A.$75d=function(n,t,i,r,u){switch(_e.$2A.$3aD(i)){case 0:_e.$2A.$75f(n,t,i,r,u);break;case 1:_e.$2A.$75g(n,t,i,u);break;case 2:_e.$2A.$75e(n,t,i,u);break}};_e.$2A.$4oM=function(n,t,i){_e.$2A.$73Q(n,i)};_e.$2A.$73n=function(n,t,i,r,u){var f=i.$F2[0].$Fl;var e=i.$F2[0].$EM;var o=t.$1kp(n,f);o?_e.$2A.$1hm(n,o,e,null,r,u):_e.$2A.$73P(n,u,f,e)};_e.$2A.$73l=function(n,t,i,r){var u=t.$2hd(n,i.$F2[0].$Fl,i.$F2[1].$Fl);var f=i.$F2[0].$EM;var e=i.$F2[1].$EM;f===e&&u?_e.$2A.$1hm(n,u,f,null,0,r):_e.$2A.$73O(n,i.$F2[0],i.$F2[1],r)};_e.$2A.$74n=function(n,t,i,r,u){_e.$2A.$4oP(n,t,i,r,u)};_e.$2A.$74o=function(n,t,i,r){var u=i.$6f;var f=i.$F2[0];if(u.get_$Qv().$5M===f.$Fl.$5M){var e=t.$1kp(n,u.get_$Qv());if(e){var s=_e.$2A.$2c1(u);_e.$2A.$1hm(n,e,f.$EM,s,0,r)}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}",u.get_$Qv().$5M);_e.$2A.$3RK(n,u,f,r)}}else{var o=t.$2hd(n,u.get_$Qv(),f.$Fl);if(o){var h=_a.$6y.$1gL(_e.$7C.$I(u.$pF,""),_e.$7C.$I(u.$pF,"￿"),!0,!0);_e.$2A.$1hm(n,o,f.$EM,h,0,r)}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}:{1}",u.get_$Qv().$5M,f.$Fl.$5M);_e.$2A.$3RK(n,u,f,r)}}};_e.$2A.$74m=function(n,t,i,r){var u=i.$6f;var f=i.$F2[0];var e=i.$F2[1];var o=t.$2hd(n,u.get_$Qv(),f.$Fl);if(o){var s=_a.$6y.$1gL(_e.$7C.$I(u.$pF,""),_e.$7C.$I(u.$pF,"￿"),!0,!0);_e.$2A.$74Z(n,o,u,s,_e.$2A.$3TA(f.$EM),[u.get_$Qv(),f.$Fl],e,r)}else if(f.$EM===e.$EM){o=t.$2hd(n,f.$Fl,e.$Fl);if(o)_e.$2A.$74Y(n,o,null,u,r);else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}:{1}",f.$Fl.$5M,e.$Fl.$5M);_e.$2A.$3RJ(n,u,f,e,r)}}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}:{1}",u.get_$Qv().$5M,f.$Fl.$5M);_e.$2A.$3RJ(n,u,f,e,r)}};_e.$2A.$75f=function(n,t,i,r,u){_e.$2A.$4oP(n,t,i,r,u)};_e.$2A.$75g=function(n,t,i,r){var u=i.$6f;var f=i.$F2[0];var e=t.$1kp(n,u.get_$Qv());if(e){var o=_e.$2A.$2c1(u);u.get_$Qv().$5M===f.$Fl.$5M?_e.$2A.$1hm(n,e,f.$EM,o,0,r):_e.$2A.$74b(n,e,o,f,r)}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}",u.get_$Qv().$5M);_e.$2A.$3RK(n,u,f,r)}};_e.$2A.$75e=function(n,t,i,r){var u=i.$6f;var f=i.$F2[0];var e=i.$F2[1];var o=t.$1kp(n,u.get_$Qv());if(o){var s=_e.$2A.$2c1(u);_e.$2A.$74a(n,o,s,f,e,r)}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}",u.get_$Qv().$5M);_e.$2A.$3RJ(n,u,f,e,r)}};_e.$2A.$4oP=function(n,t,i,r,u){var f=t.$1kp(n,i.$6f.$1al[0]);if(f){var e=_e.$2A.$2c1(i.$6f);_e.$2A.$1hm(n,f,0,e,r,u)}else{_js.Trace.logWarning(_a.$0.$C0,"This query would run faster with an index on {0}",i.$6f.$1al[0].$5M);_e.$2A.$73N(n,i.$6f,u)}};_e.$2A.$74b=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Index) strategy.");var f=t.openCursor(i,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateIndexSortStrategy",f,function(t){var f=new _e.$KC(t.target,i);var e=new _e.$By(n,r.$Fl,r.$EM,f);u(e)})};_e.$2A.$74Y=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$C0,"Creating Filter(Index) strategy.");var f=t.openCursor(i,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateIndexFilterStrategy",f,function(n){var t=new _e.$KC(n.target,i);var f=new _e.$g4(r,t);u(f)})};_e.$2A.$74a=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Sort(Index)) strategy.");var e=t.openCursor(i,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateIndexSortSortStrategy",e,function(t){var e=new _e.$KC(t.target,i);var o=new _e.$By(n,r.$Fl,r.$EM,e);var s=new _e.$By(n,u.$Fl,u.$EM,o);f(s)})};_e.$2A.$74Z=function(n,t,i,r,u,f,e,o){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Group((Index)) strategy.");var s=t.openCursor(r,u);_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateIndexGroupSortStrategy",s,function(t){var i=new _e.$KC(t.target,r);var u=new _e.$11X(f,i);var s=new _e.$By(n,e.$Fl,e.$EM,u);o(s)})};_e.$2A.$3RK=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Filter((Cursor)) strategy.");var u=_a.$6y.$1CZ();var f=n.openCursor(u,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorFilterSortStrategy",f,function(f){var e=new _e.$KC(f.target,u);var o=new _e.$g4(t,e);var s=new _e.$By(n,i.$Fl,i.$EM,o);r(s)})};_e.$2A.$3RJ=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Sort(Filter((Cursor))) strategy.");var f=_a.$6y.$1CZ();var e=n.openCursor(f,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorFilterSortSortStrategy",e,function(e){var o=new _e.$KC(e.target,f);var s=new _e.$g4(t,o);var h=new _e.$By(n,i.$Fl,i.$EM,s);var c=new _e.$By(n,r.$Fl,r.$EM,h);u(c)})};_e.$2A.$73N=function(n,t,i){_js.Trace.logInfo(_a.$0.$C0,"Creating Filter(Cursor) strategy.");var r=_a.$6y.$1CZ();var u=n.openCursor(r,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorFilterStrategy",u,function(n){var u=new _e.$KC(n.target,r);var f=new _e.$g4(t,u);i(f)})};_e.$2A.$73O=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Sort(Cursor)) strategy.");var u=_a.$6y.$1CZ();var f=n.openCursor(u,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorSortSortStrategy",f,function(f){var e=new _e.$KC(f.target,u);var o=new _e.$By(n,t.$Fl,t.$EM,e);var s=new _e.$By(n,i.$Fl,i.$EM,o);r(s)})};_e.$2A.$73P=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$C0,"Creating Sort(Cursor) strategy.");var u=_a.$6y.$1CZ();var f=n.openCursor(u,_e.$2A.$3TA(r));_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorSortStrategy",f,function(f){var e=new _e.$KC(f.target,u);var o=new _e.$By(n,i,r,e);t(o)})};_e.$2A.$1hm=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$C0,"Creating Index strategy.");var e=t.openCursor(r,_e.$2A.$3TA(i));_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateIndexStrategy",e,function(n){f(new _e.$KC(n.target,r))})};_e.$2A.$73Q=function(n,t){_js.Trace.logInfo(_a.$0.$C0,"Creating Cursor strategy.");var i=_a.$6y.$1CZ();var r=n.openCursor(i,"next");_e.$3e.$4BQ(_a.$FI,_a.$HW,"CreateCursorStrategy",r,function(n){t(new _e.$KC(n.target,i))})};_e.$2A.$3aD=function(n){return n.$F2&&n.$F2.length?n.$F2.length===1?1:n.$F2.length===2?2:0:0};_e.$2A.$7aB=function(n){return!!n&&!!n.$6f&&_a.$86.isInstanceOfType(n.$6f)};_e.$2A.$7Yp=function(n){return!!n&&!n.$6f};_e.$2A.$7b7=function(n){return!n};_e.$2A.$7bs=function(n){return!!n&&!!n.$6f&&(_a.$Ut.isInstanceOfType(n.$6f)||_a.$Li.isInstanceOfType(n.$6f))};_e.$2A.$3TA=function(n){return n?"prev":"next"};_e.$2A.$2c1=function(n){var i=null;if(_a.$Ut.isInstanceOfType(n)){var t=n;switch(t.$1Td){case 0:i=_a.$6y.$1gL(t.$yb,t.$11F,!1,!1);break;case 3:i=_a.$6y.$1gL(t.$yb,t.$11F,!0,!0);break;case 1:i=_a.$6y.$1gL(t.$yb,t.$11F,!0,!1);break;case 2:i=_a.$6y.$1gL(t.$yb,t.$11F,!1,!0);break;default:break}}else if(_a.$Li.isInstanceOfType(n)){var r=n;var u=!r.$1gK;i=r.$30q?_a.$6y.$9Fr(r.$1DA,u):_a.$6y.$7g0(r.$1DA,u)}else if(_a.$86.isInstanceOfType(n)){var f=n;i=_a.$6y.$8Zw(f.$pF)}return i};_e.$2A.$6tU=function(n,t,i){var r=n.onerror;n.onerror=function(t){n.onerror=r;_e.$5h.$uE(t.target.error.name,i);r&&r(t)};var u=t;t=function(t){n.onerror=r;u(t)};return t};function $4Qm(n,t,i,r){if(n.$MK===2)i(t);else{var u=this,f=this;n.$CS(function(){$4Qm(n,t+1,i,r)},function(n){_e.$5h.$uE(n.name,r)})}}function $4Qn(n,t,i,r,u){var f=n.$MK?1:0;var e=this,o=this;n.$CS(function(){i+=f;if(n.$MK===2)r(!1,i);else if(t.$5Cy(n.get_$14O(),n.get_$1Qf().data)){n.$MK=0;r(!0,i)}else $4Qn(n,t,i,r,u)},function(n){_e.$5h.$uE(n.name,u)})}function $3GG(n){if(!n.$MK)throw Error.invalidOperation("cannot ask for value before calling next");}function $2UX(n){n.$MK=n.get_$57v()!==null?1:2}_e.$2A.prototype={$ND:null,$MK:0,$25r:0,get_$1Qf:function(){$3GG(this);return this.get_$7WY()},get_$14O:function(){$3GG(this);return this.get_$57v()},get_$3Se:function(){$3GG(this);return this.get_$7WX()},get_$3I:function(){return this.$MK},$F:function(n,t){if(this.$25r===null){_js.Trace.logWarning(_a.$0.$C0,"Asking for Count on anything other than a cusor strategy will require query traversal.");var i=this;$4Qm(this,0,function(t){i.$25r=t;n(i.$25r)},t)}else n(this.$25r)},$CS:function(n,t){switch(this.$MK){case 0:var i=this;this.$3v(function(){$2UX(i);n()},t);break;case 1:var r=this;this.$3eh(function(){$2UX(r);n()},t);break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}},$1ar:function(n,t,i){$4Qn(this,n,0,t,i)},$1MM:function(n,t,i){if(n&&this.$MK!==2)switch(this.$MK){case 0:var r=this,f=this;this.$3v(function(){$2UX(r);r.$1MM(n-1,t,i)},function(n){_e.$5h.$uE(n.name,i)});break;case 1:var u=this,e=this;this.$58J(n,function(){$2UX(u);_e.$5h.$1LB(t)},function(n){_e.$5h.$uE(n.name,i)});break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}else _e.$5h.$1LB(t)},$3v:function(n,t){this.$3eh(n,t)},$58J:function(n,t,i){if(n&&this.$MK!==2){var r=this;this.$CS(function(){r.$58J(n-1,t,i)},i)}else t()}};_e.$11a=function(n,t){this.data=n;this.metadata=t};_e.$11a.prototype={data:null,metadata:null};_e.$lZ=function(n,t,i){this.$Kg=n;this.$BH=t;this.$6R=i;this.$4Fx=t.objectStore("__versions");this.$3dh=t.objectStore("__indexes")};function $6VE(n,t,i){var r=!1;if(i.storeName===t){r=!0;if(n.$6R.$1bz(t)){var u=n.$6R.$3b2(t);var f=i.storeVersion||"";u===f&&(r=!1)}}return r}_e.$lZ.prototype={$Kg:null,$BH:null,$4Fx:null,$3dh:null,$6R:null,$75G:function(n,t,i,r){if(this.$6R.$1bz(n))throw Error.invalidOperation("the object store: "+n+" already exists.");if(n.startsWith("__"))throw Error.invalidOperation("the object store: "+n+" begins with the reserved prefix __.");this.$Kg.createObjectStore(n,new _a.$Rf(null,i));this.$6R.$H(n,t);this.$4Fx.put(new _e.$rt(n,t),n)},$5t3:function(n){if(this.$6R.$1bz(n)){var r=this.$Kg.deleteObjectStore(n);this.$6R.$3Q(n);var u=_a.$EC.$3Q(this.$4Fx,n);var t=this.$3dh.openCursor(_a.$6y.$1CZ(),"next");var i=this;_e.$3e.$4BQ(_a.$FI,_a.$HW,"RemoveObjectStore",t,function(t){if(t.target.result){var r=t.target.result.value;$6VE(i,n,r)&&_a.$OT.$3Q(t.target.result);_a.$OT.$CS(t.target.result)}})}},$BB:function(n,t){if(this.$6R.$1bz(n)){var i=t.$SH();var r=this.$BH.objectStore(n);_a.$EC.$3Q(r,i)}},$4og:function(n,t,i){if(!this.$6R.$1bz(t))throw Error.invalidOperation("the object store: "+t+" does not exist.");if(this.$6R.$56m(t,n))throw Error.invalidOperation("the object store: "+t+" already has index "+n+" declared.");var f=this.$6R.$3b2(t);var r=new _e.$11V(t,n,i,f);this.$3dh.put(r);var e=this.$BH.objectStore(t);var u=_e.$LY.$I(r);e.createIndex(n,u.$5FR.$5M,_a.$R6.$3Tq);this.$6R.$1fB(r.storeName,u)}};_e.$11c=function(n,t){_e.$11c.initializeBase(this,[n,t,new _a.$4U("data."+t[0])])};_e.$11c.prototype={$6sf:function(n,t,i){_e.$LY.$4Ft(this.$ge[0],n,t,i)}};_e.$LZ=function(){};_e.$LZ.$HX=function(n,t,i,r){t.oncomplete=function(){_js.Trace.logInfo(_a.$0.$C0,"idb transaction successfully completed");var t=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),n);_a.$2i.$fG(t,function(){_e.$5h.$1LB(i)})};t.onabort=function(t){_js.Trace.logInfo(_a.$0.$C0,"idb transaction aborted!");var i="AbortError";if(t.target.error){i=t.target.error.name;_js.Trace.logError(_a.$0.$C0,"aborted due to error: "+i)}var u=new _a.$Hw(_a.$2i.$xP(_a.$0.$C0),n);_a.$2i.$fG(u,function(){_e.$5h.$uE(i,r)})}};_e.$rt=function(n,t){this.name=n.toLowerCase();this.version=t};_e.$rt.prototype={name:null,version:null};_e.$1A0=function(){};_e.$1A0.registerInterface("_e.$1A0");_e.$19z=function(){};_e.$19z.registerInterface("_e.$19z");_e.$AK=function(n,t){this.$$d_$7Wv=Function.createDelegate(this,this.$7Wv);this.$Kg=n;this.$6R=_e.$EP.$qo();this.$LO=new _a.$tK(this);this.$cd=new _a.$Pf;this.$8b="";this.$12j=t;this.$2Rl=0;this.$1ex=new Array(0)};_e.$AK.$72a=function(n,t,i){var r=null;try{r=new _e.$7n(t,i);n(r)}finally{r&&r.$1M()}};_e.$AK.$75H=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT, {2} TEXT, {3} TEXT)","__OBJECTSTORE","StoreName","IndexName","IndexKeyPath");var i=new Array(0);_e.$4v.$G1(n,"SqlBrowserDb.CreateObjectStoreMetaTable",t,i,null,null)};_e.$AK.$76d=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__VERSIONS","EntityName","VersionName");var i=new Array(0);_e.$4v.$G1(n,"SqlBrowserDb.CreateVersionMetaTable",t,i,null,null)};_e.$AK.$72k=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__BLOBS","StoreName","Blobs");var i=new Array(0);_e.$4v.$G1(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$AK.$769=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__SETTINGS","Id","Value");var i=new Array(0);_e.$4v.$G1(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$AK.$9Fd=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__VERSIONS","EntityName","VersionName");var r=["db",t];_e.$4v.$G1(n,"SqlBrowserDb.UpdateVersionMetaTable",i,r,null,null)};_e.$AK.$9Cs=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__SETTINGS","Id","Value");var r=["Features",JsonParser.serialize(t)];_e.$4v.$G1(n,"SqlBrowserDb.UpdateActivatedFeatures",i,r,null,null)};function $6Vb(n,t){var r=null;var u=null;var f=null;var e=null;var i=String.format("SELECT * FROM {0}","__OBJECTSTORE");var o=new Array(0);var s=this;_e.$4v.$G1(t,"SqlBrowserDb.PopulateMetadataFromDatabase1",i,o,function(t,i){r=i;$2UY(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__VERSIONS");var h=this;_e.$4v.$G1(t,"SqlBrowserDb.PopulateMetadataFromDatabas2",i,o,function(t,i){u=i;$2UY(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__BLOBS");var c=this;_e.$4v.$G1(t,"SqlBrowserDb.PopulateMetadataFromDatabase3",i,o,function(t,i){f=i;$2UY(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__SETTINGS");var l=this;_e.$4v.$G1(t,"SqlBrowserDb.PopulateMetadataFromDatabase4",i,o,function(t,i){e=i;$2UY(n,r,u,f,e)},null)}function $2UY(n,t,i,r,u){if(t&&i&&r&&u){n.$6R=_e.$EP.$74H(t,i,r);$6Vd(n,i);$6Vc(n,u)}}function $6Vd(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.EntityName==="db"){n.$8b=r.VersionName;break}}}function $6Vc(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.Id==="Features"){var u=r.Value;n.$1ex=JsonParser.deserialize(u);break}}n.$1ex=n.$1ex||new Array(0)}_e.$AK.prototype={$Kg:null,$12j:null,$6R:null,$LO:null,$cd:null,$8b:null,$1ex:null,$2Rl:0,get_$3Z:function(){return this.$8b},get_$1Jo:function(){return this.$6R.get_$1Jo()},get_$1ey:function(){return this.$1ex},$3P1:function(n,t,i,r,u){var o=this.$6R.$46();var e=this.$2Rl++;this.$12j.$3m8(e);var h=this,s=this,f=this;this.$Kg.transaction(function(r){_e.$AK.$72a(i,r,o);_e.$AK.$9Fd(r,n);_e.$AK.$9Cs(r,t)},function(n){s.$12j.$1py(e);_e.$Ak.$2Nb(n,u)},function(){f.$12j.$1py(e);f.$6R=o.$46();f.$8b=n;f.$1ex=t;r&&r()})},$AK:function(n,t,i,r){var u=null;var f=this.$2Rl++;this.$12j.$3m8(f);var e=this,o=this,s=this;this.$Kg.transaction(function(i){_js.Trace.logInfo(_a.$0.$d4,"queuing transaction {0} with id {1}",n.$Y6,f);u=new _e.$4v(i,e.$6R,e.$LO,e.$cd,n);t(u)},function(t){var i=_a.$5.aes(_a.$0.$d4,"SqlDbFailure");try{_js.Trace.logInfo(_a.$0.$d4,"transaction {0} ended in error.",n.$Y6);o.$12j.$1py(f);u&&u.$2WK?_e.$Ak.$uD(5,"transaction aborted",r):_e.$Ak.$7YN(t)?o.$12j.$7hV():u&&u.get_$5Fd()?_e.$Ak.$2Nb(u.get_$5Fd(),r):_e.$Ak.$2Nb(t,r)}finally{_a.$5.aee(i)}},function(){_js.Trace.logInfo(_a.$0.$d4,"transaction {0} with id {1} ended in success.",n.$Y6,f);var t=_a.$5.aes(_a.$0.$d4,"SqlDbSuccess");try{s.$12j.$1py(f);u&&u.$33A();_e.$Ak.$8rt(i,u.$gn.$Y6)}finally{_a.$5.aee(t)}})},$6Bk:function(n,t){var i=this,r=this;this.$3P1("",new Array(0),this.$$d_$7Wv,function(){n&&n()},function(n){t&&t(n)})},$HX:function(n,t){this.$LO.$HX(n,t)},$12Z:function(n){this.$LO.$12Z(n)},$4F0:function(){this.$LO.$4F0()},$4p2:function(n){if(!this.$6R.$1k1(n))throw Error.invalidOperation(String.format("The object store {0} does not exist",n));var t=new _e.$AK.$96E(n,this.$cd);this.$cd.$4e4(t);return t},$3v:function(n,t){_a.$3.$M(n,"success");var i=this,r=this,u=this;this.$Kg.transaction(function(n){_e.$AK.$75H(n);_e.$AK.$76d(n);_e.$AK.$72k(n);_e.$AK.$769(n);$6Vb(i,n)},function(n){_e.$Ak.$2Nb(n,t)},function(){n()})},$7M3:function(n){var t=this.$6R.$1k1(n);t||Error.invalidOperation(String.format("The storeName {0} doesn't exist",n));return t.$8b},$5H:function(){},$7Wv:function(n){for(var t=n,r=this.get_$1Jo(),i=0;i<r.length;++i)t.$5t3(r[i]);t.$8oC();t.$8oE();t.$8oB();t.$8oD()}};_e.$AK.$96E=function(n,t){_e.$AK.$96E.initializeBase(this,[n,t])};_e.$Ak=function(n,t){_e.$Ak.initializeBase(this,[n,t])};_e.$Ak.$2Nb=function(n,t){var i=n.message;var r=_e.$Ak.$9B4(n);_js.Trace.logError(_a.$0.$d4,"SQL Error - code "+r+": {0}",i);_e.$Ak.$uD(r,i,t)};_e.$Ak.$uD=function(n,t,i){if(i){var r=new _a.$Hw(_a.$2i.$xP(_a.$0.$d4),"SQLBrowserDBError.ReportError");r.$28Y=r.$28+"_"+t;_a.$2i.$fG(r,function(){i(new _e.$Ak(n,t))})}};_e.$Ak.$8rs=function(n,t,i,r){if(n){var u=new _a.$Hw(_a.$2i.$xP(_a.$0.$d4),"SQLBrowserDBError.ReportStatementSuccess_"+r);_a.$2i.$fG(u,function(){n(t,i)})}};_e.$Ak.$8rt=function(n,t){if(n){var i=new _a.$Hw(_a.$2i.$xP(_a.$0.$d4),"SQLBrowserDBError.ReportTransactionSuccess_"+t);_a.$2i.$fG(i,function(){n()})}};_e.$Ak.$7YN=function(n){var t=n.code;var i=(n.message||"").toLowerCase();var r=!t&&i.indexOf("closed")>=0;_js.Trace.logWarning(_a.$0.$d4,"returning {0} for the sql error with code {1} and message {2} in IsDatabaseClosedError.",r,t,i);return r};_e.$Ak.$9B4=function(n){var t=0;switch(n.code){case 6:t=1;break;case 1:t=0;break;case 4:t=3;break;case 5:t=0;break;case 7:t=4;break;case 3:t=0;break;case 0:t=0;break;case 2:t=0;break}return t};_e.$iL=function(n,t){_e.$iL.initializeBase(this);this.$6Bg=n;this.$12j=t};function $6Ve(n,t,i,r,u){_a.$3.$1C(t,"name");r.val=null;u.val="";try{r.val=n.$6Bg.openDatabase(t,"",_u.Strings.l_OWA_Text,i*1048576,null)}catch(f){u.val=f.message;r.val=null}return!!r.val}_e.$iL.prototype={$6Bg:null,$12j:null,$8hy:function(n,t,i,r){_a.$3.$M(i,"success");var u;var f;var e,o,s;if(s=$6Ve(this,n,t,e={val:u},o={val:f}),u=e.val,f=o.val,s){var h=new _e.$AK(u,this.$12j);var c=this,l=this;h.$3v(function(){i(h)},function(n){r&&r(n)})}else r&&r(new _a.$8t(0,f))},$78b:function(n,t,i){var r=this,u=this;this.$8hy(n,5,function(n){n.$6Bk(function(){t()},function(n){i&&i(n)})},function(n){i&&i(n)})}};_e.$Cb=function(n,t,i,r){this.$BH=n;this.$6R=t;this.$2Ms=i;this.$o4=r};_e.$Cb.$7HD=function(n,t){var i=null;n.rows.length&&(i=_e.$d1.$29r(0,n,t).$24);return i};function $4Qw(n,t){if(t){$6Vi(n,t);$6Vj(n,t)}}function $6Vj(n,t){if(t.$F2)for(var i=0;i<t.$F2.length;++i)if(!n.$6R.$2B1(t.$F2[i].$Fl.$5M)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$F2[i].$Fl.$5M);_a.$8t.$v0(1,r)}}function $6Vi(n,t){if(t.$6f)for(var r=t.$6f.$1al,i=0;i<r.length;++i)if(!n.$6R.$2B1(r[i].$5M)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5M);_a.$8t.$v0(1,u)}}function $6Vg(n,t,i){var r=[];var f={};Array.add(r,t);for(var e=0;e<n.$6R.get_$1yw().length;++e){var o=n.$6R.get_$1yw()[e];var p=o.$15Z(i);f[o.$5M]=p;o.$78g(i)}try{Array.add(r,JsonParser.serialize(i));for(var s=0;s<n.get_$1mD().length;++s){var h=n.get_$1mD()[s];var c=f[h];$6Vl(n,t,h,c);$6Vm(n,t,h,c);Array.add(r,c)}for(var l=0;l<n.$6R.get_$24S().length;++l){var v=n.$6R.get_$24S()[l].$5M;var u=f[v];u=undefined===u?null:u;$6Vk(n,t,v,u);Array.add(r,u)}}finally{for(var a=0;a<n.$6R.get_$1yw().length;++a){var y=n.$6R.get_$1yw()[a];var w=f[y.$5M];y.$1xz(i,w)}}return r}function $6Vl(n,t,i,r){if($8(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",i,n.$6R.get_$o2(),t);_a.$8t.$v0(1,u)}}function $6Vk(n,t,i,r){if(r&&!String.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a blob store {1} but it is not a string {2}",i,n.$6R.get_$o2(),t);_a.$8t.$v0(1,u)}}function $6Vm(n,t,i,r){if(!String.isInstanceOfType(r)&&!Number.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",i,n.$6R.get_$o2(),t,Object.getType(r).getName());_a.$8t.$v0(1,u)}}function $6Vh(n){for(var t=new Sys.StringBuilder("(?, ?"),i=0;i<n.get_$1mD().length;++i)t.append(", ?");for(var r=0;r<n.$6R.get_$24S().length;++r)t.append(", ?");t.append(")");return t.toString()}function $6Vf(n){for(var t=new Sys.StringBuilder(String.format("({0}, {1}",_e.$Ez.$18q,"json")),i=0;i<n.get_$1mD().length;++i)t.append(String.format(", [{0}]",n.get_$1mD()[i]));for(var r=0;r<n.$6R.get_$24S().length;++r)t.append(String.format(", [{0}]",n.$6R.get_$24S()[r].$5M));t.append(")");return t.toString()}_e.$Cb.prototype={$BH:null,$6R:null,$2Ms:null,$o4:null,get_$1Q:function(){return this.$6R.get_$o2()},get_$1mD:function(){return this.$6R.get_$1mD()},$3k:function(n,t,i){_a.$3.$M(n,"id must be provided");_a.$3.$M(n.$SH(),"id must be provided");_a.$3.$M(t,"success callback must be provided");var r=n.$SH();_a.$3.$M(r,"id must be provided");_a.$3.$1C(r.toString(),"id must be provided");var u=String.format("SELECT * FROM [{0}] WHERE {1} = ?",this.$6R.get_$o2(),_e.$Ez.$18q);var f=[r];var e=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,u,f,function(n,i){var r=_e.$Cb.$7HD(i,e.$6R.get_$1yw());t(r)},i)},$eA:function(n,t,i){_a.$3.$M(n,"id must be provided");var r=n.$SH();_a.$3.$M(r,"id must be provided");_a.$3.$1C(r.toString(),"id must be provided");var f=String.format("DELETE FROM [{0}] WHERE {1} = ?",this.$6R.get_$o2(),_e.$Ez.$18q);var e=[r];this.$o4.$10I(this,n);var u=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,f,e,function(){u.$2Ms&&u.$2Ms(u.get_$1Q(),2,n,null);t&&t()},i)},$1u:function(n,t){var i=String.format("DELETE FROM [{0}]",this.$6R.get_$o2());var r=[];this.$o4.$1YO(this);var u=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,i,r,function(){n&&n()},t)},$8oG:function(n,t,i,r){_a.$3.$M(n,"id must be provided");_a.$3.$M(t,"json must be provided");var f=String.format("INSERT OR REPLACE INTO [{0}] {1} VALUES {2}",this.$6R.get_$o2(),$6Vf(this),$6Vh(this));var e=$6Vg(this,n.$SH(),t);this.$o4.$1YP(this,n,t);var u=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,f,e,function(r,f){u.$2Ms&&u.$2Ms(u.get_$1Q(),1,n,t);n.$SH()||(n=new _a.$Lr(f.insertId));i&&i(n)},r)},$HQ:function(n,t,i){_a.$3.$M(t,"success");$4Qw(this,n);t(new _e.$d1(this.$BH,n,this.$6R.get_$o2(),this.$6R.get_$1yw()))},$3dH:function(n,t,i){_a.$3.$M(t,"success");var r=new _a.$7m(n,null);$4Qw(this,r);t(new _e.$d0(this.$BH,r,this.$6R.get_$o2()))}};_e.$4v=function(n,t,i,r,u){this.$BH=n;this.$6R=t;this.$o4=new _a.$Pe(this,r);this.$18n=null;this.$gn=u;i&&(this.$18n=new _a.$tI(i))};_e.$4v.$G1=function(n,t,i,r,u,f){var s="";var h="";if(_js.Trace.$2x&&_js.Trace.$Qe===5){for(var e="{ ",o=0;o<r.length;++o){e+=r[o]?r[o].toString():"null";o<r.length-1&&(e+=", ")}e+=" }";s=String.format("ExecuteSql => {0} {1}",i,e.substr(0,50));h=String.format("ExecuteSql => {0} {1}",i,e.substr(0,256))}n.executeSql(i,r,function(n,i){var r=_a.$5.aes(_a.$0.$d4,"ExecuteSqlSuccess");try{_e.$Ak.$8rs(u,n,i,t)}finally{_a.$5.aee(r)}},function(t,r){var u=_a.$5.aes(_a.$0.$d4,"ExecuteSqlFailure");try{n.lastBrowserDbTransactionError=r;i!=="BOGUS SQL STATEMENT TO FORCE ROLLBACK"&&_e.$Ak.$2Nb(r,f);return!0}finally{_a.$5.aee(u)}})};_e.$4v.prototype={$BH:null,$6R:null,$18n:null,$o4:null,$gn:null,$2WK:!1,get_$1N1:function(){return this.$gn},get_$5Fd:function(){return this.$BH.lastBrowserDbTransactionError},get_$7DL:function(){var n=null;this.$18n&&(n=this.$18n.$$d_$8oS);return n},$2WJ:function(){this.$2WK=!0;_e.$4v.$G1(this.$BH,"SqlBrowserDbTransaction.Abort","BOGUS SQL STATEMENT TO FORCE ROLLBACK",[],null,null)},$CU:function(n){var t=this.$6R.$7M2(n);if(!t)throw Error.invalidOperation(String.format("Object store {0} does not exist",n));return new _e.$Cb(this,t,this.get_$7DL(),this.$o4)},$33A:function(){this.$18n&&this.$18n.$33A(this.$gn)}};_e.$Ez=function(){};_e.$176=function(n,t,i){_e.$176.initializeBase(this,[n,t,i]);this.$6f=n.$6f};_e.$176.prototype={$6f:null,get_$9H3:function(){return"WHERE ["+this.$6f.get_$Qv().$5M+"] = ?"},get_$6Bd:function(){return[this.$6f.$pF]}};_e.$177=function(n,t,i){_e.$177.initializeBase(this,[n,t,i]);this.$6f=n.$6f};_e.$177.prototype={$6f:null,get_$9H3:function(){var n=" ["+this.$6f.get_$Qv().$5M+"] ";return"WHERE"+n+this.get_$7ea()+" ? AND"+n+this.get_$8tc()+" ?"},get_$6Bd:function(){return[this.$6f.$yb,this.$6f.$11F]},get_$7ea:function(){var n=">";this.$6f.$1Td&&this.$6f.$1Td!==2||(n+="=");return n},get_$8tc:function(){var n="<";this.$6f.$1Td&&this.$6f.$1Td!==1||(n+="=");return n}};_e.$178=function(n,t,i){_e.$178.initializeBase(this,[n,t,i]);this.$6f=n.$6f};_e.$178.prototype={$6f:null,get_$9H3:function(){var n;switch(this.$6f.$30q){case 0:n=this.$6f.$1gK===1?">=":">";break;case 1:n=this.$6f.$1gK===1?"<=":"<";break;default:throw Error.invalidOperation("OperatorType is not supported.");}return"WHERE ["+this.$6f.get_$Qv().$5M+"] "+n+" ?"},get_$6Bd:function(){return[this.$6f.$1DA]}};_e.$EP=function(){this.$rA=[]};_e.$EP.$qo=function(){return new _e.$EP};_e.$EP.$74H=function(n,t,i){for(var c=new _e.$EP,l={},r={},u=0;u<t.rows.length;++u){var a=t.rows.item(u);var v=a.EntityName.toLowerCase();l[v]=a.VersionName;r[v]=null}for(var f=0;f<i.rows.length;++f){for(var y=i.rows.item(f),nt=y.StoreName.toLowerCase(),tt=JsonParser.deserialize(y.Blobs),p=[],w=tt,it=w.length,e=0;e<it;++e){var rt=w[e];Array.add(p,new _a.$4U(rt))}r[nt]=p}for(var b=n.rows,o=0;o<b.length;++o){var s=b.item(o);var h=s.StoreName;var k=s.IndexName;var d=s.IndexKeyPath;var g=$4R0(c,h,l[h.toLowerCase()],r[h.toLowerCase()]);_js.$8.$c(k)||g.$1fB(k);_js.$8.$c(d)||g.$4du(new _a.$4U(d))}return c};function $2UZ(n,t){return n.$rA[t]}function $4R0(n,t,i,r){var u=n.$1k1(t);if(!u){u=new _e.$un(t,i,r);Array.add(n.$rA,u)}return u}_e.$EP.prototype={get_$1Jo:function(){for(var t=[],n=0;n<this.$rA.length;++n){var i=$2UZ(this,n);Array.add(t,i.$Vv)}return t},$H:function(n,t,i){$4R0(this,n,t,i)},$3Q:function(n){for(var t=0;t<this.$rA.length;++t){var i=$2UZ(this,t);if(i.$2mC(n.$Vv)){Array.removeAt(this.$rA,t);break}}},$46:function(){for(var t=new _e.$EP,n=0;n<this.$rA.length;++n){var i=$2UZ(this,n);Array.add(t.$rA,i.$46())}return t},$3X1:function(n){return!!this.$1k1(n)},$1k1:function(n){for(var i=null,t=0;t<this.$rA.length;++t){var r=$2UZ(this,t);if(r.$2mC(n)){i=r;break}}return i},$7M2:function(n){return this.$1k1(n)}};_e.$un=function(n,t,i){this.$Vv=n;this.$8b=t;this.$1D6=i||[];this.$1bt=Array.clone(this.$1D6);this.$2Bn={};this.$1mC={}};_e.$un.prototype={$Vv:null,$8b:null,$1D6:null,$1bt:null,$2Bn:null,$1mC:null,get_$o2:function(){return this.$Vv},get_$1mD:function(){var n=[];var t=this.$1mC;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.value)}return n},get_$1yw:function(){return this.$1bt},get_$24S:function(){return this.$1D6},$2mC:function(n){return this.$Vv.toLowerCase()===n.toLowerCase()},$46:function(){var n=new _e.$un(this.$Vv,this.$8b,this.$1D6);n.$2Bn=_0365f.$57.$46(this.$2Bn);n.$1mC=_0365f.$57.$46(this.$1mC);n.$1bt=Array.clone(this.$1bt);return n},$1fB:function(n){this.$2Bn[n.toLowerCase()]=n},$4du:function(n){this.$1mC[n.$5M.toLowerCase()]=n.$5M;Array.add(this.$1bt,n)},$7SR:function(n){return n.toLowerCase()in this.$2Bn},$2B1:function(n){return n.toLowerCase()in this.$1mC||n.toLowerCase()===_e.$Ez.$18q}};_e.$Fe=function(n,t,i){this.$5C=n;this.$Vv=t;this.$60I=i};_e.$Fe.$I=function(n,t,i){var r=null;n&&n.$6f?_a.$86.isInstanceOfType(n.$6f)?r=new _e.$176(n,t,i):_a.$Ut.isInstanceOfType(n.$6f)?r=new _e.$177(n,t,i):_a.$Li.isInstanceOfType(n.$6f)&&(r=new _e.$178(n,t,i)):r=new _e.$Fe(n,t,i);return r};_e.$Fe.$7OI=function(n){return n?"DESC":"ASC"};function $6Vw(n){return!!n.$5C&&!!n.$5C.$F2&&n.$5C.$F2.length>0}function $2Ua(n,t){var i="SELECT "+t+" FROM ["+n.$Vv+"]";var r=n.get_$9H3();r&&(i+=" "+r);var u=n.get_$8iY();u&&(i+=" "+u);return i}_e.$Fe.prototype={$5C:null,$Vv:null,$60I:0,get_$8wW:function(){return this.$60I===1?$2Ua(this,"*"):$2Ua(this,_e.$Ez.$18q)},get_$8vh:function(){return $2Ua(this,"COUNT(*)")},get_$4AZ:function(){var n=[];this.get_$6Bd()&&Array.addRange(n,this.get_$6Bd());return n},get_$9H3:function(){return""},get_$6Bd:function(){return[]},get_$8iY:function(){var t="";if($6Vw(this)){t="ORDER BY";for(var n=0;n<this.$5C.$F2.length;++n){var i=this.$5C.$F2[n];t+=" ["+i.$Fl.$5M+"] "+_e.$Fe.$7OI(i.$EM)+(n<this.$5C.$F2.length-1?",":"")}}return t},$8w7:function(){for(var n=[],t=0;t<arguments.length;++t)n[t]=arguments[t];for(var r="",i=0;i<n.length;++i){r+="["+n[i].$5M+"]";i+1<n.length&&(r+=", ")}return $2Ua(this,r)}};_e.$d0=function(n,t,i){this.$FM=new _e.$Jf(n,_e.$Fe.$I(t,i,0))};_e.$d0.$29r=function(n,t){var i=t.rows.item(n);var r=i[_e.$Ez.$18q];return new _a.$Lr(r)};_e.$d0.prototype={$FM:null,$F:function(n,t){this.$FM.$F(n,t)},$CS:function(n,t,i){this.$FM.$CS(_a.$Lr,n,_e.$d0.$29r,t,i)}};_e.$d1=function(n,t,i,r){this.$FM=new _e.$Jf(n,_e.$Fe.$I(t,i,1));this.$1bt=r};_e.$d1.$29r=function(n,t,i){for(var u=t.rows.item(n),s=u.json,f=JsonParser.deserialize(s),e=i,h=e.length,r=0;r<h;++r){var o=e[r];var c=u[o.$5M];o.$1xz(f,c)}return new _a.$c5(_e.$d0.$29r(n,t),f)};_e.$d1.prototype={$FM:null,$1bt:null,get_$MG:function(){return this.$FM.$89},$F:function(n,t){this.$FM.$F(n,t)},$CS:function(n,t,i){var f=this;var r=t?function(n,i,r){t(n,i,r)}:null;var u=this;this.$FM.$CS(_a.$c5,n,function(n,t){return _e.$d1.$29r(n,t,u.$1bt)},r,i)},$1ar:function(n,t,i,r){this.$FM.$1ar(n,t,i,r)},$1MM:function(n,t,i){this.$FM.$1MM(n,t,i)}};_e.$Jf=function(n,t){this.$BH=n;this.$1bw=t};_e.$Jf.$7Ew=function(n,t){for(var i=0;i<n.rows.length;++i)if(t.$7cB(n.rows.item(i)))return i;return-1};_e.$Jf.$4iH=function(n,t,i){var r=String.format(" LIMIT {0} OFFSET {1}",i,t);return n+r};function $4R1(n){if(n.$1dU)throw Error.invalidOperation("An async operation is currently in progress");}_e.$Jf.prototype={$1bw:null,$BH:null,$89:0,$1dU:!1,$F:function(n,t){var i=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,this.$1bw.get_$8vh(),this.$1bw.get_$4AZ(),function(t,i){var r=i.rows.item(0)["COUNT(*)"];n(r)},t)},$CS:function(n,t,i,r,u){$4R1(this);this.$1dU=!0;var e=_e.$Jf.$4iH(this.$1bw.get_$8wW(),this.$89,t);this.$89=this.$89+t;var f=this,o=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,e,this.$1bw.get_$4AZ(),function(n,u){f.$1dU=!1;if(r){for(var o=u.rows.length,h=_a.$5.ads(_a.$0.$d4,"SqlQueryResultImpl.Next_BuildResultsFromRow_"+o),s=new Array(o),e=0;e<o;++e){var c=i(e,u);s[e]=c}_a.$5.ade(h);r(f.$BH,s,s.length<t)}},function(n){o.$1dU=!1;u&&u(n)})},$1ar:function(n,t,i,r){$4R1(this);_a.$3.$M(t,"condition cannot be null");this.$1dU=!0;this.$58G(t,this.$89,i,r)},$1MM:function(n,t,i){this.$89+=n;t()},$58G:function(n,t,i,r){var f;var e=_e.$Jf.$4iH((f=this.$1bw).$8w7.apply(f,n.$1al),t,500);var u=this,o=this;_e.$4v.$G1(this.$BH.$BH,this.$BH.$gn.$Y6,e,this.$1bw.get_$4AZ(),function(f,e){var o=_e.$Jf.$7Ew(e,n);var s=o!==-1;var h=e.rows.length>0;if(s||!h){u.$1dU=!1;u.$89=t+o;i(s)}else u.$58G(n,t+e.rows.length,i,r)},function(n){o.$1dU=!1;r&&r(n)})}};_e.$7n=function(n,t){_e.$7n.initializeBase(this);this.$A5=n;this.$1YF=t};_e.$7n.$6xU=function(n){if(n.startsWith("__"))throw Error.create("An object store cannot be created with a name beginning with __");};_e.$7n.$6uz=function(n){for(var t="(",i=0;i<n.length;++i){i>0&&(t+=", ");t+=String.format("[{0}]",n[i].$5M.$5M)}t+=")";return t};_e.$7n.$6xe=function(n){if(n.length>2)throw Error.invalidOperation("Cannot create a multi-column index with more than two fields");};_e.$7n.$6xZ=function(n,t){if(n.$7SR(t))throw Error.invalidOperation(String.format("The index {0} already exists",t));};function $6W2(n,t,i,r){for(var u=0;u<i.length;++u){var f=i[u];if(!r.$2B1(f.$5M.$5M)){$6W1(n,r,f);$6Vy(n,r,t,f)}}}function $6W4(n,t,i,r){var u=i?"INTEGER PRIMARY KEY AUTOINCREMENT":"TEXT PRIMARY KEY";var f=$6W6(n,r);var e=String.format("CREATE TABLE [{0}]({1} {3}, {2} BLOB"+f+")",t,_e.$Ez.$18q,"json",u);var o=new Array(0);_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.CreateUnderlyingObjectStoreTable",e,o,null,null)}function $6W6(n,t){var u="";if(t&&t.length>0){for(var i=new Sys.StringBuilder,r=0;r<t.length;++r){i.append(", [");i.append(t[r].$5M);i.append("] BLOB")}u=i.toString()}return u}function $6W0(n,t,i){var r=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?, ?)","__VERSIONS","EntityName","VersionName");var u=[t,i];_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.AddStoreVersionToVersionsTable",r,u,null,null)}function $6Vx(n,t,i,r){var f="[]";if(r){for(var e=[],o=r,s=o.length,u=0;u<s;++u){var h=o[u];Array.add(e,h.$5M)}f=JsonParser.serialize(e)}var c=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?,?)","__BLOBS","StoreName","Blobs");var l=[t,f];_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.AddBlobPathsToBlobTable",c,l,null,null)}function $6Vz(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t,"",""];_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.AddStoreNameToObjectStoreMetadata",u,f,null,null);n.$1YF.$H(t,i,r)}function $6W7(n,t){var i=String.format("DELETE FROM {0} WHERE {1} = ?","__OBJECTSTORE","StoreName");var r=[t.$Vv];_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.RemoveStoreNameFromObjectStoreMetadata",i,r,null,null);n.$1YF.$3Q(t)}function $4R3(n,t){var i=String.format("DROP TABLE IF EXISTS [{0}]",t);var r=new Array(0);_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.RemoveUnderlyingObjectStoreTable",i,r,null,null)}function $6W5(n,t){if(n.$1YF.$3X1(t)){var i=new _e.$Ak(1,String.format("The object store {0} already exists.",t));throw Error.create(i.$4P,i);}}function $4R2(n,t){var i=n.$1YF.$1k1(t);if(!i){var r=new _e.$Ak(1,String.format("The object store {0} was not found.",t));throw Error.create(r.$4P,r);}return i}function $6W3(n,t,i,r){var u=_e.$7n.$6uz(r);var f=String.format("CREATE INDEX [{0}] ON [{1}] {2}",t,i.get_$o2(),u);var e=new Array(0);_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.CreateSqlIndexOnColumns",f,e,null,null)}function $6Vy(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t.$Vv,i,r.$5M.$5M];_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.AddIndexInformationToMetaTable",u,f,null,null);t.$4du(r.$5M)}function $6W1(n,t,i){var r=String.format("ALTER TABLE [{0}] ADD COLUMN [{1}] {2}",t.get_$o2(),i.$5M.$5M,_a.$gY.$J7(i.$7b));var u=new Array(0);_e.$4v.$G1(n.$A5,"SqlSchemaUpdater.AlterTableToAddColumnForIndex",r,u,null,null)}_e.$7n.prototype={$1YF:null,$A5:null,$75G:function(n,t,i,r){$6W5(this,n);_e.$7n.$6xU(n);$4R3(this,n);$6W4(this,n,i,r);$6W0(this,n,t);$6Vx(this,n,t,r);$6Vz(this,n,t,r)},$5t3:function(n){if(this.$1YF.$3X1(n)){var t=$4R2(this,n);$4R3(this,t.$Vv);$6W7(this,t)}},$BB:function(n,t){if(this.$1YF.$3X1(n)){var i=String.format("DELETE FROM [{0}] WHERE {1} = ?",n,_e.$Ez.$18q);var r=[t.$SH()];_e.$4v.$G1(this.$A5,"SqlSchemaUpdater.RemoveItem",i,r,null,null)}},$4og:function(n,t,i){_e.$7n.$6xe(i);var r=$4R2(this,t);_e.$7n.$6xZ(r,n);$6W2(this,n,i,r);$6W3(this,n,r,i);r.$1fB(n)},$8oC:function(){var n=String.format("DELETE FROM {0}","__OBJECTSTORE");var t=new Array(0);_e.$4v.$G1(this.$A5,"SqlSchemaUpdater.PurgeObjectStoreMetadata",n,t,null,null)},$8oE:function(){var n=String.format("DELETE FROM {0}","__VERSIONS");var t=new Array(0);_e.$4v.$G1(this.$A5,"SqlSchemaUpdater.PurgeVersionMetadata",n,t,null,null)},$8oB:function(){var n=String.format("DELETE FROM {0}","__BLOBS");var t=new Array(0);_e.$4v.$G1(this.$A5,"SqlSchemaUpdater.PurgeBlobMetadata",n,t,null,null)},$8oD:function(){var n=String.format("DELETE FROM {0}","__SETTINGS");var t=new Array(0);_e.$4v.$G1(this.$A5,"SqlSchemaUpdater.PurgeSettingsMetadata",n,t,null,null)},$59:function(){this.$A5=null}};_e.$cy=function(n,t){this.transaction=this.$AK;this.$uq=n;this.$2Em=t;this.$3B6=[];this.$3B7=!1};function $4Qx(n){if(!n.$3B7&&n.$3B6.length>0){n.$3B7=!0;var t=Array.dequeue(n.$3B6);var i=this;t.$96M(function(){n.$3B7=!1;$4Qx(n)})}}_e.$cy.prototype={$uq:null,$2Em:null,$3B7:!1,$3B6:null,$AK:function(n,t,i){_a.$3.$M(n,"transaction");var r=new _e.$4m(this.$uq,this.$2Em,i,t);try{n(r);Array.enqueue(this.$3B6,r);$4Qx(this)}catch(u){_js.Trace.logException(_a.$0.$d4,u,"Exception caught in transaction callback.");if(t){var f=String.format("Exception caught in transaction callback. {0}",u.message);var e=new _a.$tC(0,f);t(e)}}}};_e.$174=function(n){_e.$174.initializeBase(this);this.insertId=n.insertId;this.rowsAffected=n.rowsAffected;this.rows=new _e.$175(n)};_e.$175=function(n){_e.$175.initializeBase(this);this.length=n.rows.length;this.$2y1=n};_e.$175.prototype={$2y1:null,item:function(n){for(var i={},r=this.$2y1.rows[n],t=0;t<this.$2y1.columnNames.length;++t){var u=this.$2y1.columnNames[t];i[u]=r[t]}return i}};_e.$iM=function(n,t,i,r){_a.$3.$1C(n,"sql");_a.$3.$M(t,"args");_a.$3.$M(i,"successCallback");_a.$3.$M(r,"errorCallback");this.$63n=n;this.$1fh=t;this.$64x=i;this.$4v0=r};_e.$iM.prototype={$63n:null,$1fh:null,$64x:null,$4v0:null,$6r2:function(n){var t=this,i=this;n.$6qj(this.$63n,this.$1fh,function(n){t.$64x(n)},function(n){i.$4v0(n)})}};_e.$4m=function(n,t,i,r){this.$$d_$4m7=Function.createDelegate(this,this.$4m7);this.executeSql=this.$G1;this.$uq=n;this.$2Em=t;this.$3z5=$6Vs(this,i);this.$3xx=$6Vr(this,r);this.$6r=0;this.$10y=[];$6Vt(this,r)};function $6Vn(n){_js.Trace.logInfo(_e.$4m.$D,"Committing transaction");$3GK(n,1);n.$6r=2;var i=this,r=this;var t=new _e.$iM("COMMIT TRANSACTION",[],function(){n.$4m7()},function(t){_js.Trace.logError(_e.$4m.$D,"Commit error: {0}",t.message);$3GL(n,t)});Array.enqueue(n.$10y,t);$21r(n)}function $3GL(n,t){$4Qy(n);n.$3xx&&n.$3xx(t)}function $4Qy(n){n.$uq=null;n.$3xq&&n.$3xq()}function $6Vv(n,t){var i=new _a.$tC(0,"Exception occurred on a transaction callback. "+t.message);$4Qz(n,i)}function $4Qz(n,t){_js.Trace.logInfo(_e.$4m.$D,"Rolling back transaction");$3GK(n,1);n.$6r=2;Array.clear(n.$10y);var r=this,u=this;var i=new _e.$iM("ROLLBACK TRANSACTION",[],function(){$3GL(n,t)},function(i){_js.Trace.logWarning(_e.$4m.$D,"Rollback error: {0}",i.message);$3GL(n,t)});Array.enqueue(n.$10y,i);$21r(n)}function $6Vr(n,t){if(t){var i=this;return function(n){try{t(n)}catch(i){_js.Trace.logException(_e.$4m.$D,i,"Exception during transaction error callback.")}}}else return null}function $6Vs(n,t){if(t){var i=this;return function(){try{t()}catch(n){_js.Trace.logException(_e.$4m.$D,n,"Exception during transaction success callback.")}}}else return null}function $6Vq(n,t){var i=this;return function(i){n.$6r!==2&&t&&$6Vu(n,t,i)}}function $6Vp(n,t){var i=this;return function(i){n.$6r!==2&&$4Qz(n,i);t&&t(n,i)}}function $6Vu(n,t,i){try{t(n,new _e.$174(i))}catch(r){_js.Trace.logException(_e.$4m.$D,r,"Exception during transaction callback.");$6Vv(n,r)}}function $6Vo(n){n.$10y.length||$6Vn(n)}function $6Vt(n,t){var r=this,u=this;var i=new _e.$iM("BEGIN IMMEDIATE TRANSACTION",[],function(){},function(n){_js.Trace.logError(_e.$4m.$D,"BEGIN error: {0}",n.message);t&&t(n)});Array.enqueue(n.$10y,i)}function $21r(n){if(!n.$3g4&&n.$10y.length>0){for(var t=n.$uq.$72j();n.$10y.length>0&&t.get_$4v9()<4194304;){var i=Array.dequeue(n.$10y);i.$6r2(t)}n.$3g4=!0;var r=this;t.$s(function(){n.$3g4=!1;n.$6r!==2&&$6Vo(n);$21r(n)})}}function $3GK(n,t){if(n.$6r!==t)throw Error.invalidOperation(String.format("transaction state expected {0}.  Actual {1}.",t,n.$6r));}_e.$4m.prototype={$2Em:null,$3z5:null,$3xx:null,$uq:null,$3xq:null,$6r:0,$10y:null,$3g4:!1,$4vd:!1,$3hu:!1,$G1:function(n,t,i,r){this.$4vd=!0;if(this.$6r===2)throw Error.invalidOperation("ExecuteSql cannot be invoked on a completed transaction.");var f=new _e.$iM(n,t,$6Vq(this,i),$6Vp(this,r));Array.enqueue(this.$10y,f);if(this.$6r&&!this.$3hu){this.$3hu=!0;var u=this;this.$2Em.$21(_a.$0.$38x,"ExecuteSql",function(){u.$3hu=!1;$21r(u)},0)}},$96M:function(n){$3GK(this,0);this.$3xq=n;if(this.$4vd){_js.Trace.logInfo(_e.$4m.$D,"Starting transaction.");this.$6r=1;$21r(this)}else{this.$6r=2;this.$2Em.$21(_a.$0.$38x,"ExecuteSql",this.$$d_$4m7,0)}},$4m7:function(){$4Qy(this);this.$3z5&&this.$3z5()}};_e.$179=function(n,t){this.openDatabase=this.$8hy;this.$uq=n;this.$6Bt=t};_e.$179.prototype={$uq:null,$6Bt:null,$8hy:function(n,t,i,r,u){return new _e.$cy(this.$uq,this.$6Bt)}};_e.$WO=function(n,t,i,r){_e.$WO.initializeBase(this,[n,t]);_a.$3.$17(i,"personaId");_a.$3.$17(r,"syncManager");this.$8w=i;this.$3x=r};_e.$WO.prototype={$8w:null,$3x:null,get_$Of:function(){return"AddFavorite"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(8,new _a.$H5,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logWarning(_e.$WO.$D,"Couldn't find the persona because people module wasn't synced.");i(-1)}})},$7Dt:function(n,t,i){var r=this,u=this,f=this;this.$AK(function(n){var t=_e.$5T.$I(r.get_$95());t.$Da(n,r.$8w,function(i){if(i){i.IsFavorite=!0;i.FolderIds||(i.FolderIds=new Array(1));Array.add(i.FolderIds,_g.$1v.$9K("favorites"));t.$gO(n,i,0,null)}else _a.$8t.$v0(2,"PersonaId to update is not present in persona store")},null)},function(){n()},function(n){_e.$1W.$BC(n,t)})}};_e.$9T=function(n,t,i){_e.$9T.initializeBase(this,[n,t,i,i.Body.ConversationActions.length])};function $6T7(n,t,i,r){var u=_e.$D8.$xL(t,n.$OA.ConversationId);var f=this,e=this;n.$AK(function(t){n.$A5=t;n.get_$95().get_$Hh().$Da(n.$A5,u,function(t){$4Q1(n,t,u)},null)},function(){i()},_e.$1W.$WX(r))}function $6T8(n,t,i){n.$5AX=!0;var r=this,u=this;n.$AK(function(t){n.$A5=t;_e.$6O.$3ZJ(t,n.get_$95().get_$Hh(),n.$OA.ConversationId,function(t){for(var r=t,f=r.length,i=0;i<f;++i){var u=r[i];var e=_e.$D8.$xL(u.get_$1s().FolderId,n.$OA.ConversationId);$4Q1(n,u,e)}})},function(){t()},_e.$1W.$WX(i))}function $4Q1(n,t,i){if(t){var r=t.get_$1s();var u=r.FolderId;var f=this;n.get_$95().get_$2j().$Da(n.$A5,_e.$1X.$54(u.Id),function(u){$6TA(n,u,r);$6T9(n,i,t,r);$6TC(n,r)},null)}}function $6TA(n,t,i){if(t){var f=t.get_$1s();var r=f;switch(n.$OA.Action){case"Delete":case"AlwaysDelete":case"Move":i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);r.TotalCount-=i.MessageCount;break;case"SetReadState":if(n.$OA.IsRead)i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);else{var u=i.MessageCount;i.UnreadCount>0&&(u=i.MessageCount-i.UnreadCount);r.UnreadCount+=u}break;default:_js.Trace.logInfo(_e.$9T.$D,"{0} not implemented in client store.",n.$OA.Action);break}t.$Cn(n.$A5,null)}}function $6T9(n,t,i,r){switch(n.$OA.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$95().get_$Hh().$GW(n.$A5,t);break;case"SetReadState":r.UnreadCount=n.$OA.IsRead?0:r.MessageCount;n.$5AX&&(r.GlobalUnreadCount=n.$OA.IsRead?0:r.GlobalMessageCount);n.get_$95().get_$Hh().$gO(n.$A5,i,0,null);break;case"Flag":r.FlagStatus=n.$OA.Flag.FlagStatus;n.get_$95().get_$Hh().$gO(n.$A5,i,0,null);break;case"SetClutterState":r.HasClutter=n.$OA.IsClutter;n.get_$95().get_$Hh().$gO(n.$A5,i,0,null);break;default:_js.Trace.logInfo(_e.$9T.$D,"UpdateConversation: {0} not implemented in client store.",n.$OA.Action);break}}function $6TC(n,t){var i=t.ItemIds;if(i)for(var u=i.length,r=0;r<u;r++){var f=i[r];$6TB(n,f)}}function $6TB(n,t){if(t&&t.Id){var i=_e.$1X.$54(t.Id);switch(n.$OA.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$95().get_$4i().$GW(n.$A5,i);break;case"SetReadState":var r=this;$3G3(n,i,function(t,i){i.get_$1s().IsRead=n.$OA.IsRead});break;case"Flag":var u=this;$3G3(n,i,function(t,i){i.get_$1s().Flag=n.$OA.Flag});break;case"SetClutterState":var f=this;$3G3(n,i,function(t,i){i.get_$1s().IsClutter=n.$OA.IsClutter});break;default:_js.Trace.logInfo(_e.$9T.$D,"UpdateMessages: {0} not implemented in client store.",n.$OA.Action);break}}}function $3G3(n,t,i){var r=this;n.get_$95().get_$4i().$Da(n.$A5,t,function(t){if(t){i(n.$OA,t);t.$Cn(n.$A5,null)}},null)}_e.$9T.prototype={$A5:null,$OA:null,$5AX:!1,get_$Of:function(){return"ApplyConversationAction"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Df:function(n,t,i,r){this.$OA=this.get_$34X().Body.ConversationActions[n];if(this.get_$9I5()&&this.get_$9I5().isActionGlobal)$6T8(this,t,i);else{var u=null;if(this.$OA.ContextFolderId)u=this.$OA.ContextFolderId.BaseFolderId;else if(this.get_$9I5()&&this.get_$9I5().folderIdForInstanceKeysToRemoveFromPendingOperations)u=new _g.$3J(this.get_$9I5().folderIdForInstanceKeysToRemoveFromPendingOperations);else{_js.Trace.logInfo(_a.$0.$Jo,"This action {0}:{1} does not contain a valid folder id. Completing the service command without performing any real action.",this.get_$Of(),this.$OA.Action);t();return}$6T7(this,u,t,i)}}};_e.$Wt=function(n,t,i){_e.$Wt.$$(this.$$gta["_e.$Wt"].TRequest,this.$$gta["_e.$Wt"].TActionContext).initializeBase(this,[n,t]);_a.$3.$17(i,"request");_a.$3.$17(i.Header,"request.Header");_a.$3.$17(i.Header.TimeZoneContext,"request.Header.TimeZoneContext");_a.$3.$17(i.Header.TimeZoneContext.TimeZoneDefinition,"request.Header.TimeZoneContext.TimeZoneDefinition");this.$MO=i};_e.$Wt.$$=function(n,t){var i="$Wt"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$Wt"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$Wt.apply(this,r)};u.registerClass("_e."+i,_e.$5k.$$(t));var f=_e.$Wt.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$Wt.prototype={$MO:null,get_timeZone:function(){return this.$MO.Header.TimeZoneContext.TimeZoneDefinition.Id},get_$34X:function(){return this.$MO}};_e.$jZ=function(n,t,i,r,u){_e.$jZ.$$(this.$$gta["_e.$jZ"].TRequest,this.$$gta["_e.$jZ"].TActionContext).initializeBase(this,[n,t,i,r]);this.$1n=u};_e.$jZ.$$=function(n,t){var i="$jZ"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$jZ"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$jZ.apply(this,r)};u.registerClass("_e."+i,_e.$bB.$$(n,t));var f=_e.$jZ.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$jZ.prototype={$2hH_3:!1,$3zP:null,$1n:null,get_$jQ:function(){this.$3zP||(this.$3zP=this.$7O1());return this.$3zP},$9Jq:function(n,t,i,r,u){var e=null;_js.Trace.logInfo(this.$1n,"Opening transaction to move message to Outbox. {0}",this.$678);var f=this,s=this,o=this;this.$AK(function(i){if(n){_js.Trace.logInfo(f.$1n,"Getting message to move to Outbox. {0}",f.$678);f.get_$95().get_$4i().$Da(i,_e.$1X.$54(n.Id),function(n){_js.Trace.logInfo(f.$1n,"Calling getMessageToSaveCallback. {0}",f.$678);e=t(n,i);_js.Trace.logInfo(f.$1n,"Checking for existing Outbox item before save. {0}",f.$678);f.$8uf(e,n,i);_js.Trace.logInfo(f.$1n,"Deleting message from Drafts. {0}",f.$678);f.$78c(n,i);f.$4rc(e,i)},null)}else{_js.Trace.logInfo(f.$1n,"Calling getMessageToSaveCallback. {0}",f.$678);e=t(null,i);_js.Trace.logInfo(f.$1n,"Saving message to Outbox. {0}",f.$678);f.$5wN(e,null,!0,i);f.$4rc(e,i)}},function(){_js.Trace.logInfo(s.$1n,"Successfully moved message to Outbox. {0}",s.$678);s.$5ur(e);r()},function(n){_js.Trace.logInfo(o.$1n,"Reporting store error. {0}",o.$678);o.$5ur(e);o.$9I7(i,new _e.$1W(n),u)})},$9Jr:function(n,t,i,r,u){_js.Trace.logInfo(this.$1n,"Opening transaction to move Outbox item to Drafts. {0}",this.$678);var o=this,f=this,e=this;this.$AK(function(i){o.$7Wg(i,n,t)},function(){if(f.$2hH_3){_js.Trace.logInfo(f.$1n,"Generating notifications to refresh inbox count. {0}",f.$678);_e.$2a.$2hG(f.get_$jQ().$1TM.Id,null,"Reload","serviceCommand",_e.$2a.$rv,_e.$2a.$rv,!0)}_js.Trace.logInfo(f.$1n,"Successfully moved message from outbox to drafts. {0}",f.$678);r()},function(n){_js.Trace.logInfo(e.$1n,"Reporting store error {0}. {1}",n.$4P,e.$678);e.$9I7(i,new _e.$1W(n),u)})},$9Js:function(n){var u=10;var e="; ";var f;var t="";f=n?n.length<=u?n.length:u:0;for(var i=0;i<=f-1;i++){var r=n[i].Name;if(r&&r.length>0){var o=t.length?e:"";t+=o+r}}return t},$7Wg:function(n,t,i){_js.Trace.logInfo(this.$1n,"Getting OutboxItem for move back to Drafts. {0}",this.$678);var r=this;this.get_$95().get_$ch().$Da(n,_e.$1X.$54(this.get_$jQ().$MH.Id),function(u){var e=null;var o=null;var s=null;if(u){e=u.get_$1s().NormalizedBody;o=u.get_$1s().UniqueBody;s=u.get_$1s().Preview;_js.Trace.logInfo(r.$1n,"Deleting OutboxItem. {0}",r.$678);r.get_$4i().$1ij(n,null,"HardDelete",u,null,r.get_$5HW(),!0)}else _js.Trace.logWarning(_e.$1a.$D,"Outbox item with id {0} was not found in the client store. {1}",r.get_$jQ().$MH.Id,r.$678);_js.Trace.logInfo(r.$1n,"Calling getMessageToSaveCallback. {0}",r.$678);var f=t(n);f.get_$1s().NormalizedBody=e;f.get_$1s().UniqueBody=o;f.get_$1s().Preview=s;if(i){_js.Trace.logInfo(r.$1n,"Saving item to drafts. {0}",r.$678);r.$35S(f,!0,n)}else{_js.Trace.logInfo(r.$1n,"Checking for existing draft before save. {0}",r.$678);r.$8ug(f,n)}},null)},$5wP:function(n,t,i){this.$8zc(n,t);n.$Cn(i,null)},$8zc:function(n,t){n.$7Uz(this.$7Ny(),t,this.$7NL(),"NoError");var i=n.get_$1s();i.IsRead=!0},$5ur:function(n){if(n){n.$8qW();_a.$1U.$9Iv(_g.$9d,n.get_$1s()).IsRead=undefined}},$8uf:function(n,t,i){var r=this;this.get_$95().get_$ch().$Da(i,_e.$1X.$54(n.get_$1s().ItemId.Id),function(u){var f=!1;u?_js.Trace.logWarning(r.$1n,"Message from Drafts is already in the Outbox. Folder count won't be incremented since message will be replaced. {0}",r.$678):f=!0;r.$5wN(n,t,f,i)},null)},$5wN:function(n,t,i,r){_js.Trace.logInfo(this.$1n,"Moving to outbox: Id="+(n.get_$1y()?n.get_$1y().toString():"null")+"; ItemId="+(n.get_$1s()?JsonParser.serialize(n.get_$1s().ItemId):"null")+"; Subject="+(n.get_$1s()?n.get_$1s().Subject:"null"));if(t&&t.get_$1s().ConversationId){var f=t.get_$1s();_js.Trace.logInfo(this.$1n,"Removing item part from conversation for conversation id={0}. {1}",f.ConversationId.Id,this.$678);var u=this;this.get_$Hh().$44A(r,f.ConversationId,f.ParentFolderId,f,this.get_$5HW(),function(t){_js.Trace.logInfo(u.$1n,"Removed item part from conversation. ParentConversationNodeId={0}. {1}",t||"null",u.$678);_js.Trace.logInfo(u.$1n,"Saving item to Outbox. {0}",u.$678);u.$5wP(n,t,r)})}else{_js.Trace.logInfo(this.$1n,"Saving item to Outbox. {0}",this.$678);this.$5wP(n,null,r)}if(i){_js.Trace.logInfo(this.$1n,"Incrementing Outbox folder count. {0}",this.$678);this.get_$95().get_$2j().$2Bh(r,n.get_$1s().ParentFolderId,1,0)}},$78c:function(n,t){if(n){_js.Trace.logInfo(this.$1n,"Draft message found - deleting from Drafts. {0}",this.$678);this.get_$4i().$1ij(t,this.get_$Hh(),"HardDelete",n,null,this.get_$5HW(),!0)}else _js.Trace.logInfo(this.$1n,"Draft message not found. {0}",this.$678)},$4rc:function(n,t){if(n&&n.get_$1s()&&_e.$16.$58u(n.get_$1s().__type)){var i=n.get_$1s();if(i.ReferenceItemId&&i.ReferenceItemId.__type===_g.$1j._dataContractName){_js.Trace.logInfo(this.$1n,"Deleting approval request message with id {0}. {1}",i.ReferenceItemId.Id,this.$678);this.get_$4i().$3UF(t,this.get_$Hh(),"HardDelete",i.ReferenceItemId,null,this.get_$5HW())}}},$8ug:function(n,t){var i=this;this.get_$95().get_$4i().$Da(t,_e.$1X.$54(n.get_$1s().ItemId.Id),function(r){if(r)if(r.get_$1s().ConversationId){_js.Trace.logInfo(i.$1n,"Draft message with id {0} was found in the client store. Removing from conversation {1}",n.get_$1s().ItemId.Id,i.$678);var u=r.get_$1s();i.get_$Hh().$44A(t,u.ConversationId,u.ParentFolderId,u,i.get_$5HW(),function(r){_js.Trace.logInfo(i.$1n,"RemoveItemPartFromConversation success callback. {0}",i.$678);i.$35S(n,!1,t)})}else{_js.Trace.logInfo(i.$1n,"Draft message with id {0} was found in the client store. It does not have a ConversationId. {1}",n.get_$1s().ItemId.Id,i.$678);i.$35S(n,!1,t)}else{_js.Trace.logInfo(i.$1n,"Draft message with id {0} was not found in the client store. {1}",n.get_$1s().ItemId.Id,i.$678);i.$35S(n,!0,t)}},null)},$35S:function(n,t,i){_js.Trace.logInfo(this.$1n,"Saving to Drafts via update: Id={0}; ItemId={1}; Subject={2}. {3}",n.get_$1y()?n.get_$1y().toString():"null",n.get_$1s()?JsonParser.serialize(n.get_$1s().ItemId):"null",n.get_$1s()?n.get_$1s().Subject:"null",this.$678);n.$Cn(i,null);if(t){_js.Trace.logInfo(this.$1n,"Increment drafts folder count after message is moved to drafts. {0}",this.$678);this.get_$95().get_$2j().$2Bh(i,n.get_$1s().ParentFolderId,1,0)}if(!!(!!this.get_$jQ().$Be&!!this.get_$jQ().$VR)){_js.Trace.logInfo(this.$1n,"Adding item to conversation. {0}",this.$678);this.$6qL(i,n.get_$1s())}},$6qL:function(n,t){if(!this.get_$jQ().$VR){_js.Trace.logInfo(this.$1n,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var i=this;this.get_$Hh().$4dx(n,this.get_$jQ().$Be,t,this.get_$jQ().$VR,this.get_$jQ().$2pC,this.get_$5HW(),function(n){if(n){_js.Trace.logInfo(i.$1n,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$jQ().$Be.Id,i.get_$jQ().$VR);i.$2hH_3=!0}else _js.Trace.logInfo(i.$1n,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$jQ().$Be.Id,i.get_$jQ().$VR)})}};_e.$Mb=function(n,t,i){_e.$Mb.initializeBase(this,[n,t,i,i.Body.Attachments.length]);this.get_$9I5().parentItemId=this.get_$34X().Body.ParentItemId;this.get_$9I5().attachmentIds=new Array(this.get_$9Jf());this.$CW=new _g.$Wl;this.$CW.ResponseCode="NoError";this.$CW.ResponseClass="Success";this.$CW.Attachments=new Array(this.get_$9Jf());this.$2n=new _g.$QP;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=[this.$CW]};_e.$Mb.$4FI=function(n,t){var i=n;$8(i.Attachments)&&(i.Attachments=[]);i.HasAttachments=!0;Array.add(i.Attachments,t)};_e.$Mb.prototype={$2n:null,$CW:null,get_$Of:function(){return"CreateAttachment"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Df:function(n,t,i,r){if(this.get_$9I5().clientStoreItem===2){var u=this.get_$34X().Body.Attachments[n];var f=this.get_$34X().Body.ParentItemId;var s=new _bc.$BG;var e=s.get_$40();this.get_$9I5().attachmentIds[n]=e;u.AttachmentId=new _g.$DW(e.Id);this.$CW.Attachments[n]=u;var o=this,h=this,c=this;this.$AK(function(n){o.get_$95().get_$4i().$4FI(n,o.get_$95().get_$57().$el(f.Id),u)},function(){_js.Trace.logInfo(_e.$Mb.$D,"Successfully updated message with server id {0} in local store.",f.Id);u.AttachmentId.RootItemId=f.Id;u.AttachmentId.RootItemChangeKey=f.ChangeKey;t()},function(n){_e.$1W.$BC(n,i)})}else{_js.Trace.logWarning(_e.$Mb.$D,"ClientStoreItem type {0} is not supported.",this.get_$9I5().clientStoreItem);t();return}}};_e.$16=function(n,t,i){this.$2No=null;this.$Iw=0;_e.$16.initializeBase(this,[n,t,i,i.Body.Items.length,_e.$16.$D]);this.get_$9I5().itemIds=new Array(i.Body.Items.length);this.get_$9I5().uIds=new Array(i.Body.Items.length);this.get_$9I5().createdCalendarItemIds=new Array(i.Body.Items.length);this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$QR;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};_e.$16.$47n=function(n,t,i){var r=null;$8(i)?t&&t.BodyType==="Text"&&!$8(t.Value)&&(r=t.Value):r=i;if(!$8(r)){var f=_a.$1T.$he(r,!0);var u=new _g.$67("HTML",f);n.NormalizedBody=u;n.UniqueBody=u;n.Preview=r}};_e.$16.$1oX=function(n){return n===_g.$H2._dataContractName||n===_g.$G0._dataContractName||n===_g.$Fb._dataContractName||n===_g.$GJ._dataContractName};_e.$16.$58u=function(n){return n===_g.$Jk._dataContractName||n===_g.$Nc._dataContractName};_e.$16.$7aX=function(n){return n===_g.$L1._dataContractName||n===_g.$LP._dataContractName||n===_g.$MH._dataContractName};_e.$16.$1Sh=function(n,t,i,r){t.val=n.__type===_g.$L1._dataContractName;i.val=n.__type===_g.$MH._dataContractName;r.val=n.__type===_g.$LP._dataContractName};function $6UD(n,t,i,r,u){_js.Trace.logInfo(_e.$16.$D,"ExecuteMessageItemStep");if(n.get_$9I5()&&n.get_$9I5().explicitLogonUser){_js.Trace.logInfo(_e.$16.$D,"MessageRequest - operations on this mailbox is not supported in offline: {0}",n.get_$9I5().explicitLogonUser);n.$70=!0;n.$Iw=17;r();return}_a.$3.$M(n.get_$9I5().parentFolderId,"ParentFolderId");$6UK(n,t);n.$9Jg(t.ItemId);n.get_$34X().Body.MessageDisposition==="SaveOnly"&&(n.$8R[i].Items[0].ItemId=t.ItemId);var e=!1;var f=null;if(_e.$16.$1oX(t.__type)){e=!0;f=t}if(n.get_$34X().Body.MessageDisposition==="SendAndSaveCopy"){var o=null;var s=null;if(e){var h=this;o=function(t,r){n.get_$9I5().itemIds[i]=f.ItemId;t&&(f.ConversationId=t.get_$1s().ConversationId);return n.get_$95().get_$ch().$lp(f)};s=f.UpdateResponseItemId}else{var c=this;o=function(r,u){var f=n.get_$95().get_$ch().$lp(t);n.get_$9I5().itemIds[i]=t.ItemId;return f}}_js.Trace.logInfo(_e.$16.$D,"Moving item to Outbox. {0}",n.$678);var l=this,a=this;n.$9Jq(s,o,n.$8R[i],function(){$1Bz(n,t);r()},function(i){$1Bz(n,t);u(i)})}else if(n.get_$9I5().outboxItemId){_js.Trace.logInfo(_e.$16.$D,"Moving a message from Outbox back to Drafts. {0}",n.$678);var v=this,y=this,p=this;n.$9Jr(function(r){var u=n.get_$95().get_$4i().$lp(t);n.get_$9I5().itemIds[i]=t.ItemId;return u},!e,n.$8R[i],function(){$1Bz(n,t);r()},function(i){$1Bz(n,t);u(i)})}else if(e){_js.Trace.logInfo(_e.$16.$D,"Creating a SmartResponse for ReferenceItemId={0}. {1}",JsonParser.serialize(f.ReferenceItemId),n.$678);if(f.UpdateResponseItemId)if(n.get_$34X().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$16.$D,"Updating an existing SmartResponse. {0}",n.$678);$6UL(n,f,i,r,u)}else throw Error.invalidOperation("Unknown SmartResponse operation.");else{_js.Trace.logInfo(_e.$16.$D,"Creating a SmartResponse in Drafts. {0}",n.$678);$4QO(n,t,i,r,u)}}else{_js.Trace.logInfo(_e.$16.$D,"Creating a message in the Drafts or Outbox. {0}",n.$678);$4QO(n,t,i,r,u)}}function $4QN(n,t,i){if(!$8(n.get_$9I5().clientStoreBodyValue)){n.$34u=t.val.Value;n.$2No=t.val.BodyType;t.val=new _g.$67(i,n.get_$9I5().clientStoreBodyValue);n.get_$9I5().clientStoreBodyValue=null}}function $6UL(n,t,i,r,u){n.get_$9I5().itemIds[i]=t.UpdateResponseItemId;_js.Trace.logInfo(_e.$16.$D,"Opening transaction to update a SmartResponse. {0}",n.$678);var f=this,e=this,o=this;n.$9I8(new _a.$6L("CreateItem.UpdateSmartResponse",!1),function(i){_js.Trace.logInfo(_e.$16.$D,"Updating SmartResponse. {0}",n.$678);n.get_$95().get_$4i().$1BX(i,_e.$1X.$54(t.ItemId.Id),function(i){if($8(i)){_js.Trace.logWarning(_e.$16.$D,"Message with id {0} not found in local store",t.ItemId.Id);return}_js.Trace.logInfo(_e.$16.$D,"Retrieved SmartResponse from the local store for update. {0}",n.$678);var r=i;r.__type=t.__type;r.ReferenceItemId=t.ReferenceItemId;r.NewBodyContent=t.NewBodyContent;r.BccRecipients=t.BccRecipients;r.CcRecipients=t.CcRecipients;r.ToRecipients=t.ToRecipients;r.From=t.From;r.Subject=t.Subject;r.Importance=t.Importance;r.NormalizedBody=t.NormalizedBody;r.UniqueBody=r.NormalizedBody;r.Preview=t.Preview;r.RightsManagementLicenseData=t.RightsManagementLicenseData;if(t.ExtendedProperty)for(var e=0;e<t.ExtendedProperty.length;e++){var f=t.ExtendedProperty[e];var u=f.ExtendedFieldURI;u.DistinguishedPropertySetId==="Common"&&(u.PropertyId===34229?_e.$3s.$S3(r,u,f.Value):u.PropertyId===34232?_e.$3s.$S3(r,u,f.Value):u.PropertyId===34230?_e.$3s.$S3(r,u,f.Value):u.PropertyId===34231&&_e.$3s.$S3(r,u,f.Value))}_js.Trace.logInfo(_e.$16.$D,"Smart response with updates going to client store via create: ReferenceItemId={0}; Subject={1}. {2}",JsonParser.serialize(r.ReferenceItemId),r.Subject,n.$678)})},function(){_js.Trace.logInfo(_e.$16.$D,"Successfully updated message in local store. {0}",n.$678);$1Bz(n,t);r()},function(i){_js.Trace.logInfo(_e.$16.$D,"Reporting store error. {0}",n.$678);$1Bz(n,t);_e.$1W.$BC(i,u)})}function $4QO(n,t,i,r,u){var f=n.get_$95().get_$4i().$lp(t);n.get_$9I5().itemIds[i]=t.ItemId;var e=null;_js.Trace.logInfo(_e.$16.$D,"Opening transaction to save message item via create. Id={0}; Subject={1}; {2}",f.get_$1y()?f.get_$1y().toString():"null",t.Subject,n.$678);var o=this,s=this,h=this;n.$AK(function(i){_js.Trace.logInfo(_e.$16.$D,"Saving item. {0}",n.$678);f.$Cn(i,function(n){e=n});_js.Trace.logInfo(_e.$16.$D,"Incrementing folder count. {0}",n.$678);n.get_$95().get_$2j().$2Bh(i,t.ParentFolderId,1,0);if(_e.$16.$1oX(t.__type)&&n.get_$34X().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$16.$D,"Adding item (SmartResponse) to conversation. {0}",n.$678);$6UA(n,i,t)}},function(){_js.Trace.logInfo(_e.$16.$D,"Successfully created message in local store id={0}. {1}",e,n.$678);$1Bz(n,t);if(n.$2hH){_js.Trace.logInfo(_e.$16.$D,"Generating notifications to refresh inbox count. {0}",n.$678);_e.$2a.$2hG(n.get_$9I5().inboxFolderId.Id,null,"Reload","serviceCommand",_e.$2a.$rv,_e.$2a.$rv,!0)}_js.Trace.logInfo(_e.$16.$D,"Calling succeededCallback. {0}",n.$678);r()},function(r){_js.Trace.logInfo(_e.$16.$D,"Reporting store error {0}. {1}",r.$4P,n.$678);$1Bz(n,t);n.$9I7(n.$8R[i],new _e.$1W(r),u)})}function $6UA(n,t,i){if(!n.get_$9I5().parentConversationNodeId){_js.Trace.logInfo(_e.$16.$D,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var r=this;n.get_$Hh().$4dx(t,n.get_$9I5().conversationId,i,n.get_$9I5().parentConversationNodeId,n.get_$9I5().itemPartsOrderDescending,n.get_$5HW(),function(t){if(t){_js.Trace.logInfo(_e.$16.$D,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$9I5().conversationId.Id,n.get_$9I5().parentConversationNodeId);n.$2hH=!0}else _js.Trace.logInfo(_e.$16.$D,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$9I5().conversationId.Id,n.get_$9I5().parentConversationNodeId)})}function $6UB(n,t,i,r,u){var f=t;if($6UH(n,f)){n.$70=!0;n.$Iw=1;r()}else if(f.Recurrence){n.$70=!0;n.$Iw=2;r()}else if($6UG(n,f)){n.$70=!0;n.$Iw=10;r()}else{var e=this,o=this;n.get_$9I4().$7Zw(f.Start,f.End,function(){var t=_0365f.$2t.$46(f,!0,!0);t.ParentFolderId||(t.ParentFolderId=n.get_$9I5().calendarFolderId);$6UJ(n,t,i,r,u)},function(){n.$70=!0;n.$Iw=11;r()})}}function $6UG(n,t){return!!t.ParentFolderId&&t.ParentFolderId.Id!==n.get_$9I5().calendarFolderId.Id||!!n.get_$34X().Body.SavedItemFolderId&&n.get_$34X().Body.SavedItemFolderId.BaseFolderId.__type===_g.$3J._dataContractName&&n.get_$34X().Body.SavedItemFolderId.BaseFolderId.Id!==n.get_$9I5().calendarFolderId.Id}function $6UK(n,t){var r=_e.$16.$1oX(t.__type);var i=r?t:null;var u=new _bc.$BG;t.InstanceKey=u.get_$DH();t.ItemId=r&&i.UpdateResponseItemId?i.UpdateResponseItemId:u.$5J;n.get_$34X().Body.MessageDisposition==="SendAndSaveCopy"&&(t.ItemId=_bc.OutboxItemContext.$4nX(t.ItemId,_e.$16.$D));t.DateTimeCreated=_a.$7.$Eb(_a.$7.get_$2M());t.DateTimeReceived=t.DateTimeCreated;t.ParentFolderId=n.get_$9I5().parentFolderId;var o=r?i.NewBodyContent:null;var s=n.get_$9I5().bodySubstring||"";_e.$16.$47n(t,o,s);if(r){var f;$4QN(n,f={val:i.NewBodyContent},i.NewBodyContent.BodyType);i.NewBodyContent=f.val}else{var e;$4QN(n,e={val:t.Body},"Text");t.Body=e.val}n.get_$34X().Body.MessageDisposition==="SaveOnly"&&(t.IsDraft=!0);t.RightsManagementLicenseData=n.get_$9I5().rightsManagementLicenseData;n.get_$9I5().conversationId&&(t.ConversationId=n.get_$9I5().conversationId);_e.$16.$58u(t.__type)&&(t.ItemClass=t.__type===_g.$Jk._dataContractName?"IPM.Note.Microsoft.Approval.Reply.Approve":"IPM.Note.Microsoft.Approval.Reply.Reject");t.DisplayTo=n.$9Js(t.ToRecipients)}function $1Bz(n,t){t.ItemId=undefined;t.InstanceKey=undefined;t.DateTimeCreated=undefined;t.DateTimeReceived=undefined;t.ParentFolderId=undefined;t.NormalizedBody=undefined;t.UniqueBody=undefined;t.Preview=undefined;t.IsDraft=undefined;t.ConversationId=undefined;t.InternetMessageId=undefined;t.ItemClass=undefined;t.DisplayTo=undefined;n.$34u&&(_e.$16.$1oX(t.__type)?t.NewBodyContent.Value=n.$34u:t.Body.Value=n.$34u);n.$2No!==null&&(_e.$16.$1oX(t.__type)?t.NewBodyContent.BodyType=n.$2No:t.Body.BodyType=n.$2No);t.RightsManagementLicenseData=undefined}function $6UJ(n,t,i,r,u){var e=new _bc.$BG;var f=e.$5J;$4QJ(n,t);t.ItemId=f;t.UID=e.get_$12V();t.IsMeeting=!1;t.HasAttachments=!1;t.ResponseType="Organizer";t.IsOrganizer=!0;t.ResponseObjects=new Array(1);t.ResponseObjects[0]=new _g.$G0;t.Organizer=new _g.$Bk;t.Organizer.Mailbox=new _g.$1m;t.Organizer.Mailbox.EmailAddress=n.get_$9I5().userEmailAddress;t.Organizer.Mailbox.Name=n.get_$9I5().userDisplayName;t.Organizer.Mailbox.RoutingType="SMTP";t.Organizer.Mailbox.MailboxType="Mailbox";t.StartWallClock=t.Start;t.StartTimeZoneId=n.get_$34X().Header.TimeZoneContext.TimeZoneDefinition.Id;t.EndWallClock=t.End;t.EndTimeZoneId=n.get_$34X().Header.TimeZoneContext.TimeZoneDefinition.Id;_e.$9V.$41x(t);var o=n.get_$95().get_$1o().$lp(t);var s=this,h=this,c=this;n.$AK(function(i){o.$Cn(i,function(r){_js.Trace.logInfo(_e.$16.$D,"Successfully created calendar item with id {0} to local store.",r.toString());if(t.ReminderIsSet){_js.Trace.logInfo(_e.$16.$D,"A reminder is set on calendar item with Id {0}. Creating a reminder.",f.Id);n.get_$9I4().$45u(i,t,f,function(n){_js.Trace.logInfo(_e.$16.$D,"Successfully created reminder for calendar item with id {0} to local store.",r.toString())})}})},function(){_js.Trace.logInfo(_e.$16.$D,"Successfully created calendar item and reminder with id {0} to local store.",f);n.$8R[i].Items[0].ItemId=f;n.get_$9I5().itemIds[i]=f;n.get_$9I5().uIds[i]=e.get_$12V();r()},function(t){n.$9I7(n.$8R[i],new _e.$1W(t),u)})}function $6UH(n,t){return!$8(t.RequiredAttendees)&&t.RequiredAttendees.length>0||!$8(t.OptionalAttendees)&&t.OptionalAttendees.length>0}function $6UC(n,t,i,r,u){if(!_e.$16.$7aX(t.__type)){_js.Trace.logWarning(_e.$16.$D,"MeetingRequest - Response type not support in offline: {0}",t.__type);n.$70=!0;n.$Iw=15;r();return}var f=t;var h,c,l;var a,v,y;_e.$16.$1Sh(f,a={val:h},v={val:c},y={val:l});h=a.val;c=v.val;l=y.val;if(f.ReferenceItemId.__type!==_g.$1j._dataContractName&&f.ReferenceItemId.__type!==_g.$78._dataContractName){n.$70=!0;n.$Iw=14;r();return}var e=f.ReferenceItemId;var s=_a.$7.$Eb(_a.$7.get_$2M());if(n.get_$9I5().isReferencedItemMeetingRequest){n.$8R[i].Items=new Array(3);var o=_e.$1X.$54(e.Id);var p=this,w=this,b=this;n.$AK(function(t){n.get_$95().get_$4i().$Da(t,o,function(r){if($8(r)||$8(r.get_$1s())){_js.Trace.logWarning(_e.$16.$D,"MeetingRequest - Message with id {0} not found in local store",o);n.$70=!0;return}var u=r.get_$1s();if(u.IsDelegated){_js.Trace.logInfo(_e.$16.$D,"MeetingRequest - Message with id {0} is delegated and will not be processed by offline service command",o);n.$70=!0;n.$Iw=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$16.$D,"MeetingRequest - Message with id {0} is out of date and should not be used to respond to a meeting request",o);return}u.ResponseType=$4QL(n,f);u.FreeBusyType=$4QK(n,f,u.IntendedFreeBusyStatus);u.AppointmentReplyTime=s;var e=new _g.$JJ;e.ItemId=u.ItemId;n.$8R[i].Items[2]=e;n.get_$4i().$1ij(t,n.get_$Hh(),"MoveToDeletedItems",r,n.get_$9I5().deletedItemsFolderId,n.get_$5HW());$6UI(n,t,i,r,f,s)},null)},function(){_js.Trace.logInfo(_e.$16.$D,"Successfully responded to message with id {0}.",o);r()},function(t){if(n.$70&&t.$SU===5)u(new _e.$1W(t));else{_js.Trace.logError(_e.$16.$D,"MeetingRequest - Error while processing message with id:{0}. Error: {1}",o,t.$4P);n.$9I7(n.$8R[i],new _e.$1W(t),u)}})}else{n.$8R[i].Items=new Array(2);var k=this,d=this,g=this;n.$AK(function(t){e.__type===_g.$78._dataContractName?n.get_$9I4().$50v(t,e,function(r){_e.$Ch.$3N8(t,n.get_$95().get_$hL(),r,function(u){if(!u||!u.get_$1s()){_js.Trace.logWarning(_e.$16.$D,"MeetingRequest - Calendar master item with uid {0} could not be found in client store.",r);n.$70=!0;return}_js.Trace.logInfo(_e.$16.$D,"MeetingRequest - Calendar master item with uid {0} found in client store.",r);$4QS(n,t,i,u,f,s);$6UF(n,f,u)})},function(){n.$70=!0}):$4QM(n,t,_e.$1X.$54(e.Id),i,f,s,null)},function(){e.__type===_g.$78._dataContractName?_js.Trace.logInfo(_e.$16.$D,"Successfully responded to calendar master item with occurrence id {0}.",e.OccurrenceId):_js.Trace.logInfo(_e.$16.$D,"Successfully responded to calendar item with id {0}.",e.Id);r()},function(t){if(n.$70&&t.$SU===5)u(new _e.$1W(t));else{e.__type===_g.$78._dataContractName?_js.Trace.logError(_e.$16.$D,"MeetingRequest - Error while processing calendar master item with ocurrence id:{0}. Error: {1}",e.OccurrenceId,t.$4P):_js.Trace.logError(_e.$16.$D,"MeetingRequest - Error while processing calendar item with id:{0}. Error: {1}",e.Id,t.$4P);n.$9I7(n.$8R[i],new _e.$1W(t),u)}})}}function $6UI(n,t,i,r,u,f){var e=r.get_$1s();if($8(e.AssociatedCalendarItemId)||$8(e.AssociatedCalendarItemId.Id)){if(e.CalendarItemType!=="Single"){var o=String.format("MeetingRequest: No associated calendar item found in meeting request. Cannot create recurring meeting calendar item for the recurring meeting request with id {0}. The call should be forwarded to online proxy. Rolling back.",e.ItemId.Id);_js.Trace.logWarning(_e.$16.$D,o);n.$70=!0;n.$Iw=4;t.$2WJ();return}$4QH(n,t,i,r,u,f,!1)}else{var s=_e.$1X.$54(e.AssociatedCalendarItemId.Id);$4QM(n,t,s,i,u,f,r)}}function $4QM(n,t,i,r,u,f,e){if(n.get_$9I5().referencedCalendarItemType==="RecurringMaster"){var o=this;n.get_$95().get_$hL().$Da(t,i,function(e){if($8(e)||$8(e.get_$1s()))if(n.get_$9I5().isReferencedItemMeetingRequest){var o=String.format("MeetingRequest: Recurring master with id {0} not found. Cannot create recurring meeting calendar item for a recurring meeting request. The call should be forwarded to online proxy. Rolling back.",i);_js.Trace.logWarning(_e.$16.$D,o);n.$70=!0;n.$Iw=4;t.$2WJ();return}else{_js.Trace.logWarning(_e.$16.$D,"MeetingRequest: Recurring master with id {0} not found in local store.",i);n.$70=!0;return}$4QS(n,t,r,e,u,f)},null)}else{var s=this;n.get_$95().get_$1o().$Da(t,i,function(o){if($8(o)||$8(o.get_$1s())){if(n.get_$9I5().isReferencedItemMeetingRequest&&n.get_$9I5().referencedCalendarItemType==="Single"){_js.Trace.logWarning(_e.$16.$D,"MeetingRequest - Calendar with id {0} not found in local store, creating one while sync doesn't happen.",i);$4QH(n,t,r,e,u,f,!0)}else{_js.Trace.logWarning(_e.$16.$D,"MeetingRequest - Calendar with id {0} not found in local store",i);n.$70=!0}return}$4QP(n,t,r,o,u,f)},null)}}function $4QJ(n,t){var i=new _g.$OH;i.CreateAssociated=!1;i.CreateContents=!1;i.CreateHierarchy=!1;i.Delete=!0;i.Modify=!0;i.Read=!0;i.ViewPrivateItems=!0;t.EffectiveRights=i;t.CalendarItemType="Single";t.IsCancelled=!1}function $4QH(n,t,i,r,u,f,e){var s=r.get_$1s();var o=new _g.$6P;$4QJ(n,o);var c=new _bc.$BG;var h;h=e?s.AssociatedCalendarItemId:c.$5J;o.ParentFolderId=n.get_$9I5().calendarFolderId;o.ItemId=h;o.UID=c.get_$12V();o.ResponseType=s.ResponseType;o.Start=s.Start;o.End=s.End;o.ResponseObjects=s.ResponseObjects;o.IsResponseRequested=s.IsResponseRequested;o.ConversationId=s.ConversationId;o.Subject=s.Subject;o.IsMeeting=!0;o.Organizer=s.From;o.IsOrganizer=s.IsOrganizer;o.Location=s.Location;o.HasAttachments=s.HasAttachments;o.Body=s.UniqueBody;o.ReminderIsSet=!0;o.ReminderMinutesBeforeStart=5;o.StartWallClock=s.StartWallClock;o.StartTimeZoneId=s.StartTimeZoneId;o.EndWallClock=s.EndWallClock;o.EndTimeZoneId=s.EndTimeZoneId;_e.$9V.$41x(o);var l=n.get_$95().get_$1o().$lp(o);var a=this;l.$Cn(t,function(a){_js.Trace.logInfo(_e.$16.$D,"Successfully created calendar item with id {0} to local store.",a.toString());n.get_$9I5().createdCalendarItemIds[i]=h;n.get_$9I5().uIds[i]=c.get_$12V();var v=new _g.$6P;v.ItemId=h;n.$8R[i].Items[0]=v;if(o.ReminderIsSet){_js.Trace.logInfo(_e.$16.$D,"A reminder is set on calendar item with Id {0}. Creating a reminder.",h.Id);n.get_$9I4().$45u(t,o,h,function(n){_js.Trace.logInfo(_e.$16.$D,"Successfully created reminder for calendar item with id {0} to local store.",a.toString())})}if(!e){_js.Trace.logInfo(_e.$16.$D,"Created calendar item without associated calendar item id. Updating meeting request with new value.");s.AssociatedCalendarItemId=o.ItemId;r.$Cn(t,function(n){_js.Trace.logInfo(_e.$16.$D,"Successfully updated meeting request {0} with new Associated calendar item id {1}.",n,s.AssociatedCalendarItemId.Id)})}$4QP(n,t,i,l,u,f)})}function $4QS(n,t,i,r,u,f){var o,s,h;var c,l,a;_e.$16.$1Sh(u,c={val:o},l={val:s},a={val:h});o=c.val;s=l.val;h=a.val;var e=r.get_$1s();var v=new _g.$6P;v.ItemId=e.ItemId;n.$8R[i].Items[0]=v;$4QR(n,e,u,f);if(o||s){var y=this;_e.$5f.$6uZ(t,n.get_$95().get_$1o(),e.UID,function(i,r){var e=i.get_$1s();(e.CalendarItemType==="Occurrence"||h)&&$4QQ(n,t,i,u,f)});var p=this;r.$Cn(t,function(n){_js.Trace.logInfo(_e.$16.$D,"Successfully updated calendar master item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$16.$D,"Response is declient, deleting occurrences/exceptions and reminders for master item with id {0}.",r.get_$1y());n.get_$9I4().$3U5(t,r.get_$1y(),r.get_$1s());_js.Trace.logInfo(_e.$16.$D,"Response is decline, deleting calendar master item with id {0}.",r.get_$1y());n.get_$95().get_$hL().$GW(t,r.get_$1y())}$4QI(n,t,i,e,u,f)}function $4QP(n,t,i,r,u,f){var e=r.get_$1s();var o=new _g.$6P;o.ItemId=e.ItemId;n.$8R[i].Items[0]=o;$4QQ(n,t,r,u,f);$4QI(n,t,i,e,u,f)}function $4QQ(n,t,i,r,u){var f,e,o;var s,h,c;_e.$16.$1Sh(r,s={val:f},h={val:e},c={val:o});f=s.val;e=h.val;o=c.val;var l=i.get_$1s();$4QR(n,l,r,u);if(f||e){var a=this;i.$Cn(t,function(n){_js.Trace.logInfo(_e.$16.$D,"Successfully updated calendar item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$16.$D,"Response is decline, deleting calendar item with id {0}.",i.get_$1y());n.get_$95().get_$1o().$GW(t,i.get_$1y());_js.Trace.logInfo(_e.$16.$D,"Response is decline, deleting reminder with id {0}.",i.get_$1y());n.get_$95().get_$jj().$GW(t,i.get_$1y())}}function $4QR(n,t,i,r){n.get_$9I5().referencedCalendarItemType!=="RecurringMaster"&&i.ReferenceItemId.__type!==_g.$78._dataContractName&&t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception");t.ResponseType=$4QL(n,i);t.FreeBusyType=$4QK(n,i,t.IntendedFreeBusyStatus);t.AppointmentReplyTime=r}function $4QI(n,t,i,r,u,f){var l=!1;var h,c,a;var v,y,p;_e.$16.$1Sh(u,v={val:h},y={val:c},p={val:a});h=v.val;c=y.val;a=p.val;var e=new _g.$IR;var w=new _bc.$BG;var b=w.$5J;_js.Trace.logInfo(_e.$16.$D,"Create meeting response called. Populating properties.");e.ItemId=b;e.InstanceKey=w.get_$DH();e.DateTimeCreated=f;e.DateTimeReceived=f;e.LastModifiedTime=f;e.Start=r.Start;e.End=r.End;e.Location=r.Location;e.Sensitivity=r.Sensitivity;e.Importance=r.Importance;e.AssociatedCalendarItemId=r.ItemId;e.Body=r.Body;e.ToRecipients=[r.Organizer.Mailbox];var o=new _g.$Bk;o.Mailbox=new _g.$1m;o.Mailbox.EmailAddress=n.get_$9I5().userEmailAddress;o.Mailbox.Name=n.get_$9I5().userDisplayName;o.Mailbox.RoutingType="SMTP";o.Mailbox.MailboxType="Mailbox";e.From=o;e.Sender=o;e.IsRead=!0;e.HasAttachments=!1;if(n.get_$34X().Body.MessageDisposition==="SaveOnly"){e.IsDraft=!0;e.ParentFolderId=n.get_$9I5().draftsFolderId}else{e.IsDraft=!1;e.ParentFolderId=n.get_$9I5().outboxFolderId;l=!0}e.ResponseType=r.ResponseType;var s;if(h){e.ItemClass="IPM.Schedule.Meeting.Resp.Pos";s=_u.Strings.l_AcceptForResponseMessageSubject_Text}else if(c){e.ItemClass="IPM.Schedule.Meeting.Resp.Tent";s=_u.Strings.l_TentativeForResponseMessageSubject_Text}else{e.ItemClass="IPM.Schedule.Meeting.Resp.Neg";s=_u.Strings.l_DeclineForResponseMessageSubject_Text}e.Subject=s+r.Subject;e.ResponseObjects=[new _g.$GJ,new _g.$Fb,new _g.$G0];var k;k=l?n.get_$95().get_$ch().$lp(e):n.get_$95().get_$4i().$lp(e);_js.Trace.logInfo(_e.$16.$D,"Saving meeting response with id {0} into client store.",e.ItemId.Id);var d=this;k.$Cn(t,function(r){_js.Trace.logInfo(_e.$16.$D,"Successfully saved meeting response with id {0} into client store.",e.ItemId.Id);var u=new _g.$IR;u.ItemId=e.ItemId;n.$8R[i].Items[1]=u;n.get_$9I5().itemIds[i]=b;n.get_$95().get_$2j().$2Bh(t,e.ParentFolderId,1,0)})}function $4QL(n,t){var i=null;var r,u,f;var e,o,s;_e.$16.$1Sh(t,e={val:r},o={val:u},s={val:f});r=e.val;u=o.val;f=s.val;if(r)i="Accept";else if(u)i="Tentative";else if(f)i="Decline";else throw Error.argumentType("responseItem has invalid response type");return i}function $4QK(n,t,i){var r=null;$8(i)&&(i="NoData");var u,f,e;var o,s,h;_e.$16.$1Sh(t,o={val:u},s={val:f},h={val:e});u=o.val;f=s.val;e=h.val;if(f)r=i==="Free"?"Free":"Tentative";else if(u)r=i==="NoData"?"Busy":i;else if(e)r="Free";else throw Error.argumentType("responseItem has invalid response type");return r}function $6UF(n,t,i){var u=t.ReferenceItemId;_js.Trace.logInfo(_e.$16.$D,"MeetingRequest - Filling Conflict Info for master for occurrence with id {0}",u.OccurrenceId);var r=i.get_$1s();t.AdditionalInfo||(t.AdditionalInfo=new _g.$Ur);t.AdditionalInfo.Organizer=r.Organizer;t.AdditionalInfo.Start=r.Start;t.AdditionalInfo.End=r.End;t.AdditionalInfo.Subject=r.Subject;t.AdditionalInfo.IsResponseRequested=r.IsResponseRequested;t.AdditionalInfo.ConversationId=r.ConversationId;t.AdditionalInfo.Recurrence=r.Recurrence;t.AdditionalInfo.Location=r.Location}function $6UE(n,t,i,r,u){if(!(t.__type===_g.$Nd._dataContractName)){_js.Trace.logWarning(_e.$16.$D,"Remove item wasn't supposed to receive an item type that's not a RemoveItemType : {0}.",Object.getType(t));throw Error.argumentType("item",Object.getType(t),Object.getType(new _g.$Nd),"Remove item wasn't supposed to receive an item type that's not a RemoveItemType.");}var o=t;var e=o.ReferenceItemId;var f=_e.$1X.$54(e.Id);var s=this,h=this,c=this;n.$AK(function(t){n.get_$95().get_$4i().$Da(t,f,function(r){if($8(r)||$8(r.get_$1s())){_js.Trace.logWarning(_e.$16.$D,"RemoveItem - Message with id {0} not found in local store",f);n.$70=!0;return}_js.Trace.logInfo(_e.$16.$D,"RemoveItem - Cancellation message with id {0} found in client store.",f);var u=r.get_$1s();if(u.IsDelegated){_js.Trace.logInfo(_e.$16.$D,"RemoveItem - Message with id {0} is delegated and will not be processed by offline service command",f);n.$70=!0;n.$Iw=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$16.$D,"RemoveItem - Message with id {0} is out of date and should not be used to respond to a meeting request",f);return}if($8(u.AssociatedCalendarItemId)){_js.Trace.logWarning(_e.$16.$D,"RemoveItem - Meeting cancelation message doesn't have associated calendar item and cannot be processed offline",f);n.$70=!0;return}n.get_$4i().$1ij(t,n.get_$Hh(),"MoveToDeletedItems",r,_g.$1v.$9K("deleteditems"),n.get_$5HW());n.get_$9I5().referencedCalendarItemType==="RecurringMaster"?n.$9KA(_bc.$JF,t,u.AssociatedCalendarItemId,n.get_$95().get_$hL()):n.$9KA(_bc.$KB,t,u.AssociatedCalendarItemId,n.get_$95().get_$1o());n.$8R[i].Items=new Array(2);var e=new _g.$KT;e.ItemId=u.ItemId;n.$8R[i].Items[0]=e;var o=new _g.$6P;o.ItemId=u.AssociatedCalendarItemId;n.$8R[i].Items[1]=o},null)},function(){_js.Trace.logInfo(_e.$16.$D,"Successfully remove item from calendar referred by cancellation message with id {0}.",e.Id);r()},function(t){if(n.$70&&t.$SU===5)u(new _e.$1W(t));else{_js.Trace.logError(_e.$16.$D,"RemoveItem - Error while processing message with id:{0}. Error: {1}",e.Id,t.$4P);n.$9I7(n.$8R[i],new _e.$1W(t),u)}})}_e.$16.prototype={$2n:null,$8R:null,$34u:null,$70:!1,$2hH:!1,get_$Of:function(){return"CreateItem"},$5zf:function(n,t){_e.$GB.$5yr(this.get_$95().get_$ch(),n,t,_e.$16.$D)},$7O1:function(){return _e.$Vi.$74E(this.get_$9I5())},$7NL:function(){return this.get_$34X().Body.ComplianceId},$7Ny:function(){return 0},$6xG:function(n,t,i){if(this.get_$9I5().clientStoreItem){var r=this,u=this;this.$s(function(){if(r.$70){_js.Trace.logInfo(_e.$16.$D,"CreateItem: Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else{r.get_$9I5().clientStoreItem===4&&(r.get_$34X().Body.GenerateResponseMessageOnFailure=!0);n()}},function(n){if(u.$70){_js.Trace.logInfo(_e.$16.$D,"CreateItem: Rollback happened. Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else t(n)},i)}else{_js.Trace.logWarning(_e.$16.$D,"The item will not be created in the local store because ClientStoreItem.None was passed.");i(-1)}},$7Df:function(n,t,i,r){if(this.$70){t();return}var u=this.get_$34X().Body.Items[n];var f=new _g.$Uq;f.ResponseCode="NoError";f.ResponseClass="Success";f.Items=[new _g.$7q];this.$8R[n]=f;if(this.get_$9I5().clientStoreItem===2)$6UD(this,u,n,t,i);else if(this.get_$9I5().clientStoreItem===1)$6UB(this,u,n,t,i);else if(this.get_$9I5().clientStoreItem===4)$6UC(this,u,n,t,i);else if(this.get_$9I5().clientStoreItem===5)$6UE(this,u,n,t,i);else{_js.Trace.logWarning(_e.$16.$D,"ClientStoreItem type {0} is not supported.",this.get_$9I5().clientStoreItem);t();return}},$9KA:function(n,t,i,r){var u=this;r.$Da(t,_e.$1X.$54(i.Id),function(r){if(!r||!r.get_$1s()){_js.Trace.logWarning(_e.$16.$D,"RemoveItem - Associated calendar item (type: '{0}') with id {1} could no be found in client store. Rolling back transaction.",n.getName(),i.Id);u.$70=!0;u.$Iw=13;t.$2WJ();return}_js.Trace.logInfo(_e.$16.$D,"RemoveItem - Associated calendar item (type: '{0}') with id {1} found in client store. Deleting it.",n.getName(),i.Id);u.get_$9I4().$3U5(t,r.get_$1y(),r.get_$1s())},null)}};_e.$L=function(){};_e.$L.$4fy=function(n,t){for(var r=[],k=n.AttributionsArray,sf=k.length,l=0;l<sf;++l){var d=k[l];d.IsWritable&&Array.add(r,d.Id)}if(!r.length){var hf=n.AttributionsArray.length;var o=new _g.$L7(hf.toString(),new _g.$1j("TEMPID"),"Outlook");o.IsWritable=!0;o.IsQuickContact=!1;o.IsHidden=!1;o.FolderId=null;for(var a=new Array(n.AttributionsArray.length+1),h=0;h<n.AttributionsArray.length;++h)a[h]=n.AttributionsArray[h];a[n.AttributionsArray.length]=o;n.AttributionsArray=a;Array.add(r,o.Id)}for(var u=!1,g=!1,f=!1,s=!1,nt="",tt="",it="",rt=t,cf=rt.length,v=0;v<cf;++v){var i=rt[v];var ut=i.Path;if(!ut)break;switch(ut.FieldURI){case"PersonaFileAsIds":var ft;_e.$L.$9I2(_g.$30,Object,r,ft={val:n.FileAsIdsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.FileAsIdsArray=ft.val;if(n.FileAsId===i.OldValue||_js.$8.$14(n.FileAsId)&&_js.$8.$14(i.OldValue)){n.FileAsId=i.NewValue;u=!0}break;case"PersonaDisplayNamePrefixes":var et;_e.$L.$9I2(_g.$30,Object,r,et={val:n.DisplayNamePrefixesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.DisplayNamePrefixesArray=et.val;if(n.DisplayNamePrefix===i.OldValue||_js.$8.$14(n.DisplayNamePrefix)&&_js.$8.$14(i.OldValue)){n.DisplayNamePrefix=i.NewValue;u=!0}break;case"PersonaGivenNames":var ot;_e.$L.$9I2(_g.$30,Object,r,ot={val:n.GivenNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.GivenNamesArray=ot.val;if(n.GivenName===i.OldValue||_js.$8.$14(n.GivenName)&&_js.$8.$14(i.OldValue)){n.GivenName=i.NewValue;u=!0}break;case"PersonaMiddleNames":var st;_e.$L.$9I2(_g.$30,Object,r,st={val:n.MiddleNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.MiddleNamesArray=st.val;if(n.MiddleName===i.OldValue||_js.$8.$14(n.MiddleName)&&_js.$8.$14(i.OldValue)){n.MiddleName=i.NewValue;u=!0}break;case"PersonaSurnames":var ht;_e.$L.$9I2(_g.$30,Object,r,ht={val:n.SurnamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.SurnamesArray=ht.val;if(n.Surname===i.OldValue||_js.$8.$14(n.Surname)&&_js.$8.$14(i.OldValue)){n.Surname=i.NewValue;u=!0}break;case"PersonaDisplayNames":var ct;_e.$L.$9I2(_g.$30,Object,r,ct={val:n.DisplayNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.DisplayNamesArray=ct.val;if(n.DisplayName===i.OldValue||_js.$8.$14(n.DisplayName)&&_js.$8.$14(i.OldValue)){n.DisplayName=i.NewValue;u=!0;g=!0}break;case"PersonaGenerations":var lt;_e.$L.$9I2(_g.$30,Object,r,lt={val:n.GenerationsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.GenerationsArray=lt.val;if(n.Generation===i.OldValue||_js.$8.$14(n.Generation)&&_js.$8.$14(i.OldValue)){n.Generation=i.NewValue;u=!0}break;case"PersonaNicknames":var at;_e.$L.$9I2(_g.$30,Object,r,at={val:n.NicknamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.NicknamesArray=at.val;if(n.Nickname===i.OldValue||_js.$8.$14(n.Nickname)&&_js.$8.$14(i.OldValue)){n.Nickname=i.NewValue;u=!0}break;case"PersonaInitials":var vt;_e.$L.$9I2(_g.$30,Object,r,vt={val:n.InitialsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.InitialsArray=vt.val;break;case"PersonaYomiCompanyNames":var yt;_e.$L.$9I2(_g.$30,Object,r,yt={val:n.YomiCompanyNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.YomiCompanyNamesArray=yt.val;break;case"PersonaYomiFirstNames":var pt;_e.$L.$9I2(_g.$30,Object,r,pt={val:n.YomiFirstNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.YomiFirstNamesArray=pt.val;if(n.YomiFirstName===i.OldValue||_js.$8.$14(n.YomiFirstName)&&_js.$8.$14(i.OldValue)){n.YomiFirstName=i.NewValue;u=!0}break;case"PersonaYomiLastNames":var wt;_e.$L.$9I2(_g.$30,Object,r,wt={val:n.YomiLastNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.YomiLastNamesArray=wt.val;if(n.YomiLastName===i.OldValue||_js.$8.$14(n.YomiLastName)&&_js.$8.$14(i.OldValue)){n.YomiLastName=i.NewValue;u=!0}break;case"PersonaBusinessPhoneNumbers":var bt;_e.$L.$9I2(_g.$52,Number,r,bt={val:n.BusinessPhoneNumbersArray},i.OldValue,i.NewValue,_e.$L.$UC,"Business",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.BusinessPhoneNumbersArray=bt.val;s=!0;break;case"PersonaBusinessPhoneNumbers2":var kt;_e.$L.$9I2(_g.$52,Number,r,kt={val:n.BusinessPhoneNumbers2Array},i.OldValue,i.NewValue,_e.$L.$UC,"Business",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.BusinessPhoneNumbers2Array=kt.val;break;case"PersonaHomePhones":var dt;_e.$L.$9I2(_g.$52,Number,r,dt={val:n.HomePhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Home",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.HomePhonesArray=dt.val;s=!0;break;case"PersonaHomePhones2":var gt;_e.$L.$9I2(_g.$52,Number,r,gt={val:n.HomePhones2Array},i.OldValue,i.NewValue,_e.$L.$UC,"Home",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.HomePhones2Array=gt.val;break;case"PersonaMobilePhones":var ni;_e.$L.$9I2(_g.$52,Number,r,ni={val:n.MobilePhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Mobile",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.MobilePhonesArray=ni.val;s=!0;break;case"PersonaAssistantPhoneNumbers":var ti;_e.$L.$9I2(_g.$52,Number,r,ti={val:n.AssistantPhoneNumbersArray},i.OldValue,i.NewValue,_e.$L.$UC,"Assistant",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.AssistantPhoneNumbersArray=ti.val;break;case"PersonaCallbackPhones":var ii;_e.$L.$9I2(_g.$52,Number,r,ii={val:n.CallbackPhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Callback",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.CallbackPhonesArray=ii.val;break;case"PersonaCarPhones":var ri;_e.$L.$9I2(_g.$52,Number,r,ri={val:n.CarPhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Car",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.CarPhonesArray=ri.val;break;case"PersonaHomeFaxes":var ui;_e.$L.$9I2(_g.$52,Number,r,ui={val:n.HomeFaxesArray},i.OldValue,i.NewValue,_e.$L.$UC,"HomeFax",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.HomeFaxesArray=ui.val;break;case"PersonaOrganizationMainPhones":var fi;_e.$L.$9I2(_g.$52,Number,r,fi={val:n.OrganizationMainPhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"OrganizationMain",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.OrganizationMainPhonesArray=fi.val;break;case"PersonaOtherFaxes":var ei;_e.$L.$9I2(_g.$52,Number,r,ei={val:n.OtherFaxesArray},i.OldValue,i.NewValue,_e.$L.$UC,"OtherFax",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.OtherFaxesArray=ei.val;break;case"PersonaOtherTelephones":var oi;_e.$L.$9I2(_g.$52,Number,r,oi={val:n.OtherTelephonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Other",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.OtherTelephonesArray=oi.val;s=!0;break;case"PersonaOtherPhones2":var si;_e.$L.$9I2(_g.$52,Number,r,si={val:n.OtherPhones2Array},i.OldValue,i.NewValue,_e.$L.$UC,"Other",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.OtherPhones2Array=si.val;break;case"PersonaPagers":var hi;_e.$L.$9I2(_g.$52,Number,r,hi={val:n.PagersArray},i.OldValue,i.NewValue,_e.$L.$UC,"Pager",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.PagersArray=hi.val;break;case"PersonaRadioPhones":var ci;_e.$L.$9I2(_g.$52,Number,r,ci={val:n.RadioPhonesArray},i.OldValue,i.NewValue,_e.$L.$UC,"Radio",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.RadioPhonesArray=ci.val;break;case"PersonaTelexNumbers":var li;_e.$L.$9I2(_g.$52,Number,r,li={val:n.TelexNumbersArray},i.OldValue,i.NewValue,_e.$L.$UC,"Telex",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.TelexNumbersArray=li.val;break;case"PersonaTTYTDDPhoneNumbers":var ai;_e.$L.$9I2(_g.$52,Number,r,ai={val:n.TTYTDDPhoneNumbersArray},i.OldValue,i.NewValue,_e.$L.$UC,"TTYTDD",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.TTYTDDPhoneNumbersArray=ai.val;break;case"PersonaWorkFaxes":var vi;_e.$L.$9I2(_g.$52,Number,r,vi={val:n.WorkFaxesArray},i.OldValue,i.NewValue,_e.$L.$UC,"BusinessFax",_e.$L.$UD,_e.$L.$UT,_e.$L.$Vq,_e.$L.$UQ,_e.$L.$Vp);n.WorkFaxesArray=vi.val;break;case"PersonaEmails1":var yi=new _g.$1m;yi.EmailAddress=i.OldValue;var pi=new _g.$1m;pi.EmailAddress=i.NewValue;var wi;_e.$L.$9I2(_g.$At,Object,r,wi={val:n.Emails1Array},yi,pi,_e.$L.$14E,0,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails1Array=wi.val;f=!0;nt=i.OldValue;break;case"PersonaEmails1DisplayNames":var bi=new _g.$1m;bi.Name=i.OldValue;var ki=new _g.$1m;ki.Name=i.NewValue;var di;_e.$L.$9I2(_g.$At,Object,r,di={val:n.Emails1Array},bi,ki,_e.$L.$14E,1,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails1Array=di.val;f=!0;break;case"PersonaEmails1OriginalDisplayNames":var gi=new _g.$1m;gi.OriginalDisplayName=i.OldValue;var nr=new _g.$1m;nr.OriginalDisplayName=i.NewValue;var tr;_e.$L.$9I2(_g.$At,Object,r,tr={val:n.Emails1Array},gi,nr,_e.$L.$14E,2,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails1Array=tr.val;f=!0;break;case"PersonaEmails2":var ir=new _g.$1m;ir.EmailAddress=i.OldValue;var rr=new _g.$1m;rr.EmailAddress=i.NewValue;var ur;_e.$L.$9I2(_g.$At,Object,r,ur={val:n.Emails2Array},ir,rr,_e.$L.$14E,0,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails2Array=ur.val;f=!0;tt=i.OldValue;break;case"PersonaEmails2DisplayNames":var fr=new _g.$1m;fr.Name=i.OldValue;var er=new _g.$1m;er.Name=i.NewValue;var or;_e.$L.$9I2(_g.$At,Object,r,or={val:n.Emails2Array},fr,er,_e.$L.$14E,1,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails2Array=or.val;f=!0;break;case"PersonaEmails2OriginalDisplayNames":var sr=new _g.$1m;sr.OriginalDisplayName=i.OldValue;var hr=new _g.$1m;hr.OriginalDisplayName=i.NewValue;var cr;_e.$L.$9I2(_g.$At,Object,r,cr={val:n.Emails2Array},sr,hr,_e.$L.$14E,2,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails2Array=cr.val;f=!0;break;case"PersonaEmails3":var lr=new _g.$1m;lr.EmailAddress=i.OldValue;var ar=new _g.$1m;ar.EmailAddress=i.NewValue;var vr;_e.$L.$9I2(_g.$At,Object,r,vr={val:n.Emails3Array},lr,ar,_e.$L.$14E,0,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails3Array=vr.val;f=!0;it=i.OldValue;break;case"PersonaEmails3DisplayNames":var yr=new _g.$1m;yr.Name=i.OldValue;var pr=new _g.$1m;pr.Name=i.NewValue;var wr;_e.$L.$9I2(_g.$At,Object,r,wr={val:n.Emails3Array},yr,pr,_e.$L.$14E,1,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails3Array=wr.val;f=!0;break;case"PersonaEmails3OriginalDisplayNames":var br=new _g.$1m;br.OriginalDisplayName=i.OldValue;var kr=new _g.$1m;kr.OriginalDisplayName=i.NewValue;var dr;_e.$L.$9I2(_g.$At,Object,r,dr={val:n.Emails3Array},br,kr,_e.$L.$14E,2,_e.$L.$14F,_e.$L.$15h,_e.$L.$1AZ,_e.$L.$15V,_e.$L.$1AV);n.Emails3Array=dr.val;f=!0;break;case"PersonaBusinessHomePages":var gr;_e.$L.$9I2(_g.$30,Object,r,gr={val:n.BusinessHomePagesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.BusinessHomePagesArray=gr.val;break;case"PersonaPersonalHomePages":var nu;_e.$L.$9I2(_g.$30,Object,r,nu={val:n.PersonalHomePagesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.PersonalHomePagesArray=nu.val;break;case"PersonaOfficeLocations":var tu;_e.$L.$9I2(_g.$30,Object,r,tu={val:n.OfficeLocationsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.OfficeLocationsArray=tu.val;break;case"PersonaImAddresses":var iu;_e.$L.$9I2(_g.$30,Object,r,iu={val:n.ImAddressesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.ImAddressesArray=iu.val;(n.ImAddress===i.OldValue||_js.$8.$14(n.ImAddress)&&_js.$8.$14(i.OldValue))&&(n.ImAddress=i.NewValue);break;case"PersonaBusinessAddresses":var ru;_e.$L.$9I2(_g.$Dp,Number,r,ru={val:n.BusinessAddressesArray},i.OldValue,i.NewValue,_e.$L.$3S0,"Business",_e.$L.$3S1,_e.$L.$3b1,_e.$L.$48J,_e.$L.$3Z5,_e.$L.$47e);n.BusinessAddressesArray=ru.val;break;case"PersonaHomeAddresses":var uu;_e.$L.$9I2(_g.$Dp,Number,r,uu={val:n.HomeAddressesArray},i.OldValue,i.NewValue,_e.$L.$3S0,"Home",_e.$L.$3S1,_e.$L.$3b1,_e.$L.$48J,_e.$L.$3Z5,_e.$L.$47e);n.HomeAddressesArray=uu.val;break;case"PersonaOtherAddresses":var fu;_e.$L.$9I2(_g.$Dp,Number,r,fu={val:n.OtherAddressesArray},i.OldValue,i.NewValue,_e.$L.$3S0,"Other",_e.$L.$3S1,_e.$L.$3b1,_e.$L.$48J,_e.$L.$3Z5,_e.$L.$47e);n.OtherAddressesArray=fu.val;break;case"PersonaTitles":var eu;_e.$L.$9I2(_g.$30,Object,r,eu={val:n.TitlesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.TitlesArray=eu.val;(n.Title===i.OldValue||_js.$8.$14(n.Title)&&_js.$8.$14(i.OldValue))&&(n.Title=i.NewValue);break;case"PersonaDepartments":var ou;_e.$L.$9I2(_g.$30,Object,r,ou={val:n.DepartmentsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.DepartmentsArray=ou.val;(n.Department===i.OldValue||_js.$8.$14(n.Department)&&_js.$8.$14(i.OldValue))&&(n.Department=i.NewValue);break;case"PersonaCompanyNames":var su;_e.$L.$9I2(_g.$30,Object,r,su={val:n.CompanyNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.CompanyNamesArray=su.val;if(n.CompanyName===i.OldValue||_js.$8.$14(n.CompanyName)&&_js.$8.$14(i.OldValue)){n.CompanyName=i.NewValue;n.CompanyNameSortKey=null}break;case"PersonaManagers":var hu;_e.$L.$9I2(_g.$30,Object,r,hu={val:n.ManagersArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.ManagersArray=hu.val;break;case"PersonaAssistantNames":var cu;_e.$L.$9I2(_g.$30,Object,r,cu={val:n.AssistantNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.AssistantNamesArray=cu.val;break;case"PersonaProfessions":var lu;_e.$L.$9I2(_g.$30,Object,r,lu={val:n.ProfessionsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.ProfessionsArray=lu.val;break;case"PersonaBodies":var au;_e.$L.$9I2(_g.$I4,Object,r,au={val:n.BodiesArray},i.OldValue,i.NewValue,_e.$L.$72m,null,_e.$L.$72n,_e.$L.$7PB,_e.$L.$90E,_e.$L.$7IO,_e.$L.$8xQ);n.BodiesArray=au.val;break;case"PersonaSpouseNames":var vu;_e.$L.$9I2(_g.$30,Object,r,vu={val:n.SpouseNamesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.SpouseNamesArray=vu.val;break;case"PersonaChildren":var yu;_e.$L.$9I2(_g.$Ii,Object,r,yu={val:n.ChildrenArray},i.OldValue,i.NewValue,_e.$L.$76H,null,_e.$L.$76I,_e.$L.$7PC,_e.$L.$90F,_e.$L.$7IP,_e.$L.$8xR);n.ChildrenArray=yu.val;break;case"PersonaHobbies":var pu;_e.$L.$9I2(_g.$30,Object,r,pu={val:n.HobbiesArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.HobbiesArray=pu.val;break;case"PersonaSchools":var wu;_e.$L.$9I2(_g.$30,Object,r,wu={val:n.SchoolsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.SchoolsArray=wu.val;break;case"PersonaWeddingAnniversariesLocal":var bu;_e.$L.$9I2(_g.$30,Object,r,bu={val:n.WeddingAnniversariesLocalArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.WeddingAnniversariesLocalArray=bu.val;break;case"PersonaBirthdaysLocal":var ku;_e.$L.$9I2(_g.$30,Object,r,ku={val:n.BirthdaysLocalArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.BirthdaysLocalArray=ku.val;break;case"PersonaLocations":var du;_e.$L.$9I2(_g.$30,Object,r,du={val:n.LocationsArray},i.OldValue,i.NewValue,_e.$L.$IV,null,_e.$L.$IW,_e.$L.$Ie,_e.$L.$J2,_e.$L.$Ic,_e.$L.$J0);n.LocationsArray=du.val;(n.Location===i.OldValue||_js.$8.$14(n.Location)&&_js.$8.$14(i.OldValue))&&(n.Location=i.NewValue);break;case"PersonaType":(n.PersonaTypeString===i.OldValue||_js.$8.$14(n.PersonaTypeString)&&_js.$8.$14(i.OldValue))&&(n.PersonaTypeString=i.NewValue);break;default:break}}if(u){g||(n.DisplayName=_g.$6X.$3No(n.DisplayNamePrefix,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.YomiFirstName,n.YomiLastName));n.FileAs=_g.$6X.$6vc(n.FileAsId,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.DisplayName,n.CompanyName)}if(f){var e=[];if(!$8(n.Emails1Array))for(var gu=n.Emails1Array,lf=gu.length,y=0;y<lf;++y){var nf=gu[y];var af=nf.Value.Name===nt;_e.$L.$3KL(e,nf,af)}if(!$8(n.Emails2Array))for(var tf=n.Emails2Array,vf=tf.length,p=0;p<vf;++p){var rf=tf[p];var yf=rf.Value.Name===tt;_e.$L.$3KL(e,rf,yf)}if(!$8(n.Emails3Array))for(var uf=n.Emails3Array,pf=uf.length,w=0;w<pf;++w){var ff=uf[w];var wf=ff.Value.Name===it;_e.$L.$3KL(e,ff,wf)}if(e.length>0){for(var b=new Array(e.length),c=0;c<e.length;++c)b[c]=e[c];n.EmailAddresses=b;n.EmailAddress=b[0]}}if(u||f||s){var ef,of;_g.$6X.$3Np(n.GivenName,n.MiddleName,n.Surname,n.DisplayName,n.CompanyName,n.EmailAddress,n.MobilePhonesArray,n.HomePhonesArray,n.BusinessPhoneNumbersArray,n.OtherTelephonesArray,_e.$L.$7Jp,_e.$L.$eY,ef={val:n.DisplayNameFirstLast},of={val:n.DisplayNameLastFirst});n.DisplayNameFirstLast=ef.val;n.DisplayNameLastFirst=of.val;n.DisplayNameFirstLastSortKey=null;n.DisplayNameLastFirstSortKey=null;n.DisplayNameFirstLastHeader=_e.$L.$2Lw;n.DisplayNameLastFirstHeader=_e.$L.$2Lw}};_e.$L.$7KG=function(n){var t=null;$8(n)||n.length>0&&!$8(n[0].Value)&&!_js.$8.$14(n[0].Value.Number)&&(t=n[0].Value.Number);return t};_e.$L.$7Jp=function(n){var t=null;$8(n)||_js.$8.$14(n.EmailAddress)||(t=n.RoutingType.toUpperCase()==="EX"?n.OriginalDisplayName:n.EmailAddress);return t};_e.$L.$eY=function(n){if(Array.isInstanceOfType(n)){var t=n;return _e.$L.$7KG(t)}return null};_e.$L.$3KL=function(n,t,i){($8(t.Value.Name)||i)&&(t.Value.Name=t.Value.EmailAddress);$8(t.Value.RoutingType)&&(t.Value.RoutingType="SMTP");Array.add(n,t.Value)};_e.$L.$IV=function(n,t){return new _g.$30(n)};_e.$L.$IW=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$L.$Ie=function(n){return n.Value};_e.$L.$J2=function(n,t,i){n.Value=t};_e.$L.$Ic=function(n){return n.Attributions};_e.$L.$J0=function(n,t){n.Attributions=t};_e.$L.$76H=function(n,t){var i=new _g.$Ii;i.Values=n.split(",;");return i};_e.$L.$76I=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$L.$7PC=function(n){return n.Values.join(", ")};_e.$L.$90F=function(n,t,i){n.Values=t.split(",;")};_e.$L.$7IP=function(n){return n.Attributions};_e.$L.$8xR=function(n,t){n.Attributions=t};_e.$L.$UC=function(n,t){return new _g.$52(new _g.$2u(n,t))};_e.$L.$UD=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$L.$UT=function(n){return n.Value.Number};_e.$L.$Vq=function(n,t,i){var r=n.Value.Type;n.Value=new _g.$2u(t,r)};_e.$L.$UQ=function(n){return n.Attributions};_e.$L.$Vp=function(n,t){n.Attributions=t};_e.$L.$14E=function(n,t){var i=new _g.$At;i.Value=n;return i};_e.$L.$14F=function(n){for(var i=new(_0365f.$s.$$(_g.$At)),t=0;t<n.length;++t){var r=_e.$L.$4pO(n[t]);_e.$L.$14(r)||i.$H(n[t])}return i.get_$F()>0?i.$7V():null};_e.$L.$15h=function(n){return _e.$L.$4pO(n)};_e.$L.$4pO=function(n){var t=new _g.$1m;t.Name=n.Value.Name;t.EmailAddress=n.Value.EmailAddress;t.RoutingType=n.Value.RoutingType;t.OriginalDisplayName=n.Value.OriginalDisplayName;return t};_e.$L.$1AZ=function(n,t,i){n.Value||(n.Value=new _g.$1m);var r=t;var u=i;switch(u){case 1:n.Value.Name=r.Name;break;case 2:n.Value.OriginalDisplayName=r.OriginalDisplayName;break;case 0:n.Value.EmailAddress=r.EmailAddress;if(n.Value.EmailAddress===""){n.Value.Name="";n.Value.RoutingType=""}break;default:throw Error.notImplemented("Invalid enum type: "+_e.$L.$2f8.toString(u));}};_e.$L.$15V=function(n){return n.Attributions};_e.$L.$1AV=function(n,t){n.Attributions=t};_e.$L.$3S0=function(n,t){var i=_g.$PA.$4mT(n,t);return new _g.$Dp(i)};_e.$L.$3S1=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$L.$3b1=function(n){var t=n.Value;return _g.$PA.$4mR(t.Street,t.City,t.State,t.PostalCode,t.Country)};_e.$L.$48J=function(n,t,i){var r=_g.$PA.$4mT(t,n.Value.Type);n.Value=r};_e.$L.$3Z5=function(n){return n.Attributions};_e.$L.$47e=function(n,t){n.Attributions=t};_e.$L.$72m=function(n,t){var i=new _g.$67("Text",n);return new _g.$I4(i)};_e.$L.$72n=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$L.$7PB=function(n){return n.Value.Value};_e.$L.$90E=function(n,t,i){var r=new _g.$67("Text",t);n.Value=r};_e.$L.$7IO=function(n){return n.Attributions};_e.$L.$8xQ=function(n,t){n.Attributions=t};_e.$L.$9I2=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v=[];if(r.val&&r.val.length)for(var st=r.val,wt=st.length,g=0;g<wt;++g){var y=st[g];var nt=h(y);var ht=l(y);if(_e.$L.$14(nt)&&_e.$L.$14(u)||_e.$L.$6st(u,nt,o)){for(var tt=!1,it=!1,ct=ht,bt=ct.length,rt=0;rt<bt;++rt){var kt=ct[rt];Array.contains(i,kt)?tt=!0:it=!0}if(tt&&!it){if(!_e.$L.$7dB(f)){c(y,f,o);Array.add(v,y)}}else if(tt&&it){for(var lt=e(f,o),at=e(nt,o),w=[],b=[],vt=ht,dt=vt.length,ut=0;ut<dt;++ut){var ft=vt[ut];Array.contains(i,ft)?Array.add(w,ft):Array.add(b,ft)}for(var yt=new Array(w.length),k=0;k<w.length;++k)yt[k]=w[k];a(lt,yt);for(var pt=new Array(b.length),d=0;d<b.length;++d)pt[d]=b[d];a(at,pt);_e.$L.$14(f)||Array.add(v,lt);Array.add(v,at)}else Array.add(v,y)}else Array.add(v,y)}else if(!_e.$L.$14(f)){for(var et=e(f,o),ot=new Array(i.length),p=0;p<i.length;++p)ot[p]=i[p];a(et,ot);Array.add(v,et)}r.val=v.length>0?s(v):null};_e.$L.$6st=function(n,t,i){if(!$8(n)&&!$8(t)){if(String.isInstanceOfType(n))return t===n;if(_g.$2I.$Uf(n)){var r=n;var u=t;var f=i;switch(f){case 0:return _js.$8.$14(r.EmailAddress)&&_js.$8.$14(u.EmailAddress)?!0:u.EmailAddress===r.EmailAddress;case 1:return _js.$8.$14(r.Name)&&_js.$8.$14(u.Name)?!0:u.Name===r.Name;case 2:return _js.$8.$14(r.OriginalDisplayName)&&_js.$8.$14(u.OriginalDisplayName)?!0:u.OriginalDisplayName===r.OriginalDisplayName;default:throw Error.notImplemented("Invalid enum type: "+_e.$L.$2f8.toString(f));}}throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());}return!1};_e.$L.$14=function(n){if($8(n))return!0;if(String.isInstanceOfType(n))return _js.$8.$14(n);if(_g.$2I.$Uf(n))return _js.$8.$14(n.EmailAddress)&&_js.$8.$14(n.Name);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$L.$7dB=function(n){if(String.isInstanceOfType(n))return _e.$L.$14(n);if(_g.$2I.$Uf(n))return $8(n);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$L.$2f8=function(){};_e.$L.$2f8.prototype={address:0,name:1,originalDisplayName:2};_e.$L.$2f8.registerEnum("_e.$L.$2f8",!1);_e.$oq=function(n,t,i,r){_e.$oq.$$(this.$$gta["_e.$oq"].TActionContext).initializeBase(this,[n,t]);this.$2Mh=i;this.$5oL=r};_e.$oq.$$=function(n){var t="$oq"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$oq"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$oq.apply(this,i)};r.registerClass("_e."+t,_e.$5k.$$(n));var u=_e.$oq.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$oq.prototype={$2Mh:null,$12:null,$5oL:null,get_$1v:function(){return this.$12},set_$1v:function(n){this.$12=n;return n},get_$9J9:function(){return this.$2Mh},set_$9J9:function(n){this.$2Mh=n;return n},get_$9JA:function(){return this.$5oL}};_e.$Mc=function(n,t,i,r,u,f){_e.$Mc.initializeBase(this,[n,t,i,u]);_a.$3.$17(i,"propertyUpdates");_a.$3.$17(r,"parentFolder");_a.$3.$17(n.personaId,"actionContext.PersonaId");_a.$3.$1C(n.personaId.Id,"actionContext.PersonaId.Id");this.$KJ=r;this.$3x=f};_e.$Mc.prototype={$KJ:null,$3x:null,$2i:null,get_$Of:function(){return"CreatePersona"},$6xG:function(n,t,i){if(this.get_$9JA()===_e.$L.$3V9){i(-1);return}var r=this.$KJ.BaseFolderId;if(_g.$7o.isInstanceOfType(r)){var u=this;this.$3x.$NL(2,new _a.$H5,function(f){if(f){var e=r.Id;_e.$7i.$1SK(u.get_$95().get_$2j(),e,function(r){if(r){u.$2i=r.get_$1s().FolderId;u.$s(n,t,i)}else{_js.Trace.logWarning(_e.$Mc.$D,"Couldn't find a folder with the distinguished id '{0}', so reject this command.",e);i(-1)}},function(n){_js.Trace.logError(_e.$Mc.$D,"Couldn't find a folder with the distinguished id because of failure: '{0}'",n.get_$4i());t(n.$IU())})}else{_js.Trace.logWarning(_e.$Mc.$D,"Couldn't find a folder with the distinguished id because folder hierarchy wasn't synced.");i(-1)}})}else{this.$2i=r;this.$s(n,t,i)}},$7Dt:function(n,t,i){var r=new _g.$C3;r.PersonaId=this.get_$9I5().personaId;r.PersonaTypeString="Person";r.FolderIds=[this.$2i];this.get_$9I5().createPersonaUnderMyContactsFolder&&Array.add(r.FolderIds,_g.$1v.$9K("mycontacts"));r.CreationTimeString=_a.$7.$Eb(_a.$7.get_$2M());r.DisplayNameFirstLastHeader=_e.$L.$2Lw;r.DisplayNameLastFirstHeader=_e.$L.$2Lw;r.FileAsId="LastCommaFirst";var u=new _g.$L7("0",new _g.$1j(this.get_$9I5().personaId.Id),"Outlook");u.IsWritable=!0;u.IsQuickContact=!1;u.IsHidden=!1;u.FolderId=null;r.AttributionsArray=[u];_e.$L.$4fy(r,this.get_$9J9());var f=this,e=this,o=this;this.$AK(function(n){var t=_e.$5T.$I(f.get_$95());t.$4ym(n,r,function(){t.$gO(n,r,0,null)});f.set_$1v(r)},function(){n()},function(n){_e.$1W.$BC(n,function(n){t(n)})})}};_e.$Y1=function(n,t,i,r){_e.$Y1.initializeBase(this,[n,t]);_a.$3.$17(i,"personaId");this.$8w=i;this.$3x=r};_e.$Y1.prototype={$8w:null,$3x:null,get_$Of:function(){return"DeletePersona"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(8,new _a.$H5,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logWarning(_e.$Y1.$D,"Couldn't find the persona because people module wasn't synced.");i(-1)}})},$7Dt:function(n,t,i){var r=this,u=this,f=this;this.$AK(function(n){var t=_e.$5T.$I(r.get_$95());t.$Da(n,r.$8w,function(i){$8(i)?_a.$8t.$v0(2,"PersonaId to delete is not present in persona store"):t.$GW(n,i.PersonaId)},null)},function(){n()},function(n){_e.$1W.$BC(n,t)})}};_e.$GZ=function(n,t,i){_e.$GZ.initializeBase(this,[n,t,i,i.Body.AttachmentIds.length]);this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$QS;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};function $6UO(n,t,i,r){var u=t;if($8(u.Attachments)){_js.Trace.logWarning(_e.$GZ.$D,"Item with id {0} has no attachments in local store",u.ItemId.Id);return}var f=$6UP(n,u,i);r.deletedAttachment=f;if(!f){_js.Trace.logWarning(_e.$GZ.$D,"Attachment with id {0} not found on item with id {1} in local store",i,u.ItemId.Id);return}if(!u.Attachments.length){u.Attachments=undefined;u.HasAttachments=!1}}function $6UP(n,t,i){for(var f=t.Attachments,e=f.length,r=0;r<e;++r){var u=f[r];if(u.AttachmentId.Id===i){Array.remove(t.Attachments,u);return u}}return null}_e.$GZ.prototype={$2n:null,$8R:null,get_$Of:function(){return"DeleteAttachment"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Df:function(n,t,i,r){var f=this.get_$9I5().itemContexts[n];if(f.clientStoreItem===2){var u=new _g.$Xs;u.ResponseCode="NoError";u.ResponseClass="Success";var e=f.parentItemId;u.RootItemId=new _g.$cS;u.RootItemId.RootItemId=e.Id;u.RootItemId.RootItemChangeKey=e.ChangeKey;this.$8R[n]=u;var o=this,s=this,h=this;this.$AK(function(t){o.get_$95().get_$4i().$1BX(t,_e.$1X.$54(e.Id),function(t){if($8(t)){_js.Trace.logWarning(_e.$GZ.$D,"Message with id {0} not found in local store",e.Id);return}$6UO(o,t,o.get_$34X().Body.AttachmentIds[n].Id,f)})},function(){t()},function(n){_e.$1W.$BC(n,i)})}else{_js.Trace.logWarning(_e.$GZ.$D,"ClientStoreItem type {0} is not supported.",f.clientStoreItem);t();return}}};_e.$8x=function(n,t,i){this.$Iw=0;_e.$8x.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $6UQ(n,t,i,r){if(t.__type!==_g.$1j._dataContractName&&t.__type!==_g.$78._dataContractName){n.$70=!0;n.$Iw=14;i();return}var u=this,f=this,e=this;n.$AK(function(i){if(t.__type===_g.$78._dataContractName)n.get_$9I4().$50v(i,t,function(t){_e.$Ch.$3N8(i,n.get_$95().get_$hL(),t,function(r){if(!r||!r.get_$1s()){_js.Trace.logWarning(_e.$8x.$D,"DeleteCalendarItem - Calendar master item with uid {0} could not be found in client store.",t);n.$70=!0;return}_js.Trace.logInfo(_e.$8x.$D,"DeleteCalendarItem - Calendar master item with uid {0} found in client store. Deleting it.",t);n.$9Jp(_bc.$JF,i,r)})},function(){n.$70=!0});else{var u=t;var r=_e.$1X.$54(u.Id);n.get_$9I5().isReferencedItemRecurringMaster?n.$9Jo(_bc.$JF,i,r,n.get_$95().get_$hL()):n.$9Jo(_bc.$KB,i,r,n.get_$95().get_$1o())}},function(){if(t.__type===_g.$78._dataContractName)_js.Trace.logInfo(_e.$8x.$D,"Successfully deleted calendar master, occurrences, exceptions and reminders with from master of occurrence with id {0} from local store.",t.OccurrenceId);else{var r=t;n.get_$9I5().isReferencedItemRecurringMaster?_js.Trace.logInfo(_e.$8x.$D,"Successfully deleted calendar master, occurrences, exceptions and reminders with from calendar master with id {0} from local store.",r.Id):_js.Trace.logInfo(_e.$8x.$D,"Successfully deleted calendar item and reminder with id {0} from local store.",r.Id)}i()},function(n){r(new _e.$1W(new _a.$8t(0,n.$4P)))})}function $6UR(n,t,i,r){var u=this,f=this;n.$AK(function(i){n.get_$4i().$3UF(i,n.get_$Hh(),n.get_$34X().Body.DeleteType,t,_g.$1v.$9K("deleteditems"),n.get_$5HW())},function(){i()},_e.$1W.$WX(r))}_e.$8x.prototype={$70:!1,get_$Of:function(){return"DeleteItem"},$6xG:function(n,t,i){if(this.get_$9I5().clientStoreItem){var r=this;this.$s(function(){r.$70?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$8x.$D,"ClientStoreItem.None was passed. Request will be sent to the server.");n()}},$7Df:function(n,t,i,r){if(this.$70){t();return}var f=this.get_$34X().Body.ItemIds[n];if(this.get_$9I5().clientStoreItem===2){var u=f;_js.Trace.logInfo(_e.$8x.$D,"Step {0} called for delete message item with id {1}",n.toString(),u.Id);var e=this,o=this;$6UR(this,u,function(){_js.Trace.logInfo(_e.$8x.$D,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}else if(this.get_$9I5().clientStoreItem===1){_js.Trace.logInfo(_e.$8x.$D,"Step {0} called for deleting an calendar item",n.toString());$6UQ(this,f,t,i)}else{_js.Trace.logWarning(_e.$8x.$D,"ClientStoreItem {0} is not supported.",this.get_$9I5().clientStoreItem);t()}},$9Jo:function(n,t,i,r){var u=this;r.$Da(t,i,function(r){if(!r||!r.get_$1s()){_js.Trace.logWarning(_e.$8x.$D,"Calendar item (type: {0}) with id {1} could no be found in client store.",n.getName(),i);u.$70=!0;return}_js.Trace.logInfo(_e.$8x.$D,"Calendar item (type: {0}) with id {1} found in client store. Deleting it.",n.getName(),r.get_$1y());u.$9Jp(n,t,r)},null)},$9Jp:function(n,t,i){if(i.get_$1s().IsMeeting){_js.Trace.logInfo(_e.$8x.$D,"Offline delete calendar item with id {0} was rejected because it's a meeting. Request will go directly to the server.",i.get_$1y());this.$70=!0;this.$Iw=5;return}this.get_$9I4().$3U5(t,i.get_$1y(),i.get_$1s())}};_e.$FA=function(n,t,i,r,u){_e.$FA.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);_a.$3.$17(r,"folderMappings");_a.$3.$17(u,"syncManager");this.$1i=r;this.$3x=u};_e.$FA.$3iW=function(n,t){if(t&&t.explicitLogonUser){_js.Trace.logInfo(_e.$FA.$D,"Not-supported: Offline EmptyFolder only supports primary mailbox, other mailbox calls are not supported.");return!1}if(!t.$3fs){_js.Trace.logInfo(_e.$FA.$D,"Not-supported: Offline EmptyFolder currently only supports conversation view.");return!1}return!0};_e.$FA.$7KK=function(n,t){for(var i=null,u=t,e=u.length,r=0;r<e;++r){var f=u[r];if(f.FolderId.Id===n.Id){i=f;break}}return i&&!_js.$8.$c(i.LastSuccessfulSyncTime)?_a.$7.$4Y(i.LastSuccessfulSyncTime):null};function $6UU(n,t,i,r,u){var f=this,e=this;n.$AK(function(i){n.get_$9I5().$3fs?n.get_$95().get_$Hh().$1ia(i,_e.$OA.$3aX(t.Id,n.get_$9I5().$B0),function(){$6UV(n,t,i)}):u(100)},function(){i()},_e.$1W.$WX(r))}function $6UV(n,t,i){n.get_$9I5().$B0==="All"&&n.get_$95().get_$2j().$693(i,t,0,0)}_e.$FA.prototype={$1i:null,$3x:null,get_$Of:function(){return"EmptyFolder"},$6xG:function(n,t,i){_e.$FA.$3iW(this.get_$34X().Body,this.get_$9I5())?this.$s(n,t,i):i(100)},$7Df:function(n,t,i,r){var f=this.get_$9I5().$B0!=="All"?this.get_$9I5().$63T:this.get_$34X().Body.FolderIds[n];_a.$3.$M(f,"FolderId for current step cannot be null");var u=null;if(_g.$7o.isInstanceOfType(f)){var o=f;u=this.$1i.nameToId(o.Id)}else u=f;_a.$3.$8z(!!u,"[EmptyFolder::ExecuteCurrentStep] currentFolderId should not be null.");var e=this;this.$3x.$1Up(4,new _bc.$Ga(u),function(n,f){if(n){var o=_e.$FA.$7KK(u,f);_a.$3.$8z(!!o,"[EmptyFolder::ExecuteCurrentStep] folderLastSyncTime should never be null for a synced folder.");e.get_$34X().Body.ClientLastSyncTime=o.$8r();$6UU(e,u,t,i,r)}else{_js.Trace.logInfo(_e.$FA.$D,"Offline EmptyFolder only supports synced folders.");r(100)}})}};_e.$9Y=function(n,t,i,r){this.$IA=-1;_e.$9Y.initializeBase(this,[n,t,i]);_a.$3.$M(i.Body.ParentFolderId,"ParentFolderId");_a.$3.$M(i.Body.Paging,"Paging");_a.$3.$17(r,"syncManager");this.$3x=r;this.$2n=new _g.$Mk;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body=new _g.$Tk};_e.$9Y.$$cctor=function(){_e.$5k.$$(_g.$E8).$9I3("FindConversation")};function $6UX(n,t,i,r){r.val=null;for(var f=!0,s=i,l=s.length,o=0;o<l;++o){var h=s[o];if(h.FolderId.Id===n.$2i.Id){r.val=h;break}}if(r.val)if(_g.$BL.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>r.val.SyncMinimum&&n.$mO()){_js.Trace.logInfo(_e.$9Y.$D,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,r.val.SyncMinimum,n.$mO());f=!1}}else if(_g.$Je.isInstanceOfType(t.Paging)){var e=t.Paging;if(e.MaxEntriesReturned<=0||e.MaxEntriesReturned>r.val.SyncMinimum&&n.$mO()){_js.Trace.logInfo(_e.$9Y.$D,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",e.MaxEntriesReturned,e.BasePoint,r.val.SyncMinimum,n.$mO());f=!1}else if(e.BasePoint==="Beginning"){var c=n.get_$95().get_$Hh().$52F(r.val.OldestDeliveryTime);var a=_a.$7.$4Y(c).$55();var v=_a.$7.$4Y(n.get_$9I5().itemLastDeliveryTime).$55();if(v<a){_js.Trace.logInfo(_e.$9Y.$D,"Requested item's last delivery time [{0}] is less than the oldest synced item's last delivery time [{1}]. Rejecting the request.",n.get_$9I5().itemLastDeliveryTime,c);f=!1}}}else{_js.Trace.logInfo(_e.$9Y.$D,"Non-supported paging type. PagingType={0}",t.Paging);f=!1}else{_js.Trace.logInfo(_e.$9Y.$D,"Could not find the conversation view data for the folder specified");f=!1}return f}function $6UW(n,t,i,r){n.$2n.Body.ResponseCode="NoError";n.$2n.Body.ResponseClass="Success";n.$2n.Body.Conversations=t;n.$2n.Body.TotalConversationsInView=i;n.$2n.Body.IndexedOffset=r}_e.$9Y.prototype={$3x:null,$2n:null,$2i:null,$70:!1,get_$Of:function(){return"FindConversation"},$6xG:function(n,t,i){var r,u;if(!(u=_g.$E8.$3iW(this.get_$34X().Body,this.get_$9I5(),r={val:this.$IA}),this.$IA=r.val,u)){_js.Trace.logInfo(_e.$9Y.$D,"Not-supported: Request contains query string or view filter or explicit logon or from filter.");i(this.$IA);return}this.$2i=this.$3Zf(this.get_$34X().Body.ParentFolderId.BaseFolderId);var f=this;this.$s(function(){if(f.$70){_js.Trace.logInfo(_e.$9Y.$D,"Client store unable to fulfil request. Forwarding request to the server.");i(f.$IA)}else n()},t,i)},$7Dt:function(n,t,i){var r=this;this.$1Up(4,new _bc.$Ga(this.$2i),function(i,u){var f=null;var e,o;if(!i||!(o=$6UX(r,r.get_$34X().Body,u,e={val:f}),f=e.val,o)){r.$70=!0;r.$IA=i?100:301;_js.Trace.logInfo(_e.$9Y.$D,"Rejecting the request to the server with RejectCode {0}",_0365f.$Ow.toString(r.$IA));n();return}_js.Trace.logInfo(_e.$9Y.$D,"FindConversationAction is trying to use client store to get {0} rows",r.get_$34X().Body.Paging.MaxEntriesReturned);r.get_$95().get_$Hh().$4ze(r.$2i.Id,r.get_$34X().Body,r.get_$9I5(),f,function(t,i,u){_js.Trace.logInfo(_e.$9Y.$D,"Obtained {0} conversations from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",t.length,f.MoreItemsOnServer,r.$mO());var e=r.get_$34X().Body.Paging.MaxEntriesReturned;if(t.length<e&&f.MoreItemsOnServer&&r.$mO()||!t.length&&f.MoreItemsOnServer){_js.Trace.logInfo(_e.$9Y.$D,"The client store was requested {0} rows but returned only {1} AND there are more changes on the server. Hence, rejecting the request to the server.",e,t.length);r.$70=!0;r.$IA=302;n();return}_js.Trace.logInfo(_e.$9Y.$D,"FindConversationAction is returning {0} rows from client store. TotalConversationsInView={1}, indexOffset={2}",t.length,f.TotalConversationsInView,u);$6UW(r,t,f.TotalConversationsInView,u);n()},function(n){r.$9I7(r.$2n.Body,n,t)})})},$1Up:function(n,t,i){this.$3x.$1Up(n,t,i)},$mO:function(){return _g.$1Q.$g.$AS.$NF}};_e.$A7=function(n,t,i,r,u,f){_e.$A7.initializeBase(this,[n,t,i,i.Body.ParentFolderIds.length]);_a.$3.$17(r,"syncManager");_a.$3.$17(u,"folderMappings");_a.$3.$17(f,"sessionSettings");this.$3x=r;this.$1i=u;this.$Bo=f;this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$OK;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};function $6Ua(n,t,i,r,u,f){_js.Trace.logInfo(_e.$A7.$D,"Processing FindFolder with shallow traversal for folder {0} in client store.",t);var e=this,o=this;i.$7OR(t,function(i){$6UY(n,t,r,u,f,i)},function(t){n.$9I7(r,t,f)})}function $6UZ(n,t,i,r,u,f){_js.Trace.logInfo(_e.$A7.$D,"Processing FindFolder with deep traversal for folder {0} in client store.",t);if(n.$1i.doesIdEqualName(new _g.$3J(t),"msgfolderroot")){_js.Trace.logInfo(_e.$A7.$D,"Processing FindFolder with deep traversal for msgfolderroot in client store.");var o=this,s=this;i.$7Ht(function(t){var i=t[0].get_$1s();Array.removeAt(t,0);$4QW(n,r,t,i);u()},function(t){n.$9I7(r,t,f)})}else{var e="Deep traversal is supported only for msgrootFolder. Actual folderId = "+t;_js.Trace.logError(_e.$A7.$D,e);f(new _e.$1W(new _a.$8t(1,e)))}}function $6UY(n,t,i,r,u,f){var e=this,o=this,s=this;n.$AK(function(r){n.get_$95().get_$2j().$Da(r,_e.$1X.$54(t),function(t){$4QW(n,i,f,t.get_$1s())},null)},function(){r()},function(n){i.ResponseCode="ErrorDataSourceOperation";i.ResponseClass="Error";i.MessageText=n.$4P;_e.$1W.$BC(n,u)})}function $4QW(n,t,i,r){for(var f=t.RootFolder.Folders,u=0;u<i.length;++u)f[f.length]=i[u].get_$1s();t.RootFolder.ParentFolder=r}function $6Ub(n,t){if(_g.$7o.isInstanceOfType(t)){var i=t;var r=i.Id;if(r==="archivemsgfolderroot"||i.Mailbox&&n.$Bo&&i.Mailbox.EmailAddress!==n.$Bo.get_$Br())return!1}else if(n.$1i.doesIdEqualName(t,"archivemsgfolderroot"))return!1;return!0}_e.$A7.prototype={$3x:null,$1i:null,$2n:null,$8R:null,$70:!1,$Bo:null,get_$Of:function(){return"FindFolder"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(2,new _a.$H5,function(u){if(u){var f=r.get_$34X().Body.Traversal;if(f!=="Deep"&&f!=="Shallow"){_js.Trace.logInfo(_e.$A7.$D,"Rejecting request: FindFolder requested with unsupported traversal {0}.",f);i(-1)}else r.$s(function(){r.$70?i(-1):n()},t,i)}else i(-1)})},$7Df:function(n,t,i,r){var f=this.get_$34X().Body.ParentFolderIds[n];if(!$6Ub(this,f)){_js.Trace.logInfo(_e.$A7.$D,"Not-supported: Request with DistinguishedFolderId.");this.$70=!0;t();return}if(_g.$7o.isInstanceOfType(f)){var s=f.Id;var e=String.format("Failed to find distinguished folder with id '{0}'",s);_js.Trace.logError(_e.$A7.$D,e);i(new _e.$1W(new _a.$8t(2,e)))}else{var o=f.Id;var u=new _g.$Yc;u.ResponseCode="NoError";u.ResponseClass="Success";u.RootFolder=new _g.$YZ;this.$8R[n]=u;this.get_$34X().Body.Traversal==="Shallow"?$6Ua(this,o,this.get_$95().get_$4xV(),u,t,i):this.get_$34X().Body.Traversal==="Deep"&&$6UZ(this,o,this.get_$95().get_$4xV(),u,t,i)}}};_e.$2w=function(n,t,i,r,u){_e.$2w.initializeBase(this,[n,t,i]);_a.$3.$17(r,"syncManager");_a.$3.$17(u,"folderMappings");this.$3x=r;this.$1i=u;this.$2n=new _g.$OL;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=new Array(1)};_e.$2w.$$cctor=function(){_e.$5k.$$(_g.$8c).$9I3("FindItem")};_e.$2w.$4ly=function(n,t){var r=n;var u=t;var f=r.get_$4el();var e=u.get_$4el();var i=f.$8c(e);if(i)return i;!r.get_$9w()&&u.get_$9w()?i=1:r.get_$9w()&&!u.get_$9w()&&(i=-1);if(i)return i;i=u.get_$5EZ()-r.get_$5EZ();return i?i:f.$2Y(e)};_e.$2w.$7iJ=function(n,t,i,r){for(var e=n.length,o=e>0?n[e-1]:null,s=t.length,u=i;u<s;u++){var f=t[u];if(o&&f.get_$3Kr().localeCompare(o.get_$10())<=0)_0365f.$F4.$2l9(n,f,_e.$2w.$4ly);else if(n.length<r)Array.add(n,f);else break}};function $6Uh(n){var r=!1;var t=_g.$8c.$4zD(n.get_$34X().Body);if(_g.$7o.isInstanceOfType(t)){var i=t;if($8(i.Mailbox)){n.$2i=n.$1i.nameToId(i.Id);n.$wn=i.Id;n.$2eT=!0;r=!0;_js.Trace.logInfo(_e.$2w.$D,"Converted distinguished folder id '{0}' to actual folder id '{1}'",n.$wn,n.$2i.Id)}else _js.Trace.logInfo(_e.$2w.$D,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",i.Mailbox.EmailAddress)}else if(_g.$3J.isInstanceOfType(t)){n.$2i=t;r=!0}else _js.Trace.logWarning(_e.$2w.$D,"FolderId {0} is not of a known folder type.",t);return r}function $6Ud(n,t,i,r){_js.Trace.logInfo(_e.$2w.$D,"FindCalendarItemsByIndex");if(n.get_$34X().Body.Paging.MaxEntriesReturned<0)throw Error.invalidOperation("FindCalendarItemsByIndex called with a negative MaxEntriesReturned in the paging.");var f=new _e.$5e(n.get_$95().get_$1o());var u=n.get_$34X().Body.Paging;var e=u.Condition.$5x2;if(u.Offset){var s=_a.$5.acsa(_a.$0.$11W,"FindCalendarItemsByIndex_SeekToConditionWithOffset",!0);var l=this,a=this;f.$8vV(e,function(e){_a.$5.acea(s);n.get_$9I5().firstMatchingRowIndex=e;n.get_$9I5().loadedStartIndex=Math.max(0,e+u.Offset);var o=new _g.$BL("Beginning");o.Offset=n.get_$9I5().loadedStartIndex;o.MaxEntriesReturned=u.MaxEntriesReturned;$6Uf(n,t,f,o,i,r)},function(i){n.$9I7(t,i,r)})}else{var o=_a.$5.acsa(_a.$0.$11W,"FindCalendarItemsByIndex_SeekToConditionNoOffset",!0);var h=this,c=this;f.$7Hp(n.$2i.Id,e,u.MaxEntriesReturned,n.get_$34X().Body.ItemShape,function(e,s){_a.$5.acea(o);$4QY(n,t,i,r,f,e,s,u.MaxEntriesReturned)},function(i){n.$9I7(t,i,r)})}}function $6Ui(n,t,i,r){if(_e.$2w.$2xu&&!n.get_$9I5().isReload){i(_e.$2w.$2xu);return}var u=this;t.$7Lp(n.$2i.Id,n.get_$34X().Body.ItemShape,function(t){for(var l=t.length,a=_a.$5.acss(_a.$0.$11W,"UnfoldMultidayItems_ProcessMultidayEvents_"+l),r=[],u=0,v=t.length;u<v;u++){var s=t[u];var f=s.get_$1s();var e=_a.$7.$4Y(f.Start);var o=_a.$7.$4Y(f.End);s.get_$5m()&&(o=o.$9b(-1));for(var h=1;e.$8c(o)<0;){e=e.$2q(1);var y=_0365f.$2t.$46(f);var c=n.get_$95().get_$1o().$lp(y);c.get_$1s().unfoldedIndex=h;_0365f.$F4.$2l9(r,c,_e.$2w.$4ly);h++}}_e.$2w.$2xu=r;_a.$5.aces(a);i(r)},r)}function $4QY(n,t,i,r,u,f,e,o){var s=_a.$5.acsa(_a.$0.$11W,"ProcessAgendaViewItems_UnfoldMultidayItems",!0);var h=this;$6Ui(n,u,function(r){_a.$5.acea(s);var c=r.length;var y=_a.$5.acss(_a.$0.$11W,"ProcessAgendaViewItems_ProcessUnfoldedMultidayItems_"+c);if(e>0){var p=n.get_$9I5().loadedStartIndex;var h;n.get_$9I5().tableSize=e+c;var w=f[0];var b=w.get_$10();for(h=0;h<c;h++){var k=r[h];if(b.localeCompare(k.get_$3Kr())<0)break}_e.$2w.$7iJ(f,r,h,o);var l=n.get_$34X().Body.Paging;var d=l.Condition.$2OR;var u;var a=f.length;for(u=0;u<a;u++){var g=f[u];if(g.get_$3Kr().localeCompare(d)>=0)break}u===a&&u--;n.get_$9I5().firstMatchingRowIndex=u+p+h;n.get_$9I5().loadedStartIndex=Math.max(0,n.get_$9I5().firstMatchingRowIndex+l.Offset);var v=Math.max(u+l.Offset,0);var nt=v+o;var tt=f;f=tt.slice(v,nt);_js.Trace.logInfo(_e.$2w.$D,"GetCalendarItemsByIndex will return {0} items.",f.length)}else{n.get_$9I5().firstMatchingRowIndex=0;n.get_$9I5().loadedStartIndex=0}_a.$5.aces(y);$4Qa(n,t,i,f)},r)}function $6Uf(n,t,i,r,u,f){var e=_a.$5.acsa(_a.$0.$11W,"GetCalendarItemsByIndex",!0);var o=this,s=this;i.$7Ho(n.$2i.Id,r.Offset,r.MaxEntriesReturned,n.get_$34X().Body.ItemShape,function(o,s){_a.$5.acea(e);$4QY(n,t,u,f,i,o,s,r.MaxEntriesReturned)},function(i){n.$9I7(t,i,f)})}function $6Uc(n,t,i,r){_js.Trace.logInfo(_e.$2w.$D,"FindItem for CalendarPageView is trying to fetch data from the client store");var u=n.get_$34X().Body.Paging;var f=new _e.$5e(n.get_$95().get_$1o());var e=_a.$5.acsa(_e.$2w.$D,"FindItem_GetCalendarView",!0);var o=this,s=this;f.$4zP(n.$2i.Id,u.StartDate,u.EndDate,n.get_$34X().Body.ItemShape,function(r){_a.$5.acea(e);var u=_a.$5.acss(_e.$2w.$D,"GetCalendarView_Success");$4Qa(n,t,i,r);_a.$5.aces(u)},function(i){n.$9I7(t,i,r)})}function $4Qa(n,t,i,r){var f=_a.$5.acss(_e.$2w.$D,"AddingtoResponseMsg_"+r.length);t.RootFolder.Items=new Array(r.length);for(var u=0;u<r.length;u++)t.RootFolder.Items[u]=r[u].get_$1s();_a.$5.aces(f);i()}function $6Ue(n,t,i,r){var u=n.get_$34X().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$2w.$D,"FindItem for folder outbox is trying to fetch {0} items from the client store",u);var f=this,e=this;n.get_$95().get_$ch().$50z(n.$2i.Id,n.get_$95().get_$2j(),n.get_$34X().Body,n.get_$9I5(),null,function(r,u,f){$4QZ(n,t,r,u,f);_js.Trace.logInfo(_e.$2w.$D,"FindItemAction is returning {0} rows from client store, total count={1}, indexOffset={2}",r.length,u,f);i()},function(t){n.$9I7(n.$2n.Body.ResponseMessages.Items[0],t,r)})}function $4QX(n,t,i,r){var u=n.get_$34X().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$2w.$D,"FindItem for folder '{0}' is trying to fetch {1} items from the client store",n.$wn,u);var f=this;n.$1Up(5,new _bc.$Ga(n.$2i),function(f,e){var o=e;if(!f||!$6Ug(n,n.get_$34X().Body,o)){_js.Trace.logInfo(_e.$2w.$D,"The folder is not synced in date mode or the request cannot be processed offline. Hence, rejecting the request to the server. isSynced={0}",f);n.$3w8=!0;i();return}n.get_$95().get_$4i().$50z(n.$2i.Id,n.get_$95().get_$2j(),n.get_$34X().Body,n.get_$9I5(),o,function(r,f,e){_js.Trace.logInfo(_e.$2w.$D,"Obtained {0} messages from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",r.length,o.MoreItemsOnServer,n.$mO());if(r.length<u&&o.MoreItemsOnServer&&n.$mO()||!r.length&&o.MoreItemsOnServer){_js.Trace.logInfo(_e.$2w.$D,"The client store was requested {0} rows but returned only {1} AND we are CONNECTED. Hence, rejecting the request to the server.",u,r.length);n.$3w8=!0;i();return}$4QZ(n,t,r,o.TotalCount,e);_js.Trace.logInfo(_e.$2w.$D,"FindItemAction is returning {0} rows from client store",r.length);i()},function(t){n.$9I7(n.$2n.Body.ResponseMessages.Items[0],t,r)})})}function $6Ug(n,t,i){var r=!0;if(i)if(_g.$BL.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>i.SyncMinimum&&n.$mO()){_js.Trace.logInfo(_e.$2w.$D,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,i.SyncMinimum,n.$mO());r=!1}}else if(_g.$Je.isInstanceOfType(t.Paging)){var f=t.Paging;if(_g.$Ld.isInstanceOfType(f.Condition.Item)){if(f.MaxEntriesReturned<=0||f.MaxEntriesReturned>i.SyncMinimum&&n.$mO()){_js.Trace.logInfo(_e.$2w.$D,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",f.MaxEntriesReturned,f.BasePoint,i.SyncMinimum,n.$mO());r=!1}else if(f.BasePoint==="Beginning"){var e=n.get_$95().get_$4i().$52F(i.OldestReceivedTime);var o=_a.$7.$4Y(e).$55();var s=_a.$7.$4Y(n.get_$9I5().itemReceivedTime).$55();if(s<o){_js.Trace.logInfo(_e.$2w.$D,"Requested item's received time [{0}] is less than the oldest synced item's receivedtime [{1}]. Rejecting the request to the server.",n.get_$9I5().itemReceivedTime,e);r=!1}}}else{_js.Trace.logInfo(_e.$2w.$D,"Non-supported SeekToConditionPageView paging values. Paging type is {0}",Object.getType(f.Condition.Item));r=!1}}else{_js.Trace.logInfo(_e.$2w.$D,"Non-supported paging type. PagingType={0}",t.Paging);r=!1}else{_js.Trace.logInfo(_e.$2w.$D,"Rejecting request to the server as message sync state context for the folder '{0}' is null.",n.$2i.Id);r=!1}return r}function $4QZ(n,t,i,r,u){var f=_a.$5.acss(_a.$0.$11W,"FindItem:ProcessMessages");t.RootFolder.Items=i;t.RootFolder.TotalItemsInView=r;t.RootFolder.IndexedPagingOffset=u;_a.$5.aces(f)}_e.$2w.prototype={$3x:null,$1i:null,$2n:null,$2i:null,$wn:"calendar",$2eT:!1,$3w8:!1,get_$Of:function(){return"FindItem"},get_$91U:function(){return _g.$8c.$5BS(this.get_$34X().Body)},$6xG:function(n,t,i){var f=_a.$5.acsa(_a.$0.$11W,"FindItemCheckAndExecute-Preprocessing",!0);var e=this;var u=function(){e.$s(function(){e.$3w8?i(-1):n()},t,i)};if($6Uh(this))if(_g.$Q8.isInstanceOfType(this.get_$34X().Body.Paging)){var r=this.get_$34X().Body.Paging;var s=this;this.$NL(10,new _e.$eu(this.$2i.Id,r.StartDate,r.EndDate),function(n){if(n){_a.$5.acea(f);_js.Trace.logInfo(_e.$2w.$D,"Processing the request by the offline store as the calendar module is synced.");u()}else{_js.Trace.logInfo(_e.$2w.$D,"Rejecting the call as the calendar folder is not synced OR the date range is not synced. FolderId='{0}', StartDate={1}, EndDate={2}, ",s.$2i.Id,r.StartDate,r.EndDate);i(-1)}})}else if(this.$2eT&&this.$wn==="calendar")if(_g.$Hr.isInstanceOfType(this.get_$34X().Body.Paging)){_a.$5.acea(f);_js.Trace.logInfo(_e.$2w.$D,"Processing the request by the offline store as the view is offline-only.");u()}else{var o=String.format("{0} isn't supported for calendar folders.",Object.getType(this.get_$34X().Body.Paging));_js.Trace.logInfo(_e.$2w.$D,o);t(Error.invalidOperation(o))}else if(this.get_$91U())u();else{_js.Trace.logInfo(_e.$2w.$D,"Rejecting the call as it is not supported in the client store");i(-1)}else{_js.Trace.logWarning(_e.$2w.$D,"Rejecting the call as parent folder id is not valid.");i(-1)}},$7Dt:function(n,t,i){var r=new _g.$Yg;r.ResponseCode="NoError";r.ResponseClass="Success";r.RootFolder=new _g.$Ye;this.$2n.Body.ResponseMessages.Items[0]=r;var u=this.get_$34X().Body.Paging;if(_g.$Q8.isInstanceOfType(u))$6Uc(this,r,n,t);else if(this.$2eT&&this.$wn==="calendar"&&_g.$Hr.isInstanceOfType(this.get_$34X().Body.Paging))$6Ud(this,r,n,t);else if(_g.$8c.$5DX(u)||_g.$8c.$5DZ(u)){_js.Trace.logInfo(_e.$2w.$D,"FindItem for {0} paging is using client store",Object.getType(u));if(this.$2eT)if(this.$wn==="outbox")$6Ue(this,r,n,t);else if(this.$wn==="calendar")throw Error.invalidOperation("FindItem with IndexedPageView isn't supported for calendar folders.");else $4QX(this,r,n,t);else $4QX(this,r,n,t)}else{var f=String.format("FindItem called with invalid folder ID and paging. FID={0}, Paging={1}",this.$2i.Id,Object.getType(u));throw Error.invalidOperation(f);}},$NL:function(n,t,i){this.$3x.$NL(n,t,i)},$1Up:function(n,t,i){this.$3x.$1Up(n,t,i)},$mO:function(){return _g.$1Q.$g.$AS.$NF}};_e.$Qf=function(n,t,i,r){_e.$Qf.initializeBase(this,[n,t,i]);_a.$3.$17(r,"syncManager");this.$3x=r;this.$2n=new _g.$Qh;this.$2n.Header=_e.$7w.$Tb};_e.$Qf.$7YZ=function(n){return _g.$7o.isInstanceOfType(n)&&n.Id==="directory"};function $4Qb(n,t,i,r,u){var f=this,e=this;t.$3NP(i.Offset,i.MaxEntriesReturned,n.$2i,n.get_$34X().Body.SortOrder,function(t,u){n.$2n.Body.ResponseCode="NoError";n.$2n.Body.ResponseClass="Success";n.$2n.Body.ResultSet=t;n.$2n.Body.TotalNumberOfPeopleInView=u;n.$2n.Body.FirstLoadedRowIndex=i.Offset;r()},function(t){n.$2n.Body.ResponseCode="ErrorDataSourceOperation";n.$2n.Body.ResponseClass="Error";n.$2n.Body.MessageText=t.get_$4i();u(t)})}_e.$Qf.prototype={$3x:null,$2n:null,$2i:null,get_$Of:function(){return"FindPeople"},$6xG:function(n,t,i){var r=this.get_$34X().Body.ParentFolderId?this.get_$34X().Body.ParentFolderId.BaseFolderId:null;var f=_g.$3J.isInstanceOfType(r);if(!_js.$8.$c(this.get_$34X().Body.QueryString)||this.get_$34X().Body.Restriction||this.get_$34X().Body.AggregationRestriction||!f||_e.$Qf.$7YZ(r)||_g.$8c.$3hw(r))i(-1);else{var u=this;this.$3x.$NL(8,new _a.$H5,function(f){if(f)if(_g.$7o.isInstanceOfType(r))_a.$3.$8z(!1,"FindPeople is not supported with DistinguishedFolderId as ParentFolderId, offending Folder Id: "+r.Id);else{u.$2i=r;u.$s(n,t,i)}else i(-1)})}},$7Dt:function(n,t,i){_a.$3.$6v(this.get_$34X().Body.SortOrder.length,1,2,"expecting 1 - 2 sort columns");_a.$3.$8z(_g.$BL.isInstanceOfType(this.get_$34X().Body.IndexedPageItemView)||_g.$Hr.isInstanceOfType(this.get_$34X().Body.IndexedPageItemView),"Browse People only support IndexedPageView or SeekToConditionWithOffsetPageView.");var r=_e.$5T.$I(this.get_$95());if(_g.$BL.isInstanceOfType(this.get_$34X().Body.IndexedPageItemView)){var o=this.get_$34X().Body.IndexedPageItemView;$4Qb(this,r,o,n,t);return}var s=_a.$5.acsa(_a.$0.$9C,"FindPeople.SeekToCondition",!0);var u=this.get_$34X().Body.IndexedPageItemView;var e=this,f=this;r.$8vT(u.Condition,this.$2i,this.get_$34X().Body.SortOrder,function(i){_a.$5.acea(s);e.$2n.Body.FirstMatchingRowIndex=i;var f=new _g.$BL("Beginning");f.Offset=Math.max(0,i+u.Offset);f.MaxEntriesReturned=u.MaxEntriesReturned;$4Qb(e,r,f,n,t)},function(n){f.$2n.Body.ResponseCode="ErrorDataSourceOperation";f.$2n.Body.ResponseClass="Error";f.$2n.Body.MessageText=n.get_$4i();t(n)})}};_e.$Ms=function(n,t,i,r){this.$IA=-1;_e.$Ms.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);this.$3x=r;this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$Qo;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};_e.$Ms.prototype={$3x:null,$2n:null,$8R:null,$70:!1,get_$Of:function(){return"GetFolder"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(2,new _a.$H5,function(u){u?r.$s(function(){r.$70?i(r.$IA):n()},t,i):i(301)})},$7Df:function(n,t,i,r){var e=this.get_$34X().Body.FolderIds[n];var u=new _g.$Yp;u.ResponseCode="NoError";u.ResponseClass="Success";u.Folders=new Array(0);this.$8R[n]=u;var o=u.Folders;if(_g.$7o.isInstanceOfType(e)){var f=e;if(f.Id==="archivemsgfolderroot"){this.$70=!0;this.$IA=100;t()}else if(f.Mailbox){_js.Trace.logInfo(_e.$Ms.$D,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",f.Mailbox.EmailAddress);this.$70=!0;this.$IA=100;t()}else{var h=this,c=this;_e.$7i.$1SK(this.get_$95().get_$2j(),f.Id,function(n){if(n)o[o.length]=n.get_$1s();else{_js.Trace.logWarning(_e.$Ms.$D,"Could not find folder with DistinguishedFolderId = {0} in the ClientStore",f.Id);var i=new _g.$D9;i.DisplayName=_e.$7i.$3wU}t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.get_$4i();i(n)})}}else{var s=this,l=this,a=this;this.$AK(function(n){s.get_$95().get_$2j().$Da(n,_e.$1X.$54(e.Id),function(n){if(n)o[o.length]=n.get_$1s();else{_js.Trace.logInfo(_e.$Ms.$D,"Could not find folder with id = {0} in the ClientStore - rejecting command.",e.Id);s.$70=!0;s.$IA=302}},null)},function(){t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.$4P;_e.$1W.$BC(n,i)})}}};_e.$Qn=function(n,t,i){_e.$Qn.initializeBase(this,[n,t]);_a.$3.$17(i,"syncManager");this.$3x=i;this.$2n=null};_e.$Qn.prototype={$3x:null,$2n:null,get_$Of:function(){return"GetCalendarFolders"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(9,new _a.$H5,function(u){if(u){_js.Trace.logInfo(_e.$Qn.$D,"Executing offline GetCalendarFolders command.");r.$s(n,t,i)}else{_js.Trace.logInfo(_e.$Qn.$D,"Offline GetCalendarFolders command rejected.");i(301)}})},$7Dt:function(n,t,i){var r=this;this.get_$48C().$1ki(function(t){r.$2n=t;n()},t)}};_e.$9a=function(n,t,i){this.$IA=-1;this.$3jg={};_e.$9a.initializeBase(this,[n,t,i]);_a.$3.$M(n.lastModifiedTimeDictionary,"lastModifiedTimeDictionary");this.$2n=new _g.$OO;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8};_e.$9a.$$cctor=function(){_e.$5k.$$(_g.$fv).$9I3("GetConversationItems")};function $6Uk(n,t){for(var e=n.$260.get_$1s().ConversationId.Id,u=n.$260.get_$1s().ConversationNodes,o=u.length,i=0;i<o;++i)for(var f=u[i],r=0;r<f.Items.length;r++){var s=f.Items[r];n.$3An++;var h=this;n.get_$95().get_$4i().$Da(t,_e.$1X.$54(s.ItemId.Id),function(t){if(t&&_e.$B6.$6z7(t.get_$1s(),0)){_js.Trace.logInfo(_e.$9a.$D,"Adding item with id '{0}' to the dictionary for conversation with id '{1}'",t.get_$1s().ItemId.Id,e);n.$3jg[t.get_$1s().ItemId.Id]=t.get_$1s();n.$4Dy++}},null)}}function $6Ul(n){for(var u=n.$260.get_$1s().ConversationNodes,f=u.length,i=0;i<f;++i)for(var r=u[i],t=0;t<r.Items.length;t++){var e=n.$3jg[r.Items[t].ItemId.Id];r.Items[t]=e}}function $6Uj(n,t){n.$2n.Body.ResponseMessages.Items=new Array(t.length);for(var i=0;i<t.length;i++){var r=new _g.$Z8;r.ResponseCode="NoError";r.ResponseClass="Success";r.Conversation=t[i].get_$1s();n.$2n.Body.ResponseMessages.Items[i]=r}}function $6Um(n,t){for(var u=t,o=u.length,r=0;r<o;++r){var i=u[r];var f=n.get_$9I5().lastModifiedTimeDictionary[i.get_$1s().ConversationId.Id];var e=_a.$7.$4Y(i.get_$1s().LastModifiedTime).$55();if(e<f){_js.Trace.logInfo(_e.$9a.$D,"LastModifiedTime does not match for conversation with id {0}, client store item value = {1}:{2}, requested value = {3}",i.get_$1s().ConversationId.Id,i.get_$1s().LastModifiedTime,e,f);return!0}}return!1}_e.$9a.prototype={$2n:null,$70:!1,$3An:0,$4Dy:0,$260:null,get_$Of:function(){return"GetConversationItems"},$6xG:function(n,t,i){var r=this.get_$9I5().currentUserOptionsSortOrder;if($8(r)||r===this.get_$34X().Body.SortOrder)if($8(this.get_$9I5().currentUserOptionsIgnoringDeletedItems)||this.get_$9I5().currentUserOptionsIgnoringDeletedItems===this.get_$9I5().requestIgnoringDeleteditems)if(this.get_$34X().Body.MaxItemsToReturn<=20){var u=this;this.$s(function(){if(u.$70){_js.Trace.logInfo(_e.$9a.$D,"Client store unable to fulfil request. Forwarding request to the server.");i(u.$IA)}else n()},t,i)}else{_js.Trace.logInfo(_e.$9a.$D,"{0} requested item parts is greater than {1} itemparts supported by the clientstore. Hence, rejecting the request",this.get_$34X().Body.MaxItemsToReturn,20);i(100)}else{_js.Trace.logInfo(_e.$9a.$D,"Request specified a Hide Deleted Items option of {0} while the current UserOptions has Hided Deleted Items set to {1}, rejecting the request",this.get_$9I5().requestIgnoringDeleteditems,this.get_$9I5().currentUserOptionsIgnoringDeletedItems);i(304)}else{_js.Trace.logInfo(_e.$9a.$D,"Request specified SortOrder of {0} while the current UserOptions has set SortOrder to {1}, rejecting the request",this.get_$34X().Body.SortOrder,r);i(304)}},$7Dt:function(n,t,i){var e=this.get_$34X().Body.Conversations;_a.$3.$6v(e.length,1,1,"Invalid number of conversations requested. Number = "+e.length);var o=new _e.$ge(_a.$69.$I());if(o.get_$7C9()){_js.Trace.logInfo(_e.$9a.$D,"Offline email data is outdated, forwarding request to the server.");this.$70=!0;this.$IA=301;n()}else{var f=_e.$1X.$54(e[0].ConversationId.Id);var u=this,r=this,s=this;this.$AK(function(n){u.get_$95().get_$Hi().$Da(n,f,function(t){u.$260=t;if(t&&!$6Um(u,[t]))$6Uk(u,n);else{u.$70=!0;u.$IA=t?306:305;_js.Trace.logInfo(_e.$9a.$D,"id '{0}' rejectCode: {1}, forwarding request to the server",f,_0365f.$Ow.toString(u.$IA))}},null)},function(){if(!r.$70&&r.$3An>0&&r.$3An===r.$4Dy){_js.Trace.logInfo(_e.$9a.$D,"All items found for conversation with id '{0}'. Providing data to the caller",f);$6Ul(r);$6Uj(r,[r.$260]);n()}else{_js.Trace.logInfo(_e.$9a.$D,"Couldn't find all items for conversation with id '{0}', forwarding request to the server. Total items requested = {1}, total items found = {2}",f,r.$3An,r.$4Dy);r.$70=!0;r.$IA=302;n()}},function(n){t(new _e.$1W(new _a.$8t(0,n.$4P)))})}}};_e.$kv=function(n,t,i){_e.$kv.initializeBase(this,[n,t]);_a.$3.$17(i,"syncManager");this.$3x=i;this.$2n=null};_e.$kv.prototype={$3x:null,$2n:null,get_$Of:function(){return"GetFavoriteFolders"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(6,new _a.$H5,function(u){u?r.$s(n,t,i):i(301)})},$7Dt:function(n,t,i){var r=this;this.get_$48C().$3ZY(function(t){r.$2n=t;n()},t)}};_e.$68=function(n,t,i){this.$IA=-1;this.$Iw=0;_e.$68.initializeBase(this,[n,t,i,i.Body.ItemIds.length]);this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$OP;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};_e.$68.$$cctor=function(){_e.$5k.$$(_g.$UA).$9I3("GetItem")};function $6Up(n,t,i){return _bc.$KG.isInstanceOfType(t)?$6Uq(n,t,i):_bc.$KB.isInstanceOfType(t)?$6Un(n,t,i):_bc.$JF.isInstanceOfType(t)?$6Uo(n,t,i):!0}function $6Ur(n,t,i,r,u){var f=null;var e=null;var o=this,s=this,h=this;n.$AK(function(i){n.get_$95().get_$1o().$Da(i,_e.$1X.$54(t.OccurrenceId),function(r){if(r&&r.get_$1s()){f=r.get_$12V();_e.$Ch.$3N8(i,n.get_$95().get_$hL(),f,function(n){e=n})}else _js.Trace.logInfo(_e.$68.$D,"GetCalendarItem: Occurrence with id {0} not found in local store",t.OccurrenceId)},null)},function(){if(f)$3GC(n,f,e,i,r);else{n.$70=!0;n.$IA=302;r()}},function(t){_e.$1W.$BC(t,function(t){n.$9I7(i,t,u)})})}function $3GC(n,t,i,r,u){var f=_a.$5.acss(_a.$0.$3a0,"CheckAndReturnItemFromClientStore");r.ResponseCode="NoError";r.ResponseClass="Success";r.Items=new Array(0);var e=r.Items;if(i&&i.get_$4F5())if($6Up(n,i,n.get_$34X().Body.ItemShape)){_js.Trace.logInfo(_e.$68.$D,"Item {0} retrieved for local store satisfies request.",i.get_$1y());e[0]=i.get_$4F5()}else{_js.Trace.logWarning(_e.$68.$D,"Item {0} retrieved for local store does not satisfy request.",i.get_$1y());n.$70=!0;n.$IA=303}else{_js.Trace.logInfo(_e.$68.$D,"Item with id {0} not found in local store",t);n.$70=!0;n.$IA=302}u();_a.$5.aces(f)}function $6Uq(n,t,i){var r=t.get_$1s();var u=!1;if(n.get_$9I5().requireNormalizedBody&&!t.get_$1s().NormalizedBody){_js.Trace.logInfo(_e.$68.$D,"Item with id {0} does not contain the NormalizedBody shape. So rejecting to server.",t.get_$1y());n.$70=!0;n.$IA=303}else if(i.BodyType){if(r.Body)if(r.Body.BodyType==="HTML"&&i.BodyType==="HTML"||r.Body.BodyType==="Text"&&i.BodyType==="Text"){_js.Trace.logInfo(_e.$68.$D,"Message body type matches response shape body type. ItemId: {0} body type: {1}",r.ItemId.Id,r.Body.BodyType);u=!0}else _js.Trace.logInfo(_e.$68.$D,"Message body type doesn't match response shape body type. ItemId: {0}  Message body type: {1}  Response shape body type: {2}",r.ItemId.Id,r.Body.BodyType,i.BodyType);else if(_e.$16.$1oX(r.__type)){var f=t.get_$1s();if(f.NewBodyContent){_js.Trace.logInfo(_e.$68.$D,"Item is a SmartResponse. ItemId: {0}",r.ItemId.Id);u=!0}else throw Error.invalidOperation(String.format("SmartResponse.NewBodyContent is undefined. ItemId: {0}",r.ItemId.Id));}}else u=!0;return u}function $6Un(n,t,i){return $4Qd(n,t.get_$1s(),i)}function $6Uo(n,t,i){return $4Qd(n,t.get_$1s(),i)}function $4Qd(n,t,i){if(i.BodyType==="Text"){t.TextBody||(t.TextBody=new _g.$67("Text",t.Preview));t.Body=t.TextBody}if(t.Body.IsTruncated){_js.Trace.logWarning(_a.$0.$Ag,"Truncated body type {0} on item with id {1}. Rejecting call.",t.Body.BodyType,t.ItemId.Id);n.$Iw=16;return!1}t.TextBody=undefined;return!0}_e.$68.prototype={$2n:null,$8R:null,$70:!1,get_$Of:function(){return"GetItem"},$6xG:function(n,t,i){if(this.get_$9I5().clientStoreItem){var r=this;this.$s(function(){r.$70?i(r.$IA):n()},t,i)}else{_js.Trace.logInfo(_e.$68.$D,"ClientStoreItem.None was passed. Request will be sent to the server.");i(100)}},$7Df:function(n,t,i,r){if(this.$70){t();return}var u=new _g.$Uq;this.$8R[n]=u;var f=this.get_$34X().Body.ItemIds[n];if(this.get_$9I5().clientStoreItem===2)this.$9Jt(_bc.$KG,f,u,this.get_$95().get_$4i(),t,i);else if(this.get_$9I5().clientStoreItem===3)this.$9Jt(_bc.$12M,f,u,this.get_$95().get_$ch(),t,i);else if(this.get_$9I5().clientStoreItem===1)if(f.__type===_g.$78._dataContractName){var c=f;$6Ur(this,c,u,t,i)}else if(f.__type===_g.$S8._dataContractName){_js.Trace.logInfo(_e.$68.$D,"GetCalendarItem: RecurringMasterItemIdRanges isn't supported on offline getitem service command. Rejecting call.");this.$70=!0;this.$IA=100;t()}else{var o=null;var s=f;var e=_e.$1X.$54(s.Id);var h=this,l=this,a=this;this.$AK(function(n){_js.Trace.logInfo(_e.$68.$D,"GetCalendarItem: Trying to find item with Id {0} in CalendarItem table",e);h.get_$95().get_$1o().$Da(n,e,function(t){if($8(t)||$8(t.get_$1s())){_js.Trace.logInfo(_e.$68.$D,"GetCalendarItem: Trying to find item with Id {0} in CalendarRecurrenceMaster table",e);h.get_$95().get_$hL().$Da(n,e,function(n){o=n},null)}else o=t},null)},function(){$3GC(l,s.Id,o,u,t)},function(n){_e.$1W.$BC(n,function(n){a.$9I7(u,n,i)})})}else{this.$70=!0;this.$IA=100;t()}},$9Jt:function(n,t,i,r,u,f){var e=t;_js.Trace.logInfo(_e.$68.$D,"GetItem called for id {1}",e.Id);var o=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;var c=this,s=this,h=this;this.$AK(function(n){r.$1d0(n,_e.$1X.$54(e.Id),function(n){o=n},null)},function(){$3GC(s,e.Id,o,i,u)},function(n){_js.Trace.logInfo(_e.$68.$D,"GetItem. Reporting store error {0}. id {1}",n.$4P,e.Id);h.$9I7(i,new _e.$1W(n),f)})}};_e.$Mw=function(n,t){_e.$Mw.initializeBase(this,[n,t])};_e.$Mw.prototype={$t:null,get_$Of:function(){return"GetOwaUserConfiguration"},$6xG:function(n,t,i){var r=this,u=this;this.get_$48C().$lu(function(u){r.$t=u;if(r.$t)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$Mw.$D,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}},function(n){_js.Trace.logInfo(_e.$Mw.$D,"GetOwaUserconfiguration: Failed to load : {0}",n.get_$4i());t(Error.create(n.get_$4i()))})},$7Dt:function(n,t,i){if(this.$t)n();else{_js.Trace.logInfo(_e.$Mw.$D,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}}};_e.$kz=function(n,t,i){_e.$kz.initializeBase(this,[n,t]);_a.$3.$17(i,"syncManager");this.$3x=i;this.$2n=null};_e.$kz.prototype={$3x:null,$2n:null,get_$Of:function(){return"GetOtherMailboxConfiguration"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(13,new _a.$H5,function(u){u?r.$s(n,t,i):i(301)})},$7Dt:function(n,t,i){var r=this;this.get_$48C().$15b(function(t){r.$2n=t;n()},t)}};_e.$10N=function(n,t,i){_e.$10N.initializeBase(this,[n,t]);_a.$3.$17(i,"syncManager");this.$3x=i};_e.$10N.prototype={$3x:null,$As:null,get_$Of:function(){return"GetPeopleFilters"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(7,new _a.$H5,function(u){u?r.$s(n,t,i):i(301)})},$7Dt:function(n,t,i){var r=this,u=this;_e.$FW.$1Sg(this.get_$95().get_$40j(),function(t){r.$As=new Array(t.length);for(var i=0;i<t.length;++i)r.$As[i]=t[i].get_$1s();n()},function(n){t(n)})}};_e.$10P=function(n,t,i,r){_e.$10P.initializeBase(this,[n,t,i]);_a.$3.$17(r,"syncManager");this.$3x=r;this.$2n=new _g.$Qp;this.$2n.Header=_e.$7w.$Tb};_e.$10P.prototype={$3x:null,$2n:null,$3XQ:!1,get_$Of:function(){return"GetPersona"},$6xG:function(n,t,i){if(this.get_$34X().Body.EmailAddress){i(100);return}if(this.get_$9I5().hasGALComponent){this.$3XQ=!0;i(303);return}_a.$3.$17(this.get_$34X().Body.PersonaId,"PersonaId");_a.$3.$17(this.get_$34X().Body.PersonaId.Id,"PersonaId.Id");var r=this;this.$3x.$NL(8,new _a.$H5,function(u){u?r.$s(function(){if(r.$2n.Body.Persona)if(r.$2n.Body.Persona.ADObjectId){r.$3XQ=!0;i(303)}else n();else i(302)},t,i):i(301)})},$7Dt:function(n,t,i){var r=this,f=this,u=this;this.$AK(function(n){var t=_e.$5T.$I(r.get_$95());t.$Da(n,r.get_$34X().Body.PersonaId,function(n){if(n){r.$2n.Body.ResponseCode="NoError";r.$2n.Body.ResponseClass="Success";r.$2n.Body.Persona=n}else{r.$2n.Body.ResponseCode="ErrorItemNotFound";r.$2n.Body.ResponseClass="Error"}},null)},function(){n()},function(n){_e.$1W.$BC(n,function(n){u.$9I7(u.$2n.Body,n,t)})})}};_e.$KW=function(n,t,i){this.$Iw=0;_e.$KW.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $6VO(n,t,i,r){var u=this,f=this;n.$AK(function(i){n.get_$4i().$3UF(i,n.get_$Hh(),"HardDelete",t,null,n.get_$5HW())},function(){i()},_e.$1W.$WX(r))}_e.$KW.prototype={$70:!1,get_$Of:function(){return"MoveItem"},$6xG:function(n,t,i){if(this.get_$9I5().clientStoreItem===2){var r=this;this.$s(function(){r.$70?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$KW.$D,"ClientStoreItem.{0} was passed. Request will be sent to the server.",this.get_$9I5().clientStoreItem);i(-1)}},$7Df:function(n,t,i,r){if(this.$70){t();return}var f=this.get_$34X().Body.ItemIds[n];if(!_g.$1j.isInstanceOfType(f)){this.$70=!0;this.$Iw=12;t();return}var u=f;_js.Trace.logInfo(_e.$KW.$D,"Step {0} called for id {1}",n.toString(),u.Id);var e=this,o=this;$6VO(this,u,function(){_js.Trace.logInfo(_e.$KW.$D,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}};_e.$bB=function(n,t,i,r){this.$$d_$2fp=Function.createDelegate(this,this.$2fp);this.$91=-1;this.$678="";_e.$bB.$$(this.$$gta["_e.$bB"].TRequest,this.$$gta["_e.$bB"].TActionContext).initializeBase(this,[n,t,i]);this.$4Ay=r};_e.$bB.$$=function(n,t){var i="$bB"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$bB"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$bB.apply(this,r)};u.registerClass("_e."+i,_e.$Wt.$$(n,t));var f=_e.$bB.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$bB.prototype={$4Ay:0,$4vV:null,$4vS:null,$4vU:null,get_$9Jf:function(){return this.$4Ay},$7Dt:function(n,t,i){this.$4vV=n;this.$4vS=t;this.$4vU=i;this.$2fp()},$9Jg:function(n){_a.$3.$M(n,"itemId");this.$678="ItemId ="+JsonParser.serialize(n)},$2fp:function(){this.$91++;this.$91===this.$4Ay?this.$4vV():this.$7Df(this.$91,this.$$d_$2fp,this.$4vS,this.$4vU)}};_e.$9C=function(n,t,i,r){_e.$9C.initializeBase(this,[n,t,i]);_a.$3.$17(r,"syncManager");this.$3x=r;this.$2n=new _g.$VJ;this.$2n.Header=_e.$7w.$Tb};function $6VP(n,t,i){var r=n.get_$95().get_$jj();var u=this;r.$Da(t,_e.$1X.$54(i.Id),function(u){if(!u||!u.get_$1s()){_js.Trace.logWarning(_e.$9C.$D,"PerformReminderAction-Dismiss: Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction-Dismiss: Reminder item with id {0} found in client store. Dismissing it.",u.get_$1y());r.$GW(t,u.get_$1y());_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction-Dismiss: Successfully deleted (dismissed) reminder item with id {0} from client store.",u.get_$1y());$6VR(n,t,i,u.get_$1s())},null)}function $6VR(n,t,i,r){var u=this;n.get_$95().get_$1o().$1BX(t,_e.$1X.$54(i.Id),function(n){if($8(n)){var u=String.format("PerformReminderAction-Dismiss: Calendar item with id {0} not found in local store. Calendar item couldn't be updated for reminder with Subject:{1}, Reminder Time: {2}, Start date:{3}, End date {4}.",i.Id,r.Subject,r.ReminderTime.toString(),r.StartDate.toString(),r.EndDate.toString());_js.Trace.logWarning(_e.$9C.$D,u);return}var t=n;t.ReminderIsSet=!1;_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction-Dismiss: Successfully updated calendar item with id {0} from client store.",t.ItemId.Id)})}function $6VQ(n,t,i,r){var u=this;n.get_$95().get_$jj().$1BX(t,_e.$1X.$54(i.Id),function(n){if($8(n)){_js.Trace.logWarning(_e.$9C.$D,"PerformReminderAction-Snooze: Reminder item with id {0} not found in local store",i.Id);return}var t=n;t.ReminderTime=_a.$7.$eV(r);_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction-Snooze: Successfully updated (snooze) reminder item with id {0} from client store.",t.ItemId.Id)})}_e.$9C.prototype={$3x:null,$2n:null,get_$Of:function(){return"PerformReminderAction"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(3,new _a.$H5,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction: Rejecting the call as the reminder module is not synced");i(-1)}})},$7Dt:function(n,t,i){var r=this,u=this,f=this;this.$AK(function(n){for(var u=r.get_$34X().Body.ReminderItemActions,e=u.length,i=0;i<e;++i){var t=u[i];var f=t.ItemId;if(t.ActionType)if(t.ActionType===1){var o=_a.$7.$4Y(t.NewReminderTime);$6VQ(r,n,f,o)}else throw Error.argument("ActionType",String.format("Reminder Action Type not supported {0}",_g.$uK.toString(t.ActionType)));else $6VP(r,n,f)}},function(){_js.Trace.logInfo(_e.$9C.$D,"PerformReminderAction: Successfully performed reminder actions to local store.");u.$2n.Body.ResponseCode="NoError";u.$2n.Body.ResponseClass="Success";n()},function(n){_js.Trace.logError(_e.$9C.$D,"PerformReminderAction: Failed to perform reminder actions to local store.");var i=new _e.$1W(new _a.$8t(0,n.$4P));f.$9I7(f.$2n.Body,i,t)})}};_e.$cI=function(n,t,i,r){_e.$cI.initializeBase(this,[n,t]);_a.$3.$17(i,"personaId");_a.$3.$17(r,"syncManager");this.$8w=i;this.$3x=r};_e.$cI.prototype={$8w:null,$3x:null,get_$Of:function(){return"RemoveFavorite"},$6xG:function(n,t,i){var r=this;this.$3x.$NL(8,new _a.$H5,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logWarning(_e.$cI.$D,"Couldn't find the persona because people module wasn't synced.");i(-1)}})},$7Dt:function(n,t,i){var r=this,u=this,f=this;this.$AK(function(n){var t=_e.$5T.$I(r.get_$95());t.$Da(n,r.$8w,function(i){if(i){i.IsFavorite=!1;if(i.FolderIds)for(var u=_g.$1v.$9K("favorites"),r=0;r<i.FolderIds.length;r++)if(_g.$1v.$4F(u,i.FolderIds[r])){Array.removeAt(i.FolderIds,r);break}t.$gO(n,i,0,null)}else _a.$8t.$v0(2,"PersonaId to update is not present in persona store")},null)},function(){n()},function(n){_e.$1W.$BC(n,t)})}};_e.$7w=function(){};_e.$7w.$$cctor=function(){_e.$7w.$Tb=new _g.$aO;_e.$7w.$Tb.ServerVersionInfo=new _g.$cj;_e.$7w.$Tb.ServerVersionInfo.Version="Exchange2013"};_e.$5k=function(n,t){_a.$3.$M(n,"actionContext");_a.$3.$M(t.get_$95(),"serviceCommandContext.ItemStoreGetter");_a.$3.$1C(t.get_$IJ(),"serviceCommandContext.TimeZone");this.$Mi=n;this.$5yj=t;this.$7y=t.get_$95()};_e.$5k.$$=function(n){var i="$5k"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[i]){var t=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$5k"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$5k.apply(this,i)};t.registerClass("_e."+i);var u=_e.$5k.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$9I3=function(n){_a.$3.$8z(!t.$Vy[0][n],"PerfCounter for "+n+" already exists");var r=new _a.$Bh("Svc","BHits",4,!1,n);t.$Vy[0][n]=r;var i=new _a.$Bh("Svc","SHits",2,!1,n);i.set_$1ZN(r);t.$Vy[1][n]=i;i=new _a.$Bh("Svc","FHits",2,!1,n);i.set_$1ZN(r);t.$Vy[2][n]=i;i=new _a.$Bh("Svc","RHits",2,!1,n);i.set_$1ZN(r);t.$Vy[3][n]=i};t.$2ki=function(n,t){var i=t[n];i&&i.$1mB()};t.$Vy=new Array(4);t.$$cctor=function(){for(var n=0;n<4;n++)t.$Vy[n]={}};t.$$cctor()}return _e[i]};_e.$5k.prototype={$Mi:null,$5yj:null,$2GJ:null,$2bU:null,$3O0:null,$Dv:null,$7y:null,$34Y:null,$2dj:null,get_$4i:function(){this.$2GJ||(this.$2GJ=new _e.$go(this.$7y));return this.$2GJ},get_$Hh:function(){this.$2bU||(this.$2bU=new _e.$BI(this.$7y));return this.$2bU},get_$9I4:function(){this.$3O0||(this.$3O0=new _e.$9V(this.$7y));return this.$3O0},get_$9I5:function(){return this.$Mi},get_$79n:function(){return this.$2dj},set_$79n:function(n){this.$34Y&&(this.$34Y.$1iw=n);this.$2dj=n;return n},get_$48C:function(){this.$Dv||(this.$Dv=new _e.$9O(this.$7y));return this.$Dv},get_$95:function(){return this.$7y},get_$5HW:function(){return _g.$1Q.$g},$9I6:function(n,t,i){this.$34Y=OwaApplication.get_$1LC().$5tq(this.get_$Of(),!0);_e.$5k.$$(this.$$gta["_e.$5k"].TActionContext).$2ki(this.get_$Of(),_e.$5k.$$(this.$$gta["_e.$5k"].TActionContext).$Vy[0]);if(this.$5yj.get_$7b9()){var f=null;var o=_a.$5.ads(_a.$0.$DO,"OfflineInvoke_"+this.get_$Of());var u=this,r=this,e=this;this.$6xG(function(){_a.$5.are(f);var t=_a.$5.aes(_a.$0.$DO,"OfflineResponse_"+u.get_$Of());try{u.$3Q2(200);n()}finally{_e.$5k.$$(u.$$gta["_e.$5k"].TActionContext).$2ki(u.get_$Of(),_e.$5k.$$(u.$$gta["_e.$5k"].TActionContext).$Vy[1]);_a.$5.aee(t)}},function(n){_a.$5.are(f);var i=_a.$5.aes(_a.$0.$DO,"OfflineResponseFailed_"+r.get_$Of());try{r.set_$79n(n.message);r.$3Q2(500);t(n)}finally{_e.$5k.$$(r.$$gta["_e.$5k"].TActionContext).$2ki(r.get_$Of(),_e.$5k.$$(r.$$gta["_e.$5k"].TActionContext).$Vy[2]);_a.$5.aee(i)}},function(n){_a.$5.are(f);var t=_a.$5.aes(_a.$0.$DO,"OfflineResponseRejected_"+e.get_$Of()+"_"+_0365f.$Ow.toString(n));try{e.$5sQ(n,i)}finally{_a.$5.aee(t)}});_a.$5.ade(o);f=_a.$5.ars(_a.$0.$DO,"OfflineRequest_"+this.get_$Of())}else{var s=_a.$5.ads(_a.$0.$DO,"CommandRejected_"+this.get_$Of());_js.Trace.logWarning(_a.$0.$Jo,"The offline component is not ready to use yet. {0} is rejected.",this.get_$Of());this.$5sQ(1,i);_a.$5.ade(s)}},$s:function(n,t,i){var r=this;this.$7Dt(n,function(n){t(n.$IU())},i)},$9I7:function(n,t,i){n.ResponseCode="ErrorDataSourceOperation";n.ResponseClass="Error";n.MessageText=t.get_$4i();_js.Trace.logError(_a.$0.$Jo,"Processing clientstore error '{0}' in servicecommand {1}",t.get_$4i(),this.get_$Of());i(t)},$AK:function(n,t,i){this.$7y.$AK(new _a.$6L(this.get_$Of()),n,t,i)},$9I8:function(n,t,i,r){this.$7y.$AK(n,t,i,r)},$3Zf:function(n){return _g.$7o.isInstanceOfType(n)?_g.$g.$1i.nameToId(n.Id):n},$3Q2:function(n){_js.Trace.logInfo(_a.$0.$Jo,"ServiceCommand {0} completed. Status {1}. Details {2}",this.get_$Of(),n,this.$2dj);OwaApplication.get_$1LC().$5tk(this.$34Y,n,this.$2dj,null,null)},$5sQ:function(n,t){_e.$5k.$$(this.$$gta["_e.$5k"].TActionContext).$2ki(this.get_$Of(),_e.$5k.$$(this.$$gta["_e.$5k"].TActionContext).$Vy[3]);_js.Trace.logInfo(_a.$0.$Jo,"Rejecting the service command '{0}' from the offline component (Reason: {1})...",this.get_$Of(),_0365f.$Ow.toString(n));this.$3Q2(302);this.$Mi.offlineRejectCode=n;t()}};_e.$ct=function(n,t,i){_e.$ct.initializeBase(this,[n,t]);this.$2yS=i};_e.$ct.prototype={$2yS:null,get_$Of:function(){return"SetLayoutSettings"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Dt:function(n,t,i){_js.Trace.logInfo(_e.$ct.$D,"SetLayoutSettings ExecuteInternal invoked.");this.get_$48C().$1y8(this.$2yS,n)}};_e.$16l=function(n,t,i){_e.$16l.initializeBase(this,[n,t]);this.$2K6=i};_e.$16l.prototype={$2K6:null,get_$Of:function(){return"SetTimeZone"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Dt:function(n,t,i){this.get_$48C().$36n(this.$2K6,n)}};_e.$7A=function(n,t,i){this.$Iw=0;_e.$7A.initializeBase(this,[n,t,i,i.Body.ItemChanges.length]);this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$Pm;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R};function $6W8(n,t,i,r){r.val=0;if(t.IsMeeting){r.val=6;return!0}else if(t.CalendarItemType==="RecurringMaster"){r.val=7;return!0}for(var u=0;u<i.length;u++)if(i[u].Path.__type===_g.$1i._dataContractName){var f=i[u].Path;switch(f.FieldURI){case"RequiredAttendees":case"OptionalAttendees":case"Resources":r.val=9;return!0;case"Recurrence":r.val=t.CalendarItemType==="Single"?2:8;return!0}}return!1}function $6WA(n,t,i,r,u){var e=!1;r.val=i.StartWallClock;u.val=i.EndWallClock;for(var f=0;f<t.length;f++)if(t[f].__type===_g.$6p._dataContractName&&t[f].Item.__type===_g.$6P._dataContractName&&t[f].Path.__type===_g.$1i._dataContractName){var o=t[f].Item;var s=t[f].Path;switch(s.FieldURI){case"Start":r.val=o.Start;e=!0;break;case"End":u.val=o.End;e=!0;break}}return e}function $6WD(n,t,i){for(var r=0;r<i.length;r++)if(i[r].__type===_g.$6p._dataContractName)$6WB(n,t,i[r]);else if(i[r].__type===_g.$Dd._dataContractName)$6W9(n,t,i[r]);else break;t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception")}function $6WB(n,t,i){var u=null;if(i.Path.__type===_g.$1i._dataContractName)u=i.Path;else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));var r=null;if(i.Item.__type===_g.$6P._dataContractName)r=i.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property update item type {0} is not supported.",Object.getType(i.Item).getName()));switch(u.FieldURI){case"Subject":t.Subject=r.Subject;break;case"Body":t.Body=r.Body;_e.$9V.$41x(t);break;case"IsAllDayEvent":t.IsAllDayEvent=r.IsAllDayEvent;break;case"StartTimeZone":t.StartTimeZoneId=r.StartTimeZone.Id;break;case"Start":t.Start=r.Start;t.StartWallClock=r.Start;break;case"EndTimeZone":t.EndTimeZoneId=r.EndTimeZone.Id;break;case"End":t.End=r.End;t.EndWallClock=r.End;break;case"LegacyFreeBusyStatus":t.FreeBusyType=r.FreeBusyType;break;case"ReminderIsSet":t.ReminderIsSet=r.ReminderIsSet;break;case"ReminderMinutesBeforeStart":t.ReminderMinutesBeforeStart=r.ReminderMinutesBeforeStart;break;case"Sensitivity":t.Sensitivity=r.Sensitivity;break;case"Location":case"EnhancedLocation":t.Location=r.Location;break;case"Categories":t.Categories=r.Categories;break;case"InboxReminders":t.InboxReminders=r.InboxReminders;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-SetProperty: Field uri {0} is not supported.",u.FieldURI));}}function $6W9(n,t,i){var r=null;if(i.Path.__type===_g.$1i._dataContractName)r=i.Path;else throw Error.argument(String.format("UpdateCalendarItem-DeleteProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));switch(r.FieldURI){case"Location":case"EnhancedLocation":t.Location=null;break;case"InboxReminders":t.InboxReminders=null;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-DeleteProperty: Field uri {0} is not supported.",r.FieldURI));}}function $6WE(n,t,i,r){var u=_e.$1X.$54(i.ItemId.Id);var f=n.get_$95().get_$jj();if(i.ReminderIsSet){var e=this;f.$1BX(t,u,function(f){if($8(f)){_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Reminder is set but no reminder with id {0} was found in local store. Creating a reminder.",i.ItemId.Id);n.get_$9I4().$45u(t,i,i.ItemId,function(n){_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Reminder with id {0} created successfuly.",n)})}else{_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Reminder with id {0} found. Updating properties.",u);var e=f;$6WF(n,e,i,r)}})}else{_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Reminder not set on calendar item with id {0}. Deleting reminder if one exist.",i.ItemId.Id);f.$GW(t,u)}}function $6WF(n,t,i,r){for(var u=0;u<r.length;u++)r[u].__type===_g.$6p._dataContractName?$6WC(n,t,i,r[u]):_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Property update type {0} is not handled for reminders.",Object.getType(r[u]).getName())}function $6WC(n,t,i,r){var f=null;if(r.Path.__type===_g.$1i._dataContractName)f=r.Path;else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property path type {0} is not supported.",Object.getType(r.Path).getName()));var u=null;if(r.Item.__type===_g.$6P._dataContractName)u=r.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property update item type {0} is not supported.",Object.getType(r.Item).getName()));switch(f.FieldURI){case"Subject":t.Subject=u.Subject;break;case"Start":var e=_a.$7.$4Y(u.Start);t.StartDate=u.Start;t.ReminderTime=_a.$7.$eV(e.$Fr(-i.ReminderMinutesBeforeStart));break;case"ReminderMinutesBeforeStart":var o=_a.$7.$4Y(t.StartDate);t.ReminderTime=_a.$7.$eV(o.$Fr(-i.ReminderMinutesBeforeStart));break;case"End":t.EndDate=u.End;break;case"EnhancedLocation":t.Location=u.Location?u.Location.DisplayName:null;break;default:_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem-SetReminderItemProperty: Field uri {0} is not handled for reminders.",f.FieldURI);break}}_e.$7A.prototype={$2n:null,$8R:null,$70:!1,get_$Of:function(){return"UpdateCalendarItem"},$6xG:function(n,t,i){if(this.get_$9I5().clientStoreItem===1){var r=this;this.$s(function(){if(r.$70){_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: Call rejected by updated calendar item service command. The call should be forwarded to online proxy.");i(-1)}else n()},t,i)}else throw Error.argument("ClientStoreItem",String.format("ClientStoreItem {0} is not supported.",this.get_$9I5().clientStoreItem));},$7Df:function(n,t,i,r){if(this.$70){t();return}var o=this.get_$34X().Body.ItemChanges[n];var u=o.ItemId;_js.Trace.logInfo(_e.$7A.$D,"Step {0} called for id {1}",n.toString(),u.Id);var e=new _g.$W4;e.ResponseCode="NoError";e.ResponseClass="Success";e.Items=[new _g.$7q];e.Items[0].ItemId=u;this.$8R[n]=e;var f=this,s=this,h=this;this.$AK(function(n){if(f.get_$9I5().isReferencedItemRecurring)if(u.__type===_g.$78._dataContractName){_js.Trace.logInfo(_e.$7A.$D,"UpdateCalendarItem: RecurringMasterItemId isn't supported on offline updateitem service command. Rejecting call.");f.$70=!0}else f.$9Ju(_bc.$JF,n,u,o.Updates,f.get_$95().get_$hL());else f.$9Ju(_bc.$KB,n,u,o.Updates,f.get_$95().get_$1o())},function(){_js.Trace.logInfo(_e.$7A.$D,"Successfully updated calendar item with server id {0} in local store.",u.Id);t()},function(n){_js.Trace.logError(_e.$7A.$D,"Failed to updated calendar item with server id {0} in local store. Error: {1}.",u.Id,n.$4P);i(new _e.$1W(new _a.$8t(0,n.$4P)))})},$9Ju:function(n,t,i,r,u){var f=this;u.$Da(t,_e.$1X.$54(i.Id),function(u){if($8(u)){_js.Trace.logWarning(_e.$7A.$D,"UpdateCalendarItem: Calendar item (type: '{0}') with id {1} was not found in local store",n.getName(),i.Id);f.$70=!0}else{var e,o;var s,h,c;(c=$6WA(f,r,u.get_$1s(),s={val:e},h={val:o}),e=s.val,o=h.val,c)?f.get_$9I4().$7Zx(t,e,o,function(){f.$9Jv(n,t,u,r)},function(){f.$70=!0;f.$Iw=11}):f.$9Jv(n,t,u,r)}},null)},$9Jv:function(n,t,i,r){var u;var f=i.get_$1s();var e,o;if(o=$6W8(this,f,r,e={val:u}),u=e.val,o){this.$70=!0;this.$Iw=u}else{$6WD(this,f,r);$6WE(this,t,f,r);i.$Cn(t,null)}}};_e.$3s=function(n,t,i){_e.$3s.initializeBase(this,[n,t,i,i.Body.ItemChanges.length,_e.$3s.$D]);this.$8R=new Array(this.get_$9Jf());this.$2n=new _g.$Pm;this.$2n.Header=_e.$7w.$Tb;this.$2n.Body.ResponseMessages=new _g.$H8;this.$2n.Body.ResponseMessages.Items=this.$8R;this.get_$9I5().itemIds=new Array(i.Body.ItemChanges.length)};_e.$3s.$S3=function(n,t,i){var r=new _g.$CN;r.ExtendedFieldURI=t;r.Value=i;_e.$3s.$1xy(n,r)};_e.$3s.$1xy=function(n,t){if($8(n.ExtendedProperty)){n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}else{for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}};function $6WL(n,t,i,r,u,f){_js.Trace.logInfo(_e.$3s.$D,"Opening a transaction to update a MessageItem. {0}",n.$678);var e=this,o=this,s=this;n.$9I8(new _a.$6L("UpdateItem.UpdateMessageItem",!1),function(r){_js.Trace.logInfo(_e.$3s.$D,"Getting a MessageItem for update. {0}",n.$678);n.get_$95().get_$4i().$1BX(r,_e.$1X.$54(i.Id),function(u){if($8(u)){_js.Trace.logWarning(_e.$3s.$D,"Message with id {0} was not found in client store. {1}",i.Id,n.$678);return}_js.Trace.logInfo(_e.$3s.$D,"MessageItem retrieved for update. {0}",n.$678);$4R6(n,r,u,t.Updates);var f=u;$8(n.get_$9I5().bodySubstring)||_e.$16.$47n(f,null,n.get_$9I5().bodySubstring);_js.Trace.logInfo(_e.$3s.$D,"Message with updates going to client store via update ItemId={0}; Subject{1}. {2}",JsonParser.serialize(f.ItemId),f.Subject,n.$678)})},function(){_js.Trace.logInfo(_e.$3s.$D,"Successfully updated message in local store. {0}",n.$678);u()},function(t){_js.Trace.logInfo(_e.$3s.$D,"Reporting store error {0}. {1}",t.$4P,n.$678);n.$9I7(n.$8R[r],new _e.$1W(t),f)})}function $4R6(n,t,i,r){$4R4(n,t,i,r);var u=i;n.get_$9I5().isUpdatingRightsManagementLicenseData&&(u.RightsManagementLicenseData=n.get_$9I5().rightsManagementLicenseData)}function $6WH(n,t,i,r,u,f){_a.$3.$M(n.get_$9I5().outboxFolderId,"OutboxFolderId");var o=!!u;var e;if(o)e=_0365f.$57.$46(u.get_$1s());else{_js.Trace.logInfo(_e.$3s.$D,"Message with id {0} not found in local store",t.Id);e=new _g.$9d}$4R5(n,e,t,n.get_$9I5().outboxFolderId,!1,o);e.ItemId=_bc.OutboxItemContext.$4nX(e.ItemId,_e.$3s.$D);n.get_$9I5().itemIds[r]=e.ItemId;$4R4(n,f,e,i.Updates);return n.get_$95().get_$ch().$lp(e)}function $4R5(n,t,i,r,u,f){if(!f){t.DateTimeCreated=_a.$7.$Eb(_a.$7.get_$2M());t.DateTimeReceived||(t.DateTimeReceived=t.DateTimeCreated);t.ItemId=new _g.$1j(i.Id);t.ItemId.ChangeKey=i.ChangeKey;t.InstanceKey=(new _bc.$BG).get_$DH()}t.ParentFolderId=r;_e.$16.$47n(t,null,n.get_$9I5().bodySubstring);t.IsDraft=u;n.get_$9I5().isUpdatingRightsManagementLicenseData&&(t.RightsManagementLicenseData=n.get_$9I5().rightsManagementLicenseData);n.get_$9I5().conversationId&&(t.ConversationId=n.get_$9I5().conversationId)}function $4R4(n,t,i,r){for(var u=i,o=0;o<r.length;o++){var s=r[o];if(s&&s.__type===_g.$Dd._dataContractName){var a=s.Path;if("From"===a.FieldURI){u.From=null;continue}else{var c=s.Path;if(c.DistinguishedPropertySetId==="Sharing"&&c.PropertyId===35356)continue}}var h=r[o];var l=h.Path;var f=h.Item;if(!l||!f)break;switch(l.FieldURI){case"BccRecipients":u.BccRecipients=f.BccRecipients;break;case"Body":u.Body=f.Body.BodyType==="HTML"?new _g.$67(n.get_$9I5().isTextBodyValue?"Text":f.Body.BodyType,n.get_$9I5().clientStoreBodyValue):f.Body;(u.__type===_g.$Fb._dataContractName||u.__type===_g.$GJ._dataContractName||u.__type===_g.$G0._dataContractName)&&(u.__type=_g.$9d._dataContractName);break;case"CcRecipients":u.CcRecipients=f.CcRecipients;break;case"Importance":u.Importance=f.Importance;break;case"Subject":u.Subject=f.Subject;break;case"From":u.From=f.From;break;case"ToRecipients":u.ToRecipients=f.ToRecipients;u.DisplayTo=n.$9Js(f.ToRecipients);break;case"IsRead":$6WK(n,t,u,f.IsRead);break;case"Flag":$6WI(n,t,u,f.Flag);break;case"ItemPolicyTag":u.PolicyTag=f.PolicyTag;break;case"ItemArchiveTag":u.ArchiveTag=f.ArchiveTag;break;case"Sensitivity":u.Sensitivity=f.Sensitivity;break;case"IsDeliveryReceiptRequested":u.IsDeliveryReceiptRequested=f.IsDeliveryReceiptRequested;break;case"IsReadReceiptRequested":u.IsReadReceiptRequested=f.IsReadReceiptRequested;break;case"IsClutter":$6WJ(n,t,u,f.IsClutter);break;default:var e=h.Path;if(e.DistinguishedPropertySetId==="Sharing"&&e.PropertyId===35356)continue;if(e.DistinguishedPropertySetId==="Common")if(e.PropertyId===34229){_e.$3s.$S3(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34232){_e.$3s.$S3(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34230){_e.$3s.$S3(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34231){_e.$3s.$S3(u,e,f.ExtendedProperty[0].Value);break}if(e.DistinguishedPropertySetId==="InternetHeaders"&&(e.PropertyName==="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification"||e.PropertyName==="X-Ms-Exchange-Organization-Dlp-FalsePositive"))break;break}}}function $6WJ(n,t,i,r){if(i.IsClutter!==r){i.IsClutter=r;if(i.ConversationId&&i.ConversationId.Id){var u=_e.$D8.$xL(i.ParentFolderId,i.ConversationId);var f=this;n.get_$95().get_$Hh().$Da(t,u,function(n){if(n){for(var u=n.get_$1s(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e&&(!r||!u.HasClutter)){u.HasClutter=r;n.$Cn(t,null)}}},null)}}}function $6WK(n,t,i,r){if(i.IsRead!==r){i.IsRead=r;var u=this;n.get_$95().get_$2j().$Da(t,_e.$1X.$54(i.ParentFolderId.Id),function(u){if(u){var f=u.get_$1s();r&&f.UnreadCount>0?f.UnreadCount--:r||f.UnreadCount++;u.$Cn(t,null);if(i.ConversationId&&i.ConversationId.Id){var e=_e.$D8.$xL(i.ParentFolderId,i.ConversationId);n.get_$95().get_$Hh().$Da(t,e,function(n){if(n){for(var u=n.get_$1s(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e){r&&u.UnreadCount>0?u.UnreadCount--:r||u.UnreadCount++;n.$Cn(t,null)}}},null)}}},null)}}function $6WI(n,t,i,r){_a.$3.$kI(n.get_$9I5().flag,null,"UpdateItemContext.Flag can't be null when Flag is being updated.");_a.$3.$HZ(n.get_$9I5().flag.FlagStatus,r.FlagStatus,"UpdateItemContext.Flag.FlagStatus should match the FlagStatus in SetItemPropertyUpdate.");i.Flag=n.get_$9I5().flag;if(i.ConversationId){var u=_e.$D8.$xL(i.ParentFolderId,i.ConversationId);var f=this;n.get_$95().get_$Hh().$Da(t,u,function(u){if(u)if(n.get_$9I5().isFlagConversation){u.get_$1s().FlagStatus=n.get_$9I5().flag.FlagStatus;u.$Cn(t,null)}else $6WG(n,t,i,r.FlagStatus,u)},null)}}function $6WG(n,t,i,r,u){for(var f=u.get_$1s(),o=[],s=!1,e=0;e<f.ItemIds.length;e++)f.ItemIds[e].Id===i.ItemId.Id?s=!0:Array.add(o,_e.$1X.$54(f.ItemIds[e].Id));if(s){var h=f.FlagStatus;if(r>=h||!o.length){f.FlagStatus=r;u.$Cn(t,null);return}var c=this,l=this;n.get_$95().get_$4i().$6ua(t,o,function(n){for(var i=0;i<n.length;i++){n[i].get_$1s().Flag.FlagStatus>r&&(r=n[i].get_$1s().Flag.FlagStatus);if(r==="Flagged"){f.FlagStatus=r;u.$Cn(t,null);break}}f.FlagStatus=r;u.$Cn(t,null)},function(n){_js.Trace.logError(_e.$3s.$D,"Error binding to messages in conversation with id {0}, Error {1}",f.ConversationId.Id,n.get_$4i())})}}_e.$3s.prototype={$2n:null,$8R:null,get_$Of:function(){return"UpdateItem"},$5zf:function(n,t){_e.$GB.$5yr(this.get_$95().get_$ch(),n,t,_e.$3s.$D)},$7O1:function(){return _e.$Vi.$74I(this.get_$9I5())},$7NL:function(){return this.get_$34X().Body.ComplianceId},$7Ny:function(){return 1},$6xG:function(n,t,i){this.$s(n,t,i)},$7Dt:function(n,t,i){var r=this;_e.$bB.prototype.$7Dt.call(this,function(){r.get_$9I5().clientStoreBodyValue=null;n()},t,i)},$7Df:function(n,t,i,r){var e=this.get_$34X().Body.ItemChanges[n];var u=e.ItemId;this.$9Jg(u);_js.Trace.logInfo(_e.$3s.$D,"ExecuteCurrentStep called for step={0}. {1}",n.toString(),this.$678);var f=new _g.$W4;f.ResponseCode="NoError";f.ResponseClass="Success";if(this.get_$34X().Body.MessageDisposition==="SaveOnly"){f.Items=[new _g.$7q];f.Items[0].ItemId=u}this.$8R[n]=f;if(!this.get_$9I5().clientStoreItem){_js.Trace.logInfo(_e.$3s.$D,"ClientStoreItem.None was passed. Request will be sent to the server. {0}",this.$678);t();return}if(this.get_$9I5().clientStoreItem===2)if(this.get_$34X().Body.MessageDisposition==="SendAndSaveCopy"){_js.Trace.logInfo(_e.$3s.$D,"Moving Draft item to Outbox. {0}",this.$678);var s=this;this.$9Jq(u,function(t,i){return $6WH(s,u,e,n,t,i)},f,t,i)}else if(this.get_$9I5().outboxItemId){_js.Trace.logInfo(_e.$3s.$D,"Moving Outbox item back to Drafts. {0}",this.$678);var o=this;this.$9Jr(function(n){var t=new _g.$9d;$4R5(o,t,u,o.get_$9I5().parentFolderId,!0,!1);var i=o.get_$95().get_$4i().$lp(t);$4R6(o,n,i.get_$1s(),e.Updates);return i},!1,this.$8R[n],t,i)}else{_js.Trace.logInfo(_e.$3s.$D,"Updating MessageItem. {0}",this.$678);$6WL(this,e,u,n,t,i)}else{_js.Trace.logWarning(_e.$3s.$D,"ClientStoreItem is not supported. ClientStoreItem={0}. {1}",this.get_$9I5().clientStoreItem,this.$678);t()}}};_e.$18s=function(n,t,i,r,u){_e.$18s.initializeBase(this,[n,t,r,u]);_a.$3.$17(i,"personaId");_a.$3.$1C(i.Id,"personaId.Id");this.$8w=i};_e.$18s.prototype={$8w:null,get_$Of:function(){return"UpdatePersona"},$6xG:function(n,t,i){if(this.get_$9JA()===_e.$L.$3V9){i(-1);return}this.$s(n,t,i)},$7Dt:function(n,t,i){var r=this,u=this,f=this;this.$AK(function(n){var t=_e.$5T.$I(r.get_$95());t.$Da(n,r.$8w,function(i){if(!$8(i)){_e.$L.$4fy(i,r.get_$9J9());t.$4ym(n,i,function(){t.$gO(n,i,0,null)})}r.set_$1v(i)},null)},function(){n()},function(n){_e.$1W.$BC(n,t)})}};_e.$Qq=function(n,t,i,r){_e.$Qq.initializeBase(this,[n,t,i]);_a.$3.$17(r,"syncManager");this.$3x=r;this.$2n=new _g.$UM;this.$2n.Header=_e.$7w.$Tb};function $6Us(n){return n.get_$34X().Body.ReminderType===1||n.get_$34X().Body.ReminderType===2||n.get_$34X().Body.ReminderType===3?!1:!0}_e.$Qq.prototype={$2n:null,$3x:null,get_$Of:function(){return"GetReminders"},$6xG:function(n,t,i){if($6Us(this)){var r=this;this.$NL(3,new _a.$H5,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$Qq.$D,"Rejecting the call as the reminderm module is not synced");i(301)}})}else i(100)},$7Dt:function(n,t,i){var r=this,u=this;_e.$9k.$15f(this.get_$95().get_$jj(),this.get_$34X().Body.MaxItems,this.get_$34X().Body.BeginTime,this.get_$34X().Body.EndTime,function(t){r.$2n.Body.ResponseCode="NoError";r.$2n.Body.ResponseClass="Success";r.$2n.Body.Reminders=new Array(t.length);for(var i=0;i<t.length;++i){var u=t[i].get_$1s();r.$2n.Body.Reminders[i]=u}n()},function(n){u.$2n.Body.ResponseCode="ErrorDataSourceOperation";u.$2n.Body.ResponseClass="Error";u.$2n.Body.MessageText=n.get_$4i();t(n)})},$NL:function(n,t,i){this.$3x.$NL(n,t,i)}};_e.$ou=function(n,t,i){this.$$d_$9Fe=Function.createDelegate(this,this.$9Fe);_e.$ou.initializeBase(this,[n,t,i])};_e.$ou.prototype={get_$Of:function(){return"UpdateViewStateConfiguration"},$6xG:function(n,t,i){this.$s(n,t,i)},$7Dt:function(n,t,i){this.get_$48C().$8zH(this.$$d_$9Fe,n,t)},$9Fe:function(n){for(var r=this.get_$34X().Body.UserConfiguration.Dictionary,u=r.length,i=0;i<u;++i){var t=r[i];switch(t.DictionaryKey.Value[0]){case"CalendarViewTypeNarrow":n.CalendarViewTypeNarrow=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeWide":n.CalendarViewTypeWide=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeDesktop":n.CalendarViewTypeDesktop=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarSidePanelIsExpanded":n.CalendarSidePanelIsExpanded=Boolean.parse(t.DictionaryValue.Value[0]);break;case"FolderViewState":n.FolderViewState=t.DictionaryValue.Value;break;case"SchedulingViewType":n.SchedulingViewType=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SchedulingLastUsedRoomListName":n.SchedulingLastUsedRoomListName=t.DictionaryValue.Value[0];break;case"SchedulingLastUsedRoomListEmailAddress":n.SchedulingLastUsedRoomListEmailAddress=t.DictionaryValue.Value[0];break;case"SearchHistory":n.SearchHistory=t.DictionaryValue.Value;break;case"CalendarSidePanelMonthPickerCount":n.CalendarSidePanelMonthPickerCount=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SelectedCalendarsDesktop":n.SelectedCalendarsDesktop=t.DictionaryValue.Value;break;case"SelectedCalendarsTWide":n.SelectedCalendarsTWide=t.DictionaryValue.Value;break;case"SelectedCalendarsTNarrow":n.SelectedCalendarsTNarrow=t.DictionaryValue.Value;break;case"AttachmentsFilePickerViewTypeMouse":n.AttachmentsFilePickerViewTypeForMouse=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"AttachmentsFilePickerViewTypeTouch":n.AttachmentsFilePickerViewTypeForTouch=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"BookmarkedWeatherLocations":n.BookmarkedWeatherLocations=t.DictionaryValue.Value;break;case"CurrentWeatherLocationBookmarkIndex":n.CurrentWeatherLocationBookmarkIndex=Number.parseInvariant(t.DictionaryValue.Value[0]);break}}}};_e.$9V=function(n){_e.$9V.initializeBase(this,[n])};_e.$9V.$41x=function(n){if(n.Body&&n.Body.Value)if(n.Body.BodyType==="Text"){n.TextBody=n.Body;var f=_a.$1T.$he(n.TextBody.Value);n.Body=new _g.$67("HTML",f);_js.Trace.logInfo(_a.$0.$Ag,"Created Body from TextBody for new created item with client id {0}",n.ItemId.Id)}else{var i=_a.$1T.$7ER(n.Body.Value);i||(i=n.Body.Value);var t=null;var r,u;if(u=_a.$1T.$71o(i,r={val:t}),t=r.val,u)_js.Trace.logInfo(_a.$0.$Ag,"Created TextBody from body for new created item with client id {0}",n.ItemId.Id);else{_js.Trace.logWarning(_a.$0.$Ag,"HTML body couldn't be converted to TEXT for item with client id {0}. Setting Text body to empty.",n.ItemId.Id);t=""}n.TextBody=new _g.$67("Text",t)}};function $4Q6(n,t,i,r,u,f){if($8(t)){_js.Trace.logWarning(_e.$9V.$D,"No calendar sync state was found. Considering item outside sync range.");f();return}var e=t.get_$1s();if(!e.IsSynced){_js.Trace.logInfo(_e.$9V.$D,"Calendar isn't synced. Considering item outside sync range.");f();return}var o=_a.$7.$4Y(i);var s=_a.$7.$4Y(r);var h=_a.$7.$4Y(e.WindowStart);var c=_a.$7.$4Y(e.WindowEnd);s.$2Y(h)<0||o.$2Y(c)>0?f():u()}function $6TJ(n,t,i){var r=n.$7y.get_$jj();var u=this;r.$Da(t,i,function(n){if(!n||!n.get_$1s()){_js.Trace.logWarning(_e.$9V.$D,"Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$9V.$D,"Reminder item with id {0} found in client store. Deleting it.",n.get_$1y());r.$GW(t,i);_js.Trace.logInfo(_e.$9V.$D,"Successfully deleted reminder item with id {0} from client store.",n.get_$1y())},null)}_e.$9V.prototype={$45u:function(n,t,i,r){var f=_a.$7.$4Y(t.Start);var e=_a.$7.$eV(f.$Fr(-t.ReminderMinutesBeforeStart));var u=new _g.$VX(t.Subject,e,t.Start,t.End,i,t.UID);t.Location&&(u.Location=t.Location.DisplayName);var o=this.$7y.get_$jj().$lp(u);o.$Cn(n,r)},$3U5:function(n,t,i){var r=this.$7y.get_$1o();if(i.CalendarItemType==="RecurringMaster"){_js.Trace.logInfo(_e.$9V.$D,"Item {0} is a recurring master. Deleteting occurrences/exceptions and master",t);var u=_e.$XA.$8M(this.$7y);var e=this;u.$4rz(n,t,function(){});var f=new _a.$86(_e.$9k.$12W,i.UID);var o=this;this.$7y.get_$jj().$1ia(n,f,function(){});this.$7y.get_$hL().$GW(n,t)}else{r.$GW(n,t);$6TJ(this,n,t)}},$7Zw:function(n,t,i,r){var u=new _e.$id(this.$7y.get_$kC(),"CalendarSyncState");var f=this,e=this;u.$2AU(function(u){$4Q6(f,u,n,t,i,r)},function(n){r()})},$7Zx:function(n,t,i,r,u){var f=new _e.$id(this.$7y.get_$kC(),"CalendarSyncState");var e=this;f.$52D(n,function(n){$4Q6(e,n,t,i,r,u)})},$50v:function(n,t,i,r){var u=this;this.$7y.get_$1o().$Da(n,_e.$1X.$54(t.OccurrenceId),function(n){if(!n||!n.get_$1s()){_js.Trace.logWarning(_e.$9V.$D,"Occurrence item with id {0} could no be found in client store.",t.OccurrenceId);r();return}_js.Trace.logInfo(_e.$9V.$D,"Occurrence item with id {0} found in client store. Master Uid is {1}.",n.get_$1y(),n.get_$12V());i(n.get_$12V())},null)}};_e.$BI=function(n){_e.$BI.initializeBase(this,[n])};function $6U2(n,t,i,r,u,f,e){var o=this;n.$7y.get_$Hi().$Da(t,_e.$1X.$54(i.Id),function(i){if(!i){_js.Trace.logInfo(_e.$1a.$D,"ConversationNodeItem not found in the clientstore. Hence, not adding the itempart");e(!1);return}var o=i.get_$1s();var h=(new _bc.$BG).$5J.Id;var s=new _g.$QK(h);s.ParentInternetMessageId=u;var c=_e.$Ma.$4ow(r);s.Items=[c];f?Array.insert(o.ConversationNodes,0,s):Array.add(o.ConversationNodes,s);o.LastModifiedTime=$2UV(n,o.LastModifiedTime);i.$Cn(t,null);_js.Trace.logInfo(_e.$1a.$D,"Successfully updated and saved the conversationNodeItem");e(!0)},null)}function $6U3(n,t,i,r,u,f){var e=this;n.$7y.get_$Hi().$Da(t,_e.$1X.$54(i.Id),function(e){if(!e){_js.Trace.logInfo(_e.$1a.$D,"ConversationNodeItem not found in the clientstore. Hence, not removing the itempart");f(null);return}for(var o=e.get_$1s(),a=null,l=!1,c=0;c<o.ConversationNodes.length;c++){var s=o.ConversationNodes[c];if(s.Items.length===1&&$2UU(n,s.Items[0].ItemId,r.ItemId,u)){a=s.ParentInternetMessageId;_js.Trace.logInfo(_e.$1a.$D,"Removing the whole ConversationNode at index {0}",c);Array.removeAt(o.ConversationNodes,c);l=!0;break}else for(var h=0,h=0;h<s.Items.length;h++){var v=s.Items[h];if($2UU(n,v.ItemId,r.ItemId,u)){_js.Trace.logInfo(_e.$1a.$D,"Removing the item at index {0}",h);Array.removeAt(s.Items,h);l=!0;break}}if(l)break}if(l){o.LastModifiedTime=$2UV(n,o.LastModifiedTime);if(o.ConversationNodes.length){e.$Cn(t,null);_js.Trace.logInfo(_e.$1a.$D,"Successfully removed item from the conversationNode")}f(a)}else{_js.Trace.logInfo(_e.$1a.$D,"ItemId {0} not removed from conversationNode with id {0}",r.ItemId.Id,i.Id);f(null)}},null)}function $6U4(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1a.$D,"Update metadata properties for all conversations with id {0} for addition. The itempart added has id {1}",i,r.ItemId.Id);var e=this;_e.$6O.$3ZJ(t,n.$7y.get_$Hh(),i,function(i){for(var c=i,y=c.length,s=0;s<y;++s){for(var l=c[s],u=l.get_$1s(),a=u.GlobalItemIds,p=a.length,h=0;h<p;++h){var w=a[h];if($2UU(n,w,r.ItemId,f))throw Error.invalidOperation(String.format("itempart is already a part of the conversation, id = {0}, GlobalItemIds = [{1}]",r.ItemId.Id,u.GlobalItemIds.join(",")));}var e=new _g.$1j(r.ItemId.Id);e.ChangeKey=r.ItemId.ChangeKey;Array.add(u.GlobalItemIds,e);if(r.IsDraft&&!r.IsSubmitted)if(u.DraftItemIds){for(var v=!1,o=0;o<u.DraftItemIds.length;o++)if(u.DraftItemIds[o].Id===e.Id){v=!0;u.DraftItemIds[o]=e;break}v||Array.add(u.DraftItemIds,e)}else u.DraftItemIds=[e];u.GlobalMessageCount++;u.LastModifiedTime=$2UV(n,u.LastModifiedTime);l.$Cn(t,null)}})}function $6U5(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1a.$D,"Update metadata properties for all conversations with id {0} for remove. The itempart removed has id {1}",i,u.ItemId.Id);var e=this;_e.$6O.$3ZJ(t,n.$7y.get_$Hh(),i,function(i){for(var a=i,p=a.length,c=0;c<p;++c){for(var l=a[c],e=l.get_$1s(),v=!1,o=0;o<e.GlobalItemIds.length;o++){var y=e.GlobalItemIds[o];if(y.Id===u.ItemId.Id){Array.removeAt(e.GlobalItemIds,o);if(e.DraftItemIds)for(var s=0;s<e.DraftItemIds.length;s++)e.DraftItemIds[s].Id===y.Id&&Array.removeAt(e.DraftItemIds,s);v=!0}}if(v){if(e.GlobalMessageCount<=0)throw Error.invalidOperation("conversation.GlobalMessageCount "+e.GlobalMessageCount+" is less than or equal to 0");e.GlobalMessageCount--;if(!$8(u.IsRead)&&!u.IsRead){if(e.GlobalUnreadCount<=0)throw Error.invalidOperation("conversation.GlobalUnreadCount "+e.GlobalUnreadCount+" is less than or equal to 0");e.GlobalUnreadCount--}if(e.MessageCount<=0)throw Error.invalidOperation("conversation.MessageCount "+e.MessageCount+" is less than or equal to 0");if(e.FolderId.Id===r.Id){e.MessageCount--;if(!$8(u.IsRead)&&!u.IsRead){if(e.UnreadCount<=0)throw Error.invalidOperation("conversation.UnreadCount "+e.UnreadCount+" is less than or equal to 0");e.UnreadCount--}for(var h=0;h<e.ItemIds.length;h++)$2UU(n,e.ItemIds[h],u.ItemId,f)&&Array.removeAt(e.ItemIds,h)}e.LastModifiedTime=$2UV(n,e.LastModifiedTime);if(e.ItemIds.length){l.$Cn(t,null);_js.Trace.logInfo(_e.$1a.$D,"Saved the updated conversation object")}else{e.MessageCount&&_js.Trace.logWarning(_e.$1a.$D,"ConversationHelper.UpdateConversationMetadataForRemove, Conversation.ItemIds.length == 0 but conversation MessageCount = {0}",e.MessageCount);l.$27L(t);_js.Trace.logInfo(_e.$1a.$D,"Last itemPart for this folder in this conversation, hence deleted the listView entry for this conversation")}}else _js.Trace.logInfo(_e.$1a.$D,"ItemPart not found in the GlobalItemIds list, conversation JSON = {0}",JsonParser.serialize(e))}})}function $2UU(n,t,i,r){return t.Id===i.Id||t.Id===r.$lw(i).Id||r.$lw(t).Id===i.Id}function $2UV(n,t){return _a.$7.$4Y(t).$9b(1).$8r()}_e.$BI.prototype={$4dx:function(n,t,i,r,u,f,e){_a.$3.$M(n,"tx");_a.$3.$M(t,"conversationId");_a.$3.$M(i,"itemPartToAdd");_a.$3.$1C(r,"parentConversationNodeId");_a.$3.$M(f,"mailboxDataContext");_a.$3.$M(e,"successCallback");_js.Trace.logInfo(_e.$1a.$D,"Adding itemPart with id {0} to conversation with id {1}",i.ItemId.Id,t.Id);var o=this;$6U2(this,n,t,i,r,u,function(u){if(!u){_js.Trace.logInfo(_e.$1a.$D,"ConversationNode not found in the clientstore. Hence, not updating conversation metadata properties also");e(!1);return}$6U4(o,n,t,i,r,f);if(i.ConversationId&&i.ConversationId!==t)throw Error.invalidOperation(String.format("The itemPartToAdd already has a different conversationId. conversationId = {0}, itemPartToAdd.ConversationId = {1}",t.Id,i.ConversationId.Id));else i.ConversationId=t;_js.Trace.logInfo(_e.$1a.$D,"Successfully added itempart to the conversation");e(!0)})},$44A:function(n,t,i,r,u,f){_a.$3.$M(t,"conversationId");_a.$3.$M(i,"itemOriginalParentFolderId");_a.$3.$M(r,"itemPartToRemove");_a.$3.$M(u,"mailboxDataContext");_a.$3.$M(f,"successCallback");_js.Trace.logInfo(_e.$1a.$D,"Removing itemPart with id {0} from conversation with id {1}",r.ItemId.Id,t);var e=this;$6U3(this,n,t,r,u,function(o){_js.Trace.logInfo(_e.$1a.$D,"Successfully updated the conversationNodeItem. Retreived parentConversationIndex = ",o);$6U5(e,n,t,i,r,u);f(o)})}};_e.$go=function(n){_e.$go.initializeBase(this,[n])};_e.$go.$7P1=function(n,t){return!n.IsRead&&!_g.$g.$1i.doesIdEqualName(t,"outbox")&&!_g.$g.$1i.doesIdEqualName(t,"drafts")?1:0};_e.$go.prototype={$3UF:function(n,t,i,r,u,f){_a.$3.$M(n,"tx");_a.$3.$M(t,"conversationHelper");_a.$3.$M(r,"messageItemId");_a.$3.$M(f,"mailboxDataContext");var e=this;this.$7y.get_$4i().$Da(n,_e.$1X.$54(r.Id),function(o){if(!o){_js.Trace.logWarning(_e.$1a.$D,"Message item with id {0} was not found in the client store.",r.Id);return}e.$1ij(n,t,i,o,u,f)},null)},$3UG:function(n,t,i){_a.$3.$M(n,"tx");_a.$3.$M(t,"outboxItemId");_a.$3.$M(i,"mailboxDataContext");var r=this;this.$7y.get_$ch().$Da(n,_e.$1X.$54(t.Id),function(u){if(!u){_js.Trace.logWarning(_e.$1a.$D,"Outbox item with id {0} was not found in the client store.",t.Id);return}r.$1ij(n,null,"HardDelete",u,null,i,!0)},null)},$1ij:function(n,t,i,r,u,f,e){_a.$3.$M(n,"tx");_a.$3.$M(f,"mailboxDataContext");e||_a.$3.$M(t,"conversationHelper");_a.$3.$M(r,"messageItem");i==="MoveToDeletedItems"&&_a.$3.$M(u,"deletedItemsFolderId");var o=r.get_$1s();var c=o.IsRead?0:1;var s=new _g.$3J(o.ParentFolderId.Id);var h=_e.$go.$7P1(o,s);if(i==="MoveToDeletedItems"&&o.ParentFolderId.Id!==u.Id){o.ParentFolderId=u;r.$Cn(n,null);this.$7y.get_$2j().$4r4(n,s,1,h);this.$7y.get_$2j().$2Bh(n,o.ParentFolderId,1,c)}else{_js.Trace.logInfo(_a.$0.$Jo,"Deleting the message with id {0}",o.ItemId.Id);r.$27L(n);this.$7y.get_$2j().$4r4(n,s,1,h)}if(!e&&o.ConversationId){var l=this;t.$44A(n,o.ConversationId,s,o,f,function(n){})}}};_e.$Vi=function(){};_e.$Vi.$74E=function(n){var t=new _e.$Vi;t.$1TM=n.inboxFolderId;t.$10U=n.outboxFolderId;t.$MH=n.outboxItemId;t.$GH=n.parentFolderId;t.$Be=n.conversationId;t.$VR=n.parentConversationNodeId;t.$2pC=n.itemPartsOrderDescending;return t};_e.$Vi.$74I=function(n){var t=new _e.$Vi;t.$1TM=n.inboxFolderId;t.$10U=n.outboxFolderId;t.$MH=n.outboxItemId;t.$GH=n.parentFolderId;t.$Be=n.conversationId;t.$VR=n.parentConversationNodeId;t.$2pC=n.itemPartsOrderDescending;return t};_e.$Vi.prototype={$1TM:null,$10U:null,$MH:null,$GH:null,$Be:null,$VR:null,$2pC:!1,get_inboxFolderId:function(){return this.$1TM},get_outboxFolderId:function(){return this.$10U},get_outboxItemId:function(){return this.$MH},get_parentFolderId:function(){return this.$GH},get_conversationId:function(){return this.$Be},get_parentConversationNodeId:function(){return this.$VR},get_itemPartsOrderDescending:function(){return this.$2pC}};_e.$1CV=function(n){_a.$3.$M(n,"itemStoreGetter");this.$7y=n};_e.$1CV.prototype={$7y:null};_e.$16M=function(n){this.$2GJ=new _e.$go(n);this.$2bU=new _e.$BI(n)};_e.$16M.prototype={$2GJ:null,$2bU:null,$3a9:function(){return this.$2GJ}};_e.$3e.registerClass("_e.$3e");CoreStorageComponent.registerClass("CoreStorageComponent",null,_a.$1C3);_e.$7C.registerClass("_e.$7C");_e.$53.registerClass("_e.$53",null,IAttachmentsCleanupManager);AddressbookPostalAddress.registerClass("AddressbookPostalAddress");_e.$MK.registerClass("_e.$MK");_e.$vp.registerClass("_e.$vp",_e.$MK);_e.$3E.registerClass("_e.$3E");_e.$jL.registerClass("_e.$jL",_e.$3E);_e.$w.registerClass("_e.$w",null,_bc.$11w);_e.$4W.registerClass("_e.$4W",_e.$ok.$$(AttachmentInfoRecord),_bc.$lO,_bc.$11w);ItemMetadata.registerClass("ItemMetadata");AttachmentInfoMetadata.registerClass("AttachmentInfoMetadata",ItemMetadata);_e.$pN.registerClass("_e.$pN",_e.$7E.$$(_bc.$lO,_e.$4W),IAttachmentInfoItemStore,_bc.$11x);_e.$Dy.registerClass("_e.$Dy");_e.$K0.registerClass("_e.$K0");CustomSyncData.registerClass("CustomSyncData");_e.$48.registerClass("_e.$48",_a.$T);_e.$48.prototype.$J7=_a.$T.prototype.$J7;_e.$yp.registerClass("_e.$yp");_e.$BY.registerClass("_e.$BY",_e.$3E);_e.$EG.registerClass("_e.$EG");_e.$7i.registerClass("_e.$7i",_e.$ok.$$(_g.$wX),_bc.$1BY,_bc.$11w);_e.$Yq.registerClass("_e.$Yq",_e.$7E.$$(_bc.$1BY,_e.$7i),_bc.$11j,_bc.$11x);_e.$RG.registerClass("_e.$RG",null,_bc.$1B9);_e.$sj.registerClass("_e.$sj",null,IItemStoreGetterFactory);_e.$B6.registerClass("_e.$B6",_e.$ok.$$(_g.$7q),_bc.$KG,_bc.$11w);_e.$GB.registerClass("_e.$GB",_e.$B6,_bc.$12M,_bc.$KG,_bc.$11w);_e.$14E.registerClass("_e.$14E",_e.$RT.$$(_bc.$12M,_e.$GB),_bc.$12N,_bc.$11x);_e.$FW.registerClass("_e.$FW",_e.$ok.$$(_g.$bb),_bc.$aF,_bc.$11w);PersistedDataRecord.registerClass("PersistedDataRecord");_e.$9k.registerClass("_e.$9k",_e.$ok.$$(_g.$VX),_bc.$Um,_bc.$11w);_e.$1X.registerClass("_e.$1X",null,_a.$lT);_e.$F3.registerClass("_e.$F3",_e.$ok.$$(_g.$47),_bc.$11G,_bc.$11w);ActionItemMetadata.registerClass("ActionItemMetadata",ItemMetadata);_e.$8U.registerClass("_e.$8U");_e.$vn.registerClass("_e.$vn",_e.$ok.$$(AddressbookOperation),_bc.$rb,_bc.$11w);_e.$vo.registerClass("_e.$vo",_e.$ok.$$(AddressbookPersona),_bc.$rc,_bc.$11w);_e.$Q4.registerClass("_e.$Q4",_e.$kP.$$(_bc.$KB));_e.$Yr.registerClass("_e.$Yr",_e.$kP.$$(_bc.$1BY));_e.$nn.registerClass("_e.$nn",_e.$kP.$$(_bc.$Um));_e.$5f.registerClass("_e.$5f",_e.$ok.$$(_g.$6P),_bc.$KB,_bc.$1BX,_bc.$11w);CalendarItemMetadata.registerClass("CalendarItemMetadata",ItemMetadata);_e.$Ch.registerClass("_e.$Ch",_e.$ok.$$(_g.$6P),_bc.$JF,_bc.$1BX,_bc.$11w);_e.$5e.registerClass("_e.$5e");_e.$5e.$3OH.registerClass("_e.$5e.$3OH");_e.$5e.$9JJ.registerClass("_e.$5e.$9JJ",_e.$5e.$3OH);_e.$5e.$915.registerClass("_e.$5e.$915",_e.$5e.$9JJ);_e.$5e.$7fx.registerClass("_e.$5e.$7fx",_e.$5e.$9JJ);_e.$wh.registerClass("_e.$wh",_e.$3E);_e.$XA.registerClass("_e.$XA");_e.$1a.registerClass("_e.$1a",null,IClientStore);_e.$QD.registerClass("_e.$QD",_js.$yd,_a.$1BT,Sys.IDisposable);_e.$1W.registerClass("_e.$1W",null,_bc.$1Bd);_e.$Jx.registerClass("_e.$Jx",_e.$ok.$$(_g.$C3),_bc.$lU,_bc.$11w);_e.$xY.registerClass("_e.$xY",_e.$kP.$$(_bc.$11P));_e.$6O.registerClass("_e.$6O",_e.$ok.$$(_g.$TI),_bc.$11P,_bc.$11w);_e.$OA.registerClass("_e.$OA",_e.$aV.$$(_bc.$11P,_e.$6O,_g.$TI),_bc.$11Q,_bc.$11x);_e.$aN.registerClass("_e.$aN",null,_e.$1AK);_e.$qK.registerClass("_e.$qK",_e.$aN);_e.$1E.registerClass("_e.$1E",null,_e.$rk);_e.$8Z.registerClass("_e.$8Z",null,_e.$1AL);_e.$Qk.registerClass("_e.$Qk",_e.$7E.$$(_bc.$1BY,_e.$7i),_bc.$11i,_bc.$11x);_e.$D8.registerClass("_e.$D8",_e.$1X);_e.$D8.prototype.toString=_e.$1X.prototype.toString;FolderItemMetadata.registerClass("FolderItemMetadata",ItemMetadata);_e.$gG.registerClass("_e.$gG",_e.$ok.$$(InlineImageRecord),_bc.$11v,_bc.$11w);_e.$sH.registerClass("_e.$sH",_e.$7E.$$(_bc.$11v,_e.$gG),IInlineImageItemStore,_bc.$11x);_e.$63.registerClass("_e.$63");_e.$12k.registerClass("_e.$12k",null,_e.$s1);_e.$Bz.registerClass("_e.$Bz",null,_e.$s2);_e.$8l.registerClass("_e.$8l");_e.$13g.registerClass("_e.$13g",_e.$kP.$$(_bc.$KG));_e.$t1.registerClass("_e.$t1",_e.$aN);_e.$13h.registerClass("_e.$13h",_e.$Us.$$(_bc.$KG,_g.$7q));_e.$gq.registerClass("_e.$gq",null,_e.$19x);_e.$id.registerClass("_e.$id",null,_e.$19x);_e.$13t.registerClass("_e.$13t",_e.$id);_e.$tA.registerClass("_e.$tA",_e.$aN);_e.$2a.registerClass("_e.$2a");_e.$14D.registerClass("_e.$14D",_e.$kP.$$(_bc.$12M));_e.$Rl.registerClass("_e.$Rl",_e.$kP.$$(_bc.$sa));_e.$Jg.registerClass("_e.$Jg",_e.$ok.$$(SyncState),_bc.$m4,_bc.$11w);_e.$17w.registerClass("_e.$17w");ConversationItemMetadata.registerClass("ConversationItemMetadata",ItemMetadata);_e.$Ma.registerClass("_e.$Ma",_e.$ok.$$(_g.$XR),_bc.$g3,_bc.$11w);_e.$XS.registerClass("_e.$XS",null,_e.$19x);MessageItemMetadata.registerClass("MessageItemMetadata",ItemMetadata);_e.$gp.registerClass("_e.$gp",_e.$RT.$$(_bc.$KG,_e.$B6),_bc.$123,_bc.$11x);_e.$2M.registerClass("_e.$2M",_e.$ok.$$(PartialPersonaRecord),_bc.$lx,_bc.$11w);_e.$Rx.registerClass("_e.$Rx",_e.$kP.$$(_bc.$lU));_e.$14p.registerClass("_e.$14p",_e.$3E);_e.$5T.registerClass("_e.$5T",null,_bc.$12P);_e.$bj.registerClass("_e.$bj",_e.$3E,_e.$sV);ConfigChangeCleanupModuleItem.registerClass("ConfigChangeCleanupModuleItem");MessageItemRecord.registerClass("MessageItemRecord",_g.$7q);_e.$5l.registerClass("_e.$5l",_e.$ok.$$(SettingRecord),_bc.$sa,_bc.$11w);_e.$9O.registerClass("_e.$9O",null,_bc.$1BA);_e.$Nq.registerClass("_e.$Nq",_e.$ok.$$(_g.$W0),_bc.$gV,_bc.$11w);_e.$in.registerClass("_e.$in",_e.$ok.$$(TombstonedItemRecord),_bc.$12m,_bc.$11w);_e.$vG.registerClass("_e.$vG",_e.$7E.$$(_bc.$12m,_e.$in),_bc.$12n,_bc.$11x);_e.$ws.registerClass("_e.$ws",_e.$aN);_e.$7T.registerClass("_e.$7T",_e.$3E,_e.$sV);_e.$eu.registerClass("_e.$eu",_a.$H5);_e.$k2.registerClass("_e.$k2",_e.$3E);EmailItemSyncState.registerClass("EmailItemSyncState",SyncState);ConversationItemSyncState.registerClass("ConversationItemSyncState",EmailItemSyncState);_e.$XP.registerClass("_e.$XP",_e.$3E,_e.$sV);_e.$QM.registerClass("_e.$QM",_e.$Us.$$(_bc.$11P,_g.$TI));_e.$zP.registerClass("_e.$zP",_e.$LE.$$(_bc.$1BY,_g.$wX));MessageItemSyncState.registerClass("MessageItemSyncState",EmailItemSyncState);_e.$RU.registerClass("_e.$RU",_e.$Us.$$(_bc.$KG,_g.$7q));_e.$3M.registerClass("_e.$3M",_js.$9,_bc.$1B5,_js.$sJ);_e.$ES.registerClass("_e.$ES");_e.$BW.registerClass("_e.$BW",_g.$7Y,_g.$19U);_e.$ge.registerClass("_e.$ge");_e.$5s.registerClass("_e.$5s",_g.$1Q,_bc.$Ul,_g.$1BF,Sys.IDisposable,_bc.$1B4);_e.$15G.registerClass("_e.$15G",_g.$1Cc,_g.$19U);_e.$nx.registerClass("_e.$nx",_e.$ES);_e.$cP.registerClass("_e.$cP",_e.$ES);_e.$5v.registerClass("_e.$5v",_e.$3M);_e.$Jj.registerClass("_e.$Jj");_e.$Sw.registerClass("_e.$Sw",null,_a.$rf);_e.$rr.registerClass("_e.$rr");_e.$5P.registerClass("_e.$5P",null,_a.$1Bb);_e.$5P.$7U8.registerClass("_e.$5P.$7U8",_a.$W1);_e.$5h.registerClass("_e.$5h",_a.$8t);_e.$11S.registerClass("_e.$11S",_e.$Sw);_e.$FH.registerClass("_e.$FH",null,_a.$1Bc);_e.$11T.registerClass("_e.$11T",null,_e.$1A6,_a.$1Ba);_e.$LY.registerClass("_e.$LY");_e.$11U.registerClass("_e.$11U",_e.$LY);_e.$11V.registerClass("_e.$11V");_e.$rq.registerClass("_e.$rq",null,_e.$1A5);_e.$rq.$4ux.registerClass("_e.$rq.$4ux",null,_e.$1A3);_e.$2A.registerClass("_e.$2A",null,_e.$1A2,_e.$1A1);_e.$KC.registerClass("_e.$KC",_e.$2A);_e.$rs.registerClass("_e.$rs");_e.$g4.registerClass("_e.$g4",_e.$2A);_e.$11X.registerClass("_e.$11X",_e.$2A);_e.$11Y.registerClass("_e.$11Y",null,_a.$12R);_e.$11Z.registerClass("_e.$11Z",null,_a.$12S);_e.$OU.registerClass("_e.$OU");_e.$By.registerClass("_e.$By",_e.$11X);_e.$By.$962.registerClass("_e.$By.$962");_e.$11a.registerClass("_e.$11a");_e.$lZ.registerClass("_e.$lZ",null,_a.$1BZ);_e.$11c.registerClass("_e.$11c",_e.$LY);_e.$LZ.registerClass("_e.$LZ");_e.$rt.registerClass("_e.$rt");_e.$AK.registerClass("_e.$AK",null,_a.$1Bb);_e.$AK.$96E.registerClass("_e.$AK.$96E",_a.$W1);_e.$Ak.registerClass("_e.$Ak",_a.$8t);_e.$iL.registerClass("_e.$iL",_e.$Sw);_e.$Cb.registerClass("_e.$Cb",null,_a.$1Bc);_e.$4v.registerClass("_e.$4v",null,_a.$1Ba);_e.$Ez.registerClass("_e.$Ez");_e.$Fe.registerClass("_e.$Fe");_e.$176.registerClass("_e.$176",_e.$Fe);_e.$177.registerClass("_e.$177",_e.$Fe);_e.$178.registerClass("_e.$178",_e.$Fe);_e.$EP.registerClass("_e.$EP",null,_e.$1A0);_e.$un.registerClass("_e.$un",null,_e.$19z);_e.$d0.registerClass("_e.$d0",null,_a.$12R);_e.$d1.registerClass("_e.$d1",null,_a.$12S);_e.$Jf.registerClass("_e.$Jf");_e.$7n.registerClass("_e.$7n",_js.$yd,_a.$1BZ);_e.$cy.registerClass("_e.$cy",null,_a.$1BI);_e.$174.registerClass("_e.$174",_a.ISqlResultSet);_e.$175.registerClass("_e.$175",_a.ISqlResultSetRowList);_e.$iM.registerClass("_e.$iM");_e.$4m.registerClass("_e.$4m",null,_a.$1BJ);_e.$179.registerClass("_e.$179",null,_a.$1BH);_e.$WO.registerClass("_e.$WO",_e.$5k.$$(_g.$vh));_e.$9T.registerClass("_e.$9T",_e.$bB.$$(_g.$Sn,_g.$pI));_e.$Mb.registerClass("_e.$Mb",_e.$bB.$$(_g.$TJ,_g.$qP));_e.$16.registerClass("_e.$16",_e.$jZ.$$(_g.$Xi,_g.$xl));_e.$L.registerClass("_e.$L");_e.$Mc.registerClass("_e.$Mc",_e.$oq.$$(_g.$xs));_e.$Y1.registerClass("_e.$Y1",_e.$5k.$$(_g.$yK));_e.$GZ.registerClass("_e.$GZ",_e.$bB.$$(_g.$Xq,_g.$yD));_e.$8x.registerClass("_e.$8x",_e.$bB.$$(_g.$Xx,_g.$yI));_e.$FA.registerClass("_e.$FA",_e.$bB.$$(_g.$YL,_g.$ys));_e.$9Y.registerClass("_e.$9Y",_e.$Wt.$$(_g.$YX,_g.$E8));_e.$A7.registerClass("_e.$A7",_e.$bB.$$(_g.$YY,_g.$zA));_e.$2w.registerClass("_e.$2w",_e.$Wt.$$(_g.$Tl,_g.$8c));_e.$Qf.registerClass("_e.$Qf",_e.$Wt.$$(_g.$Yh,_g.$zC));_e.$Ms.registerClass("_e.$Ms",_e.$bB.$$(_g.$U7,_g.$rJ));_e.$Qn.registerClass("_e.$Qn",_e.$5k.$$(_g.$zi));_e.$9a.registerClass("_e.$9a",_e.$Wt.$$(_g.$Z6,_g.$fv));_e.$kv.registerClass("_e.$kv",_e.$5k.$$(_g.$rI));_e.$68.registerClass("_e.$68",_e.$bB.$$(_g.$Mu,_g.$UA));_e.$Mw.registerClass("_e.$Mw",_e.$5k.$$(_g.$rM));_e.$kz.registerClass("_e.$kz",_e.$5k.$$(_g.$10K));_e.$10N.registerClass("_e.$10N",_e.$5k.$$(_g.$rN));_e.$10P.registerClass("_e.$10P",_e.$Wt.$$(_g.$ZX,_g.$10Q));_e.$KW.registerClass("_e.$KW",_e.$bB.$$(_g.$b7,_g.$13s));_e.$9C.registerClass("_e.$9C",_e.$Wt.$$(_g.$be,_g.$14h));_e.$cI.registerClass("_e.$cI",_e.$5k.$$(_g.$15a));_e.$7w.registerClass("_e.$7w");_e.$ct.registerClass("_e.$ct",_e.$5k.$$(_g.$16W));_e.$16l.registerClass("_e.$16l",_e.$5k.$$(_g.$16n));_e.$7A.registerClass("_e.$7A",_e.$bB.$$(_g.$e0,_g.$18o));_e.$3s.registerClass("_e.$3s",_e.$jZ.$$(_g.$e0,_g.$18o));_e.$18s.registerClass("_e.$18s",_e.$oq.$$(_g.$18t));_e.$Qq.registerClass("_e.$Qq",_e.$Wt.$$(_g.$UL,_g.$rO));_e.$ou.registerClass("_e.$ou",_e.$Wt.$$(_g.$e7,_g.$18u));_e.$1CV.registerClass("_e.$1CV");_e.$9V.registerClass("_e.$9V",_e.$1CV);_e.$BI.registerClass("_e.$BI",_e.$1CV,_bc.$1B6);_e.$go.registerClass("_e.$go",_e.$1CV,_bc.$1B8);_e.$Vi.registerClass("_e.$Vi");_e.$16M.registerClass("_e.$16M",null,_bc.$1B3);_e.$7C.$49y=-0xffffffffffff;_e.$53.$D=_a.$0.$4h3;_e.$53.$g=null;_e.$4W.$3mq=new _a.$4U("Data.MessageID");_e.$4W.$3mr=new _a.$4U("Data.MessageReceivedDateTime");_e.$4W.$3MM=new _a.$4U("Data.AttachmentType");_e.$4W.$3ML=new _a.$4U("Metadata.AttachmentTypeAndSyncStatus");CustomSyncData.$1iL="";_e.$48.$4kq="ct";_e.$48.$4Dw="tct";_e.$48.$4Dv="tctbtc";_e.$48.$4DK="tcc";_e.$48.$3wr="ncc";_e.$48.$3ws="nccnc";_e.$48.$4DJ="tcnc";_e.$48.$3wq="ncnc";_e.$48.$4DL="tcm";_e.$48.$3wu="nmc";_e.$48.$4DH="tcia";_e.$48.$3wt="noiac";_e.$48.$3wv="notick";_e.$w.$D=_a.$0.$64P;_e.$w.$2O9=new _a.$4U("Data.SaveMode");_e.$w.$5Fk=new _a.$4U("Data.LastModifiedOnClient");_e.$w.$5Fo=new _a.$4U("Data.LastSynchronizedToServer");_e.$9k.$2rD=200;_e.$9k.$5d2=0;_e.$9k.$444=new _a.$4U("Data.ReminderTime");_e.$9k.$12W=new _a.$4U("Data.UID");_e.$F3.$2Qn=new _a.$4U("Data.state");_e.$5f.$D=_a.$0.$64O;_e.$5f.$1zD=new _a.$4U("Data.Start");_e.$5f.$3WK=new _a.$4U("Data.End");_e.$5f.$12W=new _a.$4U("Data.UID");_e.$5f.$2eo=new _a.$4U("Metadata.DurationInHours");_e.$Ch.$12W=new _a.$4U("Data.UID");_e.$5e.$D=_a.$0.$1o;_e.$1a.$D=_a.$0.$57;_e.$1a.$6t="UTC";_e.$1W.$33I=new Sys.EventHandlerList;_e.$1E.$8b="15.00.0342.00";_e.$1E.$g=null;_e.$1E.$1LU=[new _a.$4y(_e.$w.$2O9,1)];_e.$7i.$3wU="";_e.$gG.$4ho=new _a.$4U("Data.Blob");_e.$Bz.$77K=new Array(0);_e.$8l.$Ne=new Array(0);_e.$aN.$D=_a.$0.$1Uy;_e.$2a.$rv=-1;_e.$Jg.$5J2=100;_e.$3E.$D=_a.$0.$65H;_e.$6O.$71e="ConversationTopic";_e.$2M.$1kG=new _a.$4U("Data.FolderId.Id");_e.$2M.$31v=new _a.$4U("Data.Persona.PersonaId.Id");_e.$2M.$3Uy=new _a.$4U("Data.Persona.DisplayNameFirstLast");_e.$2M.$14t=new _a.$4U("Data.Persona.DisplayNameFirstLastSortKey");_e.$2M.$3V0=new _a.$4U("Data.Persona.DisplayNameLastFirst");_e.$2M.$1Eg=new _a.$4U("Data.Persona.DisplayNameLastFirstSortKey");_e.$2M.$6yv=new _a.$4U("Data.Persona.CompanyName");_e.$2M.$2ay=new _a.$4U("Data.Persona.CompanyNameSortKey");_e.$2M.$7Ts=new _a.$4U("Data.Persona.HomeCity");_e.$2M.$2kB=new _a.$4U("Data.Persona.HomeCitySortKey");_e.$2M.$9HD=new _a.$4U("Data.Persona.WorkCity");_e.$2M.$3Cn=new _a.$4U("Data.Persona.WorkCitySortKey");_e.$2M.$2c6=new _a.$4U("Data.Persona.CreationTimeString");_e.$2M.$43s=new _a.$4U("Data.Persona.RelevanceScore");_e.$5T.$25S=null;_e.$5T.$4AJ=null;_e.$5T.$$cctor();_e.$3M.$D=_a.$0.$YC;_e.$3M.$2Ey=new _H("LastEnqueuedAction",_g.$47,_e.$3M);_e.$3M.$2Nd=new _H("RequestAvailable",Boolean,_e.$3M,!0);_e.$3M.$2Nk=new _H("ResponseAvailable",Boolean,_e.$3M,!0);_e.$3M.$256=new _H("CanProcess",Boolean,_e.$3M,!0);_e.$3M.$2D5=new _H("IsEmpty",Boolean,_e.$3M,!1);_e.$BW.$1Jq="OfflineErrorInfo";_e.$5s.$D=_a.$0.$5fa;_e.$5v.$2QV=[new _a.$Gy(_a.$4U.$5U,0)];_e.$5v.$5ec=new _a.$86(_e.$F3.$2Qn,0);_e.$5v.$5ed=new _a.$7m(_e.$5v.$5ec,_e.$5v.$2QV);_e.$5v.$5ee=new _a.$86(_e.$F3.$2Qn,1);_e.$5v.$5ef=new _a.$7m(_e.$5v.$5ee,_e.$5v.$2QV);_e.$5v.$4fA=new _a.$7m(null,_e.$5v.$2QV);_e.$Jj.$g=null;_e.$Ez.$18q=_a.$4U.$5U.$5M;_e.$4m.$D=_a.$0.$38x;_e.$WO.$D=_a.$0.$5yb;_e.$9T.$D=_a.$0.$1Ci;_e.$Mb.$D=_a.$0.$1e;_e.$16.$D=_a.$0.$4on;_e.$L.$2Lw="#";_e.$L.$3V9="DistributionList";_e.$Mc.$D=_a.$0.$5yc;_e.$Y1.$D=_a.$0.$5yd;_e.$GZ.$D=_a.$0.$1e;_e.$8x.$D=_a.$0.$4rs;_e.$FA.$D=_a.$0.$Jo;_e.$9Y.$D=_a.$0.$4wZ;_e.$9Y.$$cctor();_e.$A7.$D=_a.$0.$4wb;_e.$2w.$D=_a.$0.$11W;_e.$2w.$2xu=null;_e.$2w.$$cctor();_e.$Ms.$D=_a.$0.$50F;_e.$Qn.$D=_a.$0.$4zL;_e.$9a.$D=_a.$0.$4zc;_e.$9a.$$cctor();_e.$kv.$D=_a.$0.$3ZY;_e.$68.$D=_a.$0.$3a0;_e.$68.$$cctor();_e.$Mw.$D=_a.$0.$5ye;_e.$kz.$D=_a.$0.$15b;_e.$KW.$D=_a.$0.$5di;_e.$9C.$D=_a.$0.$5yg;_e.$cI.$D=_a.$0.$5yh;_e.$7w.$Tb=null;_e.$7w.$$cctor();_e.$ct.$D=_a.$0.$1y8;_e.$7A.$D=_a.$0.$68t;_e.$3s.$D=_a.$0.$69D;_e.$Qq.$D=_a.$0.$5yf;_e.$ou.$D=_a.$0.$5yi;_e.$9V.$D=_a.$0.$4jC