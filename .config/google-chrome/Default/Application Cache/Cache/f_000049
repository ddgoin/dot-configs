Type.registerNamespace("OSF");OSF.AppSpecificSetup=function(){};OSF.AppSpecificSetup._setupFacade=function(n,t,i){n.$8zk(i);t.getLocalizedCSSFilePath=OSF.AppSpecificSetup.$7LL;t.getLocalizedImageFilePath=OSF.AppSpecificSetup.$7LN};OSF.AppSpecificSetup.$7LL=function(n){var t=n==="MOEErrorUx.css";var i=_g.$S.get_$L().get_$38().get_$XC()?"moeerroruxrtl.css":n;return t?_y.$j.$g.$7JA(i.toLowerCase()):""};OSF.AppSpecificSetup.$7LN=function(n){var t=n==="thinking24.gif"||n==="agavedefaulticon96x96.png"||n==="moe_status_icons.png";return t?_y.$j.$g.$rU(n.toLowerCase()):""};Type.registerNamespace("_d");_d.$19G=function(){};_d.$19G.registerInterface("_d.$19G");_d.$tz=function(){};_d.$tz.prototype={thirdParty:1,owaUrlParameters:2,owaContext:3,unitTest:4};_d.$tz.registerEnum("_d.$tz",!1);_d.$11L=function(){};_d.$11L.registerInterface("_d.$11L");var ISharingCalendarViewModelFactory=function(){};ISharingCalendarViewModelFactory.registerInterface("ISharingCalendarViewModelFactory");var ICalendarSharingPermissionsViewModelFactory=function(){};ICalendarSharingPermissionsViewModelFactory.registerInterface("ICalendarSharingPermissionsViewModelFactory");var ICalendarPickerModernGroupsViewModel=function(){};ICalendarPickerModernGroupsViewModel.registerInterface("ICalendarPickerModernGroupsViewModel");var ICalendarPickerModernGroupsProvider=function(){};ICalendarPickerModernGroupsProvider.registerInterface("ICalendarPickerModernGroupsProvider");_d.$ri=function(){};_d.$ri.registerInterface("_d.$ri");var ICalendarEventSearchViewModel=function(){};ICalendarEventSearchViewModel.registerInterface("ICalendarEventSearchViewModel");var ICalendarSurfaceTimelineViewModel=function(){};ICalendarSurfaceTimelineViewModel.registerInterface("ICalendarSurfaceTimelineViewModel");_d.$19l=function(){};_d.$19l.registerInterface("_d.$19l");_d.$xL=function(){};_d.$xL.prototype={Zero:0,ThirtyMinutes:18e5,OneHour:36e5,NinetyMinutes:54e5,TwoHours:72e5,AllDay:-1,Custom:-2};_d.$xL.registerEnum("_d.$xL",!1);_d.$ph=function(){};_d.$ph.prototype={singleDay:0,week:1};_d.$ph.registerEnum("_d.$ph",!1);_d.$19j=function(){};_d.$19j.registerInterface("_d.$19j");_d.$19k=function(){};_d.$19k.registerInterface("_d.$19k");_d.$45=function(){};_d.$45.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.$45.registerEnum("_d.$45",!1);var IEmailRemindersViewModel=function(){};IEmailRemindersViewModel.registerInterface("IEmailRemindersViewModel");var IEmailRemindersViewModelFactory=function(){};IEmailRemindersViewModelFactory.registerInterface("IEmailRemindersViewModelFactory");_d.$RA=function(){};_d.$RA.registerInterface("_d.$RA");_d.$19Z=function(){};_d.$19Z.registerInterface("_d.$19Z");_d.$jR=function(){};_d.$jR.prototype={required:0,optional:1,resource:2,organizer:3};_d.$jR.registerEnum("_d.$jR",!1);_d.$19e=function(){};_d.$19e.registerInterface("_d.$19e");_d.$19f=function(){};_d.$19f.registerInterface("_d.$19f");_d.$19g=function(){};_d.$19g.registerInterface("_d.$19g");_d.$y6=function(){};_d.$y6.prototype={};_d.$y6.registerEnum("_d.$y6",!1);_d.$19c=function(){};_d.$19c.registerInterface("_d.$19c");_d.$12L=function(){};_d.$12L.registerInterface("_d.$12L");_d.$1BG=function(){};_d.$1BG.registerInterface("_d.$1BG");_d.$1BE=function(){};_d.$1BE.registerInterface("_d.$1BE");_d.$nC=function(n){this.$48c=n};_d.$14U=function(n,t){this.$1zV=n;this.$2g2=t};_d.$12Y=function(){};_d.$12Y.registerInterface("_d.$12Y");_d.$qi=function(){};_d.$qi.prototype={firstLast:0,lastFirst:1};_d.$qi.registerEnum("_d.$qi",!1);_d.$1Ak=function(){};_d.$1Ak.registerInterface("_d.$1Ak");_d.$1Al=function(){};_d.$1Al.registerInterface("_d.$1Al");_d.$1Aj=function(){};_d.$1Aj.registerInterface("_d.$1Aj");var IModernGroupCardViewModelFactory=function(){};IModernGroupCardViewModelFactory.registerInterface("IModernGroupCardViewModelFactory");var IModernGroupMembershipPivotViewModel=function(){};IModernGroupMembershipPivotViewModel.registerInterface("IModernGroupMembershipPivotViewModel");_d.$1An=function(){};_d.$1An.registerInterface("_d.$1An");_d.$1Ao=function(){};_d.$1Ao.registerInterface("_d.$1Ao");_d.$1Am=function(){};_d.$1Am.registerInterface("_d.$1Am");var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.$lv=function(){};_d.$lv.registerInterface("_d.$lv");function CoreViewModelsComponent(){}CoreViewModelsComponent.prototype={$1QB:function(n,t,i){var r=this;n.$9V(_d.$mG).$9Iy(IMailComposeDiscardManager).$9Iz().$9J0(function(){return new _d.$mG});n.$9V(_d.$5S.$4dA).$9Iy(IPeopleSuggestionLoader).$9Iz();n.$9V(_d.$5S.$4dA).$9Iy(IPeopleSuggestionLoader).$9Iz();var u=this;n.$9V(_d.$7v).$9Iz().$9J0(function(){return new _d.$7v(n.$5uT(_d.$np),n.$5uT(_0365f.$M),n.$5uT(_a.NativeBridge),n.$5uT(_h.$OX),n.$5uT(_a.$o),n.$5uT(_g.$S))});if(i.get_$B5()!=="Mouse"&&!n.$5uT(_a.NativeBridge).$32.get_$7r().get_$18g()){var f=this;n.$9V(_d.$58).$9Iy(ICalendarMiniatureNextAppointmentManager).$9J0(function(){return new _d.$58(i.get_$B5(),n.$5uT(_a.$aE),n.$5uT(_js.$Cm),n.$5uT(_c.$1S),n.$5uT(_d.$7y).$5X)}).$9Iz()}var e=this;n.$9V(_d.$C4).$9Iy(IPopOutHelper).$9Iz().$9J0(function(){return new _d.$C4(n.$5uT(_y.$sS))});var o=this;n.$9V(_d.$Et).$9Iy(IPopOutViewModel).$9Iz().$9J0(function(){return new _d.$Et(n.$5uT(_y.$N),n.$5uT(IPopOutHelper))});var s=this;n.$9V(_d.$mK).$9Iz().$9J0(function(){return new _d.$mK(n.$9Ha(IInferenceTracker),n.$5uT(_g.$S),n.$5uT(IMailComposeContextFactory))});var h=this,c=this;n.$9V(_d.$gl).$9J0(function(){return new _d.$gl(n.$9Ha(IInferenceTracker),n.$5uT(_a.$42),n.$5uT(_y.$N),n.$5uT(IMailComposeContextFactory),n.$5uT(_y.$RL),n.$5uT(_g.$X2),n.$5uT(_a.$o))}).$9J1(function(t){t.$4j4=n.$5uT(_d.$X5)});var l=this;n.$9V(_d.$7y).$9Iz().$9J0(function(){return new _d.$7y(n.$5uT(_d.$jp),n.$5uT(_y.$N),n.$5uT(_c.$1S),n.$5uT(_d.$oO),n.$5uT(_g.$4H),n.$5uT(_a.$42),n.$5uT(_a.$5X).$7x("CalendarSearchAndPin")?10:5,n.$5uT(_a.$5X).$7x("ModernGroups")?n.$9Ha(ICalendarPickerModernGroupsProvider):null,n.$9Ha(ICalendarPickerModernGroupsViewModel))});var a=this;n.$9V(_d.$oO).$9Iz().$9J0(function(){return new _d.$oO(n.$5uT(_d.$CO),n.$5uT(_a.$42),n.$5uT(_c.$1S))});var v=this;n.$9V(_d.$XB).$9Iz().$9J0(function(){return new _d.$XB(n.$9HY(ICalendarSharingPermissionsViewModelFactory),n.$9HY(ISharingCalendarViewModelFactory),n.$5uT(_c.$1S),n.$5uT(_y.$N),n.$5uT(_a.$o))});var y=this;n.$9V(_d.$jj).$9Iz().$9J0(function(){return new _d.$jj(n.$5uT(_d.$XB),n.$5uT(_c.$1S),n.$5uT(_y.$N))});var p=this;n.$9V(_d.$jp).$9Iz().$9J0(function(){return new _d.$jp(n.$5uT(_d.$jj),n.$5uT(_d.$XB),n.$5uT(_c.$1S))});var w=this;n.$9V(_c.$Js).$9Iz().$9J0(function(){return new _c.$Js(n.$5uT(_d.$7y).$5X,n.$5uT(_c.$kq),n.$5uT(_c.$1S),n.$5uT(_0365f.$M),n.$5uT(_js.$Cm))});var b=this;n.$9V(_c.$kq).$9Iz().$9J0(function(){return new _c.$kq(n.$5uT(_a.$42))});var k=this;n.$9V(_d.$jl).$9Iz().$9J0(function(){return new _d.$jl(n.$5uT(_a.$42),n.$5uT(_y.$N),n.$5uT(IMailComposeContextFactory),n.$9HZ(_d.$X5),n.$5uT(_c.$Js))});var d=this;n.$9V(_d.$fe).$9Iz().$9J0(function(){return new _d.$fe(n.$5uT(_d.$EI),n.$5uT(_y.$N),n.$5uT(_g.$GM),n.$5uT(_d.$Wz),n.$5uT(_c.$1S),n.$9Ha(IAttachmentWellViewModelFactory),n.$5uT(_a.$5X),n.$9Ha(IEmailRemindersViewModelFactory))});var g=this;n.$9V(_d.$eo).$9Iz().$9J0(function(){return new _d.$eo(n.$5uT(_d.$EI),n.$5uT(_y.$N),n.$5uT(_g.$GM),n.$5uT(_c.$Js),n.$5uT(_d.$fe))});var nt=this;n.$9V(_d.$je).$9Iz().$9J0(function(){return new _d.$je(n.$5uT(_d.$Aq),n.$5uT(_d.$T0),n.$5uT(_d.$eo),n.$5uT(_d.$6t))});var tt=this;n.$9V(_d.$HB).$9Iz().$9J0(function(){return new _d.$HB(n.$5uT(_d.$7y),n.$5uT(_c.$Js),n.$5uT(_c.$1S),i.get_$B5()==="Mouse"?n.$5uT(_d.$Wz):null,n.$5uT(_y.$N),n.$5uT(_g.$4H),n.$9Ha(ICalendarSurfaceTimelineViewModel),n.$5uT(_0365f.$M))});var it=this;n.$9V(_d.$Iw).$9Iz().$9J0(function(){return new _d.$Iw(n.$5uT(_d.$3Q),n.$9Ha(ICalendarEventSearchViewModel))});var rt=this;n.$9V(_d.$6t).$9Iz().$9J0(function(){return new _d.$6t});var ut=this;n.$9V(_d.$HP).$9Iy(IExtensibilityStatistics).$9Iz().$9J0(function(){return new _d.$HP});var ft=this;n.$9V(_d.$kZ).$9Iz().$9J0(function(){return new _d.$kZ(n.$5uT(_g.$R2),n.$5uT(IExtensibilityStatistics),n.$5uT(_a.$5X))});var et=this;n.$9V(_d.$kc).$9Iz().$9J0(function(){return new _d.$kc});var ot=this,st=this;n.$9V(_d.$kb).$9Iz().$9J0(function(){var t=n.$5uT(_g.$S);return new _d.$kb(t.get_$Vz(),t.get_$38().get_$Gz(),t.get_$38().get_$Br(),t.get_$1t().get_$IJ(),n.$5uT(_y.$N),n.$5uT(IItemReadingPaneContextFactory),n.$5uT(_y.$G1),n.$5uT(IMailComposeContextFactory),n.$5uT(_a.$o),n.$5uT(_a.NativeBridge).$9I,n.$5uT(_a.$42),n.$5uT(_a.$BK))}).$9J1(function(t){t.$La=n.$5uT(_d.$I6);t.$Gk=n.$5uT(_d.$V1);t.$Db=n.$5uT(_d.$Aq)});var ht=this;n.$9V(_d.$Qa).$9Iy(IExtensibilityViewModelFactory).$9Iz().$9J0(function(){var t=n.$5uT(_g.$S);return new _d.$Qa(n.$5uT(_d.$kc),t.get_$38().get_$73(),i.get_$8if(),n.$5uT(_a.NativeBridge).$9I,n.$5uT(_a.$o),n.$5uT(_y.$N),n.$5uT(_0365f.$M),n.$5uT(_d.$kZ),n.$5uT(_d.$kb),n.$5uT(IExtensibilityStatistics))});var ct=this;n.$9V(_d.$as).$9Iz().$9J0(function(){return new _d.$as(n.$5uT(_d.$gl),n.$5uT(_d.$EI),n.$5uT(_y.$5G),n.$5uT(_y.$N),n.$5uT(_a.$42),n.$5uT(_g.$R2),n.$5uT(_d.$Aq),n.$5uT(_d.$kD),n.$5uT(_g.$M7),n.$5uT(_a.$o))});var lt=this;n.$9V(_d.$kD).$9Iz().$9J0(function(){return new _d.$kD(n.$5uT(_c.$1S),n.$5uT(_a.$42),n.$5uT(_y.$N))});var at=this;n.$9V(_d.$jJ).$9Iz().$9J0(function(){return new _d.$jJ(n.$5uT(_y.$N),n.$5uT(_y.$5G),n.$5uT(_a.$42),n.$5uT(IMailComposeContextFactory),n.$5uT(_a.$o))});var vt=this;n.$9V(_d.$sh).$9Iy(IItemPartPartnerViewModelFactory).$9Iz().$9J0(function(){return new _d.$sh(n.$5uT(_d.$as),n.$5uT(_d.$X8),n.$5uT(_d.$jJ),n.$5uT(_a.$42),n.$5uT(_d.$JY),n.$9Ha(IModernGroupsNavigationFactory),n.$5uT(_a.$5X))});var yt=this;n.$9V(IMailComposeContextFactory).$9Iz().$9J0(function(){return new _d.$13H(n.$5uT(_y.$gg),n.$5uT(_a.$BK))});var pt=this;n.$9V(_d.$si).$9Iy(IItemReadingPaneContextFactory).$9Iz().$9J0(function(){return new _d.$si});var wt=this;n.$9V(IMailResponseViewModelFactory).$9Iz().$9J0(function(){return new _d.$mK(n.$9Ha(IInferenceTracker),n.$5uT(_g.$4H),n.$5uT(IMailComposeContextFactory))});var bt=this;n.$9V(_d.$T0).$9Iz().$9J0(function(){return new _d.$T0(n.$5uT(_y.$ag),n.$5uT(_d.$gl),n.$5uT(_d.$jl),n.$5uT(_a.$o),n.$9HZ(_d.$jk),n.$9HZ(_d.$X5),n.$5uT(_g.$X2),n.$5uT(_a.$8G))});var kt=this;n.$9V(_d.$Wz).$9Iz().$9J0(function(){return new _d.$Wz(n.$5uT(_y.$N),n.$5uT(_c.$1S),n.$5uT(_a.$42))});var dt=this;n.$9V(_d.$jk).$9Iz().$9J0(function(){return new _d.$jk(n.$5uT(_d.$Aq),n.$5uT(_d.$I6),n.$5uT(_y.$N))});var gt=this;n.$9V(_d.$np).$9Iz().$9J0(function(){return new _d.$np(n.$5uT(_y.$N))});var ni=this;n.$9V(_d.$XG).$9J0(function(){return new _d.$XG(n.$5uT(_y.$N),n.$5uT(_d.$S6),n.$5uT(_y.$FL))});var ti=this;n.$9V(IUnsupportedItemReadingPaneViewModel).$9J0(function(){return new _d.$CA(n.$5uT(_y.$j))});var ii=this;n.$9V(_d.$4n).$9Iy(_y.$12a).$9J0(function(){return new _d.$4n(n.$5uT(_0365f.$M),n.$9Ha(IAttachmentWellViewModelFactory))});var ri=this;n.$9V(_d.$v9).$9Iy(ITaskReadingPaneViewModelFactory).$9Iz().$9J0(function(){return new _d.$v9(n.$5uT(_0365f.$M),n.$9Ha(IAttachmentWellViewModelFactory))});var ui=this;n.$9V(_d.$di).$9J0(function(){return new _d.$di(n.$5uT(_0365f.$M),n.$9Ha(IAttachmentWellViewModelFactory))});var fi=this;n.$9V(_d.$P6).$9Iy(IPeopleSearchSuggestionAdaptorViewModel).$9J0(function(){return new _d.$P6(n.$5uT(_y.$N),n.$5uT(_d.$EI))});var ei=this;n.$9V(_d.$X5).$9Iz().$9J0(function(){return new _d.$X5(n.$5uT(IMailComposeViewModelFactory),n.$5uT(_y.$N))});var oi=this;n.$9V(_d.$EI).$9Iz().$9J0(function(){return new _d.$EI(n.$5uT(_d.$QF),n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$5uT(_a.$42))});var si=this;n.$9V(_d.$bi).$9Iz().$9J0(function(){return new _d.$bi(n.$5uT(_y.$N),n.$5uT(_h.$5A),n.$5uT(_d.$EI))});var hi=this;n.$9V(_d.$QF).$9Iy(ICompositePersonaViewModelFactory).$9Iz().$9J0(function(){return new _d.$QF(n.$5uT(_y.$N),n.$9HZ(_d.$JY))});var ci=this;n.$9V(_d.$Vf).$9Iz().$9J0(function(){return new _d.$Vf(n.$5uT(_d.$QF),n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$5uT(_a.$42))});var li=this;n.$9V(_d.$sz).$9Iy(IMeCardViewModelFactory).$9Iz().$9J0(function(){return new _d.$sz(n.$5uT(_g.$GM),n.$5uT(_c.$2G),n.$5uT(_d.$EI),n.$5uT(_a.$42),n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$5uT(_a.NativeBridge))});var ai=this,vi=this;n.$9V(_d.$mr).$9Iz().$9J0(function(){return new _d.$mr}).$9J1(function(t){t.$50=n.$5uT(_d.$EI)});var yi=this,pi=this;n.$9V(_d.$l6).$9Iz().$9J0(function(){return new _d.$l6}).$9J1(function(t){t.$50=n.$5uT(_d.$EI)});var wi=this,bi=this;n.$9V(_d.$l7).$9Iz().$9J0(function(){return new _d.$l7(n.$5uT(_d.$CO),n.$5uT(_y.$Q0))}).$9J1(function(t){t.$50=n.$5uT(_d.$EI)});var ki=this,di=this;n.$9V(_d.$lB).$9Iz().$9J0(function(){return new _d.$lB}).$9J1(function(t){t.$50=n.$5uT(_d.$EI)});var gi=this,nr=this;n.$9V(_d.$ms).$9Iz().$9J0(function(){return new _d.$ms}).$9J1(function(t){t.$2LJ=n.$5uT(_d.$mr)});var tr=this;n.$9V(_d.$S6).$9Iy(IRecipientWellViewModelFactory).$9Iz().$9J0(function(){return new _d.$S6(n.$5uT(_y.$N),n.$5uT(_d.$EI),n.$5uT(_a.$42))});var ir=this;n.$9V(_d.$Sc).$9Iz().$9J0(function(){return new _d.$Sc(n.$5uT(_y.$N),n.$5uT(_d.$Vf))});if(i.get_$B5()!=="Mouse")if(i.get_$B5()==="TouchNarrow"){var rr=this;n.$9V(_d.$tV).$9Iy(IOptionsViewModel).$9J0(function(){return new _d.$tU(n.$5uT(_0365f.$M),n.$5uT(_d.$lv))})}else{var ur=this;n.$9V(_d.$tV).$9Iy(IOptionsViewModel).$9J0(function(){return new _d.$8r(n.$5uT(_0365f.$M),n.$5uT(_d.$lv),n.$5uT(_a.NativeBridge),n.$5uT(_y.$Qx),n.$5uT(_a.$o))})}var fr=this;n.$9V(_d.$WA).$9Iz().$9J0(function(){return new _d.$WA(n.$5uT(_y.$N),n.$5uT(_g.$S))});var er=this,or=this;n.$9V(_d.$PK).$9Iz().$9J0(function(){return new _d.$PK(n.$5uT(_d.$CO),n.$5uT(_y.$N),n.$5uT(_g.$S),n.$5uT(_d.$WA),n.$5uT(_d.$cR),n.$5uT(_d.$eT),n.$5uT(_a.$42),n.$5uT(_js.$Cm))}).$9J1(function(t){t.$3CP=n.$5uT(_d.$Sc);t.$11J=n.$5uT(_d.$Vf)});var sr=this,hr=this;n.$9V(_d.$bm).$9Iz().$9J0(function(){return new _d.$bm(n.$5uT(_a.$Me),n.$5uT(_y.$N),n.$5uT(_a.$8G))}).$9J1(function(t){t.$w7=n.$5uT(_d.$QF);t.$50=n.$5uT(_d.$EI)});var cr=this,lr=this;n.$9V(_d.$mD).$9Iz().$9J0(function(){return new _d.$mD(n.$5uT(_d.$bm),n.$5uT(_y.$N),n.$5uT(_a.$8G))}).$9J1(function(t){t.$50=n.$5uT(_d.$EI)});var ar=this;n.$9V(_d.$aZ).$9Iz().$9J0(function(){return new _d.$aZ(n.$5uT(_a.$Me),n.$5uT(_a.$8G))});var vr=this;n.$9V(_d.$mC).$9Iz().$9J0(function(){return new _d.$mC(n.$5uT(_a.$Me),n.$5uT(_a.$8G))});var yr=this;n.$9V(_d.$cR).$9Iz().$9J0(function(){return new _d.$cR(n.$5uT(_a.$42))});var pr=this;n.$9V(_d.$Mj).$9Iz().$9J0(function(){return new _d.$Mj(n.$5uT(_a.$42),n.$5uT(_g.$S).get_$4r(),n.$5uT(_y.$N))});var wr=this;n.$9V(_d.$jQ).$9Iz().$9J0(function(){return new _d.$jQ(n.$5uT(_d.$Vf),n.$5uT(_y.$N),n.$5uT(_a.$42))});var br=this;n.$9V(_d.$k6).$9Iz().$9J0(function(){return new _d.$k6(n.$5uT(_d.$jQ),n.$9HZ(_d.$hu),n.$5uT(_y.$N),n.$5uT(_a.$42),n.$5uT(_a.$BK))});var kr=this;n.$9V(_d.$Dv).$9Iz().$9J0(function(){return new _d.$Dv(n.$5uT(_g.$S).get_$38(),n.$5uT(_a.$42))});var dr=this;n.$9V(_d.$h8).$9Iz().$9J0(function(){return new _d.$h8(n.$5uT(_d.$Dv),n.$5uT(_c.$1S))});var gr=this;n.$9V(IMeetNowManagerFactory).$9Iz().$9J0(function(){return new _d.$13a(n.$5uT(_d.$Dv),n.$5uT(_a.$42),n.$5uT(_a.$8G))});var nu=this;n.$9V(_d.$kA).$9Iz().$9J0(function(){return new _d.$kA(n.$5uT(_d.$h8),n.$5uT(_a.$42))});var tu=this;n.$9V(_d.$Aq).$9Iz().$9J0(function(){var t=new _d.$Aq(n.$5uT(_d.$WA),n.$5uT(_d.$PK),n.$5uT(_d.$Mj),n.$5uT(_d.$mD),n.$5uT(_d.$T0),n.$5uT(_d.$k6),n.$5uT(_g.$S),n.$5uT(_a.$42),n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$9HZ(_c.$Js),n.$5uT(_d.$fr),n.$5uT(_0365f.$M),n.$5uT(_d.$kA),n.$5uT(_d.$k5),n.$5uT(_g.$X2),n.$5uT(_d.$Wz),n.$9Ha(IAttachmentWellViewModelFactory),n.$9Ha(IExtensibilityViewModelFactory),n.$5uT(_a.$BK));var i=n.$5uT(_y.$FL);i.$340(_d.$Aq.getName(),[n.$5uT(_c.$1S)]);return t});var iu=this,ru=this;n.$9V(_d.$Wr).$9Iz().$9J0(function(){return new _d.$Wr(n.$5uT(_y.$N))}).$9J1(function(t){t.$66=n.$5uT(_d.$S6)});var uu=this;n.$9V(_d.$eT).$9Iz().$9J0(function(){return new _d.$eT(n.$5uT(_d.$Mj),n.$5uT(_y.$N))});var fu=this;n.$9V(_d.$k5).$9Iz().$9J0(function(){return new _d.$k5(n.$5uT(_d.$Mj),n.$5uT(_d.$WA),n.$5uT(_d.$cR),n.$5uT(_y.$N))});var eu=this;n.$9V(_d.$I6).$9Iz().$9Iy(ICalendarReadingPaneViewModelFactory).$9J0(function(){var t=new _d.$I6(n.$5uT(_d.$T0),n.$5uT(_d.$mC),n.$5uT(_d.$Qa),n.$5uT(_d.$Wr),n.$5uT(_d.$EI),n.$5uT(_c.$Js),n.$5uT(_y.$N),n.$5uT(_d.$fe),n.$5uT(_a.$42),n.$5uT(_a.$o));var i=n.$5uT(_y.$FL);i.$340(_d.$I6.getName(),[n.$5uT(_c.$1S)]);return t});var ou=this;n.$9V(_d.$CO).$9Iz().$9J0(function(){return new _d.$CO(n.$5uT(_a.$42),n.$5uT(_a.$5X),n.$5uT(_0365f.$M))});var su=this;n.$9V(_d.$X8).$9Iz().$9J0(function(){var t=new _d.$X8(n.$9HY(ISharingCalendarViewModelFactory),n.$5uT(_d.$7y),n.$5uT(_0365f.$M),n.$5uT(_y.$N),n.$5uT(_c.$1S),n.$5uT(_a.$42),n.$5uT(_g.$M7));var i=n.$5uT(_y.$FL);i.$340(_d.$X8.getName(),[n.$5uT(_c.$1S)]);return t});var hu=this;n.$9V(_d.$DG).$9J0(function(){return new _d.$DG(n.$5uT(_0365f.$M),n.$5uT(_g.$4H))});var cu=this;n.$9V(_d.$HG).$9J0(function(){return new _d.$HG(n.$5uT(_c.$2G))});var lu=this;n.$9V(_d.$L8).$9J0(function(){return new _d.$L8(n.$5uT(_c.$2G))});n.$9V(_d.$F1).$9Iz();var au=this;n.$9V(_d.$nB).$9Iz().$9J0(function(){return new _d.$nB(n.$5uT(_0365f.$M),n.$5uT(_d.$F1))});var vu=this;n.$9V(_d.$oy).$9Iz().$9J0(function(){return new _d.$oy(n.$5uT(_d.$F1))});if(i.get_$B5()==="Mouse"){var yu=this;n.$9V(INotificationTrayViewModel).$9Iz().$9J0(function(){var i=n.$5uT(_g.$S);if(!i.get_$6D().get_$5v())return new _d.$tO;var t=new _d.$Ot;_g.$S.get_$L().get_$1t().get_$3wE()&2&&t.$1fF(n.$5uT(_d.$DG));t.$1fF(n.$5uT(_d.$HG));t.$1fF(n.$5uT(_d.$L8));_g.$S.get_$L().get_$1t().get_$1jb()&&t.$1fF(new _d.$nq(n.$5uT(_d.$7v)));t.$1fF(n.$5uT(_d.$F1));n.$5uT(_d.$nB);n.$5uT(_d.$oy);return t})}else{var pu=this;n.$9V(INotificationTrayViewModel).$9Iz().$9J0(function(){return new _d.$tO})}var wu=this;n.$9V(_d.$V1).$9Iy(IMailComposeViewModelFactory).$9Iz().$9J0(function(){return new _d.$V1(n.$5uT(IExtensibilityViewModelFactory),n.$5uT(_d.$S6),n.$5uT(_d.$fr),n.$5uT(_d.$hu),n.$5uT(IMailComposeContextFactory),n.$5uT(_d.$EI),n.$5uT(_y.$N),n.$5uT(_d.$VF),n.$5uT(_d.$mG),n.$5uT(_y.$FL),n.$5uT(_0365f.$M),n.$9Ha(IAttachmentWellViewModelFactory),n.$5uT(_a.$5X),n.$5uT(_a.$BK),n.$9HY(IAttachmentsFilePickerPanelViewModel),n.$9HY(IInferenceTracker),n.$5uT(_g.$MZ))});var bu=this;n.$9V(_d.$my).$9J0(function(){return new _d.$my(n.$5uT(_d.$Sc))});var ku=this;n.$9V(_y.$G1).$9Iy(_y.$G1).$9J0(function(){return new _d.$12j(n.$5uT(_y.$R3),n.$5uT(_h.$7U),n.$5uT(_y.$N),n.$5uT(_g.$S))});var du=this;n.$9V(_y.$lf).$9J0(function(){return new _d.$12b(n.$5uT(_y.$N),n.$5uT(_y.$R3),n.$5uT(_d.$I6),n.$9HY(ITaskReadingPaneViewModelFactory))});var gu=this;n.$9V(_a.$Sh).$9Iz().$9J0(function(){return new _a.$Sh});var nf=this;n.$9V(_d.$TW).$9Iz().$9J0(function(){return new _d.$TW(n.$5uT(_y.$N),n.$5uT(_g.$4H),n.$5uT(_0365f.$M),n.$5uT(_h.$5A),n.$9Ha(IInferenceTracker),n.$9HY(IMailErrorHandler))});var tf=this;n.$9V(_d.$TW.$41v).$9Iz().$9J0(function(){return new _d.$TW.$41v(n.$5uT(_d.$TW))});var rf=this;n.$9V(_c.$sc).$9Iz().$9J0(function(){return new _d.$17B(n.$5uT(_y.$FL))});var uf=this;n.$9V(_d.$rw).$9Iz().$9J0(function(){return new _d.$E9});var ff=this;n.$9V(_d.$fr).$9Iz().$9J0(function(){return new _d.$fr(n.$5uT(_y.$N),n.$5uT(_g.$4H),n.$5uT(_d.$rw))});var ef=this;n.$9V(_d.$LX).$9Iy(IModuleHelpProvider).$9Iz().$9J0(function(){var t=n.$5uT(_g.$GM);return new _d.$LX(t.get_$555(),t.get_$X0(),n.$5uT(_a.$8G),n.$5uT(_d.$VF),n.$5uT(_y.$6I),i.get_$B5(),n.$5uT(_y.$N))});var of=this;n.$9V(_d.$VF).$9Iy(_d.$12L).$9Iz().$9J0(function(){return new _d.$VF(n.$5uT(_h.$OX),n.$5uT(_y.$N),n.$5uT(_g.$S).get_$QG().AllowOfflineOn,n.$5uT(_0365f.$M))});var sf=this;n.$9V(_d.$f2).$9Iy(_d.$f2).$9Iz().$9J0(function(){return new _d.$f2(n.$5uT(_y.$N),n.$5uT(_a.$42),n.$5uT(_h.$7U),n.$5uT(_d.$aZ),n.$5uT(_d.$Aq),n.$5uT(IMailComposeContextFactory),n.$5uT(_g.$M7),n.$5uT(_a.$8G))});var hf=this;n.$9V(_d.$hN).$9Iy(_d.$hN).$9Iz().$9J0(function(){return new _d.$hN(n.$5uT(_y.$N),n.$5uT(_a.$42),n.$5uT(_h.$7U),n.$5uT(_d.$aZ),n.$5uT(_d.$Aq),n.$5uT(IMailComposeContextFactory),n.$5uT(_g.$M7),n.$5uT(_a.$8G),n.$5uT(_d.$EI),n.$5uT(_d.$f2))});var cf=this;n.$9V(_d.$gc).$9Iy(_d.$gc).$9Iz().$9J0(function(){return new _d.$gc(n.$5uT(_y.$N),n.$5uT(_d.$gb))});var lf=this,af=this;n.$9V(_d.$gb).$9Iy(_d.$gb).$9Iz().$9J0(function(){return new _d.$gb(n.$5uT(_y.$N))}).$9J1(function(t){t.$1KQ=n.$5uT(_d.$JY)});var vf=this,yf=this;n.$9V(_d.$Es).$9Iy(_d.$to).$9Iz().$9J0(function(){return new _d.$Es(n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$5uT(_a.$42),n.$5uT(_h.$7U),n.$5uT(_d.$gc),n.$5uT(_d.$bm),n.$5uT(_d.$aZ),n.$5uT(_d.$Aq),n.$5uT(_d.$ms),n.$9Ha(IInlineExploreListViewModelFactory),n.$5uT(_d.$l6),n.$5uT(_d.$l7),n.$5uT(_d.$lB),n.$5uT(IMailComposeContextFactory),n.$9Ha(IModernGroupCardViewModelFactory),n.$5uT(_y.$6U),n.$5uT(_g.$M7),n.$5uT(_a.$8G))}).$9J1(function(t){t.$tw=n.$5uT(_d.$hN)});var pf=this;n.$9V(_d.$JY).$9Iy(_d.$JY).$9Iz().$9J0(function(){return new _d.$JY(n.$5uT(_y.$N),n.$5uT(_a.$5X),n.$5uT(_h.$7U),n.$5uT(_d.$to))});var wf=this;n.$9V(IModernGroupsComposeFactory).$9Iz().$9J0(function(){var t=n.$5uT(_d.$JY);return t.$I(new _d.$Gu,0)});var bf=this;n.$9V(_d.$nj).$9Iz().$9J0(function(){return new _d.$nj});var kf=this;n.$9V(_d.$kE).$9Iz().$9J0(function(){return new _d.$kE(n.$5uT(_a.$42))});var df=this;n.$9V(_d.$jz).$9Iz().$9J0(function(){return new _d.$jz(i.get_$B5(),n.$5uT(_g.$S).get_$56W(),n.$5uT(_c.$2G),n.$5uT(_d.$XG))});var gf=this;n.$9V(_d.$SG).$9Iy(ISharedFolderViewModel).$9J0(function(){return new _d.$SG(n.$5uT(_d.$CO),n.$5uT(_a.$42))});var ne=this;n.$9V(_d.$sK).$9Iy(IInstantSearchFactory).$9Iz().$9J0(function(){return new _d.$sK});var te=this;n.$9V(_d.$bU).$9Iy(IOpenAnotherMailboxViewModel).$9J0(function(){return new _d.$bU(n.$5uT(_0365f.$M),n.$5uT(_d.$CO))});var ie=this;n.$9V(_d.$4s).$9Iy(IMailFolderPermissionsDialogViewModel).$9J0(function(){return new _d.$4s(n.$5uT(_d.$CO),n.$5uT(_a.$42))});var re=this;n.$9V(_d.$Ok).$9Iy(IMailErrorHandler).$9Iz().$9J0(function(){return new _d.$Ok(n.$5uT(_0365f.$M))});if(i.get_$16Y()){var fe=this;n.$9V(_c.$u0).$9Iy(IPresenceManager).$9Iz().$9J0(function(){return new _c.$u0(n.$5uT(_c.$2G),n.$5uT(_c.$D1),n.$5uT(_y.$FL))})}else{var ue=this;n.$9V(_c.$GE).$9Iy(IPresenceManager).$9Iz().$9J0(function(){return new _c.$GE(n.$5uT(_c.$2G),n.$5uT(_c.$D1),n.$5uT(_y.$FL))})}var ee=this;n.$9V(_d.$nG).$9Iz().$9J0(function(){return new _d.$nG(n.$5uT(_a.$42))});var oe=this;n.$9V(_d.$P4).$9Iz().$9J0(function(){return _d.$P4.$75O(n.$5uT(_y.$N),n.$5uT(_a.$Ha),n.$5uT(_a.$5X),n.$9Ha(IModernGroupsNavigationFactory))})},$7Is:function(){return[new _a.$6E(_d.$nj,2,9),new _a.$6E(_d.$jz,1,1),new _a.$6E(_y.$gk,1,13),new _a.$6E(_d.$7v,2,9),new _a.$6E(_a.$5m,2,1),new _a.$6E(_c.$Js,2,9),new _a.$6E(_y.$mz,2,9),new _a.$6E(_d.$TW.$41v,2,9),new _a.$6E(_d.$kE,2,9),new _a.$6E(_d.$nG,2,9)]}};_d.$Et=function(n,t){this.$47=new Sys.EventHandlerList;_d.$Et.initializeBase(this);this.$G=n;this.$19X=t};function $1Nk(n,t,i,r){var u=t[r];_js.$8.$14(u)||(i[r]=u)}function $6RP(n,t,i,r){var u;if($8(t))throw Error.argumentNull("factory");u=$8(r)?n.$19X.$3SK(t,i):n.$19X.$3SJ(t,r);return u}_d.$Et.prototype={$G:null,$19X:null,add_$5pN:function(n){this.$47.addHandler("OpenWindowRequested",n)},remove_$5pN:function(n){this.$47.removeHandler("OpenWindowRequested",n)},$5i:function(n,t,i,r,u){if(!this.$19X.$4Fs(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var f=this.$47.getHandler("OpenWindowRequested");if($8(f))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var e=this.$19X.$7OX(n);u=$8(u)?"_blank":u;f(this,new _y.$14O(e,t,i,r,u))},$8lI:function(n,t,i,r){this.$5pM(n,t,i,r,null,!1)},$5pM:function(n,t,i,r,u,f){if(!this.$19X.$4Fs(n))throw Error.argumentType("The parameter vmType should be ViewModel or IParameterableViewModelFactory type!");if(this.$G.get_$O()==="Mouse"){var s=window.location.href;var e=_a.$38.$1KE(s);$1Nk(this,e,i,"flights");$1Nk(this,e,i,"features");$1Nk(this,e,i,"traceMessageMaxLength");$1Nk(this,e,i,"traceComponents");$1Nk(this,e,i,"traceLevel");$1Nk(this,e,i,"perfTraceLevel");$1Nk(this,e,i,"analyticsEnabled");this.$5i(n,i,r,u,"_blank")}else{var o=$6RP(this,t(),i,u);if(o.length>1)throw Error.invalidOperation("Popping up more than one view model is not supported in touch environments. Please contact the Shell team if you have this requirement.");this.$G.$hu(o[0],0,f)}}};_d.$C4=function(n){this.$32M=n};_d.$C4.$6vg=function(n,t){if(_d.$C4.$3A6)return 4;var i=_d.$C4.$5uz(n,t);return i?_y.$Do.$54e(i)?3:2:1};_d.$C4.$5uz=function(n,t){return!_js.$8.$14(t)&&n?n.$1SQ(t):null};function $6RO(n,t){if(!n.$4Fs(t))throw Error.argument("The pop out control only supports creating ViewModels by passing in a IParameterizeableViewModelFactory");var i=n.$32M.$1wq(t);$8(i)&&(i=new t);if($8(i))throw Error.argument(String.format("Could not instantiate IParameterizeableViewModelFactory {0}",t));return i}function $6RN(n,t,i){if(!$8(i.get_$1tl())&&i.get_$1tl().length>0){t.get_$im()&&!t.get_$im().closed&&new _y.$hI(t.get_$im(),i.get_$1tl());for(var u=i.get_$1tl(),e=u.length,r=0;r<e;++r){var f=u[r];_h.$1M.get_$L().$H0(f.get_$T(),f)}}}function $4PC(n,t,i,r){var u=this;t.add_$12X(function(){_a.$3b.$Ee(i.get_$im(),function(n){i.$79T(r)})})}_d.$C4.prototype={$aQ:null,$32M:null,get_$65F:function(){if(!this.$aQ){this.$aQ={};this.$aQ.ReadMessageItem=_y.$G1;this.$aQ.ItemReadingPaneViewModelPopOutFactory=_y.$G1;this.$aQ.Chat=_d.$XG;this.$aQ.ItemAttachment=_y.$lf;this.$aQ.ComposeCalendarItemViewModelFactory=_d.$Aq;this.$aQ.OwaOptionPeoplePickerViewModelFactory=_d.$my;this.$aQ.CalendarItemDetailsViewModelFactory=_d.$I6;this.$aQ.ISharingCalendarViewModelFactory=ISharingCalendarViewModelFactory;this.$aQ.IMailComposeViewModelFactory=_d.$V1;this.$aQ.PersonaCardViewModelFactory=_d.$Es;this.$aQ.TaskReadingPaneViewModelPopOutFactory=_d.$di;this.$aQ.IAttachmentViewModelPopoutFactory=IAttachmentViewModelPopoutFactory;this.$aQ.CalendarShareMessageViewModelFactory=_d.$X8}return this.$aQ},$4Fs:function(n){return Type.isClass(n)&&(_a.$ER===n||n.inheritsFrom(_a.$ER)||n.implementsInterface(_y.$12O))||Type.isInterface(n)},$7OX:function(n){var t=this.get_$65F();for(var i in t){var r={key:i,value:t[i]};var u=r.value;if(n===u)return r.key}return n.getName()},$7Oz:function(n){return this.get_$65F()[n]},$7PD:function(n,t,i,r){var u=null;var e=$6RO(this,i);var f=r.wid;var o=_d.$C4.$5uz(t,f);_a.$3b.$1dR=f;var s=_d.$C4.$6vg(t,f);switch(s){case 4:u=this.$3SJ(e,_d.$C4.$3A6);_d.$C4.$3A6=null;break;case 1:u=this.$3SK(e,r);break;case 2:$4PC(this,n,t,f);_y.$Do.$4s9(o,this.$32M);u=this.$3SK(e,r);break;case 3:$4PC(this,n,t,f);_y.$Do.$4s9(o,this.$32M);var h=_y.$Do.$79W(o);$6RN(this,t,h);u=this.$3SJ(e,h);break;default:_a.$3.$8z(!0,"Unknown PopOutMode "+_d.$tz.toString(s));break}if(!u||!u.length)throw Error.argument("The ViewModel provided in the url is not valid!");n.$63s(u[0],n.$bW());return u},$3SJ:function(n,t){var i;if(_y.$sR.isInstanceOfType(n)){var r=n;i=r.$76G(t)}else i=[n.$wD(t)];return i},$3SK:function(n,t){var i;if(_y.$sR.isInstanceOfType(n)){var r=n;i=r.$8tD(t)}else i=[n.$ct(t)];return i}};_d.$NU=function(n,t){_d.$NU.initializeBase(this);this.$1vq=new _C(n,_d.$NU.$D);this.set_$aI(t)};_d.$NU.prototype={$1vq:null,$49Y:!1,get_$19W:function(){return this.$1vq},get_$aI:function(){return this.$49Y},set_$aI:function(n){this.$49Y=n;$Q(this,"ShowPopOutControl");return n}};_d.$SN=function(){this.$2JR=-1};_d.$SN.prototype={$3mA:0,$3mJ:null,$651:0,$F:0,get_$6u9:function(){return this.$F?Math.round(this.$651/this.$F):-1},$5x:function(n,t){this.$F++;this.$651+=n;if(n>=this.$3mA){this.$3mA=n;this.$3mJ=t}(this.$2JR===-1||n<this.$2JR)&&(this.$2JR=n)},$1AU:function(){if(!this.$F)return"";var n=$8(this.$3mJ)?"":this.$3mJ;var t=[this.$2JR,this.get_$6u9(),this.$3mA,n];return t.join(",")}};_d.$Cz=function(n,t,i,r){this.$$d_$1d4=Function.createDelegate(this,this.$1d4);this.$$d_$973=Function.createDelegate(this,this.$973);this.$$d_$13y=Function.createDelegate(this,this.$13y);this.$$d_$6wa=Function.createDelegate(this,this.$6wa);this.$$d_$7gg=Function.createDelegate(this,this.$7gg);this.$$d_$25T=Function.createDelegate(this,this.$25T);_d.$Cz.initializeBase(this);this.$5Bw=n;this.$1I0=t;this.$2Q=i;this.$p=r;this.$du=new _C(this.$$d_$25T,_d.$Cz.$D);this.$1Vg=new _C(this.$$d_$7gg,_d.$Cz.$D,this.$2Q,"CalendarEntry",this.$$d_$6wa)};function $6Jy(n){var t={};if(n.$2Q.get_$5p()&&n.$2Q.get_$5p().get_$F()>0){var i=n.$2Q.get_$5p().$7V();t["Compose Form Item Categories"]=i}return t}function $6Jz(n){n.$WO||n.set_$25D(new _y.$BF(n.$1I0,n.$$d_$1d4))}function $6Jx(n){var i=null;var t=n.$2Q.get_$5Z();_g.$9b.isInstanceOfType(t)&&t.get_$bi()&&(i=t.get_$DQ());return i}function $6Jw(n,t,i){var f=this;var u=new _y.$2j("dummy",new _C(function(){},_d.$Cz.$D));var e=this;var r=new _y.$2j(t,new _C(function(){$6K0(n,u)},_d.$Cz.$D));u=r;r.$7CK();r.set_$3AZ(i);return r}function $6K0(n,t){var i=t.$2E;var r=null;var u=null;t.get_$3AZ()?r=i:u=i;n.$13y(r,u,!1)}_d.$Cz.prototype={$du:null,$1Vg:null,$5Bw:!1,$2Q:null,$1I0:null,$p:null,$Lc:null,$WO:null,$25B:null,add_$2aH:function(n){this.$2Z("CategoriesChanged",n)},remove_$2aH:function(n){this.$2b("CategoriesChanged",n)},get_$25D:function(){return this.$WO},set_$25D:function(n){if(this.$WO!==n){this.$WO=n;$6(this,"CategoryManagementDialog")}return n},get_$4iy:function(){return this.$2Q.get_$5p()},get_$4k7:function(){this.$Lc||(this.$Lc=new _y.$Eb(this.$1I0,this.$$d_$13y,this.$du,this.$1Vg));return this.$Lc},$7Ik:function(){if(this.$25B)return this.$25B;this.$25B=new(_0365f.$s.$$(_y.$2j));if(this.$1I0&&!this.$2Q.get_$Ef()){var t=this.$1I0.$4AE();var i=this.$2Q.get_$5p()?this.$2Q.get_$5p().$7V():new Array(0);i.sort(this.$$d_$973);for(var f=t.length,e=i.length,n=0,r=0;n<f;n++){var u=!1;if(r<e&&t[n].get_$1Q()===i[r]){u=!0;r++}this.$25B.$H($6Jw(this,t[n].get_$1Q(),u))}}return this.$25B},$3ZC:function(){return this.$2Q.get_$Ef()?null:this.get_$4k7().$1QT()},$41y:function(){this.get_$4k7().$1hR($6Jy(this),1)},$13y:function(n,t,i){var r=this.$2Q.get_$5p();var u=_g.$B5.$1d2(r,i,t,n);this.$2Q.set_$5p(u);$6b(this,"CategoriesChanged")},$25T:function(){this.$13y(null,null,!0)},$6wa:function(){var n=this.$2Q.get_$5Z();return this.$5Bw&&(_g.$Di.isInstanceOfType(n)&&!n.get_$16Q()||this.$2Q.get_$1nt())?!0:!1},$7gg:function(){$6Jz(this);this.$WO.$d1()},$1d4:function(n,t,i){var r=new _h.$e3(n,t,i,$6Jx(this));var u=this;r.add_$2A(function(){var n=r.$3Bd;u.$1I0.set_$1I2(n);$6(u,"MasterCategories")});r.add_$20(_c.$5Q.$15U);this.$p.$y(r)},$973:function(n,t){var i=n.toLowerCase();var r=t.toLowerCase();return i.localeCompare(r)}};_d.$Wz=function(n,t,i){this.$G=n;this.$2f=t;this.$p=i};_d.$Wz.prototype={$G:null,$2f:null,$p:null,$8M:function(n){if(!this.$2f.get_$Hn()){_js.Trace.logError(_a.$0.$IP,"Make sure that calendarcache is loaded before creating CalendarCategoryViewModel");return null}var t=this.$2f.$2A9(n.get_$22());return t?new _d.$Cz(this.$G.get_$6Q(),t,n,this.$p):null}};_d.$EY=function(n){this.$$d_$6wL=Function.createDelegate(this,this.$6wL);this.$$d_$8qq=Function.createDelegate(this,this.$8qq);this.$$d_$3PX=Function.createDelegate(this,this.$3PX);this.$$d_$6wS=Function.createDelegate(this,this.$6wS);this.$$d_$8rM=Function.createDelegate(this,this.$8rM);_d.$EY.initializeBase(this);_a.$3.$17(n,"itemViewModel");this.$4x=n;$6K3(this);var t=this;this.$2NV=new _C(this.$$d_$8rM,_d.$EY.$D,this,"CanRemoveWithConfirmation",function(){return t.get_$6wi()});var i=this;this.$2Zu=new _C(this.$$d_$6wS,_d.$EY.$D,this,"CanCancelWithConfirmation",function(){return i.get_$6w7()});this.$Mr=new _C(this.$$d_$3PX,_d.$EY.$D)};function $6K3(n){var t=this;n.$4x.$a("CanCancel",function(){$6(n,"CanCancelWithConfirmation")});var i=this;n.$4x.$a("CanRemove",function(){$6(n,"CanRemoveWithConfirmation")})}_d.$EY.prototype={$4x:null,$2NV:null,$2Zu:null,$Mr:null,$qe:null,$1hT:null,$qd:null,$1Do:!1,get_$6wi:function(){return this.$4x.get_$U8()},get_$6w7:function(){return this.$4x.get_$hN()},get_$1hU:function(){return this.$qe},set_$1hU:function(n){if(this.$qe!==n){this.$qe=n;$6(this,"ConfirmDialogTitle")}return n},get_$3QF:function(){return this.$1hT},set_$3QF:function(n){if(this.$1hT!==n){this.$1hT=n;$6(this,"ConfirmDialogMessage")}return n},get_$2bF:function(){return this.$qd},set_$2bF:function(n){if(this.$qd!==n){this.$qd=n;$6(this,"ConfirmDialogButtonDataList")}return n},get_$Lf:function(){return this.$1Do},set_$Lf:function(n){if(this.$1Do!==n){this.$1Do=n;$6(this,"ConfirmDialogIsShown")}return n},$3PX:function(){this.set_$Lf(!1)},$8rM:function(){this.set_$1hU(_u.Strings.l_DeleteEvent_Text);this.set_$3QF(_u.Strings.l_AreYouSureYouWantToDeleteThisEvent_Text);var n=new _js.$X;n.$H(new _a.$2E(new _C(this.$$d_$8qq,_d.$EY.$D),_u.Strings.l_DeleteButtonLabel_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Back_Text));this.set_$2bF(n);this.set_$Lf(!0)},$6wS:function(){this.set_$1hU(_u.Strings.l_CancelEvent_Text);this.set_$3QF(_u.Strings.l_AreYouSureYouWantToCancelTheEvent_Text);var n=new _js.$X;n.$H(new _a.$2E(new _C(this.$$d_$6wL,_d.$EY.$D),_u.Strings.l_Yes_Text,_u.Strings.l_YouWillHaveAnOpportunityToTypeAMessageToAttendees_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Back_Text,_u.Strings.l_ReturnToTheEvent_Text));this.set_$2bF(n);this.set_$Lf(!0)},$8qq:function(){this.$Mr.$s();this.$4x.$Ta.$s()},$6wL:function(){this.$Mr.$s();this.$4x.$79.$s()}};_d.$HC=function(n){this.$$d_$8Un=Function.createDelegate(this,this.$8Un);_d.$HC.initializeBase(this);this.$1D=n};function $4Lr(n){if($8(n.$2Q)){n.$2Bs="";return}n.$2Q.get_$9w()?n.$2Q.get_$10().$8c(n.$2Q.get_$23())?n.$2Q.get_$5m()?$2Tk(n,8,8):$2Tk(n,11,11):n.set_$56q(n.$2Q.get_$10().$2P(8)):n.$2Q.get_$1UI()?$2Tk(n,11,11):$2Tk(n,11,18)}function $2Tk(n,t,i){n.set_$56q(String.format(_u.Strings.l_CalendarDragDrop_InfoTip_Text,n.$2Q.get_$10().$2P(t),n.$2Q.get_$23().$2P(i)))}_d.$HC.prototype={$1D:null,$2Q:null,$2Bs:null,get_$7F:function(){return this.$2Q},set_$7F:function(n){if(this.$2Q!==n){if(this.$2Q){this.$2Q.$w("Start",this.$$d_$8Un);this.$2Q.$w("End",this.$$d_$8Un)}this.$2Q=n;$4Lr(this);if(this.$2Q){this.$2Q.$a("Start",this.$$d_$8Un);this.$2Q.$a("End",this.$$d_$8Un)}}return n},get_$56q:function(){return this.$2Bs},set_$56q:function(n){if(this.$2Bs!==n){this.$2Bs=n;$6(this,"InfoTipString")}return n},get_$iP:function(){return!this.$1D.get_$rk()},$8Un:function(n,t){$4Lr(this)}};_d.$5N=function(n,t){this.$$d_$8fi=Function.createDelegate(this,this.$8fi);this.$$d_$8TO=Function.createDelegate(this,this.$8TO);this.$$d_$2zJ=Function.createDelegate(this,this.$2zJ);_d.$5N.initializeBase(this,[new Array(0)]);_a.$3.$M(n,"calendarItemViewModel");this.$l=n;n.$r.get_$Ef()&&(this.$oG=this.$l.$1QS());if(t){this.$kz=n.$r.get_$Ef()?t.$8M(this.$oG.$r):t.$8M(n.$r);this.$kz&&this.$kz.add_$2aH(this.$$d_$2zJ)}$6KH(this)};_d.$5N.$1f9=function(n,t){var i=n.length;t();n.length!==i&&Array.add(n,new _0365m.$9q)};_d.$5N.$2AF=function(n,t,i,r,u){if(u&&r){var f=new _0365m.$2c([new _0365m.$n(t,null,r),new _0365m.$n(i,null,u)]);return new _0365m.$Fg(n,null,f)}return u?new _0365m.$n(i,null,u):r?new _0365m.$n(n,null,r):null};_d.$5N.$4ye=function(n,t){if(!t){_js.Trace.logWarning(_a.$0.$1o,"Empty context sub-menu generated for item. OptionText: {0}",n);return new _0365m.$Fg(n,null,new _0365m.$2c([]))}for(var r=t.$1B.get_$F(),u=new Array(r),i=0;i<r;++i)u[i]=t.$1B.get_$48(i).$46();return new _0365m.$Fg(n,null,new _0365m.$2c(u))};_d.$5N.$4yf=function(n,t,i){if($8(i))return new _0365m.$n(n,null,t);for(var u=i.$1B.get_$F(),f=new Array(u),r=0;r<u;++r)f[r]=i.$1B.get_$48(r).$46();return new _0365m.$Fg(n,null,new _0365m.$2c(f))};function $6KH(n){if(n.$l.$r.get_$1DP()){var t=[];var i=n.$l.$r;var r=i.get_$Ef();var f=this;_d.$5N.$1f9(t,function(){i.get_$1PV()&&Array.add(t,new _0365m.$n(_u.Strings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$l.$f8))});var e=this;_d.$5N.$1f9(t,function(){i.get_$RF()&&!i.get_$Ho()&&Array.add(t,new _0365m.$n(_d.$Iu.$51i(n.$l.$r,1),null,n.$l.$4x.$Ta))});var o=this;_d.$5N.$1f9(t,function(){Array.add(t,_d.$5N.$2AF(_u.Strings.l_Open_LowerCase_Text,_u.Strings.l_OpenOccurrence_LowerCase_Text,_u.Strings.l_OpenSeries_LowerCase_Text,n.$l.$fv.$hi(1,!1),r?n.$l.$fv.$hi(1,!0):null))});$6KI(n,t);if(i.get_$vr()){Array.add(t,$6KD(n));if(n.$kz){n.$1Pc=n.$kz.$3ZC();if(n.$1Pc){n.$1Pc.$GP.$a("IsShown",n.$$d_$8TO);Array.add(t,n.$1Pc)}}Array.add(t,new _0365m.$9q)}$6KG(n,r,t,i);$6KF(n,r,t,i);t.length>0&&Array.removeAt(t,t.length-1);for(var u=0;u<t.length;u++)t[u].set_$tp(n);n.$1B.$6G(t)}}function $6KI(n,t){var i=n.$l.$r;var r=i.get_$Ef();var u=this;_d.$5N.$1f9(t,function(){i.get_$b4()&&Array.add(t,new _0365m.$n(_u.Strings.l_Reply_LowerCase_Text,null,n.$l.$Nl.$GL));i.get_$ds()&&Array.add(t,new _0365m.$n(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$l.$Nl.$Iy));var r=$6KE(n);r&&Array.add(t,r)})}function $6KE(n){var t=null;var i=null;if(n.$l.$r.get_$Ef()){i=n.$oG.$Nl.$G2;n.$l.$r.get_$b3()&&(t=n.$l.$Nl.$G2)}else n.$l.$r.get_$b3()&&(t=n.$l.$Nl.$G2);return _d.$5N.$2AF(_u.Strings.l_Forward_LowerCase_Text,_u.Strings.l_ForwardOccurrence_LowerCase_Text,_u.Strings.l_ForwardSeries_LowerCase_Text,t,i)}function $6KF(n,t,i,r){var u=n.$l.$Od;var f=this;_d.$5N.$1f9(i,function(){n.$l.$r.get_$1nt()||!r.get_$Hm()||r.get_$Ho()||r.get_$RF()?n.$l.$4x.$Ta.$2K&&!r.get_$RF()&&Array.add(i,_d.$5N.$2AF(_u.Strings.l_Delete_LowerCase_Text,_u.Strings.l_DeleteOccurrence_LowerCase_Text,_u.Strings.l_DeleteSeries_LowerCase_Text,n.$l.$4x.$Ta,t?n.$oG.$4x.$Ta:null)):r.get_$Cz()?Array.add(i,_d.$5N.$4ye(_u.Strings.l_Delete_LowerCase_Text,u.$27F)):Array.add(i,_d.$5N.$4yf(_u.Strings.l_Delete_LowerCase_Text,u.$2d0,u.$27F));r.get_$hN()&&Array.add(i,_d.$5N.$2AF(_u.Strings.l_CancelMeeting_LowerCase_Text,_u.Strings.l_CancelOccurrence_LowerCase_Text,_u.Strings.l_CancelSeries_LowerCase_Text,n.$l.$4x.$79,t?n.$oG.$4x.$79:null))})}function $6KG(n,t,i,r){var u=n.$l.$Od;var f=this;_d.$5N.$1f9(i,function(){if(n.$l.$r.get_$1nt())r.get_$RF()||Array.add(i,_d.$5N.$2AF(_u.Strings.l_AddToMyCalendar_Lowercase_Text,_u.Strings.l_AddToMyCalendar_Occurrence_Text,_u.Strings.l_AddToMyCalendar_Series_Text,n.$l.$4x.$13M,t?n.$oG.$4x.$13M:null));else{$3Ed(n,r.get_$13s(),i,r.get_$Cz(),_u.Strings.l_AcceptItem_LowerCase_Text,u.$22k,u.$3Jn);$3Ed(n,r.get_$13w(),i,r.get_$Cz(),_u.Strings.l_TentativelyAcceptItem_LowerCase_Text,u.$2RJ,u.$4Cp);$3Ed(n,r.get_$vq(),i,r.get_$Cz(),_u.Strings.l_DeclineItem_LowerCase_Text,u.$272,u.$2d0)}})}function $3Ed(n,t,i,r,u,f,e){t&&(r?Array.add(i,_d.$5N.$4ye(u,f)):Array.add(i,_d.$5N.$4yf(u,e,f)))}function $6KD(n){for(var u=null,t=0;t<_d.$5N.$1yU.length;t++)_d.$5N.$1yU[t].$3g===n.$l.$r.get_$92()&&(u=_d.$5N.$1yU[t]);var i=new _d.$RZ(_u.Strings.l_Calendar_ItemContextMenu_ShowAs_Text,null,n.$$d_$8fi,_d.$5N.$1yU,u);i.set_$61V(!1);i.set_$2l(!n.$l.$r.get_$2mG());for(var r=0;r<_d.$5N.$1yU.length;r++)i.$GP.$1B.get_$48(r).$1p5="CalendarItemTemplates.ShowAsMenuItemTemplate";return i}_d.$5N.prototype={$l:null,$oG:null,$1Pc:null,$kz:null,$59:function(){if(this.$kz){this.$kz.remove_$2aH(this.$$d_$2zJ);this.$1Pc&&this.$1Pc.$GP.$w("IsShown",this.$$d_$8TO)}_js.$9.prototype.$59.call(this)},$8TO:function(n,t){this.$1Pc.$GP.$2R&&this.$kz.$41y()},$8fi:function(n){if(this.$oG){this.$oG.$r.set_$92(n);this.$oG.$4x.$Ey()}else{this.$l.$r.set_$92(n);this.$l.$4x.$Ey()}},$2zJ:function(){if(this.$oG){this.$oG.$r.set_$5p(this.$kz.get_$4iy());this.$oG.$4x.$Ey()}else{this.$l.$r.set_$5p(this.$kz.get_$4iy());this.$l.$4x.$Ey()}}};_d.$wu=function(n,t){_d.$wu.initializeBase(this);this.$Gk=n;this.$G=t};_d.$wu.prototype={$Gk:null,$G:null,$VM:function(n){_js.$K.get_$L().$11p(_a.$0.$d,_y.$99.$30p(n.get_$4D()));_a.$5.acsa(_a.$0.$3L,"VM.MailCompose.Navigate");this.$Ui=!1;if(this.$G.get_$6Q()){n.get_$5L()===1&&n.set_$5L(0);this.$G.$L9(IMailComposeViewModelFactory,null,null,_y.$3p.get_$RN(),n,!0)}else{var t=this.$Gk.$wD(n);this.$G.$hu(t,1,!0)}}};_d.$X5=function(n,t){this.$$d_$I=Function.createDelegate(this,this.$I);this.$Gk=n;this.$G=t};_d.$X5.prototype={$Gk:null,$G:null,$I:function(n,t){return n&&t===1?n:new _d.$wu(this.$Gk,this.$G)}};_d.$6N=function(n,t,i,r,u,f,e,o,s){this.$$d_$1Uz=Function.createDelegate(this,this.$1Uz);_d.$6N.initializeBase(this);_a.$3.$17(n,"item");this.$fI=t;this.$31q=f;this.$17E=i;this.$Ka=r;this.$2Za=u;this.$1Hs=e;this.$qG=o;this.$SL=s;$6Kq(this,n)};_d.$6N.$1nU=function(n){var t;var i=n.get_$ZC()&&!$8(n.get_$Jh());t=i?_d.$2h.$6va(n.get_$Jh()):_d.$6N.$3ZM(n).$2w;return!!t&&t.$2Y(_a.$7.get_$2M())<0};_d.$6N.$3ar=function(n){var t=$8(n.get_$72())?0:n.get_$72().get_$F();var i=$8(n.get_$8A())?0:n.get_$8A().get_$F();return t+i};_d.$6N.$3ZM=function(n){var t;var i;if(n.get_$5m()){var r=n.get_$23().$6E(n.get_$10());t=n.get_$10().$3u();i=n.get_$23().$3QP()||!r?n.get_$23().$3u().$2q(1):n.get_$23()}else{t=n.get_$10();i=n.get_$23()}return new _h.$4S(t,i)};function $6Kp(n){n.$7VN();n.$fv=n.$2Za.$8M(n);n.$Nl=n.$fI.$8M(n.$r,null,n.$1Hs.$$d_$I);n.$Cm=new _d.$uF(n.$r,new _g.$15P,n.$r.get_$10(),n.$r.get_$23())}function $6Kq(n,t){t.$36g();n.set_$1K2(t);n.set_$7F(n.$6S.$46())}_d.$6N.prototype={$Z9:!1,$fI:null,$31q:null,$17E:null,$Ka:null,$2Za:null,$1Hs:null,$SL:null,$qG:null,$6S:null,$r:null,$Nl:null,$4x:null,$fv:null,$Cm:null,$f8:null,$Od:null,get_$1Gu:function(){return $8(this.$6S.get_$i())&&$8(this.$r.get_$i())},get_$1Bh:function(){return this.$6S.get_$Hm()||this.$r.get_$Hm()},get_$9Gs:function(){return this.$6S.get_$Hm()&&this.$r.get_$Hm()},get_$7hw:function(){return this.$Od},set_$7hw:function(n){if(this.$Od!==n){this.$Od=n;$6(this,"MeetingResponseViewModel")}return n},get_$7F:function(){return this.$r},set_$7F:function(n){if(this.$r!==n){this.$r=n;$6Kp(this);this.set_$cs(this.$r.get_$Nk()?this.$r.get_$oi():_d.$6N.$1Jf);var t=this;this.set_$2Ek(new _C(this.$$d_$1Uz,_d.$6N.$D,this.$r,"CanJoin",function(){return t.$r.get_$1PV()}));$6(this,"CalendarItem")}return n},get_$cs:function(){return this.$r.get_$Nk()?this.$r.get_$oi():_d.$6N.$1Jf},set_$cs:function(n){if(this.get_$cs()!==n){this.$r.set_$Nk(n!==_d.$6N.$1Jf);this.$r.get_$Nk()&&this.$r.get_$oi()!==n&&this.$r.set_$oi(n);$6(this,"ReminderSelectedValue")}return n},get_$2Ek:function(){return this.$f8},set_$2Ek:function(n){if(this.$f8!==n){this.$f8=n;$6(this,"JoinCommand")}return n},get_$1mm:function(){if($8(this.$6S.get_$22())){if(!_g.$g.$1i.doesIdEqualName(this.$r.get_$22(),"calendar"))return!0}else if(this.$59F())return!0;return this.get_$54c()},get_$54c:function(){return this.$6S.get_$2h()!==this.$r.get_$2h()||this.$6S.get_$5m()!==this.$r.get_$5m()||!_a.$7.$4F(this.$6S.get_$10(),this.$r.get_$10())||!_a.$7.$4F(this.$6S.get_$23(),this.$r.get_$23())||this.$6S.get_$92()!==this.$r.get_$92()||this.$6S.get_$Nk()!==this.$r.get_$Nk()||this.$6S.get_$oi()!==this.$r.get_$oi()||this.$6S.get_$7J()!==this.$r.get_$7J()||this.$6S.get_$Cz()!==this.$r.get_$Cz()||!_g.$E.$4F(this.$6S.get_$4h(),this.$r.get_$4h())||!_g.$E.$4F(this.$6S.get_$Jh(),this.$r.get_$Jh())||_g.$3X.$1Co(this.$6S.get_$72(),this.$r.get_$72())||_g.$3X.$1Co(this.$6S.get_$8A(),this.$r.get_$8A())||_g.$3X.$1Co(this.$6S.get_$9D(),this.$r.get_$9D())||_g.$Lb.$4gH(this.$6S.get_$iH(),this.$r.get_$iH())||_g.$w.$4gD(this.$6S.get_$5p(),this.$r.get_$5p())?!0:this.$r.get_$54K()},get_$7S9:function(){return _g.$3X.$1Co(this.$6S.get_$72(),this.$r.get_$72())||_g.$3X.$1Co(this.$6S.get_$8A(),this.$r.get_$8A())},get_$1K2:function(){return this.$6S},set_$1K2:function(n){if(this.$6S!==n){this.$6S=n;this.$4oC()}return n},get_$CK:function(){return this.$Z9},set_$CK:function(n){this.$Z9=n;$6(this,"IsDraft");return n},get_$2h:function(){return this.$r.get_$2h()},$59F:function(){return!$8(this.$6S.get_$22())&&!$8(this.$r.get_$22())&&!_g.$1v.$4F(this.$r.get_$22(),this.$6S.get_$22())},$9D9:function(n){this.set_$7F(n)},$9DA:function(n){this.set_$7F(n);this.$9Ef()},$1QS:function(){if(!this.$r.get_$Ef())throw Error.invalidOperation("Cannot create partial recurring master model from a non-recurring event.");var n=this.$qG.$1QS(this.$6S);return this.$Ka.$8M(n)},$9Ef:function(){this.$6S.$20b(this.$r.get_$2v());this.$4oC()},$eC:function(){this.set_$7F(this.$6S.$46())},$7VN:function(){this.$4x=this.$31q.$I(this)},$4oC:function(){this.set_$7hw(this.$17E.$8M(this.$6S,1))},$1Uz:function(){this.$SL.$Q9(this.$r.get_$2El())}};_d.$T0=function(n,t,i,r,u,f,e,o){this.$fI=n;this.$17E=t;this.$qG=e;this.$1D=r;this.$31q=i;this.$2Za=u;this.$1Hs=f;this.$SL=o};_d.$T0.prototype={$fI:null,$17E:null,$1D:null,$31q:null,$qG:null,$1Hs:null,$2Za:null,$SL:null,get_$8kM:function(){return this.$31q},get_$2Fo:function(){return this.$1Hs.get_$1d()},get_$6vp:function(){return this.$2Za.get_$1d()},$8M:function(n){return new _d.$6N(n,this.$fI,this.$17E,this,this.get_$6vp(),this.get_$8kM(),this.get_$2Fo(),this.$qG,this.$SL)}};_d.$61=function(n,t,i,r,u,f){this.$$d_$7FO=Function.createDelegate(this,this.$7FO);this.$$d_$7FM=Function.createDelegate(this,this.$7FM);this.$$d_$7FN=Function.createDelegate(this,this.$7FN);this.$$d_$7FL=Function.createDelegate(this,this.$7FL);this.$$d_$8ub=Function.createDelegate(this,this.$8ub);this.$$d_$5yH=Function.createDelegate(this,this.$5yH);this.$$d_$8x0=Function.createDelegate(this,this.$8x0);this.$$d_$Ey=Function.createDelegate(this,this.$Ey);this.$$d_$AQ=Function.createDelegate(this,this.$AQ);this.$$d_$3Q=Function.createDelegate(this,this.$3Q);this.$$d_$3Kp=Function.createDelegate(this,this.$3Kp);_d.$61.initializeBase(this);this.$1T=t;this.$G=i;this.$8T=f;this.$f=n;this.$6M=r;this.$1Hs=u;$6Ki(this);var e=this;this.$13M=new _C(this.$$d_$3Kp,_d.$61.$D,this,"CanAddToMyCalendar",function(){return e.get_$1PR()});var o=this;this.$Ta=new _C(this.$$d_$3Q,_d.$61.$D,this,"CanRemove",function(){return o.get_$U8()});var s=this;this.$79=new _C(this.$$d_$AQ,_d.$61.$D,this,"CanCancel",function(){return s.get_$hN()});var h=this;this.$DS=new _C(this.$$d_$Ey,_d.$61.$D,this,"CanSave",function(){return h.get_$258()});var c=this;this.$47O=new _C(this.$$d_$8x0,_d.$61.$D,this,"CanSend",function(){return c.get_$hO()});var l=this;this.$5yI=new _C(this.$$d_$5yH,_d.$61.$D,this,"CanSend",function(){return l.get_$hO()});var a=this;this.$5wJ=new _C(this.$$d_$8ub,_d.$61.$D,this,"CanSaveDraft",function(){return a.get_$6wn()});var v=this;this.$3Ur=new _C(this.$$d_$3Q,_d.$61.$D,this,"CanDiscardDraft",function(){return v.get_$6wU()})};function $6Kh(n,t,i){var f=t?2:0;var r=n.$f.$r;if(i){r=n.$f.$6S;r.set_$10(n.$f.$r.get_$10().$h2(1));r.set_$23(n.$f.$r.get_$23().$h2(1))}else $8(n.$f.$r.$Gg)||n.$f.$r.$Gg.$s();var u=new _c.$8w(r,f,_c.$6D.$2iM(r));u.$DX=n.$DX;return u}function $21b(n,t,i,r,u){if(t&&i)throw Error.invalidOperation("Cannot send and save as draft.");var f=new(_0365f.$s.$$(_a.$3O));var c=!1;if(n.$f.get_$1Gu())f.$H($6Kh(n,t,i));else{if(i)throw Error.invalidOperation("Cannot save a draft of an existing calendar item.");$8(n.$f.$r.$Gg)||n.$f.$r.$Gg.$s();if(n.$f.get_$54c()){var e=new _c.$EQ(n.$f.$6S,n.$f.$r,r,n.$f.$6S.get_$ZC(),_c.$6D.$2iM(n.$f.$r));e.$DX=n.$DX;f.$H(e);n.$8T.$7CO(e)}if(n.$f.$59F()){c=!0;var a=n.$7Lo();f.$H(a)}}if(f.get_$F()>0){for(var o=null,l=f.get_$3T(),v=l.length,s=0;s<v;++s){var h=l[s];$6Kj(n,h,u);if(o){var p=this;o.add_$2A(function(t){n.$1T.$y(h)})}o=h}var y=f.get_$48(f.get_$F()-1);$6Kk(n,y,i,c,t);n.$1T.$y(f.get_$48(0))}else $1e1(n,t?"SendCalendarItemAction":"SaveCalendarItemAction",null)}function $6Kj(n,t,i){var r=this;t.add_$20(function(t){i||_c.$5Q.$15U(t);$1e1(n,"PersistActionFailed",t)})}function $6Kk(n,t,i,r,u){var f=this;t.add_$2A(function(f){var e;e=i?"SaveDraftCalendarItemAction":r?"MoveCalendarItemAction":u?"SendCalendarItemAction":"SaveCalendarItemAction";$1e1(n,e,t)})}function $1e1(n,t,i){$Bc(n,"Completed",t,i)}function $6Ki(n){n.$f.$r.$36g();n.$f.$r.$a("RequiredAttendees",n.$$d_$7FL);n.$f.$r.$a("OptionalAttendees",n.$$d_$7FL);n.$f.$r.$a("Resources",n.$$d_$7FL);n.$f.$r.$a("IsCancelled",n.$$d_$7FN);n.$f.$r.$33z(n.$$d_$7FM);n.$f.$a("IsDraft",n.$$d_$7FO)}function $4M8(n){$4Z(n,"CanSend","CanSave")}_d.$61.prototype={$13M:null,$Ta:null,$79:null,$DS:null,$47O:null,$5yI:null,$5wJ:null,$3Ur:null,$1Hs:null,$f:null,$1T:null,$G:null,$6M:null,$8T:null,$DX:null,add_$2m:function(n){this.$2Z("Completed",n)},remove_$2m:function(n){this.$2b("Completed",n)},get_$1PR:function(){return!this.$G.get_$DC()&&this.$f.$6S.get_$1PR()&&!this.$f.$6S.get_$RF()},get_$U8:function(){return this.get_$vr()&&(this.$f.$6S.get_$RF()||this.$f.$6S.get_$U8())},get_$hN:function(){return this.$f.$6S.get_$hN()&&this.$f.$6S.get_$Hm()},get_$258:function(){return!this.$f.get_$1Bh()&&!this.$f.$r.get_$RF()&&this.$f.$r.get_$Ho()},get_$hO:function(){return this.$f.get_$1Bh()&&this.$f.$r.get_$Ho()},get_$6wn:function(){return this.$f.$r.get_$Ho()},get_$6wU:function(){return this.$f.$Z9},get_$b2:function(){return!this.$G.get_$DC()&&this.$f.$r.get_$b2()},get_$vr:function(){return!this.$G.get_$DC()&&this.$f.$r.get_$vr()},get_$1DP:function(){return(!this.$G.get_$DC()||!_d.$1n.$3Uk&&!this.$f.$r.get_$bm())&&this.$f.$r.get_$1DP()},get_$7gI:function(){return this.$1Hs.$I()},$3Kp:function(){var t=new _g.$Si;t.ItemId=_h.$78.$3Zy(this.$f.$6S);var n=new _c.$eR(t);n.add_$20(_c.$5Q.$15U);var i=this;n.add_$2A(function(t){$1e1(i,"AddCalendarItemToMyCalendarAction",n)});this.$1T.$y(n)},$3Q:function(){var t=this.$f.$6S;t.get_$3ij()&&(t=this.$f.$1QS().$r);var n=new _c.$yF(t,"MoveToDeletedItems",_c.$6D.$2iM(this.$f.$r));n.$47I=2;n.add_$20(_c.$5Q.$15U);var i=this;n.add_$2A(function(t){$1e1(i,"RemoveCalendarItemAction",n)});this.$1T.$y(n)},$AQ:function(){var t=this.get_$7gI();var n=this.$6M.$GU(!0,!1);n.set_$4D(8);n.set_$Mb(!0);if(this.$f.$6S.get_$yC()){this.$f.$r.$Gg&&this.$f.$r.$Gg.$s();n.$165(this.$f.$6S)}else{n.set_$yG(!0);n.set_$Zs(this.$f.$6S.get_$i());n.set_$mY(_g.$39.$mY(this.$f.$6S))}this.$G.get_$6Q()&&$1e1(this,"CancelCalendarItemAction",null);t.$VM(n)},$Ey:function(){$21b(this,!1,!1,0,!1)},$8um:function(){$21b(this,!1,!1,0,!0)},$8x0:function(){$21b(this,!0,!1,3,!1)},$5yH:function(){$21b(this,!0,!1,4,!1)},$8ub:function(){$21b(this,!1,!0,0,!1)},$5x:function(){this.$f.get_$1Bh()?this.$5yH():this.$Ey()},$7Lo:function(){return new _h.$KX([this.$f.$r],this.$f.$r.get_$22(),0)},$7FL:function(n,t){this.$f.$r.$33z(this.$$d_$7FM);$4M8(this)},$7FM:function(n,t){$4M8(this)},$7FN:function(n,t){$6(this,"CanSave")},$7FO:function(n,t){$6(this,"CanDiscardDraft")}};_d.$jl=function(n,t,i,r,u){this.$1T=n;this.$G=t;this.$8T=u;this.$6M=i;this.$1Hs=r};_d.$jl.prototype={$1Hs:null,$1T:null,$G:null,$6M:null,$8T:null,get_$3Nm:function(){return this.$8T},get_$2Fo:function(){return this.$1Hs.get_$1d()},$I:function(n){return new _d.$61(n,this.$1T,this.$G,this.$6M,this.get_$2Fo(),this.get_$3Nm())}};_d.$BV=function(n,t,i,r){_d.$BV.initializeBase(this);this.$G=n;this.$l=r;this.$Db=i;this.$La=t};function $6KZ(n){if(n.$2LB){_a.$5.$1G(n.$2LB);n.$2LB=null}_a.$5.endPT("OpenCalendarItemOnReadingPane")}function $6KY(n){if(n.$2LA){_a.$5.$1G(n.$2LA);n.$2LA=null}_a.$5.endPT("OpenCalendarItemOnComposeForm")}function $6KX(n,t,i,r){$4M2(n,n.$La,t);_a.$5.stPT(_a.$0.$Ag,"OpenCalendarItemOnReadingPane",3);n.$2LB=t?_a.$5.$1V(_a.$0.$Ag,"OpenCalendarSeriesItemOnReadingPane",!0):_a.$5.$1V(_a.$0.$Ag,"OpenCalendarItemOnReadingPane",!0);var u=$4M3(n,t);var f=$4M1(n);var s=this;var e=function(t){r&&r(t);$6KZ(n)};var o=n.$La.$ct(u.$3l,e);n.$G.$hu(o,f,!1);i&&i()}function $4M1(n){if(n.$G.get_$6Q()){var t=n.$G.$bW();return _d.$3P.isInstanceOfType(t.get_$7L())||_d.$10.isInstanceOfType(t.get_$7L())?1:0}else return 1}function $6KW(n,t,i,r){$4M2(n,n.$Db,t);_a.$5.stPT(_a.$0.$Ag,"OpenCalendarItemOnComposeForm",3);n.$2LA=t?_a.$5.$1V(_a.$0.$Ag,"OpenCalendarSeriesItemOnComposeForm",!0):_a.$5.$1V(_a.$0.$Ag,"OpenCalendarItemOnComposeForm",!0);var u=$4M3(n,t);var f=$4M1(n);var e=_a.$5.acss(_a.$0.$Ag,"Setting ComposeCalendarItemVM");var h=this;var o=function(t){r&&r(t);$6KY(n)};var s=n.$Db.$ct(u.$3l,o);_a.$5.aces(e);n.$G.$hu(s,f,!1);i&&i()}function $4M3(n,t){var i=new _y.$Ao;t?i.$8za(new _h.$78(n.$l.$r.get_$i())):i.$cz(n.$l.$r.get_$i());return i}function $4M2(n,t,i){}_d.$BV.prototype={$La:null,$Db:null,$G:null,$l:null,$2LB:null,$2LA:null,get_$2a2:function(){return this.get_$4jl()||this.get_$4jm()},get_$4jl:function(){return this.$l.$4x.get_$b2()},get_$6wd:function(){return this.$l.$4x.get_$b2()&&this.get_$4jn()},get_$4jm:function(){return this.$l.$4x.get_$1DP()},get_$6we:function(){return this.$l.$4x.get_$1DP()&&this.get_$4jn()},get_$4jn:function(){return this.$l.$r.get_$Ef()},$hi:function(n,t,i,r){var e=null;var u=null;var f=null;switch(n){case 1:var o=this;e=function(){$6KX(o,t,i,r)};u="CanOpenItemInRead";var s=this;f=function(){return s.get_$4jm()};if(t){u="CanOpenSeriesInRead";var h=this;f=function(){return h.get_$6we()}}break;case 0:var c=this;e=function(){$6KW(c,t,i,r)};u="CanOpenItemInCompose";var l=this;f=function(){return l.get_$4jl()};if(t){u="CanOpenSeriesInCompose";var a=this;f=function(){return a.get_$6wd()}}break}return new _C(e,_d.$BV.$D,this,u,f)}};_d.$jk=function(n,t,i){this.$Db=n;this.$La=t;this.$G=i};_d.$jk.prototype={$G:null,$Db:null,$La:null,$8M:function(n){return new _d.$BV(this.$G,this.$La,this.$Db,n)}};_d.$Jr=function(){this.$$d_$3cX=Function.createDelegate(this,this.$3cX);this.$$d_$78n=Function.createDelegate(this,this.$78n);this.$$d_$78m=Function.createDelegate(this,this.$78m);this.$$d_$78u=Function.createDelegate(this,this.$78u);_d.$Jr.initializeBase(this);var n=this;this.$3UE=new _C(this.$$d_$78u,this.get_$1Y(),this,"CanDeleteItemOrSeries",function(){return n.get_$6wT()})};_d.$Jr.$eA=function(n){var t=n.$4x;var i=n.$Od;t.$Ta.$2K?t.$Ta.$s():t.$79.$2K?t.$79.$s():i.$lZ.$2K&&i.$lZ.$s()};function $6Kl(n){if(!n.$1R6){var t=new _js.$X;t.$H(new _a.$2E(new _C(n.$$d_$78m,n.get_$1Y()),_u.Strings.l_Occurrence_LowerCase_Text));t.$H(new _a.$2E(new _C(n.$$d_$78n,n.get_$1Y()),_u.Strings.l_Series_LowerCase_Text));t.$H(new _a.$2E(new _C(n.$$d_$3cX,n.get_$1Y()),_u.Strings.l_ConfirmDialog_Back_Text));n.set_$799(t)}}function $6Km(n){n.set_$2Cw(!0)}_d.$Jr.prototype={$3UE:null,$1n2:!1,$1R6:null,$3H:null,get_$sU:function(){return this.$3H},set_$sU:function(n){this.$3H=n;$4Z(this,"ItemViewModel","CanDeleteItemOrSeries");return n},get_$6wT:function(){return!$8(this.$3H)&&!this.$3H.get_$1Gu()&&(this.$3H.$4x.get_$U8()||this.$3H.$4x.get_$hN()||this.$3H.$Od.get_$vq())},get_$2Cw:function(){return this.$1n2},set_$2Cw:function(n){if(this.$1n2!==n){this.$1n2=n;$6(this,"IsDeleteRecurringEventDialogShown")}return n},get_$799:function(){return this.$1R6},set_$799:function(n){if(n!==this.$1R6){this.$1R6=n;$6(this,"DeleteRecurringEventDialogButtonData")}return n},get_$1Y:function(){return _a.$0.$1o},$78u:function(){if(this.$3H){var n=this.$3H.$r;if(n.get_$Ef()){$6Kl(this);$6Km(this)}else _d.$Jr.$eA(this.$3H)}},$78m:function(){this.$3cX();_d.$Jr.$eA(this.$3H)},$78n:function(){this.$3cX();var n=this.$3H.$1QS();_d.$Jr.$eA(n)},$3cX:function(){this.set_$2Cw(!1)}};_d.$1Dx=function(){_d.$1Dx.initializeBase(this)};_d.$8W=function(){};_d.$8W.$I=function(n,t,i,r){var f=_a.$5.$1V(n,t,!0);_a.$5.acsa(n,t);var u=null;if(f){u=new _d.$8W;u.$4pd=f;u.$6Bw=i;u.$11I=t;u.$1n=n;u.$3WL=r}return u};function $3Eh(n,t,i){_a.$5.acea(null,n.$11I);n.$6Bw&&_a.$5.$1G(n.$4pd,null,t,i);_a.$5.endPT(null)}_d.$8W.prototype={$4pd:null,$11I:null,$6Bw:!1,$3WL:!1,$4vq:1,$1n:null,$7hE:function(){--this.$4vq>0||$3Eh(this)},$7GV:function(n,t){$3Eh(this,n,t)},$3WM:function(){this.$3WL?_js.Trace.logWarning(this.$1n,"EndTrace was called for an animation based scenario."):$3Eh(this)}};_d.$Jw=function(n,t){_d.$Jw.initializeBase(this,[n]);_a.$3.$17(t,"date");this.$6y=t;var i=_d.$Jw.$50e(t,n);this.$2G=i.$2G;this.$2w=i.$2w};_d.$Jw.$50e=function(n,t){var i;var r;i=n.$2Y(t.get_$10())>0?n:t.get_$10();var u=n.$2q(1);r=u.$2Y(t.get_$23())<0?u:t.get_$23();return new _h.$4S(i,r)};_d.$Jw.prototype={$6y:null,$2G:null,$2w:null,get_$10:function(){return this.$2G},get_$23:function(){return this.$2w}};_d.$1Dp=function(n){this.$$d_$3O4=Function.createDelegate(this,this.$3O4);_d.$1Dp.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$1Dp.initializeBase(this);_a.$3.$17(n,"calendarItemModel");this.$2Q=n;this.$2Q.add_$8C(this.$$d_$3O4)};_d.$1Dp.prototype={$2Q:null,get_$i:function(){return this.$2Q.get_$i()},get_$10:function(){return this.$2Q.get_$10()},get_$23:function(){return this.$2Q.get_$23()},get_$2h:function(){return this.$2Q.get_$2h()},get_$5m:function(){return this.$2Q.get_$5m()},get_$92:function(){return this.$2Q.get_$92()},get_$5Z:function(){return this.$2Q.get_$5Z()},get_$iZ:function(){return this.$2Q.get_$iZ()},get_$2LL:function(){return this.$2Q.get_$2LL()},get_$Ef:function(){return this.$2Q.get_$Ef()},get_$2Dl:function(){return this.$2Q.get_$2Dl()},get_$2mG:function(){return this.$2Q.get_$2mG()},get_$FL:function(){return this.$2Q.get_$FL()},get_$bm:function(){return this.$2Q.get_$bm()},get_$4h:function(){return this.$2Q.get_$4h()},get_$9w:function(){return this.$2Q.get_$9w()},get_$1UI:function(){return this.$2Q.get_$1UI()},get_$EB:function(){return this.$2Q.get_$EB()},get_$3jM:function(){return this.$2Q.get_$3jM()},get_$Ho:function(){return this.$2Q.get_$Ho()},get_$b2:function(){return this.$2Q.get_$b2()},$59:function(){this.$2Q.remove_$8C(this.$$d_$3O4);_a.$1.prototype.$59.call(this)},$3O4:function(n,t){$6(this,t)}};_d.$X8=function(n,t,i,r,u,f,e){this.$1M2=n;this.$S=i;this.$G=r;this.$2f=u;this.$6w=t;this.$p=f;this.$9X=e};_d.$X8.prototype={$1M2:null,$S:null,$G:null,$2f:null,$6w:null,$p:null,$9X:null,$I:function(n){return this.$9X.get_$1o()?new _d.$DZ(n,this.$6w,this.$1M2,this.$S,this.$G,this.$2f,this.$p):null}};_d.$DZ=function(n,t,i,r,u,f,e){this.$$d_$8P8=Function.createDelegate(this,this.$8P8);this.$$d_$8RG=Function.createDelegate(this,this.$8RG);this.$$d_$1OD=Function.createDelegate(this,this.$1OD);this.$$d_$911=Function.createDelegate(this,this.$911);_d.$DZ.initializeBase(this);this.$13p=n;this.$1M2=i;this.$S=r;this.$G=u;this.$60S=new _C(this.$$d_$911,_d.$DZ.$D);this.$4ih=new _C(this.$$d_$1OD,_d.$DZ.$D);this.$2f=f;this.$6w=t;this.$2CP=!1;this.$p=e;$6LN(this)};function $6LN(n){n.set_$61C(!1);n.set_$62U(!1);var t=$6LO(n);if(t&&!_g.$g.$1i.doesIdEqualName(t,"sentitems")){var i=this;n.$2f.$1FT(function(){n.set_$62U(n.$G.get_$O()==="Mouse")});n.set_$61C(!0)}}function $6LO(n){var t;if(n.$13p.get_$22()&&_g.$g.$1i.idToName(n.$13p.get_$22())===_g.$AM.$VO){var i=_h.$8A.$7Ou(n.$13p.get_$22());if(i)t=i.get_$n();else{_js.Trace.logError(_d.$DZ.$D,"Not able to found the WellKnownFolder for the Share message");t=null}}else t=n.$13p.get_$22();return t}function $6LL(n){var t=this;_js.$K.get_$L().$3i(_a.$0.$5i,"PopOutClose",function(){window.self.close()})}function $6LM(n){var t=new(_0365f.$s.$$(String));if(n.$13p.get_$85()){var i=this;n.$13p.get_$85().$Bx(function(n){var i=n;i.get_$BL()==="application/x-sharing-metadata-xml"&&t.$H(i.get_$40().Id)})}return t.$7V()}function $6LP(n,t){for(var u=n.$2f.get_$px(),i=0;i<u.get_$F();++i)for(var f=u.get_$48(i),r=0;r<f.get_$Bd().get_$F();r++){var e=f.get_$Bd().get_$48(r);if(e.get_$i().Id===t.Id){n.$6w.$36X(e,!0);return}}}_d.$DZ.prototype={$13p:null,$6w:null,$60S:null,$G:null,$S:null,$1M2:null,$2f:null,$p:null,$4ih:null,$37N:!1,$38A:!1,$2CP:!1,$di:null,get_$4gu:function(){this.$di||(this.$di=$6LM(this));return this.$di},get_$61C:function(){return this.$37N},set_$61C:function(n){if(this.$37N!==n){this.$37N=n;$6(this,"ShowAddButton")}return n},get_$62U:function(){return this.$38A},set_$62U:function(n){if(this.$38A!==n){this.$38A=n;$6(this,"ShowShareBackButton")}return n},$f7:function(){},$911:function(){var n=this;this.$1M2.$I(function(t){t.$3zM(n.$2f.get_$wV().get_$AC(),n.$13p.get_$9o().Mailbox,!0)})},$1OD:function(){if(!this.$2CP){this.$2CP=!0;var n=new _c.$vq(this.$13p.get_$i());n.add_$20(this.$$d_$8RG);this.$G.get_$6Q()&&n.add_$2A(this.$$d_$8P8);this.$p.$y(n);this.$G.get_$6Q()||$6LL(this)}},$8RG:function(n){this.$2CP=!1;_c.$5Q.$15U(n)},$8P8:function(n){var i=n;this.$S.$8oV(_y.$FS,new _y.$FS(1,null));var t=this;this.$2f.$BA(function(){t.$2CP=!1;$6LP(t,i.$5eK)})}};_d.$oO=function(n,t,i){this.$Ys=n;this.$p=t;this.$2f=i};_d.$oO.prototype={$Ys:null,$p:null,$2f:null,$I:function(n,t){var i=this.$Ys.$I(_c.$14.$15a,_c.$14.$bV(),!1,"PersonaDetailedView");return new _d.$6b(n,t,i,this.$p,this.$2f)}};_d.$6b=function(n,t,i,r,u){this.$$d_$8Sy=Function.createDelegate(this,this.$8Sy);this.$$d_$97K=Function.createDelegate(this,this.$97K);this.$$d_$97L=Function.createDelegate(this,this.$97L);this.$$d_$8qo=Function.createDelegate(this,this.$8qo);this.$$d_$7Bo=Function.createDelegate(this,this.$7Bo);this.$$d_$8Yi=Function.createDelegate(this,this.$8Yi);this.$$d_$8dZ=Function.createDelegate(this,this.$8dZ);this.$$d_$142=Function.createDelegate(this,this.$142);this.$$d_$5lY=Function.createDelegate(this,this.$5lY);_d.$6b.initializeBase(this);this.$BN=n;this.$p=r;this.$6w=t;this.$2f=u;this.set_$Cu(this);this.set_$16U(!0);this.set_$1mi(!1);this.set_$3fV(!1);var f=this;this.$30g=new _C(this.$$d_$5lY,_d.$6b.$D,this,"CanOpenCalendar",function(){return f.get_$6wb()});this.$6g.$H(new _a.$2E(this.$30g,_u.Strings.l_OpenCalendarButton_Text));var e=this;this.$6g.$H(new _a.$2E(new _C(this.$$d_$142,_d.$6b.$D,this,"IsActionPending",function(){return!e.$Hl}),_u.Strings.l_CancelButtonText_Text));this.$N3=new _y.$4p;this.$36=i;this.$36.$a("QueryString",this.$$d_$8dZ);$6Sc(this)};function $6Sc(n){n.$36.set_$oy(!0);_d.$CO.$1QB(n.$36);n.$36.$vd();n.$36.add_$jv(n.$$d_$8Yi);n.set_$58L(!1)}function $6SY(n,t){t.set_$l9(!0);t.set_$1hZ($6SZ(n))}function $6SZ(n){return[new _0365m.$n(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(n.$$d_$7Bo,_d.$6b.$D)),new _0365m.$n(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(n.$$d_$8qo,_d.$6b.$D))]}function $6Sf(n){$4Pk(n,1)}function $6Se(n){$4Pk(n,0)}function $4Pk(n,t){n.$4BN=t;if(!$8(n.$aO)){n.$aO.remove_$2A(n.$$d_$97L);n.$aO.remove_$20(n.$$d_$97K);n.$aO=null}switch(n.$4BN){case 0:var i=n.$1GK.get_$1v().get_$18()===5;n.$aO=new _c.$17G(n.$BN,n.$1GK.get_$1v().get_$1h().EmailAddress,i);break;case 1:n.$aO=new _c.$17H(n.$BN,n.$1mc);break}n.$aO.add_$2A(n.$$d_$97L);n.$aO.add_$20(n.$$d_$97K);n.set_$1mi(!0);n.$p.$y(n.$aO)}function $6Sa(n){var t=null;switch(n.$4BN){case 0:t=n.$aO.$VN;break;case 1:t=n.$aO.$VN;break}return t}function $6Sb(n){if(!$8(n.$aO)){n.$aO.remove_$2A(n.$$d_$97L);n.$aO.remove_$20(n.$$d_$97K)}n.$36.set_$D5(null);n.set_$3el(null);n.set_$58Q(null)}function $3Fz(n){n.$36.set_$7ci(!n.$1mc);n.set_$7Wy(!n.$36.$2k&&!n.$1GK)}function $6SX(n){for(var t=0;t<n.$6g.get_$F();t++)n.$6g.get_$48(t).$Jv.set_$5P(!n.$Hl)}function $4Pj(n){n.set_$3el(null);n.$36.set_$D5("");n.$36.set_$HE(!0)}function $6Sd(n,t,i){n.$N3.$3A(0,i,null,!1,null,null,t)}_d.$6b.prototype={$N3:null,$BN:null,$2f:null,$6w:null,$p:null,$30g:null,$36:null,$1mZ:!1,$2lE:!1,$Hl:!1,$2le:!1,$2lD:!0,$4BN:0,$aO:null,$1GK:null,$1mc:null,get_$3el:function(){return this.$1GK},set_$3el:function(n){if(this.$1GK!==n){this.$1GK=n;this.set_$58L(!$8(n));$6(this,"InternalSubscriptionSource")}return n},get_$58Q:function(){return this.$1mc},set_$58Q:function(n){if(this.$1mc!==n){this.$1mc=n;this.set_$7Wz(!_js.$8.$c(n)&&!_js.$8.$14(n));$6(this,"InternetSubscriptionSource");$3Fz(this)}return n},get_$7Wy:function(){return this.$2lD},set_$7Wy:function(n){if(n!==this.$2lD){this.$2lD=n;$6(this,"InternetSubscriptionSourceEnabled")}return n},get_$58L:function(){return this.$1mZ},set_$58L:function(n){if(this.$1mZ!==n){this.$1mZ=n;$4Z(this,"InternalSubscriptionSourceIsResolved","CanOpenCalendar")}return n},get_$7Wz:function(){return this.$2lE},set_$7Wz:function(n){if(this.$2lE!==n){this.$2lE=n;$4Z(this,"InternetSubscriptionSourceIsResolved","CanOpenCalendar")}return n},get_$6wb:function(){return!this.$Hl&&(this.$1mZ||this.$2lE)},get_$1mi:function(){return this.$Hl},set_$1mi:function(n){if(this.$Hl!==n){this.$Hl=n;$4Z(this,"IsActionPending","CanOpenCalendar");$6SX(this)}return n},get_$3fV:function(){return this.$2le},set_$3fV:function(n){if(this.$2le!==n){this.$2le=n;$6(this,"IsCacheReloadPending")}return n},$59:function(){this.$36.$1M();this.$N3.$1M();this.$aO=null;_a.$1.prototype.$59.call(this)},$8Yi:function(n,t){var i=n.get_$Vm();if(i){$6SY(this,i);this.set_$3el(i)}},$142:function(){$6Sb(this);this.$4a.$s()},$5lY:function(){this.$1mZ?$6Se(this):$6Sf(this)},$97K:function(n){this.set_$1mi(!1);$6Sd(this,_u.Strings.l_CalendarActionErrorDialogTitle_Text,n.get_$bO())},$97L:function(n){this.set_$3fV(!0);this.$2f.$BA(this.$$d_$8Sy);this.set_$1mi(!1);this.$142()},$8Sy:function(){var n=$6Sa(this);if(n){this.$6w.$36X(n,!0);this.$aO=null}this.set_$3fV(!1)},$7Bo:function(){var n=this.$1GK.get_$1v().get_$1l();$4Pj(this);this.$36.set_$D5(n)},$8dZ:function(n,t){$3Fz(this)},$8qo:function(){$4Pj(this);$3Fz(this)}};_d.$q6=function(n){_d.$q6.initializeBase(this);if(n){this.$54X=n.get_$54Y();this.$54l=n.get_$54m();this.$54L=n.get_$54M();this.$4c=n.get_$7Cl();this.$2G=n.get_$10();this.$2w=n.get_$23();this.$AH=n.$AH}};_d.$q6.prototype={$54X:!1,$54l:!1,$54L:!1,$4c:null,$2G:null,$2w:null,$AH:null,get_$10:function(){return this.$2G},get_$23:function(){return this.$2w},get_$Jh:function(){return this.$AH},get_$ZC:function(){return!$8(this.$AH)}};_d.$O9=function(){};_d.$O9.$3S8=function(n){var t=new _js.$X;t.$H(_d.$6N.$1Jf);t.$H(0);t.$H(5);t.$H(10);t.$H(15);t.$H(30);t.$H(60);t.$H(120);t.$H(180);t.$H(240);t.$H(480);t.$H(720);t.$H(1440);t.$H(2880);t.$H(4320);t.$H(10080);t.$H(20160);if(n.get_$cs()>t.get_$48(t.get_$F()-1))t.$H(n.get_$cs());else for(var i=0;i<t.get_$F();i++){if(n.get_$cs()===t.get_$48(i))break;if(n.get_$cs()<t.get_$48(i)){t.$6z(i,n.get_$cs());break}}return t};_d.$O9.$4oU=function(){var n=new _js.$X;n.$H("Free");n.$H("WorkingElsewhere");n.$H("Tentative");n.$H("Busy");n.$H("OOF");return n};_d.$Bt=function(n){this.$$d_$9E1=Function.createDelegate(this,this.$9E1);this.$z=n;this.$7fK()};function $3Ec(n,t,i){if(_d.$6N.$1nU(t)){var r=0;var u=1;var f=new Array(2);f[r]=4600;f[u]=6200;var e=new Array(2);e[r]=1100;e[u]=2200;var o=i?f:e;t.get_$ZC()?n.$z.$2r(o[u]):n.$z.$2r(o[r])}}function $4Lv(n,t,i){t.get_$Ho()&&i&&!t.get_$Cz()&&n.$z.$2r(1400)}function $4Lu(n,t){if(t.get_$RF()){var i=_u.Strings.l_None_Text;var r=_u.Strings.l_None_Text;if(t.get_$B4()){r=t.get_$B4().$2P(5);i=t.get_$B4().$2P(0)}n.$z.$2r(1200,r,i)}}function $4Ls(n,t){t.get_$Ho()||t.get_$RF()||_d.$6N.$1nU(t)||(t.get_$QP()==="NoResponseReceived"||t.get_$QP()==="Unknown")&&(t.get_$Cz()||n.$z.$2r(1300))}function $4Lt(n,t,i){if(!t.get_$Ho()&&t.get_$2Y8()){var r=_js.$8.$14(t.get_$2Y7())||i.get_$Gz()===t.get_$2Y7();var u=t.get_$2Y8().$2P(5);var f=t.get_$2Y8().$2P(0);var e=null;e=r?[u,f]:[t.get_$2Y7(),u,f];var o=$6KC(n,t.get_$QP(),r);if(o!==-1){var s;(s=n.$z).$2r.apply(s,[o].concat(e))}}}function $6KC(n,t,i){var r=-1;switch(t){case"Accept":r=i?1600:1700;break;case"Tentative":r=i?1800:1900;break;case"Decline":r=i?2e3:2100;break;default:break}return r}_d.$Bt.prototype={$z:null,$QH:null,$9E1:function(n,t){this.$12a()},$12a:function(){this.$z.$Ff(this.$QH);this.$7HF()}};_d.$h8=function(n,t){this.$$d_$7FI=Function.createDelegate(this,this.$7FI);this.$$d_$8TA=Function.createDelegate(this,this.$8TA);this.$$d_$8TB=Function.createDelegate(this,this.$8TB);_d.$h8.initializeBase(this);this.$2f=t;this.$gs=n;this.$2f.add_$2ZS(this.$$d_$8TB);this.$2f.add_$4uM(this.$$d_$8TA)};_d.$h8.prototype={$2f:null,$gs:null,add_$51D:function(n){this.$2Z("GetOnlineMeetingInformationCompleted",n)},remove_$51D:function(n){this.$2b("GetOnlineMeetingInformationCompleted",n)},get_$2DV:function(){return this.$gs.get_$2DV()},$7Xw:function(n){return!!n&&!n.get_$10N()&&(_g.$Di.isInstanceOfType(n.get_$5Z())&&this.$gs.get_$2DV()||_g.$9b.isInstanceOfType(n.get_$5Z())&&this.$gs.$2mB(n.get_$5Z().get_$2LU()))},$7OC:function(n){return!n||!n.get_$5Z()?null:_g.$9b.isInstanceOfType(n.get_$5Z())?n.get_$5Z().get_$2LU():this.$gs.get_$2FW()},$1l3:function(n){this.$gs.$1l3(n,this.$$d_$7FI)},$59:function(){this.$2f.remove_$4uM(this.$$d_$8TA);this.$2f.remove_$2ZS(this.$$d_$8TB);_js.$9.prototype.$59.call(this)},$7FI:function(n,t){$SM(this,"GetOnlineMeetingInformationCompleted",this,n)},$8TA:function(n,t){var i=this.$2f.$xS(t.get_$AC());i.$2Zw(t)&&!t.get_$1nz()&&this.$gs.$1l3(t.get_$2LU(),this.$$d_$7FI)},$8TB:function(n){this.$gs.$3v(this.$$d_$7FI)}};_d.$18R=function(n){_d.$18R.initializeBase(this);this.$SD=n};_d.$18R.prototype={$SD:null,get_$10:function(){return this.$SD.get_$10()},set_$10:function(n){if(!this.get_$10()||!this.get_$10().$4W(n)){var t=this.get_$DE();this.$SD.set_$10(n.$46());this.$SD.set_$23(n.$9b(t));$9G(this,"Start","End")}return n},get_$23:function(){return this.$SD.get_$23()},set_$23:function(n){if(!this.get_$23()||!this.get_$23().$4W(n)){n.$2Y(this.get_$10())<0?this.$SD.set_$23(this.get_$10().$46()):this.$SD.set_$23(n.$46());$Q(this,"End")}return n},get_$5m:function(){return this.$SD.get_$5m()},set_$5m:function(n){if(this.get_$5m()===n)return n;this.$SD.set_$5m(n);$Q(this,"IsAllDayEvent");return n},get_$DE:function(){return this.get_$23().$6E(this.get_$10())},set_$DE:function(n){if(n!==this.get_$DE()){var t=n-this.get_$DE();this.set_$23(this.get_$23().$9b(t))}return n}};_d.$Hy=function(n){_d.$Hy.initializeBase(this);this.$o=this.$74k();this.$To=new Array(7);for(var t=0;t<7;t++)this.$To[t]=0;this.set_$10(n)};_d.$Hy.$w6=function(n,t){var r=n;var u=t;var i=(r.get_$9w()?0:1)-(u.get_$9w()?0:1);i||(i=r.get_$10().$6E(u.get_$10()));i||(i=_d.$Hy.$5Ea(u)-_d.$Hy.$5Ea(r));i||(i=r.get_$2h()?u.get_$2h()?r.get_$2h().localeCompare(u.get_$2h()):1:-1);return i};_d.$Hy.$5Ea=function(n){return Math.floor(n.get_$23().$6E(n.get_$10())/6e4)};_d.$Hy.prototype={$o:null,$To:null,$1uF:0,$5f:null,$Pb:null,$4Ge:null,$21F:null,get_$10:function(){return this.$5f},set_$10:function(n){if(!this.$5f&&n||this.$5f&&n&&!this.$5f.$4W(n)){this.$5f=n;this.$Pb=this.$5f.$2q(7);for(var t=this.$o.get_$F()-1;t>=0;--t)this.$2DS(this.$o.get_$48(t))||this.$o.$67(t);this.$4Ge=_a.$25.$Km(this.$5f,1,!0);this.$21F=new _h.$4S(this.$5f,this.$Pb);Array.removeAt(this.$4Ge,this.$4Ge.length-1);$4Z(this,"Start","WeekDateRange")}return n},get_$3ww:function(){return this.$1uF},set_$3ww:function(n){this.$1uF=n;return n},get_$66u:function(){return this.$To},set_$66u:function(n){this.$To=n;$Ha(this,_d.$Hy.$66v);return n},get_$9AV:function(){return this.$To[0]},get_$9AW:function(){return this.$To[1]},get_$9AX:function(){return this.$To[2]},get_$9AY:function(){return this.$To[3]},get_$9AZ:function(){return this.$To[4]},get_$9Aa:function(){return this.$To[5]},get_$9Ab:function(){return this.$To[6]},$2DS:function(n){var t=new _h.$4S(this.$5f,this.$Pb);return t.$1Gz(n)},$74k:function(){return new _a.$V9(_d.$Hy.$w6)}};_d.$1Dy=function(n,t,i,r,u,f){_d.$1Dy.initializeBase(this,[n,t,r,i,u,f])};_d.$1Dy.prototype={$3TX:null,$2KF:null,get_$1iJ:function(){return null},get_$1DO:function(){return 5},get_$4qt:function(){this.$3TX||(this.$3TX=new _d.$Ps(this.get_$1iJ()));return this.$3TX},get_$2yZ:function(){return this.$2KF},set_$2yZ:function(n){if(this.$2KF!==n){this.$2KF=n;$6(this,"NoItemsMessage")}return n},$539:function(){},$53A:function(){}};_d.$1E6=function(n,t,i,r,u,f){this.$$d_$8Z6=Function.createDelegate(this,this.$8Z6);_d.$1E6.initializeBase(this,[n,t,i,r,u,f]);this.$o=new _a.$V9(_d.$9p.$6yy);this.$o.add_$1Z(this.$$d_$8Z6)};_d.$1E6.prototype={$o:null,$50g:function(){return this.$o.get_$F()},$7L8:function(){return this.$o.get_$F()},$3KT:function(n){for(var r=n.length,f=_a.$5.acss(_a.$0.$Ag,"AgendaDefaultVM_AddItems_"+r),e=this.$o.$63t(),u,t,i=0;i<r;i++){t=n[i];if(this.$1bX(t)){u=$1e0(this,t,this.$HA);e.$6G(u)}}this.$o.$4uf();_a.$5.aces(f)},$H0:function(n){var t=$1e0(this,n,this.$HA);this.$o.$6G(t)},$BB:function(n){this.$o.$3Q(n)},$76C:function(n,t){return new _d.$I1(n,t,this.$QA)},$1wp:function(){_d.$1n.prototype.$1wp.call(this);this.$o.$1u()},$8Z6:function(n,t){this.set_$2yZ(this.$o.get_$F()?null:_u.Strings.l_Calendar_NoAgendaItems_Text)}};_d.$j9=function(n,t,i,r,u){_d.$j9.initializeBase(this,[n,!1,t,i,r,u])};_d.$j9.prototype={$1au:null,get_$1Q:function(){return"AgendaViewModel"},get_$14d:function(){return 0},get_$2WR:function(){return String.format(_u.Strings.l_CalendarAgendaView_AT_Region_Text,this.get_$433())},get_$3cI:function(){return this.get_$8G().$2P(3).toLocaleUpperCase()},get_$9Gu:function(){return this.get_$8G().$2P(21)},get_$8vj:function(){return this.$1au},set_$8vj:function(n){if(this.$1au!==n){this.$1au=n;$6(this,"SelectedAgendaItem");this.get_$y8()||this.$1c.set_$qu(n)}return n},$5sD:function(){var n=this.$1c.$8T.$3Z8(this.$E8);this.$1wp();this.$3KT(n)},$6yI:function(){if(this.$1au){this.$1au=null;$6(this,"SelectedAgendaItem")}},get_$8G:function(){return _d.$1n.prototype.get_$8G.call(this)},set_$8G:function(n){_d.$1n.prototype.set_$8G.call(this,n);$4Z(this,"HeaderText","WatermarkText");return n},$5sE:function(){_d.$1n.prototype.$5sE.call(this);this.$5sD()},$25L:function(){return!1}};_d.$I1=function(n,t,i){_d.$I1.initializeBase(this,[n,t]);this.$QA=i};_d.$I1.prototype={$QA:null,get_$10:function(){return this.get_$5DD()?this.$6y:this.$2Q.get_$10()},get_$23:function(){return this.$2Q.get_$23()},get_$DE:function(){var i=this.$2Q.get_$5m();var t=this.$2Q.get_$10();var n=this.$2Q.get_$23();if(t.$2Y(n)>0)throw Error.argumentOutOfRange("Cannot retrieve duration string. The start DateTime cannot be later than the end DateTime");i&&n.$9b(1).$4W(n.$2q(1).$3u())&&(n=n.$9b(1));var r=Math.floor((n.$55()-t.$55())/1e3);return _a.$7.$2hh(r)},get_$66K:function(){return this.get_$5DD()?this.$6y.$2P(18):this.get_$9w()?"":this.$2Q.get_$10().$2P(18)},get_$7cY:function(){return this.$2Q.get_$23().$9b(-1).$2Y(this.$6y)>=0&&!this.$2Q.get_$10().$8c(this.$6y)},get_$5DD:function(){return!this.$2Q.get_$9w()&&this.$2Q.get_$10().$2Y(this.$6y)<0&&this.$2Q.get_$23().$3u().$4W(this.$6y)},get_$7Ys:function(){return this.$2Q.get_$10().$2Y(this.$6y)<=0&&!this.$2Q.get_$23().$9b(-1).$8c(this.$6y)},get_$7SX:function(){return!this.get_$iZ()},$7KX:function(){return this.$6y.$7Le().toString()},$3O4:function(n,t){_d.$1Dp.prototype.$3O4.call(this,n,t);var r=t==="Start";if(r){var i=this.get_$10().$3u();this.$2Q.get_$1N5()&&(i=i.$2q(this.$2Q.get_$1N5()));this.$6y=i}r||t==="End"?$Ha(this,_d.$I1.$4qq):t==="CalendarItemType"?$6(this,"IsOccurrenceOrException"):t==="Sensitivity"?$6(this,"IsPrivate"):t==="Categories"&&$6(this,"HasNoCategories")}};_d.$Ps=function(n){this.$Hd={};this.$bH=n};function $4LG(n,t){return n.$bH?n.$bH.$4EJ(t):t}function $6JI(n,t){var i=t.$7KX();if(i in n.$Hd)return n.$Hd[i];else{var u=t.$6y.$2P(3).toUpperCase();var r=new _d.$Vn(u,i);n.$Hd[i]=r;return r}}_d.$Ps.prototype={$Hd:null,$bH:null,get_$3iP:function(){return!1},$AU:function(){return!0},$4z7:function(n,t){var i=$4LG(this,n);var r=$4LG(this,t);var u=!r||!!i.$6y.$8c(r.$6y);return new _0365m.$Zx($6JI(this,i),u)}};_d.$1n=function(n,t,i,r,u,f){this.$$d_$8az=Function.createDelegate(this,this.$8az);this.$$d_$7A5=Function.createDelegate(this,this.$7A5);this.$$d_$6pL=Function.createDelegate(this,this.$6pL);this.$$d_$8iO=Function.createDelegate(this,this.$8iO);this.$$d_$5gH=Function.createDelegate(this,this.$5gH);this.$$d_$8bJ=Function.createDelegate(this,this.$8bJ);this.$$d_$8xr=Function.createDelegate(this,this.$8xr);this.$$d_$30G=Function.createDelegate(this,this.$30G);this.$$d_$8T9=Function.createDelegate(this,this.$8T9);this.$$d_$5gP=Function.createDelegate(this,this.$5gP);this.$$d_$8ac=Function.createDelegate(this,this.$8ac);this.$$d_$5h0=Function.createDelegate(this,this.$5h0);this.$$d_$8Uc=Function.createDelegate(this,this.$8Uc);this.$$d_$55S=Function.createDelegate(this,this.$55S);this.$$d_$8pI=Function.createDelegate(this,this.$8pI);this.$$d_$72Z=Function.createDelegate(this,this.$72Z);this.$$d_$539=Function.createDelegate(this,this.$539);this.$$d_$53A=Function.createDelegate(this,this.$53A);this.$$d_$3bB=Function.createDelegate(this,this.$3bB);this.$$d_$72Q=Function.createDelegate(this,this.$72Q);this.$$d_$1Lp=Function.createDelegate(this,this.$1Lp);this.$$d_$8i5=Function.createDelegate(this,this.$8i5);this.$$d_$30l=Function.createDelegate(this,this.$30l);this.$$d_$4nv=Function.createDelegate(this,this.$4nv);this.$$d_$gu=Function.createDelegate(this,this.$gu);this.$$d_$74e=Function.createDelegate(this,this.$74e);this.$$d_$74g=Function.createDelegate(this,this.$74g);this.$$d_$74f=Function.createDelegate(this,this.$74f);this.$$d_$74d=Function.createDelegate(this,this.$74d);this.$$d_$8Sz=Function.createDelegate(this,this.$8Sz);this.$$d_$5gL=Function.createDelegate(this,this.$5gL);this.$$d_$8WH=Function.createDelegate(this,this.$8WH);this.$2Jw=new _js.$X;this.$1ge=-1;_d.$1n.initializeBase(this);var o=_a.$5.acss(_a.$0.$1o,"CalendarBaseViewModel:Init");this.$1c=f;this.$Ka=i;this.$Db=r;this.$5nf=u;this.$1HV=this.$1c.$G.get_$O()==="Mouse";this.$2Cr=!0;this.$1Ab=t;this.$2ny=!1;if(this.$1Ab){this.$1c.$8T.add_$4wG(this.$$d_$8WH);this.$1c.$8T.add_$2ZX(this.$$d_$5gL)}this.$1c.$8T.add_$4ik(this.$$d_$8Sz);this.$CJ=!1;var s=this;this.$2br=new _C(this.$$d_$74d,this.get_$1Y(),this,"CanCreateItem",function(){return s.get_$4jW()});var h=this;this.$4ok=new _C(this.$$d_$74f,this.get_$1Y(),this.$1c,"CanCreateItemOnCalendar",function(){return h.$1c.get_$1PU()});var c=this;this.$3Re=new _C(this.$$d_$74g,this.get_$1Y(),this,"CanCreateItem",function(){return c.get_$4jW()});var l=this;this.$2bs=new _C(this.$$d_$74e,this.get_$1Y(),this.$1c,"CanCreateItemOnCalendar",function(){return l.$1c.get_$1PU()});var a=this;this.$4FH=new _C(this.$$d_$gu,this.get_$1Y(),this,"CanUpdateItemDetails",function(){return a.get_$6wu()});var v=this;this.$Ya=new _C(this.$$d_$4nv,this.get_$1Y(),this.$1c,"CanCreateItemOnCalendar",function(){return v.$1c.get_$1PU()});var y=this;this.$QA=new _C(this.$$d_$30l,this.get_$1Y(),this,"CanOpenItem",function(){return y.get_$2a2()});var p=this;this.$1uu=new _C(this.$$d_$8i5,this.get_$1Y(),this,"CanOpenItem",function(){return p.get_$2a2()});var w=this;this.$36D=new _C(this.$$d_$1Lp,this.get_$1Y(),this,"CanSelectItem",function(){return w.get_$6wo()});this.$lD=new _C(this.$$d_$72Q,this.get_$1Y());this.$i8=new _C(this.$$d_$3bB,this.get_$1Y());this.$2Af=new _C(this.$$d_$53A,this.get_$1Y());this.$2Ae=new _C(this.$$d_$539,this.get_$1Y());this.$3R5=new _C(this.$$d_$72Z,this.get_$1Y());this.$3vl=new _C(this.$$d_$8pI,this.get_$1Y());this.$2k0=new _C(this.$$d_$55S,this.get_$1Y());this.$ad=n;this.$3F=n;this.$1tw={};var e=_a.$25.$Km(this.$ad,this.get_$14d(),!1,this.$1c.$t.get_$1t().get_$Tv().get_$dP());this.$HA=this.$3ZQ();this.$E8=new _h.$4S(e[0],e[1]);this.$13m=$6Jh(this);this.$1c.$a("CurrentItem",this.$$d_$8Uc);this.$1c.$a("CurrentItemModel",this.$$d_$5h0);this.$1c.$a("IsModuleSidePanelExpanded",this.$$d_$8ac);if(this.$1c.$G.get_$O()==="Mouse"){$4Lh(this);this.$1c.$a("CanCreateItemOnCalendar",this.$$d_$5gP)}_a.$5.aces(o);if(this.$1c.$6w){this.$1c.$6w.$oJ.add_$1Z(this.$$d_$8T9);this.$1c.$6w.$5X.add_$1Z(this.$$d_$30G)}};_d.$1n.$6vd=function(n,t){switch(n){case-1:return!1;case 0:case 1:return!0;default:return t>0}};_d.$1n.$446=function(n,t){for(var r,i=t.get_$F()-1;i>=0;i--){r=t.get_$48(i);if(n.get_$EB()){if(r.get_$EB()){t.$67(i);break}}else r.get_$EB()||r.get_$i().Id!==n.get_$i().Id||t.$67(i)}};_d.$1n.$67E=function(n){_a.$5.$1G(null,n.$2bk);_a.$5.endPT("CreateCalendarItemDefault")};_d.$1n.$9Ap=function(n){_a.$5.$1G(null,n.$2bk);_a.$5.endPT("CreateAllDayCalendarItem")};function $4Lf(n,t){$3EZ(n,!1);n.$65J();n.set_$4qr(n.$3ZQ());t&&n.$5sE();$3EZ(n,n.$2Cp)}function $4Lc(n,t,i){if(n.get_$IQ()){n.get_$IQ().$7GV(t,i);n.set_$IQ(null)}}function $3EV(n){var t=new _d.$TB;t.set_$37Q("Free");t.set_$Nk(!1);t.set_$5m(!0);t.set_$DE(_a.$25.$1BD(2));n.$9Q&&n.$9Q.$EA.$2K&&t.set_$2h(n.$9Q.get_$2h());_js.$8.$c(t.get_$2h())||t.set_$29O(!0);return t}function $6Jh(n){return n.$1c.$G.get_$DC()?null:new _d.$Jr}function $2Tf(n,t){for(var u=0,i=0,e=t.get_$F();i<e;i++)if(_g.$IK.isInstanceOfType(t.get_$48(i))){var f=t.get_$48(i);var r=f.get_$23();var o=f.get_$10().$3u();var s=r.$8c(r)?r.$3u().$9b(86399999):r.$9b(-1);var h=new _h.$4S(o,s);h.$hX(n.get_$8G(),!0,!0)&&u++}return u}function $4Le(n){var t=new _d.$TB;n.get_$8G().$8c(_a.$7.get_$2M())?t.set_$10(_a.$25.$2bn(n.get_$8G(),n.$1c.$t.get_$1t().get_$Tv().get_$1NX())):t.set_$10(_a.$25.$3RL(_a.$7.get_$2M()));t.set_$DE(18e5);n.$1c.$CH&&t.set_$1DK(n.$1c.$CH.get_$AC());if(n.$9Q&&n.$9Q.$EA.$2K){t.set_$2h(n.$9Q.get_$2h());t.set_$10(n.$9Q.get_$10())}_js.$8.$c(t.get_$2h())||t.set_$29O(!0);return t}function $4Lg(n){n.set_$3TR(n.$4zp(n.$ad))}function $6Jl(n,t){t.$2av.$2t.length>0&&n.$1c.$8T.$50T(t.$do)&&n.$3KT(t.$2av.$2t)}function $6Jm(n,t){t.$3Y.length>0&&n.$44B(t.$3Y)}function $6Jn(n,t){t.$3Y.length>0&&n.$8re(t.$2t,t.$3Y)}function $1e0(n,t,i){for(var u=[],r,e,f=0,o=i.length;f<o;f++){r=i[f];e=new _h.$4S(r,r.$2q(1));e.$1Gz(t)&&Array.add(u,n.$76C(t,r))}n.$1tw[t.get_$i().Id]=u;return u}function $2Tg(n){n.$BB(n.$9Q);n.$9Q=null;$4Ld(n)}function $3EW(n){var t=_a.$5.acss(_a.$0.$Ag,"GetItems");if(!n.$1c.$6w){_a.$5.aces(t);return}n.set_$59i(!1);n.set_$sD(!1);n.$1wp();$12w(n);n.$1c.$8T.$8rx(n.get_$1Q(),n.$E8,n.get_$1DO());$12w(n);_a.$5.aces(t)}function $3EX(n){n.$1Ab&&n.set_$sD(n.$1c.$8T.get_$vj()>=1)}function $6Jg(n,t,i,r){_a.$5.stPT(_a.$0.$1o,"CreateCalendarItemDefault",3);_a.$5.$1V(_a.$0.$1o,r);var u=_a.$5.acss(_a.$0.$1o,"Create ComposeCalendarItemViewModel");$8(n.$9Q)||n.$BB(n.$9Q);var f=n.$Db.$ct(t.$3l,_d.$1n.$67E,r);_a.$5.aces(u);n.$1c.$G.$hu(f,0,i)}function $6Jf(n,t){for(var i=0,r=t.get_$F();i<r;i++)t.get_$48(i).$a("AssignedCalendarColor",n.$$d_$5gH)}function $6Jj(n,t){for(var i=0,r=t.get_$F();i<r;i++)t.get_$48(i).$w("AssignedCalendarColor",n.$$d_$5gH)}function $4Lh(n){n.get_$4jx()&&!n.$1dC?n.set_$6Au(n.$76f()):!n.get_$4jx()&&n.$1dC&&n.set_$6Au(null)}function $6Jt(n){n.$13m&&n.$13m.set_$sU(n.$1c.get_$8N())}function $12w(n){if(n.$1Ab){n.set_$2mE(n.$1c.$8T.get_$vj()===-1||n.$1c.$8T.get_$vj()===2);n.set_$5BC(_d.$1n.$6vd(n.$1c.$8T.get_$vj(),n.$1c.$6w?n.$1c.$6w.$oJ.get_$F():0))}}function $6Jv(n,t){if(n.$1HV){$6Ju(n,t);$3EZ(n,t)}}function $6Ju(n,t){n.$1HV&&(t?n.$2Cr?n.set_$2pI(String.format(_u.Strings.l_CalendarViewLoaded_AT_LiveRegion_Text,n.get_$433(),n.$50g())):n.set_$2pI(String.format(_u.Strings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$50g())):n.set_$2pI(null))}function $3EZ(n,t){n.$1HV&&(t?n.set_$5xH(String.format(_u.Strings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$7L8())):n.set_$5xH(null))}function $6Jp(n){var i=n.$1c.get_$8N().$fv;var t=i.$hi(1,!1);if(t.$2K){t.$s();t.$1M()}}function $6Jr(n){if(!n.$1uv){var t=new _js.$X;t.$H(new _a.$2E(new _C(n.$$d_$8iO,n.get_$1Y()),_u.Strings.l_Calendar_OpenUpdatedMeeting_EditButton_Text,_u.Strings.l_Calendar_OpenUpdatedMeeting_EditButtonDesc_Text));t.$H(new _a.$2E(n.$2k0,_u.Strings.l_Calendar_OpenUpdatedMeeting_DiscardButton_Text,_u.Strings.l_Calendar_OpenUpdatedMeeting_DiscardButtonDesc_Text));n.set_$8iN(t)}}function $6Js(n){n.set_$2na(!0)}function $6Jk(n){n.$1c.get_$8N()&&n.$1c.get_$8N().$eC()}function $6Jq(n){n.$9Q&&(n.$1LS=n.$9Q.get_$5m()?_a.$5.$1V(n.get_$1Y(),"SaveNaturalInputAllDayItem",!0):_a.$5.$1V(n.get_$1Y(),"SaveNaturalInputItem",!0));var t=n.$Ka.$8M(n.$9Q.$2Q);t.$4x.add_$2m(n.$$d_$8az);t.$4x.$DX=String.format("CreateCalendarItem.NaturalInput.{0}.{1}",n.get_$1DO(),n.$1c.$G.get_$O());t.$4x.$8um();$4Ld(n)}function $4Ld(n){n.$1u2&&n.$1u2.$2K&&n.$1u2.$s()}function $6Jo(n){if(!(n.$2Jw.get_$F()>0)){n.$2Jw.$H(new _a.$2E(n.$3vl,_u.Strings.l_CalendarNaturalInputConfirmDialogContinueEditTitle_LowerCase_Text,_u.Strings.l_CalendarNaturalInputConfirmDialogContinueEditSubTitle_Text));var t=this;n.$2Jw.$H(new _a.$2E(new _C(function(){n.set_$5e8(!0);n.set_$2nO(!1);$2Tg(n)},_a.$0.$1o),_u.Strings.l_CalendarNaturalInputConfirmDialogDiscardTitle_LowerCase_Text,_u.Strings.l_CalendarNaturalInputConfirmDialogDiscardSubTitle_Text))}}function $3EY(n,t){}function $3EU(n,t){var i=!1;if(n.$1c.$QF){var r=n.$1c.$QF.$l.$r.get_$i();var u=n.$1c.get_$8N()?n.$1c.get_$8N().$r.get_$i():null;if(t||r!==u){n.$1c.$QF.set_$1X(!1);i=!0}if(i&&r!==u){n.$1c.$QF.$1M();n.$1c.set_$5ne(null)}}else i=!0;return i}function $6Je(n){return!!n.$1c.$G.get_$oP().get_$8H().get_$F()}function $6Ji(n,t){return!_h.$4S.$4F(n.$E8,n.$4zp(t))}_d.$1n.prototype={$1Ab:!0,$Db:null,$Ka:null,$5nf:null,$1c:null,$2br:null,$4ok:null,$3Re:null,$2bs:null,$4FH:null,$Ya:null,$QA:null,$1uu:null,$36D:null,$lD:null,$i8:null,$2Af:null,$2Ae:null,$3R5:null,$2k0:null,$1tw:null,$1HV:!1,$3vl:null,$1dC:null,$1u2:null,$E8:null,$HA:null,$ad:null,$3F:null,$2dI:null,$CJ:!1,$1yQ:!1,$2Cp:!1,$1Go:!1,$16N:!1,$1nv:!1,$1uv:null,$9Q:null,$13m:null,$16J:!1,$2ny:!1,$1HW:null,$35w:null,$2Cr:!1,$2y3:!1,$2nN:!1,$16R:!1,$qI:null,$1QQ:null,$1LS:null,add_$2ZV:function(n){this.$2Z("CalendarColorsChanged",n)},remove_$2ZV:function(n){this.$2b("CalendarColorsChanged",n)},add_$2eK:function(n){this.$2Z("DisplayedDateChanging",n)},remove_$2eK:function(n){this.$2b("DisplayedDateChanging",n)},get_$6Au:function(){return this.$1dC},set_$6Au:function(n){if(this.$1dC!==n){this.$1dC=n;$6(this,"ViewContextMenuViewModel")}return n},get_$5BC:function(){return this.$1Go},set_$5BC:function(n){if(this.$1Go!==n){this.$1Go=n;$6(this,"IsLoadingItems")}return n},get_$3h2:function(){return this.$16R},set_$3h2:function(n){if(n!==this.$16R){this.$16R=n;$6(this,"IsItemContextMenuShown")}return n},get_$2nO:function(){return this.$2nN},set_$2nO:function(n){if(n!==this.$2nN){n&&$6Jo(this);this.$2nN=n;$6(this,"IsNaturalInputSaveDialogShown")}return n},get_$5e8:function(){return this.$2y3},set_$5e8:function(n){if(n!==this.$2y3){this.$2y3=n;$6(this,"NaturalInputSaveDialogShouldRestoreFocus")}return n},get_$5e7:function(){return this.$1u2},set_$5e7:function(n){if(this.$1u2!==n){this.$1u2=n;$6(this,"NaturalInputExitCommand")}return n},get_$2mE:function(){return this.$16N},set_$2mE:function(n){if(this.$16N!==n){this.$16N=n;$6(this,"IsErrorLoadingItems")}return n},get_$7D4:function(){return _u.Strings.l_LoadingError_Text},get_$G5:function(){return this.$CJ},set_$G5:function(n){if(this.$CJ!==n){this.$CJ=n;n?this.$2z6():this.$5h6()}return n},get_$37C:function(){return this.$1yQ},set_$37C:function(n){if(this.$1yQ!==n){this.$1yQ=n;n&&this.$25L()}return n},get_$4jW:function(){return!this.$1c.$G.get_$DC()},get_$2a2:function(){return!!this.$9Q||!!this.$1c.get_$8N()&&this.$1c.get_$8N().$fv.get_$2a2()},get_$6wo:function(){return this.get_$2a2()},get_$6wu:function(){return this.$1c.get_$8N()?this.$1c.get_$8N().$r.get_$b2():!1},get_$y8:function(){return this.$16J},set_$y8:function(n){if(this.$16J!==n){this.$16J=n;this.$5gM()}return n},get_$4jc:function(){return this.$1c.$G.get_$O()==="Mouse"},get_$3TR:function(){return this.$E8},set_$3TR:function(n){if($8(n))throw Error.argumentNull("DateRange");if($8(this.$E8)||!this.$E8.$4W(n)){this.$E8=n;this.set_$4qr(this.$3ZQ());if(this.$CJ&&this.$1Ab){$3EW(this);this.$1ge=this.$1c.$8T.get_$36Q()}else this.$1ge=-1;$4Z(this,"DateRange","AccessibleName")}return n},get_$8G:function(){return this.$ad},set_$8G:function(n){if(!$8(n)&&!_a.$7.$4F(this.$ad,n)){var t=$8(this.$ad)||!_a.$7.$4F(this.$ad.$3u(),n.$3u());this.$ad=n;$4Lf(this,t);$6(this,"VMSelectedDate")}return n},$25L:function(){return this.$1c.$8T.$25L()},$47o:function(n){this.$3F=n;$6(this,"DisplayedDate");this.set_$8G(n)},get_$3bD:function(){return 0},get_$AB:function(){return this.$3F},set_$AB:function(n){if(this.$2dI){$6(this,"DisplayedDate");return n}if(!_a.$7.$4F(this.$3F,n)){var t=this.$eX("DisplayedDateChanging");if(t&&$6Ji(this,n)){var i=!this.$3F||n.$2Y(this.$3F)<0;this.$2dI=n;t(i,this.$$d_$8xr)}else this.$47o(n)}return n},get_$4qr:function(){return this.$HA},set_$4qr:function(n){_a.$3.$M(n,"DateRangeArray cannot be null");if(!_a.$25.$4F(this.$HA,n)){this.$HA=n;$6(this,"DateRangeArray")}return n},get_$2y2:function(){return this.$9Q},set_$2y2:function(n){if(this.$9Q!==n){this.$9Q=n;$6(this,"CanOpenItem")}return n},get_$2na:function(){return this.$1nv},set_$2na:function(n){if(this.$1nv!==n){this.$1nv=n;$6(this,"IsOpenUpdatedMeetingDialogShown")}return n},get_$8iN:function(){return this.$1uv},set_$8iN:function(n){if(n!==this.$1uv){this.$1uv=n;$6(this,"OpenUpdatedMeetingDialogButtonData")}return n},get_$sD:function(){return this.$2ny},set_$sD:function(n){if(this.$2ny!==n){this.$2ny=n;$6(this,"IsReadyToShowData")}return n},get_$2pI:function(){return this.$1HW},set_$2pI:function(n){if(this.$1HW!==n){this.$1HW=n;$6(this,"ItemsLoadedNotificationMessage")}return n},get_$5xH:function(){return this.$35w},set_$5xH:function(n){if(this.$35w!==n){this.$35w=n;$6(this,"SelectedDateItemsLoadedNotificationMessage")}return n},get_$7YQ:function(){return this.$2Cr},set_$7YQ:function(n){if(this.$2Cr!==n){this.$2Cr=n;$6(this,"IsDateInItemsLoadedNotificationMessage")}return n},get_$59i:function(){return this.$2Cp},set_$59i:function(n){if(this.$2Cp!==n){this.$2Cp=n;$6Jv(this,n);$6(this,"IsDataProcessed")}return n},get_$433:function(){return this.get_$AB().$2P(3)},get_$IQ:function(){return this.$qI},set_$IQ:function(n){if(this.$qI!==n){this.$qI=n;$6(this,"CalendarScenarioContext")}return n},$2z6:function(){this.$1c.$8T.add_$2Zd(this.$$d_$8bJ);this.set_$37C(!0);this.$1ge!==this.$1c.$8T.get_$36Q()&&this.$1Ab&&$3EW(this);this.$1c.$6w&&$6Jf(this,this.$1c.$6w.$5X);$12w(this)},$5h6:function(){this.$1c.$8T.remove_$2Zd(this.$$d_$8bJ);this.set_$37C(!1);this.$1c.$6w&&$6Jj(this,this.$1c.$6w.$5X)},get_$4j1:function(){return this.$Ka},get_$1Y:function(){return _a.$0.$1o},get_$4jX:function(){return!this.$9Q&&this.$1c.get_$1PU()&&!this.get_$y8()&&this.$1c.get_$7YI()},get_$4jx:function(){return this.$1c.get_$1PU()},$hh:function(n){if(!$6Je(this)){$3EU(this,!0);var t=this.$52A();$6Jg(this,t,!1,n?n:"CreateCalendarItemDefault")}},$74d:function(){this.$hh("CreateItemByClickNewEventButton")},$74e:function(){this.$hh("CreateItemByClickOrTapOnSurface")},$74f:function(){this.$hh("CreateItemByContextMenu")},$74g:function(){this.$hh("CreateItemByHotkey")},$gu:function(){var t=this.$1c.get_$8N().$r;if(t.get_$Hm()){$3EY(this,"ShowConfirmation");$6Jr(this);$6Js(this)}else{$3EY(this,"Save");var n=this.$1c.get_$8N();var i=this;n.$4x.add_$2m(function(n,t){t.$1b&&$3EY(i,"Fail")});this.$16J&&(n.$4x.$DX=String.format("UpdateCalendarItem.DragDrop.{0}.{1}",this.get_$1DO(),this.$1c.$G.get_$O()));n.$4x.$5x()}},$4nv:function(){_a.$5.stPT(_a.$0.$1o,"CreateAllDayCalendarItem",3);_a.$5.$1V(_a.$0.$1o,"CreateAllDayCalendarItem");var n=_a.$5.acss(_a.$0.$1o,"ComposeCalendarItemViewModelAllDay");$8(this.$9Q)||this.$BB(this.$9Q);var t=this.$7Hs();this.$9Q&&this.$9Q.$EA.$2K&&(this.$9Q=null);var i=this.$Db.$ct(t.$3l,_d.$1n.$9Ap,"CreateAllDayCalendarItem");_a.$5.aces(n);this.$1c.$G.$9T(i)},$1Lp:function(){this.$1c.$G.get_$O()==="TouchNarrow"&&this.$30l()},$8i5:function(){this.$30l("CreateItemByHotkeyEnter")},$30l:function(n){if(!$8(this.$9Q)&&this.$9Q.$EA.$2K){this.$BB(this.$9Q);this.$9Q.get_$9w()?this.$4nv():n?this.$hh(n):this.$hh("CreateItemByClickOrTapOnSurface");return}var t=this.$1c.get_$8N();if(!$8(t)&&!$8(t.$r)&&!t.get_$1Gu()){$3EU(this,!0);$6Jp(this)}},$3bB:function(){var n=_a.$7.get_$2M().$3u();this.set_$8G(new _a.$7(n.get_$4M(),n.get_$3D(),n.get_$5z(),this.$ad.get_$Ec(),this.$ad.get_$Gs(),this.$ad.get_$Te(),this.$ad.get_$18b()));this.$1c.$S.$8oV(_d.$ep,new _d.$ep)},$53A:function(){throw Error.notImplemented();},$539:function(){throw Error.notImplemented();},$b7:function(){if(this.$1c){this.$1c.set_$8N(null);this.$1c.set_$qu(null)}},$76f:function(){return this.$1c.$G.get_$DC()?null:new _0365m.$2c([new _0365m.$n(_u.Strings.l_NewString_LowerCase_Text,null,this.$Ya)])},$59:function(){if(this.$1Ab){this.$1c.$8T.remove_$4wG(this.$$d_$8WH);this.$1c.$8T.remove_$2ZX(this.$$d_$5gL)}this.$1c.$8T.remove_$4ik(this.$$d_$8Sz);this.$1c.$w("CurrentItem",this.$$d_$8Uc);this.$1c.$w("CurrentItemModel",this.$$d_$5h0);this.$1c.$w("IsModuleSidePanelExpanded",this.$$d_$8ac);this.$1c.$G.get_$O()==="Mouse"&&this.$1c.$w("CanCreateItemOnCalendar",this.$$d_$5gP);if(this.$1c.$6w){this.$1c.$6w.$oJ.remove_$1Z(this.$$d_$8T9);this.$1c.$6w.$5X.remove_$1Z(this.$$d_$30G)}this.$Ya.$1M();this.$2bs.$1M();_a.$1.prototype.$59.call(this)},$4zp:function(n){var t=_a.$25.$Km(n,this.get_$14d(),!1,this.$1c.$t.get_$1t().get_$Tv().get_$dP());return new _h.$4S(t[0],t[1])},$52A:function(){return $4Le(this)},$7Hs:function(){var n=$3EV(this);n.set_$10(_a.$25.$2bn(this.get_$8G(),this.$1c.$t.get_$1t().get_$Tv().get_$1NX()));n.set_$1DK(this.$1c.$CH.get_$AC());return n},$65J:function(){this.set_$AB(this.get_$8G())},$5sE:function(){$4Lg(this)},$9FE:function(){$8(this.$1c.get_$8N())||$8(this.$1c.get_$8N().$r.get_$10())||this.$1c.get_$8N().$r.get_$9w()||(this.$ad=new _a.$7(this.$ad.get_$4M(),this.$ad.get_$3D(),this.$ad.get_$5z(),this.$1c.get_$8N().$r.get_$10().get_$Ec(),this.$1c.get_$8N().$r.get_$10().get_$Gs(),0))},$8WH:function(n,t){if(this.$CJ){this.$1ge=this.$1c.$8T.get_$36Q();var i=this.$1c.$8T.$3Z8(this.$E8);var r=_a.$5.acss(_a.$0.$1o,"CalDataLoaded:"+this.get_$1Q());this.$1wp();this.$3KT(i);this.$5gJ(n,t);$12w(this);$3EX(this);this.$1c.$8T.get_$vj()===2&&$4Lc(this,"Failed to load some calendar folders",t.$1QL);_a.$5.aces(r)}},$8bJ:function(n,t){var i=t.$2av;var r=_a.$5.acss(_a.$0.$5v,"OnNotification");if(!this.$CJ)throw Error.invalidOperation(String.format("[CalendarBaseViewModel: {0}] Inactive view model should not listen to cache changes.",this.get_$1Q()));this.$1ge=this.$1c.$8T.get_$36Q();try{switch(i.$3R){case 0:$6Jl(this,t);break;case 2:$6Jm(this,i);break;case 4:this.$1wp();break;case 3:$6Jn(this,i);break}}finally{$3EX(this);$12w(this)}_a.$5.aces(r)},$8Sz:function(){_js.Trace.logInfo(this.get_$1Y(),"CalendarBaseViewModel:CheckAndReloadCache, ShouldReloadCacheOnStale: {0}",this.$1yQ);this.$1yQ&&this.$25L()},$44B:function(n){for(var t,r,u,i,f=0,o=n.length;f<o;++f){t=n[f];i=t.get_$i().Id;if(this.$1bX(t))if(i in this.$1tw){r=this.$1tw[i];for(var e=0,s=r.length;e<s;e++){u=r[e];this.$BB(u);u.$1M()}delete this.$1tw[i]}else this.$BB(t)}},$1wp:function(){var t=this.$1tw;for(var i in t)for(var u={key:i,value:t[i]},r=u.value,n=0,f=r.length;n<f;n++)r[n].$1M()},$8re:function(n,t){this.$44B(n);this.$3KT(t)},$1bX:function(n){return this.$E8.$2G.$2Y(n.get_$10())<=0&&this.$E8.$2w.$2Y(n.get_$10())>0||this.$E8.$2w.$2Y(n.get_$23())>=0&&this.$E8.$2G.$2Y(n.get_$23())<0||n.get_$10().$2Y(this.$E8.$2G)<=0&&n.get_$23().$2Y(this.$E8.$2w)>=0},$76C:function(n,t){return new _d.$Jw(n,t)},$5fk:function(n){this.$1c.$G.get_$O()!=="Mouse"&&n!==this.$1c.$2f.get_$wV()&&this.$1c.$6w.$5X.$6l(this.$1c.$2f.get_$wV())||this.$1c.set_$14L(n)},$8dn:function(n){if(this.$1c.$CH===n){var t=this.$1c.$6w.$5X.$7h(this.$1c.$2f.get_$wV());t<0&&(t=this.$1c.$G.get_$O()==="Mouse"?0:this.$1c.$6w.$5X.get_$F()-1);this.$1c.set_$14L(this.$1c.$6w.$5X.get_$48(t))}},$30G:function(n,t){if(this.$CJ){var i;switch(t.$3R){case 0:for(var r=0,f=t.$2t.length;r<f;r++){i=t.$2t[r];i.$a("AssignedCalendarColor",this.$$d_$5gH);this.$1Ab&&this.$7Ii(i);this.$5fk(i)}break;case 2:for(var u=0,e=t.$3Y.length;u<e;u++){i=t.$3Y[u];i.$w("AssignedCalendarColor",this.$$d_$5gH);$12w(this);$3EX(this);this.$8dn(i)}break;case 3:throw Error.notImplemented();case 4:this.$1Ab&&$3EW(this);break}}},$5gJ:function(n,t){this.set_$59i(!0)},$5gL:function(n,t){this.$1c.$8T.get_$vj()===-1&&$4Lc(this,"Failed to load all calendars",t.$1QL);$12w(this)},$3ZQ:function(){var n=_a.$25.$Km(this.get_$8G(),this.get_$14d(),!0,this.$1c.$t.get_$1t().get_$Tv().get_$dP());Array.removeAt(n,n.length-1);return n},$8xJ:function(n){return n},$6pL:function(){if(this.$1QQ){_a.$5.$1G(this.$1QQ);this.$1QQ=null}if(this.$9Q)if(_js.$8.$c(this.$9Q.get_$2h())){var n=null;this.$9Q&&(n=this.$9Q.get_$5m()?_a.$5.$1V(this.get_$1Y(),"DiscardNaturalInputAllDayItem",!0):_a.$5.$1V(this.get_$1Y(),"DiscardNaturalInputItem",!0));$2Tg(this);if(n){_a.$5.$1G(n);n=null}}else{this.$9Q.$EA.set_$5P(!1);$6Jq(this)}},$7A5:function(){this.$1QQ&&_a.$5.$1G(this.$1QQ);var n=null;this.$9Q&&(n=this.$9Q.get_$5m()?_a.$5.$1V(this.get_$1Y(),"DiscardNaturalInputAllDayItem",!0):_a.$5.$1V(this.get_$1Y(),"DiscardNaturalInputItem",!0));$2Tg(this);if(n){_a.$5.$1G(n);n=null}},$5gM:function(){this.$16J?this.$1c.$8T.$39f():this.$1c.$8T.$351();$6(this,"IsDraggingItem")},$9El:function(){if(!this.$1c.$G.get_$DC()){var n=$3EU(this);n&&this.$1c.get_$8N()&&this.$1c.get_$8N().$r.get_$1DP()&&this.$1c.set_$5ne(this.$5nf.$I(this.$1c.get_$8N()))}},$8Uc:function(n,t){if(this.$CJ){$Ha(this,_d.$1n.$5gy);this.$9El();this.$9FE();$6Jt(this)}},$5gP:function(n,t){this.$CJ&&$4Lh(this)},$7Ii:function(n){var t=_a.$5.acss(_a.$0.$Ag,"GetCalendarItems");this.$1c.$8T.$2Ng(this.get_$1Q(),n,this.$E8,this.get_$1DO());$12w(this);_a.$5.aces(t)},$5gH:function(n,t){$Bc(this,"CalendarColorsChanged",this,n)},$8ac:function(n,t){this.$CJ&&$6(this,"LayoutResize")},$5h0:function(n,t){if(this.$CJ)if(this.$1c.$WZ){var i;i=_g.$39.isInstanceOfType(this.$1c.$WZ)?this.$1c.$WZ:this.$1c.$WZ.$2Q;this.$1c.get_$8N()&&i===this.$1c.get_$8N().$6S||this.$1c.set_$8N(this.get_$4j1().$8M(i))}else this.$1c.set_$8N(null)},$8iO:function(){var n=this.$1c.get_$8N().$r;var t=new _d.$F2;t.set_$i(n.get_$i());t.set_$10(n.get_$10());t.set_$DE(n.get_$23().$6E(n.get_$10()));t.set_$5m(n.get_$5m());var i=this.$Db.$ct(t.$3l,_d.$1n.$67E);this.$55S();this.$1c.$G.$9T(i)},$55S:function(){$6Jk(this);this.set_$2na(!1)},$72Z:function(){if(this.$1c.$G.get_$O()==="Mouse"&&this.get_$4jX()){this.$1QQ=_a.$5.$1V(this.get_$1Y(),"CreateAllDayItemByNaturalInput",!0);this.$1c.set_$qu(null);var n=new _g.$1m;n.EmailAddress=this.$1c.$t.get_$38().get_$Br();n.Name=this.$1c.$t.get_$38().get_$Gz();n.MailboxType="Mailbox";var t=this.$Db.get_$3O3().$26C(n);t.set_$5m(!0);t.set_$92("Free");t.set_$Nk(!1);this.set_$2y2(new _d.$jn(this.$8xJ(t),new _C(this.$$d_$6pL,this.get_$1Y()),new _C(this.$$d_$7A5,this.get_$1Y())));this.$H0(this.$9Q)}},$8az:function(n,t){if(t.$1b){this.set_$2nO(!0);this.$1c.set_$qu(null);this.$1c.set_$8N(null);if(this.$1LS){_a.$5.$1G(this.$1LS,null,t.$1b.message.toString(),t.$Jn.toString());this.$1LS=null}}else{$2Tg(this);if(this.$1LS){_a.$5.$1G(this.$1LS);this.$1LS=null}}},$8pI:function(){this.set_$5e8(!1);this.set_$2nO(!1);this.$9Q.$EA.set_$5P(!0)},$8T9:function(n,t){this.$CJ&&$12w(this)},$72Q:function(){var n=this.$1c.get_$8N()?this.$1c.get_$8N().$6S:null;if(n){var t=_g.$97.$4oX(n);var i=_y.$AZ.$3RT(t);_a.$HH.$2PK(JsonParser.serialize(i.$OR()))}},$8xr:function(){var n=this.$2dI;this.$2dI=null;n&&this.$47o(n)}};_d.$je=function(n,t,i,r){this.$Db=n;this.$Ka=t;this.$vk=i;this.$WK=r};_d.$je.prototype={$Db:null,$Ka:null,$vk:null,$WK:null,$3R4:function(n,t){return new _d.$j9(n,this.$Db,this.$Ka,this.$vk,t)},$4o7:function(n,t){return new _d.$EZ(n,this.$Db,this.$Ka,this.$vk,t)},$4pY:function(n,t,i){return new _d.$jw(n,this.$Db,this.$Ka,this.$vk,t,i,this.$WK)},$4pU:function(n,t,i){return new _d.$MW(n,this.$Db,this.$Ka,this.$vk,t,i,this.$WK)},$76k:function(n,t){return new _d.$x4(n,this.$Db,this.$Ka,this.$vk,t)},$75b:function(n,t,i,r,u){return new _d.$nY(n,this.$Db,this.$Ka,this.$vk,t,i,r,u)},$4oy:function(n,t,i,r){var u=_a.$5.acss(_a.$0.$1o,"CreateMonthAgendaVM");var f=new _d.$t7(this.$3R4(n,r),n,this.$Db,this.$Ka,this.$vk,i,r);_a.$5.aces(u);return f}};_d.$Sy=function(n,t){this.$$d_$4kx=Function.createDelegate(this,this.$4kx);_d.$Sy.initializeBase(this,[n,t]);this.$2f=t;this.$4ky=new _C(this.$$d_$4kx,_d.$Sy.$D)};_d.$Sy.prototype={$2f:null,$4ky:null,$4kx:function(){this.$2f.$4kx()}};_d.$wj=function(n,t,i){_d.$wj.initializeBase(this,[_u.Strings.l_ChangeCalendarColorContextMenuTitle_LowerCase_Text,null,n,t,i]);this.set_$61V(!1);this.$4f9=!1;this.set_$39M("CalendarColorPickerTemplates.ColorGridMenuItemTemplate")};_d.$jg=function(n,t){this.$$d_$8xW=Function.createDelegate(this,this.$8xW);this.$$d_$8xX=Function.createDelegate(this,this.$8xX);this.$$d_$8Ts=Function.createDelegate(this,this.$8Ts);_d.$jg.initializeBase(this);_a.$3.$17(n,"Need calendar entry for calendar we are managing the color for.");_a.$3.$17(t,"Error message handler must be specified.");this.$IO=n;this.$4il=$6K1(this);this.$4dG=t};function $6K1(n){var t=new Array(10);t[0]=new _d.$RY(_u.Strings.l_AutomaticCalendarColorContextMenuTitle_LowerCase_Text,null,-1,"CalendarColorPickerTemplates.AutomaticColorMenuItemTemplate");for(var i=0;i<9;i++)t[i+1]=new _d.$RY(_g.$em.toString(i).toLocaleLowerCase(),null,i,"CalendarColorPickerTemplates.ColorMenuItemTemplate");n.$5JU=new _d.$wj(n.$$d_$8Ts,t,t[n.$IO.get_$YR()+1]);return t}_d.$jg.prototype={$IO:null,$4il:null,$4dG:null,$5JU:null,$Hl:!1,get_$1mi:function(){return this.$Hl},set_$1mi:function(n){if(this.$Hl!==n){this.$Hl=n;$6(this,"IsActionPending")}return n},$8Ts:function(n){if(!this.$Hl){var i=n;if(this.$IO.get_$iN()){this.$IO.set_$1Cv(this.$IO.set_$YR(i));return}var t=new _c.$ue(this.$IO,i);t.add_$20(this.$$d_$8xX);t.add_$2m(this.$$d_$8xW);this.set_$1mi(!0);OwaApplication.$1T.$y(t)}},$8xX:function(n){this.$4il[this.$IO.get_$YR()+1].$470();this.$4dG(n.get_$bO())},$8xW:function(n){this.set_$1mi(!1)}};_d.$wl=function(){_d.$wl.initializeBase(this)};_d.$wl.prototype={$6qH:function(n){for(var t=0,i=this.$o.length;t<i;t++)if(_d.$9p.$w6(this.$o[t],n)>0){Array.insert(this.$o,t,n);return}Array.add(this.$o,n)}};_d.$I5=function(){this.$o=new _js.$X};_d.$I5.$8ss=function(n,t){for(var i=0,r=t.length;i<r;i++)_d.$I5.$5uW(n,t[i]);return n};_d.$I5.$5uW=function(n,t){_a.$3.$M(n,"source");_a.$3.$M(t,"item");var i=_d.$I5.$4zW(n,t);var o=i.length;if(o){for(var r=i[0],u,f=1;f<o;f++){u=i[f].$o;for(var e=0,c=u.length;e<c;e++)r.$H(u[e])}r.$H(t);var h=n.$7h(r);n.$a5(h,i.length);n.$6z(h,r)}else{var s=new _d.$wl;s.$H(t);_d.$I5.$3KP(n,s)}};_d.$I5.$3KP=function(n,t){for(var i=0,r=n.get_$F();i<r;i++){var u=n.get_$48(i);if(t.$7T.$2Y(u.$7T)<0){n.$6z(i,t);return}}n.$H(t)};_d.$I5.$4zW=function(n,t){for(var e=[],i,r,u,f=0,o=n.get_$F();f<o;f++){i=n.get_$48(f);r=i.$7T;u=t.get_$23();if(t.get_$10().$2Y(i.$9f)<0&&u.$2Y(r)>0)Array.add(e,i);else if(u.$2Y(r)<=0)break}return e};function $6K4(n,t){for(var i,r=0,u=n.$o.get_$F();r<u;r++){i=n.$o.get_$48(r);if(i.$7T.$2Y(t.get_$10())<=0&&i.$9f.$2Y(t.get_$23())>=0)return i}return null}_d.$I5.prototype={$o:null,$H:function(n){_a.$3.$M(n,"item");_d.$I5.$5uW(this.$o,n)},$3Q:function(n){_a.$3.$M(n,"item");var t=$6K4(this,n);if(!t)throw Error.invalidOperation("The ICalendarSurfaceItem does not exist in the CalendarConflictGroupCollection");t.$3Q(n);var i=this.$o.$7h(t);if(i===-1||i>this.$o.get_$F())throw Error.invalidOperation("Unable to find index of item's conflict group");this.$o.$67(i);for(var u=_d.$I5.$8ss(new _js.$X,t.$o),r=u.get_$F()-1;r>=0;r--)this.$o.$6z(i,u.get_$48(r))}};_d.$HB=function(n,t,i,r,u,f,e,o){this.$$d_$8bu=Function.createDelegate(this,this.$8bu);_d.$HB.initializeBase(this);_a.$3.$M(u,"owaShell");_a.$3.$M(f,"userConfiguration");this.$G=u;this.$t=f;this.$S=o;this.$6w=n;this.$8T=t;this.$2f=i;this.$25G=r;this.$4D6=e;this.$s7=u.get_$O()==="Mouse"};function $6K6(n){if($6K5(n)&&n.$4D6){var t=this;n.$4D6.$I(function(t){n.set_$4qC(t)})}else n.set_$4qC(null)}function $6K5(n){if(n.$G.get_$O()==="TouchNarrow")return!1;var t=n.$CH;return t?t.get_$bi():!1}_d.$HB.prototype={$6w:null,$8T:null,$2f:null,$G:null,$t:null,$2C:null,$QF:null,$WZ:null,$CH:null,$26Y:null,$25G:null,$S:null,$4D6:null,$s7:!1,$38O:!1,$2QN:0,$1c6:!1,$2cX:null,get_$8N:function(){return this.$2C},set_$8N:function(n){if(this.$2C!==n){this.$2C=n;this.$G.get_$DC()||this.$G.get_$O()!=="Mouse"||!this.$2C||this.$2C.get_$1Gu()?this.set_$4pr(null):this.set_$4pr(new _d.$5N(this.$2C,this.$25G));$6(this,"CurrentItem")}return n},get_$4qC:function(){return this.$2cX},set_$4qC:function(n){if(this.$2cX!==n){this.$2cX=n;$6(this,"CurrentTimeline")}return n},get_$qu:function(){return this.$WZ},set_$qu:function(n){if(this.$WZ!==n){this.$WZ=n;this.$WZ&&this.$G.get_$O()==="Mouse"&&this.set_$14L(this.$WZ.get_$5Z());$6(this,"CurrentItemModel")}return n},get_$4pr:function(){return this.$26Y},set_$4pr:function(n){if(this.$26Y!==n){this.$26Y=n;$6(this,"CurrentItemContextMenuViewModel")}return n},get_$14L:function(){return this.$CH},set_$14L:function(n){if(n!==this.$CH){this.$CH=n;$6K6(this);$4Z(this,"CurrentCalendarModel","CanCreateItemOnCalendar")}return n},get_$16V:function(){return this.$s7},set_$16V:function(n){if(this.$s7!==n){this.$s7=n;$6(this,"IsModuleSidePanelExpanded")}return n},get_$62k:function(){return this.$38O},set_$62k:function(n){if(this.$38O!==n){this.$38O=n;$6(this,"SidePanelItemsLoadedNotificationEnabled")}return n},get_$38P:function(){return this.$2QN},set_$38P:function(n){if(this.$2QN!==n){this.$2QN=n;$6(this,"SidePanelMonthPickerCount")}return n},get_$7YI:function(){if(!this.$CH)return!1;var n=this.$2f.$xS(this.$CH.get_$AC());return this.$8T.$50T(n.get_$n())},get_$1PU:function(){if($8(this.$CH))return!1;var n=this.$2f.$xS(this.$CH.get_$AC());return!this.$G.get_$DC()&&!!n&&n.$2Zw(this.$CH)},get_$5ne:function(){return this.$QF},set_$5ne:function(n){if(this.$QF!==n){this.$QF&&this.$QF.$w("IsShown",this.$$d_$8bu);this.$QF=n;this.$QF&&this.$QF.$a("IsShown",this.$$d_$8bu);$6(this,"PeekViewModel")}return n},$8bu:function(n,t){this.$1c6=!!(this.$1c6|!!this.$QF)}};_d.$6t=function(){this.$$d_$8TF=Function.createDelegate(this,this.$8TF);this.$2F1=_a.$7.get_$2M();_d.$6t.initializeBase(this)};function $4Lk(n){if(!n.$hM){n.$2F1=_a.$7.get_$2M();n.$hM=_js.$K.get_$L().$oa(_a.$0.$1o,"CalendarDateTimeNotification",n.$$d_$8TF,_d.$6t.$4qE)}}function $4Lj(n){n.$hM&&(n.$hM=_js.$K.get_$L().$5G(n.$hM))}_d.$6t.prototype={$hM:null,$2Zk:0,add_$4jJ:function(n){this.$2Z("CalendarTimeChanged",n);++this.$2Zk==1&&$4Lk(this)},remove_$4jJ:function(n){this.$2b("CalendarTimeChanged",n);--this.$2Zk||$4Lj(this)},add_$24l:function(n){this.$2Z("CalendarDateChanged",n);++this.$2Zk==1&&$4Lk(this)},remove_$24l:function(n){this.$2b("CalendarDateChanged",n);--this.$2Zk||$4Lj(this)},$8TF:function(){var n=_a.$7.get_$2M();var t=!!this.$2F1.$8c(n);this.$2F1=n;$Bc(this,"CalendarTimeChanged",this,n);t&&$Bc(this,"CalendarDateChanged",this,n)}};_d.$EZ=function(n,t,i,r,u){this.$$d_$5fp=Function.createDelegate(this,this.$5fp);this.$$d_$8gG=Function.createDelegate(this,this.$8gG);_d.$EZ.initializeBase(this,[n,t,i,r,u]);var f=_a.$5.acss(_a.$0.$1o,"CalendarDayViewModel:Init");this.set_$8G(n);this.$ip=new _0365m.$n(_u.Strings.l_SplitLabel_Caps_Text,_d.$4.get_$63g(),new _C(this.$$d_$8gG,this.get_$1Y()),!1,null,null,null,_d.$4.get_$63j());this.$3Nu=new _d.$Fo([this.get_$8G()],this.$BJ,this.$1c.$6w.$5X,u.$2f);_a.$5.aces(f)};function $6K7(n){if(!$8(n.$1BH)){n.$1BH.$1u();for(var i=Math.min(2,n.$BJ.get_$F()),t=0;t<i;t++)n.$1BH.$H(n.$BJ.get_$48(t));$4Z(n,"CanShowInAgenda","ShowInAgendaItems")}}_d.$EZ.prototype={$1BH:null,$3Nu:null,$OX:!1,$1bj:null,$ip:null,get_$14d:function(){return 0},get_$1Q:function(){return"CalendarDayViewModel"},get_$1DO:function(){return 1},get_$672:function(){return this.$1c.$G.get_$O()!=="TouchNarrow"?null:this.$1bj?this.$1BH:this.$BJ},get_$2oR:function(){return this.$OX},set_$2oR:function(n){if(this.$OX!==n){this.$OX=n;var t=[this.get_$8G()];if(this.$OX){this.$3Nu.set_$aD(t);this.set_$3SU(this.$3Nu);this.$ip.set_$1N(_u.Strings.l_MergeLabel_Caps_Text);this.$ip.set_$Bh(_d.$4.get_$7i3());this.$ip.set_$JO(_d.$4.get_$7i9())}else{this.$14b.set_$aD(t);this.set_$3SU(this.$14b);this.$ip.set_$1N(_u.Strings.l_SplitLabel_Caps_Text);this.$ip.set_$Bh(_d.$4.get_$63g());this.$ip.set_$JO(_d.$4.get_$63j())}$4Z(this,"IsSideBySideMode","CanDimItems")}return n},get_$4jc:function(){return!this.$OX&&_d.$1n.prototype.get_$4jc.call(this)},get_$3Om:function(){return this.$1c.$6w.$5X.get_$F()>1},get_$4jy:function(){return!$8(this.$1BH)&&this.$BJ.get_$F()>this.$1BH.get_$F()},get_$93C:function(){return this.get_$4jy()?String.format(_u.Strings.l_Calendar_ShowInAgendaLabel_Text,this.$BJ.get_$F()-this.$1BH.get_$F()):""},get_$93B:function(){return this.$1bj},set_$93B:function(n){if(this.$1bj!==n){this.$1bj=n;if(this.$1bj){this.$1BH=new _0365f.$Ih(_d.$9p.$w6);this.$BJ.add_$1Z(this.$$d_$5fp)}else{this.$1BH=null;this.$BJ.remove_$1Z(this.$$d_$5fp)}$6(this,"ShowInAgendaCommand")}return n},get_$2WR:function(){return String.format(_u.Strings.l_CalendarDayView_AT_Region_Text,this.get_$433())},$53A:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"DayView_GoPrev",!0,!0));this.set_$AB(this.get_$AB().$2q(-1))},$539:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"DayView_GoNext",!0,!0));this.set_$AB(this.get_$AB().$2q(1))},$2he:function(n){return this.$OX?$21a(this,this.get_$8G(),n,0):_d.$7S.prototype.$2he.call(this,n)},$52A:function(){if(!this.$OX)return _d.$7S.prototype.$52A.call(this);var n=$4Le(this);if(this.$9Q&&this.$9Q.$EA.$2K){n.set_$10(this.$9Q.get_$10());n.set_$DE(this.$9Q.get_$23().$6E(this.$9Q.get_$10()));this.$BB(this.$9Q);this.set_$2y2(null)}else{if(this.$N8){n.set_$10($2Th(this,this.get_$8G(),this.$N8.$Jm));var t=this.$1c.$6w.$5X.get_$48(this.$N8.$Jm.$He);t&&n.set_$1DK(t.get_$AC());this.set_$2Ai(null)}n.set_$DE(_a.$25.$1BD(this.$15l));n.set_$1DK(this.$1c.$CH.get_$AC())}return n},$7Hs:function(){if(this.$OX){var n=$3EV(this);n.set_$10(_a.$25.$2bn(this.get_$8G(),this.$1c.$t.get_$1t().get_$Tv().get_$1NX()));if(this.$UW){var t=this.$1c.$6w.$5X.get_$48(this.$UW.$Jm.$He);t&&n.set_$1DK(t.get_$AC())}return n}else return _d.$7S.prototype.$7Hs.call(this)},$5zd:function(n){if(!this.$OX)return _d.$7S.prototype.$5zd.call(this,n);n.set_$10($2Th(this,this.get_$8G(),this.$N8.$Jm));n.set_$23($2Th(this,this.get_$8G(),this.$N8.$1bC).$9b(_a.$25.$1BD(this.$15l)));n.set_$5Z(this.$1c.$6w.$5X.get_$48(this.$N8.$Jm.$He));return n},$8xJ:function(n){if(!this.$OX)return _d.$7S.prototype.$8xJ.call(this,n);n.set_$10(this.get_$8G());n.set_$23(this.get_$8G());n.set_$5Z(this.$1c.$6w.$5X.get_$48(this.$UW.$Jm.$He));return n},$5fk:function(n){if(this.$1c.$G.get_$O()==="TouchNarrow")_d.$1n.prototype.$5fk.call(this,n);else if(!this.$OX){this.$1c.set_$14L(n);this.$1c.$6w.$5X.get_$F()===2&&this.set_$2oR(!0)}},$30G:function(n,t){if(this.$CJ){_d.$1n.prototype.$30G.call(this,n,t);this.$ip.set_$15(!this.get_$3Om());this.set_$2oR(this.$OX&&this.get_$3Om())}},$5fp:function(n,t){$6K7(this)},$8gG:function(){this.set_$2oR(!this.$OX)}};_d.$7S=function(n,t,i,r,u){this.$$d_$5h5=Function.createDelegate(this,this.$5h5);this.$$d_$8Xn=Function.createDelegate(this,this.$8Xn);this.$$d_$8RS=Function.createDelegate(this,this.$8RS);this.$$d_$8Xj=Function.createDelegate(this,this.$8Xj);this.$$d_$757=Function.createDelegate(this,this.$757);_d.$7S.initializeBase(this,[n,!0,i,t,r,u]);var f=_a.$5.acss(_a.$0.$1o,"CalendarDayWeekBaseVM:Init");this.$BJ=new _0365f.$Ih(_d.$9p.$w6);this.$o=new _js.$X;this.$3Ro=new _C(this.$$d_$757,this.get_$1Y());this.$3yC=new _C(this.$$d_$8Xj,this.get_$1Y());this.$3xM=new _C(this.$$d_$8RS,this.get_$1Y());this.$5iC=new _C(this.$$d_$8Xn,this.get_$1Y());this.$1c.$G.get_$O()==="Mouse"&&$4Lm(this);this.$15l=$6K9(this);this.$14b=new _d.$LN(this.$HA,this.$BJ,this.$1c,u.$2f);this.$Mu=this.$14b;this.$a("DateRangeArray",this.$$d_$5h5);_a.$5.aces(f)};function $21Z(n,t,i){return $21a(n,null,t,i)}function $2Th(n,t,i){return $21a(n,t,i,0)}function $21a(n,t,i,r){t||(t=n.$14b.get_$aD()[i.$He]);$8(r)&&(r=0);var u=36e5/_a.$25.$1BD(n.$15l);var f=60/u;var e=Math.floor((i.$QS+r)/u);var o=(i.$QS+r)%u*f;return new _a.$7(t.get_$4M(),t.get_$3D(),t.get_$5z(),e,o,0)}function $6K9(n){if(n.$1c.$G.get_$O()==="TouchNarrow")return 3;if(n.$1c.$G.get_$O()==="TouchWide")return 2;switch(n.$1c.$t.get_$1t().get_$m6()){case 15:return 1;case 30:return 2}return 3}function $6K8(n){return n.$1c.$G.get_$DC()?null:new _0365m.$2c([new _0365m.$n(_u.Strings.l_NewString_LowerCase_Text,null,n.$Ya)])}function $4Ll(n,t){_js.Trace.logInfo(n.get_$1Y(),"Ignoring click on the grid: {0}",n.$1c.$1c6);n.$1c.$1c6?n.$1c.$1c6=!1:t.$2K&&t.$s()}function $4Lm(n){n.$1c.get_$1PU()&&!n.$1fL?n.set_$4f4($6K8(n)):!n.$1c.get_$1PU()&&n.$1fL&&n.set_$4f4(null)}_d.$7S.prototype={$3Ro:null,$3yC:null,$3xM:null,$5iC:null,$14b:null,$Mu:null,$1fL:null,$15l:0,$BJ:null,$o:null,$sN:!1,$N8:null,$15k:null,$UW:null,$2lM:!1,get_$7XN:function(){return this.$2lM},set_$7XN:function(n){if(n!==this.$2lM){this.$2lM=n;$6(this,"IsAllDayItemContextMenuShown")}return n},get_$bp:function(){return this.$sN},set_$bp:function(n){if(this.$sN!==n){this.$sN=n;$6(this,"IsUpdatingItems")}return n},get_$3SU:function(){return this.$Mu},set_$3SU:function(n){if(this.$Mu!==n){this.$Mu=n;$6(this,"CurrentColumnProviderViewModel")}return n},get_$4f4:function(){return this.$1fL},set_$4f4:function(n){if(this.$1fL!==n){this.$1fL=n;$6(this,"AllDayWellContextMenuViewModel")}return n},get_$ra:function(){return this.$1c.$G.get_$O()==="Mouse"?54:this.$1c.$G.get_$O()==="TouchWide"?60:52},get_$53F:function(){return this.$15l===2?this.get_$ra()/2:this.$15l===1?this.get_$ra()/4:this.get_$ra()},get_$3bD:function(){return this.$1c.$G.get_$O()==="TouchNarrow"?50:this.$1c.$G.get_$O()==="TouchWide"?63:58},get_$7Pm:function(){return $8(this.$N8)?null:this.$2he(this.$N8.$Jm)},get_$7Pk:function(){return $8(this.$UW)?null:this.$2he(this.$UW.$Jm)},get_$6Bq:function(){return this.$1c.$t.get_$1t().get_$Tv().get_$1NX()},get_$2Ai:function(){return this.$N8},set_$2Ai:function(n){if(this.$N8!==n){this.$N8=n;_d.$Fo.isInstanceOfType(this.$Mu)&&this.$1c.$6w&&this.$N8&&this.$1c.set_$14L(this.$1c.$6w.$5X.get_$48(this.$N8.$Jm.$He));$6(this,"GridSelectedRowColumnIndex")}return n},get_$53E:function(){return this.$15k},set_$53E:function(n){if(this.$15k!==n){this.$15k=n;$6(this,"GridHoveredRowColumnIndex")}return n},get_$2iZ:function(){return this.$UW},set_$2iZ:function(n){if(n&&n.$4W(this.$UW))return n;this.$UW=n;_d.$Fo.isInstanceOfType(this.$Mu)&&this.$1c.$6w&&this.$UW&&this.$1c.set_$14L(this.$1c.$6w.$5X.get_$48(this.$UW.$Jm.$He));$6(this,"GridAllDaySelectedRowColumnIndex");return n},$50g:function(){return this.$o.get_$F()+this.$BJ.get_$F()},$7L8:function(){return $2Tf(this,this.$o)+$2Tf(this,this.$BJ)},$2he:function(n){return $21a(this,this.$14b.get_$aD()[n.$He],n,0)},$3KT:function(n){var u=n.length;var e=_a.$5.acss(_a.$0.$Ag,"CalendarDayWeekBaseVM:AddItems_"+u);this.set_$bp(!0);for(var f=[],i=[],t,r=0;r<u;r++){t=n[r];this.$1bX(t)&&(t.get_$9w()?Array.add(f,t):t.get_$10().$3u().$2Y(t.get_$23().$3u())?Array.addRange(i,$1e0(this,t,this.$HA)):Array.add(i,t))}this.$BJ.$6G(f);this.$o.$6G(i);this.set_$bp(!1);_a.$5.aces(e)},$H0:function(n){var t=_a.$5.acss(_a.$0.$Ag,"CalendarDayWeekBaseVM:AddItem");n.get_$9w()?this.$BJ.$H(n):n.get_$10().$3u().$2Y(n.get_$23().$3u())?this.$o.$6G($1e0(this,n,this.$HA)):this.$o.$H(n);_a.$5.aces(t)},$BB:function(n){var t=_a.$5.acss(_a.$0.$Ag,"CalendarDayWeekBaseVM:RemoveItem");var i=n===this.$9Q&&!n.$2Q.get_$5m();n.get_$9w()&&!i?_d.$1n.$446(n,this.$BJ):_d.$1n.$446(n,this.$o);_a.$5.aces(t)},$1wp:function(){this.set_$bp(!0);this.$BJ.$1u();this.$o.$1u();_d.$1n.prototype.$1wp.call(this);this.set_$bp(!1)},$76f:function(){return this.$1c.$G.get_$DC()?null:new _0365m.$2c([new _0365m.$n(_u.Strings.l_NewString_LowerCase_Text,null,this.$4ok)])},$5gP:function(n,t){_d.$1n.prototype.$5gP.call(this,n,t);$4Lm(this)},$52A:function(){var n=_d.$1n.prototype.$52A.call(this);if(!$8(this.$9Q)&&this.$9Q.$EA.$2K){n.set_$DE(this.$9Q.get_$23().$6E(this.$9Q.get_$10()));this.$BB(this.$9Q);this.set_$2y2(null)}else{if(!$8(this.$N8)){n.set_$10($21Z(this,this.$N8.$Jm));this.set_$2Ai(null)}n.set_$DE(_a.$25.$1BD(this.$15l))}return n},$7Hs:function(){var n=$3EV(this);var t=this.get_$8G();$8(this.$UW)||this.$UW.$Jm.$He>=0&&this.$UW.$Jm.$He<this.$14b.get_$aD().length&&(t=this.$14b.get_$aD()[this.$UW.$Jm.$He]);this.$1c&&this.$1c.$CH&&n.set_$1DK(this.$1c.$CH.get_$AC());n.set_$10(_a.$25.$2bn(t,this.$1c.$t.get_$1t().get_$Tv().get_$1NX()));return n},$8xJ:function(n){var t=this.$14b.get_$aD()[this.$UW.$Jm.$He];n.set_$10(t);n.set_$23(t);n.set_$5Z(this.$1c.$CH);return n},$5zd:function(n){n.set_$10($21Z(this,this.$N8.$Jm));n.set_$23($21Z(this,this.$N8.$1bC,1));n.set_$5Z(this.$1c.$CH);return n},$7KW:function(){return this.$1c.$G.get_$O()==="Mouse"?this.$3Ro:this.$2bs},$7Hr:function(){return this.$1c.$G.get_$O()==="Mouse"?this.$3R5:this.$Ya},$5h5:function(n,t){this.$Mu&&this.$Mu.set_$aD(this.$HA);this.set_$2iZ(null);this.set_$2Ai(null)},$8Xj:function(){$4Ll(this,this.$7KW())},$8RS:function(){$4Ll(this,this.$7Hr())},$8Xn:function(){var n;(n=this.$1c).$1c6=!!(n.$1c6|this.$1c.$s7)},$757:function(){if(this.get_$4jX()){this.$1QQ=_a.$5.$1V(this.get_$1Y(),"CreateItemByNaturalInput",!0);this.$1c.set_$qu(null);var n=new _g.$1m;n.EmailAddress=this.$1c.$t.get_$38().get_$Br();n.Name=this.$1c.$t.get_$38().get_$Gz();n.MailboxType="Mailbox";var t=this.$Db.get_$3O3().$26C(n);this.set_$2y2(new _d.$jn(this.$5zd(t),new _C(this.$$d_$6pL,this.get_$1Y()),new _C(this.$$d_$7A5,this.get_$1Y())));this.$o.$H(this.$9Q)}}};_d.$jj=function(n,t,i){this.$dq=n;this.$2f=t;this.$G=i};_d.$jj.prototype={$dq:null,$2f:null,$G:null,$I:function(n,t){return n.get_$ly()===1?new _d.$jo(n,t,t.$86,this.$dq,this,this.$2f,this.$G):new _d.$9U(n,t,t.$86,this.$dq,this.$2f,this.$G)},$762:function(n){return new _d.$T1(this.$2f.get_$11Q(),n,this.$dq,this.$2f,this.$G)}};_d.$LB=function(n,t,i,r,u){this.$$d_$8TC=Function.createDelegate(this,this.$8TC);_d.$LB.initializeBase(this,[t,r]);this.$G=u;this.$BN=n;this.$UY=n.get_$Ph();this.$BN.get_$Bd().add_$1Z(this.$$d_$8TC);this.set_$lW(!0);this.set_$Bb(2);this.$dq=i};_d.$LB.prototype={$BN:null,$dq:null,$G:null,$UY:null,get_$Ph:function(){return this.$UY},set_$Ph:function(n){if(n!==this.$UY){this.$UY=n;this.$BN.set_$Ph(n);$4Z(this,"GroupName","GroupNameInUpperCase")}return n},get_$7Ps:function(){return this.$UY?this.$UY.toUpperCase():this.$UY},get_$6A7:function(){return this.$G.get_$O()==="TouchNarrow"},$8Oo:function(n,t){if(n.$Fb!==this){_d.$LB.$1zW=!0;try{var i=n.$Fb;n.set_$5n4(this);this.$BN.get_$Bd().$6z(t,n.$CF);this.$3eQ(t,n);i.$BN.get_$Bd().$3Q(n.$CF);i.$V.$3Q(n)}finally{_d.$LB.$1zW=!1}}},$3eQ:function(n,t){this.$V.$6z(n,t)},$59:function(){this.$BN.get_$Bd().remove_$1Z(this.$$d_$8TC);_d.$X7.prototype.$59.call(this)},$7Ut:function(n){n.set_$2X(this.$86.$5X.$6l(n.$CF)||this.$86.$oJ.$6l(n.$CF));n.set_$lW(this.$86.$1Gq)},$8TC:function(n,t){if(!_d.$LB.$1zW)switch(t.$3R){case 0:for(var r=0,o=t.$2t.length;r<o;r++){var s=t.$2t[r];var e=this.$dq.$I(s,this);this.$7Ut(e);this.$3eQ(t.$4T+r,e)}break;case 2:for(var f=0,h=t.$3Y.length;f<h;f++)for(var c=t.$3Y[f],u=0,l=this.$V.get_$F();u<l;u++){var i=this.$V.get_$48(u);if(i.$CF&&i.$CF.$4W(c)){i.$28P&&i.set_$2X(!1);this.$V.$67(u);i.$1M();break}}break;default:break}}};_d.$9U=function(n,t,i,r,u,f){this.$$d_$78q=Function.createDelegate(this,this.$78q);this.$$d_$78r=Function.createDelegate(this,this.$78r);this.$$d_$78R=Function.createDelegate(this,this.$78R);this.$$d_$8UO=Function.createDelegate(this,this.$8UO);this.$$d_$8UP=Function.createDelegate(this,this.$8UP);this.$$d_$8rN=Function.createDelegate(this,this.$8rN);this.$$d_$8rO=Function.createDelegate(this,this.$8rO);this.$$d_$8nq=Function.createDelegate(this,this.$8nq);this.$$d_$7Vl=Function.createDelegate(this,this.$7Vl);this.$$d_$5lY=Function.createDelegate(this,this.$5lY);this.$$d_$7VZ=Function.createDelegate(this,this.$7VZ);this.$$d_$6wC=Function.createDelegate(this,this.$6wC);this.$$d_$44M=Function.createDelegate(this,this.$44M);this.$$d_$2bi=Function.createDelegate(this,this.$2bi);this.$$d_$8TD=Function.createDelegate(this,this.$8TD);_d.$9U.initializeBase(this,[n,i,r,u,f]);this.$2Nw=t;n.get_$Bd().$a("Count",this.$$d_$8TD);this.set_$1E2(new _C(this.$$d_$2bi,_d.$9U.$D));this.set_$1L8(new _C(this.$$d_$44M,_d.$9U.$D));this.set_$2Zt(new _C(this.$$d_$6wC,_d.$9U.$D));var e=new _C(this.$$d_$7VZ,_d.$9U.$D);this.$30g=new _C(this.$$d_$5lY,_d.$9U.$D);this.$3e8=new _C(this.$$d_$7Vl,_d.$9U.$D);this.$3U4=new _C(this.$$d_$8nq,_d.$9U.$D);$4Lq(this);f.get_$DC()||this.get_$6A7()||(this.$8W=new _0365m.$2c([new _0365m.$n(_u.Strings.l_CreateCalendarContextMenuTitle_LowerCase_Text,null,e),new _0365m.$n(_u.Strings.l_OpenCalendarContextMenuTitle_LowerCase_Text,null,this.$30g),new _0365m.$9q,new _0365m.$n(_u.Strings.l_CreateCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$2Nw.$57A),new _0365m.$n(_u.Strings.l_RenameCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$3e8),new _0365m.$n(_u.Strings.l_DeleteCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$3U4)]))};function $4Lq(n){n.$3e8.set_$5P(n.$BN.get_$ly()===3);n.$3U4.set_$5P(n.$BN.get_$ly()===3&&!n.$BN.get_$Bd().get_$F())}function $3Eb(n){n.set_$RG(!1);n.set_$Bb(2)}function $6KB(n){if(!n.$86.$yT){if(!$8(n.$1ic)){n.$1ic.remove_$2A(n.$$d_$78r);n.$1ic.remove_$20(n.$$d_$78q);n.$1ic=null}var t=n.$1ic=new _c.$qZ(n.$BN);t.add_$2A(n.$$d_$78r);t.add_$20(n.$$d_$78q);n.$86.set_$Sy(!0);OwaApplication.$1T.$y(t);n.$27K=n.$2Nw.$V.$7h(n);n.$27K>=0&&n.$2Nw.$V.$67(n.$27K)}}_d.$9U.prototype={$3e8:null,$3U4:null,$30g:null,$tc:null,$2Nw:null,$1wd:null,$1ic:null,$27K:0,$1Zl:null,$59:function(){this.$BN.get_$Bd().$w("Count",this.$$d_$8TD);_d.$LB.prototype.$59.call(this)},$8TD:function(n,t){$4Lq(this)},$7Vl:function(){if(!this.$86.$yT){this.$1Zl=this.$UY;this.set_$1u5(this);this.set_$RG(!0);this.set_$Bb(4)}},$6wC:function(){this.set_$RG(!1);this.set_$Ph(this.$1Zl);this.$1Zl=null;this.set_$Bb(2)},$44M:function(){if(_js.$8.$14(this.$UY)){this.set_$Ph(this.$1Zl);this.$1Zl=null;$3Eb(this);return}if(this.$UY.trim()===this.$BN.get_$Ph()){$3Eb(this);return}if(this.$1wd){this.$1wd.remove_$2A(this.$$d_$8rO);this.$1wd.remove_$20(this.$$d_$8rN);this.$1wd=null}var n=this.$1wd=new _c.$uM(this.$BN,this.$UY);n.add_$2A(this.$$d_$8rO);n.add_$20(this.$$d_$8rN);this.$86.set_$Sy(!0);OwaApplication.$1T.$y(n);$3Eb(this)},$8rN:function(n){this.set_$Ph(this.$1Zl);this.$1Zl=null;this.$86.set_$Sy(!1);this.$1Ae(this.$1wd.get_$bO())},$8rO:function(n){this.$86.set_$Sy(!1)},$5lY:function(){this.$86.$8iL(this.$BN)},$7VZ:function(){if(!this.$86.$yT){var n=this.$dq.$I(this.$2f_4.$72u(),this);n.set_$RG(!0);n.set_$lW(!0);this.set_$1u5(this.$tc=n);this.set_$Bb(3)}},$2bi:function(){if(_js.$8.$14(this.$tc.$dp)){this.$tc.$1M();this.$tc=null;return}this.$tc.set_$RG(!1);this.$tc.set_$Bb(2);this.$86.set_$Sy(!0);this.$2f_4.$2bi(this.$BN,this.$tc.$CF,null,this.$$d_$8UP,this.$$d_$8UO);this.$V.$H(this.$tc)},$8UP:function(n){this.$1Ae(n);this.$2f_4.$BA()},$8UO:function(){this.$V.$3Q(this.$tc);this.$tc.$1M();this.$tc=null;this.$86.set_$Sy(!1)},$8nq:function(){this.$1r.$3A(2,_u.Strings.l_DeleteCalendarGroupMessageBoxText_Text,this.$$d_$78R,!1,null,null,_u.Strings.l_DeleteCalendarGroupMessageBoxTitle_Text)},$78R:function(n,t){n&&$6KB(this)},$78q:function(n){this.$27K>=0&&this.$2Nw.$V.$6z(this.$27K,this);this.$86.set_$Sy(!1);this.$1Ae(this.$1ic.get_$bO())},$78r:function(n){this.$86.set_$Sy(!1);this.$2f_4.get_$px().$3Q(this.$BN);this.$1M()}};_d.$O0=function(n,t,i,r,u){this.$$d_$8T8=Function.createDelegate(this,this.$8T8);this.$$d_$8hP=Function.createDelegate(this,this.$8hP);_d.$O0.initializeBase(this,[n.get_$Ca(),t,i,!0]);_a.$3.$M(n,"calendar");this.$68Z=new _C(this.$$d_$8hP,_a.$0.$1o);this.$46U=r;this.$86=u;this.$Fs=n;this.$Fs.$a("CalendarName",this.$$d_$8T8)};_d.$O0.prototype={$68Z:null,$46U:null,$86:null,$Fs:null,get_$9Cf:function(){return String.format(_u.Strings.l_CalendarHeaderUnselectCalendar_Aria_Text,this.$Fs.get_$Ca())},get_$8vf:function(){return String.format(_u.Strings.l_CalendarHeaderSelectCalendar_Aria_Text,this.$Fs.get_$Ca())},$4l5:function(){this.$Fs.$w("CalendarName",this.$$d_$8T8)},$8hP:function(){this.$Fs&&this.$86.$36X(this.$Fs,!1)},$8T8:function(n,t){this.set_$1N(this.$Fs.get_$Ca())}};_d.$9p=function(){};_d.$9p.$6yy=function(n,t){var i=n;var r=t;var u=i.$6y.$2Y(r.$6y);return u?u:_d.$9p.$4lx(i,r)};_d.$9p.$w6=function(n,t){return _d.$9p.$4lx(n,t)};_d.$9p.$4lx=function(n,t){var i=t.get_$9w()-n.get_$9w();if(i)return i;i=_d.$9p.$50Y(t)-_d.$9p.$50Y(n);if(i)return i;i=n.get_$10().$6E(t.get_$10());if(i)return i;i=(n.get_$5Z()&&n.get_$5Z().get_$2Cu()?0:1)-(t.get_$5Z()&&t.get_$5Z().get_$2Cu()?0:1);if(i)return i;i=_d.$9p.$5IE(n.get_$92())-_d.$9p.$5IE(t.get_$92());if(i)return i;i=t.get_$23().$6E(n.get_$23());return i?i:_d.$9p.$6zA(n,t)};_d.$9p.$6zA=function(n,t){return $8(n.get_$2h())?$8(t.get_$2h())?0:1:$8(t.get_$2h())?-1:n.get_$2h().localeCompare(t.get_$2h())};_d.$9p.$5IE=function(n){switch(n){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}};_d.$9p.$50Y=function(n){var t=n.get_$23().$6E(n.get_$10());return t>864e5?Math.ceil(t/864e5):1};_d.$It=function(n,t,i,r){_d.$It.initializeBase(this);n&&t&&i&&n.$r.get_$b2()&&(r===4?$6Ko(this,t,i):(r===1||r===2||r===3)&&$6Kn(this,n,t,i,r))};_d.$It.$73W=function(){return new _d.$It(null,null,null,0)};_d.$It.$I=function(n,t,i,r){return new _d.$It(n,t,i,r)};function $6Ko(n,t,i){if(t.get_$9w()){n.$2a8=i.$hX(t.get_$10(),!0,!0);n.$2a9=i.$hX(t.get_$23(),!0,!0)}}function $6Kn(n,t,i,r,u){if(_d.$Jw.isInstanceOfType(i)){n.$3Oj=!t.$r.get_$10().$2Y(i.get_$10());n.$3Oi=!t.$r.get_$23().$2Y(i.get_$23());n.$2a8=!1;n.$2a9=!1}else{n.$3Oj=!t.$r.get_$9w();n.$3Oi=!t.$r.get_$9w();n.$2a8=u!==1&&t.$r.get_$9w()&&r.$hX(i.get_$10(),!0,!0);n.$2a9=u!==1&&t.$r.get_$9w()&&r.$hX(i.get_$23(),!0,!0)}}_d.$It.prototype={$3Oj:!1,$3Oi:!1,$2a8:!1,$2a9:!1,get_$6wm:function(){return this.$3Oj},get_$6wj:function(){return this.$3Oi},get_$6wk:function(){return this.$2a8},get_$6wl:function(){return this.$2a9}};_d.$pv=function(){this.$o=[]};_d.$pv.prototype={$7T:null,$9f:null,$o:null,$H:function(n){_a.$3.$M(n,"item");(!this.$o.length||n.get_$10().$2Y(this.$7T)<0)&&(this.$7T=n.get_$10().$46());(!this.$o.length||n.get_$23().$2Y(this.$9f)>0)&&(this.$9f=n.get_$23().$46());this.$6qH(n)},$3Q:function(n){_a.$3.$M(n,"item");if(!Array.remove(this.$o,n))throw Error.invalidOperation("Failed to remove ICalendarSurfaceItem object from group");},$6qH:function(n){Array.add(this.$o,n)}};_d.$3Q=function(n,t){this.$$d_$4Fy=Function.createDelegate(this,this.$4Fy);this.$$d_$8a9=Function.createDelegate(this,this.$8a9);this.$$d_$5jI=Function.createDelegate(this,this.$5jI);this.$$d_$3bB=Function.createDelegate(this,this.$3bB);this.$$d_$61t=Function.createDelegate(this,this.$61t);this.$$d_$92B=Function.createDelegate(this,this.$92B);this.$$d_$30G=Function.createDelegate(this,this.$30G);this.$$d_$5gu=Function.createDelegate(this,this.$5gu);this.$$d_$49l=Function.createDelegate(this,this.$49l);this.$$d_$94h=Function.createDelegate(this,this.$94h);this.$$d_$5lP=Function.createDelegate(this,this.$5lP);this.$$d_$8hh=Function.createDelegate(this,this.$8hh);this.$$d_$2Ps=Function.createDelegate(this,this.$2Ps);_d.$3Q.initializeBase(this);var r=_a.$5.acss(_a.$0.$1o,"CalendarLayoutVM:Init");this.$6d=t;this.$dn=n;this.$vh=new _js.$X;this.$24g={};this.$2qp=new _y.$F8;this.$Xt=new _C(this.$$d_$2Ps,_d.$3Q.$D);this.$20x=new _C(this.$$d_$8hh,_a.$0.$1o);this.$1NQ=new _C(this.$$d_$5lP,_a.$0.$1o);if(this.$6d.$G.get_$O()!=="TouchNarrow"){this.$1Am=new _C(this.$$d_$94h,_d.$3Q.$D);this.$1Al=new _C(this.$$d_$49l,_d.$3Q.$D);this.$1gi=new _js.$X;this.$hJ=new _js.$X;this.$6d.$a("CurrentCalendarModel",this.$$d_$5gu);var i=this.$6d.$6w.$5X;i.add_$1Z(this.$$d_$30G);i.get_$F()>0&&$4M9(this,i.$7V())}else this.$48z=new _C(this.$$d_$92B,_d.$3Q.$D);this.$11f=new _C(this.$$d_$61t,_d.$3Q.$D);this.$i8=new _C(this.$$d_$3bB,_d.$3Q.$D);this.$2u=_a.$7.get_$2M();if(this.$6d.$G.get_$O()!=="Mouse"){this.set_$7E(_y.$26.$Bv(this,null,null));this.$3t.set_$2Px(!0)}_a.$5.aces(r)};function $1Bw(n,t){n.$6Ay=t;n.$Hu?$6Ku(n,n.$Hu.get_$1Q(),t):$4MA(n,t)}function $4MA(n,t){n.$6d.set_$qu(null);var i=null;var r=!1;if(t in n.$24g)i=n.$24g[t];else{switch(t){case"DayViewModel":i=n.$dn.$4o7(n.$2u,n.$6d);break;case"WorkWeekViewModel":i=n.$dn.$4pY(n.$2u,n.$6d.$G.get_$O()==="Mouse"?n.$Xt:null,n.$6d);break;case"WeekViewModel":i=n.$dn.$4pU(n.$2u,n.$6d.$G.get_$O()==="Mouse"?n.$Xt:null,n.$6d);break;case"MonthAgendaViewModel":i=n.$dn.$4oy(n.$2u,!0,n.$Xt,n.$6d);r=!0;break;case"AgendaViewModel":i=n.$dn.$3R4(n.$2u,n.$6d);break;default:break}n.$24g[t]=i}var u=n.$Hu?n.$Hu.get_$1Q():null;n.set_$D1(i);n.get_$D1().set_$IQ(n.$qI);r&&n.get_$D1().set_$ZD(n.$Dm);var f=this;_js.$K.get_$L().$3i(_a.$0.$1o,"CalendarLayoutViewModel",function(){$6Kt(n,u,i.get_$1Q())})}function $6Ku(n,t,i){var r=n.$eX("ViewChanging");r&&r(t,n.$$d_$4Fy)}function $6Kt(n,t,i){var r=n.$eX("ViewChanged");r&&r(t,i)}function $vE(n,t,i){i===undefined&&(i=!0);_a.$5.stPT(_a.$0.$1o,"SwitchCalendarView",3);n.set_$IQ(_d.$8W.$I(_a.$0.$1o,t,!0,i))}function $6Kv(n){n.get_$3mn()&&(_d.$EZ.isInstanceOfType(n.get_$D1())?n.get_$3mn().set_$15(!n.get_$D1().get_$3Om()):n.get_$3mn().set_$15(!0))}function $6Kx(n){_d.$8o.isInstanceOfType(n.$Hu)?n.set_$1ce(2):_d.$MW.isInstanceOfType(n.$Hu)?n.set_$1ce(3):n.set_$1ce(1)}function $6Ks(n,t){if(!n.$6d.$G.get_$DC()){n.$8xc(t);_h.$2x.$1Q2(n.$6d.$t.get_$4r().get_$Tq(),OwaApplication.$1T)}}function $4M9(n,t){for(var r=t.length,i=0;i<r;i++)$6Kr(n,t[i]);$Ha(n,_d.$3Q.$3xY)}function $6Kr(n,t){var i=null;var u=this;var r=new _C(function(){n.set_$35t(i)},_d.$3Q.$D);i=n.$72v(t,r);n.$hJ.$H(i)}function $6Kw(n,t){var i=n.$hJ.get_$48(t);i.$4l5();n.$hJ.$67(t);$Ha(n,_d.$3Q.$3xY)}_d.$3Q.prototype={$dn:null,$6d:null,$2qp:null,$Xt:null,$48z:null,$1Am:null,$1Al:null,$11f:null,$i8:null,$20x:null,$1NQ:null,$24g:null,$vh:null,$Hu:null,$2u:null,$aW:0,$4fU:null,$6Ay:null,$1gi:null,$hJ:null,$uU:null,$ip:null,$qI:null,add_$4G2:function(n){this.$2Z("ViewChanging",n)},remove_$4G2:function(n){this.$2b("ViewChanging",n)},add_$4G0:function(n){this.$2Z("ViewChanged",n)},remove_$4G0:function(n){this.$2b("ViewChanged",n)},add_$2eK:function(n){this.$2Z("DisplayedDateChanging",n)},remove_$2eK:function(n){this.$2b("DisplayedDateChanging",n)},get_$30c:function(){return this.$20x},get_$30e:function(){return this.$1NQ},get_$Jr:function(){return this.$6d.$G.get_$O()!=="Mouse"?_y.$1De.prototype.get_$Jr.call(this):0},get_$4fN:function(){return!0},get_$D1:function(){return this.$Hu},set_$D1:function(n){if(this.$Hu!==n){var i=_a.$5.acss(_a.$0.$1o,"MainVM_"+n.get_$1Q());var t=null;if(this.$Hu){this.$Hu.remove_$8C(this.$$d_$5jI);this.$Hu.remove_$2eK(this.$$d_$8a9);this.$Hu.set_$G5(!1);t=this.get_$D1().get_$8G();this.get_$D1().set_$AB(t);this.$Hu.set_$IQ(null)}this.$Hu=n;$6Ks(this,this.$Hu.get_$1DO());this.$6d.$G.get_$O()!=="TouchNarrow"&&$6Kv(this);this.$vh.$6l(n)||this.$vh.$H(n);if(t){this.get_$D1().set_$AB(t);this.get_$D1().set_$8G(t)}this.$Hu.add_$8C(this.$$d_$5jI);this.$Hu.add_$2eK(this.$$d_$8a9);$6Kx(this);this.$2u=n.get_$8G();this.$Hu.set_$G5(!0);$6(this,"MainViewModel");this.$2qp.$MZ(n);_a.$5.aces(i)}return n},$8a9:function(n,t){var i=this.$eX("DisplayedDateChanging");i?i(n,t):t()},get_$1ce:function(){return this.$aW},set_$1ce:function(n){if(n!==this.$aW){this.$aW=n;$4Z(this,"TimeStripMode","DisplayedDateString")}return n},get_$Ba:function(){return this.$2u},set_$Ba:function(n){this.$2u.$4W(n)||this.get_$D1().set_$8G(n);return n},get_$4tL:function(){if($8(this.get_$D1())||$8(this.get_$D1().get_$AB()))return"";var n;var t=this.get_$D1().get_$AB();switch(this.$aW){case 1:n=t.$2P(3);break;case 2:n=t.$2P(2);break;case 3:var i=_a.$7.$Kn(t);var r=i.$2q(6);n=_a.$7.$2AA(i,r);break;default:throw Error.notImplemented("Unexpected TimeStrip mode");}if(this.$6d.$G.get_$O()==="Mouse"&&_d.$MW.isInstanceOfType(this.get_$D1())&&this.$6d.$t.get_$1t().get_$38L()){var u=_a.$7.$Kn(t).$2q(6);return _js.$8.$4C(_u.Strings.l_CalendarHeaderWeekNumbers_Text,n,_a.$7.$3b7(u))}return n},get_$IQ:function(){return this.$qI},set_$IQ:function(n){this.$qI=n;this.get_$D1()&&this.get_$D1().set_$IQ(n);return n},get_$35t:function(){return this.$uU},set_$35t:function(n){if(this.$uU!==n){this.$uU&&this.$uU.set_$2X(!1);this.$uU=n;if(this.$uU){this.$uU.set_$2X(!0);this.$6d.set_$14L(this.$uU.$Fs)}$6(this,"SelectedCalendarHeaderItem")}return n},get_$3mn:function(){if(!this.$ip&&_d.$EZ.isInstanceOfType(this.get_$D1())){this.$ip=this.get_$D1().$ip;this.$1gi.$6z(0,this.$ip)}return this.$ip},$22s:function(){this.$6d.$2f.$1FT();this.$6d.set_$14L(this.$6d.$6w.$5X.get_$48(0));this.$4fU=this.$6d.$G.get_$DC()?String.format(_u.Strings.l_AnonymousCalendarDisplayNameFormat_Text,this.$6d.$6w.$5X.get_$48(0).get_$Ca(),this.$6d.$t.get_$38().get_$Gz()):null},$2Ps:function(){$1Bw(this,"DayViewModel")},$92B:function(){throw Error.notImplemented();},$94h:function(){throw Error.notImplemented();},$49l:function(){throw Error.notImplemented();},$61t:function(){throw Error.notImplemented();},$9DY:function(n,t){throw Error.notImplemented();},$3bB:function(){if(this.$Hu&&this.$Hu.$i8.$2K){this.$Hu.$i8.$s();this.$Hu.get_$1DO()!==3||_a.$25.$2Cs(this.$Hu.$HA,this.$Hu.get_$8G())||this.$49l()}},$4Fy:function(){$4MA(this,this.$6Ay)},$5jI:function(n,t){if(t==="VMSelectedDate"){this.$2u=this.$Hu.get_$8G();$6(this,"SelectedDate")}else t==="DisplayedDate"&&$6(this,"DisplayedDateString");$6(this,t)},$8hh:function(){_js.Trace.logInfo(_a.$0.$1o,"CalendarLayoutViewModel activated");this.$Hu&&this.$Hu.set_$37C(!0)},$5lP:function(){_js.Trace.logInfo(_a.$0.$1o,"CalendarLayoutViewModel deactivated");this.$Hu&&this.$Hu.set_$37C(!1)},$49Z:function(n){switch(n){case 1:this.$2PC(1);break;case 3:this.$6d.$G.get_$DC()?this.$2PC(2):this.$2PC(3);break;case 2:this.$2PC(2);break;case 4:this.$2PC(4);break;default:throw Error.argumentOutOfRange("viewType");}},$4Ag:function(){var n=null;var t=!0;switch(this.get_$8m1()){case 1:n="NavigateToCalendarDay";break;case 4:n="NavigateToCalendarMonth";break;case 2:n="NavigateToCalendarWeek";break;case 3:n="NavigateToCalendarWorkWeek";break;case 5:n="NavigateToCalendarAgenda";t=!1;break}n&&this.set_$IQ(_d.$8W.$I(_a.$0.$1o,n,!0,t))},$72v:function(n,t){return new _d.$O0(n,null,null,t,this.$6d.$6w)},get_$4iw:function(){return!this.$6d.$6w.$5X.get_$F()||this.$6d.$6w.$5X.get_$F()===1&&this.$6d.$6w.$5X.get_$48(0).get_$2Cu()},$30G:function(n,t){switch(t.$3R){case 0:$4M9(this,t.$2t);break;case 2:$6Kw(this,t.$4T);break;default:throw Error.notImplemented();}},$5gu:function(n,t){$4Z(this,"CanShareCalendar","CanPrint");if(this.$6d.$CH)for(var i,r=0,u=this.$hJ.get_$F();r<u;r++){i=this.$hJ.get_$48(r);if(this.$6d.$CH.$4W(i.$Fs)){this.set_$35t(i);return}}}};_d.$Iw=function(n,t){this.$$d_$4uk=Function.createDelegate(this,this.$4uk);this.$$d_$8b3=Function.createDelegate(this,this.$8b3);this.$Le=new _y.$F8;_d.$Iw.initializeBase(this);this.$Kb=n;this.$4ip=t};_d.$Iw.prototype={$Kb:null,$4ip:null,$Yg:null,add_$4vF:function(n){this.$2Z("EventSearchEnded",n)},remove_$4vF:function(n){this.$2b("EventSearchEnded",n)},$3v:function(){this.$Le.$B9(this.$Kb)},$70t:function(n){this.set_$4q7(n)},$4uk:function(){this.set_$4q7(null)},get_$26n:function(){return this.$Le.get_$7L()},get_$3w5:function(){return this.$Le.get_$8H()},get_$4q7:function(){return this.$Yg},set_$4q7:function(n){if(this.$Yg===n)return n;this.$Yg=n;var t=ICalendarEventSearchViewModel.isInstanceOfType(this.get_$26n())?this.get_$26n():null;t&&t.set_$MU(n);if(!n&&t){this.$Le.$BX();$dX(this,"EventSearchEnded");return n}n&&!t&&this.$4ip.$I(this.$$d_$8b3);return n},$8b3:function(n){if(!this.$Yg){_js.Trace.logInfo(_d.$Iw.$1Y,"Event Search factory was loaded but search context was not set.");return}n.set_$MU(this.$Yg);n.set_$6yW(new _C(this.$$d_$4uk,_d.$Iw.$1Y));this.$Le.$B9(n)}};_d.$HD=function(n){this.$2ih=n};_d.$HD.prototype={$2ih:0};_d.$jn=function(n,t,i){_d.$jn.initializeBase(this,[n]);this.$EA=t;this.$Wg=i};_d.$jn.prototype={$EA:null,$Wg:null};_d.$ep=function(){};_d.$jo=function(n,t,i,r,u,f,e){this.$$d_$8et=Function.createDelegate(this,this.$8et);_d.$jo.initializeBase(this,[n,t,i,r,f,e]);this.$1DJ=u;this.$2ON=this.$2f_4.get_$11Q().get_$Bd();this.$2ON.$a("Count",this.$$d_$8et)};function $6LB(n){if(n.$2ON.get_$F()){if(!n.$2OO){var t=n.$2OO=n.$1DJ.$762(n.$86);n.$V.$6z(0,t)}}else if(n.$2OO){n.$V.$67(0);n.$2OO.$1M();n.$2OO=null}}_d.$jo.prototype={$2ON:null,$1DJ:null,$2OO:null,$3eQ:function(n,t){var i=n;this.$2ON.get_$F()&&(i+=1);_d.$LB.prototype.$3eQ.call(this,i,t)},$59:function(){this.$2ON.$w("Count",this.$$d_$8et);_d.$9U.prototype.$59.call(this)},$8et:function(n,t){$6LB(this)}};_d.$jp=function(n,t,i){this.$2f=i;this.$1DJ=n;this.$dq=t};_d.$jp.prototype={$2f:null,$1DJ:null,$dq:null,$8M:function(n,t){return new _d.$wx(n,this.$1DJ,this.$2f,t)},$I:function(n,t,i){for(var u=this.$8M(n,t),r,f=null,e,h,o=0,c=t.get_$F();o<c;o++){r=t.get_$48(o);if(!r){_js.Trace.logError(_a.$0.$Kc,"Undefined calendar group in calendar groups collection.");continue}if(r.get_$8X()!=="12B353D3-3078-4E85-875B-F905CCB65E9B"&&!_c.$1S.$5BW(r)){f=this.$1DJ.$I(r,u);for(var s=0,l=r.get_$Bd().get_$F();s<l;s++){h=r.get_$Bd().get_$48(s);e=this.$dq.$I(h,f);i&&i(e);f.$V.$H(e)}u.$V.$H(f)}}u.$V.get_$F()||_js.Trace.logInfo(_a.$0.$Kc,"The created calendar tree is empty.");return u}};_d.$wx=function(n,t,i,r){this.$$d_$8UQ=Function.createDelegate(this,this.$8UQ);this.$$d_$8UR=Function.createDelegate(this,this.$8UR);this.$$d_$8T4=Function.createDelegate(this,this.$8T4);this.$$d_$2bj=Function.createDelegate(this,this.$2bj);this.$$d_$7Va=Function.createDelegate(this,this.$7Va);_d.$wx.initializeBase(this,[n,i]);this.$1DJ=t;this.$57A=new _C(this.$$d_$7Va,_a.$0.$1o);this.set_$1E2(new _C(this.$$d_$2bj,_a.$0.$1o));this.$24n=r;this.$24n&&this.$24n.add_$1Z(this.$$d_$8T4)};_d.$wx.prototype={$1DJ:null,$24n:null,$57A:null,$18j:null,$59:function(){this.$24n&&this.$24n.remove_$1Z(this.$$d_$8T4);_d.$X7.prototype.$59.call(this)},$8T4:function(n,t){switch(t.$3R){case 0:for(var r=0,s=t.$2t.length;r<s;r++){var f=t.$2t[r];if(!_c.$1S.$5BW(f)){var u=this.$1DJ.$I(f,this);u.set_$lW(!0);u.set_$RG(!1);u.set_$Bb(2);_js.Trace.logInfo(_a.$0.$Kc,"Handling calendar group added event - Group:{0}",f.get_$Ph());this.$V.$6z(t.$4T+r,u)}}break;case 2:for(var e=0,h=t.$3Y.length;e<h;e++){var o=t.$3Y[e];_js.Trace.logInfo(_a.$0.$Kc,"Handling calendar group removed event - Group:{0}",o.get_$Ph());for(var i=0,c=this.$V.get_$F();i<c;i++){var l=this.$V.get_$48(i);if(l.$BN.get_$8X()===o.get_$8X()){_js.Trace.logInfo(_a.$0.$Kc,"Calendar group '{0}' found at index {1}",o.get_$Ph(),i);this.$V.$67(i);break}}}break;default:break}},$7Va:function(){if(this.$86.$yT){_js.Trace.logInfo(_a.$0.$Kc,"InitiateCreateCalendarGroup: Action ignored as we are currently waiting for an action to complete.");return}var n=this.$18j=this.$1DJ.$I(this.$2f_4.$74z(),this);n.set_$RG(!0);n.set_$lW(!0);this.set_$1u5(n);this.set_$Bb(3)},$2bj:function(){if(_js.$8.$14(this.$18j.$UY)){_js.Trace.logInfo(_a.$0.$Kc,"CreateCalendarGroup: Action cancelled because group name is null or empty.");return}this.$18j.set_$RG(!1);this.$18j.set_$Bb(2);this.$86.set_$Sy(!0);this.$2f_4.$2bj(this.$18j.$BN,null,this.$$d_$8UR,this.$$d_$8UQ);this.$V.$H(this.$18j)},$8UQ:function(){this.$V.$3Q(this.$18j);this.$18j.$1M();this.$18j=null;this.$86.set_$Sy(!1)},$8UR:function(n){this.$1Ae(n)}};_d.$X7=function(n,t){this.$$d_$1Ae=Function.createDelegate(this,this.$1Ae);this.$$d_$8Z3=Function.createDelegate(this,this.$8Z3);_d.$X7.initializeBase(this);_a.$3.$M(n,"parentCalendarPicker");this.$V=new _js.$X;this.$86=n;this.$2f_4=t;this.$1r=n.$1r;this.$86.$a("IsWaitingForCalendarAction",this.$$d_$8Z3)};_d.$X7.prototype={$2f_4:null,$dr:null,$uB:null,$qn:null,$11j:null,$AL:0,$V:null,$3G:!1,$we:!1,$mQ:!1,$1JW:null,$1r:null,$8W:null,$86:null,get_$RG:function(){return this.$mQ},set_$RG:function(n){if(n!==this.$mQ){this.$mQ=n;$4Z(this,"IsEdit","IsContextMenuEnabled")}return n},get_$Ua:function(){return this.$V.get_$F()>0},get_$2X:function(){return this.$3G},set_$2X:function(n){if(this.$3G!==n){this.$3G=n;$6(this,"IsSelected")}return n},get_$lW:function(){return this.$we},set_$lW:function(n){if(n!==this.$we){this.$we=n;$6(this,"DisableSelection")}return n},get_$Bb:function(){return this.$AL},set_$Bb:function(n){if(n!==this.$AL){this.$AL=n;$6(this,"TreeNodeMode")}return n},get_$1u5:function(){return this.$1JW},set_$1u5:function(n){if(n!==this.$1JW){this.$1JW=n;$6(this,"NewNodeViewModel")}return n},get_$1E2:function(){return this.$qn},set_$1E2:function(n){if(n!==this.$qn){this.$qn=n;$6(this,"CreateCommand")}return n},get_$1L8:function(){return this.$uB},set_$1L8:function(n){if(n!==this.$uB){this.$uB=n;$6(this,"RenameCommand")}return n},get_$2Zt:function(){return this.$dr},set_$2Zt:function(n){if(n!==this.$dr){this.$dr=n;$6(this,"CancelRenameCommand")}return n},get_$94e:function(){return this.$11j},set_$94e:function(n){if(n!==this.$11j){this.$11j=n;$6(this,"ShowWarningMessageCommand")}return n},get_$7YG:function(){return!this.$mQ&&!this.$86.$yT},$1Ry:function(n){for(var i=null,r=0,u=this.$V.get_$F();r<u;r++){var t=this.$V.get_$48(r);_d.$LB.isInstanceOfType(t)?i=t.$1Ry(n):_d.$8X.isInstanceOfType(t)&&t.$CF.$4W(n)&&(i=t);if(i)break}return i},$1Ae:function(n){this.$1r.$3A(0,n,null,!1,null,null,_u.Strings.l_CalendarActionErrorDialogTitle_Text)},$59:function(){this.$86.$w("IsWaitingForCalendarAction",this.$$d_$8Z3);if(this.$V)for(var n=0,t=this.$V.get_$F();n<t;n++)this.$V.get_$48(n).$1M();_a.$1.prototype.$59.call(this)},$8Z3:function(n,t){$6(this,"IsContextMenuEnabled")}};_d.$7y=function(n,t,i,r,u,f,e,o,s){this.$$d_$8hO=Function.createDelegate(this,this.$8hO);this.$$d_$4eT=Function.createDelegate(this,this.$4eT);this.$$d_$3xW=Function.createDelegate(this,this.$3xW);this.$$d_$8fJ=Function.createDelegate(this,this.$8fJ);this.$$d_$3z1=Function.createDelegate(this,this.$3z1);this.$3Pl=new _c.$jh;_d.$7y.initializeBase(this);var l=_a.$5.acss(_a.$0.$1o,"CalendarPickerViewModel:Init");this.$2rA=e;this.$t=u;this.$p=f;this.$G=t;this.$3O9=n;this.$2f=i;this.$64g=r;this.$3O8=o;this.$P1=new _js.$X;this.$P1.add_$1Z(this.$$d_$3z1);this.$P1.$a("Count",this.$$d_$8fJ);this.$oJ=new _js.$X;this.$1r=new _y.$4p;this.$5X=new _js.$X;t.get_$O()!=="Mouse"&&this.set_$7E(_y.$26.$I(this));if(this.$3O8){var h=this;o.$I(function(n){h.$b0=n;h.$b0.$7Ds(function(){h.$3xW(h.$2f)})})}if(s){var c=this;s.$I(function(n){c.$3L5=n;$6(c,"AllModernGroupsViewModel")})}this.$2f.add_$2ZS(this.$$d_$3xW);this.$3xW(this.$2f);_a.$5.aces(l)};function $3Eg(n,t,i,r){var u=i.$7h(t.$CF.get_$i().Id);u>-1&&(r[u]=t)}function $4MG(n){n.set_$2OU(new(_a.$U.$$(String))(n.get_$2OU().$7V()));n.$G.get_$DC()||_h.$2x.$1Q2(n.$t.get_$4r().get_$Tq(),n.$p)}function $3Ef(n,t){n.get_$2OU().$H(t.get_$i().Id);$4MG(n)}function $4MF(n){if(n.$1EV){var t=n.$P1.get_$F();t?t===1&&n.$P1.get_$48(0)===n.$1EV?n.$1EV.set_$lW(!0):t>1&&n.$1EV.set_$lW(!1):n.$1EV.set_$2X(!0);t>=n.$2rA?n.set_$3hS(!0):n.set_$3hS(!1)}}_d.$7y.prototype={$1r:null,$3O9:null,$64g:null,$t:null,$p:null,$G:null,$2rA:0,$1EV:null,$P1:null,$39R:null,$Bn:null,$5X:null,$QR:null,$2Ak:null,$1Gq:!1,$yT:!1,$2f:null,$oJ:null,$3O8:null,$b0:null,$3L5:null,get_$gW:function(){return this.$Bn},set_$gW:function(n){if(this.$Bn!==n){this.$Bn=n;$6(this,"SelectedTreeNode")}return n},get_$64f:function(){return this.$39R},set_$64f:function(n){if(n!==this.$39R){this.$39R=n;$6(this,"SubscribeCalendarViewModel")}return n},get_$MY:function(){return 3},get_$Sy:function(){return this.$yT},set_$Sy:function(n){if(n!==this.$yT){this.$yT=n;$6(this,"IsWaitingForCalendarAction")}return n},get_$2Nx:function(){return this.$QR},set_$2Nx:function(n){if(n!==this.$QR){this.$QR=n;$6(this,"RootTreeNode")}return n},get_$7Pw:function(){return this.$2Ak},set_$7Pw:function(n){if(n!==this.$2Ak){this.$2Ak=n;$6(this,"GroupsRootTreeNode")}return n},get_$3hS:function(){return this.$1Gq},set_$3hS:function(n){if(n!==this.$1Gq){this.$1Gq=n;$6(this,"IsMaxNumberOfCalendarsSelected")}return n},get_$Jr:function(){return this.$G.get_$O()!=="Mouse"?1:0},get_$4rC:function(){return this.$1EV},set_$4rC:function(n){if(this.$1EV!==n){this.$1EV=n;$4MF(this)}return n},get_$2OU:function(){switch(this.$G.get_$O()){case"Mouse":return this.$t.get_$4r().get_$5xC();case"TouchWide":return this.$t.get_$4r().get_$5xE();default:return this.$t.get_$4r().get_$5xD()}},set_$2OU:function(n){switch(this.$G.get_$O()){case"Mouse":this.$t.get_$4r().set_$5xC(n);break;case"TouchWide":this.$t.get_$4r().set_$5xE(n);break;default:this.$t.get_$4r().set_$5xD(n);break}return n},$8iL:function(n){var t=this.set_$64f(this.$64g.$I(n,this));var i=this;t.set_$GT(new _C(function(){i.set_$64f(null);t.$2le?t.$a("IsCacheReloadPending",function(n,t){n.$1M()}):t.$1M()},_a.$0.$Kc));t.set_$1X(!0)},$36X:function(n,t){var i=null;if(t)i=this.$QR.$1Ry(n);else for(var r=0,f=this.$P1.get_$F();r<f;r++){var u=this.$P1.get_$48(r);if(u.$CF.$4W(n)){i=u;break}}i?this.$47g(i,t):_js.Trace.logWarning(_a.$0.$1o,"couldnt find calendar {0} on the CalendarPicker and select it.",n.get_$Ca())},$47g:function(n,t){if(t&&this.$1Gq){_js.Trace.logInfo(_a.$0.$Kc,"Unable to select calendar as the maximum number of selected calendar has already been reached.");return}n.set_$2X(t);var i=this.$P1.$6l(n);!i&&t?this.$P1.$H(n):i&&!t&&this.$P1.$3Q(n)},$4uu:function(n){if(n){var t=_g.$9b.$3SH(n,n,!0);if(this.$b0&&this.$b0.get_$Hn()){var i=this.$b0.$3Xm(t);if(i){this.$47g(i,!0);return}}$3Ef(this,t)}},$8v5:function(n){var t=this.$b0.$3Xm(n);if(t)return t;var i=n;this.$2f.$3KD(n,this.$2f.get_$1dH());return this.$b0.$3Xm(n)},$8kv:function(n){var t=n.$CF;if(!t.get_$bi()){_js.Trace.logError(_a.$0.$Kc,"Calendar is not a modern groups calendar at PinGroupCalendar: {0}",t.get_$Ca());return}this.$b0.$2M6(t.get_$DQ())},$5sp:function(n){var t=n.$CF;_d.$T1.isInstanceOfType(n.$Fb)?this.$2f.$5sp(t,this.$2f.get_$11Q()):n.$Fb.$BN===this.$2f.get_$1Za()&&this.$b0.$3BQ(t.get_$DQ())},$3xW:function(n){if(this.$2f.get_$Hn()&&(!this.$3O8||this.$b0&&this.$b0.get_$Hn())){if(this.$QR){this.$QR.$1M();this.set_$4rC(null);this.set_$3hS(!1)}var i=null;var t=this.get_$2OU();var o=0;t&&(o=t.get_$F());var r=new Array(o);var c=this;var s=this.$3O9.$I(this,this.$2f.get_$px(),function(u){!i&&_g.$Di.isInstanceOfType(u.$CF)&&u.$CF.get_$2Ct()&&(i=u);t&&n.$4kR(u.$CF.get_$AC())&&$3Eg(c,u,t,r)});if(this.$b0){var l=this;this.$b0.$8lf(s,function(n){$3Eg(l,n,t,r)});var h=this.$3O9.$8M(this,null);var a=this;this.$b0.$8lS(h,function(n){$3Eg(a,n,t,r)});this.$2f.get_$px().$6G([this.$2f.get_$1Za(),this.$2f.get_$1V1(),this.$2f.get_$1dH()]);this.set_$7Pw(h)}this.set_$2Nx(s);if(!i)throw Error.create("DefaultCalendarNode not found in calendars response.");this.$P1.$1u();t&&t.$1u();for(var u,e=0,f=0;f<r.length;f++){u=r[f];if(!u){_js.Trace.logWarning(_a.$0.$Kc,"Previously selected calendar at position {0} is no longer available and / or invalid.",f);continue}if(e===this.$2rA){_js.Trace.logWarning(_a.$0.$Kc,"CalendarPicker: We attempted to re-select more than the maximum number of calendars. Was the ViewState corrupted?");break}u.set_$2X(!0);this.$P1.$6l(u)||this.$P1.$H(u);e++}if(!e){i.set_$2X(!0);this.$P1.get_$F()||this.$P1.$H(i)}this.set_$4rC(i)}},$3z1:function(n,t){var u=this.get_$2OU();var r;var i;var f;switch(t.$3R){case 0:for(var e=0,s=t.$2t.length;e<s;e++){r=t.$2t[e];i=r.$CF;_js.Trace.logInfo(_a.$0.$Kc,"Calendar tree node selected: '{0}' - IsValid: {1} ItemId:{2}",r.$dp||"",r.$CF.get_$2D7()?"yes":"no",r.$CF.get_$i().Id);if(!r.$28P||this.$oJ.$6l(i)||this.$5X.$6l(i)){_js.Trace.logInfo(_a.$0.$Kc,"Selected tree node was added, but not processed. EnableSelectionTracking:{0}, IsPending: {1}, IsSelected:{2}.",r.$28P,this.$oJ.$6l(i),this.$5X.$6l(i));return}this.$oJ.$H(i);this.$3Pl.$5uX(i);if(_g.$9b.isInstanceOfType(r.$CF)){var h=i;var c=this;this.$2f.$5Gj(h,null,function(){if(!c.$2f.$2aA(i)){r.set_$lW(!0);r.set_$2X(!1);r.$11j.$2K&&r.$11j.$s()}},this.$$d_$4eT)}else this.$4eT(i);u&&!u.$6l(i.get_$i().Id)&&(i.get_$iN()&&!i.get_$bi()?i.$a("ItemId",this.$$d_$8hO):$3Ef(this,i))}break;case 2:for(var o=0,l=t.$3Y.length;o<l;o++){r=t.$3Y[o];i=r.$CF;if(!r.$28P){_js.Trace.logInfo(_a.$0.$Kc,"Selected tree node was removed but not processed. CalendarName: {0}",r.$dp);return}_js.Trace.logInfo(_a.$0.$Kc,"Calendar tree node un-selected: '{0}' - ItemId: {1}",r.$dp||"",r.$CF.get_$i().Id);f=this.$oJ.$3Q(i);f=!!(f|this.$5X.$3Q(i));this.$3Pl.$5sm(i);if(u)if(i.get_$iN()&&!i.get_$bi())i.$w("ItemId",this.$$d_$8hO);else{u.$3Q(i.get_$i().Id);$4MG(this)}}break;case 3:this.$3z1(n,new _js.$JN(2,t.$4T,null,t.$3Y));this.$3z1(n,new _js.$JN(0,t.$4T,t.$2t,null));break;case 4:this.$5X.$1u();this.$oJ.$1u();break;default:throw Error.invalidOperation("Unsupported NotifyCollectionChangedAction");}},$8hO:function(n,t){var i=n;if(!i.get_$iN()){$3Ef(this,i);i.$w("ItemId",this.$$d_$8hO)}},$4eT:function(n){_js.Trace.logInfo(_a.$0.$Kc,"Attempting to add calendar {0} to SelectedCalendars",n?n.get_$Ca()||"":"null");if(this.$oJ.$6l(n)&&this.$2f.$2aA(n)){_js.Trace.logInfo(_a.$0.$Kc,"Calendar successfully selected");this.$oJ.$3Q(n);this.$5X.$H(n)}},$8fJ:function(n,t){$4MF(this)}};_d.$T1=function(n,t,i,r,u){_d.$T1.initializeBase(this,[n,t,i,r,u]);for(var f=0,o=n.get_$Bd().get_$F();f<o;f++){var e=this.$dq.$I(n.get_$Bd().get_$48(f),this);this.$7Ut(e);this.$V.$H(e)}this.$V.$H(new _d.$Sy(t,r))};_d.$T1.prototype={$7Ut:function(n){n.set_$2X(!this.$86.$1Gq)}};_d.$I8=function(n,t,i){this.$$d_$8eJ=Function.createDelegate(this,this.$8eJ);this.$$d_$8b2=Function.createDelegate(this,this.$8b2);this.$$d_$8a8=Function.createDelegate(this,this.$8a8);this.$3CT=new _js.$X;_d.$I8.initializeBase(this);this.$Kb=n;this.$WJ=t;this.$S=t.$S;this.$G=t.$G;this.$yo=i;this.$k2=this.$Kb.get_$Ba();this.$Kb.$a("MainViewModel",this.$$d_$8a8);this.$S.$HX(_d.$ep,this.$$d_$8b2);this.$G.get_$O()!=="Mouse"&&this.$yo.get_$3w5().add_$1Z(this.$$d_$8eJ)};function $6LQ(n){if(!_d.$3Q.isInstanceOfType(n.get_$772())||!n.$94){_js.Trace.logInfo(_d.$I8.$1Y,"Module visibility changed but no action was taken. IsVisible: {0}",n.$94);return}n.$Kb.get_$D1()&&n.$Kb.get_$D1().$b7();n.$94&&!n.$G.get_$3jW()&&n.$Kb.$3bB()}function $6LR(n){n.set_$7E(_y.$KK.isInstanceOfType(n.$yo.get_$26n())?n.$yo.get_$26n().get_$7E():null)}_d.$I8.prototype={$Kb:null,$yo:null,$WJ:null,$S:null,$G:null,$k2:null,$94:!1,get_$772:function(){return this.$yo.get_$26n()},get_$5Hw:function(){return this.$yo.get_$3w5()},get_$1yp:function(){return this.$k2},set_$1yp:function(n){if(n!==this.$k2){this.$k2=n;$6(this,"SidePanelDisplayedDate")}return n},get_$24s:function(){return this.$Kb.get_$D1()},get_$CM:function(){return this.$94},set_$CM:function(n){if(this.$94!==n){this.$94=n;$6LQ(this)}return n},$3v:function(){this.$3CT.$H(this.$Kb);this.$yo.$3v();this.$Kb.$22s()},$6sh:function(n){switch(n.$WL){case 2:this.$Kb.$61t();break;case 1:this.$Kb.$49l();break;case 0:this.$Kb.$2Ps();break}this.$Kb.get_$D1().set_$8G(n.$164)},$8nE:function(n){_c.$Dt.$8nD(n,this.$Kb)},$5lc:function(){this.$Kb.get_$D1().$3Re.$2K&&this.$Kb.get_$D1().$3Re.$s()},$59:function(){this.$S.$12Z(_d.$ep,this.$$d_$8b2);this.$yo.get_$3w5().remove_$1Z(this.$$d_$8eJ);_a.$1.prototype.$59.call(this)},$8a8:function(n,t){$6(this,"CalendarViewModel")},$8b2:function(n){this.set_$1yp(this.$Kb.get_$Ba())},$8eJ:function(n,t){$6LR(this)}};_d.$XB=function(n,t,i,r,u){this.$2f=i;this.$G=r;this.$1D=u;this.$36u=n;this.$1M2=t};_d.$XB.prototype={$2f:null,$G:null,$1D:null,$36u:null,$1M2:null,$I:function(n,t){return new _d.$8X(n,t,this.$G.get_$O()==="TouchNarrow",t.$86,this.$36u,this.$1M2,this.$2f,this.$G,this.$1D)}};_d.$8X=function(n,t,i,r,u,f,e,o,s){this.$$d_$8cV=Function.createDelegate(this,this.$8cV);this.$$d_$8cW=Function.createDelegate(this,this.$8cW);this.$$d_$8V4=Function.createDelegate(this,this.$8V4);this.$$d_$8V3=Function.createDelegate(this,this.$8V3);this.$$d_$78S=Function.createDelegate(this,this.$78S);this.$$d_$8dv=Function.createDelegate(this,this.$8dv);this.$$d_$8du=Function.createDelegate(this,this.$8du);this.$$d_$8Tt=Function.createDelegate(this,this.$8Tt);this.$$d_$8nt=Function.createDelegate(this,this.$8nt);this.$$d_$6wD=Function.createDelegate(this,this.$6wD);this.$$d_$44L=Function.createDelegate(this,this.$44L);this.$$d_$8np=Function.createDelegate(this,this.$8np);this.$$d_$5oc=Function.createDelegate(this,this.$5oc);this.$$d_$60K=Function.createDelegate(this,this.$60K);this.$$d_$93l=Function.createDelegate(this,this.$93l);this.$$d_$7Vk=Function.createDelegate(this,this.$7Vk);this.$$d_$8Yv=Function.createDelegate(this,this.$8Yv);_d.$8X.initializeBase(this,[r,e]);var a;var v;var c;this.$G=o;this.$1D=s;this.$1M2=f;this.$36u=u;this.$CF=n;this.$dp=n.get_$Ca();this.set_$5n4(t);this.$2mu=this.$1oU=_g.$9b.isInstanceOfType(n);this.$2ll=_d.$T1.isInstanceOfType(this.$Fb)||this.$Fb.$BN===this.$2f_4.get_$1Za()||this.$Fb.$BN===this.$2f_4.get_$1V1()||this.$Fb.$BN===this.$2f_4.get_$1dH();r.$a("IsMaxNumberOfCalendarsSelected",this.$$d_$8Yv);this.set_$Bb(1);var l=new _C(this.$$d_$7Vk,_d.$8X.$D);var p=new _C(this.$$d_$93l,_d.$8X.$D);var b=new _C(this.$$d_$60K,_d.$8X.$D);this.$5od=new _C(this.$$d_$5oc,_d.$8X.$D);var y=this.$4rh=new _C(this.$$d_$8np,_d.$8X.$D);l.set_$5P(!0);p.set_$5P(!0);y.set_$5P(!0);this.set_$1L8(new _C(this.$$d_$44L,_d.$8X.$D));this.set_$2Zt(new _C(this.$$d_$6wD,_d.$8X.$D));this.set_$94e(new _C(this.$$d_$8nt,_d.$8X.$D));if(this.$2mu){a=n;c=new _g.$1m;c.EmailAddress=a.get_$DQ();c.Name=a.get_$Ca();this.$7S=new _d.$7u(_c.$i.$E5(c),2,!1)}else{v=n;this.$1oU=!!(this.$1oU|v.get_$16Q());l.set_$5P(!v.get_$2Ct());y.set_$5P(l.$2K)}var w=new _d.$jg(n,this.$$d_$1Ae);w.$a("IsActionPending",this.$$d_$8Tt);if(!i){var h=new(_0365f.$s.$$(_0365m.$n));if(!(this.$1oU||this.get_$bi())){h.$H(new _0365m.$n(_u.Strings.l_ShareCalendarContextMenuTitle_LowerCase_Text,null,b));h.$H(new _0365m.$n(_u.Strings.l_SharedCalendarPermissions_Text,null,p))}this.$2mu&&this.$CF.get_$bi()||h.$6G([new _0365m.$n(_u.Strings.l_RenameCalendarContextMenuTitle_LowerCase_Text,null,l),new _0365m.$n(this.$1oU?_u.Strings.l_RemoveCalendarContextMenuTitle_LowerCase_Text:_u.Strings.l_DeleteCalendarContextMenuTitle_LowerCase_Text,null,y)]);h.$H(w.$5JU);this.$8W=new _0365m.$2c(h.get_$3T())}$4ML(this)};function $4ML(n){n.set_$lW(!n.$2f_4.$2aA(n.$CF)||n.$86.$1Gq&&!n.$86.$P1.$6l(n))}function $4MM(n){if(!n.$86.$yT){n.set_$2X(!1);if(n.$2ll){n.$86.$5sp(n);return}n.$27G=n.$Fb.$V.$7h(n);n.$27G>=0&&n.$Fb.$V.$67(n.$27G);var t=new _c.$qY(n.$CF,n.$Fb.$BN,n.$2f_4);t.add_$20(n.$$d_$8V3);t.add_$2A(n.$$d_$8V4);n.$86.set_$Sy(!0);OwaApplication.$1T.$y(t)}}_d.$8X.prototype={$2mu:!1,$1oU:!1,$2ll:!1,$255:!1,$257:!1,$28P:!0,$36u:null,$1M2:null,$1D:null,$4rh:null,$5od:null,$7S:null,$CF:null,$G:null,$Fb:null,$27G:0,$dp:null,$1Kf:null,get_$8kw:function(){return this.$G.get_$O()==="Mouse"?_d.$4.get_$2M6():_d.$4.get_$5oh()},get_$8qk:function(){return this.$G.get_$O()==="Mouse"?_d.$4.get_$143():_d.$4.get_$1Pw()},get_$5n4:function(){return this.$Fb},set_$5n4:function(n){if(this.$Fb!==n){this.$Fb=n;if(_d.$T1.isInstanceOfType(this.$Fb)){this.set_$4jp(!0);this.set_$U8(!0)}else{this.set_$4jp(this.$Fb.$BN===this.$2f_4.get_$1V1());this.set_$U8(this.$Fb.$BN===this.$2f_4.get_$1Za())}}return n},get_$7Aa:function(){return!this.$1D.get_$rk()},get_$92T:function(){return String.format(_u.Strings.l_CalendarPickerShowCalendar_AT_Checkbox_Text,this.$dp)},get_$Ca:function(){return this.$dp},set_$Ca:function(n){if(n!==this.$dp){this.$dp=this.$CF.set_$Ca(n);$4Z(this,"CalendarName","ShowCalendarText")}return n},get_$4jp:function(){return this.$255},set_$4jp:function(n){if(this.$255!==n){this.$255=n;$4Z(this,"CanPin","CanPinOrRemove")}return n},get_$U8:function(){return this.$257},set_$U8:function(n){if(this.$257!==n){this.$257=n;$4Z(this,"CanRemove","CanPinOrRemove")}return n},get_$6wf:function(){return this.$255||this.$257},$59:function(){this.$86.$w("IsMaxNumberOfCalendarsSelected",this.$$d_$8Yv);_d.$X7.prototype.$59.call(this)},get_$bi:function(){return!!this.$CF&&this.$CF.get_$bi()},$8Tt:function(n,t){var i=n;this.$86.set_$Sy(i.$Hl)},$8nt:function(){if(this.$1r.$2R){_js.Trace.logInfo(_d.$8X.$D,"Unable to show a messagebox while there is another one already being shown.");return}this.$2f_4.$2aA(this.$CF)?this.$86.$1Gq&&this.$1r.$3A(0,String.format(_u.Strings.l_CalendarPickerTooManyCalendarsSelected_Text,this.$86.$2rA),null,!1,null,null,_u.Strings.l_Warning_Text):this.$1r.$3A(0,_u.Strings.l_CalendarPickerInvalidSharedCalendar_Text,null,!1,null,null,_u.Strings.l_CalendarActionErrorDialogTitle_Text)},$8Yv:function(n,t){$4ML(this)},$60K:function(){var n=this;this.$1M2.$I(function(t){t.$3zM(n.$CF.get_$AC(),null,!1)})},$7Vk:function(){if(!this.$86.$yT){this.$1Kf=this.$dp;this.set_$1u5(this);this.set_$RG(!0);this.set_$Bb(4)}},$6wD:function(){this.set_$RG(!1);this.set_$Ca(this.$1Kf);this.$1Kf=null;this.set_$Bb(1)},$44L:function(){if(_js.$8.$14(this.$dp)){this.set_$Ca(this.$1Kf);this.$1Kf=null;this.set_$RG(!1);return}if(this.$dp.trim()===this.$1Kf||this.$2ll){this.set_$RG(!1);return}var n=new _c.$uL(this.$CF,this.$dp,this.$2f_4);n.add_$20(this.$$d_$8du);n.add_$2A(this.$$d_$8dv);this.$86.set_$Sy(!0);OwaApplication.$1T.$y(n);this.set_$RG(!1)},$8dv:function(n){this.$86.set_$Sy(!1)},$8du:function(n){this.$86.set_$Sy(!1);this.set_$Ca(this.$1Kf);this.$1Kf=null;this.$1Ae(n.get_$bO());this.$2f_4.$BA()},$8np:function(){if(this.$2ll||this.$1oU){$4MM(this);return}this.$1r.$3A(2,_u.Strings.l_DeleteCalendarMessageBoxText_Text,this.$$d_$78S,!1,null,null,_u.Strings.l_DeleteCalendarMessageBoxTitle_Text)},$93l:function(){var n=this;this.$36u.$I(function(t){t.$8i9(n.$CF)})},$78S:function(n,t){n&&$4MM(this)},$8V4:function(n){this.$86.set_$Sy(!1);this.$CF.$1M();this.$1M()},$8V3:function(n){this.$27G>=0&&this.$Fb.$V.$6z(this.$27G,this);this.$86.set_$Sy(!1);this.$1Ae(n.get_$bO());this.$2f_4.$BA()},$5oc:function(){var n=this.$Fb.$BN===this.$2f_4.get_$1V1()||this.$Fb.$BN===this.$2f_4.get_$1dH();if(!_d.$T1.isInstanceOfType(this.$Fb)&&!n){_js.Trace.logError(_d.$8X.$D,"Expecting that calendar being pinned is either searched or modern groups calendar. ParentGroupName: {0}",this.$Fb?this.$Fb.$UY:"isNull");return}if(n){this.$86.$8kv(this);return}this.$86.set_$Sy(!0);this.$28P=!1;this.set_$2X(!1);this.$2f_4.$5oc(this.$CF,null,this.$$d_$8cW,this.$$d_$8cV)},$8cW:function(n){this.$1Ae(n)},$8cV:function(){this.$86.set_$Sy(!1);this.$1M()}};_d.$MW=function(n,t,i,r,u,f,e){this.$$d_$69c=Function.createDelegate(this,this.$69c);_d.$MW.initializeBase(this,[n,t,i,r,f]);var o=_a.$5.acss(_a.$0.$1o,"CalendarWeekViewModel:Init");this.$Xt=u;this.$26w=new _js.$X;$6LT(this);e&&e.add_$24l(this.$$d_$69c);_a.$5.aces(o)};function $6LT(n){for(var t,i,u=_a.$7.get_$2M(),r=0,f=n.$Mu.get_$aD().length;r<f;r++){t=n.$Mu.get_$aD()[r];i=new _d.$TP(t,n.$Xt);t.$8c(u)||i.set_$2X(!0);n.$26w.$H(i)}}function $6LU(n){for(var i,r,u=_a.$7.get_$2M().$3u(),t=0,f=n.$HA.length;t<f;t++){i=n.$HA[t];r=n.$26w.get_$48(t);r.set_$5z(i);r.set_$2X(i.$4W(u))}}_d.$MW.prototype={$Xt:null,$26w:null,$1xU:null,get_$14d:function(){return 1},get_$1Q:function(){return"CalendarWeekViewModel"},get_$1DO:function(){return 2},get_$8vq:function(){return this.$1xU},set_$8vq:function(n){if(this.$1xU!==n){this.$1xU=n;this.$1xU&&this.set_$8G(this.$1xU.$6y)}return n},get_$433:function(){return _a.$7.$2AA(this.$E8.$2G,this.$E8.$2w.$2q(-1))},get_$2WR:function(){return String.format(_u.Strings.l_CalendarWeekView_AT_Region_Text,this.get_$433())},$53A:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"WeekView_GoPrev",!0,!0));this.set_$AB(this.$E8.$2G.$2q(-7))},$539:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"WeekView_GoNext",!0,!0));this.set_$AB(this.$E8.$2G.$2q(7))},$H0:function(n){n.get_$9w()?this.$BJ.$H(n):n.get_$10().$3u().$2Y(n.get_$23().$3u())?this.$o.$6G($1e0(this,n,this.$HA)):this.$o.$H(n)},$2z6:function(){_d.$1n.prototype.$2z6.call(this);this.$69c(this,_a.$7.get_$2M())},$5h5:function(n,t){_d.$7S.prototype.$5h5.call(this,n,t);$6LU(this)},$69c:function(n,t){for(var r,i=0,u=this.$HA.length;i<u;i++){r=this.$HA[i];this.$26w.get_$48(i).set_$2X(!r.$8c(t))}}};_d.$x4=function(n,t,i,r,u){_d.$x4.initializeBase(this,[n,t,i,r,null,u,null])};_d.$x4.prototype={get_$14d:function(){return 5}};_d.$jw=function(n,t,i,r,u,f,e){_d.$jw.initializeBase(this,[n,t,i,r,u,f,e])};_d.$jw.prototype={get_$14d:function(){return 2},get_$1Q:function(){return"CalendarWorkWeekViewModel"},get_$1DO:function(){return 3},get_$2WR:function(){return String.format(_u.Strings.l_CalendarWorkWeekView_AT_Region_Text,this.get_$433())},$1bX:function(n){if(_d.$1n.prototype.$1bX.call(this,n))for(var t,r,i=0,u=this.$Mu.get_$aD().length;i<u;i++){t=this.$Mu.get_$aD()[i];r=new _h.$4S(t,t.$2q(1));if(r.$1Gz(n))return!0}return!1},$3ZQ:function(){var n=_a.$25.$Km(this.get_$8G(),this.get_$14d(),!0,this.$1c.$t.get_$1t().get_$Tv().get_$dP());Array.removeAt(n,n.length-1);return n},$2z6:function(){_d.$MW.prototype.$2z6.call(this);_a.$25.$2Cs(this.$HA,this.get_$8G())||this.set_$8G(this.$HA[0])}};_d.$TP=function(n,t){_d.$TP.initializeBase(this,[_d.$TP.$4y0(n),null,t,!0]);this.$6y=n};_d.$TP.$4y0=function(n){return String.format("{0} {1}",n.$2P(19),_a.$7.$1FZ(n.get_$Cd(),2))};_d.$TP.prototype={$6y:null,get_$5z:function(){return this.$6y},set_$5z:function(n){if(n&&!_a.$7.$4F(this.$6y,n)){this.$6y=n;$Q(this,"FormattedDate")}return n},get_$7Gk:function(){return _d.$TP.$4y0(this.$6y)}};_d.$t7=function(n,t,i,r,u,f,e){this.$$d_$8RR=Function.createDelegate(this,this.$8RR);_d.$t7.initializeBase(this,[t,i,r,u,f,e]);this.$kh=n};_d.$t7.prototype={$kh:null,get_$1Q:function(){return"MonthAgendaViewModel"},get_$8G:function(){return _d.$1n.prototype.get_$8G.call(this)},set_$8G:function(n){_d.$1n.prototype.set_$8G.call(this,n);this.$kh.set_$8G(n);return n},get_$y8:function(){return _d.$1n.prototype.get_$y8.call(this)},set_$y8:function(n){_d.$1n.prototype.set_$y8.call(this,n);this.$kh.set_$y8(n);return n},$5gJ:function(n,t){_d.$1n.prototype.$5gJ.call(this,n,t);this.$kh.$5sD()},$5lW:function(n,t){_d.$1E8.prototype.$5lW.call(this,n,t);this.$1c.$WZ&&this.$kh.$6yI()},$2z6:function(){_d.$8o.prototype.$2z6.call(this);this.$kh.set_$G5(!0);this.$kh.add_$8C(this.$$d_$8RR)},$5h6:function(){_d.$1n.prototype.$5h6.call(this);this.$kh.set_$G5(!1);this.$kh.remove_$8C(this.$$d_$8RR)},$8RR:function(n,t){t==="VMSelectedDate"?this.set_$8G(this.$kh.get_$8G()):t==="SelectedAgendaItem"&&this.$kh.$1au&&this.$b7()}};_d.$vV=function(n,t,i){_d.$vV.initializeBase(this,[n]);this.$14c=t;this.$1AM=i};_d.$vV.prototype={$14c:null,$1AM:null,$qI:null,add_$2ZV:function(n){this.$2Z("CalendarColorsChanged",n)},remove_$2ZV:function(n){this.$2b("CalendarColorsChanged",n)},get_$IQ:function(){return this.$qI},set_$IQ:function(n){this.$qI=n;return n},get_$3ww:function(){return _d.$Hy.prototype.get_$3ww.call(this)},set_$3ww:function(n){_d.$Hy.prototype.set_$3ww.call(this,n);this.$qI&&(this.$qI.$4vq=n);return n},get_$7da:function(){return this.$o.get_$F()},$7FF:function(n){$Bc(this,"CalendarColorsChanged",this,n)},$b7:function(){}};_d.$eJ=function(n,t,i,r,u,f,e,o,s){_d.$eJ.initializeBase(this,[n,t,i]);this.$Qf=s;this.$13m=e;this.$QA=r;this.$1uu=u;this.$lD=f;this.$3vO=o};_d.$eJ.prototype={$Qf:0,$13m:null,$3vO:null,$QA:null,$1uu:null,$lD:null,$13:null,$16R:!1,$16J:!1,get_$3h2:function(){return this.$16R},set_$3h2:function(n){if(n!==this.$16R){this.$16R=n;$6(this,"IsItemContextMenuShown")}return n},get_$1DO:function(){return 4},get_$25:function(){return this.$13},set_$25:function(n){if(this.$13!==n){this.$13=n;$6(this,"SelectedItem")}return n},get_$y8:function(){return this.$16J},set_$y8:function(n){if(this.$16J!==n){this.$16J=n;$4Z(this,"IsDraggingItem","ShouldPeekBeEnabled")}return n},get_$91S:function(){return!this.$16J&&this.$3vO.$G.get_$O()==="Mouse"},$b7:function(){this.set_$25(null)}};_d.$1E8=function(n,t,i,r,u,f){this.$$d_$5lW=Function.createDelegate(this,this.$5lW);_d.$1E8.initializeBase(this,[n,t,i,r,f]);this.$Xt=u;$4Od(this)};_d.$1E8.prototype={$3iY:!1,$Xt:null,$76j:function(n,t){var i=new _d.$eJ(t,this.$Xt,this.$3R5,this.$QA,this.$1uu,this.$lD,this.$13m,this.$1c,n);i.$a("SelectedItem",this.$$d_$5lW);return i},$5sE:function(){_d.$8o.prototype.$5sE.call(this);var n=this.$1c.$WZ;if(n&&!this.get_$y8()){var r=n.get_$10();var u=n.get_$23();var i=this.get_$8G().$3u();var f=i.$2q(1).$9b(-1);var e=new _h.$4S(r,u);if(!e.$2YM(i,f)){for(var t=0,o=this.$9Z.length;t<o;t++)this.$9Z[t].set_$25(null);this.$1c.set_$qu(null)}}},$5gM:function(){for(var n=0,t=this.$9Z.length;n<t;n++)this.$9Z[n].set_$y8(this.get_$y8());_d.$1n.prototype.$5gM.call(this)},$5lW:function(n,t){if(!this.$3iY){this.$3iY=!0;var i=n;var r;this.$1c.set_$qu(i.$13);for(var u=0,f=this.$9Z.length;u<f;u++){r=this.$9Z[u];r!==i&&r.set_$25(i.$13)}this.$3iY=!1}}};_d.$8o=function(n,t,i,r,u){this.$$d_$8T1=Function.createDelegate(this,this.$8T1);_d.$8o.initializeBase(this,[n,!0,i,t,r,u]);this.$9Z=new Array(6);this.add_$2ZV(this.$$d_$8T1)};_d.$8o.$1l9=function(n){var t=_a.$25.$Km(n,3);var i=new _a.$7(n.get_$4M(),n.get_$3D(),1,t[0].get_$Ec(),t[0].get_$Gs(),t[0].get_$Te());t[1]=_a.$7.$Kn(i.$GR(1).$2q(-1)).$2q(7);return t};function $4Od(n){for(var r=_a.$25.$Km(n.get_$8G(),3)[0],i,t=0;t<6;++t){i=r.$2q(t*7);n.$9Z[t]=n.$76j(t,i)}}function $4Oe(n){var t=_d.$8o.$1l9(n.get_$AB());var i=new _h.$4S(t[0],t[1]);return!i.$hX(n.get_$8G(),!0,!1)||!i.$4W(n.$E8)}function $4Of(n,t){n.set_$AB(new _a.$7(n.get_$2So().$5f.get_$4M(),n.get_$2So().$5f.get_$3D(),1).$GR(t?1:-1))}function $6Pb(n){for(var i=_a.$5.acss(_a.$0.$1o,"MonthVM:UpdateDisplayedDateInWeeks"),r=_a.$25.$Km(n.get_$AB(),3)[0],t=0;t<6;++t)n.$9Z[t].set_$10(r.$2q(t*7));_a.$5.aces(i)}_d.$8o.prototype={$9Z:null,$1uS:null,$Dm:!1,get_$1Q:function(){return"MonthViewModel"},get_$IQ:function(){return _d.$1n.prototype.get_$IQ.call(this)},set_$IQ:function(n){_d.$1n.prototype.set_$IQ.call(this,n);for(var t=0,i=this.$9Z.length;t<i;t++)this.$9Z[t].$qI=n;return n},get_$ZD:function(){return this.$Dm},set_$ZD:function(n){if(this.$Dm!==n){this.$Dm=n;$6(this,"IsTransitionedIn")}return n},get_$14d:function(){return 3},get_$8Uo:function(){return this.$1uS},set_$8Uo:function(n){if(n!==this.$1uS){this.$1uS=n;$6(this,"OnDateClickedCommand")}return n},get_$1DO:function(){return 4},$2z6:function(){var n=_d.$8o.$1l9(this.get_$AB());this.set_$3TR(new _h.$4S(n[0],n[1]));_d.$1n.prototype.$2z6.call(this)},$47o:function(n){_d.$1n.prototype.$47o.call(this,n);$6Pb(this);$4Lf(this,!0)},get_$4GY:function(){return this.$9Z[0]},get_$4GZ:function(){return this.$9Z[1]},get_$2So:function(){return this.$9Z[2]},get_$4Ga:function(){return this.$9Z[3]},get_$4Gb:function(){return this.$9Z[4]},get_$4Gc:function(){return this.$9Z[5]},get_$3bD:function(){return 12},get_$433:function(){return this.get_$AB().$2P(2)},get_$2WR:function(){return String.format(_u.Strings.l_CalendarMonthView_AT_Region_Text,this.get_$433())},$50g:function(){for(var t=0,n=0,i=this.$9Z.length;n<i;n++)t+=this.$9Z[n].get_$7da();return t},$7L8:function(){for(var r=0,n,t,i=0,u=this.$9Z.length;i<u;i++){n=this.$9Z[i];t=n.$o;t&&n.$21F.$hX(this.get_$8G(),!0,!0)&&(r+=$2Tf(this,t))}return r},$53A:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"MonthView_GoPrev",!0,!0));$4Of(this,!1)},$539:function(){this.set_$IQ(_d.$8W.$I(_a.$0.$1o,"MonthView_GoNext",!0,!0));$4Of(this,!0)},$b7:function(){_d.$1n.prototype.$b7.call(this);for(var n=0,t=this.$9Z.length;n<t;n++)this.$9Z[n].$b7()},$4zp:function(n){var t=_d.$8o.$1l9(n);return new _h.$4S(t[0],t[1])},$3KT:function(n){for(var h=[],t,r,u,c=n.length,l=_a.$5.acss(_a.$0.$Ag,"MonthVM:AddItems_"+c),f=0;f<6;++f)Array.add(h,this.$9Z[f].$o.$63t());for(var e=0;e<c;++e){t=n[e];if(this.$1bX(t)){r=!t.get_$9w()&&t.get_$10().$3u().$2Y(t.get_$23().$3u())?$1e0(this,t,this.$HA):[t];for(var i=0;i<6;++i)for(var o=0,a=r.length;o<a;++o){u=r[o];this.$9Z[i].$2DS(u)&&h[i].$H(u)}}}for(var s=0;s<6;++s)this.$9Z[s].$o.$4uf();_a.$5.aces(l)},$H0:function(n){var r=_a.$5.acss(_a.$0.$Ag,"MonthVM:AddItem");var t;if(this.$1bX(n))for(var i=0;i<6;++i){t=this.$9Z[i];t.$2DS(n)&&t.$o.$H(n)}_a.$5.aces(r)},$BB:function(n){for(var t,i=0;i<6;++i){t=this.$9Z[i];t.$2DS(n)&&_d.$1n.$446(n,t.$o)}},$1wp:function(){for(var n=0,t=this.$9Z.length;n<t;++n)this.$9Z[n].$o.$1u();_d.$1n.prototype.$1wp.call(this)},$59:function(){var n;this.remove_$2ZV(this.$$d_$8T1);for(var t=0,i=this.$9Z.length;t<i;t++){n=this.$9Z[t];n&&n.$1M()}_d.$1n.prototype.$59.call(this)},$65J:function(){$4Oe(this)&&_d.$1n.prototype.$65J.call(this)},$5sE:function(){$4Oe(this)&&this.set_$3TR(this.$4zp(this.get_$AB()))},$8xJ:function(n){n.set_$10(this.get_$8G().$3u());n.set_$23(n.get_$10().$2q(1).$9b(-1));n.set_$5Z(this.$1c.$CH);return n},$8T1:function(n,t){for(var i=0,r=this.$9Z.length;i<r;i++)this.$9Z[i].$7FF(t)}};_d.$hq=function(n){this.$Fs=n};_d.$hq.prototype={$Fs:null};_d.$Fo=function(n,t,i,r){this.$$d_$5lX=Function.createDelegate(this,this.$5lX);this.$$d_$8T0=Function.createDelegate(this,this.$8T0);_d.$Fo.initializeBase(this,[n,t,r]);_a.$3.$M(i,"calendars");this.$3zc=i;this.$Ft=i.$46();this.$3zc.add_$1Z(this.$$d_$8T0);this.$UX=$6K2(this);this.$2f.add_$3Co(this.$$d_$5lX)};function $4Li(n,t){if(t.get_$92()!=="Free"){var i=n.$Ft.$7h(t.get_$5Z());i>=0&&i<n.$UX.get_$F()&&n.$UX.get_$48(i).set_$3L2($3Ea(n,t.get_$5Z()))}}function $6K2(n){for(var r=new _js.$X,t,u=n.$DU[0].$3u(),i=0,f=n.$Ft.get_$F();i<f;i++){t=n.$Ft.get_$48(i);r.$H(new _d.$8u(n.$2f.$1Sj(t),u,t,$3Ea(n,t)))}return r}function $3Ea(n,t){for(var i,r=null,u=0,f=n.$BJ.get_$F();u<f;u++){i=n.$BJ.get_$48(u);if(i.get_$5Z().$4W(t)&&i.get_$92()!=="Free"){r||(r=new(_0365f.$s.$$(_g.$IK)));r.$H(i)}}return r}_d.$Fo.prototype={$Ft:null,$3zc:null,$xT:function(n){return this.$Ft.$7h(n.get_$5Z())},$29j:function(n){return 1},$7PP:function(n){var t;var i,r;var u=this;var f=(r=this.$UX.$3BG(function(t){return t.$Fs===n},i={val:t}),t=i.val,r);return t},$59:function(){_js.$9.prototype.$59.call(this);this.$2f.remove_$3Co(this.$$d_$5lX);this.$3zc.remove_$1Z(this.$$d_$8T0)},$9Dy:function(){for(var n=0,t=this.$Ft.get_$F();n<t;n++)this.$UX.get_$48(n).set_$5z(this.$DU[0].$3u())},$5fp:function(n,t){switch(t.$3R){case 0:for(var i=0,u=t.$2t.length;i<u;i++)$4Li(this,t.$2t[i]);break;case 2:for(var r=0,f=t.$3Y.length;r<f;r++)$4Li(this,t.$3Y[r]);break}},$8T0:function(n,t){var i;var r=t.$4T;switch(t.$3R){case 0:for(var f=t.$2t,u=r,o=r+f.length;u<o;u++){var s=u-r;i=f[s];this.$Ft.$6z(u,i);this.$UX.$6z(u,new _d.$8u(this.$2f.$1Sj(i),this.$DU[0].$3u(),i,$3Ea(this,i)))}break;case 2:for(var e=0,h=t.$3Y.length;e<h;e++){this.$Ft.$67(r);this.$UX.$67(r)}break;default:break}$Q(this,"ColumnCount")},$5lX:function(n){for(var i,t=0,r=this.$Ft.get_$F();t<r;t++)if(_g.$9b.isInstanceOfType(this.$Ft.get_$48(t))){i=this.$Ft.get_$48(t);i.get_$DQ()===n&&this.$UX.get_$48(t).set_$6Bs(this.$2f.$1Sj(i))}}};_d.$8u=function(n,t,i,r){this.$$d_$8Ua=Function.createDelegate(this,this.$8Ua);_d.$8u.initializeBase(this);_a.$3.$M(n,"workingHoursModel");_a.$3.$M(t,"date");this.$vB=n;this.$6y=t;this.set_$1o(i);this.$vR=[];this.set_$3L2(r);$2Tj(this)};function $2Tj(n){n.$2CI=$4Lo(n,n.$vB.get_$1NX(),0);n.$2CH=$4Lo(n,n.$vB.get_$4Gn(),1440)}function $4Lp(n){n.set_$YR(n.$Fs?n.$Fs.$LW:-1)}function $4Lo(n,t,i){return n.$vB.$7dK(n.$6y.$Fr(1440-t).get_$Cd())?(1440+t)%1440:i}function $4Ln(n,t){Array.clear(n.$vR);if(t){$2Ti(n,t,n.$vR,"OOF");$2Ti(n,t,n.$vR,"Busy");$2Ti(n,t,n.$vR,"Tentative");$2Ti(n,t,n.$vR,"WorkingElsewhere")}}function $2Ti(n,t,i,r){for(var u,e=i.length,f=0,o=t.get_$F();f<o;f++){u=t.get_$48(f);u.get_$92()===r&&$6KA(n,i,e,u)}}function $6KA(n,t,i,r){for(var u,f=null,e=i;e<t.length;e++){u=t[e];if(r.get_$10().$2Y(u.$9f)<0&&r.get_$23().$2Y(u.$7T)>0)if(f){Array.addRange(f.$o,u.$o);Array.removeAt(t,e);e--}else{f=u;f.$H(r)}}if(!f){u=new _d.$pv;u.$H(r);Array.add(t,u)}}_d.$8u.prototype={$vB:null,$YQ:0,$Fs:null,$2CI:0,$2CH:0,$6y:null,$BJ:null,$vR:null,$2j1:!1,get_$1o:function(){return this.$Fs},set_$1o:function(n){if(this.$Fs!==n){this.$Fs&&this.$Fs.$w("AssignedCalendarColor",this.$$d_$8Ua);n&&n.$a("AssignedCalendarColor",this.$$d_$8Ua);this.$Fs=n;$4Lp(this)}return n},get_$5z:function(){return this.$6y},set_$5z:function(n){_a.$3.$M(n,"date");if(!_a.$7.$4F(this.$6y,n)){this.$6y=n;$2Tj(this);$6(this,"Date")}return n},get_$6Bs:function(){return this.$vB},set_$6Bs:function(n){if(this.$vB!==n){this.$vB=n;$2Tj(this);$6(this,"WorkingHoursModel")}return n},get_$7SM:function(){return this.$2j1},set_$7SM:function(n){if(this.$2j1!==n){this.$2j1=n;$6(this,"ResponseMessage")}return n},get_$7dL:function(){return this.$2CI<=this.$2CH},get_$YR:function(){return this.$YQ},set_$YR:function(n){if(this.$YQ!==n){this.$YQ=n;$6(this,"CalendarColor")}return n},get_$3L2:function(){return this.$BJ},set_$3L2:function(n){if(this.$BJ!==n){this.$BJ=n;$4Ln(this,this.$BJ);$6(this,"AllDayItems")}return n},$9DC:function(n,t,i){_a.$3.$M(i,"workingHours");_a.$3.$M(n,"calendar");this.set_$1o(n);this.$vB=i;$4Ln(this,t);$2Tj(this);$6(this,"CalendarProperties")},$8Ua:function(n,t){$4Lp(this)}};_d.$Sz=function(n,t){this.$QS=n;this.$He=t};_d.$Sz.prototype={$QS:0,$He:0,$4W:function(n){if(n){var t=n;return this.$QS===t.$QS&&this.$He===t.$He}return!1}};_d.$ji=function(n,t){_a.$3.$M(n,"selectionStart");_a.$3.$M(t,"selectionEnd");this.$Jm=new _d.$Sz(Math.min(n.$QS,t.$QS),Math.min(n.$He,t.$He));this.$1bC=new _d.$Sz(Math.max(n.$QS,t.$QS),Math.max(n.$He,t.$He))};_d.$ji.prototype={$Jm:null,$1bC:null,$4W:function(n){if(n&&Object.getType(n).isInstanceOfType(this)){var t=n;return this.$Jm.$4W(t.$Jm)&&this.$1bC.$4W(t.$1bC)}return!1}};_d.$LN=function(n,t,i,r){this.$$d_$5lX=Function.createDelegate(this,this.$5lX);this.$$d_$5gu=Function.createDelegate(this,this.$5gu);_d.$LN.initializeBase(this,[n,t,r]);this.$1c=i;this.$1Qj=$8(i.$CH)?_c.$1S.$2yp:r.$1Sj(i.$CH);this.$UX=$6Mn(this);i.$a("CurrentCalendarModel",this.$$d_$5gu);this.$2f.add_$3Co(this.$$d_$5lX)};function $6Mn(n){for(var i=new _js.$X,t=0,r=n.$DU.length;t<r;t++)i.$H(new _d.$8u(n.$1Qj,n.$DU[t].$3u(),n.$1c.$CH,$3Ex(n,n.$DU[t])));return i}function $3Ex(n,t){if(!n.$1c.$CH)return null;for(var i,r=null,u=0,f=n.$BJ.get_$F();u<f;u++){i=n.$BJ.get_$48(u);if(i.get_$5Z()&&i.get_$5Z().$4W(n.$1c.$CH)&&i.get_$92()!=="Free"&&i.get_$10().$8c(t)<=0&&i.get_$23().$9b(-1).$8c(t)>=0){r||(r=new(_0365f.$s.$$(_g.$IK)));r.$H(i)}}return r}_d.$LN.prototype={$1c:null,$1Qj:null,$xT:function(n){for(var t=0,i=this.$DU.length;t<i;t++)if(n.get_$10().$2Y(this.$DU[t].$2q(1))<0)return t;return-1},$29j:function(n){for(var i=this.$xT(n),t=i+1;t<this.$DU.length&&n.get_$23().$9b(-1).$2Y(this.$DU[t])>0;)t++;return t-i},$59:function(){_js.$9.prototype.$59.call(this);this.$2f.remove_$3Co(this.$$d_$5lX);this.$1c.$w("CurrentCalendarModel",this.$$d_$5gu)},$9Dy:function(){for(var n=0,t=this.$DU.length;n<t;n++)this.$UX.get_$48(n).set_$5z(this.$DU[n].$3u())},$5fp:function(n,t){for(var i=0,r=this.$DU.length;i<r;i++)this.$UX.get_$48(i).set_$3L2($3Ex(this,this.$DU[i]))},$5gu:function(n,t){if(this.$1c.$CH){this.$1Qj=this.$2f.$1Sj(this.$1c.$CH);for(var r,i=0,u=this.$UX.get_$F();i<u;i++){r=this.$UX.get_$48(i);r.$9DC(this.$1c.$CH,$3Ex(this,this.$DU[i]),this.$1Qj)}}},$5lX:function(n){if(_g.$9b.isInstanceOfType(this.$1c.$CH)){var i=this.$1c.$CH;if(i.get_$DQ()===n){this.$1Qj=this.$2f.$1Sj(i);for(var r,t=0,u=this.$UX.get_$F();t<u;t++){r=this.$UX.get_$48(t);r.set_$6Bs(this.$1Qj)}}}}};_d.$1DP=function(n,t,i){this.$$d_$5fp=Function.createDelegate(this,this.$5fp);_d.$1DP.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;this.dispose=this.$1M;_d.$1DP.initializeBase(this);_a.$3.$M(n,"dateRange");this.$DU=n;this.$2f=i;this.$BJ=t;this.$BJ.add_$1Z(this.$$d_$5fp)};_d.$1DP.prototype={$BJ:null,$2f:null,$UX:null,$dy:0,$DU:null,get_$aD:function(){return this.$DU},set_$aD:function(n){if(this.$DU!==n){this.$DU=n;this.$9Dy();$Q(this,"SelectedDateRange")}return n},get_$Hf:function(){return this.$dy},set_$Hf:function(n){if(this.$dy!==n){this.$dy=n;$Q(this,"ColumnWidth")}return n},get_$l7:function(){return this.$UX.get_$F()},get_$xZ:function(){return this.$UX},set_$xZ:function(n){this.$UX=n;return n}};_d.$Jy=function(n){this.$O8=n};_d.$Jy.$43I=function(n){switch(n){case 0:return 0;case 1:return 1;default:throw Error.invalidOperation("Attendee type not supported");}};function $4MR(n,t,i){var u=n.$O8.$U3.$Bm;if(u.$1L.get_$F()+i.get_$F()>100)return!1;for(var r=0;r<i.get_$F();r++){var f=i.get_$48(r);var e=u.$237(f);e.set_$13c(t)}return!0}_d.$Jy.prototype={$O8:null,$2A8:function(){return this.$O8.$l.$r.get_$4h().get_$1l()},$8yx:function(n){this.$O8.$l.$r.set_$4h(_g.$3G.$wE(n))},$4dw:function(n,t){t.val=0;var r=_y.$AZ.$3RT(n);if(this.$O8.$6I){var i=new(_0365f.$s.$$(_y.$lQ));this.$O8.$6I.$235(r,i);if(!i.get_$F()){_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$48(0)}else{_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - max number exceeded.");t.val=9001;return null}},$4dn:function(n,t,i){i.val=0;var r=this.$O8.$6I;if(r){var u=new _d.$vM(n,t);return r.$4do(u)}else{i.val=15;return null}},$7NA:function(n){for(var r=new _js.$X,i=this.$O8.$U3.$Bm.$1L,u=_d.$Jy.$43I(n),t=0;t<i.get_$F();t++)u===i.get_$48(t).$4U.$WG&&r.$H(i.get_$48(t));return r},$8zY:function(n,t){var i=_d.$Jy.$43I(n);this.$O8.$U3.$Bm.$6yG(i);$4MR(this,i,t)},$9BQ:function(n,t){return $4MR(this,_d.$Jy.$43I(n),t)},$8zp:function(n){this.$O8.$l.$r.set_$2h(n)},$xY:function(){return this.$O8.$l.get_$2h()},$2iK:function(){return this.$O8.$K0.$lF.$2G},$2hj:function(){return this.$O8.$K0.$lF.$2w},$8zn:function(n){this.$O8.$K0.set_$10(n)},$9Bu:function(n){var t=this.$O8.$K0;var i=n.$6E(t.get_$10());if(i<0)return!1;if(i>72e5||i%18e5){t.set_$154(-2);t.set_$23(n)}else t.set_$154(i);return!0},$7WE:function(n){var t=new _d.$lq(n,!0);this.$O8.set_$Se(t)},$8mD:function(n){var t=new _d.$nV(n);this.$O8.set_$Se(t)},$2hU:function(){return this.$O8.$1oK?"HTML":"Text"},$2A6:function(){var n=this.$O8.$l.$r.get_$i();return n?n.Id:null},$50A:function(){return this.$O8.$l.$r.get_$Hj().get_$9JV()},$96r:function(){var n=new _y.$XH(null);this.$O8.set_$Se(n)},$6xP:function(n){var t=new _y.$XH(n);this.$O8.set_$Se(t)}};_d.$7e=function(n){_d.$7e.initializeBase(this);if(!$8(n)){$8(n.$r.$Gg)||n.$r.$Gg.$s();this.set_$7F(n.$r.$46());this.set_$1K2(n.$6S.$46())}};_d.$7e.$$cctor=function(){_d.$7e.$2Yk.set_$FQ(new _a.$DB(_d.$CD))};_d.$7e.prototype={get_$7F:function(){return this.$W(_d.$7e.$1gm)},set_$7F:function(n){this.$N(_d.$7e.$1gm,n);return n},get_$1K2:function(){return this.$W(_d.$7e.$3zb)},set_$1K2:function(n){this.$N(_d.$7e.$3zb,n);return n},get_$2Yj:function(){return this.$W(_d.$7e.$2Yk)},set_$2Yj:function(n){this.$N(_d.$7e.$2Yk,n);return n},get_$CK:function(){return this.$W(_d.$7e.$1n9)},set_$CK:function(n){this.$N(_d.$7e.$1n9,n);return n},get_$29O:function(){return this.$W(_d.$7e.$3YP)},set_$29O:function(n){this.$N(_d.$7e.$3YP,n);return n},get_$1tl:function(){return!$8(this.get_$1K2())&&!$8(this.get_$1K2().get_$i())?[this.get_$1K2()]:null}};_d.$CH=function(n,t,i,r,u){this.$$d_$8sv=Function.createDelegate(this,this.$8sv);this.$$d_$5uZ=Function.createDelegate(this,this.$5uZ);this.$$d_$77T=Function.createDelegate(this,this.$77T);_d.$CH.initializeBase(this,[t,i,r,u]);this.$2Q=n;this.$Jy=this.$8x.get_$A1();this.$3Ke="AddRoom_ComposeForm"};function $4MP(n){var t=new _h.$4S(n.$2Q.get_$10(),n.$2Q.get_$23());n.$Mo.set_$e6(n.$2Q.get_$10());n.$Mo.set_$5JH(n.$2Q.get_$10().$3u());n.$8x.set_$aD(t)}function $3Em(n){var t=n.$2Q.get_$9D();$4LF(n);t&&t.get_$F()>0?n.$8x.set_$A1(t.get_$48(0).get_$6V()):n.$8x.set_$A1(null);$4LE(n);n.$Jy=n.$8x.get_$A1();$3EO(n)}function $3Ek(n){n.set_$4q5(n.$2Q.get_$9D())}function $3El(n){n.set_$4q5(null)}_d.$CH.prototype={$2Q:null,$Jy:null,$1Qg:null,add_$8eO:function(n){this.$2Z("OnRoomSelectionChanged",n)},remove_$8eO:function(n){this.$2b("OnRoomSelectionChanged",n)},$5F:function(){if(!this.$pq){_d.$DU.prototype.$5F.call(this);$3Em(this);$4MP(this)}},$5sI:function(){_d.$DU.prototype.$5sI.call(this);this.$2Q.$a("Start",this.$$d_$77T);this.$2Q.$a("End",this.$$d_$77T);this.$2Q.$a("Resources",this.$$d_$5uZ);$3Ek(this)},$4Ev:function(){$3El(this);this.$2Q.$w("Start",this.$$d_$77T);this.$2Q.$w("End",this.$$d_$77T);this.$2Q.$w("Resources",this.$$d_$5uZ);_d.$DU.prototype.$4Ev.call(this)},get_$4q5:function(){return this.$1Qg},set_$4q5:function(n){if(this.$1Qg!==n){this.$1Qg&&this.$1Qg.remove_$1Z(this.$$d_$8sv);this.$1Qg=n;this.$1Qg&&this.$1Qg.add_$1Z(this.$$d_$8sv)}return n},$77T:function(n,t){$4MP(this)},$5xZ:function(n,t){_d.$DU.prototype.$5xZ.call(this,n,t);var i=this.$Jy;this.$Jy=this.$8x.get_$A1();$3El(this);i&&this.$2Q.get_$9D().get_$F()>0&&this.$2Q.get_$9D().get_$48(0).get_$6V().EmailAddress===i.EmailAddress&&this.$2Q.get_$9D().$67(0);this.$Jy&&this.$2Q.get_$9D().$6z(0,_g.$3X.$rO(this.$Jy));$3Ek(this);var r=this.$eX("OnRoomSelectionChanged");r&&r(i,this.$Jy)},$5uZ:function(n,t){$3El(this);$3Ek(this);$3Em(this)},$8sv:function(n,t){$3Em(this);t.$3R===2&&t.$3Y.length===1&&t.$3Y[0].get_$6V().Name===this.$2Q.get_$4h().get_$1l()&&this.$2Q.set_$4h(_g.$3G.$qo())}};_d.$k5=function(n,t,i,r){this.$294=n;this.$3C5=t;this.$1x1=i;this.$G=r};_d.$k5.prototype={$3C5:null,$1x1:null,$294:null,$G:null,$I:function(n){var u=_c.$1S.$4oL(!0);var t=this.$3C5.$I(n,u);var r=this.$1x1.$4oI(n,t);var i=this.$1x1.$I(n,t,r);t.set_$5wT(i);var f=this.$294.$746(i,r);return new _d.$CH(n.$r,t,i,f,this.$G)}};_d.$IA=function(n,t,i,r,u,f){this.$$d_$3yi=Function.createDelegate(this,this.$3yi);this.$$d_$5kF=Function.createDelegate(this,this.$5kF);this.$$d_$8S7=Function.createDelegate(this,this.$8S7);this.$$d_$3Xo=Function.createDelegate(this,this.$3Xo);this.$$d_$34q=Function.createDelegate(this,this.$34q);this.$$d_$5Fw=Function.createDelegate(this,this.$5Fw);_d.$IA.initializeBase(this);this.$G=r;this.$p=u;this.$2Q=n;this.$66=i;this.$1LI=t;this.$3kY=new _C(this.$$d_$5Fw,_a.$0.$cl);this.$1K=f;var e=this;this.$34p=new _C(this.$$d_$34q,_a.$0.$1o,this,"IsRecipientWellPopulated",function(){return e.get_$5Cb()})};function $4MQ(n){if(n.$2Bp){n.$JR=new _d.$xK(n.$Bm,n.$2Bp,n.$p,n.$1K);$2Tm(n)}}function $2Tm(n,t){n.$JR&&n.$JR.$12a(t)}_d.$IA.prototype={$2Q:null,$G:null,$66:null,$1LI:null,$3kY:null,$p:null,$34p:null,$1K:null,$Bm:null,$2Bp:null,$JR:null,$2XR:null,$3BS:null,$No:null,get_$43N:function(){return this.$Bm},set_$43N:function(n){if(this.$Bm===n)return n;if(this.$Bm){this.$Bm.$36.$w("QueryString",this.$$d_$3Xo);this.$Bm.remove_$jN(this.$$d_$8S7);this.$Bm.$36.set_$2c9(null);this.$Bm.$1L.remove_$1Z(this.$$d_$5kF);this.$Bm.$1M()}this.$Bm=n;if(this.$Bm){this.$Bm.$36.$a("QueryString",this.$$d_$3Xo);this.$Bm.add_$jN(this.$$d_$8S7);this.$Bm.$36.set_$2c9(this.$34p);this.$Bm.$1L.add_$1Z(this.$$d_$5kF);$4MQ(this);this.$3Xo()}$6(this,"RecipientWellViewModel");return n},$3v:function(n){this.set_$43N(this.$66.$I());this.$Bm.$3v(this.$2Q,n)},get_$7Ui:function(){return this.$2Bp},set_$7Ui:function(n){if(this.$2Bp!==n){this.$2Bp=n;$4MQ(this)}return n},get_$iB:function(){return this.$Bm.$1GT||!_js.$8.$c(this.$Bm.$36.$2k)},get_$5Cb:function(){return!!this.$Bm&&(this.$Bm.$1L.get_$F()>0||!_js.$8.$c(this.$Bm.$36.$2k))},$34q:function(n,t){$2Tm(this);this.$2XR=n;this.$3BS=t;this.$Bm.$1kO()},$59:function(){this.set_$43N(null);if(this.$No){this.$No.remove_$1af(this.$$d_$3yi);this.$No.$1M();this.$No=null}_a.$1.prototype.$59.call(this)},$8S7:function(n){$2Tm(this,!0);if(n){if(this.$2XR){this.$2XR();this.$2XR=null}}else if(this.$3BS){this.$3BS();this.$3BS=null}},$5Fw:function(){this.$Bm.$15P();_a.$b.$8E.$H("VM.PeoplePicker.Launched",_a.$7.get_$2M());if(this.$No)this.$No.$69X(this.$Bm.get_$40q());else{this.$No=this.$1LI.$4pF(this.$Bm.get_$40q(),_u.Strings.l_RichPeoplePickerRequired_Text);this.$No.add_$1af(this.$$d_$3yi)}this.$G.$9T(this.$No)},$3yi:function(n){this.$Bm.set_$40q(n)},$3Xo:function(n,t){$6(this,"IsRecipientWellPopulated")},$5kF:function(n,t){$2Tm(this);this.$3Xo()}};_d.$pc=function(n){this.$19u=new(_0365f.$s.$$(_y.$28));this.$19u.$H(n)};_d.$pc.prototype={$19u:null,get_$Vc:function(){return this.$19u}};_d.$xK=function(n,t,i,r){_d.$xK.initializeBase(this,[t]);this.$Bm=n;this.$3lq=new _d.$3w(i,new _d.$pc(n),t,r);this.$3lq.$3v()};_d.$xK.prototype={$Bm:null,$3lq:null,$3fK:!1,$12a:function(n){this.$3fK=n;_d.$Bt.prototype.$12a.call(this);this.$3fK=!1},$7fK:function(){this.$QH=[67]},$7HF:function(){this.$3fK&&this.$Bm.$1GT&&this.$z.$2r(67);this.$3lq.$39O()}};_d.$k6=function(n,t,i,r,u){this.$66=n;this.$1LI=t;this.$G=i;this.$p=r;this.$1K=u};_d.$k6.prototype={$1K:null,$G:null,$p:null,$66:null,$1LI:null,$I:function(n){return new _d.$IA(n,this.$1LI.get_$1d(),this.$66,this.$G,this.$p,this.$1K)}};_d.$k7=function(n,t,i,r){_d.$k7.initializeBase(this,[r]);this.$2Q=n;this.$1np=t;this.$28J=i};function $6LX(n){if(!n.$1np)if(n.$2Q.get_$ZC())n.$z.$2r(4800);else if(n.$2Q.get_$Ef()&&n.$28J.$2K){var t=n.$28J.get_$N5();n.$z.$Mk(4700,null,_u.Strings.l_EditSeries_Text,t)}}_d.$k7.prototype={$2Q:null,$1np:!1,$28J:null,$7fK:function(){this.$QH=[6200,4600,975,4800,4700]},$7HF:function(){this.$2Q.get_$Hm()&&this.$2Q.get_$1o()&&!this.$2Q.get_$4vf()&&this.$z.$2r(975);$3Ec(this,this.$2Q,!0);$6LX(this)}};_d.$TB=function(n){this.$3l=n||{}};_d.$TB.prototype={$3l:null,get_$2h:function(){return this.$3l.Subject},set_$2h:function(n){this.$3l.Subject=n;return n},get_$4h:function(){return this.$3l.Location},set_$4h:function(n){this.$3l.Location=n;return n},get_$3c:function(){return this.$3l.Body},set_$3c:function(n){this.$3l.Body=n;return n},get_$10:function(){return this.$3l.Start},set_$10:function(n){this.$3l.Start=n;return n},get_$29O:function(){return this.$3l.ForceDirty?Boolean.parse(this.$3l.ForceDirty):!1},set_$29O:function(n){this.$3l.ForceDirty=n.toString();return n},get_$DE:function(){var n=this.$3l.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DE:function(n){this.$3l.Duration=n;return n},get_$1DK:function(){if($8(this.$3l.CalendarId))return null;return new _g.$3J(this.$3l.CalendarId)},set_$1DK:function(n){$8(n)?delete this.$3l.CalendarId:this.$3l.CalendarId=n.Id;return n},get_$72:function(){return this.$3l.RequiredAttendees},set_$72:function(n){this.$3l.RequiredAttendees=n;return n},get_$8A:function(){return this.$3l.OptionalAttendees},set_$8A:function(n){this.$3l.OptionalAttendees=n;return n},get_$37Q:function(){var n="Busy";if($8(this.$3l.ShowAs))return n;try{n=this.$3l.ShowAs}catch(t){}return n},set_$37Q:function(n){this.$3l.ShowAs=n;return n},get_$Nk:function(){return this.$3l.ReminderIsSet?Boolean.parse(this.$3l.ReminderIsSet):!0},set_$Nk:function(n){this.$3l.ReminderIsSet=n.toString();return n},get_$5m:function(){return $8(this.$3l.IsAllDayEvent)?!1:Boolean.parse(this.$3l.IsAllDayEvent)},set_$5m:function(n){this.$3l.IsAllDayEvent=n.toString();return n},$6xf:function(n){return n in this.$3l}};_d.$10=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.$$d_$8eL=Function.createDelegate(this,this.$8eL);this.$$d_$4gj=Function.createDelegate(this,this.$4gj);this.$$d_$4gi=Function.createDelegate(this,this.$4gi);this.$$d_$57e=Function.createDelegate(this,this.$57e);this.$$d_$1OB=Function.createDelegate(this,this.$1OB);this.$$d_$2z5=Function.createDelegate(this,this.$2z5);this.$$d_$8lL=Function.createDelegate(this,this.$8lL);this.$$d_$8eF=Function.createDelegate(this,this.$8eF);this.$$d_$8eG=Function.createDelegate(this,this.$8eG);this.$$d_$5H=Function.createDelegate(this,this.$5H);this.$$d_$8Ym=Function.createDelegate(this,this.$8Ym);this.$$d_$9Ev=Function.createDelegate(this,this.$9Ev);this.$$d_$304=Function.createDelegate(this,this.$304);this.$$d_$5uZ=Function.createDelegate(this,this.$5uZ);this.$$d_$6vk=Function.createDelegate(this,this.$6vk);this.$$d_$7Yw=Function.createDelegate(this,this.$7Yw);this.$$d_$8Sn=Function.createDelegate(this,this.$8Sn);this.$$d_$2bE=Function.createDelegate(this,this.$2bE);this.$$d_$5uF=Function.createDelegate(this,this.$5uF);this.$$d_$8Yc=Function.createDelegate(this,this.$8Yc);this.$$d_$9EI=Function.createDelegate(this,this.$9EI);this.$$d_$8lH=Function.createDelegate(this,this.$8lH);this.$$d_$4g4=Function.createDelegate(this,this.$4g4);this.$$d_$8RN=Function.createDelegate(this,this.$8RN);this.$$d_$587=Function.createDelegate(this,this.$587);this.$$d_$4t4=Function.createDelegate(this,this.$4t4);this.$$d_$9DB=Function.createDelegate(this,this.$9DB);this.$$d_$8df=Function.createDelegate(this,this.$8df);this.$$d_$5kG=Function.createDelegate(this,this.$5kG);this.$$d_$8Vd=Function.createDelegate(this,this.$8Vd);this.$$d_$2zJ=Function.createDelegate(this,this.$2zJ);this.$$d_$75K=Function.createDelegate(this,this.$75K);this.$$d_$3xj=Function.createDelegate(this,this.$3xj);this.$$d_$6tn=Function.createDelegate(this,this.$6tn);this.$$d_$Xj=Function.createDelegate(this,this.$Xj);this.$$d_$18u=Function.createDelegate(this,this.$18u);this.$$d_$73h=Function.createDelegate(this,this.$73h);this.$$d_$8iq=Function.createDelegate(this,this.$8iq);this.$$d_$8ip=Function.createDelegate(this,this.$8ip);this.$$d_$9G9=Function.createDelegate(this,this.$9G9);this.$$d_$9GA=Function.createDelegate(this,this.$9GA);this.$$d_$7UL=Function.createDelegate(this,this.$7UL);this.$$d_$7UO=Function.createDelegate(this,this.$7UO);this.$$d_$7UK=Function.createDelegate(this,this.$7UK);this.$$d_$3PX=Function.createDelegate(this,this.$3PX);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$8PF=Function.createDelegate(this,this.$8PF);this.$$d_$8kK=Function.createDelegate(this,this.$8kK);this.$$d_$1vb=Function.createDelegate(this,this.$1vb);this.$$d_$69p=Function.createDelegate(this,this.$69p);this.$$d_$8fm=Function.createDelegate(this,this.$8fm);this.$$d_$68q=Function.createDelegate(this,this.$68q);this.$$d_$5i=Function.createDelegate(this,this.$5i);_d.$10.initializeBase(this);this.$8T=h;this.$35Y=n;this.$2qN=t;this.$Ka=i;this.$2b5=o;this.$G=r;this.$87=u;this.$1oK=w;this.$p=s;this.$t=a;this.set_$1ob(!1);this.$3bj=!1;this.$2b9=v;this.$DD=b;this.$ON=k;this.$2bk="CreateCalendarItemDefault";this.$1r=f;this.$Xd=new _d.$NU(this.$$d_$5i,!1);this.$dO=new _y.$eK;this.$32T=2;this.$CR=c;this.$1D=l;this.$2b4=y;this.$1gj=p;this.$1kV=_d.$O9.$4oU();this.$a("BlockView",this.$$d_$68q);this.$a("IsUploadingAttachment",this.$$d_$68q);this.$a("ShowMoreDetails",this.$$d_$8fm);this.$a("IsTransitionedIn",_d.$10.$140);this.$a("IsInitialized",_d.$10.$140);this.$a("ComposeOnlineMeetingViewModel",this.$$d_$69p);var d=this;this.$1vc=new _C(this.$$d_$1vb,_d.$10.$D,this,"CanPersistChanges",function(){return d.get_$2a4()});var g=this;this.$45s=new _C(this.$$d_$8kK,_d.$10.$D,this,"CanSave",function(){return g.get_$258()});var nt=this;this.$47F=new _C(this.$$d_$8kK,_d.$10.$D,this,"CanSend",function(){return nt.get_$hO()});this.$3zL=new _C(this.$$d_$8PF,_d.$10.$D);var tt=this;this.$61v=new _C(function(){_a.$5.$1V(_a.$0.$1o,"ClickOnMoreDetailsButton");tt.set_$1Ah(!0);_a.$5.$1G(null,"ClickOnMoreDetailsButton")},_d.$10.$D);this.$Cv=new _C(this.$$d_$eC,_d.$10.$D);this.$Mr=new _C(this.$$d_$3PX,_d.$10.$D);this.$56E=new _C(this.$$d_$7UK,_d.$10.$D);this.$56H=new _C(this.$$d_$7UO,_d.$10.$D);this.$56F=new _C(this.$$d_$7UL,_d.$10.$D);this.$4Fp=new _C(this.$$d_$9GA,_d.$10.$D);this.$6AN=new _C(this.$$d_$9G9,_d.$10.$D);this.$5mY=new _C(this.$$d_$8ip,_d.$10.$D);this.$5mX=new _C(this.$$d_$8iq,_d.$10.$D);this.$ln=e.$4oR(this.$1r,this.$1vc);if(this.$G.get_$O()!=="Mouse"){var it=_a.$5.acss(_a.$0.$JB,"ApplicationBar:CreateRaw");this.set_$7E(_y.$26.$Bv(this));_a.$5.aces(it)}};_d.$10.$3a5=function(n){for(var i=new Array(n.get_$F()),t=0;t<n.get_$F();t++)i[t]=n.get_$48(t);return i.join(";")};_d.$10.$140=function(n,t){var i=n;i.$Dm&&i.$7M&&$Bc(i,"Ready",i,i)};function $6Ll(n,t){var i=t.$46();if(i.get_$5m()&&!_a.$7.$4F(i.get_$10(),i.get_$23())){i.set_$23(i.get_$23().$1CT(-1));i.$a7()}var r=n.$Ka.$8M(i);n.$4F9&&n.$4F9.$6sg(r.$r);$4Ma(n,r)}function $4Ma(n,t,i){var f=_a.$5.acsa(_a.$0.$1o,"Initialize",!0);n.set_$1gn(t);$6M7(n,n.$l.$r);n.$197=n.$l.$fv.$hi(0,!0,n.$$d_$8RN);n.$EK=n.$l.$4x.$47O;$6Li(n);$6Lj(n,i);n.set_$4ty(new _d.$Ed(n.$l.$r));n.set_$en(new _y.$8L);$6Lo(n,n.get_$EB());$4Me(n);$6M6(n);n.set_$3Nv(new _d.$EY(n.$l.$4x));$6Lm(n);n.$1wV=_d.$O9.$3S8(n.$l);$6(n,"ReminderPickerOptions");$6Lu(n);n.$68q(null,null);var r=n.$l.$r.get_$1e();var u=r?r.get_$9JV():null;var e=this;n.$DD.$I(function(t){n.$G.get_$O()==="TouchNarrow"?n.set_$5o(t.$1hr(n.$l.$r.get_$i(),u,!1,!0,null,!0,n.$z,null)):n.set_$5o(t.$1hq(n.$l.$r.get_$i(),u,!1,3,!0,null,!0,n.$z,null));n.set_$4nk(_d.$XL.$4oh(n.$G,n.$DD,n.$6I,_d.$10.$D))});var o=this;n.$ON.$I(function(t){n.set_$1jp(t.$4o6(new _d.$Jy(n),n.$$d_$4g4));n.$7e.$5F();$2Tn(n)});$6Lv(n);$2Tn(n);n.$l.$r.$a7();n.set_$49d($3Eo(n));n.set_$3fZ($3En(n));$6Lh(n);$6Ln(n);n.$4FG();var s=this;n.get_$IP().$1FT(function(){$6Lt(n);_a.$5.acea(f)})}function $6Lt(n){n.set_$4mM(n.$2b9.$I(n.$l.$r,n.$1r));$6Lk(n);n.set_$CL(!0);$6(n,"BlockView")}function $6Lm(n){n.set_$7fa(n.$2qN.$I(n.$l,n.$$d_$8lH,n.get_$3L()));n.$RS.$a("Location",n.$$d_$9EI);n.$3bn=$4MS(n)}function $3Ep(n){if(n.$G.get_$O()!=="Mouse")throw Error.invalidOperation("Compose view can only be popped out in MUI");if(!n.$G.get_$6Q())throw Error.invalidOperation("Compose view can only be popped out from the main window");}function $6M6(n){n.$Xd.set_$aI(n.$G.get_$O()==="Mouse"&&n.$G.get_$6Q());$6(n,"ShowPopOutControl")}function $6Lc(n){var t=new _d.$7e(n.$l);t.set_$CK(n.$l.$Z9);t.set_$2Yj(n.$U3.$Bm.$7IM());return t}function $2Tn(n){n.$G.get_$O()==="Mouse"?$6M5(n):$6M4(n);n.$Xj()}function $4Mb(n){n.set_$3Q9(new _d.$40(n.$l.$Cm,n.get_$IP().$1Sj(n.$l.$r.get_$5Z()),n.$1r,n.$G));n.$Ct.set_$1X(!1);n.$Ct.set_$93y(!n.$l.$r.get_$Ef())}function $6Lj(n,t){n.$U3=n.$2b5.$I(n.$l.$r);var i=!t||!t.get_$2Yj()||!t.get_$2Yj().get_$F()?null:t.get_$2Yj();n.$U3.$3v(i)}function $6Ln(n){_a.$5a.$2x&&(n.$1vn=new _d.$xO(n,n.$p,n.$G))}function $6Lv(n){n.$G.add_$Nm(n.$$d_$Xj);n.$G.add_$U5(n.$$d_$2bE);n.$G.add_$12X(n.$$d_$8Sn)}function $6M3(n){n.$G.remove_$Nm(n.$$d_$Xj);n.$G.remove_$U5(n.$$d_$2bE);n.$G.remove_$12X(n.$$d_$8Sn)}function $6Lu(n){n.$l.$r.$a("IsEventAMeeting",n.$$d_$7Yw);n.$l.$r.$a("Calendar",n.$$d_$6vk);n.$l.$r.$a("Resources",n.$$d_$5uZ);n.$l.$4x.add_$2m(n.$$d_$304);n.$l.$r.$a("Location",n.$RS.$$d_$7fZ);n.$l.$r.$a("Start",n.$$d_$9Ev);n.$l.$r.$a("IsAllDayEvent",n.$$d_$8Ym);n.$l.$4x.$a("CanSend",n.$$d_$68q);n.$l.$4x.$a("CanSave",n.$$d_$68q);n.$l.$a("IsDraft",n.$$d_$69p)}function $6M2(n){n.$l.$r.$w("IsEventAMeeting",n.$$d_$7Yw);n.$l.$r.$w("Calendar",n.$$d_$6vk);n.$l.$r.$w("Resources",n.$$d_$5uZ);n.$l.$4x.remove_$2m(n.$$d_$304);n.$l.$r.$w("Location",n.$RS.$$d_$7fZ);n.$l.$r.$w("Start",n.$$d_$9Ev);n.$l.$r.$w("IsAllDayEvent",n.$$d_$8Ym);n.$l.$4x.$w("CanSend",n.$$d_$68q);n.$l.$4x.$w("CanSave",n.$$d_$68q);n.$l.$w("IsDraft",n.$$d_$69p)}function $4MZ(n,t){for(var f=new _js.$X,e=n.get_$IP().get_$px(),r=0;r<e.get_$F();++r)for(var o=e.get_$48(r),u=0;u<o.get_$Bd().get_$F();u++){var i=o.get_$Bd().get_$48(u);if((!_g.$9b.isInstanceOfType(i)||!i.get_$1nz())&&(!t||$4Md(n,i,t.EmailAddress))){var s=n.get_$IP().$xS(i.get_$AC());s.$2Zw(i)&&f.$H(s)}}return f}function $4Md(n,t,i){if(_g.$Di.isInstanceOfType(t)&&!t.get_$16Q())return n.$t.get_$38().get_$Br()===i;if(_g.$9b.isInstanceOfType(t)){var r=t;return!r.get_$1nz()&&r.get_$DQ()===i}return!1}function $3En(n){var t=n.$1dX?n.$1dX.get_$F():0;return t<2?!1:n.$l.$r.get_$10N()?!1:n.$l.get_$1Gu()?!0:n.$l.$r.get_$Hm()?!1:n.get_$7YB()?!n.$l.$r.get_$Ef():!1}function $3Eo(n){return n.$l.$r.get_$Hm()&&n.$l.$r.get_$4vf()}function $6Lk(n){n.$l.$r.get_$22()||n.$l.$r.set_$5Z(n.get_$IP().get_$wV());$6Ls(n)}function $6Ls(n){var t=n.$l.$r.get_$1o();if(t){if(!t.$2Zw(n.$l.$r.get_$5Z())){_js.Trace.logInfo(_d.$10.$D,"Cannot create content on Calendar:{0}. Reverting to DefaultCalendar",n.$l.$r.get_$1o().get_$1l());n.$l.$r.set_$5Z(n.get_$IP().get_$wV());n.$l.$6S.set_$5Z(n.get_$IP().get_$wV())}}else{var i=[_u.Strings.l_ErrorCalendarActionFailed_Text,_u.Strings.l_ErrorAccessDenied_Text];_a.$6R.$S5(i,0,n.$$d_$5H);return}$4Mh(n);n.$l.$r.$a7();n.$69p();n.$56v();$4Mb(n)}function $6Lo(n,t){switch(n.$G.get_$O()){case"Mouse":n.set_$1Ah(!0);break;default:n.$G.get_$6Q()?n.set_$1Ah(!t):n.set_$1Ah(!0);break}}function $12x(n,t,i,r){n.$Aw.set_$1hU(t);n.$Aw.set_$3QF(i);n.$Aw.set_$2bF(r);n.$302&&n.$302.$s()}function $6Ly(n){if(!n.$3dK&&_js.$8.$c(n.$l.$r.get_$2h())){$12x(n,n.$l.$r.get_$Hm()?_u.Strings.l_NoMeetingTitle_Text:_u.Strings.l_NoEventTitle_Text,n.$l.get_$1Bh()?_u.Strings.l_AreYouSureYouWantToSendThisEventToAttendees_Text:_u.Strings.l_AreYouSureYouWantToSaveTheEventWithoutATitle_Text,n.get_$7CH());n.$Aw.set_$Lf(!0);return!0}return!1}function $6Lz(n){if(!n.$3dM&&_d.$6N.$1nU(n.$l.$r)&&n.$l.get_$1Bh()){$12x(n,_u.Strings.l_EventOccursInThePastTitle_Text,_u.Strings.l_AreYouSureYouWantToSendThisEventToAttendees_Text,n.get_$7DS());n.$Aw.set_$Lf(!0);return!0}return!1}function $6M1(n){if(!n.get_$EB()&&n.$l.get_$9Gs()&&!$6Lp(n)){if(!n.get_$1mm()&&!n.$3bj){$12x(n,_u.Strings.l_Calendar_Compose_NoChanges_Text,_u.Strings.l_Calendar_Compose_NoChanges_Description_Text,n.get_$8ws());n.$Aw.set_$Lf(!0);return!0}if(n.$l.get_$7S9()){$12x(n,_u.Strings.l_SendUpdateToAttendees_Text,"",n.get_$8wt());n.$Aw.set_$Lf(!0);return!0}}return!1}function $6M0(n){if(!n.$3dN&&!n.get_$EB()&&n.$l.$6S.get_$Jh()&&!n.$l.$6S.get_$Jh().$4W(n.$l.$r.get_$Jh())){$12x(n,_u.Strings.l_ExceptionsLostWarning_Text,"",n.get_$7fz());n.$Aw.set_$Lf(!0);return!0}return!1}function $6Lp(n){return!!n.$l.$r.get_$10()&&!n.$l.$r.get_$10().$4W(n.$l.$6S.get_$10())||!!n.$l.$r.get_$23()&&!n.$l.$r.get_$23().$4W(n.$l.$6S.get_$23())||!$8(n.$l.$r.get_$Cz())&&n.$l.$r.get_$Cz()!==n.$l.$6S.get_$Cz()||!$8(n.$l.$r.get_$5m())&&n.$l.$r.get_$5m()!==n.$l.$6S.get_$5m()||n.$RS.$1UC||!!n.$l.$r.get_$4h()&&!n.$l.$r.get_$4h().$4W(n.$l.$6S.get_$4h())||!!n.$l.$r.get_$Jh()&&!n.$l.$r.get_$Jh().$4W(n.$l.$6S.get_$Jh())||!n.$l.$r.get_$Jh()&&!!n.$l.$6S.get_$Jh()}function $4Mi(n,t,i){n.$U3.$34q(t,i)}function $3Eq(n,t){n.$RS.$4FJ();if(n.$l.$r.get_$5m()){n.$l.$r.set_$10(n.$K0.$lF.$2G);n.$l.$r.set_$23(n.$K0.$lF.$2w.$9b(-1))}var i=null;var r="";if(n.$EK.$2K){i=_d.$1Cp.$1o.$YZ.$63y(!0,n.get_$Uk(),n.$G.get_$O(),!n.get_$aI(),!n.$11g);r=_d.$1Cp.$1o.$YZ.$2cf(t,n.get_$EB(),n.get_$Uk(),n.$l,n.$K0,n.$Ct);n.$l.$4x.$DX=$4MV(n);n.$EK.$s();n.set_$3Q3(_u.Strings.l_Sending_Text);n.set_$1ob(!0);var u=this;n.$l.$4x.add_$2m(function(n,t){if(n==="PersistActionFailed"){var u=!t||!t.$1b||_js.$8.$14(t.$1b.message)?"Failed":t.$1b.message;_d.$1Cp.$1o.$YZ.$2fM(i,u,null,r)}else n==="SendCalendarItemAction"&&_d.$1Cp.$1o.$YZ.$2fM(i,"",null,r)})}else if(n.$l.$4x.$DS.$2K){i=_d.$1Cp.$1o.$YZ.$63y(!1,n.get_$Uk(),n.$G.get_$O(),!n.get_$aI(),!n.$11g);r=_d.$1Cp.$1o.$YZ.$2cf(t,n.get_$EB(),n.get_$Uk(),n.$l,n.$K0,n.$Ct);n.$l.$4x.$DX=$4MV(n);n.$l.$4x.$DS.$s();n.set_$3Q3(_u.Strings.l_Saving_Text);n.set_$1ob(!0);var f=this;n.$l.$4x.add_$2m(function(n,t){if(n==="PersistActionFailed"){var u=!t||!t.$1b||_js.$8.$14(t.$1b.message)?"Failed":t.$1b.message;_d.$1Cp.$1o.$YZ.$2fM(i,u,null,r)}else n==="SaveCalendarItemAction"&&_d.$1Cp.$1o.$YZ.$2fM(i,"",null,r)})}else _js.Trace.logError(_d.$10.$D,"Neither saveCommand nor sendCommand had their canExecute properties equals to true and thus neither got executed.");n.$sJ&&n.$RS.$6r3(n.$l.$r.get_$4h())}function $4MV(n){var t;t=n.$l.$r.get_$EB()?String.format("CreateCalendarItem.ComposeForm.{0}",n.$G.get_$O()):String.format("UpdateCalendarItem.ComposeForm.{0}",n.$G.get_$O());return t}function $4MT(n){if(n.$3bn){$12x(n,_u.Strings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_u.Strings.l_OverwriteLocationDescription_Text].concat([n.$l.$r.get_$4h().get_$1l(),_d.$10.$3a5($4MX(n))])),n.get_$8is());n.$Aw.set_$Lf(!0);return}$3Er(n)}function $3Er(n){var t=null;var i=n.$l.$r.get_$9D();if(i&&i.get_$F()>0){var r=n.$l.$r.get_$9D().get_$48(0);t=_g.$3G.$74G(r);t.set_$df(_d.$10.$3a5($6Le(n)))}n.$l.$r.set_$4h(t)}function $4Mg(n){n.$l.$r.set_$4h(_g.$3G.$wE(_u.Strings.l_OnlineMeetingDisplayLocation_Text))}function $4MS(n){var i=$4MX(n);var r=$6Lg(n,n.$RS.$4c.get_$1l());if(i.get_$F()!==r.get_$F())return!0;for(var t=0;t<i.get_$F();t++)if(i.get_$48(t)!==r.get_$48(t))return!0;return!1}function $4MX(n){return $4MY(n,0)}function $6Le(n){return $4MY(n,1)}function $4MY(n,t){var r=new(_a.$3Y.$$(String));var u=n.$l.$r.get_$9D();if(u)for(var i=t;i<n.$l.$r.get_$9D().get_$F();i++){var f=n.$l.$r.get_$9D().get_$48(i);r.$H(f.get_$6V().Name)}return r}function $6Lg(n,t){var r=new(_a.$3Y.$$(String));if(t)for(var e=t.split(";"),u=e,o=u.length,i=0;i<o;++i){var f=u[i];_js.$8.$14(f)||r.$H(f.trim())}return r}function $4Me(n){var t=_d.$6N.$3ar(n.$l.$r)+1;n.set_$6ts(t>1?String.format(_u.Strings.l_ManyAttendees_Caps_Text,t):_u.Strings.l_Calendar_Compose_AddAttendees_Text)}function $4Mf(n,t,i){if(i!=="defaultMode"){_js.Trace.logError(_d.$10.$D,"Compose is only supported on CalendarItemRequestMode.DefaultMode. RequestMode:{0}",i);return}n.set_$1Ah(!0);var u=_a.$5.acss(_a.$0.$Ag,"RetrieveCalendarItem");var r="HTML";n.$1oK||(r="Text");n.$aw=n.$8T.$1kw(300,t,n.$$d_$8eG,n.$$d_$8eF,null,r,i);_a.$5.aces(u)}function $6M7(n,t){if(n.$G.get_$O()==="Mouse"&&t.get_$3c().get_$45()!=="HTML"){var i=_js.$8.$4C("BodyType should always be HTML on Mouse Layout. Current BodyType: {0}",t.get_$3c().get_$45());_js.Trace.logError(_d.$10.$D,i);throw Error.invalidOperation("Not able to edit a meeting with this Body Type. "+i);}}function $4MU(n){n.$l.$4x.$3Ur.$2K&&n.$l.$4x.$3Ur.$s()}function $4Mc(n,t){n.set_$1Ah(!0);n.$6I.$194(t,null,null)}function $6Lq(n){var i=!0;if(n.$Ct.$Vd&&!_d.$Gs.isInstanceOfType(n.$Ct.$Vd)){var t=n.$l.$Cm.$1SX();if(t){n.$1r.$3A(0,t,null);return!1}}if(n.$l.$r.get_$Hm()&&n.$ln.$3bu(n.$l.$r,n.$6I.get_$1e()))return!1;if(_a.$5a.$2x&&n.get_$hO()&&n.$1vn&&n.$1vn.$7SJ()){_js.Trace.logInfo(_d.$10.$D,"Not valid to send since policy violation detected");n.$1r.$3A(0,n.$1vn.$7Jf(),null);return!1}return i}function $6M5(n){var t=[];var u=$6Lb(n);u.get_$F()>0&&Array.add(t,new _0365m.$Fg(_u.Strings.l_IncludeMenuButtonText_Text,null,new _0365m.$2c(u.get_$3T())));if(!n.get_$EB()){n.$l.$r.get_$1PV()&&Array.add(t,new _0365m.$n(_u.Strings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$l.$f8));var i=new(_0365f.$s.$$(_0365m.$n));n.$l.$r.get_$b4()&&i.$H(new _0365m.$n(_u.Strings.l_Reply_LowerCase_Text,null,n.$l.$Nl.$GL));n.$l.$r.get_$ds()&&i.$H(new _0365m.$n(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$l.$Nl.$Iy));n.$l.$r.get_$b3()&&i.$H(new _0365m.$n(_u.Strings.l_Forward_LowerCase_Text,null,n.$l.$Nl.$G2));i.get_$F()>0&&(i.get_$F()>1?Array.add(t,new _0365m.$Fg(_u.Strings.l_Reply_LowerCase_Text,null,new _0365m.$2c(i.get_$3T()))):Array.add(t,i.get_$48(0)))}n.$l.$r.get_$Ef()&&Array.add(t,new _0365m.$n(_u.Strings.l_OpenSeries_LowerCase_Text,null,n.$197));var r=null;if(n.$O0){r=n.$O0.$3ZC();r&&Array.add(t,r)}n.set_$3QS(t.length?new _0365m.$2c(t):null);r&&n.$CG.$a("IsShown",n.$$d_$2z5)}function $6Lb(n){var f=$4MW(n);var t=new(_0365f.$s.$$(_0365m.$n));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$H(new _0365m.$n(u.key,null,u.value))}return t}function $6La(n){var f=$4MW(n);var t=new(_0365f.$s.$$(_y.$2j));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$H(new _y.$2j(u.key,u.value))}return t}function $6Li(n){var t=this;n.$233=new _C(n.$$d_$1OB,_d.$10.$D,n,"",function(){return n.$1D.get_$3M8()&&!n.$1D.get_$5h()});var i=this;n.$1GI=new _C(n.$$d_$57e,_d.$10.$D,n,"",function(){return n.$1oK});var r=this;n.$13U=new _C(n.$$d_$4gi,_d.$10.$D,n.$CR.get_$fm(),_a.$Dk.$3OP.$1j,function(){return n.$CR.get_$fm().get_$2Zo()&&n.$1D.get_$5h()});var u=this;n.$13V=new _C(n.$$d_$4gj,_d.$10.$D,n.$CR.get_$fm(),_a.$Dk.$3Yl.$1j,function(){return n.$CR.get_$fm().get_$2hB()&&n.$1D.get_$5h()})}function $6Ld(n){n.$233.$1M();n.$233=null;n.$1GI.$1M();n.$1GI=null;n.$13U.$1M();n.$13U=null;n.$13V.$1M();n.$13V=null}function $4MW(n){var t={};n.$233.$2K&&(t[_u.Strings.l_AttachmentSubmenuItem_LowerCase_Text]=n.$233);n.$13U.$2K&&(t[_u.Strings.l_NewPhotoSubmenuItemText_Text]=n.$13U);n.$13V.$2K&&(t[_u.Strings.l_PhotoFromGallerySubmenuItemText_Text]=n.$13V);n.$1GI.$2K&&(t[_u.Strings.l_PictureSubmenuItem_LowerCase_Text]=n.$1GI);return t}function $6M4(n){var r=new(_0365f.$s.$$(_y.$2f));var e=!!n.$87&&n.$87.$7x("ComposeApps");n.get_$hO()?r.$H(new _y.$2f(_y.$c.get_$1Lr(),_y.$c.get_$36O(),_u.Strings.l_SendItemMobile_Text,n.$1vc)):r.$H(new _y.$2f(_y.$c.get_$Ey(),_y.$c.get_$2OA(),_u.Strings.l_SaveItemMobile_Text,n.$1vc));r.$H(new _y.$2f(_y.$c.get_$DT(),_y.$c.get_$8uu(),_u.Strings.l_SchedulingAssistant_AppBarButtonText_Text,n.$3zL));e&&n.$7e&&r.$H(new _y.$2f(_y.$c.get_$2YF(),_y.$c.get_$4gA(),_u.Strings.l_AppsTouch_Text,n.$7e.$1bg));r.$H(new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItemMobile_Text,n.$Cv));var t=new(_0365f.$s.$$(_y.$2j));if(!n.get_$EB()){n.$l.$4x.get_$U8()?t.$H(new _y.$2j(_u.Strings.l_DeleteEvent_LowerCase_Text,n.$l.$4x.$Ta)):n.$l.$4x.get_$hN()&&t.$H(new _y.$2j(_u.Strings.l_CancelEvent_LowerCase_Text,n.$l.$4x.$79));n.$l.$r.get_$1PV()&&t.$H(new _y.$2j(_u.Strings.l_JoinOnlineMeeting_LowerCase_Text,n.$l.$f8))}var u=$6La(n);u.get_$F()>0&&t.$H(new _y.$2j(_u.Strings.l_IncludeMenuButtonText_Text,null,u.get_$3T()));if(n.$O0){var f=n.$O0.$7Ik();f.get_$F()>0&&t.$H(new _y.$2j(_u.Strings.l_Categorize_Text,null,f.get_$3T()))}var i=new(_0365f.$s.$$(_y.$2j));if(!n.get_$EB()){n.$l.$r.get_$b4()&&i.$H(new _y.$2j(_u.Strings.l_Reply_LowerCase_Text,n.$l.$Nl.$GL));n.$l.$r.get_$ds()&&i.$H(new _y.$2j(_u.Strings.l_ReplyAll_LowerCase_Text,n.$l.$Nl.$Iy));n.$l.$r.get_$b3()&&i.$H(new _y.$2j(_u.Strings.l_Forward_LowerCase_Text,n.$l.$Nl.$G2));i.get_$F()>0&&(i.get_$F()>1?t.$H(new _y.$2j(_u.Strings.l_Reply_LowerCase_Text,null,i.get_$3T())):t.$H(i.get_$48(0)))}n.$l.$r.get_$Ef()&&t.$H(new _y.$2j(_u.Strings.l_OpenSeries_LowerCase_Text,n.$197));n.$3t.set_$MS(r.get_$3T());n.$3t.set_$XL(t.get_$3T())}function $6Lw(n){n.set_$427(2)}function $6Lx(n){n.set_$427(1)}function $6LZ(n,t,i){var r=$6Lf(n,t===1,i);$12x(n,_u.Strings.l_Calendar_Compose_LeaveEventFormDialog_Title_Text,null,r);n.$Aw.set_$Lf(!0)}function $6Lr(n){return n.$7M&&!n.$Aw.$1Do&&n.$G7()}function $6Lf(n,t,i){var r=new _js.$X;var u;var f;if(n.$l.get_$1Bh()){u=_u.Strings.l_ConfirmDialog_Send_Text;f=_u.Strings.l_SendUpdatedEventToAttendees_Text}else{u=_u.Strings.l_ConfirmDialog_Save_Text;f=_u.Strings.l_SaveChangesMadeToThisEvent_Text}var e=this;r.$H(new _a.$2E(new _C(function(){n.$1vb();i&&i()},_d.$10.$D),u,f));var o=this;r.$H(new _a.$2E(new _C(function(){n.$4t4();i&&i()},_d.$10.$D),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$G.get_$O()==="Mouse"&&t){var s=this;r.$H(new _a.$2E(new _C(function(){n.$5i();i&&i()},_d.$10.$D),_u.Strings.l_ConfirmDialog_Popout_Text,_u.Strings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var h=this;r.$H(new _a.$2E(new _C(function(){n.$3PX();n.$1Bf=!1},_d.$10.$D),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToEventForFurtherEditing_Text));return r}function $4Mh(n){var u=n.$l.$r.get_$5Z();var t=new _g.$1m;t.MailboxType=n.$l.$r.get_$Cl().Mailbox.MailboxType;t.RoutingType=n.$l.$r.get_$Cl().Mailbox.RoutingType;if(_g.$Di.isInstanceOfType(u)){t.EmailAddress=n.$t.get_$38().get_$Br();t.Name=n.$t.get_$38().get_$Gz();n.$SV.$tj.$1l3(n.$t.get_$38().get_$1dA())}else{var i=u;t.EmailAddress=i.get_$DQ();if(i.get_$mU())t.Name=i.get_$Ca();else{var f=n.get_$IP().$4zK(i.get_$DQ());f&&(t.Name=f.get_$Ca())}n.$SV.$tj.$1l3(i.get_$2LU())}var r=new _g.$Bk;r.Mailbox=t;n.$l.$r.set_$Cl(r);n.$l.$6S.set_$Cl(r)}function $6Lh(n){n.$1Dk=n.$2b4.$I(n.$l);n.$1Dk.add_$8eO(n.$$d_$8eL);n.$1Dk.$5F()}function $6LY(n){n.$9v||n.$1M()}_d.$10.prototype={$1gj:null,$1r:null,$1kV:null,$35Y:null,$2qN:null,$G:null,$ln:null,$45s:null,$47F:null,$1vc:null,$3zL:null,$Cv:null,$61v:null,$56E:null,$56H:null,$56F:null,$Mr:null,$4Fp:null,$6AN:null,$5mY:null,$5mX:null,$CR:null,$1D:null,$1oK:!1,$Ka:null,$Xd:null,$8T:null,$t:null,$2b5:null,$2b9:null,$2b4:null,$197:null,$1GI:null,$13U:null,$13V:null,$233:null,$302:null,$2zH:null,$32T:0,$sJ:!1,$4xn:!1,$U3:null,$7M:!1,$2Cb:!1,$1yk:!1,$dO:null,$RS:null,$l:null,$O0:null,$z:null,$JR:null,$p:null,$1wV:null,$1dX:null,$K0:null,$aw:null,$Ct:null,$11g:!1,$6I:null,$SV:null,$Aw:null,$3MQ:null,$25k:null,$1aP:null,$Fw:null,$3dK:!1,$3dM:!1,$3dN:!1,$mR:!1,$EK:null,$CG:null,$3bn:!1,$4F9:null,$1Bf:!1,$1LW:null,$1zq:null,$11Z:!1,$2op:!1,$3bj:!1,$1Dk:null,$1hi:null,$DD:null,$ON:null,$7e:null,$r7:null,$2bk:null,$87:null,$1vn:null,add_$5kD:function(n){this.$2Z("Ready",n)},remove_$5kD:function(n){this.$2b("Ready",n)},get_$1jp:function(){return this.$7e},set_$1jp:function(n){if(n!==this.$7e){this.$7e=n;$6(this,"ExtensibilityViewModel")}return n},get_$3QS:function(){return this.$CG},set_$3QS:function(n){if(n!==this.$CG){this.$CG=n;$6(this,"ContextMenu")}return n},get_$7fa:function(){return this.$RS},set_$7fa:function(n){if(this.$RS!==n){this.$RS=n;$6(this,"LocationWellViewModel")}return n},get_$6ts:function(){return this.$3MQ},set_$6ts:function(n){if(this.$3MQ!==n){this.$3MQ=n;$6(this,"AttendeeLabel")}return n},get_$3L:function(){return _y.$1De.prototype.get_$3L.call(this)},set_$3L:function(n){_y.$1De.prototype.set_$3L.call(this,n);this.$RS&&(this.$RS.$2o=n);return n},get_$13i:function(){return this.$sJ||!this.get_$IP().get_$Hn()},get_$58g:function(){return this.$l.$r.get_$5m()&&this.get_$Uk()},get_$7bx:function(){return!this.$l.$r.get_$5m()&&this.get_$Uk()},get_$Uk:function(){return!$8(this.$Ct)&&!$8(this.$Ct.$Cm)&&!_d.$Gs.isInstanceOfType(this.$Ct.$Cm.get_$GK())},get_$EB:function(){return this.$l.$Z9||this.$l.get_$1Gu()},get_$Jr:function(){return this.$G.get_$O()!=="Mouse"?1:0},get_$5o:function(){return this.$6I},set_$5o:function(n){if(this.$6I!==n){if(this.$6I){this.$6I.remove_$10H(this.$$d_$73h);this.$6I.remove_$18u(this.$$d_$18u);this.$6I.remove_$4GB(this.$$d_$Xj);this.$6I.rpcl("IsInProgress",this.$$d_$6tn);this.$6I.rpcl("EditorCallContext",this.$$d_$6tn)}if(n){n.add_$10H(this.$$d_$73h);n.add_$18u(this.$$d_$18u);n.add_$4GB(this.$$d_$Xj);n.apcl("IsInProgress",this.$$d_$6tn);n.apcl("EditorCallContext",this.$$d_$6tn)}this.$6I=n;$6(this,"AttachmentWellViewModel")}return n},get_$4mM:function(){return this.$SV},set_$4mM:function(n){if(this.$SV!==n){if(this.$SV){this.$SV.remove_$5g7(this.$$d_$73h);this.$SV.remove_$3xj(this.$$d_$3xj);this.$SV.$w("IsInProgress",this.$$d_$75K);this.$SV.$1M()}if(n){n.add_$5g7(this.$$d_$73h);n.add_$3xj(this.$$d_$3xj);n.$a("IsInProgress",this.$$d_$75K)}this.$SV=n;this.$SV&&this.$SV.$tj.$1l3(this.$t.get_$38().get_$1dA());$6(this,"ComposeOnlineMeetingViewModel")}return n},get_$3Nv:function(){return this.$Aw},set_$3Nv:function(n){if(this.$Aw!==n){this.$Aw=n;$6(this,"CalendarConfirmDialogViewModel")}return n},get_$1Ah:function(){return this.$11g},set_$1Ah:function(n){if(n!==this.$11g){this.$11g=n;$6(this,"ShowMoreDetails")}return n},get_$3fZ:function(){return this.$2Cb},set_$3fZ:function(n){if(this.$2Cb!==n){this.$2Cb=n;$6(this,"IsCalendarPickerEnabled")}return n},get_$49d:function(){return this.$1yk},set_$49d:function(n){if(this.$1yk!==n){this.$1yk=n;$6(this,"ShowRequestResponses")}return n},get_$hO:function(){var n=!!this.$EK&&this.$EK.$2K;return!this.get_$13i()&&(n||this.get_$58z())},get_$258:function(){var n=!!this.$l&&this.$l.$4x.$DS.$2K;return!this.get_$13i()&&!this.get_$58z()&&n},get_$92V:function(){return this.$G.get_$O()==="Mouse"&&this.get_$EB()},get_$92k:function(){return this.$G.get_$O()==="Mouse"&&!this.get_$EB()&&!this.$l.get_$1Bh()&&this.$l.$r.get_$U8()},get_$92U:function(){return this.$G.get_$O()==="Mouse"&&!this.get_$EB()&&this.$l.get_$1Bh()&&this.$l.$r.get_$hN()},get_$1aQ:function(){return this.$1aP},set_$1aQ:function(n){this.$1aP=n;$6(this,"ResizeEditorCommand");return n},get_$CL:function(){return this.$7M},set_$CL:function(n){if(this.$7M!==n){this.$7M=n;$6(this,"IsInitialized")}return n},get_$2a4:function(){var n=!!this.$l&&(this.$l.$4x.get_$258()||this.$l.$4x.get_$hO());return n&&!this.$sJ&&!this.$2op},get_$en:function(){return this.$z},set_$en:function(n){if(this.$z!==n){this.$z&&this.$9CY(this.$z);this.$z=n;this.$z&&this.$8pi(this.$z);$6(this,"InfoBarViewModel")}return n},get_$1gn:function(){return this.$l},set_$1gn:function(n){this.$l=n;$6(this,"CalendarItemViewModel");return n},get_$3Ns:function(){return this.$O0},set_$3Ns:function(n){if(this.$O0!==n){this.$O0&&this.$O0.remove_$2aH(this.$$d_$2zJ);n&&n.add_$2aH(this.$$d_$2zJ);this.$O0=n;$6(this,"CalendarCategoryViewModel")}return n},get_$4ty:function(){return this.$K0},set_$4ty:function(n){if(this.$K0!==n){this.$K0&&this.$K0.$w("DurationSelectedValue",this.$$d_$8Vd);n&&n.$a("DurationSelectedValue",this.$$d_$8Vd);this.$K0=n;$6(this,"DurationViewModel")}return n},get_$3Q9:function(){return this.$Ct},set_$3Q9:function(n){if(this.$Ct!==n){if(this.$Ct){this.$Ct.$w("RecurrenceSelected",this.$$d_$5kG);this.$Ct.$Cm.$I9.$w("StartDate",this.$$d_$8df);this.$Ct.$Cm.$w("Model",this.$$d_$9DB);this.$9CX(this.$Ct)}this.$Ct=n;if(this.$Ct){this.$Ct.$a("RecurrenceSelected",this.$$d_$5kG);this.$Ct.$Cm.$I9.$a("StartDate",this.$$d_$8df);this.$Ct.$Cm.$a("Model",this.$$d_$9DB);this.$8ph(this.$Ct);this.$4FG()}$6(this,"ComposeRecurrenceViewModel")}return n},get_$7A3:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$1vc,this.get_$hO()?_u.Strings.l_ConfirmDialog_Send_Text:_u.Strings.l_ConfirmDialog_Save_Text,this.get_$hO()?_u.Strings.l_SendEventToAttendees_Text:_u.Strings.l_SaveChangesMadeToThisEvent_Text));var t=_u.Strings.l_YourChangesWillNotBeSaved_Text;this.$l.get_$1Bh()?t=_u.Strings.l_EventWillNotBeSent_Text:this.get_$EB()&&(t=_u.Strings.l_ThisEventWillBeDeleted_Text);n.$H(new _a.$2E(new _C(this.$$d_$4t4,_d.$10.$D),_u.Strings.l_ConfirmDialog_Discard_Text,t));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToEventForFurtherEditing_Text));return n},get_$7CH:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$56E,this.get_$hO()?_u.Strings.l_ConfirmDialog_Send_Text:_u.Strings.l_ConfirmDialog_Save_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Back_Text));return n},get_$7DS:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$56H,_u.Strings.l_ConfirmDialog_Send_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Back_Text));return n},get_$8wt:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$6AN,_u.Strings.l_JustAddedOrRemoved_Lowercase_Text,_u.Strings.l_SendUpdatesToAddedOrRemovedAttendees_Text));n.$H(new _a.$2E(this.$4Fp,_u.Strings.l_Everyone_Lowercase_Text,_u.Strings.l_SendUpdatesToAllAttendees_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_CancelAndContinueEditing_Text,_u.Strings.l_ReturnToTheEventForFurtherEditing_SentenceCase_Text));return n},get_$8ws:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$Mr,_u.Strings.l_Calendar_Compose_NoChanges_DontSend_Text));n.$H(new _a.$2E(this.$4Fp,_u.Strings.l_Calendar_Compose_NoChanges_SendAnyway_Text));return n},get_$8is:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$5mY,_u.Strings.l_Yes_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_No_Text));return n},get_$8ir:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$5mX,_u.Strings.l_Yes_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_No_Text));return n},get_$7fz:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$56F,this.get_$hO()?_u.Strings.l_ConfirmDialog_Send_Text:_u.Strings.l_ConfirmDialog_Save_Text));n.$H(new _a.$2E(this.$Mr,_u.Strings.l_ConfirmDialog_Back_Text));return n},get_$6Bv:function(){return this.$1dX},set_$6Bv:function(n){if(this.$1dX!==n){this.$1dX=n;this.set_$3fZ($3En(this));$6(this,"WritableCalendars")}return n},get_$2m5:function(){return this.$mR},set_$2m5:function(n){this.$mR=n;n&&this.$l.$r.$HB.$s();return n},get_$19W:function(){return this.$Xd.get_$19W()},get_$aI:function(){return this.$Xd.get_$aI()},get_$7Zr:function(){return this.$G.get_$6Q()},get_$427:function(){return this.$32T},set_$427:function(n){if(this.$32T!==n){this.$32T=n;$6(this,"PopupPanelSize")}return n},get_$2Ao:function(){return this.$$d_$587},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$7A8:function(){return!0},get_$1mm:function(){return this.$l.get_$1mm()||this.$4xn},get_$99C:function(){return this.$1zq},set_$99C:function(n){if(this.$1zq!==n){this.$1zq=n;if(this.$1oK)$6(this,"TextToAppend");else{this.$l.$r.$Gg&&this.$l.$r.$Gg.$s();this.$l.$r.get_$3c().set_$1d(this.$l.$r.get_$3c().get_$1d()+this.$1zq)}}return n},get_$1ob:function(){return this.$sJ},set_$1ob:function(n){if(this.$sJ!==n){this.$sJ=n;$6(this,"IsSubmitted");$6(this,"BlockView")}return n},get_$Se:function(){return this.$r7},set_$Se:function(n){this.$r7=n;$6(this,"EditorCallContext");return n},get_$58z:function(){return!!this.$U3&&this.$U3.get_$5Cb()},get_$460:function(){return this.$1LW},set_$460:function(n){this.$1LW&&this.$1LW.$1M();this.$1LW=n;return n},get_$IP:function(){return this.$8T.$2f},get_$7d2:function(){return this.$2op},set_$7d2:function(n){if(this.$2op!==n){this.$2op=n;$6(this,"IsUploadingAttachment")}return n},get_$7YB:function(){return $4Md(this,this.$l.$r.get_$5Z(),this.$t.get_$38().get_$Br())},get_$4nk:function(){return this.$1hi},set_$4nk:function(n){this.$1hi=n;$6(this,"CopyPasteViewModel");return n},get_$3Q3:function(){return this.$25k},set_$3Q3:function(n){if(this.$25k!==n){this.$25k=n;$6(this,"ComposeActionString")}return n},get_$93R:function(){return!this.$l.$r.get_$Ef()},get_$92d:function(){return this.$SV.get_$3hp()},get_$623:function(){return!!this.$l.$r.get_$10N()},get_$7XT:function(){return this.get_$93R()||this.get_$92d()||this.get_$623()||this.$1yk},$xs:function(n){var t;t=this.$Ka.$8M(n.get_$1K2());t.$9D9(n.get_$7F());t.set_$CK(n.get_$CK());this.$4xn=n.get_$29O();$4Ma(this,t,n)},$3dx:function(n){$4Mf(this,n.get_$3Vv(),n.get_$2hY())},$7V8:function(n){this.$4F9=n;$4Mf(this,n.get_$i(),"defaultMode")},$co:function(){_y.$1De.prototype.$co.call(this);this.$7M&&this.$l.$r.get_$Hm()&&this.set_$1Ah(!0)},$Fe:function(){_y.$1De.prototype.$Fe.call(this);this.$Xj()},$3xf:function(n){this.$1Bf=!1;if(this.$1Dk&&this.$G.get_$O()!=="TouchNarrow")if(n){this.set_$460(null);this.$1Dk.$5F()}else this.$1Dk.$6e()},$8lL:function(){if(!this.$1LW)throw Error.invalidOperation("Cannot pop out scheduling when scheduling is not active.");$3Ep(this);var n=new _d.$3H(this.$l,this.$1LW.$j);n.set_$CK(this.$l.$Z9);this.$5H();this.$G.$L9(_d.$Aq,null,null,_y.$3p.get_$eK(),n,!1)},$8lH:function(){if(!this.$RS||!_d.$5w.isInstanceOfType(this.get_$3L().get_$7L()))throw Error.invalidOperation("Cannot pop out place picker when it is not active or available.");$3Ep(this);var n=new _d.$87(this.$l,this.$RS.get_$1Zc());n.set_$CK(this.$l.$Z9);this.$5H();this.$G.$L9(_d.$Aq,null,null,_y.$3p.get_$eK(),n,!1)},$G7:function(){return!this.$sJ&&!this.$1Bf&&this.get_$1mm()},$56v:function(){this.set_$3Ns(this.$1gj.$8M(this.$l.$r));$2Tn(this)},$73h:function(){this.$l.get_$1Gu()&&this.$l.$4x.$5wJ.$s()},$5i:function(){$3Ep(this);_a.$5.$1V(_a.$0.$1o,"PopoutCalendarComposeForm");var n=$6Lc(this);this.$Aw.set_$Lf(!0);this.$5H();this.$G.$L9(_d.$Aq,null,null,_y.$3p.get_$eK(),n,!1);_a.$5.$1G(null,"PopoutCalendarComposeForm")},$9FS:function(){this.$4FG();$4Me(this);this.set_$3fZ($3En(this));this.set_$49d($3Eo(this))},$8pi:function(n){this.$U3.set_$7Ui(n);n.$a("Count",this.$$d_$8Yc);this.$JR=new _d.$k7(this.$l.$r,this.get_$EB(),this.$197,this.$z);this.$K0.$a("Start",this.$JR.$$d_$9E1);this.$K0.$a("End",this.$JR.$$d_$9E1);this.$K0.$a("IsAllDayEvent",this.$JR.$$d_$9E1);this.$l.$r.$a("Calendar",this.$JR.$$d_$9E1)},$9CY:function(n){this.$K0.$w("Start",this.$JR.$$d_$9E1);this.$K0.$w("End",this.$JR.$$d_$9E1);this.$K0.$w("IsAllDayEvent",this.$JR.$$d_$9E1);this.$l.$r.$w("Calendar",this.$JR.$$d_$9E1);n.$w("Count",this.$$d_$8Yc)},$8ph:function(n){n.$Cm.$I9.$a("EndDate",this.$JR.$$d_$9E1);n.$Cm.$a("RecurrencePattern",this.$JR.$$d_$9E1)},$9CX:function(n){n.$Cm.$I9.$w("EndDate",this.$JR.$$d_$9E1);n.$Cm.$w("RecurrencePattern",this.$JR.$$d_$9E1)},$4FG:function(){this.$JR.$12a()},$59:function(){if(this.$7M){$6Ld(this);this.$U3.$1M();$6M2(this);this.$RS.$w("Location",this.$$d_$9EI);this.set_$3Q9(null);this.set_$en(null);this.set_$3Ns(null);this.set_$4ty(null);this.set_$5o(null);this.set_$4mM(null);this.set_$460(null)}this.$7e&&this.$7e.$6e();if(this.$aw){this.$aw.$1M();this.$aw=null}this.$w("BlockView",this.$$d_$68q);this.$w("IsUploadingAttachment",this.$$d_$68q);this.$w("ShowMoreDetails",this.$$d_$8fm);this.$w("IsTransitionedIn",_d.$10.$140);this.$w("IsInitialized",_d.$10.$140);this.$w("ComposeOnlineMeetingViewModel",this.$$d_$69p);$6M3(this);_a.$1.prototype.$59.call(this)},$587:function(n,t){var i=!0;var r=!i;if($6Lr(this)){$6LZ(this,t,n);return i}$6LY(this);return r},$2bE:function(n){this.$11Z||this.$G7()&&n.$1OY(_u.Strings.l_Calendar_BrowserWindowUnloadWarning_Text);this.$11Z=!0;_js.$K.get_$L().$21(_a.$0.$1o,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$5uF,100)},$8Sn:function(){this.$sJ||$4MU(this)},$18u:function(n){this.$3bj=!0;_a.$5a.$2x&&this.$2Ru(8)},$6tn:function(n,t){t==="IsInProgress"?this.set_$7d2(this.$6I.get_$Ik()):t==="EditorCallContext"&&this.set_$Se(this.$6I.get_$Se())},$2Ru:function(n){_a.$5a.$2x&&this.$1vn&&this.$l&&this.$1vn.$2Ru(this.$6I,this.$l.$r,n)},$75K:function(n,t){this.set_$3Q3(this.$SV.$X6?_u.Strings.l_OnlineMeetingCreationInProgress_Text:"");this.set_$1ob(this.$SV.$X6)},$3xj:function(n){this.$l.$r.set_$i(_0365f.$2t.$46(this.$l.$6S.get_$i()));if(this.$l.$r.get_$4h()&&!_js.$8.$c(this.$l.$r.get_$4h().get_$1l())){$12x(this,_u.Strings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_u.Strings.l_OverwriteLocationDescription_Text].concat([this.$l.$r.get_$4h().get_$1l(),_u.Strings.l_OnlineMeetingDisplayLocation_Text])),this.get_$8ir());this.$Aw.set_$Lf(!0)}else $4Mg(this);this.set_$99C(n.$7HS(this.$1oK))},$8RN:function(){this.$1M()},$68q:function(n,t){$6(this,"CanPersistChanges");$6(this,"CanSave");$6(this,"CanSend");$2Tn(this)},$8Ym:function(n,t){if(this.$l.$r.get_$5m()){this.$l.$r.set_$92("Free");this.$l.set_$cs(_d.$6N.$1Jf)}else{this.$l.$r.set_$92("Busy");this.$l.set_$cs(this.$t.get_$1t().get_$1jb()?this.$t.get_$1t().get_$3Tr():_d.$6N.$1Jf)}$4Z(this,"IsAllDayAndRecurring","IsRecurringAndNotAllDay")},$69p:function(n,t){this.$l.$Z9||!this.get_$EB()?this.set_$6Bv($4MZ(this,this.$l.$r.get_$Cl().Mailbox)):this.set_$6Bv($4MZ(this,null))},$3PX:function(){this.$Aw.$Mr.$s();this.$3dM=!1;this.$3dK=!1;this.$3dN=!1;this.$2zH&&this.$2zH.$s()},$7UK:function(){this.$3dK=!0;this.$Aw.$Mr.$s();this.$1vb()},$7UO:function(){this.$3dM=!0;this.$Aw.$Mr.$s();this.$1vb()},$7UL:function(){this.$3dN=!0;this.$Aw.$Mr.$s();this.$1vb()},$9GA:function(){this.$EK=this.$l.$4x.$47O;this.$Aw.$Mr.$s();$3Eq(this)},$9G9:function(){this.$EK=this.$l.$4x.$5yI;this.$Aw.$Mr.$s();$3Eq(this)},$8kK:function(){this.$1vb(!0)},$1vb:function(n){var t=this;var r=function(){if($6Lq(t)&&!$6Ly(t)&&!$6Lz(t)&&!$6M1(t)&&!$6M0(t)){t.$Aw.set_$Lf(!1);$3Eq(t,n)}};var i=this;var u=function(){i.$Mr.$2K&&i.$Mr.$s()};this.$Aw.set_$Lf(!1);$4Mi(this,r,u)},$7Yw:function(n,t){this.set_$1Ah(!0);this.$9FS()},$6vk:function(n,t){$4Mh(this);var i=$3Eo(this);this.$56v();$4Mb(this);this.$l.$r.set_$Cz(i);this.set_$49d(i)},$5uZ:function(n,t){$4MT(this)},$8ip:function(){$3Er(this);this.$Aw.set_$Lf(!1)},$8iq:function(){$4Mg(this);this.$Aw.set_$Lf(!1)},$8Yc:function(n,t){this.$Xj()},$8Vd:function(n,t){this.$Xj()},$5kG:function(n,t){this.$Ct.$Vd&&!_d.$RA.isInstanceOfType(this.$Ct.$Vd)&&_u.Strings.l_EditPattern_Text===this.$Ct.$Vd&&this.$Ct.set_$1X(!0);this.$Xj();$Nu(this,"IsAllDayAndRecurring","IsRecurring","IsRecurringAndNotAllDay")},$9DB:function(n,t){this.$l.$r.get_$1L0()?this.$l.$r.set_$Ju("RecurringMaster"):this.$l.$r.set_$Ju("Single")},$8df:function(n,t){var i=this.$K0.get_$10().$6E(this.$K0.get_$10().$3u());this.$K0.set_$10(this.$Ct.$Cm.$I9.$5f.$3u().$9b(i))},$8fm:function(n,t){this.$11g?$6Lx(this):$6Lw(this)},$8eF:function(n){_c.$5Q.$3Yy(n,this.$$d_$5H)},$8eG:function(n){var t=_a.$5.acss(_a.$0.$Ag,"LoadExistingCalendarItem");$6Ll(this,n);_a.$5a.$2x&&this.$2Ru(32);_a.$5.aces(t)},$304:function(n,t){if(this.get_$8K()&&(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="SaveCalendarItemAction"||n==="SendCalendarItemAction"||n==="MoveCalendarItemAction")){this.$5H();$Bc(this,"EditingCompleted",n,null)}else if(n==="SaveDraftCalendarItemAction"){this.$l.set_$CK(!0);this.$l.$r.set_$i(this.$l.$6S.get_$i());this.$6I&&this.$6I.$1aB(this.$l.$r.get_$i(),this.$l.$r.get_$1e().get_$9JV(),null);this.$SV&&this.$SV.$9Cz(this.$l.$r)}else n==="PersistActionFailed"&&this.set_$1ob(!1)},$eC:function(){this.$RS.$4FJ();if(this.get_$1mm()||this.$U3.get_$iB()){$12x(this,_u.Strings.l_CloseEventForm_Text,null,this.get_$7A3());this.$Aw.set_$Lf(!0)}else this.$5H()},$4t4:function(){_a.$5.$1V(_a.$0.$1o,"DiscardComposeChanges");$4MU(this);this.$Aw.$Mr.$s();this.$5H();_a.$5.$1G(null,"DiscardComposeChanges")},$5H:function(){this.$1Bf=!0;this.get_$8K()();this.$9v||this.$1M()},$8PF:function(){_a.$5.$1V(_a.$0.$1o,"OpenSchedulingAssistantForm_ResolveAttendees");var n=this;var t=function(){_a.$5.$1G(null,"OpenSchedulingAssistantForm_ResolveAttendees","",null,null);var t=_d.$1Cp.$1o.$GM.$96J(n.$G.get_$O()==="Mouse"&&!n.get_$aI());n.set_$460(n.$35Y.$I(n.$l,n.$K0,n.$$d_$8lL,!1,n.get_$EB(),t));var i=n.$G.get_$O()==="TouchNarrow"?n.$1LW.$14l:n.$1LW;n.get_$3L().$B9(i)};var r=this;var i=function(){_a.$5.$1G(null,"OpenSchedulingAssistantForm_ResolveAttendees","Attendees cannot be resolved",null,"Attendees cannot be resolved")};$4Mi(this,t,i)},$1OB:function(){$4Mc(this,!1)},$57e:function(){$4Mc(this,!0)},$4gi:function(){this.$6I.$5lZ(this.$CR)},$4gj:function(){this.$6I.$5lh(this.$CR)},$9Ev:function(n,t){var i=this.$l.$r.get_$10().$3u();_a.$7.$4F(this.$l.$Cm.$I9.$5f.$3u(),i)||this.$l.$Cm.$I9.set_$7p(i)},$9EI:function(n,t){this.$l.$r.set_$4h(this.$RS.$4c);this.$3bn=$4MS(this)},$2z5:function(n,t){this.$CG.$2R&&this.$O0&&this.$O0.$41y()},$Xj:function(){this.$1aP&&this.$1aP.$2K&&this.$1aP.$s()},$4g4:function(n){this.$Xj()},$8eL:function(n,t){if(t){this.$U3.$Bm.$6qk(t);this.$U3.$Bm.$8rA(n);this.$G.get_$O()==="TouchNarrow"?$4MT(this):$3Er(this)}},$5uF:function(){this.$11Z=!1},$2zJ:function(){this.$Xj();this.$11g||this.set_$1Ah(!0)}};_d.$Aq=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){this.$294=i;this.$2b5=f;this.$t=e;this.$6u7=n;this.$35Y=t;this.$2qN=r;this.$Ka=u;this.$p=o;this.$G=s;this.$1K=d;this.$8T=c;this.$1kQ=l;this.$S=a;this.$2b9=v;this.$2b4=y;this.$qG=p;this.$1gj=w;this.$DD=b;this.$ON=k;this.$1K=d;this.$87=h};function $4Mk(n){var t=new _g.$1m;t.EmailAddress=n.$t.get_$38().get_$Br();t.Name=n.$t.get_$38().get_$Gz();t.MailboxType="Mailbox";var i=n.get_$3O3().$26C(t);i.get_$3c().set_$45(n.get_$5Ct()?"HTML":"Text");return i}function $6M8(n){var t=new _d.$7e(null);t.set_$1K2($4Mk(n));t.set_$7F($4Mk(n));return t}function $4Mj(n,t,i){t.get_$2h()&&i.set_$2h(t.get_$2h());i.set_$10(t.get_$10()||_a.$7.get_$2M());var r=t.get_$DE()===undefined?_a.$25.$1BD(2):t.get_$DE();i.set_$23(i.get_$10().$9b(r));i.set_$92(t.get_$37Q());i.set_$5m(t.get_$5m());t.$6xf("ReminderIsSet")?i.set_$Nk(t.get_$Nk()):i.set_$Nk(n.$t.get_$1t().get_$1jb());t.get_$72()&&i.set_$72(_g.$3X.$66n(t.get_$72()));t.get_$8A()&&i.set_$8A(_g.$3X.$66n(t.get_$8A()));t.get_$4h()&&i.set_$4h(t.get_$4h());t.get_$3c()&&i.set_$3c(t.get_$3c());i.set_$22(t.get_$1DK())}_d.$Aq.prototype={$t:null,$6u7:null,$2qN:null,$35Y:null,$294:null,$Ka:null,$p:null,$G:null,$1kQ:null,$8T:null,$S:null,$qG:null,$2b5:null,$2b9:null,$2b4:null,$1gj:null,$DD:null,$ON:null,$1K:null,$87:null,get_$3O3:function(){return this.$qG},get_$5wU:function(){return this.$35Y},get_$4j1:function(){return this.$Ka},get_$3Nm:function(){return this.$8T.get_$1d()},get_$7Gf:function(){return this.$1kQ},get_$5Ct:function(){return this.$1K.get_$A0()},$2hD:function(n){var t=$6M8(this);$4Mj(this,n,t.get_$7F());$4Mj(this,n,t.get_$1K2());t.set_$29O(n.get_$29O());return t},$ct:function(n,t,i){var r=this.$2CA();t&&r.add_$5kD(t);if(_d.$F2.$AU(n))r.$7V8(new _d.$F2(n));else if(_y.$Ao.$AU(n))r.$3dx(new _y.$Ao(n));else{var u=this.$2hD(new _d.$TB(n));r.$xs(u)}i&&(r.$2bk=i);return r},$wD:function(n){var t=this.$2CA();t.$xs(n);return t},$8tD:function(n){return[this.$ct(n)]},$76G:function(n){var t=this.$2CA();t.$xs(n);if(_d.$3H.isInstanceOfType(n)){var i=this.get_$5wU().$I(t.$l,t.$K0,t.$$d_$8lL,!0,t.get_$EB());n.$4nm(i.$j);return[t,i]}if(_d.$87.isInstanceOfType(n)){var r=t.$RS.get_$1Zc();n.$4nm(r);return[t,r]}return[t]},$2CA:function(){return new _d.$10(this.get_$5wU(),this.$2qN,this.get_$4j1(),this.$G,this.$87,new _y.$4p,this.get_$7Gf(),this.$2b5,this.$p,this.get_$3Nm(),_a.NativeBridge.get_$L().$CR,_a.UserAgent.getInstance(),this.$t,this.$2b9,this.$2b4,this.$1gj,this.get_$5Ct(),this.$DD,this.$ON)}};_d.$xO=function(n,t,i){this.$$d_$5k4=Function.createDelegate(this,this.$5k4);this.$$d_$5k3=Function.createDelegate(this,this.$5k3);this.$$d_$5k1=Function.createDelegate(this,this.$5k1);if(_a.$5a.$2x){this.$l=n;this.$TW=new _d.$3T(t,new _d.$pc(n.$U3.$Bm),n,n.$z,i);this.$TW.$3v();this.$TW.set_$306(this.$$d_$5k1);this.$TW.set_$305(this.$$d_$5k3);this.$TW.set_$5k5(this.$$d_$5k4)}};_d.$xO.prototype={$TW:null,$l:null,$5k1:function(n){_a.$5a.$2x&&this.$l.$l&&this.$l.$l.$r&&this.$l.$l.$r.set_$Sc(n)},$5k3:function(n){_a.$5a.$2x&&this.$l.$l&&this.$l.$l.$r&&this.$l.$l.$r.set_$Qo(n)},$5k4:function(){_a.$5a.$2x&&this.$l.$2Ru(64)},$2Ru:function(n,t,i){if(_a.$5a.$2x&&t&&t.get_$i()){_js.Trace.logInfo(_a.$0.$1o,"Prepares to submit policyTips action");var r=_a.$3m.$1kj(t.get_$2h());var u=_a.$3m.$1kj(t.$r8);var f=t.get_$i();n?this.$TW.$2Qv(f,n.get_$1e(),r,u,i):this.$TW.$2Qv(f,null,r,u,i)}},$7SJ:function(){if(!_a.$5a.$2x||!this.$l.$l||!this.$l.$l.$r)return!1;switch(this.$TW.$2hP()){case 1:return!1;case 2:case 3:return $8(this.$l.$l.$r.get_$Sc())&&$8(this.$l.$l.$r.get_$Qo());case 4:case 5:return $8(this.$l.$l.$r.get_$Qo());default:return!1}},$7Jf:function(){if(!_a.$5a.$2x)return"";switch(this.$TW.$2hP()){case 2:case 3:return _u.Strings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _u.Strings.l_PolicyTipsBlockSend_Text;default:return""}}};_d.$Ed=function(n){this.$$d_$8h0=Function.createDelegate(this,this.$8h0);_d.$Ed.initializeBase(this);this.$3w=n;this.$SD=new _d.$18R(n);this.$lF=$21d(this);$6MB(this);this.$SD.add_$8C(this.$$d_$8h0)};_d.$Ed.$54r=function(n,t){var i=n.$6E(t);return!!(i%864e5)};function $6MB(n){n.$wt=new _js.$X;n.$wt.$H(0);n.$wt.$H(18e5);n.$wt.$H(36e5);n.$wt.$H(54e5);n.$wt.$H(72e5);n.$wt.$H(-1);n.$wt.$H(-2);n.set_$154(n.$3w.get_$5m()?-1:n.get_$DE())}function $21d(n){var t=_d.$6N.$3ZM(n.$SD);n.$3R1=t.$2w.$6E(t.$2G);return t}_d.$Ed.prototype={$3w:null,$SD:null,$wt:null,$153:0,$lF:null,$3R1:0,$1PS:!1,$1PT:!1,get_$10:function(){return this.$SD.get_$10()},set_$10:function(n){if(!this.$1PT&&_d.$Ed.$54r(n,this.get_$10()))throw Error.invalidOperation("Changing time part of Start is not allowed");this.$SD.set_$10(n);return n},get_$23:function(){return this.$SD.get_$23()},set_$23:function(n){if(!this.$1PS)throw Error.invalidOperation("Changing the End date or time part are not allowed");if(!this.$1PT&&_d.$Ed.$54r(n,this.get_$23()))throw Error.invalidOperation("Changing time part of End is not allowed");this.$SD.set_$23(n);return n},get_$DE:function(){return this.$SD.get_$DE()},set_$DE:function(n){this.$SD.set_$DE(n);return n},get_$154:function(){return this.$153},set_$154:function(n){this.$153=n;switch(n){case 0:case 18e5:case 36e5:case 54e5:case 72e5:this.set_$3Oa(!1);this.set_$3Oc(!0);this.$3w.set_$5m(!1);this.set_$2be($21d(this));this.set_$DE(this.$153);break;case-1:this.$3w.set_$5m(!0);this.set_$2be($21d(this));this.set_$3Oa(!0);this.set_$3Oc(!1);break;default:this.$153=-2;this.$3w.set_$5m(!1);this.set_$2be($21d(this));this.set_$3Oa(!0);this.set_$3Oc(!0);break}$4Z(this,"DurationSelectedValue","IsAllDayEvent");return n},get_$2be:function(){return this.$lF},set_$2be:function(n){if(this.$lF.$4W(n))return n;this.$lF=n;$6(this,"CorrectedDateRange");return n},get_$3Oa:function(){return this.$1PS},set_$3Oa:function(n){if(n!==this.$1PS){this.$1PS=n;$6(this,"CanChangeEndDateAndTime")}return n},get_$3Oc:function(){return this.$1PT},set_$3Oc:function(n){if(n!==this.$1PT){this.$1PT=n;$6(this,"CanChangeStartAndEndTime")}return n},get_$5m:function(){return this.$3w.get_$5m()},$68u:function(n,t,i){this.$SD.set_$10(n);this.$SD.set_$DE(t);this.set_$154(i?-1:this.get_$DE())},$8h0:function(n,t){t==="Start"?$6(this,"Start"):t==="End"&&$6(this,"End");this.set_$2be($21d(this));$Bc(this,"DateChanged",this,null)}};_d.$GV=function(n,t,i,r){this.$$d_$8tU=Function.createDelegate(this,this.$8tU);this.$$d_$8UX=Function.createDelegate(this,this.$8UX);this.$$d_$8UY=Function.createDelegate(this,this.$8UY);this.$$d_$8UZ=Function.createDelegate(this,this.$8UZ);this.$$d_$2bx=Function.createDelegate(this,this.$2bx);this.$$d_$623=Function.createDelegate(this,this.$623);this.$$d_$3ya=Function.createDelegate(this,this.$3ya);_d.$GV.initializeBase(this);this.$2Q=n;this.$1r=i;this.$p=r;this.$tj=t;this.set_$Ik(!1);this.$tj.add_$51D(this.$$d_$3ya);this.$49T=new _C(this.$$d_$623,_d.$GV.$D);var u=this;this.$3Rv=new _C(this.$$d_$2bx,_d.$GV.$D,this,"IsOnlineMeetingButtonEnabled",function(){return u.get_$3ho()});if(this.$2Q.get_$10N()){this.set_$3yN(new _d.$mo(this.$2Q.get_$10N()));this.$1Jw.set_$1X(!1)}else this.set_$3yN(null)};_d.$GV.$7HB=function(n,t,i){var s=i?"<P><BR></P>":"\n";var r=[];if(t){_js.$8.$14(n.AcpInformation.TollNumber)||Array.add(r,String.format(i?_u.Strings.l_JoinOnlineMeetingDialInNumberForTollumberFormatRichText_Text:_u.Strings.l_JoinOnlineMeetingDialInNumberForTollNumberFormatPlainText_Text,n.AcpInformation.TollNumber));for(var h=i?_u.Strings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatRichText_Text:_u.Strings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatPlainText_Text,o=n.AcpInformation.TollFreeNumbers,c=o.length,u=0;u<c;++u){var l=o[u];Array.add(r,String.format(h,l))}}else for(var a=i?_u.Strings.l_JoinOnlineMeetingDialInNumberFormatRichText_Text:_u.Strings.l_JoinOnlineMeetingDialInNumberFormatPlainText_Text,f=0;f<n.Numbers.length;f++){var e=n.Numbers[f];Array.add(r,String.format(a,e.Number,e.RegionName,e.Language))}return r.length?String.format(i?_u.Strings.l_OnlineMeetingJoinByPhoneSectionRichText_Text:_u.Strings.l_OnlineMeetingJoinByPhoneSectionPlainText_Text,r.join(s)):""};function $3Es(n){var i=n.$tj.$7OC(n.$2Q);var t=new _c.$xq(n.$2Q,i);t.add_$2A(n.$$d_$8UZ);t.add_$20(n.$$d_$8UY);t.add_$2m(n.$$d_$8UX);n.$p.$y(t)}_d.$GV.prototype={$49T:null,$3Rv:null,$tj:null,$1r:null,$p:null,$X6:!1,$2Q:null,$3yM:null,$3yL:null,$1Jw:null,$CT:null,add_$5g7:function(n){this.$2Z("OnBeforeCreateOnlineMeeting",n)},remove_$5g7:function(n){this.$2b("OnBeforeCreateOnlineMeeting",n)},add_$3xj:function(n){this.$2Z("OnCreateOnlineMeetingSucceeded",n)},remove_$3xj:function(n){this.$2b("OnCreateOnlineMeetingSucceeded",n)},get_$3hp:function(){return!this.$2Q.get_$10N()&&(this.$tj.get_$2DV()||this.get_$3ho())&&!this.$2Q.get_$Ef()},get_$5is:function(){return this.get_$3ho()?_u.Strings.l_OnlineMeetingButton_Text:_u.Strings.l_OnlineMeetingButtonDisabledTooltip_Text},get_$3ho:function(){return!this.$X6&&!!this.$2Q&&this.$tj.$7Xw(this.$2Q)},get_$3yN:function(){return this.$1Jw},set_$3yN:function(n){if(this.$1Jw!==n){this.$1Jw=n;$6(this,"OnlineMeetingSettingsViewModel")}return n},get_$Ik:function(){return this.$X6},set_$Ik:function(n){if(this.$X6!==n){this.$X6=n;$6(this,"IsInProgress");this.$3ya("")}return n},$59:function(){this.$tj.remove_$51D(this.$$d_$3ya);_a.$1.prototype.$59.call(this)},$3ya:function(n){$Nu(this,"IsOnlineMeetingButtonVisible","IsOnlineMeetingButtonEnabled","OnlineMeetingButtonTitleText")},$9Cz:function(n){this.$2Q=n;this.$X6&&$3Es(this)},$7HS:function(n){if(!this.$CT)return"";var o=!$8(this.$CT.AcpInformation);var i=n?"<P><BR></P>":"\n";var s;var r;var u="";var f="";var t="";if(n){r=o?String.format(_u.Strings.l_OnlineMeetingParticipantPasscodeRichText_Text,this.$CT.AcpInformation.ParticipantPassCode):String.format(_u.Strings.l_OnlineMeetingConferenceIdRichText_Text,this.$CT.ConferenceId);var e="";_js.$8.$14(this.$CT.LogoUrl)||(e=String.format('<img src="{0}" />{1}{1}',this.$CT.LogoUrl,i));_js.$8.$14(this.$CT.HelpUrl)||(u=String.format(_u.Strings.l_OnlineMeetingHelpSectionRichText_Text,this.$CT.HelpUrl));_js.$8.$14(this.$CT.LegalUrl)||(f=String.format(_u.Strings.l_OnlineMeetingLegalSectionRichText_Text,this.$CT.LegalUrl));_js.$8.$14(this.$CT.CustomFooterText)?_js.$8.$c(e)||(t=String.format("{1}{0}{1}",e,i)):t=String.format("{1}{2}{0}{1}",this.$CT.CustomFooterText,i,e)}else{r=o?String.format(_u.Strings.l_OnlineMeetingParticipantPasscodePlainText_Text,this.$CT.AcpInformation.ParticipantPassCode):String.format(_u.Strings.l_OnlineMeetingConferenceIdPlainText_Text,this.$CT.ConferenceId);_js.$8.$14(this.$CT.HelpUrl)||(u=String.format(_u.Strings.l_OnlineMeetingHelpSectionPlainText_Text,this.$CT.HelpUrl));_js.$8.$14(this.$CT.LegalUrl)||(f=String.format(_u.Strings.l_OnlineMeetingLegalSectionPlainText_Text,this.$CT.LegalUrl));_js.$8.$14(this.$CT.CustomFooterText)||(t=String.format("{1}{0}{1}",this.$CT.CustomFooterText,i))}var h=_d.$GV.$7HB(this.$CT,o,n);s=n?String.format(_u.Strings.l_RichTextOnlineMeetingInformationForEventComposeForm_Text,this.$CT.WebUrl,h,this.$CT.ExternalDirectoryUri,r,this.$CT.InternalDirectoryUri,u,f,t):String.format(_u.Strings.l_PlainTextOnlineMeetingInformationForEventComposeForm_Text,this.$CT.WebUrl,h,this.$CT.ExternalDirectoryUri,r,this.$CT.InternalDirectoryUri,u,f,t);return s},$623:function(){this.$1Jw&&this.$1Jw.set_$1X(!0)},$2bx:function(){_js.Trace.logInfo(_a.$0.$1o,"Scenarios={0}, checkpoin={1}","Create.OnlineMeeting","Calendar.Reliability.UpdateCalendarItem.ComposeForm");_a.$5.stPT(_a.$0.$Ag,"CreateOnlineMeeting",3);_a.$5.$1V(_a.$0.$Ag,"CreateOnlineMeeting");this.set_$Ik(!0);this.$CT=null;this.$2Q.get_$i()?$3Es(this):$Bc(this,"OnBeforeCreateOnlineMeeting",this,null)},$8UZ:function(n){_a.$5.acsa(_a.$0.$Ag,"Perf_createOnlineMeetingUIUpdate");_js.Trace.logInfo(_a.$0.$1o,"Scenarios={0}, checkpoin={1}","Create.OnlineMeeting.Succeed","Calendar.Reliability.UpdateCalendarItem.ComposeForm");var t=n;this.$2Q.set_$2El(t.$CT.WebUrl);this.set_$3yN(new _d.$mo(this.$2Q.get_$10N()));this.$CT=t.$CT;this.set_$Ik(!1);$Bc(this,"OnCreateOnlineMeetingSucceeded",this,this);this.$3yM="";this.$3yL=t.get_$4dL()?t.get_$4dL().correlationId:null},$8UY:function(n){_js.Trace.logInfo(_a.$0.$1o,"Scenarios={0}, checkpoin={1}","Create.OnlineMeeting.Fail","Calendar.Reliability.UpdateCalendarItem.ComposeForm");this.$1r.$S5(2,[_u.Strings.l_UnableToGetOnlineMeetingInformation_Text],this.$$d_$8tU,!1,_u.Strings.l_RetryButton_LowerCase_Text,_u.Strings.l_Close_LowerCase_Text,_u.Strings.l_UnableToGetOnlineMeetingInformationDialogTitle_Text);this.$3yM="Failed";var t=n;this.$3yL=t.get_$4dL()?t.get_$4dL().correlationId:null},$8UX:function(n){this.$3ya("");n.remove_$2m(this.$$d_$8UX);n.remove_$2A(this.$$d_$8UZ);n.remove_$20(this.$$d_$8UY);_a.$5.acea(null,"Perf_createOnlineMeetingUIUpdate");_a.$5.$1G(null,"CreateOnlineMeeting",this.$3yM,this.$3yL);_a.$5.endPT("CreateOnlineMeeting")},$8tU:function(n,t){n?$3Es(this):this.set_$Ik(!1)}};_d.$kA=function(n,t){this.$tj=n;this.$p=t};_d.$kA.prototype={$tj:null,$p:null,$I:function(n,t){return new _d.$GV(n,this.$tj,t,this.$p)}};_d.$40=function(n,t,i,r){this.$$d_$6w8=Function.createDelegate(this,this.$6w8);this.$$d_$8uX=Function.createDelegate(this,this.$8uX);this.$$d_$5kv=Function.createDelegate(this,this.$5kv);this.$$d_$9Dl=Function.createDelegate(this,this.$9Dl);_d.$40.initializeBase(this);this.$Cm=n;this.$vB=t;this.$1r=i;this.$G=r;this.$QN=_d.$GG.$5I1(this.$Cm.$I9.$5f,this.$vB.get_$dP(),this.$G);this.$18r=_d.$40.$7M4();this.$4Gf=_d.$40.$7PI();this.$43U=_d.$40.$7ND();this.$3vT=_d.$40.$7Lm();$6ML(this);this.set_$1Jp(this.$18r.get_$48(0));this.set_$2Sp(this.$4Gf.get_$48(0));this.set_$2Jf(this.$3vT.get_$48(0));this.set_$2N8(this.$43U.get_$48(0));this.$Cm.$a("RecurrenceDataObject",this.$$d_$9Dl);this.$Cm.$a("RecurrencePattern",this.$$d_$9Dl);this.$Cm.$I9.$a("StartDate",this.$$d_$5kv);this.$DS=new _C(this.$$d_$8uX,_a.$0.$1o);this.$79=new _C(this.$$d_$6w8,_a.$0.$1o);this.set_$Cu(this);var u=new _js.$X;u.$H(new _a.$2E(this.$DS,_u.Strings.l_ComposeRecurrenceDialogSaveButtonTitle_Text));u.$H(new _a.$2E(this.$79,_u.Strings.l_ComposeRecurrenceDialogCancelButtonTitle_Text));this.set_$OO(u)};_d.$40.$7M4=function(){var n=new _js.$X;n.$H(new _d.$ID(0));n.$H(new _d.$I0(0,0));n.$H(new _d.$IS(0,0));n.$H(new _d.$IT(0,"None",0));n.$H(new _d.$Io(0,0));n.$H(new _d.$Ji("None",0,0));return n};_d.$40.$7PI=function(){var n=new _js.$X;n.$H(1);n.$H(2);n.$H(4);n.$H(8);n.$H(16);n.$H(32);n.$H(64);return n};_d.$40.$7ND=function(){var n=new _js.$X;n.$H("First");n.$H("Second");n.$H("Third");n.$H("Fourth");n.$H("Last");return n};_d.$40.$7Lm=function(){var n=new _js.$X;n.$H(0);n.$H(1);n.$H(2);n.$H(3);n.$H(4);n.$H(5);n.$H(6);n.$H(7);n.$H(8);n.$H(9);n.$H(10);n.$H(11);return n};function $12y(n,t){return(n.$1iP&t)===t}function $6MM(n){var t=_d.$2h.$4nQ(n.$Cm.$I9.$5f.get_$Cd());n.set_$2cw(t);$4Mq(n);n.set_$2cx(n.$Cm.$I9.$5f.get_$5z().toString());n.set_$1md("1");n.set_$2Jf(n.$Cm.$I9.$5f.get_$3D());n.set_$2N8(_d.$2h.$2iU(n.$Cm.$I9.$5f));n.set_$2Sp(t)}function $1Ng(n,t,i){t&&!$12y(n,i)?n.set_$2cw(n.$1iP|i):!t&&$12y(n,i)&&n.set_$2cw(n.$1iP&~i)}function $3Et(n){for(var i=null,t=0;t<n.$QN.get_$F();++t)if(_d.$RA.isInstanceOfType(n.$QN.get_$48(t))&&n.$QN.get_$48(t).$2Y(n.$Cm.get_$GK())){i=n.$QN.get_$48(t);break}if($8(i)){var r=n.$G.get_$O()==="TouchNarrow"?n.$QN.get_$F()-1:n.$QN.get_$F()-2;if($8(n.$2ch)){r++;n.$QN.$6z(r,_u.Strings.l_CustomPattern_Text)}n.$2ch=n.$Cm.get_$GK();return n.$QN.get_$48(r)}else return i}function $4Mp(n){var t=n.$Cm.get_$GK();if(_d.$ID.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(0));n.set_$1md(t.$9t.toString())}else if(_d.$I0.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(1));n.set_$1md(t.$9t.toString());n.set_$2cw(t.$wT)}else if(_d.$IS.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(2));n.set_$1md(t.$9t.toString());n.set_$2cx(t.$OH.toString())}else if(_d.$IT.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(3));n.set_$1md(t.$9t.toString());n.set_$2N8(t.$BU);n.set_$2Sp(t.$OI)}else if(_d.$Io.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(4));n.set_$2Jf(t.$VK);n.set_$2cx(t.$OH.toString())}else if(_d.$Ji.isInstanceOfType(t)){n.set_$1Jp(n.$18r.get_$48(5));n.set_$2Jf(t.$VK);n.set_$2N8(t.$BU);n.set_$2Sp(t.$OI)}n.set_$49c(!_d.$RA.isInstanceOfType(n.$Vd))}function $6ML(n){var t=$3Et(n);n.set_$1wP(t);n.set_$49c(!_d.$RA.isInstanceOfType(t));n.set_$62F(!_d.$Gs.isInstanceOfType(t))}function $4Mq(n){$6(n,"MondaySelected");$6(n,"TuesdaySelected");$6(n,"WednesdaySelected");$6(n,"ThursdaySelected");$6(n,"FridaySelected");$6(n,"SaturdaySelected");$6(n,"SundaySelected")}function $6MN(n){var t=n.$1uI;n.set_$92f(_d.$ID.isInstanceOfType(t));n.set_$94g(_d.$I0.isInstanceOfType(t));n.set_$93W(_d.$IS.isInstanceOfType(t));n.set_$93X(_d.$IT.isInstanceOfType(t));n.set_$94j(_d.$Io.isInstanceOfType(t));n.set_$94i(_d.$Ji.isInstanceOfType(t))}function $6MO(n){if(_d.$RA.isInstanceOfType(n.$Vd)){n.$Cm.set_$GK(n.$Vd);$3Eu(n)}else if(n.$Vd===_u.Strings.l_CustomPattern_Text){n.$Cm.set_$GK(n.$2ch);$3Eu(n)}else if(n.$Vd===_u.Strings.l_EditPattern_Text){$6MM(n);$4Mp(n)}n.set_$62F(!_d.$Gs.isInstanceOfType(n.$Cm.get_$GK()))}function $3Eu(n){n.set_$49c(!_d.$RA.isInstanceOfType(n.$Vd))}_d.$40.prototype={$G:null,$vB:null,$1r:null,$Cm:null,$18r:null,$4Gf:null,$3vT:null,$43U:null,$DS:null,$79:null,$QN:null,$1iP:0,$Vd:null,$1wO:null,$26z:null,$2CJ:null,$2Q5:!1,$2Q6:!1,$37e:!1,$38K:!1,$37u:!1,$37v:!1,$38N:!1,$38M:!1,$2Q4:!1,$1ts:null,$21H:null,$1uI:null,$2ch:null,get_$1md:function(){return this.$2CJ},set_$1md:function(n){if(this.$2CJ!==n){this.$2CJ=n;$6(this,"IntervalString")}return n},get_$2cx:function(){return this.$26z},set_$2cx:function(n){if(this.$26z!==n){this.$26z=n;$6(this,"DayString")}return n},get_$93y:function(){return this.$2Q5},set_$93y:function(n){if(this.$2Q5!==n){this.$2Q5=n;$6(this,"ShowRecurrencePicker")}return n},get_$49c:function(){return this.$2Q6},set_$49c:function(n){if(this.$2Q6!==n){this.$2Q6=n;$6(this,"ShowRecurrenceString")}return n},get_$5dP:function(){return $12y(this,2)},set_$5dP:function(n){$1Ng(this,n,2);return n},get_$67x:function(){return $12y(this,4)},set_$67x:function(n){$1Ng(this,n,4);return n},get_$6BU:function(){return $12y(this,8)},set_$6BU:function(n){$1Ng(this,n,8);return n},get_$66F:function(){return $12y(this,16)},set_$66F:function(n){$1Ng(this,n,16);return n},get_$4yJ:function(){return $12y(this,32)},set_$4yJ:function(n){$1Ng(this,n,32);return n},get_$5wE:function(){return $12y(this,64)},set_$5wE:function(n){$1Ng(this,n,64);return n},get_$654:function(){return $12y(this,1)},set_$654:function(n){$1Ng(this,n,1);return n},get_$92f:function(){return this.$37e},set_$92f:function(n){if(this.$37e!==n){this.$37e=n;$6(this,"ShowDailyRecurrence")}return n},get_$94g:function(){return this.$38K},set_$94g:function(n){if(this.$38K!==n){this.$38K=n;$6(this,"ShowWeeklyRecurrence")}return n},get_$93W:function(){return this.$37u},set_$93W:function(n){if(this.$37u!==n){this.$37u=n;$6(this,"ShowMonthlyByDayRecurrence")}return n},get_$93X:function(){return this.$37v},set_$93X:function(n){if(this.$37v!==n){this.$37v=n;$6(this,"ShowMonthlyByWeekRecurrence")}return n},get_$94j:function(){return this.$38N},set_$94j:function(n){if(this.$38N!==n){this.$38N=n;$6(this,"ShowYearlyRecurrence")}return n},get_$94i:function(){return this.$38M},set_$94i:function(n){if(this.$38M!==n){this.$38M=n;$6(this,"ShowYearlyByWeekRecurrence")}return n},get_$62F:function(){return this.$2Q4},set_$62F:function(n){if(this.$2Q4!==n){this.$2Q4=n;$6(this,"ShowRangeFields")}return n},get_$1wP:function(){return this.$Vd},set_$1wP:function(n){if(this.$Vd!==n){this.$Vd=n;$6MO(this);$6(this,"RecurrenceSelected")}return n},get_$2Jf:function(){return this.$1ts},set_$2Jf:function(n){if(this.$1ts!==n){this.$1ts=n;$6(this,"MonthsSelected")}return n},get_$1Jp:function(){return this.$1uI},set_$1Jp:function(n){if(this.$1uI!==n){this.$1uI=n;$6MN(this);$6(this,"OccursSelected")}return n},get_$2Sp:function(){return this.$21H},set_$2Sp:function(n){if(this.$21H!==n){this.$21H=n;$6(this,"WeekdaysSelected")}return n},get_$2N8:function(){return this.$1wO},set_$2N8:function(n){if(this.$1wO!==n){this.$1wO=n;$6(this,"RecurrenceOrderSelected")}return n},get_$8pD:function(){return this.$QN},set_$8pD:function(n){if(this.$QN!==n){this.$QN=n;$6(this,"RecurrenceOptions")}return n},get_$2cw:function(){return this.$1iP},set_$2cw:function(n){this.$1iP=n;$4Mq(this);return n},get_$Ww:function(){var n=_a.$BQ.$5nA(this.$2CJ);return isNaN(n)?0:n},get_$1Qr:function(){var n=_a.$BQ.$5nA(this.$26z);return isNaN(n)?0:n},$8uX:function(){var n=this.$1uI;if(_d.$ID.isInstanceOfType(n))n.$9t=this.get_$Ww();else if(_d.$I0.isInstanceOfType(n)){n.$9t=this.get_$Ww();n.$wT=this.$1iP}else if(_d.$IS.isInstanceOfType(n)){n.$9t=this.get_$Ww();n.$OH=this.get_$1Qr()}else if(_d.$IT.isInstanceOfType(n)){n.$9t=this.get_$Ww();n.$OI=this.$21H;n.$BU=this.$1wO}else if(_d.$Io.isInstanceOfType(n)){n.$OH=this.get_$1Qr();n.$VK=this.$1ts}else if(_d.$Ji.isInstanceOfType(n)){n.$OI=this.$21H;n.$VK=this.$1ts;n.$BU=this.$1wO}if(n.$3CH()){this.$1r.$3A(0,_d.$CX.$1SX(n.$3CH()),null);return}this.$Cm.set_$GK(n.$46());$3Eu(this);this.$4a.$s()},$6w8:function(){this.set_$1wP($3Et(this));this.$4a.$s()},$9Dl:function(n,t){this.set_$1wP($3Et(this));$4Mp(this)},$5kv:function(n,t){for(var i=0,i=0;i<this.$QN.get_$F();i++)if(String.isInstanceOfType(this.$QN.get_$48(i))||this.$QN.get_$48(i).$2Y(this.$Cm.get_$GK()))break;this.set_$8pD(_d.$GG.$5I1(this.$Cm.$I9.$5f,this.$vB.get_$dP(),this.$G));$8(this.$2ch)||this.$QN.$6z(this.$G.get_$O()==="TouchNarrow"?this.$QN.get_$F():this.$QN.get_$F()-1,_u.Strings.l_CustomPattern_Text);this.set_$1wP(this.$QN.get_$48(i))}};_d.$3i=function(n,t,i,r,u){this.$$d_$8R9=Function.createDelegate(this,this.$8R9);this.$$d_$8VA=Function.createDelegate(this,this.$8VA);this.$$d_$3yB=Function.createDelegate(this,this.$3yB);this.$47=new Sys.EventHandlerList;this.$2Nu=new(_a.$3Y.$$(String));_d.$3i.initializeBase(this);_a.$3.$17(r,"itemViewModel");_a.$3.$17(n,"gridUserAvailabilityCoordinator");this.$2Yn=i;this.$If=n;this.$Qn=t;this.$t=u;this.$29S=$6MQ(this);this.$5uo=_d.$3i.$75w(r.$6S);this.$4yF=new _d.$ft;var f=_d.$6N.$3ZM(r.$6S);this.$5mC=f.$2G;this.$5m7=f.$2w;this.set_$e6(r.$r.get_$10());this.$1nn=r.$r.get_$1UI();this.$2nM=r.$r.get_$9w();this.$If.add_$2ZT(this.$$d_$3yB);this.$Qn.add_$2ZT(this.$$d_$8VA);this.$If.$a("HasActiveRequests",this.$$d_$8R9);this.$Qn.$a("HasActiveRequests",this.$$d_$8R9)};_d.$3i.$7v=function(n){return n==="Tentative"||n==="Busy"||n==="OOF"};_d.$3i.$7ME=function(n,t){for(var u=t.get_$Fu().get_$3T(),f=new(_a.$3Y.$$(_d.$If)),i=0;i<u.get_$F();++i){var r=new _d.$If(u.get_$48(i));n.$1Gz(r)&&_d.$3i.$7v(r.$hz)&&f.$H(r)}return f};_d.$3i.$7MF=function(n,t){for(var u=new(_a.$3Y.$$(_d.$If)),i=0;i<t.get_$F();++i){var r=t.get_$48(i);n.$1Gz(r)&&_d.$3i.$7v(r.$hz)&&u.$H(r)}return u};_d.$3i.$75w=function(n){var i={};if(n.get_$i()){for(var r=new _d.$15k,t=null,u=0;u<n.get_$72().get_$F();u++){t=n.get_$72().get_$48(u);i[t.get_$6V().EmailAddress]=r.$39(t.get_$QP(),null)}for(var f=0;f<n.get_$8A().get_$F();f++){t=n.get_$8A().get_$48(f);i[t.get_$6V().EmailAddress]=r.$39(t.get_$QP(),null)}for(var e=0;e<n.get_$9D().get_$F();e++){t=n.get_$9D().get_$48(e);i[t.get_$6V().EmailAddress]=r.$39(t.get_$QP(),null)}i[n.get_$Cl().Mailbox.EmailAddress]=r.$39("Organizer",null)}return i};function $3Ev(n,t,i,r){for(var u=_c.$Ei.$3RN(t),w=n.$If.$xR(i),e=[],s=0;s<w.get_$F();s++){var h=w.get_$48(s);if(s)for(var f=0;f<e.length;f++)h.get_$Fu().get_$17H().charAt(f)<e[f]&&(e[f]=h.get_$Fu().get_$17H().charAt(f));else for(var v=0;v<h.get_$Fu().get_$17H().length;v++)Array.add(e,h.get_$Fu().get_$17H().charAt(v))}u.get_$Fu().$N(_c.$90.$2GI,e.join(""));u.get_$Fu().$N(_c.$90.$29T,"FreeBusyMerged");if(r){var c;var y;var b,k;$3Ew(n,n.$2Yn,b={val:c},k={val:y});c=b.val;y=k.val;for(var d=n.$2Yn===1?_a.$7.$Kn(n.$wM).$3u():n.$wM.$3u(),p=d.$46(),l,o=c;o<y&&u.get_$Fu().get_$17H().length>0;o++){l=d.$Fr((o-c+1)*n.$t.get_$1t().get_$m6());var g=new _h.$4S(p,l);if(_d.$3i.$7v($1e2(n,u,o))&&_h.$4S.$1Oh(g,r)){var a=new _g.$39;a.set_$10(p);a.set_$23(l);a.set_$92($1e2(n,u,o));u.get_$Fu().get_$3T().$H(a)}p=l}}return u}function $4Mt(n,t){var o=new(_a.$3Y.$$(_d.$If));var i;var r;var h=1440/n.$t.get_$1t().get_$m6();var f;if(t.get_$Fu().get_$17H().length===h){i=0;r=h;f=n.$Qn.$JG.$2G}else{var c,l;$3Ew(n,0,c={val:i},l={val:r});i=c.val;r=l.val;f=n.$wM}for(var s=i,e=$1e2(n,t,i),u=i+1;u<r;u++){var a=$1e2(n,t,u);if(a!==e){$4Mr(n,o,f,e,i,s,u);s=u;e=a}}$4Mr(n,o,f,e,i,s,r);return o}function $4Mr(n,t,i,r,u,f,e){if(r!=="Free"){var s=(e-f)*n.$t.get_$1t().get_$m6();var o=new _g.$39;o.set_$10(i.$3u().$Fr((f-u)*n.$t.get_$1t().get_$m6()));o.set_$23(o.get_$10().$Fr(s));o.set_$92(r);t.$H(new _d.$If(o))}}function $6MT(n,t,i){for(var u="Free",e=n.$29S.Free,f=0;f<i.get_$Fu().get_$3T().get_$F();f++){var r=i.get_$Fu().get_$3T().get_$48(f);if(t.$1Gz(r)){var o=n.$29S[r.get_$92()];if(o>e){e=o;u=r.get_$92()}if(u===_d.$3i.$3vW)break}else if(r.get_$10().$2Y(t.$2w)>0)break}return u}function $6MU(n,t,i){for(var u="Free",e=n.$29S.Free,f=0;f<i.get_$F();f++){var r=i.get_$48(f);if(t.$1Gz(r)){var o=n.$29S[r.$hz];if(o>e){e=o;u=r.$hz}if(u===_d.$3i.$3vW)break}else if(r.$2G.$2Y(t.$2w)>0)break}return u}function $6MV(n,t,i){var r;if(_h.$4S.$1Oh(n.$If.$JG,t)){_js.Trace.logInfo(_a.$0.$qZ,"Fetching free-busy information for attendees from grid cache...");r=n.$If.$xR(i)}else r=n.$Qn.$xR(i);return r}function $4Ms(n,t){var i=n.$47.getHandler("DetailsCacheUpdateEvent");i&&i(t)}function $6MR(n){var t=n.$47.getHandler("CacheRefreshRequested");t&&t()}function $6MW(n,t,i,r,u){r.val=null;i.$H(t);var e=i.$46();var o=null;if(n.$gT&&e.$6l(n.$gT.EmailAddress)){e.$3Q(n.$gT.EmailAddress);o=$3Ev(n,n.$gT.EmailAddress,n.$2Nu,null)}u.val=n.$If.$xR(e);o&&u.val.$H(o);for(var f=0;f<u.val.get_$F();){if(u.val.get_$48(f).$SJ===t){_js.Trace.logInfo(_a.$0.$qZ,"Found organizer{0} free busy model",u.val.get_$48(f).$SJ);r.val=u.val.get_$48(f);u.val.$67(f);continue}f++}}function $6MS(n,t,i,r,u){var l=new _js.$X;var e;var s;var a,v;$3Ew(n,t,a={val:e},v={val:s});e=a.val;s=v.val;for(var y=t===1?_a.$7.$Kn(n.$wM).$3u():n.$wM.$3u(),p=y.$46(),h,f=e;f<s;f++){var o=0;var w=$1e2(n,i,f);_d.$3i.$7v(w)&&o++;for(var c=0;c<r.get_$F();c++)_d.$3i.$7v($1e2(n,r.get_$48(c),f))&&o++;h=y.$Fr((f-e+1)*n.$t.get_$1t().get_$m6());o>0&&l.$H(new _d.$uS(w,$6MP(n,o,u),p,h,n.$1nn,n.$2nM));p=h}return l}function $3Ew(n,t,i,r){var u=null;var e=0;var f=1440/n.$t.get_$1t().get_$m6();switch(t){case 0:u=n.$wM.$3u();break;case 1:u=_a.$7.$Kn(n.$wM).$3u();f=f*7;break;default:throw Error.notImplemented(_d.$ph.toString(t));}e=Math.abs(n.$If.$JG.$2G.$6E(u));var o=6e4*n.$t.get_$1t().get_$m6();i.val=e/o;r.val=i.val+f}function $1e2(n,t,i){if($8(t)||_js.$8.$c(t.get_$Fu().get_$17H()))return"NoData";else{var r=t.get_$Fu().get_$17H().charAt(i).toString();switch(r){case"0":return"Free";case"1":return"Tentative";case"2":return"Busy";case"3":return"OOF";case"4":return"WorkingElsewhere";case"5":return"NoData";default:_js.Trace.logError(_a.$0.$qZ,"Unexpected merged string encountered:'{0}')",r);return"NoData"}}}function $6MP(n,t,i){if(!i)return 0;var r=t/i;if(r>.9&&r<1)return.9;else if(r>0&&r<.15)return.15;return r}function $4Mu(n,t,i,r,u,f,e){var o;var s;var h=!1;if($8(f)){o="NoData";s=_u.Strings.l_LoadingWithEllipses_Text;u="NoError"}else{o=f;s=n.$4yF.$39(o,null)}if(n.$5mC.$4W(i)&&n.$5m7.$4W(r)){var c=n.$5uo[t];if(!$8(c)){h=!0;s=c}}return new _d.$Dw(t,o,s,h,u,e)}function $6MQ(n){var t={};t.Free=0;t.WorkingElsewhere=1;t.Tentative=2;t.Busy=3;t.OOF=4;return t}function $6MX(n,t){if(_h.$4S.$1Oh(n.$If.$JG,n.$Qn.$JG)){var i=n.$If.$xR(t);n.$Qn.$9D4(i);if(i.get_$F()!==t.get_$F()){for(var r=new(_a.$3Y.$$(String)),e={},u=0;u<i.get_$F();u++)e[i.get_$48(u).$SJ]=!0;for(var f=0;f<t.get_$F();f++){var o=t.get_$48(f);e[o]||r.$H(o)}_js.Trace.logInfo(_a.$0.$qZ,"Requesting FB for missing effective users {0}",r);n.$Qn.$xR(r)}}}_d.$3i.prototype={$If:null,$Qn:null,$4yF:null,$2Yn:0,$5mC:null,$5m7:null,$29S:null,$5uo:null,$t:null,$1nn:!1,$2nM:!1,$gT:null,$wM:null,$2rK:null,$3hF:!1,$35X:null,add_$2ia:function(n){this.$If.add_$2ZT(n)},remove_$2ia:function(n){this.$If.remove_$2ZT(n)},add_$3UR:function(n){this.$47.addHandler("DetailsCacheUpdateEvent",n)},remove_$3UR:function(n){this.$47.removeHandler("DetailsCacheUpdateEvent",n)},get_$5JH:function(){return this.$2rK},set_$5JH:function(n){if(!_a.$7.$4F(this.$2rK,n)){if(n.$3QP())throw Error.argument("MeetingStartDate","value should not contain time part.");this.$2rK=n;this.$Qn.$69T(this.$2rK,null)}return n},get_$e6:function(){return this.$wM},set_$e6:function(n){if(!_a.$7.$4F(this.$wM,n)){this.$wM=n;if(this.$If.$5EI(n))return n;var t=this.$35X.$3ZU(!1);var i=_a.$7.$Kn(n);$6MX(this,t);this.$If.$69T(i,t)}return n},get_$3hG:function(){return this.$3hF},set_$3hG:function(n){if(this.$3hF!==n){this.$3hF=n;$Q(this,"IsLoadingData")}return n},get_$5wT:function(){return this.$35X},set_$5wT:function(n){this.$35X=n;return n},get_$1xa:function(){return this.$gT},set_$1xa:function(n){this.$gT=n;return n},get_$5vG:function(){return this.$2Nu},$7Iv:function(n,t){var i=null;var r=null;t=t.$46();var u,f;$6MW(this,n,t,u={val:r},f={val:i});r=u.val;i=f.val;return $6MS(this,this.$2Yn,r,i,t.get_$F())},$7Jz:function(n){for(var i=this.$If.$xR(n),r={},t=0;t<i.get_$F();t++){var u=i.get_$48(t);r[u.$SJ]=u.$MP}return r},$7Nd:function(n,t,i){var a=new _h.$4S(n,t);var u={};var e=i.$46();if(this.$gT&&e.$6l(this.$gT.EmailAddress)){e.$3Q(this.$gT.EmailAddress);for(var o=$3Ev(this,this.$gT.EmailAddress,this.$2Nu,a),v=new(_a.$3Y.$$(_d.$If)),s=0;s<o.get_$Fu().get_$3T().get_$F();s++)v.$H(new _d.$If(o.get_$Fu().get_$3T().get_$48(s)));u[o.$SJ]=v}for(var y=this.$If.$xR(e),h=0;h<y.get_$F();h++){var r=y.get_$48(h);var f=null;switch(r.get_$Fu().get_$2h2()){case"None":break;case"MergedOnly":f=$4Mt(this,r);break;default:f=new(_a.$3Y.$$(_d.$If));for(var c,l=0;l<r.get_$Fu().get_$3T().get_$F();l++){c=new _d.$If(r.get_$Fu().get_$3T().get_$48(l));a.$1Gz(c)&&f.$H(c)}break}u[r.$SJ]=f}var p=this;i.$Bx(function(n){$8(u[n])});return u},$7SG:function(n,t,i,r){var u=new _h.$4S(n,t);if(_h.$4S.$1Oh(this.$If.$JG,u)){if(this.$If.$54F(i))return!0;r&&this.$If.$xR(i)}else{if(this.$Qn.$54F(i))return!0;r&&this.$Qn.$xR(i)}return!1},$2AD:function(n,t,i,r){var f=new _h.$4S(n,t);var h=i.$46();var c=null;if(r&&this.$gT&&h.$6l(this.$gT.EmailAddress)){h.$3Q(this.$gT.EmailAddress);c=$3Ev(this,this.$gT.EmailAddress,this.$2Nu,f)}var l=$6MV(this,f,h);c&&l.$H(c);for(var e={},a=0;a<l.get_$F();a++){var u=l.get_$48(a);var o=null;var s="Free";switch(u.get_$Fu().get_$2h2()){case"None":s="NoData";break;case"MergedOnly":o=_d.$3i.$7MF(f,$4Mt(this,u));s=$6MU(this,f,o);break;default:o=_d.$3i.$7ME(f,u);s=$6MT(this,f,u);break}e[u.$SJ]=$4Mu(this,u.$SJ,n,t,u.$MP,s,o)}var v=this;i.$Bx(function(i){$8(e[i])&&(e[i]=$4Mu(v,i,n,t))});return e},$gI:function(){_js.Trace.logInfo(_a.$0.$qZ,"Refreshing Scheduling Grid Cache...");$6MR(this);var n=this.$35X.$3ZU(!0);this.$If.$gI(n,!0);if(!this.$If.$JG.$6l(this.$Qn.$JG,!0)){_js.Trace.logInfo(_a.$0.$qZ,"Refreshing Scheduling Details Cache...");this.$Qn.$gI(n,!0)}},$3yB:function(n){if(this.$If.$JG.$6l(this.$Qn.$JG,!0)){_js.Trace.logInfo(_a.$0.$qZ,"[Grid] Fire details cache event. Grid:{0} - Detail{1}",this.$If.$JG,this.$Qn.$JG);$4Ms(this,n)}else _js.Trace.logInfo(_a.$0.$qZ,"[Grid] Suppress detail cache event. Grid:{0} - Detail{1}",this.$If.$JG,this.$Qn.$JG)},$8VA:function(n){if(this.$If.$JG.$6l(this.$Qn.$JG,!0))_js.Trace.logInfo(_a.$0.$qZ,"[Detail] Suppressing details cache event. Grid:{0} - Detail{1}",this.$If.$JG,this.$Qn.$JG);else{_js.Trace.logInfo(_a.$0.$qZ,"[Detail] Fire details cache event. Grid:{0} - Detail{1}",this.$If.$JG,this.$Qn.$JG);$4Ms(this,n)}},$8R9:function(n,t){this.set_$3hG(this.$If.$2At||this.$Qn.$2At)}};_d.$P5=function(n,t,i,r,u,f){this.$$d_$3xP=Function.createDelegate(this,this.$3xP);this.$$d_$3yX=Function.createDelegate(this,this.$3yX);_d.$P5.initializeBase(this);this.$66=u;this.$3MP=f;this.$8v6=t;this.$36=r;this.$36.$vd();this.$36.set_$L8(i);this.$36.set_$1aY("PersonaDetailedView");this.$36.set_$OY(!0);this.$36.set_$15(!1);this.$36.add_$jv(this.$$d_$3yX);this.$36.set_$12U(100);this.$36.set_$1Xb(0);this.$dk=n};function $6Q6(n,t){var i=$6Q9(n,t);$8(i)||$8(i.$11S)||t.get_$1v().set_$1h(i.$11S);if(!$6Q7(n,t.get_$1v().get_$1h().EmailAddress)){var r=new _d.$7l(t.get_$1v(),n.$q6.$1Kz,!0);r.$1AQ=!0;n.$8yh(r);n.$q6.$1CU(r,3)}}function $6Q8(n){for(var i=new _js.$X,t=0;t<n.$dk.get_$F();t++)i.$H(n.$dk.get_$48(t).get_$6V());return n.$1QU(i)}function $6Q7(n,t){for(var i=0;i<n.$dk.get_$F();i++)if(n.$dk.get_$48(i).get_$6V().EmailAddress.toLowerCase()===t.toLowerCase())return!0;return!1}function $6Q9(n,t){return _d.$7l.isInstanceOfType(t)?t:null}_d.$P5.prototype={$36:null,$8v6:null,$dk:null,$66:null,$3MP:null,$q6:null,$1Ew:null,get_$6tt:function(){return this.$q6},set_$6tt:function(n){this.$q6=n;$6(this,"AttendeeRecipientWellViewModel");return n},$Ar:function(){this.$1Ew={};this.set_$6tt($6Q8(this));this.$q6.$84.remove_$1Z(this.$$d_$3xP);this.$q6.$84.add_$1Z(this.$$d_$3xP);for(var n=0;n<this.$q6.$1L.get_$F();n++){var t=this.$q6.$1L.get_$48(n);var i=this.$q6.$84.get_$48(n).EmailAddress;this.$1Ew[i]=t}},$6re:function(n){return!0},$8yh:function(n){},$1QU:function(n){return this.$66.$1QU(_y.$q.$Hr,n,3)},$3yX:function(n,t){var i=n.get_$Vm();i&&this.$6re(this.$dk)&&($8(this.$3MP)||this.$3MP(i.get_$1v().get_$1h().EmailAddress))&&$6Q6(this,i)},$3xP:function(n,t){switch(t.$3R){case 0:var i=this;Array.forEach(t.$2t,function(n){var t=i.$q6.$1L.get_$48(i.$q6.$1L.get_$F()-1);var r=t.$4U.$12;i.$1Ew[r.get_$1h().EmailAddress]=t;i.$dk.$H(_g.$3X.$rO(r.get_$1h()))});break;case 2:var r=this;Array.forEach(t.$3Y,function(n){for(var i=n,t=0;t<r.$dk.get_$F();t++)if(r.$dk.get_$48(t).get_$6V().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$dk.$67(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}}};_d.$Cw=function(n,t,i,r,u,f){this.$$d_$6u6=Function.createDelegate(this,this.$6u6);this.$47=new Sys.EventHandlerList;_d.$Cw.initializeBase(this);if($8(t))throw Error.argumentNull("submitter");this.$t=i;this.$2f=f;this.$11u=t;this.$5fF=u;this.$5fM=r;this.$15S={};this.$1CP=new(_a.$3Y.$$(_c.$rR));$4Pw(this,n)};function $6Sy(n,t){n.$15S={};n.$1CP.$1u();n.set_$3bh(!1);$4Pw(n,t)}function $4Pw(n,t){var r=t.$2q(-n.$5fM).$3u();var i=t.$2q(n.$5fF).$3u();r.$4W(i)&&(i=i.$2q(1));n.$JG=new _h.$4S(r,i);_js.Trace.logInfo(_a.$0.$20l,"NewCacheRange: Range:{0}",n.$JG)}function $3G1(n,t){$6Sx(n,t);if(t.get_$F()>0){_js.Trace.logInfo(_a.$0.$20l,"Requesting FB:{0} - {1}",n.$JG,t.toString());var i=new _c.$rR(n.$JG.$2G,n.$JG.$2w,_d.$Cw.$4yD,n.$t.get_$1t().get_$m6(),t);n.$2f.$43n(i);i.add_$2m(n.$$d_$6u6);n.$1CP.$H(i);n.$11u.$y(i)}n.set_$3bh(n.$1CP.get_$F()>0)}function $6Sx(n,t){for(var i=0;i<n.$1CP.get_$F();i++){var r=n.$1CP.get_$48(i);var u=this;r.$uG.$Bx(function(n){t.$3Q(n)});if(!t.get_$F())return}}function $6Sw(n,t){var i=n.$47.getHandler("CacheUpdateEventName");i&&i(t)}_d.$Cw.prototype={$1CP:null,$5fM:0,$5fF:0,$2f:null,$11u:null,$t:null,$JG:null,$15S:null,$2At:!1,add_$2ZT:function(n){this.$47.addHandler("CacheUpdateEventName",n)},remove_$2ZT:function(n){this.$47.removeHandler("CacheUpdateEventName",n)},get_$3bh:function(){return this.$2At},set_$3bh:function(n){if(this.$2At!==n){this.$2At=n;$Q(this,"HasActiveRequests")}return n},$5EI:function(n){return this.$JG.$hX(n,!0,!1)},$69T:function(n,t){if(!this.$5EI(n)){$6Sy(this,n);t&&$3G1(this,t)}},$9D4:function(n){for(var t=0;t<n.get_$F();t++){var i=n.get_$48(t);this.$15S[i.$SJ]=_c.$Ei.$72H(i,this.$JG)}},$gI:function(n,t){if(t){var i={};var r=this;n.$Bx(function(n){var t=r.$15S[n];t&&(i[n]=t)});this.$15S=i}$3G1(this,n)},$54F:function(n){for(var t=0;t<n.get_$F();t++){var i=this.$15S[n.get_$48(t)];if(!i)return!1}return!0},$xR:function(n){for(var i=new(_a.$3Y.$$(_c.$Ei)),r=new(_a.$3Y.$$(String)),t=0;t<n.get_$F();t++){var u=this.$15S[n.get_$48(t)];u?i.$H(u):r.$H(n.get_$48(t))}$3G1(this,r);return i},$6u6:function(n){var f=_a.$5.$1V(_a.$0.$20l,"Scheduling.AvailabilityActionCompleted",!0);var t=n;t.remove_$2m(this.$$d_$6u6);if(!this.$1CP.$3Q(t)){_js.Trace.logInfo(_a.$0.$20l,"Discarding FB results {0}-{1} {2} ",t.$7T,t.$9f,t.$uG);return}var i=t.$4yC;if(t.$1b){_js.Trace.logError(_a.$0.$20l,"{0} failed with the following error {1}",t.$1j_2,t.$1b.message);i=new _js.$X;var o=this;t.$uG.$Bx(function(n){i.$H(_c.$Ei.$3RN(n))})}for(var u=0;u<i.get_$F();u++){var r=i.get_$48(u);var e=this.$15S[r.$SJ];e&&r.get_$Fu().get_$2h2()==="None"||(this.$15S[r.$SJ]=r)}this.set_$3bh(this.$1CP.get_$F()>0);$6Sw(this,t.$uG);_a.$5.$1G(f)}};_d.$WA=function(n,t){this.$Ti=n;this.$t=t};_d.$WA.prototype={$Ti:null,$t:null,$I:function(n,t){var i=this.$Ti.get_$O()==="TouchNarrow"?0:1;var r=this.$74L(n.$r.get_$10(),t);var u=this.$73c(n.$r.get_$10(),t);return new _d.$3i(r,u,i,n,this.$t)},$74L:function(n,t){return new _d.$Cw(_a.$7.$Kn(n),OwaApplication.$1T,this.$t,7,14,t)},$73c:function(n,t){return new _d.$Cw(n,OwaApplication.$1T,this.$t,0,0,t)}};_d.$LQ=function(){};_d.$LQ.$8x5=function(n){for(var r=[],t=0;t<n.get_$F();++t){var i={};i.DisplayName=n.get_$48(t).get_$6V().Name;i.SmtpAddress=n.get_$48(t).get_$6V().EmailAddress;i.RoutingType=n.get_$48(t).get_$6V().RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$LQ.$79U=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$X;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _g.$3X;var i=new _g.$1m;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.set_$6V(i);t.$H(u)});return t};_d.$LQ.$8x6=function(n){for(var r=[],t=0;t<n.get_$F();++t){var i={};i.DisplayName=n.get_$48(t).$BY.get_$1l();i.SmtpAddress=n.get_$48(t).$BY.get_$1h().EmailAddress;i.RoutingType=n.get_$48(t).$BY.get_$1h().RoutingType;i.GALContactGuid=n.get_$48(t).$BY.get_$ls();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$LQ.$79V=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$X;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.$1m;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.$H(i)});return t};_d.$mo=function(n){_d.$mo.initializeBase(this);this.$tk=n;this.set_$Cu(this);var t=new _js.$X;t.$H(new _a.$2E(this.$4a,_u.Strings.l_Close_Text));this.set_$OO(t)};_d.$mo.prototype={$tk:null,get_$8ZR:function(){switch(this.$tk.get_$3Jt()){case"Everyone":return _u.Strings.l_OnlineMeetingAccessLevelEveryone_Text;case"Internal":return _u.Strings.l_OnlineMeetingAccessLevelInternal_Text;case"Invited":return _u.Strings.l_OnlineMeetingAccessLevelInvited_Text;case"Locked":return _u.Strings.l_OnlineMeetingAccessLevelLocked_Text;default:return""}},get_$8ZS:function(){switch(this.$tk.get_$3lH()){case"Disabled":return _u.Strings.l_OnlineMeetingLobbyBypassDisabled_Text;case"EnabledForGatewayParticipants":return _u.Strings.l_OnlineMeetingLobbyBypassEnabledForGatewayParticipants_Text;default:return""}},get_$8ZT:function(){switch(this.$tk.get_$42L()){case"Disabled":return _u.Strings.l_OnlineMeetingPresentersDisabled_Text;case"Internal":return _u.Strings.l_OnlineMeetingPresentersInternal_Text;case"Everyone":return _u.Strings.l_OnlineMeetingPresentersEveryone_Text;default:return""}}};_d.$3f=function(n){this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$6sL=Function.createDelegate(this,this.$6sL);_d.$3f.initializeBase(this,[_d.$3f.$8tK(),_d.$3f.$8tM(),_d.$3f.$8tN(),_d.$3f.$8tL(),n,null]);this.$4f7=_d.$3f.$5ux("AllowMultipleSelection");this.$kp=new _C(this.$$d_$6sL,_a.$0.$1o);this.$Cv=new _C(this.$$d_$eC,_a.$0.$1o);var t=$6Q1(this);this.set_$7E(_y.$26.$Bv(null,t,null));this.$3t.set_$492(!1);this.$Ar()};_d.$3f.get_$5we=function(){if(!_d.$3f.$GN){_d.$3f.$GN={};_d.$3f.$GN[_d.$45.toString(0)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$3f.$GN[_d.$45.toString(1)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$3f.$GN[_d.$45.toString(2)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$3f.$GN[_d.$45.toString(3)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$3f.$GN[_d.$45.toString(4)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelOwners_Text;_d.$3f.$GN[_d.$45.toString(6)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelGroupModerators_Text;_d.$3f.$GN[_d.$45.toString(5)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelMembers_Text;_d.$3f.$GN[_d.$45.toString(7)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelSenders_Text;_d.$3f.$GN[_d.$45.toString(8)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelAllowedSenders_Text;_d.$3f.$GN[_d.$45.toString(9)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$3f.$GN[_d.$45.toString(10)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$3f.$GN[_d.$45.toString(11)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text}return _d.$3f.$GN};_d.$3f.get_$8v7=function(){if(!_d.$3f.$aB){_d.$3f.$aB={};_d.$3f.$aB[_d.$45.toString(0)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$3f.$aB[_d.$45.toString(1)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$3f.$aB[_d.$45.toString(2)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$3f.$aB[_d.$45.toString(3)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$3f.$aB[_d.$45.toString(4)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupOwner_Text;_d.$3f.$aB[_d.$45.toString(6)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupModerator_Text;_d.$3f.$aB[_d.$45.toString(5)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupMember_Text;_d.$3f.$aB[_d.$45.toString(7)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkSender_Text;_d.$3f.$aB[_d.$45.toString(8)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkAllowedSenders_Text;_d.$3f.$aB[_d.$45.toString(9)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$3f.$aB[_d.$45.toString(10)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$3f.$aB[_d.$45.toString(11)]=_u.Strings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text}return _d.$3f.$aB};_d.$3f.$8tK=function(){var n=window.dialogArguments;return _d.$LQ.$79U(n)};_d.$3f.$5ux=function(n){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);return i[n]};_d.$3f.$8tM=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$3f.get_$5we()[_d.$45.toString(i)]};_d.$3f.$8tN=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$3f.get_$8v7()[_d.$45.toString(i)]};_d.$3f.$8tL=function(){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);var r=i.PickerCallerType;var n=null;switch(r){case 0:n=_c.$14.$rT;break;case 1:n=_c.$14.$rT;break;case 2:n=_c.$14.$rT;break;case 3:n=_c.$14.$rT;break;case 4:n=_c.$14.$15a;break;case 6:n=_c.$14.$15a;break;case 5:n=_c.$14.$15a;break;case 7:n=_c.$14.$15a;break;case 8:n=_c.$14.$15a;break;case 9:n=_c.$14.$rT;break;case 10:n=_c.$14.$15a;break;case 11:n=_c.$14.$15a;break;default:n=_c.$14.$rT;break}return new _d.$22(n,_c.$14.$bV(),_d.$3f.$5ux("AllowAddAsSmtpAddress"))};function $6Q1(n){var t=new Array(2);t[0]=new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItem_Text,n.$kp);t[1]=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,n.$Cv);return t}_d.$3f.prototype={$kp:null,$Cv:null,$3t:null,$4f7:!1,get_$7E:function(){return this.$3t},set_$7E:function(n){if(this.$3t!==n){this.$3t=n;$6(this,"ApplicationBarViewModel")}return n},$6re:function(n){return this.$4f7?!0:n.get_$F()>=1?!1:!0},$8yh:function(n){n.$Xp(1,new Array(0),n.get_$1v().get_$1h().EmailAddress)},$1QU:function(n){return this.$66.$76e(_y.$q.$Hr,n)},$6sL:function(){var n=window.dialogArguments;n.Properties=_d.$LQ.$8x5(this.$dk);window.close()},$eC:function(){window.close()}};_d.$my=function(n){this.$66=n};_d.$my.prototype={$66:null,$ct:function(n){return new _d.$3f(this.$66)},$wD:function(n){return new _d.$3f(this.$66)}};_d.$F2=function(n){if($8(n))this.$3l={};else{if(!_d.$F2.$AU(n))throw Error.invalidOperation("Cannot construct a UpdateCalendarItemParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.$3l=n}};_d.$F2.$AU=function(n){return!$8(n[_d.$F2.$mi])&&(!$8(n.Start)||!$8(n.Duration)||!$8(n.IsAllDayEvent))};_d.$F2.prototype={$3l:null,get_$i:function(){if($8(this.$3l[_d.$F2.$mi]))return null;var n=this.$3l[_d.$F2.$mi];return _g.$1j.$26E(n)},set_$i:function(n){$8(n)?delete this.$3l[_d.$F2.$mi]:this.$3l[_d.$F2.$mi]=n.Id;return n},get_$10:function(){return this.$3l.Start},set_$10:function(n){this.$3l.Start=n;return n},get_$DE:function(){var n=this.$3l.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DE:function(n){this.$3l.Duration=n;return n},get_$5m:function(){return $8(this.$3l.IsAllDayEvent)?!1:Boolean.parse(this.$3l.IsAllDayEvent)},set_$5m:function(n){this.$3l.IsAllDayEvent=n.toString();return n},$6sg:function(n){$8(this.get_$10())||n.set_$10(this.get_$10());$8(this.get_$DE())||n.set_$23(n.get_$10().$9b(this.get_$DE()));$8(this.get_$5m())||n.set_$5m(this.get_$5m())}};_d.$cR=function(n){this.$p=n};_d.$cR.prototype={$p:null,$I:function(n,t,i){var f=new _h.$4S(n.$r.get_$10(),n.$r.get_$23());var u=null;var r=n.$r.get_$9D();r&&r.get_$F()>0&&(u=r.get_$48(0).get_$6V());return new _d.$H0(i,f,u)},$4oI:function(n,t){var i=new _h.$4S(n.$r.get_$10(),n.$r.get_$23());var r=this;return new _d.$Ds(this.$p,t,function(){return new _c.$10c},i,_d.$Gs.isInstanceOfType(n.$Cm.get_$GK()))}};_d.$4X=function(n,t,i,r,u,f,e){this.$$d_$5io=Function.createDelegate(this,this.$5io);this.$$d_$5fx=Function.createDelegate(this,this.$5fx);this.$$d_$5kF=Function.createDelegate(this,this.$5kF);this.$$d_$3xP=Function.createDelegate(this,this.$3xP);_d.$4X.initializeBase(this,[f,n,t,i,r,u,e])};_d.$4X.$1QN=function(n,t,i){var r=new _d.$CD;r.set_$1h(n);r.set_$13c(t);r.set_$AU(i);return r};function $6JV(n,t){var i=new _js.$X;var r=this;n.$1L.$Bx(function(n){var r=n.$4U;t===r.$WG&&i.$H(n)});return i}function $3ES(n,t){$4LP(n,!1);if(t){n.$2Q.get_$72().$1u();n.$2Q.get_$8A().$1u();n.$2Q.get_$9D().$1u();$4LO(n,t)}else{$3ER(n,n.$2Q.get_$72(),0);$3ER(n,n.$2Q.get_$8A(),1);$3ER(n,n.$2Q.get_$9D(),2)}}function $4LP(n,t){t||n.$1L.remove_$1Z(n.$$d_$5kF);n.$1L.$1u();t||n.$1L.add_$1Z(n.$$d_$5kF)}function $3ER(n,t,i){for(var r=0;r<t.get_$F();r++){var u=_d.$4X.$1QN(t.get_$48(r).get_$6V(),i,!0);$3EQ(n,u,!1)}}function $4LO(n,t){for(var i=0;i<t.get_$F();i++)$3EQ(n,t.get_$48(i),!0)}function $3EQ(n,t,i){i||n.$1L.remove_$1Z(n.$$d_$5kF);if(t.get_$AU()){var r=n.$50.$qm(_c.$i.$E5(t.get_$1h()),n.$1Kz,!0,n.$1wM);r.set_$13c(t.get_$13c());r.$a("AttendeeType",n.$$d_$5fx);n.$1CU(r)}else n.$234(_c.$i.$E5(t.get_$1h()));i||n.$1L.add_$1Z(n.$$d_$5kF)}function $4LS(n,t){switch(t){case 0:return n.$2Q.get_$72().get_$9JV();case 1:return n.$2Q.get_$8A().get_$9JV();case 2:return n.$2Q.get_$9D().get_$9JV();default:throw Error.argumentOutOfRange("Unknown AttendeeTypeType: "+_d.$jR.toString(t));}}function $6JW(n,t){switch(t){case 0:return 1;case 1:return 0;default:throw Error.invalidOperation("Operation supported only for Required and Optional Attendees");}}function $4LT(n,t){var i=$4LS(n,t.get_$13c());var r=t.get_$1h();var u=this;i.$DK(function(n){if(_g.$2I.$4W(r,n.get_$6V())){i.$3Q(n);return!0}return!1})}function $4LN(n,t){var i=$4LS(n,t.get_$13c());i.$H(_g.$3X.$rO(t.get_$1h()))}function $6JX(n,t){switch(t.$3R){case 0:var i=this;Array.forEach(t.$2t,function(t){t.$4U.$a("AttendeeType",n.$$d_$5fx);var i=t.$4U;var r=_d.$4X.$1QN(i.$Wp(),i.$WG,t.$Kq);$4LN(n,r)});break;case 2:var r=this;Array.forEach(t.$3Y,function(t){var i=t.$4U;i.$w("AttendeeType",n.$$d_$5fx);var r=t.$4U.$Wp();var u=_d.$4X.$1QN(r,i.$WG,t.$Kq);$4LT(n,u)});break;case 3:case 4:throw Error.invalidOperation("People Picker only supports adding and removing attendees from the underlying recipient well.");}}function $4LR(n,t){var i=new _js.$X;var r=this;t.$Bx(function(t){i.$H($4LQ(n,t))});return i}function $4LQ(n,t){var i=t.$4U;var r=_d.$4X.$4r7;_d.$Jd.isInstanceOfType(i)&&(r=i.$WG);return _d.$4X.$1QN(i.$Wp(),r,t.$Kq)}_d.$4X.prototype={$2Q:null,get_$40q:function(){return $6JV(this,0)},set_$40q:function(n){var t=$4LR(this,n);if(this.$48U!=="TouchNarrow"){var i=this;this.$1L.$Bx(function(n){var r=$4LQ(i,n);r.get_$13c()&&t.$H(r)});$4LP(this,!0)}$4LO(this,t);return n},get_$4iz:function(){return this.$2Q},set_$4iz:function(n){if(this.$2Q){this.$2Q.$w("RequiredAttendees",this.$$d_$3xP);this.$2Q.$w("OptionalAttendees",this.$$d_$3xP);this.$2Q.$w("Resources",this.$$d_$3xP)}this.$2Q=n;if(this.$2Q){this.$2Q.$a("RequiredAttendees",this.$$d_$3xP);this.$2Q.$a("OptionalAttendees",this.$$d_$3xP);this.$2Q.$a("Resources",this.$$d_$3xP)}return n},$3v:function(n,t){this.set_$4iz(n);this.$1L.add_$1Z(this.$$d_$5kF);$3ES(this,t)},$7IM:function(){this.$15P();return $4LR(this,this.$1L)},$6qk:function(n){if(n){var t=_d.$4X.$1QN(n,2,!0);$3EQ(this,t,!1)}},$8rA:function(n){if(n){var i=this;var t=this.$1L.$DK(function(t){return _g.$2I.$4W(n,t.$4U.$Wp())});t<this.$1L.get_$F()&&this.$34L(this.$1L.get_$48(t).$4U)}},$6yG:function(n){n?n===1?this.$2Q.get_$8A().$1u():n===2&&this.$2Q.get_$9D().$1u():this.$2Q.get_$72().$1u();$3ES(this)},$59:function(){this.set_$4iz(null);this.$1L.remove_$1Z(this.$$d_$5kF);this.remove_$Om(this.$$d_$5io);_d.$2n.prototype.$59.call(this)},$3xP:function(n,t){$3ES(this)},$5io:function(){this.$2aj()},$5kF:function(n,t){$6JX(this,t)},$5fx:function(n,t){var r=!0;var i=n;var u=$6JW(this,i.$WG);var f=_d.$4X.$1QN(i.$Wp(),u,r);$4LT(this,f);var e=_d.$4X.$1QN(i.$Wp(),i.$WG,r);$4LN(this,e)}};_d.$jQ=function(n,t,i){this.$G=t;this.$11J=n;this.$4dM=i};_d.$jQ.prototype={$G:null,$4dM:null,$11J:null,$I:function(){return new _d.$4X(7,_y.$q.$Mp,null,!0,this.$11J,this.$G.get_$O(),this.$4dM)}};_d.$CD=function(){_d.$CD.initializeBase(this)};_d.$CD.prototype={get_$13c:function(){return this.$W(_d.$CD.$3MR)},set_$13c:function(n){this.$N(_d.$CD.$3MR,n);return n},get_$1h:function(){return this.$W(_d.$CD.$1Ev)},set_$1h:function(n){this.$N(_d.$CD.$1Ev,n);return n},get_$AU:function(){return this.$W(_d.$CD.$1ok)},set_$AU:function(n){this.$N(_d.$CD.$1ok,n);return n},get_$1tl:function(){return null}};_d.$Q6=function(n,t,i,r){_d.$Q6.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;this.dispose=this.$1M;_d.$Q6.initializeBase(this);_a.$3.$M(n,"model");this.$3w=n;this.$3fo=r;this.$QC=i;$6Ky(this,t)};function $6Ky(n,t){if(t){var i=n.$QC.get_$2M();var r=n.$3w.get_$10().$Fr(Math.min(15,n.$3w.get_$2ep())).$6E(i);n.$rC=_js.$K.get_$L().$21(_d.$Q6.$2Zc,"CalendarMiniatureItem",t,r)}}_d.$Q6.prototype={$rC:null,$3w:null,$3fo:!1,$QC:null,$59:function(){this.$rC&&(this.$rC=_js.$K.get_$L().$5G(this.$rC));this.$3w=null;_a.$1.prototype.$59.call(this)},get_$Nd:function(){return this.$3w},get_$4h:function(){return this.$3w.get_$4h()},get_$7YC:function(){return this.$3fo},get_$1og:function(){return _a.$7.$1og(this.$3w.get_$10())},get_$4Ar:function(){var i=!(this.get_$1og()||this.$3fo);var n;if(!this.$3w.get_$10().$2Y(this.$3w.get_$23())){n=i?_u.Strings.l_CalendarMiniatureStartSameAsEndTomorrow_Text:_u.Strings.l_CalendarMiniatureStartSameAsEnd_Text;return String.format(n,this.$3w.get_$10().$2P(18))}var f=this.$3w.get_$2ep()>1440;var u=this.$3w.get_$5m();if(!f){if(u)return i?_u.Strings.l_CalendarMiniatureAllDayTomorrow_Text:_u.Strings.l_CalendarMiniatureAllDay_Text;n=i?_u.Strings.l_CalendarMiniatureTimeRangeTomorrow_Text:_u.Strings.l_CalendarMiniatureTimeRange_Text;return String.format(n,this.$3w.get_$10().$2P(18),this.$3w.get_$23().$2P(18))}var r;var t=this.$3w.get_$23();if(u){n=_u.Strings.l_CalendarMiniatureLongTimeRange_Text;r=this.get_$1og()?_u.Strings.l_CalendarMiniatureToday_Text:_u.Strings.l_CalendarMiniatureTomorrow_Text;t=t.$1CT(-1)}else{n=i?_u.Strings.l_CalendarMiniatureLongTimeRangeTomorrow_Text:_u.Strings.l_CalendarMiniatureLongTimeRange_Text;r=this.$3w.get_$10().$2P(18)}var e=t.$8c(this.$QC.get_$2M().$2q(6))<=0;var o=e?_a.$7.$1FZ(t.get_$Cd()):t.$2P(1);return String.format(n,r,o)},get_$2h:function(){return this.$3w.get_$2h()}};_d.$58=function(n,t,i,r,u){this.$$d_$2NJ=Function.createDelegate(this,this.$2NJ);this.$$d_$30G=Function.createDelegate(this,this.$30G);this.$$d_$5gG=Function.createDelegate(this,this.$5gG);this.$$d_$3xb=Function.createDelegate(this,this.$3xb);this.$$d_$5gI=Function.createDelegate(this,this.$5gI);this.$i9=new(_0365f.$s.$$(Number));_d.$58.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$58.initializeBase(this);this.$5w=i;this.$QC=t;this.$3vh=n==="TouchNarrow"?1:2;this.$5X=u;this.$YS=new _d.$58.$6vq(this.$5X,r,this.$$d_$5gI,this.$$d_$3xb,this.$$d_$5gG);var f=this;r.$1FT(function(){$6Kz(f);f.$5X.add_$1Z(f.$$d_$30G);f.$614=!0})};_d.$58.$3Pw=function(n,t){if(!n)return t?-1:0;if(!t)return 1;var i=n;var r=t;var u=i.get_$10().$8c(r.get_$10());return u?u:_d.$9p.$w6(i,r)};_d.$58.$504=function(n){return n.$3u().$2q(2).$9b(-1)};function $6L5(n){$6L8(n);$6L3(n);$6L4(n);$6L9(n);$6L6(n)}function $6L6(n){var t=n.$1Jm>1?0:n.$1uD>1?1:-1;$6L7(n,t)}function $6L7(n,t){if(t<0)n.set_$3QI(null);else{for(var i=$6L1(n,t),s=i+n.$i9.get_$48(t),f=!0,r=i;r<s;r++)if(!n.$Zl.get_$48(r).get_$5m()){f=!1;break}var e=n.$Zl.get_$48(i).get_$10();var o=_a.$7.$1og(e);var u;if(f){var h=o?_u.Strings.l_CalendarMiniatureConflict_AllDay_Text:_u.Strings.l_CalendarMiniatureConflict_AllDay_Tomorrow_Text;u=String.format(h,n.$i9.get_$48(t))}else{var c=o?_u.Strings.l_CalendarMiniatureConflict_Text:_u.Strings.l_CalendarMiniatureConflict_Tomorrow_Text;u=String.format(c,n.$i9.get_$48(t),e.$2P(18))}n.set_$3QI(u)}}function $6L1(n,t){for(var r=0,i=0;i<t;i++)r+=n.$i9.get_$48(i);return r}function $6L9(n){n.set_$5dS(n.$1Jm>n.$3vh?String.format(_u.Strings.l_CalendarMiniatureMoreAppointments_Text,n.$1Jm-n.$3vh):null)}function $6L4(n){var t=n.$1Jm>1;n.set_$4ww($4MD(n,t,n.$Zl.get_$F()>0,n.$1S4,n.$Zl.get_$48(0)));var i=t||n.$1uD>1;n.set_$5wx($4MD(n,i,n.$Zl.get_$F()>1,n.$1xP,n.$Zl.get_$48(1)))}function $4MD(n,t,i,r,u){return i?!r||r.get_$Nd()!==u||r.get_$7YC()!==t?new _d.$Q6(u,n.$$d_$2NJ,n.$QC,t):r:null}function $6L3(n){var t=n.$i9.get_$F()>0?n.$i9.get_$48(0):0;var i=n.$i9.get_$F()>1?n.$i9.get_$48(1):0;var r=n.$1Jm!==t;var u=n.$1uD!==i;n.$1Jm=t;n.$1uD=i;(r||u)&&$Bc(n,"NumberOfAppointmentsChanged",n,null)}function $6L8(n){n.$i9.$1u();if(n.$Zl.get_$F())for(var i=null,e=n.$Zl.get_$F(),t=-1,r=0;r<e;r++){var u=n.$Zl.get_$48(r);if(u&&i&&_a.$7.$4F(u.get_$10(),i.get_$10())){var f;(f=n.$i9).set_$48(t,f.get_$48(t)+1)}else{if(t===1)break;i=u;n.$i9.$H(1);t=n.$i9.get_$F()-1}}}function $4MC(n,t){var i=t.get_$10().$Fr(Math.min(15,t.get_$2ep()));return i.$2Y(n.$QC.get_$2M())}function $4MB(n){n.$1bY=!1;var t=n.$YS.$25L();n.$1bY=!0;t&&n.$2NJ()}function $6L2(n){n.$7o=$2Tl(n);for(var i=n.$5X.get_$F(),t=0;t<i;t++){var r=n.$5X.get_$48(t);$4ME(n,r)}}function $2Tl(n){var t=n.$QC.get_$2M();var i=_d.$58.$504(t);return new _h.$4S(t,i)}function $6L0(n){for(var i=0,r=n.$5X.get_$F(),t=0;t<r;t++){var u=n.$5X.get_$48(t);var f=n.$YS.$29h(u,n.$7o);i+=f.length}(!n.$1S4||i-(n.$1Jm+n.$1uD)<=1)&&n.$7o&&n.$7o.$2w.$2Y(_d.$58.$504(n.$QC.get_$2M()))<0&&$6L2(n)}function $6Kz(n){n.$1bY=!0;var i=n.$5X.get_$F();n.$7o=$2Tl(n);for(var t=0;t<i;t++){var r=n.$5X.get_$48(t);n.$YS.$2Ng("CalendarMiniatureNextAppointmentManager",r,n.$7o,6)}}function $6LA(n,t,i){if(i&&i.length>0){n.$7o=$2Tl(n);n.$2NJ();return}var u;if(t&&(u=t.length)>0){n.$7o=$2Tl(n);for(var r=0;r<u;r++)$4ME(n,t[r]);return}}function $4ME(n,t){n.$YS.$2Ng("CalendarMiniatureNextAppointmentManager",t,n.$7o,6)}_d.$58.prototype={$3vh:0,$5X:null,$1Jm:0,$1uD:0,$1S4:null,$1xP:null,$Zl:null,$3QH:null,$3vV:null,$YS:null,$7o:null,$1HP:!1,$1bY:!1,$614:!1,$QC:null,$5w:null,get_$4ww:function(){return this.$1S4},set_$4ww:function(n){if(this.$1S4!==n){this.$1S4&&this.$1S4.dispose();this.$1S4=n;$6(this,"FirstAppointment")}return n},get_$5wx:function(){return this.$1xP},set_$5wx:function(n){if(this.$1xP!==n){this.$1xP&&this.$1xP.dispose();this.$1xP=n;$6(this,"SecondAppointment")}return n},get_$5fJ:function(){return this.$1Jm},get_$8QW:function(){return this.$1uD},add_$5fD:function(n){this.$2Z("NumberOfAppointmentsChanged",n)},remove_$5fD:function(n){this.$2b("NumberOfAppointmentsChanged",n)},get_$3QI:function(){return this.$3QH},set_$3QI:function(n){if(this.$3QH!==n){this.$3QH=n;$6(this,"ConflictingAppointmentsMessage")}return n},get_$5dS:function(){return this.$3vV},set_$5dS:function(n){if(this.$3vV!==n){this.$3vV=n;$6(this,"MoreAppointmentsMessage")}return n},$30b:function(){this.$1HP=!0;this.$1bY&&$4MB(this)},$30d:function(){this.$1HP=!1},$2NJ:function(){this.$Zl=new _0365f.$Ih(_d.$58.$3Pw);for(var h=this.$5X.get_$F(),u=0;u<h;u++){var c=this.$5X.get_$48(u);var i=this.$YS.$29h(c,this.$7o);var r=this.$Zl;this.$Zl=new _0365f.$Ih(_d.$58.$3Pw);for(var t=0,n=0,f=i.length,e=r.get_$F();t<e&&n<f;){var o=i[n];var l=$4MC(this,o);if(l<0){n++;continue}if(_d.$58.$3Pw(r.get_$48(t),i[n])<0){this.$Zl.$H(r.get_$48(t));t++}else{this.$Zl.$H(o);n++}}while(t<e){this.$Zl.$H(r.get_$48(t));t++}while(n<f){var s=i[n];var a=$4MC(this,s);a>=0&&this.$Zl.$H(s);n++}}$6L5(this);$6L0(this)},$59:function(){this.$614&&this.$5X.remove_$1Z(this.$$d_$30G);_a.$1.prototype.$59.call(this)},$30G:function(n,t){var i=this;this.$5w.$3i(_d.$58.$2Zc,"OnSelectedCalendarsCollectionChanged",function(){$6LA(i,t.$2t,t.$3Y)})},$5gG:function(){this.$1HP&&this.$1bY&&$4MB(this)},$3xb:function(n,t){this.$1bY&&this.$2NJ()},$5gI:function(n,t){this.$1bY&&this.$2NJ()}};_d.$58.$6vq=function(n,t,i,r,u){_d.$58.$6vq.initializeBase(this,[n,t,null,i,null,r,u])};_d.$58.$6vq.prototype={$4o8:function(n){return new _c.$pw(n)},$76A:function(n){return new _c.$16q(n)}};_d.$4B=function(n,t,i,r,u){this.$$d_$8d7=Function.createDelegate(this,this.$8d7);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$1Lh=1;this.$gR=24;_d.$4B.initializeBase(this);this.$dn=n;this.$1c=t;this.$24f=i;this.$3zm=r;this.$1D=u;this.$Cv=new _C(this.$$d_$eC,_a.$0.$1o);var e=this;this.$1w3=new _C(function(){},_a.$0.$1o);$6LG(this);this.$2bC=new _js.$X;this.$32u=new _y.$F8;$6LH(this);$6LI(this);this.$2u=r.get_$8G();if(this.get_$4js()){var f=t.$t.get_$1t().get_$Tv();this.$gU=Math.floor(f.get_$1NX()/60);this.$gR=Math.floor(f.get_$4Gn()/60)}$6LK(this,r)};function $4MK(n,t){n.$2Cx&&(n.$2Cy||t)?n.$49C():n.$61a()}function $6LK(n,t){var i=t.get_$1Q();switch(i){case"CalendarDayViewModel":n.set_$1xS(1);break;case"CalendarWeekViewModel":n.set_$1xS(2);break;case"CalendarWorkWeekViewModel":n.set_$1xS(3);break;case"MonthAgendaViewModel":n.set_$1xS(4);break;default:n.set_$1xS(1);break}}function $21c(n){n.set_$9N(!0);n.set_$5qN($6LD(n,n.$1AL,n.$1Lh));n.set_$9N(!1)}function $6LF(n,t,i){switch(t){case 1:return"DayViewModel";case 2:return i===3||i===2?"WeeklyAgenda":"WeekViewModel";case 3:return i===3||i===2?"WorkWeekAgenda":"WorkWeekViewModel";case 4:return"MonthAgendaViewModel";default:throw Error.argument("viewModelType","Unknown CalendarViewTypeEnum value");}}function $6LE(n,t,i){var r=null;if(i in n.$24f){r=n.$24f[i];if(r.get_$8G()!==n.$2u){delete n.$24f[i];r=null}}if(!r){switch(t){case 1:r=n.$dn.$4o7(n.$2u,n.$1c);break;case 4:r=n.$dn.$4oy(n.$2u,!0,null,n.$1c);break;case 2:r=n.$1Lh===2||n.$1Lh===3?n.$dn.$76k(n.$2u,n.$1c):n.$dn.$4pU(n.$2u,null,n.$1c);break;case 3:r=n.$dn.$4pY(n.$2u,null,n.$1c);break;default:break}n.$24f[i]=r}return r}function $6LD(n,t,i){var u=null;var f=$6LF(n,t,i);var r=$6LE(n,t,f);switch(f){case"WeeklyAgenda":case"WorkWeekAgenda":u=new _d.$AH(r,t,i,n);break;case"DayViewModel":u=new _d.$PE(r,n,n.$1D);break;case"MonthAgendaViewModel":u=new _d.$NZ(r,n);break;case"WeekViewModel":u=new _d.$nb(r,n,n.$1D);break;case"WorkWeekViewModel":u=new _d.$nc(r,n,n.$1D);break;default:break}n.set_$4sF(n.$dn.$75b(n.$2u,n.$1c,n,r.get_$14d()===3?6:r.get_$14d(),n.$1D));return u}function $6LH(n){if($8(_d.$4B.$1DN)){_d.$4B.$1DN=new _js.$X;_d.$4B.$1DN.$H(1);_d.$4B.$1DN.$H(2);_d.$4B.$1DN.$H(3);_d.$4B.$1DN.$H(4)}}function $6LI(n){if($8(_d.$4B.$1VB)){_d.$4B.$1VB=new _js.$X;_d.$4B.$1VB.$H(1);_d.$4B.$1VB.$H(2);_d.$4B.$1VB.$H(3)}}function $4MJ(n){n.$1zF?n.$1zF.$1u():n.$1zF=new _js.$X;for(var t=0;t<n.$gR;t++)n.$1zF.$H(t)}function $4MI(n){n.$1jd?n.$1jd.$1u():n.$1jd=new _js.$X;for(var t=n.$gU+1;t<=24;t++)n.$1jd.$H(t)}function $6LG(n){n.set_$8n2($6LC(n));n.$Iz=n.$1c.$CH}function $6LC(n){for(var r=new _js.$X,u=n.$1c.$6w.$5X,t=null,i=0,f=u.get_$F();i<f;++i){t=u.get_$48(i);t&&r.$H(t)}return r}function $6LJ(n,t,i,r){r.val=i===3||i===2;return!!((t===2||t===3)^r.val)}function $4MH(n){n.set_$5qN(null);n.set_$4sF(null);n.$3zm=null}_d.$4B.prototype={$dn:null,$1c:null,$24f:null,$2bC:null,$32u:null,$Cv:null,$1w3:null,$2u:null,$1D:null,$Po:!1,$3zm:null,$oY:null,$14k:null,$Fw:null,$Iz:null,$32s:null,$1AL:0,$2Dk:!1,$2Cx:!1,$2Cy:!1,$1zF:null,$1jd:null,$gU:0,get_$9N:function(){return this.$Po},set_$9N:function(n){if(this.$Po!==n){this.$Po=n;$6(this,"Loading")}return n},get_$1Ld:function(){return this.$Iz},set_$1Ld:function(n){if(n!==this.$Iz){this.$Iz=n;$6(this,"SelectedCalendar");$21c(this)}return n},get_$8n2:function(){return this.$32s},set_$8n2:function(n){if(this.$32s!==n){this.$32s=n;$6(this,"PrintableCalendars")}return n},get_$6vt:function(){return _d.$4B.$1DN},get_$1xS:function(){return this.$1AL},set_$1xS:function(n){if(this.$1AL!==n){var t;var i,r;var u=(r=$6LJ(this,this.$1AL,n,i={val:t}),t=i.val,r);this.$1AL=n;u&&$6(this,"IsCalendarLayoutHidden");$21c(this)}return n},get_$7Xx:function(){return this.$1AL!==2&&this.$1AL!==3},get_$7eQ:function(){return _d.$4B.$1VB},get_$8vx:function(){return this.$1Lh},set_$8vx:function(n){if(this.$1Lh!==n){this.$1Lh=n;if(n){$6(this,"SelectedLayout");$21c(this)}}return n},get_$7A8:function(){return!0},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$427:function(){return 1},get_$2Ao:function(){return this.$$d_$8d7},get_$1bo:function(){return 320},get_$96d:function(){this.$1zF||$4MJ(this);return this.$1zF},get_$7Cj:function(){this.$1jd||$4MI(this);return this.$1jd},get_$8w3:function(){return this.$gU},set_$8w3:function(n){if(n!==this.$gU){this.$gU=n;$6(this,"SelectedStartTime");$4MI(this);this.$gU>=this.$gR&&this.set_$5xK(this.$gU+1);$21c(this)}return n},get_$5xK:function(){return this.$gR},set_$5xK:function(n){n||(n=24);if(n!==this.$gR){this.$gR=n;$6(this,"SelectedEndTime");$4MJ(this);$21c(this)}return n},get_$7b2:function(){return this.$2Dk},set_$7b2:function(n){if(this.$2Dk!==n){this.$2Dk=n;$6(this,"IsNotesPanelExpanded")}return n},get_$4k0:function(){return this.$1AL===1},get_$4js:function(){return this.$1D.get_$rk()},get_$7YV:function(){return this.$2Cx},set_$7YV:function(n){if(this.$2Cx!==n){this.$2Cx=n;$6(this,"IsDetailedAgendaSelected");$4MK(this,!0)}return n},get_$59n:function(){return this.$2Cy},set_$59n:function(n){if(this.$2Cy!==n){this.$2Cy=n;$6(this,"IsDetailedAgendaShown")}return n},get_$5qN:function(){return this.$oY},set_$5qN:function(n){if(this.$oY!==n){if(this.$oY){this.$oY.$pD!==this.$3zm&&this.$oY.$pD.set_$G5(!1);this.$oY.$4l5();this.$oY.$1M()}this.$oY=n;if(this.$oY){this.$oY.$6tp();this.$oY.$pD.set_$G5(!0);this.$2bC.$6l(n)||this.$2bC.$H(n);$4MK(this,!1)}$6(this,"CanShowNotes")}return n},get_$4sF:function(){return this.$14k},set_$4sF:function(n){if(this.$14k!==n){if(this.$14k){this.$14k.set_$G5(!1);this.$14k.$1M()}this.$14k=n}return n},get_$Jr:function(){return 0},$61a:function(){this.$32u.$MZ(this.$oY);this.$14k.set_$G5(!1);this.set_$59n(!1)},$49C:function(){this.$14k.set_$G5(!0);this.$32u.$MZ(this.$14k);this.set_$59n(!0)},$eC:function(){$4MH(this);this.get_$8K()&&this.get_$8K()()},$8d7:function(n,t){$4MH(this);return!1}};_d.$NY=function(n){_d.$NY.initializeBase(this);this.$o=n};_d.$NY.prototype={$o:null};_d.$AH=function(n,t,i,r){this.$$d_$3du=Function.createDelegate(this,this.$3du);this.$$d_$5fo=Function.createDelegate(this,this.$5fo);_d.$AH.initializeBase(this,[n,r]);this.$kA=n;this.$NO=i;this.$rF=new _0365f.$Ih(_d.$9p.$w6);$21m(this,this.$kA.$BJ,this.$rF);this.$3du(null,null)};function $1Nl(n,t){return t>=n.$1EP.length?"":n.$1EP[t].$2P(3)}function $2UJ(n,t,i,r,u){var f=t[r];t[r]=t[u];t[u]=f;f=i[r];i[r]=i[u];i[u]=f}_d.$AH.prototype={$NO:0,$Wd:null,$1EP:null,$kA:null,$rF:null,get_$8QU:function(){return this.$Wd.length},get_$77Z:function(){return $1Nl(this,0)},get_$77b:function(){return $1Nl(this,1)},get_$77d:function(){return $1Nl(this,2)},get_$77f:function(){return $1Nl(this,3)},get_$77h:function(){return $1Nl(this,4)},get_$77j:function(){return $1Nl(this,5)},get_$77l:function(){return $1Nl(this,6)},get_$77a:function(){return new _d.$NY(this.$Wd[0])},get_$77c:function(){return new _d.$NY(this.$Wd[1])},get_$77e:function(){return new _d.$NY(this.$Wd[2])},get_$77g:function(){return this.$Wd.length>=4?new _d.$NY(this.$Wd[3]):null},get_$77i:function(){return new _d.$NY(this.$Wd[4])},get_$77k:function(){return this.$Wd.length>=6?new _d.$NY(this.$Wd[5]):null},get_$77m:function(){return new _d.$NY(this.$Wd[6])},$4l5:function(){this.$kA.$BJ.remove_$1Z(this.$$d_$5fo);this.$kA.$o.remove_$1Z(this.$$d_$3du)},$6tp:function(){this.$kA.$BJ.add_$1Z(this.$$d_$5fo);this.$kA.$o.add_$1Z(this.$$d_$3du)},$5fo:function(n,t){switch(t.$3R){case 0:$4PD(this,t.$2t,this.$rF);break;case 2:$4PE(this,t.$3Y,this.$rF);break;case 3:throw Error.notImplemented();case 4:$21m(this,this.$kA.$BJ,this.$rF);break;default:break}this.$3du(n,t)},$3du:function(n,t){this.$Wd=new Array(this.$kA.$HA.length);this.$1EP=new Array(this.$kA.$HA.length);var h=this.$Wd.length;if(this.$kA.$o)for(var r=this.$kA.$E8.$2G,u,i,e,f=0;f<h;f++){u=new _js.$X;for(var o=0,c=this.$rF.get_$F();o<c;o++){i=this.$rF.get_$48(o);e=i.get_$10().$8c(r);(!e||e<0&&i.get_$23().$Fr(-1).$8c(r)>=0)&&u.$H(new _d.$ha(i))}for(var s=0,l=this.$kA.$o.get_$F();s<l;s++){i=this.$kA.$o.get_$48(s);i.get_$10().get_$Cd()===r.get_$Cd()&&_d.$Ag.$2PU(i,this.get_$b1().$gU,this.get_$b1().$gR,this.get_$b1().$Iz)&&(_d.$Jw.isInstanceOfType(i)?u.$H(new _d.$ha(i.$2Q)):u.$H(new _d.$ha(i)))}this.$Wd[f]=u;this.$1EP[f]=r;r=r.$2q(1)}if(this.$NO===3)switch(h){case 3:case 4:$2UJ(this,this.$Wd,this.$1EP,1,2);break;case 5:case 6:case 7:$2UJ(this,this.$Wd,this.$1EP,1,2);$2UJ(this,this.$Wd,this.$1EP,1,4);$2UJ(this,this.$Wd,this.$1EP,1,3);break}$8(n)||$Ha(this,["Day1Items","Day2Items","Day3Items","Day4Items","Day5Items","Day6Items","Day7Items"])}};_d.$Ag=function(n,t){_d.$Ag.initializeBase(this);this.$pD=n;this.set_$b1(t)};_d.$Ag.$2PU=function(n,t,i,r){var s=n.get_$23().get_$Ec()?n.get_$23().get_$Ec():24;var u=n.get_$10().get_$Gs()+(n.get_$10().get_$Ec()<<6);var f=n.get_$23().get_$Gs()+(s<<6);var e=t<<6;var o=i<<6;return(!n.get_$5Z()&&!r||n.get_$5Z().$4W(r))&&(n.get_$9w()||_g.$39.isInstanceOfType(n)&&n.get_$1UI()&&(u<o||f>e)||u<o&&f>e)};function $21m(n,t,i){var r;i.$1u();for(var u=0,f=t.get_$F();u<f;u++){r=t.get_$48(u);_d.$Ag.$2PU(r,n.$hK.$gU,n.$hK.$gR,n.$hK.$Iz)&&i.$H(r)}}function $4PD(n,t,i){for(var r,u=0,f=t.length;u<f;u++){r=t[u];_d.$Ag.$2PU(r,n.$hK.$gU,n.$hK.$gR,n.$hK.$Iz)&&i.$H(r)}}function $4PE(n,t,i){for(var r=0,u=t.length;r<u;++r)i.$3Q(t[r])}_d.$Ag.prototype={$pD:null,$hK:null,get_$4Al:function(){return this.get_$b1().$gU},get_$7Cd:function(){return this.get_$b1().$gR},get_$b1:function(){return this.$hK},set_$b1:function(n){this.$hK=n;return n},$59:function(){this.set_$b1(null);_a.$1.prototype.$59.call(this)}};_d.$PE=function(n,t,i){this.$$d_$8bI=Function.createDelegate(this,this.$8bI);_d.$PE.initializeBase(this,[n,t,i])};_d.$PE.prototype={$19v:function(){$6(this,"LayoutResize")},$4l5:function(){_d.$PF.prototype.$4l5.call(this);this.get_$b1().$w("IsNotesPanelExpanded",this.$$d_$8bI)},$6tp:function(){_d.$PF.prototype.$6tp.call(this);this.get_$b1().$a("IsNotesPanelExpanded",this.$$d_$8bI)},$8bI:function(n,t){$6(this,"IsNotesPanelExpanded")}};_d.$PF=function(n,t,i){this.$$d_$5fo=Function.createDelegate(this,this.$5fo);this.$$d_$TP=Function.createDelegate(this,this.$TP);_d.$PF.initializeBase(this,[n,t]);this.$1D=i;this.$13l=n;this.$Mu=new _d.$LN(n.$HA,n.$BJ,n.$1c,n.$1c.$2f);this.$2gG=new _0365f.$Ih(_d.$9p.$w6);$21m(this,this.$13l.$o,this.$2gG);this.$rF=new _0365f.$Ih(_d.$9p.$w6);$21m(this,this.$13l.$BJ,this.$rF);$4PF(this)};function $4PG(n,t,i,r){switch(t.$3R){case 0:$4PD(n,t.$2t,r);break;case 2:$4PE(n,t.$3Y,r);break;case 4:$21m(n,i,r);break;default:throw Error.notImplemented(_js.$8.$4C("Action '{0}' is not supported in PrintDayWeekBaseViewModel",t.$3R));}}function $4PF(n){var t=n.get_$7Cd()-n.get_$4Al();var i=875-n.$YD;n.set_$77s(i/t)}_d.$PF.prototype={$13l:null,$Mu:null,$2gG:null,$rF:null,$1D:null,$2cy:50,$YD:0,get_$23P:function(){return this.$YD},set_$23P:function(n){if(this.$YD!==n){this.$YD=n;$4PF(this);$6(this,"AllDayPanelHeight")}return n},get_$77s:function(){return this.$2cy},set_$77s:function(n){this.$2cy=n;$6(this,"DayViewIntervalHeight");return n},get_$iP:function(){return!_a.UserAgent.getInstance().$Lr},get_$6vr:function(){return-(this.$2cy*this.get_$4Al())},get_$7TL:function(){return this.$1D.get_$1GU()},$4l5:function(){this.$13l.$o.remove_$1Z(this.$$d_$TP);this.$13l.$BJ.remove_$1Z(this.$$d_$5fo)},$6tp:function(){this.$13l.$o.add_$1Z(this.$$d_$TP);this.$13l.$BJ.add_$1Z(this.$$d_$5fo)},$TP:function(n,t){$4PG(this,t,this.$13l.$o,this.$2gG)},$5fo:function(n,t){$4PG(this,t,this.$13l.$BJ,this.$rF)}};_d.$nY=function(n,t,i,r,u,f,e,o){this.$3TS=6;_d.$nY.initializeBase(this,[n,!0,t,i,r,u]);this.$hK=f;this.$1D=o;this.$3TS=e;$4Lg(this)};_d.$nY.prototype={$1D:null,$hK:null,get_$1Q:function(){return"PrintDetailedAgendaViewModel"},get_$14d:function(){return this.$3TS},get_$7TD:function(){return this.$1D.get_$1GU()},$3KT:function(n){_d.$1E6.prototype.$3KT.call(this,n);for(var r=[],t,i=0,u=n.length;i<u;i++){t=n[i];t.get_$yC()||Array.add(r,t)}r.length>0&&this.$1c.$8T.$7f9(n)},$1bX:function(n){return _d.$1n.prototype.$1bX.call(this,n)?_d.$Ag.$2PU(n,this.$hK.$gU,this.$hK.$gR,this.$hK.$Iz):!1}};_d.$ha=function(n){_d.$ha.initializeBase(this,[n])};_d.$ha.prototype={get_$96e:function(){return this.$2Q.get_$5m()?this.$2Q.get_$10().$8c(this.$2Q.get_$23().$Fr(-1))<0?String.format(_u.Strings.l_PrintWeekRange_Text,this.$2Q.get_$10().$2P(4,0),this.$2Q.get_$23().$2P(4,0)):String.format(_u.Strings.l_PrintWeekRange_Text,this.$2Q.get_$10().$2P(0,0),this.$2Q.get_$23().$2P(4,0)):String.format(_u.Strings.l_PrintWeekRange_Text,this.$2Q.get_$10().$2P(0,0),this.$2Q.get_$23().$2P(0,0))},get_$7hr:function(){return this.$2Q.get_$Hm()?this.$2Q.get_$Cl().Mailbox.Name:""}};_d.$NZ=function(n,t){this.$$d_$8ga=Function.createDelegate(this,this.$8ga);_d.$NZ.initializeBase(this,[n,t]);this.$2u=this.$pD.get_$8G();$6RQ(this)};function $6RQ(n){n.$9Z=new Array(6);for(var i=n.get_$39e().$E8.$2G,t=0;t<6;++t)n.$9Z[t]=new _d.$Hy(i.$2q(t*7));$4PH(n)}function $4PH(n){for(var i,r,u,t=0;t<6;t++){i=n.$9Z[t].$o;i.$1u();r=n.get_$39e().$9Z[t].$o;for(var f=0,e=r.get_$F();f<e;f++){u=r.get_$48(f);_d.$Ag.$2PU(u,n.get_$b1().$gU,n.get_$b1().$gR,n.get_$b1().$Iz)&&i.$H(u)}}}_d.$NZ.prototype={$9Z:null,$2u:null,get_$39e:function(){return this.$pD},get_$4GY:function(){return this.$9Z[0]},get_$4GZ:function(){return this.$9Z[1]},get_$2So:function(){return this.$9Z[2]},get_$4Ga:function(){return this.$9Z[3]},get_$4Gb:function(){return this.$9Z[4]},get_$4Gc:function(){return this.$9Z[5]},$4l5:function(){this.$pD.$w("IsLoadingItems",this.$$d_$8ga)},$6tp:function(){this.$pD.$a("IsLoadingItems",this.$$d_$8ga)},$8ga:function(n,t){this.get_$39e().$1Go||$4PH(this)}};_d.$nb=function(n,t,i){_d.$nb.initializeBase(this,[n,t,i])};_d.$nb.prototype={get_$97i:function(){return this.$pD}};_d.$nc=function(n,t,i){_d.$nc.initializeBase(this,[n,t,i])};_d.$nc.prototype={get_$97j:function(){return this.$pD}};_d.$Jm=function(n,t,i,r,u){_d.$Jm.initializeBase(this);this.$EH=n;this.$EE=t;this.$KP=i;this.$66=u;r&&this.$56r()};function $3EP(n,t){var r=new _js.$X;if(t)for(var i=0;i<t.get_$F();i++)r.$H(t.get_$48(i).get_$6V());return n.$66.$UE(1,_y.$q.$1gC,r,1)}_d.$Jm.prototype={$5tu:null,$5ly:null,$5ua:null,$66:null,$EH:null,$EE:null,$KP:null,$56r:function(){this.$5tu=$3EP(this,this.$EH);this.$5ly=$3EP(this,this.$EE);this.$5ua=$3EP(this,this.$KP);$Nu(this,"RequiredAttendeesRecipientWellViewModel","OptionalAttendeesRecipientWellViewModel","ResourcesRecipientWellViewModel")},get_$8sC:function(){return String.format(_u.Strings.l_RequiredAttendeesLabelAndCount_Text,this.$EH.get_$F())},get_$8iT:function(){return String.format(_u.Strings.l_OptionalAttendeesLabelAndCount_Text,this.$EE.get_$F())},get_$8sw:function(){return String.format(_u.Strings.l_ResourcesLabelAndCount_Text,this.$KP.get_$F())},get_$62L:function(){return!!this.$KP&&this.$KP.get_$F()>0},get_$62I:function(){return!!this.$EH&&this.$EH.get_$F()>0},get_$624:function(){return!!this.$EE&&this.$EE.get_$F()>0}};_d.$EV=function(n,t,i,r,u){_d.$EV.initializeBase(this);this.$66=u;this.$QQ=new _d.$L6(n,t,i);r&&this.$572()};_d.$EV.$5zl=function(n,t){var i=n.$4U;i.$J1(1,t,0)};function $2Te(n,t,i){var o=new _js.$X;if(t)for(var u=0;u<t.get_$F();u++)o.$H(t.get_$48(u).get_$6V());for(var r=n.$66.$UE(1,_y.$q.$Hr,o,1),f=0;f<i;f++)_d.$EV.$5zl(r.$1L.get_$48(f),_u.Strings.l_AttendeeDetailsRequired_Text);for(var e=i;e<r.$1L.get_$F();e++)_d.$EV.$5zl(r.$1L.get_$48(e),_u.Strings.l_AttendeeDetailsOptional_Text);return r}_d.$EV.prototype={$66:null,$QQ:null,$4d2:null,$65r:null,$4r1:null,$5ej:null,get_$3Jo:function(){return this.$QQ.get_$3Jo()},get_$4Cq:function(){return this.$QQ.get_$4Cq()},get_$3Tb:function(){return this.$QQ.get_$3Tb()},get_$3wY:function(){return this.$QQ.get_$3wY()},get_$619:function(){return this.$QQ.$kX.get_$F()>0},get_$61Z:function(){return this.$QQ.$lQ.get_$F()>0},get_$62Z:function(){return this.$QQ.$pH.get_$F()>0},get_$620:function(){return this.$QQ.$nu.get_$F()>0},$572:function(){this.$4d2=$2Te(this,this.$QQ.$kX,this.$QQ.$4d3);this.$65r=$2Te(this,this.$QQ.$pH,this.$QQ.$65s);this.$4r1=$2Te(this,this.$QQ.$lQ,this.$QQ.$4r2);this.$5ej=$2Te(this,this.$QQ.$nu,this.$QQ.$5ek);$Ha(this,["AcceptedAttendeesRecipientWellViewModel","TentativelyAcceptedAttendeesRecipientWellViewModel","DeclinedAttendeesRecipientWellViewModel","NoResponseReceivedAttendeesRecipientWellViewModel"])}};_d.$Jn=function(n,t,i){this.$$d_$92P=Function.createDelegate(this,this.$92P);_d.$Jn.initializeBase(this);this.$66=t;this.$K9=n;if(this.$K9.get_$Hm()){this.$1bf=!i;this.$1bf&&(this.$490=new _C(this.$$d_$92P,_a.$0.$4jI));this.get_$4k2()?$6JT(this):$6JS(this)}};function $6JT(n){n.$2Yg=new _d.$EV(n.$K9.get_$72().get_$9JV(),n.$K9.get_$8A().get_$9JV(),n.$K9.get_$9D().get_$9JV(),!n.$1bf,n.$66)}function $6JS(n){n.$2Yf=new _d.$Jm(n.$K9.get_$72().get_$9JV(),n.$K9.get_$8A().get_$9JV(),n.$K9.get_$9D().get_$9JV(),!n.$1bf,n.$66)}_d.$Jn.prototype={$2Yf:null,$2Yg:null,$K9:null,$66:null,$1bf:!1,$490:null,get_$4k2:function(){return this.$K9.get_$Ho()&&this.$K9.get_$Cz()},get_$92D:function(){return this.$1bf},set_$92D:function(n){this.$1bf=n;$6(this,"ShowAllAttendeesButton");return n},$92P:function(){this.set_$92D(!1);this.$490.set_$5P(!1);if(this.$2Yf){this.$2Yf.$56r();return}if(this.$2Yg){this.$2Yg.$572();return}}};_d.$O1=function(){_d.$O1.initializeBase(this)};_d.$O1.prototype={get_$7F:function(){return this.$W(_d.$O1.$1gm)},set_$7F:function(n){this.$N(_d.$O1.$1gm,n);return n},get_$1tl:function(){return[this.get_$7F()]}};_d.$6M=function(n,t,i,r,u,f){this.$$d_$8c8=Function.createDelegate(this,this.$8c8);this.$$d_$8dP=Function.createDelegate(this,this.$8dP);this.$$d_$8dO=Function.createDelegate(this,this.$8dO);this.$$d_$8RM=Function.createDelegate(this,this.$8RM);this.$$d_$6vn=Function.createDelegate(this,this.$6vn);this.$$d_$6vo=Function.createDelegate(this,this.$6vo);this.$$d_$304=Function.createDelegate(this,this.$304);this.$$d_$3yQ=Function.createDelegate(this,this.$3yQ);this.$$d_$5H=Function.createDelegate(this,this.$5H);_d.$6M.initializeBase(this);this.$8T=u;this.$G=i;this.$50=t;this.$1F3=f;this.$Bo=r;this.$4a=new _C(this.$$d_$5H,_a.$0.$1o);this.$z=new _y.$8L;this.set_$1gn(n)};function $4M5(n){n.$l.$Od.add_$1O6(n.$$d_$3yQ);n.$l.$4x.add_$2m(n.$$d_$304)}function $4M6(n){n.$l.$Od.remove_$1O6(n.$$d_$3yQ);n.$l.$4x.remove_$2m(n.$$d_$304)}function $6Ke(n){n.$l.$r.get_$yC()||n.$l.$r.get_$1DP()&&n.$l.$r.get_$1o().get_$IY().Read&&(n.$aw=n.$8T.$1kw(300,n.$l.$r.get_$i(),n.$$d_$6vo,n.$$d_$6vn))}function $4M7(n){n.set_$2fg(n.$1F3.$748(n.$l,n.$$d_$8RM,$6Kc(n)));if(n.$l.$r.get_$yC()){var t=n.$l.$fv;n.set_$8iF(t.$hi(1,!1,n.$$d_$8RM,n.$$d_$8dO));n.$l.$r.get_$4h()&&n.$l.$r.get_$4h().$Sv()&&n.set_$8iG(t.$hi(1,!1,n.$$d_$8RM,n.$$d_$8dP));var i=new _d.$MS(n.$l.$r,n.$2LF,n.$z,n.$Bo);i.$12a();n.$l.$r.get_$Cz()&&n.set_$8t7(new _d.$L6(n.$l.$r.get_$72().get_$9JV(),n.$l.$r.get_$8A().get_$9JV(),n.$l.$r.get_$9D().get_$9JV()))}}function $4M4(n,t,i){t.$8wI(i)}function $6Kd(n){n.$20y=n.$l.$4x.get_$vr()?n.$l.$r.get_$Ho()?1:2:3}function $6Kb(n,t){t&&n.$20y!==1&&t.$J1(1,n.get_$6tu(),0)}function $6Kf(n,t){t&&n.$G.get_$O()==="TouchWide"&&t.$a("IsPersonaCardShown",n.$$d_$8c8)}function $6Kg(n,t){t&&n.$G.get_$O()==="TouchWide"&&t.$w("IsPersonaCardShown",n.$$d_$8c8)}function $6Kc(n){var t=new _d.$tX(n.$50);var i=_y.$q.$1gC;n.$20y!==1&&(i=_y.$q.$Hr);t.$41G=i;t.$Zy=1;return t}_d.$6M.prototype={$G:null,$50:null,$4a:null,$z:null,$Bo:null,$1F3:null,$l:null,$aw:null,$2R:!1,$2LF:null,$30n:null,$QQ:null,$Df:null,$8T:null,$20y:0,get_$1X:function(){return this.$2R},set_$1X:function(n){if(this.$2R===n)return n;this.$2R=n;this.$2R&&$6Ke(this);$6(this,"IsShown");return n},get_$1gn:function(){return this.$l},set_$1gn:function(n){this.$l&&$4M6(this);this.$l=n;if(this.$l){$6Kd(this);$4M5(this);this.$l.$Od.set_$92J(!this.$l.$r.get_$1PV());$4M7(this)}return n},get_$2fg:function(){return this.$Df},set_$2fg:function(n){if(this.$Df!==n){if(this.$Df){$6Kg(this,this.$Df.$1Yy);this.$Df.$1M()}this.$Df=n;if(this.$Df){$6Kb(this,this.$Df.$1Yy);$6Kf(this,this.$Df.$1Yy)}$6(this,"EventDetailsViewModel")}return n},get_$8t7:function(){return this.$QQ},set_$8t7:function(n){if(this.$QQ!==n){this.$QQ=n;$6(this,"ResponseTypeManagerViewModel")}return n},get_$5In:function(){return 420},get_$zw:function(){return 320},get_$8iF:function(){return this.$2LF},set_$8iF:function(n){if(this.$2LF!==n){this.$2LF=n;$6(this,"OpenReadFormOnAttendeesPivotCommand")}return n},get_$8iG:function(){return this.$30n},set_$8iG:function(n){if(this.$30n!==n){this.$30n=n;$6(this,"OpenReadFormOnLocationPivotCommand")}return n},get_$59e:function(){return!!this.$l&&!this.$l.get_$1Gu()&&this.$l.$r.get_$6wg()&&this.$G.get_$O()!=="TouchNarrow"},get_$6tu:function(){var n=_d.$6N.$3ar(this.$l.$r);return n?_js.$8.$4C(_u.Strings.l_AttendeesInvitedLabel_Text,n):""},$8RM:function(){this.$5H()},$8dO:function(n){$4M4(this,n,1)},$8dP:function(n){$4M4(this,n,2)},$5H:function(){this.set_$1X(!1)},$8c8:function(n,t){this.$5H()},$6vo:function(n){$4M6(this);this.$l.$9DA(n);$4M5(this);$4M7(this);$6(this,"FullItemLoaded")},$6vn:function(n){var i=n.responseCode;if(i&&i.toString()==="ErrorAccessDenied"){_js.Trace.logInfo(_a.$0.$Ag,"Calendar Peek - Failed to load full calendar item because of access denied");return}var t="Calendar Peek - Failed to load full calendar item";n&&(t=String.format("{0}: {1}",t,n.message));_js.Trace.logWarning(_a.$0.$Ag,t)},$3yQ:function(n){this.$5H()},$304:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$5H()},$59:function(){this.set_$2fg(null);this.set_$1gn(null);this.$aw&&this.$aw.$1M();_a.$1.prototype.$59.call(this)}};_d.$eo=function(n,t,i,r,u){this.$G=t;this.$Bo=i;this.$8T=r;this.$50=n;this.$1F3=u};_d.$eo.prototype={$G:null,$8T:null,$Bo:null,$50:null,$1F3:null,$I:function(n){return new _d.$6M(n,this.$50,this.$G,this.$Bo,this.$8T,this.$1F3)}};_d.$L6=function(n,t,i){_d.$L6.initializeBase(this);$6Jb(this,n,t,i)};function $6Jb(n,t,i,r){n.$kX=new _js.$X;n.$pH=new _js.$X;n.$lQ=new _js.$X;n.$nu=new _js.$X;var u,f,e,o;$3ET(n,r,u={val:n.$kX},f={val:n.$pH},e={val:n.$lQ},o={val:n.$nu});n.$kX=u.val;n.$pH=f.val;n.$lQ=e.val;n.$nu=o.val;var s,h,c,l;$3ET(n,t,s={val:n.$kX},h={val:n.$pH},c={val:n.$lQ},l={val:n.$nu});n.$kX=s.val;n.$pH=h.val;n.$lQ=c.val;n.$nu=l.val;n.$4d3=n.$kX.get_$F();n.$65s=n.$pH.get_$F();n.$4r2=n.$lQ.get_$F();n.$5ek=n.$nu.get_$F();var a,v,y,p;$3ET(n,i,a={val:n.$kX},v={val:n.$pH},y={val:n.$lQ},p={val:n.$nu});n.$kX=a.val;n.$pH=v.val;n.$lQ=y.val;n.$nu=p.val}function $3ET(n,t,i,r,u,f){if(!$8(t))for(var o=0;o<t.get_$F();o++){var e=t.get_$48(o);switch(e.get_$QP()){case"Accept":case"Organizer":i.val.$H(e);break;case"Tentative":r.val.$H(e);break;case"Decline":u.val.$H(e);break;default:f.val.$H(e);break}}}_d.$L6.prototype={$kX:null,$pH:null,$lQ:null,$nu:null,$4d3:0,$65s:0,$4r2:0,$5ek:0,get_$3Jo:function(){return String.format(_u.Strings.l_AcceptedAttendeesLabelAndCount_Text,this.$kX.get_$F())},get_$4Cq:function(){return String.format(_u.Strings.l_TentativelyAcceptedAttendeesLabelAndCount_Text,this.$pH.get_$F())},get_$3Tb:function(){return String.format(_u.Strings.l_DeclinedAttendeesLabelAndCount_Text,this.$lQ.get_$F())},get_$3wY:function(){return String.format(_u.Strings.l_NoResponseReceivedAttendeesLabelAndCount_Text,this.$nu.get_$F())}};_d.$MS=function(n,t,i,r){_d.$MS.initializeBase(this,[i]);this.$K9=n;this.$Bo=r;this.$4G4=t};function $6Ka(n,t,i){if(t.get_$Ho()&&t.get_$Hm()&&!t.get_$Cz()&&i.$2K){var r=n.$4G4.get_$N5();n.$z.$Mk(1500,null,_u.Strings.l_ViewInvitedAttendeesInfobar_Text,r)}}_d.$MS.prototype={$K9:null,$4G4:null,$Bo:null,$7fK:function(){this.$QH=[1500,1600,1800,2e3,1200,1700,1900,2100]},$7HF:function(){$6Ka(this,this.$K9,this.$4G4);$4Lt(this,this.$K9,this.$Bo);$4Lu(this,this.$K9)}};_d.$tX=function(n){this.$50=n};_d.$tX.prototype={$50:null,$41G:0,$Zy:0,$I:function(n){if(!n)return null;var i=_c.$i.$E5(n);var t=this.$50.$SX(i,this.$41G,!0,this.$Zy);t.set_$Ih(!1);t.set_$DA(!0);return t}};_d.$YO=function(n,t,i,r,u,f,e){_d.$YO.initializeBase(this,[u]);this.$K9=n;this.$Bo=f;this.$4GA=t;this.$3BN=i;this.$3BO=r;this.$21D=e};function $6Mr(n){if(n.$K9.get_$ZC())n.$z.$2r(4810);else if(n.$K9.get_$Ef()&&n.$4GA.$2K){var t=n.$4GA.get_$N5();n.$z.$Mk(4710,null,_u.Strings.l_ViewSeries_Text,t)}}function $6Mq(n){if(n.$K9.get_$m1()&&!n.$21D){var t=n.$3BN.get_$N5();n.$z.$Mk(7700,null,_u.Strings.l_ClickHere_Text,t);var i=n.$3BO.get_$N5();n.$z.$Mk(7750,null,_u.Strings.l_ClickHere_Text,i)}}_d.$YO.prototype={$K9:null,$Bo:null,$4GA:null,$3BN:null,$3BO:null,$21D:0,$7fK:function(){this.$QH=[1200,2200,1100,1600,1800,2e3,1300,1400,1700,1900,2100,4810,4710,7700,7750]},$7HF:function(){$4Lu(this,this.$K9);$3Ec(this,this.$K9);$4Lt(this,this.$K9,this.$Bo);$4Ls(this,this.$K9);$4Lv(this,this.$K9,this.$K9.get_$St());$6Mr(this);$6Mq(this)}};_d.$3P=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$7Ig=Function.createDelegate(this,this.$7Ig);this.$$d_$7Ih=Function.createDelegate(this,this.$7Ih);this.$$d_$9CG=Function.createDelegate(this,this.$9CG);this.$$d_$9CF=Function.createDelegate(this,this.$9CF);this.$$d_$66e=Function.createDelegate(this,this.$66e);this.$$d_$2ak=Function.createDelegate(this,this.$2ak);this.$$d_$70u=Function.createDelegate(this,this.$70u);this.$$d_$7Ie=Function.createDelegate(this,this.$7Ie);this.$$d_$7If=Function.createDelegate(this,this.$7If);this.$$d_$3ZA=Function.createDelegate(this,this.$3ZA);this.$$d_$303=Function.createDelegate(this,this.$303);this.$$d_$5ny=Function.createDelegate(this,this.$5ny);this.$$d_$304=Function.createDelegate(this,this.$304);this.$$d_$3yQ=Function.createDelegate(this,this.$3yQ);this.$$d_$5i=Function.createDelegate(this,this.$5i);_d.$3P.initializeBase(this);this.$1kF=l;this.$3fk=c;this.$Ka=n;this.$2qL=t;this.$ON=i;this.$1F3=o;this.$G=r;this.$8T=u;this.$2Yi=f;this.$50=e;this.$p=s;this.$1D=h;this.$dO=new _y.$eK;this.$Xd=new _d.$NU(this.$$d_$5i,!this.$G.get_$DC()&&this.$G.get_$O()==="Mouse"&&this.$G.get_$6Q());this.$G.get_$O()==="TouchNarrow"&&this.set_$7E(_y.$26.$I(this));this.$a("IsTransitionedIn",_d.$3P.$140);this.$a("IsInitialized",_d.$3P.$140)};_d.$3P.$140=function(n,t){var i=n;if(i.$Dm&&i.$7M){$Bc(i,"Ready",i,i);i.$Df.$8QM()}};function $6KJ(n){if(n.$G.get_$O()!=="Mouse")throw Error.invalidOperation("Calendar Item Details View can only be popped out in a new browser window in MUI");if(!n.$G.get_$6Q())throw Error.invalidOperation("Calendar Item Details View can only be popped out from the main window");}function $6KS(n){var t=new _d.$tX(n.$50);t.$Zy=2;t.$41G=_y.$q.$Hr;return t}function $6KL(n,t){t&&n.$l.$r.get_$Hm()&&n.$l.$r.get_$UJ()&&t.$J1(1,n.$l.$r.get_$UJ().$2P(4),0)}function $3Ee(n){if(n.$7e){n.get_$3L()&&_js.$9.isInstanceOfType(n.get_$3L())&&n.get_$3L().$w("ActiveNavigationStack",n.$$d_$70u);n.$7e.$6e();n.$7e=null}}function $6KK(n){n.$4a=new _C(n.$$d_$2ak,_d.$3P.$D);n.$Wf=n.$l.$fv.$hi(0,!1,n.$$d_$2ak);n.$197=n.$l.$fv.$hi(1,!0,n.$$d_$2ak);n.$9A3=new _C(n.$$d_$66e,_d.$3P.$D);n.$3BN=new _C(n.$$d_$9CF,_a.$0.$1o);n.$3BO=new _C(n.$$d_$9CG,_a.$0.$1o)}function $4Ly(n,t){var i;i=t?n.$$d_$7Ih:n.$$d_$7Ig;n.$aw=n.$8T.$1kw(300,n.$l.$r.get_$i(),i,n.$$d_$7If,n.$$d_$7Ie,"HTML","unblockMode");n.$l.$r.set_$m1(!1);n.$l.$r.set_$1D7(!1)}function $6KV(n){var t=n.$l.$r.get_$3c();if(t&&t.get_$45()!=="HTML"){var i=_js.$8.$4C("BodyType should always be HTML on CalendarItemDetailsView. Current BodyType: {0}",t.get_$45());_js.Trace.logWarning(n.get_$1Y(),i)}if(!n.$G.get_$DC()){n.$7e=n.$ON.$4o9(n.$l.$r);n.$7e.$5F();n.get_$3L()&&_js.$9.isInstanceOfType(n.get_$3L())&&n.get_$3L().$a("ActiveNavigationStack",n.$$d_$70u)}$4Lz(n);n.set_$2fg(n.$1F3.$I(n.$l,n.$$d_$2ak,$6KS(n),n.$7e,n.$XI,n.$3BN,n.$3BO));n.$Df.$2o=n.get_$3L();var r=this;n.$Df.$XI.add_$8Zu(function(){$4Lz(n);$4M0(n);n.$Df.$9EJ(n.$XI)});n.set_$3Nv(new _d.$EY(n.$l.$4x));$4M0(n)}function $6KM(n){var t=[];Array.add(t,new _a.$5D(_u.Strings.l_EventDetailsTitle_Text,n.$Df));if(!n.$G.get_$DC()&&n.$l.$r.get_$Hm()){n.set_$6tr(n.$2Yi.$I(n.$l.$r));Array.add(t,new _a.$5D(_u.Strings.l_AttendeeDetailsTitle_Text,n.$2Yh))}n.$XI.get_$Sv()&&Array.add(t,new _a.$5D(_u.Strings.l_LocationDetailsTitle_Text,n.$XI));n.set_$41b(t)}function $4Lz(n){n.set_$2qM(n.$2qL.$I(n.get_$3L(),n.$l.$r.get_$4h(),n.$G.get_$O()));n.$1kr=new _C(n.$XI.$$d_$1lB,_d.$3P.$D)}function $4M0(n){$6KM(n);n.$G.get_$O()==="TouchNarrow"&&$6KU(n)}function $6KT(n,t){return Object.getType(n.$Xb[t].$x)}function $6KU(n){var t;var i;if(n.$G.get_$DC()||!n.$l.$r.get_$vr()){t=$6KN(n);i=$6KO(n)}else{t=n.$l.$4x.get_$b2()?$6KQ(n):$6KP(n);i=n.$l.$4x.get_$b2()?$6KR(n):$4Lw(n)}n.$3t.set_$MS(t);n.$3t.set_$XL(i)}function $6KP(n){var t=[];var r=this;var i=$4Lx(n,function(n){return new _y.$2f(_y.$c.get_$34M(),_y.$c.get_$5tc(),_u.Strings.l_Reply_LowerCase_Text,null,n)});i&&Array.add(t,i);n.$l.$r.get_$RF()||n.$l.$4x.get_$U8()?Array.add(t,new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Aw.$2NV)):Array.add(t,new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$l.$Od.$lZ));return t}function $6KQ(n){var t=[];Array.add(t,new _y.$2f(_y.$c.get_$Yo(),_y.$c.get_$2f3(),_u.Strings.l_EditItemMobile_Text,n.$Wf));n.$l.$4x.get_$U8()?Array.add(t,new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Aw.$2NV)):n.$l.$4x.get_$hN()&&Array.add(t,new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_CancelItemMobile_Text,n.$Aw.$2Zu));return t}function $4Lx(n,t){var i=[];n.$l.$r.get_$b4()&&Array.add(i,new _y.$2j(_u.Strings.l_Reply_LowerCase_Text,n.$l.$Nl.$GL));n.$l.$r.get_$ds()&&Array.add(i,new _y.$2j(_u.Strings.l_ReplyAll_LowerCase_Text,n.$l.$Nl.$Iy));n.$l.$r.get_$b3()&&Array.add(i,new _y.$2j(_u.Strings.l_Forward_LowerCase_Text,n.$l.$Nl.$G2));if(i.length<=0)return null;if(i.length===1)return i[0];return t(i)}function $6KR(n){var r=this;var i=$4Lx(n,function(n){return new _y.$2j(_u.Strings.l_Reply_LowerCase_Text,null,n)});var t=[];i&&Array.add(t,i);Array.addRange(t,$4Lw(n));return t}function $4Lw(n){var t=[];n.$197.$2K&&Array.add(t,new _y.$2j(_u.Strings.l_OpenSeries_LowerCase_Text,n.$197));n.$XI.get_$Sv()&&Array.add(t,new _y.$2j(_u.Strings.l_GetDirections_LowerCase_Text,n.$1kr));n.$G.get_$O()!=="Mouse"&&n.$l.$r.get_$1PV()&&Array.add(t,new _y.$2j(_u.Strings.l_JoinOnlineMeeting_LowerCase_Text,n.$l.$f8));return t}function $6KO(n){return n.$197.$2K?[new _y.$2j(_u.Strings.l_OpenSeries_LowerCase_Text,n.$197)]:new Array(0)}function $6KN(n){return new Array(0)}_d.$3P.prototype={$Ka:null,$2qL:null,$ON:null,$G:null,$2Yi:null,$50:null,$Xd:null,$8T:null,$1F3:null,$p:null,$1D:null,$3fk:!0,$1kF:!0,$aw:null,$Wf:null,$4a:null,$197:null,$9A3:null,$1kr:null,$3BN:null,$3BO:null,$7M:!1,$1o1:!1,$gS:0,$5Cg:!1,$l:null,$dO:null,$Xb:null,$Df:null,$XI:null,$2Yh:null,$Aw:null,$7e:null,$Fw:null,add_$5kD:function(n){this.$2Z("Ready",n)},remove_$5kD:function(n){this.$2b("Ready",n)},get_$3L:function(){return _y.$1De.prototype.get_$3L.call(this)},set_$3L:function(n){_y.$1De.prototype.set_$3L.call(this,n);this.$Df&&(this.$Df.$2o=n);this.$XI&&(this.$XI.$2o=n);return n},get_$1nk:function(){return this.$G.get_$O()==="Mouse"},get_$94E:function(){return this.$l.$Od.get_$1gy()||this.$l.$4x.get_$b2()||this.$l.$4x.get_$U8()||this.$l.$4x.get_$hN()},get_$1gn:function(){return this.$l},set_$1gn:function(n){if(this.$l===n)return n;if(this.$l){this.$l.$Od.remove_$1O6(this.$$d_$3yQ);this.$l.$4x.remove_$2m(this.$$d_$304);this.$l.$r.$w("IsPrivate",this.$$d_$5ny);this.$l.$r.$w("FreeBusyType",this.$$d_$5ny);this.$l.$r.$w("Categories",this.$$d_$5ny);this.$l.$w("ReminderSelectedValue",this.$$d_$5ny);this.$l.$r.$w("InboxReminders",this.$$d_$5ny)}this.$l=n;if(this.$l){$6KK(this);$6KV(this);this.$l.$Od.add_$1O6(this.$$d_$3yQ);this.$l.$4x.add_$2m(this.$$d_$304);this.$l.$r.$a("IsPrivate",this.$$d_$5ny);this.$l.$r.$a("FreeBusyType",this.$$d_$5ny);this.$l.$r.$a("Categories",this.$$d_$5ny);this.$l.$a("ReminderSelectedValue",this.$$d_$5ny);this.$l.$r.$a("InboxReminders",this.$$d_$5ny)}$6(this,"CalendarItemViewModel");return n},get_$19W:function(){return this.$Xd.$1vq},get_$aI:function(){return this.$Xd.$49Y},get_$41b:function(){return this.$Xb},set_$41b:function(n){if(this.$Xb!==n){this.$Xb=n;$6(this,"PivotSelectionOptions")}return n},get_$2fg:function(){return this.$Df},set_$2fg:function(n){if(this.$Df!==n){this.$Df&&this.$Df.$1M();this.$Df=n;this.$Df&&$6KL(this,this.$Df.$1Yy);$6(this,"EventDetailsViewModel")}return n},get_$6tr:function(){return this.$2Yh},set_$6tr:function(n){if(this.$2Yh!==n){this.$2Yh=n;$6(this,"AttendeeDetailsViewModel")}return n},get_$2qM:function(){return this.$XI},set_$2qM:function(n){if(this.$XI!==n){this.$XI=n;$6(this,"LocationViewModel")}return n},get_$3Nv:function(){return this.$Aw},set_$3Nv:function(n){if(this.$Aw!==n){this.$Aw=n;$6(this,"CalendarConfirmDialogViewModel")}return n},get_$CL:function(){return this.$7M},set_$CL:function(n){if(this.$7M!==n){this.set_$5C6(n);this.$7M=n;$6(this,"IsInitialized")}return n},get_$5C6:function(){return this.$1o1},set_$5C6:function(n){if(this.$1o1!==n){this.$1o1=n;$6(this,"IsPartiallyInitialized")}return n},get_$427:function(){return this.$G.get_$O()==="TouchWide"?4:0},get_$2Ao:function(){return this.$$d_$303},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$7A8:function(){return!0},get_$62B:function(){return this.$7M||this.$1o1},get_$2OZ:function(){return this.$gS},set_$2OZ:function(n){if(this.$gS!==n){this.$gS=n;$6(this,"SelectedPivotIndex")}return n},get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?_y.$1De.prototype.get_$Jr.call(this):0},get_$yU:function(){return this.$1D.get_$YP().$mg},get_$1Y:function(){return _a.$0.$Ag},$3dx:function(n){this.set_$CL(!1);var t=null;this.$5Cg=n.get_$5Ch();t=this.$8T.$1Sa(n.get_$3Vv());if(t){this.$7V7(t);this.$Df.set_$49K(!0)}this.$aw=this.$8T.$1kw(300,n.get_$3Vv(),this.$$d_$3ZA,this.$$d_$7If,this.$$d_$7Ie,"HTML",n.get_$2hY())},$56z:function(n){this.set_$1gn(this.$Ka.$8M(n));this.set_$CL(!0)},$7V7:function(n){this.set_$1gn(this.$Ka.$8M(n));this.set_$5C6(!0)},$8wI:function(n){for(var i=new _d.$yR,r=i.$39(n),t=0;t<this.$Xb.length;t++)if($6KT(this,t)===r){this.set_$2OZ(t);return}this.set_$2OZ(0)},$2ak:function(){if(!this.$3fk){_js.Trace.logInfo(this.get_$1Y(),"Omitting close action as it is not allowed for this CalendarItemDetailsView.");return}this.get_$8K()();this.$1M()},$18v:function(){$3Ee(this);_y.$1De.prototype.$18v.call(this)},$5i:function(){_a.$5.$1V(this.get_$1Y(),"PopoutCalendarReadingPane");$6KJ(this);var n=new _d.$O1;n.set_$7F(this.$l.$6S);this.$2ak();this.$G.$L9(_d.$I6,null,null,_y.$3p.get_$eK(),n,!1);_a.$5.$1G(null,"PopoutCalendarReadingPane")},$304:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$2ak()},$59:function(){this.$aw&&this.$aw.$1M();$3Ee(this);if(this.$l){this.$l.$1M();this.set_$1gn(null)}this.set_$2fg(null);_a.$1.prototype.$59.call(this)},$66e:function(){this.$l.$r.set_$bm(!this.$l.$r.get_$bm())},$9CF:function(){$4Ly(this,!1)},$7Ig:function(n){this.$3ZA(n);var t=new _h.$on(this.$l.$r);this.$p.$y(t)},$9CG:function(){$4Ly(this,!0)},$7Ih:function(n){this.$3ZA(n);var t=new _h.$j7(this.$l.$r);this.$p.$y(t)},$3ZA:function(n){this.$56z(n)},$7If:function(n){_c.$5Q.$3Yy(n,this.$$d_$2ak);this.set_$CL(!1)},$7Ie:function(){this.$Df&&this.$Df.set_$49K(!1)},$3yQ:function(n){this.$2ak()},$5ny:function(n,t){this.$l.$4x.$Ey()},$70u:function(n,t){t!=="ActiveNavigationStack"||this.get_$3L().get_$8H()&&this.get_$3L().get_$8H().get_$F()||$3Ee(this)},$303:function(n,t){this.$Df&&this.$Df.$303();this.$1M();return!1}};_d.$I6=function(n,t,i,r,u,f,e,o,s,h){this.$Ka=n;this.$2qL=t;this.$ON=i;this.$2Yi=r;this.$50=u;this.$G=e;this.$8T=f;this.$1F3=o;this.$p=s;this.$1D=h};_d.$I6.prototype={$1F3:null,$Ka:null,$2qL:null,$ON:null,$2Yi:null,$50:null,$G:null,$8T:null,$p:null,$1D:null,get_$3Nm:function(){return this.$8T},get_$am:function(){return this.$p},$ct:function(n,t,i,r){var u=this.$2CA(t,i===undefined?!0:i,r===undefined?!0:r);u.$3dx(new _y.$Ao(n));return u},$wD:function(n){return this.$3RX(n.get_$7F())},$3RX:function(n,t){var i=this.$2CA(t,!0,!0);i.$56z(n);return i},$2CA:function(n,t,i){var r=new _d.$3P(this.$Ka,this.$2qL,this.$ON,this.$G,this.get_$3Nm(),this.$2Yi,this.$50,this.$1F3,this.get_$am(),this.$1D,t,i);n&&r.add_$5kD(n);return r}};_d.$5g=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$2z5=Function.createDelegate(this,this.$2z5);this.$$d_$3xS=Function.createDelegate(this,this.$3xS);this.$$d_$304=Function.createDelegate(this,this.$304);this.$$d_$7dU=Function.createDelegate(this,this.$7dU);this.$$d_$AQ=Function.createDelegate(this,this.$AQ);this.$$d_$3Q=Function.createDelegate(this,this.$3Q);this.$$d_$Yo=Function.createDelegate(this,this.$Yo);this.$$d_$3Kp=Function.createDelegate(this,this.$3Kp);this.$$d_$66e=Function.createDelegate(this,this.$66e);_d.$5g.initializeBase(this);this.$1YS=t;this.$l=n;this.$G=u;this.$7e=f;this.$1pX=e;this.$1gj=h;this.$1K=v;this.$2o=null;this.$l.$r.get_$Ef()&&!this.$G.get_$DC()&&(this.$1vN=this.$l.$1QS());this.$XI=new _d.$DC(this.$l.$r.get_$4h(),null,r,this.$G,!!this.$1pX);this.$1kV=_d.$O9.$4oU();this.$1wV=_d.$O9.$3S8(this.$l);this.$9AB=new _C(this.$$d_$66e,_a.$0.$1o);this.$13M=new _C(this.$$d_$3Kp,_a.$0.$1o);this.$Wf=new _C(this.$$d_$Yo,_a.$0.$1o);this.$IX=new _C(this.$$d_$3Q,_a.$0.$1o);this.$79=new _C(this.$$d_$AQ,_a.$0.$1o);this.$3Vo=this.$l.$fv.$hi(0,!1,this.$1YS);this.$5lk=this.$l.$fv.$hi(1,!1,this.$1YS);this.$30o=this.$l.$fv.$hi(1,!0,this.$1YS);this.set_$3Nv(new _d.$EY(this.$l.$4x));if(this.$G.get_$O()!=="TouchNarrow"){$2Tq(this);this.$l.$r.$a("IsPrivate",this.$$d_$7dU);this.$5sJ=!0}if(this.$1vN){this.$1vN.$4x.add_$2m(this.$$d_$304);this.$28J=this.$l.$fv.$hi(0,!0,this.$1YS);this.set_$6rB(new _0365m.$2c($6Ms(this)));this.set_$7Bi(new _0365m.$2c($6Mw(this)));this.set_$78Z(new _0365m.$2c($6Mv(this)));this.set_$6wG(new _0365m.$2c($6Mu(this)))}if(this.$G.get_$DC()||this.$l.$r.get_$1DQ())this.$z=null;else{this.$z=new _y.$8L;this.$JR=new _d.$YO(this.$l.$r,this.$30o,c,l,this.$z,o,_g.$S.get_$L().get_$Mm().get_$1Rx());this.$JR.$12a();this.$l.$r.$a("HasBlockedImages",this.$$d_$3xS)}var w=this.$l.$r.get_$1e();var k=w?w.get_$9JV():new _js.$X;var p=this;a.$I(function(n){p.$6I=n.$1hr(p.$l.$r.get_$i(),k,!0,!0,null,!0,p.$z,null)});var d=this.$l.$r.get_$Cl()?this.$l.$r.get_$Cl().Mailbox:null;this.$1Yy=i.$I(d);$6Mz(this,s);if(y&&this.get_$49F()){var b=this;y.$I(function(n){b.set_$7CB(n.$I(b.$l.$r))})}};function $2Tq(n){var t=null;t=n.$G.get_$DC()||!n.$l.$r.get_$vr()?$6Mt(n):$6Mx(n);n.set_$7C5(t.length?new _0365m.$2c(t):null);n.$O0&&n.$1RV&&n.$1RV.$a("IsShown",n.$$d_$2z5);n.set_$8rj(n.$G.get_$DC()?null:new _0365m.$2c($6My(n)))}function $6Mx(n){var t=[];n.$30o.$2K&&Array.add(t,new _0365m.$n(_u.Strings.l_OpenSeries_LowerCase_Text,null,n.$30o));if(!$8(n.$1pX)&&n.$1pX.get_$Sv()){n.$1kr=new _C(n.$1pX.$$d_$1lB,_d.$5g.$D);Array.add(t,new _0365m.$n(_u.Strings.l_GetDirections_LowerCase_Text,null,n.$1kr))}var i=n.$O0?n.$O0.$3ZC():null;i&&Array.add(t,i);return t}function $6Mz(n,t){if(t&&!n.$l.$r.get_$1DQ()){var i=this;t.$1FT(function(){var t=n.$l.$r.get_$1o();if(t){n.set_$3Ns(n.$1gj.$8M(n.$l.$r));$2Tq(n)}else _js.Trace.logError(_d.$5g.$D,"Could not find Calendar with Id: {0}. See #E15:3185198 to confimr if you are hitting a known bug",n.$l.$r.get_$22())})}}function $6Mt(n){var t=n.$l.$fv.$hi(1,!0,n.$1YS);return t.$2K?[new _0365m.$n(_u.Strings.l_OpenSeries_LowerCase_Text,null,t)]:new Array(0)}function $6My(n){var t=[];if(n.$l.$r.get_$Hm()){n.$l.$r.get_$b4()&&Array.add(t,new _0365m.$n(_u.Strings.l_Reply_LowerCase_Text,null,n.$l.$Nl.$GL));n.$l.$r.get_$ds()&&Array.add(t,new _0365m.$n(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$l.$Nl.$Iy));n.$l.$r.get_$b3()&&Array.add(t,new _0365m.$n(_u.Strings.l_Forward_LowerCase_Text,null,n.$l.$Nl.$G2))}else n.$l.$r.get_$b3()&&Array.add(t,new _0365m.$n(_u.Strings.l_Forward_LowerCase_Text,null,n.$l.$Nl.$G2));return t}function $6Ms(n){return[new _0365m.$n(_u.Strings.l_AddToMyCalendar_Occurrence_Text,null,n.$l.$4x.$13M),new _0365m.$n(_u.Strings.l_AddToMyCalendar_Series_Text,null,n.$1vN.$4x.$13M)]}function $6Mw(n){return[new _0365m.$n(_u.Strings.l_Calendar_ReadingPane_EditContextMenu_EditOccurrence_Text,null,n.$3Vo),new _0365m.$n(_u.Strings.l_Calendar_ReadingPane_EditContextMenu_EditSeries_Text,null,n.$28J)]}function $6Mv(n){return[new _0365m.$n(_u.Strings.l_DeleteOccurrence_LowerCase_Text,null,n.$l.$4x.$Ta),new _0365m.$n(_u.Strings.l_DeleteSeries_LowerCase_Text,null,n.$1vN.$4x.$Ta)]}function $6Mu(n){return[new _0365m.$n(_u.Strings.l_CancelOccurrence_LowerCase_Text,null,n.$l.$4x.$79),new _0365m.$n(_u.Strings.l_CancelSeries_LowerCase_Text,null,n.$1vN.$4x.$79)]}function $2Tp(n,t,i,r){t&&(n.$l.$r.get_$Ef()?i.set_$1X(!0):r.$s())}_d.$5g.prototype={$1gj:null,$l:null,$1kV:null,$1wV:null,$z:null,$1YS:null,$JR:null,$XI:null,$9AB:null,$3Vo:null,$28J:null,$13M:null,$Wf:null,$IX:null,$79:null,$5lk:null,$30o:null,$1vN:null,$5sJ:!1,$1Yy:null,$7e:null,$G:null,$1K:null,$1RW:null,$6I:null,$1pX:null,$1kr:null,$Aw:null,$O0:null,$2o:null,$1RV:null,$1wg:null,$1fJ:null,$28B:null,$27E:null,$24w:null,$1ye:!1,get_$3Ns:function(){return this.$O0},set_$3Ns:function(n){this.$O0=n;$6(this,"CalendarCategoryViewModel");return n},get_$7CB:function(){return this.$1RW},set_$7CB:function(n){if(this.$1RW!==n){this.$1RW=n;$6(this,"EmailRemindersViewModel")}return n},get_$7C5:function(){return this.$1RV},set_$7C5:function(n){if(n!==this.$1RV){this.$1RV=n;$6(this,"EllipsesContextMenu")}return n},get_$8rj:function(){return this.$1wg},set_$8rj:function(n){if(n!==this.$1wg){this.$1wg=n;$6(this,"ReplyContextMenu")}return n},get_$6rB:function(){return this.$1fJ},set_$6rB:function(n){if(this.$1fJ!==n){this.$1fJ=n;$6(this,"AddToMyCalendarContextMenuForSeries")}return n},get_$7Bi:function(){return this.$28B},set_$7Bi:function(n){if(this.$28B!==n){this.$28B=n;$6(this,"EditContextMenuForSeries")}return n},get_$78Z:function(){return this.$27E},set_$78Z:function(n){if(this.$27E!==n){this.$27E=n;$6(this,"DeleteContextMenuForSeries")}return n},get_$4jv:function(){return!this.$G.get_$DC()&&this.$l.$r.get_$vr()},get_$6ws:function(){return!!this.$1wg&&this.$1wg.$1B.get_$F()>0},get_$595:function(){var n=this.$l.$r.get_$3c();return!!n&&n.get_$45()==="HTML"},get_$6wG:function(){return this.$24w},set_$6wG:function(n){if(this.$24w!==n){this.$24w=n;$6(this,"CancelContextMenuForSeries")}return n},get_$49K:function(){return this.$1ye},set_$49K:function(n){if(this.$1ye!==n){this.$1ye=n;$4Z(this,"ShowLoading","ShowEmailRemindersControl")}return n},get_$3Nv:function(){return this.$Aw},set_$3Nv:function(n){if(this.$Aw!==n){this.$Aw=n;$6(this,"CalendarConfirmDialogViewModel")}return n},get_$49F:function(){return!!this.$1K&&this.$1K.$7x("EmailReminders")&&!this.$l.$r.get_$Ef()&&!this.$l.$r.get_$Uk()&&!this.$l.$r.get_$ZC()&&!this.$1ye},$8QM:function(){$Bc(this,"Ready",this,this)},$303:function(){this.$1RW&&this.$1RW.$303()},$9EJ:function(n){this.$1pX=n;$2Tq(this)},$59:function(){this.$5sJ&&this.$l.$r.$w("IsPrivate",this.$$d_$7dU);this.$JR&&this.$l.$r.$w("HasBlockedImages",this.$$d_$3xS);_a.$1.prototype.$59.call(this)},$2z5:function(n,t){this.$1RV.$2R&&this.$O0&&this.$O0.$41y()},$66e:function(){this.$l.$r.set_$bm(!this.$l.$r.get_$bm())},$7dU:function(n,t){$2Tq(this)},$3xS:function(n,t){this.$JR.$12a()},$304:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$1YS()},$3Kp:function(){$2Tp(this,this.$l.$4x.get_$1PR(),this.$1fJ,this.$l.$4x.$13M)},$Yo:function(){$2Tp(this,this.$l.$4x.get_$b2(),this.$28B,this.$3Vo)},$3Q:function(){$2Tp(this,this.$l.$4x.get_$U8(),this.$27E,this.$Aw.$2NV)},$AQ:function(){$2Tp(this,this.$l.$4x.get_$hN(),this.$24w,this.$Aw.$2Zu)}};_d.$fe=function(n,t,i,r,u,f,e,o){this.$G=t;this.$25G=r;this.$50=n;this.$Bo=i;this.$2f=u;this.$DD=f;this.$1K=e;this.$4uR=o};_d.$fe.prototype={$50:null,$G:null,$Bo:null,$25G:null,$2f:null,$DD:null,$1K:null,$4uR:null,$I:function(n,t,i,r,u,f,e){return new _d.$5g(n,t,i,this.$50,this.$G,r,u,this.$Bo,this.$2f,this.$25G,f,e,this.$DD,this.$1K,this.$4uR)},$748:function(n,t,i){return new _d.$5g(n,t,i,this.$50,this.$G,null,null,this.$Bo,null,this.$25G,null,null,this.$DD,null,null)}};_d.$Wr=function(n){this.$Ti=n};function $6JU(n,t){var i=t.get_$72()?t.get_$72().get_$F():0;i+=t.get_$8A()?t.get_$8A().get_$F():0;i+=t.get_$9D()?t.get_$9D().get_$F():0;if(n.$Ti.get_$O()==="Mouse"){if(i>=100)return!1}else if(i>=50)return!1;return!0}_d.$Wr.prototype={$Ti:null,$66:null,$I:function(n){return new _d.$Jn(n,this.$66,$6JU(this,n))}};_d.$ID=function(n){this.$9t=n};function $4N1(n,t){_a.$3.$HZ(t.length,3,"Expected three daily recurrence pattern strings");var i="";switch(n.$9t){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=String.format(t[2],n.$9t);break}return i}_d.$ID.prototype={$9t:0,get_$1l:function(){return _u.Strings.l_Daily_Text},$2Y:function(n){return _d.$ID.isInstanceOfType(n)&&n.$9t===this.$9t},$20C:function(){var n=[_u.Strings.l_Recurrence_PatternDailyOne_Text,_u.Strings.l_Recurrence_PatternDailyTwoFormat_Text,_u.Strings.l_Recurrence_PatternDailyMoreFormat_Text];return $4N1(this,n)},$9AK:function(){var n=[_u.Strings.l_Recurrence_PatternDailyOne_StringSegment_Text,_u.Strings.l_Recurrence_PatternDailyTwoFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternDailyMoreFormat_StringSegment_Text];return $4N1(this,n)},$3CH:function(){return this.$9t<=0?4:0},$9AN:function(){var n=new _g.$fO(new _g.$OD(this.$9t));n.set_$Ww(this.$9t);return n},$46:function(){return new _d.$ID(this.$9t)}};_d.$IS=function(n,t){this.$9t=n;this.$OH=t};function $4Ob(n,t){_a.$3.$HZ(t.length,3,"Expected three month-by-day pattern strings");var i="";switch(n.$9t){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,n.$OH,n.$9t)}_d.$IS.prototype={$OH:0,$9t:0,get_$1l:function(){return _u.Strings.l_MonthlyByDay_Text},$20C:function(){var n=[_u.Strings.l_Recurrence_PatternMonthlyByDayOneFormat_Text,_u.Strings.l_Recurrence_PatternMonthlyByDayTwoFormat_Text,_u.Strings.l_Recurrence_PatternMonthlyByDayMoreFormat_Text];return $4Ob(this,n)},$9AK:function(){var n=[_u.Strings.l_Recurrence_PatternMonthlyByDayOneFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternMonthlyByDayTwoFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternMonthlyByDayMoreFormat_StringSegment_Text];return $4Ob(this,n)},$2Y:function(n){return _d.$IS.isInstanceOfType(n)&&n.$9t===this.$9t&&n.$OH===this.$OH},$3CH:function(){var n=0;this.$9t<=0?n|=4:(this.$OH>31||this.$OH<=0)&&(n|=1);return n},$9AN:function(){return new _g.$eM(new _g.$Nr(this.$9t,this.$OH))},$46:function(){return new _d.$IS(this.$9t,this.$OH)}};_d.$IT=function(n,t,i){this.$9t=n;this.$BU=t;this.$OI=i};function $4Oc(n,t){_a.$3.$HZ(t.length,3,"Expected three monthly-by-week recurrence pattern strings");var i="";switch(n.$9t){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,_d.$2h.$4yi(n.$BU),_d.$2h.$3Yo(n.$OI),n.$9t)}_d.$IT.prototype={$BU:"None",$OI:0,$9t:0,get_$1l:function(){return _u.Strings.l_MonthlyByWeek_Text},$20C:function(){var n=[_u.Strings.l_Recurrence_PatternMonthlyByWeekOneFormat_Text,_u.Strings.l_Recurrence_PatternMonthlyByWeekTwoFormat_Text,_u.Strings.l_Recurrence_PatternMonthlyByWeekMoreFormat_Text];return $4Oc(this,n)},$9AK:function(){var n=[_u.Strings.l_Recurrence_PatternMonthlyByWeekOneFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternMonthlyByWeekTwoFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternMonthlyByWeekMoreFormat_StringSegment_Text];return $4Oc(this,n)},$2Y:function(n){return _d.$IT.isInstanceOfType(n)&&n.$9t===this.$9t&&n.$OI===this.$OI&&n.$BU===this.$BU},$3CH:function(){var n=0;this.$9t<=0&&(n|=4);this.$OI||(n|=2);this.$BU==="None"&&(n|=16);return n},$9AN:function(){var n=new _g.$hj;n.set_$Ww(this.$9t);n.set_$14g(this.$OI);n.set_$1ET(this.$BU);return n},$46:function(){return new _d.$IT(this.$9t,this.$BU,this.$OI)}};_d.$Gs=function(){};_d.$Gs.prototype={get_$1l:function(){return _u.Strings.l_Never_Text},$20C:function(){return _u.Strings.l_Never_Text},$9AK:function(){return this.$20C()},$2Y:function(n){return _d.$Gs.isInstanceOfType(n)},$3CH:function(){return 0},$9AN:function(){return null},$46:function(){return new _d.$Gs}};_d.$GG=function(){};_d.$GG.$5I1=function(n,t,i){var r=new _js.$X;var u=_d.$2h.$4nQ(n.get_$Cd());var f=n.get_$3D();r.$H(new _d.$Gs);r.$H(new _d.$ID(1));r.$H(new _d.$I0(1,u));t&&r.$H(new _d.$I0(1,t,t));r.$H(new _d.$IS(1,n.get_$5z()));r.$H(new _d.$IT(1,_d.$2h.$2iU(n),u));r.$H(new _d.$Io(n.get_$5z(),f));i.get_$O()!=="TouchNarrow"&&r.$H(_u.Strings.l_EditPattern_Text);return r};_d.$GG.$8pA=function(n,t){t.set_$GK(n.$I8.$9AN());t.set_$1a8(n.$9AO());t.set_$3AN(n.$6t)};_d.$GG.$43T=function(n,t,i){if($8(n))return null;var r=new _d.$CX;r.set_$GK(_d.$GG.$5nU(n.get_$GK()));r.set_$7p(n.get_$1a8().get_$7p());r.set_$158(_d.$2h.$4ic(n.get_$1a8(),r.$I8));r.set_$1Av(t);r.set_$15A(i);r.set_$3AN(n.get_$3AN());return r};_d.$GG.$5nU=function(n){var t=new _d.$Gs;_g.$fO.isInstanceOfType(n)?t=new _d.$ID(n.get_$Ww()):_g.$j5.isInstanceOfType(n)?t=new _d.$I0(n.get_$Ww(),n.get_$14g()):_g.$eM.isInstanceOfType(n)?t=new _d.$IS(n.get_$Ww(),n.get_$1iO()):_g.$hj.isInstanceOfType(n)?t=new _d.$IT(n.get_$Ww(),n.get_$1ET(),n.get_$14g()):_g.$eN.isInstanceOfType(n)?t=new _d.$Io(n.get_$1iO(),_js.$2B.$Rq(_a.$mU,n.get_$3D())):_g.$nl.isInstanceOfType(n)&&(t=new _d.$Ji(n.get_$1ET(),n.get_$14g(),_js.$2B.$Rq(_a.$mU,n.get_$3D())));return t};_d.$CX=function(n,t,i,r,u,f){_d.$CX.initializeBase(this);this.set_$7p(t||null);this.set_$158(i||null);this.set_$1Av(r||null);this.set_$15A(u||null);this.set_$3AN($8(f)?null:f);this.set_$GK($8(n)?null:n)};_d.$CX.$1a9=function(n,t){return(n&t)===t};_d.$CX.$1SX=function(n){var t=null;n?_d.$CX.$1a9(n,64)?t=_u.Strings.l_InvalidDateRange_Text:_d.$CX.$1a9(n,1)?t=_u.Strings.l_InvalidDay_Text:_d.$CX.$1a9(n,2)?t=_u.Strings.l_InvalidDaysOfWeek_Text:_d.$CX.$1a9(n,4)?t=_u.Strings.l_InvalidInterval_Text:_d.$CX.$1a9(n,32)?t=_u.Strings.l_InvalidMonth_Text:_d.$CX.$1a9(n,16)?t=_u.Strings.l_InvalidRecurrenceOrder_Text:_d.$CX.$1a9(n,8)&&(t=_u.Strings.l_InvalidStartDate_Text):t=null;return t};function $6Rh(n){var t=0;$8(n.$5f)?t=8:!$8(n.$Pb)&&n.$5f.$2Y(n.$Pb)>=0&&(t=64);return t}_d.$CX.prototype={$5f:null,$Pb:null,$7T:null,$9f:null,$I8:null,$6t:null,get_$GK:function(){return this.$I8},set_$GK:function(n){if(this.$I8!==n){this.$I8=n;$Q(this,"RecurrencePattern")}return n},get_$7p:function(){return this.$5f},set_$7p:function(n){if(this.$5f!==n){this.$5f=n;$Q(this,"StartDate")}return n},get_$158:function(){return this.$Pb},set_$158:function(n){if(this.$Pb!==n){!$8(n)&&n.$2Y(this.$5f)<0&&(n=this.$5f);this.$Pb=n;$Q(this,"EndDate")}return n},get_$1Av:function(){return this.$7T},set_$1Av:function(n){if(this.$7T!==n){this.$7T=n;$Q(this,"StartTime")}return n},get_$15A:function(){return this.$9f},set_$15A:function(n){if(this.$9f!==n){!$8(n)&&n.$2Y(this.$7T)<0&&(n=this.$7T);this.$9f=n;$Q(this,"EndTime")}return n},get_$3AN:function(){return this.$6t},set_$3AN:function(n){if(this.$6t!==n){this.$6t=n;$Q(this,"TimeZoneId")}return n},$9AP:function(){return _d.$Gs.isInstanceOfType(this.$I8)?this.$I8.$20C():String.format(_u.Strings.l_RecurrenceFormat_Text,this.$I8.$9AK(),this.$66q())},$66q:function(){var n="";var t="";this.$7T&&this.$9f&&(t=String.format(_u.Strings.l_RangeTime_Text,this.$7T.$2P(0),this.$9f.$2P(0)));n=this.$Pb?String.format(_u.Strings.l_RangeEndDate_Text,this.$5f.$2P(5),this.$Pb.$2P(5)):String.format(_u.Strings.l_RangeNoEndDate_Text,this.$5f.$2P(5));return String.format(_u.Strings.l_RangeFormat_Text,t,n)},$3CH:function(){return this.$I8.$3CH()|$6Rh(this)},$9AO:function(){var n;if(this.$Pb){var t=new _g.$fb;t.set_$7p(this.$5f);t.set_$158(this.$Pb);n=t}else{var i=new _g.$tF;i.set_$7p(this.$5f);n=i}return n}};_d.$2h=function(){};_d.$2h.$2iU=function(n){for(var t=n.get_$5z(),i=0;t>0;){t-=7;++i}switch(i){case 0:return"None";case 1:return"First";case 2:return"Second";case 3:return"Third";case 4:return"Fourth";default:return"Last"}};_d.$2h.$4nQ=function(n){var t;switch(n){case 0:t=1;break;case 1:t=2;break;case 2:t=4;break;case 3:t=8;break;case 4:t=16;break;case 5:t=32;break;case 6:t=64;break;default:t=0;break}return t};_d.$2h.$1QI=function(n){var t=[];n&1&&Array.add(t,0);n&2&&Array.add(t,1);n&4&&Array.add(t,2);n&8&&Array.add(t,3);n&16&&Array.add(t,4);n&32&&Array.add(t,5);n&64&&Array.add(t,6);return t};_d.$2h.$6va=function(n){var t=_d.$GG.$5nU(n.get_$GK());var i=n.get_$1a8();return _d.$2h.$4ic(i,t)};_d.$2h.$4ic=function(n,t){if(_g.$fb.isInstanceOfType(n))return n.get_$158();if(!_g.$tQ.isInstanceOfType(n)||_d.$Gs.isInstanceOfType(t))return null;var r=n.get_$5fK();var i=n.get_$7p();if(_d.$ID.isInstanceOfType(t)){var p=t.$9t*(r-1);return i.$2q(p)}else if(_d.$I0.isInstanceOfType(t)){var u=t.$wT;var o=t.$9t;if(!Array.contains(_d.$2h.$1QI(u),i.get_$Cd())){var w=_d.$2h.$51A(i.get_$Cd(),u,0);i=i.$2q(_d.$2h.$29n(i.get_$Cd(),w))}var s=_d.$2h.$7Ns(u);var b=Math.floor((r-1)/s);var h=(r-1)%s;var f=o*7*b;if(h>0){var e=_d.$2h.$51A(i.get_$Cd(),u,h);if(e<=i.get_$Cd()){f+=o*7;f-=_d.$2h.$29n(e,i.get_$Cd())}else f+=_d.$2h.$29n(i.get_$Cd(),e)}return i.$2q(f)}else if(_d.$IT.isInstanceOfType(t)){var k=t.$BU;var d=t.$9t;var g=_d.$2h.$1QI(t.$OI)[0];(_d.$2h.$2iU(i)>k||i.get_$Cd()>g)&&(i=i.$GR(d));return _d.$2h.$4ep(i.$GR((r-1)*t.$9t),_d.$2h.$1QI(t.$OI)[0],t.$BU)}else if(_d.$IS.isInstanceOfType(t)){var c=t.$OH;var l=t.$9t;if(i.get_$5z()>c){i=i.$GR(l);i=new _a.$7(i.get_$4M(),i.get_$3D(),c)}return i.$GR((r-1)*l)}else if(_d.$Ji.isInstanceOfType(t)){var nt=t.$BU;var a=t.$VK;var tt=_d.$2h.$1QI(t.$OI)[0];(i.get_$3D()>a||_d.$2h.$2iU(i)>nt||i.get_$Cd()>tt)&&(i=new _a.$7(i.get_$4M()+1,a,1));return _d.$2h.$4ep(i.$h2(r-1),_d.$2h.$1QI(t.$OI)[0],t.$BU)}else if(_d.$Io.isInstanceOfType(t)){var v=t.$OH;var y=t.$VK;(i.get_$3D()>y||i.get_$5z()>v)&&(i=new _a.$7(i.get_$4M()+1,y,v));return i.$h2(r-1)}return null};_d.$2h.$51A=function(n,t,i){for(var r=_d.$2h.$1QI(t),f=0,u=0;u<r.length;u++)if(n<=r[u]){f=u;if(n===r[u])break}return r[(i+f)%r.length]};_d.$2h.$29n=function(n,t){var i=t-n;return i<0?i+7:i};_d.$2h.$7Ns=function(n){for(var i=0,t=n;t;){(t&1)>0&&i++;t=t>>1}return i};_d.$2h.$IT=function(n){switch(n){case 0:return _u.Strings.l_Sunday_Text;case 1:return _u.Strings.l_Monday_Text;case 2:return _u.Strings.l_Tuesday_Text;case 3:return _u.Strings.l_Wednesday_Text;case 4:return _u.Strings.l_Thursday_Text;case 5:return _u.Strings.l_Friday_Text;case 6:return _u.Strings.l_Saturday_Text;default:return""}};_d.$2h.$3Yo=function(n,t){if(!$8(t)&&n===t)return _u.Strings.l_Workday_Text;if(n===62)return _u.Strings.l_Weekday_Text;if(n===65)return _u.Strings.l_WeekendDay_Text;if(n===127)return _u.Strings.l_Day_LowerCase_Text;var i=_d.$2h.$1QI(n);switch(i.length){case 0:return"";case 1:return String.format(_u.Strings.l_WhenOneDayOfWeek_Text,_d.$2h.$IT(i[0]));case 2:return String.format(_u.Strings.l_WhenTwoDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]));case 3:return String.format(_u.Strings.l_WhenThreeDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]),_d.$2h.$IT(i[2]));case 4:return String.format(_u.Strings.l_WhenFourDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]),_d.$2h.$IT(i[2]),_d.$2h.$IT(i[3]));case 5:return String.format(_u.Strings.l_WhenFiveDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]),_d.$2h.$IT(i[2]),_d.$2h.$IT(i[3]),_d.$2h.$IT(i[4]));case 6:return String.format(_u.Strings.l_WhenSixDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]),_d.$2h.$IT(i[2]),_d.$2h.$IT(i[3]),_d.$2h.$IT(i[4]),_d.$2h.$IT(i[5]));case 7:return String.format(_u.Strings.l_WhenSevenDaysOfWeek_Text,_d.$2h.$IT(i[0]),_d.$2h.$IT(i[1]),_d.$2h.$IT(i[2]),_d.$2h.$IT(i[3]),_d.$2h.$IT(i[4]),_d.$2h.$IT(i[5]),_d.$2h.$IT(i[6]));default:return""}};_d.$2h.$4yi=function(n){switch(n){case"First":return _u.Strings.l_WhenFirst_Text;case"Second":return _u.Strings.l_WhenSecond_Text;case"Third":return _u.Strings.l_WhenThird_Text;case"Fourth":return _u.Strings.l_WhenFourth_Text;case"Last":return _u.Strings.l_WhenLast_Text;case"None":default:return""}};_d.$2h.$4ep=function(n,t,i){if(i!=="Last"){n=new _a.$7(n.get_$4M(),n.get_$3D(),1);var u=_d.$2h.$29n(n.get_$Cd(),t);var r=0;switch(i){case"First":r=1;break;case"Second":r=2;break;case"Third":r=3;break;case"Fourth":r=4;break}u+=7*(r-1);return n.$2q(u)}else{n=new _a.$7(n.get_$4M(),n.get_$3D(),_a.$7.$15X(n.get_$3D(),n.get_$4M()));return n.$2q(_d.$2h.$29n(t,n.get_$Cd())*-1)}};_d.$uF=function(n,t,i,r){this.$$d_$9Eu=Function.createDelegate(this,this.$9Eu);_d.$uF.initializeBase(this);this.$P=n;this.$5s6=t;$8(this.get_$Nd())||$8(this.get_$Nd().get_$GK())?this.set_$5s4(new _d.$CX(new _d.$Gs,i,null,i,r,"")):this.set_$5s4(_d.$GG.$43T(this.get_$Nd(),i,r));this.$a("RecurrenceDataObject",this.$$d_$9Eu);this.$I9.$a("StartDate",this.$$d_$9Eu);this.$I9.$a("EndDate",this.$$d_$9Eu);this.$I9.$a("RecurrencePattern",this.$$d_$9Eu);this.$I9.$a("TimeZoneId",this.$$d_$9Eu)};_d.$uF.prototype={$P:null,$5s6:null,$I9:null,get_$5s4:function(){return this.$I9},set_$5s4:function(n){if(this.$I9!==n){this.$I9=n;$6(this,"RecurrenceDataObject")}return n},get_$GK:function(){return this.$I9.$I8},set_$GK:function(n){if(this.$I9.$I8!==n){this.$I9.set_$GK(n);$4Z(this,"RecurrencePattern","RecurrenceDataObject")}return n},get_$Nd:function(){return this.$P.get_$1L0()},set_$Nd:function(n){if(this.$P.get_$1L0()!==n){this.$P.set_$1L0(n);$6(this,"Model")}return n},$1SX:function(){return _d.$CX.$1SX(this.$I9.$3CH())},$9Eu:function(n,t){if(_d.$Gs.isInstanceOfType(this.$I9.$I8))this.set_$Nd(null);else{var i=this.$5s6.$I();_d.$GG.$8pA(this.$I9,i);this.set_$Nd(i)}}};_d.$I0=function(n,t,i){this.$9t=n;this.$wT=t;this.$6Bp=i};function $4Px(n,t){_a.$3.$HZ(t.length,3,"Expected three weekly recurrence pattern strings");var i="";switch(n.$9t){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,_d.$2h.$3Yo(n.$wT,n.$6Bp),n.$9t)}_d.$I0.prototype={$6Bp:0,$wT:0,$9t:0,get_$1l:function(){return _u.Strings.l_Weekly_Text},$20C:function(){var n=[_u.Strings.l_Recurrence_PatternWeeklyOneFormat_Text,_u.Strings.l_Recurrence_PatternWeeklyTwoFormat_Text,_u.Strings.l_Recurrence_PatternWeeklyMoreFormat_Text];return $4Px(this,n)},$9AK:function(){var n=[_u.Strings.l_Recurrence_PatternWeeklyOneFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternWeeklyTwoFormat_StringSegment_Text,_u.Strings.l_Recurrence_PatternWeeklyMoreFormat_StringSegment_Text];return $4Px(this,n)},$2Y:function(n){return _d.$I0.isInstanceOfType(n)&&n.$9t===this.$9t&&n.$wT===this.$wT},$3CH:function(){var n=0;this.$9t<=0?n|=4:this.$wT||(n|=2);return n},$9AN:function(){var n=new _g.$j5;n.set_$Ww(this.$9t);n.set_$14g(this.$wT);n.set_$3Xr(_a.$Ee.toString(_a.$7.$2hm()));return n},$46:function(){return new _d.$I0(this.$9t,this.$wT)}};_d.$Io=function(n,t){this.$OH=n;this.$VK=t;this.$1zN=new _d.$mV};function $4Py(n,t){return String.format(t,n.$1zN.$39(n.$VK,!0),n.$OH)}_d.$Io.prototype={$1zN:null,$VK:0,$OH:0,get_$1l:function(){return _u.Strings.l_YearlyByDay_Text},$20C:function(){return $4Py(this,_u.Strings.l_Recurrence_PatternYearlyByDayOneFormat_Text)},$9AK:function(){return $4Py(this,_u.Strings.l_Recurrence_PatternYearlyByDayOneFormat_StringSegment_Text)},$2Y:function(n){return _d.$Io.isInstanceOfType(n)&&n.$OH===this.$OH&&n.$VK===this.$VK},$3CH:function(){var n=0;(0>=this.$OH||this.$OH>31)&&(n|=1);return n},$9AN:function(){return new _g.$eN(new _g.$Ns(this.$OH,this.$1zN.$39(this.$VK,!1)))},$46:function(){return new _d.$Io(this.$OH,this.$VK)}};_d.$Ji=function(n,t,i){this.$BU=n;this.$OI=t;this.$VK=i;this.$1zN=new _d.$mV};function $4Pz(n,t){return String.format(t,_d.$2h.$4yi(n.$BU),_d.$2h.$3Yo(n.$OI),n.$1zN.$39(n.$VK,!0))}_d.$Ji.prototype={$1zN:null,$VK:0,$BU:"None",$OI:0,get_$1l:function(){return _u.Strings.l_YearlyByWeek_Text},$20C:function(){return $4Pz(this,_u.Strings.l_Recurrence_PatternYearlyByWeekOneFormat_Text)},$9AK:function(){return $4Pz(this,_u.Strings.l_Recurrence_PatternYearlyByWeekOneFormat_StringSegment_Text)},$2Y:function(n){return _d.$Ji.isInstanceOfType(n)&&n.$OI===this.$OI&&n.$BU===this.$BU&&n.$VK===this.$VK},$3CH:function(){var n=0;this.$OI||(n|=2);this.$BU==="None"&&(n|=16);return n},$9AN:function(){var n=new _g.$nl;n.set_$3D(this.$1zN.$39(this.$VK,!1));n.set_$14g(this.$OI);n.set_$1ET(this.$BU);return n},$46:function(){return new _d.$Ji(this.$BU,this.$OI,this.$VK)}};_d.$7K=function(n,t,i,r,u,f,e,o,s){this.$$d_$5fx=Function.createDelegate(this,this.$5fx);this.$$d_$8eK=Function.createDelegate(this,this.$8eK);this.$$d_$5jl=Function.createDelegate(this,this.$5jl);this.$$d_$309=Function.createDelegate(this,this.$309);this.$$d_$3yX=Function.createDelegate(this,this.$3yX);_d.$7K.initializeBase(this);this.$66=e;this.$11J=o;this.$2Dh=s;this.$36=f;this.$36.$vd();this.$36.set_$L8(u);this.$36.set_$1aY("PersonaDetailedView");this.$36.add_$jv(this.$$d_$3yX);this.$EH=n;this.$EE=t;this.$jR=i;this.$1wn=new(_a.$3Y.$$(String));this.$1uw=new(_a.$3Y.$$(String));this.$11H=r};function $4Lb(n,t,i){var r=0;var f=0;var e=t;for(var o in e){var u={key:o,value:e[o]};var s=u.value;($8(s)||s.get_$7v())&&(n.$1wn.$6l(u.key)?r++:n.$1uw.$6l(u.key)&&f++)}n.$jR.$9u&&r++;n.$11H.get_$A1()&&n.$11H.get_$363().get_$7v()&&r++;$4La(n);n.set_$8sD(_d.$Dw.$3RG(r,!n.$2Dh&&!i));n.set_$8iU(_d.$Dw.$3RG(f,!n.$2Dh&&!i))}function $4La(n){var t=n.$1wn.get_$F()+1+(n.$11H.get_$A1()?1:0);n.set_$8sE(_d.$Dw.$4pR(t));n.set_$8iV(_d.$Dw.$76X(n.$1uw.get_$F()))}function $4LX(n,t,i){for(var f,r,u=0;u<t.$1L.get_$F();u++){f=t.$1L.get_$48(u);r=f.$4U;r.set_$13c(i);r.$a("AttendeeType",n.$$d_$5fx)}}function $4LZ(n,t){for(var r,u,i=0;i<t.$1L.get_$F();i++){r=t.$1L.get_$48(i);u=r.$4U;u.$w("AttendeeType",n.$$d_$5fx)}}function $6JY(n,t){var r=_d.$6B.$4yd(t.$Wp());if(!$6JZ(n,r)){var u=_c.$i.$E5(r);u.set_$18(t.get_$1v().get_$18());var i=n.$11J.$2bo(u,n.$a6.$1Kz,!0,0);i.$a("AttendeeType",n.$$d_$5fx);i.$1AQ=!0;n.$a6.$1CU(i)}}function $6Ja(n){var t=1;t|=2;return t}function $4LU(n,t,i){for(var f=new _js.$X,r,u=0;u<t.get_$F();u++){r=t.get_$48(u).get_$6V();f.$H(r);i.$H(r.EmailAddress)}return n.$66.$1QU(_y.$q.$Hr,f,$6Ja(n))}function $4LV(n,t,i,r,u){switch(t.$3R){case 0:var f=this;Array.forEach(t.$2t,function(t){var e=i.$1L.get_$48(i.$1L.get_$F()-1);var f=e.$4U.$12;f.get_$18()===2&&f.get_$1h().RoutingType==="MAPIPDL"&&(n.$1Ew[f.get_$1h().Name]=e);n.$1Ew[f.get_$1h().EmailAddress]=e;u.$H(f.get_$1h().EmailAddress);r.$H(_g.$3X.$rO(f.get_$1h()))});break;case 2:var e=this;Array.forEach(t.$3Y,function(n){var i=n;u.$3Q(i.EmailAddress);for(var t=0;t<r.get_$F();t++)if(r.get_$48(t).get_$6V().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$67(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}$4La(n);n.set_$625(n.$fw.$1L.get_$F()>0)}function $6JZ(n,t){for(var i=t.EmailAddress.toLowerCase(),r=0;r<n.$EH.get_$F();r++)if(n.$EH.get_$48(r).get_$6V().EmailAddress.toLowerCase()===i)return!0;for(var u=0;u<n.$EE.get_$F();u++)if(n.$EE.get_$48(u).get_$6V().EmailAddress.toLowerCase()===i)return!0;return n.$jR.$4U.$12.get_$1h().EmailAddress.toLowerCase()===i?!0:!!n.$11H.get_$A1()&&n.$11H.get_$A1().EmailAddress.toLowerCase()===i}function $4LW(n,t){for(var i=0;i<t.$1L.get_$F();i++){var r=t.$1L.get_$48(i);var u=t.$84.get_$48(i).EmailAddress;n.$1Ew[u]=r}}function $4LY(n,t,i){i=i.toLowerCase();var u=this;var r=t.$1L.$DK(function(n){return i===n.$4U.$12.get_$1h().EmailAddress.toLowerCase()});if(r<t.$1L.get_$F()){t.$34L(t.$1L.get_$48(r).$4U);return!0}return!1}_d.$7K.prototype={$36:null,$EH:null,$EE:null,$66:null,$11J:null,$2Dh:!1,$1wn:null,$1uw:null,$11H:null,$jR:null,$a6:null,$fw:null,$1Ew:null,$37z:!1,$34b:null,$30t:null,$34a:null,$30s:null,get_$8sA:function(){return this.$a6},set_$8sA:function(n){this.$a6=n;$6(this,"RequiredAttendeeRecipientWellViewModel");return n},get_$8iR:function(){return this.$fw},set_$8iR:function(n){this.$fw=n;$6(this,"OptionalAttendeeRecipientWellViewModel");return n},get_$625:function(){return this.$37z},set_$625:function(n){if(this.$37z!==n){this.$37z=n;$6(this,"ShowOptionalRecipientWell")}return n},get_$8sE:function(){return this.$34b},set_$8sE:function(n){if(this.$34b!==n){this.$34b=n;$6(this,"RequiredCountLabel")}return n},get_$8iV:function(){return this.$30t},set_$8iV:function(n){if(this.$30t!==n){this.$30t=n;$6(this,"OptionalCountLabel")}return n},get_$8sD:function(){return this.$34a},set_$8sD:function(n){if(this.$34a!==n){this.$34a=n;$6(this,"RequiredConflictsLabel")}return n},get_$8iU:function(){return this.$30s},set_$8iU:function(n){if(this.$30s!==n){this.$30s=n;$6(this,"OptionalConflictsLabel")}return n},$Ar:function(){if(!$8(this.$a6)){this.$a6.$84.remove_$1Z(this.$$d_$309);this.$fw.$84.remove_$1Z(this.$$d_$5jl);$4LZ(this,this.$a6);$4LZ(this,this.$fw)}this.$1Ew={};this.$1wn.$1u();this.$1uw.$1u();this.set_$8sA($4LU(this,this.$EH,this.$1wn));this.set_$8iR($4LU(this,this.$EE,this.$1uw));$4LX(this,this.$a6,0);$4LX(this,this.$fw,1);this.$a6.$84.add_$1Z(this.$$d_$309);this.$fw.$84.add_$1Z(this.$$d_$5jl);this.set_$625(this.$fw.$1L.get_$F()>0);$4LW(this,this.$a6);$4LW(this,this.$fw);$4Lb(this,{},!1);this.$11H.apcl("selectedRoomEmailAddress",this.$$d_$8eK)},$4fn:function(n,t){var f=n;for(var e in f){var o={key:e,value:f[e]};var r=this.$1Ew[o.key];if(!$8(r)){var s=r.$4U;var u=o.value;r.set_$7v(u.get_$7v());s.$J1(1,this.$4yc(u),0);s.set_$4v4(_h.$L9.$51y(u.$MP))}}if(!$8(this.$jR)){var i=n[this.$jR.$4U.$12.get_$1h().EmailAddress];if(!$8(i)){this.$jR.set_$7v(i.get_$7v());this.$jR.$4U.$J1(1,this.$4yc(i),0);this.$jR.$4U.set_$4v4(_h.$L9.$51y(i.$MP))}}$4Lb(this,n,t)},$4yc:function(n){var t=n.$lY;_js.$8.$c(n.$25x)||n.$25x===t||(t+=String.format(_u.Strings.l_SchedulingConflictingMeetings_Text,n.$25x));return t},$3yX:function(n,t){var i=n.get_$Vm();$8(i)||$6JY(this,i)},$5fx:function(n,t){var i=n;i.$w("AttendeeType",this.$$d_$5fx);var r=this.$11J.$2bo(i.get_$1v(),this.$a6.$1Kz,!0,i.$WG);r.$a("AttendeeType",this.$$d_$5fx);if(r.$WG){this.$a6.$34L(i);this.$fw.$1CU(r)}else{this.$fw.$34L(i);this.$a6.$1CU(r)}},$309:function(n,t){$4LV(this,t,this.$a6,this.$EH,this.$1wn)},$5jl:function(n,t){$4LV(this,t,this.$fw,this.$EE,this.$1uw)},$8eK:function(n,t){this.$11H.get_$A1()&&($4LY(this,this.$a6,this.$11H.get_$A1().EmailAddress)||$4LY(this,this.$fw,this.$11H.get_$A1().EmailAddress))}};_d.$Ie=function(n){this.$$d_$8bv=Function.createDelegate(this,this.$8bv);this.$$d_$8fr=Function.createDelegate(this,this.$8fr);_d.$Ie.initializeBase(this);this.$gP=n;this.$gP.$a("ShowSelectionPeek",this.$$d_$8fr);this.$a("IsShown",this.$$d_$8bv)};function $6S0(n){var i=n.$gP.$1w0;var r=n.$gP.$4z0();var t=$6Rw(n,i,r);n.$4tx=_d.$Iz.$52p(i.$2G,i.$2w);n.$5tt=_d.$Dw.$4pR(r.get_$F());n.$4mb=_d.$Dw.$3RG(t.get_$F(),!n.$gP.$2Dh&&!n.$gP.get_$3bt());n.$4GD=null;n.$3bH=null;if(t.get_$F()>0){n.$4GD=$6Ry(n,t);t.get_$F()-4>0&&(n.$3bH=$6Rx(n,t.get_$F()-4))}}function $6Rx(n,t){switch(t){case 1:return _u.Strings.l_OneAdditionalConflict_Text;default:return _js.$8.$4C(_u.Strings.l_AdditionalConflicts_Text,t)}}function $6Rw(n,t,i){var r=n.$gP.$Mo.$2AD(t.$2G,t.$2w,_g.$2I.$9AQ(i),!0);return _d.$Dw.$4zW(r)}function $6Ry(n,t){for(var u=new _js.$X,r,i=0;i<t.get_$F()&&i<4;i++){r=t.get_$48(i);$6Rz(n,r);u.$H(r)}return u}function $6Rz(n,t){if(n.$gP.$Mo.get_$1xa()&&_a.$3m.$OQ(n.$gP.$Mo.get_$1xa().EmailAddress)===_a.$3m.$OQ(t.$9e))t.$6m=n.$gP.$8x.get_$Fk()?n.$gP.$8x.get_$Fk().Name:n.$gP.$8x.get_$8Q2().Name;else{var i;i=n.$gP.get_$38j()[t.$9e];$8(i)||(t.$6m=i.Name)}}_d.$Ie.prototype={$gP:null,$5tt:null,$4mb:null,$4tx:null,$4GD:null,$3bH:null,$2R:!1,get_$1X:function(){return this.$2R},set_$1X:function(n){if(this.$2R!==n){this.$2R=n;this.$2R;$6(this,"IsShown")}return n},get_$5In:function(){return 400},get_$zw:function(){return 330},get_$59e:function(){return!!this.$gP.$1w0},$8fr:function(n,t){this.get_$59e()&&n.$2Q9?this.set_$1X(!0):this.set_$1X(!1)},$8bv:function(n,t){this.$2R&&$6S0(this)}};_d.$uS=function(n,t,i,r,u,f){_d.$uS.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$uS.initializeBase(this);this.$2G=$8(i)?null:i.$46();this.$2w=$8(r)?null:r.$46();this.$hz=n;this.$5np=t;this.$4c=_g.$3G.$wE("");this.$1nn=u;this.$2nM=f};_d.$uS.prototype={$4c:null,$5np:0,$2G:null,$2w:null,$hz:"Free",$1nn:!1,$2nM:!1,get_$9w:function(){return this.$2nM},get_$1UI:function(){return this.$1nn},get_$i:function(){return null},get_$10:function(){return this.$2G},get_$EB:function(){return!1},get_$23:function(){return this.$2w},get_$2h:function(){return""},get_$92:function(){return this.$hz},get_$5m:function(){return!1},get_$7ZL:function(){switch(this.$hz){case"Tentative":case"Busy":case"OOF":return!1;default:return!0}},get_$5Z:function(){return null},get_$iZ:function(){return""},get_$4h:function(){return this.$4c},get_$3jM:function(){return!1},get_$Ho:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingConflictViewModel");},get_$b2:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingConflictViewModel");}};_d.$Jd=function(n,t,i,r,u,f,e,o){this.$$d_$p6=Function.createDelegate(this,this.$p6);this.$$d_$9A4=Function.createDelegate(this,this.$9A4);_d.$Jd.initializeBase(this,[n,t,i,u,f,e,!1,null,o]);this.$WG=r;this.$2RV=new _0365m.$n(_u.Strings.l_MarkAsOptional_Text,null,new _C(this.$$d_$9A4,_a.$0.$DT));this.$2RV.set_$15(!this.get_$4jV());this.$2RV.$Sz.set_$5P(this.get_$4jV());var s=this;this.$37k=new _0365m.$n(_u.Strings.l_ShowError_Text,null,new _C(this.$$d_$p6,_a.$0.$DT,this,"CanShowError",function(){return s.get_$2aC()}));this.$37k.set_$15(!0);$3Fw(this);Array.add(this.$hb,this.$2RV);Array.add(this.$hb,this.$37k);this.$1r=new _y.$4p};function $3Fw(n){n.$2RV.set_$1N(n.$WG?_u.Strings.l_MarkAsRequired_Text:_u.Strings.l_MarkAsOptional_Text)}function $4Pc(n,t){var i=t.get_$1h().EmailAddress;return!!i&&i.startsWith("@")}_d.$Jd.prototype={$2RV:null,$37k:null,$1r:null,$WG:0,$28Z:null,get_$2aC:function(){return!$8(this.$28Z)&&!$4Pc(this,this.get_$1v())},get_$4v4:function(){return this.$28Z},set_$4v4:function(n){if(this.$28Z!==n){var t=this.get_$2aC();this.$28Z=n;if(t!==this.get_$2aC()){$6(this,"CanShowError");this.$37k.set_$15(!this.get_$2aC())}}return n},get_$13c:function(){return this.$WG},set_$13c:function(n){if(this.$WG!==n){this.$WG=n;$3Fw(this);$6(this,"AttendeeType")}return n},get_$4jV:function(){return!this.$WG||this.$WG===1},$2AI:function(){var n=_y.$q.prototype.$2AI.call(this);if($4Pc(this,n)){n=_c.$i.$E5(_0365f.$2t.$46(n.get_$1h(),!0,!0));n.get_$1h().EmailAddress=null}return n},$9A4:function(){this.set_$13c(this.$WG?0:1);$3Fw(this)},$p6:function(){this.$1r.$3A(0,this.$28Z,null,!1)}};_d.$Vf=function(n,t,i,r){_d.$Vf.initializeBase(this,[n,t,i,r]);this.$1QA=n;this.$G=t};_d.$Vf.prototype={$G:null,$1QA:null,$qm:function(n,t,i,r){return this.$2bo(n,t,i,0,r)},$2bo:function(n,t,i,r,u){return new _d.$Jd(n,t,i,r,u,this.$1QA,this.$G,this.$1K)}};_d.$3H=function(n,t){_d.$3H.initializeBase(this,[n]);if(!$8(t)){this.set_$pc(t.$Tt);this.set_$4vG(t.$9F.get_$10());this.set_$4vC(t.$9F.get_$23());this.set_$154(t.$9F.$153);this.set_$3Wk(new _js.$X);this.get_$3Wk().$6G(t.$Ln.$7V());this.set_$3Wj(new _js.$X);this.get_$3Wj().$6G(t.$bP.$7V());this.set_$3zl(new _js.$X);this.get_$3zl().$6G(t.$19B.$7V());this.set_$3zk(new _js.$X);this.get_$3zk().$6G(t.$2LO.$7V());this.set_$3zh(new _js.$X);this.get_$3zh().$6G(t.$2LM.$7V());this.set_$5xa(t.$8x.get_$Fk());this.set_$5xY(t.$8x.get_$A1());this.set_$58m(t.$8x.get_$1OT())}};_d.$3H.$$cctor=function(){_d.$3H.$2fj.set_$FQ(new _a.$DB(_g.$3X));_d.$3H.$2fi.set_$FQ(new _a.$DB(_g.$3X));_d.$3H.$315.set_$FQ(new _a.$DB(_g.$3X));_d.$3H.$314.set_$FQ(new _a.$DB(_g.$3X));_d.$3H.$313.set_$FQ(new _a.$DB(_g.$3X))};_d.$3H.prototype={get_$4vG:function(){return this.$W(_d.$3H.$3Wl)},set_$4vG:function(n){this.$N(_d.$3H.$3Wl,n);return n},get_$4vC:function(){return this.$W(_d.$3H.$3Wg)},set_$4vC:function(n){this.$N(_d.$3H.$3Wg,n);return n},get_$154:function(){return this.$W(_d.$3H.$3Vd)},set_$154:function(n){this.$N(_d.$3H.$3Vd,n);return n},get_$pc:function(){return this.$W(_d.$3H.$4G3)},set_$pc:function(n){this.$N(_d.$3H.$4G3,n);return n},get_$3Wk:function(){return this.$W(_d.$3H.$2fj)},set_$3Wk:function(n){this.$N(_d.$3H.$2fj,n);return n},get_$3Wj:function(){return this.$W(_d.$3H.$2fi)},set_$3Wj:function(n){this.$N(_d.$3H.$2fi,n);return n},get_$3zl:function(){return this.$W(_d.$3H.$315)},set_$3zl:function(n){this.$N(_d.$3H.$315,n);return n},get_$3zk:function(){return this.$W(_d.$3H.$314)},set_$3zk:function(n){this.$N(_d.$3H.$314,n);return n},get_$3zh:function(){return this.$W(_d.$3H.$313)},set_$3zh:function(n){this.$N(_d.$3H.$313,n);return n},get_$5xa:function(){return this.$W(_d.$3H.$46n)},set_$5xa:function(n){this.$N(_d.$3H.$46n,n);return n},get_$5xY:function(){return this.$W(_d.$3H.$46o)},set_$5xY:function(n){this.$N(_d.$3H.$46o,n);return n},get_$58m:function(){return this.$W(_d.$3H.$3fC)},set_$58m:function(n){this.$N(_d.$3H.$3fC,n);return n},$4nm:function(n){n.set_$pc(this.get_$pc());n.$9F.set_$154(this.get_$154());n.$9F.set_$10(this.get_$4vG());n.$9F.$1PS&&n.$9F.set_$23(this.get_$4vC());n.$Ln.$6G(this.get_$3Wk().$7V());n.$bP.$6G(this.get_$3Wj().$7V());n.$19B.$6G(this.get_$3zl().$7V());n.$2LO.$6G(this.get_$3zk().$7V());n.$2LM.$6G(this.get_$3zh().$7V());n.$8x.set_$Fk(this.get_$5xa());n.$8x.set_$A1(this.get_$5xY());n.$8x.set_$1OT(this.get_$58m())}};_d.$6B=function(n,t,i,r,u,f,e,o,s){this.$$d_$8fq=Function.createDelegate(this,this.$8fq);this.$$d_$1uh=Function.createDelegate(this,this.$1uh);this.$$d_$309=Function.createDelegate(this,this.$309);this.$$d_$8fs=Function.createDelegate(this,this.$8fs);this.$$d_$8d2=Function.createDelegate(this,this.$8d2);this.$$d_$8f8=Function.createDelegate(this,this.$8f8);this.$$d_$5kc=Function.createDelegate(this,this.$5kc);_d.$6B.initializeBase(this);this.$4DE=n;this.$l=t;this.$7BX=f;this.$48Y=o;this.$2Dh=s;this.$3Ve=i;this.$Mo=r;this.$8x=u;this.$1r=e;this.$2LO=new(_a.$1p.$$(_g.$3X,_g.$8J));this.$2LM=new(_a.$1p.$$(_g.$3X,_g.$8J));this.$19B=new(_a.$1p.$$(_g.$3X,_g.$8J));this.$Ln=new(_a.$1p.$$(_g.$3X,_g.$8J));this.$bP=new(_a.$1p.$$(_g.$3X,_g.$8J));this.$9F=new _d.$Ed(new _d.$15y(this.$l.$r.get_$10(),this.$l.$r.get_$23(),this.$l.$r.get_$5m()));this.$9F.$a("Start",this.$$d_$5kc);this.$9F.$a("End",this.$$d_$5kc);this.$9F.$a("CorrectedDateRange",this.$$d_$8f8);this.$a("PreviewDateRange",this.$$d_$8d2);this.$a("ShowSelectionPreview",this.$$d_$8fs);this.set_$pc(this.$l.$r.get_$10().$3u());this.set_$1ym(!this.$9F.get_$5m());this.$2ng=!0};_d.$6B.$4yd=function(n){if(_js.$8.$c(n.EmailAddress)){n=_0365f.$2t.$46(n,!0,!0);n.EmailAddress=n.ItemId&&!_js.$8.$c(n.ItemId.Id)?"@"+n.ItemId.Id:String.format("{0}{1}{2}","@",n.Name,n.MailboxType)}return n};_d.$6B.$96D=function(n,t){var u={};_d.$6B.$349(u,n);for(var r=0;r<t.get_$F();r++)var e=t.get_$48(r).get_$6V().EmailAddress;for(var i=0;i<t.get_$F();i++){var f=u[t.get_$48(i).get_$6V().EmailAddress.toLowerCase()];if(f)n.$3Q(f);else{t.$67(i);i--}}};_d.$6B.$7IN=function(n,t,i,r){_d.$6B.$3Yp(t);_d.$6B.$3Yp(i);_d.$6B.$3Yp(n);var u={};u[r.EmailAddress.toLowerCase()]=r;_d.$6B.$349(u,n);_d.$6B.$349(u,t);_d.$6B.$349(u,i)};_d.$6B.$349=function(n,t){for(var i=0;i<t.get_$F();i++){var u=t.get_$48(i);var r=u.get_$6V().EmailAddress.toLowerCase();if(n[r]){_js.Trace.logInfo(_a.$0.$DT,"SchedulingContext: Removing duplicated entry {0}",r);t.$67(i);i--}else n[r]=u}};_d.$6B.$3Yp=function(n){for(var t=0;t<n.get_$F();t++)_js.$8.$c(n.get_$48(t).get_$6V().EmailAddress)&&n.set_$48(t,_g.$3X.$rO(_d.$6B.$4yd(n.get_$48(t).get_$6V())))};_d.$6B.$3PP=function(n){for(var t=0;t<n.get_$F();t++){var i=n.get_$48(t);i.get_$6V().EmailAddress.startsWith("@")&&(i.get_$6V().EmailAddress=null)}};_d.$6B.$23r=function(n,t){if(n===t)return!0;if(!n||!t||n.get_$F()!==t.get_$F())return!1;for(var i=0;i<n.get_$F();i++)if(!(_0365f.$2t.$4F(t.get_$48(i).get_$6V().ItemId,n.get_$48(i).get_$6V().ItemId)&&t.get_$48(i).get_$6V().EmailAddress===n.get_$48(i).get_$6V().EmailAddress))return!1;return!0};function $6S1(n){for(var r=n.$4z0(),u={},t=0;t<r.get_$F();t++){var i=r.get_$48(t);$8(i)||(u[i.EmailAddress]=i)}return u}function $4PU(n){n.$4DE.$3OZ();n.$2QA&&n.$2ng&&n.$4DE.$21(n.$$d_$8fq,400,_a.$0.$DT)}function $6S3(n){var t=n.$3Ve;var i=n.$9F;return t.get_$10()!==i.get_$10()||t.get_$23()!==i.get_$23()||t.get_$DE()!==i.get_$DE()||t.$153!==i.$153}function $6S2(n){return!_d.$6B.$23r(n.$2LO,n.$Ln)||!_d.$6B.$23r(n.$2LM,n.$bP)}function $6S4(n){return!n.$19B.get_$F()&&n.$8x.get_$A1()?!0:n.$19B.get_$F()>0&&!n.$8x.get_$A1()?!0:n.$19B.get_$F()>0&&!!n.$8x.get_$A1()&&n.$19B.get_$48(0).get_$6V().EmailAddress!==n.$8x.get_$A1().EmailAddress}_d.$6B.prototype={$4DE:null,$l:null,$Mo:null,$8x:null,$7BX:0,$Ln:null,$bP:null,$19B:null,$3Ve:null,$2Dh:!1,$1r:null,$9F:null,$Tt:null,$1w0:null,$2QA:!1,$2ng:!1,$48Y:!1,$2Q9:!1,$4AA:null,$2LO:null,$2LM:null,get_$pc:function(){return this.$Tt},set_$pc:function(n){if($8(n))throw Error.argumentNull("ViewStartDate");if(n.$3QP())throw Error.argument("ViewStartDate","value should not contain time part.");if(!_a.$7.$4F(this.$Tt,n)){this.$Tt=n;this.$Mo.set_$e6(this.$Tt);$6(this,"ViewStartDate")}return n},get_$2fk:function(){return this.$l.$r.get_$2h()},get_$1Rg:function(){return this.$l.$r.get_$Cl().Mailbox},get_$1mm:function(){return $6S3(this)||$6S4(this)||$6S2(this)},get_$1Tz:function(){return!this.get_$Uk()},get_$2Zv:function(){return!this.get_$Uk()},get_$5qB:function(){return this.$1w0},set_$5qB:function(n){if($8(n))throw Error.argumentNull("PreviewDateRange");if(!_a.$7.$4F(this.$1w0,n)){this.$1w0=n;$6(this,"PreviewDateRange")}return n},get_$1ym:function(){return this.$2QA},set_$1ym:function(n){if(this.$2QA!==n){this.$2QA=n;$6(this,"ShowSelectionPreview")}return n},get_$49g:function(){return this.$2Q9},set_$49g:function(n){if(this.$2Q9!==n){this.$2Q9=n;$6(this,"ShowSelectionPeek")}return n},get_$38j:function(){if(!this.$4AA){this.$4AA=$6S1(this);this.$Ln.add_$1Z(this.$$d_$309);this.$8x.apcl("SelectedRoomViewModel",this.$$d_$1uh)}return this.$4AA},get_$3bt:function(){return!_a.$7.$4F(this.$l.$r.get_$10(),this.$9F.get_$10())||!_a.$7.$4F(this.$l.$r.get_$23(),this.$9F.get_$23())},get_$10:function(){return this.$9F.get_$10()},get_$23:function(){return this.$9F.get_$23()},get_$Jh:function(){return this.$l.$r.get_$Jh()},get_$ZC:function(){return this.$l.$r.get_$ZC()},get_$Uk:function(){return!_d.$Gs.isInstanceOfType(this.$l.$Cm.get_$GK())},$72E:function(){if(this.$48Y){this.$48Y=!1;var t;var i;var n;t=this.$l.$r.get_$72()?this.$l.$r.get_$72().$46():new(_a.$1p.$$(_g.$3X,_g.$8J));i=this.$l.$r.get_$8A()?this.$l.$r.get_$8A().$46():new(_a.$1p.$$(_g.$3X,_g.$8J));n=this.$l.$r.get_$9D()?this.$l.$r.get_$9D().$46():new(_a.$1p.$$(_g.$3X,_g.$8J));_d.$6B.$7IN(n,t,i,this.$l.$r.get_$Cl().Mailbox);if(n.get_$F()>0){this.$8x.set_$A1(n.get_$48(0).get_$6V());for(var r=1;r<n.get_$F();r++)t.$H(n.get_$48(r))}else this.$8x.set_$A1(null);this.$2LO=t;this.$2LM=i;this.$Ln.$3Qv(t);this.$bP.$3Qv(i);this.$19B.$3Qv(n);this.set_$pc(this.$l.$r.get_$10().$3u());this.set_$1ym(!this.$9F.get_$5m())}},$4fr:function(){this.$3Ve.$68u(this.$9F.get_$10(),this.$9F.get_$DE(),this.$9F.get_$5m())},$4fq:function(){var t=this.$Ln.$46();var n=this.$19B.$46();var i=this.$bP.$46();_d.$6B.$96D(t,n);this.$8x.get_$A1()&&!this.$8x.get_$8w2()&&n.$6z(0,_g.$3X.$rO(this.$8x.get_$A1()));_d.$6B.$3PP(t);_d.$6B.$3PP(i);_d.$6B.$3PP(n);_d.$6B.$23r(t,this.$l.$r.get_$72())||this.$l.$r.set_$72(t);_d.$6B.$23r(i,this.$l.$r.get_$8A())||this.$l.$r.set_$8A(i);_d.$6B.$23r(n,this.$l.$r.get_$9D())||this.$l.$r.set_$9D(n)},$4z0:function(){var n=new(_a.$3Y.$$(_g.$1m));n.$H(this.get_$1Rg());for(var t=0;t<this.$Ln.get_$F();t++)n.$H(this.$Ln.get_$48(t).get_$6V());this.$8x.get_$A1()&&n.$H(this.$8x.get_$A1());return n},$3ZU:function(n){var t=new(_a.$3Y.$$(String));t.$H(this.get_$1Rg().EmailAddress);for(var i=0;i<this.$Ln.get_$F();i++)t.$H(this.$Ln.get_$48(i).get_$6V().EmailAddress);for(var r=0;r<this.$bP.get_$F();r++)t.$H(this.$bP.get_$48(r).get_$6V().EmailAddress);for(var f=this.$8x.$3ZU(n),u=0;u<f.get_$F();u++)t.$H(f.get_$48(u));return t},$1uh:function(n,t){this.$8x.get_$A1()&&(this.get_$38j()[this.$8x.get_$A1().EmailAddress]=this.$8x.get_$A1())},$309:function(n,t){var i;switch(t.$3R){case 0:for(var r=t.$2t.length-1;r>=0;r--){i=t.$2t[r].get_$6V();this.get_$38j()[i.EmailAddress]=i}break;case 2:for(var u=t.$3Y.length-1;u>=0;u--){i=t.$3Y[u].get_$6V();delete this.get_$38j()[i.EmailAddress]}break;default:break}},$5kc:function(n,t){var i=this.$9F.get_$10().$3u();this.$Mo.set_$5JH(i);this.set_$pc(i)},$8f8:function(n,t){this.$8x.set_$aD(this.$9F.$lF.$46());this.set_$1ym(!1)},$8d2:function(n,t){this.set_$1ym(!this.$9F.get_$5m());this.set_$49g(!1);$4PU(this)},$8fs:function(n,t){this.set_$49g(!1);$4PU(this)},$8fq:function(){this.set_$49g(!this.$9F.get_$5m())}};_d.$4K=function(n,t){this.$$d_$3yB=Function.createDelegate(this,this.$3yB);this.$$d_$1uh=Function.createDelegate(this,this.$1uh);this.$$d_$5jl=Function.createDelegate(this,this.$5jl);this.$$d_$309=Function.createDelegate(this,this.$309);this.$$d_$3zC=Function.createDelegate(this,this.$3zC);this.$$d_$5iA=Function.createDelegate(this,this.$5iA);this.$$d_$5iB=Function.createDelegate(this,this.$5iB);this.$2YR={};_d.$4K.initializeBase(this,[n.$9F.get_$10(),null,null,null,t]);_a.$3.$M(t,"calendarContext");this.$j=n;this.$g7=new _js.$X;this.$hJ=new _js.$X;this.$1nQ=this.$1c.$G.get_$O()==="Mouse";this.set_$3SU(new _d.$Fo([n.$9F.get_$10()],this.$BJ,this.$g7,t.$2f));this.$a("GridSelectedRowColumnIndex",this.$$d_$5iB);this.$1nQ&&this.$a("GridHoveredRowColumnIndex",this.$$d_$5iA);this.$1JS=!0;this.$qz=!0;this.$j.$a("ViewStartDate",this.$$d_$3zC);this.$j.$Ln.add_$1Z(this.$$d_$309);this.$j.$bP.add_$1Z(this.$$d_$5jl);this.$j.$8x.apcl("SelectedRoomViewModel",this.$$d_$1uh);this.$j.$Mo.add_$2ia(this.$$d_$3yB)};function $6S5(n){n.set_$AB(n.$j.$Tt);$1eB(n,0,_g.$3X.$rO(n.$j.get_$1Rg()),!0);for(var t=0;t<n.$j.$Ln.get_$F();t++)$1eB(n,t+1,n.$j.$Ln.get_$48(t),!1);for(var i=0;i<n.$j.$bP.get_$F();i++)$1eB(n,i+1+n.$j.$Ln.get_$F(),n.$j.$bP.get_$48(i),!1);if(n.$j.$8x.get_$A1()){n.$Jy=n.$j.$8x.get_$A1();$1eB(n,n.$g7.get_$F(),_g.$3X.$rO(n.$Jy),!1)}}function $1eB(n,t,i,r){var f=i.get_$6V().EmailAddress;var e=_js.$8.$c(i.get_$6V().Name)?f:i.get_$6V().Name;var u=new _g.$9b;u.set_$Ca(e);u.set_$DQ(f);u.set_$i(new _g.$1j(f));u.set_$1Cv(r?_d.$4K.$5m4:_d.$4K.$4hA);u.set_$mU(!0);n.$g7.$6z(t,u);n.$hJ.$6z(t,new _d.$O0(u,null,null,null,n.$1c.$6w));$3Fu(n,new _d.$4K.$3M0(n.$14h,u.get_$DQ()))}function $4PY(n,t){var i=n.$g7.get_$48(t);$4PZ(n,i,!0);n.$g7.$67(t);n.$hJ.$67(t)}function $3Fu(n,t){if($4PV(n,t)){_js.Trace.logInfo(_a.$0.$DT,"AddItemsForAttendee() Token already exists {0}. ",t.get_$2S6());return}var r=this;var i=function(){$6S7(n,t);var i=null;$1Bx(n)&&n.$14h===t.get_$77r()&&(i=$4PW(n,t.get_$1h()));if(!i){_js.Trace.logInfo(_a.$0.$DT,"AddItemsForAttendee() Ignore async calendar add. {0}",t.get_$2S6());return}var f=new(_a.$3Y.$$(String));f.$H(i.get_$DQ());var e=n.get_$AB().$3u();var s=n.$j.$Mo.$7Nd(e,e.$2q(1),f);var r=s[i.get_$DQ()];var o=n.$j.$Mo.$7Jz(f)[i.get_$DQ()];var h=!$8(o)&&o!=="NoError";if(r)try{n.set_$bp(!0);for(var u=0;u<r.get_$F();u++){r.get_$48(u).$Fs=i;n.$H0(r.get_$48(u))}}finally{n.set_$bp(!1)}n.$Mu.$7PP(i).set_$7SM(h)};$6S6(n,t);n.get_$9GB()?_js.$K.get_$L().$21(_a.$0.$DT,"Scheduling",i,0):i()}function $4PZ(n,t,i){try{i&&n.set_$bp(!0);_js.Trace.logInfo(_a.$0.$DT,"Removing calendar items of user: {0} ",t.get_$Ca());for(var f=!1,r=0;r<n.$o.get_$F();r++)if(n.$o.get_$48(r).$Fs===t){n.$o.$67(r);r--;f=!0}else if(f)break;for(var u=0;u<n.$BJ.get_$F();u++)if(n.$BJ.get_$48(u).$Fs===t){n.$BJ.$67(u);u--}}finally{i&&n.set_$bp(!1)}}function $4PX(n,t,i){switch(t.$3R){case 0:for(var r=t.$2t.length-1;r>=0;r--){var f=i+t.$4T;$1eB(n,f,t.$2t[r],!1)}break;case 2:for(var u=t.$3Y.length-1;u>=0;u--){var e=i+t.$4T;$4PY(n,e)}break;default:break}}function $1Bx(n){if(n.$qz){n.$1JS=!0;return!1}return!0}function $4PV(n,t){return!!n.$2YR[t.get_$2S6()]}function $6S6(n,t){n.$2YR[t.get_$2S6()]=t}function $6S7(n,t){delete n.$2YR[t.get_$2S6()]}function $4PW(n,t){for(var i=0;i<n.$g7.get_$F();i++)if(n.$g7.get_$48(i).get_$DQ()===t)return n.$g7.get_$48(i);return null}_d.$4K.prototype={$qz:!1,$1JS:!1,$g7:null,$hJ:null,$1nQ:!1,$j:null,$14h:0,$Jy:null,get_$SW:function(){return this.$j},get_$14d:function(){return 0},get_$1DO:function(){return 1},get_$1Q:function(){return"SchedulingDayViewModel"},get_$3Nz:function(){return 24},get_$4jr:function(){return this.$j.get_$2Zv()},get_$9GB:function(){return!0},$co:function(){this.$qz=!1;this.$j.$2ng=!1;if(this.$1JS){this.$14h++;this.$1wp();this.$g7.$1u();this.$hJ.$1u();$6S5(this)}},$Fe:function(){_a.$5.$1G(null,"SchedulingAssistant_SwitchToDayView")},$gC:function(){this.$qz=!0;this.$1JS=!1;this.$14h++},$Rx:function(){},$2he:function(n){return $21a(this,this.get_$8G(),n,0)},$59:function(){this.$w("GridSelectedRowColumnIndex",this.$$d_$5iB);this.$1nQ&&this.$w("GridHoveredRowColumnIndex",this.$$d_$5iA);this.$j.$Ln.remove_$1Z(this.$$d_$309);this.$j.$bP.remove_$1Z(this.$$d_$5jl);this.$j.$8x.rpcl("SelectedRoomViewModel",this.$$d_$1uh);this.$j.$Mo.remove_$2ia(this.$$d_$3yB);this.$Mu.dispose();_d.$1n.prototype.$59.call(this)},$76C:function(n,t){return _d.$If.$76B(n,t)},$3zC:function(n,t){if($1Bx(this)){this.set_$AB(this.$j.$Tt);this.$1wp();this.$14h++;for(var i=0;i<this.$g7.get_$F();i++)$3Fu(this,new _d.$4K.$3M0(this.$14h,this.$g7.get_$48(i).get_$DQ()))}},$3yB:function(n){if($1Bx(this))try{for(var t=0;t<n.get_$F();t++){var i=$4PW(this,n.get_$48(t));if(i){var r=new _d.$4K.$3M0(this.$14h,i.get_$DQ());if(!$4PV(this,r)){this.set_$bp(!0);$4PZ(this,i,!1);$3Fu(this,r)}}}}finally{this.set_$bp(!1)}},$309:function(n,t){$1Bx(this)&&$4PX(this,t,1)},$5jl:function(n,t){$1Bx(this)&&$4PX(this,t,this.$j.$Ln.get_$F()+1)},$1uh:function(n,t){if($1Bx(this)){if(this.$Jy){$4PY(this,this.$g7.get_$F()-1);this.$Jy=null}if(this.$j.$8x.get_$A1()){this.$Jy=this.$j.$8x.get_$A1();$1eB(this,this.$g7.get_$F(),_g.$3X.$rO(this.$Jy),!1)}}},$5iB:function(n,t){if($1Bx(this)&&this.$N8)if(this.get_$4jr()){var i=$2Th(this,this.get_$AB(),this.$N8.$Jm);this.$j.$9F.get_$5m()?this.$j.$9F.set_$10(new _a.$7(i.get_$4M(),i.get_$3D(),i.get_$5z(),this.$j.$9F.get_$10().get_$Ec(),this.$j.$9F.get_$10().get_$Gs(),this.$j.$9F.get_$10().get_$Te(),this.$j.$9F.get_$10().get_$18b())):this.$j.$9F.set_$10(i)}else this.$j.$1r.$3A(0,_u.Strings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$5iA:function(n,t){if($1Bx(this))if(this.$15k){var i=this.$2he(this.$15k);var r=new _h.$4S(i,i.$9b(this.$j.$9F.$3R1));this.$j.set_$5qB(r)}else this.$j.set_$1ym(!1)}};_d.$4K.$3M0=function(n,t){this.$14h=n;this.$9e=t;this.$68P=String.format("{0}@{1}",n,t)};_d.$4K.$3M0.prototype={$14h:0,$9e:null,$68P:null,get_$77r:function(){return this.$14h},get_$1h:function(){return this.$9e},get_$2S6:function(){return this.$68P}};_d.$5M=function(n,t,i,r){this.$$d_$1uh=Function.createDelegate(this,this.$1uh);this.$$d_$5kc=Function.createDelegate(this,this.$5kc);this.$$d_$8Sw=Function.createDelegate(this,this.$8Sw);this.$$d_$3xP=Function.createDelegate(this,this.$3xP);this.$$d_$8h1=Function.createDelegate(this,this.$8h1);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$4fo=Function.createDelegate(this,this.$4fo);_d.$5M.initializeBase(this);this.$j=t;this.$kp=new _C(this.$$d_$4fo,_d.$5M.$D);this.$Cv=new _C(this.$$d_$eC,_d.$5M.$D);this.$va=i;this.$1g0=new(_a.$3Y.$$(String));this.$3Kf=r;n.get_$O()==="TouchNarrow"&&this.set_$7E(_y.$26.$Bv(this,$6S9(this),null));this.$3Kf.$5F();this.$E2=new _0365m.$2c(new Array(0));this.$Jv=new _C(this.$$d_$8h1,_d.$5M.$D);this.$10S="OpenSchedulingAssistantForm"};function $6SC(n){n.$j.$72E();n.$va.$Ar();n.$1g0.$1u()}function $6S8(n){n.$va.$EH.add_$1Z(n.$$d_$3xP);n.$va.$EE.add_$1Z(n.$$d_$3xP);n.$j.$Mo.add_$3UR(n.$$d_$8Sw);n.$j.$9F.$a("CorrectedDateRange",n.$$d_$5kc);n.$j.$8x.apcl("SelectedRoomViewModel",n.$$d_$1uh)}function $6SB(n){n.$va.$EH.remove_$1Z(n.$$d_$3xP);n.$va.$EE.remove_$1Z(n.$$d_$3xP);n.$j.$Mo.remove_$3UR(n.$$d_$8Sw);n.$j.$9F.$w("CorrectedDateRange",n.$$d_$5kc);n.$j.$8x.rpcl("SelectedRoomViewModel",n.$$d_$1uh)}function $6SA(n){$1eC(n,n.$j.get_$1Rg());for(var t=0;t<n.$j.$Ln.get_$F();t++){var r=n.$j.$Ln.get_$48(t);$1eC(n,r.get_$6V())}for(var i=0;i<n.$j.$bP.get_$F();i++){var u=n.$j.$bP.get_$48(i);$1eC(n,u.get_$6V())}if(n.get_$1A8().get_$1Sv()){$1eC(n,n.get_$1A8().get_$A1());n.$Jy=n.get_$1A8().get_$A1()}}function $1eC(n,t){n.$1g0.$H(t.EmailAddress)}function $4Pb(n,t){n.$1g0.$3Q(t.EmailAddress)}function $3Fv(n,t){if(n.$j.get_$1Tz()){var i=n.$j.$9F.$lF;var r=n.$j.$Mo.$2AD(i.$2G,i.$2w,t,!1);n.$va.$4fn(r,n.$j.get_$3bt())}$2UO(n)}function $2UO(n){var t=n.$j.$9F.$lF;var i=n.$j.$Mo.$2AD(t.$2G,t.$2w,n.$1g0,!1);n.$va.$4fn(i,n.$j.get_$3bt())}function $4Pa(n){n.get_$3L().$BX()}function $6S9(n){var t=new Array(2);t[0]=new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItem_LowerCase_Text,n.$kp);t[1]=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,n.$Cv);return t}_d.$5M.prototype={$1g0:null,$j:null,$kp:null,$Cv:null,$3Kf:null,$va:null,$Jv:null,$E2:null,$Jy:null,$10S:null,get_$1A8:function(){return this.$j.$8x},get_$2fk:function(){return _js.$8.$c(this.$j.get_$2fk())?_u.Strings.l_DefaultEventSubject_Text:this.$j.get_$2fk()},get_$45y:function(){return this.$j.$9F},get_$Jr:function(){return 1},get_$5lp:function(){return this.$10S},set_$5lp:function(n){this.$10S!==n&&(this.$10S=n);return n},$co:function(){_y.$1De.prototype.$co.call(this);$6SC(this);$6S8(this);$6SA(this);$3Fv(this,this.$1g0)},$gC:function(){_y.$1De.prototype.$gC.call(this);$6SB(this)},$Fe:function(){_y.$1De.prototype.$Fe.call(this);_a.$5.$1G(null,this.$10S)},$5kc:function(n,t){$2UO(this)},$8Sw:function(n){$3Fv(this,n)},$3xP:function(n,t){if(t.$3R){if(t.$3R===2){var u=this;Array.forEach(t.$3Y,function(n){var t=n;$4Pb(u,t.get_$6V())});$2UO(this)}}else{var i=new(_a.$3Y.$$(String));var r=this;Array.forEach(t.$2t,function(n){var t=n;i.$H(t.get_$6V().EmailAddress);$1eC(r,t.get_$6V())});$3Fv(this,i)}},$4fo:function(){var n=_d.$1Cp.$1o.$GM.$63w(!1);this.$j.$4fr();this.$j.$4fq();$4Pa(this);_d.$1Cp.$1o.$GM.$28R(n,null,null,null)},$eC:function(){var n=_d.$1Cp.$1o.$GM.$63x(!1);$4Pa(this);_d.$1Cp.$1o.$GM.$28R(n,null,null,null)},$8h1:function(){this.$j.get_$2Zv()||this.$j.$1r.$3A(0,_u.Strings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$1uh:function(n,t){if(!$8(this.$Jy)){$4Pb(this,this.$Jy);this.$Jy=null}if(this.get_$1A8().get_$1Sv()){$1eC(this,this.get_$1A8().get_$A1());this.$Jy=this.get_$1A8().get_$A1()}$2UO(this)}};_d.$If=function(n){_d.$If.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$If.initializeBase(this);this.$5J=new _g.$1j(null);this.$2G=n.get_$10();this.$2w=n.get_$23();this.$hz=n.get_$92();this.$2LP=n.get_$2h();this.$4c=$8(n.get_$4h())?_g.$3G.$wE(""):n.get_$4h();if(_js.$8.$c(this.$2LP)){var t=new _d.$ft;this.$Vw=t.$39(this.$hz,null)}else this.$Vw=this.$2LP;n.get_$10()&&n.get_$23()&&(this.$1nn=n.get_$1UI())};_d.$If.$76B=function(n,t){var i=new _d.$If(n);i.$Fs=n.$Fs;var r=_d.$Jw.$50e(t,n);i.$2G=r.$2G;i.$2w=r.$2w;return i};_d.$If.prototype={$4c:null,$Vw:null,$hz:"Free",$2LP:null,$5J:null,$1nn:!1,$Fs:null,$2G:null,$2w:null,get_$i:function(){return this.$5J},get_$EB:function(){return!1},get_$9w:function(){return this.$2w.$6E(this.$2G)>=864e5},get_$1UI:function(){return this.$1nn},get_$5m:function(){return!1},get_$Ef:function(){return!1},get_$2Dl:function(){return!1},get_$2mG:function(){return!1},get_$bm:function(){return!1},get_$FL:function(){return!1},get_$2LL:function(){return""},get_$4h:function(){return this.$4c},get_$10:function(){return this.$2G},get_$23:function(){return this.$2w},get_$2h:function(){return this.$Vw},get_$92:function(){return this.$hz},get_$5Z:function(){return this.$Fs},set_$5Z:function(n){this.$Fs=n;return n},get_$iZ:function(){return""},get_$3jM:function(){return!1},get_$Ho:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingItemViewModel");},get_$b2:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingItemViewModel");}};_d.$o4=function(n,t,i){_d.$o4.initializeBase(this,[n,t,i]);this.$9u=!1};_d.$o4.prototype={$9u:!1,get_$7v:function(){return this.$9u},set_$7v:function(n){if(this.$9u!==n){this.$9u=n;$6(this,"IsBusy")}return n},get_$5tC:function(){return!this.$4U||!this.$4U.$12?String.format(_u.Strings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_u.Strings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$4U.$12.get_$1l())}};_d.$15y=function(n,t,i){this.$2G=n;this.$2w=t;this.$xy=i};_d.$15y.prototype={$2G:null,$2w:null,$xy:!1,get_$10:function(){return this.$2G},set_$10:function(n){this.$2G=n;return n},get_$23:function(){return this.$2w},set_$23:function(n){this.$2w=n;return n},get_$5m:function(){return this.$xy},set_$5m:function(n){this.$xy=n;return n}};_d.$6J=function(n,t,i,r,u,f){this.$$d_$587=Function.createDelegate(this,this.$587);this.$$d_$5i=Function.createDelegate(this,this.$5i);this.$$d_$2bE=Function.createDelegate(this,this.$2bE);this.$$d_$3zC=Function.createDelegate(this,this.$3zC);this.$$d_$94f=Function.createDelegate(this,this.$94f);this.$$d_$92i=Function.createDelegate(this,this.$92i);this.$$d_$8pU=Function.createDelegate(this,this.$8pU);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$4fo=Function.createDelegate(this,this.$4fo);this.$$d_$53A=Function.createDelegate(this,this.$53A);this.$$d_$539=Function.createDelegate(this,this.$539);_d.$6J.initializeBase(this);_a.$3.$M(t,"calendarContext");this.$j=n;this.$1c=t;this.$p=r;this.$2OE=new _d.$8R(n,t);this.$2OC=new _d.$4K(n,t);this.$14l=i;this.$2Ae=new _C(this.$$d_$539,_d.$6J.$D);this.$2Af=new _C(this.$$d_$53A,_d.$6J.$D);this.$kp=new _C(this.$$d_$4fo,_d.$6J.$D);this.$Cv=new _C(this.$$d_$eC,_d.$6J.$D);this.$43e=new _C(this.$$d_$8pU,_d.$6J.$D);this.$2Pr=new _C(this.$$d_$92i,_a.$0.$DT);this.$2QL=new _C(this.$$d_$94f,_a.$0.$DT);var o=this.$1c.$G;var e=o.get_$O();if(e==="Mouse"){this.$14l.$kp.set_$N5(this.$$d_$4fo);this.$14l.$Cv.set_$N5(this.$$d_$eC)}var s=new _0365m.$n(_u.Strings.l_Scheduling_Affordance_RefreshFreeBusy_Text,null,this.$43e);this.$14l.$E2.$1B.$H(s);if(e!=="Mouse"){this.set_$7E(_y.$26.$Bv(this,$6SF(this),$6SE(this)));e==="TouchWide"&&this.$3t.set_$3Ou($6SG(this))}var h=e==="Mouse"&&o.get_$6Q();this.$Xd=new _d.$NU(u,h);this.$AN=t.$t.get_$4r();this.$vh=new _js.$X;this.$vh.$H(this.$2OC);this.$vh.$H(this.$2OE);this.$Le=f;this.$Mh=new _js.$X;this.$Mh.$H(new _0365m.$n(_u.Strings.l_Day_LowerCase_Text,null,this.$2Pr));this.$Mh.$H(new _0365m.$n(_u.Strings.l_Week_LowerCase_Text,null,this.$2QL));this.$j.$a("ViewStartDate",this.$$d_$3zC);o.add_$U5(this.$$d_$2bE);this.$10S="OpenSchedulingAssistantForm"};_d.$6J.$73E=function(n,t,i,r){var u=new _d.$EY(n.$4x);u.set_$1hU(t);u.set_$2bF(i);u.set_$Lf(r);return u};function $6SK(n){n.$1c.$G.remove_$U5(n.$$d_$2bE)}function $4Pd(n,t){n.$AN.set_$461(t);_h.$2x.$H4(n.$AN.get_$Tq(),n.$p)}function $3Fx(n){n.$1Bf=!0;n.$9v||n.$1M();n.get_$3L().$BX()}function $6SF(n){var t=new Array(2);t[0]=new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItem_LowerCase_Text,n.$kp);t[1]=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,n.$Cv);return t}function $6SG(n){var t=[];Array.add(t,new _y.$2f(_y.$c.get_$1Qr(),_y.$c.get_$4qu(),_u.Strings.l_Day_LowerCase_Text,n.$2Pr));Array.add(t,new _y.$2f(_y.$c.get_$6BV(),_y.$c.get_$6BX(),_u.Strings.l_Week_LowerCase_Text,n.$2QL));return t}function $6SE(n){return[new _y.$2j(_u.Strings.l_Scheduling_Affordance_RefreshFreeBusy_Text,n.$43e)]}function $6SH(n,t,i){var r=new _js.$X;var u=this;r.$H(new _a.$2E(new _C(function(){var t=_d.$1Cp.$1o.$GM.$63x(n.get_$1o7());n.$w8.set_$Lf(!1);$3Fx(n);i&&i();_d.$1Cp.$1o.$GM.$28R(t,null,null,null)},_a.$0.$DT),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$1c.$G.get_$O()==="Mouse"&&t){var f=this;r.$H(new _a.$2E(new _C(function(){n.$w8.set_$Lf(!1);n.$5i();i&&i()},_a.$0.$DT),_u.Strings.l_ConfirmDialog_Popout_Text,_u.Strings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var e=this;r.$H(new _a.$2E(new _C(function(){n.$w8.set_$Lf(!1);n.$1Bf=!1},_a.$0.$DT),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToEventForFurtherEditing_Text));return r}function $4Pe(n,t,i){n.set_$712(_d.$6J.$73E(n.$j.$l,_u.Strings.l_Calendar_Scheduling_LeaveSchedulingFormDialog_Title_Text,$6SH(n,t===1,i),!0))}function $6SJ(n){return(!n.$w8||!n.$w8.$1Do)&&!n.$1Bf&&$6SI(n)}function $6SI(n){return n.get_$G7()||n.$j.$l.get_$1mm()}function $6SD(n){n.$9v||n.$1M()}_d.$6J.prototype={$2OE:null,$2OC:null,$p:null,$14l:null,$j:null,$1c:null,$kp:null,$Cv:null,$43e:null,$2Ae:null,$2Af:null,$AN:null,$Xd:null,$Le:null,$vh:null,$Mh:null,$2QL:null,$2Pr:null,$aW:0,$w8:null,$1Bf:!1,$10S:null,get_$4tL:function(){var n=this.$j.$Tt;switch(this.$aW){case 1:return n.$2P(3);case 3:var t=_a.$7.$Kn(n);var i=t.$2q(6);return _a.$7.$2AA(t,i);default:return""}},get_$Jr:function(){return this.$1c.$G.get_$O()!=="Mouse"?1:0},get_$5lp:function(){return this.$10S},set_$5lp:function(n){this.$10S!==n&&(this.$10S=n);return n},get_$19W:function(){return new _C(this.$$d_$5i,_a.$0.$DT)},get_$aI:function(){return this.$Xd.get_$aI()},get_$427:function(){return 1},get_$2Ao:function(){return this.$$d_$587},get_$1ce:function(){return this.$aW},set_$1ce:function(n){if(this.$aW!==n){this.$aW=n;$4Z(this,"TimeStripMode","DisplayedDateString")}return n},get_$712:function(){return this.$w8},set_$712:function(n){if(this.$w8!==n){this.$w8=n;$6(this,"ConfirmationDialog")}return n},get_$G7:function(){return!this.$1Bf&&this.$j.get_$1mm()},get_$1o7:function(){return this.$1c.$G.get_$O()==="Mouse"&&!this.get_$aI()},$co:function(){_y.$1De.prototype.$co.call(this);this.$14l.$co();if(this.$AN.get_$461()===1){this.set_$1ce(1);this.$Le.$MZ(this.$2OC);this.$Mh.get_$48(0).set_$2X(!0)}else{this.set_$1ce(3);this.$Le.$MZ(this.$2OE);this.$Mh.get_$48(1).set_$2X(!0)}},$gC:function(){_y.$1De.prototype.$gC.call(this);this.$14l.$gC()},$Fe:function(){_y.$1De.prototype.$Fe.call(this);_a.$5.$1G(null,this.$10S)},$587:function(n,t){var i=!0;var r=!i;if($6SJ(this)){$4Pe(this,t,n);return i}$6SD(this);return r},$59:function(){$6SK(this);this.$2OC.$1M();this.$2OE.$1M();_a.$1.prototype.$59.call(this)},$2bE:function(n){this.get_$G7()&&_js.$8.$c(n.$19h)&&n.$1OY(_u.Strings.l_Calendar_BrowserWindowUnloadWarning_Text)},$4fo:function(){var n=_d.$1Cp.$1o.$GM.$63w(this.get_$1o7());this.$j.$4fr();this.$j.$4fq();$3Fx(this);_d.$1Cp.$1o.$GM.$28R(n,null,null,null)},$eC:function(){this.get_$G7()?$4Pe(this,2,null):$3Fx(this)},$539:function(){this.$aW===1?this.$j.set_$pc(this.$j.$Tt.$2q(1)):this.$j.set_$pc(this.$j.$Tt.$2q(7))},$53A:function(){this.$aW===1?this.$j.set_$pc(this.$j.$Tt.$2q(-1)):this.$j.set_$pc(this.$j.$Tt.$2q(-7))},$8pU:function(){this.$j.$Mo.$gI()},$92i:function(){if(this.$aW!==1){_a.$5.$1V(_a.$0.$DT,"SchedulingAssistant_SwitchToDayView");this.set_$1ce(1);this.$Le.$MZ(this.$2OC);$4Pd(this,1);$6(this,"DisplayedDateString");this.$Mh.get_$48(0).set_$2X(!0);this.$Mh.get_$48(1).set_$2X(!1)}},$94f:function(){if(this.$aW!==3){_a.$5.$1V(_a.$0.$DT,"SchedulingAssistant_SwitchToWeekView");this.set_$1ce(3);this.$Le.$MZ(this.$2OE);$4Pd(this,2);$6(this,"DisplayedDateString");this.$Mh.get_$48(0).set_$2X(!1);this.$Mh.get_$48(1).set_$2X(!0)}},$3zC:function(n,t){$6(this,"DisplayedDateString")},$5i:function(){var n=_d.$1Cp.$1o.$GM.$96K();this.$1Bf=!0;this.$Xd.get_$19W().$s();_d.$1Cp.$1o.$GM.$28R(n,null,null,null)}};_d.$PK=function(n,t,i,r,u,f,e,o){this.$Ys=n;this.$4eR=f;this.$p=e;this.$3C5=r;this.$1x1=u;this.$Ti=t;this.$t=i;this.$5w=o};function $6SM(n,t,i,r){return new _d.$5M(n.$Ti,t,i,r)}function $6SL(n,t){var i=_c.$i.$E5(t.get_$1Rg());var r=n.$11J.$2bo(i,_y.$q.$Hr,!0,3);return new _d.$o4(r,1,!0)}_d.$PK.prototype={$Ti:null,$t:null,$Ys:null,$3C5:null,$1x1:null,$4eR:null,$p:null,$5w:null,$11J:null,$3CP:null,$I:function(n,t,i,r,u,f){_a.$3.$17(this.$3CP,"RecipientWellViewModelFactory");var s=_c.$1S.$4oL(!0);var p=new _c.$Js(new _js.$X,null,s,null,this.$5w);var c=new _d.$HB(null,p,s,null,this.$Ti,this.$t,null,null);var w=this.$7IS();var o=this.$3C5.$I(n,s);var l=this.$1x1.$4oI(n,o);var a=this.$1x1.$I(n,o,l);var e=new _d.$6B(new _d.$vF("SchedulingContextViewModel"),n,t,o,a,w,new _y.$4p,!r,u);o.set_$5wT(e);var h=new _g.$9b;h.set_$mU(!0);h.set_$DQ(e.get_$1Rg().EmailAddress);c.set_$14L(h);var b=this.$72Y(a,l,o);var k=new _d.$7K(e.$Ln.get_$9JV(),e.$bP.get_$9JV(),$6SL(this,e),e.$8x,_u.Strings.l_AddAttendeeWatermark_Text,this.$73v(),this.$3CP,this.$11J,u);var v=$6SM(this,e,k,b);v.set_$5lp(f);var y=new _d.$6J(e,c,v,this.$p,i,new _y.$F8);y.set_$5lp(f);return y},$72Y:function(n,t,i){return this.$4eR.$I(n,t,i)},$7IS:function(){return 1},$73v:function(){var n=this.$Ys.$I(_c.$14.$rT,_c.$14.$bV(),!0,"PersonaDetailedView",!1,this.$11J);_d.$CO.$1QB(n);return n}};_d.$8R=function(n,t){this.$$d_$5iA=Function.createDelegate(this,this.$5iA);this.$$d_$5iB=Function.createDelegate(this,this.$5iB);this.$$d_$3yB=Function.createDelegate(this,this.$3yB);this.$$d_$1uh=Function.createDelegate(this,this.$1uh);this.$$d_$309=Function.createDelegate(this,this.$309);this.$$d_$3zC=Function.createDelegate(this,this.$3zC);_d.$8R.resolveInheritance();this.dispose=this.$1M;_d.$8R.initializeBase(this,[n.$9F.get_$10(),null,null,null,null,t,null]);_a.$3.$M(t,"calendarContext");this.$j=n;this.$1Dp=new(_a.$3Y.$$(String));this.$4mc=new _d.$Ie(this.$j);this.$1nQ=this.$1c.$G.get_$O()==="Mouse";this.$1JS=!0;this.$2cz=!0;this.$j.$a("ViewStartDate",this.$$d_$3zC);this.$j.$Ln.add_$1Z(this.$$d_$309);this.$j.$8x.apcl("SelectedRoomViewModel",this.$$d_$1uh);this.$j.$Mo.add_$2ia(this.$$d_$3yB);this.$a("GridSelectedRowColumnIndex",this.$$d_$5iB);this.$1nQ&&this.$a("GridHoveredRowColumnIndex",this.$$d_$5iA)};function $4Pg(n){if(n.$j.$8x.get_$A1()){n.$Jy=n.$j.$8x.get_$A1();n.$1Dp.$H(n.$Jy.EmailAddress)}}function $6SN(n){n.set_$AB(n.$j.$Tt);$4Pf(n);n.$1Dp.$1u();for(var t=0;t<n.$j.$Ln.get_$F();t++)n.$1Dp.$H(n.$j.$Ln.get_$48(t).get_$6V().EmailAddress);$4Pg(n)}function $21o(n){_js.Trace.logInfo(_a.$0.$DT,"WeekView PopulatingItemCollection WeekViewModel");n.$1wp();var i=n.$j.$Mo.$7Iv(n.$j.get_$1Rg().EmailAddress,n.$1Dp);try{n.set_$bp(!0);for(var t=0;t<i.get_$F();t++){var r=i.get_$48(t);n.$H0(r)}}finally{n.set_$bp(!1)}}function $4Pf(n){var t=_a.$7.$Kn(n.$j.$Tt.$3u());var i=t.$2q(7);n.$1EA=new _h.$4S(t,i)}function $1eD(n){if(n.$2cz){n.$1JS=!0;return!1}return!0}_d.$8R.prototype={$1Dp:null,$j:null,$1nQ:!1,$4mc:null,$Jy:null,$2cz:!1,$1JS:!1,$1EA:null,get_$SW:function(){return this.$j},get_$1Q:function(){return"SchedulingWeekViewModel"},get_$3Nz:function(){return 24},get_$4jr:function(){return this.$j.get_$2Zv()},get_$AB:function(){return _d.$1n.prototype.get_$AB.call(this)},set_$AB:function(n){_a.$7.$4F(_a.$7.$Kn(this.get_$AB()).$3u(),_a.$7.$Kn(n).$3u())||_d.$1n.prototype.set_$AB.call(this,n);return n},$co:function(){this.$2cz=!1;this.$j.$2ng=!0;if(this.$1JS){$6SN(this);$21o(this)}},$Fe:function(){_a.$5.$1G(null,"SchedulingAssistant_SwitchToWeekView")},$gC:function(){this.$2cz=!0;this.$1JS=!1},$Rx:function(){},$59:function(){this.$Mu.dispose();this.$j.$w("ViewStartDate",this.$$d_$3zC);this.$j.$Ln.remove_$1Z(this.$$d_$309);this.$j.$8x.rpcl("SelectedRoomViewModel",this.$$d_$1uh);this.$j.$Mo.remove_$2ia(this.$$d_$3yB);this.$w("GridSelectedRowColumnIndex",this.$$d_$5iB);this.$1nQ&&this.$w("GridHoveredRowColumnIndex",this.$$d_$5iA);_d.$1n.prototype.$59.call(this)},$3KT:function(n){throw Error.notImplemented();},$H0:function(n){this.$o.$H(n)},$3yB:function(n){$1eD(this)&&$21o(this)},$309:function(n,t){if($1eD(this)){switch(t.$3R){case 0:for(var i=t.$2t.length-1;i>=0;i--)this.$1Dp.$H(t.$2t[i].get_$6V().EmailAddress);break;case 2:for(var r=t.$3Y.length-1;r>=0;r--)this.$1Dp.$3Q(t.$3Y[r].get_$6V().EmailAddress);break;default:break}$21o(this)}},$3zC:function(n,t){if($1eD(this)){this.set_$AB(this.$j.$Tt);if(this.$1EA.$hX(this.$j.$Tt,!0,!1))_js.Trace.logInfo(_a.$0.$DT,"Ignoring ViewStart :{0} because it is within the current date range:{1}",this.$j.$Tt,this.$1EA);else{$4Pf(this);$21o(this)}}},$5iB:function(n,t){if($1eD(this)&&this.$N8)if(this.get_$4jr()){var i=$21Z(this,this.$N8.$Jm);this.$j.$9F.get_$5m()?this.$j.$9F.set_$10(new _a.$7(i.get_$4M(),i.get_$3D(),i.get_$5z(),this.$j.$9F.get_$10().get_$Ec(),this.$j.$9F.get_$10().get_$Gs(),this.$j.$9F.get_$10().get_$Te(),this.$j.$9F.get_$10().get_$18b())):this.$j.$9F.set_$10(i)}else this.$j.$1r.$3A(0,_u.Strings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$5iA:function(n,t){if($1eD(this))if(this.$15k){var i=$21Z(this,this.$15k);var r=new _h.$4S(i,i.$9b(this.$j.$9F.$3R1));this.$j.set_$5qB(r)}else this.$j.set_$1ym(!1)},$1uh:function(n,t){if($1eD(this)){if(this.$Jy){this.$1Dp.$3Q(this.$Jy.EmailAddress);this.$Jy=null}$4Pg(this);$21o(this)}}};_d.$Dw=function(n,t,i,r,u,f){_d.$Dw.initializeBase(this);this.$xJ=t;this.$9e=n;this.$54h=r;this.$MP=u;this.$lY=i;this.$qf=f;this.$25x=$6Sz(this)};_d.$Dw.$4zW=function(n){var t=new _js.$X;var i=n;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.get_$7v()&&t.$H(u.value)}return t};_d.$Dw.$3RG=function(n,t){var i=t?_u.Strings.l_ZeroNewConflicts_Text:_u.Strings.l_ZeroConflicts_Text;var r=t?_u.Strings.l_OneNewConflict_Text:_u.Strings.l_OneConflict_Text;var u=t?_u.Strings.l_ManyNewConflicts_Text:_u.Strings.l_ManyConflicts_Text;switch(n){case 0:return i;case 1:return r;default:return String.format(u,n)}};_d.$Dw.$4pR=function(n){return String.format(_a.$8N.$52G(n,_u.Strings.l_TotalRequiredAttandees_Singular_Upper_Case_Text,_u.Strings.l_TotalRequiredAttandees_FirstPlural_Upper_Case_Text,_u.Strings.l_TotalRequiredAttandees_SecondGenitivePlural_Upper_Case_Text),n)};_d.$Dw.$76X=function(n){return String.format(_a.$8N.$52G(n,_u.Strings.l_TotalOptionalAttandees_Singular_Upper_Case_Text,_u.Strings.l_TotalOptionalAttandees_FirstPlural_Upper_Case_Text,_u.Strings.l_TotalOptionalAttandees_SecondGenitivePlural_Upper_Case_Text),n)};function $6Sz(n){var t="";if(n.get_$7v()&&!$8(n.$qf)){var i=n.$qf.get_$F();if(i>1)t=String.format(_u.Strings.l_ConflictStatus_Text,i);else if(i===1){var r=n.$qf.get_$48(0);$8(r)||_js.$8.$c(r.$2LP)||(t=r.$2LP)}}return t}_d.$Dw.prototype={$xJ:"Free",$9e:null,$lY:null,$25x:null,$54h:!1,$MP:"NoError",$qf:null,$6m:null,get_$7v:function(){return this.$54h?!1:_d.$3i.$7v(this.$xJ)}};_d.$DU=function(n,t,i,r){this.$$d_$5xZ=Function.createDelegate(this,this.$5xZ);this.$$d_$7Eo=Function.createDelegate(this,this.$7Eo);_d.$DU.initializeBase(this);this.$Mo=n;this.$8x=t;this.$2gI=i;this.$G=r;this.$pq=!1;this.$3Ke="AddRoom_SchedulingAssistant";this.$293=new _C(this.$$d_$7Eo,_d.$DU.$D);this.$293.set_$5P(!1);$3EO(this)};function $4LE(n){n.$8x.apcl("SelectedRoomViewModel",n.$$d_$5xZ)}function $4LF(n){n.$8x.rpcl("SelectedRoomViewModel",n.$$d_$5xZ)}function $3EO(n){n.set_$7Ep(n.$8x.get_$1Sv()?_u.Strings.l_ChangeRoomButton_Text:_u.Strings.l_FindRoomButton_Text)}_d.$DU.prototype={$8x:null,$Mo:null,$pq:!1,$G:null,$293:null,$2gI:null,$2gH:null,$3Ke:null,get_$7Ep:function(){return this.$2gH},set_$7Ep:function(n){if(this.$2gH!==n){this.$2gH=n;$4Z(this,"FindARoomButtonLabel","HideFindARoomControl")}return n},get_$7TR:function(){return this.$G.get_$O()==="TouchNarrow"&&this.$8x.get_$1Sv()},$5F:function(){if(!this.$pq){this.$5sI();this.$pq=!0;this.$293.set_$5P(!0)}},$6e:function(){if(this.$pq){this.$4Ev();this.$pq=!1;this.$293.set_$5P(!1)}},$59:function(){this.$4Ev();_a.$1.prototype.$59.call(this)},$5sI:function(){$4LE(this)},$4Ev:function(){$4LF(this)},$5xZ:function(n,t){$3EO(this)},$7Eo:function(){_a.$5.$1V(_a.$0.$DT,this.$3Ke);this.$G.get_$O()==="TouchNarrow"?this.$G.$hu(this.$2gI,0,!1):this.$2gI.set_$1Kc(!0)}};_d.$eT=function(n,t){this.$294=n;this.$G=t};_d.$eT.prototype={$294:null,$G:null,$I:function(n,t,i){var r=this.$294.$74B(n,t);return new _d.$DU(i,n,r,this.$G)}};_d.$EX=function(n,t){this.$$d_$BA=Function.createDelegate(this,this.$BA);this.$$d_$8ou=Function.createDelegate(this,this.$8ou);_d.$EX.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$EX.initializeBase(this);this.$1j=n;this.$5b=t;this.$5T=new Sys.EventHandlerList;this.set_$37r(!0);this.$a("IsDataLoaded",this.$$d_$8ou);this.$a("HasErrorOccurred",this.$$d_$8ou);this.$1ab=new _C(this.$$d_$BA,_a.$0.$DT)};function $12v(n,t){var i=n.$5T.getHandler("StepCompleted");$8(i)||i(t)}_d.$EX.prototype={$5b:null,$5T:null,$1ab:null,$1j:null,$CJ:!1,$ez:!1,$15r:!1,$1Ag:!1,$1cm:0,add_$d7:function(n){this.$5T.addHandler("StepCompleted",n)},remove_$d7:function(n){this.$5T.removeHandler("StepCompleted",n)},get_$1Q:function(){return this.$1j},get_$G5:function(){return this.$CJ},set_$G5:function(n){if(this.$CJ!==n){this.$CJ=n;$6(this,"IsActive")}return n},get_$1Tn:function(){return this.$ez},set_$1Tn:function(n){if(this.$ez!==n){this.$ez=n;$4Z(this,"IsDataLoaded","HasNoRoomsFound")}return n},get_$3c1:function(){return this.$ez&&!this.$1cm},get_$37r:function(){return this.$1Ag},set_$37r:function(n){if(this.$1Ag!==n){this.$1Ag=n;$6(this,"ShowLoadingMessage")}return n},get_$xb:function(){return this.$15r},set_$xb:function(n){if(this.$15r!==n){this.$15r=n;$6(this,"HasErrorOccurred")}return n},get_$66x:function(){return this.$1cm},set_$66x:function(n){if(this.$1cm!==n){this.$1cm=n;$4Z(this,"TotalNumberOfItems","HasNoRoomsFound")}return n},$7Cq:function(){this.$2zc();this.set_$G5(!0)},$7E7:function(){this.$5hV();this.set_$G5(!1)},$8ou:function(n,t){this.set_$37r(!this.$ez&&!this.$15r)},$BA:function(){this.$5hV();this.$2zc()}};_d.$FB=function(n,t,i,r){this.$$d_$5uS=Function.createDelegate(this,this.$5uS);this.$$d_$8gM=Function.createDelegate(this,this.$8gM);this.$$d_$5H=Function.createDelegate(this,this.$5H);_d.$FB.initializeBase(this);this.$39F={};this.$39F[n.get_$1Q()]=n;this.$39F[t.get_$1Q()]=t;this.$91=n;this.$G=i;this.$a0=!1;this.$3Xh=r||"AddRoom_SchedulingAssistant";if(this.$G.get_$O()==="TouchNarrow"){var u=[new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,new _C(this.$$d_$5H,_a.$0.$DT))];this.set_$7E(_y.$26.$Bv(this,u,null))}};function $6NO(n,t){$8(n.$91)||$3F2(n);n.set_$3Sw(t);$3F1(n)}function $3F1(n){n.$91.add_$d7(n.$$d_$8gM);n.$91.add_$8C(n.$$d_$5uS);n.$91.$7Cq();n.$5uS(n,null);_a.$5.$1G(null,n.$3Xh)}function $3F2(n){n.$91.remove_$d7(n.$$d_$8gM);n.$91.remove_$8C(n.$$d_$5uS);n.$91.$7E7()}_d.$FB.prototype={$G:null,$39F:null,$91:null,$jk:null,$a0:!1,$3Xh:null,get_$1Kc:function(){return this.$a0},set_$1Kc:function(n){if(this.$a0===n)return n;this.$a0=n;$6(this,"PopupVisible");this.$a0?$3F1(this):$3F2(this);return n},get_$3Sw:function(){return this.$91},set_$3Sw:function(n){if(this.$91!==n){this.$91=n;$6(this,"CurrentStep")}return n},get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?1:0},$co:function(){_y.$1De.prototype.$co.call(this);$3F1(this)},$gC:function(){$3F2(this);_y.$1De.prototype.$gC.call(this)},$Fe:function(){_y.$1De.prototype.$Fe.call(this);_a.$5.$1G(null,this.$3Xh)},$5H:function(){this.get_$3L().$BX()},$8gM:function(n){if(_js.$8.$c(n)){this.$G.get_$O()==="TouchNarrow"?this.$5H():this.set_$1Kc(!1);return}var t=this.$39F[n];$6NO(this,t)},$5uS:function(n,t){_a.$3.$17(this.$jk,"ResizeCommand cannot be null.");this.$jk.$s()}};_d.$Mj=function(n,t,i){this.$p=n;this.$AN=t;this.$G=i};function $4NJ(n,t){var i=this;return new _d.$Ni(n.$p,n.$AN,t,function(){return new _c.$10a})}_d.$Mj.prototype={$p:null,$AN:null,$G:null,$74B:function(n,t){var i=$4NJ(this,n);var r=new _d.$Kl(n,t);return new _d.$FB(i,r,this.$G,"AddRoom_SchedulingAssistant")},$746:function(n,t){var i=$4NJ(this,n);var r=new _d.$16B(n,t);return new _d.$FB(i,r,this.$G,"AddRoom_ComposeForm")}};_d.$H0=function(n,t,i){this.$$d_$2Ol=Function.createDelegate(this,this.$2Ol);this.$$d_$8qY=Function.createDelegate(this,this.$8qY);this.$$d_$5kg=Function.createDelegate(this,this.$5kg);this.$$d_$3yx=Function.createDelegate(this,this.$3yx);this.$$d_$1uR=Function.createDelegate(this,this.$1uR);_d.$H0.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$H0.initializeBase(this);this.$2p=n;this.$2p.add_$2ck(this.$$d_$1uR);this.$DU=t;this.$a("SelectedDateRange",this.$$d_$3yx);this.$a("selectedRoomEmailAddress",this.$$d_$5kg);this.$44G=new _C(this.$$d_$8qY,_a.$0.$1o);var r=this;this.$3wL=new _C(this.$$d_$2Ol,_a.$0.$1o,this,"CanSelectNextAvailableRoom",function(){return r.get_$1PW()});this.$1Jg=new _g.$1m;this.$1Jg.Name=_u.Strings.l_GenericRoomListName_Text;this.$1Jg.EmailAddress="@noRoomListsAvailableMailbox";this.$8W=new _0365m.$2c([]);$4PS(this);this.set_$A1(i)};function $4PS(n){n.$8W.$1B.$1u();n.$8W.$1B.$H(new _0365m.$n(_u.Strings.l_RemoveRoom_LowerCase_Text,null,n.$44G));n.get_$1PW()&&n.$8W.$1B.$H(new _0365m.$n(_u.Strings.l_NextAvailableRoom_LowerCase_Text,null,n.$3wL))}function $3Fs(n,t){$6Rt(n,t);$6Rs(n,t);$6(n,"CanSelectNextAvailableRoom")}function $6Rs(n,t){if(n.get_$1PW()){var r=t.get_$7v()?0:1;var i=n.$2p.get_$lo().get_$F()-r;i?i===1?t.set_$46x(_u.Strings.l_OneAvailableRoom_Text):t.set_$46x(String.format(_u.Strings.l_ManyAvailableRooms_Text,i)):t.set_$46x("")}}function $6Rt(n,t){n.$1Jh?t.set_$4yE(new _d.$Dw(n.$Vn.EmailAddress,"Busy",_u.Strings.l_NoRoomsAvailable_Text,!1,"NoError",null)):t.set_$4yE(n.$2p.$7KR(n.$Vn,n.$DU))}_d.$H0.prototype={$2p:null,$8W:null,$44G:null,$3wL:null,$1Jg:null,$1Ll:null,$3c4:!1,$1fR:!1,$Vn:null,$DU:null,$ou:null,$1Jh:!1,get_$1PW:function(){if(!this.$2p.get_$1Tz()||!this.$1fR||!this.$2p.get_$1Tn())return!1;var n=this.get_$1Sv()&&!this.$ou.get_$7v()?1:0;return this.$2p.get_$lo().get_$F()-n>0},get_$4n1:function(){return this.$8W},get_$1Sv:function(){return!$8(this.$ou)&&!this.$1Jh},get_$1OT:function(){return this.$1fR},set_$1OT:function(n){if(this.$1fR===n)return n;this.$1fR=n;$6(this,"CanSelectNextAvailableRoom");this.$1Jh=!1;if(this.$1fR){this.$ou=null;if(this.get_$1PW())this.$2Ol();else{this.$1Jh=!0;this.set_$A1(this.$1Ll||this.$1Jg);this.$2p.get_$2Yo().set_$1xa(this.$Vn)}}else this.$2p.get_$2Yo().set_$1xa(null);return n},get_$Fk:function(){return this.$1Ll},set_$Fk:function(n){if(this.$1Ll!==n||!n&&!this.$3c4){this.$3c4=!0;this.$1Ll=n;this.set_$1OT(!1);$6(this,"selectedRoomListEmailAddress")}return n},get_$A1:function(){return this.$Vn},set_$A1:function(n){if(this.$Vn!==n){this.$Vn=n;$6(this,"selectedRoomEmailAddress")}return n},get_$aD:function(){return this.$DU},set_$aD:function(n){if(this.$DU!==n){this.$DU=n;$6(this,"SelectedDateRange")}return n},get_$363:function(){return this.$ou},set_$363:function(n){if(this.$ou!==n){this.$ou=n;$6(this,"SelectedRoomViewModel")}return n},get_$8Q2:function(){return this.$1Jg},get_$8w2:function(){return!!this.$Vn&&(_g.$2I.$4W(this.$Vn,this.$1Ll)||_g.$2I.$4W(this.$Vn,this.$1Jg))},$3ZU:function(n){var t=new(_a.$3Y.$$(String));if(this.$Vn){t.$H(this.$Vn.EmailAddress);n=!0}if(this.$2p.get_$1Tz()&&n)for(var r=this.$2p.get_$8tf(),i=0;i<r.get_$F();i++)t.$H(r.get_$48(i));return t},$5kg:function(n,t){if($8(this.$Vn)){this.set_$363(null);this.set_$1OT(!1)}else{var i=new _d.$uO(this.$Vn,this.$3wL,this.$44G);i.set_$37r(!this.$2p.get_$1Tn());$3Fs(this,i);this.set_$363(i);$4PS(this)}},$3yx:function(n,t){this.$3c4&&this.$2p.$51r(this.$1Ll,this.$DU);this.get_$1Sv()&&$3Fs(this,this.$ou);if(this.$1fR&&(this.$ou.get_$7v()||this.$1Jh))if(this.get_$1PW()){this.$1Jh=!1;this.$2Ol();$6(this,"CanSelectNextAvailableRoom")}else{this.$1Jh=!0;this.set_$A1(this.$1Ll||this.$1Jg);this.$2p.get_$2Yo().set_$1xa(this.$Vn)}},$1uR:function(){if(this.get_$1PW()&&(_g.$2I.$4W(this.$Vn,this.$1Ll)||_g.$2I.$4W(this.$Vn,this.$1Jg))){this.$1Jh=!1;this.$2Ol()}else if(this.$ou){this.$ou.set_$37r(!this.$2p.get_$1Tn());$3Fs(this,this.$ou);this.$ou.get_$7v()&&this.get_$1PW()&&this.$2Ol()}},$8qY:function(){this.set_$A1(null)},$2Ol:function(){var n=this.$2p.$3Zj(this.$Vn);var t=this.$2p.get_$lo();n=(n+1+t.get_$F())%t.get_$F();this.set_$A1(t.get_$48(n).$9e);this.$2p.get_$2Yo().set_$1xa(this.$Vn)}};_d.$hv=function(n,t){_d.$hv.initializeBase(this);this.$9e=n;if(t)switch(t.$xJ){case"Free":this.$lY=_u.Strings.l_FreeRoom_Text;break;case"NoData":this.$lY=_u.Strings.l_NoDataRoom_Text;break;case"Tentative":this.$lY=_u.Strings.l_TentativeRoom_Text;break;case"WorkingElsewhere":this.$lY=_u.Strings.l_WorkingElsewhereRoom_Text;break;case"OOF":this.$lY=_u.Strings.l_AwayRoom_Text;break;default:this.$lY=_u.Strings.l_BusyRoom_Text;break}else this.$lY=""};_d.$hv.prototype={$9e:null,$lY:null};_d.$Ds=function(n,t,i,r,u){this.$$d_$8XX=Function.createDelegate(this,this.$8XX);this.$$d_$8Xa=Function.createDelegate(this,this.$8Xa);this.$$d_$8Xb=Function.createDelegate(this,this.$8Xb);this.$$d_$8VB=Function.createDelegate(this,this.$8VB);_d.$Ds.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$Ds.initializeBase(this);this.$p=n;this.$1NG=t;this.$1NG.add_$3UR(this.$$d_$8VB);this.$51s=i;this.$1gX=new _js.$X;this.$1kX=new _js.$X;this.$uL=new(_a.$3Y.$$(String));this.$2X6={};this.$DU=r;this.$4yG=new _d.$ft;this.$5T=new Sys.EventHandlerList;this.$2mW=u};_d.$Ds.$51p=function(n,t){if(!t)return-1;var i=n.$DK(function(n){var i=n;return _g.$2I.$4W(t,i.$9e)});return i===n.get_$F()?-1:i};function $6Rv(n,t,i){return!t&&!i?!0:i?_g.$2I.$4W(i,t):!1}function $3Ft(n){var t=null;if(n.$2mW&&n.$uL.get_$F())if(n.$1NG.$7SG(n.$DU.$2G,n.$DU.$2w,n.$uL,!0)){t=n.$1NG.$2AD(n.$DU.$2G,n.$DU.$2w,n.$uL,!1);$4PT(n,t)}else n.$ez=!1;else{t={};$4PT(n,t)}}function $4PT(n,t){n.$1kX.$1u();n.$1gX.$1u();for(var u=[],f=[],i=0;i<n.$uL.get_$F();i++){var r=t[n.$uL.get_$48(i)];var e=n.$2X6[n.$uL.get_$48(i)];r&&r.$xJ!=="Free"?Array.add(u,new _d.$hv(e,r)):Array.add(f,new _d.$hv(e,r))}n.$1gX.$6G(u);n.$1kX.$6G(f);$6Ru(n)}function $6Ru(n){_js.Trace.logInfo(_a.$0.$DT,"Firing Room Data Loaded {0}",n.$uL.toString());n.$ez=!0;var t=n.$5T.getHandler("DataLoaded");$8(t)||t()}_d.$Ds.prototype={$p:null,$1NG:null,$51s:null,$1gX:null,$1kX:null,$uL:null,$4yG:null,$5T:null,$2mW:!1,$2X6:null,$DU:null,$15r:!1,$54f:!1,$4q6:null,$Jy:null,$ez:!1,$e3:null,add_$2ck:function(n){this.$5T.addHandler("DataLoaded",n)},remove_$2ck:function(n){this.$5T.removeHandler("DataLoaded",n)},get_$1Tn:function(){return this.$ez},get_$lo:function(){return this.$1kX},get_$1PG:function(){return this.$1gX},get_$1Tz:function(){return this.$2mW},get_$8tf:function(){return this.$uL},get_$xb:function(){return this.$15r},set_$xb:function(n){if(this.$15r!==n){this.$15r=n;$6(this,"HasErrorOccurred")}return n},get_$2Yo:function(){return this.$1NG},get_$4pm:function(){return this.$e3},set_$4pm:function(n){if(this.$e3){this.$e3.remove_$2A(this.$$d_$8Xb);this.$e3.remove_$20(this.$$d_$8Xa);this.$e3.remove_$2m(this.$$d_$8XX)}this.$e3=n;if(this.$e3){this.$e3.add_$2A(this.$$d_$8Xb);this.$e3.add_$20(this.$$d_$8Xa);this.$e3.add_$2m(this.$$d_$8XX)}return n},$7KR:function(n,t){($8(this.$Jy)||!_g.$2I.$4W(this.$Jy,n))&&(this.$Jy=n);var i;if(this.$2mW){var r=new(_a.$3Y.$$(String));r.$H(n.EmailAddress);this.$DU=t;i=this.$1NG.$2AD(this.$DU.$2G,this.$DU.$2w,r,!1)}else i={};return i[n.EmailAddress]||new _d.$Dw(n.EmailAddress,"NoData",this.$4yG.$39("NoData",null),!1,"NoError",new(_a.$3Y.$$(_d.$If)))},$51r:function(n,t){this.$ez=!1;this.set_$xb(!1);this.$DU=t;if(this.$54f&&$6Rv(this,this.$4q6,n))$3Ft(this);else{this.$54f=!0;this.$4q6=n;this.$1gX.$1u();this.$1kX.$1u();this.$uL.$1u();this.$2X6={};this.set_$4pm(this.$51s());this.$e3.$2Nt=n;this.$p.$y(this.$e3)}},$3Zj:function(n){return _d.$Ds.$51p(this.$1kX,n)},$4zJ:function(n){return _d.$Ds.$51p(this.$1gX,n)},$8Xa:function(n){this.set_$xb(!0)},$8XX:function(n){this.set_$4pm(null)},$8Xb:function(n){this.$1NG.get_$5vG().$1u();for(var i=0;i<this.$e3.$358.length;i++){var t=this.$e3.$358[i];this.$uL.$H(t.EmailAddress);this.$2X6[t.EmailAddress]=t;this.$1NG.get_$5vG().$H(t.EmailAddress)}$3Ft(this)},$8VB:function(n){$3Ft(this)}};_d.$uO=function(n,t,i){_d.$uO.initializeBase(this);this.$9e=n;this.$5xl=t;this.$Ta=i};_d.$uO.prototype={$9e:null,$5xl:null,$Ta:null,$xJ:null,$36E:null,$1Ag:!1,get_$4yE:function(){return this.$xJ},set_$4yE:function(n){if(this.$xJ!==n){this.$xJ=n;$Nu(this,"FreeBusyStatus","IsBusy","DisplayStatus")}return n},get_$1l:function(){return this.$9e.Name},get_$7v:function(){return this.$xJ.get_$7v()},get_$7AU:function(){return this.$xJ.$lY},get_$46x:function(){return this.$36E},set_$46x:function(n){if(this.$36E!==n){this.$36E=n;$6(this,"SelectNextAvailableRoomLabel")}return n},get_$37r:function(){return this.$1Ag},set_$37r:function(n){if(this.$1Ag!==n){this.$1Ag=n;$6(this,"ShowLoadingMessage")}return n}};_d.$Ni=function(n,t,i,r){this.$$d_$8XY=Function.createDelegate(this,this.$8XY);this.$$d_$8XZ=Function.createDelegate(this,this.$8XZ);this.$$d_$4hU=Function.createDelegate(this,this.$4hU);_d.$Ni.initializeBase(this,["SelectARoomList",i]);this.$p=n;this.$1dF=t;this.$51q=r;this.$1A9=new _js.$X;this.$JF=new _C(this.$$d_$4hU,_a.$0.$DT)};function $6SR(n){if(!n.$ez){var t=n.$51q();t.add_$2A(n.$$d_$8XZ);t.add_$20(n.$$d_$8XY);n.$p.$y(t)}}_d.$Ni.prototype={$p:null,$1dF:null,$51q:null,$1A9:null,$JF:null,get_$7D0:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$1ab,_u.Strings.l_TryAgainButton_Text));n.$H(new _a.$2E(this.$JF,_u.Strings.l_ConfirmDialog_Back_Text));return n},$8eN:function(){if(this.$5b.get_$Fk()){this.$1dF.set_$45z(this.$5b.get_$Fk().Name);this.$1dF.set_$35W(this.$5b.get_$Fk().EmailAddress);_h.$2x.$H4(this.$1dF.get_$Tq(),this.$p);$12v(this,"SelectARoom")}},get_$920:function(){return!$8(this.$1dF.get_$35W())&&$8(this.$5b.get_$Fk())},get_$5yS:function(){return this.$ez&&!this.$1cm},$2zc:function(){this.set_$xb(!1);if(this.get_$920()){var n=new _g.$1m;n.Name=this.$1dF.get_$45z();n.EmailAddress=this.$1dF.get_$35W();this.$5b.set_$Fk(n);$12v(this,"SelectARoom")}else if(this.get_$5yS()){this.$5b.set_$Fk(null);$12v(this,"SelectARoom")}else $6SR(this)},$5hV:function(){},$8XY:function(n){var t=n;t.remove_$2A(this.$$d_$8XZ);t.remove_$20(this.$$d_$8XY);this.set_$xb(!0)},$8XZ:function(n){var t=n;t.remove_$2A(this.$$d_$8XZ);t.remove_$20(this.$$d_$8XY);this.$1A9.$6G(t.$1A9);this.set_$66x(this.$1A9.get_$F());if(this.$5b.get_$Fk())for(var r=t.$1A9,f=r.length,i=0;i<f;++i){var u=r[i];if(u.EmailAddress===this.$5b.get_$Fk().EmailAddress){this.$5b.set_$Fk(u);break}}this.set_$1Tn(!0);if(this.get_$5yS()){this.$5b.set_$Fk(null);$12v(this,"SelectARoom")}},$4hU:function(){this.set_$xb(!1);$12v(this,null)}};_d.$Kl=function(n,t){this.$$d_$9FF=Function.createDelegate(this,this.$9FF);this.$$d_$8W0=Function.createDelegate(this,this.$8W0);this.$$d_$1uR=Function.createDelegate(this,this.$1uR);this.$$d_$5kg=Function.createDelegate(this,this.$5kg);this.$$d_$1uh=Function.createDelegate(this,this.$1uh);this.$$d_$8eM=Function.createDelegate(this,this.$8eM);this.$$d_$7Ao=Function.createDelegate(this,this.$7Ao);this.$$d_$8va=Function.createDelegate(this,this.$8va);this.$$d_$8vc=Function.createDelegate(this,this.$8vc);this.$$d_$4hU=Function.createDelegate(this,this.$4hU);_d.$Kl.initializeBase(this,["SelectARoom",n]);this.$2p=t;this.$JF=new _C(this.$$d_$4hU,_a.$0.$DT);this.$2OS=new _C(this.$$d_$8vc,_a.$0.$DT);this.$5x7=new _C(this.$$d_$8va,_a.$0.$DT);this.$61N=new _C(this.$$d_$7Ao,_a.$0.$DT);this.$5b.apcl("selectedRoomListEmailAddress",this.$$d_$8eM);this.$5b.apcl("selectedRoomEmailAddress",this.$$d_$1uh)};function $6SS(n){n.$ez?n.$1uR():n.$2p.$51r(n.$5b.get_$Fk(),n.$5b.get_$aD())}_d.$Kl.prototype={$2p:null,$2OS:null,$5x7:null,$61N:null,$JF:null,$1AK:null,$11T:null,$1MF:!1,$2is:!1,$2jB:!1,$2jD:!1,$2Po:!1,$2BH:!1,$2iu:!1,$37U:null,$2yc:null,$35p:null,get_$54B:function(){return this.$2is},set_$54B:function(n){if(this.$2is!==n){this.$2is=n;$6(this,"HasAvailableRooms")}return n},get_$2jC:function(){return this.$2jB},set_$2jC:function(n){if(this.$2jB!==n){this.$2jB=n;$6(this,"HasNoRoomsAvailable")}return n},get_$2jE:function(){return this.$2jD},set_$2jE:function(n){if(this.$2jD!==n){this.$2jD=n;$6(this,"HasNoRoomsInDirectory")}return n},get_$61M:function(){return this.$2Po},set_$61M:function(n){if(this.$2Po!==n){this.$2Po=n;$6(this,"ShowBusyRooms")}return n},get_$4jt:function(){return this.$2iu&&this.get_$92N()},get_$92O:function(){return this.$37U},set_$92O:function(n){if(this.$37U!==n){this.$37U=n;$6(this,"ShowBusyRoomsLabel")}return n},get_$5ep:function(){return this.$2yc},set_$5ep:function(n){if(this.$2yc!==n){this.$2yc=n;$6(this,"NoRoomAvailableLabel")}return n},get_$8vb:function(){return this.$35p},set_$8vb:function(n){if(this.$35p!==n){this.$35p=n;$6(this,"SelectAnyRoomLabelText")}return n},get_$61E:function(){return this.get_$1Tz()},get_$1Tz:function(){return this.$2p.get_$1Tz()},get_$lo:function(){return this.$2p.get_$lo()},get_$1PG:function(){return this.$2p.get_$1PG()},get_$8vm:function(){return this.$1AK},set_$8vm:function(n){if(this.$1AK!==n){this.$1AK=n;this.$11T=null;$4Z(this,"SelectedBusyRoom","SelectedFreeRoom");this.$5b.set_$1OT(!1);this.$5b.set_$A1(n?n.$9e:null)}return n},get_$5xM:function(){return this.$11T},set_$5xM:function(n){if(this.$11T!==n){this.$11T=n;this.$1AK=null;$4Z(this,"SelectedFreeRoom","SelectedBusyRoom");this.$5b.set_$1OT(!1);this.$5b.set_$A1(n?n.$9e:null)}return n},get_$944:function(){return this.$1MF},set_$944:function(n){if(this.$1MF!==n){this.$1MF=n;$6(this,"ShowSelectARoomListButton")}return n},get_$55L:function(){return this.$2BH},set_$55L:function(n){if(this.$2BH!==n){this.$2BH=n;$6(this,"HideListOfAvailableRooms")}return n},get_$6vC:function(){return this.$5b.get_$Fk()?String.format(_u.Strings.l_FindingRoomsInRoomlist_Text,this.$5b.get_$Fk().Name):_u.Strings.l_FindingRooms_Text},get_$7D1:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$1ab,_u.Strings.l_TryAgainButton_Text));n.$H(new _a.$2E(this.$JF,_u.Strings.l_ConfirmDialog_Back_Text));return n},get_$8Q3:function(){var n=new _js.$X;n.$H(new _a.$2E(this.$JF,_u.Strings.l_ChangeTimeButton_Text));this.$1MF&&n.$H(new _a.$2E(this.$2OS,_u.Strings.l_ChangeRoomListButton_Text));return n},get_$8Q4:function(){var n=new _js.$X;this.$1MF&&n.$H(new _a.$2E(this.$2OS,_u.Strings.l_ChangeRoomListButton_Text));n.$H(new _a.$2E(this.$JF,_u.Strings.l_ConfirmDialog_Back_Text));return n},get_$92N:function(){return!0},get_$3bl:function(){return this.$2iu},set_$3bl:function(n){if(this.$2iu!==n){this.$2iu=n;$6(this,"CanShowBusyRooms")}return n},$2zc:function(){this.set_$944(!!this.$5b.get_$Fk());this.set_$1Tn(!1);this.set_$61M(!1);this.set_$54B(!1);this.set_$2jC(!1);this.set_$2jE(!1);this.set_$3bl(!1);this.set_$55L(!0);this.$5b.apcl("selectedRoomEmailAddress",this.$$d_$5kg);this.$2p.add_$2ck(this.$$d_$1uR);this.$2p.apcl("HasErrorOccurred",this.$$d_$8W0);this.$2p.get_$lo().add_$1Z(this.$$d_$9FF);$6SS(this)},$5hV:function(){this.$5b.rpcl("selectedRoomEmailAddress",this.$$d_$5kg);this.$2p.remove_$2ck(this.$$d_$1uR);this.$2p.rpcl("HasErrorOccurred",this.$$d_$8W0)},$8z9:function(){this.set_$5ep(this.$5b.get_$Fk()?String.format(_u.Strings.l_NoRoomsAvailableInRoomList_Text,this.$5b.get_$Fk().Name):_u.Strings.l_NoRoomsAvailable_Text)},$8W0:function(n,t){this.set_$xb(this.$2p.get_$xb())},$1uR:function(){this.set_$1Tn(!0);this.set_$66x(this.get_$lo().get_$F()+this.get_$1PG().get_$F());this.set_$54B(this.get_$lo().get_$F()>0);this.set_$3bl(this.get_$1PG().get_$F()>0);this.set_$2jC(this.$1cm>0&&!this.get_$lo().get_$F());this.set_$2jE(this.get_$3c1());this.set_$92O(this.$5b.get_$Fk()?String.format(_u.Strings.l_ShowBusyRooms_Text,this.$5b.get_$Fk().Name):_u.Strings.l_ShowBusyRoomsWithoutRoomList_Text);this.$8z9();this.set_$55L(this.get_$3c1())},$5kg:function(n,t){$12v(this,null)},$4hU:function(){this.set_$xb(!1);this.set_$2jC(!1);this.set_$2jE(!1);$12v(this,null)},$8vc:function(){this.set_$xb(!1);this.set_$2jC(!1);this.set_$2jE(!1);$12v(this,"SelectARoomList")},$8va:function(){$12v(this,null);this.$5b.set_$1OT(!0)},$7Ao:function(){this.set_$61M(!0);this.set_$3bl(!1)},$8eM:function(n,t){this.set_$8vb(this.$5b.get_$Fk()?String.format(_u.Strings.l_FindAnyAvailableRoomInRoomList_Text,this.$5b.get_$Fk().Name):_u.Strings.l_FindAnyAvailableRoom_Text);this.set_$1Tn(!1)},$1uh:function(n,t){if(!this.$5b.get_$1Sv()&&(this.$11T||this.$1AK)){this.$11T=null;this.$1AK=null}else{var i=this.$2p.$3Zj(this.$5b.get_$A1());if(i>=0){this.$11T=this.get_$lo().get_$48(i);this.$1AK=null}else{i=this.$2p.$4zJ(this.$5b.get_$A1());if(i>=0){this.$1AK=this.get_$1PG().get_$48(i);this.$11T=null}}}$4Z(this,"SelectedBusyRoom","SelectedFreeRoom")},$9FF:function(n,t){this.$1uh(null,null)}};_d.$16B=function(n,t){_d.$16B.initializeBase(this,[n,t])};_d.$16B.prototype={get_$61E:function(){return!1},$8z9:function(){this.set_$5ep(this.$5b.get_$Fk()?String.format(_u.Strings.l_NoRoomsAvailableInRoomListComposeForm_Text,this.$5b.get_$Fk().Name):_u.Strings.l_NoRoomsAvailableComposeForm_Text)},get_$92N:function(){return!1}};_d.$XL=function(n,t,i){this.$$d_$8S3=Function.createDelegate(this,this.$8S3);_d.$XL.initializeBase(this);this.$DD=n;this.$6I=t;this.set_$8S4(new _C(this.$$d_$8S3,i))};_d.$XL.$4oh=function(n,t,i,r){return n.get_$O()==="Mouse"?new _d.$XL(t,i,r):null};_d.$XL.prototype={$11s:null,$pf:!1,$o7:null,$6I:null,$DD:null,get_$8S4:function(){return this.$o7},set_$8S4:function(n){if(this.$o7!==n){this.$o7=n;$6(this,"OnAttachViaStringCommand")}return n},get_$2Qq:function(){return this.$11s},set_$2Qq:function(n){if(this.$11s!==n){this.$11s=n;$6(this,"StringAttachContent")}return n},get_$21A:function(){return this.$pf},set_$21A:function(n){if(this.$pf!==n){this.$pf=n;$6(this,"WasStringAttachments")}return n},$8S3:function(){var n=this;this.$DD.$I(function(t){var i;var r,u;n.set_$21A((u=t.$2Rv(n.$11s,r={val:i}),i=r.val,u));n.$pf&&n.$6I&&n.$6I.$235(i,null)})}};_d.$qW=function(n){this.$$d_$8wH=Function.createDelegate(this,this.$8wH);this.$$d_$8wY=Function.createDelegate(this,this.$8wY);_d.$qW.initializeBase(this);this.$36I=new _C(this.$$d_$8wY,_a.$0.$Bu);this.$5xq=new _C(this.$$d_$8wH,_a.$0.$Bu);this.$56w(n);this.$3F=n};_d.$qW.prototype={$36I:null,$5xq:null,$jO:null,$Xz:null,$b5:!1,$2u:null,$3F:null,$Hp:!1,get_$qM:function(){return this.$b5},set_$qM:function(n){if(this.$b5!==n){this.$b5=n;$6(this,"CanSelectNone")}return n},get_$39X:function(){return this.$Xz},set_$39X:function(n){if(n!==this.$Xz){this.$Xz=n;$6(this,"SuggestedDate")}return n},get_$Ba:function(){return this.$2u},set_$Ba:function(n){this.$2u=$8(this.$2u)||$8(n)?n:new _a.$7(n.get_$4M(),n.get_$3D(),n.get_$5z(),this.$2u.get_$Ec(),this.$2u.get_$Gs(),this.$2u.get_$Te());this.$3F=this.$2u;this.set_$1H5(!1);$4Z(this,"DisplayedDate","SelectedDate");!$8(this.$jO)&&this.$jO.$2K&&this.$jO.$s();return n},get_$AB:function(){return this.$3F},set_$AB:function(n){if(!_a.$7.$4F(this.$3F,n)){this.$3F=n;$6(this,"DisplayedDate")}return n},get_$1H5:function(){return this.$Hp},set_$1H5:function(n){if(this.$Hp!==n){this.$Hp=n;$6(this,"IsPickingMonth")}return n},$56w:function(n){this.$3F=n;this.$2u=n;$4Z(this,"DisplayedDate","SelectedDate")},$8wY:function(){var n=_a.$7.get_$2M();$8(this.$2u)||(n=new _a.$7(n.get_$4M(),n.get_$3D(),n.get_$5z(),this.$2u.get_$Ec(),this.$2u.get_$Gs(),this.$2u.get_$Te()));this.set_$Ba(n)},$8wH:function(){this.set_$Ba(null)}};_d.$Tm=function(n){this.$$d_$8hf=Function.createDelegate(this,this.$8hf);this.$$d_$8qz=Function.createDelegate(this,this.$8qz);_d.$Tm.initializeBase(this);this.$Ys=n;var t=this;this.$5t6=new _C(this.$$d_$8qz,_a.$0.$Bu,this,"Persona",function(){return!!t.$12})};_d.$Tm.prototype={$Ys:null,$36:null,$5t6:null,$12:null,get_$ll:function(){if(!this.$36){this.$36=this.$Ys.$I(_c.$14.$15a,_c.$14.$bV(),!1,"PersonaDetailedView");this.$36.$vd();this.$36.set_$oy(!0);this.$36.set_$OY(!0);this.$36.set_$15(!1);this.$36.add_$jv(this.$$d_$8hf);this.$36.set_$12U(100);this.$36.set_$1Xb(0)}return this.$36},get_$1v:function(){return this.$12},set_$1v:function(n){if(this.$12!==n){this.$12=n;$4Z(this,"Persona","RemoveRecipientText")}return n},get_$5tC:function(){return!this.$12||!this.$12.$12?String.format(_u.Strings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_u.Strings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$12.$12.get_$1l())},$1u:function(){this.set_$1v(null);this.get_$ll().set_$D5("")},$8hf:function(n,t){var i=n.get_$Vm();i&&this.set_$1v(i)},$8qz:function(){this.set_$1v(null);this.get_$ll().set_$HE(!0)}};_d.$LV=function(n,t,i,r,u,f){this.$$d_$5fi=Function.createDelegate(this,this.$5fi);this.$$d_$3Q=Function.createDelegate(this,this.$3Q);this.$$d_$8i2=Function.createDelegate(this,this.$8i2);_d.$LV.initializeBase(this);_a.$3.$M(i,"folderPickerContainer shouldn't be null");_a.$3.$M(r,"owaShell shouldn't be null");_a.$3.$M(u,"passFolderCheck shouldn't be null");_a.$3.$M(f,"conductor shouldn't be null");this.$eR=i;this.$G=r;this.set_$JM(n);this.set_$n(t);this.$5nI=u;this.$2o=f;this.$4di=new _C(this.$$d_$8i2,_a.$0.$DO);this.$Ta=new _C(this.$$d_$3Q,_a.$0.$DO)};function $6Nc(n){n.$eR.$xE||n.$eR.$9BV();if(n.$eR.$xE){var i=this;var t=new _C(function(){n.$eR.$xE.$5R.get_$Dt()&&$4NQ(n,n.$eR.$xE.$5R.get_$Dt().$1x)},_a.$0.$DO);n.$eR.$xE.$49W(t,_u.Strings.l_Select_Text,_u.Strings.l_Select_Text)}}function $6Nd(n){n.$eR.$Ib||n.$eR.$9BW();if(n.$eR.$Ib){n.$eR.$Ib.$5R.$gx=new _C(n.$$d_$5fi,_a.$0.$9h);n.$2o.$B9(n.$eR.$Ib)}}function $4NQ(n,t){if(n.$5nI(t)){n.set_$JM(t.get_$1l());n.set_$n(t.get_$n().Id)}}_d.$LV.prototype={$eR:null,$G:null,$5nI:null,$2o:null,$Ge:null,$2i:null,$4di:null,$Ta:null,get_$JM:function(){return this.$Ge},set_$JM:function(n){if(this.$Ge!==n){this.$Ge=n;$6(this,"FolderName")}return n},get_$n:function(){return this.$2i},set_$n:function(n){if(this.$2i!==n){this.$2i=n;$6(this,"FolderId")}return n},$8i2:function(){switch(this.$G.get_$O()){case"Mouse":case"TouchWide":$6Nc(this);break;case"TouchNarrow":$6Nd(this);break}},$5fi:function(){var n=this.$eR.$Ib.$5R;n.get_$Dt()&&$4NQ(this,n.get_$Dt().$1x);n.$gx=null;this.$2o.$BX()},$3Q:function(){this.set_$JM("");this.set_$n("")}};_d.$Ax=function(n,t,i){this.$$d_$8qf=Function.createDelegate(this,this.$8qf);this.$$d_$8qe=Function.createDelegate(this,this.$8qe);_d.$Ax.initializeBase(this);this.$S=n;this.$5w=t;this.$G=i};function $4NR(n){var t=_h.$l.$ea("msgfolderroot");var i=_g.$2Q.$9K("msgfolderroot");if(t&&i){n.$1kK=new _js.$X;var r=new _y.$NA(n.$S,"msgfolderroot",i,t,_g.$S.get_$L());n.$1kK.$H(r);return!0}else{$6Ng(n);return!1}}function $6Ne(n){_js.Trace.logInfo(_d.$Ax.$5W,"Setting FolderPickerDialog to null");n.$1kK=null;n.set_$Dg(null)}function $6Nf(n){_js.Trace.logInfo(_d.$Ax.$5W,"Setting FolderPickerScreen to null");n.$1kK=null;n.$Ib=null}function $6Ng(n){var t=new _a.$4f([_u.Strings.l_FolderTreesIsNull_Text],0,null,0,!1,_u.Strings.l_OK_Text,null,_u.Strings.l_FolderPickerError_Text);n.$S.$8oV(_a.$4f,t)}_d.$Ax.prototype={$S:null,$5w:null,$G:null,$1kK:null,$xE:null,$Ib:null,get_$Dg:function(){return this.$xE},set_$Dg:function(n){if(n!==this.$xE){this.$xE=n;$6(this,"FolderPickerDialog")}return n},$9BV:function(){if($4NR(this)){_js.Trace.logInfo(_d.$Ax.$5W,"CreateFolderPickerDialog");this.set_$Dg(new _y.$K6(new _y.$4M(this.$S,this.$1kK,_g.$S.get_$L(),this.$G,null,null,!0,!1,!1,null,null)));this.$5w.$21(_d.$Ax.$5W,"RemovePickerDialog",this.$$d_$8qe,18e4)}},$9BW:function(){if($4NR(this)){this.$Ib=new _y.$Ql(new _y.$4M(this.$S,this.$1kK,_g.$S.get_$L(),this.$G,null,null,!0,!1,!1,null,null));this.$Ib.set_$2go(_u.Strings.l_SelectFolder_Text);this.$5w.$21(_d.$Ax.$5W,"RemoveFolderPickerScreen",this.$$d_$8qf,18e4)}},$8qe:function(){this.$xE.$2R?this.$5w.$21(_d.$Ax.$5W,"RemovePickerDialog",this.$$d_$8qe,18e4):$6Ne(this)},$8qf:function(){this.$Ib.$2R?this.$5w.$21(_d.$Ax.$5W,"RemoveFolderPickerScreen",this.$$d_$8qf,18e4):$6Nf(this)}};_d.$Vn=function(n,t){this.$2E=n;this.$15n=t};_d.$Vn.prototype={$2E:null,$15n:null,$4Q:!1,get_$8X:function(){return this.$15n},get_$15:function(){return this.$4Q},set_$15:function(n){this.$4Q=n;return n}};_d.$LX=function(n,t,i,r,u,f,e){this.$3cN=n;this.$Dk=t;this.$1ux="";this.$SL=i;this.$1Jr=r;this.$69=u;this.$Am=f;this.$G=e};function $6O2(n,t){var i=$6Nz(n,t);if(i){var r=n.$Dk?"MicrosoftOffice365Help":"OWAPremiumHelp";n.$SL.$Q9(i,r,$6O0(n))}}function $6O1(n){return n.$G.get_$O()==="TouchWide"&&_d.$8r.isInstanceOfType(n.$G.$bW().get_$7L())?!0:!1}function $6Nz(n,t){var i=null;if(n.$3cN){i=_js.$8.$4C(n.$3cN,_js.$2B.$J7(_y.$11B,t));n.$Dk&&(i+=n.$1ux)}return i}function $6O0(n){return n.$Am==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""}_d.$LX.prototype={$3cN:null,$Dk:!1,$SL:null,$1Jr:null,$1ux:null,$69:null,$Am:0,$G:null,get_$3zR:function(){return this.$1ux},set_$3zR:function(n){this.$1ux=_js.$8.$14(n)?"":n.startsWith("&")?n:"&"+n;return n},$2Py:function(){var t=0;$6O1(this)?t=4:this.$69&&this.$69.get_$6F()&&(t=this.$69.get_$6F().$9l);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.$1bi(n)},$1bi:function(n){this.$1Jr.$9Bv(_g.$1Q.$g)||$6O2(this,n)}};_d.$4=function(){};_d.$4.get_$143=function(){return _0365m.$B.$I("close_small.png")};_d.$4.get_$1Pw=function(){return _0365m.$B.$I("close_small_h.png")};_d.$4.get_$7gS=function(){return _0365m.$B.$I("mail_notification_white.png")};_d.$4.get_$7gR=function(){return _0365m.$B.$I("mail_notification.png")};_d.$4.get_$6tC=function(){return _0365m.$B.$I("arrow_right_small_blue.png")};_d.$4.get_$6tD=function(){return _0365m.$B.$I("arrow_up.png")};_d.$4.get_$7DR=function(){return _0365m.$B.$I("event_notification_white.png")};_d.$4.get_$7DQ=function(){return _0365m.$B.$I("event_notification.png")};_d.$4.get_$6xD=function(){return _0365m.$B.$I("chat_white.png")};_d.$4.get_$4H=function(){return _0365m.$B.$I("chat.png")};_d.$4.get_$4e9=function(){return _0365m.$B.$I("add_people.png")};_d.$4.get_$6pv=function(){return _0365m.$B.$I("add_circle_grey_large.png")};_d.$4.get_$6pt=function(){return _0365m.$B.$I("add_circle_blue_p.png")};_d.$4.get_$l4=function(){return _0365m.$B.$I("close_large.png")};_d.$4.get_$hT=function(){return _0365m.$B.$I("close_large_h.png")};_d.$4.get_$25b=function(){return _0365m.$B.$I("close_large_d.png")};_d.$4.get_$8kh=function(){return _0365m.$B.$I("personcard_phone.png")};_d.$4.get_$8ki=function(){return _0365m.$B.$I("personcard_phone_p.png")};_d.$4.get_$7fW=function(){return _0365m.$B.$I("locationcard_directions_p.png")};_d.$4.get_$8ke=function(){return _0365m.$B.$I("personcard_event_p.png")};_d.$4.get_$8kg=function(){return _0365m.$B.$I("personcard_mail_p.png")};_d.$4.get_$8kf=function(){return _0365m.$B.$I("personcard_im_p.png")};_d.$4.get_$5H1=function(){return _0365m.$B.$I("locationcard_directions.png")};_d.$4.get_$5H2=function(){return _0365m.$B.$I("locationcard_directions_h.png")};_d.$4.get_$5oN=function(){return _0365m.$B.$I("personcard_event.png")};_d.$4.get_$5oO=function(){return _0365m.$B.$I("personcard_event_h.png")};_d.$4.get_$5oR=function(){return _0365m.$B.$I("personcard_mail.png")};_d.$4.get_$5oS=function(){return _0365m.$B.$I("personcard_mail_h.png")};_d.$4.get_$5oP=function(){return _0365m.$B.$I("personcard_im.png")};_d.$4.get_$5oQ=function(){return _0365m.$B.$I("personcard_im_h.png")};_d.$4.get_$7i3=function(){return _0365m.$B.$I("merge.png")};_d.$4.get_$7i9=function(){return _0365m.$B.$I("merge_h.png")};_d.$4.get_$63g=function(){return _0365m.$B.$I("split.png")};_d.$4.get_$63j=function(){return _0365m.$B.$I("split_h.png")};_d.$4.get_$32r=function(){return _0365m.$B.$I("print.png")};_d.$4.get_$5qM=function(){return _0365m.$B.$I("print_h.png")};_d.$4.get_$4jD=function(){return _0365m.$B.$I("calendar_share.png")};_d.$4.get_$4jE=function(){return _0365m.$B.$I("calendar_share_h.png")};_d.$4.get_$8ii=function(){return _0365m.$B.$I("other_notification_white.png")};_d.$4.get_$8ih=function(){return _0365m.$B.$I("other_notification.png")};_d.$4.get_$4df=function(){return _0365m.$B.$I("add_circle_blue.png")};_d.$4.get_$4dg=function(){return _0365m.$B.$I("add_circle_grey.png")};_d.$4.get_$6pu=function(){return _0365m.$B.$I("add_circle_grey_d.png")};_d.$4.get_$4dh=function(){return _0365m.$B.$I("add_circle_grey_h.png")};_d.$4.get_$2M6=function(){return _0365m.$B.$I("pin.png")};_d.$4.get_$5oh=function(){return _0365m.$B.$I("pin_h.png")};_d.$Dv=function(n,t){this.$$d_$5fg=Function.createDelegate(this,this.$5fg);this.$$d_$8R5=Function.createDelegate(this,this.$8R5);this.$3CA={};_d.$Dv.initializeBase(this);this.$Bo=n;this.$p=t};function $4Pv(n,t){return t in n.$3CA}_d.$Dv.prototype={$Bo:null,$p:null,$3ay:null,$3ax:null,get_$2FW:function(){return this.$Bo.get_$1dA()},$3v:function(n){_js.$8.$c(this.get_$2FW())||this.$1l3(this.get_$2FW(),n)},$2mB:function(n){return _js.$8.$c(n)?!1:$4Pv(this,n)&&this.$3CA[n]},get_$2DV:function(){return this.$2mB(this.get_$2FW())},$1l3:function(n,t){if(_js.$8.$c(n)){_js.Trace.logInfo(_d.$Dv.$1Y,"Ignoring request to fetch online meeting configuration for empty sipUri");t&&t(n,!1);return}if($4Pv(this,n)){t&&t(n,this.$2mB(n));return}_js.Trace.logInfo(_d.$Dv.$1Y,String.format("Fetching user online meeting configuration for {0}",n));_a.$5.$1V(_d.$Dv.$1Y,"GetUserOnlineMeetingSettings");var i=new _c.$10n(n);i.add_$2A(this.$$d_$8R5);i.add_$20(this.$$d_$5fg);var r=this;i.add_$2m(function(n){_a.$5.$1G(null,"GetUserOnlineMeetingSettings",r.$3ay,r.$3ax);if(t){var i=n;var u=i.$t?i.$t.SipUri:"";t(u,r.$2mB(u))}});this.$p.$y(i)},$8R5:function(n){_js.Trace.logInfo(_d.$Dv.$1Y,"Fetching user online meeting configuration succeeded.");var t=n;this.$3CA[t.$t.SipUri]=t.$t.IsUcwaSupported;this.$3ax=t.get_$4dL()?t.get_$4dL().correlationId:null;this.$3ay=""},$5fg:function(n){_js.Trace.logInfo(_d.$Dv.$1Y,"Fetching user online meeting configuration failed.");var t=n;this.$3ax=t.get_$4dL()?t.get_$4dL().correlationId:null;this.$3ay="Failed"}};_d.$RS=function(n,t,i){_d.$RS.initializeBase(this);this.$SL=i;this.$gs=n;this.$p=t};_d.$RS.prototype={$SL:null,$gs:null,$p:null,$74x:function(n,t,i){var r=new _c.$xm(this.$gs.get_$2FW(),n);var u=this;r.add_$2A(function(n){_js.Trace.logInfo(_d.$RS.$1Y,"Create meet now succeeded.");var i=n;t(i.$CT.WebUrl)});var f=this;r.add_$20(function(n){_js.Trace.logInfo(_d.$RS.$1Y,"Create meet now failed.");i()});this.$p.$y(r)},$7HL:function(n,t){return t?String.format(_u.Strings.l_PlainTextMeetNowPost_Text,_u.Strings.l_MeetNow_Announcement_Text,n,t):""},$3v:function(n){var t=this;this.$gs.$3v(function(){n&&n()})},get_$2DV:function(){return this.$gs.get_$2DV()}};_d.$13a=function(n,t,i){this.$gs=n;this.$p=t;this.$SL=i};_d.$13a.prototype={$gs:null,$p:null,$SL:null,$8M:function(){return new _d.$RS(this.$gs,this.$p,this.$SL)}};_d.$24=function(n,t,i,r,u,f,e,o,s){this.$$d_$8sz=Function.createDelegate(this,this.$8sz);this.$$d_$7Al=Function.createDelegate(this,this.$7Al);this.$$d_$8sx=Function.createDelegate(this,this.$8sx);this.$$d_$3Kp=Function.createDelegate(this,this.$3Kp);this.$$d_$4qx=Function.createDelegate(this,this.$4qx);this.$$d_$991=Function.createDelegate(this,this.$991);this.$$d_$2WN=Function.createDelegate(this,this.$2WN);this.$$d_$780=Function.createDelegate(this,this.$780);this.$$d_$7Bk=Function.createDelegate(this,this.$7Bk);this.$$d_$994=Function.createDelegate(this,this.$994);this.$$d_$7C0=Function.createDelegate(this,this.$7C0);this.$$d_$6pK=Function.createDelegate(this,this.$6pK);this.$$d_$7Bh=Function.createDelegate(this,this.$7Bh);this.$$d_$7Ak=Function.createDelegate(this,this.$7Ak);this.$$d_$7An=Function.createDelegate(this,this.$7An);this.$$d_$7Ai=Function.createDelegate(this,this.$7Ai);this.$$d_$77y=Function.createDelegate(this,this.$77y);this.$$d_$7Bj=Function.createDelegate(this,this.$7Bj);this.$$d_$992=Function.createDelegate(this,this.$992);this.$$d_$7Bz=Function.createDelegate(this,this.$7Bz);this.$$d_$6pI=Function.createDelegate(this,this.$6pI);this.$$d_$7Bg=Function.createDelegate(this,this.$7Bg);this.$$d_$7Aj=Function.createDelegate(this,this.$7Aj);this.$$d_$7Am=Function.createDelegate(this,this.$7Am);this.$$d_$7Ah=Function.createDelegate(this,this.$7Ah);_d.$24.initializeBase(this);_a.$3.$M(n,"item");this.$P=n;this.$4mE=t;this.$1Dm=i;this.$30=r;this.$1T=u;this.$G=f;this.$6M=e;this.$qG=o;this.$1D=s;this.$1bG=0;this.$1bh=!0;var h=this;this.$27z=new _C(this.$$d_$7Ah,_d.$24.$D,this,"CanAccept",function(){return h.get_$13s()});var c=this;this.$281=new _C(this.$$d_$7Am,_d.$24.$D,this,"CanTentativelyAccept",function(){return c.get_$13w()});var l=this;this.$lZ=new _C(this.$$d_$7Aj,_d.$24.$D,this,"CanDecline",function(){return l.get_$vq()});if(this.$P.get_$Cz()){var a=this;this.$3Vh=new _C(this.$$d_$7Bg,_d.$24.$D,this,"CanAccept",function(){return a.get_$13s()});var v=this;this.$3Jp=new _C(this.$$d_$6pI,_d.$24.$D,this,"CanAccept",function(){return v.get_$13s()});var y=this;this.$3Vt=new _C(this.$$d_$7Bz,_d.$24.$D,this,"CanTentativelyAccept",function(){return y.get_$13w()});var p=this;this.$4Cr=new _C(this.$$d_$992,_d.$24.$D,this,"CanTentativelyAccept",function(){return p.get_$13w()});var w=this;this.$28C=new _C(this.$$d_$7Bj,_d.$24.$D,this,"CanDecline",function(){return w.get_$vq()});var b=this;this.$273=new _C(this.$$d_$77y,_d.$24.$D,this,"CanDecline",function(){return b.get_$vq()})}if(_g.$39.isInstanceOfType(this.$P)&&this.$P.get_$Ef()){var k=this;this.$3VJ=new _C(this.$$d_$7Ai,_d.$24.$D,this,"CanAccept",function(){return k.get_$13s()});var d=this;this.$3VK=new _C(this.$$d_$7An,_d.$24.$D,this,"CanTentativelyAccept",function(){return d.get_$13w()});var g=this;this.$280=new _C(this.$$d_$7Ak,_d.$24.$D,this,"CanDecline",function(){return g.get_$vq()});if(this.$P.get_$Cz()){var nt=this;this.$4tz=new _C(this.$$d_$7Bh,_d.$24.$D,this,"CanAccept",function(){return nt.get_$13s()});var tt=this;this.$4d5=new _C(this.$$d_$6pK,_d.$24.$D,this,"CanAccept",function(){return tt.get_$13s()});var it=this;this.$4uL=new _C(this.$$d_$7C0,_d.$24.$D,this,"CanTentativelyAccept",function(){return it.get_$13w()});var rt=this;this.$65t=new _C(this.$$d_$994,_d.$24.$D,this,"CanTentativelyAccept",function(){return rt.get_$13w()});var ut=this;this.$3Vl=new _C(this.$$d_$7Bk,_d.$24.$D,this,"CanDecline",function(){return ut.get_$vq()});var ft=this;this.$3Tc=new _C(this.$$d_$780,_d.$24.$D,this,"CanDecline",function(){return ft.get_$vq()})}}this.$3Jn=new _C(this.$$d_$2WN,_d.$24.$D);this.$4Cp=new _C(this.$$d_$991,_d.$24.$D);this.$2d0=new _C(this.$$d_$4qx,_d.$24.$D);this.$4dz=new _C(this.$$d_$3Kp,_d.$24.$D);$6PZ(this);this.$22m=1};_d.$24.$7LS=function(n){var t=4;switch(n){case"Accept":t=5;break;case"Tentative":t=6;break;case"Decline":t=7;break;default:throw Error.invalidOperation("Expected Accept, Tentatively Accept or Decline as valid Meeting Responses");}return t};_d.$24.$1Sh=function(n){switch(n){case 5:return"Accept";case 6:return"Tentative";case 7:return"Decline";default:throw Error.invalidOperation("Unable to get ResponseType from MailComposeOperation "+_y.$Oi.toString(n));}};_d.$24.$3Ys=function(n,t,i,r){var u=new _c.$OC(n,t,r);u.$EZ=i;return u};function $3FQ(n,t){$4OY(n,t,!1)}function $3FR(n,t){$4OY(n,t,!0)}function $6PZ(n){if(n.$P.get_$Cz())if(_g.$39.isInstanceOfType(n.$P)&&n.$P.get_$Ef()){n.$22k=$2UB(n,_u.Strings.l_AcceptOccurrence_UpperCase_Text,_u.Strings.l_AcceptSeries_UpperCase_Text,n.$3Vh,n.$3Jp,n.$27z,n.$4tz,n.$4d5,n.$3VJ);n.$2RJ=$2UB(n,_u.Strings.l_TentativelyAcceptOccurrence_UpperCase_Text,_u.Strings.l_TentativelyAcceptSeries_UpperCase_Text,n.$3Vt,n.$4Cr,n.$281,n.$4uL,n.$65t,n.$3VK);n.$272=$2UB(n,_u.Strings.l_DeclineOccurrence_UpperCase_Text,_u.Strings.l_DeclineSeries_UpperCase_Text,n.$28C,n.$273,n.$lZ,n.$3Vl,n.$3Tc,n.$280);n.$27F=$2UB(n,_u.Strings.l_DeleteOccurrence_UpperCase_Text,_u.Strings.l_DeleteSeries_UpperCase_Text,n.$28C,n.$273,n.$lZ,n.$3Vl,n.$3Tc,n.$280)}else{n.$22k=$2UA(n,_u.Strings.l_AcceptMeeting_UpperCase_Text,n.$3Vh,n.$3Jp,n.$27z);n.$2RJ=$2UA(n,_u.Strings.l_TentativelyAcceptMeeting_UpperCase_Text,n.$3Vt,n.$4Cr,n.$281);n.$272=$2UA(n,_u.Strings.l_DeclineMeeting_UpperCase_Text,n.$28C,n.$273,n.$lZ);n.$27F=$2UA(n,_u.Strings.l_DeleteMeeting_UpperCase_Text,n.$28C,n.$273,n.$lZ)}else if(_g.$39.isInstanceOfType(n.$P)&&n.$P.get_$Ef()){n.$22k=$2UC(n,_u.Strings.l_AcceptMeeting_UpperCase_Text,n.$27z,n.$3VJ);n.$2RJ=$2UC(n,_u.Strings.l_TentativelyAcceptMeeting_UpperCase_Text,n.$281,n.$3VK);n.$272=$2UC(n,_u.Strings.l_DeclineMeeting_UpperCase_Text,n.$lZ,n.$280);n.$27F=$2UC(n,_u.Strings.l_DeleteMeeting_UpperCase_Text,n.$lZ,n.$280)}}function $2UA(n,t,i,r,u){var f=new(_0365f.$s.$$(_0365m.$Qz));f.$H(new _0365m.$GW(t));f.$H(new _0365m.$n(_u.Strings.l_EditResponseBeforeSending_LowerCase_Text,null,i));f.$H(new _0365m.$n(_u.Strings.l_SendResponseNow_LowerCase_Text,null,r));f.$H(new _0365m.$n(_u.Strings.l_DontSendResponse_LowerCase_Text,null,u));return new _0365m.$2c(f.get_$3T())}function $2UB(n,t,i,r,u,f,e,o,s){var h=new(_0365f.$s.$$(_0365m.$Qz));h.$H(new _0365m.$GW(t));h.$H(new _0365m.$n(_u.Strings.l_EditResponseBeforeSending_LowerCase_Text,null,r));h.$H(new _0365m.$n(_u.Strings.l_SendResponseNow_LowerCase_Text,null,u));h.$H(new _0365m.$n(_u.Strings.l_DontSendResponse_LowerCase_Text,null,f));h.$H(new _0365m.$GW(i));h.$H(new _0365m.$n(_u.Strings.l_EditResponseBeforeSending_LowerCase_Text,null,e));h.$H(new _0365m.$n(_u.Strings.l_SendResponseNow_LowerCase_Text,null,o));h.$H(new _0365m.$n(_u.Strings.l_DontSendResponse_LowerCase_Text,null,s));return new _0365m.$2c(h.get_$3T())}function $2UC(n,t,i,r){var u=new(_0365f.$s.$$(_0365m.$Qz));u.$H(new _0365m.$GW(t));u.$H(new _0365m.$n(_u.Strings.l_Occurrence_LowerCase_Text,null,i));u.$H(new _0365m.$n(_u.Strings.l_Series_LowerCase_Text,null,r));return new _0365m.$2c(u.get_$3T())}function $4OY(n,t,i){n.$1bG=_d.$1Cp.$1o.$Hv.$7Jn(i);n.$mx=_d.$1Cp.$1o.$Hv.$4Aj(t,n.$22m);if(n.$G.get_$6Q()){n.$33K();n.$5re()}_a.$b.$7W("VM.MeetResponse.EditResponseForTouchWideAndMouseStart");var r=n.$6M.$GU(!1,!1);r.set_$4D(_d.$24.$7LS(t));r.set_$Mb(!0);if(_g.$39.isInstanceOfType(n.$P)){r.set_$yG(!0);r.set_$mY(i);if(i){var u=n.$qG.$1QS(n.$P);r.set_$Zs(u.get_$i())}else r.set_$Zs(n.$P.get_$i())}else r.$165(n.$P);r.set_$5L(n.$1Dm);n.$4mE.$VM(r);if(n.$mx){_d.$1Cp.$1o.$Hv.$3WI(n.$mx,"",null,n.$P.get_$Cz(),_g.$39.isInstanceOfType(n.$P),n.get_$Ef(),n.$1bG);n.$mx=null}}function $3FO(n,t){$4OX(n,t,!1)}function $3FP(n,t){$4OX(n,t,!0)}function $4OZ(n,t,i,r){var u=n.$P;_g.$39.isInstanceOfType(u)&&t&&(u=n.$qG.$1QS(u));return _d.$24.$3Ys(u,i,$6PY(n),r)}function $4OX(n,t,i){n.$1bG=_d.$1Cp.$1o.$Hv.$7Jh(i);n.$mx=_d.$1Cp.$1o.$Hv.$4Aj(t,n.$22m);var r=$4OZ(n,i,t,0);r.add_$2A(n.$$d_$7Al);r.add_$20(n.$$d_$8sx);n.$1T.$y(r);n.$33K()}function $6PY(n){var t=new _g.$7f;t.set_$3c(n.$3V);t.set_$6A("Normal");return t}function $3FT(n,t){$4Oa(n,t,!1)}function $3FU(n,t){$4Oa(n,t,!0)}function $4Oa(n,t,i){n.$1bG=_d.$1Cp.$1o.$Hv.$7O2(i);n.$mx=_d.$1Cp.$1o.$Hv.$4Aj(t,n.$22m);var r=$4OZ(n,i,t,1);r.add_$20(n.$$d_$8sx);r.add_$2A(n.$$d_$8sz);n.$1T.$y(r);n.$33K();_a.$b.$7W("VM.MeetResponse.MeetingResponseEnd")}function $3FS(n,t){if(n.get_$92Q())switch(t){case"Accept":n.$27z.$s();break;case"Tentative":n.$281.$s();break;case"Decline":n.$lZ.$s();break;default:throw Error.argument("Invalid meeting response argument");}}_d.$24.prototype={$30:null,$1T:null,$P:null,$4dz:null,$3Jn:null,$4Cp:null,$2d0:null,$3Jp:null,$4d5:null,$4Cr:null,$65t:null,$273:null,$3Tc:null,$3Vh:null,$4tz:null,$3Vt:null,$4uL:null,$28C:null,$3Vl:null,$27z:null,$3VJ:null,$281:null,$3VK:null,$lZ:null,$280:null,$G:null,$1Dm:0,$4mE:null,$6M:null,$qG:null,$1D:null,$22k:null,$2RJ:null,$272:null,$27F:null,$3V:null,$1bh:!1,$22m:0,$1bG:0,$mx:null,add_$1O6:function(n){this.$2Z("ActionSubmitted",n)},remove_$1O6:function(n){this.$2b("ActionSubmitted",n)},get_$6pJ:function(){return this.$1bh?_u.Strings.l_AcceptItem_UpperCase_Text:""},get_$77z:function(){return this.$1bh?_u.Strings.l_DeclineItem_UpperCase_Text:""},get_$993:function(){return this.$1bh?_u.Strings.l_TentativelyAcceptItem_UpperCase_Text:""},get_$1gy:function(){return this.get_$13s()||this.get_$vq()||this.get_$13w()},get_$1PR:function(){return this.$P.get_$1PR()},get_$13s:function(){return this.$P.get_$13s()},get_$vq:function(){return this.$P.get_$vq()},get_$13w:function(){return this.$P.get_$13w()},get_$92J:function(){return this.$1bh},set_$92J:function(n){if(this.$1bh!==n){this.$1bh=n;$Ha(this,["TentativelyAcceptLabel","AcceptLabel","DeclineLabel"])}return n},get_$yU:function(){return this.$1D.get_$YP().$mg},get_$92Q:function(){return!this.$P.get_$Cz()&&(_g.$RQ.isInstanceOfType(this.$P)||_g.$39.isInstanceOfType(this.$P)&&!this.$P.get_$Ef())},$33K:function(){$Bc(this,"ActionSubmitted",this,null)},$5re:function(){$Bc(this,"ActionSucceeded",this,null)},$3Kp:function(){var t=new _g.$Si;t.ItemId=this.$P.get_$i();var n=new _c.$eR(t);n.add_$20(this.$$d_$8sx);var i=this;n.add_$2A(function(n){_a.$6R.$3A("Added!",1)});this.$1T.$y(n)},$7Bg:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FQ(this,"Accept")},$6pI:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FT(this,"Accept")},$7Ah:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FO(this,"Accept")},$7Bh:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FR(this,"Accept")},$6pK:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FU(this,"Accept")},$7Ai:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.AcceptedMeetingRequest",n)});$3FP(this,"Accept")},$7Bz:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FQ(this,"Tentative")},$992:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FT(this,"Tentative")},$7Am:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FO(this,"Tentative")},$7C0:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FR(this,"Tentative")},$994:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FU(this,"Tentative")},$7An:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.TentativeMeetingRequest",n)});$3FP(this,"Tentative")},$7Bj:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FQ(this,"Decline")},$77y:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FT(this,"Decline")},$7Aj:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FO(this,"Decline")},$7Bk:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FR(this,"Decline")},$780:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FU(this,"Decline")},$7Ak:function(){var n=this.$P.get_$i();var t=this;this.$30.$I(function(t){t.$P9("Inference.DeclinedMeetingRequest",n)});$3FP(this,"Decline")},$7Al:function(n){var t=n;t.remove_$2m(this.$$d_$7Al);if(!$8(t.meetingResponseMessageId)){var i=new _h.$J7([t.meetingResponseMessageId],"HardDelete",2);i.add_$20(this.$$d_$8sx);i.add_$2A(this.$$d_$8sz);this.$1T.$y(i);this.$33K()}},get_$Ef:function(){return _g.$39.isInstanceOfType(this.$P)&&this.$P.get_$Ef()},$8sx:function(n){var t=!n||!n.$1b||_js.$8.$14(n.$1b.message)?"Failed":n.$1b.message;_js.Trace.logWarning(_a.$0.$6k,"MeetingResponse message failed with error: "+t);if(this.$mx){_d.$1Cp.$1o.$Hv.$3WI(this.$mx,t,n.$Jn.toString(),this.$P.get_$Cz(),_g.$39.isInstanceOfType(this.$P),this.get_$Ef(),this.$1bG);this.$mx=null}_c.$5Q.$15U(n)},$8sz:function(n){if(this.$mx){_d.$1Cp.$1o.$Hv.$3WI(this.$mx,"",n.$Jn.toString(),this.$P.get_$Cz(),_g.$39.isInstanceOfType(this.$P),this.get_$Ef(),this.$1bG);this.$mx=null}this.$5re()},$2WN:function(){$3FS(this,"Accept")},$991:function(){$3FS(this,"Tentative")},$4qx:function(){$3FS(this,"Decline")}};_d.$gl=function(n,t,i,r,u,f,e){this.$p=t;this.$30=n;this.$Ti=i;this.$6M=r;this.$70v=u;this.$qG=f;this.$1D=e};_d.$gl.prototype={$p:null,$30:null,$Ti:null,$6M:null,$qG:null,$1D:null,$4j4:null,$4rQ:null,$70v:null,$6vX:function(n){var t;if(this.$Ti.get_$O()==="TouchNarrow")t=2;else switch(n){case 0:t=this.$Ti.get_$O()==="Mouse"?1:0;break;default:t=0;break}return t},$7WT:function(n,t,i){return new _d.$24(n,t,i,this.$30,this.$p,this.$Ti,this.$6M,this.$qG,this.$1D)},$8M:function(n,t){var i=this.$6vX(t);var r=this.$4j4.$I(this.$4rQ,i);return this.$7WT(n,r,i)}};_d.$RY=function(n,t,i,r){this.$$d_$470=Function.createDelegate(this,this.$470);this.$2E=n;this.$mB=t;this.$3g=i;this.$199=r};_d.$RY.prototype={$2E:null,$199:null,$mB:null,$3g:null,$1tx:null,$XM:null,$470:function(){$8(this.$1tx)||(this.$1tx.$Yf!==this?this.$1tx.set_$3Sm(this):this.$1tx.$4f9&&this.$1tx.set_$3Sm(null))}};_d.$RZ=function(n,t,i,r,u,f){_d.$RZ.initializeBase(this,[n,t,null,f]);this.$2Yw=n;$6Pc(this,r);this.set_$3Sm(u);this.$30L=i};function $6Pc(n,t){for(var f=t.length,u=new Array(f),r=0;r<f;r++){var i=t[r];i.$1tx=n;u[r]=new _0365m.$8I(i.$2E,i.$mB,new _C(i.$$d_$470,_a.$0.$Bu),n.$Yf===i,!1,null,i.$199,i.$3g);u[r].set_$66U(!1);i.$XM=u[r]}n.set_$1zQ(new _0365m.$2c(u))}function $4Og(n){!n.$37b||$8(n.$Yf)||_js.$8.$14(n.$Yf.$2E)?n.set_$1N(n.$2Yw):_js.$8.$14(n.$2Yw)?n.set_$1N(n.$Yf.$2E):n.set_$1N(String.format("{0}: {1}",n.$2Yw,n.$Yf.$2E))}_d.$RZ.prototype={$2Yw:null,$Yf:null,$30L:null,$37b:!0,$4f9:!0,$3Un:!1,get_$3Sm:function(){return this.$Yf},set_$3Sm:function(n){if(this.$Yf!==n){$8(this.$Yf)||this.$3Un||this.$Yf.$XM.set_$6h(!1);this.$Yf=n;$8(this.$Yf)||this.$3Un||this.$Yf.$XM.set_$6h(!0);$Q(this,"CurrentOption");$4Og(this);$8(this.$30L)||($8(this.$Yf)?this.$30L(null):this.$30L(this.$Yf.$3g));this.$3Un&&(this.$Yf=null)}return n},get_$61V:function(){return this.$37b},set_$61V:function(n){if(this.$37b===n)return n;this.$37b=n;$4Og(this);return n}};_d.$bU=function(n,t){this.$$d_$8bW=Function.createDelegate(this,this.$8bW);_d.$bU.initializeBase(this);this.$S=n;this.$N6=new _d.$Tm(t);$6Pk(this)};function $6Pk(n){var t=new _y.$K3;t.set_$5N(_u.Strings.l_OpenAnotherMailbox_Text);t.set_$Cu(n);var i=this;n.$tn=new _C(n.$$d_$8bW,_a.$0.$3X9,n.$N6,"Persona",function(){return!!n.$N6.$12});t.$6g.$H(new _a.$2E(n.$tn,_u.Strings.l_OpenButtonText_Text));t.$6g.$H(new _a.$2E(t.$4a,_u.Strings.l_CancelButtonText_Text));n.set_$eB(t)}_d.$bU.prototype={$S:null,$tn:null,$8d:null,$N6:null,get_$eB:function(){return this.$8d},set_$eB:function(n){if(this.$8d!==n){this.$8d=n;$6(this,"DialogViewModel")}return n},$d1:function(){this.$N6.$1u();this.$8d.set_$1X(!0)},$8bW:function(){if(this.$N6.$12){this.$S.$8oV(_y.$kX,new _y.$kX(this.$N6.$12.get_$1v().get_$1h().EmailAddress));this.$8d.$4a.$s();_a.$b.$7W("VM.MailUsage.OpenFromExplicitLogonWindow")}}};_d.$VF=function(n,t,i,r){this.$$d_$37i=Function.createDelegate(this,this.$37i);this.$$d_$9Ct=Function.createDelegate(this,this.$9Ct);_a.$3.$17(n,"offlineSettings");_a.$3.$17(t,"owaShell");_a.$3.$17(r,"eventAggregator");this.$6H=n;this.$G=t;this.$3L8=i;r.$HX(_a.$Kx,this.$$d_$9Ct);var u=this;this.$5fZ=new(_0365f.$3k.$$(_y.$mn))(function(){return new _y.$mn})};function $6Pj(n){n.get_$2z1().set_$37i(!1);n.$G.$9T(n.get_$2z1())}_d.$VF.prototype={$6H:null,$G:null,$5fZ:null,$3L8:0,get_$2z1:function(){return this.$5fZ.get_$1d()},get_$611:function(){return!this.$6H.get_$1d9()&&this.$6H.$37y(this.$3L8,!1)},$9Bv:function(n){if(n&&!n.$AS.$NF){if(this.$6H.get_$1d9()){$6Pj(this);return!0}if(this.get_$611()){this.$37i();return!0}}return!1},$4dj:function(n){this.get_$611()&&!n.$1UG(9600)&&n.$Mk(9600,null,_u.Strings.l_OfflineDiscovery_InfoBarLink_Text,this.$$d_$37i)},$8qZ:function(n){n.$5c(9600)},$37i:function(){this.get_$2z1().set_$37i(!0);this.$G.$9T(this.get_$2z1())},$9Ct:function(n){var t=n.$t;this.$3L8=t.get_$QG().AllowOfflineOn}};_d.$4C=function(n,t){this.$$d_$2qD=Function.createDelegate(this,this.$2qD);this.$1EN=new Sys.EventHandlerList;_d.$4C.initializeBase(this);_a.$3.$6v(n,1,1e3,"pageSize");this.$575=new _h.$85(0,n);this.$U4=t;this.$6r=0;this.$13=null;this.$lL=_d.$4C.$2FQ;t||this.set_$1FH(!0)};function $6Q3(n){return n.$3TE||_d.$4C.$1uB}function $4Oq(n,t){if(n.$1w){n.$1w.remove_$tl(n.$$d_$2qD);_h.$3K.get_$L().$1aE(n.$1w)}n.$1w=t;n.set_$25(null);n.set_$1ox(!1);n.$1w&&n.$1w.add_$tl(n.$$d_$2qD);$6(n,"Table")}function $4Op(n){if(n.$6r){if(!n.$1w)return;$6Q4(n,n.$575)}}function $6Q4(n,t){n.$6r=2;n.set_$wK(_d.$4C.$2FQ);n.set_$1ox(!1);t.$1pU=1;n.$1w.$NR(t);n.$2qD(n.$1w,"Loading")}function $6Q2(n,t){if(n.$1EN){var i=n.$1EN.getHandler(t);i&&i()}}_d.$4C.prototype={$575:null,$13:null,$lL:null,$3TE:null,$U4:0,$1w:null,$6r:0,$bN:null,$1ow:!1,$1nb:!1,$3gf:!1,$Gd:!1,add_$5xO:function(n){this.$a("SelectedItem",n)},remove_$5xO:function(n){this.$w("SelectedItem",n)},get_$F3:function(){return this.$1w},set_$F3:function(n){_a.$3.$M(n,"Table");$4Oq(this,n);$4Op(this);return n},get_$25:function(){return this.$13},set_$25:function(n){this.$8SW();this.$13=n;this.$8RQ();this.$3gf=!1;$6(this,"SelectedItem");return n},get_$1FH:function(){return this.$Gd},set_$1FH:function(n){this.$Gd=n;$6(this,"FocusItemOnSelect");return n},get_$28W:function(){return this.$bN},set_$28W:function(n){this.$bN=n;$6(this,"EnterKeyCommand");return n},get_$wK:function(){return this.$lL},set_$wK:function(n){if(this.$lL!==n){this.$lL=n;$4Z(this,_d.$4C.$1Qa,_d.$4C.$61p)}return n},get_$1bk:function(){return this.$lL===_d.$4C.$2FQ||this.$lL===_d.$4C.$3l8?!1:!0},get_$1ox:function(){return this.$1ow},set_$1ox:function(n){if(this.$1ow!==n){this.$1ow=n;$6(this,_d.$4C.$2Eg)}return n},get_$7aL:function(){return this.$1nb},set_$7aL:function(n){if(this.$1nb!==n){this.$1nb=n;$6(this,_d.$4C.$2DU)}return n},get_$Uh:function(){return this.$lL===_d.$4C.$2FQ},$5Cw:function(n){var t=$8(n);var i=$8(this.$1w);return t&&i?!0:t||i?!1:n.get_$T()===this.$1w.$5C.get_$T()},$5F:function(){if(!this.$6r){this.$6r=1;$4Op(this)}},$6e:function(){if(this.$6r===1){this.$6r=0;$4Oq(this,null)}},$8RQ:function(){},$8SW:function(){},$8Zk:function(){},$1SX:function(){return _d.$4C.$bO},$2qD:function(n,t){if(n===this.$1w){this.set_$7aL(this.$1w.$ZJ);if(!this.$1w.$ZJ){if(this.$1w.$1p.get_$F()){this.set_$wK(_d.$4C.$3l8);if(this.$U4===1&&!this.$13&&!this.$3gf){this.set_$25(this.$1w.$1p.get_$48(0));this.set_$1FH(!0)}}else{this.$1w.$1Hm?this.set_$wK(this.$1SX()):this.set_$wK($6Q3(this));this.$U4===1&&this.$13&&this.set_$25(null)}this.$6r=1;this.set_$1ox(!0);$6Q2(this,"LoadCompleted");this.$8Zk()}}}};_d.$Fa=function(n,t){this.$$d_$30l=Function.createDelegate(this,this.$30l);_d.$Fa.initializeBase(this);this.$G=t;this.$EG=n;this.$2ND=_d.$Fa.$51g();this.$QA=new _C(this.$$d_$30l,_a.$0.$Ix);$4PN(this);if(this.$EG.get_$19y()&&this.$EG.get_$19y()!==1)throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.$EG.get_$19y()));};_d.$Fa.$6yz=function(n,t){_a.$3.$17(n,"object1");_a.$3.$17(t,"object2");var i=n.$EG;var r=t.$EG;return i.get_$7p().$2Y(r.get_$7p())};_d.$Fa.$51g=function(){var n=_a.$7.get_$2M();return new _a.$7(n.get_$4M(),n.get_$3D(),n.get_$5z(),n.get_$Ec(),n.get_$Gs(),0)};function $4PN(n){var i=null;n.$EG.get_$19y()?n.$EG.get_$19y()===1&&(i=n.$EG.get_$1A0()):i=n.$EG.get_$7p();var t=Math.floor(i.$6E(n.$2ND)/1e3);var r=_a.$7.$500(t<0?-t:t,!0,!0);n.$5Ci=t<0;if(t&&r.length){n.$4DM=r[1];n.$4DN=r[0]}else{n.$4DM=_u.Strings.l_Reminders_Now_UpperCase_Text;n.$4DN=""}$Nu(n,"TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")}_d.$Fa.prototype={$G:null,$QA:null,$EG:null,$2ND:null,$5Ci:!1,$4DM:null,$4DN:null,get_$66K:function(){var n="";this.$EG.get_$19y()?this.$EG.get_$19y()===1&&(n=this.$EG.get_$1A0().$2P(18)):n=_a.$7.$1Of(this.$EG.get_$7p(),this.$2ND)&&_a.$7.$1Of(this.$EG.get_$7p(),this.$EG.get_$158())?String.format(_u.Strings.l_Reminder_DurationLabel_Text,this.$EG.get_$7p().$2P(18),this.$EG.get_$158().$2P(18)):String.format(_u.Strings.l_Reminder_DurationLabel_DifferentDay_Text,this.$EG.get_$7p().$2P(18),this.$EG.get_$7p().$2P(3));return n},get_$8pK:function(){return this.$2ND},set_$8pK:function(n){_a.$3.$17(n,"ReferenceDateTime");this.$2ND=n;return n},$9Ey:function(){this.set_$8pK(_d.$Fa.$51g());$4PN(this)},$30l:function(){if(this.$EG.get_$19y()){if(this.$EG.get_$19y()===1){var t={};t.ItemID=this.$EG.get_$i().Id;this.$G.$5i(_d.$di,null,t,_y.$3p.get_$RN())}}else{var n=new _y.$Ao;n.$cz(this.$EG.get_$i());this.$G.$5i(_d.$I6,null,n.$3l,_y.$3p.get_$RN())}}};_d.$np=function(n){_d.$np.initializeBase(this);this.$G=n};_d.$np.prototype={$G:null,$8M:function(n){return new _d.$Fa(n,this.$G)}};_d.$7v=function(n,t,i,r,u,f){this.$$d_$8dk=Function.createDelegate(this,this.$8dk);this.$$d_$8XW=Function.createDelegate(this,this.$8XW);this.$$d_$6zC=Function.createDelegate(this,this.$6zC);this.$$d_$2KZ=Function.createDelegate(this,this.$2KZ);this.$$d_$6yx=Function.createDelegate(this,this.$6yx);_d.$7v.initializeBase(this);_a.$3.$17(i,"nativeBridge");_a.$3.$17(i.$QO,"nativeBridge.Reminder");_a.$3.$17(r,"offlineSettings");_a.$3.$17(u,"userAgent");this.$43z=n;this.$YE=new _c.$VW;this.$13J={};this.$6H=r;this.$1D=u;this.$t=f;this.$Qh=new _a.$V9(this.$$d_$6yx);this.$Qh.add_$1Z(this.$$d_$2KZ);this.$lr=new _a.$V9(this.$$d_$6zC);this.$27=i;if(t){var e=this;t.$HX(_a.$DL,function(n){n.$2DX&&e.$3yf()})}};function $4PP(n,t){for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=t[i].$EG;return r}function $4PO(n,t){var r=n.$Qh.$3Q(t);n.$YE.$3Q(t.$EG);var i=t.$EG;!$8(i.get_$114())&&i.get_$114().Id in n.$13J&&delete n.$13J[i.get_$114().Id];return r}function $6Rj(n,t){$Bc(n,"BeforeRemindersRefresh",n,null);n.$2KB=_js.$K.get_$L().$5G(n.$2KB);n.$lr.$1u();n.$3Xp=!1;var o=n.$YE;n.$YE=t.$441;for(var s=n.$Qh.get_$F(),u=0;u<s;u++)n.$Qh.get_$48(u)&&n.$Qh.get_$48(u).$1M();n.$Qh.$1u();n.$13J={};for(var h=_a.$7.get_utcNow(),i,f=-1,r=!1,e=n.$YE.get_$F()-1;e>=0;e--){i=n.$YE.get_$48(e);if(i.get_$1A0().$aY().$2Y(h)>0)n.$lr.$H(i);else{n.$Qh.get_$F()||(f=o.$7h(i));var c=!!i.get_$114();if(!c||!(i.get_$114().Id in n.$13J)){var l=n.$43z.$8M(i);n.$Qh.$H(l);c&&(n.$13J[i.get_$114().Id]=l);if(r)continue;r=f<0||!o.get_$48(f).$4W(i)}f--}}r=!!(r|s!==n.$Qh.get_$F());r&&$Bc(n,"ActiveRemindersChanged",n.$Qh,new _js.$JN(4,0,[],[]));n.$lr.get_$F()>0&&$2UM(n,h);$2UN(n,t);n.$3Xp=!0;$Bc(n,"AfterRemindersRefresh",n,null)}function $6Ri(n,t){if(!n.$27.$QO.$Cp)return!1;for(var e=t.get_$cu().Body.Reminders,r=[],u=e,o=u.length,i=0;i<o;++i){var f=u[i];f.ReminderGroup||Array.add(r,f)}var s=JsonParser.serialize(r);var h=this,c=this;n.$27.$QO.$8ur(s,function(){_js.Trace.logInfo(_a.$0.$Ix,"Schedule reminders on PAL succeeded.");$2UN(n,t)},function(i){_js.Trace.logError(_a.$0.$Ix,String.format("Failed to schedule reminders on PAL : {0}",i.message));$2UN(n,t)});return!0}function $2UN(n,t){n.$24v&&(n.$24v=_js.$K.get_$L().$5G(n.$24v));if(t){if(!t.$1wX||t.$1wX===1){var r=_a.$7.get_utcNow();var i=null;n.$YE.get_$F()===t.$1q2&&n.$YE.get_$F()>=1&&(i=n.$YE.get_$48(n.$YE.get_$F()-1).get_$1A0().$aY());var f=r.$9b(288e5);var u=288e5;i&&(i.$2Y(r)<=0?u=3e5:i.$2Y(f)<0&&(u=i.$6E(r)));var o=this;n.$24v=_js.$K.get_$L().$21(_a.$0.$Ix,"GetReminders",function(){n.$15f(0,null)},u)}}else{var e=this;n.$24v=_js.$K.get_$L().$21(_a.$0.$Ix,"GetReminders",function(){n.$15f(0,null)},3e5)}}function $2UM(n,t){n.$2KB=_js.$K.get_$L().$5G(n.$2KB);if(n.$lr.get_$F()){var i=n.$lr.get_$48(n.$lr.get_$F()-1);var r=i.get_$1A0().$aY().$6E(t);var u=this;n.$2KB=_js.$K.get_$L().$21(_a.$0.$Ix,"ActivateReminders",function(){n.$6pb(_a.$7.get_utcNow())},r)}}_d.$7v.prototype={$6H:null,$43z:null,$1D:null,$t:null,$YE:null,$Qh:null,$13J:null,$lr:null,$2KB:null,$24v:null,$1iZ:null,$3Xp:!0,$27:null,add_$6pe:function(n){this.$2Z("ActiveRemindersChanged",n)},remove_$6pe:function(n){this.$2b("ActiveRemindersChanged",n)},add_$6uO:function(n){this.$2Z("BeforeRemindersRefresh",n)},remove_$6uO:function(n){this.$2b("BeforeRemindersRefresh",n)},add_$6rR:function(n){this.$2Z("AfterRemindersRefresh",n)},remove_$6rR:function(n){this.$2b("AfterRemindersRefresh",n)},$3yf:function(){var n=this.$t.get_$1t().get_$1jb();var t=this.$t.get_$6D().get_$1o();var i=this.$t.get_$6D().get_$2RH();var r;r=this.$1D.get_$5h()?this.$t.get_$6D().get_$1o():n&&(t||i);if(!r){_js.Trace.logInfo(_a.$0.$Ix,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",n,this.$1D.get_$5h(),t,i);return}this.$97O();if(!(this.$6H.get_$NI()&&!this.$1D.get_$5h())){_js.Trace.logInfo(_a.$0.$Ix,"Fetch reminders on OwaStarted event.");this.$15f(0,null)}},$15f:function(n,t){n&&n!==1||$2UN(this,null);this.$1iZ=_js.$K.get_$L().$5G(this.$1iZ);var i=new _c.$l2(this.$1D.get_$5h(),this.$t.get_$6D());i.$1wX=n;i.set_$7hg(this.$1D.get_$Gj()?64:200);var r=_a.$7.get_$2M();switch(n){case 0:i.$9f=r.$2q(10);break;case 1:i.$3N7=r.$9b(_d.$7v.$3xE);i.$9f=i.$9f=r.$2q(10);break;case 2:i.$9f=r.$9b(_d.$7v.$3xE);break}i.add_$2A(this.$$d_$8XW);if(t){var u=this;i.add_$2m(function(n){t()})}OwaApplication.$1T.$y(i)},$4tG:function(n){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$Ix,"DismissReminders called with no reminder to dismiss");return}var i=new _c.$yc(this.$YE,$4PP(this,n));OwaApplication.$1T.$y(i);for(var t=0;t<n.length;t++){$4PO(this,n[t]);n[t].$1M()}$2UM(this,_a.$7.get_utcNow())},$4tD:function(){this.$4tG(this.$Qh.$7V())},$63G:function(n,t){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$Ix,"SnoozeReminders called with no reminders to snooze");return}var u=new _c.$16z($4PP(this,n),t);OwaApplication.$1T.$y(u);for(var f=_a.$7.get_utcNow(),i,r=0;r<n.length;r++){i=n[r];$4PO(this,i);this.$lr.$H(i.$EG);this.$YE.$H(i.$EG)}$2UM(this,f)},$6pb:function(n){for(var t=[],i,r,u,f=this.$lr.get_$F()-1;f>=0;f--){i=this.$lr.get_$48(f);r=this.$43z.$8M(i);if(i.get_$1A0().$aY().$2Y(n)<=0){var e=i.get_$114()?i.get_$114().Id:"";if(this.$13J[e]){u=this.$13J[e];this.$Qh.$3Q(u);u.$1M();this.$13J[e]=r}Array.add(t,r)}else break}if(t.length>0){this.$Qh.$6G(t);this.$lr.$a5(this.$lr.get_$F()-t.length,t.length)}$2UM(this,n)},$97O:function(){_js.Trace.logInfo(_a.$0.$Ix,"Subscribe for reminders notifications.");var n=new _g.$Bm;n.NotificationType="ReminderNotification";var t=new _h.$DH(n);t.$HX(_a.$0.$Ix,"ReminderNotification",this.$$d_$8dk,0)},$6zC:function(n,t){return _c.$VW.$4m0(t,n)},$6yx:function(n,t){return _d.$Fa.$6yz(t,n)},$2KZ:function(n,t){this.$3Xp&&$Bc(this,"ActiveRemindersChanged",n,t)},$8dk:function(n){_a.$3.$M(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_js.Trace.logInfo(_a.$0.$Ix,"Received reminder notification");var t=n;if(t.shouldGetReminders){this.$1iZ&&(this.$1iZ=_js.$K.get_$L().$5G(this.$1iZ));var i=this;this.$1iZ=_js.$K.get_$L().$21(_a.$0.$Ix,"ReminderNotification",function(){i.$15f(0,null)},8e3)}},$8XW:function(n){var t=n;$6Ri(this,t)||$6Rj(this,t)}};_d.$AI=function(n){this.$$d_$8iH=Function.createDelegate(this,this.$8iH);this.$$d_$9D6=Function.createDelegate(this,this.$9D6);this.$$d_$4tD=Function.createDelegate(this,this.$4tD);this.$$d_$7AA=Function.createDelegate(this,this.$7AA);this.$$d_$8g3=Function.createDelegate(this,this.$8g3);this.$$d_$8fG=Function.createDelegate(this,this.$8fG);this.$$d_$8RP=Function.createDelegate(this,this.$8RP);this.$$d_$8SU=Function.createDelegate(this,this.$8SU);this.$$d_$2KZ=Function.createDelegate(this,this.$2KZ);_d.$AI.initializeBase(this);this.$oj=n;n.$Qh.add_$1Z(this.$$d_$2KZ);n.add_$6uO(this.$$d_$8SU);n.add_$6rR(this.$$d_$8RP);this.$Vl=new _js.$X;this.$Vl.$a("Count",this.$$d_$8fG);this.$1w2=[];var t=this;this.$4AC=new _C(this.$$d_$8g3,_d.$AI.$D,this,"CanActOnSelectedReminders",function(){return t.get_$3OQ()});var i=this;this.$3Ut=new _C(this.$$d_$7AA,_d.$AI.$D,this,"CanActOnSelectedReminders",function(){return i.get_$3OQ()});this.$4tE=new _C(this.$$d_$4tD,_d.$AI.$D);this.$1N8=new _C(this.$$d_$9D6,_d.$AI.$D);this.$5lr=new _C(this.$$d_$8iH,_d.$AI.$D);this.$Mc=new _js.$X;$6Rk(this);$3Fq(this,!1);if(_y.$j.$g.get_$O()!=="Mouse"){var r=[new _y.$2f(_y.$c.get_$gI(),_y.$c.get_$1wS(),_u.Strings.l_Snooze_Text,this.$4AC),new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_Dismiss_Text,this.$3Ut)];this.set_$7E(_y.$26.$I(this,r,null))}};function $6Rm(n){for(var i,r=n.$oj.$Qh,t=0;t<r.get_$F();t++){i=r.get_$48(t);i.$9Ey()}}function $3Fq(n,t){var i=[];if(n.$Xo&&n.$Vl.get_$F()===1){var u=_a.$7.get_$2M();var f=n.$Xo.$EG.get_$7p().$Fr(-15);u.$2Y(f)<=0&&Array.add(i,-15);u.$2Y(f.$Fr(5))<=0&&Array.add(i,-10);u.$2Y(f.$Fr(10))<=0&&Array.add(i,-5);u.$2Y(n.$Xo.$EG.get_$7p())<=0&&Array.add(i,0)}if(!i.length||i[0]!==n.$Mc.get_$48(0)){for(var r=0;r<n.$Mc.get_$F();r++)if(n.$Mc.get_$48(r)===5)break;n.$Mc.$a5(0,r);i.length>0&&n.$Mc.$Z6(0,i)}(n.$1xd<n.$Mc.get_$48(0)||t)&&n.set_$5xd(n.$Mc.get_$48(0))}function $6Rk(n){n.$Mc.$H(5);n.$Mc.$H(10);n.$Mc.$H(15);n.$Mc.$H(30);n.$Mc.$H(60);n.$Mc.$H(120);n.$Mc.$H(240);n.$Mc.$H(480);n.$Mc.$H(720);n.$Mc.$H(1440);n.$Mc.$H(2880);n.$Mc.$H(4320);n.$Mc.$H(5760);n.$Mc.$H(10080);n.$Mc.$H(20160)}function $6Rl(n,t){if(t>0)n.$oj.$63G(n.$Vl.$7V(),_a.$7.get_$2M().$Fr(t));else{var i=n.$Xo.$EG.get_$7p().$Fr(t);n.$oj.$63G([n.$Xo],i)}}_d.$AI.prototype={$1N8:null,$oj:null,$Xo:null,$Vl:null,$Mc:null,$1xd:0,$4AC:null,$3Ut:null,$4tE:null,$5lr:null,$1w2:null,get_$Jr:function(){return _y.$j.$g.get_$O()!=="Mouse"?_y.$1De.prototype.get_$Jr.call(this):0},add_$8qH:function(n){this.$2Z("ReminderOpened",n)},remove_$8qH:function(n){this.$2b("ReminderOpened",n)},get_$1Lk:function(){return this.$Xo},set_$1Lk:function(n){if(this.$Xo!==n){this.$Xo=n;$6(this,"SelectedReminder");$3Fq(this,!0)}return n},get_$5xd:function(){return this.$1xd},set_$5xd:function(n){if(n!==this.$1xd){this.$1xd=n;$6(this,"SelectedSnoozeTime")}return n},get_$8w1:function(){return this.$Vl},set_$8w1:function(n){this.$Vl!==n&&(this.$Vl=n);return n},get_$MY:function(){return 2},get_$3OQ:function(){return this.$Vl.get_$F()>0},$9D6:function(){$6Rm(this);$3Fq(this,!1)},$8iH:function(){if(this.$Xo&&this.$Xo.$QA.$2K){this.$Xo.$QA.$s();$Bc(this,"ReminderOpened",this.$Xo,null)}},$8fG:function(n,t){$6(this,"CanActOnSelectedReminders")},$8SU:function(n,t){Array.clear(this.$1w2);for(var r,u,i=0;i<this.$Vl.get_$F();i++){r=this.$Vl.get_$48(i);u=r.$EG.get_$i().Id;Array.add(this.$1w2,u)}this.set_$1Lk(null);this.$Vl.$1u();return},$8RP:function(n,t){var i=n.$Qh;var e;var u;var r;if($8(this.$Xo)){for(var f=0;f<this.$1w2.length;f++){e=this.$1w2[f];var o=this;u=i.$DK(function(n){return _d.$Fa.isInstanceOfType(n)&&n.$EG.get_$i().Id===e});if(u<i.get_$F()){r=i.get_$48(u);$8(this.$Xo)&&this.set_$1Lk(r);this.$Vl.$7h(r)===-1&&this.$Vl.$H(r)}}$8(this.$Xo)&&this.set_$1Lk(i.get_$48(0));Array.clear(this.$1w2)}},$2KZ:function(n,t){var u=!1;var f=!1;var i=n;switch(t.$3R){case 0:return;case 2:for(var r=0;r<t.$3Y.length;r++){u=!!(u|this.$Vl.$3Q(t.$3Y[r]));f=!!(f|t.$3Y[r]===this.$Xo)}if(f||u&&!this.$Vl.get_$F()){var e=t.$4T+t.$3Y.length-1;i.get_$F()>e?this.set_$1Lk(i.get_$48(e)):i.get_$F()>0?this.set_$1Lk(i.get_$48(i.get_$F()-1)):this.set_$1Lk(null)}break;case 3:this.$2KZ(n,new _js.$JN(2,t.$4T,null,t.$3Y));this.$2KZ(n,new _js.$JN(0,t.$4T,t.$2t,null));break;case 4:this.set_$1Lk(null);this.$Vl.$1u();break;default:throw Error.argumentOutOfRange("evtArgs.Action");}},$8g3:function(){$6Rl(this,this.$1xd)},$7AA:function(){this.$oj.$4tG(this.$Vl.$7V())},$4tD:function(){this.$oj.$4tD()}};_d.$15m=function(n,t,i,r,u){this.$$d_$7WP=Function.createDelegate(this,this.$7WP);_d.$15m.initializeBase(this,[u]);this.$2rE=n;this.$2RN=t;this.$8U=i;this.$1n=r};_d.$15m.prototype={$2rE:0,$2RN:0,$gL:1,$8U:null,$3br:!1,$1n:null,$10:function(){_js.Trace.logInfo(_a.$0.$5g,"RetryTimer.Start");this.$3br=!1;this.$21(this.$$d_$7WP,this.$2RN,this.$1n)},$23:function(){_js.Trace.logInfo(_a.$0.$5g,"RetryTimer.End");this.$3br=!0;this.$gL=this.$2rE;this.$3OZ()},$7WP:function(){_js.Trace.logInfo(_a.$0.$5g,"RetryTimer.Callback: count {0}",this.$gL);this.$8U();if(this.$gL<this.$2rE){this.$gL++;this.$21(this.$$d_$7WP,this.$2RN,this.$1n)}else{_js.Trace.logInfo(_a.$0.$5g,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$gL,this.$2rE);this.$23()}}};_d.$Nj=function(n,t,i,r){this.$26f=this.$$gta["_d.$Nj"].T===Number||Type.isEnum(this.$$gta["_d.$Nj"].T)?0:this.$$gta["_d.$Nj"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.$26f=n;this.$5Cx=t;this.$5zw=i;this.$68M=r};_d.$Nj.$$=function(n){var t="$Nj"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Nj"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Nj.apply(this,i)};r.registerClass("_d."+t);var u=_d.$Nj.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$Nj.prototype={$5Cx:null,$5zw:null,$68M:null,$5x:function(n){if(!this.$5Cx(this.$26f)){var t=this;n.$33E(function(n){n?t.$26f=t.$5zw():t.$68M(t.$26f)})}}};_d.$xE=function(n){_d.$xE.initializeBase(this);this.$4lm=n};_d.$xE.prototype={$4lm:null,$8de:function(){if(this.$Vg.get_$F()===1){var n=this.$Vg.get_$48(0);this.$4lm.$8U0(n)}},$76E:function(){this.$rj.$H(_u.Strings.l_SpeechCombinedSearchHint1_Text);this.$rj.$H(_u.Strings.l_SpeechCombinedSearchHint2_Text);this.$rj.$H(_u.Strings.l_SpeechCombinedSearchHint3_Text);this.$rj.$H(_u.Strings.l_SpeechCombinedSearchHint4_Text);this.$S7=new _d.$2s(_d.$Nk.$$(_c.$xD).$L,_u.Strings.l_SpeechCombinedScenarioListening_Text,_u.Strings.l_SpeechCombinedScenarioWithExample_Text,this.$rj);this.$S7.$2lG=_u.Strings.l_SpeechInvalidRequest_Text}};_d.$14d=function(n,t){this.$$d_$1Jv=Function.createDelegate(this,this.$1Jv);this.$$d_$8gH=Function.createDelegate(this,this.$8gH);_d.$14d.initializeBase(this);this.$4dR=n;this.$5gN=t;if(this.get_$3is()){this.$S7.set_$2Qi(new _C(this.$$d_$8gH,_a.$0.$Qb));this.$S7.add_$5EB(this.$$d_$1Jv)}};_d.$14d.prototype={$4dR:null,$5gN:null,$8de:function(){},$76E:function(){this.$rj.$H(_u.Strings.l_SpeechFindPeopleHint1_Text);this.$rj.$H(_u.Strings.l_SpeechFindPeopleHint2_Text);this.$rj.$H(_u.Strings.l_SpeechFindPeopleHint3_Text);this.$rj.$H(_u.Strings.l_SpeechFindPeopleHint4_Text);this.$S7=new _d.$2s(_d.$Nk.$$(_c.$zD).$L,_u.Strings.l_SpeechSayAContactName_Text,_u.Strings.l_SpeechSayAContactNameWithExample_Text,this.$rj);this.$S7.set_$5em(_u.Strings.l_SpeechFindPeopleNoResultsAvailable_Text)},$5F:function(){this.$S7.$5F()},$8gH:function(){this.$5F();this.$4dR()},$1Jv:function(n,t){if(!n.get_$CM()){this.$S7.$42a||this.$5gN();this.$S7.$6e()}}};_d.$tj=function(){this.$1NR=""};_d.$tj.prototype={$3a4:function(n){return new _c.$14e(this.$1NR,n)}};_d.$1Dm=function(){this.$$d_$1Jv_4=Function.createDelegate(this,this.$1Jv_4);this.$$d_$5F=Function.createDelegate(this,this.$5F);_d.$1Dm.initializeBase(this);if(this.get_$3is()){this.$rj=new _js.$X;this.$Vg=new _js.$X;this.$76E();this.$S7.set_$2Qi(new _C(this.$$d_$5F,_a.$0.$Qb));this.$S7.add_$5EB(this.$$d_$1Jv_4)}else this.$S7=null};_d.$1Dm.prototype={$S7:null,$Vg:null,$sa:null,$rj:null,get_$3is:function(){return _a.$BR.get_$L().get_$3is()&&_g.$S.get_$L().get_$38().get_$5E3()},$5F:function(){this.$Vg.$1u();this.$sa=this.$S7.$3a4(this.$Vg);this.$S7.$5F();this.$sa&&OwaApplication.$1T.$y(this.$sa)},$1Jv_4:function(n,t){if(!n.get_$CM()){this.$8de();this.$S7.$6e()}}};_d.$Nk=function(){};_d.$Nk.$$=function(n){var t="$Nk"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var i=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Nk"]={TAction:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Nk.apply(this,i)};i.registerClass("_d."+t,null,_y.$11z);var u=_d.$Nk.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(i.prototype[r.key]=r.value)}i.$L=new i}return _d[t]};_d.$Nk.prototype={$3a4:function(n){var t=new this.$$gta["_d.$Nk"].TAction;t.$3v(_a.$BR.get_$L(),n);return t}};_d.$2s=function(n,t,i,r){this.$$d_$8gE=Function.createDelegate(this,this.$8gE);this.$$d_$8gF=Function.createDelegate(this,this.$8gF);this.$$d_$3xI=Function.createDelegate(this,this.$3xI);this.$$d_$39H=Function.createDelegate(this,this.$39H);this.$$d_$7T8=Function.createDelegate(this,this.$7T8);this.$$d_$AQ=Function.createDelegate(this,this.$AQ);_d.$2s.initializeBase(this);this.set_$Cu(this);this.$4Gh=t;this.$6Bb=i;this.$63c=r;this.$1er=n;this.set_$GT(new _C(this.$$d_$AQ,_a.$0.$Qb));this.set_$7T4(new _C(this.$$d_$7T8,_a.$0.$Qb));this.$2jc=!1;this.set_$64K(new _C(this.$$d_$39H,_a.$0.$Qb));this.set_$2Wx(new _js.$X);this.$2lG=_u.Strings.l_SpeechInvalidRequest_Text;this.set_$38C(!0)};_d.$2s.$8Yp=function(n){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnIsErrorChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$355.set_$15(!n.newValue);t.$w3.set_$15(!n.newValue)};_d.$2s.$8Yu=function(n){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnIsListeningChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$qL.set_$15(!n.newValue);t.$2iY.set_$15(!n.newValue)};_d.$2s.$8Z0=function(n){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnIsThinkingChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$qL.set_$15(!n.newValue)};function $6SV(n,t){$4Pi(n);switch(_a.$4F.$3Yd(t).$1u1){case 1e3:$3Fy(n);n.set_$5N(n.get_$5em());n.set_$38C(!1);break;case 1:$3Fy(n);n.set_$5N(_u.Strings.l_SpeechHintTitle_Text);n.set_$38C(!1);n.$2jc=!1;break;case 1003:$3Fy(n);n.set_$5N(n.$2lG);break;case 5:n.set_$5N(_u.Strings.l_SpeechNoNetworkAccess_Text);n.set_$pB(_u.Strings.l_SpeechNoNetworkAction_Text);break;case 4:case 3:n.set_$5N(_u.Strings.l_SpeechRecordingError_Text);n.set_$pB(_u.Strings.l_SpeechNoMicrophone_Text);break;case 1002:n.set_$5N(_u.Strings.l_SpeechRecordingError_Text);n.set_$pB(_u.Strings.l_SpeechNoSpeech_Text);break;case 1006:n.set_$5N(_u.Strings.l_SpeechNoResultsAvailable_Text);n.set_$pB(_u.Strings.l_SpeechNoContactWithEmailAddress_Text);break;case 6:n.set_$5N(_u.Strings.l_SpeechServerError_Text);n.set_$pB(_u.Strings.l_SpeechServerBusy_Text);break;case 1005:n.set_$5N(_u.Strings.l_SpeechServerError_Text);n.set_$pB(_u.Strings.l_SpeechInvalidCredentials_Text);break;case 1004:n.set_$5N(n.$2lG);n.set_$pB(_u.Strings.l_SpeechMaxRequestsExceeded_Text);break;default:n.set_$5N(_u.Strings.l_SpeechServerError_Text);n.set_$pB(t.message);break}}function $3Fy(n){n.set_$pB(n.$6Bb);n.set_$2Wx(n.$63c)}function $4Pi(n){n.set_$pB("");n.set_$5N("");n.set_$2Wx(null);n.$42a=!1;n.set_$38C(!0)}function $6SW(n){n.set_$OO(new _js.$X);n.$355=new _a.$2E(n.get_$2Qi(),_u.Strings.l_Retry_Text);n.$355.set_$15(!0);n.$6g.$H(n.$355);n.$2iY=new _a.$2E(n.get_$64K(),_u.Strings.l_Go_Text);n.$2iY.set_$15(!0);n.$6g.$H(n.$2iY);n.$qL=new _a.$2E(n.$4a,_u.Strings.l_ConfirmDialog_Cancel_Text);n.$qL.set_$15(!0);n.$6g.$H(n.$qL);n.$w3=new _a.$2E(n.$4a,_u.Strings.l_Close_Text);n.$w3.set_$15(!0);n.$6g.$H(n.$w3)}_d.$2s.prototype={$Tn:null,$355:null,$2iY:null,$qL:null,$w3:null,$63c:null,$4Gh:null,$6Bb:null,$2lG:null,$42a:!1,$38B:!1,$2jY:null,$1er:null,$2jc:!1,add_$5EB:function(n){this.$a(_d.$2s.$2EV.$1j,n)},remove_$5EB:function(n){this.$w(_d.$2s.$2EV.$1j,n)},get_$2Qi:function(){return this.$W(_d.$2s.$4Am)},set_$2Qi:function(n){this.$N(_d.$2s.$4Am,n);return n},get_$64K:function(){return this.$W(_d.$2s.$4B0)},set_$64K:function(n){this.$N(_d.$2s.$4B0,n);return n},get_$1nF:function(){return this.$W(_d.$2s.$3gH)},set_$1nF:function(n){this.$N(_d.$2s.$3gH,n);return n},get_$CM:function(){return this.$W(_d.$2s.$2EV)},set_$CM:function(n){this.$N(_d.$2s.$2EV,n);return n},get_$3h8:function(){return this.$W(_d.$2s.$3h9)},set_$3h8:function(n){this.$N(_d.$2s.$3h9,n);return n},get_$3jA:function(){return this.$W(_d.$2s.$3jB)},set_$3jA:function(n){this.$N(_d.$2s.$3jB,n);return n},get_$3iZ:function(){return this.$W(_d.$2s.$3ia)},set_$3iZ:function(n){this.$N(_d.$2s.$3ia,n);return n},get_$pB:function(){return this.$W(_d.$2s.$4As)},set_$pB:function(n){this.$N(_d.$2s.$4As,n);return n},get_$5em:function(){return this.$W(_d.$2s.$3wZ)},set_$5em:function(n){this.$N(_d.$2s.$3wZ,n);return n},get_$2Wx:function(){return this.$W(_d.$2s.$3KU)},set_$2Wx:function(n){this.$N(_d.$2s.$3KU,n);return n},get_$63e:function(){return this.$W(_d.$2s.$4AX)},set_$63e:function(n){this.$N(_d.$2s.$4AX,n);return n},get_$63b:function(){return this.$Tn},set_$63b:function(n){if(n){if(this.$Tn)throw Error.invalidOperation("SpeechAction cannot be set while another speech action is active");this.$Tn=n;this.$Tn.add_$2m(this.$$d_$3xI);this.$Tn.$uo.add_$647(this.$$d_$8gF);this.$Tn.$uo.add_$5G8(this.$$d_$8gE)}else if(this.$Tn){this.$Tn.remove_$2m(this.$$d_$3xI);this.$Tn.$uo.remove_$647(this.$$d_$8gF);this.$Tn.$uo.remove_$5G8(this.$$d_$8gE);this.$Tn=null}return n},get_$38C:function(){return this.$38B},set_$38C:function(n){if(this.$38B!==n){this.$38B=n;$6(this,"ShowShortPanelSize")}return n},get_$7T4:function(){return this.$2jY},set_$7T4:function(n){if(this.$2jY!==n){this.$2jY=n;$6(this,"HelpCommand")}return n},$3a4:function(n){this.set_$63b(this.$1er.$3a4(n));return this.$Tn},$5F:function(){$6SW(this);this.set_$5N(this.$4Gh)},$6e:function(){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.Deactivate");this.$AQ()},$8gF:function(n){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnSpeechStateChanged: {0}",_a.$oM.toString(n));$4Pi(this);this.set_$3h8(n===1);this.set_$3jA(n===2);if(this.get_$3h8()){this.set_$1nF(!1);this.set_$3iZ(!1);this.set_$5N(this.$4Gh);this.set_$CM(!0)}else if(this.get_$3jA()){this.set_$5N(_u.Strings.l_SpeechThinkingState_Text);this.set_$pB(_u.Strings.l_SpeechPleaseWait_Text);this.$Tn.$5HG("Thinking")}},$8gE:function(n){this.set_$63e(n)},$39H:function(){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.StopListening");this.$Tn.$39H()},$AQ:function(){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.Cancel");this.set_$CM(!1);if(this.$Tn){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.Cancel: speechAction != null calling SpeechAction.Cancel()");this.$Tn.$AQ()}},$7T8:function(){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.HelpPressed");this.$2jc=!0;this.$Tn.$AQ()},$3xI:function(n){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnActionCompleted");var t=this.$Tn.$1b;this.$Tn.$Vg.get_$F()>0&&(this.$42a=!0);this.set_$63b(null);this.set_$1nF(!1);if(!$8(t)){_js.Trace.logInfo(_a.$0.$Qb,"SpeechInputViewModel.OnActionCompleted: Error:{0}",t.message);if(!_a.$4F.$RF(t)||this.$2jc){this.set_$1nF(!0);$6SV(this,t);this.set_$3iZ(_a.$4F.$3iZ(t))}}this.set_$CM(this.get_$1nF())}};_d.$MI=function(n){_d.$MI.initializeBase(this);this.$NO=n};function $6Sp(n){var t=!1;switch(n.$7R){case 1:n.$2E=n.$XD.$2P(10);t=n.$XD.get_$7aF();n.set_$3cn(!t);n.$NO==="Mouse"?n.set_$3jc(n.$XD.$2P(3)):n.$NO==="TouchWide"&&n.set_$47R(t?_a.$7.$3Yz(n.$XD.$2q(1).get_$3D(),1):null);break;case 2:n.$2E=_a.$7.$3Yz(n.$XD.get_$3D(),1);t=n.$XD.get_$3D()===11;n.set_$3cn(!t);n.$NO==="Mouse"?n.set_$3jc(n.$XD.$2P(2)):n.$NO==="TouchWide"&&n.set_$47R(t?n.$XD.$GR(1).$2P(13,1):null);break;case 3:var i=_a.$7.$Kn(n.$XD);var r=i.$2q(6);n.$2E=_a.$7.$7OB(i,r);n.set_$3cn(!0);n.set_$47R(null);n.$NO==="Mouse"&&n.set_$3jc(_a.$7.$2AA(i,r));break;default:throw Error.argumentOutOfRange("mode",n.$7R,"GenerateTextValue() should not be called before the TimeStripMode has been set.");}if(n.$NO==="Mouse"){var u=n.$2E.replace(" ","");if(n.$2E!==u){n.$2E=u;if(!_d.$MI.$3lP){_js.Trace.logWarning(_a.$0.$1o,"Removing space character from localized time strip item. This is only expected for for pesudo-localized builds.");_d.$MI.$3lP=!0}}}}_d.$MI.prototype={$2E:null,$1bK:null,$3jb:null,$2k5:!0,$7R:0,$XD:null,$NO:0,get_$3jc:function(){return this.$3jb},set_$3jc:function(n){this.$3jb=n;$6(this,"ItemAriaLabel");return n},get_$5z:function(){return this.$XD},set_$5z:function(n){this.$XD=n;$6Sp(this);return n},get_$3cn:function(){return this.$2k5},set_$3cn:function(n){if(n!==this.$2k5){this.$2k5=n;$6(this,"HideSeparator")}return n},get_$47R:function(){return this.$1bK},set_$47R:function(n){if(n!==this.$1bK){this.$1bK=n;$6(this,"SeparatorText")}return n}};_d.$vF=function(n){this.$28=n};_d.$vF.prototype={$28:null,$1Fx:null,$21:function(n,t,i){this.$1Fx=_js.$K.get_$L().$21(i,this.$28,n,t)},$3OZ:function(){this.$1Fx&&(this.$1Fx=_js.$K.get_$L().$5G(this.$1Fx))}};_d.$TW=function(n,t,i,r,u,f){this.$$d_$7ez=Function.createDelegate(this,this.$7ez);this.$G=n;this.$t=t;this.$S=i;this.$AF=r;this.$30=u;this.$6W=f};function $6Mo(n){var i="archiverecoverableitemsdeletions";var t=new _h.$fx("GetFolderAction_DumpsterPopOutViewModelFactory_"+i,!1);t.$1SB=new _h.$Tp;t.$bT=[new _g.$7o(i)];t.add_$2m(n.$$d_$7ez);OwaApplication.$1T.$y(t)}_d.$TW.prototype={$AF:null,$30:null,$6W:null,$G:null,$t:null,$S:null,$1RS:null,$ct:function(n){var t=n.IsArchive.toString()==="true";this.$1RS=new _d.$qp(new _d.$CM(this.$G,this.$t,this.$S,this.$AF,this.$30,this.$6W));if(t&&!_g.$g.$1i.nameToId("archiverecoverableitemsdeletions"))$6Mo(this);else{var i=t?_g.$2Q.$9K("archiverecoverableitemsdeletions"):_g.$2Q.$9K("recoverableitemsdeletions");this.$1RS.$bL.set_$2j(i);this.$1RS.$bL.$RQ(0)}return this.$1RS},$wD:function(n){throw Error.notImplemented("Creating from context is not supported");},$5i:function(n){var t={};t.IsArchive=n;this.$G.$5i(_d.$TW,null,t,_y.$3p.get_$ws())},$7ez:function(n){var t=n;t.remove_$2m(this.$$d_$7ez);if(t.$1b){this.$1RS.$bL.set_$S4(11);return}this.$1RS.$bL.set_$2j(t.$1SB.get_$48(0));this.$1RS.$bL.$RQ(0)}};_d.$TW.$41v=function(n){this.$bS=n;var t=this;this.$bS.$S.$HX(_y.$oH,function(n){t.$bS.$5i(n.$2B.get_$9H()==="archivedeleteditems")})};_d.$TW.$41v.prototype={$bS:null};_d.$kZ=function(n,t,i){this.$1i=n;this.$Lo=t;this.$1K=i||null};_d.$kZ.prototype={$1i:null,$Lo:null,$1K:null,$4pA:function(n,t){return new _d.$Av(n,this.$1i,t,this.$Lo)},$4oD:function(n){return new _d.$z4(this.$Lo,n,this.$1K)}};_d.$z4=function(n,t,i){this.$Lo=n;this.$1FR=t;this.$1K=i||null};_d.$z4.prototype={$Lo:null,$1K:null,$1FR:0,$7DD:function(n,t){_a.$5.stPT(_a.$0.$5g,"AppActivationInComposeForm",5);for(var a=_a.$5.$1V(_a.$0.$5g,"AppActivationInComposeForm",!0),v=_a.$7.get_$2M(),u=new(_0365f.$s.$$(_d.$HQ)),r=0;r<n.length;r++){var f=n[r];var i;var e,o;if(o=_d.$HQ.$67m(f,new _d.$qv(this.$Lo,this.$1FR),e={val:i}),i=e.val,o){var s=null;var y=_a.$7.get_$2M();var h,c;var l=i.$1O8?(c=i.$1O8.$2ff(null,i.$ht,h={val:s}),s=h.val,c):!1;var p=_a.$7.get_$2M();l&&u.$H(i);this.$Lo.$67F(f.Id,p.$6E(y),l)}}this.$Lo.$67K(_a.$7.get_$2M().$6E(v));t(u);this.$Ar();this.$Lo.$4xF();_a.$5.$1G(a,"AppActivationInComposeForm");_a.$5.endPT("AppActivationInComposeForm")},$91H:function(){return!!this.$1K&&this.$1K.$7x("ComposeApps")},$Ar:function(){}};_d.$Av=function(n,t,i,r){this.$P=n;this.$59W=i;this.$Lo=r;this.$1i=t};function $6N6(n,t){if(!_d.$Av.$2KC){_d.$Av.$2KC={};for(var i=0;i<_d.$Av.$3wQ.length;i++){var u=_d.$Av.$3wQ[i];var r=n.$1i.nameToId(u);r&&(_d.$Av.$2KC[r.Id]=!0)}}return!(t in _d.$Av.$2KC)}function $4ND(n,t){if(n.$1jq){_a.$5.stPT(_a.$0.$5g,"AppActivationInReadingPane",5);var h=_a.$5.$1V(_a.$0.$5g,"AppActivationInReadingPane",!0);var u=new(_0365f.$s.$$(_d.$HQ));n.$Lo.$67G(n.$P.get_$332(),n.$P.get_$x2());for(var c=_a.$7.get_$2M(),f=null,r=0;r<n.$1jq.get_$F();r++){var i=n.$1jq.get_$48(r);var l=_a.$7.get_$2M();var e,o;var s=(o=$6N7(n,i,e={val:f}),f=e.val,o);var a=_a.$7.get_$2M();if(s){u.$H(i);i.$8yW(n.$P.get_$x2())}n.$Lo.$67F(i.$9g.Id,a.$6E(l),s)}n.$Lo.$67K(_a.$7.get_$2M().$6E(c));t(u);n.$Ar();n.$Lo.$4xF();_a.$5.$1G(h,"AppActivationInReadingPane","");_a.$5.endPT("AppActivationInReadingPane")}}function $6N7(n,t,i){if($8(t)||$8(t.$1O8))return!1;var r=!1;t.$ht.$2NK={};r=!!(r|t.$1O8.$2ff(n.$P,t.$ht,i));return r}function $6N5(n,t){var i=new _c.$rH(n.$P);var r=this;i.add_$2A(function(i){$4ND(n,t)});OwaApplication.$1T.$y(i)}_d.$Av.prototype={$59W:!1,$P:null,$Lo:null,$1jq:null,$1i:null,$7DD:function(n,t){var u=!0;this.$1jq=new(_0365f.$s.$$(_d.$HQ));for(var r=0;r<n.length;r++){var s=n[r];var f=new _d.$qv(this.$Lo,1);f.$iO=this.$59W;var i;var e,o;if(o=_d.$HQ.$67m(s,f,e={val:i}),i=e.val,o){this.$1jq.$H(i);i.$1O8&&(i.$1O8.$5B2(this.$P,i.$ht)||(u=!1))}}u?$4ND(this,t):$6N5(this,t)},$91H:function(){if(this.$P.get_$5D()||this.$P.get_$CK())return!1;if(this.$P.get_$7G()){var n=this.$P.get_$7G().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$P.get_$22()&&!$6N6(this,this.$P.get_$22().Id)?!1:!0},$Ar:function(){this.$1jq=null}};_d.$p9=function(n,t,i,r){this.$$d_$9Fl=Function.createDelegate(this,this.$9Fl);this.$$d_$6tl=Function.createDelegate(this,this.$6tl);_d.$p9.initializeBase(this,[i,r]);this.$Cy=n;this.$1D2=t};_d.$p9.$7K5=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_d.$p9.prototype={$Cy:null,$1D2:null,$1Cw:null,$7Dc:function(){var n;if(!this.$9C2()){$vD(this);return}var t,i,r;if(r=this.$9BU(t={val:n},i={val:this.$1Cw}),n=t.val,this.$1Cw=i.val,r){this.$1Cw.add_$8C(this.$$d_$6tl);this.$1Cw.add_$1up(this.$$d_$9Fl)}else{$kU(this,n,null);return}},$9Fl:function(n){this.$1Cw.remove_$1up(this.$$d_$9Fl);if(n.get_$5lu()){var t=_d.$p9.$7K5(n.get_$2YY());$kU(this,t,null);return}var i=this.$1D2.$H(this.$1Cw);$dU(this,i,null)},$6tl:function(n,t){if(t==="IsDeleted"&&this.$1Cw.get_$y5()){this.$1Cw.remove_$8C(this.$$d_$6tl);$kU(this,9006,null)}}};_d.$vk=function(n,t,i,r){_d.$vk.initializeBase(this,[n,t,i,r])};_d.$vk.prototype={get_$VS:function(){return"AddItemAttachment"},$9C2:function(){var n=this.$x.itemId;var t=this.$x.name;if(_js.$8.$c(n)||_js.$8.$c(t)){_js.Trace.logError(_a.$0.$5g,"AddItemAttachment got null or empty itemId or name");return!1}else if(n.length>200||t.length>255){_js.Trace.logError(_a.$0.$5g,"AddItemAttachment got too long itemId or name");return!1}else return!0},$9BU:function(n,t){var r=this.$x.itemId;var u=this.$x.name;var i=new _g.$97;i.set_$i(new _g.$1j(r));i.set_$1Q(u);i.set_$8Y(!1);i.set_$5y(0);t.val=this.$Cy.$4dw(i,n);return!!t.val}};_d.$vi=function(n,t,i,r){_d.$vi.initializeBase(this,[n,t,i,r])};_d.$vi.prototype={get_$VS:function(){return"AddFileAttachment"},$9C2:function(){var n=this.$x.uri;var t=this.$x.name;if(_js.$8.$c(n)||_js.$8.$c(t)){_js.Trace.logError(_a.$0.$5g,"AddFileAttachment got null or empty uri or name");return!1}else if(n.length>2048||t.length>255){_js.Trace.logError(_a.$0.$5g,"AddFileAttachment got too long uri or name");return!1}else return!0},$9BU:function(n,t){var i=this.$x.uri;var r=this.$x.name;t.val=this.$Cy.$4dn(i,r,n);return!!t.val}};_d.$pC=function(n,t,i,r){_d.$pC.initializeBase(this,[t,i]);this.$Cy=n;this.$3PS=r};_d.$pC.prototype={$Cy:null,$3PS:!1,get_$VS:function(){return this.$3PS?"SetRecipients":"AddRecipients"},$9BY:function(n,t){t.val=new(_0365f.$s.$$(_g.$1m));if($8(n)||!n.length)return!0;for(var o=n.length,r=0;r<o;r++){var u=n[r];var f=u.address;var e=u.name;if(e.length>255){_js.Trace.logError(_a.$0.$5g,"Add/SetRecipientsAsync got displayName lengths over the limit");$vD(this);return!1}if(_a.$3I.$OZ(f)){var i=new _g.$1m;i.EmailAddress=f;i.Name=e;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$H(i)}}if(t.val.get_$F()>0)return!0;else{$kU(this,9013,null);return!1}},$7Dc:function(){var t=this.$x.recipientField;var i=this.$x.recipientArray;var n;if(i.length>100){_js.Trace.logError(_a.$0.$5g,"Add/SetRecipientsAsync got more recipients in the list than the limit.");$vD(this);return}var r,u;if(u=this.$9BY(i,r={val:n}),n=r.val,u){if(this.$3PS)this.$Cy.$8zY(t,n);else if(!this.$Cy.$9BQ(t,n)){$kU(this,9012,null);return}$dU(this,null,null)}}};_d.$3n=function(n,t){this.$x=n;this.$1ws=t};function $dU(n,t,i){n.$1ws(_d.$2T.$76K(t));_a.$5.$1G(n.$19M,n.get_$VS(),"",i);_a.$5.endPT(n.get_$VS())}function $kU(n,t,i){n.$1ws(_d.$2T.$73o(t));_a.$5.$1G(n.$19M,n.get_$VS(),_d.$OI.$7hC(t),i);_a.$5.endPT(n.get_$VS())}function $2Td(n,t,i){n.$1ws(t);_a.$5.$1G(n.$19M,n.get_$VS(),"",i);_a.$5.endPT(n.get_$VS())}function $6JK(n,t,i,r){n.$1ws(t);_a.$5.$1G(n.$19M,n.get_$VS(),i,r);_a.$5.endPT(n.get_$VS())}function $vD(n){n.$1ws(null);_a.$5.$1G(n.$19M,n.get_$VS(),"NonAPI",null);_a.$5.endPT(n.get_$VS())}_d.$3n.prototype={$x:null,$1ws:null,$19M:null,$s:function(){_a.$5.stPT(_a.$0.$5g,this.get_$VS(),5);this.$19M=_a.$5.$1V(_a.$0.$5g,this.get_$VS(),!0);this.$7Dc()}};_d.$we=function(n,t,i,r){_d.$we.initializeBase(this,[n,t,i,r])};_d.$we.prototype={get_$VS:function(){return"BodySetSelectedData"},$2l7:function(n){this.$Cy.$7WE(n);$dU(this,null,null)}};_d.$wd=function(n,t,i,r){_d.$wd.initializeBase(this,[n,t,i,r])};_d.$wd.prototype={get_$VS:function(){return"BodyPrepend"},$2l7:function(n){this.$Cy.$8mD(n);$dU(this,null,null)}};_d.$fi=function(){};_d.$Ti=function(){};_d.$z3=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8yy=Function.createDelegate(this,this.$8yy);this.$$d_$7LO=Function.createDelegate(this,this.$7LO);this.$$d_$8zx=Function.createDelegate(this,this.$8zx);this.$$d_$7Oq=Function.createDelegate(this,this.$7Oq);_d.$z3.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$bR=n};_d.$z3.prototype={$bR:null,$6r7:function(n,t){n.itemType=5;var i=this;_d.$1DH.prototype.$6r7.call(this,n,function(){t()})},$3K7:function(n){n.$6G([_d.$4o.$I("GetTimeAsync",this.$$d_$7Oq),_d.$4o.$I("SetTimeAsync",this.$$d_$8zx),_d.$4o.$I("GetLocationAsync",this.$$d_$7LO),_d.$4o.$I("SetLocationAsync",this.$$d_$8yy)]);_d.$1DH.prototype.$3K7.call(this,n)},$7Oq:function(n,t){new _d.$10i(this.$bR,n,t).$s()},$8zx:function(n,t){new _d.$16k(this.$bR,n,t).$s()},$8yy:function(n,t){new _d.$16X(this.$bR,n,t).$s()},$7LO:function(n,t){new _d.$105(this.$bR,n,t).$s()}};_d.$ka=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_d.$ka.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p])};function $6N0(n,t,i){if(!n.get_$1Gb()){_d.$5z.$1fC(i,"to",t.get_$72(),t.get_$Cl());_d.$5z.$1fC(i,"cc",t.get_$8A(),null);_d.$5z.$1fC(i,"resources",t.get_$9D(),null);t.get_$Cl()&&_d.$5z.$3KS(i,"organizer",t.get_$Cl())}t.get_$4h()&&(i.location=t.get_$4h().get_$1l());t.get_$10()&&(i.start=t.get_$10().$1Ff().getTime());t.get_$23()&&(i.end=t.get_$23().$1Ff().getTime())}_d.$ka.prototype={$6r7:function(n,t){var i=this.$P.get_$7G()?this.$P.get_$7G().toLowerCase():"";if(_d.$KN.$58t(i)){n.itemType=2;var r=this.$P;$6N0(this,r,n)}var u=this;_d.$5z.prototype.$6r7.call(this,n,function(){t()})}};_d.$1DH=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$4vb=Function.createDelegate(this,this.$4vb);this.$$d_$4vZ=Function.createDelegate(this,this.$4vZ);this.$$d_$8mE=Function.createDelegate(this,this.$8mE);this.$$d_$8zj=Function.createDelegate(this,this.$8zj);this.$$d_$8zq=Function.createDelegate(this,this.$8zq);this.$$d_$7OS=Function.createDelegate(this,this.$7OS);this.$$d_$8zZ=Function.createDelegate(this,this.$8zZ);this.$$d_$6qf=Function.createDelegate(this,this.$6qf);this.$$d_$7NB=Function.createDelegate(this,this.$7NB);this.$$d_$1aF=Function.createDelegate(this,this.$1aF);this.$$d_$4dn=Function.createDelegate(this,this.$4dn);this.$$d_$4dw=Function.createDelegate(this,this.$4dw);_d.$1DH.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$Cy=n};_d.$1DH.prototype={$Cy:null,$1D2:null,get_$3MK:function(){this.$1D2||(this.$1D2=new(_d.$YS.$$(_y.$lQ))(this.$IZ.$9g.Id));return this.$1D2},$4dw:function(n,t){new _d.$vk(this.$Cy,this.get_$3MK(),n,t).$s()},$4dn:function(n,t){new _d.$vi(this.$Cy,this.get_$3MK(),n,t).$s()},$1aF:function(n,t){new _d.$15X(this.get_$3MK(),n,t).$s()},$7NB:function(n,t){new _d.$l1(this.$Cy,n,t).$s()},$8zZ:function(n,t){new _d.$pC(this.$Cy,n,t,!0).$s()},$6qf:function(n,t){new _d.$pC(this.$Cy,n,t,!1).$s()},$7OS:function(n,t){new _d.$10e(this.$Cy,n,t).$s()},$8zq:function(n,t){new _d.$16h(this.$Cy,n,t).$s()},$8zj:function(n,t){new _d.$we(this.$Cy,n,t,this.$p).$s()},$8mE:function(n,t){new _d.$wd(this.$Cy,n,t,this.$p).$s()},$6r7:function(n,t){t()},$3K7:function(n){_d.$2T.prototype.$3K7.call(this,n);n.$6G([_d.$4o.$I("AddItemAttachmentAsync",this.$$d_$4dw),_d.$4o.$I("AddFileAttachmentAsync",this.$$d_$4dn),_d.$4o.$I("RemoveAttachmentAsync",this.$$d_$1aF),_d.$4o.$I("GetRecipientsAsync",this.$$d_$7NB),_d.$4o.$I("AddRecipientsAsync",this.$$d_$6qf),_d.$4o.$I("SetRecipientsAsync",this.$$d_$8zZ),_d.$4o.$I("GetSubjectAsync",this.$$d_$7OS),_d.$4o.$I("SetSubjectAsync",this.$$d_$8zq),_d.$4o.$I("BodySetSelectedDataAsync",this.$$d_$8zj),_d.$4o.$I("BodyPrependAsync",this.$$d_$8mE),_d.$4o.$I("LoadCustomProperties",this.$$d_$4vZ),_d.$4o.$I("SaveCustomProperties",this.$$d_$4vb)])},$4vb:function(n,t){new _d.$cU(this.$Cy,n,this.$IZ.$9g.Id,t).$s()},$4vZ:function(n,t){new _d.$135(this.$Cy,n,this.$IZ.$9g.Id,this.$p,t).$s()}};_d.$2T=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$7eN=Function.createDelegate(this,this.$7eN);this.$$d_$7Dh=Function.createDelegate(this,this.$7Dh);this.$$d_$7Dg=Function.createDelegate(this,this.$7Dg);this.$$d_$7Di=Function.createDelegate(this,this.$7Di);this.$$d_$7Dq=Function.createDelegate(this,this.$7Dq);this.$$d_$9Ar=Function.createDelegate(this,this.$9Ar);this.$$d_$8p5=Function.createDelegate(this,this.$8p5);this.$$d_$8p3=Function.createDelegate(this,this.$8p3);this.$$d_$7Dz=Function.createDelegate(this,this.$7Dz);this.$$d_$7Dn=Function.createDelegate(this,this.$7Dn);this.$$d_$7Kr=Function.createDelegate(this,this.$7Kr);this.$$d_$8XH=Function.createDelegate(this,this.$8XH);this.$G=n;this.$v2=t;this.$1NJ=i;this.$aa=r;this.$SJ=u;this.$Db=f;this.$La=e;this.$Gk=o;this.$6M=s;this.$Kr=h;this.$sR=c;this.$9I=a;this.$p=v};_d.$2T.$51M=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_d.$2T.$76K=function(n){return{error:0,data:n}};_d.$2T.$73o=function(n){return{error:1,errorCode:n}};function $vF(n,t,i,r){if(t>i){_js.Trace.logWarning(_a.$0.$5g,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",r,n.$IZ.$9g.DisplayName,i,t);return!0}return!1}function $1e3(n,t,i){if(n.$3zw<3){var r=t.val;var u=this;t.val=function(t){$6N1(n);r(t)};n.$3zw++;return!0}t.val(i);return!1}function $6N1(n){n.$3zw--}function $4N8(n,t,i){var r="";_c.$CF.get_$L().$3QQ(t)&&(r=_c.$CF.get_$L().$7P7(t).TokenValue);i({wasSuccessful:!0,token:r})}function $4N5(n,t,i,r){for(var e=new(_0365f.$s.$$(String)),u=0;u<n.$Yq.Extensions.length;u++){var o=n.$Yq.Extensions[u];(t==="CallerIdentity"&&o.RequestedCapabilities>=1||t==="ExtensionCallback"&&o.RequestedCapabilities===2)&&e.$H(n.$Yq.Extensions[u].Id)}var f=new _c.$rE(e.$7V(),t);f.add_$2A(i);f.add_$20(r);n.$p.$y(f)}function $4N7(n,t,i,r){var e=i;var o=e.body;var f="";if(_c.$CF.get_$L().$3QO(t.Id)){f=_c.$CF.get_$L().$7K6(t.Id).TokenValue;var u=new _c.$qw(o,f,t.Id);var s=this;u.add_$2A(function(t){r({wasProxySuccessful:u.get_$cu().WasProxySuccessful,errorMessage:u.get_$cu().ErrorMessage,statusCode:u.get_$cu().StatusCode,statusDescription:u.get_$cu().StatusDescription,body:u.get_$cu().Body});n.$JL(n.$1Rj,"ExecuteEwsRequest","",u)});var h=this;u.add_$20(function(t){r({wasProxySuccessful:!1,errorMessage:u.$1b.message,statusCode:500,statusDescription:u.$1b.message,body:null});n.$JL(n.$1Rj,"ExecuteEwsRequest",u.$1b.message,u)});n.$p.$y(u)}else r({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})}function $6N2(n,t){var i=new _d.$TB;if("requiredAttendees"in t){i.set_$72(new _js.$X);var r=t.requiredAttendees;if($vF(n,r.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var u=0;u<r.length;u++)i.get_$72().$H(_g.$3X.$4yR(r[u]))}if("optionalAttendees"in t){i.set_$8A(new _js.$X);var f=t.optionalAttendees;if($vF(n,f.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var e=0;e<f.length;e++)i.get_$8A().$H(_g.$3X.$4yR(f[e]))}if("start"in t&&!$8(t.start)){var a=t.start;var v=new Date(a);i.set_$10(_a.$7.$4yO(v))}else{var y=_a.$25.$3RL(_a.$7.get_$2M());i.set_$10(y)}if("end"in t){var p=t.end;var w=new Date(p);i.set_$DE(_a.$7.$4yO(w).$6E(i.get_$10()))}else i.set_$DE(_d.$fi.$3Tm);if("subject"in t){var s=t.subject;if($vF(n,s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;i.set_$2h(s)}if("body"in t){var o=t.body;if($vF(n,o.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var h;h=n.$G.get_$O()==="Mouse"?new _g.$67("HTML",_a.$1T.$3Qo(o)):new _g.$67("Text",o);var b=new _g.$66(h);i.set_$3c(b)}var c=_g.$3G.$qo();if("location"in t){var l=t.location;if($vF(n,l.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;c.set_$1l(l)}i.set_$4h(c);return i}function $6N3(n,t,i){var u=_h.$1M.get_$L();var r=u.$3k(t);if($8(r)||$8(r.get_$3c()))if(!$8(r)&&r.get_$CK())$4N6(n,t,r.get_$cY(),i);else{var e=this;var f=function(r){r.get_$CK()?$4N6(n,t,r.get_$cY(),i):i(r)};$4NA(n,t,_h.$11.get_$yZ(),"ItemNormalizedBody",f)}else i(r)}function $4N6(n,t,i,r){var u;u=n.$G.get_$O()==="Mouse"&&i!==1?_h.$11.get_$1pi():_h.$11.get_$2qh();$4NA(n,t,u,"MailCompose",r)}function $4NA(n,t,i,r,u){var e=new _g.$1j(t);var f=new _h.$kx(100,[e],i,r,0,!1);var o=this;f.add_$2A(function(n){var i=_h.$1M.get_$L().$3k(t);u(i)});n.$p.$y(f)}function $4N9(n,t){n.$G.$9T(t)}_d.$2T.prototype={$G:null,$v2:null,$1NJ:null,$aa:null,$SJ:null,$Yq:null,$ht:null,$IZ:null,$3zw:0,$47a:null,$6M:null,$p:null,$Db:null,$La:null,$Gk:null,$Kr:null,$sR:null,$369:null,$3XC:!1,$1Rj:null,$1jl:null,$1jm:null,$1Hj:null,$2jQ:!1,$9I:null,get_$1Gb:function(){return!this.$IZ.$9g.RequestedCapabilities},$3v:function(n,t,i){this.$IZ=n;this.$Yq=t;this.$ht=i},$7Kr:function(n,t){var u=_a.$5.acsa(_a.$0.$5g,"GetInitialData",!0);var i={};i.permissionLevel=this.$IZ.$9g.RequestedCapabilities;i.timeZoneOffsets=this.$7Ot();i.hostVersion=this.$G.get_$20w();i.owaView=_d.$2T.$51M(this.$G.get_$O());i.overrideWindowOpen=this.$9I.get_$1jE().get_$2pq();if(!this.get_$1Gb()){i.userDisplayName=this.$aa;i.userEmailAddress=this.$SJ;i.userTimeZone=this.$1NJ;i.ewsUrl=this.$Yq.EwsUrl}var r=this;this.$6r7(i,function(){_a.$5.acea(u);t(i);r.$3XC=!0;r.$3WH()})},$8pk:function(){if(!this.$2jQ){if(!this.$1Hj){this.$1Hj=new(_0365f.$s.$$(_d.$4o));this.$3K7(this.$1Hj)}for(var n=0;n<this.$1Hj.get_$F();n++){var t=this.$1Hj.get_$48(n);this.$47a.registerMethod(t.$Of,t.$1qF,0,t.$4ht)}this.$2jQ=!0}},$9CZ:function(){if(this.$2jQ&&this.$1Hj){for(var n=0;n<this.$1Hj.get_$F();n++){var t=this.$1Hj.get_$48(n);this.$47a.unregisterMethod(t.$Of)}this.$2jQ=!1}},$7Dn:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteEwsRequest",5);this.$1Rj=_a.$5.$1V(_a.$0.$5g,"ExecuteEwsRequest",!0);var i=this.$IZ.$9g;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$5g,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_d.$2T.$1kf);this.$JL(this.$1Rj,"ExecuteEwsRequest","Failed",null);return}var s=n;var r=s.body;var u=_c.$CF.get_$L();if($8(r)||$vF(this,r.length,_d.$Ti.$2r9,"ExecuteEwsRequest")){t(_d.$2T.$1kf);this.$JL(this.$1Rj,"ExecuteEwsRequest","Failed",null);return}var f,e;if(!(e=$1e3(this,f={val:t},_d.$2T.$4gZ),t=f.val,e)){this.$JL(this.$1Rj,"ExecuteEwsRequest",_d.$2T.$vX,null);return}if(!u.$3QO(i.Id)||u.$7XU()){var h=this,o=this;$4N5(this,"ExtensionCallback",function(r){$4N7(h,i,n,t)},function(n){t({wasProxySuccessful:!1});o.$JL(o.$1Rj,"ExecuteEwsRequest","Failed",n)})}else $4N7(this,i,n,t)},$7Dz:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteSaveSettingsRequest",5);this.$1jm=_a.$5.$1V(_a.$0.$5g,"ExecuteSaveSettingsRequest",!0);var u=this.$IZ;var c=n;var f=c[0];var e=JsonParser.serialize(f);if($vF(this,e.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$JL(this.$1jm,"ExecuteSaveSettingsRequest","Failed",null);return}var o,s;if(!(s=$1e3(this,o={val:t},_d.$2T.$4ga),t=o.val,s)){this.$JL(this.$1jm,"ExecuteSaveSettingsRequest",_d.$2T.$vX,null);return}var i=new _c.$uQ(u.$9g.Id,u.$9g.Version,e);var r=this;i.add_$2A(function(n){if(i.get_$cu().WasSuccessful){u.set_$608(f);t({error:0});r.$JL(r.$1jm,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$cu().ErrorMessage,error:1});r.$JL(r.$1jm,"ExecuteSaveSettingsRequest",i.get_$cu().ErrorMessage,n)}});var h=this;i.add_$20(function(n){t({errorMessage:i.$1b.message,error:1});h.$JL(h.$1jm,"ExecuteSaveSettingsRequest",i.$1b.message,n)});this.$p.$y(i)},$7Dq:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteGetUserIdentityTokenRequest",5);this.$1jl=_a.$5.$1V(_a.$0.$5g,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1Gb()){_js.Trace.logInfo(_a.$0.$5g,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$IZ.$9g.DisplayName);t(_d.$2T.$1kf);this.$JL(this.$1jl,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_c.$CF.get_$L();var i=this.$IZ.$9g.Id;if(!u.$3QQ(i)||u.$7XY()){var f,e;if(!(e=$1e3(this,f={val:t},_d.$2T.$23z),t=f.val,e)){this.$JL(this.$1jl,"ExecuteGetUserIdentityTokenRequest",_d.$2T.$vX,null);return}var r=this,o=this;$4N5(this,"CallerIdentity",function(n){$4N8(r,i,t);r.$JL(r.$1jl,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});o.$JL(o.$1jl,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{$4N8(this,i,t);this.$JL(this.$1jl,"ExecuteGetUserIdentityTokenRequest","",null)}},$7Di:function(n,t){var r=n;var i=$6N2(this,r);if(!i){t(null);return}if(this.$G.get_$O()==="Mouse"){var u=this.$Db.$2hD(i);this.$G.$L9(Object.getType(this.$Db),null,null,_y.$3p.get_$eK(),u,!1)}else{var f=this.$Db.$ct(i.$3l);$4N9(this,f)}t(null)},$7Dg:function(n,t){var r=n;var i=new _y.$Ao;i.$cz(new _g.$1j(r.itemId));var u=this.$La.$ct(i.$3l);$4N9(this,u);t(null)},$7Dh:function(n,t){var i=n;$6N3(this,i.itemId,this.$$d_$8XH);t(null)},$7eN:function(n,t){if(this.$9I){var i=n.launchUrl;i&&this.$9I.$2FD(i)}t(null)},$8p3:function(n,t){var r=n;if(this.$IZ.$9g.Origin===3){var i=new _d.$z7(this.$IZ.$9g.DisplayName.replace(_d.$2T.$1dQ,""));i.$8lR(r);i.$y()}t(null)},$8p5:function(n,t){var i=n;if(this.$IZ.$9g.Origin!==3){t(null);return}var r=_a.$0.$5g;var u="[{0}] {1}";var f=this.$IZ.$9g.DisplayName.replace(_d.$2T.$1dQ,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(r,u,f,i.Message);break;case"Error":_js.Trace.logError(r,u,f,i.Message);break;default:break}t(null)},$9Ar:function(n,t){var i=n;if(this.$IZ.$9g.Origin!==3){t(null);return}var r=this.$IZ.$9g.DisplayName.replace(_d.$2T.$1dQ,"")+"."+i.Name.replace(_d.$2T.$1dQ,"");var u=i.Event;switch(u){case"Start":_a.$5.$1V(_a.$0.$5g,r);break;case"End":_a.$5.$1G(null,r);break;default:break}t(null)},$8zk:function(n){this.$47a=n},$7Ot:function(){return this.$v2.$2AX(this.$1NJ)},$96G:function(){this.$3XC=!1;_a.$5.stPT(_a.$0.$5g,"AppSelection",5);this.$369=_a.$5.$1V(_a.$0.$5g,"AppSelection",!0)},$3WH:function(){if(this.$369){var n=new _a.$7t;n.$IN("Id",this.$IZ.$9g.Id);n.$IN("Name",this.$IZ.$9g.DisplayName);var t=n.toString();var i=this.$3XC?"":"Failed";_a.$5.$1G(this.$369,"AppSelection",i,null,t);_a.$5.endPT("AppSelection");this.$369=null}},$JL:function(n,t,i,r){i||(i="");var u=null;r&&(_c.$qw.isInstanceOfType(r)&&r.get_$4dL()?u=r.get_$4dL().correlationId:_c.$uQ.isInstanceOfType(r)&&r.get_$4dL()?u=r.get_$4dL().correlationId:_c.$mB.isInstanceOfType(r)&&r.get_$4dL()?u=r.get_$4dL().correlationId:_c.$uP.isInstanceOfType(r)&&r.get_$4dL()?u=r.get_$4dL().correlationId:_c.$rE.isInstanceOfType(r)&&r.get_$4dL()?u=r.get_$4dL().correlationId:_c.$l3.isInstanceOfType(r)&&r.get_$4dL()&&(u=r.get_$4dL().correlationId));n?_a.$5.$1G(n,t,i,u):_a.$5.$1G(null,t,i,u);_a.$5.endPT(t)},$3K7:function(n){n.$6G([_d.$4o.$72l("GetInitialData",this.$$d_$7Kr),_d.$4o.$I("EwsRequest",this.$$d_$7Dn),_d.$4o.$I("saveSettingsAsync",this.$$d_$7Dz),_d.$4o.$I("RecordDataPoint",this.$$d_$8p3),_d.$4o.$I("RecordTrace",this.$$d_$8p5),_d.$4o.$I("TrackCtq",this.$$d_$9Ar),_d.$4o.$I("GetUserIdentityToken",this.$$d_$7Dq),_d.$4o.$I("DisplayNewAppointmentForm",this.$$d_$7Di),_d.$4o.$I("DisplayExistingAppointmentForm",this.$$d_$7Dg),_d.$4o.$I("DisplayExistingMessageForm",this.$$d_$7Dh),_d.$4o.$I("LaunchPalUrl",this.$$d_$7eN)])},$8XH:function(n){if(n.get_$CK()){var t=this.$6M.$GU(!0,!1);t.$3dw(n);var r=this;this.$G.$L9(IMailComposeViewModelFactory,function(){return r.$Gk},null,_y.$3p.get_$eK(),t,!1)}else{var i=this.$Kr.$I(!1);i.set_$48(n);var u=this;this.$G.$L9(_y.$G1,function(){return u.$sR},null,_y.$3p.get_$eK(),i,!1)}}};_d.$kb=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$v2=n;this.$aa=t;this.$SJ=i;this.$1NJ=r;this.$G=u;this.$Kr=f;this.$sR=e;this.$6M=o;this.$1D=s;this.$9I=h;this.$p=c;this.$1K=l};_d.$kb.prototype={$v2:null,$aa:null,$SJ:null,$1NJ:null,$G:null,$6M:null,$Kr:null,$sR:null,$1K:null,$La:null,$Gk:null,$Db:null,$1D:null,$9I:null,$p:null,$3Rl:function(n,t){return new _d.$QY(this.$G,this.$v2,this.$1NJ,this.$aa,this.$SJ,t,this.$Db,this.$La,this.$Gk,this.$6M,this.$Kr,this.$sR,n,this.$1D,this.$9I,this.$p,this.$1K)},$4o9:function(n){return new _d.$ka(this.$G,this.$v2,this.$1NJ,this.$aa,this.$SJ,this.$Db,this.$La,this.$Gk,this.$6M,this.$Kr,this.$sR,n,this.$1D,this.$9I,this.$p,this.$1K)},$4ov:function(n){return new _d.$z6(n,this.$G,this.$v2,this.$1NJ,this.$aa,this.$SJ,this.$Db,this.$La,this.$Gk,this.$6M,this.$Kr,this.$sR,this.$1D,this.$9I,this.$p)},$4o6:function(n){return new _d.$z3(n,this.$G,this.$v2,this.$1NJ,this.$aa,this.$SJ,this.$Db,this.$La,this.$Gk,this.$6M,this.$Kr,this.$sR,this.$1D,this.$9I,this.$p)}};_d.$z6=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$7IW=Function.createDelegate(this,this.$7IW);_d.$z6.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$28i=n};_d.$z6.prototype={$28i:null,$6r7:function(n,t){n.itemType=4;n.conversationId=this.$28i.$3ZK();var i=this;_d.$1DH.prototype.$6r7.call(this,n,function(){t()})},$3K7:function(n){_d.$1DH.prototype.$3K7.call(this,n);n.$6G([_d.$4o.$I("GetBodyTypeAsync",this.$$d_$7IW)])},$7IW:function(n,t){new _d.$zf(this.$28i,n,t).$s()}};_d.$QY=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_d.$QY.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w])};function $4NC(n,t){var i=n.$P;if(!n.get_$1Gb()){_d.$5z.$3KS(t,"from",i.get_$35());_d.$5z.$3KS(t,"sender",i.get_$9o());_d.$5z.$4dv(t,"to",i.get_$4O());_d.$5z.$4dv(t,"cc",i.get_$4f())}t.conversationId=i.get_$3E()?i.get_$3E().Id:null;t.internetMessageId=i.get_$9s()}function $6N4(n,t){var i=n.$P;if(!n.get_$1Gb()){_d.$5z.$1fC(t,"to",i.get_$NB().get_$72(),i.get_$NB().get_$Cl());_d.$5z.$1fC(t,"cc",i.get_$NB().get_$8A(),null);_d.$5z.$1fC(t,"resources",i.get_$NB().get_$9D(),null)}i.get_$NB().get_$4h()&&(t.location=i.get_$NB().get_$4h().get_$1l());i.get_$NB().get_$10()&&(t.start=i.get_$NB().get_$10().$1Ff().getTime());i.get_$NB().get_$23()&&(t.end=i.get_$NB().get_$23().$1Ff().getTime())}_d.$QY.prototype={$6r7:function(n,t){var i=this.$P.get_$7G()?this.$P.get_$7G().toLowerCase():"";if(_g.$Be.isInstanceOfType(this.$P)&&_d.$KN.$3hY(i)){n.itemType=3;var r=this.$P;$4NC(this,n);$6N4(this,n)}else if(_d.$KN.$3hY(i)){n.itemType=1;$4NC(this,n)}var u=this;_d.$5z.prototype.$6r7.call(this,n,function(){t()})}};_d.$YS=function(n){this.$2KW={};this.$4hZ=n};_d.$YS.$$=function(n){var t="$YS"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$YS"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$YS.apply(this,i)};r.registerClass("_d."+t);var u=_d.$YS.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$YS.prototype={$rn:0,$4hZ:null,$H:function(n){var t=this.$4hZ+(new Date).getTime().toString()+this.$rn.toString();this.$2KW[t]=n;this.$rn++;return t},$9Im:function(n,t){this.$2KW[n]=t;return n},$9In:function(n,t){var i=this.$2KW[n];t&&delete this.$2KW[n];return i}};_d.$5z=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$7Dj=Function.createDelegate(this,this.$7Dj);this.$$d_$7Dk=Function.createDelegate(this,this.$7Dk);this.$$d_$4vb=Function.createDelegate(this,this.$4vb);this.$$d_$4vZ=Function.createDelegate(this,this.$4vZ);this.$$d_$7Dp=Function.createDelegate(this,this.$7Dp);_d.$5z.initializeBase(this,[n,t,i,r,u,e,o,s,h,c,l,v,y,p]);this.$iO=f;this.$P=a;this.$1K=w};_d.$5z.$3KS=function(n,t,i){$8(i)||(n[t]=_d.$5z.$4pC(i.Mailbox))};_d.$5z.$4dv=function(n,t,i){if(!$8(i)&&i.get_$F()>0){for(var u=[],r=0;r<i.get_$F()&&r<100;r++){var f=i.get_$48(r);$8(f)||(u[r]=_d.$5z.$4pC(f))}n[t]=u}};_d.$5z.$1fC=function(n,t,i,r){var u=null;var e=0;var s=!1;if(r&&r.Mailbox){s=!0;u=new Array(0);u[e++]=_d.$5z.$4o4(r.Mailbox,"Organizer")}if(!$8(i)&&i.get_$F()>0){u||(u=new Array(0));for(var o=0;o<i.get_$F()&&e<100;o++){var f=i.get_$48(o);if(f&&f.get_$6V()){if(s&&r.Mailbox.EmailAddress&&f.get_$6V().EmailAddress&&f.get_$6V().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;u[e++]=_d.$5z.$4o4(f.get_$6V(),f.get_$QP())}}}n[t]=u};_d.$5z.$4pC=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_d.$5z.$3lx(n.MailboxType);return t};_d.$5z.$3lx=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_d.$5z.$6qK=function(n,t){if(!$8(t)&&t.get_$F()>0){for(var f=[],u=0;u<t.get_$F();u++){var i=t.get_$48(u);var r={};if(i){r.id=i.get_$40().Id;r.name=i.get_$1Q();r.contentType=i.get_$BL();r.size=i.get_$5y();r.attachmentType=_g.$5q.isInstanceOfType(i)?0:1;r.isInline=i.get_$8Y();f[u]=r}}n.attachments=f}};_d.$5z.$4o4=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_d.$5z.$3lx(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};function $6N9(n){if(n.$P.get_$x2())return!1;var t=n.$P.get_$332();return t?t.ExtractedAddresses||t.ExtractedContacts||t.ExtractedEmails||t.ExtractedMeetings||t.ExtractedPhones||t.ExtractedTasks||t.ExtractedUrls:!1}function $6NC(n,t,i){var r=new _c.$rH(n.$P);var u=this;r.add_$2A(function(r){n.$3KF(t);i()});var f=this;r.add_$20(function(u){_js.Trace.logWarning(_a.$0.$5g,"GetItem to fetch entities failed "+r.$1b);n.$3KF(t);i()});OwaApplication.$1T.$y(r)}function $6N8(n,t){var i={};i.Addresses=_d.$5Y.$1Fa(t.Addresses,3,n.$iO);i.Urls=_d.$5Y.$1Fa(t.Urls,4,n.$iO);i.PhoneNumbers=_d.$5Y.$1Fa(t.PhoneNumbers,5,n.$iO);if(!n.get_$1Gb()){i.Contacts=_d.$5Y.$1Fa(t.Contacts,7,n.$iO);i.EmailAddresses=_d.$5Y.$1Fa(t.EmailAddresses,6,n.$iO);i.MeetingSuggestions=_d.$5Y.$1Fa(t.MeetingSuggestions,1,n.$iO);i.TaskSuggestions=_d.$5Y.$1Fa(t.TaskSuggestions,2,n.$iO)}return i}function $4NE(n,t,i){var r=n.$6M.$GU(!0,!1);r.set_$4D(t);r.$165(n.$P);var e=r.$1E6(!0);var u;if(t===1)u=new _g.$hp;else if(t===2)u=new _g.$ho;else return;u.$2SL(e.get_$8f());u.set_$1JT(new _g.$66(new _g.$67("HTML",i)));u.set_$2NG(n.$P.get_$i());r.$571(u);var f=_d.$9v.$3S9(r,u,n.$1K);f.$HJ=0;var o=this;f.add_$2A(function(n){_js.Trace.logInfo(_a.$0.$5g,"Create response action succeeded");var t=n;if(t.$5I===r.get_$6u()){r.$Ar();r.set_$5L(0);r.set_$4D(4);r.set_$9J(t.$5J);var i=new _y.$99;i.$VM(r)}});OwaApplication.$1T.$y(f)}function $6NA(n){return n.$P?_g.$39.isInstanceOfType(n.$P)?n.$P.get_$ds():!0:!1}function $6NB(n){return n.$P?_g.$39.isInstanceOfType(n.$P)?n.$P.get_$b4():!0:!1}function $6ND(n,t,i){var r="";i&&_c.$l3.isInstanceOfType(i)&&i.$SG&&(r=i.$SG.TokenValue);t({wasSuccessful:!0,token:r})}_d.$5z.prototype={$iO:!1,$1K:null,$P:null,$6r7:function(n,t){if($6N9(this))$6NC(this,n,t);else{this.$3KF(n);t()}},$3K7:function(n){_d.$2T.prototype.$3K7.call(this,n);n.$6G([_d.$4o.$I("GetCallbackToken",this.$$d_$7Dp),_d.$4o.$I("LoadCustomProperties",this.$$d_$4vZ),_d.$4o.$I("SaveCustomProperties",this.$$d_$4vb),_d.$4o.$I("DisplayReplyForm",this.$$d_$7Dk),_d.$4o.$I("DisplayReplyAllForm",this.$$d_$7Dj)])},$7Dp:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteGetCallbackTokenRequest",5);var i=_a.$5.$1V(_a.$0.$5g,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1Gb()){_js.Trace.logInfo(_a.$0.$5g,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$IZ.$9g.DisplayName);t(_d.$2T.$1kf);this.$JL(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var u,f;if(!(f=$1e3(this,u={val:t},_d.$2T.$23z),t=u.val,f)){this.$JL(i,"ExecuteGetCallbackTokenRequest",_d.$2T.$vX,null);return}var r=new _c.$l3(this.$IZ.$9g.Id,String.format("ParentItemId:{0}",this.$P.get_$i().Id));var e=this;r.add_$2A(function(n){$6ND(e,t,n);e.$JL(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$20(function(n){t({wasSuccessful:!1});o.$JL(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$1T.$y(r)},$4vZ:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteLoadCustomPropRequest",5);var r=_a.$5.$1V(_a.$0.$5g,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _c.$mB(this.$IZ.$9g.Id,this.$P.get_$i().Id);var u,f;if(!(f=$1e3(this,u={val:t},_d.$2T.$23z),t=u.val,f)){this.$JL(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2A(function(n){t({errorMessage:i.get_$cu().ErrorMessage,wasSuccessful:i.get_$cu().WasSuccessful,customProperties:i.get_$cu().CustomProperties});e.$JL(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$20(function(n){t({errorMessage:i.$1b.message,wasSuccessful:!1,customProperties:null});o.$JL(r,"ExecuteLoadCustomPropRequest",i.$1b.message,n)});OwaApplication.$1T.$y(i)},$4vb:function(n,t){_a.$5.stPT(_a.$0.$5g,"ExecuteSaveCustomPropRequest",5);var r=_a.$5.$1V(_a.$0.$5g,"ExecuteSaveCustomPropRequest",!0);var o=n;var s=o.customProperties;var u=JsonParser.serialize(s);if($vF(this,u.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_d.$2T.$1kf);this.$JL(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var f,e;if(!(e=$1e3(this,f={val:t},_d.$2T.$23z),t=f.val,e)){this.$JL(r,"ExecuteSaveCustomPropRequest",_d.$2T.$vX,null);return}var i=new _c.$uP(this.$IZ.$9g.Id,this.$P.get_$i().Id,u);var h=this;i.add_$2A(function(n){t({errorMessage:i.get_$cu().ErrorMessage,wasSuccessful:i.get_$cu().WasSuccessful});h.$JL(r,"ExecuteSaveCustomPropRequest","",n)});var c=this;i.add_$20(function(n){t({errorMessage:i.$1b.message,wasSuccessful:!1});c.$JL(r,"ExecuteSaveCustomPropRequest",i.$1b.message,n)});OwaApplication.$1T.$y(i)},$7Dk:function(n,t){if(!$6NB(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($vF(this,i.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}$4NE(this,1,i);t(null)},$7Dj:function(n,t){if(!$6NA(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($vF(this,i.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}$4NE(this,2,i);t(null)},$3KF:function(n){n.id=this.$P.get_$i().Id;n.itemClass=this.$P.get_$7G();n.subject=this.$P.get_$2h();n.normalizedSubject=this.$P.get_$nv();this.$P.get_$14f()&&(n.dateTimeCreated=this.$P.get_$14f().$1Ff().getTime());this.$P.get_$B4()&&(n.dateTimeModified=this.$P.get_$B4().$1Ff().getTime());this.$P.get_$wS()&&(n.dateTimeSent=this.$P.get_$wS().$1Ff().getTime());$8(this.$P.get_$x2())||(n.entities=$6N8(this,this.$P.get_$x2()));var t=this.$ht.$rG.$7JY();t&&(n.filteredEntities=t);if(!_d.$2T.prototype.get_$1Gb.call(this)){var i=this.$ht.$2NK;$8(i)||(n.regExMatches=i);_d.$5z.$6qK(n,this.$P.get_$85())}}};_d.$zf=function(n,t,i){_d.$zf.initializeBase(this,[t,i]);this.$28i=n};_d.$zf.prototype={$28i:null,get_$VS:function(){return"GetBodyType"},$7Dc:function(){var t=this.$28i.$2hU();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");$dU(this,n,null)}};_d.$105=function(n,t,i){_d.$105.initializeBase(this,[t,i]);this.$bR=n};_d.$105.prototype={$bR:null,get_$VS:function(){return"GetLocation"},$7Dc:function(){var n=this.$bR.$2A8();$dU(this,n,null)}};_d.$l1=function(n,t,i){_d.$l1.initializeBase(this,[t,i]);this.$Cy=n};_d.$l1.$7Gj=function(n){var r=[];if(!n)return r;for(var f=n.get_$F()>100?100:n.get_$F(),t=0;t<f;t++){var u=n.get_$48(t).$BY;var i={};i.recipientType=_d.$5z.$3lx(u.get_$1h().MailboxType);i.address=u.get_$1h().EmailAddress||null;i.name=u.get_$1l();r[t]=i}return r};_d.$l1.prototype={$Cy:null,get_$VS:function(){return"GetRecipients"},$7Dc:function(){var n=this.$x.recipientField;var t=this.$Cy.$7NA(n);var i=_d.$l1.$7Gj(t);$dU(this,i,null)}};_d.$10e=function(n,t,i){_d.$10e.initializeBase(this,[t,i]);this.$Cy=n};_d.$10e.prototype={$Cy:null,get_$VS:function(){return"GetSubject"},$7Dc:function(){var n=this.$Cy.$xY();$dU(this,n||"",null)}};_d.$10i=function(n,t,i){_d.$10i.initializeBase(this,[t,i]);this.$bR=n};_d.$10i.prototype={$bR:null,get_$VS:function(){return"GetTime"},$7Dc:function(){var n=null;var t=this.$x.TimeProperty;t===1?n=this.$bR.$2iK():t===2&&(n=this.$bR.$2hj());$dU(this,n.$1Ff().getTime(),null)}};_d.$135=function(n,t,i,r,u){this.$$d_$2qC=Function.createDelegate(this,this.$2qC);this.$$d_$2qH=Function.createDelegate(this,this.$2qH);_d.$135.initializeBase(this,[t,u]);this.$eJ=i;this.$Cy=n;this.$p=r};_d.$135.prototype={$eJ:null,$Cy:null,$p:null,get_$VS:function(){return"ExecuteLoadCustomPropRequestCompose"},$7Dc:function(){var n=this.$Cy.$50A();if(n)for(var t=n.get_$F()-1;t>=0;t--)if(_h.$Bv.$59c(n.get_$48(t),this.$eJ)){$2Td(this,{wasSuccessful:!0,customProperties:n.get_$48(t).get_$1d()},null);return}var r=this.$Cy.$2A6();if(!r){$2Td(this,{wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$x;var i=new _c.$mB(this.$eJ,this.$Cy.$2A6());i.add_$2A(this.$$d_$2qH);i.add_$20(this.$$d_$2qC);this.$p.$y(i)},$2qH:function(n){var t=n;var i={wasSuccessful:t.get_$cu().WasSuccessful,customProperties:t.get_$cu().CustomProperties};$2Td(this,i,n.$5I)},$2qC:function(n){_js.Trace.logError(_a.$0.$5g,"custom properties load failed with "+n.$1b);var t={errorMessage:n.$1b.message,wasSuccessful:!1,customProperties:null};$6JK(this,t,n.$1b.message,n.$5I)}};_d.$15X=function(n,t,i){this.$$d_$4rl=Function.createDelegate(this,this.$4rl);_d.$15X.initializeBase(this,[t,i]);this.$1D2=n};_d.$15X.prototype={$1D2:null,$1Oq:null,$244:null,get_$VS:function(){return"RemoveAttachment"},$7Dc:function(){this.$244=this.$x.attachmentIndex;if(this.$244.length>200){_js.Trace.logError(_a.$0.$5g,"RemoveFileAttachment got too long attachmentId");$vD(this);return}if(!this.$244){_js.Trace.logError(_a.$0.$5g,"RemoveAttachment got null or empty attachmentIndex");$vD(this);return}this.$1Oq=this.$1D2.$9In(this.$244,!0);if(!this.$1Oq){$kU(this,9008,null);return}if(this.$1Oq.get_$y5()){$dU(this,null,null);return}this.$1Oq.add_$1uT(this.$$d_$4rl);this.$1Oq.get_$1R2().$s()},$4rl:function(n){this.$1Oq.remove_$1uT(this.$$d_$4rl);if(n.get_$5lu()){this.$1D2.$9Im(this.$244,this.$1Oq);$kU(this,9009,null);return}$dU(this,null,null)}};_d.$cU=function(n,t,i,r){_d.$cU.initializeBase(this,[t,r]);this.$eJ=i;this.$Cy=n};_d.$cU.prototype={$eJ:null,$Cy:null,get_$VS:function(){return"ExecuteSaveCustomPropRequestCompose"},$7Dc:function(){var f=this.$x;var e=f.customProperties;var i=JsonParser.serialize(e);if(i.length>2500){$vD(this);return}for(var r=_h.$Bv.$73r(this.$eJ,i),n=this.$Cy.$50A(),u=!1,t=0;t<n.get_$F();t++)if(_h.$Bv.$59c(n.get_$48(t),this.$eJ)){n.set_$48(t,r);u=!0;break}u||n.$H(r);$2Td(this,_d.$cU.$4qV,null)}};_d.$iC=function(n,t,i,r){this.$$d_$8uU=Function.createDelegate(this,this.$8uU);this.$$d_$8uV=Function.createDelegate(this,this.$8uV);_d.$iC.initializeBase(this,[t,i]);this.$Cy=n;this.$p=r};function $6ST(n,t){t.val=t.val.trim();t.val.substr(0,5).toLowerCase()==="<div>"&&t.val.substr(t.val.length-6,6).toLowerCase()==="</div>"&&(t.val=t.val.substring(5,t.val.length-6))}function $6SU(n,t,i){var r=n.$Cy.$2hU();i.val=t;if(!$8(t)){if(r==="Text"&&i.val===3){$kU(n,2006,null);return!1}return!0}$vD(n);return!1}_d.$iC.prototype={$Cy:null,$p:null,$7Dc:function(){var r=this.$x;var n=r.data;if(n.length>1e6){$vD(this);return}var t;var u,f;if(f=$6SU(this,r.coercionType,u={val:t}),t=u.val,f)if(t===3)if(_js.$8.$c(n))this.$2l7("");else{var i=new _c.$15p(n);i.add_$2A(this.$$d_$8uV);i.add_$20(this.$$d_$8uU);this.$Cy.$96r();this.$p.$y(i)}else this.$Cy.$2hU()==="HTML"?this.$2l7(_a.$41.$JK(n)):this.$2l7(n)},$8uU:function(n){_js.Trace.logError(_a.$0.$5g,"Sanitize html failed with "+n.$1b);$kU(this,9011,null)},$8uV:function(n){_js.Trace.logInfo(_a.$0.$5g,"Sanitize html succeeded.");if(this.$Cy.$2hU()==="HTML"){var u=n;var t=u.get_$cu();var i;$6ST(this,i={val:t});t=i.val;var r=this;this.$Cy.$6xP(function(n){n?$kU(r,9014,null):r.$2l7(t)})}else $kU(this,2006,null)}};_d.$16X=function(n,t,i){_d.$16X.initializeBase(this,[t,i]);this.$bR=n};_d.$16X.prototype={$bR:null,get_$VS:function(){return"SetLocation"},$7Dc:function(){var n=this.$x.location;if(n.length>255)$vD(this);else{this.$bR.$8yx(n);$dU(this,null,null)}}};_d.$16h=function(n,t,i){_d.$16h.initializeBase(this,[t,i]);this.$Cy=n};_d.$16h.prototype={$Cy:null,get_$VS:function(){return"SetSubject"},$7Dc:function(){var n=this.$x.subject;if(n.length>255){$vD(this);return}this.$Cy.$8zp(n);$dU(this,null,null)}};_d.$16k=function(n,t,i){_d.$16k.initializeBase(this,[t,i]);this.$bR=n};_d.$16k.prototype={$bR:null,get_$VS:function(){return"SetTime"},$7Dc:function(){var n=this.$x.TimeProperty;var r=this.$x.time;var t=_a.$7.$29a(new Date(r));var i=!0;n===1?this.$bR.$8zn(t):n===2&&(i=this.$bR.$9Bu(t));i?$dU(this,null,null):$kU(this,9010,null)}};_d.$4o=function(n,t,i){this.$Of=n;this.$1qF=t;this.$4ht=i};_d.$4o.$I=function(n,t){return new _d.$4o(n,t,!1)};_d.$4o.$72l=function(n,t){return new _d.$4o(n,t,!0)};_d.$4o.prototype={$Of:null,$4ht:!1,$1qF:null};_d.$vM=function(n,t){this.$20h=n;this.$1j=t};_d.$vM.prototype={$20h:null,$1j:null,get_$9Ft:function(){return this.$20h},get_$1Q:function(){return this.$1j},get_$5y:function(){return 0},get_$5E:function(){return""}};_d.$2r=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6xd=Function.createDelegate(this,this.$6xd);this.$$d_$8XD=Function.createDelegate(this,this.$8XD);this.$$d_$8W8=Function.createDelegate(this,this.$8W8);this.$$d_$29u=Function.createDelegate(this,this.$29u);this.$$d_$7Qo=Function.createDelegate(this,this.$7Qo);this.$$d_$8i7=Function.createDelegate(this,this.$8i7);this.$$d_$30J=Function.createDelegate(this,this.$30J);_d.$2r.initializeBase(this);this.$F5=n;this.$1Rp=u;this.$9I=t;this.$1D=i;this.$G=r;this.$W9=new _js.$X;this.$dO=new _y.$eK;this.$5mL=_d.$2r.$7MD(o);this.$1AP=new _d.$qz(this.$$d_$30J,null);this.$5ll=new _C(this.$$d_$8i7,_a.$0.$5g);this.$45J=f;this.$1Ge=e;this.$3We=s;this.$Lo=h;this.$P=c;this.$1f0=l;this.$1GA=a};_d.$2r.add_$2zh=function(n){_d.$2r.$2hk.addHandler(_d.$2r.$2zi,n)};_d.$2r.remove_$2zh=function(n){_d.$2r.$2hk.removeHandler(_d.$2r.$2zi,n)};_d.$2r.$7MD=function(n){return n?n.replace("osfruntime_strings.js",""):""};function $6NI(n,t){n.$1GA.$3v(t,n.$Yq,t.$ht);n.$1GA.$8pk()}function $3Ez(n,t){$4NG(n,t)&&n.$3We.$8oV(_a.$IX,new _a.$IX(!0,"Extensibility"))}function $3F0(n,t){$4NG(n,t)&&n.$3We.$8oV(_a.$IX,new _a.$IX(!1,"Extensibility"))}function $4NG(n,t){return!n.$1D.get_$3gz()&&!n.$1D.get_$2mv()?!1:!t||n.$Fj&&!n.$Fj.get_$28k().Type?!0:!1}function $6NJ(n){$6(n,"ActiveExtensions")}function $4NF(n){n.$1GA.$9CZ()}function $3Ey(n){if((!_d.$2r.$2mb||n.$37B)&&!n.$1Ge){_a.$5.stPT(_a.$0.$5g,"GetListOfApps",5);n.$1kv=_a.$5.$1V(_a.$0.$5g,"GetListOfApps",!0);_d.$2r.$2mb=!0;n.$29u();if(n.$45J){n.$1ac=new _d.$15m(3,3e4,n.$$d_$29u,_a.$0.$5g,"GetExtensibilityContext");n.$1ac.$10()}}}function $6NH(n){n.$25P&&n.$25P.$3OZ()}function $6NL(n){if(!n.$25P){n.$25P=new _d.$vF("CheckNewApp");$4NH(n)}}function $4NH(n){n.$25P.$21(n.$$d_$6xd,5e3,_a.$0.$5g)}function $6NK(n,t){var i=_d.$2r.$2hk.getHandler(_d.$2r.$2zi);$8(i)||i(t)}_d.$2r.prototype={$G:null,$1D:null,$1AP:null,$1Rp:null,$Lo:null,$F5:null,$5ll:null,$dO:null,$9I:null,$5mL:null,$1f0:null,$1GA:null,$25P:null,$1ac:null,$Yq:null,$37B:!1,$10V:null,$1hX:null,$W9:null,$Fj:null,$P:null,$2jq:!0,$2KD:!0,$1Vn:null,$45J:!1,$1Ge:!1,$3We:null,$1kv:null,get_$6yO:function(){switch(this.$G.get_$O()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$8il:function(){return this.$10V},set_$8il:function(n){this.$10V!==n&&(this.$10V=n);$6(this,"OverflowMenuViewModel");return n},get_$5mK:function(){return this.$1hX},set_$5mK:function(n){if(this.$1hX!==n){this.$1hX=n;$6(this,"OsfContextActivationManager")}return n},get_$1az:function(){return this.$Fj},set_$1az:function(n){if(this.$Fj!==n){$8(n)||this.$Lo.$9Au(n.get_$28k().Id);this.$Fj=n;$6(this,"SelectedExtension")}return n},get_$3cZ:function(){return this.$2jq},set_$3cZ:function(n){if(this.$2jq!==n){this.$2jq=n;$6(this,_d.$2r.$55H)}return n},get_$1Y5:function(){return this.$2KD},set_$1Y5:function(n){if(this.$2KD!==n){this.$2KD=n;$6(this,_d.$2r.$2KE)}return n},get_$7hW:function(){return this.$1Vn},set_$7hW:function(n){this.$1Vn=n;$6(this,_d.$2r.$2G2);return n},$30J:function(n){n&&this.$Fj===n||this.$1GA.$3WH();n&&this.$1GA.$96G();if(!this.$1hX&&n){var i=_a.$5.acsa(_a.$0.$5g,"ContextActivationManager",!0);$3Ez(this,!1);this.set_$5mK(new OSF.ContextActivationManager({appName:64,appVersion:"15",clientMode:1,appUILocale:this.$F5,dataLocale:"",hostControl:this.$1GA,localizedScriptsUrl:this.$5mL,docUrl:""}));var t={frameBorder:"0"};this.$1D.get_$Gj()&&this.$1D.get_$5h()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");this.$1hX.setIframeAttributeBag(t);$3F0(this,!1);_a.$5.acea(i)}n?$6NI(this,n):$4NF(this);this.set_$3cZ(this.$79h(n));this.set_$1az(n)},$6e:function(){_d.$2r.remove_$2zh(this.$$d_$7Qo);this.$1GA.$3WH();$4NF(this);this.set_$1az(null);this.$10V&&this.$10V.$b7();this.$10V=null;this.set_$3cZ(!0);this.$W9.$1u();this.set_$1Y5(!0);this.$1f0.$Ar();$6NH(this)},$5F:function(){if(this.$1D.get_$8Qg()){this.$W9.$1u();if(this.$1f0.$91H())if(_a.$Cl.$5Ce()){_a.$Cl.$5u9();_d.$2r.$2mb=!1;_d.$2r.add_$2zh(this.$$d_$7Qo);$3Ey(this)}else if($8(this.$Yq)&&$8(_c.$84.$hv)){_d.$2r.add_$2zh(this.$$d_$7Qo);$3Ey(this)}else{$8(this.$Yq)&&!$8(_c.$84.$hv)&&(this.$Yq=_c.$84.$hv);this.$4dQ()}}},$8W8:function(n){if(this.$45J&&this.$1ac){this.$1ac.$23();this.$1ac=null}$6NK(this,n);if(this.$1kv){var t=null;_c.$84.isInstanceOfType(n)&&n.get_$4dL()&&(t=n.get_$4dL().correlationId);_a.$5.$1G(this.$1kv,"GetListOfApps","",t);_a.$5.endPT("GetListOfApps");this.$1kv=null}},$4dQ:function(){if(this.$1f0){this.$G.get_$O()==="Mouse"&&this.$Yq.MarketplaceUrl&&this.set_$7hW(this.$Yq.MarketplaceUrl);if(!$8(this.$Yq.Extensions)&&this.$Yq.Extensions.length){var n=this;this.$1f0.$7DD(this.$Yq.Extensions,function(t){if(n.$1f0){if(t.get_$F()>0){n.$W9.$6G(t.$7V());$6NJ(n);n.set_$8il(new _d.$Gc(n.$W9,n.$1AP));n.$10V.$b7();n.set_$1Y5(!1);$6(n,_d.$2r.$4vx)}else n.set_$1Y5(!0);$6(n,_d.$2r.$4dU)}})}}},$8i7:function(){if(this.$1Vn){_a.$5.stPT(_a.$0.$5g,"GetMoreApps",3);var n=_a.$5.$1V(_a.$0.$5g,"GetMoreApps",!0);this.$dO.$Q9(this.$1Vn);$6NL(this);_a.$5.$1G(n,"GetMoreApps","");_a.$5.endPT("GetMoreApps")}},$29u:function(){var n=new _c.$84;n.add_$2A(this.$$d_$8W8);n.add_$20(this.$$d_$8XD);n.$s(this.get_$6yO(),this.$F5)},$8XD:function(n){if(this.$1ac&&this.$1ac.$3br&&this.$1kv){var t=null;_c.$84.isInstanceOfType(n)&&n.get_$4dL()&&(t=n.get_$4dL().correlationId);_a.$5.$1G(this.$1kv,"GetListOfApps","Failed",t);_a.$5.endPT("GetListOfApps")}},$6xd:function(){if(_a.$Cl.$5Ce()){_a.$Cl.$5u9();this.$37B=!0;$3Ey(this)}$4NH(this)},$7Qo:function(n){_d.$2r.remove_$2zh(this.$$d_$7Qo);if(this.$Yq){if(this.$37B){this.$37B=!1;_c.$84.$2pe=n.$3QW}}else{_c.$84.$2pe=n.$3QW;this.$Yq=_c.$84.$hv;this.$4dQ()}}};_d.$J1=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8W9=Function.createDelegate(this,this.$8W9);this.$$d_$5k6=Function.createDelegate(this,this.$5k6);this.$$d_$4wq=Function.createDelegate(this,this.$4wq);this.$$d_$8SH=Function.createDelegate(this,this.$8SH);this.$$d_$8Y7=Function.createDelegate(this,this.$8Y7);this.$$d_$92E=Function.createDelegate(this,this.$92E);_d.$J1.initializeBase(this,[i,r,u,f,e,o,s,h,c,l,a,v,y]);this.set_$3La(_u.Strings.l_ComposeAppsForOutlook_Text);this.set_$3ca(!1);this.set_$2YB(!0);this.$3LZ=t;this.$1bg=new _C(this.$$d_$92E,n);this.$1bg.set_$5P(!1);this.$55A=new _C(this.$$d_$8Y7,n);this.$4hW=new _C(this.$$d_$8SH,n)};function $6MC(n){n.$a(_d.$2r.$2KE,n.$$d_$8W9);n.$a(_d.$2r.$2G2,n.$$d_$8W9);n.$3Li=!0}function $6MD(n){if(n.$3Li){n.$w(_d.$2r.$2KE,n.$$d_$8W9);n.$w(_d.$2r.$2G2,n.$$d_$8W9);n.$3Li=!1}}function $4Mo(n,t){n.$3LZ&&n.$3LZ(t)}_d.$J1.prototype={$1Hk:null,$2YD:null,$2js:!1,$3LZ:null,$1yT:!1,$1fb:!1,$2YC:0,$1bg:null,$55A:null,$4hW:null,$3Li:!1,get_$61F:function(){return this.$1yT},set_$61F:function(n){if(this.$1yT!==n){this.$1yT=n;$6(this,"ShowAppsButton")}return n},get_$4g3:function(){return this.$2YC},set_$4g3:function(n){if(this.$2YC!==n){this.$2YC=n;$6(this,"AppPaneSize")}return n},get_$2YB:function(){return this.$1fb},set_$2YB:function(n){if(this.$1fb!==n){this.$1fb=n;$6(this,"AppPaneIsHidden")}return n},get_$5GM:function(){return this.$1Hk},set_$5GM:function(n){this.$1Hk=n;if(n.$Sf===3){var t=this.$1Hk.$3Wi.get_$1s().extensionViewModel;this.$30J(t)}return n},get_$3La:function(){return this.$2YD},set_$3La:function(n){if(this.$2YD!==n){this.$2YD=n;$6(this,"AppPaneTitle")}return n},get_$3ca:function(){return this.$2js},set_$3ca:function(n){if(this.$2js!==n){this.$2js=n;$6(this,"HideExtensionsList")}return n},get_$1oh:function(){return this.$G.get_$O()!=="Mouse"},$5F:function(){this.set_$61F(!this.$2KD||!!this.$1Vn);this.$1bg.set_$5P(this.$1yT);this.set_$2YB(!0);$6MC(this);_d.$2r.prototype.$5F.call(this)},$6e:function(){$6MD(this);_d.$2r.prototype.$6e.call(this)},$30J:function(n){if(n){this.set_$3ca(!0);this.set_$3cZ(!1);this.set_$3La(n.get_$28k().DisplayName);if(this.$1D.get_$5h()){var t=this;this.$9I.$4uv(n.get_$4uy(),n.get_$28k().DisplayName,function(){t.$5uv(n)},this.$$d_$4wq)}else this.$5uv(n)}else this.$1D.get_$5h()?this.$9I.$4vg():this.$4wq()},$92E:function(){_a.$5.stPT(_a.$0.$5g,"ShowAppPane",3);var t=_a.$5.$1V(_a.$0.$5g,"ShowAppPane",!0);if(_y.$j.$g.get_$O()==="Mouse"){if(this.$1fb){this.set_$4g3(320);this.set_$2YB(!1);$4Mo(this,1)}}else if(_y.$j.$g.get_$O()==="TouchWide"){var n=this.$1Rp.$73A(this,_y.$j.$g.get_$O());n.set_$5ga(this.$$d_$5k6);_y.$j.$g.$9T(n)}_a.$5.$1G(t,"ShowAppPane","");_a.$5.endPT("ShowAppPane")},$8Y7:function(){this.$3cS(!0)},$3cS:function(n){if(!this.$1fb){var t=null;if(n){_a.$5.stPT(_a.$0.$5g,"HideAppPane",3);t=_a.$5.$1V(_a.$0.$5g,"HideAppPane",!0)}this.$4hV(!1);this.set_$4g3(0);this.set_$2YB(!0);$4Mo(this,2);if(n){_a.$5.$1G(t,"HideAppPane","");_a.$5.endPT("HideAppPane")}}},$8SH:function(){this.$4hV(!0)},$4hV:function(n){var t=null;if(n){_a.$5.stPT(_a.$0.$5g,"CloseComposeApp",3);t=_a.$5.$1V(_a.$0.$5g,"CloseComposeApp",!0)}this.$30J(null);if(n){_a.$5.$1G(t,"CloseComposeApp","");_a.$5.endPT("CloseComposeApp")}},$79h:function(n){return!n},$5uv:function(n){$3Ez(this,!0);_d.$2r.prototype.$30J.call(this,n)},$4wq:function(){$3F0(this,!0);this.set_$3La(_u.Strings.l_ComposeAppsForOutlook_Text);this.set_$3ca(!1);_d.$2r.prototype.$30J.call(this,null)},$8W9:function(n,t){if(t===_d.$2r.$2KE||t===_d.$2r.$2G2){this.set_$61F(!this.$2KD||!!this.$1Vn);this.$1bg.set_$5P(this.$1yT)}},$5k6:function(n){this.$30J(null);n()}};_d.$qC=function(n,t){this.$$d_$2gP=Function.createDelegate(this,this.$2gP);this.$$d_$53t=Function.createDelegate(this,this.$53t);_d.$qC.initializeBase(this);this.$7e=n;this.$NO=t};_d.$qC.prototype={$NO:0,$Fw:null,$7e:null,$1mx:!1,$1hb:null,$10K:null,get_$5ga:function(){return this.$10K},set_$5ga:function(n){this.$10K=n;return n},get_$427:function(){return 2},get_$2Ao:function(){return this.$$d_$53t},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$7A8:function(){return!0},get_$Jr:function(){return 0},$53t:function(n,t){if(this.$1mx)return!1;if(this.$10K){this.$1hb=n;this.$10K(this.$$d_$2gP);return!0}this.$2gP();return!1},$2gP:function(){this.$1mx=!0;this.$1hb&&this.$1hb()}};_d.$OI=function(){};_d.$OI.$7hC=function(n){var i=n.toString();var t=_d.$OI.$Cg[i];if(!t){t=_js.$2B.$J7(_d.$OI.$1F0,n);_d.$OI.$Cg[i]=t}return t};_d.$OI.$1F0=function(){};_d.$OI.$1F0.prototype={};_d.$OI.$1F0.registerEnum("_d.$OI.$1F0",!1);_d.$z5=function(){_d.$z5.initializeBase(this,[1,"VM.Extensibility.Stats"])};_d.$z5.prototype={get_$71O:function(){return this.$W("ContextRetrievalTime")},set_$71O:function(n){$1O(this,"ContextRetrievalTime",n);return n},get_$71L:function(){return this.$W("ContextExtensionsCount")},set_$71L:function(n){$1O(this,"ContextExtensionsCount",n);return n},get_$7hf:function(){return this.$W("MaxCountOfActiveExtensions")},set_$7hf:function(n){$1O(this,"MaxCountOfActiveExtensions",n);return n},get_$6pc:function(){return this.$W("ActivationTime")},set_$6pc:function(n){$1O(this,"ActivationTime",n);return n},get_$9AR:function(){return this.$W("TotalActivationStatistics")},set_$9AR:function(n){$1O(this,"TotalActivationStatistics",n);return n},get_$8pb:function(){return this.$W("RegExStatistics")},set_$8pb:function(n){$1O(this,"RegExStatistics",n);return n},get_$8k9:function(){return this.$W("PerExtensionStatistics")},set_$8k9:function(n){$1O(this,"PerExtensionStatistics",n);return n},get_$Ww:function(){return this.$W("Interval")},set_$Ww:function(n){$1O(this,"Interval",n);return n},get_$7Gw:function(){return this.$W("FromHtmlStatistics")},set_$7Gw:function(n){$1O(this,"FromHtmlStatistics",n);return n},get_$7W6:function(){return this.$W("InnerTextStatistics")},set_$7W6:function(n){$1O(this,"InnerTextStatistics",n);return n},get_$7U0:function(){return this.$W("HtmlBodyLengthStatistics")},set_$7U0:function(n){$1O(this,"HtmlBodyLengthStatistics",n);return n},get_$71l:function(){return this.$W("ConvertedBodyLengthStatistics")},set_$71l:function(n){$1O(this,"ConvertedBodyLengthStatistics",n);return n},get_$7Cv:function(){return this.$W("EntityStatistics")},set_$7Cv:function(n){$1O(this,"EntityStatistics",n);return n}};_d.$HP=function(){this.$$d_$4zn=Function.createDelegate(this,this.$4zn);this.$3TL=6e5;this.$3kA=_a.$7.$cV;this.$1CM=[];this.$1Rq={};this.$1Rr={}};function $6NE(n,t){for(var i=new Sys.StringBuilder,r=0;r<_c.$84.$hv.Extensions.length;r++){var u=_c.$84.$hv.Extensions[r];var f=$8(n.$1Rq[u.Id])?0:n.$1Rq[u.Id];var e=$8(n.$1Rr[u.Id])?0:n.$1Rr[u.Id];i.append("[");i.append(t[r]?t[r].$1AU():"");i.append(",");i.append(f.toString());i.append(",");i.append(e.toString());i.append("]")}return i.toString()}function $21f(n){return n.$1CM.length>=n.$7hd||!_js.Trace.$2x}_d.$HP.prototype={$7hd:100,$13I:null,$kt:null,$eI:null,$1jg:null,$67J:function(n,t){if(!$21f(this)){this.$eI||(this.$eI=new _d.$HP.$4vw);if(!this.$eI.$33t){this.$eI.$33t=[];this.$eI.$2NL=[]}Array.add(this.$eI.$33t,n);Array.add(this.$eI.$2NL,t)}},$9Au:function(n){this.$1Rr[n]=$8(this.$1Rr[n])?1:this.$1Rr[n]+1},$67F:function(n,t,i){i&&(this.$1Rq[n]=$8(this.$1Rq[n])?1:this.$1Rq[n]+1);if(!$21f(this)){this.$eI||(this.$eI=new _d.$HP.$4vw);this.$eI.$63Y=t;this.$eI.$4dS=i;this.$13I||(this.$13I=new _d.$HP.$4dT);Array.add(this.$13I.$2km,this.$eI);this.$eI=null}},$67G:function(n,t){if(!$21f(this)){this.$1jg||(this.$1jg=new _d.$HP.$7ES);this.$1jg.$67G(n,t)}},$67K:function(n){if(!$21f(this)){this.$13I||(this.$13I=new _d.$HP.$4dT);this.$13I.$670=n;Array.add(this.$1CM,this.$13I);this.$13I=null}},$9Aq:function(n,t,i,r){if(!$21f(this)){this.$kt||(this.$kt=new _d.$HP.$6uj);this.$kt.$3d9.$5x(n,null);this.$kt.$3eH.$5x(r,null);this.$kt.$3Ye.$5x(i,null);this.$kt.$3Qk.$5x(t,null)}},$4xF:function(){var n=_a.$7.get_$2M();if(n.$6E(this.$3kA)>=this.$3TL){_a.$b.$8E.$6ph(this.$$d_$4zn);this.$8sR();this.$3kA=n}},$8sR:function(){this.$1CM=[];this.$1Rq={};this.$1Rr={};this.$13I=null;this.$eI=null;this.$kt=null;this.$1jg=null},$eU:function(n){var t=new Sys.StringBuilder;if($8(_c.$84.$hv))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$4zn().$J7(n));n&&t.append("</TABLE>")}return new _a.$LR("Pending Extensibility Statistics",t.toString())},$4zn:function(){var s=_c.$84.$hv.Extensions.length;var n=new _d.$z5;n.set_$71O(_c.$84.$2pe);n.set_$71L(s);if(this.$1CM.length>0){for(var r=0,h=new _d.$SN,i=new Array(s),c=new _d.$SN,u=0;u<this.$1CM.length;u++){var f=this.$1CM[u];h.$5x(f.$670,null);for(var e=0,t=0;t<f.$2km.length;t++){var o=f.$2km[t];o.$4dS&&e++;$8(i[t])&&(i[t]=new _d.$SN);var l=_c.$84.$hv.Extensions[t];var a=$8(l)?null:l.DisplayName;i[t].$5x(o.$63Y,a);o.$9Ez(c)}e>r&&(r=e)}n.set_$7hf(r);n.set_$6pc(this.$1CM.length);n.set_$9AR(h.$1AU());n.set_$8k9($6NE(this,i));n.set_$8pb(c.$1AU());n.set_$Ww(this.$3TL/1e3);if(this.$kt){n.set_$7Gw(this.$kt.$3Ye.$1AU());n.set_$7W6(this.$kt.$3eH.$1AU());n.set_$7U0(this.$kt.$3d9.$1AU());n.set_$71l(this.$kt.$3Qk.$1AU())}this.$1jg&&n.set_$7Cv(this.$1jg.$1AU())}return n}};_d.$HP.$4dT=function(){this.$2km=[]};_d.$HP.$4dT.prototype={$670:0};_d.$HP.$6uj=function(){this.$3Ye=new _d.$SN;this.$3eH=new _d.$SN;this.$3d9=new _d.$SN;this.$3Qk=new _d.$SN};_d.$HP.$4vw=function(){};_d.$HP.$4vw.prototype={$33t:null,$2NL:null,$63Y:0,$4dS:!1,$9Ez:function(n){if(this.$2NL)for(var t=0;t<this.$2NL.length;t++)n.$5x(this.$2NL[t],this.$33t[t])}};_d.$HP.$7ES=function(){};_d.$HP.$7ES.prototype={$5d4:0,$5d5:0,$5d6:0,$5d7:0,$5d8:0,$5d9:0,$5dA:0,$1Xc:null,$67G:function(n,t){this.$1Xc=null;var i=!t;if(n){var r=new(_0365f.$s.$$(_g.$gZ));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1OE(3);this.$5d4++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1OE(7);this.$5d5++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1OE(6);this.$5d6++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1OE(1);this.$5d7++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1OE(5);this.$5d8++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1OE(2);this.$5d9++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1OE(4);this.$5dA++}}},$1AU:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$5d4,this.$5d5,this.$5d6,this.$5d7,this.$5d8,this.$5d9,this.$5dA));if(this.$1Xc){n.append("MissingOnLastMessage:");for(var t=0;t<this.$1Xc.get_$F();t++){n.append(_g.$gZ.toString(this.$1Xc.get_$48(t)));n.append(",")}}return n.toString()},$1OE:function(n){this.$1Xc||(this.$1Xc=new(_0365f.$s.$$(_g.$gZ)));this.$1Xc.$H(n)}};_d.$Gc=function(n,t){this.$$d_$8vg=Function.createDelegate(this,this.$8vg);this.$$d_$8li=Function.createDelegate(this,this.$8li);_d.$Gc.initializeBase(this);this.$W9=n;this.$1AP=t;this.$32N=new _C(this.$$d_$8li,_a.$0.$5g);this.$28l=new _0365m.$2c(new Array(0));this.$1F4=new _js.$X};function $4NB(n){var r=n.$W9.get_$F();if(r>n.$17C){var t=0;n.$28l.$1B.$1u();while(t<r){var i=n.$W9.get_$48(t);if(n.$1F4.$7h(i)<0){var u=new _0365m.$n(i.$9g.DisplayName,null,new _d.$qz(n.$$d_$8vg,i),!0);n.$28l.$1B.$H(u)}t++}n.set_$55I(!1)}else{n.$28l.$1B.$1u();n.set_$55I(!0)}}_d.$Gc.prototype={$17C:0,$W9:null,$1F4:null,$28l:null,$1AP:null,$2jr:!0,$1cH:null,$1Hk:null,$32N:null,get_$55I:function(){return this.$2jr},set_$55I:function(n){if(this.$2jr!==n){this.$2jr=n;$6(this,_d.$Gc.$55J)}return n},get_$39u:function(){return this.$1cH},set_$39u:function(n){if(this.$1cH!==n){this.$1cH=n;$8(n)||$6(this,_d.$Gc.$4CV)}return n},get_$5GM:function(){return this.$1Hk},set_$5GM:function(n){this.$1Hk=n;if(n.$Sf===3){var t=this.$1Hk.$3Wi.get_$1s().extensionViewModel;if($8(t)||this.$1cH===t){this.$1AP.$IZ=null;this.$1AP.$s();this.$b7()}else{this.$1AP.$IZ=t;this.$1AP.$s();this.set_$39u(t)}}return n},$b7:function(){this.$1cH=null;$6(this,_d.$Gc.$4CV)},$8li:function(){if(!(this.$17C<1)){var n=0;var i=this.$W9.get_$F();var u=!1;var t=this.$1cH;var r=this.$17C;this.$1F4.$1u();while(n<r&&n<i){var o=this.$W9.get_$48(n);var f=n+1===r||n+1===i;($8(t)||o.$9g.Id===t.$9g.Id)&&(u=!0);var e=f&&!u?t:this.$W9.get_$48(n);this.$1F4.$H(e);e.set_$5B5(f&&i<=r);n++}this.set_$39u(t);$4NB(this)}},$8vg:function(n){n.set_$5B5(!1);this.$1F4.$67(this.$1F4.get_$F()-1);this.$1F4.$H(n);this.$1AP.$IZ=n;this.$1AP.$s();this.set_$39u(n);$4NB(this)}};_d.$qy=function(n,t,i){this.$$d_$4ws=Function.createDelegate(this,this.$4ws);this.$$d_$2gP=Function.createDelegate(this,this.$2gP);this.$$d_$53t=Function.createDelegate(this,this.$53t);_d.$qy.initializeBase(this);this.$7e=n;this.$NO=i;if(i!=="Mouse"){this.set_$7E(_y.$26.$Bv(this));var e=this;var o=new _C(function(){e.$5H()},_a.$0.$5g);this.$3t.set_$MS([new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$1HR())if(_g.$39.isInstanceOfType(this.$7e.$P))this.set_$3je(this.$7e.$P.get_$3c().get_$1d());else if(this.$7e.$P.get_$I3()&&this.$7e.$P.get_$I3().get_$1d())this.set_$3je(this.$7e.$P.get_$I3().get_$1d());else{var r=_0365f.$2t.$46(_h.$11.get_$yZ());r.MaximumBodySize=0;var u=new _h.$Gf(100,[this.$7e.$P.get_$i()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2A(function(n){f.set_$3je(f.$7e.$P.get_$I3().get_$1d())});OwaApplication.$1T.$y(u)}};_d.$qy.prototype={$Fw:null,$7e:null,$10K:null,$3jd:null,$1mx:!1,$1hb:null,$NO:0,get_$3je:function(){return this.$3jd},set_$3je:function(n){this.$3jd=n;$6(this,"ItemBodyValue");return n},get_$427:function(){return 4},get_$2Ao:function(){return this.$$d_$53t},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$7A8:function(){return!0},get_$Jr:function(){return this.$NO!=="Mouse"?1:0},get_$5ga:function(){return this.$10K},set_$5ga:function(n){this.$10K=n;return n},$53t:function(n,t){if(this.$1mx)return!1;if(this.$10K){this.$1hb=n;this.$10K(this.$$d_$2gP);return!0}this.$2gP();return!1},$5H:function(){this.$1mx||(this.$NO==="TouchNarrow"?this.$10K?this.$10K(this.$$d_$4ws):this.$4ws():this.get_$8K()&&this.get_$8K()())},$4ws:function(){this.$1mx=!0;this.get_$8K()&&this.get_$8K()()},$2gP:function(){this.$1mx=!0;this.$1hb&&this.$1hb()}};_d.$kc=function(){};_d.$kc.prototype={$73s:function(n,t,i){return new _d.$qy(n,t,i)},$73A:function(n,t){return new _d.$qC(n,t)}};_d.$QZ=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$5k6=Function.createDelegate(this,this.$5k6);this.$$d_$4wr=Function.createDelegate(this,this.$4wr);this.$$d_$5na=Function.createDelegate(this,this.$5na);_d.$QZ.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a])};function $6NG(n){"Mouse"!==n.$G.get_$O()&&n.$Fj&&(n.$1D.get_$5h()?n.$9I.$4uv(n.$Fj.get_$4uy(),n.$Fj.get_$28k().DisplayName,n.$$d_$5na,n.$$d_$4wr):n.$5na())}function $6NF(n){n.$19Z=n.$1Rp.$73s(n,n.$1D,n.$G.get_$O());n.$19Z.set_$5ga(n.$$d_$5k6);n.$G.$9T(n.$19Z)}_d.$QZ.prototype={$19Z:null,$3Xn:null,$30J:function(n){_d.$2r.prototype.$30J.call(this,n);$6NG(this)},$6e:function(){_d.$2r.prototype.$6e.call(this);this.$19Z&&this.$19Z.$5H()},$79h:function(n){return"Mouse"!==this.$G.get_$O()||!n},$5na:function(){$3Ez(this,!0);$6NF(this)},$5k6:function(n){this.$10V&&this.$10V.$b7();this.$3Xn=n;$3F0(this,!0);this.$1D.get_$5h()?this.$9I.$4vg():this.$4wr()},$4wr:function(){this.$3Xn&&this.$3Xn()}};_d.$z7=function(n){_d.$z7.initializeBase(this,[1,"VM.Extensibility."+n])};_d.$z7.prototype={$y:function(){_a.$b.$8E.$A7(this)},$8lR:function(n){var t=n;for(var i in t){var r={key:i,value:t[i]};$1O(this,r.key,r.value)}}};_d.$qz=function(n,t){this.$$d_$7E3=Function.createDelegate(this,this.$7E3);_d.$qz.initializeBase(this);this.set_$5P(!0);this.set_$N5(this.$$d_$7E3);this.$582=n;this.$IZ=t;this.$1n=_a.$0.$5g};_d.$qz.prototype={$582:null,$IZ:null,$7E3:function(){this.$582(this.$IZ)}};_d.$Qa=function(n,t,i,r,u,f,e,o,s,h){this.$1Rp=n;this.$F5=t;this.$1v1=i;this.$9I=r;this.$1D=u;this.$G=f;this.$S=e;this.$28h=o;this.$28j=s;this.$Lo=h};function $4NI(n,t,i,r){return new _d.$QZ(n.$F5,n.$9I,n.$1D,n.$G,n.$1Rp,!0,_a.$Bw.$s2(),n.$1v1,n.$S,n.$Lo,t,i,r)}_d.$Qa.prototype={$F5:null,$1v1:null,$9I:null,$1D:null,$G:null,$1Rp:null,$S:null,$28h:null,$28j:null,$Lo:null,$3Rl:function(n,t){return $4NI(this,n,this.$28h.$4pA(n,t),this.$28j.$3Rl(n,t))},$4o9:function(n){return $4NI(this,n,this.$28h.$4pA(n,!1),this.$28j.$4o9(n))},$4ov:function(n,t){return new _d.$J1(_a.$0.$d,t,this.$F5,this.$9I,this.$1D,this.$G,this.$1Rp,!0,_a.$Bw.$s2(),this.$1v1,this.$S,this.$Lo,null,this.$28h.$4oD(2),this.$28j.$4ov(n))},$4o6:function(n,t){return new _d.$J1(_a.$0.$1o,t,this.$F5,this.$9I,this.$1D,this.$G,this.$1Rp,!0,_a.$Bw.$s2(),this.$1v1,this.$S,this.$Lo,null,this.$28h.$4oD(3),this.$28j.$4o6(n))}};_d.$HQ=function(n,t){this.$$d_$4ed=Function.createDelegate(this,this.$4ed);this.$2BO=[];_d.$HQ.initializeBase(this);this.$9g=n;this.$ht=t;this.$1O8=_d.$Bq.$I(n.Rule,this.$ht)};_d.$HQ.$67m=function(n,t,i){i.val=null;var r=new _d.$HQ(n,t);var u=null;var f=0;var e,o,s;if(s=_d.$HQ.$9Bb(n,t.$1FR,e={val:u},o={val:f}),u=e.val,f=o.val,s){r.$3WT=u;r.$4rM=f;i.val=r;return!0}return!1};_d.$HQ.$9Bb=function(n,t,i,r){i.val=null;r.val=0;var u;if(t===1)u=0;else if(t===2||t===3)u=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,f=0;f<s;++f){var e=o[f];if(e.SettingsType===u){i.val=e.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=e.RequestedHeight;return!0}}return!1};_d.$HQ.prototype={$3WT:null,$4rM:0,$9g:null,$1O8:null,$ht:null,$3h6:!1,get_$28k:function(){return this.$9g},get_$JC:function(){return this.$9g.AppStatus},get_$2fN:function(){return this.$9g.EndNodeUrl},get_$1l:function(){return this.$9g.DisplayName},get_$7ef:function(){return this.$9g.LicenseType},get_$8o3:function(){return this.$9g.ProviderName},get_$608:function(){return _js.$8.$14(this.$9g.Settings)?{}:JsonParser.deserialize(this.$9g.Settings)},set_$608:function(n){this.$9g.Settings=n?JsonParser.serialize(n):"";return n},get_$7U7:function(){return this.$9g.IconUrl},get_$4uy:function(){return this.$3WT},get_$5B5:function(){return this.$3h6},set_$5B5:function(n){if(n!==this.$3h6){this.$3h6=n;$6(this,"IsLastExtension")}return n},get_$2k9:function(){return this.$2BO},set_$2k9:function(n){this.$2BO=n;return n},$8yW:function(n){var u=this.$ht.$3m9;var s=this.$ht.$2NK;Array.clear(this.$2BO);if(!this.$9g.DisableEntityHighlighting){var t={};var f=s;for(var e in f)for(var h={key:e,value:f[e]},o=h.value,i=0;i<o.length;i++)this.$4ed(o[i],null,t);for(var r=0;r<u.length;r++){var c=u[r];switch(c){case 3:_d.$5Y.$15O(n.Addresses,"Address",t,this.$$d_$4ed);break;case 6:_d.$5Y.$15O(n.EmailAddresses,"EmailAddress",t,this.$$d_$4ed);break;case 4:_d.$5Y.$15O(n.Urls,"Url",t,this.$$d_$4ed);break;case 1:_d.$5Y.$15O(n.MeetingSuggestions,"MeetingString",t,this.$$d_$4ed);break;case 2:_d.$5Y.$15O(n.TaskSuggestions,"TaskString",t,this.$$d_$4ed);break;case 5:_d.$5Y.$15O(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$4ed);break;case 7:_d.$5Y.$15O(n.Contacts,"ContactString",t,this.$$d_$4ed);break}}this.$ht.$rG.$7GR(t,this.$$d_$4ed)}},$4ed:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$2BO,n);r[n]=!0}}};_d.$Bq=function(){};_d.$Bq.$I=function(n,t){var i=_d.$Bq.$4p1(n,t);if(!$8(i)){t.$4qU>7&&$1dz(i,"Number of custom pattern rules exceeds the limit of "+7+".");t.$5w3>15&&$1dz(i,"Number of rules exceeds the limit of "+15+".");if(i.$Kq)return i}return null};_d.$Bq.$3iG=function(n){return n.$1FR===1};_d.$Bq.$4p1=function(n,t){return $8(n)?null:++t.$5w3>15?null:n.Type==="Collection"?new _d.$xC(n,t):n.Type==="ItemIs"?new _d.$KN(n):n.Type==="ItemHasKnownEntity"?new _d.$5Y(n):n.Type==="ItemHasRegularExpressionMatch"?new _d.$Gj(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _d.$12h:null};function $1dz(n,t){_js.Trace.logError(_a.$0.$5g,t);n.$Kq=!1}_d.$Bq.prototype={$Kq:!0,$5B2:function(n,t){return!0}};_d.$xC=function(n,t){_d.$xC.initializeBase(this);if($8(n.Mode)){$1dz(this,"Collection rule with no required 'mode' attribute found.");return}if($8(n.Rules)||!n.Rules.length){$1dz(this,"Collection rule with no required 'rule' attribute found.");return}this.$3f8="And"===n.Mode;this.$1hE=new _js.$X;for(var i=0;i<n.Rules.length;i++){var r=_d.$Bq.$4p1(n.Rules[i],t);$8(r)||this.$1hE.$H(r)}};_d.$xC.prototype={$3f8:!1,$1hE:null,$2ff:function(n,t,i){for(var r=this.$3f8,u=0;u<this.$1hE.get_$F();u++){var f=this.$1hE.get_$48(u);r=this.$3f8?!!(r&f.$2ff(n,t,i)):!!(r|f.$2ff(n,t,i))}return r},$5B2:function(n,t){for(var i=0;i<this.$1hE.get_$F();i++){var r=this.$1hE.get_$48(i);if(!r.$5B2(n,t))return!1}return!0}};_d.$qv=function(n,t){this.$3m9=[];this.$rG=new _d.$75;this.$Lo=n;this.$1FR=t};_d.$qv.prototype={$4qU:0,$5w3:0,$2NK:null,$iO:!1,$Lo:null,$1FR:0};_d.$75=function(){};_d.$75.$1SG=function(n,t,i,r){if(n){var u=n;for(var f in u){var e={key:f,value:u[f]};_d.$5Y.$15O(e.value,t,i,r)}}};_d.$75.$1OG=function(n,t,i){i&&(n[t]=i)};_d.$75.$1OF=function(n,t,i){n.val||(n.val={});n.val[t]=i};_d.$75.prototype={$84:null,$149:null,$PZ:null,$1Vu:null,$10p:null,$1cO:null,$12b:null,$7JY:function(){var n={};_d.$75.$1OG(n,"Addresses",this.$84);_d.$75.$1OG(n,"Contacts",this.$149);_d.$75.$1OG(n,"EmailAddresses",this.$PZ);_d.$75.$1OG(n,"MeetingSuggestions",this.$1Vu);_d.$75.$1OG(n,"PhoneNumbers",this.$10p);_d.$75.$1OG(n,"TaskSuggestions",this.$1cO);_d.$75.$1OG(n,"Urls",this.$12b);return n},$4dk:function(n,t,i){switch(n){case 3:var r;_d.$75.$1OF(r={val:this.$84},t,i);this.$84=r.val;break;case 7:var u;_d.$75.$1OF(u={val:this.$149},t,i);this.$149=u.val;break;case 6:var f;_d.$75.$1OF(f={val:this.$PZ},t,i);this.$PZ=f.val;break;case 1:var e;_d.$75.$1OF(e={val:this.$1Vu},t,i);this.$1Vu=e.val;break;case 5:var o;_d.$75.$1OF(o={val:this.$10p},t,i);this.$10p=o.val;break;case 2:var s;_d.$75.$1OF(s={val:this.$1cO},t,i);this.$1cO=s.val;break;case 4:var h;_d.$75.$1OF(h={val:this.$12b},t,i);this.$12b=h.val;break;default:break}},$7GR:function(n,t){_d.$75.$1SG(this.$84,"Address",n,t);_d.$75.$1SG(this.$149,"ContactString",n,t);_d.$75.$1SG(this.$PZ,"EmailAddress",n,t);_d.$75.$1SG(this.$1Vu,"MeetingString",n,t);_d.$75.$1SG(this.$10p,"OriginalPhoneString",n,t);_d.$75.$1SG(this.$1cO,"TaskString",n,t);_d.$75.$1SG(this.$12b,"Url",n,t)}};_d.$12h=function(){_d.$12h.initializeBase(this)};_d.$12h.prototype={$2ff:function(n,t,i){return _d.$Bq.$3iG(t)?n.get_$FL()!==undefined&&n.get_$FL():!1}};_d.$5Y=function(n){this.$$d_$7DJ=Function.createDelegate(this,this.$7DJ);_d.$5Y.initializeBase(this);$8(n.EntityType)?$1dz(this,"ItemHasKnownEntity rule contains null entity type."):this.$Ds=n};_d.$5Y.$15O=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_d.$5Y.$1Fa=function(n,t,i){if($8(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_d.$5Y.$7Yt(i,e,t)){f[r]=_d.$5Y.$7K9(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$5g,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$5g,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_d.$5Y.$7Yt=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_d.$5Y.$5CM(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_d.$5Y.$5CM=function(n){return n===7||n===1||n===2};_d.$5Y.$7K9=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$7.$4Y(i.StartTime,!0).$55());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$7.$4Y(i.EndTime,!0).$55());return i;default:return n}};function $1Nh(n,t,i,r){var u=null;!$8(i)&&i.length>0&&(u=_d.$5Y.$1Fa(i,n.$Ds.EntityType,t.$iO));if(u){if(!n.$1wT){Array.add(t.$3m9,n.$Ds.EntityType);return!0}var f=_a.$7.get_$2M();_d.$5Y.$15O(u,r,null,n.$$d_$7DJ);t.$Lo.$67J(n.$Ds.FilterName,_a.$7.get_$2M().$6E(f));if(n.$rG){t.$rG.$4dk(n.$Ds.EntityType,n.$Ds.FilterName,n.$rG);return!0}}n.$1wT&&t.$rG.$4dk(n.$Ds.EntityType,n.$Ds.FilterName,null);return!1}function $6O6(n,t){return t?n.$Ds.EntityType===3&&t.ExtractedAddresses||n.$Ds.EntityType===7&&t.ExtractedContacts||n.$Ds.EntityType===6&&t.ExtractedEmails||n.$Ds.EntityType===1&&t.ExtractedMeetings||n.$Ds.EntityType===5&&t.ExtractedPhones||n.$Ds.EntityType===2&&t.ExtractedTasks||n.$Ds.EntityType===4&&t.ExtractedUrls:!1}_d.$5Y.prototype={$Ds:null,$1wT:null,$rG:null,$5B2:function(n,t){return n.get_$x2()?!0:$6O6(this,n.get_$332())?this.$1wT?!1:t.$iO?!1:!_d.$5Y.$5CM(this.$Ds.EntityType):!0},$2ff:function(n,t,i){if(!_d.$Bq.$3iG(t))return!1;this.$rG=null;var r=n.get_$x2();if($8(r))return!1;if(this.$Ds.RegExFilter){var f,e;if(!(e=_d.$Gj.$67n(this.$Ds.RegExFilter,this.$Ds.IgnoreCase,f={val:this.$1wT}),this.$1wT=f.val,e))return!1}var u=!1;switch(this.$Ds.EntityType){case 3:u=$1Nh(this,t,r.Addresses,null);break;case 7:u=$1Nh(this,t,r.Contacts,"ContactString");break;case 6:u=$1Nh(this,t,r.EmailAddresses,null);break;case 1:u=$1Nh(this,t,r.MeetingSuggestions,"MeetingString");break;case 5:u=$1Nh(this,t,r.PhoneNumbers,"OriginalPhoneString");break;case 2:u=$1Nh(this,t,r.TaskSuggestions,"TaskString");break;case 4:u=$1Nh(this,t,r.Urls,null);break}return u},$7DJ:function(n,t,i){var r=n.match(this.$1wT);if(r&&r.length>0){this.$rG||(this.$rG=[]);Array.add(this.$rG,t)}}};_d.$Gj=function(n,t,i){this.$58Z=16e3;this.$3ex=64e3;this.$4yX=5e5;_d.$Gj.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$Ds=n;t.$4qU++}else $1dz(this,"Invalid ItemHasRegularExpressionMatchRule rule.");this.$1D=i};_d.$Gj.$67n=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$5g,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_d.$Gj.$8qb=function(n){for(var t=n.length-1;t>=0;t--){var i=!1;if(t>=50||n[t].length>3072)i=!0;else for(var r=t-1;r>=0;r--)if(n[t]===n[r]){i=!0;break}i&&Array.removeAt(n,t)}return n};_d.$Gj.$7Kg=function(n,t){if(t){if(n.get_$Mf())return n.get_$Mf().get_$1d()}else if(n.get_$I3())return n.get_$I3().get_$1d();else if(n.get_$3c())return n.get_$3c().get_$1d();_js.Trace.logWarning(_a.$0.$5g,"Skipping regex eval: no body for item with Id: {0}.",n.get_$i()?n.get_$i().Id:"'null id'");return null};function $6O7(n,t,i,r){if(n.$Ds.PropertyName===1)return t.get_$2h();else if(n.$Ds.PropertyName===4){var u=null;if(_g.$7f.isInstanceOfType(t))t.get_$9o()&&(u=t.get_$9o().Mailbox);else if(_g.$39.isInstanceOfType(t)){var o=t.get_$Cl();o&&(u=o.Mailbox)}if(u&&u.EmailAddress)return u.EmailAddress}else if(n.$Ds.PropertyName===3){var s=null;t.get_$cY()===3&&(s=$4NT(n,t,i.$iO));return s}else if(n.$Ds.PropertyName===2){if(r.val)return r.val;var f=$4NT(n,t,i.$iO);var c=_a.$7.get_$2M();var e=$(f);var h=_a.$7.get_$2M();e[0]&&(r.val=e[0].innerText);$8(r.val)&&(r.val=e.text());var l=_a.$7.get_$2M();i.$Lo.$9Aq(f?f.length:0,r.val?r.val.length:0,h.$6E(c),l.$6E(h));return r.val}return null}function $4NT(n,t,i){var r=_d.$Gj.$7Kg(t,i);if(r){if(r.length>n.$4yX){_js.Trace.logInfo(_a.$0.$5g,"Body size exceeds general activation size limit");r=null}if(n.$1D.get_$3gz()||n.$1D.get_$2mv())if(n.$Ds.PropertyName===2){if(r.length>n.$58Z){_js.Trace.logInfo(_a.$0.$5g,"Body size exceeds IPhone/IPad activation size limit");r=null}}else if(n.$Ds.PropertyName===3&&r.length>n.$3ex){_js.Trace.logInfo(_a.$0.$5g,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");r=r.substr(0,n.$3ex)}}return r}_d.$Gj.prototype={$Ds:null,$1D:null,$2ff:function(n,t,i){if(!_d.$Bq.$3iG(t))return!1;var r=null;var f=$6O7(this,n,t,i);if(f){var u;var e,o;if(!(o=_d.$Gj.$67n(this.$Ds.RegExValue,this.$Ds.IgnoreCase,e={val:u}),u=e.val,o))return!1;var s=_a.$7.get_$2M();r=f.match(u);t.$Lo.$67J(this.$Ds.RegExName,_a.$7.get_$2M().$6E(s));if(r&&r.length>0){r=_d.$Gj.$8qb(r);if(r.length>0){t.$2NK[this.$Ds.RegExName]=r;return!0}}}t.$2NK[this.$Ds.RegExName]=new Array(0);return!1}};_d.$KN=function(n){_d.$KN.initializeBase(this);this.$56k=n.IncludeSubClasses;this.$sT=n.ItemType;this.$2Ef=n.FormType;$8(n.ItemClass)||(this.$2p7=n.ItemClass.toLowerCase())};_d.$KN.$3hY=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_d.$KN.$58t=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_d.$KN.prototype={$2p7:null,$56k:!1,$sT:0,$2Ef:0,$2ff:function(n,t,i){if(t.$1FR===1&&(this.$2Ef===2||this.$2Ef===3)){if(!$8(n.get_$7G())){var r=n.get_$7G().toLowerCase();if(this.$sT===1&&_g.$7f.isInstanceOfType(n)&&_d.$KN.$3hY(r)||this.$sT===2&&_g.$39.isInstanceOfType(n)&&_d.$KN.$58t(r)){if(!this.$2p7)return!0;if(this.$56k){if(r.startsWith(this.$2p7))return!0}else if(r===this.$2p7)return!0}}}else if(t.$1FR===2&&this.$sT===1||t.$1FR===3&&this.$sT===2)return this.$2Ef===1||this.$2Ef===3;return!1}};_d.$Fu=function(n,t,i,r){this.$$d_$4hh=Function.createDelegate(this,this.$4hh);this.$$d_$8bp=Function.createDelegate(this,this.$8bp);this.$$d_$3z2=Function.createDelegate(this,this.$3z2);_d.$Fu.initializeBase(this);this.$Xc=r;this.$8V=n;this.$EK=new _C(this.$$d_$3z2,_a.$0.$4H);this.set_$1vO(i.$UE(1,_y.$q.$Mp,this.$8V.get_$MJ(),0));this.$8V.get_$MJ().add_$1Z(this.$$d_$8bp);t.add_$U5(this.$$d_$4hh);if(r.get_$im()&&!r.get_$im().closed){var u=this;_a.$3b.$Ee(r.get_$im(),function(n){n.$6xE(u.$8V.get_$T())})}};_d.$Fu.prototype={$Xc:null,$8V:null,$EK:null,$HB:null,$435:null,get_$1vO:function(){return this.$W(_d.$Fu.$40U)},set_$1vO:function(n){this.$N(_d.$Fu.$40U,n);return n},get_$2Oq:function(){return this.$W(_d.$Fu.$47N)},set_$2Oq:function(n){this.$N(_d.$Fu.$47N,n);return n},get_$Ni:function(){return this.$435},set_$Ni:function(n){this.$435=n;$6(this,"RawEditorContent");return n},$8bp:function(n,t){switch(t.$3R){case 0:for(var i=0;i<t.$2t.length;i++){var f=t.$2t[i];this.get_$1vO().$1fK(f)}return;case 2:for(var r=t.$3Y.length-1;r>=0;r--){var e=t.$3Y[r];var o=this;var u=this.get_$1vO().$1L.$DK(function(n){var t=n;return t.$BY.get_$8e()===e.get_$8e()});u<this.get_$1vO().$1L.get_$F()&&this.get_$1vO().$1L.$67(u)}return}},$3z2:function(){if(!_js.$8.$c(this.get_$2Oq())){this.$8V.$93A(this.get_$2Oq());var n=this;_a.$3b.$Ee(this.$Xc.get_$im(),function(t){t.$36J(n.$8V.get_$1y().Id,n.get_$2Oq())})}},$4hh:function(n){_js.Trace.logInfo(_a.$0.$4H,"ChatViewModel.BeforeUnload invoked.");this.$8V.get_$MJ().remove_$1Z(this.$$d_$8bp);var t=this;_a.$3b.$Ee(this.$Xc.get_$im(),function(n){_js.Trace.logInfo(_a.$0.$4H,"ChatViewModel.BeforeUnload calling into main window.");n.$7Cb(t.$8V.get_$T())})}};_d.$XG=function(n,t,i){this.$G=n;this.$66=t;this.$Xc=i};_d.$XG.prototype={$G:null,$66:null,$Xc:null,$8iD:function(n){var i={};i.ItemID=n.get_$i();var r=new _d.$O6;r.set_$4H(n);var t=_y.$3p.get_$7UP();if(n.$3Cs!==-1&&n.$3Cx!==-1){t.$3Cr=n.$3Cs;t.$3Cw=n.$3Cx}_js.Trace.logInfo(_a.$0.$4H,"ChatViewModelFactory: Chat.BodyText: {0}",n.get_$1P8());var u=this;this.$G.$L9(_d.$XG,function(){return u},i,t,r,!1)},$ct:function(n){return null},$wD:function(n){var t=n.get_$4H();return new _d.$Fu(t,this.$G,this.$66,this.$Xc)}};_d.$O6=function(){_d.$O6.initializeBase(this)};_d.$O6.prototype={get_$4H:function(){return this.$W(_d.$O6.$3P3)},set_$4H:function(n){this.$N(_d.$O6.$3P3,n);return n},get_$1tl:function(){return[this.get_$4H()]}};_d.$17B=function(n){this.$Xc=n};_d.$17B.prototype={$Xc:null,$4Ah:function(n,t,i){for(var u=new Array(n.get_$F()),f=new Array(n.get_$F()),r=0;r<n.get_$F();r++){var e=n.get_$48(r);u[r]=e.get_$1l();f[r]=e.get_$8e()}var o=$8(t)?null:t.get_$T();var s=this;_a.$3b.$Ee(this.$Xc.get_$im(),function(n){n.$4Ah(u,f,o,i)})}};_d.$Qg=function(){_d.$Qg.initializeBase(this);this.$Oq=_c.$14.$1KO;this.$31y=_d.$Qg.$4rT;this.$19k=2};_d.$Qg.prototype={$2B:null,$Oq:null,$1CX:null,$31y:null,$3a4:function(n){return _c.$14.$1E4(this.$2k,this.$2B,n,this.$Oq,null,this.$1CX,this.$31y,1)}};_d.$r7=function(n){_d.$r7.initializeBase(this);this.$2Mp=n;switch(this.$2Mp){case 2:case 6:this.$19k=1;break;case 1:this.$19k=3;break;default:throw Error.argumentOutOfRange("querySources",n,"Unsupported source for places action provider");}};_d.$r7.prototype={$3a4:function(n){var t=new _g.$Qi;t.Query=this.$2k;t.Sources=this.$2Mp;t.MaxResults=12;t.Culture=_g.$S.get_$L().get_$38().get_$73();if(this.$1wC.$Fy.$Sv()){t.Latitude=this.$1wC.$Fy.$NM;t.Longitude=this.$1wC.$Fy.$NS}return new _c.$kk(t,n)}};_d.$Yk=function(n,t,i,r){this.$$d_$1Jy=Function.createDelegate(this,this.$1Jy);this.$$d_$5Fv=Function.createDelegate(this,this.$5Fv);this.$$d_$6AP=Function.createDelegate(this,this.$6AP);_d.$Yk.initializeBase(this,[n,t,!1,null,!1,r,null,null]);this.$1vl=t;this.$6n=i;this.set_$7F5("");this.$6AQ=new _C(this.$$d_$6AP,_a.$0.$4h);this.$5G1=new _C(this.$$d_$5Fv,_a.$0.$4h);this.$16l=!0;this.$a("QueryString",this.$$d_$1Jy)};function $4NK(n,t,i){var u=t.$3a6();i.val=-1;for(var r=0;r<n.$1vl.$1p.get_$F();r++){var f=n.$1vl.$1p.get_$48(r);if(f.$3a6()===u){i.val=r;return!0}}return!1}_d.$Yk.prototype={$1vl:null,$6n:null,$1U9:!1,$5G1:null,$6AQ:null,$2Sb:null,$49j:!0,$16l:!1,get_$9Fv:function(){return!1},get_$7eT:function(){return"http://go.microsoft.com/fwlink/?LinkId=260597"},get_$93P:function(){return!this.$1vl.$1p.get_$F()},get_$7aG:function(){return this.$1U9},set_$7aG:function(n){if(this.$1U9!==n){this.$1U9=n;this.$1U9&&this.$cy(_u.Strings.l_LearnMore_Aria_Text);$Q(this,"IsLearnMoreButtonHighlighted")}return n},get_$7eS:function(){return this.$5G1},get_$94a:function(){return this.$49j},set_$94a:function(n){if(this.$49j!==n){this.$49j=n;$Q(this,"ShowUseThisLocationButton")}return n},get_$9GD:function(){return this.$2Sb},set_$9GD:function(n){if(this.$2Sb!==n){this.$2Sb=n;this.$16l&&this.$cy(this.$2Sb);$Q(this,"UseThisLocationString")}return n},get_$9GC:function(){return this.$6AQ},get_$7d7:function(){return this.$16l},set_$7d7:function(n){if(this.$16l!==n){this.$16l=n;this.$16l&&this.$cy(this.$2Sb);$Q(this,"IsUseThisLocationButtonHighlighted")}return n},$67k:function(n){n&&!this.$7ba(n)&&this.$1vl.$1p.$H(n)},$5uA:function(){this.set_$7aG(!1);this.set_$ev(!1);this.set_$e4(-1);this.set_$HU(-1);this.set_$7d7(!0)},$794:function(n){var t;var i,r;if(n&&(r=$4NK(this,n,i={val:t}),t=i.val,r)){this.$1vl.$1p.$67(t);var u=new _g.$Y5;u.Id=n.$3a6();var f=new _c.$yL(u);this.$1T.$y(f)}},$7ba:function(n){var t;var i,r;return r=$4NK(this,n,i={val:t}),t=i.val,r},$2c0:function(n){var t=new _d.$7l(n,_y.$q.$1VE,!1);t.$Xp(1,_d.$DC.$2qK,"");if($8(n.get_$2g()))return t;t.$8lg();return t},$8fA:function(){this.set_$a9(!1);this.set_$HU(-1);this.set_$e4(-1)},$921:function(){return!1},$4ji:function(){if(this.$16l)return!0;else if(!this.$8a.get_$F()&&this.$mK){this.set_$ev(!1);this.set_$7d7(!0);return!0}else if(this.$EI){if(this.$1U9){this.set_$7aG(!1);this.set_$ev(!0);return!0}}else{this.set_$e4(-1);this.set_$HU(-1);this.set_$7d7(!0);return!0}return _d.$22.prototype.$4ji.call(this)},$4jh:function(){if(this.$16l){this.set_$7d7(!1);if(this.$8a.get_$F()){this.set_$e4(0);this.set_$HU(0);return!0}else{this.set_$ev(!0);return!0}}else if(this.$mK&&this.get_$93P()){this.set_$ev(!1);this.set_$7aG(!0);return!0}else if(this.$1U9)return!0;return _d.$22.prototype.$4jh.call(this)},get_$5wh:function(){return _u.Strings.l_LocationWellSearchForMoreLocations_Text},$46V:function(){this.$16l?this.$6AP():this.$1U9?this.$5Fv():_d.$22.prototype.$46V.call(this)},$5Fv:function(){this.$6n.$Q9(this.get_$7eT())},$6AP:function(){this.set_$a9(!1)},$1Jy:function(n,t){this.set_$9GD(_js.$8.$4C(_u.Strings.l_UseThisLocation_Text,this.$2k))}};_d.$5i=function(n,t,i,r){this.$$d_$92M=Function.createDelegate(this,this.$92M);this.$$d_$92A=Function.createDelegate(this,this.$92A);this.$$d_$92K=Function.createDelegate(this,this.$92K);this.$$d_$942=Function.createDelegate(this,this.$942);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$4d6=Function.createDelegate(this,this.$4d6);this.$$d_$9AF=Function.createDelegate(this,this.$9AF);this.$$d_$9AE=Function.createDelegate(this,this.$9AE);this.$$d_$1lB=Function.createDelegate(this,this.$1lB);this.$CY=-1;this.$1TD=-1;this.$1Hv=new _a.$9N;this.$1Hw=new _a.$9N;this.$1Vi=new _a.$9N;this.$se=_a.$7L.$1Qv;this.$1Vk=10;this.$47=new Sys.EventHandlerList;_d.$5i.initializeBase(this);_a.$3.$17(i,"locationManager");this.$sf=n;this.$MN=t;this.$id=i;this.$6n=r;if(this.$MN){var u=n.get_$48(0);if($8(u))throw Error.argument("mapPoints","mapPoints should contain at least one IMappable object.");if(n.get_$F()===1){var f=u.get_$1pp().get_$RR()==="PhonebookServices"?u.get_$1pp().get_$yi():"";this.$q9=new _a.$MQ(_g.$S.get_$L().get_$Mm().get_$4sp(),_a.$7L.$1Qv,_g.$S.get_$L().get_$38().get_$73(),u.get_$2Fx(),u.get_$1pp().get_$1VM(),u.get_$2qv(),f)}}else n.get_$F()||(this.$1Vk=1);this.set_$3Uc(new _C(this.$$d_$1lB,_d.$5i.$D));this.set_$3Si(new _C(this.$$d_$9AE,_d.$5i.$D));this.set_$4EI(new _C(this.$$d_$9AF,_d.$5i.$D));_y.$j.$g.get_$O()!=="Mouse"&&$12z(this)};function $6OL(n){n.$5uL();n.$MN&&n.$sf.get_$F()===1&&n.set_$2qu(!1);n.get_$2CR()&&$12z(n)}function $6OM(n,t){if(!t){n.set_$2Pq(t);return}var i=this,r=this;n.$id.$4zl(function(i){n.set_$7go(i);n.set_$2Pq(t)},function(n){if(_y.$j.$g.get_$O()==="Mouse")switch(n.$4ld){case 2:case 3:_a.$6R.$3A(_u.Strings.l_CurrentLocationError_Text,1);break;case 1:break}})}function $6OK(n){if(!n.$97h){var t=n.$q9.get_$7Gm();_a.UserAgent.getInstance().get_$5h()&&(_a.UserAgent.getInstance().$Wz?t=n.$q9.get_$6ry():_a.UserAgent.getInstance().get_$Gj()&&(t=n.$q9.get_$6sC()));n.$6n.$Q9(t)}}function $12z(n){n.$MN?n.$sf.get_$F()===1?n.set_$7E($6OJ(n)):n.set_$7E(_y.$26.$I(n)):n.set_$7E($6OI(n))}function $6OJ(n){var t=[new _y.$2f(_y.$c.get_$79q(),_y.$c.get_$79v(),_u.Strings.l_GetDirectionsMobile_Text,n.$wb)];return _y.$26.$I(n,t,$3F7(n))}function $6OI(n){if(_y.$j.$g.get_$O()==="TouchNarrow"){var t=null;if(!n.$558){var u=this;t=new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItemMobile_Text,new _C(n.$$d_$4d6,_d.$5i.$D,n,"SelectedIndex",function(){return n.$CY!==-1}))}var i=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItemMobile_Text,new _C(n.$$d_$eC,_d.$5i.$D));var r=n.$558?[i]:[t,i];return _y.$26.$Bv(n,r,$3F7(n))}else return _y.$26.$I(n,null,$3F7(n))}function $3F7(n){var i=new _y.$2j(n.$1M5?_u.Strings.l_HideCurrentLocation_Text:_u.Strings.l_ShowCurrentLocation_Text,n.$14P);var r=new _y.$2j(n.$1MI?_u.Strings.l_HideTraffic_Text:_u.Strings.l_ShowTraffic_Text,n.$1BI);var t=[i,r];if(n.$se!=="r"){var u=new _C(n.$$d_$942,_d.$5i.$D);var f=new _y.$2j(_u.Strings.l_RoadView_Text,u);Array.add(t,f)}if(n.$se!=="auto"){var e=new _C(n.$$d_$92K,_d.$5i.$D);var o=new _y.$2j(_u.Strings.l_AutomaticView_Text,e);Array.add(t,o)}if(n.$se!=="a"){var s=new _C(n.$$d_$92A,_d.$5i.$D);var h=new _y.$2j(_u.Strings.l_AerialView_Text,s);Array.add(t,h)}if(n.$se!=="be"){var c=new _C(n.$$d_$92M,_d.$5i.$D);var l=new _y.$2j(_u.Strings.l_BirdsEyeView_Text,c);Array.add(t,l)}return t}_d.$5i.prototype={$MN:!1,$sf:null,$id:null,$qN:!0,$2qt:!1,$q9:null,$97h:!1,$2R3:!1,$1M5:!1,$1MI:!1,$558:!1,$wb:null,$14P:null,$1BI:null,$6n:null,get_$Jr:function(){return _y.$j.$g.get_$O()!=="Mouse"?_y.$1De.prototype.get_$Jr.call(this):0},add_$7h2:function(n){this.$47.addHandler("MapPointAccepted",n)},remove_$7h2:function(n){this.$47.removeHandler("MapPointAccepted",n)},add_$46d:function(n){this.$a("SelectedIndex",n)},remove_$46d:function(n){this.$w("SelectedIndex",n)},add_$3d3:function(n){this.$a("HoveredIndex",n)},remove_$3d3:function(n){this.$w("HoveredIndex",n)},add_$5I8:function(n){this.$a("MapCenter",n)},remove_$5I8:function(n){this.$w("MapCenter",n)},get_$427:function(){return 1},get_$2Ao:function(){return null},get_$P0:function(){return this.$CY},set_$P0:function(n){if(this.$CY!==n){(n>this.$sf.get_$F()-1||n<-1)&&(n=-1);this.$CY=n;$6(this,"SelectedIndex")}return n},get_$3d2:function(){return this.$1TD},set_$3d2:function(n){if(this.$1TD!==n){(n>this.$sf.get_$F()-1||n<-1)&&(n=-1);this.$1TD=n;$6(this,"HoveredIndex")}return n},get_$5I7:function(){return this.$1Hv},set_$5I7:function(n){if(!$8(n)&&!this.$1Hv.$Fy.$1Sw(n.$Fy)){this.$1Hv=n;$6(this,"MapCenter")}return n},get_$3lz:function(){return this.$1Hw},set_$3lz:function(n){if(!$8(n)&&!this.$1Hw.$Fy.$1Sw(n.$Fy)){this.$1Hw=n;$6(this,"MapViewCenter")}return n},get_$7go:function(){return this.$1Vi},set_$7go:function(n){if(!$8(n)&&!this.$1Vi.$Fy.$1Sw(n.$Fy)){this.$1Vi=n;$6(this,"MapCurrentLocation")}return n},get_$1Vj:function(){return this.$se},set_$1Vj:function(n){if(n!==this.$se){this.$se=n;$8(this.$q9)||this.$q9.set_$2Fy(this.$se);this.$2R3||$6(this,"MapDisplayType")}return n},get_$5IF:function(){return this.$1Vk},set_$5IF:function(n){if(n!==this.$1Vk){this.$1Vk=n;$6(this,"MapZoomLevel")}return n},get_$2qu:function(){return this.$2qt},set_$2qu:function(n){this.$2qt=n;$6(this,"MapBestViewSet");return n},get_$2Pq:function(){return this.$1M5},set_$2Pq:function(n){if(n!==this.$1M5){this.$1M5=n;$8(this.$q9)||this.$q9.set_$96T(this.$1M5?this.$1Vi:null);this.get_$2CR()&&$12z(this);this.$2R3||$6(this,"ShowCurrentLocationOnMap")}return n},get_$62e:function(){return this.$1MI},set_$62e:function(n){if(n!==this.$1MI){this.$1MI=n;$8(this.$q9)||this.$q9.set_$2QK(this.$1MI);this.get_$2CR()&&$12z(this);this.$2R3||$6(this,"ShowTrafficOnMap")}return n},get_$3Uc:function(){return this.$wb},set_$3Uc:function(n){this.$wb=n;$6(this,"DirectionsCommand");return n},get_$3Si:function(){return this.$14P},set_$3Si:function(n){this.$14P=n;$6(this,"CurrentLocationCommand");return n},get_$4EI:function(){return this.$1BI},set_$4EI:function(n){this.$1BI=n;$6(this,"TrafficCommand");return n},$1lB:function(){if($8(this.$q9)){_a.$6R.$3A(_u.Strings.l_GiveDirectionsError_Text,1);return}$6OK(this)},$5uL:function(){this.$2R3=!0;this.set_$2Pq(!1);this.set_$62e(!1);this.set_$1Vj(_a.$7L.$1Qv);this.$2R3=!1},$Fe:function(){_y.$1De.prototype.$Fe.call(this);this.get_$2CR()&&$12z(this)},$Rx:function(){_y.$1De.prototype.$Rx.call(this);$6OL(this)},$eC:function(){this.get_$3L().$BX()},$4d6:function(){if(this.$CY!==-1){var n=this.$47.getHandler("MapPointAccepted");$8(n)||n()}},$9AE:function(){$6OM(this,!this.$1M5)},$9AF:function(){this.set_$62e(!this.$1MI)},$92A:function(){this.set_$1Vj("a");$12z(this)},$92K:function(){this.set_$1Vj("auto");$12z(this)},$92M:function(){this.set_$1Vj("be");$12z(this)},$942:function(){this.set_$1Vj("r");$12z(this)}};_d.$aZ=function(n,t){this.$6n=t;this.$id=n};_d.$aZ.prototype={$id:null,$6n:null,$3RW:function(n,t){var i=new _js.$X;i.$H(n);return this.$I(i,t)},$I:function(n,t){return new _d.$5i(n,t,this.$id,this.$6n)}};_d.$Of=function(n,t,i,r,u){this.$$d_$7RR=Function.createDelegate(this,this.$7RR);this.$$d_$1lB=Function.createDelegate(this,this.$1lB);_d.$Of.initializeBase(this);_a.$3.$M(r,"locationManager");this.$2o=n;this.$4c=t;this.$id=r;this.$6n=u;this.$sf=new _js.$X;this.get_$Sv()&&this.$sf.$H(t);if(i!=="Mouse"){var f=this;this.$5lE=new _C(this.$$d_$7RR,_a.$0.$4h,this,"IsResolved",function(){return f.get_$Sv()})}};_d.$Of.prototype={$2o:null,$4c:null,$171:null,$5lE:null,$sf:null,$id:null,$6n:null,get_$1l:function(){return this.$4c.get_$1l()},get_$df:function(){return this.$4c.get_$df()},get_$1kR:function(){return this.$4c.get_$2g().get_$WA()},get_$Sv:function(){return this.$4c?this.$4c.$Sv():!1},get_$1pW:function(){this.$171||(this.$171=new _d.$5i(this.$sf,!0,this.$id,this.$6n));return this.$171},$1lB:function(){this.get_$1pW().$1lB()},$7RR:function(){this.$2o.$B9(this.get_$1pW())}};_d.$mC=function(n,t){this.$id=n;this.$6n=t};_d.$mC.prototype={$id:null,$6n:null,$I:function(n,t,i){return new _d.$Of(n,t,i,this.$id,this.$6n)}};_d.$DC=function(n,t,i,r,u){this.$$d_$8cD=Function.createDelegate(this,this.$8cD);this.$$d_$8cM=Function.createDelegate(this,this.$8cM);_d.$DC.initializeBase(this);this.$4c=n;this.$3zv=t;if(this.get_$3bs()){var e=_c.$i.$29Z(n);this.$2FT=_d.$DC.$3Ri(e,i,r);if(u&&this.$4c.get_$2g().get_$RR()==="Resource"){_js.Trace.logInfo(_a.$0.$6q,"Creating ReadCard for LocationViewModel.");var f=this.$2FT.$EW;f.get_$I5().add_$19q(this.$$d_$8cM);f.$2c2()}}};_d.$DC.$3Ri=function(n,t,i,r,u,f){if(!n.$3cB())throw Error.invalidOperation("Cannot create persona view model for a persona that does not have a valid location identifier");var e=t.$SX(n,4,!1,0);var o=i.get_$O()!=="Mouse";switch(r){case 0:e.set_$l9(!0);e.set_$2fW(!0);e.set_$DA(!1);e.set_$14y(!1);e.set_$Ih(!1);break;case 1:e.set_$l9(!0);e.set_$2fW(!0);e.set_$DA(!1);e.set_$14y(!o);e.set_$Ih(!o);break;case 2:default:e.set_$l9(!0);e.set_$2fW(!0);e.set_$DA(!0);e.set_$14y(!o);e.set_$Ih(!o);break}if(u&&u.length>0){for(var h=new Array(u.length),s=0;s<u.length;s++)h[s]=u[s].$46();_d.$DC.$8m4(e,h,f)}e.$Xp(0,_d.$DC.$2qK,null,2);return e};_d.$DC.$8m4=function(n,t,i){var r=[];Array.addRange(r,t);!$8(n.$hb)&&i&&Array.addRange(r,n.$hb);n.set_$1hZ(r)};_d.$DC.prototype={$3zv:null,$2FT:null,$4c:null,add_$8Zu:function(n){this.$2Z("OnLocationUpdated",n)},remove_$8Zu:function(n){this.$2b("OnLocationUpdated",n)},get_$3bs:function(){return!$8(this.$4c)&&this.$4c.$3bv()&&(this.$4c.$Sv()||this.$4c.get_$2g().get_$RR()==="Resource")},get_$7SZ:function(){return this.$4c===this.$3zv},$8cM:function(){var n=this.$2FT.$EW;if(n.get_$I5().$5u){n.get_$I5().$5u.add_$2Lv(this.$$d_$8cD);n.get_$I5().remove_$19q(this.$$d_$8cM)}},$8cD:function(){var t=this.$2FT.$EW.get_$I5().$5u;t.remove_$2Lv(this.$$d_$8cD);var n=t.$12;if(n.get_$2g()){this.$4c.get_$2g().set_$NM(n.get_$2g().get_$NM());this.$4c.get_$2g().set_$NS(n.get_$2g().get_$NS());this.$4c.get_$2g().set_$pz(n.get_$2g().get_$pz());$6b(this,"OnLocationUpdated")}}};_d.$8m=function(n,t,i,r,u,f,e){this.$$d_$1Jy=Function.createDelegate(this,this.$1Jy);this.$$d_$3z0=Function.createDelegate(this,this.$3z0);this.$$d_$5l5=Function.createDelegate(this,this.$5l5);this.$$d_$8ce=Function.createDelegate(this,this.$8ce);this.$$d_$8iC=Function.createDelegate(this,this.$8iC);this.$$d_$78w=Function.createDelegate(this,this.$78w);this.$$d_$7fZ=Function.createDelegate(this,this.$7fZ);_d.$8m.initializeBase(this);this.$2dR=new _C(this.$$d_$78w,_d.$8m.$D);this.$3kZ=new _C(this.$$d_$8iC,_d.$8m.$D);this.$3Ci=[new _0365m.$n(_u.Strings.l_RemoveLocation_LowerCase_Text,null,this.$2dR)];this.$2MA=i;this.$5os=t;this.$G=r;this.$2o=u;this.$50=f;this.$6n=e;this.$73w();$6OQ(this);$6OO(this,n)};function $6ON(n){n.$VT=n.$2MA.$I(9,n.$5os);n.$VT.add_$46e(n.$$d_$8ce);if(n.$G.get_$O()==="Mouse"&&!n.$G.get_$6Q()){var t=this;n.$VT.add_$2Wf(function(){n.$VT.$3Wu(n.$VT.$Xn,n.$VT.$1AI)})}$6(n,"PlacePickerViewModel")}function $6OQ(n){n.$DF.set_$1BC(n.$2dR);n.$DF.add_$2od(n.$$d_$5l5);n.$DF.add_$jv(n.$$d_$3z0);n.$DF.$a("QueryString",n.$$d_$1Jy);if(n.get_$2MB()){n.$DF.set_$2c9(n.$3kZ);n.$DF.set_$4dF(n.$3kZ)}else n.$DF.set_$2c9(null)}function $4NX(n,t){n.$DF.set_$D5(t);n.$1UC=!1}function $6OO(n,t){n.$4c=t?t.$46():_g.$3G.$qo();n.$4c.set_$1l(n.$4c.get_$1l()||"");$3F8(n,_c.$i.$29Z(n.$4c))}function $3F8(n,t){if(n.$4c.get_$2g().get_$RR()==="Resource"){var r=n.$4c.get_$1l();if(!_js.$8.$c(n.$4c.get_$df())){var i=new(_a.$3Y.$$(String));i.$H(n.$4c.get_$1l());i.$H(n.$4c.get_$df());r=_d.$10.$3a5(i)}$4NZ(n,r)}else n.$4c.$3bv()?$6OP(n,t):$4NZ(n,n.$4c.get_$4tQ())}function $4NZ(n,t){$4NX(n,t);n.set_$2M1(null);n.$DF.set_$OY(n.get_$2MB())}function $6OP(n,t){n.$DF.set_$L8(_u.Strings.l_LocationWellAnnotationWatermark_Text);n.$DF.set_$OY(!1);$4NX(n,n.$4c.get_$df()||"");n.$1UC=!1;n.set_$2M1(_d.$DC.$3Ri(t,n.$50,n.$G,1,n.$3Ci,!0))}function $4NY(n){n.$DF.set_$OY(n.get_$2MB());n.set_$4h(_g.$3G.$wE(n.$DF.$2k))}_d.$8m.prototype={$6n:null,$7S:null,$4c:null,$DF:null,$2dR:null,$3kZ:null,$3Ci:null,$5os:null,$VT:null,$2MA:null,$50:null,$2o:null,$G:null,$1UC:!1,get_$1Zc:function(){this.$VT||$6ON(this);return this.$VT},get_$2M1:function(){return this.$7S},set_$2M1:function(n){if(this.$7S!==n){this.$7S=n;$6(this,"PersonaViewModel")}return n},get_$4h:function(){return this.$4c},set_$4h:function(n){if(this.$4c!==n&&!this.$4c.$4W(n)){this.$4c=n;$6(this,"Location")}return n},get_$5BH:function(){return this.$1UC},set_$5BH:function(n){if(this.$1UC!==n){this.$1UC=n;$6(this,"IsLocationDirty")}return n},get_$2MB:function(){return _g.$S.get_$L().get_$QG().PlacesEnabled},get_$3L:function(){return this.$2o},set_$3L:function(n){this.$2o=n;return n},$8iC:function(){if(!this.get_$2MB())throw Error.invalidOperation("Places must be enabled to use the place picker");if($8(this.$7S)&&!_js.$8.$14(this.$DF.$2k)){this.$DF.set_$a9(!1);this.$DF.set_$HE(!1);this.get_$1Zc().$3Wu(this.$DF.$2k);this.$2o.$B9(this.get_$1Zc())}},$4dr:function(n){this.set_$4h(n.$3Ad());$3F8(this,n)},$4FJ:function(){if(this.$1UC){if($8(this.$7S)){if(!$8(this.$4c)&&this.$4c.get_$2g().get_$RR()==="Resource"&&this.$4c.get_$1l()===this.$DF.$2k)return;$4NY(this)}else if(!$8(this.$4c)&&!this.$DF.$bo){this.$4c.set_$df(this.$DF.$2k);$6(this,"Location")}this.set_$5BH(!1)}},$7fZ:function(n,t){var i=n.get_$4h();if(!this.$4c.$4W(i)){var r=i||_g.$3G.$qo();this.$4c=r.$46();$3F8(this,_c.$i.$29Z(this.$4c));this.$DF.set_$2B9(!1);$6(this,"Location")}},$6r3:function(n){!$8(n)&&n.$3bv()&&n.get_$2g().get_$RR()!=="Resource"&&this.$DF.$67k(_c.$i.$29Z(n))},$73w:function(){this.$DF=new _d.$Yk(_c.$JD.$4oT,_c.$JD.$7Mp(),this.$6n,this.$50);this.$DF.set_$1aY("PlaceDetailedView");if(this.get_$2MB()){this.$DF.$vd();this.$DF.set_$OY(!0)}else this.$DF.set_$OY(!1);this.$DF.set_$15(!1);this.$DF.set_$oy(!1);this.$DF.set_$1Xb(0);this.$DF.set_$12U(100)},$1Jy:function(n,t){this.set_$5BH(!0)},$78w:function(){this.$DF.set_$L8("");this.set_$2M1(null);$4NY(this);this.$DF.set_$2B9(!1)},$5l5:function(n,t){this.$DF.$iV||this.$4FJ()},$3z0:function(n,t){$8(this.$DF.get_$Vm())||this.$4dr(this.$DF.get_$Vm().get_$1v())},$8ce:function(n){$8(n)||this.$4dr(n)}};_d.$mD=function(n,t,i){this.$2MA=n;this.$G=t;this.$6n=i};_d.$mD.prototype={$2MA:null,$50:null,$G:null,$6n:null,$I:function(n,t,i){return new _d.$8m(n.$r.get_$4h(),t,this.$2MA,this.$G,i,this.$50,this.$6n)}};_d.$87=function(n,t){_d.$87.initializeBase(this,[n]);if(t){this.set_$1xO(t.$Xn);this.set_$5wo(t.$1AI.$Fy.$NM);this.set_$5wp(t.$1AI.$Fy.$NS);this.set_$QV(t.$BD);t.$1Li&&this.set_$1b2(t.$1Li.get_$1v().$3Ad())}};_d.$87.prototype={get_$1xO:function(){return this.$W(_d.$87.$46P)},set_$1xO:function(n){this.$N(_d.$87.$46P,n);return n},get_$5wo:function(){return this.$W(_d.$87.$46K)},set_$5wo:function(n){this.$N(_d.$87.$46K,n);return n},get_$5wp:function(){return this.$W(_d.$87.$46L)},set_$5wp:function(n){this.$N(_d.$87.$46L,n);return n},get_$QV:function(){return this.$W(_d.$87.$46h)},set_$QV:function(n){this.$N(_d.$87.$46h,n);return n},get_$1b2:function(){return this.$W(_d.$87.$46f)},set_$1b2:function(n){this.$N(_d.$87.$46f,n);return n},$4nm:function(n){n.set_$1xO(this.get_$1xO());var t=_a.$9N.$7Gx(this.get_$5wo(),this.get_$5wp());n.$1AI=t;n.set_$QV(this.get_$QV());this.get_$1b2()&&n.set_$1b2(n.$4pH(_c.$i.$29Z(this.get_$1b2())))}};_d.$VN=function(n,t){this.$$d_$8cI=Function.createDelegate(this,this.$8cI);this.$$d_$8cH=Function.createDelegate(this,this.$8cH);this.$$d_$8wG=Function.createDelegate(this,this.$8wG);this.$$d_$8wK=Function.createDelegate(this,this.$8wK);this.$3CS=_y.$q.$Hr;_d.$VN.initializeBase(this);this.$w7=n;this.$G=t||_y.$j.$g;this.$Sw=this.$G.get_$O()!=="Mouse";this.$5xv=new _C(this.$$d_$8wK,_a.$0.$4h);this.$5xo=new _C(this.$$d_$8wG,_a.$0.$4h);this.set_$wK("");this.set_$2FQ("");this.set_$bO(_u.Strings.l_ErrorRetrievingData_Text)};function $4P5(n,t){if(t&&n.$416){var i=t.$EW.get_$D4();i.$2Mw=n.get_$7fX();if(!i.$5u){var r=null;var u=this;r=function(){if(i.$5u){i.$5u.$5k.set_$AG(0);i.remove_$19q(r)}};i.add_$19q(r);i.$1Aj(t.get_$1v())}}}_d.$VN.prototype={$Sw:!1,$w7:null,$G:null,$1hY:!1,$416:!1,$5xv:null,$5xo:null,get_$7FU:function(){var n=this.get_$3T().get_$F()>0?this.get_$3T().get_$48(0):null;$4P5(this,n);return n},get_$7fX:function(){switch(this.$G.get_$O()){case"Mouse":case"TouchWide":return 0;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value for OwaShell.CurrentLayout: "+this.$G.get_$O());}},$9EZ:function(){var n=this.get_$9KG();if(n&&!_js.$8.$14(n.$2k)){var t=_u.Strings.l_NoSearchResultsString_Text;switch(n.$19k){case 1:t=_u.Strings.l_NoSearchResultsFromBingString_Text;break;case 2:t=_u.Strings.l_NoSearchResultsFromPeopleString_Text;break;case 3:t=_u.Strings.l_NoSearchResultsFromHistoryString_Text;break}this.set_$1uB(String.format(t,n.$2k))}},$4pT:function(n){var t=new _d.$7l(n,this.$3CS,!1,null,this.$Sw?2:1,this.$w7,this.$G);t.$Xp(1,_d.$DC.$2qK,"");t.set_$8kx((this.get_$9KF().$7h(n)+1).toString());t.set_$14y(!1);t.set_$Ih(!1);t.set_$l9(this.$1hY);t.set_$368(this.$1hY);if(!this.$Sw){t.set_$Ih(!0);t.$EW.set_$4t1(!0);var i=this;t.set_$1TC(new _C(function(){},_a.$0.$4h));t.$a("IsHovered",this.$$d_$8cH)}t.$a("IsSelected",this.$$d_$8cI);t.get_$4mQ().set_$TT(_d.$Gu.get_$8l5());return t},$8wK:function(){var n=this.$9KI();n<=0||n>=this.get_$3T().get_$F()||this.set_$25(this.get_$3T().get_$48(n-1))},$8wG:function(){var n=this.$9KI();!this.get_$3T().get_$F()||n>=this.get_$3T().get_$F()-1||(n===-1?this.set_$25(this.get_$3T().get_$48(0)):this.set_$25(this.get_$3T().get_$48(n+1)))},$8cH:function(n,t){var i=n;i.$1nP?this.set_$2kH(this.get_$9KF().$7h(i.get_$1v())):this.set_$2kH(-1)},$8cI:function(n,t){var i=n;i.$3G&&$4P5(this,i)}};_d.$hR=function(n,t,i,r,u){this.$$d_$8cb=Function.createDelegate(this,this.$8cb);this.$$d_$8aC=Function.createDelegate(this,this.$8aC);this.$$d_$8aF=Function.createDelegate(this,this.$8aF);this.$$d_$8cc=Function.createDelegate(this,this.$8cc);this.$$d_$8aE=Function.createDelegate(this,this.$8aE);this.$$d_$8aA=Function.createDelegate(this,this.$8aA);this.$47=new Sys.EventHandlerList;_d.$hR.initializeBase(this,[n,i,r]);this.$Ac.$3CS=24;this.$Ac.$416=!1;this.$Oc=new _d.$tv(this.$Ac.get_$3T(),!1,t,u);this.$Oc.add_$5I8(this.$$d_$8aA);this.$Oc.add_$46d(this.$$d_$8aE);this.$Ac.add_$5xO(this.$$d_$8cc);if(_y.$j.$g.get_$O()!=="Mouse")this.$5jJ=new _C(this.$$d_$8aF,_a.$0.$4h);else{this.$Oc.add_$3d3(this.$$d_$8aC);this.$Ac.add_$9KD(this.$$d_$8cb)}};_d.$hR.prototype={$5jJ:null,$Oc:null,add_$5I8:function(n){this.$47.addHandler("MapCenterChanged",n)},remove_$5I8:function(n){this.$47.removeHandler("MapCenterChanged",n)},get_$3L:function(){return _d.$14v.prototype.get_$3L.call(this)},set_$3L:function(n){_d.$14v.prototype.set_$3L.call(this,n);$8(this.$Oc)||this.$Oc.set_$3L(n);return n},$8sd:function(){this.$Oc.set_$2qu(!1)},$5uI:function(){_d.$14v.prototype.$5uI.call(this);this.$Oc.$5uL()},$8aF:function(){this.get_$3L().$B9(this.$Oc)},$8aE:function(n,t){this.$Ac.remove_$5xO(this.$$d_$8cc);this.$Oc.$CY>-1&&this.$Oc.$CY<this.$Ac.get_$3T().get_$F()&&this.$Ac.set_$25(this.$Ac.get_$3T().get_$48(this.$Oc.$CY));this.$Ac.add_$5xO(this.$$d_$8cc)},$8cc:function(n,t){this.$Oc.remove_$46d(this.$$d_$8aE);this.$Oc.set_$P0(this.$Ac.$9KI());this.$Oc.add_$46d(this.$$d_$8aE)},$8aC:function(n,t){this.$Ac.remove_$9KD(this.$$d_$8cb);this.$Ac.get_$2kH()>-1&&this.$Ac.get_$2kH()<this.$Ac.get_$3T().get_$F()&&this.$Ac.get_$3T().get_$48(this.$Ac.get_$2kH()).set_$G8(!1);this.$Ac.set_$2kH(this.$Oc.$1TD);this.$Ac.get_$2kH()>-1&&this.$Ac.get_$2kH()<this.$Ac.get_$3T().get_$F()&&this.$Ac.get_$3T().get_$48(this.$Ac.get_$2kH()).set_$G8(!0);this.$Ac.add_$9KD(this.$$d_$8cb)},$8cb:function(n,t){this.$Oc.remove_$3d3(this.$$d_$8aC);this.$Oc.set_$3d2(this.$Ac.get_$2kH());this.$Oc.add_$3d3(this.$$d_$8aC)},$8aA:function(n,t){if(!this.$3hJ){var i=n;var r=this.$47.getHandler("MapCenterChanged");$8(r)||r(i.$1Hv);this.$2SE(this.$Xn,i.$1Hv)}}};_d.$tv=function(n,t,i,r){_d.$tv.initializeBase(this,[n,t,i,r])};_d.$tv.prototype={get_$Jr:function(){return 1}};_d.$VO=function(n,t,i){_d.$VO.initializeBase(this,[n,t,i]);_y.$j.$g.get_$O()==="TouchNarrow"?this.$Ac.$1hY=!0:this.$Ac.$416=!0};_d.$14v=function(n,t,i){this.$$d_$8cd=Function.createDelegate(this,this.$8cd);this.$$d_$5kf=Function.createDelegate(this,this.$5kf);this.$47_4=new Sys.EventHandlerList;_d.$14v.initializeBase(this);if(!n)throw Error.argumentNull("provider");this.$48e=!i||i.get_$O()!=="Mouse";this.$Ac=new _d.$VN(t,i);this.$Ac.$3CS=_y.$q.$1VE;this.$Ac.add_$5xO(this.$$d_$5kf);this.$Ac.add_$9KB(this.$$d_$8cd);this.$1er=n;this.$Ac.$9KH(n)};_d.$14v.prototype={$2o:null,$Xn:null,$Ac:null,$1er:null,$3hJ:!1,$1na:!0,$48e:!1,add_$46j:function(n){this.$47_4.addHandler("SelectedPlaceChanged",n)},remove_$46j:function(n){this.$47_4.removeHandler("SelectedPlaceChanged",n)},add_$41z:function(n){this.$47_4.addHandler("PopulatedItemCountChanged",n)},remove_$41z:function(n){this.$47_4.removeHandler("PopulatedItemCountChanged",n)},get_$7be:function(){return!!this.$Ac.get_$3T().get_$F()},get_$7aK:function(){return this.$1na},set_$7aK:function(n){if(this.$1na!==n){this.$1na=n;$6(this,"IsLoadingFirstTime")}return n},get_$3L:function(){return this.$2o},set_$3L:function(n){this.$2o=n;return n},get_$1xO:function(){return this.$Xn},set_$1xO:function(n){this.$Xn=n;$6(this,"SearchTerm");return n},get_$5BD:function(){return this.$3hJ},set_$5BD:function(n){this.$3hJ=n;$6(this,"IsLoadingSuggestionsFromWS");return n},$8sd:function(){},$5uI:function(){this.$1na=!0},$2SE:function(n,t){this.set_$1xO(n);this.$1er.set_$D5(n);$8(t)||this.$1er.set_$8oI(t);this.$Ac.$9EZ();if(!_js.$8.$14(n)||_js.$8.$14(n)&&this.$1er.$2Mp===1){this.set_$5BD(!0);this.$Ac.get_$52()?this.$Ac.$gI():this.$Ac.$5F()}else this.$Ac.$Ar();$6(this,"IsPopulated")},$5kf:function(n,t){if(this.$Ac.get_$25()){var i=this.$47_4.getHandler("SelectedPlaceChanged");$8(i)||i(this.$Ac.get_$25())}},$8cd:function(){this.set_$5BD(!1);this.set_$7aK(!1);$6(this,"IsPopulated");var n=this.$47_4.getHandler("PopulatedItemCountChanged");$8(n)||n(this.$Ac.get_$3T().get_$F())}};_d.$5w=function(n,t,i,r,u,f,e){this.$$d_$8Sa=Function.createDelegate(this,this.$8Sa);this.$$d_$8SZ=Function.createDelegate(this,this.$8SZ);this.$$d_$8dV=Function.createDelegate(this,this.$8dV);this.$$d_$8c0=Function.createDelegate(this,this.$8c0);this.$$d_$5kf=Function.createDelegate(this,this.$5kf);this.$$d_$7RZ=Function.createDelegate(this,this.$7RZ);this.$$d_$7Qb=Function.createDelegate(this,this.$7Qb);this.$$d_$44m=Function.createDelegate(this,this.$44m);this.$$d_$eC=Function.createDelegate(this,this.$eC);this.$$d_$4d6=Function.createDelegate(this,this.$4d6);this.$$d_$9FA=Function.createDelegate(this,this.$9FA);this.$$d_$3l9=Function.createDelegate(this,this.$3l9);this.$2Lk=-1;this.$2N3=-1;this.$24R=-1;this.$Xn="";this.$1LY="";this.$1AI=new _a.$9N;this.$47=new Sys.EventHandlerList;_d.$5w.initializeBase(this);this.$5ol=n;this.$id=i;this.$w7=r;this.$50=u;this.$G=f;this.$6n=e;this.$2Pf=this.$G.get_$O()!=="TouchNarrow";this.$1bc=this.$G.get_$O()==="Mouse";var s=this;this.$1k3=new _C(this.$$d_$3l9,_a.$0.$4h,this,"SearchDisplayText",function(){return!_js.$8.$14(s.$1LY)});this.$69b=new _C(this.$$d_$9FA,_a.$0.$4h);var h=this;this.$2WQ=new _C(this.$$d_$4d6,_a.$0.$4h,this,"SelectedLocation",function(){return!$8(h.$1Li)});this.$2e8=new _C(this.$$d_$eC,_a.$0.$4h);this.$44H=new _C(this.$$d_$44m,_a.$0.$4h);this.$3Ci=[new _0365m.$n(_u.Strings.l_RemoveLocation_LowerCase_Text,null,this.$44H)];var o=[];$130(this,1)&&Array.add(o,new _a.$5D(_u.Strings.l_BingPivotLabel_Text,$6Qy(this)));$130(this,4)&&Array.add(o,new _a.$5D(_u.Strings.l_PeoplePivotLabel_Text,$6Qz(this)));$130(this,8)&&Array.add(o,new _a.$5D(_u.Strings.l_RecentPivotLabel_Text,$6R0(this)));this.set_$QB(o);this.set_$7cS(this.$GJ.length<=1);this.$GJ.length||this.set_$QV(-1);var c=!!t&&f.get_$O()==="Mouse"&&f.get_$6Q();var y=this;this.$Xd=new _d.$NU(t||function(){},c);if(!this.$1bc){var l=new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItemMobile_Text,this.$2WQ);var a=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItemMobile_Text,this.$2e8);var v=[l,a];this.set_$7E(_y.$26.$Bv(this,v,null))}};function $3Fi(n){n.set_$7v(!0);$6R2(n);_js.$8.$14(n.$Xn)&&$130(n,8)&&n.set_$QV(n.$GJ.length-1);var t=this;$1eA(n,function(t){t.$2SE(n.$Xn,n.$1AI)})}function $6R2(n){n.$24R=_js.$8.$14(n.$Xn)||!($130(n,1)||$130(n,2))?0:-1;n.$2Lk=_js.$8.$14(n.$Xn)||!$130(n,4)?0:-1;n.$2N3=$130(n,8)?-1:0;$6(n,"TotalResults");n.$44m(n.get_$3CF())}function $6R1(n){var t=this;$1eA(n,function(t){t.$Ac.get_$25()&&t.$Ac.get_$25()!==n.$1b5&&t.$Ac.set_$25(null)})}function $4P6(n){n.$BD=0;n.set_$46i(null);n.set_$1b2(null);var t=this;$1eA(n,function(n){n.$5uI()});$8(n.get_$8K())?n.get_$3L().$1KY(_d.$5w.isInstanceOfType(n.get_$3L().get_$7L())?1:2):n.get_$8K()()}function $1eA(n,t){for(var r=n.$GJ,u=r.length,i=0;i<u;++i){var f=r[i];var e=f.$x;t(e)}}function $130(n,t){return(n.$5ol&t)===t}function $6Qz(n){var t=new _d.$Qg;t.$Oq=_c.$14.$qp(0,12);t.$1CX=_c.$14.$1l5();t.$31y=new _g.$P8("Default");t.$31y.AdditionalProperties=[new _g.$1i("PersonaOfficeLocations"),new _g.$1i("PersonaBusinessAddresses"),new _g.$1i("PersonaHomeAddresses"),new _g.$1i("PersonaOtherAddresses")];var i=new _d.$VO(t,n.$w7,n.$G);i.add_$46j(n.$$d_$5kf);i.add_$41z(n.$$d_$8c0);return i}function $6R0(n){var t=new _d.$VO(new _d.$r7(1),n.$w7,n.$G);t.add_$46j(n.$$d_$5kf);t.add_$41z(n.$$d_$8dV);return t}function $6Qy(n){var i;i=$130(n,2)?2:6;var t=new _d.$hR(new _d.$r7(i),n.$id,n.$w7,n.$G,n.$6n);t.add_$46j(n.$$d_$5kf);t.add_$41z(n.$$d_$8SZ);t.add_$5I8(n.$$d_$8Sa);n.get_$3CF()||t.$Oc.add_$7h2(n.$$d_$4d6);return t}_d.$5w.prototype={$2WQ:null,$2e8:null,$44H:null,$1k3:null,$69b:null,$3Ci:null,$Xd:null,$5ol:0,$GJ:null,$BD:0,$2E9:!1,$1b5:null,$1Li:null,$9u:!1,$id:null,$w7:null,$50:null,$G:null,$R7:null,$6n:null,$2Pf:!1,$1bc:!1,add_$46e:function(n){this.$47.addHandler("SelectedLocationChanged",n)},remove_$46e:function(n){this.$47.removeHandler("SelectedLocationChanged",n)},add_$2Wf:function(n){this.$47.addHandler("Activated",n)},remove_$2Wf:function(n){this.$47.removeHandler("Activated",n)},add_$3PY:function(n){this.$47.addHandler("Closed",n)},remove_$3PY:function(n){this.$47.removeHandler("Closed",n)},get_$46i:function(){return this.$1b5},set_$46i:function(n){this.$1b5&&this.$1b5.set_$2X(!1);this.$1b5=n;$6R1(this);this.$1b5&&this.$1b5.set_$2X(!0);$6(this,"SelectedPlace");return n},get_$1b2:function(){return this.$1Li},set_$1b2:function(n){this.$1Li=n;$6(this,"SelectedLocation");return n},get_$QB:function(){return this.$GJ},set_$QB:function(n){this.$GJ=n;$6(this,"Options");return n},get_$QV:function(){return this.$BD},set_$QV:function(n){this.$BD=n;this.get_$3CF()||this.$44m();this.set_$2OM(this.$Xn);$6(this,"SelectedOptionIndex");return n},get_$7cS:function(){return this.$2E9},set_$7cS:function(n){if(this.$2E9!==n){this.$2E9=n;$6(this,"IsSingleOption")}return n},get_$3L:function(){return _y.$1De.prototype.get_$3L.call(this)},set_$3L:function(n){_y.$1De.prototype.set_$3L.call(this,n);var t=this;$1eA(this,function(t){t.set_$3L(n)});return n},get_$427:function(){return 1},get_$2Ao:function(){return null},get_$8K:function(){return this.$R7},set_$8K:function(n){this.$R7=n;return n},get_$7A8:function(){return!1},get_$Jr:function(){return this.$1bc?0:1},get_$94O:function(){return this.$1bc},set_$94O:function(n){if(this.$1bc===n)return n;this.$1bc=n;$6(this,"ShowToolbar");return n},get_$93r:function(){return this.$2Pf},set_$93r:function(n){if(this.$2Pf===n)return n;this.$2Pf=n;$6(this,"ShowPreviewPanel");return n},get_$3CF:function(){return!this.$2E9&&this.$G.get_$O()!=="TouchNarrow"},get_$aI:function(){return this.$Xd.get_$aI()},get_$19W:function(){return this.$Xd.get_$19W()},get_$2OM:function(){return this.$1LY},set_$2OM:function(n){if(this.$1LY!==n){this.$1LY=n;$6(this,"SearchDisplayText")}return n},get_$1xO:function(){return this.$Xn},set_$1xO:function(n){if(this.$Xn!==n){var t=this;$1eA(this,function(n){n.$8sd()})}this.$Xn=n;this.set_$2OM(this.$Xn);return n},get_$9Af:function(){if(this.$24R>=0&&this.$2Lk>=0&&this.$2N3>=0){this.set_$7v(!1);var n=this.$24R+this.$2Lk+this.$2N3;var t=n===1?_u.Strings.l_TotalResults_OnlyOne_Uppercase_Text:_u.Strings.l_TotalResults_ZeroOrMoreThanOne_Uppercase_Text;return String.format(t,n)}return _u.Strings.l_Searching_Text},get_$7v:function(){return this.$9u},set_$7v:function(n){if(this.$9u!==n){this.$9u=n;$6(this,"IsBusy")}return n},$8zl:function(n){var t=this;$1eA(this,function(t){t.$48e=n})},$Fe:function(){_y.$1De.prototype.$Fe.call(this);var n=this.$47.getHandler("Activated");$8(n)||n()},$4d6:function(){if(this.$1Li){var n=this.$47.getHandler("SelectedLocationChanged");$8(n)||n(this.$1Li.get_$1v());$4P6(this)}},$eC:function(){$4P6(this)},$4pH:function(n){return _d.$DC.$3Ri(n,this.$50,this.$G,0,this.$3Ci,!1)},$3Wu:function(n,t){this.set_$7v(!0);if(!_js.$8.$14(n)&&$8(t))if(_y.$j.$g.get_$O()==="Mouse")this.$3l9(n);else{this.set_$1xO(n);this.$id.$4zl(this.$$d_$7Qb,this.$$d_$7RZ)}else this.$3l9(n,t)},$3l9:function(n,t){this.set_$1xO(n||this.$1LY);t&&(this.$1AI=t);$3Fi(this)},$9FA:function(){_js.$8.$14(this.$1LY)&&this.set_$2OM(this.$Xn)},$44m:function(n){this.set_$46i(null);n||this.set_$1b2(null)},$Rx:function(){var n=this.$47.getHandler("Closed");$8(n)||n()},$5kf:function(n){this.set_$46i(n);this.set_$1b2(this.$4pH(n.get_$1v()))},$8SZ:function(n){this.$24R=n;$6(this,"TotalResults")},$8c0:function(n){this.$2Lk=n;$6(this,"TotalResults")},$8dV:function(n){this.$2N3=n;$6(this,"TotalResults")},$7Qb:function(n){this.$1AI=n;$3Fi(this)},$7RZ:function(n){$3Fi(this)},$8Sa:function(n){this.$1AI=n;this.set_$2OM(this.$Xn);this.set_$7v(!0)}};_d.$bm=function(n,t,i){this.$id=n;this.$G=t;this.$6n=i};_d.$bm.prototype={$id:null,$w7:null,$50:null,$G:null,$6n:null,$I:function(n,t){return new _d.$5w(n,t,this.$id,this.$w7,this.$50,this.$G,this.$6n)}};_d.$1Ce=function(){this.$2k="";this.$1wC=new _a.$9N;this.$2Mp=0;this.$19k=0};_d.$1Ce.prototype={get_$D5:function(){return this.$2k},set_$D5:function(n){this.$2k=n||"";return n},get_$8oI:function(){return this.$1wC},set_$8oI:function(n){this.$1wC=n||new _a.$9N;return n}};_d.$9X=function(){_d.$9X.initializeBase(this)};_d.$9X.prototype={get_$10:function(){return this.$W(_d.$9X.$393)},set_$10:function(n){this.$N(_d.$9X.$393,n);return n},get_$23:function(){return this.$W(_d.$9X.$2fO)},set_$23:function(n){this.$N(_d.$9X.$2fO,n);return n},get_$Jh:function(){return this.$W(_d.$9X.$33l)},set_$Jh:function(n){this.$N(_d.$9X.$33l,n);return n},get_$ZC:function(){return this.$W(_d.$9X.$3iL)},set_$ZC:function(n){this.$N(_d.$9X.$3iL,n);return n}};_d.$mI=function(n,t){this.$4to=n;this.$5Hc=t};_d.$mI.prototype={$4to:null,$5Hc:null};_d.$lq=function(n,t){this.$x=n;this.$5tV=t};_d.$lq.prototype={$x:null,$5tV:!1};_d.$nV=function(n){this.$x=n};_d.$nV.prototype={$x:null};_d.$BO=function(n,t,i,r,u){this.$$d_$57e=Function.createDelegate(this,this.$57e);this.$$d_$45r=Function.createDelegate(this,this.$45r);this.$$d_$8uk=Function.createDelegate(this,this.$8uk);this.$$d_$8Vo=Function.createDelegate(this,this.$8Vo);this.$$d_$18u=Function.createDelegate(this,this.$18u);this.$$d_$10H=Function.createDelegate(this,this.$10H);this.$$d_$1fl=Function.createDelegate(this,this.$1fl);_d.$BO.initializeBase(this,[5,n]);this.$87=i;this.$15H=u;this.$DD=t;this.$dh=new _C(this.$$d_$1fl,this.get_$1Y());this.$1K=r};function $6OR(n){if(!n.get_$JX()){var t=[];var i=new _0365m.$n(_u.Strings.l_AttachmentSubmenuItem_LowerCase_Text,null,n.$dh,!1,null,_u.Strings.l_InsertAttachment_AT_MenuItem_Text);Array.add(t,i);if(n.$1K.get_$A0()){n.$1GI=new _C(n.$$d_$57e,n.get_$1Y());n.$329=new _0365m.$n(_u.Strings.l_PictureSubmenuItem_LowerCase_Text,null,n.$1GI,!1,null,_u.Strings.l_InsertPicture_AT_MenuItem_Text);Array.add(t,n.$329);n.$49X(n.$16.$f.$j.get_$45()==="HTML")}n.set_$JX(new _0365m.$2c(t))}}function $4Nd(n,t){t.get_$85()||t.set_$85(new _js.$X)}function $4Ne(n){var i=n.$16.$f;var t=i.$j;if($8(t)||!t.get_$EC()){_js.Trace.logInfo(_a.$0.$d,"Show not allowed to add attachment due to context="+(t?"non-null":"null")+"; Upgraded="+t.get_$EC());i.$1r.$3A(0,_u.Strings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0}function $6OS(n,t){if(n.$15H){var i=this;n.$15H.$I(function(i){i&&i.$d1(n.get_$5o(),t)})}}_d.$BO.prototype={$87:null,$1K:null,$15H:null,$DD:null,$dh:null,$1GI:null,$329:null,$1hi:null,get_$JX:function(){return this.$W(_d.$BO.$17G)},set_$JX:function(n){this.$N(_d.$BO.$17G,n);return n},add_$3xO:function(n){this.$2Z("AttachmentWellInitialized",n)},remove_$3xO:function(n){this.$2b("AttachmentWellInitialized",n)},get_$5o:function(){return this.$W(_d.$BO.$3MO)},set_$5o:function(n){this.$N(_d.$BO.$3MO,n);return n},get_$Ik:function(){return this.get_$5o()?this.get_$5o().get_$Ik():!1},get_$FL:function(){return this.get_$5o()&&this.get_$5o().get_$1e()?this.get_$5o().get_$1e().get_$F()>0:!1},get_$4nk:function(){return this.$1hi},set_$4nk:function(n){this.$1hi=n;$Q(this,"CopyPasteViewModel");return n},$3v:function(){var n=this.$16.$f.$j;$6OR(this);var i=!n.get_$EC()||n.get_$2BF();var r=n.get_$85();var u=!((n.get_$4D()===4||n.get_$4D()===13)&&!this.$1K.get_$A0());if(this.get_$5o()){this.get_$5o().$2NN(n.get_$9J(),r,i,n.get_$6u(),n.get_$1Ou());this.$4lt(n,i)}else{var t=this;this.$DD.$I(function(f){_y.$j.$g.get_$O()==="TouchNarrow"?t.set_$5o(f.$1hr(n.get_$9J(),r,i,u,n.get_$1Ou(),!0,t.$16.$f.$z,n.get_$6u())):t.set_$5o(f.$1hq(n.get_$9J(),r,i,_y.$j.$g.get_$O()==="Mouse"?3:0,u,n.get_$1Ou(),!0,t.$16.$f.$z,n.get_$6u()));t.get_$5o().add_$10H(t.$$d_$10H);t.get_$5o().add_$18u(t.$$d_$18u);t.get_$5o().apcl("EditorCallContext",t.$$d_$8Vo);var e=t.$16.$3S(14);e&&t.get_$5o().add_$4GB(e.$$d_$Xj);$dY(t,"AttachmentWellInitialized",t);t.$4lt(n,i)})}},$8Vo:function(n,t){if(t==="EditorCallContext"){var i=this.$16.$3S(27);i.set_$Se(this.get_$5o().get_$Se())}},$49X:function(n){this.$329&&this.$329.set_$15(!n)},$18u:function(n){if(_a.$5a.$2x){var t=this;_js.$K.get_$L().$3i(_a.$0.$HT,"TriggerPolicyTipsIfNeeded",function(){var n=t.$16.$3S(25);n.$1BL(8)})}},$10H:function(){var t=this.$16.$f;var n=t.$j;if(n.get_$9J()){$4Nd(this,n);this.get_$5o()&&this.get_$5o().$1aB(n.get_$9J(),n.get_$85(),n.get_$1Ou())}else{var i=this.$16.$3S(8);i.$1mY("Attach",this.$$d_$8uk,this.$$d_$45r,!1)}},$9Fh:function(){var n=this.$16.$f.$j;if(this.get_$5o()){this.get_$5o().$1aB(n.get_$9J(),n.get_$85(),n.get_$1Ou());if(n.$Sl)if(n.get_$85()){var t=new _js.$X;t.$6G(n.get_$85().$7V());n.$Sl.set_$85(t);n.get_$H3()&&n.get_$H3().set_$85(t)}else{n.$Sl.set_$85(null);n.get_$H3()&&n.get_$H3().set_$85(null)}}},$Ar:function(){var n=this.get_$5o();if(n){n.remove_$10H(this.$$d_$10H);n.remove_$18u(this.$$d_$18u);n.rpcl("EditorCallContext",this.$$d_$8Vo);_d.$4I.$D6(this.$16)}_d.$9c.prototype.$Ar.call(this)},$7I1:function(){var n=null;if(_a.UserAgent.getInstance().get_$3M8()&&!_a.UserAgent.getInstance().get_$5h()){n=[];Array.add(n,new _y.$2j(_u.Strings.l_AttachmentSubmenuItem_LowerCase_Text,this.$dh));this.$1K.get_$A0()&&this.$16.$f.$j.get_$45()==="HTML"&&Array.add(n,new _y.$2j(_u.Strings.l_PictureSubmenuItem_LowerCase_Text,this.$1GI))}return n},$1fl:function(){var n=this.$16.$f;var t=n.$j;_js.Trace.logInfo(_a.$0.$d,"Insert attachment start");if($4Ne(this)&&this.get_$5o())if(t.get_$1HF()){_js.Trace.logInfo(_a.$0.$d,"Opening S/MIME's file picker");this.get_$5o().$5ls(!1)}else if(this.$87&&this.$87.$7x("AttachmentsFilePicker")&&_y.$j.$g.get_$O()!=="TouchNarrow"){var i=_a.$5.$1V(_a.$0.$1e,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$d,"Opening OWA's file picker");$6OS(this,i)}else{_js.Trace.logInfo(_a.$0.$d,"Opening OS's file picker");this.get_$5o().$194(!1,null,null)}_js.Trace.logInfo(_a.$0.$d,"Insert attachment end")},$57e:function(){var n=this.$16.$f;var t=n.$j;_js.Trace.logInfo(_a.$0.$d,"Insert picture start");if($4Ne(this)&&this.get_$5o())if(t.get_$1HF()){_js.Trace.logInfo(_a.$0.$d,"Opening S/MIME's file picker");this.get_$5o().$5ls(!0)}else this.get_$5o().$194(!0,null,null);_js.Trace.logInfo(_a.$0.$d,"Insert picture end")},$4lt:function(n,t){this.get_$5o().set_$3fm(!n.get_$EC());_js.Trace.logInfo(_a.$0.$d,"Attachment component initialized, ReadOnly={0}",t);this.set_$4nk(_d.$XL.$4oh(_y.$j.$g,this.$DD,this.get_$5o(),this.get_$1Y()));if(n.get_$EC()){this.get_$5o().set_$1HF(n.get_$1HF());this.get_$FL()&&(this.get_$5o().get_$1HF()?this.get_$5o().$2xh():this.get_$5o().$2xg())}_d.$9c.prototype.$3v.call(this)},$8uk:function(n){var i=this.$16.$f;var t=i.$j;if(n.$5I===t.get_$6u()){$4Nd(this,t);this.get_$5o()&&this.get_$5o().$1aB(t.get_$9J(),t.get_$85(),t.get_$1Ou())}},$45r:function(n){var t=this.$16.$f;var i=t.$j;if(this.get_$5o()&&n.$5I===i.get_$6u()){this.get_$5o().$8qO();t.$1r.$3A(0,_u.Strings.l_WarningFileCanNotBeAttachedDisconnected_Text,null)}}};_d.$13F=function(n,t,i){this.$$d_$6u4=Function.createDelegate(this,this.$6u4);this.$$d_$6u5=Function.createDelegate(this,this.$6u5);this.$$d_$8Ro=Function.createDelegate(this,this.$8Ro);this.$$d_$6u3=Function.createDelegate(this,this.$6u3);_d.$13F.initializeBase(this,[n,t,i]);this.$1cd=new _d.$13N(this.$$d_$6u3,6e4)};_d.$13F.prototype={$1cd:null,$3v:function(){var n=this.$16.$f;var t=n.$j;if(!t.$2Ph){this.$10();_js.Trace.logInfo(_a.$0.$d,"Auto save timer started")}_d.$9c.prototype.$3v.call(this);n.$S.$HX(_a.$Wa,this.$$d_$8Ro)},$6u3:function(){var t=this.$16;var i=t.$f;var n=i.$j;if(!n.$2Ph){if(!n.get_$3id()){_js.Trace.logInfo(_a.$0.$d,"Auto Save not supported for the current operation {0}",n.get_$4D());return}var f=t.$3S(5);_js.Trace.logInfo(_a.$0.$d,"Checking dirty before auto save");var r=i.$G7();var u=f.get_$Ik();if(r&&!u){_js.Trace.logInfo(_a.$0.$d,"AutoSave:Context:"+n.toString());this.$1cd.$1u();this.$1mY("AutoSave",this.$$d_$6u5,this.$$d_$6u4,!1)}else{this.$1cd.$10();_js.Trace.logInfo(_a.$0.$d,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",r,u)}}},$10:function(){var n=this.$16.$f.$j;!n.$2Ph&&n.get_$3id()&&this.$1cd.$10()},$Ar:function(){this.$1cd.$1u();var n=this.$16.$f;n.$S.$12Z(_a.$Wa,this.$$d_$8Ro);_d.$6i.prototype.$Ar.call(this)},$59:function(){var n=this.$16.$f;n.$S.$12Z(_a.$Wa,this.$$d_$8Ro)},$8Ro:function(n){_js.$K.get_$L().$3i(_a.$0.$d,"Autosave triggered for PAL OnPause event",this.$$d_$6u3)},$6u5:function(n){var t=this.$16;var i=t.$f;var r=i.$j;r.$2Ph||this.$1cd.$10()},$6u4:function(n){_js.Trace.logInfo(_a.$0.$d,"AutoSaveActionFailed: Error: {0}",n.$1b.message);this.$16.$f.$j.$2Ph||this.$1cd.$10()}};_d.$CT=function(n){this.$$d_$8z7=Function.createDelegate(this,this.$8z7);this.$$d_$93N=Function.createDelegate(this,this.$93N);this.$$d_$5hr=Function.createDelegate(this,this.$5hr);this.$$d_$4FK=Function.createDelegate(this,this.$4FK);_d.$CT.initializeBase(this,[3,n])};_d.$CT.$4nz=function(n,t){return new _y.$2j(n,t)};_d.$CT.$2bv=function(n,t){return new _0365m.$n(n,null,t,!0)};function $6Oc(n){if("Mouse"===_y.$j.$g.get_$O()){var r=n.$9K6(_0365m.$n,_d.$CT.$2bv);r&&(n.$CG=new _0365m.$2c(r))}else if(!n.$1U1){if(!n.$YG){var u=n.$9K6(_y.$2j,_d.$CT.$4nz);u&&(n.$YG=new _y.$2j(_u.Strings.l_SetPermissions_LowerCase_Text,null,u))}if(n.$YG){var f=n.$16.$f.$3t;var i=f.$1B;if(i)for(var t=0;t<i.length;t++)if(_u.Strings.l_ImportanceMenuItem_LowerCase_Text===i[t].$2E){f.$2Wy(n.$YG,t+1);n.$1U1=!0}}}}function $4Ng(n,t){var i=this;return function(){_a.$5.stPT(_a.$0.$d,"MailComposeSetIRM",3);var h=_a.$5.$1V(_a.$0.$d,"MailComposeSetIRM",!0);var e=n.$16.$f;var i=e.$j;i.set_$Ms(t);if(i.get_$Ko()){e.$z.$5c(3800);_d.$4I.$D6(n.$16);i.set_$Ko(!1);i.set_$PQ(null);i.set_$O6(null);i.set_$ST(null)}for(var s=e.$WT.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(t.toLowerCase()===u.Id.toLowerCase()){$8(i.get_$5D())&&i.set_$5D(new _g.$cQ);var r=i.get_$5D();r.set_$45S(t);r.set_$1Dt(_g.$S.get_$L().get_$38().get_$Br());r.set_$G9(!0);r.set_$Fh(0);r.set_$1cS(u.Name);r.set_$1cQ(u.Description);r.set_$45(i.get_$45());if("Mouse"===_y.$j.$g.get_$O()){var f=e.$wF();f.$5c(4499);f.$5c(4500);f.$2r.apply(f,[4499].concat([u.Name,u.Description]));f.$2r.apply(f,[4500].concat([r.get_$1Dt()]))}n.set_$2DQ(!0);_js.Trace.logInfo(_a.$0.$d,"Set IRM "+u.Name);break}}_a.$5.$1G(h);_a.$5.endPT("MailComposeSetIRM")}}function $4Nf(n,t){var i=this;return function(){var u=n.$16.$f;var i=u.$j;i.set_$Ms(t);if(!$8(i.get_$5D())&&"Mouse"===_y.$j.$g.get_$O()){var o=u.$wF();o.$5c(4499);o.$5c(4500);i.set_$5D(null);n.set_$2DQ(!1)}for(var s=u.$WT.MessageClassifications,f=0;f<s.length;f++){var r=s[f];if(t.toLowerCase()===r.Id.toLowerCase()){i.set_$Ko(!0);i.set_$PQ(r.Name);i.set_$O6(r.Description);i.set_$ST(r.Id);var e=u.$wF();e.$5c(3800);e.$2r.apply(e,[3800].concat([r.Name,r.Description]));_js.Trace.logInfo(_a.$0.$d,"Set class "+r.Name);break}}}}function $6Od(n,t,i,r){if($8(n.$8d)){n.set_$eB(new _y.$K3);n.$8d.$6g.$H(new _a.$2E(n.$8d.$4a,_u.Strings.l_Close1_Text))}n.$8d.set_$5N(t);$8(n.$2CM)&&(n.$2CM=new _d.$sY);n.$2CM.set_$ho(i);n.$2CM.set_$71Z(String.format(_u.Strings.l_IrmConversationOwner_Text,r));n.$8d.set_$Cu(n.$2CM);n.$8d.set_$1X(!0)}_d.$CT.prototype={$CG:null,$YG:null,$2DP:!1,$2Pu:null,$8d:null,$2CM:null,$1U1:!1,get_$2DQ:function(){return this.$2DP},set_$2DQ:function(n){if(this.$2DP!==n){this.$2DP=n;$Q(this,"IsIrmProtected")}return n},get_$93O:function(){return this.$2Pu},set_$93O:function(n){if(this.$2Pu!==n){this.$2Pu=n;$Q(this,"ShowIrmInformationCommand")}return n},get_$eB:function(){return this.$8d},set_$eB:function(n){if(this.$8d!==n){this.$8d=n;$Q(this,"DialogViewModel")}return n},$3v:function(){var n=this.$16.$f;var i=n.$j;var e=n.$3t;var r=n.$WT;if(this.$3Ol())if(_g.$1Q.$KM){_js.Trace.logInfo(_a.$0.$d,"Checking main window for compliance configuration");this.$YG=_d.$CT.$3lD;_g.$1Q.$KM.$50r(this.$$d_$4FK)}else if(r.WasLoadedFromServer)this.$4FK(r);else{_js.Trace.logInfo(_a.$0.$d,"Adding the loading permissions menu item");this.$YG=_d.$CT.$3lD;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$d,"Submitting GetComplianceConfigurationAction");var o=n.$S;o.$HX(_a.$U4,this.$$d_$5hr);var s=new _h.$U3(r,n.$S);s.$s()}}else if(this.$YG&&this.$1U1&&e.$1B){n.$3t.$34C(this.$YG);this.$1U1=!1}var t=i.get_$5D();this.set_$2DQ(!!t&&!t.get_$Fh());if(this.$2DP&&"Mouse"===_y.$j.$g.get_$O()){var u=n.$wF();u.$2r.apply(u,[4499].concat([t.get_$1cS(),t.get_$1cQ()]));u.$2r.apply(u,[4500].concat([t.get_$1Dt()]))}else if(i.get_$Ko()){var f=n.$wF();f.$2r.apply(f,[3800].concat([i.get_$PQ(),i.get_$O6()]))}"Mouse"===_y.$j.$g.get_$O()||this.$2Pu||this.set_$93O(new _C(this.$$d_$93N,this.get_$1Y()));_d.$9c.prototype.$3v.call(this)},$Ar:function(){this.set_$2DQ(!1);_d.$9c.prototype.$Ar.call(this)},$3Ol:function(){var t=_g.$S.get_$L();if(!$8(t.get_$6D())&&!t.get_$6D().get_$1mf()){_js.Trace.logInfo(_a.$0.$d,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$16.$f.$j.get_$5D();var i=!n||!!n.get_$Fh()||n.get_$G9()||n.get_$2fv();_js.Trace.logInfo(_a.$0.$d,"CanSetCompliance="+i);return i},$9K6:function(n,t){var i=this.$16.$f.$WT;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$d,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var u=0;r[u++]=t(_u.Strings.l_NoRestriction_Text,new _C(this.$$d_$8z7,this.get_$1Y()));for(var f=0,e=0;f<o||e<s;)if(f===o){var l=i.MessageClassifications[e++];r[u++]=t(l.Name,new _C($4Nf(this,l.Id),this.get_$1Y()))}else if(e===s){var a=i.RmsTemplates[f++];r[u++]=t(a.Name,new _C($4Ng(this,a.Id),this.get_$1Y()))}else{var h=i.MessageClassifications[e];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[u++]=t(h.Name,new _C($4Nf(this,h.Id),this.get_$1Y()));e++}else{r[u++]=t(c.Name,new _C($4Ng(this,c.Id),this.get_$1Y()));f++}}return r},$5hr:function(n){var t=this.$16.$f;this.$4FK(t.$WT);t.$S.$12Z(_a.$U4,this.$$d_$5hr)},$4FK:function(n){var i=this.$16.$f;i.$WT=n;_js.Trace.logInfo(_a.$0.$d,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$j.$g.get_$O()){this.$YG&&i.$3t.$34C(this.$YG);this.$YG=null;this.$1U1=!1}n.WasLoadedFromServer&&$6Oc(this);if("Mouse"===_y.$j.$g.get_$O()){var t=this.$16.$3S(18);if(t.get_$JX()){var r=t.$1kx(_u.Strings.l_LoadingPermissions_LowerCase_Text);r>=0&&t.get_$JX().$1B.$67(r);n.WasLoadedFromServer&&t.$6qr()}}},$8z7:function(){var i=this.$16.$f;var n=i.$j;_js.Trace.logInfo(_a.$0.$d,"Set no restriction");n.set_$Ms("0");var t=i.$wF();if($8(n.get_$5D())){if(n.get_$Ko()){t.$5c(3800);n.set_$Ko(!1);n.set_$PQ(null);n.set_$O6(null);n.set_$ST(null)}}else{if("Mouse"===_y.$j.$g.get_$O()){t.$5c(4499);t.$5c(4500)}n.set_$5D(null);this.set_$2DQ(!1)}},$93N:function(){var t=this.$16.$f.$j;if(t.get_$5D()){var n=t.get_$5D();$6Od(this,n.get_$1cS(),n.get_$1cQ(),n.get_$1Dt())}else _js.Trace.logError(_a.$0.$d,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")}};_d.$9c=function(n,t){_d.$9c.initializeBase(this);this.$6zM=n;this.$16=t;if(t&&t.$f){this.$f=t.$f;this.$j_2=this.$f.$j;this.$Z2=this.$f.$z}};function $1e5(n){n.$Z2.$34K();n.$Z2.$Ff(_d.$6i.$QH);n.$Z2.$Ff(_d.$Bd.$QH);n.$Z2.$Ff(_d.$B4.$QH);n.$f.$1Jr.$8qZ(n.$Z2);_d.$4I.$D6(n.$16)}function $3F9(n){if(!n.$j_2.$Sl)return!0;_js.Trace.logInfo(_a.$0.$d,"Comparing initial baseline to baseline. Context:"+n.$j_2.toString());if(!n.$j_2.$Sl.$4W(n.$j_2.get_$H3()))return!0;_js.Trace.logInfo(_a.$0.$d,"Checking dirty before showing discard confirmation.");return n.$f.$G7()?!0:n.$j_2.get_$m0()?!0:!1}function $4Ni(n){try{var i=_a.$1A.$1Ke(n.$f.$G.get_$O()==="Mouse",!0);if(i)throw i;_js.Trace.logInfo(_a.$0.$d,"S/MIME choosing a cert...");var e=_a.$1A.$lv();return e.chooseCert()}catch(r){_js.Trace.logWarning(_a.$0.$d,r.message);var t;var u,f;(f=_a.$1A.$16e(r,u={val:t}),t=u.val,f)&&n.$2XA(t);return null}}function $4Nh(n){try{var p=_a.$1A.$1Ke(n.$f.$G.get_$O()==="Mouse",!0);if(p)throw p;_js.Trace.logInfo(_a.$0.$d,"Building S/MIME data package...");var s=_g.$S.get_$L().get_$kd();var u=_a.$1A.$lv();var i=new _g.$HR;i.Name="smime.p7m";i.ContentType="application/x-pkcs7-mime";var r=n.$j_2.$4o5();var h=r.get_$45()==="HTML"?3:1;r.get_$45()==="HTML"&&r.set_$1d(_a.$3m.$44J(r.get_$1d(),!0));var e=null;var w=n.$f.get_$YI();var b=w.get_$5o();if(b.get_$1e()&&b.get_$1e().get_$F()>0){var o=new(_0365f.$s.$$(String));var rt=this;w.get_$5o().get_$1e().$Bx(function(n){var u=n;var i=u.get_$CC();if(!i.get_$16d())if(_g.$5q.isInstanceOfType(i)){var t=i;t.set_$BL(t.get_$BL()||"application/octet-stream");var r=t.get_$8Y()?t.get_$Qj():"";if(t.$1FA)o.$H(r+">"+t.$1FA+">"+t.get_$BL());else{var f=t.$1kk();o.$H(r+">"+t.get_$1Q()+">"+t.get_$BL()+">"+f)}}else if(_g.$97.isInstanceOfType(i)){var e=i;o.$H(">>>"+e.$zt)}});e=o.get_$3T().join("|")}if(n.$j_2.get_$F1()&&!n.$j_2.get_$Dw()){var g=u.sign(n.$j_2.get_$1Ar(),r.get_$1d(),h,e,s.ClearSign);var c=JsonParser.deserialize(g);if(c.errorCode)throw _a.$1A.$IU(null,c.errorCode);else{i.Content=c.body;s.ClearSign&&(i.ContentType="application/x-pkcs7-signature")}}else if(!n.$j_2.get_$F1()&&n.$j_2.get_$Dw()){var nt=n.$j_2.get_$1z0()?n.$j_2.get_$1z0().join("|"):null;var tt=u.encrypt(r.get_$1d(),h,e,nt);var l=JsonParser.deserialize(tt);if(l.errorCode)throw _a.$1A.$IU(null,l.errorCode);else i.Content=l.body}else if(n.$j_2.get_$F1()&&n.$j_2.get_$Dw()){var f=u.sign(n.$j_2.get_$1Ar(),r.get_$1d(),h,e,!1);var t=JsonParser.deserialize(f);if(t.errorCode)throw _a.$1A.$IU(null,t.errorCode);else{var a="Content-Type: application/x-pkcs7-mime; name=smime.p7m; smime-type=signed-data\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment; filename=smime.p7m\r\n\r\n"+t.body+"\r\n";var it=n.$j_2.get_$1z0()?n.$j_2.get_$1z0().join("|"):null;f=u.encrypt(a,0,null,it);t=JsonParser.deserialize(f);if(t.errorCode)throw _a.$1A.$IU(null,t.errorCode);else if(s.TripleWrapSignedEncryptedMail){a="Content-Type: application/x-pkcs7-mime; name=smime.p7m; smime-type=enveloped-data\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment; filename=smime.p7m\r\n\r\n"+t.body+"\r\n";f=u.sign(n.$j_2.get_$1Ar(),a,0,null,!1);t=JsonParser.deserialize(f);if(t.errorCode)throw _a.$1A.$IU(null,t.errorCode);else i.Content=t.body}else i.Content=t.body}}_js.Trace.logInfo(_a.$0.$d,"S/MIME data package built successfully.");n.$j_2.set_$63A(i);return!0}catch(v){_js.Trace.logWarning(_a.$0.$d,v.message);var y;var k,d;if(d=_a.$1A.$16e(v,k={val:y}),y=k.val,d){n.$2XA(y);return!1}else throw v;}}function $4Nj(n,t){switch(t){case 6:n.$j_2.set_$Dw(!0);n.$j_2.set_$F1(!1);break;case 10:n.$j_2.set_$Dw(!1);n.$j_2.set_$F1(!0);break;case 11:n.$j_2.set_$Dw(!1);n.$j_2.set_$F1(!0);break;case 12:n.$j_2.set_$Dw(!0);n.$j_2.set_$F1(!0);break;case 13:n.$j_2.set_$Dw(!0);n.$j_2.set_$F1(!0);break;case-1:case 0:default:n.$j_2.set_$Dw(!1);n.$j_2.set_$F1(!1);break}}_d.$9c.prototype={$6zM:0,$16:null,$f:null,$j_2:null,$Z2:null,$7M:!1,get_$CL:function(){return this.$7M},set_$CL:function(n){this.$7M=n;return n},get_$1Y:function(){return _a.$0.$d},$3v:function(){this.$7M=!0},$Ar:function(){this.$7M=!1},$4dl:function(n){var t=this.$7Jy(n);this.$Z2.$2r(t,null);(t===55||t===50)&&this.$f.$1Jr.$4dj(this.$Z2);_d.$4I.$D6(this.$16)},$2XA:function(n){this.$Z2.$34K();this.$Z2.$1fI(n);_d.$4I.$D6(this.$16)},$2Ww:function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];var r;(r=this.$Z2).$2r.apply(r,[n].concat(i));_d.$4I.$D6(this.$16)},$5t0:function(n){this.$Z2.$5c(n);_d.$4I.$D6(this.$16)},$7Jy:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_d.$N7=function(n,t,i,r,u,f){this.$$d_$8sN=Function.createDelegate(this,this.$8sN);this.$$d_$7Uy=Function.createDelegate(this,this.$7Uy);this.$1Q9=[];this.$4mA=new _d.$13G(this,t,i,r,u,f);this.$f=n};function $4Nk(n,t,i){if($8(i)||!i)for(var r=0;r<n.$1Q9.length;r++)$4Nl(n,t,r);else for(var u=n.$1Q9.length-1;u>=0;u--)$4Nl(n,t,u)}function $4Nl(n,t,i){var r=n.$1Q9[i];$8(r)||t(r,i)}_d.$N7.prototype={$1Q9:null,$f:null,$4mA:null,$3S:function(n){var t=n;$8(this.$1Q9[t])&&(this.$1Q9[t]=this.$4mA.$738(n,this.$f.$G.get_$O()));return this.$1Q9[t]},$3v:function(){$4Nk(this,this.$$d_$7Uy)},$Ar:function(){_js.Trace.logInfo(_a.$0.$d,"Component Map Reset start.");$4Nk(this,this.$$d_$8sN,!0);_js.Trace.logInfo(_a.$0.$d,"Component Map Reset end.")},$7Uy:function(n,t){_d.$7X.isInstanceOfType(n)||n.get_$CL()||n.$3v()},$8sN:function(n,t){var i=Object.getType(n).getName();if(n.get_$CL()){_js.Trace.logInfo(_a.$0.$d,"Reset "+i+" at index "+t);n.$Ar()}else _js.Trace.logInfo(_a.$0.$d,"Skip uninitialized "+i+" at index "+t)}};_d.$N8=function(n){this.$$d_$9AM=Function.createDelegate(this,this.$9AM);this.$$d_$9AI=Function.createDelegate(this,this.$9AI);this.$$d_$9AL=Function.createDelegate(this,this.$9AL);_d.$N8.initializeBase(this,[17,n])};function $4Nm(n){var t=null;var i,r;if(r=_a.$1T.$2ba(_a.UserAgent.getInstance(),n.$16.$f.$j.get_$Cx(),i={val:t}),t=i.val,r){n.$16.$f.$j.set_$Ni(t);n.set_$4Bm(t);n.set_$4Bm(null);n.$16.$f.get_$14B().$62c();var u=n.$16.$3S(5);u.$49X(!1);u.get_$5o().$93K();n.$16.$f.$j.set_$45("Text");_js.Trace.logInfo(n.get_$1Y(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(n.get_$1Y(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")}function $4Nn(n,t){_js.Trace.logInfo(n.get_$1Y(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!n.$16.$f.$j.get_$EC()){n.$16.$f.$1r.$3A(0,t,null);_js.Trace.logInfo(n.get_$1Y(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}_d.$N8.prototype={$4Dl:null,$4Dq:null,$4Bl:null,$4Bj:null,get_$4Bm:function(){return this.$4Bl},set_$4Bm:function(n){this.$4Bl=n;$Q(this,"SwitchToPlainTextContent");return n},get_$4Bk:function(){return this.$4Bj},set_$4Bk:function(n){this.$4Bj=n;$Q(this,"SwitchToHtmlContent");return n},$3v:function(){this.$4Dq||(this.$4Dq=new _C(this.$$d_$9AL,this.get_$1Y()));this.$4Dl||(this.$4Dl=new _C(this.$$d_$9AI,this.get_$1Y()));_d.$9c.prototype.$3v.call(this)},$9AM:function(n,t){n&&$4Nm(this)},$9AL:function(){_js.Trace.logInfo(this.get_$1Y(),"User chose to convert to plain text");if($4Nn(this,_u.Strings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$16.$f.$j.$HB.$s();var t=this.$16.$f.$j.get_$Cx();var n;var i,r;var u=(r=_a.$1T.$3Qn(t,i={val:n}),n=i.val,r);if(!u){n=t;_js.Trace.logInfo(this.get_$1Y(),"Using html due to failed conversion")}if(n.length>0){var f=this.$16.$f.$1r;f.$3A(1,_u.Strings.l_ConvertToPlainTextWarning_Text,this.$$d_$9AM)}else $4Nm(this)}},$9AI:function(){_js.Trace.logInfo(this.get_$1Y(),"User chose to convert to html");if($4Nn(this,_u.Strings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var i=this.$16;var n=i.$f;var t=n.$j;t.$2iO.$s();var u=n.$j.get_$12B();t.set_$45("HTML");var r=_a.$1T.$he(u);t.set_$Ni(r);this.set_$4Bk(r);this.set_$4Bk(null);n.get_$14B().$62d();var f=i.$3S(5);f.$49X(!0);_js.Trace.logInfo(this.get_$1Y(),"MailComposeContentConversionComponent.ToHtml succeeded.")}}};_d.$Oh=function(n){_d.$Oh.initializeBase(this,[18,n]);this.$AM=_g.$S.get_$L().get_$1t();this.$j=this.$16.$f.$j};_d.$Oh.prototype={$3Ag:null,$3Aa:null,$AM:null,$j:null,get_$JX:function(){return this.$W(_d.$Oh.$17G)},set_$JX:function(n){this.$N(_d.$Oh.$17G,n);return n},$62c:function(){this.$3Aa.set_$15(!1);this.$3Ag.set_$15(!0)},$62d:function(){this.$3Aa.set_$15(!0);this.$3Ag.set_$15(!1)},$3v:function(){if("Mouse"===_y.$j.$g.get_$O()){var t=[];var n;if(this.$j.get_$4D()!==8&&!this.$j.get_$f3()&&!_y.$j.$g.get_$Qz()){var e=this.$16.$3S(8);n=new _0365m.$n(_u.Strings.l_SaveMenuItem_LowerCase_Text,null,e.$DS);Array.add(t,n)}var i=this.$16.$3S(1);if(!this.$j.get_$f3()){n=new _0365m.$n(_u.Strings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$37S);_g.$S.get_$L().get_$1t().get_$1OQ()&&n.set_$15(!0);Array.add(t,n);n=new _0365m.$n(_u.Strings.l_HideBccMenuItemText_LowerCase_Text,null,i.$3cV);_g.$S.get_$L().get_$1t().get_$1OQ()||n.set_$15(!0);Array.add(t,n)}if(this.$j.get_$2E5()){var l=this.$16.$3S(1);n=new _0365m.$n(_u.Strings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$49H);_g.$S.get_$L().get_$1t().get_$1Cd()&&n.set_$15(!0);Array.add(t,n);n=new _0365m.$n(_u.Strings.l_HideFromMenuItemText_LowerCase_Text,null,i.$3cc);_g.$S.get_$L().get_$1t().get_$1Cd()||n.set_$15(!0);Array.add(t,n)}if(!this.$j.get_$f3()&&!_y.$j.$g.get_$Qz()){n=new _0365m.$n(_u.Strings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$11A);Array.add(t,n)}var u=this.$16.$3S(6);if(!$8(u.$CG)){n=new _0365m.$Fg(_u.Strings.l_ImportanceMenuItem_LowerCase_Text,null,u.$CG);Array.add(t,n)}var r=this.$16.$3S(3);if(r.$CG){n=new _0365m.$Fg(_u.Strings.l_SetPermissions_LowerCase_Text,null,r.$CG);Array.add(t,n)}else if(r.$3Ol()&&this.$16.$f.$WT.IsLoadingFromServer){n=new _0365m.$n(_u.Strings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$j.$g.get_$Qz()){var o=this.$16.$3S(12);var s=this.$16.$3S(5);n=new _0365m.$n(_u.Strings.l_SignatureMenuItem_LowerCase_Text,null,o.$3Ki);s.get_$JX().$1B.$H(n)}var f=this.$16.$3S(17);this.$3Ag=new _0365m.$n(_u.Strings.l_ConvertToPlainText_LowerCase_Text,null,f.$4Dq);Array.add(t,this.$3Ag);this.$3Aa=new _0365m.$n(_u.Strings.l_ConvertToHtml_Text,null,f.$4Dl,!0);Array.add(t,this.$3Aa);this.$j.get_$45()==="HTML"?this.$62d():this.$62c();if(!this.$j.get_$f3()){var h=this.$16.$3S(10);n=new _0365m.$n(_u.Strings.l_ShowMessageOptions_Text,null,h.$1yg);Array.add(t,n)}var c=this.$16.$3S(18);c.set_$JX(new _0365m.$2c(t))}_d.$9c.prototype.$3v.call(this)},$9FM:function(){var n=this.get_$JX().$1B.get_$48(this.$1kx(_u.Strings.l_ShowBccMenuItemText_LowerCase_Text));var t=this.get_$JX().$1B.get_$48(this.$1kx(_u.Strings.l_HideBccMenuItemText_LowerCase_Text));n.set_$15(this.$j.get_$iL());t.set_$15(!this.$j.get_$iL())},$69e:function(){var n=this.get_$JX().$1B.get_$48(this.$1kx(_u.Strings.l_ShowFromMenuItemText_LowerCase_Text));var t=this.get_$JX().$1B.get_$48(this.$1kx(_u.Strings.l_HideFromMenuItemText_LowerCase_Text));n.set_$15(this.$j.get_$f1());t.set_$15(!this.$j.get_$f1())},$1kx:function(n){var i=this.get_$JX().$1B;if(i)for(var t=0;t<i.get_$F();t++)if(n===i.get_$48(t).$2E)return t;return-1},$6qr:function(){var n=this.$16.$3S(3);if(!$8(n.$CG)){var t=this.$1kx(_u.Strings.l_ImportanceMenuItem_LowerCase_Text);if(t>=0){var i=new _0365m.$Fg(_u.Strings.l_SetPermissions_LowerCase_Text,null,n.$CG);this.get_$JX().$1B.$6z(t+1,i)}}}};_d.$RM=function(n){this.$$d_$2jo=Function.createDelegate(this,this.$2jo);this.$$d_$3Up=Function.createDelegate(this,this.$3Up);this.$$d_$92r=Function.createDelegate(this,this.$92r);_d.$RM.initializeBase(this,[21,n]);this.$Cv=new _C(this.$$d_$92r,this.get_$1Y());this.$FG=n.$f.$FG};function $4Nv(n,t,i){n.$2jo();var r=n.$16.$f;var u=r.$j.get_$16S()||r.$j.get_$m0();n.$FG.$3Us(t,i,r.$p,u)}function $6Om(n){if($8(n.$wf)){_js.Trace.logInfo(_a.$0.$d,"Creating discard confirm dialog.");var t=new _js.$X;t.$H(new _a.$2E(new _C(n.$$d_$3Up,n.get_$1Y()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$H(new _a.$2E(new _C(n.$$d_$2jo,n.get_$1Y()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$4t6(t)}}_d.$RM.prototype={$Cv:null,$FG:null,$wf:null,$16I:!1,get_$4t6:function(){return this.$wf},set_$4t6:function(n){if(n!==this.$wf){this.$wf=n;$Q(this,"DiscardConfirmDialogButtonData")}return n},get_$1n6:function(){return this.$16I},set_$1n6:function(n){if(n!==this.$16I){this.$16I=n;$Q(this,"IsDiscardConfirmDialogShown")}return n},$3Up:function(){var i=this.$16;var t=i.$f;var n=t.$j;_js.Trace.logInfo(_a.$0.$d,"Discard and close");t.set_$mW(!0);if(n.get_$4D()||!n.get_$4D()&&(n.get_$9J()||t.get_$1LR().$Cf)){_js.Trace.logInfo(_a.$0.$d,"Discard");$4Nv(this,n.get_$6u(),n.get_$9J())}n.set_$H3(null);var r=i.$3S(2);r.get_$3L().$2Jx(t,!1);_js.Trace.logInfo(_a.$0.$d,"Navigated away from compose")},$350:function(n,t){if(this.$FG.$eh(n)){_js.Trace.logInfo(_a.$0.$d,"Resuming discard of "+_h.$Cn.$rV(t));$4Nv(this,n,t)}else _js.Trace.logInfo(_a.$0.$d,"User had already discarded.")},$92r:function(){var t=this.$16.$f;var n=t.$j;_js.Trace.logInfo(_a.$0.$d,"User chose to discard");if($3F9(this)){$6Om(this);_js.Trace.logInfo(_a.$0.$d,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$1n6(!0)}else{_js.Trace.logInfo(_a.$0.$d,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$3Up()}},$2jo:function(){_js.Trace.logInfo(_a.$0.$d,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$16.$f.$j.toString());this.set_$1n6(!1)}};_d.$13I=function(n){_d.$13I.initializeBase(this,[27,n])};_d.$13I.prototype={$r7:null,get_$Se:function(){return this.$r7},set_$Se:function(n){this.$r7=n;$Q(this,"EditorCallContext");return n}};_d.$IO=function(n){this.$$d_$8yz=Function.createDelegate(this,this.$8yz);this.$$d_$8z8=Function.createDelegate(this,this.$8z8);this.$$d_$8yU=Function.createDelegate(this,this.$8yU);_d.$IO.initializeBase(this,[6,n])};_d.$IO.$4nz=function(n,t){return new _y.$2j(n,t)};_d.$IO.$2bv=function(n,t){return new _0365m.$n(n,null,t,!0)};function $2U4(n,t){n.$16.$f.$j.set_$6A(t);n.set_$7ZT("High"===t);n.set_$7ay("Normal"===t);n.set_$7aS("Low"===t)}_d.$IO.prototype={$CG:null,$YG:null,$3gg:!1,$2nR:!1,$3hL:!1,get_$7ZT:function(){return this.$3gg},set_$7ZT:function(n){if(n!==this.$3gg){this.$3gg=n;$Q(this,"IsHighImportance")}return n},get_$7ay:function(){return this.$2nR},set_$7ay:function(n){if(n!==this.$2nR){this.$2nR=n;$Q(this,"IsNormalImportance")}return n},get_$7aS:function(){return this.$3hL},set_$7aS:function(n){if(n!==this.$3hL){this.$3hL=n;$Q(this,"IsLowImportance")}return n},$3v:function(){var n=this.$16.$f.$j.get_$6A();$2U4(this,n);_js.Trace.logInfo(_a.$0.$d,"Importance component initialized and importance set to {0}",n);if("Mouse"===_y.$j.$g.get_$O()){if(!this.$CG){var t=this.$9K6(_0365m.$n,_d.$IO.$2bv);t&&(this.$CG=new _0365m.$2c(t))}}else if(!this.$YG){var i=this.$9K6(_y.$2j,_d.$IO.$4nz);i&&(this.$YG=new _y.$2j(_u.Strings.l_ImportanceMenuItem_LowerCase_Text,null,i))}_d.$9c.prototype.$3v.call(this)},$8yU:function(){var n=_a.$5.$1V(_a.$0.$d,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$d,"User sets high importance");$2U4(this,"High");_a.$5.$1G(n)},$8z8:function(){_js.Trace.logInfo(_a.$0.$d,"User sets normal importance");$2U4(this,"Normal")},$8yz:function(){var n=_a.$5.$1V(_a.$0.$d,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$d,"User sets low importance");$2U4(this,"Low");_a.$5.$1G(n)},$9K6:function(n,t){return[t(_u.Strings.l_HighImportanceButtonText_Text,new _C(this.$$d_$8yU,this.get_$1Y())),t(_u.Strings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$8z8,this.get_$1Y())),t(_u.Strings.l_LowImportanceButtonText_Text,new _C(this.$$d_$8yz,this.get_$1Y()))]}};_d.$mH=function(n,t){this.$$d_$2e1=Function.createDelegate(this,this.$2e1);this.$$d_$47t=Function.createDelegate(this,this.$47t);this.$$d_$49m=Function.createDelegate(this,this.$49m);_d.$mH.initializeBase(this,[26,n]);this.$X7=_h.$3z.$3Zx(t)};function $6Op(n){if(_h.$3z.$2CN){_js.Trace.logInfo(_a.$0.$68,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",n.$US.Url);n.$2e1();return}if(n.$US){var i=1;var r=_a.$5.$1V(_a.$0.$68,"GetComposeLinkPreview",!0);var t=[];Array.add(t,n.$US);_js.Trace.logInfo(_a.$0.$68,"Preparing GetLinkPreview action for {0}",n.$US.Url);n.$US.Autoplay=!0;var u=new _h.$3z(n.$US);_js.Trace.logInfo(_a.$0.$68,"Submitting GetLinkPreview action for {0}",n.$US.Url);var f=this,e=this;n.$16.$f.$p.$k7(u,function(u){_h.$3z.$5zY(u,n.$$d_$47t,n.$$d_$2e1,i,r,"GetComposeLinkPreview",t)},function(n){_h.$3z.$4vO(n,i,r,"GetComposeLinkPreview",t)},null)}}_d.$mH.prototype={$US:null,$16x:null,$X7:!1,$p8:!1,$pi:null,$LR:null,get_$1UA:function(){return this.$X7},set_$1UA:function(n){if(n!==this.$X7){this.$X7=n;$Q(this,"IsLinkPreviewEnabled")}return n},get_$3a2:function(){return this.$US},set_$3a2:function(n){if(n!==this.$US){this.$US=n;$6Op(this)}return n},get_$1pK:function(){return this.$16x},set_$1pK:function(n){this.$16x=n;$Q(this,"LinkPreviewResponse");return n},get_$12o:function(){return this.$LR},set_$12o:function(n){if(n!==this.$LR){this.$LR=n;this.$LR&&_h.$3z.$3bg(this.$LR,null,this.$$d_$49m,null)}return n},get_$1yo:function(){return this.$p8},set_$1yo:function(n){if(this.$p8!==n){this.$p8=n;$Q(this,"ShowYouTubePlayer")}return n},get_$4H0:function(){return this.$pi},set_$4H0:function(n){this.$pi=n;$Q(this,"YouTubePlayerUrl");return n},$47t:function(n){this.set_$1pK(n)},$2e1:function(){this.set_$1UA(!1)},$49m:function(n){this.set_$4H0(n);this.set_$1yo(!!this.$pi)}};_d.$CS=function(n){_d.$CS.initializeBase(this,[16,n])};function $6Ob(n){n.$z.$Ff(_d.$CS.$5pX);$6OT(n)}function $6OX(n){var t=n.$16.$f.$j;var i=t.get_$9R()||t.get_$Qq();return i&&t.get_$St()?i:null}function $6Oa(n){if(_g.$39.isInstanceOfType(n.$qF))return n.$qF.get_$Ju();else if(_g.$RQ.isInstanceOfType(n.$qF)){var t=n.$qF;return t.get_$NB().get_$Ju()==="RecurringMaster"?t.get_$ZC()?"RecurringMaster":"Occurrence":t.get_$NB().get_$Ju()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(n.$qF).getName());}function $6OT(n){if(n.$qF){$6OV(n);if(!_g.$NG.isInstanceOfType(n.$qF)){n.$z.$2r(6800);switch($6Oa(n)){case"Occurrence":case"Exception":$6OW(n);break;case"RecurringMaster":$6OU(n);break}}}}function $6OY(n,t){var i;switch(t){case 8:i=3200;break;case 3:i=3205;break;case 5:i=3210;break;case 6:i=3215;break;case 7:i=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+t);}return i}function $6OZ(n,t){var i;switch(t){case 8:i=3100;break;case 3:i=3105;break;case 5:i=3110;break;case 6:i=3115;break;case 7:i=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+t);}return i}function $6OU(n){var t=$6OZ(n,n.$2bA);n.$z.$2r(t)}function $6OW(n){var t=new _d.$Iz;var i=t.$39(n.$qF,null);var r=$6OY(n,n.$2bA);n.$z.$2r(r,i)}function $6OV(n){if(_g.$Be.isInstanceOfType(n.$qF)){var i=n.$qF;var r=i.get_$2lt()&&!!i.get_$1Kx();if(r){var t=-1;switch(n.$2bA){case 5:t=3250;break;case 7:t=3260;break;case 6:t=3255;break}t!==-1&&n.$z.$2r(t,i.get_$1Kx().Mailbox.Name)}}}_d.$CS.prototype={$z:null,$2bA:0,$qF:null,$3v:function(){_d.$9c.prototype.$3v.call(this);this.$qF=$6OX(this);var n=this.$16.$f;this.$z=n.$wF();this.$2bA=n.$j.get_$4D();_d.$8O.$5DY(n.$j)&&!n.$j.get_$3ic()&&$6Ob(this)}};_d.$7X=function(n,t){this.$$d_$7Nc=Function.createDelegate(this,this.$7Nc);this.$$d_$8XB=Function.createDelegate(this,this.$8XB);this.$$d_$7E8=Function.createDelegate(this,this.$7E8);this.$$d_$7FC=Function.createDelegate(this,this.$7FC);this.$$d_$8XP=Function.createDelegate(this,this.$8XP);this.$$d_$5fh=Function.createDelegate(this,this.$5fh);this.$$d_$8XO=Function.createDelegate(this,this.$8XO);this.$$d_$3xI=Function.createDelegate(this,this.$3xI);this.$$d_$8X9=Function.createDelegate(this,this.$8X9);this.$$d_$8UK=Function.createDelegate(this,this.$8UK);_d.$7X.initializeBase(this,[0,n]);this.$FG=n.$f.$FG;this.$1K=t;this.set_$3Oe(!0)};function $4Ny(n,t){if(n.$j_2.get_$16b()&&n.$j_2.get_$kR()){_js.Trace.logInfo(_a.$0.$d,"Capture initial baseline for a loaded draft.");n.$j_2.$Sl=_d.$1Z.$1h0(n.$j_2)}_js.Trace.logInfo(_a.$0.$d,"Finish 1st init for a loaded draft.");$21i(n);if(n.$j_2.get_$4D()===4){var i=t.get_$4dL()?t.get_$4dL().correlationId:null;_y.$55.$1G(n.$j_2.get_$oK(),null,"",i);_a.$5.endPT("MailComposeEditDraft")}var r=this;_js.$K.get_$L().$3i(_a.$0.$d,"TriggerPolicyTipsIfNeeded",function(){var t=n.$16.$3S(25);t.$1BL(32)})}function $21i(n){var t=n.$16;var r=t.$f;var i=r.$j;var u=i.get_$4D();t.$3S(7).$3v();t.$3S(8).$3v();t.$3S(1).$3v();i.get_$St()&&t.$3S(16).$3v();var f=_y.$j.$g.get_$O();u&&u!==11||!n.$1K.get_$A0()||i.get_$Ni()||i.set_$Ni("");i.get_$Mb()&&t.$3S(12).$3v();f!=="Mouse"?t.$3S(11).$3v():t.$3S(24).$3v();if(r.$Pk){_js.Trace.logInfo(_a.$0.$d,"Begin 2nd init in finish 1st because we are already in view.");n.$4hi()}n.set_$CL(!0);_a.$5.aces(n.$5Ha)}function $3FD(n,t){var r=n.$16.$f;var i=r.$j;var e=r.$p;if(i.get_$16b()){if(i.get_$kR()){_js.Trace.logInfo(_a.$0.$d,"Capture initial baseline since message was a clean new message before popout, context: "+i.toString());i.$Sl=_d.$1Z.$1h0(i)}i.get_$mb()&&!i.get_$EC()&&$3FB(n,!0)}else i.set_$16S(!0);r.$z.$5c(3400);r.$z.$2r(3400,null);i.get_$2Df()&&r.$z.$2r(3480);var u=n.$1K.get_$A0()&&i.get_$45()==="HTML"?_h.$11.get_$1pi():_h.$11.get_$2qh();var o="MailCompose";var f=_d.$9v.$3Rb(t,u,o);f.$5I=i.get_$6u();e.$k7(f,n.$$d_$8XB,n.$$d_$8X9,n.$$d_$3xI);_js.Trace.logInfo(_a.$0.$d,"Loading draft with ID="+_h.$Cn.$rV(t)+"; Shape="+u.BodyType+"; Layout="+_y.$j.$g.get_$O()+"; ContextBodyType="+i.get_$45())}function $3FB(n,t){if(t!==n.$4FT){var i=n.$16.$f.$z;i.$5c(3440);t&&i.$2r(3440,null);_d.$4I.$D6(n.$16);n.$4FT=t}}function $3FC(n){var r=n.$16;var i=r.$f.$j;var t=i.get_$4D();var u=1===t||2===t||3===t||12===t;if(u&&!i.get_$9J()&&!i.get_$EC()){var f=r.$3S(13);f.$6uR()}}function $4Nz(n){var t=n.$16.$f.$j.get_$6u();_js.Trace.logInfo(_a.$0.$d,"Calling main window to process save result "+t);_g.$1Q.$KM.$51w(t,_a.$3b.$1dR,n.$$d_$7Nc)}function $6Oo(n,t,i,r){if(t){_y.$55.$1G(r.get_$oK());_a.$5.endPT(i)}}_d.$7X.prototype={$FG:null,$2oG:!1,$2a0:!1,$4FT:!1,$5Ha:null,$1K:null,get_$CL:function(){return _d.$9c.prototype.get_$CL.call(this)},set_$CL:function(n){if(n!==_d.$9c.prototype.get_$CL.call(this)){_d.$9c.prototype.set_$CL.call(this,n);$Q(this,"IsInitialized")}this.$16.$f.$j.$5EA=n;return n},get_$5D9:function(){return this.$2oG},set_$5D9:function(n){if(n!==this.$2oG){this.$2oG=n;$Q(this,"IsSecondInitializationComplete")}return n},get_$3Oe:function(){return this.$2a0},set_$3Oe:function(n){if(this.$2a0!==n){this.$2a0=n;$Q(this,"CanLoadPopoutSuccessfully")}return n},$3v:function(){this.$5Ha=_a.$5.acss(_a.$0.$d,"VM.MailCompose.FirstInit");var i=this.$16.$f;var n=i.$j;if(!n.$Sl&&!n.get_$9J()){_js.Trace.logInfo(_a.$0.$d,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$Sl=_d.$1Z.$1h0(n);n.get_$16b()||n.set_$kR(!0)}if(n.get_$bf()){_js.Trace.logInfo(_a.$0.$d,"Finish 1st init for complete context");$21i(this);_js.Trace.logInfo(_a.$0.$d,"Check begin upgrade for complete context");$3FC(this)}else{var u=i.$p;var r=n.get_$9J();var t=n.get_$Zs();var f=n.get_$64S();if(!r&&f){var o;var e=_g.$S.get_$L().get_$38();o=_js.$8.$c(e.get_$p2())?e.get_$Br()||"":e.get_$bw()||"";var c=new _g.$Pt("StoreId",f,o);var l=new _c.$qN([c],"EwsId");u.$k7(l,this.$$d_$8UK,this.$$d_$8X9,this.$$d_$3xI);_js.Trace.logInfo(_a.$0.$d,"Calling server to convert id, storeId="+f)}else if(r)if(n.get_$219()&&n.get_$16b()){_js.Trace.logInfo(_a.$0.$d,"The message was saving prior to popout, check for save result from main window");$4Nz(this)}else{_js.Trace.logInfo(_a.$0.$d,"Load draft "+_h.$Cn.$rV(r));$3FD(this,r)}else if((4===n.get_$4D()||13===n.get_$4D())&&n.get_$16b()){_js.Trace.logInfo(_a.$0.$d,"Loading draft without id for the popout from inline case, check id from main window");$4Nz(this)}else if(t){i.$z.$5c(3400);i.$z.$2r(3400,null);if(n.get_$yG()){var a=_c.$FD.$GU(t,n.get_$mY());var s=new _c.$FD(200,a);s.$5I=n.get_$6u();u.$k7(s,this.$$d_$8XO,this.$$d_$5fh,this.$$d_$3xI);_js.Trace.logInfo(_a.$0.$d,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=_d.$9v.$3Rb(t);h.$5I=n.get_$6u();u.$k7(h,this.$$d_$8XP,this.$$d_$5fh,this.$$d_$3xI);_js.Trace.logInfo(_a.$0.$d,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$4D()||11===n.get_$4D()){n.set_$EC(!0);n.set_$bf(!0);_js.Trace.logInfo(_a.$0.$d,"Finish 1st init for new mail");$21i(this)}else throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$2B.$J7(_y.$Oi,n.get_$4D())));}_js.$8.$c(_g.$S.get_$L().get_$38().get_$p2())||i.$z.$2r(95,null)},$Ar:function(){this.set_$CL(!1);this.set_$5D9(!1);this.set_$3Oe(!0);this.$4FT=!1},$4hi:function(){var u=this.$16;var f=u.$f;var n=f.$j;var e=n.get_$4D();var t=null;var i=null;var r=null;switch(e){case 0:t="VM.MailCompose.New";i=n.get_$5L()?"MailComposeNew":"MailComposeNewPopOut";r="MailComposeNew";break;case 1:t="VM.MailCompose.Reply";i=n.get_$5L()?"MailComposeReply":"MailComposeReplyPopOut";r="MailComposeReply";break;case 2:t="VM.MailCompose.ReplyAll";i=n.get_$5L()?"MailComposeReplyAll":"MailComposeReplyAllPopOut";r="MailComposeReplyAll";break;case 3:t="VM.MailCompose.Forward";i=n.get_$5L()?"MailComposeForward":"MailComposeForwardPopOut";r="MailComposeForward";break;case 4:t="VM.MailCompose.EditDraft";i="MailComposeEditDraft";break}t&&$6Oo(this,i,r,n);_js.Trace.logInfo(_a.$0.$d,"Queue 2nd init task, context:"+n.toString());_js.$K.get_$L().$3i(_a.$0.$d,"Delayed MailCompose Secondary Init",this.$$d_$7FC);if(f.get_$2CR()&&!f.$3t.$1B){var o=u.$3S(11);_js.Trace.logInfo(_a.$0.$d,"Queue appbar setup task");_js.$K.get_$L().$3i(_a.$0.$d,"SetupApplicationBarMenu",o.$$d_$906)}var s=u.$3S(19);_js.Trace.logInfo(_a.$0.$d,"Queue GetMailTips if needed task");_js.$K.get_$L().$3i(_a.$0.$d,"TriggerMailTipsIfNeeded",s.$$d_$9BK)},$8XB:function(n){var h=this.$f.get_$4t5();var r=n;var i=n.$5I;_js.Trace.logInfo(_a.$0.$d,"Got draft, checking pending discards for "+i);if(this.$FG.$eh(i))h.$350(i,r.get_$i());else if(i===this.$j_2.get_$6u()){var t=r.$EZ;if(_g.$SL.isInstanceOfType(t)){this.$j_2.$571(t);$3FB(this,!0);$4Ny(this,r)}else{var u=this;var f=function(){$4Nj(u,t.get_$k3());u.$j_2.$3dw(t);$3FB(u,!1);$4Ny(u,r)};if(t.get_$Pm()){var c=this;var e=function(n){_js.Trace.logWarning(_a.$0.$d,n.message);var t;var i,r;(r=_a.$1A.$16e(n,i={val:t}),t=i.val,r)&&c.$2XA(t);f()};try{var o=_a.$1A.$1Ke(this.$f.$G.get_$O()==="Mouse",!0);if(o)throw o;var s=_h.$A2.$26A(200,t);var v=this,y=this;this.$f.$p.$k7(s,function(){f()},function(){e(s.$1b)},null)}catch(l){e(l)}}else f()}if(_a.$5a.$2x){var a=this;_js.$K.get_$L().$3i(_a.$0.$d,"TriggerPolicyTipsIfNeeded",function(){var n=a.$16.$3S(25);n.$1BL(32)})}}else _js.Trace.logInfo(_a.$0.$d,"Skipping get draft processing since action context "+i+" doesn't match current context "+this.$j_2.toString())},$8XO:function(n){var r=this.$16;var u=r.$f;var t=u.$j;var i=n.$5I;if(i===t.get_$6u()&&!this.$FG.$eh(i)){var f=n;t.$165(f.$r);t.set_$mY(!1);_js.Trace.logInfo(_a.$0.$d,"Got original cal item, finish 1st init with context:"+t.toString());$21i(this);_js.Trace.logInfo(_a.$0.$d,"Check begin upgrade on original cal item");$3FC(this)}},$8XP:function(n){var r=this.$16;var u=r.$f;var t=u.$j;var i=n.$5I;if(i===t.get_$6u()&&!this.$FG.$eh(i)){var f=n;t.$165(f.$EZ);_js.Trace.logInfo(_a.$0.$d,"Got original message, finish 1st init with context: "+t.toString());$21i(this);_js.Trace.logInfo(_a.$0.$d,"Check begin upgrade on original message item");$3FC(this)}},$8X9:function(n){var u=this.$16;var t=u.$f;var i=t.$j;var r=n.$5I;if(r===i.get_$6u()&&!this.$FG.$eh(r)){t.$p.$11c(n,_u.Strings.l_OpenDraftFailureMessage_Text,_u.Strings.l_OpenDraftFailureMessageDisconnected_Text,_u.Strings.l_OpenDraftFailureMessage_Text,_u.Strings.l_ErrorRequestTimeout_Text,this.$$d_$7E8);if(i.get_$4D()===4){var f=t.$p.$1SX(n,_u.Strings.l_OpenDraftFailureMessage_Text,_u.Strings.l_OpenDraftFailureMessageDisconnected_Text,_u.Strings.l_OpenDraftFailureMessage_Text,_u.Strings.l_ErrorRequestTimeout_Text,null);_a.$5.$1G(null,"MailComposeEditDraft");var e=n.get_$4dL()?n.get_$4dL().correlationId:null;_y.$55.$1G(i.get_$oK(),null,f,e);_a.$5.endPT("MailComposeEditDraft")}}},$5fh:function(n){var r=this.$16;var t=r.$f;var u=t.$j;var i=n.$5I;i!==u.get_$6u()||this.$FG.$eh(i)||t.$p.$61A(n,this.$$d_$7E8)},$7E8:function(n,t){var i=this.$16.$3S(2);i.get_$3L().$2Jx(this.$16.$f,!1);_js.Trace.logInfo(_a.$0.$d,"Navigate away on action failure")},$3xI:function(n){var t=this.$16.$f;var i=t.$j;if(n.$5I===i.get_$6u()){t.$z.$5c(3400);_d.$4I.$D6(this.$16)}},$7FC:function(){var i=_a.$5.acss(_a.$0.$d,"VM.MailCompose.SecondInit");var t=this.$16;var r=t.$f;var n=r.$j;n.get_$4D()||n.get_$Ni()||n.set_$Ni("");t.$3S(2);t.$3v();n.get_$H3()||n.$4v8();this.set_$5D9(!0);_a.$5.aces(i);_a.$5.endPT(null);_js.Trace.logInfo(_a.$0.$d,"Finish 2nd init, context:"+n.toString())},$8UK:function(n){var i=n;var t=new _g.$1j(i.get_$4nT().Id);this.$16.$f.$j.set_$9J(t);$3FD(this,t)},$7Nc:function(n){if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$d,"Resume loading draft after main window successfully saved item: "+i.Id);var t=this.$16.$f.$j;t.get_$mb()&&!t.get_$EC()&&t.set_$EC(!0);$3FD(this,i)}else{_js.Trace.logInfo(_a.$0.$d,"Save failed on the main window for this popout, show failure message.");this.set_$3Oe(!1)}}};_d.$B4=function(n,t){this.$$d_$4w6=Function.createDelegate(this,this.$4w6);this.$$d_$8uj=Function.createDelegate(this,this.$8uj);this.$$d_$8lK=Function.createDelegate(this,this.$8lK);this.$$d_$45r=Function.createDelegate(this,this.$45r);this.$$d_$5wR=Function.createDelegate(this,this.$5wR);this.$$d_$8PM=Function.createDelegate(this,this.$8PM);this.$$d_$8hw=Function.createDelegate(this,this.$8hw);_d.$B4.initializeBase(this,[9,n]);this.$5lb=new _C(this.$$d_$8hw,this.get_$1Y());this.$FG=n.$f.$FG;this.$1K=t};function $4O0(n,t){var i=n.$16.$f;i.set_$66o(_u.Strings.l_Saving_Text);i.set_$613(t);i.set_$91F(t)}function $4O1(n){var t=n.$16.$f;var i=n.$16.$3S(5);if(i.get_$Ik()){if(!t.$1r.$2R){_js.Trace.logInfo(_a.$0.$d,"Show attachment in progress error dialog");t.$1r.$3A(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1}function $4O2(n){var r=n.$16.$f;var t=r.$j;var i=new _d.$Q;n.$1K&&i.set_$A0(n.$1K.get_$A0());i.set_$5L(0);i.set_$Mb(!1);if(t.get_$4D()===11||t.get_$4D()===12){i.set_$4D(13);i.set_$jV(t.get_$jV());i.set_$1ZC(t.get_$1ZC())}else i.set_$4D(4);i.set_$9J(t.get_$9J());i.set_$45(t.get_$45());var u=n.$758();i.set_$16b(!0);i.set_$EC(t.get_$EC());i.set_$1BY(t.get_$1BY());i.set_$mb(t.get_$mb());i.set_$16S(t.get_$16S());i.set_$m0(t.get_$m0());i.set_$kR(t.get_$kR());i.set_$219(t.get_$219());i.set_$6u(t.get_$6u());i.set_$2h(t.get_$2h());i.set_$oK(t.get_$oK());t.get_$EC()||t.get_$4D()!==3||t.$3iS()||!t.get_$9R().get_$1e()||i.set_$85(t.get_$9R().get_$1e().get_$9JV());u.$VM(i);if(!t.get_$219()){r.set_$mW(!0);$3FE(n);n.set_$2Dt(!1)}}function $3FE(n){var t=n.$16;var i=t.$3S(2);i.get_$3L().$2Jx(t.$f,!1);_js.Trace.logInfo(_a.$0.$d,"Navigated away from inline compose")}_d.$B4.prototype={$FG:null,$1K:null,$5lb:null,$2Ds:!1,$2oC:!1,$1oN:!1,$2Sk:!1,$3c5:!1,$1TY:null,get_$8hx:function(){return this.$5lb},get_$2Dt:function(){return this.$2Ds},set_$2Dt:function(n){this.$2Ds!==n&&(this.$2Ds=n);return n},get_$2E3:function(){return this.$2oC},set_$2E3:function(n){if(this.$2oC!==n){this.$2oC=n;$4O0(this,n)}return n},get_$2oB:function(){return this.$1oN},set_$2oB:function(n){if(this.$1oN!==n){this.$1oN=n;$4O0(this,n)}return n},$4jf:function(){var n=!0;var r=this.$16;var i=r.$f;var t=i.$j;var u=i.get_$1AT();var f=i.get_$1LR();var e=t.get_$6u();var s=t.get_$4D();if(this.$FG.$eh(e))_js.Trace.logInfo(_a.$0.$d,"User had chose to discard, simply navigate away.");else if(t.get_$mb()&&this.$FG.$4t9(r,!1))_js.Trace.logInfo(_a.$0.$d,"User had navigated away on an unused response, the unused response was discarded.");else if($4O1(this))n=!1;else if(u.$K8){_js.Trace.logInfo(_a.$0.$d,"We're sending the message, can't exit yet.");n=!1}else if(u.$2o6){_js.Trace.logInfo(_a.$0.$d,"We're resolving the recipients, can't exit yet.");u.$4vh();n=!1}else if(t.get_$f3()){var o=r.$3S(21);o.$Cv.$s();n=!1}else{_js.Trace.logInfo(_a.$0.$d,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$G7()){this.$3c5=!1;_js.$K.get_$L().$21(_a.$0.$d,"NavigatingAwaySaveTimeout",this.$$d_$8PM,1e4);$1e5(this);if(f.$1mY("InlineExit",this.$$d_$5wR,this.$$d_$45r,!1)){this.set_$2oB(!0);_js.Trace.logInfo(_a.$0.$d,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$758:function(){return new _y.$99},$8hw:function(){var i=this.$16;var t=i.$f;var n=t.$j;var r=n.get_$6u();var c=i.$3S(7);n.set_$oK(this.$1TY=_y.$55.$1V(_a.$0.$d,"MailComposeInlinePopOut",!0));_js.$K.get_$L().$11p(_a.$0.$d,"MailComposePopOut");if(this.$2Ds){_js.Trace.logInfo(_a.$0.$d,"Skipped pop out because another pop out is in progress.");_y.$55.$1G(this.$1TY,null,_d.$B4.$Gy.toString(3));return}if(c.$K8){_js.Trace.logInfo(_a.$0.$d,"Skipped pop out because send is in progress.");_y.$55.$1G(this.$1TY,null,_d.$B4.$Gy.toString(2));return}this.set_$2Dt(!0);var f=!1;try{if($4O1(this)||this.$FG.$eh(r)){_js.Trace.logInfo(_a.$0.$d,"Skipped pop out because attachment is currently uploading or user had discarded");return}var l=this.$16.$f.$z;l.$Ff(_d.$B4.$QH);_d.$4I.$D6(i);var u=i.$3S(8);_js.Trace.logInfo(_a.$0.$d,"Checking dirty before popping out from inline. Context:"+n.toString());var e=t.$G7();var o=t.$j.$2lx;var a=i.$3S(12);if(!n.get_$9J()||e||a.$48W||o){this.set_$2E3(!0);(n.get_$9J()&&!o||e||u.$s1)&&n.set_$kR(!1);_js.Trace.logInfo(_a.$0.$d,"Set WasCleanNewMessageBeforePopout = "+n.get_$kR());this.$2Sk=!1;_js.$K.get_$L().$21(_a.$0.$d,"PopoutSaveTimeout",this.$$d_$8lK,1e4);n.set_$219(!0);$1e5(this);t.$jg.get_$uP()[r]=new _y.$14T;$4O2(this);u.$1mY("Popout",this.$$d_$8uj,this.$$d_$4w6,!1)}else{if(n.get_$16S())n.set_$kR(!1);else if(n.get_$m0())n.set_$kR(!1);else if(u.$s1)n.set_$kR(!1);else if(n.$Sl){_js.Trace.logInfo(_a.$0.$d,"Comparing initial baseline with baseline. Context:"+n.toString());n.$Sl.$4W(n.get_$H3())||n.set_$kR(!1)}else n.set_$kR(!1);n.set_$219(!1);delete t.$jg.get_$uP()[r];$4O2(this)}f=!0;var s=t.get_$1u4();if(s){var h=s.get_$3L();if(h){_js.Trace.logInfo(_a.$0.$d,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");h.set_$7SW(!0)}}}finally{if(!f){this.set_$2Dt(!1);this.set_$2E3(!1);_y.$55.$1G(this.$1TY,null,_d.$B4.$Gy.toString(1))}}},$8uj:function(n){this.set_$2E3(!1);if(this.$2Sk){_js.Trace.logInfo(_a.$0.$d,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$55.$1G(this.$1TY)}else{var i=n.$5I;var t=this.$16.$f;if(i in t.$jg.get_$uP()){var u=_d.$6i.$4w3(n);var r=t.$jg.get_$uP()[i];if(r.$1hC.length){var f=JsonParser.serialize(u);t.$jg.$5rL(f,r.$1hC);delete t.$jg.get_$uP()[i]}else r.$i=u}if(t.$j.get_$6u()===i){_js.Trace.logInfo(_a.$0.$d,"Save succeeded for popout, navigating away from the main window.");t.set_$mW(!0);$3FE(this);this.set_$2Dt(!1)}else _js.Trace.logInfo(_a.$0.$d,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$j.get_$6u())}},$5wR:function(n){this.$1oN&&this.set_$2oB(!1);if(this.$3c5){_js.Trace.logInfo(_a.$0.$d,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$16.$f.set_$mW(!0);$3FE(this)},$45r:function(n){if(this.$1oN){_js.Trace.logInfo(_a.$0.$d,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$2oB(!1)}},$4w6:function(n){if(this.$2Ds){this.set_$2Dt(!1);this.set_$2E3(!1);var u=this.$16;var t=u.$f;var i;i=n?n.$5I:t.$j.get_$6u();if(i in t.$jg.get_$uP()){var r=t.$jg.get_$uP()[i];r.$1hC.length>0&&t.$jg.$5rL(null,r.$1hC);delete t.$jg.get_$uP()[i]}this.$2Sk||_y.$55.$1G(this.$1TY,null,_d.$B4.$Gy.toString(4))}},$8lK:function(){_js.Trace.logInfo(_a.$0.$d,"Attempt to popout expired since save did not come back in time");if(this.$2oC){this.$2Sk=!0;this.$4w6(null);var n=this.$16;var t=n.$f.$z;$1e5(this);t.$2r(84);_d.$4I.$D6(n);_y.$55.$1G(this.$1TY,null,_d.$B4.$Gy.toString(5))}},$8PM:function(){_js.Trace.logInfo(_a.$0.$d,"Attempt to navigate away expired since save did not come back in time");if(this.$1oN){this.$3c5=!0;this.$45r(null);var n=this.$16;var t=n.$f.$z;$1e5(this);t.$2r(86);_d.$4I.$D6(n)}}};_d.$B4.$Gy=function(){};_d.$B4.$Gy.prototype={exception:1,popOutWhileSendInProgress:2,popOutWhilePopOutInProgress:3,failedToSaveForPopout:4,popoutSaveExpired:5};_d.$B4.$Gy.registerEnum("_d.$B4.$Gy",!1);_d.$8O=function(n){_d.$8O.initializeBase(this,[4,n])};_d.$8O.$5DY=function(n){switch(n.get_$4D()){case 4:return n.get_$3ic();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_d.$8O.prototype={get_$2h3:function(){return this.$W(_d.$8O.$3Yb)},set_$2h3:function(n){this.$N(_d.$8O.$3Yb,n);return n},get_$1bF:function(){return this.$W(_d.$8O.$47D)},set_$1bF:function(n){this.$N(_d.$8O.$47D,n);return n},get_$2qM:function(){return this.$W(_d.$8O.$3lL)},set_$2qM:function(n){this.$N(_d.$8O.$3lL,n);return n},get_$3hT:function(){return this.$W(_d.$8O.$3hU)},set_$3hT:function(n){this.$N(_d.$8O.$3hU,n);return n},$3v:function(){var n=this.$16.$f.$j;var o=this.$16.$f.$G;var t=this.$16.$f.$50;n.get_$1lV()?this.set_$2qM(new _d.$DC(n.get_$4h(),null,this.$16.$f.$50,this.$16.$f.$G)):this.set_$2qM(null);if(n.get_$St()&&n.get_$16T()){var i=0;var f=_c.$i.$4oZ(n.get_$35());var r=t.$SX(f,_y.$q.$Mp,!0,i);r.set_$Ih(!1);this.set_$2h3(r);this.set_$3hT(!!n.get_$9o()&&!!n.get_$9o().Mailbox&&!!n.get_$35()&&!!n.get_$35().Mailbox&&!_g.$2I.$4W(n.get_$35().Mailbox,n.get_$9o().Mailbox));if(this.get_$3hT()){var e=_c.$i.$4oZ(n.get_$9o());var u=t.$SX(e,_y.$q.$Mp,!0,i);u.set_$Ih(!1);this.set_$1bF(u)}else this.get_$1bF()&&this.set_$1bF(null)}else{this.get_$2h3()&&this.set_$2h3(null);this.get_$1bF()&&this.set_$1bF(null)}_js.Trace.logInfo(_a.$0.$d,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$St(),n.get_$16T());_d.$9c.prototype.$3v.call(this)}};_d.$FN=function(n){this.$$d_$2xh=Function.createDelegate(this,this.$2xh);this.$$d_$2xg=Function.createDelegate(this,this.$2xg);this.$$d_$6pd=Function.createDelegate(this,this.$6pd);this.$$d_$142=Function.createDelegate(this,this.$142);this.$$d_$2MJ=Function.createDelegate(this,this.$2MJ);this.$$d_$93T=Function.createDelegate(this,this.$93T);_d.$FN.initializeBase(this,[10,n])};function $4O4(n,t,i){return!t&&!i?!0:i==="IsInProgress"&&!t.get_$Ik()}function $3FF(n){_js.Trace.logInfo(_a.$0.$d,"User hit OK on message options dialog, setting Sensitivity="+n.$j_2.get_$7J()+"; DeliveryReceipt="+n.$j_2.get_$FN()+"; ReadReceipt="+n.$j_2.get_$Eg()+"; SmimeEncryptMessage="+n.$j_2.get_$Dw()+"; SmimeSignMessage="+n.$j_2.get_$F1());n.$142()}function $6Oq(n){var i=n.$16.$f;var t=i.$wF();switch(i.$j.get_$7J()){case"Personal":t.$5c(8900);break;case"Confidential":t.$5c(8901);break;case"Private":t.$5c(8902);break}_d.$4I.$D6(n.$16)}function $4O3(n){var i=n.$16.$f;var t=i.$wF();switch(i.$j.get_$7J()){case"Personal":t.$2r(8900,null);break;case"Confidential":t.$2r(8901,null);break;case"Private":t.$2r(8902,null);break}_d.$4I.$D6(n.$16)}_d.$FN.prototype={$1yg:null,$8d:null,$Uz:null,$6g:null,get_$93U:function(){return this.$1yg},set_$93U:function(n){if(this.$1yg!==n){this.$1yg=n;$Q(this,"ShowMessageOptionsCommand")}return n},get_$eB:function(){return this.$8d},set_$eB:function(n){if(this.$8d!==n){this.$8d=n;$Q(this,"DialogViewModel")}return n},$3v:function(){this.$1yg||this.set_$93U(new _C(this.$$d_$93T,this.get_$1Y()));$4O3(this);_d.$9c.prototype.$3v.call(this)},$93T:function(){_js.Trace.logInfo(_a.$0.$d,"User chose to show message options");$8(this.$Uz)&&(this.$Uz=new _d.$gr);this.$Uz.$xs(this.$j_2);if($8(this.$8d)){this.set_$eB(new _y.$K3);this.$8d.set_$5N(_u.Strings.l_MessageOptions_Text);this.$6g=[new _a.$2E(new _C(this.$$d_$2MJ,this.get_$1Y()),_u.Strings.l_Ok_LowerCase_Text,null),new _a.$2E(new _C(this.$$d_$142,this.get_$1Y()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$8d.$6g.$6G(this.$6g)}this.$8d.set_$Cu(this.$Uz);if("TouchNarrow"===_y.$j.$g.get_$O()){var n=this.$16.$f.get_$3L();this.$Uz.set_$3L(n);n.get_$8H().add_$1Z(this.$$d_$6pd)}this.$8d.set_$1X(!0)},$2MJ:function(){if(this.$8d.$9u){_js.Trace.logInfo(_a.$0.$d,"User tried to click OK button more than once.");return}var n=this.$16.$f.$j;var t=this.$f.get_$YI();var i=t.get_$5o();if(n.get_$7J()!==this.$Uz.$1bH){"Normal"!==n.get_$7J()&&$6Oq(this);n.set_$7J(this.$Uz.$1bH);"Normal"!==n.get_$7J()&&$4O3(this)}n.set_$FN(this.$Uz.$1n3);n.set_$Eg(this.$Uz.$1oE);var r=this.$Uz.$11k||this.$Uz.$11l;if(n.get_$Dw()!==this.$Uz.$11k){n.set_$Dw(this.$Uz.$11k);$Q(this,"SmimeEncryptMessage")}if(n.get_$F1()!==this.$Uz.$11l){n.set_$F1(this.$Uz.$11l);$Q(this,"SmimeSignMessage")}i&&i.set_$1HF(n.get_$1HF());if(this.$Uz.$4GT&&!r&&t.get_$FL())if(t.get_$Ik()){this.$8d.set_$7v(!0);i.add_$8C(this.$$d_$2xg)}else this.$2xg(null,null);else if(!this.$Uz.$4GT&&r&&t.get_$FL())if(t.get_$Ik()){this.$8d.set_$7v(!0);i.add_$8C(this.$$d_$2xh)}else this.$2xh(null,null);else $3FF(this)},$2xg:function(n,t){if($4O4(this,n,t)){this.$f.get_$YI().get_$5o().$2xg();$3FF(this);if(n){n.remove_$8C(this.$$d_$2xg);this.$8d.set_$7v(!1)}}},$2xh:function(n,t){if($4O4(this,n,t)){this.$f.get_$YI().get_$5o().$2xh();$3FF(this);if(n){n.remove_$8C(this.$$d_$2xh);this.$8d.set_$7v(!1)}}},$142:function(){if(this.$8d.$9u){_js.Trace.logInfo(_a.$0.$d,"User tried to close dialog when busy.");return}var n=this.$f.get_$YI();if(n.get_$5o()){n.get_$5o().remove_$8C(this.$$d_$2xg);n.get_$5o().remove_$8C(this.$$d_$2xh)}"TouchNarrow"===_y.$j.$g.get_$O()&&this.$Uz.$2o.get_$8H().remove_$1Z(this.$$d_$6pd);_js.Trace.logInfo(_a.$0.$d,"Close message options dialog");this.$8d.$4a.$s()},$6pd:function(n,t){_d.$AA.isInstanceOfType(this.$16.$f.get_$3L().get_$7L())?this.$8d.set_$1X(!0):this.$8d.set_$1X(!1)}};_d.$13K=function(n){this.$$d_$5uF=Function.createDelegate(this,this.$5uF);this.$$d_$30Y=Function.createDelegate(this,this.$30Y);this.$$d_$4mY=Function.createDelegate(this,this.$4mY);_d.$13K.initializeBase(this,[2,n]);this.$FG=n.$f.$FG};_d.$13K.prototype={$FG:null,$2o:null,$11Z:!1,get_$3L:function(){$8(this.$2o)&&(this.$2o=new _y.$99);return this.$2o},set_$3L:function(n){this.$2o=n;return n},$3v:function(){var n=_y.$j.$g;n.remove_$U5(this.$$d_$4mY);n.add_$U5(this.$$d_$4mY);_js.Trace.logInfo(_a.$0.$d,"Before unload handler has been hooked up");"Mouse"!==n.get_$O()||n.get_$6Q()||n.add_$12X(this.$$d_$30Y);_d.$9c.prototype.$3v.call(this)},$4mY:function(n){this.$16.$f.$bk&&(this.$11Z=!0);if(!this.$11Z){_js.Trace.logInfo(_a.$0.$d,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$16.$f.$j.toString());this.$16.$f.$G7()&&n.$1OY(_u.Strings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$11Z=!0;_js.$K.get_$L().$21(_a.$0.$d,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$5uF,100)},$Ar:function(){_y.$j.$g.remove_$U5(this.$$d_$4mY);_d.$9c.prototype.$Ar.call(this)},$5uF:function(){this.$11Z=!1},$30Y:function(){_y.$j.$g.remove_$12X(this.$$d_$30Y);this.$FG.$4t9(this.$16,!0)}};_d.$13L=function(n,t){this.$$d_$194=Function.createDelegate(this,this.$194);_d.$13L.initializeBase(this,[15,n]);this.$CR=t;this.$3zI=new _C(this.$$d_$194,this.get_$1Y());this.$3zI.set_$5P(t.get_$fm().get_$2y0())};_d.$13L.prototype={$CR:null,$3zI:null,$194:function(){_js.Trace.logInfo(_a.$0.$d,"OpenFilePicker on PAL.");var n=this.$16.$3S(5);if(!n){_js.Trace.logError(_a.$0.$d,"Unable to open file picker, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$d,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_d.$N9.$2n1(this.$16.$f)){_js.Trace.logError(_a.$0.$d,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$5o().$8i8(this.$CR);_js.Trace.logInfo(_a.$0.$d,"OpenFilePicker on PAL end.")}};_d.$N9=function(n,t){this.$$d_$4gj=Function.createDelegate(this,this.$4gj);this.$$d_$4gi=Function.createDelegate(this,this.$4gi);_d.$N9.initializeBase(this,[15,n]);this.$CR=t;this.$13U=new _C(this.$$d_$4gi,this.get_$1Y());this.$13U.set_$5P(t.get_$fm().get_$2Zo());this.$13V=new _C(this.$$d_$4gj,this.get_$1Y());this.$13V.set_$5P(t.get_$fm().get_$2hB())};_d.$N9.$2n1=function(n){var t=n.$j;if($8(t)||!t.get_$EC()){_js.Trace.logInfo(_a.$0.$d,"Show attachment not allowed dialog, Upgraded="+t.get_$EC());n.$1r.$3A(0,_u.Strings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_d.$N9.prototype={$CR:null,$13U:null,$13V:null,$4gi:function(){_js.Trace.logInfo(_a.$0.$d,"User chose to attach from camera");var n=this.$16.$3S(5);if(!n){_js.Trace.logError(_a.$0.$d,"Unable to open camera, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$d,"Unable to open camera, attachment well ViewModel is null.");return}if(!_d.$N9.$2n1(this.$16.$f)){_js.Trace.logError(_a.$0.$d,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$5o().$5lZ(this.$CR);_js.Trace.logInfo(_a.$0.$d,"Attach from camera end")},$4gj:function(){_js.Trace.logInfo(_a.$0.$d,"User chose to attach from gallery");var n=this.$16.$3S(5);if(!n){_js.Trace.logError(_a.$0.$d,"Unable to open gallery, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$d,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_d.$N9.$2n1(this.$16.$f)){_js.Trace.logError(_a.$0.$d,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$5o().$5lh(this.$CR);_js.Trace.logInfo(_a.$0.$d,"Attach from gallery end")}};_d.$4O=function(n){this.$$d_$7Bn=Function.createDelegate(this,this.$7Bn);this.$$d_$8dd=Function.createDelegate(this,this.$8dd);this.$$d_$2gx=Function.createDelegate(this,this.$2gx);this.$$d_$4xr=Function.createDelegate(this,this.$4xr);this.$$d_$2L3=Function.createDelegate(this,this.$2L3);this.$$d_$10P=Function.createDelegate(this,this.$10P);this.$$d_$5io=Function.createDelegate(this,this.$5io);this.$$d_$4xs=Function.createDelegate(this,this.$4xs);this.$$d_$8c2=Function.createDelegate(this,this.$8c2);this.$$d_$3z0=Function.createDelegate(this,this.$3z0);this.$$d_$6qc=Function.createDelegate(this,this.$6qc);this.$$d_$8eA=Function.createDelegate(this,this.$8eA);this.$$d_$8w6=Function.createDelegate(this,this.$8w6);this.$$d_$78p=Function.createDelegate(this,this.$78p);this.$$d_$7TS=Function.createDelegate(this,this.$7TS);this.$$d_$933=Function.createDelegate(this,this.$933);this.$$d_$7TF=Function.createDelegate(this,this.$7TF);this.$$d_$92L=Function.createDelegate(this,this.$92L);_d.$4O.initializeBase(this,[1,n]);this.$A4=this.$3S5();this.$A9=this.$3S5();this.$A8=this.$3S5();this.$37S=new _C(this.$$d_$92L,this.get_$1Y());this.$3cV=new _C(this.$$d_$7TF,this.get_$1Y());this.$49H=new _C(this.$$d_$933,this.get_$1Y());this.$3cc=new _C(this.$$d_$7TS,this.get_$1Y());this.$4rq=new _C(this.$$d_$78p,this.get_$1Y());this.$4l6=new _C(this.$$d_$8w6,this.get_$1Y());this.$11A=new _C(this.$$d_$8eA,this.get_$1Y());this.$19u=new(_0365f.$s.$$(_y.$28));this.$38f=new _y.$ul(this.$16.$f.$66);$6Os(this)};_d.$4O.$8lk=function(n,t){n.set_$4O(t)};_d.$4O.$8lX=function(n,t){n.set_$4f(t)};_d.$4O.$8lV=function(n,t){n.set_$6J(t)};_d.$4O.$8lj=function(n,t){n.set_$Y4(t)};_d.$4O.$8lW=function(n,t){n.set_$WP(t)};_d.$4O.$8lU=function(n,t){n.set_$SP(t)};function $6Ov(n){n.$A4.$OW?n.$A4.$1kO():n.$4xs(!0)}function $3FI(n,t){t.$44?n.$19u.$H(t.$44):t.$gG&&n.$19u.$H(t.$gG)}function $6Os(n){n.$A4.$a("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A9.$a("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A8.$a("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A4.$a("ReadOnlyRecipientWellViewModel",n.$$d_$8dd);n.$A9.$a("ReadOnlyRecipientWellViewModel",n.$$d_$8dd);n.$A8.$a("ReadOnlyRecipientWellViewModel",n.$$d_$8dd)}function $6Ow(n){n.$A4.$w("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A9.$w("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A8.$w("ReadWriteRecipientWellViewModel",n.$$d_$8dd);n.$A4.$w("ReadOnlyRecipientWellViewModel",n.$$d_$8dd);n.$A9.$w("ReadOnlyRecipientWellViewModel",n.$$d_$8dd);n.$A8.$w("ReadOnlyRecipientWellViewModel",n.$$d_$8dd)}function $6Ot(n){n.$A4.$44&&n.$A4.$44.$24y();n.$A9.$44&&n.$A9.$44.$24y();n.$A8.$44&&n.$A8.$44.$24y()}function $4O7(n){if(n.$A4.$44){n.$A4.$44.remove_$jN(n.$$d_$4xs);n.$A4.$44.remove_$Om(n.$$d_$5io);n.$A4.$44.remove_$10P(n.$$d_$10P);n.$A4.$44.$1L.remove_$1Z(n.$$d_$2L3)}if(n.$A9.$44){n.$A9.$44.remove_$jN(n.$$d_$4xr);n.$A9.$44.remove_$Om(n.$$d_$5io);n.$A9.$44.remove_$10P(n.$$d_$10P);n.$A9.$44.$1L.remove_$1Z(n.$$d_$2L3)}if(n.$A8.$44){n.$A8.$44.remove_$jN(n.$$d_$2gx);n.$A8.$44.remove_$Om(n.$$d_$5io);n.$A8.$44.remove_$10P(n.$$d_$10P);n.$A8.$44.$1L.remove_$1Z(n.$$d_$2L3)}}function $4OA(n){if(_y.$j.$g.get_$O()==="Mouse"){var i=n.$16.$3S(18);i.$9FM()}else{var t=n.$16.$f.$j;var r=t.get_$iL()?n.get_$3cU():n.get_$495();var u=t.get_$iL()?n.get_$495():n.get_$3cU();var f=n.$16.$f.$3t;f.$44P(u,r)}}function $4O9(n,t){if("Mouse"!==_y.$j.$g.get_$O()){var e=n.$16;var f=e.$f;var r=f.$3t;if(r){var u=r.$1B;if(u)if(t.get_$2E5()){if(!n.$1Uf)for(var i=0;i<u.length;i++)if(_u.Strings.l_ShowBccMenuItemText_LowerCase_Text===u[i].$2E){r.$2Wy(n.get_$1ya(),i+1);n.$1Uf=!0}}else if(n.$1Uf){f.$3t.$34C(n.get_$1ya());n.$1Uf=!1}}}}function $2U5(n){var r=n.$16.$f.$j;var t=null;if(r.get_$f1()){var i=null;n.$Wl?i=n.$Wl.get_$1v().get_$1h():n.$lq&&!_js.$8.$c(n.$lq.$2k)&&(i=$3FG(n,n.$lq.$2k));t=new _g.$Bk;t.Mailbox=i;r.set_$35(t);n.get_$2mX()||n.$16.$f.$z.$5c(66)}return t}function $3FG(n,t){var i=new _g.$1m;i.MailboxType="Mailbox";i.RoutingType="SMTP";i.EmailAddress=t;return i}function $6Ou(n){var i=_d.$IP.$1wK;var t=[];(i&4)==4&&Array.add(t,new _0365m.$n(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(n.$$d_$7Bn,_a.$0.$d)));(i&2)==2&&Array.add(t,new _0365m.$n(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(n.$$d_$78p,_a.$0.$d)));$8(n.$Wl.$hb)||(i&1)!=1||Array.addRange(t,n.$Wl.$hb);n.$Wl.set_$1hZ(t)}function $4O6(n){var t=n.$16.$f.$j;var r=null;var i=_g.$S.get_$L().get_$38();r=_js.$8.$c(i.get_$p2())||_js.$8.$c(i.get_$bw())?null!==t.get_$35()&&t.get_$35().Mailbox?t.get_$35().Mailbox.EmailAddress:_h.$35.$2hf(null)||i.get_$Br():i.get_$bw();n.$2PB(r);t.set_$f1(!0);var f=$2U5(n);t.get_$H3()&&t.get_$H3().set_$35(f);var u=n.$16.$3S(20);$8(u.get_$JX())&&u.$3v()}function $6Or(n){var t=n.get_$xK().get_$Vm();if($8(t)||$8(t.get_$1v())||$8(t.get_$1v().get_$1h()))_js.Trace.logWarning(_a.$0.$d,"User selected from but the SelectedResultItem persona is invalid");else{var i=t.get_$1v().get_$1h().EmailAddress;_js.Trace.logInfo(_a.$0.$d,"User selected from="+i);n.$2PB(i)}}function $6Ox(n){if(_y.$j.$g.get_$O()==="Mouse"){var i=n.$16.$3S(18);i.$69e()}else{var t=n.$16.$f.$j;var r=t.get_$f1()?n.get_$2ju():n.get_$1ya();var u=t.get_$f1()?n.get_$1ya():n.get_$2ju();var f=n.$16.$f.$3t;f.$44P(u,r)}}function $3FH(n,t,i,r,u){var f=n.$OW?i.$44:i.$gG;if(!$8(f)){r(t,f.$84);if(_d.$2n.isInstanceOfType(f)){var e=f;u(t,e.$36.$2k)}}}function $4O8(n,t){var e=n.$16.$f.$j;var i=!1;var f=e.$3Zk();if(f){var r=n.$A9.$44.$84;if(r)for(var u=0;u<r.get_$F();u++){var o=r.get_$48(u);if(f.EmailAddress.toLowerCase()===o.EmailAddress.toLowerCase()){i=!0;break}}}if(t&&i){n.$16.$f.$z.$5c(4450);n.$16.$f.$z.$2r(4450)}else t||i||n.$16.$f.$z.$5c(4450)}_d.$4O.prototype={$A4:null,$A9:null,$A8:null,$37S:null,$3cV:null,$49H:null,$3cc:null,$4rq:null,$4l6:null,$11A:null,$49I:null,$3cd:null,$494:null,$3cT:null,$Wl:null,$lq:null,$379:!1,$OW:!1,$3gV:!1,$4gM:!1,$No:null,$26c:null,$3cr:null,$1Uf:!1,$3hx:!1,$610:!1,$19u:null,$38f:null,add_$5kO:function(n){this.$2Z("ResolveOperationSucceeded",n)},remove_$5kO:function(n){this.$2b("ResolveOperationSucceeded",n)},add_$5kN:function(n){this.$2Z("ResolveOperationCanceled",n)},remove_$5kN:function(n){this.$2b("ResolveOperationCanceled",n)},get_$2h5:function(){return this.$Wl},set_$2h5:function(n){if(this.$Wl!==n){this.$Wl=n;$Q(this,"FromPersonaViewModel")}return n},get_$xK:function(){if(!this.$lq){var n=new _d.$22(_c.$14.$rT,_c.$14.$bV(),!0);_d.$CO.$1QB(n);n.set_$1aY("PersonaDetailedView");n.$vd();n.set_$oy(!0);n.set_$4Cu(new _C(this.$$d_$6qc,_a.$0.$d));_y.$j.$g.get_$O()!=="Mouse"&&n.set_$Gb(new _C(this.$$d_$6qc,_a.$0.$d));n.add_$jv(this.$$d_$3z0);this.$lq=n}return this.$lq},get_$60p:function(){return this.$379},set_$60p:function(n){if(this.$379!==n){this.$379=n;$Q(this,"ShouldHighlightFromAsInvalid")}return n},get_$1mm:function(){var n=this.$16.$f.$j.get_$f1()&&(!!this.$Wl&&this.$Wl.get_$1mm()||!!this.$lq&&this.$lq.get_$1mm());return n||this.$A4.get_$1mm()||this.$A9.get_$1mm()||this.$A8.get_$1mm()},get_$7bw:function(){return this.$OW},set_$7bw:function(n){this.$OW=n;$Q(this,"IsReadWrite");return n},get_$5C8:function(){return this.$3hx},set_$5C8:function(n){this.$3hx=n;$Q(this,"IsPeoplePickerShown");return n},get_$2mX:function(){var n=this.$16.$f.$j;return!!n.get_$35()&&!!n.get_$35().Mailbox&&!_a.$3I.$OZ(n.get_$35().Mailbox.EmailAddress)},get_$1ya:function(){this.$49I||(this.$49I=new _y.$2j(_u.Strings.l_ShowFromMenuItemText_LowerCase_Text,this.$49H));return this.$49I},get_$2ju:function(){this.$3cd||(this.$3cd=new _y.$2j(_u.Strings.l_HideFromMenuItemText_LowerCase_Text,this.$3cc));return this.$3cd},get_$495:function(){this.$494||(this.$494=new _y.$2j(_u.Strings.l_ShowBccMenuItemText_LowerCase_Text,this.$37S));return this.$494},get_$3cU:function(){this.$3cT||(this.$3cT=new _y.$2j(_u.Strings.l_HideBccMenuItemText_LowerCase_Text,this.$3cV));return this.$3cT},get_$7Y1:function(){return!this.$16.$f.$j.get_$f3()},get_$7cn:function(){return!this.$16.$f.$j.get_$f3()},get_$7bf:function(){return this.$16.$f.$j.get_$f3()},$20c:function(){this.$A4.$20c();this.$A9.$20c();this.$A8.$20c()},$8yX:function(n){this.$3cr=n},$6ux:function(n,t,i){if(this.$No){this.$No.remove_$1af(this.$26c);this.$No.add_$1af(i);this.$26c=i;this.$No.set_$5rx(t);this.$No.$69X(n)}else{this.$No=this.$16.$f.$1LI.$4pF(n,t);this.$No.add_$1af(i);this.$No.add_$5oX(this.$$d_$8c2);this.$26c=i}this.set_$5C8(!0);this.$16.$f.$G.$9T(this.$No)},$6qh:function(){if(this.$A4.$44){this.$A4.$44.remove_$jN(this.$$d_$4xs);this.$A4.$44.remove_$Om(this.$$d_$5io);this.$A4.$44.remove_$10P(this.$$d_$10P);this.$A4.$44.$1L.remove_$1Z(this.$$d_$2L3);this.$A4.$44.add_$jN(this.$$d_$4xs);this.$A4.$44.add_$Om(this.$$d_$5io);this.$A4.$44.add_$10P(this.$$d_$10P);this.$A4.$44.$1L.add_$1Z(this.$$d_$2L3)}if(this.$A9.$44){this.$A9.$44.remove_$jN(this.$$d_$4xr);this.$A9.$44.remove_$Om(this.$$d_$5io);this.$A9.$44.remove_$10P(this.$$d_$10P);this.$A9.$44.$1L.remove_$1Z(this.$$d_$2L3);this.$A9.$44.add_$jN(this.$$d_$4xr);this.$A9.$44.add_$Om(this.$$d_$5io);this.$A9.$44.add_$10P(this.$$d_$10P);this.$A9.$44.$1L.add_$1Z(this.$$d_$2L3)}},get_$Vc:function(){return this.$19u},$3v:function(){var n=this.$16.$f.$j;var t=n.get_$5D();this.set_$7bw(!t||!!t.get_$Fh()||t.get_$3vM()||t.get_$G9());if(n.get_$2Qc()&&n.get_$2Qc().get_$F()>0){this.$A4.$7VY(n.get_$2Qc(),this.$OW,_u.Strings.l_ToRecipientsLabel_Text);n.set_$2Qc(null)}else this.$A4.$3v(n.get_$4O(),n.get_$Y4(),this.$OW,_u.Strings.l_ToRecipientsLabel_Text);this.$A9.$3v(n.get_$4f(),n.get_$WP(),this.$OW,_u.Strings.l_CcRecipientsLabel_Text);_y.$j.$g.get_$Qz()&&$4O8(this,!0);this.$6qh();var i=_g.$S.get_$L().get_$38();if(!_js.$8.$c(i.get_$p2())&&!_js.$8.$c(i.get_$bw())){var r=new _g.$Bk;r.Mailbox=$3FG(this,i.get_$bw());n.set_$35(r)}("Mouse"===_y.$j.$g.get_$O()||n.get_$35()||_g.$S.get_$L().get_$1t().get_$1Cd()||!$8(n.get_$6J())&&n.get_$6J().get_$F()>0||_g.$S.get_$L().get_$1t().get_$1OQ())&&this.$1Rd();$4O9(this,n);_d.$9c.prototype.$3v.call(this)},$Ar:function(){if(this.$Wl){this.$Wl.$1M();this.$Wl=null}if(this.$No){this.$No.remove_$1af(this.$26c);this.$No.remove_$5oX(this.$$d_$8c2);this.$No.$1M();this.$No=null;this.$26c=null}$4O7(this);if(this.$lq){this.$lq.remove_$jv(this.$$d_$3z0);this.$lq.$1M();this.$lq=null}$4O7(this);$6Ow(this);this.$19u.$1u();this.$A4.$1M();this.$A9.$1M();this.$A8.$1M();_d.$9c.prototype.$Ar.call(this)},$2SF:function(){this.$1Rd();var n=this.$16.$f.$j;$2U5(this);$3FH(this,n,this.$A4,_d.$4O.$8lk,_d.$4O.$8lj);$3FH(this,n,this.$A9,_d.$4O.$8lX,_d.$4O.$8lW);$3FH(this,n,this.$A8,_d.$4O.$8lV,_d.$4O.$8lU)},$2PB:function(n){var i=_a.$3I.$OZ(n);if(i){this.get_$xK().set_$D5("");var r=$3FG(this,n);var u=_c.$i.$E5(r);var f=this.$16.$f.$66.$wU;var t=f.$qm(u,4,!0,0);t.set_$Bs(this.$4l6);t.set_$DA(!0);t.$1AQ=!0;this.set_$2h5(t);$6Ou(this)}else{this.get_$xK().set_$D5(n);this.set_$2h5(null)}this.set_$60p(!i);this.$2SF()},$1l8:function(){this.$1Rd();return this.$A4.$1l8()+this.$A9.$1l8()+this.$A8.$1l8()},$34q:function(n){this.$1Rd();$2U5(this);$6Ot(this);this.$610=n;$6Ov(this)},$4xs:function(n){n?this.$A9.$OW?this.$A9.$1kO():this.$4xr(!0):this.$2gx(!1)},$4xr:function(n){n?this.$A8.$OW?this.$A8.$1kO():this.$2gx(!0):this.$2gx(!1)},$2gx:function(n){if(this.$610)if(n){_js.Trace.logInfo(_a.$0.$d,"Force resolve completed");$dX(this,"ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$d,"Force resolve cancelled");$dX(this,"ResolveOperationCanceled")}},$15P:function(){this.$1Rd();$2U5(this);this.$A4.$15P();this.$A9.$15P();this.$A8.$15P()},$1Rd:function(){if(!this.$4gM){this.$4gM=!0;var n=this.$16.$f.$j;this.$A8.$3v(n.get_$6J(),n.get_$SP(),this.$OW,_u.Strings.l_BccRecipientsLabel_Text);if(!$8(n.get_$6J())&&0<n.get_$6J().get_$F()||!_js.$8.$c(n.get_$SP())||_g.$S.get_$L().get_$1t().get_$1OQ()){n.set_$iL(!0);_js.Trace.logInfo(_a.$0.$d,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$8(n.get_$6J())?0:n.get_$6J().get_$F(),!_js.$8.$c(n.get_$SP()),_g.$S.get_$L().get_$1t().get_$1OQ())}if(this.$A8.$44){this.$A8.$44.remove_$jN(this.$$d_$2gx);this.$A8.$44.remove_$Om(this.$$d_$5io);this.$A8.$44.remove_$10P(this.$$d_$10P);this.$A8.$44.$1L.remove_$1Z(this.$$d_$2L3);this.$A8.$44.add_$jN(this.$$d_$2gx);this.$A8.$44.add_$Om(this.$$d_$5io);this.$A8.$44.add_$10P(this.$$d_$10P);this.$A8.$44.$1L.add_$1Z(this.$$d_$2L3)}_js.Trace.logInfo(_a.$0.$d,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$35()||!n.get_$35().Mailbox?"<not set>":n.get_$35().Mailbox.EmailAddress,$8(n.get_$4O())?0:n.get_$4O().get_$F(),$8(n.get_$4f())?0:n.get_$4f().get_$F(),$8(n.get_$6J())?0:n.get_$6J().get_$F());$4O9(this,n);if(n.get_$2E5()&&(n.get_$35()||_g.$S.get_$L().get_$1t().get_$1Cd())){$4O6(this);_js.Trace.logInfo(_a.$0.$d,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$35()||!n.get_$35().Mailbox?"<not set>":n.get_$35().Mailbox.EmailAddress,_g.$S.get_$L().get_$1t().get_$1Cd())}else if(_g.$S.get_$L().get_$1t().get_$1Cd()&&!$8(n.get_$5D())&&!n.get_$5D().get_$G9()){var t=this.$16.$f.$z;t.$5c(4525);t.$2r(4525);_d.$4I.$D6(this.$16)}}},$2qR:function(){this.$A4.$2qR();this.$A9.$2qR();this.$A8.$2qR()},$8tO:function(n,t){var f=this.$16.$f;var e=f.$j;var i;var r=e.$3Zk();if(!r){var o=_g.$S.get_$L().get_$38();r=new _g.$1m;r.EmailAddress=o.get_$Br()||o.get_$bw();r.MailboxType="Mailbox";r.RoutingType="SMTP"}var u=new(_0365f.$s.$$(_g.$1m));u.$H(r);var s=this.$OW?this.$A4.$44.$84:this.$A4.$gG.$84;var h=this.$OW?this.$A9.$44.$84:this.$A9.$gG.$84;var c=this.$OW?this.$A8.$44.$84:this.$A8.$gG.$84;s&&u.$6G(s.$7V());h&&u.$6G(h.$7V());c&&u.$6G(c.$7V());i=new _h.$zp(200,u.get_$3T());_js.Trace.logInfo(_a.$0.$d,"Retrieving certs of all recipients.");var l=this,a=this;f.$p.$k7(i,function(){e.set_$1z0(i.get_$6x1());_js.Trace.logInfo(_a.$0.$d,"Retrieving certs completed.");if(i.get_$3er()&&i.get_$3er().length){l.$38f.$3v(i.$1L,i.get_$3er(),n,t);l.$38f.set_$1X(!0)}else n()},function(){_js.Trace.logWarning(_a.$0.$d,"Retrieving certs failed. "+i.$1b.message);var n;var r,u;if(u=_a.$1A.$16e(i.$1b,r={val:n}),n=r.val,u)a.$2XA(n);else{_js.Trace.logException(_a.$0.$d,i.$1b,"GetCerts action failed.");a.$2Ww(704)}t()},null)},$8w6:function(){if(this.$Wl){_js.Trace.logInfo(_a.$0.$d,"User selected from persona");this.$Wl.set_$2X(!0);this.$3cr&&this.$3cr()}else _js.Trace.logInfo(_a.$0.$d,"User tries to select from persona, but it is null")},$8eA:function(){this.$34q(!1)},$78p:function(){_js.Trace.logInfo(_a.$0.$d,"User chose to delete from persona");this.set_$2h5(null);this.get_$xK().set_$HE(!0)},$6qc:function(){this.$2PB(this.get_$xK().$2k)},$3z0:function(n,t){$6Or(this)},$3S5:function(){return new _d.$IP(this.$16.$f.$66,this)},$8dd:function(n,t){this.$19u.$1u();$3FI(this,this.$A4);$3FI(this,this.$A9);$3FI(this,this.$A8)},$2L3:function(n,t){this.$A4.get_$iB()||this.$A9.get_$iB()||this.$A8.get_$iB()||this.$16.$f.$z.$5c(65);this.$A4.get_$C2()&&this.$A9.get_$C2()&&this.$A8.get_$C2()||this.$16.$f.$z.$5c(70);_y.$j.$g.get_$Qz()&&$4O8(this,!1);if(t&&t.$3R===2){var i=this.$16.$f.get_$5Hn();i.get_$CL()||i.$3v();i.$5t1();if(_a.$5a.$2x){var r=this;_js.$K.get_$L().$3i(_a.$0.$HT,"TriggerPolicyTipsIfNeeded",function(){if(r.$16&&r.$16.$f){var n=r.$16.$f.get_$5pB();n.$1BL(1)}})}}},$8c2:function(){this.set_$5C8(!1)},$10P:function(){_d.$4I.$D6(this.$16)},$5io:function(){var n=!1;n=this.$A4.$44.$2aj();n||(n=this.$A9.$44.$2aj());!n&&this.$A8&&(n=this.$A8.$44.$2aj())},$92L:function(){_a.$5.stPT(_a.$0.$d,"MailComposeShowBcc",3);var t=_a.$5.$1V(_a.$0.$d,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$d,"User chose to show bcc");this.$1Rd();var n=this.$16.$f.$j;if(!n.get_$iL()){n.set_$iL(!0);_d.$4I.$D6(this.$16);$4OA(this)}_a.$5.$1G(t);_a.$5.endPT("MailComposeShowBcc")},$7TF:function(){_a.$5.stPT(_a.$0.$d,"MailComposeHideBcc",3);var t=_a.$5.$1V(_a.$0.$d,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$d,"User chose to hide bcc");this.$1Rd();var n=this.$16.$f.$j;if(n.get_$iL()){n.set_$iL(!1);_d.$4I.$D6(this.$16);$4OA(this)}_a.$5.$1G(t);_a.$5.endPT("MailComposeHideBcc")},$7Bn:function(){var n=this.$Wl.get_$1v().get_$1h().EmailAddress;this.set_$2h5(null);this.get_$xK().set_$D5(n);this.get_$xK().set_$HE(!0)},$933:function(){_a.$5.stPT(_a.$0.$d,"MailComposeShowFrom",3);var n=_a.$5.$1V(_a.$0.$d,"MailComposeShowFrom",!0);var t=this.$16.$f.$j;if(t.get_$f1())_js.Trace.logInfo(_a.$0.$d,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$d,"User chose to show from");this.$3gV=!0;$4O6(this);_d.$4I.$D6(this.$16);$6Ox(this)}_a.$5.$1G(n);_a.$5.endPT("MailComposeShowFrom")},$7TS:function(){_a.$5.stPT(_a.$0.$d,"MailComposeHideFrom",3);var t=_a.$5.$1V(_a.$0.$d,"MailComposeHideFrom",!0);var n=this.$16.$f.$j;if(n.get_$f1()){n.set_$f1(!1);this.$3gV=!1;_d.$4I.$D6(this.$16);if(_y.$j.$g.get_$O()==="Mouse"){var i=this.$16.$3S(18);i.$69e()}else{var r=this.$16.$f.$3t;r.$44P(this.get_$2ju(),this.get_$1ya())}}else _js.Trace.logInfo(_a.$0.$d,"Skip hide from since it is already hidden");_a.$5.$1G(t);_a.$5.endPT("MailComposeHideFrom")}};_d.$IP=function(n,t){this.$$d_$3yi=Function.createDelegate(this,this.$3yi);this.$$d_$5Fw=Function.createDelegate(this,this.$5Fw);_d.$IP.initializeBase(this);this.$66=n;this.$5Hb=t};_d.$IP.prototype={$66:null,$45M:null,$44:null,$gG:null,$OW:!1,$5Hb:null,$113:null,get_$Xh:function(){return this.$44},set_$Xh:function(n){if(this.$44!==n){this.$44=n;$Q(this,"ReadWriteRecipientWellViewModel")}return n},get_$8ta:function(){this.$45M||(this.$45M=new _C(this.$$d_$5Fw,_a.$0.$cl));return this.$45M},get_$8or:function(){return this.$gG},set_$8or:function(n){if(n!==this.$gG){this.$gG=n;$Q(this,"ReadOnlyRecipientWellViewModel")}return n},get_$C2:function(){var o=this.$OW&&_y.$28.$C2(this.$44);if(this.$OW){var i;var n;var s="";var t="";var r="";var u="";if(this.$44){for(var f=0;f<this.$44.$1L.get_$F();f++){i=this.$44.$1L.get_$48(f);if(i){s=i.$4U.$Ex;r=r+" "+s}}for(var e=0;e<this.$44.$84.get_$F();e++){n=this.$44.$84.get_$48(e);if(n){t="";_js.$8.$14(n.EmailAddress)?_js.$8.$14(n.Name)||(t=n.Name):t=n.EmailAddress;u=u+" "+t}}}_js.Trace.logInfo(_a.$0.$cq,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$113,o,r,u)}return o},get_$iB:function(){return this.$OW&&!$8(this.$44)&&this.$44.$1GT},$1BM:function(){this.$OW&&this.$44&&this.$44.$9Bx()},$7VY:function(n,t,i){this.$OW=t;this.$44?this.$44.$2NN(null):this.set_$Xh(this.$4pB(null));var r=this.$44.$36;r.set_$D5("");r.$7Rl(n);this.$113=i},$3v:function(n,t,i,r){this.$OW=i;if(i){if(this.$44){this.$44.$2NN(n);var u=this.$44.$36;!_js.$8.$c(u.$2k)&&_js.$8.$c(t)&&u.set_$D5(t)}else this.set_$Xh(this.$4pB(n));_js.$8.$c(t)||this.$44.$36.set_$D5(t);this.$113=r}else this.$gG?this.$gG.$2NN(n):this.set_$8or(this.$75j(n))},$1kO:function(){$8(this.$44)||this.$44.$1kO()},$15P:function(){this.$44&&this.$44.$15P()},$20c:function(){if(!$8(this.$44)){this.$44.set_$20c(!0);this.$44.set_$20c(!1)}},$1l8:function(){var n;n=this.$OW?$8(this.$44)?0:_js.$8.$c(this.$44.$36.$2k)?this.$44.$84.get_$F():this.$44.$84.get_$F()+1:$8(this.$gG)?0:this.$gG.$84.get_$F();return n},$2qR:function(){if(this.$44){for(var u="",f="",i="",r,n,t=0,e=this.$44.$1L.get_$F();t<e;t++){r=this.$44.$1L.get_$48(t);if(r&&!r.$Kq){n=this.$44.$84.get_$48(t);if(n){f=_js.$8.$14(n.Name)?"":n.Name;u=_js.$8.$14(n.EmailAddress)?"":n.EmailAddress;var o=String.format("( {0} , {1} ),",f,u);i+=o}}}i!==""&&_js.Trace.logInfo(_a.$0.$d,"{0} Well Invalid Recipients are: {1} \n",this.$113,i)}},$59:function(){if(!$8(this.$44)){this.$44.set_$48s(!1);this.$44.$1M();this.$44=null}},$4pB:function(n){return this.$66.$2c3(_d.$IP.$1wK,_y.$q.$Mp,n)},$75j:function(n){return this.$66.$UE(_d.$IP.$5rs,_y.$q.$Mp,n,0)},$5Fw:function(){if(this.$OW){_js.Trace.logInfo(_a.$0.$d,"User chose to launch rich people picker");this.$44.$15P();_a.$b.$8E.$H("VM.PeoplePicker.Launched",_a.$7.get_$2M());_a.$5.stPT(_a.$0.$cl,"PeoplePicker",3);_a.$5.$1V(_a.$0.$cl,"PeoplePicker");this.$5Hb.$6ux(this.$44.$1L,this.$113,this.$$d_$3yi)}},$3yi:function(n){_y.$j.$g.get_$O()!=="TouchNarrow"&&this.$44.$1L.$1u();var t=this;n.$Bx(function(n){var i=n;i.$Kq?t.$44.$1fK(i.$BY):t.$44.$234(i.$BY)})}};_d.$4I=function(n){this.$$d_$3y8=Function.createDelegate(this,this.$3y8);this.$$d_$Xj=Function.createDelegate(this,this.$Xj);_d.$4I.initializeBase(this,[14,n])};_d.$4I.$D6=function(n){var t=n.$3S(14);t&&t.$Xj();var i=n.$3S(1);i&&i.$20c()};_d.$4I.prototype={$4GP:!1,get_$1aQ:function(){return this.$W(_d.$4I.$44t)},set_$1aQ:function(n){this.$N(_d.$4I.$44t,n);return n},$3v:function(){var n=this.$16.$f;var t=n.$j;if(!this.$4GP){_y.$j.$g.add_$a8(this.$$d_$Xj);this.$4GP=!0;_g.$S.get_$L().get_$4r().add_$1SD(this.$$d_$3y8)}this.$Xj();_js.Trace.logInfo(_a.$0.$d,"Resize editor component initialized and resize editor called");_d.$9c.prototype.$3v.call(this)},$Xj:function(){this.$7Wm()},$Ar:function(){_y.$j.$g.remove_$a8(this.$$d_$Xj);this.$4GP=!1;_g.$S.get_$L().get_$4r().remove_$1SD(this.$$d_$3y8);_js.Trace.logInfo(_a.$0.$d,"Editor resize component reset");_d.$9c.prototype.$Ar.call(this)},$7Wm:function(){!$8(this.get_$1aQ())&&this.get_$1aQ().$2K&&this.get_$1aQ().$s()},$3y8:function(n,t){this.$Xj()}};_d.$6i=function(n,t,i){this.$$d_$7AH=Function.createDelegate(this,this.$7AH);this.$$d_$7AI=Function.createDelegate(this,this.$7AI);this.$$d_$Ey=Function.createDelegate(this,this.$Ey);this.$Gv={};_d.$6i.initializeBase(this,[8,n]);this.$30=t;this.$DS=new _C(this.$$d_$Ey,this.get_$1Y());this.$FG=n.$f.$FG;this.$1K=i};_d.$6i.$4w3=function(n){var t=null;_h.$4D.isInstanceOfType(n)?t=n.$5J:_h.$4i.isInstanceOfType(n)&&(t=n.$5J);return t};function $4OE(n,t){var f=n.$16;var o=f.$f;var e=o.$j;var i=t.$5I;var r=!1;if(n.$FG.$eh(i)){e.get_$6u()===i&&(n.$Gv={});$21j(n,t);var s=_d.$6i.$4w3(t);if(s){_js.Trace.logInfo(_a.$0.$d,"Resume discard for context "+i);f.$3S(21).$350(i,s)}r=!0}else if(i===e.get_$6u()){if(n.$1bZ){n.$1bZ=!1;_js.Trace.logInfo(_a.$0.$d,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+i);n.$Gv={};$21j(n,t);var u=null;_h.$4D.isInstanceOfType(t)?u=t.$5J:_h.$4i.isInstanceOfType(t)&&(u=t.$5J);u&&e.set_$9J(u);var h=f.$3S(7);h.$2Op();r=!0}else if(n.$2j7){_js.Trace.logInfo(_a.$0.$d,"Saving new content per user's request. ContextId="+i);n.$352();r=!0}}else _js.Trace.logInfo(_a.$0.$d,"Skipping default save processing due to ContextId="+i+"; viewModelId="+o.$j.get_$6u());return r}function $4OD(n){var t="";var i=n.$Gv;for(var r in i){var u={key:r,value:i[r]};t+=u.key+":"}_js.Trace.logInfo(_a.$0.$d,"ProcessorKeys:"+t)}function $6Oy(n,t){var i=n.$16;var u=i.$f;var r=u.$j;var f=t.$5I;var o=n.$s1;if(f===r.get_$6u()){$6Oz(n,t);r.$2lx=!1}$dX(n,"MailSaveSucceeded");if(f===r.get_$6u()&&o){var s=_a.$7.get_$2M();var e=u.$z;e.$Ff(_d.$6i.$QH);e.$2r(1001,s.$2P(0));_d.$4I.$D6(i)}if(_a.$5a.$2x){var h=i.$3S(25);h.$1BL(n.$s1?4:2)}$21j(n,t);_a.$5.$1G(n.$oo,null,"",$3FJ(n,t))}function $4OB(n,t){_js.Trace.logInfo(_a.$0.$d,"SaveActionFailed: Error: {0}",t.$1b.message);var r=_d.$BN.$29t(t.$1b);t.$5I===n.$16.$f.$j.get_$6u()?n.$4dl(t):_a.$5.$1G(n.$oo,null,_d.$6i.$Gy.toString(2),$3FJ(n,t));var i=n.$16.$f;i.$bk&&i.set_$mW(!1);$21j(n,t)}function $21j(n,t){var i=n.$16;var r=i.$f.$j;if(t.$5I===r.get_$6u()){n.set_$C5(!1);n.$s1=!1}_a.$5.endPT("MailComposeSave")}function $4OC(n,t){var i=n.$16.$f;n.$5t0(t);n.$2Ww(t);i.$bk&&i.set_$mW(!1);n.set_$C5(!1);_a.$5.endPT("MailComposeSave")}function $3FJ(n,t){var i=null;_h.$4D.isInstanceOfType(t)&&t.get_$4dL()?i=t.get_$4dL().correlationId:_h.$4i.isInstanceOfType(t)&&t.get_$4dL()&&(i=t.get_$4dL().correlationId);return i}function $6Oz(n,t){var i=n.$16.$f.$j;i.set_$H3(n.$38k);if(n.$s1){i.set_$m0(!0);n.$s1=!1;_js.Trace.logInfo(_a.$0.$d,"Explicit save recorded. ContextId="+i.get_$6u())}if(_h.$35.isInstanceOfType(t)){var u=t;var r=u.$5J;u.$P.set_$i(r);i.set_$9J(r);i.set_$Qq(u.$P);_js.Trace.logInfo(_a.$0.$d,"Updated context from create action. Context:"+i.toString());if(r&&n.$30){var v=this;n.$30.$I(function(n){n.$7B6(r)})}}else if(_h.$4i.isInstanceOfType(t)){var f=t;var e=f.$5J;f.$96.set_$i(e);i.set_$9J(e);i.set_$Qq(f.$96);_js.Trace.logInfo(_a.$0.$d,"Updated context from update action. Context:"+i.toString())}else if(_h.$CI.isInstanceOfType(t)){var s=t;var h=s.$5J;i.set_$9J(h);_js.Trace.logInfo(_a.$0.$d,"Updated context from create response action. Context:"+i.toString())}else if(_c.$OC.isInstanceOfType(t)){var o=t;var c=o.meetingResponseMessageId;i.set_$9J(c);i.set_$Qq(o.$EZ);_js.Trace.logInfo(_a.$0.$d,"Updated context from create meeting response message. Context:"+i.toString())}else if(_c.$Xd.isInstanceOfType(t)){var l=t;var a=l.$5J;i.set_$9J(a);_js.Trace.logInfo(_a.$0.$d,"Updated context from create approval response action. Context:"+i.toString())}}_d.$6i.prototype={$FG:null,$DS:null,$1K:null,$Cf:!1,$s1:!1,$2j7:!1,$38k:null,$1bZ:!1,$oo:null,$30:null,get_$C5:function(){return this.$Cf},set_$C5:function(n){if(n!==this.$Cf){this.$Cf=n;$Q(this,"IsSaving")}return n},$Ey:function(){this.$4Fj(null)},$4Fj:function(n){var t=this.$16;var r=t.$3S(5);var u=t.$f.$1r;var i=t.$f.$j;_js.Trace.logInfo(_a.$0.$d,"SaveStart:Context:"+i.toString());$1e5(this);if(!i.get_$3id()){_js.Trace.logInfo(_a.$0.$d,"Save not supported for the current operation {0}",i.get_$4D());return}if(r.get_$Ik()){_js.Trace.logInfo(_a.$0.$d,"Skip save and show attachment in progress dialog");u.$3A(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$s1=!0;this.$1mY("Save",n,null,!1)},$1mY:function(n,t,i,r){var f=this.$16;var e=f.$f;var u=e.$j;var a=e.$z;var o=u.get_$6u();var p=this.$16.$f.get_$YI();var v=f.$3S(7);if(v.$K8&&!r){_js.Trace.logInfo(_a.$0.$d,"Send is in progress, this "+n+" save is ignored. ContextId="+o);return!0}if(this.$FG.$eh(o)){_js.Trace.logInfo(_a.$0.$d,"User already discarded, clearing all save processors to ignore save effects. ContextId="+o);this.$Gv={};return!1}var h=f.$3S(1);h.$15P();if(_g.$S.get_$L().get_$3mN()<h.$1l8()){a.$2r(800,null);_d.$4I.$D6(f);return!0}h.$2SF();u.$HB.$s();this.$Gv[n]=new _d.$14U(t,i);if(!this.$Cf||r){this.$38k=_d.$1Z.$1h0(u);this.set_$C5(!0)}else{this.$2j7=!this.$38k.$4uz(u);return!0}if(!u.get_$EC()&&!u.get_$9J()&&!u.get_$1BY()){_js.Trace.logInfo(_a.$0.$d,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+o);return!0}_a.$5.stPT(_a.$0.$d,"MailComposeSave",5);this.$oo=_a.$5.$1V(_a.$0.$d,"MailComposeSave",!0);_js.$K.get_$L().$11p(_a.$0.$d,"MailComposeSave");_js.Trace.logInfo(_a.$0.$d,"Started new task runner context before starting save.");var l=!0;try{if(u.get_$F1()||u.get_$Dw()){var c=$4Ni(this);if(c){u.get_$F1()&&u.set_$1Ar(c);u.get_$Dw()&&u.set_$1z0([c]);if(!$4Nh(this)){$4OC(this,743);return!0}}else{$4OC(this,742);return!0}}_js.Trace.logInfo(_a.$0.$ZN,"Setup save action, context:"+u.toString()+"; OriParentFolderId="+(u.get_$9R()&&u.get_$9R().get_$22()&&_g.$g.$1i?_g.$g.$1i.idToName(u.get_$9R().get_$22()):"null"));var s=_d.$9v.$3RE(e,0,this.$1K);if((_h.$35.isInstanceOfType(s)||_h.$4i.isInstanceOfType(s))&&("Attach"===n||"Popout"===n)&&u.get_$f3()){var y=s;y.$jo=new _g.$Bn(new _g.$7o("internalsubmission"))}e.$p.$k7(s,this.$$d_$7AI,this.$$d_$7AH,null);l=!1;_js.Trace.logInfo(_a.$0.$d,"Save action submitted");return!0}finally{if(l){this.set_$C5(!1);this.$s1=!1;_a.$5.$1G(this.$oo,null,_d.$6i.$Gy.toString(1));_a.$5.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$d,"Save failed due to an unhandled exception before action was submitted")}}},$Ar:function(){this.$Cf=!1;this.$2j7=!1;this.$s1=!1;this.$1bZ=!1;this.$Gv={};this.$38k=null;_d.$9c.prototype.$Ar.call(this)},$352:function(){this.$Cf=!1;this.$2j7=!1;_js.Trace.logInfo(_a.$0.$d,"ResumeSave:Context:"+this.$16.$f.$j.toString());var n=this.$Gv;for(var t in n){var i={key:t,value:n[t]};var r=i.value;this.$1mY(i.key,r.$1zV,r.$2g2,!0);break}},$7Jy:function(n){var t=this.$16.$f.$p.$3Zr(n,40,50,60,700,88,89,43,57);var i=new _y.$gD;var r=i.$39(t,null);_a.$5.$1G(this.$oo,null,r,$3FJ(this,n));return t},$4dl:function(n){if("InlineExit"in this.$Gv||"Popout"in this.$Gv){var i=this.$16.$f;var t=i.$z;var r=this.$7Jy(n);var f=new _y.$gD;var u=f.$39(r,null);t.$Ff(_d.$B4.$QH);"InlineExit"in this.$Gv?t.$2r(87,u):t.$2r(85,u);r===50&&i.$1Jr.$4dj(t);_d.$4I.$D6(this.$16)}else"Save"in this.$Gv&&_d.$9c.prototype.$4dl.call(this,n)},$7AI:function(n){var i=this.$16;var e=i.$f;var r=e.$j;var o=i.$3S(21);var u=n.$5I;_js.Trace.logInfo(_a.$0.$d,"Save action returned success, ContextId="+u+"; Context:"+r.toString());_a.$1A.$4kg();if(!$4OE(this,n)&&u===r.get_$6u()){$6Oy(this,n);$4OD(this);var t=null;if("Attach"in this.$Gv){if("AutoSave"in this.$Gv){t=this.$Gv.AutoSave;t&&t.$1zV(n)}t=this.$Gv.Attach}else if("Popout"in this.$Gv){t=this.$Gv.Popout;var f=i.$3S(9);if(f&&f.$2Sk&&"InlineExit"in this.$Gv){t&&t.$1zV(n);t=this.$Gv.InlineExit}}else"InlineExit"in this.$Gv?t=this.$Gv.InlineExit:"AutoSave"in this.$Gv?t=this.$Gv.AutoSave:"Save"in this.$Gv&&(t=this.$Gv.Save);t&&t.$1zV&&t.$1zV(n);this.$Gv={}}},$7AH:function(n){var r=this.$16.$f.$j;var u=n.$5I;_js.Trace.logInfo(_a.$0.$d,"Save action returned a failure, ContextId="+u+"; Context:"+r.toString());if(!$4OE(this,n)&&u===r.get_$6u()){$4OD(this);var t=!1;var f=this.$Gv;for(var e in f){var i={key:e,value:f[e]};var o=i.value;if(o.$2g2){o.$2g2(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){$4OB(this,n);t=!0}}else if(!t){$4OB(this,n);t=!0}}t||$21j(this,n);this.$Gv={}}}};_d.$6i.$Gy=function(){};_d.$6i.$Gy.prototype={exception:1,saveFailedOnDifferentContext:2};_d.$6i.$Gy.registerEnum("_d.$6i.$Gy",!1);_d.$Dj=function(n){_d.$Dj.initializeBase(this,[20,n])};_d.$Dj.$2bv=function(n,t){return new _0365m.$n(n,null,t,!0)};function $2U6(n,t){var i=this;return function(){_js.Trace.logInfo(_a.$0.$d,"User chose from="+t);n.$16.$f.get_$Nj().$2PB(t)}}_d.$Dj.prototype={get_$JX:function(){return this.$W(_d.$Dj.$17G)},set_$JX:function(n){this.$N(_d.$Dj.$17G,n);return n},$3v:function(){if($8(this.get_$JX())){var n=this.$9K6(_0365m.$n,_d.$Dj.$2bv);n&&this.set_$JX(new _0365m.$2c(n))}_d.$9c.prototype.$3v.call(this)},$Ar:function(){this.get_$JX()&&this.set_$JX(null);_d.$9c.prototype.$Ar.call(this)},$2Wy:function(n,t){if(this.get_$JX()){for(var u=_d.$Dj.$2bv(n,new _C($2U6(this,n),this.get_$1Y())),i=this.get_$JX().$1B,r=i.get_$F()-1;r>0;r--)if(_0365m.$9q.isInstanceOfType(i.get_$48(r))){i.$6z(r+1,u);var f=i.get_$F()-r-1;f>t&&i.$67(i.get_$F()-1);return}i.$H(new _0365m.$9q);i.$H(u)}},$9K6:function(n,t){var e=_g.$S.get_$L().get_$38().get_$3QK();var c=$8(e)?0:e.get_$F();var o=_g.$S.get_$L().get_$1t().get_$47B();var u=$8(o)?0:o.get_$F();var l=u>0?1:0;var r=new Array(1+c+u+l);var f=0;var i=_g.$S.get_$L().get_$38().get_$Br();r[f++]=t(i,new _C($2U6(this,i),this.get_$1Y()));for(var s=0;s<c;s++){i=e.get_$48(s).EmailAddress;r[f++]=t(i,new _C($2U6(this,i),this.get_$1Y()))}if(u>0){r[f++]=new _0365m.$9q;for(var h=0;h<u;h++){i=o.get_$48(h);r[f++]=t(i,new _C($2U6(this,i),this.get_$1Y()))}}return r}};_d.$Bd=function(n,t){this.$$d_$4iM=Function.createDelegate(this,this.$4iM);this.$$d_$8wk=Function.createDelegate(this,this.$8wk);this.$$d_$8wp=Function.createDelegate(this,this.$8wp);this.$$d_$8wz=Function.createDelegate(this,this.$8wz);this.$$d_$3OY=Function.createDelegate(this,this.$3OY);this.$$d_$8db=Function.createDelegate(this,this.$8db);this.$$d_$8wu=Function.createDelegate(this,this.$8wu);this.$$d_$8wx=Function.createDelegate(this,this.$8wx);_d.$Bd.initializeBase(this,[7,n]);this.$EK=new _C(this.$$d_$8wx,this.get_$1Y());this.$vS=new _C(this.$$d_$8wu,this.get_$1Y());this.$FG=n.$f.$FG;this.$1K=t};function $6P1(n,t,i){var f=t.MessageXml;if(f)for(var e=Sys.Net.XMLDOM(f),u=0;u<e.firstChild.childNodes.length;u++){var r=e.firstChild.childNodes[u];if(r.nodeType===1&&_a.$36.$Sj(r)==="Value"&&_a.$36.$4zB(r,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$36.$Id(r))){i.val=48;return!0}}i.val=-1;return!1}function $4OF(n){_js.Trace.logInfo(_a.$0.$d,"User chose to send, start force resolve recipients");$1e5(n);n.$2o6=!0;var t=n.$16.$3S(1);t.$34q(!0)}function $6P0(n){var i=!0;var f=n.$16;var r=f.$f;var t=f.$3S(1);var u=f.$3S(5);var e=r.$z;var o=f.$3S(25);if(n.$FG.$eh(r.$j.get_$6u())){_js.Trace.logInfo(_a.$0.$d,"User had already discarded, skipping send.");i=!1;_a.$5.$1G(n.$jw,null,"User has already discarded, skipping send")}else if(t.get_$2mX()){_js.Trace.logInfo(_a.$0.$d,"Not valid to send since sender's address is invalid");e.$2r(66,null);_d.$4I.$D6(n.$16);i=!1;_a.$5.$1G(n.$jw,null,"Sender's address is invalid, not valid to send")}else if(!r.$j.get_$f3()&&t.$A4.get_$C2()&&t.$A9.get_$C2()&&t.$A8.get_$C2()){_js.Trace.logInfo(_a.$0.$d,"Not valid to send since no recipients were specified");e.$2r(70,null);_d.$4I.$D6(n.$16);i=!1;_a.$5.$1G(n.$jw,null,"No recipients were specified, not valid to send")}else if(t.$A4.get_$iB()||t.$A9.get_$iB()||t.$A8.get_$iB()){_js.Trace.logInfo(_a.$0.$d,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$2mX(),t.$A4.get_$iB(),t.$A9.get_$iB(),t.$A8.get_$iB());t.$2qR();e.$2r(65,null);_d.$4I.$D6(n.$16);i=!1;_a.$5.$1G(n.$jw,null,"Invalid recipients are present, not valid to send")}else if(u.get_$Ik()){_js.Trace.logInfo(_a.$0.$d,"Not valid to send since attachment is in progress");var s=r.$1r;s.$3A(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);i=!1;_a.$5.$1G(n.$jw,null,"Attachment is in progress, not valid to send")}else if(_g.$S.get_$L().get_$3mN()<t.$1l8()){e.$2r(800,null);_d.$4I.$D6(n.$16);i=!1;_a.$5.$1G(n.$jw,null,"Max recipients exceeded, not valid to send")}else if(_a.$5a.$2x&&o.$7cK()){_js.Trace.logInfo(_a.$0.$d,"Not valid to send since policy violation detected");var h=r.$1r;h.$3A(0,o.$7Nz(),null);i=!1;_a.$5.$1G(n.$jw,null,"PolicyTip violation detected, not valid to send")}else if(u&&u.get_$5o())try{if(n.$ln.$3bu(r.$j,u.get_$5o().get_$1e())){i=!1;_a.$5.$1G(n.$jw,null,"Forgotten attachment detected, not valid to send")}}catch(c){_js.Trace.logException(_a.$0.$d,c,"An exception has been caught for FAD check; keep sending",n.$ln,r.$j,u.get_$5o().get_$1e())}i&&o.$8z4();return i}function $3FK(n,t){var i=null;_h.$4D.isInstanceOfType(t)&&t.get_$4dL()?i=t.get_$4dL().correlationId:_h.$4i.isInstanceOfType(t)&&t.get_$4dL()&&(i=t.get_$4dL().correlationId);return i}_d.$Bd.prototype={$FG:null,$vS:null,$1K:null,$EK:null,$K8:!1,$2o6:!1,$ln:null,$jw:null,get_$iU:function(){return this.$K8},set_$iU:function(n){if(n!==this.$K8){this.$K8=n;$Q(this,"IsSending");var t=this.$16.$f;t.set_$66o(_u.Strings.l_Sending_Text);t.set_$613(n)}return n},$3v:function(){if(!this.$ln){var t=this.$16.$f;this.$ln=t.$1kQ.$4oR(t.$1r,this.$EK)}var n=this.$16.$3S(1);if(n){n.remove_$5kO(this.$$d_$8db);n.remove_$5kN(this.$$d_$3OY);n.add_$5kO(this.$$d_$8db);n.add_$5kN(this.$$d_$3OY)}_d.$9c.prototype.$3v.call(this)},$Ar:function(){this.set_$iU(!1);_d.$9c.prototype.$Ar.call(this)},$2Op:function(){var r=this.$16;var t=r.$f;var n=t.$j;var i=r.$3S(8);if(i.$Cf){i.$1bZ=!0;_js.Trace.logInfo(_a.$0.$d,"Send deferred due to in progress save.")}if(n.get_$EC()||n.get_$9J()||n.get_$1BY()){if(!i.$1bZ){var f=this.$16.$3S(1);f.$2SF();_js.Trace.logInfo(_a.$0.$d,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$9R()&&n.get_$9R().get_$22()&&_g.$g.$1i?_g.$g.$1i.idToName(n.get_$9R().get_$22()):"null"));var e=_d.$9v.$3RE(t,1,this.$1K);_js.Trace.logInfo(_a.$0.$d,"Submitting send action");t.$p.$k7(e,this.$$d_$8wz,this.$$d_$8wp,this.$$d_$8wk);_js.Trace.logInfo(_a.$0.$d,"Send action submitted")}}else{var u=n.get_$6u();_js.Trace.logInfo(_a.$0.$d,"Send was attempted during upgrade for context "+u+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$4vh:function(){var n=this;_js.$K.get_$L().$21(_a.$0.$d,"ExitResolvingRecipientsMode",function(){n.$2o6=!1},2e3)},$6qq:function(n){if(n&&n.Mailbox){var i=n.Mailbox.EmailAddress;if(i!==_g.$S.get_$L().get_$38().get_$Br()&&!_h.$35.$2hc(n)){var r=_g.$S.get_$L().get_$1t().get_$47B();if($8(r)||!r.$6l(i)){var t=new(_a.$U.$$(String));t.$H(i);t.$3Qv(r);t.get_$F()>_d.$Bd.$3mO&&t.$67(t.get_$F()-1);_g.$S.get_$L().get_$1t().set_$47B(t);_h.$2x.$H4(_g.$S.get_$L().get_$1t().$PB,OwaApplication.$1T);var u=this.$16.$3S(20);u.$2Wy(i,_d.$Bd.$3mO)}}}},$7Jy:function(n){var t;var i=_d.$BN.$29t(n.$1b);if(i==="ErrorSendAsDenied")t=80;else{var r,u;i==="ErrorRightsManagementPermanentException"&&(u=$6P1(this,n.$1b,r={val:t}),t=r.val,u)||(t=i==="ErrorSubmissionQuotaExceeded"?47:this.$16.$f.$p.$3Zr(n,45,55,62,700,88,89,46,58))}var f=new _y.$gD;var e=f.$39(t,null);_a.$5.$1G(this.$jw,null,e,$3FK(this,n));return t},$8wx:function(){if(this.$j_2.get_$F1()&&!this.$j_2.get_$1Ar()){var r=this;var n=function(n){r.$3OY();r.$2Ww(n)};var t=!1;this.$j_2.set_$1Ar($4Ni(this));if(this.$j_2.get_$1Ar()){var i=new _h.$zq(200,this.$j_2.get_$1Ar());var u=this,f=this;this.$16.$f.$p.$k7(i,function(){_js.Trace.logInfo(_a.$0.$d,"Retrieving certs info completed.");t=i.get_$cu().IsValid;if(t)$4OF(u);else{_js.Trace.logWarning(_a.$0.$d,"Retrieving certs info determined the certificate is INVALID.");n(740)}},function(){t=!1;f.$j_2.set_$1Ar(null);_js.Trace.logWarning(_a.$0.$d,"Retrieving certs info failed. "+i.$1b.message);n(739)},null)}else n(741)}else $4OF(this)},$3OY:function(){var t=this.$16.$f.$z;var n=this.$16.$f.get_$Nj();this.set_$iU(!1);t.$5c(735);if(n.$A4.get_$iB()||n.$A9.get_$iB()||n.$A8.get_$iB()){t.$2r(65,null);OwaApplication.get_$Qt().$8oV(_a.$Hj,new _a.$Hj(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}n.get_$2mX()&&t.$2r(66,null);_d.$4I.$D6(this.$16);this.$4vh()},$8db:function(){var t=this.$f.get_$Nj();var i=this.$f.get_$YI();_js.Trace.logInfo(_a.$0.$d,"SendStart:Context:"+this.$16.$f.$j.toString());if(this.$K8){_js.Trace.logInfo(_a.$0.$d,"Skip send since another send is in progress");return}this.set_$iU(!0);this.$2o6=!0;_a.$5.stPT(_a.$0.$d,"VM.MailCompose.Send",5);this.$jw=_a.$5.$1V(_a.$0.$d,"MailComposeSend",!0);_js.$K.get_$L().$11p(_a.$0.$d,"MailComposeSend");_js.Trace.logInfo(_a.$0.$d,"Started new task runner context before starting send.");var n=!0;try{if($6P0(this))if(this.$j_2.get_$F1()||this.$j_2.get_$Dw())if(this.$j_2.get_$Dw()){this.$2Ww(735);t.$8tO(this.$$d_$4iM,this.$$d_$3OY)}else this.$4iM();else this.$2Op();else this.set_$iU(!1);n=!1}finally{if(n){this.set_$iU(!1);_js.Trace.logWarning(_a.$0.$d,"Send failed due to an unhandled exception thrown before the action was submitted");_a.$5.$1G(this.$jw,null,"Send failed due to unhandled exception")}}},$4iM:function(){if($4Nh(this)){this.$j_2.get_$Dw()&&this.$5t0(735);this.$2Op()}else this.$3OY()},$8wz:function(n){var u=this.$16;var t=u.$f;var i=t.$j;var r=n.$5I;_js.Trace.logInfo(_a.$0.$d,"Send action succeeded, ContextId="+r+"; Context:"+i.toString());_a.$1A.$4kg();i.get_$2E5()&&this.$6qq(i.get_$35());if(r===i.get_$6u()){i.set_$H3(null);_js.Trace.logInfo(_a.$0.$d,"Context match, navigating away from compose at the end of send success. ContextId="+r);var f=u.$3S(2);t.set_$mW(!0);f.get_$3L().$2Jx(t,!0)}else _js.Trace.logInfo(_a.$0.$d,"Context does not match, skipping navigating away from compose.");$dX(this,"MailSendSucceeded");_a.$5.$1G(this.$jw,null,"",$3FK(this,n),!t.get_$YI()||!t.get_$YI().get_$5o()?null:t.get_$YI().get_$5o().$7IH());OwaApplication.get_$Qt().$8oV(_a.$Hj,new _a.$Hj(_u.Strings.l_MailComposeSendComponent_AT_LiveRegion_Text))},$8wp:function(n){var i=this.$16.$f;var r=i.$j;var u=n.$5I;_js.Trace.logInfo(_a.$0.$d,"Send action failed, ContextId="+u+"; Context:"+r.toString());var t=_d.$BN.$29t(n.$1b);if(u===r.get_$6u()){this.set_$iU(!1);_js.Trace.logInfo(_a.$0.$d,"Context match. Showing infobar message for ResponseCode="+t);this.$4dl(n)}else _js.Trace.logInfo(_a.$0.$d,"Context does not match. Skip showing infobar message for ResponseCode="+t);_a.$5.$1G(this.$jw,null,1+":"+t,$3FK(this,n));i.$p.$5rg(n)},$8wk:function(n){var t=this.$16.$f;var i=t.$j;_a.$5.endPT("VM.MailCompose.Send")},$8wu:function(){this.$16.$f.get_$4tX()&&this.$EK.$2K&&this.$EK.$s()}};_d.$13M=function(n,t,i){_d.$13M.initializeBase(this,[23,n]);this.$32=t;this.$ug=i};_d.$13M.prototype={$32:null,$ug:null,$3v:function(){if(!this.get_$CL()&&this.$32.get_$7r().get_$1zE()===2&&this.$ug.get_$912().get_$7Sg()){var n=this.$16.$3S(5);_d.$N9.$2n1(this.$16.$f)&&!$8(n)&&($8(n.get_$5o())||n.get_$5o().$6qs(this.$ug))}_d.$9c.prototype.$3v.call(this)}};_d.$DD=function(n,t){this.$$d_$4eV=Function.createDelegate(this,this.$4eV);_d.$DD.initializeBase(this,[12,n]);this.$3Ki=new _C(this.$$d_$4eV,this.get_$1Y());this.$1K=t;this.$1D=_a.UserAgent.getInstance();this.$4N=_a.$69.$I()};_d.$DD.$3ag=function(n,t){return t?n.get_$62r():n.get_$1An()};function $6P2(n){var t=_g.$S.get_$L().get_$1t();return"Mouse"===_y.$j.$g.get_$O()?t.get_$13d():n.$1D.get_$5h()?n.$4N.$3k("MOWA.IsSignatureChanged")==="true"?n.$4N.$3k("MOWA.AutoAddSignature")==="true":!0:t.get_$3MX()}function $4OG(n,t,i){if("Mouse"===_y.$j.$g.get_$O())return _d.$DD.$3ag(t,i);if(n.$1D.get_$5h()){if(n.$4N.$3k("MOWA.IsSignatureChanged")==="true")if(n.$4N.$3k("MOWA.UseDesktopSignature")==="true")return _d.$DD.$3ag(t,i);else{var r=n.$4N.$3k("MOWA.SignatureText")||"";return i?_a.$1T.$he(r):r}return i?_a.$1T.$he(_c.$IH.$2hw(n.$1D)):_c.$IH.$2hw(n.$1D)}if(t.get_$kO())return _d.$DD.$3ag(t,i);else{var u=t.get_$49q()||"";return i?_a.$1T.$he(u):u}}_d.$DD.prototype={$3Ki:null,$1K:null,$2QO:null,$48W:!1,$rp:null,$1D:null,$4N:null,get_$38Q:function(){return this.$2QO},set_$38Q:function(n){if(this.$2QO!==n){this.$2QO=n;$Q(this,"Signature")}return n},get_$Mb:function(){return this.$48W},set_$Mb:function(n){this.$48W=n;$Q(this,"ShouldAutoAddSignature");return n},$3v:function(){if(this.$16.$f.$j.get_$Mb()&&$6P2(this)){_a.$5.stPT(_a.$0.$d,"MailComposeAutoSig",5);var n=_a.$5.$1V(_a.$0.$d,"MailComposeAutoSig",!0);this.set_$Mb(!0);this.$4eV(!0);_a.$5.$1G(n);_a.$5.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$d,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_d.$9c.prototype.$3v.call(this)},$7IR:function(){var t;var n=_a.UserAgent.getInstance();t=n.$8O?this.$rp?_js.$8.$4C("{0}{0}","<P></P>"):"":n.$y0||n.$JT?"<P><BR></P>":_js.$8.$4C("{0}{0}","<P><BR></P>");return t},$4eV:function(n){var u=null;var f=this.$16.$f.$j;var e=_g.$S.get_$L().get_$1t();if(n)f.$2lx=!0;else{_a.$5.stPT(_a.$0.$d,"MailComposeInsertSig",3);u=_a.$5.$1V(_a.$0.$d,"MailComposeInsertSig",!0)}var t=f.get_$45()==="HTML"&&this.$1K.get_$A0();if(t){var i=$4OG(this,e,t);if(_js.$8.$c(i))_js.Trace.logInfo(_a.$0.$d,"Skipping inserting blank signature in HTML format.");else{var l=n?this.$7IR():_d.$DD.$62q;var o=l+i.replace(_d.$DD.$5sG," ");_js.Trace.logInfo(_a.$0.$d,"Insert signature for mouse html OriSig="+i+"; FormattedSig="+o);this.set_$38Q(o)}}else{var r=$4OG(this,e,t);if(_js.$8.$c(r))_js.Trace.logInfo(_a.$0.$d,"Skipping inserting blank signature in text format.");else{var s="\n\n"+r;_js.Trace.logInfo(_a.$0.$d,"Insert signature for touch text OriSig="+r+"; FormattedSig="+s);this.set_$38Q(s)}}var h=!_js.$8.$c(this.$2QO);var c=!!this.$rp;h&&c?this.$rp.$s():_js.Trace.logInfo(_a.$0.$d,"Skip insert signature due to HasSignature="+h+"; HasCommand="+c);if(!n){_a.$5.$1G(u);_a.$5.endPT("MailComposeInsertSig")}}};_d.$FO=function(n,t){this.$$d_$2Ao=Function.createDelegate(this,this.$2Ao);this.$$d_$5wR=Function.createDelegate(this,this.$5wR);this.$$d_$3cW=Function.createDelegate(this,this.$3cW);this.$$d_$3U0=Function.createDelegate(this,this.$3U0);this.$$d_$35Q=Function.createDelegate(this,this.$35Q);this.$$d_$61R=Function.createDelegate(this,this.$61R);this.$$d_$906=Function.createDelegate(this,this.$906);_d.$FO.initializeBase(this,[11,n]);this.$4a=new _C(this.$$d_$61R,this.get_$1Y());this.$87=t||null};_d.$FO.$72c=function(n){return new _y.$2f(_y.$c.get_$2YF(),_y.$c.get_$4gA(),_u.Strings.l_AppsTouch_Text,n.$7e.$1bg)};function $4OH(n){var t=n.$16.$3S(7);return t.$K8}function $6P3(n){var i=n.$16;var f=i.$f;var e=f.$j;var c=i.$3S(7);var l=i.$3S(24);var o=!!n.$87&&n.$87.$7x("ComposeApps");var t;var a=new _y.$2f(_y.$c.get_$1Lr(),_y.$c.get_$36O(),_u.Strings.l_SendItemMobile_Text,c.$EK);var r=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Close1_Text,n.$4a);var s=_d.$FO.$72c(l);var u=$6P4(n,e,i);if(u&&o){t=new Array(4);t[1]=s;t[2]=r;t[3]=u}else if(u){t=new Array(3);t[1]=r;t[2]=u}else if(o){t=new Array(3);t[1]=s;t[2]=r}else{t=new Array(2);t[1]=r}t[0]=a;_js.Trace.logInfo(_a.$0.$d,"Creating appbar. ContextId="+e.get_$6u());var h=_y.$26.$Bv(f,t,null);h.set_$5AI("TouchNarrow"===_y.$j.$g.get_$O());f.$8xM(h)}function $6P5(n){if($8(n.$qR)){_js.Trace.logInfo(_a.$0.$d,"Create close confirm dialog.");var t=new _js.$X;t.$H(new _a.$2E(new _C(n.$$d_$35Q,n.get_$1Y()),_u.Strings.l_ConfirmDialog_Save_Text,_u.Strings.l_SaveConfirmDialogButtonDescription_Text));t.$H(new _a.$2E(new _C(n.$$d_$3U0,n.get_$1Y()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$H(new _a.$2E(new _C(n.$$d_$3cW,n.get_$1Y()),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$4lN(t)}}function $4OI(n){var t=n.$16;t.$f.set_$mW(!0);var i=t.$3S(2);i.get_$3L().$2Jx(t.$f,!1)}function $6P4(n,t,i){if(t.get_$2BF())return null;var r=new(_0365f.$s.$$(_y.$2j));var u=i.$3S(15);var o=i.$3S(22);if(u){u.$13U.$2K&&r.$H(new _y.$2j(_u.Strings.l_NewPhotoSubmenuItemText_Text,u.$13U));u.$13V.$2K&&r.$H(new _y.$2j(_u.Strings.l_PhotoFromGallerySubmenuItemText_Text,u.$13V))}else if(o)r.$H(new _y.$2j(_u.Strings.l_AttachmentSubmenuItem_LowerCase_Text,o.$3zI));else{var h=i.$3S(5);var f=h.$7I1();if(f&&f.length>0)for(var s=f,c=s.length,e=0;e<c;++e){var l=s[e];r.$H(l)}}var a=i.$3S(12);r.$H(new _y.$2j(_u.Strings.l_SignatureMenuItem_LowerCase_Text,a.$3Ki));return new _y.$2f(_y.$c.get_$1fl(),_y.$c.get_$6to(),_u.Strings.l_IncludeMenuButtonText_Text,null,r.get_$3T())}_d.$FO.prototype={$4a:null,$qR:null,$y2:!1,$87:null,$3fF:!1,get_$4lN:function(){return this.$qR},set_$4lN:function(n){if(n!==this.$qR){this.$qR=n;$Q(this,"CloseConfirmDialogButtonData")}return n},get_$1Tj:function(){return this.$y2},set_$1Tj:function(n){if(n!==this.$y2){this.$y2=n;$Q(this,"IsCloseConfirmDialogShown")}return n},get_$7Xa:function(){return this.$3fF},set_$7Xa:function(n){if(n!==this.$3fF){this.$3fF=n;$Q(this,"IsAppBarSetup")}return n},$906:function(){var i=this.$16;var u=i.$f.$j;_js.Trace.logInfo(_a.$0.$d,"Setup appbar menu. Context: "+u.toString());var n=new(_0365f.$s.$$(_y.$2j));var t=i.$3S(1);_g.$S.get_$L().get_$1t().get_$1OQ()?n.$H(t.get_$3cU()):n.$H(t.get_$495());if(u.get_$2E5())if(_g.$S.get_$L().get_$1t().get_$1Cd()){n.$H(t.get_$2ju());t.$1Uf=!1}else{n.$H(t.get_$1ya());t.$1Uf=!0}else t.$1Uf=!1;n.$H(new _y.$2j(_u.Strings.l_CheckNamesMenuItem_LowerCase_Text,t.$11A));var f=i.$3S(6);n.$H(f.$YG);var r=i.$3S(3);if(r.$YG&&r.$3Ol()){n.$H(r.$YG);r.$1U1=!0}else r.$1U1=!1;var e=i.$3S(10);n.$H(new _y.$2j(_u.Strings.l_ShowMessageOptions_Text,e.$1yg));i.$f.$3t.set_$XL(n.get_$3T());this.set_$7Xa(!0)},$3v:function(){var n=this.$16;var t=n.$f;var i=t.$j;_js.Trace.logInfo(_a.$0.$d,"InitTouchComponent:Context:"+i.toString());if(!t.$3t){var r=n.$3S(24);$6P3(this)}n.$3S(23);_d.$9c.prototype.$3v.call(this)},$2Ao:function(n,t){if(this.$16.$f.$bk)return!1;else if($3F9(this)){this.$y2||this.$61R();return!0}else if(this.$16.$f.$j.get_$mb()&&!$4OH(this)){_js.Trace.logInfo(_a.$0.$d,"Removing unedited reply forward draft if user clicks outside the form.");this.$3U0();return!0}else{this.$16.$f.set_$mW(!0);var r=this.$16;var i=r.$3S(2);i&&i.get_$3L()&&i.get_$3L().set_$2nP(!0);return!1}},$61R:function(){var t=this.$16;var i=t.$f;var n=i.$j;_js.Trace.logInfo(_a.$0.$d,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if($4OH(this)){_js.Trace.logInfo(_a.$0.$d,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if($3F9(this)){$6P5(this);_js.Trace.logInfo(_a.$0.$d,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$1Tj(!0)}else if(n.get_$mb()){_js.Trace.logInfo(_a.$0.$d,"Removing unedited reply forward draft on close.");this.$3U0()}else{_js.Trace.logInfo(_a.$0.$d,"Navigate away due to unmodified message.");$4OI(this)}},$3cW:function(){_js.Trace.logInfo(_a.$0.$d,"Hide close confirm dialog");this.set_$1Tj(!1)},$35Q:function(){_js.Trace.logInfo(_a.$0.$d,"User select save and close");var n=this.$16;n.$f.set_$mW(!0);this.$3cW();var t=n.$3S(8);t.$4Fj(this.$$d_$5wR)},$5wR:function(n){$4OI(this)},$3U0:function(){_js.Trace.logInfo(_a.$0.$d,"User select discard and close");var n=this.$16;n.$f.set_$mW(!0);this.$3cW();var t=n.$3S(21);t.$3Up()}};_d.$Gm=function(n,t){this.$$d_$8hb=Function.createDelegate(this,this.$8hb);this.$$d_$6xj=Function.createDelegate(this,this.$6xj);this.$$d_$4m6=Function.createDelegate(this,this.$4m6);_d.$Gm.initializeBase(this,[13,n]);this.$FG=this.$16.$f.$FG;this.$1K=t};function $6P7(n,t,i){for(var r=t.indexOf("<body");r<t.length&&t.charAt(r++)!==">";);t=t.substring(0,r)+i+t.substring(r,t.length);return t}function $6P6(n,t){t.$3iS()&&n.$16.$f.$z.$2r(3050)}function $3FL(n,t){t.$5c(3440);t.$2r(3440,null);_d.$4I.$D6(n.$16)}function $4OJ(n,t){var r=n.$16.$f.$j;var i=new(_a.$U.$$(_g.Attachment));var u=this;t.$Bx(function(n){if(_g.$5q.isInstanceOfType(n)){var t=n;if(t.get_$8Y()){i.$H(t);return}if(r.get_$4D()===3){i.$H(t);return}}});return i.get_$F()>0?i.get_$9JV():null}_d.$Gm.prototype={$FG:null,$1K:null,$5FY:null,$1NE:null,$6uR:function(){_a.$5.stPT(_a.$0.$d,"MailComposeUpgrade",3);this.$1NE=_a.$5.$1V(_a.$0.$d,"MailComposeUpgrade",!0);var i=this.$16.$f;var n=i.$j;var r=n.get_$6u();this.$5FY=r;var u=this;_js.$K.get_$L().$21(_a.$0.$d,"ShowUpgradeMessage",function(){n.get_$EC()||n.get_$1BY()||r!==u.$5FY||$3FL(u,i.$z)},5e3);var f;f=this.$1K.get_$A0()||n.get_$45()!=="HTML"?n.get_$45()==="Text"?_h.$11.get_$2qh():_h.$11.get_$1pi():_h.$11.get_$7gJ();var t=_d.$9v.$75o(n,f,this.$1K);n.get_$4D()===12&&(t.$jo=new _g.$Bn(new _g.$7o("internalsubmission")));t.add_$45B(this.$$d_$4m6);_js.Trace.logInfo(_a.$0.$ZN,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$9R()&&n.get_$9R().get_$22()&&_g.$g.$1i?_g.$g.$1i.idToName(n.get_$9R().get_$22()):"null"));t.$DX="MailComposeUpgrade";i.$p.$k7(t,this.$$d_$6xj,this.$$d_$8hb,null)},$6xj:function(n){var o=this.$16;var e=o.$f;var i=e.$j;var t=n;var c=o.$3S(21);var u=t.$5J;var r=n.$5I;var s=t.get_$4dL()?t.get_$4dL().correlationId:null;var l=!!t.$CW;if(this.$FG.$eh(r)){_js.Trace.logInfo(_a.$0.$ZN,"Check upgrade callback, resume discard for context "+r);c.$350(r,u)}else if(r===i.get_$6u()){i.set_$9J(u);_js.Trace.logInfo(_a.$0.$ZN,"Context match, updated the draft id. Context:"+i.toString()+"; ResponseMessageBodyType="+(l&&t.$CW.get_$3c()?t.$CW.get_$3c().get_$45():"null"));var f=e.get_$1LR();var h=e.get_$1AT();if(!f.$Cf&&h.$K8){_js.Trace.logInfo(_a.$0.$ZN,"Skipping upgrade for contextId "+r+" since send was triggered during upgrade");_a.$5.$1G(this.$1NE,null,"",s);_a.$5.endPT("MailComposeUpgrade");h.$2Op();return}if(f.$Cf&&f.$1bZ){_js.Trace.logInfo(_a.$0.$ZN,"Skipping upgrade for contextId "+r+" since save and then send was triggered during upgrade");_a.$5.$1G(this.$1NE,null,"",s);_a.$5.endPT("MailComposeUpgrade");f.$352();return}}if(t.$CW){_js.Trace.logInfo(_a.$0.$ZN,"Check upgrade, action has response message, call complete upgrade. context: "+i.toString()+"; ActionItemId="+_h.$Cn.$rV(u));this.$4m6(n)}else n.$5I===i.get_$6u()&&_js.Trace.logInfo(_a.$0.$ZN,"Check upgrade: action has id only, updated draft id. context: "+i.toString()+"; ActionItemId="+_h.$Cn.$rV(u))},$4m6:function(n){var g=this.$16;var r=g.$f;var t=r.$j;var i=n;var nt=i.get_$4dL()?i.get_$4dL().correlationId:null;var h=n.$5I;i.remove_$45B(this.$$d_$4m6);if(h===t.get_$6u()){var c=!1;if(this.$1K.get_$A0()){if(t.get_$H3()){t.$HB.$s();t.get_$Cx()===t.get_$H3().get_$Cx()&&(c=!0)}else t.$3w9=!0;t.$2lx=!0}t.get_$9R().get_$k3()===-1&&t.get_$9R().set_$k3(t.get_$k3());!t.get_$1yz()&&t.get_$9R().$Tm&&t.set_$1yz(t.get_$9R().$Tm.get_$1d());var e;var l,a;(a=_a.$1A.$16e(t.get_$4A3(),l={val:e}),e=l.val,a)&&r.$z.$1fI(e);if(t.get_$1yz()){var u=i.$CW.get_$3c().get_$1d();u=u.substring(u.indexOf("<body")+5,u.lastIndexOf("body>"));u="<div"+u+"div>";var v=$(u);var tt=v.find("hr:first").clone();var it=v.find("#divRplyFwdMsg, #x_divRplyFwdMsg, div[dir]:first").clone();var rt=$("<div>").append(tt).append(it).html();t.set_$10z($6P7(this,t.get_$1yz(),rt))}else if(this.$1K.get_$A0()||t.get_$45()!=="HTML"){var y=i.$CW.get_$3c().get_$1d();t.set_$10z(!this.$1K.get_$A0()&&t.get_$45()==="Text"?_a.$1T.$720(y):y)}else t.set_$10z(i.$CW.get_$I3().get_$1d());if(c){t.$HB.$s();t.get_$H3().set_$Cx(t.get_$Cx());var ut=t.$Sl;ut&&t.$Sl.set_$Cx(t.get_$Cx())}t.set_$Qq(i.$CW);t.$9Dz(i.$CW.get_$6A());if(!t.get_$9R().get_$Pm()&&i.$CW.get_$1e())t.set_$85(i.$CW.get_$1e().get_$9JV());else if(t.get_$9R().$Tl)t.set_$85($4OJ(this,t.get_$9R().$Tl));else if(t.get_$38d()&&!_y.$j.$g.get_$6Q()){for(var f=new(_a.$U.$$(_g.Attachment)),ft=JsonParser.deserialize(t.get_$38d()),p=ft,et=p.length,o=0;o<et;++o){var s=p[o];if(s.__type.startsWith("FileAttachment")){var w=new _g.$5q(s);w.$GA=!0;f.$H(w)}else{var b=new _g.$DA(s);b.$GA=!0;f.$H(b)}}t.get_$9R().$Tl=f;t.set_$85($4OJ(this,f))}var ot=r.get_$YI();ot.$9Fh();$4Nj(this,t.get_$9R().get_$k3());t.set_$EC(!0);r.$z.$5c(3440);$6P6(this,t);_d.$4I.$D6(this.$16);_js.Trace.logInfo(_a.$0.$ZN,"Complete upgrade context:"+t.toString());var k=r.get_$1LR();if(k.$Cf)k.$352();else if(_a.$5a.$2x){var d=this.$16.$3S(25);var st=this;_js.$K.get_$L().$3i(_a.$0.$d,"TriggerPolicyTipsIfNeeded",function(){d&&d.$1BL(32)})}r.$S.$8oV(_d.$mI,new _d.$mI(t.get_$Qq().get_$i().Id,r))}else _js.Trace.logInfo(_a.$0.$ZN,"MailComposeUpgrade failed since user switched view model context. ContextId="+h+"; Context="+t.toString());_a.$5.$1G(this.$1NE,null,"",nt);_a.$5.endPT("MailComposeUpgrade")},$8hb:function(n){var o=this.$16;var i=o.$f;var r=i.$j;var h=o.$3S(21);var f=n;var u=f.get_$4dL()?f.get_$4dL().correlationId:null;var t=n.$5I;if(this.$FG.$eh(t)){_js.Trace.logInfo(_a.$0.$ZN,"Resume discard for context "+t);h.$350(t,f.$5J)}else if(t===r.get_$6u()){r.set_$1BY(!0);var e=i.get_$1LR();var s=i.get_$1AT();if(e.$Cf){if(e.$1bZ){_js.Trace.logInfo(_a.$0.$ZN,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");_a.$5.$1G(this.$1NE,null,"Skipped upgrade since save and then send was triggered during upgrade",u);_a.$5.endPT("MailComposeUpgrade");e.$352();return}$3FL(this,i.$z)}else if(s.$K8){_js.Trace.logInfo(_a.$0.$ZN,"Skipping upgrade for context "+t+" since send was triggered during upgrade");_a.$5.$1G(this.$1NE,null,"Skipped upgrade since send was triggered during upgrade",u);_a.$5.endPT("MailComposeUpgrade");s.$2Op();return}else $3FL(this,i.$z)}if($8(n.$1b)||_js.$8.$14(n.$1b.message)){_js.Trace.logWarning(_a.$0.$ZN,"Upgrade failed since the upgrade action failed without server error. ContextId="+t+"; Context="+r.toString());_a.$5.$1G(this.$1NE,null,"Upgrade action failed without server error",u)}else{_js.Trace.logWarning(_a.$0.$ZN,"Upgrade failed since the upgrade action failed with server error "+n.$1b.message+". ContextId="+t+"; Context="+r.toString());_a.$5.$1G(this.$1NE,null,"Upgrade action failed with server error:"+n.$1b.message,u)}_a.$5.endPT("MailComposeUpgrade")}};_d.$13J=function(n,t,i,r,u){this.$$d_$8a6=Function.createDelegate(this,this.$8a6);this.$$d_$9BK=Function.createDelegate(this,this.$9BK);_d.$13J.initializeBase(this,[19,n]);this.$z=r;this.$2Ft=new _d.$3w(t,i,n.$f.$z,u);this.$2Ft.set_$3yP(this.$$d_$8a6)};_d.$13J.prototype={$z:null,$2Ft:null,$8a6:function(){_d.$4I.$D6(this.$16)},$3v:function(){this.$2Ft.$3v();_d.$9c.prototype.$3v.call(this)},$39O:function(){_js.Trace.logInfo(_a.$0.$d,"Prepares to submit mailtips action");this.$2Ft.$39O()},$9BK:function(){var t=this.$16;var i=t.$f;var n=i.$j;if(n.get_$2Dy()){this.$z.$5c(4400);this.$z.$2r(4400);_d.$4I.$D6(this.$16)}if(n.get_$4D()&&n.get_$4D()!==3&&n.get_$4D()!==11){this.get_$CL()||this.$3v();this.$39O()}},$5t1:function(){this.$2Ft.$5t1()}};_d.$ac=function(n,t,i){this.$$d_$5k4=Function.createDelegate(this,this.$5k4);this.$$d_$5k3=Function.createDelegate(this,this.$5k3);this.$$d_$5k1=Function.createDelegate(this,this.$5k1);this.$$d_$8cl=Function.createDelegate(this,this.$8cl);_d.$ac.initializeBase(this,[25,n]);if(_a.$5a.$2x){this.$z=i;this.$TW=new _d.$3T(t,this.$16.$3S(1),this.$16.$3S(5),n.$f.$z,this.$16.$f.$G);this.$TW.set_$3yj(this.$$d_$8cl);this.$TW.set_$306(this.$$d_$5k1);this.$TW.set_$305(this.$$d_$5k3);this.$TW.set_$5k5(this.$$d_$5k4)}};function $4O5(n){n.get_$CL()||n.$3v();return n.$TW?n.$TW.$2hP():0}_d.$ac.prototype={$1Uv:null,$z:null,$TW:null,$3v:function(){if(!_a.$5a.$2x){_d.$9c.prototype.$3v.call(this);return}this.$TW.$3v();_d.$9c.prototype.$3v.call(this)},$59:function(){_js.$9.prototype.$59.call(this);this.$1Uv&&(this.$1Uv=_js.$K.get_$L().$5G(this.$1Uv))},$7cK:function(){if(!_a.$5a.$2x)return!1;switch($4O5(this)){case 1:return!1;case 2:case 3:return $8(this.$16.$f.$j.get_$Sc())&&$8(this.$16.$f.$j.get_$Qo());case 4:case 5:return $8(this.$16.$f.$j.get_$Qo());default:return!1}},$7Nz:function(){if(!_a.$5a.$2x)return"";switch($4O5(this)){case 2:case 3:return _u.Strings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _u.Strings.l_PolicyTipsBlockSend_Text;default:return""}},$8z4:function(){if(_a.$5a.$2x){this.$TW.$5Jd=!0;if(!$8(this.$16.$f.$j.get_$Sc())){var n=_a.$5.$1V(_a.$0.$HT,"DlpPolicyTipOverridden",!0);_a.$5.$1G(n,"DlpPolicyTipOverridden","",null)}}},$1BL:function(n){if(_a.$5a.$2x){var r=this.$16;var u=r.$f;var i=u.$j;this.get_$CL()||this.$3v();this.$1Uv&&(this.$1Uv=_js.$K.get_$L().$5G(this.$1Uv));var t=i.get_$9J();if(t){_bc.$BG.$1mw(t)&&(t=_g.$1Q.$g.$lw(t));if(_bc.$BG.$1mw(t)){var f=this;this.$1Uv=_js.$K.get_$L().$21(_a.$0.$HT,"TriggerPolicyTipsIfNeeded",function(){f.$1BL(n)},5e3)}else this.$2Qv(i,n)}}},$2Qv:function(n,t){_js.Trace.logInfo(_a.$0.$d,"Prepares to submit policyTips action");var r;var u;if(n.get_$H3()){r=_a.$3m.$1kj(n.get_$H3().get_$2h());u=_a.$3m.$1kj(n.get_$H3().get_$Cx())}else{r=_a.$3m.$1kj(n.get_$2h());u=_a.$3m.$1kj(n.get_$Cx())}var i=n.get_$9J();_bc.$BG.$1mw(i)&&(i=_g.$1Q.$g.$lw(i));this.$TW.$2Qv(i,n.get_$85(),r,u,t)},$8cl:function(){_d.$4I.$D6(this.$16)},$5k1:function(n){var t=this.$16;var i=t.$f;var r=i.$j;r.set_$Sc(n)},$5k3:function(n){var t=this.$16;var i=t.$f;var r=i.$j;r.set_$Qo(n)},$5k4:function(){this.$1BL(64)}};_d.$EF=function(n,t){this.$$d_$7G9=Function.createDelegate(this,this.$7G9);this.$$d_$4g4=Function.createDelegate(this,this.$4g4);_d.$EF.initializeBase(this,[24,n]);this.$1lE=!1;this.$7e=t.$4ov(this,this.$$d_$4g4)};function $2U3(n,t){var i=n.$16.$3S(27);i.set_$Se(t)}function $4Nx(n,t,i,r){var u=$4Nw(n,t);r&&u.$Ar();var e=i.get_$F();if(e+u.$1L.get_$F()>100)return!1;t===2&&n.$16.$f.get_$Nj().$37S.$s();for(var f=0;f<e;f++){var o=i.get_$48(f);u.$237(o)}return!0}function $6On(n){var t=n.$16.$3S(14);t&&t.$Xj()}function $4Nw(n,t){var i=n.$16.$f.get_$Nj();return t?t===1?i.$A9.$44:t===2?i.$A8.$44:null:i.$A4.$44}_d.$EF.prototype={$1lE:!1,$7e:null,$3v:function(){if(!this.get_$CL()){var n=this.$16.$f.$S;n.$HX(_a.$Tq,this.$$d_$7G9);this.$7e.$5F()}_d.$9c.prototype.$3v.call(this)},$Ar:function(){if(this.get_$CL()){this.$7e.$6e();var n=this.$16.$f.$S;n.$12Z(_a.$Tq,this.$$d_$7G9)}_d.$9c.prototype.$Ar.call(this)},$2hU:function(){return this.$16.$f.$j.get_$45()},$xY:function(){return this.$16.$f.$j.get_$2h()},$8zp:function(n){this.$16.$f.$j.set_$2h(n)},$7NA:function(n){var t=$4Nw(this,n);return t.$1L},$9BQ:function(n,t){return $4Nx(this,n,t,!1)},$8zY:function(n,t){$4Nx(this,n,t,!0)},$4dw:function(n,t){t.val=0;if(!this.$16.$f.$j.get_$EC()){_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$16.$3S(5);var u=_y.$AZ.$3RT(n);if(r.get_$5o()){var i=new(_0365f.$s.$$(_y.$lQ));r.get_$5o().$235(u,i);if(!i.get_$F()){_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$48(0)}else{_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - max number exceeded.");t.val=9001;return null}},$4dn:function(n,t,i){i.val=0;if(!this.$16.$f.$j.get_$EC()){_js.Trace.logInfo(_a.$0.$5g,"Attachment not added - well not upgraded.");i.val=9005;return null}var u=this.$16.$3S(5);var r=u.get_$5o();if(r){var f=new _d.$vM(n,t);return r.$4do(f)}else{i.val=15;return null}},$3ZK:function(){return this.$16.$f.$j.get_$3E()?this.$16.$f.$j.get_$3E().Id:null},$7WE:function(n){var t=new _d.$lq(n,!0);$2U3(this,t)},$8mD:function(n){var t=new _d.$nV(n);$2U3(this,t)},$2A6:function(){return this.$16.$f.$j.get_$9J()?this.$16.$f.$j.get_$9J().Id:null},$50A:function(){this.$16.$f.$j.get_$UM()||this.$16.$f.$j.set_$UM(new _js.$X);return this.$16.$f.$j.get_$UM()},$96r:function(){var n=new _y.$XH(null);$2U3(this,n)},$6xP:function(n){var t=new _y.$XH(n);$2U3(this,t)},$7G9:function(n){if(this.$1lE){this.$1lE=!1;this.$7e.$3cS(!1)}},$4g4:function(n){if(n===1){var t=window.document.body.clientWidth;if(t<1367){var i=this.$16.$f.$S;i.$8oV(_a.$aa,new _a.$aa(!0));this.$1lE=!0}}else if(n===2&&this.$1lE){var r=this.$16.$f.$S;r.$8oV(_a.$aa,new _a.$aa(!1));this.$1lE=!1}$6On(this)}};_d.$Gv=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$7Tg=Function.createDelegate(this,this.$7Tg);this.$$d_$3yd=Function.createDelegate(this,this.$3yd);this.$$d_$8hK=Function.createDelegate(this,this.$8hK);this.$$d_$8bj=Function.createDelegate(this,this.$8bj);this.$$d_$8VD=Function.createDelegate(this,this.$8VD);this.$$d_$8aj=Function.createDelegate(this,this.$8aj);this.$$d_$8WE=Function.createDelegate(this,this.$8WE);this.$$d_$8ZN=Function.createDelegate(this,this.$8ZN);this.$$d_$5gV=Function.createDelegate(this,this.$5gV);this.$$d_$2L3=Function.createDelegate(this,this.$2L3);this.$2Z3=_u.Strings.l_PolicyTipsBlock_Text;this.$2ym=_u.Strings.l_PolicyTipsNotify_Text;this.$31E=_u.Strings.l_PolicyTipsOverride_Text;_d.$Gv.initializeBase(this,[n,o,5]);this.$an=t;this.$G=h;this.$1L=i;this.$1L.add_$1Z(this.$$d_$2L3);this.$l2=r;this.$l2.add_$1Z(this.$$d_$5gV);this.$5tA=u;this.$1v8=f;this.$1wi=e;this.$QF=new _d.$hW(this.$G,this.$$d_$8ZN,this.$$d_$8WE,r);this.$1iv=new _d.$hW(this.$G,this.$$d_$8ZN,this.$$d_$8WE,r);this.$5dU=new _C(this.$$d_$8aj,_a.$0.$HT);this.$4sG=new _C(this.$$d_$8VD,_a.$0.$HT);this.$2LQ=new _C(this.$$d_$8bj,_a.$0.$HT);this.$68H=s;this.$68J=new _C(this.$$d_$8hK,_a.$0.$HT);this.$y6=!1;this.set_$1HH(!0);this.$69I();this.$G.get_$O()==="TouchNarrow"?$4PB(this):this.$41q=new _d.$hV(this.$$d_$3yd,this.$$d_$8WE)};function $6RM(n){for(var i="",t=0;t<n.$1L.get_$F();t++){i+=n.$1L.get_$48(t).get_$1l()||n.$1L.get_$48(t).get_$WA();t<n.$1L.get_$F()-1&&(i+=_u.Strings.l_MessageNameSeparator_Text)}return i}function $6RL(n){return n.$1L.get_$F()===1?_u.Strings.l_PolicyTipsRecipientInfo_Text:_u.Strings.l_PolicyTipsRecipientsInfo_Text}function $4PB(n){_js.Trace.logInfo(_a.$0.$HT,"Create policy tips more info dialog.");var t=new _js.$X;n.$1Q8&&t.$H(new _a.$2E(new _C(n.$$d_$8ZN,_a.$0.$HT),_u.Strings.l_PolicyTipsDialogLearnMoreButtonCaption_Text,_u.Strings.l_PolicyTipsDialogLearnMoreButtonDescription_Text));t.$H(new _a.$2E(new _C(n.$$d_$8WE,_a.$0.$HT),_u.Strings.l_PolicyTipsDialogReportButtonCaption_Text,_u.Strings.l_PolicyTipsDialogReportButtonDescription_Text));t.$H(new _a.$2E(new _C(n.$$d_$7Tg,_a.$0.$HT),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_PolicyTipsDialogCancelButtonDescription_Text));n.set_$8Of(t)}_d.$Gv.prototype={$5dU:null,$4sG:null,$2LQ:null,$68J:null,$G:null,$1L:null,$68H:null,$2nK:!1,$2xd:null,$QF:null,$1iv:null,$1Ky:null,$5tA:null,$16X:!1,$yL:!1,$1v8:null,$1wi:null,$2nL:!1,$2nd:!1,$an:0,$5mV:null,$41q:null,$1Q8:null,$l2:null,$b6:null,get_$6ug:function(){return this.$2Z3},set_$6ug:function(n){this.$2Z3=n;this.$69I();return n},get_$8QN:function(){return this.$2ym},set_$8QN:function(n){this.$2ym=n;this.$69I();return n},get_$8im:function(){return this.$31E},set_$8im:function(n){this.$31E=n;this.$69I();return n},get_$6pY:function(){return this.$an},set_$6pY:function(n){if(this.$an!==n){this.$an=n;this.$69I()}return n},get_$2nc:function(){return this.$16X},set_$2nc:function(n){if(this.$16X!==n){this.$16X=n;this.$1v8&&this.$1v8(this.$16X?this.$5mV:null)}return n},get_$3iU:function(){return this.$yL},set_$3iU:function(n){if(this.$yL!==n){this.$yL=n;this.$1wi&&this.$1wi(this.$yL?"":null);$6(this,"IsReportedFalsePositive")}return n},get_$7ak:function(){return this.$2nL},set_$7ak:function(n){if(this.$2nL!==n){this.$2nL=n;$6(this,"IsMoreInfoLinkHidden")}return n},get_$7Y6:function(){return this.$G.get_$O()!=="TouchNarrow"},get_$7bI:function(){return this.$2nd},set_$7bI:function(n){if(this.$2nd!==n){this.$2nd=n;$6(this,"IsOverrideLinkHidden")}return n},get_$O6:function(){return this.$b6},set_$O6:function(n){if(this.$b6!==n){this.$b6=n;$6(this,"ClassificationDescription")}return n},$5gV:function(n,t){for(var r="",i=0;i<this.$l2.get_$F();i++){var u=this.$l2.get_$48(i);r+=String.format("{0}<br>",u)}this.set_$O6(r)},get_$1Ug:function(){return _d.$1Dv.prototype.get_$1Ug.call(this)},set_$1Ug:function(n){_d.$1Dv.prototype.set_$1Ug.call(this,this.$16X||this.$yL||n);return n},$8xe:function(n){this.$1Q8=n;this.$QF.set_$4m8(n);this.$1iv.set_$4m8(n);this.$69I();$4PB(this)},$59:function(){this.$1L&&this.$1L.remove_$1Z(this.$$d_$2L3);this.$l2&&this.$l2.remove_$1Z(this.$$d_$5gV);_a.$1.prototype.$59.call(this)},$7YW:function(){return(!!this.$1L&&this.$1L.get_$F()>0&&this.$an!==1||this.$an===2||this.$an===3||this.$G.get_$O()==="TouchNarrow")&&!this.$16X&&!this.$yL},$69I:function(){_d.$1Dv.prototype.$69I.call(this);this.set_$7ak(!this.get_$1Ug());this.set_$7bI(this.get_$1Ug()||this.$an===1||this.$an===4||this.$an===5);if(this.$1Ky&&this.$an===1){this.$Md.$3Q(this.$1Ky);this.$1Ky=null}$6b(this,"MessageUpdated")},$7HA:function(){},$7HJ:function(){if(this.$16X||this.$yL)this.$yL?this.set_$ms(_u.Strings.l_PolicyTipsFalsePositive_Text):this.$16X&&this.set_$ms(this.$31E);else switch(this.$an){case 1:this.set_$ms(this.$2ym);break;case 2:case 3:case 4:case 5:this.set_$ms(this.$2Z3);break}},$8aj:function(){this.$G.get_$O()==="TouchNarrow"?this.set_$2Db(!0):this.$QF.set_$1X(!this.$QF.$2R)},$8VD:function(){this.$G.get_$O()==="TouchNarrow"?this.set_$2Db(!0):this.$1iv.set_$1X(!this.$1iv.$2R)},$8bj:function(){this.$an===2||this.$G.get_$O()==="TouchNarrow"?this.$3yd(""):this.$41q.set_$1X(!0)},$3yd:function(n){this.$5mV=n;this.set_$2nc(!0);this.set_$Gi(!0);this.$69I()},$8hK:function(){this.set_$3iU(!1);this.$69I();this.$68H()},$8WE:function(){this.$QF.set_$1X(!1);this.$1iv.set_$1X(!1);this.set_$2Db(!1);this.set_$3iU(!0);this.set_$Gi(!0);this.$69I()},$2L3:function(n,t){if(this.$1Ky){this.$Md.$3Q(this.$1Ky);this.$1Ky=null}if(this.$1L.get_$F()>0&&this.$an!==1){this.$1Ky=new _d.$nR($6RM(this),"",$6RL(this),"",this.$5tA,this.$1L.get_$F()>1,!1);this.$Md.$H(this.$1Ky)}this.$69I();$6b(this,"MessageUpdated")},get_$2Db:function(){return this.$2nK},set_$2Db:function(n){if(this.$2nK!==n){this.$2nK=n;$6(this,"IsMoreInfoDialogShown")}return n},get_$8Of:function(){return this.$2xd},set_$8Of:function(n){if(n!==this.$2xd){this.$2xd=n;$6(this,"MoreInfoDialogButtonData")}return n},$7Tg:function(){_js.Trace.logInfo(_a.$0.$HT,"Hide more info dialog");this.set_$2Db(!1)},$8ZN:function(){this.$1Q8&&window.open(this.$1Q8,"_blank","width=800,height=700,toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes")}};_d.$hV=function(n,t){this.$$d_$2zG=Function.createDelegate(this,this.$2zG);this.$$d_$3yd=Function.createDelegate(this,this.$3yd);_d.$hV.initializeBase(this);this.$1v8=n;this.$1wi=t;this.$2LQ=new _C(this.$$d_$3yd,_a.$0.$HT);this.$79=new _C(this.$$d_$2zG,_a.$0.$HT);this.set_$Cu(this);var i=new _js.$X;i.$H(new _a.$2E(this.$2LQ,_u.Strings.l_PolicyTipsOverrideButtonCaption_Text));i.$H(new _a.$2E(this.$79,_u.Strings.l_CancelButtonLabel_LowerCase_Text));this.set_$OO(i);this.set_$5mW(1);this.set_$2Eo("")};_d.$hV.prototype={$2LQ:null,$79:null,$1v8:null,$1wi:null,$2En:null,$1v9:0,get_$5mW:function(){return this.$1v9},set_$5mW:function(n){if(this.$1v9!==n){this.$1v9=n;$6(this,"OverrideType")}return n},get_$2Eo:function(){return this.$2En},set_$2Eo:function(n){this.$2En=n;$6(this,"Justification");return n},$3yd:function(){if(this.$1v9===1&&this.$1v8&&!_js.$8.$c(this.$2En)){this.$1v8(this.$2En);this.set_$2Eo("");this.$4a.$s()}if(this.$1v9===2&&this.$1wi){this.$1wi();this.set_$2Eo("");this.$4a.$s()}},$2zG:function(){this.set_$2Eo("");this.$4a.$s()}};_d.$hW=function(n,t,i,r){this.$$d_$5gV=Function.createDelegate(this,this.$5gV);_d.$hW.initializeBase(this);this.$G=n;this.$1pI=new _C(t,_a.$0.$HT);this.$5te=new _C(i,_a.$0.$HT);this.$l2=r;this.$l2.add_$1Z(this.$$d_$5gV)};_d.$hW.prototype={$G:null,$1pI:null,$5te:null,$l2:null,$2R:!1,$b6:null,$1Q8:null,get_$1X:function(){return this.$2R},set_$1X:function(n){if(this.$2R===n)return n;this.$2R=n;$6(this,"IsShown");return n},get_$O6:function(){return this.$b6},set_$O6:function(n){if(this.$b6===n)return n;this.$b6=n;$6(this,"ClassificationDescription");return n},get_$5In:function(){return 420},get_$zw:function(){return 320},get_$59e:function(){return this.$G.get_$O()!=="TouchNarrow"},get_$4m8:function(){return this.$1Q8},set_$4m8:function(n){this.$1Q8=n;$6(this,"ComplianceUrl");return n},$59:function(){this.$l2&&this.$l2.remove_$1Z(this.$$d_$5gV);_a.$1.prototype.$59.call(this)},$5gV:function(n,t){for(var i="<ul>",r=0;r<this.$l2.get_$F();r++){var u=this.$l2.get_$48(r);i+=String.format("<li>{0}</li>",u)}i+="</ul>";this.set_$O6(i)}};_d.$nR=function(n,t,i,r,u,f,e){_d.$nR.initializeBase(this,[n,t,i,r,e]);u&&(this.$5tB=new _C(u,_a.$0.$HT));this.$5Bi=f};_d.$nR.prototype={$5tB:null,$5Bi:!1,get_$8r7:function(){return this.$5Bi?_u.Strings.l_MessageRemoveAll_Text:_u.Strings.l_MessageRemoveRecipient_Text}};_d.$9v=function(){};_d.$9v.$3RE=function(n,t,i){var r=n.$j;var u=r.get_$4D();var s=3===u||2===u||1===u;var h=i.get_$A0()&&r.get_$EC();var f=null;if(s&&!h){_js.Trace.logInfo(_a.$0.$d,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$j.$g.get_$O()+"; disposition="+t);var c=r.$1E6();var o=_d.$9v.$3S9(r,c,i);o.$HJ=t;o.$24T=r.$3ao(100);f=o}else if(r.get_$3ic()){_js.Trace.logInfo(_a.$0.$d,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);f=_d.$9v.$76b(t,r,i)}else if(8===r.get_$4D()){_js.Trace.logInfo(_a.$0.$d,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);f=_d.$9v.$7HK(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$d,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);f=_d.$9v.$3Ys(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$d,"CreateComposeAction: ApprovalRequestAction");f=_d.$9v.$7H6(r,t,i)}else{_js.Trace.logInfo(_a.$0.$d,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var e=null;if(u===11||u===12){e=new _h.$35(r.$3S2(),r.get_$1ZC());e.$HJ=0}else{e=new _h.$35(r.$1E6(),null);e.$HJ=t}e.$1Dd=!i.get_$A0();$8(r.get_$Ms())||(e.$l8=r.get_$Ms());e.$24T=r.$3ao(100);f=e}f.$5I=r.get_$6u();return f};_d.$9v.$3Rb=function(n,t,i){var r=new _c.$108(200,n);r.$Lw=t||_h.$11.get_$1pi();r.$Qa=$8(i)?"MailCompose":i;return r};_d.$9v.$73b=function(n,t){var i=t?"HardDelete":"MoveToDeletedItems";return new _h.$yJ([n],i,2)};_d.$9v.$7H6=function(n,t,i){var u=n.get_$9R();var r=new _c.$Xd(u,n.$1E6(),n.get_$4D()===9,t);r.$1Dd=!i.get_$A0();return r};_d.$9v.$75o=function(n,t,i){var u=null;u=n.get_$f3()?n.$3S2(!0):n.$1E6(!0);var r=_d.$9v.$3S9(n,u,i);r.$Lw=t;r.$Qa=!i.get_$A0()&&n.get_$45()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$200=_g.$S.get_$L().get_$1t().get_$dB();return r};_d.$9v.$7HK=function(n,t){var i=new _c.$ex(n.get_$Zs(),1);i.$EZ=n.$1E6();n.get_$Ms()&&(i.$l8=n.get_$Ms());return i};_d.$9v.$3S9=function(n,t,i){var u=n.get_$mY()?new _h.$78(n.get_$Zs()):n.get_$Zs();var r=null;r=new _h.$CI(_d.$9v.$3ah(n.get_$4D()),u,i);r.set_$4i(t);r.$2NF=n.get_$311();r.$1Dd=!i.get_$A0();n.get_$Ms()&&(r.$l8=n.get_$Ms());r.$Be_7=n.get_$3E();r.$VR=n.get_$1vJ();r.$5I=n.get_$6u();n.get_$9R()&&_g.$7f.isInstanceOfType(n.get_$9R())&&n.get_$9R().get_$Eg()&&(r.$2nw=!0);switch(n.get_$4D()){case 1:case 2:r.$39K=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$39K=_u.Strings.l_ForwardPrefix_Text;break}return r};_d.$9v.$3Ys=function(n,t){return _d.$24.$3Ys(n.get_$9R(),_d.$24.$1Sh(n.get_$4D()),n.$1E6(),t)};_d.$9v.$76b=function(n,t,i){var r=null;if(t.get_$f3()){r=new _h.$4i(t.$3S2());r.$jo=_g.$1v.$W0(t.get_$1ZC());r.$HJ=0}else{r=new _h.$4i(t.$1E6());r.$HJ=n}r.$5E0=!i.get_$A0();t.get_$Ms()&&(r.$l8=t.get_$Ms());r.$24T=t.$3ao(100);r.$2bH="AlwaysOverwrite";return r};_d.$9v.$3ah=function(n){switch(n){case 1:return new _g.$GJ;case 2:return new _g.$Fb;case 3:return new _g.$G0;case 12:return new _g.$VR;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$Oi.toString(n));}};_d.$13G=function(n,t,i,r,u,f){this.$16=n;this.$87=i;this.$1K=r;this.$15H=u;this.$DD=t;this.$30=f};_d.$13G.prototype={$16:null,$87:null,$1K:null,$15H:null,$DD:null,$30:null,$738:function(n,t){switch(n){case 0:return new _d.$7X(this.$16,this.$1K);case 1:return new _d.$4O(this.$16);case 2:return new _d.$13K(this.$16);case 3:return new _d.$CT(this.$16);case 4:return new _d.$8O(this.$16);case 5:return new _d.$BO(this.$16,this.$DD,this.$87,this.$1K,this.$15H);case 6:return new _d.$IO(this.$16);case 7:return new _d.$Bd(this.$16,this.$1K);case 8:return new _d.$13F(this.$16,this.$30,this.$1K);case 9:if(1===this.$16.$f.$j.get_$5L())return new _d.$B4(this.$16,this.$1K);break;case 10:return new _d.$FN(this.$16);case 11:if("Mouse"!==t)return new _d.$FO(this.$16,this.$87);break;case 12:return new _d.$DD(this.$16,this.$1K);case 13:return new _d.$Gm(this.$16,this.$1K);case 14:if(t==="Mouse")return new _d.$4I(this.$16);break;case 15:if(_a.UserAgent.getInstance().get_$4gz())return new _d.$N9(this.$16,_a.NativeBridge.get_$L().$CR);break;case 22:if(_a.NativeBridge.get_$L().$CR.get_$fm().get_$2y0())return new _d.$13L(this.$16,_a.NativeBridge.get_$L().$CR);break;case 16:return new _d.$CS(this.$16);case 17:if("Mouse"===t)return new _d.$N8(this.$16);break;case 18:if("Mouse"===t)return new _d.$Oh(this.$16);break;case 20:return new _d.$Dj(this.$16);case 19:return new _d.$13J(this.$16,OwaApplication.$1T,this.$16.$3S(1),this.$16.$f.$z,this.$1K);case 25:return new _d.$ac(this.$16,OwaApplication.$1T,this.$16.$f.$z);case 21:return new _d.$RM(this.$16);case 23:if(_a.NativeBridge.get_$L().$ug.$Cp)return new _d.$13M(this.$16,_a.NativeBridge.get_$L().$32,_a.NativeBridge.get_$L().$ug);break;case 24:return new _d.$EF(this.$16,this.$16.$f.$ON);case 26:if(this.$1K.get_$A0())return new _d.$mH(this.$16,this.$87);break;case 27:return new _d.$13I(this.$16)}return null}};_d.$13H=function(n,t){this.$3ld=n.$4zj();this.$1K=t};_d.$13H.prototype={$1K:null,$3ld:0,$GU:function(n,t){var i=new _d.$Q;this.$1K&&i.set_$A0(this.$1K.get_$A0());i.set_$5L(n?0:this.$3ld);return i},$3RI:function(n,t,i,r){var u=this.$GU(!1,!1);u.set_$5L(this.$3ld);u.set_$4D(4);u.set_$Mb(!1);u.set_$9J(n);u.set_$2Df(t);r&&!r.get_$Fh()?u.set_$45(r.get_$45()):u.set_$45(i===1?"Text":"HTML");return u}};_d.$V1=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$ON=n;this.$66=t;this.$1kQ=i;this.$1LI=r;this.$6M=u;this.$50=f;this.$G=e;this.$1Jr=o;this.$FG=s;this.$jg=h;this.$S=c;this.$87=a;this.$1K=v;this.$15H=y;this.$DD=l;this.$30=p;this.$WT=w};function $6P8(n,t,i){var r=n.$6M.$GU(!1,!1);r.$3dx(t);return n.$57u(r,i)}_d.$V1.prototype={$ON:null,$66:null,$1kQ:null,$1LI:null,$6M:null,$S:null,$50:null,$G:null,$1Jr:null,$FG:null,$jg:null,$87:null,$1K:null,$15H:null,$DD:null,$WT:null,$30:null,$ct:function(n){return $6P8(this,n,null)},$wD:function(n){return this.$57u(n,null)},$57u:function(n,t){var i=new _d.$AA(n,t,this.$ON,this.$66,this.$1kQ,this.$1LI,this.$50,this.$G,this.$1Jr,this.$FG,this.$jg,this.$S,this.$DD,this.$87,this.$1K,this.$15H,this.$30,this.$WT);i.$3v();return i}};_d.$sY=function(){_d.$sY.initializeBase(this)};_d.$sY.prototype={$Sb:null,$2bX:null,get_$ho:function(){return this.$Sb},set_$ho:function(n){if(this.$Sb!==n){this.$Sb=n;$6(this,"Description")}return n},get_$71Z:function(){return this.$2bX},set_$71Z:function(n){if(this.$2bX!==n){this.$2bX=n;$6(this,"ConversationOwner")}return n}};_d.$wT=function(n,t,i,r,u,f){_d.$wT.initializeBase(this,[n,t,i,r,u,f]);this.$y6=!1;this.set_$1HH(!0);this.$2Ni();this.$69I();this.$1K=f};_d.$wT.prototype={$1K:null,$4yl:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1L.get_$48(i);var u=new _d.$NC(this.$xX(i),"",r.$3Mb,"",r,this.get_$34G(),!1,this.$1K);this.$Md.$H(u)}},$7HJ:function(){this.set_$ms(this.$1no()?String.format(_u.Strings.l_InfoMailtipAutomaticReplyMultiple_Text,this.$1L.get_$F()):String.format(_u.Strings.l_InfoMailtipAutomaticReply_Text,this.$xX(0),this.$1L.get_$48(0).$3Mb))}};_d.$y2=function(n,t,i,r,u,f){_d.$y2.initializeBase(this,[n,t,i,r,u,f]);this.$1K=f;this.$y6=!1;this.set_$2nD(!0);this.set_$1HH(!0);this.set_$Gi(!1);this.$2Ni();this.$69I()};_d.$y2.prototype={$1K:null,$4yl:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1L.get_$48(i);var u=new _d.$NC(this.$xX(i),"",r.$4qS,"",r,null,!1,this.$1K);this.$Md.$H(u)}},$1no:function(){return!0}};_d.$z8=function(n,t,i,r,u,f){_d.$z8.initializeBase(this,[n,t,i,r,u,f]);this.$1K=f;this.$y6=!0;this.set_$1HH(!0);this.$2Ni();this.$69I()};_d.$z8.prototype={$1K:null,$2fy:0,get_$3XF:function(){return this.$2fy},set_$3XF:function(n){this.$2fy=n;this.$69I();return n},$4yl:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1L.get_$48(i);if(r.$u5>1){var u=new _d.$NC(this.$xX(i),"",String.format(_u.Strings.l_ApproximateNumberCount_Text,r.$2fz),_u.Strings.l_SubmessageEndSeparator_Text,r,this.get_$34G(),!0,this.$1K);this.$Md.$H(u)}}},$1no:function(){return this.$2fy>1||this.$2fy===1&&!!this.$1L.get_$48(0)&&this.$1L.get_$48(0).$u5>1},$7HJ:function(){this.set_$ms(this.$1no()?_u.Strings.l_InfoMailTipExternalRecipientsMultiple_Text:String.format(_u.Strings.l_InfoMailTipExternalRecipients_Text,this.$xX(0)))},$7HA:function(){for(var n="",t=0;t<this.$1L.get_$F();t++){var r=this.$1L.get_$48(t);if(r.$u5<=1){var i=this.$xX(t);_js.$8.$c(n)?n=i:n+=_u.Strings.l_MessageNameSeparator_Text+i}}this.set_$2da(n)}};_d.$12t=function(n,t,i,r,u,f){_d.$12t.initializeBase(this,[n,t,i,r,u,f]);this.$1K=f;this.$y6=!0;this.set_$1HH(!0);this.$5EC=!0;this.set_$5Cl(!0);this.$2Ni();this.$69I()};_d.$12t.prototype={$1K:null,$2kl:0,$2RY:0,$2og:!1,get_$3dj:function(){return this.$2kl},set_$3dj:function(n){this.$2kl=n;this.$7HA();return n},get_$4Dz:function(){return this.$2RY},set_$4Dz:function(n){this.$2RY=n;this.$7HJ();return n},$4yl:function(n,t){for(var r=n;r<n+t;r++){var i=this.$1L.get_$48(r);if(i.$u5>1){var u;if(i.$u5>100){this.$2og=!0;u=String.format(_u.Strings.l_ApproximateNumberCount_Text,i.$u5)}else u=i.$u5.toString();var f=new _d.$NC(this.$xX(r),"",u,_u.Strings.l_SubmessageEndSeparator_Text,i,this.get_$34G(),!0,this.$1K);this.$Md.$H(f)}}},$5tJ:function(n){_d.$KS.prototype.$5tJ.call(this,n);if(!$8(this.$1L)&&this.$1L.get_$F()){for(var t=!1,i=0;i<this.$1L.get_$F();i++){var r=this.$1L.get_$48(i);if(r.$u5>100){t=!0;break}}t!==this.$2og&&(this.$2og=t)}},$1no:function(){return!0},$7HJ:function(){if(this.$2RY<1e3){var n=this.$2og?String.format(_u.Strings.l_ApproximateNumberCount_Text,this.$2RY):this.$2RY.toString();this.set_$ms(String.format(_u.Strings.l_InfoMailTipLargeAudience_Text,n))}else this.set_$ms(String.format(_u.Strings.l_InfoMailTipExtraLargeAudience_Text,1e3))},$7HA:function(){if(this.$2kl>0){this.set_$2da(String.format(_u.Strings.l_InfoMailTipLargeAudienceIndividual_Text,this.$2kl));!this.$8P&&this.$3g0&&this.set_$3g1(!1)}else{this.set_$2da("");this.set_$3g1(!0)}}};_d.$KS=function(n,t,i,r,u,f){this.$$d_$TP=Function.createDelegate(this,this.$TP);this.$$d_$8qL=Function.createDelegate(this,this.$8qL);_d.$KS.initializeBase(this,[n,r,u]);this.$5sj=new _C(this.$$d_$8qL,_a.$0.$d);this.$5t9=i;this.$1L=t;this.$1K_6=f;this.$1L.add_$1Z(this.$$d_$TP)};_d.$KS.$5la=function(n,t){var r=n.get_$jh().get_$NA();n.get_$jh().$9U();if(r){var i=new _d.$Q;t&&i.set_$A0(t.get_$A0());i.set_$5L(0);i.set_$4D(0);i.set_$45("Html"===_g.$S.get_$L().get_$1t().get_$qX()?"HTML":"Text");if(_y.$3A.$3BH(r,i,t.get_$A0())){var u=new _y.$99;u.$VM(i)}else _js.Trace.logInfo(_a.$0.$177,"Cannot parse the mailto link in the mailtip message. The original link address is [{0}]",r)}};_d.$KS.prototype={$1K_6:null,$1L:null,$5t9:null,$1oG:!1,$5sj:null,$2oJ:!1,$44D:null,get_$8qt:function(){return this.$44D},set_$8qt:function(n){this.$44D=n;$6(this,"RemoveLinkText");return n},get_$34G:function(){return this.$5t9},$K5:null,get_$5Cl:function(){return this.$1oG},set_$5Cl:function(n){this.$1oG=n;this.set_$3ii(this.$1oG||this.get_$1Ug()||this.get_$2nD());$6(this,"IsRemoveLinkHidden");return n},get_$3ii:function(){return this.$2oJ},set_$3ii:function(n){this.$2oJ=n;$6(this,"IsSeparatorHidden");return n},$xX:function(n){var t=this.$1L.get_$48(n);return $8(t.get_$1l())||_js.$8.$14(t.get_$1l())?t.get_$WA():t.get_$1l()},$1no:function(){return this.$1L.get_$F()>1},get_$Wt:function(){return this.$K5},set_$Wt:function(n){if(n!==this.$K5){this.$K5=n;_d.$KS.$5la(this.$K5,this.$1K_6)}return n},get_$1Ug:function(){return _d.$1Dv.prototype.get_$1Ug.call(this)},set_$1Ug:function(n){this.set_$3ii(n||this.$1oG||this.get_$2nD());_d.$1Dv.prototype.set_$1Ug.call(this,n);return n},get_$2nD:function(){return _d.$1Dv.prototype.get_$2nD.call(this)},set_$2nD:function(n){this.set_$5Cl(this.$1oG||n);this.set_$3ii(this.$2oJ||n);_d.$1Dv.prototype.set_$2nD.call(this,n);return n},get_$h4:function(){return _d.$KS.$1Ce},$5tJ:function(n){for(var i=0;i<n.length;i++)for(var r=n[i],t=0;t<this.$Md.get_$F();t++){var u=this.$Md.get_$48(t);u.$43J===r&&this.$Md.$67(t)}},$TP:function(n,t){if(this.$3iv)switch(t.$3R){case 0:this.$4yl(t.$4T,t.$2t.length);break;case 2:this.$5tJ(t.$3Y);break;case 4:this.$2Ni();break;default:break}(this.$1L.get_$F()>0||this.$5EC)&&this.$69I();this.$7YW()||this.$8P||this.set_$Gi(!0);$6b(this,"MessageUpdated")},$7YW:function(){return this.$1no()},$2Ni:function(){this.$Md.$1u();this.$4yl(0,this.$1L.get_$F())},$4yl:function(n,t){},$69I:function(){_d.$1Dv.prototype.$69I.call(this);this.get_$2nD()||this.set_$8qt(this.$1no()?_u.Strings.l_MessageRemoveAll_Text:_u.Strings.l_MessageRemoveRecipient_Text)},$8qL:function(){while(this.$1L.get_$F()>0){var n=this.$1L.get_$48(0).get_$WA();this.get_$34G()(n)}},$7HA:function(){for(var t="",n=0;n<this.$1L.get_$F();n++){var i=$8(this.$1L.get_$48(n).get_$1l())?this.$1L.get_$48(n).get_$WA():this.$1L.get_$48(n).get_$1l();n?t+=_u.Strings.l_MessageNameSeparator_Text+i:t=i}this.set_$2da(t)},$7HJ:function(){}};_d.$NC=function(n,t,i,r,u,f,e,o){_d.$NC.initializeBase(this,[n,t,i,r,e]);this.$43J=u;this.$1K=o;if($8(f))this.$5Ck=!0;else{var s=this;this.$1L6=new _C(function(){f(s.$43J.get_$WA())},_a.$0.$d)}};_d.$NC.prototype={$5Ck:!1,$1K:null,$1L6:null,$43J:null,$K5:null,get_$h4:function(){return _d.$NC.$1Ce},get_$Wt:function(){return this.$K5},set_$Wt:function(n){if(n!==this.$K5){this.$K5=n;_d.$KS.$5la(this.$K5,this.$1K)}return n},get_$8r5:function(){return _d.$4.get_$143()}};_d.$13i=function(n,t,i,r,u,f){_d.$13i.initializeBase(this,[n,t,i,r,u,f]);this.$y6=!0;this.set_$1HH(!1);this.$69I()};_d.$13i.prototype={$7HJ:function(){this.set_$ms(this.$1no()?String.format(_u.Strings.l_WarningMailTipModeratedMessageMultiple_Text,this.$1L.get_$F()):String.format(_u.Strings.l_WarningMailTipModeratedMessage_Text,this.$xX(0)))}};_d.$M1=function(n){_d.$M1.initializeBase(this);this.$2N5=n};_d.$M1.prototype={$2N5:null,$3Mb:null,$4qS:null,$u5:0,$2fz:0,get_$1l:function(){var t=_d.$2n.$2AJ(this.$2N5);var n=t.match(_d.$M1.$4y1);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());n=t.match(_d.$M1.$2f9);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());return t},get_$WA:function(){return this.$2N5.$BY.get_$1h().EmailAddress}};_d.$15M=function(n,t,i,r,u,f){_d.$15M.initializeBase(this,[n,t,i,r,u,f]);this.$y6=!0;this.set_$1HH(!1);this.$69I()};_d.$15M.prototype={$7HJ:function(){this.set_$ms(this.$1no()?String.format(_u.Strings.l_WarningMailTipMailBoxFullMultiple_Text,this.$1L.get_$F()):this.set_$ms(String.format(_u.Strings.l_WarningMailTipMailBoxFull_Text,this.$xX(0))))}};_d.$15l=function(n,t,i,r,u,f){_d.$15l.initializeBase(this,[n,t,i,r,u,f]);this.$y6=!0;this.set_$1HH(!1);this.$69I()};_d.$15l.prototype={$7HJ:function(){this.set_$ms(this.$1no()?String.format(_u.Strings.l_WarningMailTipNoPermissionToSendMultiple_Text,this.$1L.get_$F()):String.format(_u.Strings.l_WarningMailTipNoPermissionToSend_Text,this.$xX(0)))}};_d.$1Dv=function(n,t,i){_d.$1Dv.initializeBase(this,[n]);this.$3kb=t;this.$37p=this.$8P?_u.Strings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text;this.$7b=i};_d.$1Dv.prototype={$Md:null,$7b:0,$8P:!0,$3kb:null,$5DE:!1,$37p:null,$3g0:!0,$5EC:!1,$5BN:!1,$3iv:!1,$y6:!1,$3lr:null,$2dZ:null,get_$ms:function(){return this.$3lr},set_$ms:function(n){this.$3lr=n;$6(this,"MainEntryText");return n},get_$2da:function(){return this.$2dZ},set_$2da:function(n){this.$2dZ=n;$6(this,"DetailEntryText");return n},get_$938:function(){return this.$37p},set_$938:function(n){this.$37p=n;$6(this,"ShowHideText");return n},get_$Gi:function(){return this.$8P},set_$Gi:function(n){this.$8P=n;this.set_$3g1(!this.$y6||this.$8P||_js.$8.$c(this.$2dZ));this.set_$938(this.$8P?_u.Strings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text);$6(this,"IsCollapsed");return n},get_$1HH:function(){return this.$3iv},set_$1HH:function(n){this.$3iv=n;this.$Md=new _js.$X;return n},get_$1Ug:function(){return this.$5DE},set_$1Ug:function(n){this.$5DE=n;$6(this,"IsShowHideLinkHidden");return n},get_$2nD:function(){return this.$5BN},set_$2nD:function(n){this.set_$1Ug(this.get_$1Ug()||n);this.$5BN=n;$6(this,"IsMainEntryHidden");return n},get_$3g1:function(){return this.$3g0},set_$3g1:function(n){this.$3g0=n;$6(this,"IsDetailEntryHidden");return n},add_$1ue:function(n){this.$2Z("MessageUpdated",n)},remove_$1ue:function(n){this.$2b("MessageUpdated",n)},$19v:function(){this.$3kb&&this.$3kb()},$69I:function(){if(!this.get_$2nD()){this.$7HJ();this.set_$1Ug(!this.$7YW())}this.$y6&&this.$7HA()}};_d.$BN=function(n){this.$$d_$5fh=Function.createDelegate(this,this.$5fh);_d.$BN.initializeBase(this);this.$p=OwaApplication.$1T;this.$1r=n};_d.$BN.$29t=function(n){if($8(n))return null;var t=n.responseCode;return $8(t)?null:t.toString()};function $4Na(n,t){var r=t.__type;if(r&&r===_g.$ED._dataContractName){var i=t.ErrorCode;if(!_g.$7N.$11r(i)&&i!==408){_js.Trace.logInfo(_a.$0.$d,"Action failure: status code {0}",i);return!0}}return!1}function $4Nb(n,t){var i=t.__type;if(i&&i===_g.$ED._dataContractName){var r=t.ErrorCode;if(r===408){_js.Trace.logInfo(_a.$0.$d,"Action failure: status code {0}",r);return!0}}return!1}function $4Nc(n,t){var i=t.__type;if(i&&i===_g.$ED._dataContractName){var r=t.ErrorCode;if(r===503){_js.Trace.logInfo(_a.$0.$d,"Action failure: status code {0}",r);return!0}}return!1}_d.$BN.prototype={$p:null,$1r:null,$k7:function(n,t,i,r){$8(t)||n.add_$2A(t);n.add_$20(i||this.$$d_$5fh);$8(r)||n.add_$2m(r);this.$p.$y(n)},$978:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$978(n,t,i,r,u,f):r(e)};var h=this,c=this;this.$k7(e,function(){o()},function(){u(e);i&&o()},f)},$61A:function(n,t){var i=_u.Strings.l_MailComposeActionFailed_Text;this.$11c(n,i,null,i,null,t)},$1SX:function(n,t,i,r,u,f){var e=t;if($4Nc(this,n.$1b))e=_u.Strings.l_ErrorServiceUnavailable_Text;else if(u&&$4Nb(this,n.$1b))e=u;else if(i&&$4Na(this,n.$1b))e=i;else{var o=_d.$BN.$29t(n.$1b);if(o)r&&o==="ErrorItemNotFound"?e=r:o==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&o==="ErrorQuotaExceeded"&&(e=f);else{var s=$8(n.$1b)||_js.$8.$14(n.$1b.message)?"none":n.$1b.message;_js.Trace.logWarning(_a.$0.$d,"MailComposeActionSubmitter.GetErrorMessage: The error type is not expected. Showing error {0} for action error message {1}",e,s)}}_js.Trace.logInfo(_a.$0.$d,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$3Zr:function(n,t,i,r,u,f,e,o,s){var h=t;s!==undefined&&(s=t);if(_a.$3.$7bR(n.$1b))h=s;else if($4Nc(this,n.$1b))h=e;else if($4Nb(this,n.$1b))h=f;else if($4Na(this,n.$1b))h=i;else{var c=_d.$BN.$29t(n.$1b);if(c)c==="ErrorItemNotFound"?h=r:c==="ErrorAccessDenied"?h=u:c==="ErrorQuotaExceeded"&&(h=o);else{var l=$8(n.$1b)||_js.$8.$14(n.$1b.message)?"none":n.$1b.message;_js.Trace.logWarning(_a.$0.$d,"MailComposeActionSubmitter.GetInfoBarErrorMessage: The error type is not expected. Showing error {0} for action error message {1}",h,l)}}_js.Trace.logInfo(_a.$0.$d,"MailComposeActionSubmitter.GetInfoBarErrorMessage: showing error {0}",h);return h},$11c:function(n,t,i,r,u,f){var e=this.$1SX(n,t,i,r,u,null);this.$1r.$3A(0,e,f)},$5fh:function(n){this.$61A(n,null);this.$5rg(n)},$5rg:function(n){$dY(this,"MailComposeActionFailed",n)}};_d.$Q=function(){this.$$d_$7FQ=Function.createDelegate(this,this.$7FQ);_d.$Q.initializeBase(this);this.set_$45("Html"===_g.$S.get_$L().get_$1t().get_$qX()?"HTML":"Text");this.$a(_d.$Q.$2LG.$1j,this.$$d_$7FQ);this.$a(_d.$Q.$2nG.$1j,this.$$d_$7FQ)};_d.$Q.$$cctor=function(){_d.$Q.$1BG.set_$FQ(new _a.$DB(_g.$1m));_d.$Q.$13z.set_$FQ(new _a.$DB(_g.$1m));_d.$Q.$13f.set_$FQ(new _a.$DB(_g.$1m));_d.$Q.$38w.set_$FQ(new _a.$DB(_c.$i));_d.$Q.$1Or.set_$FQ(new _a.$DB(_g.Attachment));_d.$Q.$1Ro.set_$FQ(new _a.$DB(_g.$LT))};_d.$Q.$9Jn=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$8.$c(u)?r:_js.$2B.$Rq(n,u)};_d.$Q.$5n8=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$8.$c(r)?i:Boolean.parse(r)};_d.$Q.$4eJ=function(n,t,i,r){if(n)for(var f=0;f<n.get_$F();f++){var u=n.get_$48(f);if(_g.$2I.$4W(u,i)){_js.Trace.logInfo(_a.$0.$d,"Excluding original from {0}",i);continue}if(_d.$Q.$1oQ(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$d,"Excluding self address {0}",_d.$Q.$ua||"null");continue}if(r&&r.get_$F()!==r.$DK(function(n){return _g.$2I.$4W(u,n)})){_js.Trace.logInfo(_a.$0.$d,"Excluding address {0} already in to",u);continue}t.$H(u)}};_d.$Q.$1oQ=function(n){return!_js.$8.$14(_d.$Q.$ua)&&!_js.$8.$14(n)&&(_d.$Q.$ua===n||_d.$Q.$ua.toLowerCase()===n.toLowerCase())};_d.$Q.$3lS=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$F();u++){r.val+=_g.$2I.$rV(t.get_$48(u));u!==t.get_$F()-1&&(r.val+="|")}r.val+=" QS="+i+")"};function $4Nr(n,t,i){i.val=$8(i.val)?!1:i.val;t.set_$2h(n.get_$2h());t.set_$6A(n.get_$6A());t.set_$i(n.get_$9J());t.set_$1e(new(_a.$1p.$$(_g.Attachment,_g.$Cf)));if(n.get_$F1()||n.get_$Dw()){var o=_g.$S.get_$L().get_$kd().ClearSign;t.set_$7G(n.get_$Dw()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");o&&n.get_$F1()&&!n.get_$Dw()?t.set_$3c($4Np(n,i.val)):t.set_$3c(new _g.$66(new _g.$67("Text","")));t.get_$1e().$H(new _g.$5q(n.get_$63A()))}else{t.set_$3c($4Np(n,i.val));(n.get_$Qq()&&n.get_$Qq().get_$Pm()||n.get_$9R()&&n.get_$9R().get_$Pm())&&t.set_$7G("IPM.Note");n.get_$85()&&t.get_$1e().$6G(n.get_$85().$7V())}t.set_$5D(n.get_$5D());t.set_$7J(n.get_$7J());t.set_$Ko(n.get_$Ko());t.set_$PQ(n.get_$PQ());t.set_$O6(n.get_$O6());t.set_$ST(n.get_$ST());t.set_$Sc(n.get_$Sc());t.set_$Qo(n.get_$Qo());if(n.get_$UM()){t.set_$Hj(new(_a.$1p.$$(_g.$LT,_g.$CN)));t.get_$Hj().$6G(n.get_$UM().$7V())}if(_g.$7f.isInstanceOfType(t)){var r=t;r.set_$35(n.get_$35());r.set_$4O(new(_a.$U.$$(_g.$1m)));n.get_$4O()&&r.get_$4O().$6G(n.get_$4O().$7V());r.set_$4f(new(_a.$U.$$(_g.$1m)));n.get_$4f()&&r.get_$4f().$6G(n.get_$4f().$7V());r.set_$6J(new(_a.$U.$$(_g.$1m)));n.get_$6J()&&r.get_$6J().$6G(n.get_$6J().$7V());r.set_$FN(n.get_$FN());r.set_$Eg(n.get_$Eg());r.set_$Dw(n.get_$Dw());r.set_$F1(n.get_$F1())}else{var u=t;u.set_$22(n.get_$1ZC());var f=_g.$S.get_$L().get_$38();var e=null;e=_js.$8.$c(f.get_$bw())?null!==n.get_$35()&&n.get_$35().Mailbox?n.get_$35().Mailbox.EmailAddress:_h.$35.$2hf(null)||f.get_$Br():f.get_$bw();if(e){u.set_$35(new _g.$Bk);u.get_$35().Mailbox=new _g.$1m;u.get_$35().Mailbox.EmailAddress=e}}}function $6Oj(n,t){var i=$6Ok(n,t);switch(n.get_$4D()){case 0:case 4:n.set_$9J(i);break;case 1:case 2:case 3:n.set_$Zs(i);break}}function $6Ok(n,t){var i=null;if(!$8(t)&&"Id"in t){i=new _g.$1j(t.Id);"ChangeKey"in t&&(i.ChangeKey=t.ChangeKey)}return i}function $4Nu(n,t,i){0===t.get_$cY()&&t.set_$cY(i&&i.get_$45()==="Text"?1:3)}function $6Oi(n,t){var u=_h.$35.$2hf(t);if(u){n.set_$35(new _g.$Bk);n.get_$35().Mailbox=new _g.$1m;n.get_$35().Mailbox.EmailAddress=u}n.set_$yG(!1);n.get_$5D()&&!n.get_$5D().get_$Fh()?n.set_$45(t.get_$5D().get_$45()):$8(t.get_$3c())||n.set_$45(t.get_$3c().get_$45());switch(n.get_$4D()){case 1:case 2:case 12:$2U1(n,t);if(_g.$7f.isInstanceOfType(t)){var i=t;i.get_$H2()?n.$1AX(i.get_$35()||i.get_$9o(),null,null,null):n.$1AX(i.get_$35()||i.get_$9o(),i.get_$4O()?i.get_$4O().get_$9JV():null,i.get_$4f()?i.get_$4f().get_$9JV():null,i.get_$34P()?i.get_$34P().get_$9JV():null);n.set_$2Dy(n.get_$4D()===2&&t.get_$2rT());n.set_$311(t.get_$27v())}else if(_g.$Kg.isInstanceOfType(t)){var f=t;n.$1AX(f.get_$35()||f.get_$9o(),null,null,null)}$3FA(n,t);break;case 5:case 6:case 7:if(_g.$7f.isInstanceOfType(t)){var r=t;n.$1AX(r.get_$35()||r.get_$9o(),r.get_$4O()?r.get_$4O().get_$9JV():null,r.get_$4f()?r.get_$4f().get_$9JV():null,r.get_$34P()?r.get_$34P().get_$9JV():null)}break;case 3:_g.$RQ.isInstanceOfType(t)||$2U1(n,t);n.set_$311(t.get_$27v());$4No(n);$3FA(n,t);break;case 9:case 10:_g.$7f.isInstanceOfType(t)?n.$1AX(t.get_$9o(),null,null,null):_g.$Kg.isInstanceOfType(t)&&n.$1AX(t.get_$9o(),null,null,null);$3FA(n,t);break;default:$4Ns(n);break}_js.Trace.logInfo(_a.$0.$d,"Initialized context with original email message, context:"+n.toString())}function $6Og(n,t){n.set_$Zs(t.get_$i());var i=n.$3iS();n.set_$5D(i?null:t.get_$5D());$6Ol(n,t.get_$nv());n.set_$7J(t.get_$7J());n.set_$Ni(n.get_$Ni()||"");n.get_$5D()&&!n.get_$5D().get_$Fh()?n.set_$45(n.get_$5D().get_$45()):n.set_$45(t.get_$cY()===1?"Text":"HTML");if(!n.get_$EC()){n.set_$EC(!(n.get_$4D()===1||n.get_$4D()===2||n.get_$4D()===3||n.get_$4D()===12));n.get_$4D()!==3||t.get_$Pm()||i||n.get_$5D()&&n.get_$5D().get_$Fh()||n.set_$85(t.get_$1e()?t.get_$1e().get_$9JV():null)}if(_g.ICalendaring.isInstanceOfType(t)){var r=t;r.$36g();$6Oh(n,r)}else if(_g.$7f.isInstanceOfType(t)||_g.$Kg.isInstanceOfType(t)){if(3===n.get_$4D()&&!n.get_$EC()){n.set_$6A(t.get_$6A());_js.Trace.logInfo(_a.$0.$d,"Setting importance to "+n.get_$6A()+" since we are forwarding item "+_h.$Cn.$rV(t.get_$i())+" with that importance")}$6Oi(n,t)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(t).getName()));$4Nt(n);n.set_$bf(!0)}function $6Of(n,t){var i=null;_g.$NG.isInstanceOfType(t)||_g.$Hf.isInstanceOfType(t)?i=t.get_$35():t.get_$Cl()?i=t.get_$Cl():_js.Trace.logError(_a.$0.$d,"ICalendaring doesnt have an organizer");return i}function $4Nt(n){var t=new(_0365f.$s.$$(String));n.get_$16T()&&t.$6G(_g.$Be.$50J(n.get_$85()));if(n.$6j&&n.$6j.get_$Pm()&&n.$6j.get_$1G3()){var i=n.$6j.get_$1e().get_$48(0).get_$40().Id;t.$H(i)}n.set_$1Ou(t.$7V())}function $6Oh(n,t){n.set_$yG(!0);t.get_$3c()&&n.set_$45(t.get_$3c().get_$45());var u=$6Of(n,t);var i;var r;if(_g.$NG.isInstanceOfType(t)||_g.$Hf.isInstanceOfType(t)){i=t.get_$4O()?_g.$2I.$29W(t.get_$4O().get_$9JV()):null;r=t.get_$4f()?_g.$2I.$29W(t.get_$4f().get_$9JV()):null}else{i=t.get_$72()?_g.$2I.$29W(_g.$3X.$4Da(t.get_$72().get_$9JV())):null;r=t.get_$8A()?_g.$2I.$29W(_g.$3X.$4Da(t.get_$8A().get_$9JV())):null}switch(n.get_$4D()){case 1:case 2:n.$1AX(u,i,r,null);break;case 5:case 6:case 7:n.$1AX(u,i,r,null);$2U2(n,t);n.set_$2BF(!0);break;case 8:var f=t.get_$72().$46();f.$6G(t.get_$9D().$7V());i=_g.$2I.$29W(_g.$3X.$4Da(f.get_$9JV()));n.$1AX(u,i,r,null);$2U2(n,t);n.set_$2BF(!0);break;case 3:if(_g.$Be.isInstanceOfType(t)||_g.$39.isInstanceOfType(t)){n.set_$16T(!0);n.set_$35(u);$2U2(n,t)}break;default:$4Ns(n);break}n.set_$St(!0);_js.Trace.logInfo(_a.$0.$d,"Initialized context from original calendar item, context:"+n.toString())}function $2U2(n,t){n.set_$yv($6Oe(n,t));n.set_$4h(t.get_$4h());n.set_$1lV(!!n.get_$4h()&&!_js.$8.$c(n.get_$4h().get_$1l()))}function $6Oe(n,t){var i=new _d.$9X;i.set_$10(t.get_$10());i.set_$23(t.get_$23());i.set_$Jh(t.get_$Jh());i.set_$ZC(t.get_$ZC());i.$a7();return i}function $6Ol(n,t){var i="";switch(n.get_$4D()){case 1:case 2:case 12:i=_u.Strings.l_ReplyPrefix_Text;break;case 3:i=_u.Strings.l_ForwardPrefix_Text;break;case 5:i=_u.Strings.l_AcceptPrefix_Text;break;case 6:i=_u.Strings.l_TentativelyAcceptPrefix_Text;break;case 7:i=_u.Strings.l_DeclinePrefix_Text;break;case 8:i=_u.Strings.l_CanceledMeetingMessagePrefix_Text;break;case 9:i=_u.Strings.l_ApprovePrefix_Text;break;case 10:i=_u.Strings.l_RejectPrefix_Text;break}var r=String.format(_u.Strings.l_SubjectFormat_Text,i,t);_js.Trace.logInfo(_a.$0.$d,"Formatted subject with Prefix="+i+"; Operation="+n.get_$4D());if(255<r.length){n.set_$2h(r.substr(0,255));_js.Trace.logInfo(_a.$0.$d,"Truncated subject from "+r+" to "+n.get_$2h()+" to meet the "+255+" characters rule.")}else n.set_$2h(r)}function $3FA(n,t){n.set_$3E(t.get_$3E());_g.$7f.isInstanceOfType(t)?n.set_$1vJ(t.get_$9s()):_g.$Kg.isInstanceOfType(t)&&n.set_$1vJ(t.get_$9s())}function $4Ns(n){var t=_js.$2B.$J7(_y.$Oi,n.get_$4D());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",t));}function $2U1(n,t){n.set_$Ko(t.get_$Ko());n.set_$ST(t.get_$ST());n.set_$PQ(t.get_$PQ());n.set_$O6(t.get_$O6());n.set_$1Pq(t.get_$1Pq())}function $4Np(n,t){return t?$4Nq(n):n.$4o5()}function $4Nq(n){var t=new _g.$66(new _g.$67("HTML",""));t.set_$1d("");if(4!==n.get_$4D()&&13!==n.get_$4D()||n.get_$A0()){_js.Trace.logInfo(_a.$0.$d,"Create new body for action email message, setting body type to context body type: "+n.get_$45());t.set_$45(n.get_$45())}else{_js.Trace.logInfo(_a.$0.$d,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");t.set_$45("Text")}return t}function $4No(n){if(_y.$j.$g.get_$Qz()){var t=n.$3Zk();if(t){var r=!1;if(n.get_$4f())for(var i=0;i<n.get_$4f().get_$F();i++){var u=n.get_$4f().get_$48(i);if(t.EmailAddress.toLowerCase()===u.EmailAddress.toLowerCase()){r=!0;break}}if(!r){n.get_$4f()||n.set_$4f(new _js.$X);n.get_$4f().$H(t);_js.Trace.logInfo(_a.$0.$d,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$d,"Could not add self to CC as the address was missing")}}_d.$Q.prototype={$HB:null,$6j:null,$Gg:null,$2iO:null,$mR:!1,$5EA:!1,$Sl:null,$3w9:!1,$2Ph:!1,$2lx:!1,$7Xs:!1,get_$6u:function(){return this.$W(_d.$Q.$4G7)},set_$6u:function(n){this.$N(_d.$Q.$4G7,n);return n},get_$4D:function(){return this.$W(_d.$Q.$2LG)},set_$4D:function(n){this.$N(_d.$Q.$2LG,n);return n},get_$5L:function(){return this.$W(_d.$Q.$zz)},set_$5L:function(n){this.$N(_d.$Q.$zz,n);return n},get_$Zs:function(){return this.$W(_d.$Q.$3zf)},set_$Zs:function(n){this.$N(_d.$Q.$3zf,n);return n},get_$311:function(){return this.$W(_d.$Q.$3ze)},set_$311:function(n){this.$N(_d.$Q.$3ze,n);return n},get_$9R:function(){this.$6j||(this.$6j=this.$W(_d.$Q.$3zg));return this.$6j},set_$9R:function(n){this.$6j=n;this.$N(_d.$Q.$3zg,this.$6j);return n},get_$9J:function(){return this.$W(_d.$Q.$3VU)},set_$9J:function(n){if($8(this.get_$9J())||!n)this.$N(_d.$Q.$3VU,n);else{this.get_$9J().Id=n.Id;this.get_$9J().ChangeKey=n.ChangeKey}return n},get_$3ic:function(){return!!this.get_$9J()},get_$64S:function(){return this.$W(_d.$Q.$4B3)},set_$64S:function(n){this.$N(_d.$Q.$4B3,n);return n},get_$2h:function(){return this.$W(_d.$Q.$Vx)},set_$2h:function(n){this.$N(_d.$Q.$Vx,n);return n},get_$Cx:function(){return this.$W(_d.$Q.$1jQ)},set_$Cx:function(n){this.$N(_d.$Q.$1jQ,n);return n},get_$502:function(){return this.$HB},set_$502:function(n){this.$HB=n;return n},get_$Ni:function(){return this.$W(_d.$Q.$436)},set_$Ni:function(n){this.$N(_d.$Q.$436,n);return n},get_$12B:function(){return this.$W(_d.$Q.$4Cv)},set_$12B:function(n){this.$N(_d.$Q.$4Cv,n);return n},get_$45:function(){return this.$W(_d.$Q.$3NH)},set_$45:function(n){this.$N(_d.$Q.$3NH,n);return n},get_$4O:function(){return this.$W(_d.$Q.$1BG)},set_$4O:function(n){this.$N(_d.$Q.$1BG,n);return n},get_$2Qc:function(){return this.$W(_d.$Q.$38w)},set_$2Qc:function(n){this.$N(_d.$Q.$38w,n);return n},get_$Y4:function(){return this.$W(_d.$Q.$20E)},set_$Y4:function(n){this.$N(_d.$Q.$20E,n);return n},get_$4f:function(){return this.$W(_d.$Q.$13z)},set_$4f:function(n){this.$N(_d.$Q.$13z,n);return n},get_$WP:function(){return this.$W(_d.$Q.$1h3)},set_$WP:function(n){this.$N(_d.$Q.$1h3,n);return n},get_$6J:function(){return this.$W(_d.$Q.$13f)},set_$6J:function(n){this.$N(_d.$Q.$13f,n);return n},get_$SP:function(){return this.$W(_d.$Q.$1gF)},set_$SP:function(n){this.$N(_d.$Q.$1gF,n);return n},get_$Mb:function(){return this.$W(_d.$Q.$36v)},set_$Mb:function(n){this.$N(_d.$Q.$36v,n);return n},get_$6A:function(){return this.$W(_d.$Q.$1m5)},set_$6A:function(n){this.$N(_d.$Q.$1m5,n);return n},get_$10z:function(){return this.$W(_d.$Q.$431)},set_$10z:function(n){this.$N(_d.$Q.$431,n);return n},get_$1yz:function(){return this.$W(_d.$Q.$4A6)},set_$1yz:function(n){this.$N(_d.$Q.$4A6,n);return n},get_$63A:function(){return this.$W(_d.$Q.$4A2)},set_$63A:function(n){this.$N(_d.$Q.$4A2,n);return n},get_$38d:function(){return this.$W(_d.$Q.$4A0)},set_$38d:function(n){this.$N(_d.$Q.$4A0,n);return n},get_$4A3:function(){return this.$W(_d.$Q.$4A4)},set_$4A3:function(n){this.$N(_d.$Q.$4A4,n);return n},get_$1z0:function(){return this.$W(_d.$Q.$4A7)},set_$1z0:function(n){this.$N(_d.$Q.$4A7,n);return n},get_$k3:function(){return this.$W(_d.$Q.$4A8)},set_$k3:function(n){this.$N(_d.$Q.$4A8,n);return n},get_$bf:function(){return this.$W(_d.$Q.$3fl)},set_$bf:function(n){this.$N(_d.$Q.$3fl,n);return n},get_$St:function(){return this.$W(_d.$Q.$2nG)},set_$St:function(n){this.$N(_d.$Q.$2nG,n);return n},get_$16T:function(){return this.$W(_d.$Q.$3hV)},set_$16T:function(n){this.$N(_d.$Q.$3hV,n);return n},get_$2Dy:function(){return this.$W(_d.$Q.$3iR)},set_$2Dy:function(n){this.$N(_d.$Q.$3iR,n);return n},get_$4h:function(){return this.$W(_d.$Q.$1pY)},set_$4h:function(n){this.$N(_d.$Q.$1pY,n);return n},get_$1lV:function(){return this.$W(_d.$Q.$3bw)},set_$1lV:function(n){this.$N(_d.$Q.$3bw,n);return n},get_$yv:function(){return this.$W(_d.$Q.$3mb)},set_$yv:function(n){this.$N(_d.$Q.$3mb,n);return n},get_$35:function(){return this.$W(_d.$Q.$1SL)},set_$35:function(n){this.$N(_d.$Q.$1SL,n);return n},get_$9o:function(){return this.$W(_d.$Q.$36M)},set_$9o:function(n){this.$N(_d.$Q.$36M,n);return n},get_$EC:function(){return this.$W(_d.$Q.$3jO)},set_$EC:function(n){this.$N(_d.$Q.$3jO,n);return n},get_$f1:function(){return this.$W(_d.$Q.$3gW)},set_$f1:function(n){this.$N(_d.$Q.$3gW,n);return n},get_$iL:function(){return this.$W(_d.$Q.$3fR)},set_$iL:function(n){this.$N(_d.$Q.$3fR,n);return n},get_$jV:function(){return this.$W(_d.$Q.$1vL)},set_$jV:function(n){this.$N(_d.$Q.$1vL,n);return n},get_$1ZC:function(){return this.$W(_d.$Q.$40N)},set_$1ZC:function(n){this.$N(_d.$Q.$40N,n);return n},get_$yG:function(){return this.$W(_d.$Q.$3hs)},set_$yG:function(n){this.$N(_d.$Q.$3hs,n);return n},get_$mY:function(){return this.$W(_d.$Q.$3hn)},set_$mY:function(n){this.$N(_d.$Q.$3hn,n);return n},get_$m0:function(){return this.$W(_d.$Q.$3bk)},set_$m0:function(n){this.$N(_d.$Q.$3bk,n);return n},get_$mb:function(){return this.$W(_d.$Q.$3iT)},set_$mb:function(n){this.$N(_d.$Q.$3iT,n);return n},get_$Qq:function(){return this.$W(_d.$Q.$3VV)},set_$Qq:function(n){this.$N(_d.$Q.$3VV,n);return n},get_$1Ou:function(){return this.$W(_d.$Q.$3MI)},set_$1Ou:function(n){this.$N(_d.$Q.$3MI,n);return n},get_$85:function(){return this.$W(_d.$Q.$1Or)},set_$85:function(n){var t=null;if(n){t=new _js.$X;for(var i=0;i<n.get_$F();i++)t.$H(n.get_$48(i))}this.$N(_d.$Q.$1Or,t);$4Nt(this);return n},get_$1BY:function(){return this.$W(_d.$Q.$4FS)},set_$1BY:function(n){this.$N(_d.$Q.$4FS,n);return n},get_$H3:function(){return this.$W(_d.$Q.$3N4)},set_$H3:function(n){this.$N(_d.$Q.$3N4,n);return n},get_$5D:function(){return this.$W(_d.$Q.$45Q)},set_$5D:function(n){if(n!==this.get_$5D()){this.$N(_d.$Q.$45Q,n);$4Z(this,"IsCopyRestricted","IsPrintRestricted")}return n},get_$Ms:function(){return this.$W(_d.$Q.$1hP)},set_$Ms:function(n){this.$N(_d.$Q.$1hP,n);return n},get_$2m5:function(){return this.$mR},set_$2m5:function(n){this.$mR=n;n&&!this.get_$H3()&&this.$4v8();return n},get_$3mQ:function(){return 255},get_$16S:function(){return this.$W(_d.$Q.$3hD)},set_$16S:function(n){this.$N(_d.$Q.$3hD,n);return n},get_$kR:function(){return this.$W(_d.$Q.$4GO)},set_$kR:function(n){this.$N(_d.$Q.$4GO,n);return n},get_$2BF:function(){return this.$W(_d.$Q.$3ce)},set_$2BF:function(n){this.$N(_d.$Q.$3ce,n);return n},get_$2Df:function(){return this.$W(_d.$Q.$3hg)},set_$2Df:function(n){this.$N(_d.$Q.$3hg,n);return n},get_$219:function(){return this.$W(_d.$Q.$4GS)},set_$219:function(n){this.$N(_d.$Q.$4GS,n);return n},get_$7bi:function(){return!!this.get_$5D()&&!this.get_$5D().get_$Fh()&&!this.get_$5D().get_$2MX()&&!this.get_$5D().get_$G9()},get_$93S:function(){return this.get_$St()&&_d.$8O.$5DY(this)},get_$y4:function(){return!!this.get_$5D()&&0===this.get_$5D().get_$Fh()&&!this.get_$5D().get_$28o()&&!this.get_$5D().get_$G9()},get_$1tl:function(){return null},get_$Ko:function(){return this.$W(_d.$Q.$3fg)},set_$Ko:function(n){this.$N(_d.$Q.$3fg,n);return n},get_$ST:function(){return this.$W(_d.$Q.$3PF)},set_$ST:function(n){this.$N(_d.$Q.$3PF,n);return n},get_$Sc:function(){return this.$W(_d.$Q.$3VC)},set_$Sc:function(n){this.$N(_d.$Q.$3VC,n);return n},get_$Qo:function(){return this.$W(_d.$Q.$3VB)},set_$Qo:function(n){this.$N(_d.$Q.$3VB,n);return n},get_$PQ:function(){return this.$W(_d.$Q.$3PH)},set_$PQ:function(n){this.$N(_d.$Q.$3PH,n);return n},get_$O6:function(){return this.$W(_d.$Q.$3PE)},set_$O6:function(n){this.$N(_d.$Q.$3PE,n);return n},get_$1Pq:function(){return this.$W(_d.$Q.$3PG)},set_$1Pq:function(n){this.$N(_d.$Q.$3PG,n);return n},get_$7J:function(){return this.$W(_d.$Q.$1bJ)},set_$7J:function(n){this.$N(_d.$Q.$1bJ,n);return n},get_$FN:function(){return this.$W(_d.$Q.$1Tr)},set_$FN:function(n){this.$N(_d.$Q.$1Tr,n);return n},get_$Eg:function(){return this.$W(_d.$Q.$1UZ)},set_$Eg:function(n){this.$N(_d.$Q.$1UZ,n);return n},get_$1Ar:function(){return this.$W(_d.$Q.$4A1)},set_$1Ar:function(n){this.$N(_d.$Q.$4A1,n);return n},get_$Dw:function(){if(!_a.$1A.$2x||!_a.$1A.get_$1mq()||!this.$3iq())return!1;var n=!1;if(_g.$S.get_$L()){_g.$S.get_$L().get_$kd()&&(n=_g.$S.get_$L().get_$kd().AlwaysEncrypt);!n&&_g.$S.get_$L().get_$1t()&&(n=_g.$S.get_$L().get_$1t().get_$63B())}return n||this.$W(_d.$Q.$1yy)},set_$Dw:function(n){this.$N(_d.$Q.$1yy,n);return n},get_$F1:function(){if(!_a.$1A.$2x||!_a.$1A.get_$1mq()||!this.$3iq())return!1;var n=!1;if(_g.$S.get_$L()){_g.$S.get_$L().get_$kd()&&(n=_g.$S.get_$L().get_$kd().AlwaysSign);!n&&_g.$S.get_$L().get_$1t()&&(n=_g.$S.get_$L().get_$1t().get_$63D())}return n||this.$W(_d.$Q.$1z1)},set_$F1:function(n){this.$N(_d.$Q.$1z1,n);return n},get_$1HF:function(){return this.get_$Dw()||this.get_$F1()},get_$63C:function(){return _g.$S.get_$L().get_$kd()?!_g.$S.get_$L().get_$kd().AlwaysEncrypt:!0},get_$63E:function(){return _g.$S.get_$L().get_$kd()?!_g.$S.get_$L().get_$kd().AlwaysSign:!0},get_$3E:function(){return this.$W(_d.$Q.$1hc)},set_$3E:function(n){this.$N(_d.$Q.$1hc,n);return n},get_$1vJ:function(){return this.$W(_d.$Q.$40K)},set_$1vJ:function(n){this.$N(_d.$Q.$40K,n);return n},get_$2E5:function(){if(this.get_$St()||_y.$j.$g.get_$Qz())return!1;var n=this.get_$5D();return!n||!!n.get_$Fh()||n.get_$G9()},get_$3id:function(){return OwaApplication.$xO?!1:this.get_$4D()!==8&&!this.get_$f3()},get_$16b:function(){return this.$W(_d.$Q.$3i4)},set_$16b:function(n){this.$N(_d.$Q.$3i4,n);return n},get_$f3:function(){return this.get_$4D()===11||this.get_$4D()===12||this.get_$4D()===13},get_$oK:function(){return this.$W(_d.$Q.$40t)},set_$oK:function(n){this.$N(_d.$Q.$40t,n);return n},get_$A0:function(){return this.$W(_d.$Q.$45N)},set_$A0:function(n){this.$N(_d.$Q.$45N,n);return n},get_$UM:function(){return this.$W(_d.$Q.$1Ro)},set_$UM:function(n){this.$N(_d.$Q.$1Ro,n);return n},$3dx:function(n){this.set_$5L(_d.$Q.$9Jn(_y.$st,n,_d.$Q.$zz.$1j,0));this.set_$4D(_d.$Q.$9Jn(_y.$Oi,n,_d.$Q.$2LG.$1j,0));this.set_$Mb(_d.$Q.$5n8(n,_d.$Q.$36v.$1j,!0));this.set_$yG(_d.$Q.$5n8(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$bf(!1);this.set_$64S(n.StoreId)}$6Oj(this,n);this.set_$EC(0===this.get_$4D()||4===this.get_$4D())},$571:function(n){_g.$hp.isInstanceOfType(n)?this.set_$4D(1):_g.$ho.isInstanceOfType(n)?this.set_$4D(2):_g.$kp.isInstanceOfType(n)&&this.set_$4D(3);$4Nu(this,n,n.get_$1JT());this.set_$Zs(n.get_$2NG());this.set_$311(n.get_$33n());this.set_$9J(n.get_$i());this.set_$2h(n.get_$2h());this.set_$Ni(n.get_$1JT().get_$1d());this.set_$35(n.get_$35());this.set_$4O(n.get_$4O()?n.get_$4O().get_$9JV():null);this.set_$4f(n.get_$4f()?n.get_$4f().get_$9JV():null);this.set_$6J(n.get_$6J()?n.get_$6J().get_$9JV():null);this.set_$Mb(!1);this.set_$6A(n.get_$6A());$2U1(this,n);this.set_$5D(n.get_$5D());this.set_$7J(n.get_$7J());this.set_$FN(n.get_$FN());this.set_$Eg(n.get_$Eg());this.get_$5D()&&!this.get_$5D().get_$Fh()?this.set_$45(this.get_$5D().get_$45()):$8(n.get_$1JT())||this.set_$45(n.get_$cY()===1?"Text":"HTML");this.set_$EC(!1);this.set_$bf(!0);_js.Trace.logInfo(_a.$0.$d,"Initialized context with smart response, context:"+this.toString())},$3dw:function(n){if($8(n))throw Error.argumentNull("message");$4Nu(this,n,n.get_$3c());this.set_$Qq(n);this.set_$9J(n.get_$i());this.set_$2h(n.get_$2h());this.set_$Ni(n.$Tm?n.$Tm.get_$1d():n.get_$3c().get_$1d());if(_g.$7f.isInstanceOfType(n)){var t=n;this.set_$35(t.get_$35());this.set_$4O(t.get_$4O()?t.get_$4O().$9JW():null);this.set_$4f(t.get_$4f()?t.get_$4f().$9JW():null);this.set_$6J(t.get_$6J()?t.get_$6J().$9JW():null);this.set_$FN(t.get_$FN());this.set_$Eg(t.get_$Eg())}else if(_g.$Kg.isInstanceOfType(n)){var u=n;this.set_$35(u.get_$35())}this.set_$Mb(!1);this.set_$6A(n.get_$6A());$2U1(this,n);this.set_$5D(n.get_$5D());this.set_$7J(n.get_$7J());n.get_$5D()&&!n.get_$5D().get_$Fh()?this.set_$45(n.get_$5D().get_$45()):n.$Tm?this.set_$45(n.$Tm.get_$45()):this.set_$45(n.get_$cY()===1?"Text":"HTML");this.set_$St(_g.$RQ.isInstanceOfType(n));if(this.get_$St()){var i=n;$2U2(this,i.get_$NB());this.set_$16T(_g.$Be.isInstanceOfType(i));i.get_$35()&&this.set_$35(i.get_$35());i.get_$9o()&&this.set_$9o(i.get_$9o())}if(n.$Tl&&n.$Tl.get_$F())this.set_$85(n.$Tl.get_$9JV());else{(!this.get_$16b()||this.get_$EC())&&this.set_$85(n.get_$1e()?n.get_$1e().get_$9JV():null);if(this.get_$85()&&n.get_$3c().get_$45()==="Text")for(var r=0;r<this.get_$85().get_$F();r++)this.get_$85().get_$48(r)&&this.get_$85().get_$48(r).get_$8Y()&&this.get_$85().get_$48(r).set_$8Y(!1)}this.set_$EC(!0);this.set_$bf(!0);_js.Trace.logInfo(_a.$0.$d,"Initialized context with draft, context:"+this.toString())},$165:function(n){this.set_$9R(n);$6Og(this,n)},$1E6:function(n){var t=new _g.$7f;var i;$4Nr(this,t,i={val:n});n=i.val;return t},$3S2:function(n){var t=new _g.$Kg;var i;$4Nr(this,t,i={val:n});n=i.val;return t},$4o5:function(){var n=$4Nq(this);_a.$3.$17(this.$Gg,"GetRawEditorContentCommand");this.$Gg.$s();var t=this.get_$Ni();n.set_$1d(t);return n},$9Dz:function(n){var t=this.get_$H3();if(!t||this.get_$6A()===t.get_$6A()){this.set_$6A(n);t&&t.set_$6A(n)}},$4v8:function(){if(this.$mR&&this.$5EA){this.$HB.$s();if($8(this.get_$H3())){this.set_$H3(_d.$1Z.$1h0(this));_js.Trace.logInfo(_a.$0.$d,"Captured baseline for the first time, context:"+this.toString());if(this.$3w9&&this.$Sl){this.$Sl.set_$Cx(this.get_$H3().get_$Cx());this.$3w9=!1}if(!this.get_$9J()||this.get_$16b()&&this.get_$kR()){this.$Sl=_d.$1Z.$1h0(this);_js.Trace.logInfo(_a.$0.$d,"Captured initial baseline for context:"+this.toString())}}else{_d.$1Z.$5x(this.get_$H3(),this);_js.Trace.logInfo(_a.$0.$d,"Updated baseline, context:"+this.toString())}}},$G7:function(){if($8(this.get_$H3()))return!1;this.$HB.$s();return!this.get_$H3().$4uz(this)},$3ao:function(n){this.$2iO.$s();var t=this.get_$12B();t=t?t.length>n?this.get_$12B().substr(0,n)+"...":t:"";return t},$1AX:function(n,t,i,r){this.set_$4O(new _js.$X);var u=n?n.Mailbox:null;if(!_d.$Q.$ua){var f=_g.$S.get_$L().get_$38();_d.$Q.$ua=_js.$8.$c(f.get_$p2())?f.get_$Br()||"":f.get_$bw()||""}if(this.get_$4D()!==8&&(!r||!r.get_$F())&&u&&(2!==this.get_$4D()||!_d.$Q.$1oQ(u.EmailAddress))){this.get_$4O().$H(u);_js.Trace.logInfo(_a.$0.$d,"Adding original From to To, Operation="+this.get_$4D()+"; From="+_g.$2I.$rV(n)+"; Self="+_d.$Q.$ua)}if(this.get_$4D()===2||this.get_$4D()===8){_js.Trace.logInfo(_a.$0.$d,"Adding "+(t?t.get_$F():0)+" To recipients to To.");_d.$Q.$4eJ(t,this.get_$4O(),u,null);_js.Trace.logInfo(_a.$0.$d,"Adding "+(i?i.get_$F():0)+" Cc recipients to Cc");this.set_$4f(new _js.$X);_d.$Q.$4eJ(i,this.get_$4f(),u,this.get_$4O())}$4No(this);if(r&&r.get_$F()>0)if(this.get_$4D()===1){this.get_$4O().$1u();for(var e=0;e<r.get_$F();e++){var c=r.get_$48(e);this.get_$4O().$H(c)}}else if(this.get_$4D()===2)for(var o=0;o<r.get_$F();o++){var s=r.get_$48(o);var l=this;if(this.get_$4O().get_$F()===this.get_$4O().$DK(function(n){return _g.$2I.$4W(s,n)})){var a=this;var h=this.get_$4f().$DK(function(n){return _g.$2I.$4W(s,n)});h!==this.get_$4f().get_$F()&&this.get_$4f().$67(h);this.get_$4O().$H(s)}}if(this.get_$4D()!==8&&u&&0===this.get_$4O().get_$F()&&(!this.get_$4f()||0===this.get_$4f().get_$F())){this.get_$4O().$H(u);_js.Trace.logInfo(_a.$0.$d,"Adding original From since there are no recipients left, From="+_g.$2I.$rV(n))}},toString:function(){var n="Id="+this.get_$6u()+"; Op="+this.get_$4D()+"; Mode="+this.get_$5L()+"; Oid=";n+=this.get_$Zs()?this.get_$Zs().Id+":"+this.get_$Zs().ChangeKey+";":this.$6j&&this.$6j.get_$i()?this.$6j.get_$i().Id+":"+this.$6j.get_$i().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$9J()?this.get_$9J().Id+":"+this.get_$9J().ChangeKey+";":this.get_$Qq()&&this.get_$Qq().get_$i()?this.get_$Qq().get_$i().Id+":"+this.get_$Qq().get_$i().ChangeKey+";":"null;";n+=" Subject="+this.get_$2h()+"; RawContentLength="+(_js.$8.$c(this.get_$Ni())?"0":this.get_$Ni().length.toString())+"; ContentLength="+(_js.$8.$c(this.get_$Cx())?"0":this.get_$Cx().length.toString())+"; TextEditorContentLength="+(_js.$8.$c(this.get_$12B())?"0":this.get_$12B().length.toString())+"; BodyType="+this.get_$45()+";";var t;_d.$Q.$3lS("To",this.get_$4O(),this.get_$Y4(),t={val:n});n=t.val;var i;_d.$Q.$3lS("Cc",this.get_$4f(),this.get_$WP(),i={val:n});n=i.val;var r;_d.$Q.$3lS("Bcc",this.get_$6J(),this.get_$SP(),r={val:n});n=r.val;n+=" AutoSig="+this.get_$Mb()+"; Imp="+this.get_$6A()+"; QuotedBodyLength="+(_js.$8.$c(this.get_$10z())?"0":this.get_$10z().length.toString())+"; IsComplete="+this.get_$bf()+"; IsMeeting="+this.get_$St()+"; IsMeetingForward="+this.get_$16T()+"; IsReplyBcc="+this.get_$2Dy()+"; HasLocation="+this.get_$1lV()+"; MeetingTime="+(this.get_$yv()?this.get_$yv().get_$ZC()+":"+(this.get_$yv().get_$10()?this.get_$yv().get_$10().$8r():"null")+":"+(this.get_$yv().get_$23()?this.get_$yv().get_$23().$8r():"null"):"null")+"; From="+_g.$2I.$rV(this.get_$35())+"; Sender="+_g.$2I.$rV(this.get_$9o())+"; IsFromShown="+this.get_$f1()+"; IsBccShown="+this.get_$iL()+"; AttachmentCount="+(this.get_$85()?this.get_$85().get_$F().toString():"0")+"; UpgradeFailed="+this.get_$1BY()+"; HasBaseline="+(!!this.get_$H3()).toString()+"; HasInitBaseline="+(!!this.$Sl).toString()+"; UserSaved="+this.get_$m0()+"; IsReplyForward="+this.get_$mb()+"; HasDraft="+(!!this.get_$Qq()).toString()+"; HasRMLD="+(!!this.get_$5D()).toString()+"; Classified="+this.get_$Ko()+"; Class="+this.get_$PQ()+"; Sensitivity="+this.get_$7J()+"; DeliveryReceipt="+this.get_$FN()+"; ReadReceipt="+this.get_$Eg()+"; SmimeEncryptMessage="+this.get_$Dw()+"; SmimeSignMessage="+this.get_$F1()+"; ConversationId="+(this.get_$3E()?this.get_$3E().Id+":"+this.get_$3E().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$1vJ()+"; IsOriCalId="+this.get_$yG()+"; OccurrenceRefMaster="+this.get_$mY()+"; IsLoadedDraft="+this.get_$16S()+"; IsMovedToDraftFromOutbox="+this.get_$2Df()+"; IsUpgraded="+this.get_$EC()+"; IsCached="+this.$7Xs+";";return n},$Ar:function(){_js.Trace.logInfo(_a.$0.$d,"Context reset start.");this.set_$6u(null);this.get_$4D()&&this.set_$4D(0);this.get_$5L()&&this.set_$5L(0);this.get_$Zs()&&this.set_$Zs(null);this.get_$9R()&&this.set_$9R(null);this.get_$9J()&&this.set_$9J(null);_js.$8.$c(this.get_$2h())||this.set_$2h(null);_js.$8.$c(this.get_$Ni())||this.set_$Ni("");_js.$8.$c(this.get_$Cx())||this.set_$Cx("");_js.$8.$c(this.get_$12B())||this.set_$12B("");this.set_$45("Html"===_g.$S.get_$L().get_$1t().get_$qX()?"HTML":"Text");this.get_$4O()&&this.set_$4O(null);_js.$8.$c(this.get_$Y4())||this.set_$Y4(null);this.get_$4f()&&this.set_$4f(null);_js.$8.$c(this.get_$WP())||this.set_$WP(null);this.get_$6J()&&this.set_$6J(null);_js.$8.$c(this.get_$SP())||this.set_$SP(null);this.get_$Mb()||this.set_$Mb(!0);this.get_$6A()!=="Normal"&&this.set_$6A("Normal");_js.$8.$c(this.get_$10z())||this.set_$10z(null);this.get_$bf()&&this.set_$bf(!1);this.get_$St()&&this.set_$St(!1);this.get_$16T()&&this.set_$16T(!1);this.get_$2Dy()&&this.set_$2Dy(!1);this.get_$4h()&&this.set_$4h(null);this.get_$1lV()&&this.set_$1lV(!1);this.get_$yv()&&this.set_$yv(null);this.get_$35()&&this.set_$35(null);this.get_$9o()&&this.set_$9o(null);this.get_$EC()&&this.set_$EC(!1);this.get_$f1()&&this.set_$f1(!1);this.get_$iL()&&this.set_$iL(!1);this.get_$85()&&this.set_$85(null);this.get_$1BY()&&this.set_$1BY(!1);this.get_$H3()&&this.set_$H3(null);this.get_$m0()&&this.set_$m0(!1);this.get_$mb()&&this.set_$mb(!1);this.get_$Qq()&&this.set_$Qq(null);this.get_$5D()&&this.set_$5D(null);_js.$8.$c(this.get_$Ms())||this.set_$Ms(null);this.get_$Ko()&&this.set_$Ko(!1);_js.$8.$c(this.get_$ST())||this.set_$ST(null);_js.$8.$c(this.get_$PQ())||this.set_$PQ(null);_js.$8.$c(this.get_$O6())||this.set_$O6(null);this.get_$1Pq()&&this.set_$1Pq(!1);this.get_$7J()!=="Normal"&&this.set_$7J("Normal");this.get_$FN()&&this.set_$FN(!1);this.get_$Eg()&&this.set_$Eg(!1);this.get_$Dw()&&this.set_$Dw(!1);this.get_$F1()&&this.set_$F1(!1);this.get_$3E()&&this.set_$3E(null);_js.$8.$c(this.get_$1vJ())||this.set_$1vJ(null);this.get_$yG()&&this.set_$yG(!1);this.get_$mY()&&this.set_$mY(!1);this.get_$16S()&&this.set_$16S(!1);this.get_$2Df()&&this.set_$2Df(!1);this.get_$UM()&&this.set_$UM(null);_js.Trace.logInfo(_a.$0.$d,"Context reset end.")},$3iS:function(){return!!this.get_$9R().get_$5D()&&0===this.get_$9R().get_$5D().get_$Fh()&&!this.get_$9R().get_$5D().get_$3Vi()&&!this.get_$9R().get_$5D().get_$2fv()},$3Zk:function(){var n=null;if(this.get_$35()&&this.get_$35().Mailbox&&!_js.$8.$c(this.get_$35().Mailbox.EmailAddress))n=this.get_$35().Mailbox;else if(this.get_$9o()&&this.get_$9o().Mailbox&&!_js.$8.$c(this.get_$9o().Mailbox.EmailAddress))n=this.get_$9o().Mailbox;else if(!_js.$8.$c(_d.$Q.$ua)){n=new _g.$1m;n.EmailAddress=_d.$Q.$ua;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$3iq:function(){switch(this.get_$4D()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$Qq()&&!$8(this.get_$Qq().get_$7G())&&this.get_$Qq().get_$7G()!=="IPM.Note"&&!this.get_$Qq().get_$Pm()?!1:this.get_$9R()&&!$8(this.get_$9R().get_$7G())&&this.get_$9R().get_$7G()!=="IPM.Note"&&!this.get_$9R().get_$Pm()?!1:!0},$7FQ:function(n,t){$6(this,"ShowMeetingReadonlyFields")}};_d.$mG=function(){this.$11q={}};_d.$mG.prototype={$eh:function(n){return n in this.$11q},$47y:function(n,t){if(n in this.$11q){var i=this.$11q[n];!i.$48c&&t&&(this.$11q[n]=new _d.$nC(t))}else this.$11q[n]=new _d.$nC(t)},$4t9:function(n,t){var u=n.$f;var i=u.$j;var r=i.get_$6u();var o=i.get_$9J();var f=!1;if(i.get_$16S())_js.Trace.logInfo(_a.$0.$d,"Not discarding a loaded draft for context "+r);else if(i.get_$m0())_js.Trace.logInfo(_a.$0.$d,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$1LR().$s1)_js.Trace.logInfo(_a.$0.$d,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$1AT().$K8)_js.Trace.logInfo(_a.$0.$d,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$d,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$d,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$G7()}if(e)_js.Trace.logInfo(_a.$0.$d,"Not discarding a dirty draft for context "+r);else if(i.$Sl)if(i.$Sl.$4W(i.get_$H3())){if(_g.$1Q.$KM&&i.get_$mb()&&!i.get_$9J()){_js.Trace.logInfo(_a.$0.$d,"Calling main window to remember the pending discard for context "+r);_g.$1Q.$KM.$47y(r,!i.get_$m0());f=!0}else if(!i.get_$f3()){_js.Trace.logInfo(_a.$0.$d,"Discarding unused draft for context "+r);this.$3Us(r,o,u.$p,i.get_$m0());f=!0}}else _js.Trace.logInfo(_a.$0.$d,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$d,"Not discarding without an initial baseline for context "+r)}return f},$3Us:function(n,t,i,r){i||(i=new _d.$BN(new _y.$4p));var u;if(this.$11q[n]){var f=this.$11q[n];u=f.$48c}else u=!r;if(t){var e=_d.$9v.$73b(t,u);i.$k7(e,null,null,null);delete this.$11q[n];_js.Trace.logInfo(_a.$0.$d,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$11q[n]=new _d.$nC(u);_js.Trace.logInfo(_a.$0.$d,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$7A4:function(n,t){this.$3Us(n,t,new _d.$BN(new _y.$4p),!1)}};_d.$1Z=function(){_d.$1Z.initializeBase(this)};_d.$1Z.$$cctor=function(){_d.$1Z.$1BG.set_$FQ(_d.$1Z.$2f7);_d.$1Z.$13z.set_$FQ(_d.$1Z.$2f7);_d.$1Z.$13f.set_$FQ(_d.$1Z.$2f7)};_d.$1Z.$1h0=function(n){var t=new _d.$1Z;_d.$1Z.$5x(t,n);return t};_d.$1Z.$5x=function(n,t){n.set_$2h(t.get_$2h());n.set_$Cx(t.get_$Cx());if(t.get_$4O()){n.set_$4O(new _js.$X);n.get_$4O().$6G(t.get_$4O().$7V())}else n.set_$4O(null);n.set_$Y4(t.get_$Y4());if(t.get_$4f()){n.set_$4f(new _js.$X);n.get_$4f().$6G(t.get_$4f().$7V())}else n.set_$4f(null);n.set_$WP(t.get_$WP());if(t.get_$6J()){n.set_$6J(new _js.$X);n.get_$6J().$6G(t.get_$6J().$7V())}else n.set_$6J(null);if(t.get_$85()){n.set_$85(new _js.$X);n.get_$85().$6G(t.get_$85().$7V())}else n.set_$85(null);if(t.get_$UM()){n.set_$UM(new _js.$X);n.get_$UM().$6G(t.get_$UM().$7V())}else n.set_$UM(null);n.set_$SP(t.get_$SP());n.set_$6A(t.get_$6A());n.set_$35(t.get_$35());n.set_$Ms(t.get_$Ms());n.set_$7J(t.get_$7J());n.set_$FN(t.get_$FN());n.set_$Eg(t.get_$Eg());n.set_$Dw(t.get_$Dw());n.set_$F1(t.get_$F1())};_d.$1Z.$1fe=function(n,t,i,r){if(i!==r&&!(_js.$8.$c(i)&&_js.$8.$c(r))||!_d.$1Z.$4tU(n,t))return!1;if($8(n)||$8(t))return!0;for(var u=0;u<n.get_$F();u++){var f=n.get_$48(u);var e=t.get_$48(u);if(!_d.$1Z.$3Lh(f,e))return!1}return!0};_d.$1Z.$3Lh=function(n,t){return $8(n)&&!$8(t)||$8(t)&&!$8(n)?!1:$8(n)&&$8(t)?!0:_g.$2I.$4W(n,t)};_d.$1Z.$4tU=function(n,t){var i=_d.$1Z.$4zV(n);var r=_d.$1Z.$4zV(t);return i===r};_d.$1Z.$4zV=function(n){return $8(n)?0:n.get_$F()};_d.$1Z.$4gC=function(n,t){if(!_d.$1Z.$4tU(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$F();i++){var r=n.get_$48(i);var u=t.get_$48(i);if(!_d.$1Z.$6sr(r,u))return!1}return!0};_d.$1Z.$6so=function(n,t){return _c.$Th.$4gE(n,t)};_d.$1Z.$6sr=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$40()&&t.get_$40()||!t.get_$40()&&n.get_$40()?!1:n.get_$40()&&n.get_$40().Id!==t.get_$40().Id?!1:n.get_$1Q()!==t.get_$1Q()?!1:n.get_$BL()!==t.get_$BL()?!1:n.get_$Qj()!==t.get_$Qj()?!1:n.get_$25z()!==t.get_$25z()?!1:n.get_$5y()!==t.get_$5y()?!1:!n.get_$B4()&&t.get_$B4()||!t.get_$B4()&&n.get_$B4()?!1:n.get_$B4()&&!n.get_$B4().$4W(t.get_$B4())?!1:n.get_$8Y()!==t.get_$8Y()?!1:!0};_d.$1Z.prototype={get_$2h:function(){return this.$W(_d.$1Z.$Vx)},set_$2h:function(n){this.$N(_d.$1Z.$Vx,n);return n},get_$Cx:function(){return this.$W(_d.$1Z.$1jQ)},set_$Cx:function(n){this.$N(_d.$1Z.$1jQ,n);return n},get_$4O:function(){return this.$W(_d.$1Z.$1BG)},set_$4O:function(n){this.$N(_d.$1Z.$1BG,n);return n},get_$Y4:function(){return this.$W(_d.$1Z.$20E)},set_$Y4:function(n){this.$N(_d.$1Z.$20E,n);return n},get_$4f:function(){return this.$W(_d.$1Z.$13z)},set_$4f:function(n){this.$N(_d.$1Z.$13z,n);return n},get_$WP:function(){return this.$W(_d.$1Z.$1h3)},set_$WP:function(n){this.$N(_d.$1Z.$1h3,n);return n},get_$6J:function(){return this.$W(_d.$1Z.$13f)},set_$6J:function(n){this.$N(_d.$1Z.$13f,n);return n},get_$SP:function(){return this.$W(_d.$1Z.$1gF)},set_$SP:function(n){this.$N(_d.$1Z.$1gF,n);return n},get_$6A:function(){return this.$W(_d.$1Z.$1m5)},set_$6A:function(n){this.$N(_d.$1Z.$1m5,n);return n},get_$35:function(){return this.$W(_d.$1Z.$1SL)},set_$35:function(n){this.$N(_d.$1Z.$1SL,n);return n},get_$Ms:function(){return this.$W(_d.$1Z.$1hP)},set_$Ms:function(n){this.$N(_d.$1Z.$1hP,n);return n},get_$7J:function(){return this.$W(_d.$1Z.$1bJ)},set_$7J:function(n){this.$N(_d.$1Z.$1bJ,n);return n},get_$FN:function(){return this.$W(_d.$1Z.$1Tr)},set_$FN:function(n){this.$N(_d.$1Z.$1Tr,n);return n},get_$Eg:function(){return this.$W(_d.$1Z.$1UZ)},set_$Eg:function(n){this.$N(_d.$1Z.$1UZ,n);return n},get_$Dw:function(){return this.$W(_d.$1Z.$1yy)},set_$Dw:function(n){this.$N(_d.$1Z.$1yy,n);return n},get_$F1:function(){return this.$W(_d.$1Z.$1z1)},set_$F1:function(n){this.$N(_d.$1Z.$1z1,n);return n},get_$85:function(){return this.$W(_d.$1Z.$1Or)},set_$85:function(n){this.$N(_d.$1Z.$1Or,n);return n},get_$UM:function(){return this.$W(_d.$1Z.$1Ro)},set_$UM:function(n){this.$N(_d.$1Z.$1Ro,n);return n},$4uz:function(n){if(this.get_$6A()!==n.get_$6A()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$6A(),n.get_$6A());return!1}if(this.get_$2h()!==n.get_$2h()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$8(this.get_$2h())?0:this.get_$2h().length,$8(n.get_$2h())?0:n.get_$2h().length);return!1}if(this.get_$Ms()!==n.get_$Ms()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$Ms(),n.get_$Ms());return!1}if(this.get_$7J()!==n.get_$7J()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$7J(),n.get_$7J());return!1}if(this.get_$FN()!==n.get_$FN()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$FN(),n.get_$FN());return!1}if(this.get_$Eg()!==n.get_$Eg()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$Eg(),n.get_$Eg());return!1}if(this.get_$Dw()!==n.get_$Dw()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$Dw(),n.get_$Dw());return!1}if(this.get_$F1()!==n.get_$F1()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$F1(),n.get_$F1());return!1}var t=this.get_$35()?this.get_$35().Mailbox:null;var i=n.get_$35()?n.get_$35().Mailbox:null;if(!_d.$1Z.$3Lh(t,i)){_js.Trace.logInfo(_a.$0.$d,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1Z.$1fe(this.get_$4O(),n.get_$4O(),this.get_$Y4(),n.get_$Y4())){_js.Trace.logInfo(_a.$0.$d,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$8(this.get_$4O())?0:this.get_$4O().get_$F(),$8(n.get_$4O())?0:n.get_$4O().get_$F(),$8(this.get_$Y4())?0:this.get_$Y4().length,$8(n.get_$Y4())?0:n.get_$Y4().length);return!1}if(!_d.$1Z.$1fe(this.get_$4f(),n.get_$4f(),this.get_$WP(),n.get_$WP())){_js.Trace.logInfo(_a.$0.$d,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$8(this.get_$4f())?0:this.get_$4f().get_$F(),$8(n.get_$4f())?0:n.get_$4f().get_$F(),$8(this.get_$WP())?0:this.get_$WP().length,$8(n.get_$WP())?0:n.get_$WP().length);return!1}if(!_d.$1Z.$1fe(this.get_$6J(),n.get_$6J(),this.get_$SP(),n.get_$SP())){_js.Trace.logInfo(_a.$0.$d,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$8(this.get_$6J())?0:this.get_$6J().get_$F(),$8(n.get_$6J())?0:n.get_$6J().get_$F(),$8(this.get_$SP())?0:this.get_$SP().length,$8(n.get_$SP())?0:n.get_$SP().length);return!1}if(!_d.$1Z.$4gC(this.get_$85(),n.get_$85())){_js.Trace.logInfo(_a.$0.$d,"snapshotAttachmentCount="+(this.get_$85()?this.get_$85().get_$F():0)+", contextAttachmentCount="+(n.get_$85()?n.get_$85().get_$F():0));return!1}if(!_d.$1Z.$6so(this.get_$UM(),n.get_$UM())){_js.Trace.logInfo(_a.$0.$d,"snapshotExtendedPropertyCount="+(this.get_$UM()?this.get_$UM().get_$F():0)+", contextExtendedPropertyCount="+(n.get_$UM()?n.get_$UM().get_$F():0));return!1}if(this.get_$Cx()!==n.get_$Cx()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$8(this.get_$Cx())?0:this.get_$Cx().length,$8(n.get_$Cx())?0:n.get_$Cx().length);return!1}_js.Trace.logInfo(_a.$0.$d,"Context is clean");return!0},$4W:function(n){if(!n){_js.Trace.logInfo(_a.$0.$d,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$6A()!==n.get_$6A()){_js.Trace.logInfo(_a.$0.$d,"sourceImportance={0}, targetImportance={1}",this.get_$6A(),n.get_$6A());return!1}if(this.get_$2h()!==n.get_$2h()){_js.Trace.logInfo(_a.$0.$d,"sourceSubject={0}, targetSubject={1}",this.get_$2h(),n.get_$2h());return!1}if(this.get_$Ms()!==n.get_$Ms()){_js.Trace.logInfo(_a.$0.$d,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$Ms(),n.get_$Ms());return!1}if(this.get_$7J()!==n.get_$7J()){_js.Trace.logInfo(_a.$0.$d,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$7J(),n.get_$7J());return!1}if(this.get_$FN()!==n.get_$FN()){_js.Trace.logInfo(_a.$0.$d,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$FN(),n.get_$FN());return!1}if(this.get_$Eg()!==n.get_$Eg()){_js.Trace.logInfo(_a.$0.$d,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$Eg(),n.get_$Eg());return!1}var t=this.get_$35()?this.get_$35().Mailbox:null;var i=n.get_$35()?n.get_$35().Mailbox:null;if(!_d.$1Z.$3Lh(t,i)){_js.Trace.logInfo(_a.$0.$d,"sourceFrom={0}, targetFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1Z.$1fe(this.get_$4O(),n.get_$4O(),this.get_$Y4(),n.get_$Y4())){_js.Trace.logInfo(_a.$0.$d,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4O()?this.get_$4O().get_$F():0,n.get_$4O()?n.get_$4O().get_$F():0,this.get_$Y4(),n.get_$Y4());return!1}if(!_d.$1Z.$1fe(this.get_$4f(),n.get_$4f(),this.get_$WP(),n.get_$WP())){_js.Trace.logInfo(_a.$0.$d,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4f()?this.get_$4f().get_$F():0,n.get_$4f()?n.get_$4f().get_$F():0,this.get_$WP(),n.get_$WP());return!1}if(!_d.$1Z.$1fe(this.get_$6J(),n.get_$6J(),this.get_$SP(),n.get_$SP())){_js.Trace.logInfo(_a.$0.$d,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$6J()?this.get_$6J().get_$F():0,n.get_$6J()?n.get_$6J().get_$F():0,this.get_$SP(),n.get_$SP());return!1}if(!_d.$1Z.$4gC(this.get_$85(),n.get_$85())){_js.Trace.logInfo(_a.$0.$d,"sourceAttachmentCount="+(this.get_$85()?this.get_$85().get_$F():0)+", targetAttachmentCount="+(n.get_$85()?n.get_$85().get_$F():0));return!1}if(this.get_$Cx()!==n.get_$Cx()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$Cx()?this.get_$Cx().length:0,n.get_$Cx()?n.get_$Cx().length:0);return!1}_js.Trace.logInfo(_a.$0.$d,"snapshot is clean");return!0}};_d.$13N=function(n,t){this.$$d_$7De=Function.createDelegate(this,this.$7De);if($8(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$2RN=t;this.$8U=n};_d.$13N.prototype={$2RN:0,$8U:null,$12D:null,$7ck:!0,$10:function(){!this.$12D&&this.$7ck&&(this.$12D=_js.$K.get_$L().$21(_a.$0.$d,"MailComposeTimer",this.$$d_$7De,this.$2RN))},$1u:function(){if(this.$12D){_js.Trace.logInfo(_a.$0.$d,"Clearing timer.");this.$12D=_js.$K.get_$L().$5G(this.$12D)}},$7De:function(){_js.Trace.logInfo(_a.$0.$d,"Executing timer callback.");this.$1u();this.$8U()}};_d.$AA=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_d.$AA.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$AA.initializeBase(this);this.$j=n;this.$1r=t||new _y.$4p;this.$z=this.$wF();this.$ON=i;this.$66=r;this.$1kQ=u;this.$p=new _d.$BN(this.$1r);this.$1LI=f;this.$1Jr=s;this.$50=e;this.$G=o;this.$FG=h;this.$jg=c;this.$S=l;this.$87=v;this.$15H=p;this.$DD=a;this.$30=w;this.$WT=b;this.$1K=y;_js.Trace.logInfo(_a.$0.$d,"ViewModel created")};_d.$AA.$7HE=function(){return(new Date).getTime()+":"+Math.random()};_d.$AA.prototype={$ON:null,$j:null,$66:null,$1kQ:null,$1LI:null,$50:null,$1Jr:null,$1r:null,$G:null,$87:null,$15H:null,$FG:null,$S:null,$jg:null,$1K:null,$WT:null,$16:null,$p:null,$R7:null,$z:null,$2E6:!1,$Pk:!1,$37J:!1,$3Af:null,$36w:!1,$bk:!1,$DD:null,$30:null,get_$en:function(){return this.$z},set_$en:function(n){if(this.$z!==n){this.$z=n;$6(this,"InfoBarViewModel")}return n},get_$1GF:function(){return this.$16.$3S(0)},get_$3As:function(){return this.$16.$3S(11)},get_$1u4:function(){return this.$16.$3S(2)},get_$7Bs:function(){return this.$16.$3S(14)},get_$YI:function(){return this.$16.$3S(5)},get_$94p:function(){return this.$16.$3S(12)},get_$71I:function(){return this.$16.$3S(17)},get_$7hq:function(){return this.$16.$3S(4)},get_$Nj:function(){return this.$16.$3S(1)},get_$7Ub:function(){return this.$16.$3S(6)},get_$1AT:function(){return this.$16.$3S(7)},get_$1LR:function(){return this.$16.$3S(8)},get_$1TX:function(){return this.$16.$3S(9)},get_$1qD:function(){return this.$16.$3S(10)},get_$14B:function(){return this.$16.$3S(18)},get_$8wd:function(){return this.$16.$3S(20)},get_$6zI:function(){return this.$16.$3S(3)},get_$5Hn:function(){return this.$16.$3S(19)},get_$5pB:function(){return this.$16.$3S(25)},get_$4t5:function(){return this.$16.$3S(21)},get_$3XB:function(){return this.$16.$3S(24)},get_$7ek:function(){return this.$16.$3S(26)},get_$7Bq:function(){return this.$16.$3S(27)},get_$5CH:function(){return!this.$G.get_$6Q()},get_$93q:function(){return!!this.get_$1TX()&&!this.$G.get_$Qz()},get_$427:function(){return 4},get_$2Ao:function(){return this.get_$3As()?this.get_$3As().$$d_$2Ao:null},get_$8K:function(){return this.$R7},set_$8K:function(n){_js.Trace.logInfo(_a.$0.$d,"Shell setting ClosePopupCommand from "+(this.$R7?"non-null":"null")+" to "+(n?"non-null":"null"));this.$R7=n;return n},get_$7A8:function(){return!0},get_$2lj:function(){return _a.UserAgent.getInstance().$y0},get_$sH:function(){return _a.UserAgent.getInstance().$be},get_$Ug:function(){return _a.UserAgent.getInstance().$JT},get_$Kp:function(){return _a.UserAgent.getInstance().$8O},get_$Jr:function(){return this.$G.get_$O()==="Mouse"?0:1},get_$3ih:function(){return this.$2E6},set_$3ih:function(n){this.$2E6=n;return n},get_$5Az:function(){return this.$Pk},set_$5Az:function(n){if(this.$Pk!==n){this.$Pk=n;$6(this,"IsInView")}return n},get_$613:function(){return this.$37J},set_$613:function(n){var t=this.get_$60j();if(this.$37J!==t){this.$37J=t;$6(this,"ShouldShowToolbarMessage")}return n},get_$66o:function(){return this.$3Af},set_$66o:function(n){if(this.$3Af!==n){this.$3Af=n;$6(this,"ToolbarMessage")}return n},get_$91F:function(){return this.$36w},set_$91F:function(n){var t=this.get_$60j();if(t!==this.$36w){this.$36w=t;$6(this,"ShouldBlockView")}return n},get_$mW:function(){return this.$bk},set_$mW:function(n){if(this.$bk!==n){this.$bk=n;$6(this,"IsNavigatingAway")}return n},get_$60j:function(){return this.get_$1TX()&&(this.get_$1TX().get_$2E3()||this.get_$1TX().get_$2oB())?!0:this.get_$1AT()&&this.get_$1AT().$K8?!0:!1},get_$4tX:function(){return!_a.$z.get_$73()||_a.$z.get_$73().toLowerCase()!=="pl-pl"},$3v:function(){this.$j.get_$6u()&&this.$j.get_$16b()||this.$j.set_$6u(_d.$AA.$7HE());_js.Trace.logInfo(_a.$0.$d,"Init:Context:"+this.$j.toString());this.$16||(this.$16=new _d.$N7(this,this.$DD,this.$87,this.$1K,this.$15H,this.$30));this.$z&&this.$z.$Ar();this.set_$mW(!1);this.$16.$3S(0).$3v()},$8xM:function(n){this.set_$7E(n);_js.Trace.logInfo(_a.$0.$d,"Set screen view model appbar. ContextId="+this.$j.get_$6u())},$Fe:function(){_y.$1De.prototype.$Fe.call(this);var n=this.get_$1GF();if(n.get_$CL()){_js.Trace.logInfo(_a.$0.$d,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$4hi()}else _js.Trace.logInfo(_a.$0.$d,"PostTransitionIn view model, not initialized yet");this.set_$5Az(!0);_a.$5.acea(null,"VM.MailCompose.Navigate")},$Rx:function(){_js.Trace.logInfo(_a.$0.$d,"Post transition out, context:"+this.$j.toString());if(this.$16){var t=this.get_$1u4();if(t){var n=t.get_$3L();if(n&&n.get_$2nP()){this.$16.$Ar();this.$j&&this.$j.$Ar();this.$z&&this.$z.$B2.$1u();this.get_$3XB()&&this.get_$3XB().$7e.$3cS(!1);n.set_$2nP(!1)}else _js.Trace.logInfo(_a.$0.$d,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$d,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$d,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2E6=!1;this.set_$5Az(!1);_y.$1De.prototype.$Rx.call(this)},$G7:function(){var n=this.$16.$3S(5);if(n.get_$Ik()){_js.Trace.logInfo(_a.$0.$d,"Dirty due to attachment in progress");return!0}var t=this.$16.$3S(1);t.$2SF();return this.$j.$G7()},$wF:function(){$8(this.$z)&&this.set_$en(new _y.$8L);return this.$z},$8js:function(){_h.$46.$8jr()},$8tH:function(){_h.$46.$5ut()},$59:function(){_js.Trace.logInfo(_a.$0.$d,"Disposing view model, context: "+(this.$j?this.$j.toString():"null"));if(this.$16){this.$16.$Ar();this.$16=null}_a.$1.prototype.$59.call(this)}};_d.$KR=function(n,t,i,r){this.$$d_$7Ld=Function.createDelegate(this,this.$7Ld);this.$$d_$3SB=Function.createDelegate(this,this.$3SB);this.$$d_$75r=Function.createDelegate(this,this.$75r);_d.$KR.initializeBase(this);this.$4lr=r;this.$6j=r.$6j;this.$30=n;this.$t=t;this.$3H=r.$3H;this.$6M=i};function $2U7(n,t,i){n.$198=t;i||(i=!_y.$j.$g.get_$6Q());var r=n.$6M.$GU(i,!1);i&&r.set_$5L(0);var u=null;switch(t){case 1:u=r.get_$5L()?"MailComposeReply":"MailComposeReplyPopOut";break;case 2:u=r.get_$5L()?"MailComposeReplyAll":"MailComposeReplyAllPopOut";break;case 3:u=r.get_$5L()?"MailComposeForward":"MailComposeForwardPopOut";break;case 12:u="MailComposePostReply";break;default:break}u&&r.set_$oK(_y.$55.$1V(_a.$0.$Dn,u,!0));r.set_$1ZC(n.$6j.get_$22());n.$3H&&r.set_$jV(n.$3H.get_$jV());r.set_$4D(n.$198);r.set_$Mb(!0);r.set_$mb(!0);var f=new _g.$Bk;f.Mailbox=new _g.$1m;f.Mailbox.EmailAddress=n.$t.get_$38().get_$Br();f.Mailbox.Name=n.$t.get_$38().get_$Gz();f.Mailbox.MailboxType="Mailbox";f.Mailbox.RoutingType="SMTP";r.set_$9o(f);if(_g.$39.isInstanceOfType(n.$6j)){var e=n.$6j;if(e.get_$yC())r.$165(e);else{r.set_$yG(!0);r.set_$Zs(n.$6j.get_$i());r.set_$mY(_g.$39.$mY(e))}}else r.$165(n.$6j);n.get_$3L().$VM(r)}_d.$KR.prototype={$t:null,$30:null,$6j:null,$3H:null,$4lr:null,$6M:null,$2o:null,$198:0,get_$3L:function(){$8(this.$2o)&&(this.$2o=new _y.$99);return this.$2o},set_$3L:function(n){this.$2o=n;return n},$1Yk:function(n){_a.$5.stPT(_a.$0.$Dn,"MailComposeReply",3);var t=this.$6j.get_$i();var i=this.$6j.get_$3E();var r=this;this.$30.$I(function(n){n.$4EG("Inference.Reply",t,i)});$2U7(this,1,n)},$1Yl:function(n){_a.$5.stPT(_a.$0.$Dn,"MailComposeReplyAll",3);var t=this.$6j.get_$i();var i=this.$6j.get_$3E();var r=this;this.$30.$I(function(n){n.$4EG("Inference.ReplyAll",t,i)});$2U7(this,2,n)},$3yk:function(n){_a.$5.stPT(_a.$0.$Dn,"MailComposePostReply",3);var t=this.$6j.get_$i();var i=this;this.$30.$I(function(n){n.$P9("Inference.PostReply",t)});$2U7(this,12,n)},$1YV:function(n){_a.$5.stPT(_a.$0.$Dn,"MailComposeForward",3);var t=this.$6j.get_$i();var i=this.$6j.get_$3E();var r=this;this.$30.$I(function(n){n.$4EG("Inference.Forward",t,i)});$2U7(this,3,n)},$5kh:function(){if(!this.$4lr.get_$2aB())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$g.$1i.nameToId("drafts");var n=new _c.$xx(this.$6j.get_$i().Id,t.Id);n.add_$2A(this.$$d_$75r);n.add_$20(this.$$d_$3SB);OwaApplication.$1T.$y(n)},$75r:function(n){var i=n.$1Xy;if(i.length>0){var t=_d.$9v.$3Rb(_g.$1j.$26E(i));t.add_$2A(this.$$d_$7Ld);t.add_$20(this.$$d_$3SB);OwaApplication.$1T.$y(t)}else this.$3SB(n)},$3SB:function(n){this.$3H.get_$en().$5c(9500);this.$3H.get_$en().$2r(9500)},$7Ld:function(n){var t=n;if(t.$EZ){this.$3H.get_$en().$5c(9500);var i=this.$6M.$3RI(t.get_$i(),!1,t.$EZ.get_$cY(),t.$EZ.get_$5D());_y.$j.$g.get_$6Q()||i.set_$5L(0);this.get_$3L().$VM(i)}else this.$3SB(n)}};_d.$mK=function(n,t,i){this.$30=n;this.$t=t;this.$6M=i};_d.$mK.prototype={$30:null,$t:null,$6M:null,$8M:function(n){return new _d.$KR(this.$30,this.$t,this.$6M,n)}};_d.$gr=function(){_d.$gr.initializeBase(this)};_d.$gr.prototype={$1bI:null,$1bH:"Normal",$1n3:!1,$1oE:!1,$11k:!1,$11l:!1,$38e:!1,$38h:!1,$2o:null,$38E:!1,$4GT:!1,$4GN:!1,get_$8x1:function(){if($8(this.$1bI)){this.$1bI=new _js.$X;this.$1bI.$H("Normal");this.$1bI.$H("Personal");this.$1bI.$H("Private");this.$1bI.$H("Confidential")}return this.$1bI},get_$7J:function(){return this.$1bH},set_$7J:function(n){if(this.$1bH!==n){this.$1bH=n;$6(this,"Sensitivity")}return n},get_$FN:function(){return this.$1n3},set_$FN:function(n){if(this.$1n3!==n){this.$1n3=n;$6(this,"IsDeliveryReceiptRequested")}return n},get_$92m:function(){return!OwaApplication.$xO},get_$Eg:function(){return this.$1oE},set_$Eg:function(n){if(this.$1oE!==n){this.$1oE=n;$6(this,"IsReadReceiptRequested")}return n},get_$93x:function(){return!OwaApplication.$xO},get_$94L:function(){return this.$38E},set_$94L:function(n){if(this.$38E!==n){this.$38E=n;$6(this,"ShowSmimeOptions")}return n},get_$Dw:function(){return this.$11k},set_$Dw:function(n){if(this.$11k!==n){this.$11k=n;$6(this,"SmimeEncryptMessage")}return n},get_$F1:function(){return this.$11l},set_$F1:function(n){if(this.$11l!==n){this.$11l=n;$6(this,"SmimeSignMessage")}return n},get_$63C:function(){return this.$38e},set_$63C:function(n){if(this.$38e!==n){this.$38e=n;$6(this,"SmimeEncryptMessageIsEnabled")}return n},get_$63E:function(){return this.$38h},set_$63E:function(n){if(this.$38h!==n){this.$38h=n;$6(this,"SmimeSignMessageIsEnabled")}return n},get_$9Gq:function(){return this.$4GN},set_$9Gq:function(n){if(this.$4GN!==n){this.$4GN=n;$6(this,"WaitingForPreviousAction")}return n},get_$3L:function(){return this.$2o},set_$3L:function(n){if(this.$2o!==n){this.$2o=n;$6(this,"Conductor")}return n},$xs:function(n){this.$4GT=n.get_$1HF();this.set_$94L(_a.$1A.$2x&&_a.$1A.get_$1mq()&&n.$3iq());this.set_$9Gq(!1);this.set_$7J(n.get_$7J());this.set_$FN(n.get_$FN());this.set_$Eg(n.get_$Eg());this.set_$Dw(n.get_$Dw());this.set_$F1(n.get_$F1());this.set_$63C(n.get_$63C());this.set_$63E(n.get_$63E())}};_d.$1Do=function(n,t,i,r,u){_d.$1Do.initializeBase(this);this.$5eD=n;this.$4w8=i;this.$4un=r;this.$5yK=_js.$8.$c(t)?_u.Strings.l_SubmessageSeparator_Text:t;this.$55b=u};_d.$1Do.prototype={$5eD:null,$4w8:null,$4un:null,$5yK:null,$55b:!1};_d.$CC=function(n,t){this.$1vY={};this.$1AJ=n;this.$Ge=t;$6JR(this)};function $6JR(n){var t=!1;n.$1AJ.get_$F()>0&&(t=_g.$8a.isInstanceOfType(n.$1AJ.get_$48(0)));n.$Ge==="sentitems"?$6JM(n,t):$6JL(n,t)}function $6JM(n,t){for(var i=0;i<n.$1AJ.get_$F();i++){var r=$6JP(n,n.$1AJ.get_$48(i),t);if(r)for(var u=0;u<r.length;u++){var f=r[u];$4LM(n,f)}$4LL(n,n.$1AJ.get_$48(i),t)}}function $6JL(n,t){for(var i=0;i<n.$1AJ.get_$F();i++){var r=$6JQ(n,n.$1AJ.get_$48(i),t);$4LM(n,r);$4LL(n,n.$1AJ.get_$48(i),t)}}function $6JQ(n,t,i){var u="";var e=new _y.$iP;if(i){var f=t;u=f.get_$1BW()?e.$39(f.get_$1BW().get_$9JV(),null):""}else{var r=t;switch(r.get_$7A()){case 1:case 5:r.get_$35()&&r.get_$35().Mailbox&&(u=r.get_$35().Mailbox.Name);break;case 2:r&&r.get_$Cl()&&r.get_$Cl().Mailbox&&(u=r.get_$Cl().Mailbox.Name);break}}return u}function $4LM(n,t){t&&t!==""&&(n.$1vY[t]=t in n.$1vY?n.$1vY[t]+1:1)}function $4LL(n,t,i){if(t)if(i){var r=t;r.get_$FL()&&n.$3wp++}else{var u=t;u.get_$FL()&&n.$3wp++}}function $6JP(n,t,i){return i?$6JN(n,t):$6JO(n,t)}function $6JO(n,t){var i=null;_g.$7f.isInstanceOfType(t)&&(i=t);if(i&&i.get_$4O()){var r=i.get_$4O();if(r){var u=r.get_$9JV();var f=new _y.$Ta;return f.$39(u,!1).split("; ")}}return null}function $6JN(n,t){return t&&t.get_$2S7()?t.get_$2S7().$7V():null}_d.$CC.prototype={$1AJ:null,$Ge:"calendar",$3wp:0};_d.$sK=function(){this.$1MY=new _c.$EL};_d.$sK.prototype={$1MY:null,$7VB:function(n,t){return new _d.$lr(n,t)},$3SF:function(n,t,i){this.$1MY.set_$8vJ(i);return new _c.$ls(n,this.$1MY,t)}};_d.$lr=function(n,t){this.$46N=new _d.$ce;this.$10h=new _d.$PP;this.$10h.apcl("SelectedRefiner",n);this.$xF=new _d.$PP;this.$xF.apcl("SelectedRefiner",n);$6O3(this,t);this.$13a=new _d.$PP;this.$13a.apcl("SelectedRefiner",n);this.$1Qq=new _d.$PP;this.$1Qq.apcl("SelectedRefiner",n)};function $6O3(n,t){var i=n.$46N.$73z(t);n.$xF.$36k(i,!0)}_d.$lr.prototype={$46N:null,$10h:null,$xF:null,$13a:null,$1Qq:null,get_$8k7:function(){return this.$10h},set_$8k7:function(n){this.$10h=n;return n},get_$7GF:function(){return this.$xF},set_$7GF:function(n){this.$xF=n;return n},get_$6ti:function(){return this.$13a},set_$6ti:function(n){this.$13a=n;return n},get_$77U:function(){return this.$1Qq},set_$77U:function(n){this.$1Qq=n;return n},$8zi:function(n,t,i,r){var u;var f;var e;var o,s,h;this.$46N.$4pD(n,o={val:u},s={val:f},h={val:e},i,t);u=o.val;f=s.val;e=h.val;this.$10h.$36k(u,r);this.$13a.$36k(f,r);this.$1Qq.$36k(e,r)},$6yH:function(){this.$10h&&this.$10h.$44k();this.$13a&&this.$13a.$44k();this.$1Qq&&this.$1Qq.$44k()},$7NI:function(n){var t="";if(this.$10h&&this.$10h.get_$1b6()){var f=this.$10h.get_$1b6();var i=f.get_$33o();if(i){var r=i.$Ex;t=n?" To:("+r+")":" From:("+r+")"}}var u="";this.$13a&&this.$13a.get_$1b6()&&(u=" hasattachment:true");return t+u},$8yO:function(n,t){n==="inbox"?this.$xF.set_$1b6(null):t?this.$xF.set_$1b6(this.$xF.get_$33p().get_$48(1)):this.$xF.set_$1b6(this.$xF.get_$33p().get_$48(0))}};_d.$hL=function(n,t,i){_d.$hL.initializeBase(this,[null,i,0]);this.$7S=$6QA(this,n,t)};function $6QA(n,t,i){var r=new _g.$1m;r.EmailAddress=i;var u=_h.$3q.$E5(r);u.set_$18(1);var f=new _y.$q(u,6,!1,0,null,null,_y.$j.$g);f.$J1(0,t,0);return f}_d.$hL.prototype={$7S:null,get_$33o:function(){return this.$7S},set_$33o:function(n){if(this.$7S!==n){this.$7S=n;$6(this,"RefinerValue")}return n}};_d.$PI=function(n,t,i){_d.$PI.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$PI.initializeBase(this);this.$43b=n;this.$5fG=t;this.$5sB=i};_d.$PI.prototype={$5sB:0,$43b:null,$5fG:0,get_$33o:function(){return this.$43b},set_$33o:function(n){this.$43b=n;$6(this,"RefinerValue");return n}};_d.$PP=function(){this.$$d_$93a=Function.createDelegate(this,this.$93a);this.$2NH=new _js.$X;this.$2eL=new _js.$X;_d.$PP.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$PP.initializeBase(this);this.$61w=new _C(this.$$d_$93a,_a.$0.$CX)};function $6SO(n,t){if(t)if(t.get_$F()>3){for(var r=new _js.$X,i=0;i<3;i++)r.$H(t.get_$48(i));n.set_$3Uw(r);n.set_$49M(!0)}else{n.set_$3Uw(t);n.set_$49M(!1)}}_d.$PP.prototype={$2Oc:null,$61w:null,$49L:!1,get_$49M:function(){return this.$49L},set_$49M:function(n){this.$49L=n;$Q(this,"ShowLoadMoreButton");return n},get_$33p:function(){return this.$2NH},set_$33p:function(n){this.$2NH=n;$6SO(this,n);return n},get_$3Uw:function(){return this.$2eL},set_$3Uw:function(n){this.$2eL=n;this.$2Oc=null;$Q(this,"DisplayedRefinerValues");return n},get_$1b6:function(){return this.$2Oc},set_$1b6:function(n){this.$2Oc=n;$Q(this,"SelectedRefiner");return n},$44k:function(){this.$2NH&&this.set_$33p(new _js.$X)},$36k:function(n,t){(!this.$2Oc||t)&&this.set_$33p(n)},$93a:function(){this.set_$3Uw(this.$2NH);this.set_$49M(!1)}};_d.$ce=function(){this.$$d_$6z8=Function.createDelegate(this,this.$6z8)};function $6SQ(n,t){var u=new _js.$X;var i=[];var f=t;for(var e in f){var s={key:e,value:f[e]};Array.add(i,s)}i.sort(n.$$d_$6z8);for(var r=0;r<i.length;r++){var o=i[r];var h=o.key;var c=o.value;u.$H(new _d.$hL(h,"",c))}return u}function $6SP(n){var t=new _js.$X;t.$H(new _d.$PI(1,0,3));t.$H(new _d.$PI(2,0,3));t.$H(new _d.$PI(3,0,3));return t}_d.$ce.prototype={$4pD:function(n,t,i,r,u,f){r.val=$6SP(this);var e=new _d.$CC(n,f);var s=e.$3wp;var h=e.$1vY;var o=new _js.$X;o.$H(new _d.$PI(_u.Strings.l_AttachmentRefiner_Text,s,2));i.val=o;t.val=$6SQ(this,h)},$73z:function(n){var t=new _js.$X;n&&t.$H(new _d.$PI(0,0,1));t.$H(new _d.$PI(2,0,1));t.$H(new _d.$PI(3,0,1));return t},$6z8:function(n,t){var i=n;var r=t;return r.value-i.value}};_d.$Cd=function(n,t,i,r,u,f,e,o){this.$$d_$8ZM=Function.createDelegate(this,this.$8ZM);this.$$d_$6yZ=Function.createDelegate(this,this.$6yZ);this.$$d_$8Vj=Function.createDelegate(this,this.$8Vj);this.$$d_$8Vi=Function.createDelegate(this,this.$8Vi);this.$$d_$8dg=Function.createDelegate(this,this.$8dg);this.$$d_$8Rp=Function.createDelegate(this,this.$8Rp);_d.$Cd.initializeBase(this);_a.$3.$M(n,"message");this.$h7=n;this.$51=t;this.$4mG=f;this.$1T=i;this.$G=r;this.$Vh=u;this.$6M=e;this.$1D=o;this.$3Ld=new _C(this.$$d_$8Rp,_a.$0.$1fc);this.$43r=new _C(this.$$d_$8dg,_a.$0.$1fc);this.$4u2=new _C(this.$$d_$8Vi,_a.$0.$1fc);this.$4u3=new _C(this.$$d_$8Vj,_a.$0.$1fc);this.$qS=new _C(this.$$d_$6yZ,_a.$0.$1fc);this.$1D=_a.UserAgent.getInstance();this.$3Lc=$4LH(this,!0);this.$43p=$4LH(this,!1);this.$3Lc||(this.$4g7=this.$3Ld);this.$43p||(this.$5sS=this.$43r);$4LK(this);this.$h7.$a("LastVerbExecuted",this.$$d_$8ZM);this.$h7.get_$H2().$a("IsUndecidedApprovalRequest",this.$$d_$8ZM)};function $4LK(n){n.set_$92F(!!n.$h7.get_$H2()&&n.$h7.get_$H2().get_$3jL()&&n.$h7.get_$ia()!==1&&n.$h7.get_$ia()!==2)}function $4LH(n,t){var i=t?0:1;if(n.$h7.get_$IM()&&n.$h7.get_$IM().UserOptions&&n.$h7.get_$IM().UserOptions.length>=i&&n.$h7.get_$IM().UserOptions[i].SendPrompt==="Send")return null;var r=[new _0365m.$n(_u.Strings.l_EditResponseBeforeSending_LowerCase_Text,null,t?n.$4u2:n.$4u3),new _0365m.$n(_u.Strings.l_SendResponseNow_LowerCase_Text,null,t?n.$3Ld:n.$43r)];n.$G.get_$O()==="TouchNarrow"&&Array.add(r,new _0365m.$n(_u.Strings.l_TNarrowCloseMenuItemLabel_Text,null,n.$qS));return new _0365m.$2c(r)}function $4LJ(n,t){if(!n.$51){var i=new _c.$Xd(n.$h7,null,t,1);n.$1T.$y(i);$6JJ(n)}}function $4LI(n,t){if(!n.$51){var i=n.$6M.$GU(!1,!1);i.set_$4D(t?9:10);i.set_$Mb(!0);i.set_$5L(n.$G.get_$O()==="Mouse"?1:2);i.$165(n.$h7);n.$4mG().$VM(i)}}function $6JJ(n){switch(n.$G.get_$O()){case"TouchNarrow":n.$Vh.$BX();break;case"TouchWide":break;case"Mouse":if(!n.$G.get_$6Q()){var t=window.self;_js.$K.get_$L().$3i(_a.$0.$5i,"ApprovalRequestHeaderViewModel.PopOutClose",t.$$d_close||(t.$$d_close=Function.createDelegate(t,t.close)))}break}}_d.$Cd.prototype={$h7:null,$G:null,$6M:null,$4mG:null,$1T:null,$3Ld:null,$43r:null,$4u2:null,$4u3:null,$4g7:null,$5sS:null,$qS:null,$Vh:null,$51:!1,$1D:null,$3Lc:null,$43p:null,$37P:!1,get_$92F:function(){return this.$37P},set_$92F:function(n){if(n!==this.$37P){this.$37P=n;$6(this,"ShowApproveRejectButtons")}return n},get_$yU:function(){return this.$1D.get_$YP().$mg},$8ZM:function(n,t){$4LK(this)},$8Rp:function(){$4LJ(this,!0)},$8dg:function(){$4LJ(this,!1)},$8Vi:function(){$4LI(this,!0)},$8Vj:function(){$4LI(this,!1)},$6yZ:function(){}};_d.$jJ=function(n,t,i,r,u){this.$G=n;this.$Vh=t;this.$p=i;this.$6M=r;this.$1D=u};_d.$jJ.prototype={$G:null,$Vh:null,$p:null,$6M:null,$1D:null,$I:function(n,t,i){t||(t=_y.$99.$4rI);return new _d.$Cd(n,i,this.$p,this.$G,this.$Vh,t,this.$6M,this.$1D)}};_d.$kC=function(n){this.$3cF=n};_d.$kC.prototype={$3cF:null,get_$3iP:function(){return!1},$AU:function(){return!0},$4z7:function(n,t){var i=$8(t);return new _0365m.$Zx(new _d.$Vn(this.$3cF,this.$3cF),i)}};_d.$AT=function(n,t,i,r){this.$$d_$3xI=Function.createDelegate(this,this.$3xI);this.$$d_$5fg=Function.createDelegate(this,this.$5fg);this.$$d_$8R4=Function.createDelegate(this,this.$8R4);this.$$d_$5uy=Function.createDelegate(this,this.$5uy);this.$$d_$8lN=Function.createDelegate(this,this.$8lN);this.$$d_$8h7=Function.createDelegate(this,this.$8h7);_d.$AT.initializeBase(this);_a.$3.$M(n,"meetingRequest");this.$HH=n;this.$1T=i;this.$2f=t;this.$G=r;this.set_$3fn(!1);this.$1Zk=new _js.$X;this.$qf=new _js.$X;this.$1SF=new _js.$X;var u=this;this.$1cj=new _C(this.$$d_$8h7,_a.$0.$1o,this,"ShowConflicts",function(){return u.get_$92X()});this.$5pO=new _C(this.$$d_$8lN,_a.$0.$1o)};function $6Me(n,t){var i=this;n.$2f.$1FT(function(){var r=n.$HH.get_$1Kx().Mailbox.EmailAddress;var i=n.$2f.$4zK(r);i?n.$2f.$5Gj(i,function(){t()},function(){$4Mw(n,_u.Strings.l_UnableToGetConflicts_Text)}):$4Mw(n,String.format(_u.Strings.l_ConflictsFormSubscribedCalendarOnly_Text,n.$HH.get_$1Kx().Mailbox.Name))})}function $4Mw(n,t){n.set_$15u(t);n.set_$CL(!0)}function $6Mh(n,t){t.add_$2A(n.$$d_$8R4);t.add_$20(n.$$d_$5fg);t.add_$2m(n.$$d_$3xI)}function $6Mi(n,t){t.remove_$2A(n.$$d_$8R4);t.remove_$20(n.$$d_$5fg);t.remove_$2m(n.$$d_$3xI)}function $6Md(n){if(!n.get_$3bi()&&!n.get_$1lR()){n.set_$15u(_u.Strings.l_NoConflicts_Text);return}n.$2Ci?n.get_$1lR()?n.set_$15u(_u.Strings.l_HideConflicts_Text):n.set_$15u(_u.Strings.l_HideAdjacents_Text):n.get_$1lR()?n.set_$15u(_u.Strings.l_ShowConflicts_Text):n.set_$15u(_u.Strings.l_ShowAdjacents_Text)}function $4Mx(n,t){return t.get_$92()!=="Free"}function $6Mf(n){var i=new _js.$X;if(!$8(n.$HH.get_$1Dq()))for(var t=0;t<n.$HH.get_$1Dq().Items.length;t++){var r=new _g.$39(n.$HH.get_$1Dq().Items[t]);$4Mx(n,r)&&i.$H(r)}n.set_$715(i)}function $6Mg(n){var r=new _js.$X;var u=new _js.$X;if(!$8(n.$HH.get_$1CV()))for(var i=0;i<n.$HH.get_$1CV().Items.length;i++){var t=new _g.$39(n.$HH.get_$1CV().Items[i]);$4Mx(n,t)&&(t.get_$10().$2Y(n.$HH.get_$10())>0?u.$H(t):r.$H(t))}n.set_$8ly(r);n.set_$7GI(u)}_d.$AT.prototype={$1T:null,$2f:null,$G:null,$1cj:null,$HH:null,$1Zk:null,$qf:null,$1SF:null,$3YN:null,$361:null,$3QG:null,$42E:null,$2Ci:!1,$7M:!1,$2jV:null,$5pO:null,get_$8ly:function(){return this.$1Zk},set_$8ly:function(n){if(this.$1Zk!==n){this.$1Zk=n;$6(this,"PrecedingEvents")}return n},get_$715:function(){return this.$qf},set_$715:function(n){if(this.$qf!==n){this.$qf=n;$6(this,"ConflictingEvents")}return n},get_$7GI:function(){return this.$1SF},set_$7GI:function(n){if(this.$1SF!==n){this.$1SF=n;$6(this,"FollowingEvents")}return n},get_$92X:function(){return this.get_$60y()&&this.$7M&&(this.get_$3bi()||this.get_$1lR())},get_$3fn:function(){return this.$2Ci},set_$3fn:function(n){this.$2Ci=n;$6Md(this);$6(this,"IsConflictDetailsExpanded");return n},get_$15u:function(){return this.$2jV},set_$15u:function(n){if(this.$2jV!==n){this.$2jV=n;$6(this,"HeaderString")}return n},get_$1lR:function(){return this.$qf&&this.$qf.get_$F()>0?!0:this.$HH.get_$25w()>0},get_$3bi:function(){return this.$1Zk&&this.$1Zk.get_$F()>0||this.$1SF&&this.$1SF.get_$F()>0?!0:this.$HH.get_$23D()>0},get_$927:function(){return this.get_$3bi()&&!this.get_$1lR()},get_$714:function(){$8(this.$3QG)&&(this.$3QG=new _d.$kC(_u.Strings.l_ConflictingEvents_Text));return this.$3QG},get_$8lz:function(){$8(this.$42E)&&(this.$42E=new _d.$kC(_u.Strings.l_PrecedingEvents_Text));return this.$42E},get_$7GJ:function(){$8(this.$3YN)&&(this.$3YN=new _d.$kC(_u.Strings.l_FollowingEvents_Text));return this.$3YN},get_$CL:function(){return this.$7M},set_$CL:function(n){if(this.$7M!==n){this.$7M=n;$Ha(this,["HasConflictingMeetings","ShowAdjacentMeetingsText","IsInitialized","ShowConflicts"])}return n},get_$60y:function(){return this.$HH.get_$2GE()==="Outdated"||_d.$6N.$1nU(this.$HH)||$8(this.$HH.get_$1fk())?!1:!0},get_$7YT:function(){return this.$HH.get_$2lt()&&!!this.$HH.get_$1Kx()},$3v:function(){if(this.get_$60y())this.get_$7YT()?$6Me(this,this.$$d_$5uy):this.$5uy();else{this.$HH.get_$2GE()==="Outdated"||_d.$6N.$1nU(this.$HH)?this.set_$15u(_u.Strings.l_ConflictsNotFetchedForOutOfDateMeeting_Text):this.set_$15u(_u.Strings.l_UnableToGetConflicts_Text);this.set_$CL(!0)}},$5uy:function(){var n=new _c.$os(300,this.$HH);$6Mh(this,n);this.$1T.$y(n)},$8h7:function(){this.set_$3fn(!this.$2Ci)},$8R4:function(n){_a.$3.$HZ(this.$HH,n.$HH,"MeetingRequest");if(!this.$HH.get_$ZC()){$6Mf(this);$6Mg(this)}this.set_$3fn(!1)},$5fg:function(n){this.set_$15u(_u.Strings.l_UnableToGetConflicts_Text)},$3xI:function(n){$6Mi(this,n);this.set_$CL(!0)},$8lN:function(){if(this.$361){var n=new _y.$Ao;n.$cz(this.$361.get_$i());this.$G.$5i(_d.$I6,null,n.$3l,_y.$3p.get_$eK())}}};_d.$qp=function(n){this.$$d_$10J=Function.createDelegate(this,this.$10J);this.$$d_$8gI=Function.createDelegate(this,this.$8gI);_d.$qp.initializeBase(this);this.$bL=n;var i=this;this.$5s1=new _C(function(){$4N4(i.$bL)},_a.$0.$ws);var r=this;this.$5rJ=new _C(function(){$4N3(r.$bL)},_a.$0.$ws);var t=this;this.$bL.$a("SelectedItemsCount",function(n,i){t.set_$6sn(t.$bL.get_$7D()>0)});this.set_$46Q(new _y.$6Y("Mouse"));this.$1g.set_$15(!1);this.$1g.set_$OY(!0);this.$1g.set_$1Xb(1);this.$1g.set_$oy(!0);this.$1g.$1Ey=!1;this.$1g.set_$Gb(new _C(this.$$d_$8gI,_a.$0.$ws));this.$1g.set_$SR(new _C(this.$$d_$10J,_a.$0.$ws))};_d.$qp.prototype={$5s1:null,$5rJ:null,$bL:null,$1g:null,$2YK:!1,get_$6sn:function(){return this.$2YK},set_$6sn:function(n){if(this.$2YK===n)return n;this.$2YK=n;$6(this,"AreActionCommandsEnabled");return n},get_$46Q:function(){return this.$1g},set_$46Q:function(n){if(this.$1g!==n){this.$1g=n;$6(this,"SearchVM")}return n},$8gI:function(){if(!_js.$8.$c(this.$1g.$2k)&&this.$1g.$2k.trim().length>0){this.$1g.set_$1HC(!0);this.$bL.$CX(this.$1g,!0)}},$10J:function(){_a.$b.$4EE("VM.FindMail.Search");this.$1g.$WM();if(this.$bL.$7Z){this.$bL.set_$X2(!0);var n=this;_js.$K.get_$L().$3i(_a.$0.$ws,"LoadItemsOnCancelSearch",function(){n.$bL.$RQ(0)})}}};_d.$CM=function(n,t,i,r,u,f){this.$$d_$7Dw=Function.createDelegate(this,this.$7Dw);this.$$d_$7Dx=Function.createDelegate(this,this.$7Dx);_d.$CM.initializeBase(this,[n,null,t,i,u,r,f]);this.$7VC();this.set_$aL(new _h.$BA("DateTimeReceived","Descending"))};function $4N4(n){if(n.get_$7D()){var t=new _a.$4f([_u.Strings.l_RecoverItemsPontDescription_Text,_u.Strings.l_RecoverItemsPointMailItems_Text,_u.Strings.l_RecoverItemsPointCalendarItems_Text,_u.Strings.l_RecoverItemsPointContacts_Text,_u.Strings.l_RecoverItemsPointTasks_Text],1,n.$$d_$7Dx,1,!1,_u.Strings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_u.Strings.l_RecoverItemsPontHeader_Text);n.$S.$8oV(_a.$4f,t)}}function $4N3(n){if(n.get_$7D()){var t=new _a.$4f([_u.Strings.l_ConfirmPurgeDescription_Text],1,n.$$d_$7Dw,1,!1,_u.Strings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_u.Strings.l_ConfirmPurgePontHeader_Text);n.$S.$8oV(_a.$4f,t)}}function $4N2(n,t,i){if(t&&!(n.get_$7D()<=0)){var r=$pn(n,$vK(n));i();$YB(n,null);$YB(n,r);$kW(n)}}function $2To(n,t,i){if(!(t.length<=0)){var r=new _h.$KX(t,i.get_$n(),0);OwaApplication.$1T.$y(r)}}_d.$CM.prototype={$7Dw:function(n,t){var i=this;$4N2(this,n,function(){i.$GX("HardDelete");_a.$b.$7W("VM.MailUsage.PurgeFromDumpster")})},$7Dx:function(n,t){var i=this;$4N2(this,n,function(){for(var r=i.$3U,u=[],f=[],e=[],o=[],t=0;t<r.get_$F();t++){var n=r.get_$48(t);switch(n.get_$7A()){case 2:Array.add(u,n);break;case 3:Array.add(o,n);break;case 4:Array.add(e,n);break;case 1:case 0:default:Array.add(f,n);break}}$2To(i,f,_g.$2Q.$9K("inbox"));$2To(i,u,_g.$2Q.$9K("calendar"));$2To(i,e,_g.$2Q.$9K("tasks"));$2To(i,o,_g.$2Q.$9K("contacts"));_a.$b.$7W("VM.MailUsage.RecoverFromDumpster")})},$2L4:function(n,t){$6(this,"SelectedItems")},$7VC:function(){var n=[];var t=this;Array.add(n,new _0365m.$n(_u.Strings.l_RecoverItemMenuOption_Text,null,new _C(function(){$4N4(t)},_a.$0.$ws)));var i=this;Array.add(n,new _0365m.$n(_u.Strings.l_PurgeItemMenuOption_Text,null,new _C(function(){$4N3(i)},_a.$0.$ws)));this.$Aj=new _0365m.$2c(n)}};_d.$zR=function(n){this.$2i=n};_d.$zR.prototype={$2i:null};_d.$12b=function(n,t,i,r){this.$G=n;this.$bs=t;this.$pG=r;this.$La=i};_d.$12b.prototype={$bs:null,$pG:null,$G:null,$La:null,$ct:function(n){var t=n.AttachmentItemID;return new _d.$Bc(this.$G,this.$bs,this.$La,this.$pG,t)},$wD:function(n){throw Error.notImplemented("Creating from context is not supported");}};_d.$Bc=function(n,t,i,r,u){this.$$d_$50W=Function.createDelegate(this,this.$50W);this.$$d_$7L3=Function.createDelegate(this,this.$7L3);_d.$Bc.initializeBase(this);this.$1r=new _y.$4p;this.$G=n;this.$G.get_$O()==="TouchNarrow"&&this.set_$7E(_y.$26.$I(this));this.$bs=t;this.$pG=r;this.$La=i;this.$7s=_g.$1j.$26E(u);if(u.startsWith("smime-"))$6O5(this,u);else{var f=new _at.$Yu(u);f.add_$2A(this.$$d_$7L3);f.add_$20(this.$$d_$50W);OwaApplication.$1T.$y(f)}};function $4NS(n,t){n.set_$2pF(n.$bs.$8M(t,!1,!0,!1,null,null,!1));n.set_$3h1(!0)}function $3F5(n){var t=this;n.$1r.$3A(0,_u.Strings.l_ItemAttachmentOpenFailure_Text,function(n,t){window.close()})}function $6O4(n,t){var i=this;n.$pG.$I(function(i){n.$kE||n.set_$98x(i.$I());t&&t(n.$kE)})}function $6O5(n,t){var f=_a.$1A.$2hV(t);if(!f){_js.Trace.logError(_d.$Bc.$D,"Cannot get attachment content of {0} from window.opener.",t);$3F5(n);return}_a.$1A.$1PH(t,f);var c=_a.$1A.$lv();var l=c.parse(f);var r=JsonParser.deserialize(l);if(r.errorCode)$3F5(n);else{for(var a=JsonParser.deserialize(r.body),i=_g.$w.$I(a),s=r.attachments,v=s.length,e=0;e<v;++e){var h=s[e];_a.$1A.$1PH(h.attachmentId,h.base64Content)}i.set_$3ip(!0);i.set_$k3(r.smimeType);i.$4GR=r.wasRtf;i.$HW=r.signature;i.$Tm=i.get_$I3();i.$Tl=i.get_$1e();for(var o=0;o<i.get_$1e().get_$F();o++){var u=i.get_$1e().get_$48(o);u.$GA=!0;_g.$DA.isInstanceOfType(u)&&(i.$4GR?u.set_$157("IPM.Unsupported"):u.set_$157("IPM.Note"))}n.set_$5EQ(1);$4NS(n,i)}}_d.$Bc.prototype={$3h0:!1,$La:null,$G:null,$bs:null,$pG:null,$1r:null,$Al:null,$kE:null,$2p3:0,$7s:null,get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?_y.$1De.prototype.get_$Jr.call(this):0},get_$2pF:function(){return this.$Al},set_$2pF:function(n){this.$Al=n;$6(this,"ItemReadingPaneViewModel");return n},get_$98x:function(){return this.$kE},set_$98x:function(n){this.$kE=n;$6(this,"TaskReadingPaneViewModel");return n},get_$7TC:function(){return this.$G.get_$O()==="Mouse"},get_$3h1:function(){return this.$3h0},set_$3h1:function(n){this.$3h0=n;$6(this,"IsItemAttachmentLoaded");return n},get_$5EQ:function(){return this.$2p3},set_$5EQ:function(n){this.$2p3=n;$6(this,"ItemAttachmentCategory");return n},$7L3:function(n){var t=n.$2cU;this.set_$5EQ(t.get_$7A());_js.Trace.logInfo(_d.$Bc.$D,"GetItemAttachment succeeded for {0}",this.$2p3);switch(t.get_$7A()){case 4:var r=this;$6O4(this,function(n){n.set_$26j(t);n.set_$7a3(!0);r.set_$3h1(!0)});break;case 2:t.set_$i(this.$7s);var i=t;i.set_$1DQ(!0);i.set_$52(2);var u=this;var f=function(){u.set_$3h1(!0)};var e=this.$La.$3RX(i,f);this.$G.$hu(e,1,!0);break;default:t.set_$i(this.$7s);$4NS(this,t);break}},$50W:function(n){_js.Trace.logWarning(_d.$Bc.$D,"Open ItemAttachment failed with Error: {0}",n.$1b?n.$1b.message:"No further details");$3F5(this)}};_d.$RF=function(n,t,i,r,u,f,e){this.$$d_$50W=Function.createDelegate(this,this.$50W);this.$$d_$50h=Function.createDelegate(this,this.$50h);_d.$RF.initializeBase(this);this.$bs=n;this.$G=t;this.$5J=i;this.$93=r;this.$5B1=u;this.$5d=f;this.$60=e;this.$1r=new _y.$4p;this.$G.get_$O()==="TouchNarrow"&&this.set_$7E(_y.$26.$I(this));var o=new _h.$Gf(200,[new _g.$1j(i)],_h.$11.get_$yZ(),"ItemNormalizedBody",0,r);o.add_$2A(this.$$d_$50h);o.add_$20(this.$$d_$50W);OwaApplication.$1T.$y(o)};_d.$RF.prototype={$3h5:!1,$5J:null,$93:!1,$5B1:!1,$5d:"All",$60:null,$bs:null,$1r:null,$Al:null,$G:null,get_$2pF:function(){return this.$Al},set_$2pF:function(n){this.$Al=n;$6(this,"ItemReadingPaneViewModel");return n},get_$7a5:function(){return this.$3h5},set_$7a5:function(n){this.$3h5=n;$6(this,"IsItemLoaded");return n},get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?_y.$1De.prototype.get_$Jr.call(this):0},$50h:function(n){var i=_h.$1M.get_$L().$3k(this.$5J);var t=this.$bs.$8M(i,this.$93,!1,this.$5B1,null,this.$60,!1);t.set_$A6(this.$5d);this.set_$2pF(t);this.set_$7a5(!0)},$50W:function(n){_js.Trace.logError(_d.$RF.$D,"Open Item failed with Error: {0}",n.$1b?n.$1b.message:"No further details");var t=this;this.$1r.$3A(0,_u.Strings.l_ItemAttachmentOpenFailure_Text,function(n,t){window.close()})}};_d.$sh=function(n,t,i,r,u,f,e){this.$5J8=n;this.$4jG=t;this.$4g6=i;this.$1KQ=u;this.$p=r;this.$5dH=f;this.$1K=e};_d.$sh.prototype={$5J8:null,$4jG:null,$4g6:null,$1KQ:null,$p:null,$5dH:null,$1K:null,$4oj:function(n,t,i,r,u,f){if(_g.$RQ.isInstanceOfType(n))return this.$5J8.$I(n,t,i,r,f);else if(_g.$7f.isInstanceOfType(n)&&n.get_$H2()&&n.get_$H2().get_$3jL()&&!u)return this.$4g6.$I(n,t,r);return null},$4p9:function(n,t,i){return _g.$do.isInstanceOfType(n)?new _d.$BT(n):this.$1K&&this.$1K.$7x("ModernGroups")&&_g.$w.$7ae(n)?new _d.$Oo(n,this.$p,this.$1KQ.$I(new _d.$Gu,1),this.$5dH):_g.$w.$7Xy(n)?this.$4jG.$I(n):null}};_d.$si=function(){};_d.$si.prototype={$I:function(n){return new _y.$4N(n)}};_d.$12j=function(n,t,i,r){this.$bs=n;this.$3K=t;this.$G=i;this.$t=r};_d.$12j.prototype={$bs:null,$3K:null,$G:null,$t:null,$ct:function(n){var t=!1;var i=!1;var r="All";"IsPrintView"in n&&this.$G.set_$NK(n.IsPrintView===1);"IsDiscoveryView"in n&&(t=n.IsDiscoveryView==="1");"ViewFilter"in n&&(r=n.ViewFilter);"IsArchive"in n&&(i=n.IsArchive==="1");var u=n.ItemID;var e=new _g.$1j(u);var f=this.$t?this.$t.get_$GB():null;return new _d.$RF(this.$bs,this.$G,u,t,i,r,f)},$wD:function(n){var t=n;var r=t.get_$48();r.get_$2h()&&(window.document.title=r.get_$2h());this.$G.set_$NK(t.get_$NK());var i=this.$bs.$8M(r,t.get_$1n7(),!1,t.get_$2lQ(),null,t.get_$GB(),t.get_$yE());i.get_$sU()&&i.get_$sU().set_$jV(t.get_$jV());i.set_$A6(t.get_$A6());_g.$1Q.$KM&&_g.$1Q.$KM.$3dt(this.$3K);return i}};_d.$Ok=function(n){this.$S=n};function $6P9(n,t){switch(t){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":$6PA(n);return;case"ErrorFolderExists":$6PB(n);return}}function $6PB(n){var t=new _a.$4f([_u.Strings.l_SameNameFolderExists_Text],0,null);n.$S.$8oV(_a.$4f,t)}function $6PA(n){var t=new _a.$4f([_u.Strings.l_SharedFolderNoPermissionMessage_Sentencecase_Text],0,null,0,!1,null,null,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text);n.$S.$8oV(_a.$4f,t)}_d.$Ok.prototype={$S:null,$lz:function(n){if(n){if(_h.$QN.isInstanceOfType(n)){var i=n;var t=_h.$l.$Ia(i.$SC);if(!t||!t.$9i)return}_h.$sX.isInstanceOfType(n)&&$6P9(this,n.get_$2Nl())}}};_d.$gh=function(n,t){this.$$d_$142=Function.createDelegate(this,this.$142);this.$$d_$4ei=Function.createDelegate(this,this.$4ei);_d.$gh.initializeBase(this);this.$N6=new _d.$Tm(n);this.$4ej=t};function $6PC(n){var t=new _y.$K3;t.set_$5N(_u.Strings.l_FolderPermissionsAddUser_Lowercase_Text);t.set_$Cu(n);var e=this;var r=new _C(n.$$d_$4ei,_a.$0.$9h,n.$N6,"Persona",function(){return!!n.$N6.$12});var i=new _C(n.$$d_$142,_a.$0.$9h);t.set_$GT(i);var u=new _a.$2E(r,_u.Strings.l_FolderPermissionsAddButton_Lowercase_Text);var f=new _a.$2E(i,_u.Strings.l_CancelButtonLabel_LowerCase_Text);t.$6g.$H(u);t.$6g.$H(f);n.set_$eB(t)}_d.$gh.prototype={$8d:null,$4ej:null,$N6:null,get_$eB:function(){this.$8d||$6PC(this);return this.$8d},set_$eB:function(n){if(this.$8d!==n){this.$8d=n;$6(this,"DialogViewModel")}return n},$4ei:function(){if(this.$N6.$12){var n=new _g.$WD;n.DisplayName=this.$N6.$12.get_$1v().get_$1l();n.PrimarySmtpAddress=this.$N6.$12.get_$1v().get_$1h().EmailAddress;n.DistinguishedUser="None";this.$142();this.$4ej(n)}},$142:function(){this.get_$eB().set_$1X(!1);this.$N6.$1u()}};_d.$4s=function(n,t){this.$$d_$8hX=Function.createDelegate(this,this.$8hX);this.$$d_$8hY=Function.createDelegate(this,this.$8hY);this.$$d_$4ei=Function.createDelegate(this,this.$4ei);this.$$d_$8dt=Function.createDelegate(this,this.$8dt);this.$$d_$8RD=Function.createDelegate(this,this.$8RD);this.$$d_$3yZ=Function.createDelegate(this,this.$3yZ);_d.$4s.initializeBase(this);this.set_$Cu(this);this.set_$16U(!0);this.$p=t;this.$Zn=new _C(this.$$d_$3yZ,_d.$4s.$IR);this.$4eC=new _C(this.$$d_$8RD,_d.$4s.$IR);this.$5t5=new _C(this.$$d_$8dt,_d.$4s.$IR);this.$Qy=new _js.$X;this.$z=new _y.$8L;this.$3lh=new _d.$gh(n,this.$$d_$4ei);var i=new _a.$2E(this.$Zn,_u.Strings.l_MailFolderPermissionsDialogButtonOK_Text);var r=new _a.$2E(this.$4a,_u.Strings.l_MailFolderPermissionsDialogButtonCancel_Text);this.set_$OO(new _js.$X);this.$6g.$H(i);this.$6g.$H(r);this.set_$5N(_u.Strings.l_MailFolderPermissionsDialogTitle_Text)};_d.$4s.$$cctor=function(){_d.$4s.$2bR=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};function $pl(n){var t=n.$13.$70o();if(t!==n.$13.get_$BW()){n.$13.set_$BW(t);$6(n,"PermissionLevel")}}function $6PE(n){var t=new _h.$18n;t.$Rs=new _g.$ae;t.$Rs.set_$40z(new(_a.$1p.$$(_g.$3c,_g.$P7)));for(var i=0;i<n.$Qy.get_$F();i++){var r=n.$Qy.get_$48(i);var u=r.$46();u.set_$1Bb($6PD(n,r.get_$1Bb()));t.$Rs.get_$40z().$H(u)}t.$2B=n.$2B;t.add_$2m(n.$$d_$8hY);t.add_$20(n.$$d_$8hX);n.$p.$y(t)}function $6PD(n,t){var i=new _g.$WD;i.DistinguishedUser=t.DistinguishedUser;i.ExternalUserIdentity=t.ExternalUserIdentity;i.PrimarySmtpAddress=t.PrimarySmtpAddress;i.SID=t.SID;return i}function $4OM(n){if(n.$13){for(var t=0;t<_d.$4s.$2bR.length;t++)$6(n,_d.$4s.$2bR[t]);$3FM(n)}}function $3FM(n){if(n.$13){n.set_$7Bt(n.$13.get_$JJ()!=="All");n.set_$7ZF(!$4OL(n,n.$13.get_$1Bb()))}}function $4OL(n,t){return t.DistinguishedUser==="Anonymous"||t.DistinguishedUser==="Default"}function $4OK(n){n.$Qy.$1u();n.set_$G7(!1);n.$4a.$s()}_d.$4s.prototype={$p:null,$Zn:null,$4eC:null,$5t5:null,$3lh:null,$1r:null,$Qy:null,$oM:null,$13:null,$z:null,$2B:null,$X3:!1,$2ER:!1,$2f1:!1,$2mU:!1,get_$D2:function(){this.$1r||(this.$1r=new _y.$4p);return this.$1r},get_$8kI:function(){if($8(this.$oM)){this.$oM=new _js.$X;this.$oM.$H("Owner");this.$oM.$H("PublishingEditor");this.$oM.$H("Editor");this.$oM.$H("PublishingAuthor");this.$oM.$H("Author");this.$oM.$H("NoneditingAuthor");this.$oM.$H("Reviewer");this.$oM.$H("Contributor");this.$oM.$H("None")}return this.$oM},get_$25:function(){return this.$13},set_$25:function(n){if(this.$13===n)return n;this.$13=n;$6(this,"SelectedItem");$4OM(this);return n},get_$BW:function(){return this.$13.get_$BW()},set_$BW:function(n){if(this.$13.get_$BW()!==n){this.$13.set_$BW(n);this.set_$G7(!0);this.$13.$6sT();$6(this,"PermissionLevel");$4OM(this)}return n},get_$5rk:function(){return this.$13.get_$Xg()},set_$5rk:function(n){if(this.$13.get_$Xg()!==n){this.$13.set_$Xg(n);this.set_$G7(!0);$pl(this);$6(this,"ReadAccess")}return n},get_$4ra:function(){return this.$13.get_$GX()},set_$4ra:function(n){if(this.$13.get_$GX()!==n){this.$13.set_$GX(n);this.set_$G7(!0);$pl(this);$6(this,"DeleteAccess")}return n},get_$SS:function(){return this.$13.get_$SS()},set_$SS:function(n){if(this.$13.get_$SS()!==n){this.$13.set_$SS(n);this.set_$G7(!0);$pl(this);$6(this,"CanCreateItems")}return n},get_$4jY:function(){return this.$13.get_$WN()},set_$4jY:function(n){if(this.$13.get_$WN()!==n){this.$13.set_$WN(n);this.set_$G7(!0);$pl(this);$6(this,"CanCreateSubfolders")}return n},get_$4uB:function(){return this.$13.get_$JJ()==="Owned"||this.$13.get_$JJ()==="All"},set_$4uB:function(n){if(n){if(this.$13.get_$JJ()==="None"){this.$13.set_$JJ("Owned");this.set_$G7(!0);$pl(this);$4Z(this,"EditOwn","EditAll")}}else if(this.$13.get_$JJ()==="None"){this.set_$G7(!0);$pl(this);$4Z(this,"EditOwn","EditAll")}else this.$13.get_$JJ()==="All"&&$6(this,"EditOwn");$3FM(this);return n},get_$7Bt:function(){return this.$2f1},set_$7Bt:function(n){if(this.$2f1!==n){this.$2f1=n;$6(this,"EditOwnEnabled")}return n},get_$4u1:function(){return this.$13.get_$JJ()==="All"},set_$4u1:function(n){if(n){(this.$13.get_$JJ()==="None"||this.$13.get_$JJ()==="Owned")&&this.$13.set_$JJ("All");this.set_$G7(!0);$pl(this);$4Z(this,"EditOwn","EditAll")}else if(this.$13.get_$JJ()==="All"){this.set_$G7(!0);this.$13.set_$JJ("None");$pl(this);$4Z(this,"EditOwn","EditAll")}$3FM(this);return n},get_$Ss:function(){return this.$13.get_$Ss()},set_$Ss:function(n){if(this.$13.get_$Ss()!==n){this.$13.set_$Ss(n);this.set_$G7(!0);$pl(this);$6(this,"IsFolderOwner")}return n},get_$OV:function(){return this.$13.get_$OV()},set_$OV:function(n){if(this.$13.get_$OV()!==n){this.$13.set_$OV(n);this.set_$G7(!0);$pl(this);$6(this,"IsFolderContact")}return n},get_$7ZF:function(){return this.$2mU},set_$7ZF:function(n){if(this.$2mU!==n){this.$2mU=n;$6(this,"IsFolderContactEnabled")}return n},get_$Pj:function(){return this.$13.get_$Pj()},set_$Pj:function(n){if(this.$13.get_$Pj()!==n){this.$13.set_$Pj(n);this.set_$G7(!0);$pl(this);$6(this,"IsFolderVisible")}return n},get_$7GD:function(){return this.$Qy},set_$7GD:function(n){if(this.$Qy!==n){this.$Qy=n;$6(this,"FolderPermissionList")}return n},get_$eB:function(){return this},get_$G7:function(){return this.$X3},set_$G7:function(n){if(this.$X3!==n){this.$X3=n;$6(this,"IsDIrty")}return n},$d1:function(n,t){this.$2B=n;this.set_$5N(String.format(_u.Strings.l_MailFolderPermissionsDialogTitle_Text,n.get_$1l()));this.$Qy.$1u();this.$Qy.$6G(t.get_$40z().$7V());this.set_$25(this.$Qy.get_$48(0));this.set_$G7(!1);this.$2ER=!1;this.set_$1X(!0)},$4ei:function(n){var r=this;var i=this.$Qy.$DK(function(t){return t.$7Cx(n)});if(i!==this.$Qy.get_$F()){this.get_$D2().$3A(0,String.format(_u.Strings.l_CannotAddDuplicateUser_Text,n.DisplayName),null);return}var t=_g.$3c.$Ne.$46();t.set_$1Bb(n);this.$Qy.$H(t);this.set_$G7(!0);this.set_$25(this.$Qy.get_$48(this.$Qy.get_$F()-1))},$8rL:function(){var n=this.$Qy.$7h(this.$13);if(n!==-1){if($4OL(this,this.$13.get_$1Bb())){this.get_$D2().$3A(0,_u.Strings.l_CannotDeleteAnonymousOrDefaultUser_Text,null);return}var t=n===this.$Qy.get_$F()-1?n-1:n;this.$Qy.$3Q(this.$13);this.set_$G7(!0);var i=this.$Qy.get_$48(t);this.set_$25(i)}},$3yZ:function(){if(!this.$2ER)if(this.$X3){$6PE(this);this.$2ER=!0}else $4OK(this)},$8RD:function(){this.$3lh.get_$eB().set_$1X(!0)},$8dt:function(){this.$8rL()},$8hY:function(n){this.$2ER=!1;n.$1b||$4OK(this)},$8hX:function(n){this.$2ER=!1;var t=n.$2B.get_$1l();this.get_$D2().$3A(0,String.format(_u.Strings.l_CannotUpdatePermissionsForFolder_Text,t),null)}};_d.$NE=function(n,t,i,r,u,f,e){this.$$d_$8dp=Function.createDelegate(this,this.$8dp);this.$$d_$8qh=Function.createDelegate(this,this.$8qh);_d.$NE.initializeBase(this,[n,i,r,f,e]);this.$Vh=t;this.$1T=u||OwaApplication.$1T;var o=this;this.$5sw=new _C(this.$$d_$8qh,_a.$0.$1o,this,"CanRemove",function(){return o.get_$U8()});Object.getType(n)===_g.$Be;this.$1mr=!0;this.set_$58w(!this.$P.get_$1fk())};function $6PT(n){if(n.$2Sa){var t=n.$P.get_$1fk();return t?new _h.$J7([t],"SoftDelete",1):null}return new _c.$15c(n.$P.get_$NB())}function $6PS(n){switch(n.$G.get_$O()){case"TouchNarrow":n.$Vh.$BX();break;case"TouchWide":case"Mouse":break}}_d.$NE.prototype={$1T:null,$5sw:null,$Vh:null,$2o3:!1,$2CU:!1,get_$U8:function(){return this.$2Sa?this.$P.get_$U8()&&!this.$2CU:this.$P.get_$U8()},get_$5Cj:function(){return this.$2o3},set_$5Cj:function(n){if(this.$2o3!==n){this.$2o3=n;$6(this,"IsRemoveFromCalendarActionInProgress")}return n},get_$58w:function(){return this.$2CU},set_$58w:function(n){if(this.$2CU!==n){this.$2CU=n;$4Z(this,"IsAssociatedCalendarItemRemoved","CanRemove")}return n},$8qh:function(){var n=$6PT(this);if(n){n.add_$20(_c.$5Q.$15U);var t=this;n.add_$2A(function(){t.set_$58w(!0);$6PS(t)});n.add_$3Wy(this.$$d_$8dp);var i=this;n.add_$2m(function(){i.set_$5Cj(!1)});this.$1T.$y(n)}},$8dp:function(n){this.set_$5Cj(!0)},$7VA:function(){this.$JR=new _d.$13Y(this.$P,this.$z);this.$JR.$12a()}};_d.$as=function(n,t,i,r,u,f,e,o,s,h){this.$17E=n;this.$50=t;this.$Vh=i;this.$G=r;this.$p=u;this.$1i=f;this.$Db=e;this.$2bG=o;this.$9X=s;this.$1D=h};_d.$as.$7VI=function(n){n&&n.$3v()};_d.$as.prototype={$17E:null,$50:null,$Vh:null,$G:null,$p:null,$1i:null,$9X:null,$Db:null,$2bG:null,$1D:null,$I:function(n,t,i,r,u){var f=null;if(this.$9X.get_$1o()){_g.$Hf.isInstanceOfType(n)&&(f=new _d.$NE(n,this.$Vh,i,this.$G,this.$p,this.$50,u));if(_g.$Be.isInstanceOfType(n))if(n.get_$RF())f=new _d.$NE(n,this.$Vh,i,this.$G,this.$p,this.$50,u);else{this.$17E.$4rQ=t();f=new _d.$JK(n,i,this.$17E,this.$G,this.$Vh,this.$1i,this.$p,this.$50,this.$2bG,r,u)}_g.$NG.isInstanceOfType(n)&&(f=new _d.$t0(n,i,this.$G,this.$50,this.$Db,this.$1D,u))}else f=new _d.$uD(n,i,this.$G,this.$50,u);_d.$as.$7VI(f);return f}};_d.$kD=function(n,t,i){this.$2f=n;this.$1T=t;this.$G=i};_d.$kD.prototype={$1T:null,$2f:null,$G:null,$I:function(n){return new _d.$AT(n,this.$2f,this.$1T,this.$G)}};_d.$13Y=function(n,t){_d.$13Y.initializeBase(this,[t]);this.$HK=n};_d.$13Y.prototype={$HK:null,$7fK:function(){this.$QH=[1200]},$7HF:function(){if(!this.$HK.get_$U8()&&!$8(this.$HK.get_$B4())){var n=this.$HK.get_$B4().$2P(5);var t=this.$HK.get_$B4().$2P(0);this.$z.$2r(1200,n,t)}}};_d.$ar=function(n,t,i,r,u){_d.$ar.initializeBase(this);this.$z=t;this.$P=n;this.$G=i;this.$50=r;this.$2Sa=u};function $6PU(n){var i=n.$1Pe.$54X?n.$1Pe.$4c:null;var t=n.$P.get_$NB().get_$4h();n.$XI=new _d.$DC(t,n.get_$5C1()?t:i,n.$50,n.$G)}_d.$ar.prototype={$50:null,$G:null,$z:null,$P:null,$2Sa:!1,$XI:null,$JR:null,$1Pe:null,$1mr:!1,get_$5C1:function(){return this.$2Sa&&(this.$P.get_$5C2()||this.$1mr)},get_$7Sa:function(){return this.$1Pe.$54l||this.$1Pe.$54L},$3v:function(){this.$7Us();this.$7Uu();this.$7VA();$6PU(this)},$7Uu:function(){this.$1Pe=new _d.$q6(null)},$7VA:function(){},$7Us:function(){}};_d.$NF=function(n,t,i,r){this.$$d_$7Bm=Function.createDelegate(this,this.$7Bm);_d.$NF.initializeBase(this,[t]);this.$HK=n;this.$G=i;this.$Db=r};_d.$NF.$3Yu=function(n,t,i,r){for(var u=0,f=0;f<r.get_$F();f++){var o=r.get_$48(f);o.get_$QP()===n&&u++}var e=null;u===1?e=t:u>1&&(e=_js.$8.$4C(i,u));return e};function $6PX(n){if(n.$HK.get_$Ho()&&_d.$6N.$3ar(n.$HK)){var i=new _js.$X;n.$HK.$EH&&i.$6G(n.$HK.$EH.$7V());n.$HK.$EE&&i.$6G(n.$HK.$EE.$7V());var t=[];Array.add(t,_d.$NF.$3Yu("Accept",_u.Strings.l_OneAttendeeAccepted_Text,_u.Strings.l_AttendeesAccepted_Text,i));Array.add(t,_d.$NF.$3Yu("Tentative",_u.Strings.l_OneAttendeeTentative_Text,_u.Strings.l_AttendeesTentative_Text,i));Array.add(t,_d.$NF.$3Yu("Decline",_u.Strings.l_OneAttendeeDeclined_Text,_u.Strings.l_AttendeesDeclined_Text,i));while(Array.remove(t,null));var r;r=t.length?t.join(", "):_u.Strings.l_NoAttendeeAnswered_Text;n.$z.$2r(6700,r)}}_d.$NF.prototype={$HK:null,$G:null,$Db:null,$7fK:function(){this.$QH=[6700,6701]},$7HF:function(){$6PX(this);if(!$8(this.$HK.get_$5r8())&&!$8(this.$HK.get_$5r7())){var r=new _d.$Iz;var n=new _d.$9X;n.set_$10(this.$HK.get_$5r8());n.set_$23(this.$HK.get_$5r7());var t=_js.$8.$c(this.$HK.get_$35().Mailbox.Name)?this.$HK.get_$35().Mailbox.EmailAddress:this.$HK.get_$35().Mailbox.Name;var i=r.$39(n,null);this.$HK.get_$Ho()?this.$z.$Mk(6701,[t,i],_u.Strings.l_EditEventInfobar_Text,this.$$d_$7Bm):this.$z.$2r(6701,t,i)}},$7Bm:function(){_a.$5.$1V(_a.$0.$1o,"OpenCalendarItemOnComposeForm");var n=new _y.$Ao;n.$cz(this.$HK.get_$1fk());if(this.$G.get_$6Q())this.$G.$5i(_d.$Aq,null,n.$3l,_y.$3p.get_$eK());else{var t=this.$Db.$ct(n.$3l);this.$G.$hu(t,1,!0)}_a.$5.$1G(null,"OpenCalendarItemOnComposeForm")}};_d.$mO=function(n,t){_d.$mO.initializeBase(this,[t]);this.$HK=n};function $6PV(n){n.$HK.get_$2lt()&&n.$HK.get_$1Kx()&&n.$z.$2r(3010,n.$HK.get_$1Kx().Mailbox.Name)}_d.$mO.prototype={$HK:null,$7fK:function(){this.$QH=[3010,5100,5800,1300,1400,2200,1100]},$7HF:function(){$6PV(this);switch(this.$HK.get_$2GE()){case"FullUpdate":case"NewMeetingRequest":$4Ls(this,this.$HK);break;case"InformationalUpdate":this.$z.$2r(5800);break;case"Outdated":_d.$6N.$1nU(this.$HK)||this.$z.$2r(5100);break}$3Ec(this,this.$HK);$4Lv(this,this.$HK,!0)}};_d.$JK=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$3yQ=Function.createDelegate(this,this.$3yQ);this.$$d_$eA=Function.createDelegate(this,this.$eA);this.$4F4=["sentitems","archivedeleteditems","archivemsgfolderroot","archiverecoverableitemsdeletions","archiverecoverableitemspurges","archiverecoverableitemsroot","archiverecoverableitemsversions","archiveroot"];_d.$JK.initializeBase(this,[n,t,r,o,c]);this.$44g=n.get_$2GE();this.$17E=i;this.$2bG=s;this.$1i=f;this.$Vh=u;this.$1T=e||OwaApplication.$1T;this.$51=h;var l=this;this.$FE=new _C(this.$$d_$eA,_a.$0.$1o,this,"CanDelete",function(){return l.get_$13t()})};function $6PW(n,t){if(!n.$P.get_$22())return!0;for(var i=0;i<n.$4F4.length;i++){var r=t.nameToId(n.$4F4[i]);if(r&&r.Id===n.$P.get_$22().Id)return!0}return!1}function $4OW(n){switch(n.$G.get_$O()){case"TouchNarrow":n.$Vh.$BX();break;case"TouchWide":break;case"Mouse":if(!n.$G.get_$6Q()){var t=this;_js.$K.get_$L().$3i(_a.$0.$5i,"PopOutClose",function(){window.self.close()})}break}}_d.$JK.prototype={$1T:null,$44g:"None",$17E:null,$2bG:null,$1i:null,$51:!1,$FE:null,$Vh:null,$Od:null,$3gx:!1,$3QJ:null,get_$13t:function(){return this.get_$3gs()},get_$4jo:function(){return this.$44g!=="Outdated"&&!this.$3gx&&!this.$51},get_$6wp:function(){return this.$Od.get_$1PR()&&this.get_$4jo()},get_$6wq:function(){return this.$Od.get_$1gy()&&!this.get_$3gs()&&this.get_$4jo()},get_$7A0:function(){return this.$3gx||this.$51},get_$3gs:function(){return this.$44g==="InformationalUpdate"&&(this.$P.get_$QP()==="Accept"||this.$P.get_$QP()==="Tentative"||this.$P.get_$QP()==="Decline")},$7Uu:function(){this.$1Pe=new _d.$q6(this.$P.get_$6x5())},$7VA:function(){if(!this.get_$7A0()){this.$JR=new _d.$mO(this.$P,this.$z);this.$JR.$12a()}},$7Us:function(){this.$Od=this.$17E.$8M(this.$P.get_$NB(),0);this.$Od.$22m=0;this.$Od.add_$1O6(this.$$d_$3yQ);this.$3gx=$6PW(this,this.$1i);this.$3QJ=this.$2bG.$I(this.$P);this.$3QJ.$3v()},$eA:function(){var n=new _h.$J7([this.$P.get_$i()],"MoveToDeletedItems",0);n.$Ew=this.$P.get_$22();n.add_$20(_c.$5Q.$15U);var t=this;n.add_$2A(function(n){$4OW(t)});this.$1T.$y(n)},$3yQ:function(n){$4OW(this)}};_d.$t0=function(n,t,i,r,u,f,e){_d.$t0.initializeBase(this,[n,t,i,r,e]);this.$Db=u;this.$1D=f};_d.$t0.prototype={$Db:null,$1D:null,get_$5ul:function(){var n="";switch(this.$P.get_$QP()){case"Accept":n=_u.Strings.l_MeetingResponse_Accepted_Text;break;case"Tentative":n=_u.Strings.l_MeetingResponse_TentativelyAccepted_Text;break;case"Decline":n=_u.Strings.l_MeetingResponse_Declined_Text;break;default:throw Error.argument("Item.ResponseType","This response type is not expected.");}return String.format(_u.Strings.l_MeetingResponseFormatString_Text,this.$P.get_$9o().Mailbox.Name,n)},$7VA:function(){if(!this.$P.get_$CK()){this.$JR=new _d.$NF(this.$P,this.$z,this.$G,this.$Db);this.$JR.$12a()}}};_d.$Oo=function(n,t,i,r){this.$$d_$8nO=Function.createDelegate(this,this.$8nO);this.$$d_$8VE=Function.createDelegate(this,this.$8VE);this.$$d_$8VF=Function.createDelegate(this,this.$8VF);this.$$d_$8VG=Function.createDelegate(this,this.$8VG);_d.$Oo.initializeBase(this);_a.$3.$M(n,"message");_a.$3.$M(i,"personaCardFacade");this.$p=t;this.$EZ=n;this.$Jf=i;this.$2BL=!0;this.$Ai=!1;if(r){var u=this;r.$I(function(n){u.$tV=n;$6Pa(u)})}};function $6Pa(n){if(!n.$2Ma){var t=n.$tV.$752(n.$EZ.get_$i());t.add_$2A(n.$$d_$8VG);t.add_$20(n.$$d_$8VF);t.add_$2m(n.$$d_$8VE);n.set_$Uh(!0);n.$p.$y(t);n.set_$8nP(new _C(n.$$d_$8nO,_d.$Oo.$D))}}_d.$Oo.prototype={$Jf:null,$EZ:null,$p:null,$1lK:null,$2BL:!1,$Ai:!1,$2Ma:null,$tV:null,$Bw:null,get_$8nP:function(){return this.$2Ma},set_$8nP:function(n){if(this.$2Ma!==n){this.$2Ma=n;$6(this,"ProcessMembershipCommand")}return n},get_$4gu:function(){return new Array(0)},$f7:function(){},get_$55V:function(){return this.$2BL},set_$55V:function(n){if(this.$2BL!==n){this.$2BL=n;$6(this,"HideProcessMembershipButton")}return n},get_$bO:function(){return this.$Bw},set_$bO:function(n){if(this.$Bw!==n){this.$Bw=n;$6(this,"ErrorMessage")}return n},get_$Uh:function(){return this.$Ai},set_$Uh:function(n){if(this.$Ai!==n){this.$Ai=n;$6(this,"IsLoading")}return n},$8VE:function(n){this.set_$Uh(!1)},$8VF:function(n){this.set_$55V(!0);this.set_$bO(_u.Strings.l_ModernGroupRequest_ProcessRequestInfoFail_Text)},$8VG:function(n){var t=n;this.$1lK=_c.$i.$1E5(t.get_$1A4().GroupPersona,2);this.set_$bO("");this.set_$55V(!t.get_$1A4().IsOwner||this.$EZ.get_$35().Mailbox.EmailAddress===_g.$S.get_$L().get_$38().get_$Br())},$8nO:function(){var t=_c.$i.$E5(this.$EZ.get_$35().Mailbox);var n=new _d.$TC;n.get_$28E().$2GG=[t];n.get_$28E().$2zu=!0;this.$Jf.$2f2(this.$1lK,n)}};_d.$uD=function(n,t,i,r,u){_d.$uD.initializeBase(this,[n,t,i,r,u])};_d.$SG=function(n,t){this.$$d_$6qu=Function.createDelegate(this,this.$6qu);this.$$d_$6qv=Function.createDelegate(this,this.$6qv);this.$$d_$8rG=Function.createDelegate(this,this.$8rG);this.$$d_$5tH=Function.createDelegate(this,this.$5tH);this.$$d_$7O8=Function.createDelegate(this,this.$7O8);this.$$d_$142=Function.createDelegate(this,this.$142);this.$$d_$H=Function.createDelegate(this,this.$H);_d.$SG.initializeBase(this);this.$N6=new _d.$Tm(n);this.$p=t};function $4Ph(n){n.get_$D2().$3A(0,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text,null,!1,null,null,_u.Strings.l_SharedFolderFailedMessage_Sentencecase_Text)}_d.$SG.prototype={$8d:null,$1r:null,$p:null,$N6:null,$2iH:null,$2X8:null,$34I:null,get_$eB:function(){if(!this.$8d){this.$8d=new _y.$K3;this.$8d.set_$5N(_u.Strings.l_AddSharedFolder_Lowercase_Text);this.$8d.set_$Cu(this);var t=this;var i=new _C(this.$$d_$H,_a.$0.$9h,this.$N6,"Persona",function(){return!!t.$N6.$12});var n=new _C(this.$$d_$142,_a.$0.$9h);this.$8d.set_$GT(n);var r=new _a.$2E(i,_u.Strings.l_AddSharedFolderButton_Lowercase_Text);var u=new _a.$2E(n,_u.Strings.l_CancelButtonLabel_LowerCase_Text);this.$8d.$6g.$H(r);this.$8d.$6g.$H(u)}return this.$8d},get_$D2:function(){this.$1r||(this.$1r=new _y.$4p);return this.$1r},get_$7O9:function(){return this.$2iH},set_$7O9:function(n){this.$2iH=n;return n},get_$6qw:function(){return this.$2X8},set_$6qw:function(n){this.$2X8=n;return n},get_$8rH:function(){return this.$34I},set_$8rH:function(n){this.$34I=n;return n},$15b:function(){var n=new _c.$10J;n.add_$2A(this.$$d_$7O8);this.$p.$y(n)},$3Q:function(n){if(n){var t=new _c.$15d(n);t.add_$2A(this.$$d_$5tH);t.add_$20(this.$$d_$8rG);this.$p.$y(t)}},$H:function(){if(this.$N6.$12){var t=this.$N6.$12.get_$1v().get_$1l();var i=this.$N6.$12.get_$1v().get_$1h().EmailAddress;var n=new _c.$vs(t,i);n.add_$2A(this.$$d_$6qv);n.add_$20(this.$$d_$6qu);this.$p.$y(n);this.$142()}},$142:function(){this.get_$eB().set_$1X(!1);this.$N6.$1u()},$7O8:function(n){this.$2iH&&this.$2iH(n.$5me)},$6qu:function(n){$4Ph(this)},$6qv:function(n){if(this.$2X8){var t=n;this.$2X8(t.$6m,t.$19e)}},$8rG:function(n){$4Ph(this)},$5tH:function(n){if(this.$34I){var t=n;this.$34I(t.$19e)}}};_d.$HG=function(n){this.$$d_$7UM=Function.createDelegate(this,this.$7UM);this.$$d_$4d4=Function.createDelegate(this,this.$4d4);this.$$d_$6xB=Function.createDelegate(this,this.$6xB);_d.$HG.initializeBase(this);this.$Ay=n;this.$Ay.$HD.add_$1Z(this.$$d_$6xB);this.$HD=new _js.$X;this.$1Zh=6e4};function $6LW(n,t){_js.Trace.logInfo(_a.$0.$4H,"Notification provider: adding invitation.");var i=new _d.$jy(t,n.$$d_$4d4,n.$$d_$7UM);if(!n.$Xu){n.$Xu=!0;$6(n,"ShowNotificationInTray")}n.$HD.$H(i);$6(n,"NotificationCount");$1e6(n)}function $3Ei(n,t){_js.Trace.logInfo(_a.$0.$4H,"Notification provider: removing invitation.");n.$HD.$3Q(t);$6(n,"NotificationCount");if(!n.$HD.get_$F()){n.$Xu=!1;$6(n,"ShowNotificationInTray")}}_d.$HG.prototype={$HD:null,$Ay:null,$Xu:!1,get_$55x:function(){return _d.$4.get_$6xD()},get_$7Tx:function(){return _d.$4.get_$4H()},get_$7U6:function(){return _u.Strings.l_Chat_Notification_Title_Text},get_$2Pz:function(){return this.$Xu},get_$8l9:function(){return!0},get_$8ln:function(){return"ChatInvitationNotificationView"},get_$8Q7:function(){return this.$HD.get_$F()},get_$93e:function(){return!0},get_$3wj:function(){return"im_notify.mp3"},get_$8ll:function(){return!0},get_$b:function(){return this},$4d4:function(n){this.$Ay.$6pH(n.$8V);$3Ei(this,n)},$7UM:function(n){this.$Ay.$7UG(n.$8V);$3Ei(this,n)},$6xB:function(n,t){if(t.$3R){if(t.$3R===2)for(var f=t.$3Y[0],e=this.$HD.get_$F(),i=0;i<e;i++){var r=this.$HD.get_$48(i);if(r.$8V===f){$3Ei(this,r);break}}}else{var u=t.$2t[0];$6LW(this,u)}}};_d.$jy=function(n,t,i){this.$$d_$1TH=Function.createDelegate(this,this.$1TH);this.$$d_$2WN=Function.createDelegate(this,this.$2WN);_d.$jy.initializeBase(this);this.$8V=n;this.$2WO=t;this.$56A=i;this.$2WP=new _0365f.$QW(this.$$d_$2WN,_a.$0.$4H);this.$56C=new _C(this.$$d_$1TH,_a.$0.$4H);this.$QX=new _d.$7u(this.$8V.$4DW,_y.$q.$32a,!1);this.$EL=new _d.$7u(this.$8V.$4DW,4,!1)};_d.$jy.prototype={$8V:null,$QX:null,$EL:null,$2WP:null,$56C:null,$2WO:null,$56A:null,get_$4i:function(){return this.$8V.$66S},$2WN:function(n){_js.Trace.logInfo(_a.$0.$4H,"ChatInvitationViewModel: Accepting session {0}.",this.$8V.get_$Oa());if(n){this.$8V.$3Cs=n.get_$QD();this.$8V.$3Cx=n.get_$cj()}this.$2WO(this)},$1TH:function(){_js.Trace.logInfo(_a.$0.$4H,"ChatInvitationViewModel: Ignoring session {0}.",this.$8V.get_$Oa());this.$56A(this)}};_d.$L8=function(n){this.$$d_$77x=Function.createDelegate(this,this.$77x);this.$$d_$4d4=Function.createDelegate(this,this.$4d4);this.$$d_$8R6=Function.createDelegate(this,this.$8R6);_d.$L8.initializeBase(this);_a.$3.$17(n,"chatManager");this.$Ay=n;this.$Ay.$1DE.add_$1Z(this.$$d_$8R6);this.$HD=new _js.$X;this.$1Zh=0};function $6Jc(n,t){_a.$3.$17(t,"persona");_js.Trace.logInfo(_a.$0.$4H,"Notification provider: adding buddy request invitation.");var i=new _d.$jd(t,n.$$d_$4d4,n.$$d_$77x);if(!n.$Xu){n.$Xu=!0;$6(n,"ShowNotificationInTray")}n.$HD.$H(i);$6(n,"NotificationCount");$8(n.$362)&&n.set_$46l(n.$HD.get_$48(0));$1e6(n)}function $6Jd(n,t){_js.Trace.logInfo(_a.$0.$4H,"Notification provider: removing buddy request invitation.");n.$HD.$3Q(t);$6(n,"NotificationCount");if(n.$HD.get_$F())n.set_$46l(n.$HD.get_$48(0));else{n.$Xu=!1;$6(n,"ShowNotificationInTray")}}_d.$L8.prototype={$HD:null,$Ay:null,$Xu:!1,$362:null,get_$55x:function(){return _d.$4.get_$4e9()},get_$7Tx:function(){return _d.$4.get_$4e9()},get_$7U6:function(){return _u.Strings.l_BuddyRequest_Notification_Title_Text},get_$2Pz:function(){return this.$Xu},get_$8l9:function(){return!0},get_$8ln:function(){return"BuddyRequestNotificationView"},get_$b:function(){return this},get_$8Q7:function(){return this.$HD.get_$F()},get_$93e:function(){return!0},get_$8ll:function(){return!1},get_$46l:function(){return this.$362},set_$46l:function(n){this.$362=n;$6(this,"SelectedRequest");return n},$4d4:function(n){_a.$3.$17(n,"invitationViewModel");this.$Ay.$6pG(n.$1Lt.get_$1v())},$77x:function(n){_a.$3.$17(n,"invitationViewModel");this.$Ay.$77w(n.$1Lt.get_$1v())},$8R6:function(n,t){if(t.$3R){if(t.$3R===2)for(var f=t.$3Y[0],e=this.$HD.get_$F(),i=0;i<e;i++){var r=this.$HD.get_$48(i);if(!r.$1Lt.get_$1v().get_$8e().localeCompare(f.get_$8e())){$6Jd(this,r);break}}}else{var u=t.$2t[0];$6Jc(this,u)}}};_d.$F1=function(){this.$5d3=new _js.$X;this.$1CO=new _js.$X;_d.$F1.initializeBase(this);this.$1Zh=0};function $4Pn(n,t){n.$1CO.$H(t);$6(n,"NotificationCount");if(n.$1CO.get_$F()===1){$6(n,"ShowNotificationInTray");$1e6(n)}}function $4Pm(n,t){n.$1CO.$3Q(t);$6(n,"NotificationCount");n.$1CO.get_$F()||$6(n,"ShowNotificationInTray")}function $4Pl(n,t){n.$5d3.$H(t)}_d.$F1.prototype={get_$55x:function(){return _d.$4.get_$8ii()},get_$7Tx:function(){return _d.$4.get_$8ih()},get_$7U6:function(){return _u.Strings.l_System_Notification_Title_Text},get_$2Pz:function(){return this.$1CO.get_$F()>0},get_$8ln:function(){return"SystemNotificationsView"},get_$8Q7:function(){return this.$1CO.get_$F()},get_$93e:function(){return!0},get_$8ll:function(){return!0},get_$8l9:function(){return!1}};_d.$DG=function(n,t,i){this.$$d_$7Qy=Function.createDelegate(this,this.$7Qy);this.$$d_$7QR=Function.createDelegate(this,this.$7QR);this.$$d_$7Qk=Function.createDelegate(this,this.$7Qk);this.$$d_$8P9=Function.createDelegate(this,this.$8P9);this.$$d_$7RJ=Function.createDelegate(this,this.$7RJ);_d.$DG.initializeBase(this);this.$S=n;this.$t=t;if($8(i)||!i){var r=new _g.$Bm;r.NotificationType="NewMailNotification";r.InferenceEnabled=$4Oh(this);var u=new _h.$DH(r);u.$HX(_a.$0.$5v,"NewMailNotification",this.$$d_$7RJ,0)}this.$5eB=new _C(this.$$d_$8P9,_a.$0.$5v);$6Pe(this)};function $2UD(n){n.$Xu=!1;$6(n,"ShowNotificationInTray");n.set_$5G9("");n.set_$5GA("");n.set_$5qD("");n.$1Xy=null}function $6Pe(n){n.$S.$HX(_d.$zR,n.$$d_$7Qk);n.$S.$HX(_y.$XO,n.$$d_$7QR);n.$S.$HX(_y.$aM,n.$$d_$7Qy)}function $6Pd(n,t){return $4Oh(n)&&t.IsClutter}function $4Oh(n){return n.$t.get_$6D().get_$Ry()&&n.$t.get_$1t().get_$KR()}_d.$DG.prototype={$Xu:!1,$2pv:null,$2px:null,$32p:null,$1Xy:null,$5eS:null,$5eB:null,$S:null,$t:null,get_$55x:function(){return _d.$4.get_$7gS()},get_$7Tx:function(){return _d.$4.get_$7gR()},get_$7U6:function(){return _u.Strings.l_NewMail_Notification_Title_Text},get_$2Pz:function(){return this.$Xu},get_$8l9:function(){return!!(this.$t.get_$1t().get_$3wE()&1)},get_$8ln:function(){return"NewMailNotificationView"},get_$8Q7:function(){return 0},get_$93e:function(){return!1},get_$3wj:function(){return"email_notify.mp3"},get_$8ll:function(){return!0},get_$5G9:function(){return this.$2pv},set_$5G9:function(n){if(this.$2pv!==n){this.$2pv=n;$6(this,"Line1")}return n},get_$5GA:function(){return this.$2px},set_$5GA:function(n){if(this.$2px!==n){this.$2px=n;$6(this,"Line2")}return n},get_$5qD:function(){return this.$32p},set_$5qD:function(n){if(this.$32p!==n){this.$32p=n;$6(this,"PreviewText")}return n},$7RJ:function(n){var t=n;if(n.EventType!=="Reload"&&!$6Pd(this,t)){this.$S.$8oV(_c.$tE,new _c.$tE);this.set_$5G9(t.Sender);this.set_$5GA(t.Subject);this.set_$5qD(t.PreviewText);this.$1Xy=t.ItemId;this.$5eS=t.ConversationId;this.$Xu=!0;$6(this,"ShowNotificationInTray");$1e6(this)}},$8P9:function(){if(!$8(this.$1Xy)){var n=new _g.$1j(this.$1Xy);this.$S.$8oV(_y.$me,new _y.$me(n));$2UD(this)}},$7Qk:function(n){this.$Xu&&_g.$g.$1i.doesIdEqualName(n.$2i,"inbox")&&$2UD(this)},$7QR:function(n){this.$Xu&&n.$Be.Id===this.$5eS&&$2UD(this)},$7Qy:function(n){this.$Xu&&n.$5J.Id===this.$1Xy&&$2UD(this)}};_d.$NL=function(n){this.$$d_$3cl=Function.createDelegate(this,this.$3cl);this.$$d_$9A9=Function.createDelegate(this,this.$9A9);this.$$d_$5kq=Function.createDelegate(this,this.$5kq);this.$$d_$7RM=Function.createDelegate(this,this.$7RM);this.$$d_$53y=Function.createDelegate(this,this.$53y);_d.$NL.initializeBase(this);this.$10w=n;this.$10w.add_$5ez(this.$$d_$53y);this.$10w.add_$8Q8(this.$$d_$7RM);this.$10w.$a("ShowNotificationInTray",this.$$d_$5kq)};function $6Pg(n){n.$10w.$1Zh&&(n.$xg=_js.$K.get_$L().$21(_a.$0.$5v,"PopOutHide",n.$$d_$3cl,n.$10w.$1Zh))}function $6Pf(n){n.$xg&&(n.$xg=_js.$K.get_$L().$5G(n.$xg))}_d.$NL.prototype={$10w:null,$iT:!1,$xg:null,$48X:!1,add_$5ez:function(n){this.$2Z("NotificationRaised",n)},remove_$5ez:function(n){this.$2b("NotificationRaised",n)},get_$9AA:function(){return new _C(this.$$d_$9A9,_a.$0.$5v)},get_$2Du:function(){return this.$iT},set_$2Du:function(n){if(this.$iT!==n){this.$iT=n;$6(this,"IsPopupShown");this.$iT||$6Pf(this)}return n},get_$8Pg:function(){return _a.UserAgent.getInstance().$be?_u.Strings.l_NewNotificationButtonSafari_Text:_u.Strings.l_NewNotificationButton_Text},$3cl:function(){this.set_$2Du(!1)},$9A9:function(){this.$iT||(this.$48X=!0);this.set_$2Du(!this.$iT)},$53y:function(n){n.get_$8ll()&&this.set_$2Du(!0);$6Pg(this);$Bc(this,"NotificationRaised",this,this)},$7RM:function(n){this.$iT&&this.$3cl()},$5kq:function(n,t){this.$10w.get_$2Pz()||this.$3cl()}};_d.$Hh=function(){_d.$Hh.initializeBase(this)};function $1e6(n){$Bc(n,"NotificationRaised",n,n)}function $6Ph(n){$Bc(n,"NotificationDismissed",n,n)}_d.$Hh.prototype={$1Zh:2e3,add_$5ez:function(n){this.$2Z("NotificationRaised",n)},remove_$5ez:function(n){this.$2b("NotificationRaised",n)},add_$8Q8:function(n){this.$2Z("NotificationDismissed",n)},remove_$8Q8:function(n){this.$2b("NotificationDismissed",n)},get_$3wj:function(){return"calendar_notify.mp3"}};_d.$Ot=function(n){this.$$d_$5kq=Function.createDelegate(this,this.$5kq);this.$$d_$53y=Function.createDelegate(this,this.$53y);this.$$d_$6ro=Function.createDelegate(this,this.$6ro);_d.$Ot.initializeBase(this);this.$cb=new _js.$X;this.$3P7=$8(n)?this.$$d_$6ro:n};function $4Oi(n,t){var i=t.get_$2Pz();if(!i){var r=this;n.$cb.$Bx(function(n){i=i||n.$10w.get_$2Pz()})}n.$2R!==i&&n.set_$1X(i)}function $6Pi(n,t){n.set_$3wj(new _d.$jS(null,_y.$j.$g.$7OK(t)+"?UA=0",null));n.set_$48l(!0)}_d.$Ot.prototype={$cb:null,$3kR:null,$2R:!1,$2yi:null,$48k:!1,$3P7:null,get_$5et:function(){return this.$cb},set_$5et:function(n){if(this.$cb!==n){this.$cb=n;$6(this,"NotificationEntries")}return n},get_$3wj:function(){return this.$2yi},set_$3wj:function(n){if(this.$2yi!==n){this.$2yi=n;$6(this,"NotificationSoundSource")}return n},get_$48l:function(){return this.$48k},set_$48l:function(n){if(this.$48k!==n){this.$48k=n;$6(this,"ShouldPlayNotificationSound")}return n},get_$1X:function(){return this.$2R},set_$1X:function(n){if(this.$2R!==n){this.$2R=n;$6(this,"IsShown")}return n},$1fF:function(n){var t=new _d.$NL(n);t.add_$5ez(this.$$d_$53y);n.$a("ShowNotificationInTray",this.$$d_$5kq);$4Oi(this,n);this.$cb.$H(t)},$5kq:function(n,t){var i=n;$4Oi(this,i)},$53y:function(n){var t=n.$10w;this.$3P7()&&t.get_$2Pz()&&t.get_$8l9()&&($8(t.get_$3wj())||$6Pi(this,t.get_$3wj()))},$6ro:function(){if($8(this.$3kR)||_a.$7.get_$2M().$6E(this.$3kR)>5e3){this.$3kR=_a.$7.get_$2M();return!0}else return!1}};_d.$tO=function(){this.$5fB=new _js.$X};_d.$tO.prototype={get_$5et:function(){return this.$5fB},set_$5et:function(n){return n},get_$48l:function(){return!1},set_$48l:function(n){return n},get_$1X:function(){return!1},set_$1X:function(n){return n}};_d.$nB=function(n,t){this.$$d_$7Q0=Function.createDelegate(this,this.$7Q0);this.$$d_$7VM=Function.createDelegate(this,this.$7VM);this.$$d_$8pF=Function.createDelegate(this,this.$8pF);this.$$d_$2eC=Function.createDelegate(this,this.$2eC);this.$270=-1;_d.$nB.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$nB.initializeBase(this);this.$S=n;this.$1JK=t;this.$2eD=new _C(this.$$d_$2eC,_a.$0.$5v);this.$5s9=new _C(this.$$d_$8pF,_a.$0.$5v);$4Pl(this.$1JK,this);_js.$K.get_$L().$3i(_a.$0.$5v,"PasswordExpirationNotificationProvider::ctor",this.$$d_$7VM)};_d.$nB.prototype={$2eD:null,$5s9:null,$S:null,$1JK:null,get_$3cI:function(){return _u.Strings.l_PasswordExpiresHeader_Text},get_$99n:function(){return this.$270?_js.$8.$4C(_u.Strings.l_PasswordExpiresInNDaysTitle_Text,this.$270):_u.Strings.l_PasswordExpiresTodayTitle_Text},get_$97T:function(){return _u.Strings.l_PasswordExpiresSubTitle_Text},get_$6vE:function(){return _u.Strings.l_Yes_Text},get_$6vD:function(){return this.$5s9},get_$6vG:function(){return _u.Strings.l_No_Text},get_$6vF:function(){return this.$2eD},$7VM:function(){var n=new _c.$zt;n.add_$2A(this.$$d_$7Q0);OwaApplication.$1T.$y(n)},$7Q0:function(n){var t=n;this.$270=t.$3TY;this.$270>=0&&$4Pn(this.$1JK,this)},$2eC:function(){$4Pm(this.$1JK,this)},$8pF:function(){this.$2eC();var n=new _y.$Kn("PersonalSettings/Password.aspx");this.$S.$8oV(_y.$Kn,n)}};_d.$nq=function(n){this.$$d_$2KZ=Function.createDelegate(this,this.$2KZ);this.$$d_$8dl=Function.createDelegate(this,this.$8dl);_d.$nq.initializeBase(this);this.$oj=n;this.$443=new _d.$AI(this.$oj);this.$443.add_$8qH(this.$$d_$8dl);this.$oj.add_$6pe(this.$$d_$2KZ);this.$1Zh=0};_d.$nq.prototype={$oj:null,$443:null,$49R:!1,get_$55x:function(){return _d.$4.get_$7DR()},get_$7Tx:function(){return _d.$4.get_$7DQ()},get_$7U6:function(){return String.format(_u.Strings.l_Reminder_Notification_Title_Text,this.get_$8Q7())},get_$2Pz:function(){return this.$49R},get_$8l9:function(){return _g.$S.get_$L().get_$1t().get_$4ud()},get_$8ln:function(){return"RemindersNotificationView"},get_$8Q7:function(){return this.$oj.$Qh.get_$F()},get_$93e:function(){return!0},get_$8ll:function(){return!0},$8dl:function(n){$6Ph(this)},$2KZ:function(n,t){this.$49R=this.$oj.$Qh.get_$F()>0;$Nu(this,"ShowNotificationInTray","NotificationCount","IconTitleText");(!t.$3R||t.$3R===4)&&this.$49R&&$1e6(this)}};_d.$oy=function(n){this.$$d_$8zC=Function.createDelegate(this,this.$8zC);this.$$d_$7O4=Function.createDelegate(this,this.$7O4);this.$$d_$7M6=Function.createDelegate(this,this.$7M6);this.$$d_$7A2=Function.createDelegate(this,this.$7A2);this.$$d_$2eC=Function.createDelegate(this,this.$2eC);_d.$oy.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$oy.initializeBase(this);this.$1JK=n;this.$Dz=new _c.$vP;this.$2eD=new _C(this.$$d_$2eC,_a.$0.$5v);this.$4t2=new _C(this.$$d_$7A2,_a.$0.$5v);$4Pl(this.$1JK,this);_js.$K.get_$L().$3i(_a.$0.$5v,"UserOofNotificationProvider::ctor",this.$$d_$7M6)};_d.$oy.prototype={$Dz:null,$2eD:null,$4t2:null,$1JK:null,get_$3cI:function(){return _u.Strings.l_OofNotificationHeader_Text},get_$99n:function(){return this.$Dz.$1oO&&this.$Dz.$9f?String.format(_u.Strings.l_OofScheduledUntilXNotificationTitle_Text,this.$Dz.$9f):_u.Strings.l_UnscheduledOofNotificationTitle_Text},get_$97T:function(){return _u.Strings.l_UnscheduledOofNotificationSubTitle_Text},get_$6vE:function(){return _u.Strings.l_Yes_Text},get_$6vD:function(){return this.$4t2},get_$6vG:function(){return _u.Strings.l_No_Text},get_$6vF:function(){return this.$2eD},$7M6:function(){var n=new _c.$rT(this.$Dz);n.add_$2A(this.$$d_$7O4);OwaApplication.$1T.$y(n)},$7O4:function(n){this.$Dz.$mZ&&$4Pn(this.$1JK,this)},$2eC:function(){$4Pm(this.$1JK,this)},$7A2:function(){this.$2eC();this.$Dz.set_$1nu(!1);var n=new _c.$ug(this.$Dz);n.add_$20(this.$$d_$8zC);OwaApplication.$1T.$y(n)},$8zC:function(n){_a.$6R.$3A(_u.Strings.l_SetUserOOFSettingsError_Text,0)}};_d.$Lw=function(n,t,i,r,u){this.$$d_$92x=Function.createDelegate(this,this.$92x);_d.$Lw.initializeBase(this,[n,t,i]);this.set_$Uh(!1);this.set_$1UB(!0);this.set_$1nY(!1);this.set_$8iu(r);this.$6n=u;this.$Jv=new _C(this.$$d_$92x,_d.$Lw.$D)};_d.$Lw.$I=function(n,t,i,r,u){_a.$3.$17(n,"owaShell");return new _d.$Lw(n,t,i,r,u)};_d.$Lw.prototype={$10W:null,$5mb:null,$6n:null,$Jv:null,$74J:function(){return null},$768:function(){return null},$73f:function(){return{}},get_$8iu:function(){return this.$10W},set_$8iu:function(n){this.$10W=n;this.$5mb=this.$10W.$3ZZ();return n},$1QM:function(){var n=[new _y.$2f(_y.$c.get_$1Cs(),_y.$c.get_$1Ok(),_u.Strings.l_ButtonBack_Text,new _C(this.$$d_$AQ,_d.$Lw.$D))];return _y.$26.$Bv(this,n,null)},$92x:function(){this.$6n.$Q9(this.$5mb)}};_d.$IV=function(n,t,i,r,u,f){this.$$d_$94M=Function.createDelegate(this,this.$94M);this.$$d_$93Q=Function.createDelegate(this,this.$93Q);this.$$d_$93u=Function.createDelegate(this,this.$93u);this.$$d_$93t=Function.createDelegate(this,this.$93t);_d.$IV.initializeBase(this,[n,t,i]);this.set_$Uh(!1);this.set_$1UB(!0);this.set_$1nY(!1);this.$1D=f;this.$6n=u;this.$4l8=new _C(this.$$d_$93t,_a.$0.$fx);this.$4l9=new _C(this.$$d_$93u,_a.$0.$fx);this.$4l7=new _C(this.$$d_$93Q,_a.$0.$fx);this.$4lA=new _C(this.$$d_$94M,_a.$0.$fx);this.get_$X0()&&r&&(this.$34=r.$34)};_d.$IV.$I=function(n,t,i,r,u,f){_a.$3.$17(n,"owaShell");return new _d.$IV(n,t,i,r,u,f)};_d.$IV.prototype={$34:null,$6n:null,$1D:null,$4l7:null,$4l9:null,$4lA:null,$4l8:null,get_$X0:function(){return _g.$S.get_$L().get_$38().get_$X0()},get_$5qO:function(){return this.$1D.get_$5h()?null:this.$34?this.$34.get_$10u().get_$82():"http://go.microsoft.com/fwlink/p/?LinkId=260597"},get_$65w:function(){return this.$1D.get_$Gj()&&this.$1D.get_$5h()?"http://go.microsoft.com/fwlink/?LinkId=299663":this.$1D.get_$2oz()&&this.$1D.get_$5h()?"http://go.microsoft.com/fwlink/?LinkId=301830":null},get_$10u:function(){return this.$1D.get_$Gj()&&this.$1D.get_$5h()?"http://go.microsoft.com/fwlink/?LinkId=299665":this.$1D.get_$2oz()&&this.$1D.get_$5h()?"http://go.microsoft.com/fwlink/?LinkId=301831":null},get_$66A:function(){return this.$1D.get_$Gj()&&this.$1D.get_$5h()?"http://go.microsoft.com/fwlink/?LinkId=299664":null},$8sa:function(n){n.set_$1Um(!1);n.set_$1Un(!0)},$1QM:function(){var n=[new _y.$2f(_y.$c.get_$1Cs(),_y.$c.get_$1Ok(),_u.Strings.l_ButtonBack_Text,new _C(this.$$d_$AQ,_d.$IV.$D))];return _y.$26.$Bv(this,n,null)},$74J:function(){return null},$768:function(){return null},$73f:function(){return{}},$93t:function(){this.$6n.$Q9(this.get_$5qO())},$93u:function(){this.$6n.$Q9(this.get_$10u())},$93Q:function(){this.$6n.$Q9(this.get_$65w())},$94M:function(){this.$6n.$Q9(this.get_$66A())}};_d.$JR=function(n,t,i){this.$$d_$4jT=Function.createDelegate(this,this.$4jT);this.$$d_$4mZ=Function.createDelegate(this,this.$4mZ);_d.$JR.initializeBase(this,[n,t,i]);this.$Dz=new _c.$vP;this.set_$Nd(this.$Dz);var r=new _js.$X;r.$H(new _a.$2E(new _C(this.$$d_$4mZ,_d.$JR.$D),_u.Strings.l_ConfirmDialog_Save_Text,null));r.$H(new _a.$2E(new _C(this.$$d_$4jT,_d.$JR.$D),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.set_$5mZ(r)};_d.$JR.$I=function(n,t,i){_a.$3.$17(n,"owaShell");return new _d.$JR(n,t,i)};_d.$JR.prototype={$mZ:!1,$28O:!1,$2NZ:0,$28I:null,$28H:null,$Dz:null,$1nZ:!1,$1K5:null,$1H0:!1,get_$5BB:function(){return this.$1nZ},set_$5BB:function(n){if(this.$1nZ!==n){this.$1nZ=n;$6(this,"IsLoadingFinished")}return n},get_$1nu:function(){return this.$mZ},set_$1nu:function(n){if(this.$mZ===n)return n;this.$mZ=n;$6(this,"IsOofOn");return n},get_$2fK:function(){return this.$28O},set_$2fK:function(n){if(this.$28O===n)return n;this.$28O=n;$6(this,"EnableExternalReply");return n},get_$34Q:function(){return this.$2NZ},set_$34Q:function(n){if(this.$2NZ===n)return n;this.$2NZ=n;$6(this,"ReplyToExternalPeopleType");return n},get_$3Vq:function(){return this.$28I},set_$3Vq:function(n){if(this.$28I===n)return n;this.$28I=n;$6(this,"EditorInternalReplyMessage");return n},get_$3Vp:function(){return this.$28H},set_$3Vp:function(n){if(this.$28H===n)return n;this.$28H=n;$6(this,"EditorExternalReplyMessage");return n},get_$5mZ:function(){return this.$1K5},set_$5mZ:function(n){if(n!==this.$1K5){this.$1K5=n;$6(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1UL:function(){return this.$1H0},set_$1UL:function(n){if(n!==this.$1H0){this.$1H0=n;$6(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$6yU:function(){return this.$Dz.$1oO&&!this.get_$1HM()?_u.Strings.l_OverwriteOofScheduleSettingConfirmMessageWhenCloseOptionWithoutSave_Text:_d.$Dl.prototype.get_$6yU.call(this)},get_$652:function(){return"Oof"},$2L5:function(){this.set_$1nu(!1);this.set_$3Vq("");this.set_$3Vp("");this.$34i();_d.$Dl.prototype.$2L5.call(this)},$Ey:function(n){this.$Dz.$1oO?n&&!this.get_$1HM()?this.$3VM():this.set_$1UL(!0):this.$3VM()},$74J:function(){return new _c.$rT(this.$Dz)},$768:function(){return new _c.$ug(this.$Dz)},$73f:function(){var n={};n.IsOofOn=!0;n.EnableExternalReply=!0;n.ReplyToExternalPeopleType=!0;n.EditorInternalReplyMessage=!0;n.EditorExternalReplyMessage=!0;return n},$10M:function(n){switch(this.$Dz.$28m){case 2:this.set_$2fK(!0);this.set_$34Q(2);break;case 1:this.set_$2fK(!0);this.set_$34Q(1);break;default:this.set_$2fK(!1);this.set_$34Q(2);break}this.set_$1nu(this.$Dz.$mZ);this.set_$3Vq(this.$Dz.$2CD);this.set_$3Vp(this.$Dz.$28n);this.set_$5BB(!0);_d.$Dl.prototype.$10M.call(this,n)},$1Jz:function(n){this.set_$pC(this.$mZ);_d.$Dl.prototype.$1Jz.call(this,n)},$71z:function(n){return n?_u.Strings.l_OofOn_Text:_u.Strings.l_OofOff_Text},$4mZ:function(){this.set_$1UL(!1);this.$3VM()},$4jT:function(){this.set_$1UL(!1)},$3VM:function(){this.$Dz.set_$1nu(this.$mZ);this.$28O?this.$Dz.set_$3XD(this.$2NZ):this.$Dz.set_$3XD(0);this.$Dz.set_$58F(this.$28I);this.$Dz.set_$4w1(this.$28H);_d.$Dl.prototype.$Ey.call(this,!1);this.$Dz.set_$5Cz(!1)}};_d.$KZ=function(n,t,i,r){this.$$d_$10M=Function.createDelegate(this,this.$10M);this.$$d_$4jT=Function.createDelegate(this,this.$4jT);this.$$d_$4mZ=Function.createDelegate(this,this.$4mZ);_d.$KZ.initializeBase(this,[n,t,r]);this.$qg=new _c.$xT;this.set_$Nd(this.$qg);var u=new _js.$X;u.$H(new _a.$2E(new _C(this.$$d_$4mZ,_d.$KZ.$D),_u.Strings.l_ConfirmDialog_Save_Text,null));u.$H(new _a.$2E(new _C(this.$$d_$4jT,_d.$KZ.$D),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.$WB=i;var f=this.$74J();f.add_$2A(this.$$d_$10M);f.add_$20(this.$$d_$8Wz);OwaApplication.$1T.$y(f);this.set_$5mZ(u)};_d.$KZ.$I=function(n,t,i){_a.$3.$17(n,"owaShell");return new _d.$KZ(n,t,_a.NativeBridge.get_$L().$WB,i)};_d.$KZ.prototype={$f5:!1,$qg:null,$1nZ:!1,$1K5:null,$1H0:!1,$WB:null,get_$2ob:function(){return this.$f5},set_$2ob:function(n){if(this.$f5===n)return n;this.$f5=n;$6(this,"IsSyncContactsToDeviceEnabled");return n},get_$5BB:function(){return this.$1nZ},set_$5BB:function(n){if(this.$1nZ!==n){this.$1nZ=n;$6(this,"IsLoadingFinished")}return n},get_$5mZ:function(){return this.$1K5},set_$5mZ:function(n){if(n!==this.$1K5){this.$1K5=n;$6(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1UL:function(){return this.$1H0},set_$1UL:function(n){if(n!==this.$1H0){this.$1H0=n;$6(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$652:function(){return null},get_$8xH:function(){return _u.Strings.l_OptionContactSyncFail_Text},$2L5:function(){this.$f5=!1;this.$34i();_d.$Dl.prototype.$2L5.call(this)},$Ey:function(n){this.$qg.set_$2ob(this.$f5);_d.$Dl.prototype.$Ey.call(this,n)},$74J:function(){return new _c.$zs(this.$qg,this.$WB)},$768:function(){return new _c.$16S(this.$qg,this.$WB)},$73f:function(){var n={};n.IsSyncContactsToDeviceEnabled=!0;return n},$10M:function(n){this.set_$2ob(this.$qg.$f5);this.set_$pC(this.$f5);this.set_$5BB(!0);_d.$Dl.prototype.$10M.call(this,n)},$1Jz:function(n){this.set_$pC(this.$qg.$f5);_d.$Dl.prototype.$1Jz.call(this,n)},$71z:function(n){return n?_u.Strings.l_OofOn_Text:_u.Strings.l_OofOff_Text},$8sa:function(n){this.set_$pC(this.$f5);n.set_$1Um(!1);n.set_$1Un(!0)},$4mZ:function(){this.set_$1UL(!1);this.$Ey(!1)},$4jT:function(){this.set_$1UL(!1)}};_d.$Lu=function(n,t,i,r){_d.$Lu.initializeBase(this,[n,t,r]);this.$TO=new _c.$143;this.set_$Nd(this.$TO);this.$QO=i;this.$TO.$1gp=i.get_$19z().get_$3OA();this.$TO.$2Zh=i.get_$19z().get_$3OG();this.$TO.$1jU=i.get_$19z().get_$3W5();this.$TO.$2fD=i.get_$19z().get_$3WB();$3FV(this)};_d.$Lu.$I=function(n,t,i){_a.$3.$17(n,"owaShell");return new _d.$Lu(n,t,_a.NativeBridge.get_$L().$QO,i)};function $3FV(n){n.$TO.$1jU&&n.$TO.$1gp?n.set_$pC(_u.Strings.l_CalendarAndEmailNotificationOn_Text):n.$TO.$1gp?n.set_$pC(_u.Strings.l_CalendarNotificationsOn_Text):n.$TO.$1jU?n.set_$pC(_u.Strings.l_EmailNotificationOn_Text):n.set_$pC(_u.Strings.l_NoNotificationsOn_Text)}_d.$Lu.prototype={$24p:!1,$24r:!1,$28M:!1,$28N:!1,$TO:null,$QO:null,get_$3OA:function(){return this.$24p},set_$3OA:function(n){if(this.$24p===n)return n;this.$24p=n;$6(this,"CalendarRemindersOn");return n},get_$3OG:function(){return this.$24r},set_$3OG:function(n){if(this.$24r===n)return n;this.$24r=n;$6(this,"CalendarSoundsOn");return n},get_$3W5:function(){return this.$28M},set_$3W5:function(n){if(this.$28M===n)return n;this.$28M=n;$6(this,"EmailAlertsOn");return n},get_$3WB:function(){return this.$28N},set_$3WB:function(n){if(this.$28N===n)return n;this.$28N=n;$6(this,"EmailSoundsOn");return n},$Ey:function(n){this.$TO.$1gp=this.$24p;this.$TO.$2Zh=this.$24r;this.$TO.$1jU=this.$28M;this.$TO.$2fD=this.$28N;_d.$Dl.prototype.$Ey.call(this,n)},$74J:function(){return new _c.$10G},$768:function(){return new _c.$16d(this.$TO,this.$QO)},$73f:function(){var n={};n.CalendarRemindersOn=!0;n.CalendarSoundsOn=!0;n.EmailAlertsOn=!0;n.EmailSoundsOn=!0;return n},$10M:function(n){this.set_$3OA(this.$TO.$1gp);this.set_$3OG(this.$TO.$2Zh);this.set_$3W5(this.$TO.$1jU);this.set_$3WB(this.$TO.$2fD);$3FV(this);_d.$Dl.prototype.$10M.call(this,n)},$1Jz:function(n){$3FV(this);_d.$Dl.prototype.$1Jz.call(this,n)}};_d.$mp=function(n,t,i){_d.$mp.initializeBase(this);_a.$3.$17(n,"saveAndNavigateAwayCommand");_a.$3.$17(t,"dontSaveAndNavigateAwayCommand");_a.$3.$17(i,"cancelCommand");this.$5wH=n;this.$4tb=t;this.$79=i};function $6Pp(n){if($8(n.$qR)){var t=new _js.$X;t.$H(new _a.$2E(n.$5wH,_u.Strings.l_ConfirmDialog_Save_Text,null));t.$H(new _a.$2E(n.$4tb,_u.Strings.l_ConfirmDialog_Discard_Text,null));t.$H(new _a.$2E(n.$79,_u.Strings.l_ConfirmDialog_Cancel_Text,null));n.set_$4lN(t)}}_d.$mp.prototype={$5wH:null,$4tb:null,$79:null,$qR:null,$y2:!1,get_$4lN:function(){return this.$qR},set_$4lN:function(n){if(n!==this.$qR){this.$qR=n;$Q(this,"CloseConfirmDialogButtonData")}return n},get_$1Tj:function(){return this.$y2},set_$1Tj:function(n){if(n!==this.$y2){this.$y2=n;$Q(this,"IsCloseConfirmDialogShown")}return n},$d1:function(){$6Pp(this);this.set_$1Tj(!0)},$ei:function(){this.set_$1Tj(!1)}};_d.$Dl=function(n,t,i){this.$$d_$5gF=Function.createDelegate(this,this.$5gF);this.$$d_$10M=Function.createDelegate(this,this.$10M);this.$$d_$8Wy=Function.createDelegate(this,this.$8Wy);this.$$d_$8fX=Function.createDelegate(this,this.$8fX);this.$$d_$1Jz=Function.createDelegate(this,this.$1Jz);this.$$d_$45n=Function.createDelegate(this,this.$45n);this.$$d_$1Xt=Function.createDelegate(this,this.$1Xt);this.$$d_$8ba=Function.createDelegate(this,this.$8ba);this.$$d_$6wF=Function.createDelegate(this,this.$6wF);this.$$d_$3VI=Function.createDelegate(this,this.$3VI);this.$$d_$35Q=Function.createDelegate(this,this.$35Q);this.$$d_$8Wz=Function.createDelegate(this,this.$8Wz);this.$$d_$AQ=Function.createDelegate(this,this.$AQ);_d.$Dl.initializeBase(this);_a.$3.$17(n,"owaShell");this.$G=n;this.$6m=t;this.$S_5=i;this.$1Pv=new _d.$mp(new _C(this.$$d_$35Q,_d.$Dl.$D),new _C(this.$$d_$3VI,_d.$Dl.$D),new _C(this.$$d_$6wF,_d.$Dl.$D));this.$19Z=new _y.$EJ;this.$1r=new _y.$4p;this.$3Ug=this.$73f();this.add_$8C(this.$$d_$8ba);if(this.$G.get_$O()==="TouchNarrow"){this.set_$7E(this.$1QM());this.add_$47c(this.$$d_$1Xt)}this.$DS=new _C(this.$$d_$45n,_d.$Dl.$D)};_d.$Dl.$79x=function(n,t){if(!$8(n.$NP))for(var e=n.$NP,c=e.length,i=0;i<c;++i){var l=e[i];l.get_$ID().set_$5P(!t)}if(!$8(n.$O4))for(var o=n.$O4,a=o.length,r=0;r<a;++r){var v=o[r];v.get_$ID().set_$5P(!t)}if(!$8(n.$MR))for(var s=n.$MR,y=s.length,u=0;u<y;++u){var p=s[u];p.get_$ID().set_$5P(!t)}$8(n.$tb)||n.$tb.get_$ID().set_$5P(!t);if(!$8(n.$1B))for(var h=n.$1B,w=h.length,f=0;f<w;++f){var b=h[f];b.get_$ID().set_$5P(!t)}};function $6Pq(n){if(!$8(n.$K4_5)){n.$K4_5.remove_$2m(n.$$d_$8Wy);n.$K4_5.remove_$2A(n.$$d_$10M);n.$K4_5.remove_$20(n.$$d_$8Wz)}n.get_$1HM()&&n.remove_$1uP(n.$$d_$5gF);n.set_$1UB(!1);n.set_$1nY(!1);n.set_$Uh(!1)}function $6Pr(n){n.set_$C5(!1);$6b(n,"ValidationOnSaveFailed")}_d.$Dl.prototype={$G:null,$1Pv:null,$6m:null,$4a:null,$3Ug:null,$653:null,$11v:null,$K4_5:null,$1bM:null,$3w:null,$Ai:!1,$3hK:!1,$2n8:!1,$Cf:!1,$3fD:!1,$19Z:null,$DS:null,$1r:null,$S_5:null,$3OR:null,add_$3xQ:function(n){this.$2Z("OnBack",n)},remove_$3xQ:function(n){this.$2b("OnBack",n)},add_$1uP:function(n){this.$2Z("OnBusy",n)},remove_$1uP:function(n){this.$2b("OnBusy",n)},add_$47c:function(n){this.$2Z("SetActionSuccess",n)},remove_$47c:function(n){this.$2b("SetActionSuccess",n)},add_$5yq:function(n){this.$2Z("SetActionFailure",n)},remove_$5yq:function(n){this.$2b("SetActionFailure",n)},add_$6Ae:function(n){this.$2Z("ValidationOnSaveFailed",n)},remove_$6Ae:function(n){this.$2b("ValidationOnSaveFailed",n)},get_$6yU:function(){return _u.Strings.l_ConfirmMessageWhenCloseOptionWithoutSave_Text},get_$8xH:function(){return _u.Strings.l_SaveOptionFailureMessage_Text},get_$652:function(){return null},get_$1c4:function(){return this.$11v},set_$1c4:function(n){this.$11v=n;$6(this,"Summary");return n},get_$pC:function(){return this.$653},set_$pC:function(n){this.$653=n;this.set_$1c4(this.$71z(n));$6(this,"SummaryRaw");return n},get_$427:function(){return 1},get_$2Ao:function(){return null},get_$7A8:function(){return!0},get_$8K:function(){return this.$4a},set_$8K:function(n){this.$4a=n;return n},get_$58p:function(){return this.$3fD},get_$1HM:function(){return this.$G.get_$O()==="TouchNarrow"},get_$Uh:function(){return this.$Ai},set_$Uh:function(n){this.$Ai=n;$6b(this,"OnBusy");return n},get_$1UB:function(){return this.$3hK},set_$1UB:function(n){this.$3hK=n;$6(this,"IsLoadSucceeded");return n},get_$1nY:function(){return this.$2n8},set_$1nY:function(n){this.$2n8=n;$6(this,"IsLoadFailed");return n},get_$C5:function(){return this.$Cf},set_$C5:function(n){this.$Cf=n;$6b(this,"OnBusy");return n},get_$Jt:function(){return this.$Ai?_u.Strings.l_LoadingOption_Text:this.$Cf?_u.Strings.l_SavingOption_Text:""},get_$7v:function(){return this.$Ai||this.$Cf},get_$p3:function(){return this.get_$1HM()?this.get_$7v():!1},get_$Jr:function(){return 1},get_$Nd:function(){return this.$3w},set_$Nd:function(n){this.$3w=n;return n},$8ba:function(n,t){$8(this.$3Ug)||$8(this.$3Ug[t])||(this.$3fD=!0)},$34i:function(){this.$3fD=!1},$9T:function(){this.$G.$9T(this)},$45n:function(){this.$Ey(!1)},$Ey:function(n){if(!this.$Cf&&!this.$2n8){if(!$8(this.$1bM)){this.$1bM.remove_$2A(this.$$d_$1Jz);this.$1bM.remove_$20(this.$$d_$8fX)}this.$1bM=this.$768();this.$1bM.add_$2A(this.$$d_$1Jz);this.$1bM.add_$20(this.$$d_$8fX);this.set_$C5(!0);OwaApplication.$1T.$y(this.$1bM)}},$2L5:function(){if(!$8(this.$K4_5)){this.$K4_5.remove_$2m(this.$$d_$8Wy);this.$K4_5.remove_$2A(this.$$d_$10M);this.$K4_5.remove_$20(this.$$d_$8Wz)}this.get_$1HM()&&this.add_$1uP(this.$$d_$5gF);this.$K4_5=this.$74J();if(this.$K4_5){this.$K4_5.add_$2m(this.$$d_$8Wy);this.$K4_5.add_$2A(this.$$d_$10M);this.$K4_5.add_$20(this.$$d_$8Wz);this.set_$1UB(!1);this.set_$1nY(!1);this.set_$Uh(!0);OwaApplication.$1T.$y(this.$K4_5)}},$8sa:function(n){},$2zD:function(){this.$Ai&&$6Pq(this);$6b(this,"OnBack")},$10M:function(n){this.set_$Uh(!1);this.set_$1UB(!0);this.set_$1nY(!1);$6b(this,"GetActionSuccess")},$8Wz:function(n){this.set_$Uh(!1);this.set_$1UB(!1);this.set_$1nY(!0);$6b(this,"GetActionFailure")},$1Jz:function(n){this.set_$C5(!1);this.$34i();this.$G.get_$O()==="TouchNarrow"&&this.$1Xt();$6b(this,"SetActionSuccess")},$8fX:function(n){this.set_$C5(!1);var t=this;this.$1Ae(this.get_$8xH(),function(n,i){$6b(t,"SetActionFailure")})},$1Ae:function(n,t){this.$1r.$3A(0,n,t,!1,null,null,_u.Strings.l_OptionActionErrorDialogTitle_Text)},$71z:function(n){return n},$8Wy:function(n){this.$34i()},$1QM:function(){this.$3OR=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItemMobile_Text,new _C(this.$$d_$AQ,_d.$Dl.$D));var n=[new _y.$2f(_y.$c.get_$Ey(),_y.$c.get_$2OA(),_u.Strings.l_SaveItemMobile_Text,new _C(this.$$d_$45n,_d.$Dl.$D)),this.$3OR];return _y.$26.$Bv(this,n,null)},$AQ:function(){this.get_$58p()?this.$1Pv.$d1():this.$1Xt()},$35Q:function(){this.$1Pv.$ei();this.$45n()},$3VI:function(){this.$1Pv.$ei();this.$1Xt()},$6wF:function(){this.$1Pv.$ei()},$1Xt:function(){this.get_$1HM()&&this.remove_$1uP(this.$$d_$5gF);this.$2zD();$8(this.get_$8K())||this.get_$8K()()},$5gF:function(){_d.$Dl.$79x(this.$3t,this.get_$p3());this.$Ai&&this.$3OR.get_$ID().set_$5P(!0);$6(this,"BusyText");$6(this,"ShowActivityIndicator")}};_d.$JS=function(n,t,i){this.$$d_$7fB=Function.createDelegate(this,this.$7fB);this.$$d_$7fC=Function.createDelegate(this,this.$7fC);this.$$d_$2qD=Function.createDelegate(this,this.$2qD);_d.$JS.initializeBase(this);_a.$3.$M(t,"listViewItemsFactory");this.$5GP=t;this.$S=n;this.$5Dn=i};function $6Ps(n){for(var i=n.$5GP.$75L(n.$S),t=0;t<i.get_$F();t++)n.get_$3T().$H(i.get_$48(t))}_d.$JS.prototype={$3w:null,$16z:null,$S:null,$5GP:null,$5Dn:!1,get_$RP:function(){return this.$W(_d.$JS.$3kU)},set_$RP:function(n){this.$N(_d.$JS.$3kU,n);return n},$3v:function(n,t){_a.$3.$17(n,"onSelectItemChangedHandler");this.set_$24C(t?1:0);this.add_$5xO(n);$6Ps(this)},$7fR:function(){if(this.get_$3T().get_$F()>0&&!this.get_$3T().get_$48(0).$2n9){for(var n=0;n<this.get_$3T().get_$F();n++){this.get_$3T().get_$48(n).set_$5BE(!0);this.get_$3T().get_$48(n).set_$1Un(!1);this.get_$3T().get_$48(n).set_$1Um(!1)}if(!$8(this.$16z)){this.$16z.remove_$2m(this.$$d_$2qD);this.$16z.remove_$2A(this.$$d_$7fC);this.$16z.remove_$20(this.$$d_$7fB)}this.$3w=new _c.$14B;this.$16z=new _c.$10H(this.$3w);this.$16z.add_$2m(this.$$d_$2qD);this.$16z.add_$2A(this.$$d_$7fC);this.$16z.add_$20(this.$$d_$7fB);OwaApplication.$1T.$y(this.$16z)}},$4pT:function(n){return null},$2qD:function(n){for(var t=0;t<this.get_$3T().get_$F();t++){var i=this.get_$3T().get_$48(t);i.set_$5BE(!1)}},$7fC:function(n){for(var i=0;i<this.get_$3T().get_$F();i++){var t=this.get_$3T().get_$48(i);if(!$8(t.get_$Op().get_$652())){var r=this.$3w.$11v[t.get_$Op().get_$652()];t.get_$Op().set_$pC(r)}t.set_$1Um(!1);t.set_$1Un(!0)}},$7fB:function(n){for(var i=0;i<this.get_$3T().get_$F();i++){var t=this.get_$3T().get_$48(i);t.set_$1Um(!0);t.set_$1Un(!1);t.get_$Op().$8sa(t)}}};_d.$Hi=function(n,t){_d.$Hi.initializeBase(this);_a.$3.$M(n,"text");_a.$3.$M(t,"optionPageCreator");this.$2E=n;this.$5lz=t};_d.$Hi.prototype={$2E:null,$5lz:null,$3zS:null,$2n9:!1,$3iz:!1,$3iy:!1,get_$Op:function(){this.$3zS||(this.$3zS=this.$5lz());return this.$3zS},get_$5BE:function(){return this.$2n9},set_$5BE:function(n){this.$2n9=n;$6(this,"IsLoadingSummary");return n},get_$1Un:function(){return this.$3iz},set_$1Un:function(n){this.$3iz=n;$6(this,"IsSummaryLoadSucceeded");return n},get_$1Um:function(){return this.$3iy},set_$1Um:function(n){this.$3iy=n;$6(this,"IsSummaryLoadFailed");return n}};_d.$tV=function(n,t){this.$$d_$8fF=Function.createDelegate(this,this.$8fF);_d.$tV.initializeBase(this);this.$S=n;this.$GG=new _d.$JS(this.$S,t,this.get_$91N());this.$GG.$3v(this.$$d_$8fF,!1)};_d.$tV.prototype={$GG:null,$S:null,get_$Jr:function(){return 1},get_$91N:function(){return!1},$Fe:function(){_y.$1De.prototype.$Fe.call(this);this.$GG.$5F();this.$GG.$7fR()}};_d.$8r=function(n,t,i,r,u){this.$$d_$5gF=Function.createDelegate(this,this.$5gF);this.$$d_$9GO=Function.createDelegate(this,this.$9GO);this.$$d_$1Xt=Function.createDelegate(this,this.$1Xt);this.$$d_$7RX=Function.createDelegate(this,this.$7RX);this.$$d_$8Tf=Function.createDelegate(this,this.$8Tf);_d.$8r.initializeBase(this,[n,t]);this.$1D=u;this.$27=i;this.$2xz=r;this.$2lV=!1;$6Pt(this);this.get_$2FH().$MZ(this.$GG)};function $6Pt(n){if(n.get_$3fP()){n.set_$7E(_y.$26.$Bv(n,null,null));n.$3t.set_$492(!0);n.$3t.$gz(new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$qO(),_u.Strings.l_SaveItemMobile_Text,n.get_$4hQ()),0)}}function $4Ol(n,t){if(t.get_$58p()){_js.Trace.logInfo(_d.$8r.$D,"Found the options vm dirty so saving before exit.");$6Pu(n)}else{_js.Trace.logInfo(_d.$8r.$D,"Navigating away without saving.");n.$1Xt()}}function $6Pu(n){var t=n.$GG.get_$RP().get_$Op();t.add_$47c(n.$$d_$1Xt);t.add_$5yq(n.$$d_$1Xt);t.add_$6Ae(n.$$d_$9GO);t.$Ey(!0)}function $4Om(n,t){if(!$8(n.$GG.get_$RP())){t&&n.$GG.get_$RP().get_$Op().$2zD();n.$GG.get_$RP().get_$Op().remove_$47c(n.$$d_$1Xt);n.$GG.get_$RP().get_$Op().remove_$5yq(n.$$d_$1Xt);n.$GG.get_$RP().get_$Op().remove_$1uP(n.$$d_$5gF);n.$GG.get_$RP().get_$Op().remove_$6Ae(n.$$d_$9GO)}}_d.$8r.prototype={$fC:null,$3zT:null,$JF:null,$3Sl:0,$uW:null,$Fw:null,$27:null,$2lV:!1,$2xz:null,$1D:null,get_$4hQ:function(){$8(this.$JF)&&(this.$JF=new _C(this.$$d_$8Tf,_d.$8r.$D));return this.$JF},get_$3zU:function(){this.$3zT||(this.$3zT=new _y.$F8);return this.$3zT},get_$2FH:function(){this.$fC||(this.$fC=new _y.$F8);return this.$fC},get_$7v:function(){return $8(this.$GG.get_$RP())?!1:this.$GG.get_$RP().get_$Op().get_$7v()},get_$Jt:function(){return $8(this.$GG.get_$RP())?"":this.$GG.get_$RP().get_$Op().get_$Jt()},get_$3fP:function(){return!this.$27.$32.get_$7r().get_$18g()},get_$91N:function(){return!0},$co:function(){_y.$1De.prototype.$co.call(this);if(this.$2xz){this.$2xz.set_$2Wi(!0);this.$2xz.$2Mj(!0,null,null,null,null)}},$Fe:function(){_d.$tV.prototype.$Fe.call(this);this.$GG.set_$25(this.$GG.get_$3T().get_$48(0))},get_$427:function(){return this.$1D.get_$Gj()?1:4},get_$2Ao:function(){return this.$$d_$7RX},get_$8K:function(){return this.$Fw},set_$8K:function(n){this.$Fw=n;return n},get_$7A8:function(){return!0},$7RX:function(n,t){_js.Trace.logInfo(_d.$8r.$D,"HandlePopupPanelClosing with reason = {0}",t);if(!t){this.$4lU();return!0}return!1},get_$Jr:function(){return this.get_$3fP()?_d.$tV.prototype.get_$Jr.call(this):0},$8fF:function(n,t){_js.Trace.logInfo(_d.$8r.$D,"OnSelectedOptionChanged {0}",t);var i=n;if(!$8(this.$GG.get_$25())){this.$uW=i.get_$25();this.$3Sl=0;if($8(this.$GG.get_$RP()))this.$1Xt();else if(this.$GG.get_$RP()!==this.$GG.get_$25()){var r=this.$GG.get_$RP().get_$Op();$4Ol(this,r)}}},$4lU:function(){_js.Trace.logInfo(_d.$8r.$D,"CloseOptionPagePopup");this.$3Sl=1;this.$uW=this.$GG.get_$25();var n=this.$uW.get_$Op();$4Ol(this,n)},$8Tf:function(){this.$2lV=!0;this.$4lU()},$9GO:function(){$4Om(this,!1);this.$GG.set_$25(this.$GG.get_$RP())},$1Xt:function(){_js.Trace.logInfo(_d.$8r.$D,"NavigateAway");$4Om(this,!0);this.$GG.set_$RP(this.$uW);switch(this.$3Sl){case 1:this.$GG.set_$RP(null);this.$GG.set_$25(null);$8(this.$uW)&&this.$uW.get_$Op().remove_$1uP(this.$$d_$5gF);this.$uW=null;this.get_$8K()();this.$27.$32.get_$7r().get_$18g()&&this.$2lV&&this.$27.$32.$94I();this.$2lV=!1;break;case 0:this.get_$3zU().get_$7L()!==this.$uW.get_$Op()&&this.get_$3zU().$MZ(this.$uW.get_$Op());this.$uW.get_$Op().add_$1uP(this.$$d_$5gF);this.$uW.get_$Op().$2L5();break;default:break}},$5gF:function(){_js.Trace.logInfo(_d.$8r.$D,"OnBusy");$6(this,"BusyText");$6(this,"IsBusy")}};_d.$tU=function(n,t){this.$$d_$8SE=Function.createDelegate(this,this.$8SE);_d.$tU.initializeBase(this,[n,t]);this.set_$7E(_y.$26.$I(this))};_d.$tU.prototype={$8SE:function(){this.$GG.get_$25().get_$Op().remove_$3xQ(this.$$d_$8SE);this.$GG.set_$25(null)},$8fF:function(n,t){var r=n;if(r.get_$25()){var u=r.get_$25();var i=u.get_$Op();i.add_$3xQ(this.$$d_$8SE);i.$9T();i.$2L5()}}};_d.$Ri=function(n,t,i){this.$$d_$8iX=Function.createDelegate(this,this.$8iX);this.$2cY=-1;_d.$Ri.initializeBase(this,[n,t,i]);this.$205=new _c.$18V;this.set_$Nd(this.$205);this.add_$3xQ(this.$$d_$8iX)};_d.$Ri.$I=function(n,t,i){_a.$3.$17(n,"owaShell");return new _d.$Ri(n,t,i)};_d.$Ri.prototype={$kJ:null,$14S:null,$208:!1,$205:null,get_$652:function(){return"TimeZone"},get_$99i:function(){return this.$kJ},set_$99i:function(n){this.$kJ=n;$6(this,"TimeZoneList");return n},get_$3Sz:function(){return this.$14S},set_$3Sz:function(n){this.set_$3T0(this.$kJ.$7h(n));if(this.$14S===n)return n;this.$14S=n;$6(this,"CurrentTimeZone");return n},get_$3T0:function(){return this.$2cY},set_$3T0:function(n){this.$2cY=n;$6(this,"CurrentTimeZoneIndex");return n},get_$4DT:function(){return this.$208},set_$4DT:function(n){this.$208=n;$6(this,"TimeZoneReloaded");return n},$74J:function(){return new _c.$10j(this.$205)},$768:function(){return new _c.$16m(this.$205,this.$14S.$3g)},$73f:function(){var n={};n.CurrentTimeZone=!0;return n},$10M:function(n){this.set_$1UB(!0);if($8(this.$kJ)||!this.$kJ.get_$F()){for(var r=new _js.$X,u=this.$205.$kJ,f=u.length,i=0;i<f;++i){var e=u[i];r.$H(new _d.$Vz(e))}this.set_$99i(r)}for(var t=0;t<this.$kJ.get_$F();t++)if(this.$kJ.get_$48(t).$3g===this.$205.$14S){this.set_$3Sz(this.$kJ.get_$48(t));this.set_$4DT(!0)}_d.$Dl.prototype.$10M.call(this,n)},$1Jz:function(n){this.set_$pC(this.$14S.$4yU);_d.$Dl.prototype.$1Jz.call(this,n);var t=new _y.$iv(1);this.$S_5.$8oV(_y.$iv,t)},$8iX:function(){this.set_$3T0(-1);this.set_$4DT(!1)}};_d.$Vz=function(n){_d.$Vz.initializeBase(this);_a.$3.$M(n,"TimeZoneEntry");this.$4yU=n.Name;this.$6m=n.Name;var i=new RegExp(_d.$Vz.$6AR,"g");var t=i.exec(n.Name);if(t&&t.length>0){this.$20q=t[0];this.$6m=n.Name.replace(this.$20q,"").trim();this.$20q.indexOf("GMT")!==-1&&(this.$20q=this.$20q.replace("GMT","UTC"))}this.$3g=n.Value};_d.$Vz.prototype={$6m:null,$4yU:null,$20q:null,$3g:null};_d.$Lt=function(n,t,i){this.$$d_$8X8=Function.createDelegate(this,this.$8X8);_d.$Lt.initializeBase(this,[n,t,i]);this.$eH=new _g.$yq;this.set_$Nd(this.$eH)};_d.$Lt.$I=function(n,t,i){_a.$3.$17(n,"owaShell");return new _d.$Lt(n,t,i)};function $4Oj(n,t,i){if(t){n.$K4=new _h.$K7;n.$K4.add_$2A(n.$$d_$8X8);OwaApplication.$1T.$y(n.$K4)}else n.set_$1c4(i)}_d.$Lt.prototype={$1Uj:!1,$20j:!1,$1RU:null,$28G:null,$eH:null,$364:0,$K4:null,get_$5DG:function(){return this.$1Uj},set_$5DG:function(n){if(this.$1Uj===n)return n;this.$1Uj=n;$6(this,"IsSignatureOn");return n},get_$kO:function(){return this.$20j},set_$kO:function(n){if(this.$20j===n)return n;this.$20j=n;$6(this,"UseDesktopSignature");return n},get_$4u8:function(){return this.$1RU},set_$4u8:function(n){if(this.$1RU===n)return n;this.$1RU=n;$6(this,"EditorSignatureMessage");return n},get_$7Br:function(){return this.$28G},set_$7Br:function(n){if(this.$28G===n)return n;this.$28G=n;$6(this,"EditorDesktopSignatureMessage");return n},get_$5xc:function(){return this.$364},set_$5xc:function(n){if(this.$364===n)return n;this.$364=n;this.set_$kO(n===1?!0:!1);$6(this,"SelectedSignatureType");return n},get_$652:function(){return"Signature"},get_$2nf:function(){return _a.UserAgent.getInstance().get_$5h()},$Ey:function(n){this.$eH.set_$13d(this.$1Uj);this.$eH.set_$1An(this.$1RU);this.$eH.set_$kO(this.$20j);_d.$Dl.prototype.$Ey.call(this,n)},$5uG:function(n){if(this.get_$2nf()){var t=_a.$69.$I();var i=t.$3k("MOWA.IsSignatureChanged")==="true"?!0:!1;var r=i?Boolean.parse(t.$3k("MOWA.AutoAddSignature")):!0;var u=i?t.$3k("MOWA.SignatureText"):_c.$IH.$2hw(_a.UserAgent.getInstance());var f=i?Boolean.parse(t.$3k("MOWA.UseDesktopSignature")):!1;r?$4Oj(this,f,u):this.set_$1c4(_u.Strings.l_EmailSignatureOff_Text)}else n.AutoAddSignature?$4Oj(this,n.UseDesktopSignature,n.SignatureText):this.set_$1c4(_u.Strings.l_EmailSignatureOff_Text);return this.$11v},$8sa:function(n){if(this.get_$2nf()){this.$5uG(null);n.set_$1Um(!1);n.set_$1Un(!0)}},$74J:function(){return this.get_$2nf()?new _c.$IH(this.$eH):new _c.$zw(this.$eH)},$768:function(){return this.get_$2nf()?new _c.$co(this.$eH):new _c.$16T(this.$eH)},$73f:function(){var n={};n.IsSignatureOn=!0;n.UseDesktopSignature=!0;n.EditorSignatureMessage=!0;n.SelectedSignatureType=!0;return n},$10M:function(n){this.set_$5DG(this.$eH.get_$13d());this.set_$kO(this.$eH.get_$kO());this.set_$4u8(this.$eH.get_$1An());this.set_$7Br(this.$eH.get_$2dW());this.set_$5xc(this.$eH.get_$kO()?1:2);_d.$Dl.prototype.$10M.call(this,n)},$1Jz:function(n){this.set_$1c4(this.$1Uj?this.$20j?this.$28G:this.$1RU:_u.Strings.l_EmailSignatureOff_Text);var t=_g.$S.get_$L().get_$1t();t.set_$kO(this.$20j);t.set_$3MX(this.$1Uj);t.set_$49q(this.$1RU);_d.$Dl.prototype.$1Jz.call(this,n)},$71z:function(n){var t=n;return this.$5uG(t)},$8X8:function(n){this.set_$1c4(this.$K4.$t.UserOptions.SignatureText)}};_d.$Bg=function(n,t,i,r,u,f){this.$$d_$8TZ=Function.createDelegate(this,this.$8TZ);this.$$d_$7ZE=Function.createDelegate(this,this.$7ZE);this.$$d_$5wO=Function.createDelegate(this,this.$5wO);_d.$Bg.initializeBase(this,[n,t,i]);_a.$3.$M(n,"owaShell shouldn't be null");_a.$3.$M(i,"eventAggregator shouldn't be null");_a.$3.$M(r,"syncFoldersProcessorLazy shouldn't be null");_a.$3.$M(u,"conductor shouldn't be null");_a.$3.$M(f,"taskRunner shouldn't be null");this.$1Mc=r;this.$S=i;this.$2o=u;this.$5w=f;$6Po(this);$6Pn(this)};function $6Pn(n){var t=this;n.$1Mc.$I(function(t){n.$DW=t;$6Pm(n);n.$36r()})}function $6Po(n){_h.$1y.$fK||_h.$1y.$44o(n.$G.get_$O());n.$17B=5>=_h.$1y.$fK?_h.$1y.$fK:5}function $6Pm(n){_js.Trace.logInfo(_d.$Bg.$5W,"Initialize folder controllers with maxSyncFolders={0}",n.$17B);n.$K3=new Array(0);for(var r=0;r<n.$17B;r++)Array.add(n.$K3,new _d.$LV("","",new _d.$Ax(n.$S,n.$5w,n.$G),n.$G,n.$$d_$7ZE,n.$2o));for(var u=n.$K3,f=u.length,t=0;t<f;++t){var e=u[t];e.$a("FolderId",n.$$d_$8TZ)}for(var i=1;i<=n.$17B;i++)$6(n,String.format("FolderController{0}",i))}function $4Ok(n,t){for(;t<n.$17B;t++){n.$K3[t].set_$JM("");n.$K3[t].set_$n("")}}_d.$Bg.prototype={$S:null,$1Mc:null,$2o:null,$5w:null,$17B:0,$DW:null,$K3:null,$488:!1,$2SY:!1,get_$606:function(){return this.$488},set_$606:function(n){if(this.$488!==n){this.$488=n;$6(this,"SettingChanged")}return n},get_$12e:function(){return this.$2SY},set_$12e:function(n){if(n!==this.$2SY){this.$2SY=n;$6(this,"UserSelected")}return n},get_$7GG:function(){var n;switch(this.$17B){case 1:n=_u.Strings.l_One_Text;break;case 2:n=_u.Strings.l_Two_Text;break;case 3:n=_u.Strings.l_Three_Text;break;case 4:n=_u.Strings.l_Four_Text;break;case 5:n=_u.Strings.l_Five_Text;break;default:throw Error.create("MaxSyncFolders can't be bigger than 5");}return String.format(_u.Strings.l_OfflineFoldersComment_Text,n)},get_$7Fx:function(){return this.$K3&&this.$K3.length>=1?this.$K3[0]:null},get_$7Fy:function(){return this.$K3&&this.$K3.length>=2?this.$K3[1]:null},get_$7Fz:function(){return this.$K3&&this.$K3.length>=3?this.$K3[2]:null},get_$7G0:function(){return this.$K3&&this.$K3.length>=4?this.$K3[3]:null},get_$7G1:function(){return this.$K3&&this.$K3.length>=5?this.$K3[4]:null},$2L5:function(){this.$36r();_d.$Dl.prototype.$2L5.call(this)},$Ey:function(n){_js.Trace.logInfo(_d.$Bg.$5W,"Save isSavedFromDirty={0}",n);this.$5wO();_d.$Dl.prototype.$Ey.call(this,n)},$36r:function(){if(this.$DW){this.set_$12e(this.$DW.get_$12e());var n=0;if(this.$DW.get_$12e()){var u=this.$DW.get_$5Hk();var t=u.get_$1FI();var i=0;if(t){i=t.length>this.$17B?this.$17B:t.length;for(;n<i;n++){var r=_h.$l.$Ia(new _g.$3J(t[n]));if(r){this.$K3[n].set_$JM(_g.$2Q.$eY(r));this.$K3[n].set_$n(t[n])}else{_js.Trace.logWarning(_d.$Bg.$5W,"Can't find folder based on FolderId {0}",t[n]);this.$K3[n].set_$JM("");this.$K3[n].set_$n("")}}}$4Ok(this,n)}else $4Ok(this,n)}},$74J:function(){return new _c.$ux},$768:function(){return new _c.$uy(this.$$d_$5wO)},$73f:function(){var n={};n.SettingChanged=!0;n.UserSelected=!0;return n},$8TZ:function(n,t){this.set_$606(!1);this.set_$606(!0)},$7ZE:function(n){if(this.$DW.$5Bo(n))return!0;else{var t;t=_h.$1y.$7ZG(n)?_u.Strings.l_FolderAlreadyInDefaultSyncListError_Text:_u.Strings.l_FolderNotAllowedToSync_Text;var i=new _a.$4f([t],0,null,0,!1,_u.Strings.l_OK_Text,null,_u.Strings.l_SelectAFolderError_Text);this.$S.$8oV(_a.$4f,i);return!1}},$5wO:function(){_js.Trace.logInfo(_d.$Bg.$5W,"SaveOfflineFolders");if(this.$DW){this.$DW.set_$12e(this.$2SY);if(this.$DW.get_$12e()){for(var i=this.$DW.get_$5Hk(),t=new Array(0),n=0;n<this.$17B;n++)_js.$8.$c(this.$K3[n].$2i)||Array.add(t,this.$K3[n].$2i);_js.Trace.logInfo(_d.$Bg.$5W,"Setting MailFolderIds={0}",t);i.set_$1FI(t)}}}};_d.$MX=function(n,t,i,r,u){this.$$d_$8XM=Function.createDelegate(this,this.$8XM);_d.$MX.initializeBase(this);this.$12=n;this.$qc=t;this.$p=r;this.$G=i;u&&this.set_$HP(n.get_$HP().get_$48(0).get_$1d())};function $6LV(n){for(var i=n.$12.get_$HP().get_$F(),t=0;t<i;t++)n.$12.get_$HP().get_$48(t).get_$Sx()&&_d.$6j.$7fg(_a.$0.$6q,"TruncatedNotesShown_"+t)}_d.$MX.prototype={$G:null,$p:null,$12:null,$qc:null,$1Gv:!1,$iR:!1,$TN:null,get_$2nT:function(){return this.$iR},set_$2nT:function(n){if(this.$iR!==n){this.$iR=n;$6(this,"IsNotesAvailable")}return n},get_$3hm:function(){return this.$1Gv},set_$3hm:function(n){if(this.$1Gv!==n){this.$1Gv=n;$6(this,"IsNotesLoaded")}return n},get_$HP:function(){return this.$TN},set_$HP:function(n){this.$TN=n;$6(this,"Notes");this.set_$2nT(!_js.$8.$c(this.$TN));this.set_$3hm(!0);return n},get_$7hj:function(){var n;switch(this.$G.get_$O()){case"TouchNarrow":n=51200;break;case"TouchWide":case"Mouse":default:n=512e3;break}return n},$Kt:function(n){if(this.$12.get_$5s()&&this.$12.get_$5s().Id&&(!this.$1Gv||n)){this.set_$2nT(!1);this.set_$3hm(!1);var t=new _c.$l0(this.$12.get_$5s().Id,this.get_$7hj());t.add_$2m(this.$$d_$8XM);t.$BP=this.$qc.$9S;this.$p.$y(t)}},$8XM:function(n){var t=n;if(t.$1vh&&t.$1vh.get_$HP()&&t.$1vh.get_$HP().get_$F()>0){this.$12.set_$HP(t.$1vh.get_$HP());this.set_$HP(t.$1vh.get_$HP().get_$48(0).get_$1d());$6LV(this)}else this.$12.get_$HP()&&this.$12.get_$HP().get_$F()?this.set_$2nT(!0):this.set_$2nT(!1);this.set_$3hm(!0)}};_d.$1Cf=function(n){this.$2I=n};_d.$1Cf.prototype={$2I:null,get_$1v:function(){return this.$2I.$12},get_$2WM:function(){return""},get_$5L:function(){return this.$2I.$7R},get_$3gF:function(){return!1},set_$3gF:function(n){return n},get_$4rH:function(){return null},get_$2mi:function(){return!1},get_$12m:function(){return new Array(0)},set_$12m:function(n){return n},get_$6q5:function(){return""},set_$6q5:function(n){return n},get_$15w:function(){return!0},get_$55N:function(){return!0},get_$1m4:function(){return!0},get_$1ml:function(){return!1},set_$1ml:function(n){return n},get_$1K8:function(){return this.$2I.$G},get_$2bD:function(){return this.$2I.$8L},get_$2FC:function(){return null},$eY:function(n){return n?this.get_$1v().get_$1j7():this.get_$1v().get_$1l()},$3zN:function(n){},$41O:function(n){},$3dX:function(n){},$2b8:function(n){}};_d.$k8=function(n){_d.$k8.initializeBase(this,[n])};_d.$k8.prototype={get_$12m:function(){return this.get_$bA().$6Bu},set_$12m:function(n){this.get_$bA().$6Bu=n;return n},get_$6q5:function(){return this.get_$bA().$3KH},set_$6q5:function(n){this.get_$bA().$3KH=n;return n},get_$3gF:function(){return this.get_$bA().$2D6},set_$3gF:function(n){this.get_$bA().set_$3gF(n);return n},get_$1ml:function(){return this.get_$bA().$Ij},set_$1ml:function(n){this.get_$bA().$Ij=n;return n},get_$bA:function(){return this.$2I}};_d.$HJ=function(n,t,i,r){this.$$d_$2Zq=Function.createDelegate(this,this.$2Zq);this.$$d_$41s=Function.createDelegate(this,this.$41s);this.$$d_$Ey=Function.createDelegate(this,this.$Ey);_d.$HJ.initializeBase(this);this.$G=i;this.$50=r;(n.get_$18()===5||t!==2)&&(this.$7S=$6MH(this,n));this.$2aG=n.get_$18()};function $6MH(n,t){return n.$50?n.$50.$SX(t,t.get_$18()===5?2:_y.$q.$32a,!1,t.get_$18()===5?2:3,!0,null):new _d.$7u(t,t.get_$18()===5?2:_y.$q.$32a,!1,t.get_$18()===5?2:3,null,n.$G,!0,null,null)}_d.$HJ.prototype={$G:null,$7S:null,$2aG:0,$50:null,$1KZ:null,$DS:null,$79:null,$Cf:!1,$yH:!1,add_$5pI:function(n){this.$2Z("PopoutClicked",n)},remove_$5pI:function(n){this.$2b("PopoutClicked",n)},add_$8ua:function(n){this.$2Z("SaveClicked",n)},remove_$8ua:function(n){this.$2b("SaveClicked",n)},add_$6wE:function(n){this.$2Z("CancelClicked",n)},remove_$6wE:function(n){this.$2b("CancelClicked",n)},get_$on:function(){$8(this.$DS)&&(this.$DS=new _C(this.$$d_$Ey,_d.$HJ.$D));return this.$DS},get_$41t:function(){$8(this.$1KZ)&&(this.$1KZ=new _C(this.$$d_$41s,_d.$HJ.$D));return this.$1KZ},get_$SR:function(){$8(this.$79)&&(this.$79=new _C(this.$$d_$2Zq,_d.$HJ.$D));return this.$79},get_$1yh:function(){return!!this.$7S},get_$mf:function(){return this.$G.get_$O()!=="Mouse"},get_$62D:function(){return!1},get_$5pG:function(){return this.$2aG===4?_u.Strings.l_LocationPopoutCardAction_AT_Tooltip_Text:_u.Strings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$C5:function(){return this.$Cf},set_$C5:function(n){if(this.$Cf!==n){this.$Cf=n;$6(this,"IsSaving")}return n},get_$1o7:function(){return this.$yH},set_$1o7:function(n){if(this.$yH!==n){this.$yH=n;$6(this,"ShowPopoutControl")}return n},$41s:function(){$6b(this,"PopoutClicked")},$Ey:function(){if(!this.$Cf){this.set_$C5(!0);$6b(this,"SaveClicked")}},$2Zq:function(){$6b(this,"CancelClicked")}};_d.$xN=function(n){_d.$xN.initializeBase(this,[n])};_d.$xN.prototype={get_$3Q8:function(){return this.$2I},$eY:function(n){var r=_d.$1Cf.prototype.$eY.call(this,n);if(!_js.$8.$c(r))return r;var u=this.get_$3Q8().$Zx.$29B;var h=u?u.$Fm:null;var f=this.get_$3Q8().$Zx.$2JN;var c=f?f.$Fm:null;var e=this.get_$3Q8().$Zx.$2F4;var l=e?e.$Fm:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$6X.$3Np(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$hN=function(n,t,i,r,u,f,e,o,s,h){this.$G=n;this.$p=t;this.$3K=i;this.$fF=r;this.$hW=u;this.$6M=f;this.$9X=e;this.$6n=o;this.$50=s;this.$25h=h};_d.$hN.prototype={$6n:null,$G:null,$p:null,$3K:null,$fF:null,$hW:null,$9X:null,$6M:null,$50:null,$25h:null,$75V:function(n,t,i,r){return new _d.$9E(n,t,i,this.$G,this.$p,this.$3K,this.$fF,this.$hW,this.$6M,this.$9X,this.$6n,r,this.$50,this.$25h)},$75W:function(n,t){return new _d.$HJ(n,t,this.$G,this.$50)}};_d.$9E=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$41s=Function.createDelegate(this,this.$41s);this.$$d_$8ZO=Function.createDelegate(this,this.$8ZO);this.$$d_$8d3=Function.createDelegate(this,this.$8d3);this.$$d_$8e1=Function.createDelegate(this,this.$8e1);this.$$d_$8Z9=Function.createDelegate(this,this.$8Z9);this.$$d_$Yo=Function.createDelegate(this,this.$Yo);_d.$9E.initializeBase(this);this.$2W=!0;this.$16O=!0;this.$3le=l;this.$G=r;this.$p=u;this.$3K=f;this.$fF=e;this.$hW=o;this.$6M=s;this.$9X=h;this.$6n=c;this.$50=a;this.$25h=v;this.$7R=t;this.$8L=i;this.$12=n;this.$7S=$6RY(this,n);this.$2aG=n.get_$18();this.$2BG=!0;this.$2jv=!0;this.$2BM=!0;this.$2BJ=!0;this.set_$3Vk(_u.Strings.l_PersonaEditMgmtAction_AT_Tooltip_Text);this.set_$2ev(_u.Strings.l_PersonaEditMgmtAction_Text)};function $6RY(n,t){if(n.get_$1nW())return null;var i=$6RX(n,t);i&&n.$8L.$1Ee&&i.set_$15w(!0);var r=_y.$q.$Hr;n.$12.get_$18()===4&&(r=_y.$q.$1VE);return n.$50?n.$50.$SX(t,r,!1,3,!0,i):new _d.$7u(t,r,!1,3,null,n.$G,!0,i,null)}function $6RX(n,t){return n.$25h?n.$25h.$736(t,n.$7R,n.$3le,n.$8L):new _d.$Fv(t,n.$G,n.$3K,n.$9X,n.$fF,n.$p,n.$hW,n.$6M,n.$6n,n.$7R,n.$3le,n.$8L)}_d.$9E.prototype={$6n:null,$G:null,$p:null,$3K:null,$fF:null,$hW:null,$9X:null,$6M:null,$50:null,$25h:null,$3le:null,$7S:null,$2aG:0,$7R:0,$8L:null,$X5:!1,$2W:!1,$16O:!1,$GJ:null,$Jg:0,$1KZ:null,$Wf:null,$f8:null,$44f:null,$42S:null,$1qC:null,$rz:!1,$Ai:!1,$2rP:null,$3cb:!1,$2jp:!1,$3cP:!1,$2ji:!1,$2BG:!1,$2BM:!1,$2jv:!1,$yH:!1,$49G:!1,$12:null,$2ew:null,$1Er:null,$49J:!1,$3di:null,$2BJ:!1,add_$5pI:function(n){this.$2Z("PopoutClicked",n)},remove_$5pI:function(n){this.$2b("PopoutClicked",n)},add_$8l1:function(n){this.$2Z("PivotOptionClicked",n)},remove_$8l1:function(n){this.$2b("PivotOptionClicked",n)},add_$7Ea:function(n){this.$2Z("FavoriteClicked",n)},remove_$7Ea:function(n){this.$2b("FavoriteClicked",n)},add_$4u5:function(n){this.$2Z("EditClicked",n)},remove_$4u5:function(n){this.$2b("EditClicked",n)},add_$99s:function(n){this.$2Z("ToggleClicked",n)},remove_$99s:function(n){this.$2b("ToggleClicked",n)},add_$7dg:function(n){this.$2Z("JoinClicked",n)},remove_$7dg:function(n){this.$2b("JoinClicked",n)},add_$5tl:function(n){this.$2Z("RequestMembershipClicked",n)},remove_$5tl:function(n){this.$2b("RequestMembershipClicked",n)},add_$8my:function(n){this.$2Z("PreviewModernGroupClicked",n)},remove_$8my:function(n){this.$2b("PreviewModernGroupClicked",n)},add_$7eW:function(n){this.$2Z("LeaveClicked",n)},remove_$7eW:function(n){this.$2b("LeaveClicked",n)},get_$1v:function(){return this.$12},set_$1v:function(n){this.$12=n;this.$7S&&this.$7S.set_$1v(n);return n},get_$92w:function(){return!this.get_$mf()&&this.$49G},set_$92w:function(n){if(this.$49G!==n){this.$49G=n;$6(this,"ShowExpandButton")}return n},get_$7Ta:function(){return this.$8L.$27m||this.$rz||this.get_$1o3()||this.get_$1nW()||this.get_$3i3()},get_$2BE:function(){return this.$3cb},set_$2BE:function(n){if(this.$3cb!==n){this.$3cb=n;$6(this,"HideFavoriteButton")}return n},get_$2BD:function(){return this.$2jp},set_$2BD:function(n){if(this.$2jp!==n){this.$2jp=n;$6(this,"HideEditButton")}return n},get_$2ev:function(){return this.$1Er},set_$2ev:function(n){if(this.$1Er!==n){this.$1Er=n;$6(this,"EditButtonText")}return n},get_$3Vk:function(){return this.$2ew},set_$3Vk:function(n){if(this.$2ew!==n){this.$2ew=n;$6(this,"EditButtonToolTip")}return n},get_$28A:function(){this.$Wf||(this.$Wf=new _C(this.$$d_$Yo,_d.$9E.$D));return this.$Wf},get_$2Ek:function(){this.$f8||(this.$f8=new _C(this.$$d_$8Z9,_d.$9E.$D));return this.$f8},get_$8s5:function(){this.$44f||(this.$44f=new _C(this.$$d_$8e1,_d.$9E.$D));return this.$44f},get_$5qC:function(){this.$42S||(this.$42S=new _C(this.$$d_$8d3,_d.$9E.$D));return this.$42S},get_$41t:function(){this.$1KZ||(this.$1KZ=new _C(this.$$d_$41s,_d.$9E.$D));return this.$1KZ},get_$1yh:function(){return this.$7S?!!this.$7S.$NO:!1},get_$mf:function(){return this.$G.get_$O()!=="Mouse"},get_$5pG:function(){return this.$2aG===4?_u.Strings.l_LocationPopoutCardAction_AT_Tooltip_Text:_u.Strings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$7hz:function(){return this.$1qC},set_$7hz:function(n){this.$1qC=n;$6(this,"MenuAddContactsViewModelPropertyName");return n},get_$3ml:function(){return this.$2rP},set_$3ml:function(n){if(this.$2rP!==n){this.$2rP=n;$6(this,"MenuAffordanceViewModel")}return n},get_$62D:function(){return!1},get_$g8:function(){return this.$GJ},set_$g8:function(n){if(this.$GJ!==n){this.$GJ=n;$6(this,"PivotOptions")}return n},get_$AG:function(){return this.$Jg},set_$AG:function(n){this.$Jg=n;$6(this,"PivotSelectedOptionIndex");$EQ(this,"PivotOptionClicked",n);return n},get_$Lu:function(){return this.$rz},set_$Lu:function(n){if(this.$rz!==n){this.$rz=n;this.$7S&&this.$7S.set_$59f(n);$4Z(this,"IsCardLoading","HideManagementActions")}return n},get_$1le:function(){return this.$Ai||this.$3cP},set_$1le:function(n){if(this.$3cP!==n){this.$3cP=n;$6(this,"HideAddContactsMenu")}return n},get_$2jj:function(){return this.$2ji},set_$2jj:function(n){if(this.$2ji!==n){this.$2ji=n;$6(this,"HideAffordanceMenu")}return n},get_$7TW:function(){return this.$2BG},set_$7TW:function(n){if(this.$2BG!==n){this.$2BG=n;$6(this,"HideJoinButton")}return n},get_$7Tk:function(){return this.$2BM},set_$7Tk:function(n){if(this.$2BM!==n){this.$2BM=n;$6(this,"HideRequestMembershipButton")}return n},get_$7TX:function(){return this.$2jv},set_$7TX:function(n){if(this.$2jv!==n){this.$2jv=n;$6(this,"HideLeaveButton")}return n},get_$7Tj:function(){return this.$2BJ},set_$7Tj:function(n){if(this.$2BJ!==n){this.$2BJ=n;$6(this,"HidePreviewModernGroupButton")}return n},get_$3m:function(){return this.$2W},set_$3m:function(n){if(this.$2W!==n){this.$2W=n;$EQ(this,"ToggleClicked",n);$4Z(this,"IsExpanded","ShowPersonCardExpandToggleButton")}return n},get_$8kY:function(){return this.get_$mf()?this.get_$16j():this.$16O||this.get_$1o3()},get_$1o3:function(){return!this.$8L.$9S},get_$7bQ:function(){return this.get_$1o3()&&!this.$X5},get_$3i3:function(){return this.$8L.$9S===1},get_$7bO:function(){return this.$8L.$9S===2&&!this.$X5},get_$1nW:function(){return this.$8L.$9S===9},get_$93n:function(){return!this.get_$1nW()&&this.$16O&&!this.$2W},get_$bh:function(){return this.$16O},set_$bh:function(n){if(this.$16O!==n){this.$16O=n;$6(this,"IsExpandable")}return n},get_$16j:function(){return this.$X5&&this.$G.get_$O()==="TouchWide"},get_$7al:function(){return this.$X5&&this.$G.get_$O()==="Mouse"},get_$2mi:function(){return this.$X5},set_$2mi:function(n){this.$X5=n;$Nu(this,"IsHoverCard","IsTouchWideHover","IsMouseHover");return n},get_$Uh:function(){return this.$Ai},set_$Uh:function(n){if(this.$Ai!==n){this.$Ai=n;$6(this,"IsLoading")}return n},get_$1o7:function(){return this.$yH},set_$1o7:function(n){if(this.$yH!==n){this.$yH=n;$6(this,"ShowPopoutControl")}return n},get_$61n:function(){return this.$49J},set_$61n:function(n){this.$49J=n;$6(this,"ShowIndicator");return n},get_$1mF:function(){return this.$3di},set_$1mF:function(n){this.$3di=n;$6(this,"IndicatorText");return n},$8e1:function(){$6b(this,"RequestMembershipClicked")},$41s:function(){$6b(this,"PopoutClicked")},$Yo:function(){$6b(this,"EditClicked")},$8Z9:function(){$6b(this,"JoinClicked")},$8d3:function(){$6b(this,"PreviewModernGroupClicked")},$8ZO:function(){$6b(this,"LeaveClicked")}};_d.$jd=function(n,t,i){this.$$d_$4qx=Function.createDelegate(this,this.$4qx);this.$$d_$2WN=Function.createDelegate(this,this.$2WN);_d.$jd.initializeBase(this);$8(n)&&(n=new _c.$i);if($8(t))throw Error.argumentNull("acceptCallback");if($8(i))throw Error.argumentNull("declineCallback");this.$2WO=t;this.$4qz=i;this.$2WP=new _C(this.$$d_$2WN,_a.$0.$4H);this.$4r0=new _C(this.$$d_$4qx,_a.$0.$4H);this.$1Lt=new _d.$7u(n,_y.$q.$1gC,!1);this.$1Lt.$5Df=!0};_d.$jd.prototype={$1Lt:null,$2WP:null,$4r0:null,$2WO:null,$4qz:null,$2WN:function(){_js.Trace.logInfo(_a.$0.$4H,"BuddyRequest: Accepting buddy request {0}.",this.$1Lt.get_$1v().get_$1h());this.$2WO(this)},$4qx:function(){_js.Trace.logInfo(_a.$0.$4H,"BuddyRequest: declining buddy request {0}.",this.$1Lt.get_$1v().get_$1h());this.$4qz(this)}};_d.$TY=function(n,t,i){this.$$d_$9A1=Function.createDelegate(this,this.$9A1);_d.$TY.initializeBase(this);_a.$3.$17(n,"personaViewModelFactory");this.$50=n;this.$4U=$6Mp(this,t);this.$2es=i;this.$Lv=!1};function $6Mp(n,t){var i=n.$50.$SX(t,_y.$q.$Hr,!1,1);var r=[1];i.$Xp(1,r,"");i.set_$l9(!0);return i}_d.$TY.prototype={$50:null,$2es:null,$4U:null,$4Dg:null,$Lv:!1,get_$y5:function(){return this.$Lv},set_$y5:function(n){if(this.$Lv!==n){this.$Lv=n;$6(this,"IsDeleted")}return n},get_$66d:function(){this.$4Dg||(this.$4Dg=new _C(this.$$d_$9A1,_a.$0.$1v));return this.$4Dg},$9A1:function(){this.set_$y5(!this.$Lv);this.$2es.$691(this)}};_d.$l7=function(n,t){this.$Ys=n;this.$66=t};_d.$l7.prototype={$Ys:null,$66:null,$50:null,$4oc:function(n,t,i){return new _d.$EB(i,this.$Ys,this.$66,this.$50,n,t)}};_d.$lA=function(n,t,i){_d.$lA.initializeBase(this,[n,0]);_a.$3.$17(t,"personaViewModelFactory");this.$50=t;this.$2es=i};_d.$lA.prototype={$50:null,$2es:null,get_$5o8:function(){return this},$4EJ:function(n){return _c.$i.isInstanceOfType(n)?this.$73j(n):n},$45K:function(n){return _d.$TY.isInstanceOfType(n)?n.$4U.$12:n},$7AV:function(n){var t=n;t&&t.$1M()},$7I6:function(n){var u=n;var t=u.$4U;var i=t.$Ex;var r=t.$uM;_js.$8.$c(r)||(i+=" "+r);return i},$73j:function(n){return new _d.$TY(this.$50,n,this.$2es)}};_d.$lB=function(){};_d.$lB.prototype={$50:null,$74T:function(n,t){return new _d.$lA(n,this.$50,t)}};_d.$l6=function(){};_d.$l6.prototype={$50:null,$I:function(n){return new _d.$My(n,this.$50)}};_d.$Qs=function(n){_d.$Qs.initializeBase(this);this.$2I=n;this.$qb()};function $6Np(n){var t;var i,r;var u=(r=_d.$1H.$9KS(String,n.$2I.get_$1v().get_$wk(),"",n.$2I,i={val:t}),t=i.val,r);t&&_js.$8.$c(t.get_$1d())&&t.set_$1d(n.$2I.get_$1v().get_$1l());$8(n.$2I.get_$1v().get_$wk())&&n.$2I.get_$1v().set_$wk(u);n.set_$53P(new _d.$2Y(n.$2I,t,"PersonaDisplayNames",_u.Strings.l_GroupName_Text,!0))}function $6Nq(n){var t;var i=new _g.$66;i.set_$1d("");i.set_$45("Text");var r,u;var f=(u=_d.$1H.$9KS(_g.$66,n.$2I.get_$1v().get_$HP(),i,n.$2I,r={val:t}),t=r.val,u);$8(n.$2I.get_$1v().get_$HP())&&n.$2I.get_$1v().set_$HP(f);n.set_$HP(new _d.$2Y(n.$2I,t,"PersonaBodies",_u.Strings.l_GroupCardNotes_ProfileField_Text,!0))}function $6Nr(n){n.$2I.get_$1v().set_$wk(_d.$1H.$9KT(String,n.$2I.get_$1v().get_$wk(),!0));n.$2I.get_$1v().set_$HP(_d.$1H.$9KT(_g.$66,n.$2I.get_$1v().get_$HP(),!0))}_d.$Qs.prototype={$1lJ:null,$TN:null,$2I:null,get_$53P:function(){return this.$1lJ},set_$53P:function(n){if(this.$1lJ!==n){this.$1lJ=n;$6(this,"GroupNameField")}return n},get_$HP:function(){return this.$TN},set_$HP:function(n){if(this.$TN!==n){this.$TN=n;$6(this,"Notes")}return n},$qb:function(){this.set_$53P(null);this.set_$HP(null);if(this.$2I.get_$5L()){_d.$1H.$60H(this.$2I);$6Np(this);$6Nq(this)}},$1Ch:function(){var n=[];n=_d.$1H.$1fY(this.$1lJ,n);n=_d.$1H.$1fY(this.$TN,n);return n},$eC:function(){$6Nr(this)}};_d.$1Du=function(n){this.$$d_$9Gz=Function.createDelegate(this,this.$9Gz);this.$$d_$8kk=Function.createDelegate(this,this.$8kk);_d.$1Du.initializeBase(this);this.$2I=n;this.$24u=this.$2I.get_$1K8().get_$O()==="TouchNarrow"&&!this.$2I.get_$15w()};_d.$1Du.prototype={$2I:null,$24u:!1,$4pT:function(n){throw Error.notImplemented();},$8kk:function(n){var t=n.$9c.get_$1d();this.$2I.$41O(t)},$9Gz:function(n){var t=n.$9c.get_$1d();if(!_js.$8.$14(t)){var i=t.trimStart().toLowerCase();i.startsWith("http://")||i.startsWith("https://")||(t="http://"+t);this.$2I.$3zN(t)}}};_d.$Fv=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$8ww=Function.createDelegate(this,this.$8ww);this.$$d_$8kj=Function.createDelegate(this,this.$8kj);this.$$d_$1lB=Function.createDelegate(this,this.$1lB);this.$$d_$7Ua=Function.createDelegate(this,this.$7Ua);this.$$d_$4mK=Function.createDelegate(this,this.$4mK);this.$$d_$6zg=Function.createDelegate(this,this.$6zg);_d.$Fv.initializeBase(this);this.$G=t;this.$3K=i;this.$9X=r;this.$fF=u;this.$p=f;this.$hW=e;this.$6M=o;this.$ym=c;this.$6n=s;this.$7R=h;this.$8L=l;this.$X9=this.$G.get_$O()==="Mouse";this.set_$1v(n)};function $4MO(n){if(!n.$7R){if(n.$2k1){n.$qW&&n.$qW.$1u();n.$qY&&n.$qY.$1u();n.$161&&n.$161.$1u();n.$oN&&n.$oN.$1u();n.$jx&&n.$jx.$1u();n.$r2&&n.$r2.$1u();return}n.$qW||(n.$qW=new(_d.$9y.$$(_g.$1m))(n.$$d_$6zg));n.$qY||(n.$qY=new(_d.$9y.$$(_g.$1m))(n.$$d_$4mK));n.$161||(n.$161=new(_d.$9y.$$(String))(n.$$d_$7Ua));if(n.$12.get_$5l()&&n.$12.get_$5l().length>0){var u=_d.$59.$$(_g.$1m).$9IT(n.$12);n.$qW.$9KJ(u);n.$qY.$9KJ(u)}else{n.$qW.$1u();n.$qY.$1u()}var f=n.$3K&&n.$3K.get_$Az()&&!_js.$8.$14(n.$3K.get_$Az().get_$1i9())?n.$3K.get_$Az().get_$1i9().trim().toLowerCase():"";var i=_d.$59.$$(String).$9IU(n.$12,f);if(i&&i.length>0){var e=this;n.$161.$9KJ(i,function(n,t,i){return new _d.$15B(n,t,i)})}else n.$161.$1u();$Ha(n,["ComposeMailActionCommand","ComposeMeetingActionCommand","IMActionCommand","ComposeMailActionMenuViewModel","ComposeMeetingActionMenuViewModel","IMActionMenuViewModel","EmailsNotAvailable","ScheduleMeetingNotAvailable","IMNotAvailable"]);if(n.$12.get_$3by()){n.$r2||(n.$r2=new(_d.$9y.$$(_g.$3G))(n.$$d_$1lB));if(n.$12.get_$18()===4||n.$12.get_$18()===3||n.$12.get_$18()===1){var r=[new(_d.$59.$$(_g.$3G))(n.get_$179().get_$48(0),"")];r&&r.length>0&&n.$r2.$9KJ(r)}else n.$r2.$1u();$4Z(n,"DirectionsActionCommand","DirectionsNotAvailable")}if(n.$G.get_$O()==="TouchNarrow"){n.$oN||(n.$oN=new(_d.$9y.$$(_g.$2u))(n.$$d_$8kj));n.$jx||(n.$jx=new(_d.$9y.$$(_g.$2u))(n.$$d_$8ww));var t=_d.$59.$$(_g.$2u).$9IV(n.$12);if(t&&t.length>0){n.$oN.$9KJ(t);n.$12.get_$18()!==4?n.$jx.$9KJ(t):n.$jx.$1u()}else{n.$oN.$1u();n.$jx.$1u()}$Ha(n,["SendSmsActionCommand","PhoneCallActionCommand","SendSmsActionMenuViewModel","PhoneCallActionMenuViewModel","PhonesNotAvailable","SmsNotAvailable","IsFiveIconsOnTnarrow"])}}}function $4MN(n,t){n.$12.get_$18()===2&&t.MailboxType==="Mailbox"&&(t.MailboxType="PublicDL");n.$12.get_$8e()&&(t.SipUri=n.$12.get_$8e())}function $3Ej(n){n.get_$mf()||$6b(n,"ActionClicked")}_d.$Fv.prototype={$6M:null,$p:null,$6n:null,$hW:null,$fF:null,$G:null,$3K:null,$9X:null,$7R:0,$8L:null,$X9:!1,$1ut:null,$1Yu:null,$1Gc:!1,$ym:null,$1pr:null,$171:null,$2k1:!1,$12:null,$qW:null,$qY:null,$oN:null,$jx:null,$161:null,$r2:null,add_$8R1:function(n){this.$2Z("ActionClicked",n)},remove_$8R1:function(n){this.$2b("ActionClicked",n)},get_$30i:function(){return this.$1ut},set_$30i:function(n){this.$1ut=n;return n},get_$3zG:function(){return this.$1Yu},set_$3zG:function(n){this.$1Yu=n;return n},get_$59f:function(){return this.$1Gc},set_$59f:function(n){if(this.$1Gc!==n){this.$1Gc=n;$6(this,"HidePersonaActions")}return n},get_$15w:function(){return this.$1Gc?!0:this.$2k1},set_$15w:function(n){if(this.$2k1!==n){this.$2k1=n;$4MO(this);$6(this,"HidePersonaActions")}return n},get_$1v:function(){return this.$12},set_$1v:function(n){this.$12=n;$4MO(this);return n},get_$4mJ:function(){return this.$qW?this.$qW.get_$3T():null},get_$4mL:function(){return this.$qY?this.$qY.get_$3T():null},get_$25o:function(){return this.$qW?this.$qW.get_$2WW():null},get_$2BZ:function(){return this.$161?this.$161.get_$2WW():null},get_$5oU:function(){return this.$oN?this.$oN.get_$2WW():null},get_$25q:function(){return this.$qY?this.$qY.get_$2WW():null},get_$5yG:function(){return this.$jx?this.$jx.get_$2WW():null},get_$3Ua:function(){return this.$r2?this.$r2.get_$2WW():null},get_$3Q6:function(){return this.$qW.get_$46S()},get_$3dO:function(){return this.$161.get_$46S()},get_$41P:function(){return this.$oN.get_$46S()},get_$3Q7:function(){return this.$qY.get_$46S()},get_$47M:function(){return this.$jx.get_$46S()},get_$3WA:function(){return!this.$12.get_$5l()||!this.$12.get_$5l().length||!this.get_$4mJ()||!this.get_$4mJ().length},get_$5wS:function(){return!!this.$1Yu||this.get_$3WA()||!this.$9X.get_$1o()||!this.get_$4mL()||!this.get_$4mL().length},get_$4so:function(){return!this.$r2||!this.$r2.get_$3T()||!this.$r2.get_$3T().length},get_$41Q:function(){return this.$G.get_$O()!=="TouchNarrow"||!this.$oN||!this.$oN.get_$3T()||!this.$oN.get_$3T().length},get_$63F:function(){return _a.UserAgent.getInstance().$EU.$1Yw.$1Zd===2||this.$12.get_$18()!==1||this.get_$41Q()||!this.$jx||!this.$jx.get_$3T()||!this.$jx.get_$3T().length},get_$1m4:function(){return this.get_$30i()?!1:this.get_$mf()?!0:!this.$12.get_$bd()||!this.$12.get_$bd().get_$F()?!0:!this.$3K||!this.$3K.$NH||!this.$3K.get_$Az()||!this.$3K.get_$Az().get_$sI()||!this.$3K.get_$Az().$1PX(this.$12.get_$8e())},get_$6vv:function(){return _d.$4.get_$8kh()},get_$6vw:function(){return _d.$4.get_$8ki()},get_$8uo:function(){return _d.$4.get_$5oN()},get_$8up:function(){return this.$X9?_d.$4.get_$5oO():_d.$4.get_$8ke()},get_$8un:function(){return this.$X9?_d.$4.get_$5oO():_d.$4.get_$5oN()},get_$8wi:function(){return _d.$4.get_$5oR()},get_$8wj:function(){return this.$X9?_d.$4.get_$5oS():_d.$4.get_$8kg()},get_$8wh:function(){return this.$X9?_d.$4.get_$5oS():_d.$4.get_$5oR()},get_$79s:function(){return _d.$4.get_$5H1()},get_$79t:function(){return this.$X9?_d.$4.get_$5H2():_d.$4.get_$7fW()},get_$79r:function(){return this.$X9?_d.$4.get_$5H2():_d.$4.get_$5H1()},get_$7UY:function(){return _d.$4.get_$5oP()},get_$7UZ:function(){return this.$X9?_d.$4.get_$5oQ():_d.$4.get_$8kf()},get_$7UX:function(){return this.$X9?_d.$4.get_$5oQ():_d.$4.get_$5oP()},get_$179:function(){this.$1pr||(this.$1pr=this.$12.$50t());return this.$1pr},get_$1pW:function(){!this.$171&&this.get_$179()&&(this.$171=this.$fF.$3RW(this.get_$179().get_$48(0),!0));return this.$171},get_$7ZA:function(){return this.$G.get_$O()==="TouchNarrow"&&!this.get_$3WA()&&!this.get_$5wS()&&!this.get_$41Q()&&!this.get_$63F()&&!this.get_$4so()},$1d5:function(n){this.set_$1v(n)},$2b8:function(n){$3Ej(this);if(!$8(this.get_$3zG())){this.get_$3zG()(n.EmailAddress);return}var t=this.$6M.$GU(!1,!0);t.set_$5L(0);t.set_$4D(0);t.set_$4O(new _js.$X);$4MN(this,n);t.get_$4O().$H(n);this.$ym||(this.$ym=new _y.$99);this.$ym.$VM(t)},$3dX:function(n){$3Ej(this);if(!$8(this.get_$30i())){this.get_$30i()(n);return}var t=this;this.$3K.add_$XW(function(){if(t.$3K.$NH){var i=t.$3K.get_$hQ().$3Rd(t.$12,n);t.$p.$y(i)}})},$41O:function(n){var t=_js.$8.$14(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6n.$Q9(String.format("tel:{0}",encodeURIComponent(t)))},$5DH:function(n,t){$6(this,"IMNotAvailable")},$6xW:function(){var n=!$8(this.get_$25o())&&!$8(this.get_$3Q6())&&this.get_$3Q6().$2R;var t=!$8(this.get_$25q())&&!$8(this.get_$3Q7())&&this.get_$3Q7().$2R;var i=!$8(this.get_$5oU())&&!$8(this.get_$41P())&&this.get_$41P().$2R;var r=!$8(this.get_$5yG())&&!$8(this.get_$47M())&&this.get_$47M().$2R;var u=!$8(this.get_$2BZ())&&!$8(this.get_$3dO())&&this.get_$3dO().$2R;var f=!$8(this.get_$3Ua());return n||t||i||r||u||f},$1lB:function(n){if(this.$12.get_$18()===4||this.$12.get_$18()===3||this.$12.get_$18()===1)this.get_$1pW().$1lB();else{var t=this.$fF.$3RW(n,!0);t.$1lB()}_d.$6j.$mo(5,this.$8L.$9S,this.$12.get_$18())},get_$mf:function(){return this.$G.get_$O()!=="Mouse"},$6zg:function(n){this.$2b8(n);_d.$6j.$mo(0,this.$8L.$9S,this.$12.get_$18())},$8kj:function(n){this.$41O(n);_d.$6j.$mo(3,this.$8L.$9S,this.$12.get_$18())},$7Ua:function(n){this.$3dX(n);_d.$6j.$mo(2,this.$8L.$9S,this.$12.get_$18())},$4mK:function(n){$3Ej(this);_a.$5.$1V(_a.$0.$1o,"CreateItemFromPersonaCard");_d.$6j.$mo(1,this.$8L.$9S,this.$12.get_$18());var t=new _d.$TB;t.set_$10(_a.$25.$3RL(_a.$7.get_$2M()));t.set_$DE(36e5);t.set_$Nk(!0);t.set_$37Q("Busy");$4MN(this,n);var i=new _js.$X;var r=_g.$3X.$rO(n);i.$H(r);t.set_$72(i);var u=this.$hW.$2hD(t);this.$G.$L9(Object.getType(this.$hW),null,null,_y.$3p.get_$eK(),u,!1);_a.$5.$1G(null,"CreateItemFromPersonaCard")},$8ww:function(n){var t=_js.$8.$14(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6n.$Q9(String.format("sms:{0}",encodeURIComponent(t)));_d.$6j.$mo(4,this.$8L.$9S,this.$12.get_$18())}};_d.$f2=function(n,t,i,r,u,f,e,o){this.$G=n;this.$p=t;this.$3K=i;this.$fF=r;this.$hW=u;this.$6M=f;this.$9X=e;this.$6n=o};_d.$f2.prototype={$6n:null,$G:null,$p:null,$3K:null,$fF:null,$hW:null,$9X:null,$6M:null,$736:function(n,t,i,r){return new _d.$Fv(n,this.$G,this.$3K,this.$9X,this.$fF,this.$p,this.$hW,this.$6M,this.$6n,t,i,r)}};_d.$qG=function(n,t,i){_d.$qG.initializeBase(this,[n,t,i])};_d.$qG.prototype={$4zz:function(n,t){if(_g.$33.isInstanceOfType(this.get_$1d())){var i=this.get_$1d();switch(i.get_$RR()){case"PhonebookServices":case"Contact":return $2WC(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$12.get_$1l(),n);default:return n}}else{switch(this.$3CK){case 11:return $2WC(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$12.get_$1l(),n)}return _y.$Dm.prototype.$4zz.call(this,n,t)}},$4zF:function(n){if(_c.$i.isInstanceOfType(this.$12)){var t=this.$12;switch(n){case 2:return t.get_$hV();case 3:return t.get_$2M2();case 4:return t.get_$hH()?t.get_$hH().get_$78G():null;case 6:return t.get_$m5()?t.get_$m5().get_$78G():null;case 5:return t.get_$np()?t.get_$np().get_$78G():null;case 7:return t.get_$2g();case 8:return t.get_$27r();case 9:return t.get_$1j7();case 10:return t.get_$15F();case 11:return t.get_$o5()?t.get_$o5().get_$78G():null}}return _y.$Dm.prototype.$4zF.call(this,n)}};_d.$F7=function(n,t,i){this.$$d_$8c7=Function.createDelegate(this,this.$8c7);this.$$d_$8ol=Function.createDelegate(this,this.$8ol);this.$$d_$8kT=Function.createDelegate(this,this.$8kT);this.$$d_$8kS=Function.createDelegate(this,this.$8kS);this.$$d_$5jr=Function.createDelegate(this,this.$5jr);_d.$F7.initializeBase(this);_a.$3.$M(t,"basePersonaViewModel");this.$G=n;this.$PM=t;this.$jd=i;this.$41K=0;this.$wG=!1;this.$27l=!1;$6Ma(this)};function $4Mv(n){n.$PM.set_$bl(!0)}function $6MZ(n){if(n.$PM.get_$2D8())return!1;var t=n.$2Do&&!!n.$HS&&!!n.$HS.$5u&&!n.$HS.$5u.get_$3m();var i=!!n.$HS&&!!n.$HS.$5u&&n.$HS.$5u.get_$58l();return!(t||i||_d.$6S.$3fE||_y.$q.$1mk||_d.$6S.$1mk)}function $6MY(n){if(!n.$HS)return!1;var t=!!n.$HS.$5u&&n.$HS.$5u.get_$58l();var i=!!n.$HS.$5u&&n.$HS.$5u.get_$3m();return!(n.$2Dd||n.$2De||i||t)}function $6Mb(n){if(n.get_$I5().$5u){var u=n.$PM.$2AI();var f=_c.$i.$1QP(u);n.get_$I5().$5u.set_$3m(n.$wG);n.get_$I5().$1Aj(f)}else{var t=_a.$5.acss(n.$IR,"CreatePersonaCard");var i=n.$PM.$2AI();var r=_c.$i.$1QP(i);n.get_$I5().$1Aj(r);_a.$5.aces(t)}}function $6Mc(n){n.get_$TT().$2W=n.$wG;switch(n.$PM.$tq){case 5:n.get_$TT().$9S=2;break;case 1:n.get_$TT().$9S=4;break;case 2:n.get_$TT().$9S=5;break;case 3:n.get_$TT().$9S=6;break;case 6:n.get_$TT().$9S=3;break;case 4:n.get_$TT().$9S=7;break;case 7:n.get_$TT().$9S=11;break;case 0:default:n.get_$TT().$9S&&n.get_$TT().$9S!==1&&(n.get_$TT().$9S=8);break}}function $6Ma(n){switch(n.$PM.$12.get_$18()){case 1:n.$IR=_a.$0.$6q;break;case 2:n.$IR=_a.$0.$2Aj;break;case 5:n.$IR=_a.$0.$tU;break;default:n.$IR=_a.$0.$5mO;break}}_d.$F7.prototype={$G:null,$jd:null,$PM:null,$31r:null,$2Do:!1,$jb:null,$HS:null,$41K:0,$wG:!1,$2Dd:!1,$2De:!1,$27l:!1,$IR:null,get_$5Bf:function(){return this.$2De},set_$5Bf:function(n){this.$2De!==n&&(this.$2De=n);return n},get_$5Be:function(){return this.$2Dd},set_$5Be:function(n){if(this.$2Dd!==n){this.$2Dd=n;this.$2Dd||this.$4lP();$6(this,"IsMouseOverHoverCard")}return n},get_$4t1:function(){return this.$27l},set_$4t1:function(n){this.$27l!==n&&(this.$27l=n);return n},get_$TT:function(){if(!this.$jb){this.$jb=new _d.$Gu;this.$jb.$1Ee=!1;this.$jb.$1RB=!0}return this.$jb},set_$TT:function(n){if(this.$jb!==n){this.$jb=n;this.$HS&&(this.$HS.$qc=n);$6(this,"PersonaCardConfig")}return n},get_$5rm:function(){switch(this.$G.get_$O()){case"Mouse":return 0;case"TouchWide":return 1;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value given for OwaShell.CurrentLayout: "+this.$G.get_$O());}},get_$D4:function(){return this.get_$I5()},get_$I5:function(){if(!this.$HS){var n=_a.$5.acss(this.$IR,"CreatePersonaCardFacade");$6Mc(this);this.$HS=this.$jd.$I(this.get_$TT(),this.get_$5rm());_a.$5.aces(n);if(this.get_$TT().$9S!==1){this.$HS.add_$2b6(this.$$d_$5jr);this.$HS.add_$19q(this.$$d_$8kS);this.$HS.add_$2Mv(this.$$d_$8kT)}$4Z(this,"PersonaCardFacadeViewModel","PersonaCardFacade")}return this.$HS},get_$bl:function(){return this.$2Do},get_$5C9:function(){return this.get_$I5()&&this.get_$I5().$5u?this.get_$I5().$5u.get_$3m():!1},set_$5C9:function(n){this.get_$I5()&&this.get_$I5().$5u&&this.get_$I5().$5u.set_$3m(n);return n},get_$31x:function(){return this.$41K},set_$31x:function(n){this.$41K=n;return n},get_$4p5:function(){return this.$wG},set_$4p5:function(n){this.$wG=n;return n},get_$7bS:function(){return!!this.$HS},$5iI:function(){this.$2De&&this.$62A()},$2c2:function(){var n=_a.$5.acss(this.$IR,"CreatePersonaCard");var t=this.$PM.$2AI();var i=_c.$i.$1QP(t);this.get_$I5().$2c2(i);_a.$5.aces(n)},$93m:function(){if(!this.$G.get_$Qz()){var n=_a.$5.$1V(this.$IR,"ShowPersonaCardExpanded",!0);this.$wG=!0;$4Mv(this);_a.$5.$1G(n);_d.$6j.$3lQ(4,this.get_$TT().$9S,this.$PM.$12.get_$18())}},$62A:function(){if(!this.$G.get_$Qz()&&$6MZ(this)){var n=_a.$5.$1V(this.$IR,"ShowPersonaCardCollapsed",!0);this.$wG=!1;$4Mv(this);_a.$5.$1G(n);_d.$6j.$3lQ(2,this.get_$TT().$9S,this.$PM.$12.get_$18())}},$8sZ:function(){this.$31r=null;this.get_$7bS()&&this.get_$I5().$25U()},$8zM:function(n){n&&$6Mb(this);if(this.$2Do!==n){var t=!1;this.get_$I5()&&(t=!0);if(this.$2Do){!n&&this.get_$I5().$5u&&this.get_$I5().$5u.get_$3m()&&!this.$PM.get_$2D8()&&this.get_$I5().$5u.set_$3m(!1);this.get_$I5().$5u&&(this.$PM.$12.get_$18()===1||this.$PM.$12.get_$18()===2||this.$PM.$12.get_$18()===5)&&!_c.$i.$1fg(this.get_$I5().$5u.$12,this.$31r)&&this.get_$I5().$25U();this.$31r=null}else this.$31r=this.$PM.$12;this.$2Do=n;return t}return!1},$4lP:function(){var n=this;var t=function(){if($6MY(n)){n.$PM.set_$bl(!1);_d.$6j.$3lQ(3,n.get_$TT().$9S,n.$PM.$12.get_$18())}};if(this.$27l)t();else{var r=this;var i=_js.$K.get_$L().$21(this.$IR,"CloseHoverCardPopupAfterTimeout",function(){t();i=null},300)}},$59:function(){if(this.$HS){this.$HS.remove_$2b6(this.$$d_$5jr);this.$HS.remove_$19q(this.$$d_$8kS);this.$HS.remove_$2Mv(this.$$d_$8kT)}_a.$1.prototype.$59.call(this)},$8kT:function(){var n=this.get_$I5().$5u;if(n){n.remove_$5gZ(this.$$d_$8ol);n.$w("IsExpanded",this.$$d_$8c7);this.$wG=n.get_$3m()}},$8kS:function(){var n=this.get_$I5().$5u;if(n){if(_c.$i.$1fg(this.$PM.$12,n.$12)){var t=this.$PM.$2AI();n.set_$4rH(t.get_$1h())}n.set_$2mi(!0);if(this.$G.get_$O()!=="Mouse"){n.set_$bh(!1);n.set_$3m(!0)}else{n.set_$3m(this.$wG);n.set_$bh(!0)}n.add_$5gZ(this.$$d_$8ol);n.$a("IsExpanded",this.$$d_$8c7)}},$8ol:function(){this.$PM.set_$bl(!1)},$8c7:function(n,t){this.$wG=n.get_$3m();$6(this,"IsPersonaCardExpanded")},$5jr:function(){this.$HS&&this.$G.get_$O()==="Mouse"&&this.$PM.set_$bl(!1)}};_d.$QF=function(n,t){this.$G=n;this.$jd=t};_d.$QF.prototype={$G:null,$jd:null,$4oE:function(n){return new _d.$F7(this.$G,n,this.$jd.get_$1d())}};_d.$f7=function(){_d.$f7.initializeBase(this);this.$V=new _js.$X;this.$1r=new _y.$4p};_d.$f7.prototype={$V:null,$1r:null,$105:null,$jT:null,$Dh:null,$Hl:!1,get_$5e0:function(){return this.$105},set_$5e0:function(n){_a.$3.$HZ(this.$105,null,"MyContactsTreeNode");this.$105=n;return n},get_$5mP:function(){return this.$jT},set_$5mP:function(n){_a.$3.$HZ(this.$jT,null,"OtherContactsTreeNode");this.$jT=n;return n},$2Mk:function(n){this.$1r.$3A(0,n,null)}};_d.$4d=function(n,t,i,r,u,f,e){this.$$d_$73F=Function.createDelegate(this,this.$73F);this.$$d_$73G=Function.createDelegate(this,this.$73G);this.$$d_$8Oi=Function.createDelegate(this,this.$8Oi);this.$$d_$8Oj=Function.createDelegate(this,this.$8Oj);this.$$d_$8rS=Function.createDelegate(this,this.$8rS);this.$$d_$8rT=Function.createDelegate(this,this.$8rT);this.$$d_$78j=Function.createDelegate(this,this.$78j);this.$$d_$78i=Function.createDelegate(this,this.$78i);this.$$d_$7Vb=Function.createDelegate(this,this.$7Vb);this.$$d_$8no=Function.createDelegate(this,this.$8no);this.$$d_$7Vm=Function.createDelegate(this,this.$7Vm);this.$$d_$2dN=Function.createDelegate(this,this.$2dN);this.$$d_$8Or=Function.createDelegate(this,this.$8Or);this.$$d_$3RH=Function.createDelegate(this,this.$3RH);this.$$d_$8rP=Function.createDelegate(this,this.$8rP);this.$$d_$8Ta=Function.createDelegate(this,this.$8Ta);_d.$4d.initializeBase(this);_a.$3.$17(i,"rootNode");this.$Ad=i;this.$G=n;this.$Z5=e;$8(r)||(this.$iC=r);this.$Gc=t;this.$V=new _js.$X;this.$V.add_$1Z(this.$$d_$8Ta);this.$3fr=!1;this.$2lo=u||this.$G.get_$O()!=="Mouse";this.set_$1Tl(f);if(!this.$2lo){this.$5tM=new _C(this.$$d_$8rP,_d.$4d.$D);this.$4oG=new _C(this.$$d_$3RH,_d.$4d.$D);this.$5dn=new _C(this.$$d_$8Or,_d.$4d.$D);this.$78X=new _C(this.$$d_$2dN,_d.$4d.$D);$4Mz(this)}};function $6Mm(n,t){return new _0365m.$n($6Ml(n,t),null,n.$5dn)}function $6Mk(n){n.$8W=new _0365m.$2c([]);n.$Gc&&$4My(n,n.$8W,n.$Gc.get_$16c());if($6Mj(n)){n.$8W.$1B.get_$F()>0&&n.$8W.$1B.$H(new _0365m.$9q);n.$8W.$1B.$H(n.get_$8PX())}}function $4My(n,t,i){var r=t.$1B;if(n.$Gc){(n.$Gc.$LK===5||n.$Gc.$LK===10)&&r.$6G([n.get_$8rQ(),n.get_$78Y(),$6Mm(n,i)]);n.$Gc.get_$5Bk()&&r.$H(n.get_$7Vf())}}function $6Mj(n){return!n.$Gc||n.$Gc.get_$1Gt()?!0:!1}function $6Ml(n,t){return String.format(_u.Strings.l_ContactFolderMoveToGroupMenuTitle_LowerCase_Text,t?_u.Strings.l_OtherFiltersTitle_LowerCase_Text:_u.Strings.l_MyContactsFolderDisplayName_LowerCase_Text)}function $21e(n){n.set_$Bb(1)}function $4N0(n,t){n.$Ad.$105.set_$2X(!0);n.$8W=new _0365m.$2c([]);$4My(n,n.$8W,t);if(t){n.$Ad.$jT.$V.$3Q(n);n.$Ad.$105.$V.$H(n)}else{n.$Ad.$105.$V.$3Q(n);n.$Ad.$jT.$V.$H(n);n.$Ad.$jT.set_$Gi(!1)}$6(n,"IsChildOfOtherContactsFolder")}function $4Mz(n){_a.$3.$8z(!n.$3fr,"Context menu commands are already hooked up. Can NOT HookupContextMenu() second time!");if(!n.$2lo&&n.$2Cj){$6Mk(n);n.$3fr=!0}}_d.$4d.prototype={$Gc:null,$iC:null,$G:null,$Ad:null,$2lo:!1,$Z5:!1,$5tM:null,$4oG:null,$5dn:null,$78X:null,$8W:null,$109:null,$AL:0,$V:null,$3G:!1,$8P:!1,$N9:!1,$3fr:!1,$2Cj:!1,$2bm:null,$3wD:null,$uC:null,$4rm:null,$2Ji:null,$3fq:!1,get_$2DG:function(){return!$8(this.$iC)},get_$59T:function(){return this.$3fq||this.get_$3ht()&&!this.$N9},set_$59T:function(n){if(this.$3fq!==n){this.$3fq=n;$6(this,"IsContactFolderHidden")}return n},get_$1Tl:function(){return this.$2Cj},set_$1Tl:function(n){if(this.$2Cj!==n){this.$2Cj=n;$6(this,"IsContactFolderReadyForUsage")}return n},get_$3ht:function(){return this===this.$Ad.$jT},get_$7Y4:function(){return!this.$Ad.$jT||!this.$Ad.$jT.$V.get_$F()?!1:this.$Ad.$jT.$V.$6l(this)},get_$Gi:function(){return this.$8P},set_$Gi:function(n){if(n!==this.$8P){this.$Gc&&this.$Gc.get_$1Gt()&&this.$Ad.$jT.set_$59T(n);this.$8P=n;$6(this,"IsCollapsed")}return n},get_$2X:function(){return this.$3G},set_$2X:function(n){if(n!==this.$3G){this.$3G=n;$6(this,"IsSelected")}return n},get_$8PW:function(){return this.$109},set_$8PW:function(n){if(n!==this.$109){this.$109=n;$6(this,"NewContactFolderName")}return n},get_$Ua:function(){return this.$N9},set_$Ua:function(n){if(n!==this.$N9){this.$N9=n;$Nu(this,"HasChildren","IsChildOfOtherContactsFolder","IsContactFolderHidden")}return n},get_$Bb:function(){return this.$AL},set_$Bb:function(n){if(n!==this.$AL){this.$AL=n;$6(this,"TreeNodeMode")}return n},get_$8rQ:function(){return new _0365m.$n(_u.Strings.l_Rename_LowerCase_Text,null,new _C(this.$$d_$7Vm,_d.$4d.$D))},get_$78Y:function(){return new _0365m.$n(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$8no,_d.$4d.$D))},get_$7Vf:function(){return new _0365m.$n(_u.Strings.l_PeopleConnect_ManageContactFolder_Text,null,new _C(_d.$P2.$5lm,_d.$4d.$D))},get_$8PX:function(){return new _0365m.$n(_u.Strings.l_ContactFolderNewFolderMenuTitle_LowerCase_Text,null,new _C(this.$$d_$7Vb,_d.$4d.$D))},$8Ta:function(n,t){this.set_$Ua(this.$V.get_$F()>0)},$8no:function(){var n=this;this.$Ad.$1r.$3A(2,_u.Strings.l_ContactFolderDeleteFolderPromptText_Text,function(t,i){t&&n.$2dN()},!1,null,null,String.format(_u.Strings.l_ContactFolderDeleteFolderTitle_Text,this.$Gc.$6m))},$2dN:function(){if(!this.$Ad.$Hl&&_d.$Mm.isInstanceOfType(this.$Gc)){var n=this.$4rm;if(!$8(n)){n.remove_$20(this.$$d_$78i);n.remove_$2A(this.$$d_$78j)}n=this.$4rm=new _c.$yG(this.$Gc.$6f);this.set_$1Tl(!1);n.add_$2A(this.$$d_$78j);n.add_$20(this.$$d_$78i);this.$Ad.$Hl=!0;OwaApplication.$1T.$y(n)}},$78i:function(n){this.$Ad.$2Mk(_u.Strings.l_ContactFolderDeleteGenericError_Text);this.$Ad.$Hl=!1;this.set_$1Tl(!0)},$78j:function(n){this.$Ad.$Hl=!1;var t=this.$3G;this.set_$2X(!1);this.$Gc.get_$16c()?this.$Ad.$105.$V.$3Q(this):this.$Ad.$jT.$V.$3Q(this);t&&this.$Ad.$105.set_$2X(!0)},$7Vm:function(){this.set_$Bb(4)},$8rP:function(){if(this.$Ad.$Hl){$21e(this);return}if(_js.$8.$14(this.$109)||this.$109.trim()===this.$Gc.$6m){$21e(this);return}if(_h.$l.$5AM(this.$Gc.$6f,this.$109)){this.$Ad.$2Mk(_u.Strings.l_SameNameFolderExists_Text);$21e(this);return}var n;if(!$8(this.$uC)){n=this.$uC;n.remove_$2A(this.$$d_$8rT);n.remove_$20(this.$$d_$8rS);this.$uC=null}n=this.$uC=new _h.$nr;n.$2B=this.$Gc.$6f;n.$2yM=this.$109;n.add_$2A(this.$$d_$8rT);n.add_$20(this.$$d_$8rS);this.set_$Bb(2);this.set_$1Tl(!1);this.$Ad.$Hl=!0;OwaApplication.$1T.$y(n)},$8rS:function(n){this.$Ad.$2Mk(_u.Strings.l_ContactFolderRenameGenericError_Text);$21e(this);this.$Ad.$Hl=!1;this.set_$1Tl(!0)},$8rT:function(n){var t=this.$3G;this.set_$2X(!1);t&&this.$Ad.$105.set_$2X(!0);$21e(this);this.$Ad.$Hl=!1;this.set_$1Tl(!0)},$8Or:function(){if(!this.$Ad.$Hl&&_d.$Mm.isInstanceOfType(this.$Gc)){var t=this.$Gc;var n=this.$2Ji;if(!$8(n)){n.remove_$2A(this.$$d_$8Oj);n.remove_$20(this.$$d_$8Oi);this.$2Ji=null}n=this.$Gc.get_$16c()?this.$2Ji=new _c.$t9(t.$6f,10):this.$2Ji=new _c.$t9(t.$6f,1);n.add_$2A(this.$$d_$8Oj);n.add_$20(this.$$d_$8Oi);$4N0(this,!this.$Gc.get_$16c());this.$Ad.$Hl=!0;OwaApplication.$1T.$y(n)}},$8Oi:function(n){this.$Ad.$Hl=!1;$4N0(this,this.$Gc.get_$16c());this.$Ad.$2Mk(this.$2Ji.$Bw)},$8Oj:function(n){this.$Ad.$Hl=!1},$7Vb:function(){if(!this.$Ad.$Hl){var n=!$8(this.$Gc)&&this.$Gc.get_$16c()?this.$Ad.$105:this.$Ad.$jT;n.set_$Bb(3)}},$3RH:function(){if(this.get_$2DG()||this.$Gc.get_$1Gt()){if(this.$Ad.$Hl){this.set_$Bb(1);return}if(_js.$8.$14(this.$109)){this.set_$Bb(1);return}var n=this.$2bm;if(!$8(n)){n.remove_$2A(this.$$d_$73G);n.remove_$20(this.$$d_$73F);this.$2bm=null}n=this.$2bm=new _c.$xj(this.$109,this.get_$2DG()?10:1,_g.$g.$1i.nameToId("contacts"),this.$Ad.$Dh);var t=new _d.$Mm(n.$1JU);var i=this.$3wD=new _d.$4d(this.$G,t,this.$Ad,null,this.$2lo,!1);n.add_$2A(this.$3wD.$$d_$73G);n.add_$20(this.$$d_$73F);this.$V.$H(i);this.$Ad.$Hl=!0;this.set_$Bb(1);OwaApplication.$1T.$y(n)}},$73F:function(n){this.$Ad.$2Mk(this.$2bm.$Bw);this.$V.$3Q(this.$3wD);this.$Ad.$Hl=!1},$73G:function(n){this.set_$1Tl(!0);$4Mz(this);this.$Ad.$Hl=!1;$6(this,"ContextMenuViewModel")}};_d.$YJ=function(){this.$3Xs=new _d.$TV(0,new _h.$BA("PersonaDisplayNameFirstLast","Ascending"),_u.Strings.l_DisplayPreferences_FirstOption_LowerCase_Text);this.$3kJ=new _d.$TV(1,new _h.$BA("PersonaDisplayNameLastFirst","Ascending"),_u.Strings.l_DisplayPreferences_SecondOption_LowerCase_Text);_d.$YJ.initializeBase(this);this.set_$5N(_d.$YJ.$1iW);this.set_$24C(1);this.get_$3T().$H(this.$3Xs);this.get_$3T().$H(this.$3kJ)};_d.$YJ.prototype={$4pT:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$TV=function(n,t,i){_d.$TV.initializeBase(this);_a.$3.$17(n,"displayOption");_a.$3.$17(t,"sortBy");_a.$3.$17(i,"contextMenuDisplayName");this.$2eO=n;this.$F2=t;this.$14C=i};_d.$TV.prototype={$2eO:0,$F2:null,$14C:null,toString:function(){return _d.$qi.toString(this.$2eO)}};_d.$JZ=function(){};_d.$JZ.$51S=function(n){return n===1?_d.$JZ.$5oJ:_d.$JZ.$5oI};_d.$z9=function(){};_d.$z9.prototype={$3a4:function(n){return new _c.$10R(n)}};_d.$82=function(n,t,i,r,u){this.$$d_$8by=Function.createDelegate(this,this.$8by);this.$$d_$32J=Function.createDelegate(this,this.$32J);this.$$d_$8bh=Function.createDelegate(this,this.$8bh);this.$$d_$8ax=Function.createDelegate(this,this.$8ax);this.$$d_$8hF=Function.createDelegate(this,this.$8hF);this.$$d_$7EN=Function.createDelegate(this,this.$7EN);this.$$d_$5hD=Function.createDelegate(this,this.$5hD);this.$$d_$8gA=Function.createDelegate(this,this.$8gA);_d.$82.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$82.initializeBase(this);this.$G=n;this.set_$5N(_d.$82.$1iW);this.$Z5=u;this.$19d=new _js.$X;this.$1Lb=new _js.$X;this.$BF=new _d.$SM;this.$BF.add_$5xO(this.$$d_$8gA);this.$r4=new _d.$YJ;this.$r4.add_$5xO(this.$$d_$5hD);this.$2OQ=!0;this.$1y0(_u.Strings.l_MyContactsFolderDisplayName_Text);this.$9KH(new _d.$z9);this.$4vp=new _C(this.$$d_$7EN,_d.$82.$D);this.$5x8=new _C(this.$$d_$8hF,_d.$82.$D);this.$g1=this.$G.get_$O();this.$1oo=_y.$49.$f6(this.$G);this.$g1==="TouchNarrow"&&this.set_$7E($6NM(this));this.set_$md(i);this.$4wT=t;this.$2Ck=r;var f=_g.$S.get_$L();this.$49V=f.get_$38().get_$X0()&&(f.get_$6D().get_$3XK()||f.get_$6D().get_$3kp());if(this.$49V){var e=_a.$5.$1V(_a.$0.$9C,_js.$8.$4C("PeopleConnectLinkShown,FB={0},LI={1}",f.get_$6D().get_$3XK(),f.get_$6D().get_$3kp()),!0);$6NN(this);_a.$5.$1G(e)}};_d.$82.$918=function(n,t){return!n&&t==="TouchWide"||n===1&&t!=="TouchNarrow"};function $2Tr(n,t,i,r){var u;var f=r?n.$19d:n.$1Lb;switch(i.$3R){case 0:for(var e=0;e<i.$2t.length;e++){u=i.$2t[e].$Gc;f.$H(u);n.get_$3T().$H(u)}break;case 2:for(var o=0;o<i.$3Y.length;o++){u=i.$3Y[o].$Gc;f.$H(u);n.get_$3T().$3Q(u)}break;case 3:$2Tr(n,t,new _js.$JN(2,i.$4T,null,i.$3Y),r);$2Tr(n,t,new _js.$JN(0,i.$4T,i.$2t,null),r);break;case 4:f.$1u();n.get_$3T().$1u();break}}function $6NM(n){var t=_y.$26.$Bv(n,null,null);t.$dc(new _C(n.$$d_$32J,_d.$82.$D));return t}function $6NN(n){_js.Trace.logInfo(_d.$82.$D,"Subscribing to people connect notifications.");var t=new _g.$Bm;t.NotificationType="RowNotification";t.FolderId=_g.$2Q.$9K("peopleconnect").get_$n().Id;_js.Trace.logInfo(_a.$0.$5v,"[FilterListVM::SubscribeToNotifications] FolderId: {0}",t.FolderId);var i=new _h.$DH(t);i.$HX(_d.$82.$D,"FilterListVM:RowNotification",n.$$d_$8by,2)}_d.$82.prototype={$4wT:0,$5x8:null,$4vp:null,$19d:null,$1Lb:null,$G:null,$BF:null,$r4:null,$2Ck:!1,$49V:!1,$g1:0,$1oo:!1,$Z5:!1,$40i:null,$QR:null,$Bn:null,$wH:null,$Pl:!1,$2OQ:!1,$292:null,$2gR:null,$1As:null,$2xw:null,$3t:null,$2o:null,$dz:null,$48w:!0,$Dm:!1,$2JY:null,$48r:!0,add_$3y6:function(n){this.$2Z("OnFolderSelected",n)},remove_$3y6:function(n){this.$2b("OnFolderSelected",n)},get_$7G7:function(){return this.$g1==="Mouse"?_y.$4.get_$1h8():this.$g1==="TouchWide"?_y.$4.get_$1h9():_y.$4.get_$O7()},get_$7G8:function(){return this.$g1==="Mouse"?_y.$4.get_$1Pj():this.$g1==="TouchWide"?_y.$4.get_$1h9():_y.$4.get_$O7()},get_$7GA:function(){return this.$g1==="Mouse"?_y.$4.get_$1hA():this.$g1==="TouchWide"?_y.$4.get_$1hB():_y.$4.get_$O7()},get_$7GB:function(){return this.$g1==="Mouse"?_y.$4.get_$1Pk():this.$g1==="TouchWide"?_y.$4.get_$1hB():_y.$4.get_$O7()},get_$25:function(){return _y.$EE.prototype.get_$25.call(this)},set_$25:function(n){_y.$EE.prototype.set_$25.call(this,n);n&&n.$6f.get_$n()?this.set_$4pg(n.$3ZN(this.$BF.get_$25().$S6,this.$dz)):this.set_$4pg(null);$6(this,"IsMailboxFilterSelected");return n},get_$1ne:function(){return!this.get_$25()||this.get_$25().get_$2nC()},get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?2:0},get_$30c:function(){return null},get_$30e:function(){return null},get_$3L:function(){return this.$2o},set_$3L:function(n){this.$2o=n;return n},get_$7E:function(){return this.$3t},set_$7E:function(n){if(this.$3t!==n){this.$3t=n;$6(this,"ApplicationBarViewModel")}return n},get_$ZD:function(){return this.$Dm},set_$ZD:function(n){if(n!==this.$Dm){this.$Dm=n;$6(this,"IsTransitionedIn")}return n},get_$717:function(){return this.$dz},set_$717:function(n){this.$dz=n;this.$wH=this.get_$25().$3ZN(this.$BF.get_$25().$S6,this.$dz);return n},get_$4pg:function(){return this.$wH},set_$4pg:function(n){this.$wH=n;this.$3Be();$6(this,"CurrentConfiguration");return n},get_$2Nx:function(){return this.$QR},set_$2Nx:function(n){if(n!==this.$QR){this.$QR=n;$6(this,"RootTreeNode")}return n},get_$7FS:function(){return this.$2gR},set_$7FS:function(n){if(this.$2gR!==n){this.$2gR=n;$6(this,"FirstFilterOptionDisplayName")}return n},get_$7Em:function(){return this.$292},set_$7Em:function(n){if(this.$292!==n){this.$292=n;$4Z(this,"FilterOptionDisplayName","AriaFilterOptionDisplayName")}return n},get_$2QW:function(){return this.$1As},set_$2QW:function(n){if(this.$1As!==n){this.$1As=n;$4Z(this,"SortOptionDisplayName","AriaSortOptionDisplayName")}return n},get_$6sv:function(){return String.format(_u.Strings.l_PeopleFilterOption_AT_Text,this.$292)},get_$6t0:function(){return String.format(_u.Strings.l_PeopleSortOption_AT_Text,this.$1As)},get_$gW:function(){return this.$Bn},set_$gW:function(n){if(n!==this.$Bn){this.$Bn=n;$6(this,"SelectedTreeNode");$8(n)||this.set_$25(n.$Gc)}return n},get_$8vO:function(){return this.$2OQ},set_$8vO:function(n){if(n!==this.$2OQ){this.$2OQ=n;$6(this,"SecondaryListIsEmpty")}return n},get_$1bo:function(){if(this.$g1==="Mouse")return this.$Z5?this.$Pl?214:57:this.$Pl?175:60;else if(this.$g1==="TouchWide")return this.$Pl?this.$1oo?244:260:60;return 0},get_$62n:function(){return 60},get_$62m:function(){return 274},get_$7GC:function(){return this.$Pl?_u.Strings.l_PeopleCollapseFolder_AT_Text:_u.Strings.l_PeopleExpandFolder_AT_Text},get_$md:function(){return this.$Pl},set_$md:function(n){if(n!==this.$Pl){this.$Pl=n;$Nu(this,"IsSidePanelExpanded","FolderPanePaneButtonAriaLabel","SidePanelWidth")}return n},get_$5dz:function(){if(!this.$2xw){this.$2xw=_g.$2Q.$9K("mycontacts");this.$2xw.set_$1l(_u.Strings.l_MyContactsFolderDisplayName_Text)}return this.$2xw},get_$8jx:function(){this.$40i||(this.$40i=new _C(_d.$P2.$5lm,_d.$82.$D));return this.$40i},$1y0:function(n){this.set_$7Em(String.format(_u.Strings.l_PeopleFilterOptionDisplayName_Text,n,this.$BF.get_$25().$6m));this.set_$7FS(n);this.get_$1ne()?this.set_$2QW(String.format(_u.Strings.l_PeopleFilterOptionDisplayNameSort_Text,this.$BF.get_$25().$6m)):this.set_$2QW(_u.Strings.l_PeopleDirectoryBrowseSortByDisplayName_Text)},$3Be:function(){this.$48w&&($8(this.get_$25())?this.$1y0(_u.Strings.l_MyContactsFolderDisplayName_Text):this.$1y0(this.get_$25().$6m))},$4zk:function(){return $8(this.$wH)?this.get_$5dz():this.$wH.$2B},$32J:function(){this.get_$3L().$BX()},$co:function(){},$Fe:function(){this.set_$ZD(!0)},$gC:function(){this.set_$ZD(!1)},$Rx:function(){},$4pT:function(n){return new _d.$Mm(n)},$8ab:function(n,t){_y.$EE.prototype.$8ab.call(this,n,t);this.$72z()},$72z:function(){this.$19d.$1u();this.$1Lb.$1u();this.$2JY=null;var n=new _d.$f7;n.$Dh=_h.$l.$ea("msgfolderroot");for(var f=null,i=null,u=new _d.$4d(this.$G,null,n,_u.Strings.l_OtherFiltersTitle_Text,this.$2Ck,!0,this.$Z5),r=null,o=new _js.$X,e=0;e<this.get_$3T().get_$F();e++){var t=this.get_$3T().get_$48(e);if(t.get_$7Z3()){f=new _d.$4d(this.$G,t,n,null,!0,!0,this.$Z5);this.$19d.$H(t);continue}if(t.get_$1Gt()){i=new _d.$4d(this.$G,t,n,null,this.$2Ck,!0,this.$Z5);this.$19d.$H(t);continue}if(t.get_$2nC())if(t.get_$16c()){i.$V.$H(new _d.$4d(this.$G,t,n,null,this.$2Ck,!0,this.$Z5));this.$19d.$H(t)}else{u.$V.$H(new _d.$4d(this.$G,t,n,null,this.$2Ck,!0,this.$Z5));this.$1Lb.$H(t)}else if(t.get_$2mc())r=new _d.$4d(this.$G,t,n,null,!0,!0,this.$Z5);else{r||(r=new _d.$4d(this.$G,null,n,_u.Strings.l_PeopleDirectoryContainer_Text,!0,!0,this.$Z5));var s=new _d.$4d(this.$G,t,n,null,!0,!0,this.$Z5);o.$H(s);t.get_$5Ba()&&(this.$2JY=s)}}f&&n.$V.$H(f);if(i){n.set_$5e0(i);n.$V.$H(i);i.set_$Gi(!1);this.$48r&&i.set_$2X(!0);n.set_$5mP(u);n.$V.$H(u);i.$V.add_$1Z(this.$$d_$8ax);u.$V.add_$1Z(this.$$d_$8bh);u.set_$Gi(!0)}if(r){r.$V.$6G(o.$7V());n.$V.$H(r)}this.set_$2Nx(n);this.$2OQ=!this.$1Lb.get_$F()},$8ax:function(n,t){$2Tr(this,n,t,!0)},$8bh:function(n,t){$2Tr(this,n,t,!1)},$7EN:function(){this.set_$md(!this.$Pl)},$8hF:function(){$6b(this,"OnFolderSelected");this.$g1==="TouchNarrow"?this.$32J():this.set_$md(!_d.$82.$918(this.$4wT,this.$g1))},$8gA:function(n,t){this.$3Be();this.get_$25()&&(this.$wH=this.get_$25().$3ZN(this.$BF.get_$25().$S6,this.$dz));$6(this,"SortOptionPropertyChanged")},$5hD:function(n,t){this.$BF.$9FR(n);$6(this,"DisplayOptionPropertyChanged")},$8by:function(n){if(n.EventType==="RowAdded"){var i=n;var r=i;var t=r.Item;$8(t)||t.ItemClass!==_d.$P2.get_$8jy()&&t.ItemClass!==_d.$P2.get_$8jz()||this.$gI()}}};_d.$IW=function(n,t,i,r){_d.$IW.initializeBase(this,[n,t,i,r])};function $4Oo(n){return!(n.$18z||n.$1Jx||n.$18y)}function $6Q0(n,t,i,r){if((n.$18z||n.$18y)&&t.$6f.$LK===1002){n.$3L9=new _d.$4d(r,t,i,null,!0,!0);return!1}if(n.$18z&&!n.$18y&&t.$6f.$LK===1004){n.$3L1=new _d.$4d(r,t,i,null,!0,!0);return!1}if((n.$1Jx||n.$18y)&&t.$6f.$LK===1003){n.$3L4=new _d.$4d(r,t,i,null,!0,!0);return!1}return(n.$18z||n.$1Jx||n.$18y)?!1:!0}function $6Pz(n){return!n.$1Ya}function $6Py(n){return!n.$2Ky}function $6Px(n,t){n.$1Ya&&t.$N9&&n.set_$25(t.$V.get_$48(0).$Gc)}_d.$IW.prototype={$2Ky:!1,$1Ya:!1,$18z:!1,$1Jx:!1,$18y:!1,$3L9:null,$3L4:null,$3L1:null,$72z:function(){this.$19d.$1u();this.$1Lb.$1u();var f=this.$G.get_$O()==="TouchNarrow";var n=new _d.$f7;n.$Dh=_h.$l.$ea("msgfolderroot");for(var r=null,u=new _d.$4d(this.$G,null,n,_u.Strings.l_OtherFiltersTitle_Text,f,!0),i=null,e=new _d.$4d(this.$G,null,n,_u.Strings.l_OtherAddressListsFiltersTitle_Text,!0,!0),o=0;o<this.get_$3T().get_$F();o++){var t=this.get_$3T().get_$48(o);if(t.get_$1Gt()){r=new _d.$4d(this.$G,t,n,null,f,!0);this.$19d.$H(t);continue}if(t.get_$2nC())if(t.get_$16c()){r.$V.$H(new _d.$4d(this.$G,t,n,null,f,!0));this.$19d.$H(t)}else{u.$V.$H(new _d.$4d(this.$G,t,n,null,f,!0));this.$1Lb.$H(t)}else if(t.get_$2mc()){i||(i=new _d.$4d(this.$G,null,n,_u.Strings.l_PeopleDirectoryContainer_Text,!0,!0));$4Oo(this)&&i.$V.$H(new _d.$4d(this.$G,t,n,null,!0,!0))}else $6Q0(this,t,n,this.$G)&&e.$V.$H(new _d.$4d(this.$G,t,n,null,!0,!0))}if(!$8(r)&&$6Pz(this)){n.set_$5e0(r);n.$V.$H(r);r.set_$Gi(!1);r.set_$2X(!0);n.set_$5mP(u);r.$V.$H(u);r.$V.add_$1Z(this.$$d_$8ax);u.$V.add_$1Z(this.$$d_$8bh);u.set_$Gi(!0)}if(!$8(i)&&$6Py(this)){n.$V.$H(i);if($4Oo(this)){i.$V.$H(e);e.set_$Gi(!0)}else{this.$3L9&&i.$V.$H(this.$3L9);this.$3L1&&i.$V.$H(this.$3L1);this.$3L4&&i.$V.$H(this.$3L4)}$6Px(this,i)}this.set_$2Nx(n);this.set_$8vO(!this.$1Lb.get_$F())}};_d.$1Dk=function(n,t){this.$6m="";_d.$1Dk.initializeBase(this);if(!n)throw Error.argumentNull("displayName");this.set_$1l(n);this.$LK=t};_d.$1Dk.prototype={$LK:0,get_$1l:function(){return this.$6m},set_$1l:function(n){this.$6m=n;$6(this,"DisplayName");return n},get_$1Gt:function(){return _c.$Cq.$5Bj(this.$LK)},get_$7Z3:function(){return _c.$Cq.$5A7(this.$LK)},get_$7bo:function(){return _c.$Cq.$7bp(this.$LK)},get_$2mc:function(){return _c.$Cq.$7ZN(this.$LK)},get_$16c:function(){return _c.$Cq.$5Bj(this.$LK)||_c.$Cq.$91A(this.$LK)},get_$2nC:function(){return!_c.$Cq.$919(this.$LK)},get_$5Bk:function(){return _c.$Cq.$5Bl(this.$LK)},get_$5Ba:function(){return _c.$Cq.$7ah(this.$LK)||this.$6m==="All Modern Groups"}};_d.$CO=function(n,t,i){this.$1T=n;this.$1K=t;this.$S=i};_d.$CO.$1QB=function(n){n.set_$OY(!0);n.set_$15(!1);n.set_$12U(100);n.set_$1Xb(0)};_d.$CO.prototype={$1T:null,$1K:null,$S:null,$I:function(n,t,i,r,u,f){var e=new _d.$22(n,t,i,this.$1T,!$8(u)&&u,f,this.$1K,this.$S);e.set_$1aY(r);return e}};_d.$IG=function(n,t){this.$$d_$8Sp=Function.createDelegate(this,this.$8Sp);this.$$d_$8eC=Function.createDelegate(this,this.$8eC);this.$1GD=-1;this.$eO={};_d.$IG.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$IG.initializeBase(this,[_c.$14.$rT,_c.$14.$bV(),!0,n,!1,t,null,null]);this.set_$1aY("PersonaDetailedView");this.$vd();this.set_$15(!1);this.set_$OY(!0);this.set_$oy(!0)};function $6NQ(n){var u=n.$2k;if(_js.$8.$14(u))return!0;var i=_d.$2n.$5nB(u);var f=i.length;if(f===1){var t;var e,o;var s=(o=_d.$2n.$2bq(i[0],e={val:t}),t=e.val,o);if(!s||!t)return!0;n.$1ZT=new _js.$X;n.$1NM=new _js.$X;n.$1ZT.$H(s);n.$1NM.$H(t)}else{n.$1ZT=new _js.$X;n.$1NM=new _js.$X;n.$W2=new _js.$X;for(var r=0;r<f;r++)$6NP(n,i[r])}if(n.$1ZT.get_$F()>0){$dY(n,"BulkResolvePersonasReady",n.$1ZT);return!1}return!0}function $6NP(n,t){var i;var u,f;var r=(f=_d.$2n.$2bq(t,u={val:i}),i=u.val,f);if(r){n.$1ZT.$H(r);n.$1NM.$H(i);if(!i){var e=r.get_$1h().Name;n.$W2.get_$F()||n.$5Hx(e);n.$W2.$H(e)}}}function $4NL(n,t){var i=n.get_$75c()(t);if(!Object.getType(i).implementsInterface(_c.$sU))throw Error.argument("The server search action must implement IQueryAction interface");n.$2Z9=i;n.$2Z9.add_$2m(n.$$d_$8Sp);n.$1T.$y(n.$2Z9)}function $6NR(n,t,i){if($8(t.$1b)){var r=t.get_$11D();n.$eO[n.$1wL]=r}else{n.set_$12L(_u.Strings.l_ServerSearchError_Text);n.set_$1aX("")}}_d.$IG.prototype={$2Z9:null,$1ZT:null,$1NM:null,$W2:null,$1wL:null,$2Zr:!1,add_$5gE:function(n){this.$2Z("BulkResolvePersonasReady",n)},remove_$5gE:function(n){this.$2b("BulkResolvePersonasReady",n)},add_$62z:function(n){this.$2Z("SingleActionResultsReady",n)},remove_$62z:function(n){this.$2b("SingleActionResultsReady",n)},get_$9Cd:function(){return this.$W2},set_$9Cd:function(n){this.$W2!==n&&(this.$W2=n);return n},get_$3OW:function(){return this.$2Zr},set_$3OW:function(n){this.$2Zr!==n&&(this.$2Zr=n);return n},$5u0:function(){this.$W2=null;this.$1ZT=null;this.$1NM=null;var n=this.$eO;for(var t in n){var i={key:t,value:n[t]};delete this.$eO[i.key]}},$5Hx:function(n){this.$1GD=0;this.$1wL=n;$4NL(this,n)},$7Rl:function(n){_a.$3.$M(n,"HandleResultsFromSpeech");var i=$21g(this,n);if(!(i===1&&$4NM(this,n.get_$48(0)))){var t=this;_js.$K.get_$L().$21(_a.$0.$UN,"ResultVisible",function(){t.set_$a9(!0);t.set_$2B9(!0)},1e3)}},$59:function(){if(!$8(this.$eO)){var n=this.$eO;for(var t in n){var i={key:t,value:n[t]};var r=i.key;delete this.$eO[r]}}_y.$6Y.prototype.$59.call(this)},$6yF:function(){},$91Y:function(){if(this.$2k in this.$eO){var n=this.$eO[this.$2k];$4NO(this);$21g(this,n);return!1}if(this.$15t){this.set_$2jO(!1);if($8(this.$W2)||!this.$W2.get_$F())return $6NQ(this)}if(this.$W2&&this.$W2.get_$F()>0){$3F3(this);var t=this.$W2.$7h(this.$2k);if(t!==-1){this.set_$2oK(!1);this.set_$33F(!0);this.set_$1aX("");this.set_$12L(String.format(_u.Strings.l_SearchingForResultsString_Text,this.$2k));$2Tv(this);this.$3bT();this.set_$HE(!0);this.add_$62z(this.$$d_$8eC);return!1}}return!0},$921:function(){if(this.$2k in this.$eO){var n=this.$eO[this.$2k];$21g(this,n);return!1}return!0},$8Sp:function(n){if($8(n.$1b)&&$8(n.get_$11D()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2Z9){var i;$6NR(this,n,i={val:t});t=i.val;$dX(this,"SingleActionResultsReady")}n.remove_$2m(this.$$d_$8Sp);if(!$8(this.$W2)){do this.$1GD++;while(this.$1GD<this.$W2.get_$F()&&this.$W2.get_$48(this.$1GD)in this.$eO);if(this.$1GD<this.$W2.get_$F()){this.$1wL=this.$W2.get_$48(this.$1GD);$4NL(this,this.$1wL)}else this.$1GD=-1}},$8eC:function(){if(this.$2k in this.$eO){var n=this.$eO[this.$2k];$21g(this,n)}this.remove_$62z(this.$$d_$8eC)}};_d.$Mm=function(n){this.$$d_$63O=Function.createDelegate(this,this.$63O);this.$$d_$9DZ=Function.createDelegate(this,this.$9DZ);_d.$Mm.initializeBase(this,[_d.$Mm.$3No(n),n.$LK]);this.$6f=n;this.$6f.add_$7AP(this.$$d_$9DZ);this.$6f.add_$9AU(this.$$d_$9DZ);this.$6f.add_$63O(this.$$d_$63O);this.$9AT=n.get_$LP()};_d.$Mm.$3No=function(n){if(!n)throw Error.argumentNull("folder");if(!n.get_$1l())throw Error.argumentNull("displayName");var t=null;t=n.$LK===1?_u.Strings.l_MyContactsFolderDisplayName_Text:n.$LK===1e3?_u.Strings.l_PeopleDirectoryContainer_Text:n.get_$1l();return t};_d.$Mm.prototype={$9AT:0,$6f:null,$3ZN:function(n,t){return new _c.$VH(this.$6f,n,t)},$9DZ:function(n,t){this.set_$1l(_d.$Mm.$3No(this.$6f))},$63O:function(n,t){this.$LK=this.$6f.$LK}};_d.$1Cg=function(){};_d.$12p=function(){this.$$d_$8Y3=Function.createDelegate(this,this.$8Y3);_d.$12p.initializeBase(this)};_d.$12p.prototype={$2jU:null,$46c:null,$3cE:null,add_$7Sr:function(n){this.$2Z("HeaderClicked",n)},remove_$7Sr:function(n){this.$2b("HeaderClicked",n)},get_$rf:function(){if(!this.$2jU){var t=_a.$z.get_$By().culture().people.headerDisplayValues;var r=_a.$z.get_$By().culture().people.headerSeekToValues;this.$2jU=new _js.$X;for(var u=Math.floor((t.length-1)/4)*4,n=0;n<t.length;n++){var i=t[n];var f=r[n];var e=!((n+1)%4);var o=n>=u;var s=new _d.$sl(i,f,e,o);this.$2jU.$H(s);if(i==="*")break}}return this.$2jU},get_$7Ss:function(){this.$3cE||(this.$3cE=new _C(this.$$d_$8Y3,_a.$0.$9C));return this.$3cE},$8Y3:function(){$EQ(this,"HeaderClicked",this.$46c)}};_d.$sl=function(n,t,i,r){_d.$sl.initializeBase(this);_a.$3.$1C(n,"displayValue");_a.$3.$M(t,"seekToValue");this.$4tR=n;this.$5x4=t;this.$5B4=i;this.$5B7=r};_d.$sl.prototype={$4tR:null,$5x4:null,$5B4:!1,$5B7:!1};_d.$12q=function(n,t){_d.$12q.initializeBase(this,[n,t])};_d.$12q.prototype={$2R:!1,get_$5In:function(){return this.$G.get_$O()==="Mouse"?348:this.get_$3cH()?420:410},get_$zw:function(){return this.$G.get_$O()==="Mouse"?this.get_$3cH()?216:198:233},get_$59e:function(){return this.get_$4jz()},get_$1X:function(){return this.$2R},set_$1X:function(n){if(this.$2R!==n){this.$2R=n;$6(this,"IsShown")}return n},$3yK:function(n){_d.$sm.prototype.$3yK.call(this,n);this.set_$1X(!1)}};_d.$aP=function(n,t){this.$$d_$32J=Function.createDelegate(this,this.$32J);this.$$d_$8Xr=Function.createDelegate(this,this.$8Xr);_d.$aP.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$aP.initializeBase(this,[n,t])};function $6O8(n){var t=_y.$26.$Bv(n,null,null);t.$dc(new _C(n.$$d_$32J,_a.$0.$9C));return t}_d.$aP.prototype={$3bJ:null,$3t:null,$2o:null,$Dm:!1,get_$30c:function(){return null},get_$30e:function(){return null},get_$Jr:function(){return this.$G.get_$O()==="Mouse"?0:2},get_$3L:function(){return this.$2o},set_$3L:function(n){this.$2o=n;return n},get_$7E:function(){this.$3t||(this.$3t=$6O8(this));return this.$3t},get_$ZD:function(){return this.$Dm},set_$ZD:function(n){if(n!==this.$Dm){this.$Dm=n;$6(this,"IsTransitionedIn")}return n},get_$7Pr:function(){this.$3bJ||(this.$3bJ=new _C(this.$$d_$8Xr,_a.$0.$9C));return this.$3bJ},$co:function(){},$Fe:function(){this.$Dm=!0},$gC:function(){this.$Dm=!1},$Rx:function(){},$3yK:function(n){_d.$sm.prototype.$3yK.call(this,n);this.$32J()},$8Xr:function(){this.get_$4jz()&&this.$G.$9T(this)},$32J:function(){this.$2o.$BX()}};_d.$sm=function(n,t){this.$$d_$3yK=Function.createDelegate(this,this.$3yK);_d.$sm.initializeBase(this);_a.$3.$M(n,"owaShell");_a.$3.$M(t,"groupGenerator");this.$G=n;this.$2jT=new _d.$12p;this.$2jT.add_$7Sr(this.$$d_$3yK);this.$HC=t};_d.$sm.$6v5=function(n,t){var i=new _g.$Uo;i.Item=new _g.$1i(t);i.FieldURIOrConstant=new _g.$JC;var r=new _g.$J4;r.Value=n;i.FieldURIOrConstant.Item=r;return new _g.$Jc(i)};_d.$sm.prototype={$2jT:null,$HC:null,$G:null,add_$5x1:function(n){this.$2Z("SeekToConditionRequested",n)},remove_$5x1:function(n){this.$2b("SeekToConditionRequested",n)},get_$3cH:function(){return this.$2jT.get_$rf().get_$F()>28},get_$4jz:function(){return this.$HC.$2lN},$3yK:function(n){var t=_d.$sm.$6v5(n.$5x4,this.$HC.$AJ);$EQ(this,"SeekToConditionRequested",t)}};_d.$gb=function(n){this.$G=n};_d.$gb.prototype={$G:null,$1KQ:null,$I:function(n,t,i,r){return new _d.$aS(this.$G,this.$1KQ,n,t,i,r)}};_d.$gc=function(n,t){this.$G=n;this.$2q1=t};_d.$gc.prototype={$G:null,$2q1:null,$I:function(n){return new _d.$Uv(this.$G,this.$2q1,n)}};_d.$RJ=function(n){_d.$RJ.initializeBase(this,[n])};function $6OF(n,t,i,r){if(t&&t.get_$F()>0){var u=new _d.$2Y(n.$2I,t.$6tv(0),i,"",!0);if(!_js.$8.$14(u.$Fm)){n.$24u&&u.add_$w0(n.$$d_$8kk);var f=new _d.$4e(n.$2I,r);f.get_$3T().$H(u);n.get_$3T().$H(f)}}}function $4NW(n,t,i,r){if(t&&t.get_$F()>0){var u=new _d.$2Y(n.$2I,t.$6tv(0),i,"",!0);u.add_$w0(n.$$d_$9Gz);var f=new _d.$4e(n.$2I,r);f.get_$3T().$H(u);n.get_$3T().$H(f)}}_d.$RJ.prototype={$8y6:function(n){var t=this.$24u?_u.Strings.l_CallActionTitle_Text:"{0}";$6OF(this,n.get_$hH(),"PersonaBusinessPhoneNumbers",String.format(t,_u.Strings.l_Phone_Text));$4NW(this,n.get_$1DF(),"PersonaBusinessHomePages",_u.Strings.l_ViewWebPage_Text);$4NW(this,n.get_$1KR(),"PersonaPersonalHomePages",_u.Strings.l_ViewLocalWebPage_Text)}};_d.$3Z=function(n,t,i,r,u,f,e,o){this.$$d_$8fa=Function.createDelegate(this,this.$8fa);this.$$d_$8fb=Function.createDelegate(this,this.$8fb);this.$$d_$8cL=Function.createDelegate(this,this.$8cL);this.$$d_$8Vp=Function.createDelegate(this,this.$8Vp);this.$$d_$8TQ=Function.createDelegate(this,this.$8TQ);this.$$d_$94x=Function.createDelegate(this,this.$94x);this.$$d_$94w=Function.createDelegate(this,this.$94w);this.$1mE=-1;_d.$3Z.initializeBase(this,[[]]);_a.$3.$M(n,"sessionSettings");_a.$3.$M(t,"chatManager");_a.$3.$M(i,"personaViewModelFactory");_a.$3.$M(r,"actionSubmitter");_a.$3.$M(o,"signOutCommand");this.$Ay=t;this.$7VJ(n,i);this.$p=r;this.$G=u;this.$1K=f;this.$CR=e;var h=this;this.$57n=new _C(this.$$d_$94w,_a.$0.$4H,this,_d.$3Z.$2aO,function(){return h.get_$4kP()!=="AttemptingSignIn"});var c=this;this.$57o=new _C(this.$$d_$94x,_a.$0.$4H,this,_d.$3Z.$2aO,function(){return c.get_$4kP()!=="AttemptingSignOut"});this.$62v=o;this.$Ay.$a(_c.$2G.$1bq,this.$$d_$8TQ);var s=_g.$S.get_$L();this.$1yX=$8(s)||$8(s.get_$6D())?!1:s.get_$6D().get_$2eP()&&s.get_$6D().get_$2PE();this.$4uC=this.$1yX?new _C(this.$$d_$8Vp,_d.$3Z.$D):null;$6PQ(this)};_d.$3Z.$7KV=function(n){switch(n){case 2:return 1;case 3:return 7;case 5:return 13;case 4:return 19;case 6:return 25;case 1:return 31;case 0:default:return 37}};function $6PQ(n){if(n.$1yX){var t=new _0365m.$n(_u.Strings.l_OwaChangePhoto_Text,null,n.$4uC,!1,null,_u.Strings.l_OwaChangePhotoAriaLabel_Text,"MeCardView.EditPhoto");n.$1B.$H(t)}n.$Ay.get_$2l()&&$6PO(n);$6PN(n)}function $6PO(n){n.$1B.$H(new _0365m.$n(_u.Strings.l_IMSignIn_Text,null,n.$57n,!0));n.$1B.$H($21k(n,_u.Strings.l_IMAvailablePresenceState_Text,"Online"));n.$1B.$H($21k(n,_u.Strings.l_IMBusyPresenceState_Text,"Busy"));n.$1B.$H($21k(n,_u.Strings.l_IMDnDPresenceState_Text,"DoNotDisturb"));n.$1B.$H($21k(n,_u.Strings.l_IMBeRightBackPresenceState_Text,"BeRightBack"));n.$1B.$H($21k(n,_u.Strings.l_IMAppearAwayPresenceState_Text,"Away"));var t=new _0365m.$n(_u.Strings.l_IMSignOut_Text,null,n.$57o,!0);t.set_$15(!0);n.$1B.$H(t);n.$1B.$H(new _0365m.$9q);$4OV(n)}function $6PN(n){n.$1B.$H(new _0365m.$n(_u.Strings.l_OwaSignOut_Text,null,new _C(n.$62v,_d.$3Z.$D)))}function $21k(n,t,i){var r=new _0365m.$n(t,_y.$PC.$3aW(_h.$7a.$2AB(i)),new _C($6PP(n,i),_a.$0.$4H),!0);r.set_$15(!0);return r}function $6PP(n,t){var i=this;return function(){var r=_h.$7a.$ec(n.$1I5.get_$1v().get_$8e());n.$Ay.$3Bo("SetPresence",r,_h.$7a.$2AB(t));var i=new _c.$16f(r,t);i.add_$2A(n.$$d_$8fb);i.add_$20(n.$$d_$8fa);n.$p.$y(i)}}function $4OV(n){var t=!1;var i=!1;n.set_$bO("");switch(n.$Ay.$P5){case"AttemptingSignIn":$2U9(n,!0,_u.Strings.l_IMSigningIn_Text);break;case"SignedIn":$2U9(n,!1,null);i=!0;break;case"unknown":case"AttemptingSignOut":case"Disabled":case"SignedOut":$2U9(n,!1,null);t=!0;break;case"Error":n.set_$bO(_u.Strings.l_IMSigningInError_Text);$2U9(n,!1,null);t=!0;break;default:throw Error.invalidOperation("MeCardViewModel.UpdateChatMenuItemState: Unexpected SignInState: "+n.$Ay.$P5+")");}$6PR(n,t,i)}function $2U9(n,t,i){n.set_$6vB(i);n.set_$7v(t)}function $6PR(n,t,i){var u=n.get_$7WM();var r=n.$1B.get_$48(u++);r.set_$15(!t);for(var f=0;f<_d.$3Z.$5fI-1;f++){r=n.$1B.get_$48(u++);r.set_$15(!i)}}_d.$3Z.prototype={$Ay:null,$p:null,$62v:null,$57n:null,$57o:null,$4uC:null,$1yX:!1,$CR:null,$G:null,$1K:null,$v6:null,$1I5:null,$9u:!1,$3Na:null,$Bw:null,get_$1vy:function(){return _d.$3Z.$7KV(this.$1I5.get_$1v().$LA)},get_$4kP:function(){return this.$Ay.$P5},get_$2DJ:function(){return this.$Ay.get_$2l()},get_$3gn:function(){return this.$Ay.$P5==="SignedIn"&&!!this.$1I5.get_$1v().$LA},get_$7v:function(){return this.$9u},set_$7v:function(n){this.$9u=n;$Q(this,_d.$3Z.$59C);return n},get_$6vB:function(){return this.$3Na},set_$6vB:function(n){this.$3Na=n;$Q(this,_d.$3Z.$4iO);return n},get_$bO:function(){return this.$Bw},set_$bO:function(n){this.$Bw=n;$Q(this,_d.$3Z.$3WZ);return n},get_$7bh:function(){return(this.$1I5.$NO&1)==1},get_$7WM:function(){return this.$1yX?1:0},get_$pW:function(){this.$v6||(this.$v6=_d.$5I.$4oQ(this.$G,this.$p,this.$CR));return this.$v6},$kn:function(n){_a.$3.$M(n,"menuItem");if(this.$1mE===-1){this.$1mE=this.$1B.get_$F()-1;this.$1B.$6z(this.$1mE,new _0365m.$9q)}this.$1B.$6z(this.$1mE,n);this.$1mE+=1},$7VJ:function(n,t){var i=new _g.$1m;i.MailboxType="OneOff";i.EmailAddress=n.get_$Br();i.RoutingType="SMTP";i.Name=n.get_$Gz();i.SipUri=n.get_$1dA()||null;var r=_c.$i.$E5(i);r.$a("Presence",this.$$d_$8cL);this.$1I5=t.$SX(r,_y.$q.$Hr,!1,2);var u=[1];this.$1I5.$Xp(1,u,"");if(this.$Ay.get_$2l()){var f=this.$1I5.$12;f.$33y()}},$8fb:function(n){var t=n;_js.Trace.logInfo(_a.$0.$4H,"Set presence to {0} succeeded.",t.$2yR)},$8fa:function(n){var t=n;_js.Trace.logWarning(_a.$0.$4H,"Set presence to {0} failed: {1}",t.$2yR,n.$1b.message)},$94w:function(){this.$Ay.$49r(!0)},$94x:function(){this.$Ay.$62u(!0)},$8TQ:function(n,t){$4OV(this);$Q(this,_d.$3Z.$2aO);$Q(this,_d.$3Z.$3go)},$8cL:function(n,t){$Q(this,_d.$3Z.$5q0);$Q(this,_d.$3Z.$3go)},$8Vp:function(){this.$1K.$7x("UploadPhoto")&&this.get_$pW().get_$254()?this.$G.$9T(this.get_$pW()):window.open(_a.$Cl.$1SU(window.location.pathname,_d.$3Z.$4uD),_d.$3Z.$4uF,_d.$3Z.$4uE);this.set_$1X(!1)}};_d.$sz=function(n,t,i,r,u,f,e){this.$Bo=n;this.$Ay=t;this.$50=i;this.$p=r;this.$G=u;this.$1K=f;this.$27=e};_d.$sz.prototype={$Bo:null,$Ay:null,$50:null,$p:null,$27:null,$G:null,$1K:null,$3Rj:function(n){return new _d.$3Z(this.$Bo,this.$Ay,this.$50,this.$p,this.$G,this.$1K,this.$27.$CR,n)}};_d.$ms=function(){};_d.$ms.prototype={$2LJ:null,$I:function(n,t){return new _d.$4J(n,t,this.$2LJ)}};_d.$mr=function(){};_d.$mr.prototype={$50:null,$I:function(n,t){return new _d.$Rj(n,t,this.$50)}};_d.$P2=function(){};_d.$P2.get_$8jy=function(){return"IPM.Note.PeopleConnect.Notification.Connected"};_d.$P2.get_$8jz=function(){return"IPM.Note.PeopleConnect.Notification.Disconnected"};_d.$P2.$5lm=function(){var n=_a.$Cl.$1SU(window.location.pathname,"Connect/PeopleConnections.aspx");var t=_a.$5.$1V(_a.$0.$9C,"PeopleConnectLinkClicked",!0);window.open(n,"_blank","width=580,height=300,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no");_a.$5.$1G(t)};_d.$Rr=function(n,t,i,r){_d.$Rr.initializeBase(this);this.$2E=n;this.$15n=t;this.$5EH=i;this.$60q=r};_d.$Rr.prototype={$2E:null,$5EH:!1,$15n:null,$60q:!1,$4Q:!1,get_$8X:function(){return this.$15n},get_$15:function(){return this.$4Q},set_$15:function(n){this.$4Q=n;return n}};_d.$Ke=function(n){this.$xe={};this.$5CO=n};_d.$Ke.$6xV=function(n){switch(n){case"PersonaDisplayNameFirstLast":case"PersonaDisplayNameLastFirst":return!0;case"PersonaCompanyName":case"PersonaHomeCity":case"PersonaWorkCity":case"PersonaCreationTime":return!1;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};function $6Q5(n,t){var r=$3FX(n,t);var i=r+n.$AJ;if(i in n.$xe)return n.$xe[i];else{var f=n.$2lN&&n.$5CO;var u=new _d.$Rr(r,i,!n.$2lN,f);n.$xe[i]=u;return u}}function $3FX(n,t){if($8(t))throw Error.invalidOperation("The persona to have a header generated should not be null");var i="";switch(n.$AJ){case"PersonaDisplayNameFirstLast":i=t.get_$1j6();break;case"PersonaDisplayNameLastFirst":i=t.get_$1j8();break;case"PersonaCompanyName":i=_u.Strings.l_PeopleHeaderNoCompany_Text;_js.$8.$c(t.get_$hV())||(i=t.get_$hV().toLocaleUpperCase());break;case"PersonaHomeCity":i=_u.Strings.l_PeopleHeaderNoCity_Text;_js.$8.$c(t.get_$1T7())||(i=t.get_$1T7().toLocaleUpperCase());break;case"PersonaWorkCity":i=_u.Strings.l_PeopleHeaderNoCity_Text;_js.$8.$c(t.get_$1dS())||(i=t.get_$1dS().toLocaleUpperCase());break;case"PersonaCreationTime":i=_u.Strings.l_PeopleHeaderNoCreationTime_Text;if(!$8(t.get_$2c5())){var r=_y.$US.$9Id(_y.$Kw,t.get_$2c5(),n.$33M);i=r.$iC.toLocaleUpperCase()}break;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n.$AJ));}return i}_d.$Ke.prototype={$xe:null,$5CO:!1,$33M:null,$20A:null,$AJ:"FolderId",$2lN:!1,get_$4q9:function(){return this.$AJ},set_$4q9:function(n){this.$AJ=n;if(this.$AJ==="PersonaCreationTime"){var t,i;this.$33M=(i=_y.$Bo.$$(_a.$8f).$7Or(_a.$7.get_$2M(),t={val:this.$20A}),this.$20A=t.val,i)}this.$2lN=_d.$Ke.$6xV(this.$AJ);return n},get_$3iP:function(){return this.$AJ==="PersonaCreationTime"},$AU:function(){return this.get_$3iP()?this.$20A.$5CW():!0},$4z7:function(n,t){var i=n;var r=t;var u=$8(r)||$3FX(this,i)!==$3FX(this,r);var f=$6Q5(this,i);return new _0365m.$Zx(f,u)}};_d.$JY=function(n,t,i,r){this.$G=n;this.$1K=t;this.$3K=i;this.$jd=r};_d.$JY.prototype={$G:null,$1K:null,$3K:null,$jd:null,$I:function(n,t){return new _d.$7H(n,t,this.$jd,this.$1K,this.$G)},$ct:function(n){throw Error.notImplemented();},$wD:function(n){var i=n;var t=this.$I(new _d.$Gu,3);t.$7f7(i);this.$3dt();return t},$3dt:function(){_g.$1Q.$KM.$3dt(this.$3K)}};_d.$14b=function(n,t,i){this.$$d_$5oM=Function.createDelegate(this,this.$5oM);_d.$14b.initializeBase(this,[n]);this.$p=t;this.$Zw=i};_d.$14b.prototype={$p:null,$Zw:null,add_$2Lz:function(n){this.$2Z("PersonaPickedCompleted",n)},remove_$2Lz:function(n){this.$2b("PersonaPickedCompleted",n)},get_$4mn:function(){return _u.Strings.l_PeoplePickerSearchPersonaList_AT_Text},$SX:function(n){var t=new _d.$GD(n,_y.$q.$Hr,!1,this.$Zy,this.$p,this.$Zw,this);$4P0(this,t);t.add_$2Lz(this.$$d_$5oM);return t},$5oM:function(n){$EQ(this,"PersonaPickedCompleted",n)}};_d.$P4=function(n,t,i,r){this.$$d_$5gx=Function.createDelegate(this,this.$5gx);_d.$P4.initializeBase(this,[i,null,"CondensedGroupsNavigationView.GroupItemViewWithoutUnseenCount",r]);this.$G=n;this.$BZ=t;this.$4I=new _d.$82(n,0,n.get_$O()==="Mouse",n.get_$O()==="TouchNarrow",!0);this.set_$3m(this.$4I.$Pl);this.$4I.$48r=!1;this.$4I.$a("CurrentConfiguration",this.$$d_$5gx);var u=this;this.$4I.$a("IsSidePanelExpanded",function(){u.set_$3m(u.$4I.$Pl)})};_d.$P4.$75O=function(n,t,i,r){return n.get_$O()==="Mouse"&&r&&i&&i.$7x("ModernGroups")?new _d.$P4(n,t,_u.Strings.l_NewString_LowerCase_Text,r):null};_d.$P4.prototype={$G:null,$4I:null,$BZ:null,$5hO:function(){_y.$mf.prototype.$5hO.call(this);this.$G.get_$O()==="Mouse"&&this.$4I.$5F()},$5hP:function(){_y.$mf.prototype.$5hP.call(this);this.$G.get_$O()==="Mouse"&&this.$4I.$5F();this.$4I.set_$gW(null)},$8U8:function(n){if(n){this.$BZ.$ca(_a.$Ad.$xN(2));this.$G3&&this.$G3.$1Ly(null)}},$3yz:function(n,t){_y.$mf.prototype.$3yz.call(this,n,t);if(this.$G3.get_$jt()){this.$BZ.$ca(_a.$Ad.$2hE(this.$G3.get_$jt().get_$BE(),2));this.$4I.set_$gW(null)}},$2Kr:function(){_y.$mf.prototype.$2Kr.call(this);this.$4I.set_$md(this.$2W)},$5gx:function(n,t){this.$8U8(this.$4I.$Bn)}};_d.$14c=function(n,t,i,r){this.$$d_$5oM=Function.createDelegate(this,this.$5oM);_d.$14c.initializeBase(this,[n,t,i]);this.$Zw=r};_d.$14c.prototype={$Zw:null,add_$2Lz:function(n){this.$2Z("PersonaPickedCompleted",n)},remove_$2Lz:function(n){this.$2b("PersonaPickedCompleted",n)},get_$4mn:function(){return _u.Strings.l_PeoplePickerPersonaList_AT_Text},get_$8ka:function(){return 41},$SX:function(n){var t=this.$50.$75S(n,this.$2Lu,!1,this.$Zy,this.$Zw,this);$4P1(this,t);t.add_$2Lz(this.$$d_$5oM);return t},$5oM:function(n){$EQ(this,"PersonaPickedCompleted",n)}};_d.$GD=function(n,t,i,r,u,f,e){this.$$d_$5i2=Function.createDelegate(this,this.$5i2);this.$$d_$3xt=Function.createDelegate(this,this.$3xt);this.$$d_$8RB=Function.createDelegate(this,this.$8RB);this.$$d_$8fN=Function.createDelegate(this,this.$8fN);_d.$GD.initializeBase(this,[n,t,i,r]);this.$p=u;this.$Zw=f;this.$41I=e;if(this.$G.get_$O()!=="TouchNarrow"){this.set_$14y(!0);this.set_$We(new _C(this.$$d_$8fN,_d.$GD.$D))}};function $3FY(n){n.$8lb();var t=n.get_$1jT().$1B;if(t.get_$F()<2){n.get_$1jT().set_$1X(!1);t.$1u();n.$3xt(n.get_$1v().get_$1h())}else n.get_$1jT().set_$1X(!0)}_d.$GD.prototype={$p:null,$Zw:null,$41I:null,$3W4:null,$3KM:null,get_$3jH:function(){return this.$G.get_$O()==="TouchNarrow"},get_$6qW:function(){return String.format(_u.Strings.l_PeoplePickerAddContactButton_AT_Text,this.$Ex)},get_$6q6:function(){this.$3KM||(this.$3KM=new _C(this.$$d_$8RB,_a.$0.$cl));return this.$3KM},add_$2Lz:function(n){this.$2Z("PersonaPickedCompleted",n)},remove_$2Lz:function(n){this.$2b("PersonaPickedCompleted",n)},get_$1jT:function(){this.$3W4||(this.$3W4=new _0365m.$2c([]));return this.$3W4},$8lb:function(){if(this.get_$1v().get_$5l()){var i=this.get_$1v().get_$5l().length;var n=[];this.get_$1jT().$1B.$1u();for(var t=0;t<i;t++)if(this.get_$1v().get_$5l()[t]){var r=new(_a.$BS.$$(_g.$1m))(this.get_$1v().get_$5l()[t],this.$$d_$3xt);Array.add(n,new _0365m.$n(this.get_$1v().get_$5l()[t].Name,null,new _C(r.$$d_$9Hu,_d.$GD.$D)));Array.add(n,new _0365m.$9q)}n.length>0&&Array.removeAt(n,n.length-1);this.get_$1jT().$1B.$6G(n)}},$3xt:function(n){var t=new _c.$i;t.$P3(this.get_$1v().$OR());t.set_$1h($3JG(this,n));$EQ(this,"PersonaPickedCompleted",t)},$8RB:function(){if(this.$41I.get_$25()===this.get_$1v()&&this.$Zw.get_$D4().$5u&&this.$Zw.get_$D4().$5u.$12.get_$9m()===3){this.set_$1v(this.$Zw.get_$D4().$5u.$12);this.$41I.$1yE(this)}if(this.get_$1v().get_$18()!==1||this.get_$1v().get_$9m()===3||_js.$8.$c(this.get_$1v().get_$ls()))$3FY(this);else{var n=null;this.get_$1v().get_$5s()?n=_c.$II.$4pX(this.get_$1v().get_$5s(),this.get_$1v().get_$ls()):this.get_$1v().get_$1h()&&this.get_$1v().get_$1h().EmailAddress&&_a.$3I.$OZ(this.get_$1v().get_$1h().EmailAddress)&&(n=_c.$II.$4pW(this.get_$1v().get_$1h()));if(n){n.add_$2m(this.$$d_$5i2);n.$BP=0;this.$p.$y(n)}else $3FY(this)}},$5i2:function(n){var t=n;t.$1b||this.set_$1v(t.$12);$3FY(this)},$8fN:function(){this.$3xt(this.get_$1v().get_$1h())}};_d.$nJ=function(){this.$26V="";_d.$nJ.initializeBase(this)};_d.$nJ.prototype={$1Lm:0,get_$1b4:function(){return this.$1Lm},set_$1b4:function(n){if(this.$1Lm!==n){this.$1Lm=n;$6(this,"SelectedPeopleSearchRefiner")}return n},get_$4pj:function(){return this.$26V},set_$4pj:function(n){if(this.$26V!==n){this.$26V=n;$6(this,"CurrentFolderRefinerDisplayName")}return n},$8xm:function(n,t){!n||n.get_$2mc()||n.get_$1Gt()?this.set_$4pj(""):this.set_$4pj(String.format(_u.Strings.l_PeopleCurrentFolderContainer_Text,t.get_$1l()))}};_d.$P6=function(n,t){this.$$d_$8WP=Function.createDelegate(this,this.$8WP);this.$g6=-1;_d.$P6.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$P6.initializeBase(this);this.$G=n;this.$Rt=new _js.$X;this.$41C=t};function $4Or(n){for(var t=0;t<n.$Rt.get_$F()&&n.$1xZ;t++)if(n.$1xZ===n.$Rt.get_$48(t)){n.set_$1Gs(!1);n.$7S=n.$1xZ;n.set_$Hq(t);break}}function $6QB(n,t){n.$7S=t;n.$7S.set_$bl(!0)}_d.$P6.prototype={$xB:null,$2W:!1,$3gK:!1,$1HI:!1,$2EG:!1,$1JJ:0,$G:null,$41B:null,$Rt:null,$7S:null,$2k:null,$1xZ:null,$41C:null,get_$4sI:function(){return!!this.$7S&&this.$7S.get_$bl()},get_$2EF:function(){return this.$3gK},set_$2EF:function(n){if(this.$3gK!==n){this.$3gK=n;$Q(this,"IsSuggestionPopulationInProgress");this.set_$2nI(!n)}return n},get_$1Gs:function(){return this.$1HI},set_$1Gs:function(n){if(this.$1HI!==n){this.$1HI=n;$Q(this,"IsModuleLinkSelected")}return n},get_$2nI:function(){return this.$2EG},set_$2nI:function(n){if(this.$2EG!==n){this.$2EG=n;$Q(this,"IsPeopleModuleSuggestionVisible");if(this.$1HI&&!n){this.set_$1Gs(!1);this.set_$Hq(-1)}}return n},get_$Hq:function(){return this.$g6},set_$Hq:function(n){if(this.$g6!==n){this.$g6=n;$Q(this,"ItemHighlightedIndex");this.$g6>=0&&this.$g6<this.$Rt.get_$F()&&$6QB(this,this.$Rt.get_$48(this.$g6))}return n},get_$3T:function(){return this.$Rt},get_$3vC:function(){return-1},set_$3vC:function(n){return n},get_$D5:function(){return this.$2k},set_$D5:function(n){this.$2k=n;return n},get_$25:function(){return this.$1xZ},set_$25:function(n){if(this.$1xZ!==n){this.$1xZ=n;$Q(this,"SelectedItem");$4Or(this)}return n},get_$6Aw:function(){return this.$41B},set_$6Aw:function(n){if(this.$41B!==n){this.$41B=n;$4Or(this)}return n},$4l1:function(){this.$7S=null;this.$xB=null;this.$Rt.$1u();this.set_$Hq(-1);this.set_$2EF(!1);this.set_$2nI(!1);this.set_$1Gs(!1);this.$2W=!1},$xA:function(){if(!_js.$8.$c(this.$2k)&&this.$2W)if(this.$2k.trim().length>=4&&this.$Rt.get_$F()<5){this.$xB=_c.$14.$1E4(this.$2k,_g.$2Q.$9K("directory"),null,_c.$14.$qp(0,5),null,null,_c.$14.$hn,4);this.$xB.add_$2m(this.$$d_$8WP);OwaApplication.$1T.$y(this.$xB)}else this.set_$2EF(!1)},$5xk:function(n){this.$7S&&this.$7S.set_$bl(!1);var t=1;(n||this.$2EG)&&(t=0);this.$1HI&&this.set_$1Gs(!1);this.$g6<this.$Rt.get_$F()-t&&this.set_$Hq(this.$g6+1);this.$g6===this.$Rt.get_$F()&&this.$2EG&&this.set_$1Gs(!0);return this.$g6<this.$Rt.get_$F()||this.$1HI},$5xs:function(n){this.$7S&&this.$7S.set_$bl(!1);var t=n?1:0;this.$1HI&&this.set_$1Gs(!1);this.$g6>=t&&this.set_$Hq(this.$g6-1);return this.$g6>=0},$2QJ:function(){var n=this.$2k.trim().length;this.$Rt.$1u();this.set_$Hq(-1);if(this.$G.get_$O()==="Mouse"){this.$2W=!0;var i=[1];var r=_d.$5S.$3aP(this.$2k,5,0,null);var t=this;Array.forEach(r,function(n){var r=t.$41C.$SX(n,_y.$q.$Hr,!1,1);r.$Xp(1,i,"");r.$EW.set_$4p5(!0);r.set_$DA(!0);r.$EW.set_$31x(1);t.$Rt.$H(r)});this.$Rt.get_$F()<5&&n>=this.$1JJ&&n>=4?this.set_$2EF(!0):this.set_$2nI(!0)}},$8WP:function(n){n.remove_$2m(this.$$d_$8WP);if(this.$xB===n){if(this.$Rt.get_$F()<5&&$8(n.$1b)){for(var u=n.get_$11D(),o=[1],s=this.$Rt.get_$F(),i=0;i<u.get_$F()&&this.$Rt.get_$F()<5;i++){for(var f=u.get_$48(i),e=!0,r=0;r<s;r++)if(_c.$i.$2j0(f,this.$Rt.get_$48(r).get_$1v())){e=!1;break}if(e){var t=this.$41C.$SX(f,_y.$q.$Hr,!1,1);t.$Xp(1,o,"");t.$EW.set_$4p5(!0);t.set_$DA(!0);t.$EW.set_$31x(1);this.$Rt.$H(t)}}this.$1HI&&this.set_$Hq(this.$Rt.get_$F())}this.set_$2EF(!1)}}};_d.$4e=function(n,t){this.$$d_$8fg=Function.createDelegate(this,this.$8fg);_d.$4e.initializeBase(this);this.$1ZW=-1;this.$2I=n;this.set_$5N(t);this.$1Us=!1};_d.$4e.$9KO=function(n,t,i){var u="";if(i.get_$12m().length)if(t&&t.get_$F()){for(var e={},a=t.get_$F(),o=0;o<a;o++){var s=t.$6tv(o);if(s.get_$3f())for(var v=s.get_$3f().length,h=0;h<v;h++){var f=i.get_$1v().$xQ(s.get_$3f()[h]);!f||!f.get_$mh()||f.get_$1y()in e||(e[f.get_$1y()]=1)}else return""}for(var y=i.get_$12m().length,c=0;c<y;c++){var l=i.get_$12m()[c].get_$1y();if(!(l in e)){u=l;break}}}else u=i.get_$12m()[0].get_$1y();else{i.get_$1v().get_$3f()||i.get_$1v().set_$3f(new _js.$X);var r=new _c.$5n;r.set_$mh(!0);r.set_$1l("Outlook");r.set_$1y(i.get_$1v().get_$3f().get_$F().toString());r.set_$15(!1);u=r.get_$1y();i.set_$6q5(r.get_$1y());i.set_$12m([r]);i.get_$1v().get_$3f().$H(r)}return u};function $3Fa(n){n.get_$kb().$1B.$1u();n.get_$kb().$1B.$6G(n.get_$Mj())}function $6QF(n,t){var r=-1;var i=null;if(t in n.get_$15E()||t in n.get_$28y())if(t===_u.Strings.l_BusinessPhoneNumber_Text||t===_u.Strings.l_HomePhoneNumber_Text||t===_u.Strings.l_MobilePhoneNumber_Text){r=n.get_$15E()[t];--n.$1ZW;n.set_$Mj($3Fb(n,n.get_$Mj(),r,n.get_$15E()))}else{i=n.get_$Mj()[n.$1ZW];r=n.get_$28y()[t];i.$GP.$1B.$67(r);for(var f=0,o=i.$GP.$1B.get_$F(),u=0;u<o;u++){var e=i.$GP.$1B.get_$48(u);e.$2E in n.get_$28y()&&(n.get_$28y()[e.$2E]=f);f++}i.$GP.$1B.get_$F()||n.set_$Mj($3Fb(n,n.get_$Mj(),n.$1ZW,n.get_$15E()))}}function $3Fb(n,t,i,r){for(var o=[],f=0,s=t.length,u=0;u<s;u++)if(t[u]&&u!==i){var e=t[u];e.$2E in r&&(r[e.$2E]=f);o[f]=e;f++}return o}function $6QE(n,t){if(n.get_$5N()===_u.Strings.l_Phone_Text){$6QF(n,t);return}var i=-1;if(t in n.get_$15E()){i=n.get_$15E()[t];n.set_$Mj($3Fb(n,n.get_$Mj(),i,n.get_$15E()))}}_d.$4e.prototype={$2I:null,$1Us:!1,$1ZW:0,$3XZ:null,$3Xa:null,$2Wu:null,$2Wt:null,$48y:null,get_$7b5:function(){return this.get_$5N()!==_u.Strings.l_LinkItem_Text},get_$7av:function(){return this.$1Us&&this.get_$3T().get_$F()>0},get_$6qB:function(){return this.$2I.get_$1K8().get_$O()==="Mouse"?_d.$4.get_$4dg():_d.$4.get_$4df()},get_$6qA:function(){return this.$2I.get_$1K8().get_$O()==="Mouse"?_d.$4.get_$4dh():_d.$4.get_$4df()},get_$6q9:function(){return this.$2I.get_$1K8().get_$O()==="Mouse"?_d.$4.get_$6pu():_d.$4.get_$6pv()},get_$6qC:function(){return this.$2I.get_$1K8().get_$O()==="Mouse"?_d.$4.get_$4dh():_d.$4.get_$6pt()},get_$923:function(){if(!this.$48y){var n=this;this.$48y=new _C(this.$$d_$8fg,_d.$4e.$D,this,"CanDisplayAddFieldMenu",function(){return n.get_$6wV()})}return this.$48y},get_$6wV:function(){return this.get_$Mj().length>0},get_$kb:function(){this.$2Wu||(this.$2Wu=new _0365m.$2c(this.get_$Mj()));return this.$2Wu},set_$kb:function(n){this.$2Wu=n;$Nu(this,"AddFieldsMenuViewModel","CanDisplayAddFieldMenu","ShowAddFieldMenuCommand");return n},get_$Bs:function(){if(this.get_$1mv()){var n=this.get_$3T().get_$48(0);return n.get_$Bs()}return null},get_$1mv:function(){if(this.$2I.get_$5L())return!0;if(this.get_$3T().get_$F()!==1||this.$2I.get_$15w()&&this.$2I.get_$2bD().$2e4)return!1;var n=this.get_$3T().get_$48(0);return n.get_$1mv()},get_$6pn:function(){return _js.$8.$4C(_u.Strings.l_PersonaAddField_AT_Tooltip_Text,this.get_$5N())},get_$Mj:function(){this.$2Wt||(this.$2Wt=[]);return this.$2Wt},set_$Mj:function(n){this.$2Wt=n;$3Fa(this);return n},get_$15E:function(){this.$3XZ||(this.$3XZ={});return this.$3XZ},get_$28y:function(){this.$3Xa||(this.$3Xa={});return this.$3Xa},$4z6:function(){var n=this.get_$5N();this.$1Us&&(n+=_u.Strings.l_PersonaCardGroupHeaderGroupLabel_Text);n+=".";return n},$9KP:function(n,t,i){if(this.$2I.get_$5L()){_a.$3.$1Mm(t,"profileFields");var r=this;var e=new(_d.$4e.$2Lt.$$(n))(this.$2I,i,t,function(n,t,u){var e=r.$2I.get_$5L()===2||r.$2I.get_$5L()===3;r.$2I.get_$5L()===1&&r.$1Us&&(e=!0);var f=new _d.$2Y(r.$2I,t,n.get_$2Mg(),n.get_$5N(),e);r.$2I.get_$5L()===1&&n.get_$2Mg()==="PersonaAssistantNames"&&f.set_$16E(!1);r.$1Us&&n.get_$2Mg()!=="PersonaTitles"||f.set_$IF(!0);i===_u.Strings.l_Email_Text&&r.$2I.get_$5L()===2&&f.set_$IF(!1);r.get_$3T().$H(f);if(!u.get_$9If()){$6QE(r,u.get_$9Ie());$3Fa(r)}});if(e.get_$9If()){var u=this.get_$Mj().length;var o=new _0365m.$n(i,null,new _C(e.$$d_$9Ig,_d.$4e.$D));if(this.get_$5N()===_u.Strings.l_Phone_Text&&i!==_u.Strings.l_BusinessPhoneNumber_Text&&i!==_u.Strings.l_HomePhoneNumber_Text&&i!==_u.Strings.l_MobilePhoneNumber_Text){var f=null;if(this.$1ZW===-1){var s=[];f=new _0365m.$Fg(_u.Strings.l_OtherPhoneNumber_Text,null,new _0365m.$2c(s));this.get_$Mj()[u]=f;this.$1ZW=u;this.get_$15E()[_u.Strings.l_OtherPhoneNumber_Text]=u}else f=this.get_$Mj()[this.$1ZW];this.get_$28y()[i]=f.$GP.$1B.get_$F();f.$GP.$1B.$H(o)}else{this.get_$Mj()[u]=o;this.get_$15E()[i]=u}$3Fa(this)}}},$68w:function(){$4Z(this,"IsClickable","ClickCommand")},$6qD:function(){this.get_$Mj().length>0&&this.get_$Mj()[0].$Sz.$s()},$4pT:function(n){throw Error.notImplemented();},$8fg:function(){if(this.get_$Mj().length>0)if(this.get_$5N()===_u.Strings.l_Phone_Text)if(this.get_$Mj().length===1)if(this.get_$Mj()[0].$2E===_u.Strings.l_OtherPhoneNumber_Text){var n=this.get_$Mj()[0];if(n.$GP.$1B.get_$F()===1){this.get_$kb().set_$1X(!1);this.get_$kb().$1B.$1u();n.$GP.$1B.get_$48(0).$Sz.$s();$6(this,"CanDisplayAddFieldMenu")}else this.get_$kb().set_$1X(!0)}else{this.get_$kb().set_$1X(!1);this.get_$kb().$1B.$1u();this.get_$Mj()[0].$Sz.$s();$6(this,"CanDisplayAddFieldMenu")}else this.get_$kb().set_$1X(!0);else if(this.get_$Mj().length>1)this.get_$kb().set_$1X(!0);else{this.get_$kb().set_$1X(!1);this.get_$kb().$1B.$1u();this.get_$Mj()[0].$Sz.$s();$6(this,"CanDisplayAddFieldMenu")}}};_d.$4e.$2Lt=function(n,t,i,r){this.$$d_$9Ig=Function.createDelegate(this,this.$9Ig);this.$2I=n;this.$53T=t;this.$5qv=i;this.$4eE=r};_d.$4e.$2Lt.$$=function(n){var t="$2Lt"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d.$4e[t]){var r=_d.$4e[t]=function(){(this.$$gta=this.$$gta||{})["_d.$4e.$2Lt"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$4e.$2Lt.apply(this,i)};r.registerClass("_d.PersonaCardProfileFieldsGroupListViewModel."+t);var u=_d.$4e.$2Lt.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d.$4e[t]};_d.$4e.$2Lt.prototype={$2I:null,$5qv:null,$4eE:null,$53T:null,get_$6q:function(){return this.$2I},get_$9Ie:function(){return this.$53T},get_$2Md:function(){return this.$5qv},get_$6qZ:function(){return this.$4eE},get_$9If:function(){for(var t=this.get_$2Md().length,n=0;n<t;n++){var i=_d.$4e.$9KO(this.$$gta["_d.$4e.$2Lt"].T,this.get_$2Md()[n].get_$9Ih(),this.get_$6q());if(!_js.$8.$c(i))return!0}return!1},$9Ig:function(){var i=null;var r=!1;var t=0;var f=this.get_$2Md().length;for(t=0;t<f;t++){var n=this.get_$2Md()[t];r||n.get_$2Mg()!=="PersonaTitles"||(r=!0);var u=_d.$4e.$9KO(this.$$gta["_d.$4e.$2Lt"].T,n.get_$9Ih(),this.get_$6q());if(!_js.$8.$c(u)){this.get_$6q().set_$3gF(!1);if(!n.get_$9Ih()){var e=n.$9Ii(this.get_$6q().get_$1v());n.set_$9Ih(e)}i=n.$9Ik(n.$9Ij(),[u]);if(i)this.get_$6qZ()(this.get_$2Md()[t],i,this);else throw Error.invalidOperation("Trying to add field when no new field can be added");if(!r)break}}}};_d.$1H=function(n,t){this.$$d_$7UQ=Function.createDelegate(this,this.$7UQ);this.$$d_$7C7=Function.createDelegate(this,this.$7C7);this.$$d_$8WO=Function.createDelegate(this,this.$8WO);_d.$1H.initializeBase(this,[n]);this.$2gB=t;this.$qb()};_d.$1H.$1fY=function(n,t){if(!n)return t;var i=n.$1Ch();i&&(t=t.concat.apply(t,i));return t};_d.$1H.$9KS=function(n,t,i,r,u){if(!r.get_$1v().$9KR(n,t,u)){var f=_d.$4e.$9KO(n,t,r);t||(t=new(_c.$1D.$$(n)));t.$H(i,f);u.val=t.$6tv(0)}return t};_d.$1H.$9KT=function(n,t,i){if(!t)return null;for(var u=new(_c.$1D.$$(n)),e=t.get_$F(),f=0;f<e;++f){var r=t.$6tv(f);_d.$2Y.$yR(r.get_$1d())||(i?u.$4e2(r.get_$1d(),r.get_$3f()):u.$9Hj(r.get_$1d(),r.get_$3f()))}return u.get_$F()?u:null};_d.$1H.$60H=function(n){var t=n.get_$1v().get_$3f();var r=[];var u=0;if(t)for(var e=t.get_$F(),i=0;i<e;i++){var f=t.get_$48(i);if(f.get_$mh()){r[u]=f;u++}}n.set_$12m(r)};_d.$1H.$9KU=function(n,t){if(!t)return!1;var r=t.length;if(!r)return!1;for(var u=new(_c.$1D.$$(n)),i=0;i<r;i++)u.$9Hi(t[i].get_$9Ih());return _d.$1H.$9KV(n,u)};_d.$1H.$9KV=function(n,t){if(!t)return!1;for(var f={},e=t.get_$F(),i=0;i<e;i++)for(var o=t.$6tv(i).get_$3f(),s=o.length,r=0;r<s;r++)f[o[r]]=!0;for(var h=_0365f.$57.$F(f),u=0;u<e;u++){var c=t.$6tv(u);if(c.get_$3f().length!==h)return!0}return!1};function $6QT(n,t,i){if(!t.$9c||!t.$9c.get_$1d())return!1;if(_g.$2I.$Uf(t.$9c.get_$1d())){i?t.remove_$w0(n.$$d_$7C7):t.add_$w0(n.$$d_$7C7);return!0}if(_g.$Ja.$1o5(t.$9c.get_$1d())&&n.$24u){i?t.remove_$w0(n.$$d_$8kk):t.add_$w0(n.$$d_$8kk);return!0}if(t.$KL==="PersonaPersonalHomePages"||t.$KL==="PersonaBusinessHomePages"){var r=t.$9c.get_$3f()[0];var u=n.$2I.get_$1v().$xQ(r);(t.get_$5Bt()||r===_u.Strings.l_PeopleSharepointProfileName_Text||u.get_$1l()==="Facebook"||u.get_$1l()==="LinkedIn")&&(i?t.remove_$w0(n.$$d_$9Gz):t.add_$w0(n.$$d_$9Gz));return!0}t.$KL==="PersonaImAddresses"&&(i?t.remove_$w0(n.$$d_$7UQ):n.$2I.get_$1m4()||i||t.add_$w0(n.$$d_$7UQ));return!1}function $6QK(n){if(n.$2I.get_$5L()){var t=n.$2I.get_$1v();var i;var f,e;var l=(e=_d.$1H.$9KS(String,t.get_$1Fo(),"",n.$2I,f={val:i}),i=f.val,e);t.get_$1Fo()||t.set_$1Fo(l);n.$29B=new _d.$2Y(n.$2I,i,"PersonaGivenNames",_u.Strings.l_GivenName_Text,!0);var r;var o,s;var a=(s=_d.$1H.$9KS(String,t.get_$1JH(),"",n.$2I,o={val:r}),r=o.val,s);t.get_$1JH()||t.set_$1JH(a);n.$2JN=new _d.$2Y(n.$2I,r,"PersonaMiddleNames",_u.Strings.l_MiddleName_Text,!0);var u;var h,c;var v=(c=_d.$1H.$9KS(String,t.get_$1B0(),"",n.$2I,h={val:u}),u=h.val,c);t.get_$1B0()||t.set_$1B0(v);n.$2F4=new _d.$2Y(n.$2I,u,"PersonaSurnames",_u.Strings.l_Surname_Text,!0);$Nu(n,"FirstName","MiddleName","LastName")}}function $6QV(n){var t=null;if(n.$2I.get_$5L()){t=new _d.$4e(n.$2I,_u.Strings.l_YOMI_Text);n.$Lp[n.$Lp.length]=t}var i=n.$2I.get_$1v();n.$9KY(String,t,[new _d.$FX(_u.Strings.l_Company_Text,"PersonaYomiCompanyNames",i.get_$2St())],_u.Strings.l_Company_Text,!1);n.$9KY(String,t,[new _d.$FX(_u.Strings.l_Surname_Text,"PersonaYomiLastNames",i.get_$1db())],_u.Strings.l_Surname_Text,!1);n.$9KY(String,t,[new _d.$FX(_u.Strings.l_GivenName_Text,"PersonaYomiFirstNames",i.get_$1dZ())],_u.Strings.l_GivenName_Text,!1)}function $6QG(n){var t=null;var f=n.$2I.get_$5L();var r;if(f){t=new _d.$4e(n.$2I,_u.Strings.l_Email_Text);n.$Lp[n.$Lp.length]=t;r=""}else r=String.format(_u.Strings.l_SendActionTitle_Text,_u.Strings.l_Email_Text);var i=[];if(f){var u=n.$2I.get_$1v();i=[new _d.$hP(_u.Strings.l_Email_ProfileField_Text,"PersonaEmails1",u.get_$Qr(),n.$2I),new _d.$hP(_u.Strings.l_Email2_Text,"PersonaEmails2",u.get_$wz(),n.$2I),new _d.$hP(_u.Strings.l_Email3_Text,"PersonaEmails3",u.get_$x0(),n.$2I)]}else{var e=$6QY(n);i[i.length]=new _d.$hP(n.$2I.get_$15w()?_u.Strings.l_Email_Text:r,"PersonaEmailAddress",e,n.$2I)}n.$9KY(_g.$1m,t,i,_u.Strings.l_Email_Text,!0);n.$2I.get_$5L()===2&&t.$6qD()}function $6QY(n){var i=n.$2I.get_$1v();var t=new(_c.$1D.$$(_g.$1m));n.$9KZ(_g.$1m,i.get_$Qr(),t);n.$9KZ(_g.$1m,i.get_$wz(),t);n.$9KZ(_g.$1m,i.get_$x0(),t);return t}function $3Fc(n,t,i){var r=new(_c.$1D.$$(_g.$2u));n.$9KZ(_g.$2u,t,r);n.$9KZ(_g.$2u,i,r);return r}function $6QI(n){var t=null;var r=n.$2I.get_$5L();var u=n.$2I.get_$1v();if(r){t=new _d.$4e(n.$2I,_u.Strings.l_IMAddress_Text);n.$Lp[n.$Lp.length]=t}var i=_u.Strings.l_IMAddress_Text;r?i=_u.Strings.l_IMAddress_ProfileField_Text:n.$2I.get_$1m4()||(i=String.format(_u.Strings.l_SendActionTitle_Text,_u.Strings.l_IMAddress_Text));var f=[new _d.$FX(i,"PersonaImAddresses",u.get_$bd())];n.$9KY(String,t,f,_u.Strings.l_IMAddress_Text,!0)}function $6QO(n){var i=null;var t=n.$2I.get_$1v();var r=!n.$2I.get_$5L();if(!r){i=new _d.$4e(n.$2I,_u.Strings.l_Phone_Text);n.$Lp[n.$Lp.length]=i}var u=n.$24u?_u.Strings.l_CallActionTitle_Text:"{0}";var f=[];if(r){var e=$3Fc(n,t.get_$hH(),t.get_$vf());f[f.length]=new _d.$Dn(String.format(u,_u.Strings.l_BusinessPhoneNumber_Text),"PersonaBusinessPhoneNumbers",e)}else f=[new _d.$Dn(_u.Strings.l_BusinessPhoneNumber_ProfileField_Text,"PersonaBusinessPhoneNumbers",t.get_$hH()),new _d.$Dn(_u.Strings.l_BusinessPhoneNumber2_ProfileField_Text,"PersonaBusinessPhoneNumbers2",t.get_$vf())];n.$9KY(_g.$2u,i,f,_u.Strings.l_BusinessPhoneNumber_Text,!1);f=[];if(r){var o=$3Fc(n,t.get_$m5(),t.get_$xh());f[f.length]=new _d.$Dn(String.format(u,_u.Strings.l_HomePhoneNumber_Text),"PersonaHomePhones",o)}else f=[new _d.$Dn(_u.Strings.l_HomePhoneNumber_ProfileField_Text,"PersonaHomePhones",t.get_$m5()),new _d.$Dn(_u.Strings.l_HomePhoneNumber2_ProfileField_Text,"PersonaHomePhones2",t.get_$xh())];n.$9KY(_g.$2u,i,f,_u.Strings.l_HomePhoneNumber_Text,!1);f=[];if(r){var s=$3Fc(n,t.get_$np(),t.get_$zx());f[f.length]=new _d.$Dn(String.format(u,_u.Strings.l_MobilePhoneNumber_Text),"PersonaMobilePhones",s)}else f=[new _d.$Dn(_u.Strings.l_MobilePhoneNumber_ProfileField_Text,"PersonaMobilePhones",t.get_$np()),new _d.$Dn(_u.Strings.l_MobilePhoneNumber2_ProfileField_Text,"PersonaCarPhones",t.get_$zx())];n.$9KY(_g.$2u,i,f,_u.Strings.l_MobilePhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_OtherPhoneNumber_Text):_u.Strings.l_OtherPhoneNumber_ProfileField_Text,"PersonaOtherTelephones",t.get_$19D())],_u.Strings.l_OtherPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_BusinessFaxPhoneNumber_Text):_u.Strings.l_BusinessFaxPhoneNumber_ProfileField_Text,"PersonaWorkFaxes",t.get_$1Bm())],_u.Strings.l_BusinessFaxPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_HomeFaxPhoneNumber_Text):_u.Strings.l_HomeFaxPhoneNumber_ProfileField_Text,"PersonaHomeFaxes",t.get_$15x())],_u.Strings.l_HomeFaxPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_OtherFaxPhoneNumber_Text):_u.Strings.l_OtherFaxPhoneNumber_ProfileField_Text,"PersonaOtherFaxes",t.get_$19C())],_u.Strings.l_OtherFaxPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_OrganizationMainPhoneNumber_Text):_u.Strings.l_OrganizationMainPhoneNumber_ProfileField_Text,"PersonaOrganizationMainPhones",t.get_$19A())],_u.Strings.l_OrganizationMainPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_AssistantPhoneNumber_Text):_u.Strings.l_AssistantPhoneNumber_ProfileField_Text,"PersonaAssistantPhoneNumbers",t.get_$13T())],_u.Strings.l_AssistantPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_CallbackPhoneNumber_Text):_u.Strings.l_CallbackPhoneNumber_ProfileField_Text,"PersonaCallbackPhones",t.get_$13r())],_u.Strings.l_CallbackPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_PagerPhoneNumber_Text):_u.Strings.l_PagerPhoneNumber_ProfileField_Text,"PersonaPagers",t.get_$19F())],_u.Strings.l_PagerPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_RadioPhoneNumber_Text):_u.Strings.l_RadioPhoneNumber_ProfileField_Text,"PersonaRadioPhones",t.get_$19m())],_u.Strings.l_RadioPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_TelexPhoneNumber_Text):_u.Strings.l_TelexPhoneNumber_ProfileField_Text,"PersonaTelexNumbers",t.get_$1B9())],_u.Strings.l_TelexPhoneNumber_Text,!1);n.$9KY(_g.$2u,i,[new _d.$Dn(r?String.format(u,_u.Strings.l_TTYTDDPhoneNumber_Text):_u.Strings.l_TTYTDDPhoneNumber_ProfileField_Text,"PersonaTTYTDDPhoneNumbers",t.get_$1BN())],_u.Strings.l_TTYTDDPhoneNumber_Text,!1)}function $6QP(n){n.$2I.get_$5L()?$6QR(n):$6QQ(n)}function $6QQ(n){var t=n.$2I.get_$1v();n.$9KW(_g.$33,null,_u.Strings.l_BusinessAddress_Text,"PhysicalAddresses",t.get_$dm(),!1,_d.$1H.$9KV(_g.$33,t.get_$dm()));n.$9KW(_g.$33,null,_u.Strings.l_HomeAddress_Text,"PhysicalAddresses",t.get_$ej(),!1,_d.$1H.$9KV(_g.$33,t.get_$ej()));n.$9KW(_g.$33,null,_u.Strings.l_OtherAddress_Text,"PhysicalAddresses",t.get_$fz(),!1,_d.$1H.$9KV(_g.$33,t.get_$fz()))}function $6QR(n){var t=new _d.$4e(n.$2I,_u.Strings.l_Address_Text);n.$Lp[n.$Lp.length]=t;var i=n.$2I.get_$1v();n.$9KY(_g.$33,t,[new _d.$nO(_u.Strings.l_BusinessAddressSuffix_LowerCase_Text,"PersonaBusinessAddresses",i.get_$dm())],_u.Strings.l_BusinessAddressSuffix_LowerCase_Text,!1);n.$9KY(_g.$33,t,[new _d.$nO(_u.Strings.l_HomeAddressSuffix_LowerCase_Text,"PersonaHomeAddresses",i.get_$ej())],_u.Strings.l_HomeAddressSuffix_LowerCase_Text,!1);n.$9KY(_g.$33,t,[new _d.$nO(_u.Strings.l_OtherAddressSuffix_LowerCase_Text,"PersonaOtherAddresses",i.get_$fz())],_u.Strings.l_OtherAddressSuffix_LowerCase_Text,!1)}function $6QN(n){var t=null;var r=n.$2I.get_$1v();var i=!n.$2I.get_$5L();if(!i){t=new _d.$4e(n.$2I,_u.Strings.l_Other_Text);n.$Lp[n.$Lp.length]=t}n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_BusinessWebPage_Text:_u.Strings.l_BusinessWebPage_ProfileField_Text,"PersonaBusinessHomePages",n.$3wW)],_u.Strings.l_BusinessWebPage_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_Schools_Text:_u.Strings.l_Schools_ProfileField_Text,"PersonaSchools",r.get_$2OF())],_u.Strings.l_Schools_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_PersonalWebPage_Text:_u.Strings.l_PersonalWebPage_ProfileField_Text,"PersonaPersonalHomePages",r.get_$1KR())],_u.Strings.l_PersonalWebPage_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_Profession_Text:_u.Strings.l_Profession_ProfileField_Text,"PersonaProfessions",r.get_$1Zu())],_u.Strings.l_Profession_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_Spouse_Text:_u.Strings.l_Spouse_ProfileField_Text,"PersonaSpouseNames",r.get_$1bu())],_u.Strings.l_Spouse_Text,!1);i&&n.$9KY(Array,t,[new _d.$14t(_u.Strings.l_Children_Text,"PersonaChildren",r.get_$1Pl())],_u.Strings.l_Children_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_Hobbies_Text:_u.Strings.l_Hobbies_ProfileField_Text,"PersonaHobbies",r.get_$1T4())],_u.Strings.l_Hobbies_Text,!1);n.$9KY(_a.$7,t,[new _d.$tp(i?_u.Strings.l_Anniversary_Text:_u.Strings.l_Anniversary_ProfileField_Text,"PersonaWeddingAnniversariesLocal",r.get_$1dM())],_u.Strings.l_Anniversary_Text,!1);n.$9KY(_a.$7,t,[new _d.$tp(i?_u.Strings.l_Birthday_Text:_u.Strings.l_Birthday_ProfileField_Text,"PersonaBirthdaysLocal",r.get_$1P4())],_u.Strings.l_Birthday_Text,!1);n.$9KY(String,t,[new _d.$FX(i?_u.Strings.l_LocationInPersonCard_Text:_u.Strings.l_LocationInPersonCard_ProfileField_Text,"PersonaLocations",r.get_$1VP())],_u.Strings.l_LocationInPersonCard_Text,!1)}function $6QJ(n){var r=n.$2FF.get_$F();if(r>0&&!n.$2I.get_$5L()&&n.$2I.get_$1v().get_$18()===1){var u=new _d.$4e(n.$2I,_u.Strings.l_LinkItem_Text);n.$Lp[n.$Lp.length]=u;for(var t=0;t<r;t++){var f=n.$2FF.$6tv(t);var i=new(_c.$1D.$$(String));i.$H(f.get_$1d().toString(),f.get_$3f()[0]);n.$9KX(String,u,null,"PersonaBusinessHomePages",i,!0,_d.$1H.$9KV(String,i),!0)}}}function $6QS(n){if(!n.$2I.get_$5L()&&n.$2I.get_$1v().get_$18()===1&&!_js.$8.$c(n.$2I.get_$2WM())){var t=n.$2I.get_$1v().$7KT();if(!_js.$8.$c(t)){var u=_js.$8.$4C("{0}/?user={1}",n.$2I.get_$2WM(),encodeURIComponent(t));var i=new(_c.$1D.$$(String));i.$H(u,_u.Strings.l_PeopleSharepointProfileName_Text);var r=new _d.$4e(n.$2I,_u.Strings.l_ProfileSection_Text);n.$Lp[n.$Lp.length]=r;n.$9KX(String,r,null,"PersonaBusinessHomePages",i,!0,!1,!0)}}}function $6Qa(n,t){var e=n.$2I.get_$1v();n.$2FF=new(_c.$1D.$$(String));n.$3wW=new(_c.$1D.$$(String));var i=[];if(t)for(var v=t.get_$F(),o=0;o<v;o++)for(var u=t.$6tv(o),y=u.get_$3f().length,s=0;s<y;s++)for(var l=e.get_$3f(),p=l.get_$F(),h=0;h<p;++h){var r=l.get_$48(h);if(r.get_$1y()===u.get_$3f()[s])switch(r.get_$1l()){case"Facebook":case"LinkedIn":n.$2FF.$H(u.get_$1d().toString(),r.get_$1y());i[i.length]=r.get_$1l();break;default:n.$3wW.$H(u.get_$1d().toString(),r.get_$1y());break}}if(e.$7PF()>0)for(var a=e.$3b3(),w=a.length,c=0;c<w;c++){var f=a[c];if(!Array.contains(i,f.get_$1SN())){n.$2FF.$H(f.get_$1SN(),f.get_$1y());i[i.length]=f.get_$1SN()}}}function $4Ow(n){var t=null;var f=n.$2I.get_$1v();t=new _d.$4e(n.$2I,_u.Strings.l_PersonaCardNotesPivotOption_Text);n.$Lp[n.$Lp.length]=t;var i=f.get_$HP();if(i)for(var e=i.get_$F(),s=e===1,h=f.get_$3f(),r=0;r<e;r++){var u=i.$6tv(r);if(!_js.$8.$14(u.get_$1d().get_$dl().Value)){var o=new _d.$2Y(n.$2I,u,"PersonaBodies",n.$2I.get_$5L()?_u.Strings.l_PersonaCardNotes_ProfileField_Text:"",s);var c=this;h.$DK(function(n){if(n.get_$1y()===u.get_$3f()[0]){o.set_$1g3(n.get_$1SN());return!0}else return!1});t.get_$3T().$H(o)}}return t}function $6QM(n){var t=$4Ow(n);var o=n.$2I.get_$1v();var i=o.get_$HP();if(n.$2I.get_$5L()&&t)if(i&&t.get_$3T().get_$F()>0){for(var r=new(_c.$1D.$$(_g.$66)),s=i.get_$F(),h=o.get_$3f(),u=0;u<s;u++)for(var f=i.$6tv(u),c=f.get_$3f().length,e=0;e<c;e++){var v=this;h.$DK(function(n){if(n.get_$1y()===f.get_$3f()[e]&&n.get_$1l()==="Outlook"){var t=new _g.$66;t.set_$45("Text");t.set_$1d(f.get_$1d().get_$1d());r.$H(t,n.get_$1y());return!0}else return!1})}if(r.get_$F()>0){var l=[new _d.$tn(_u.Strings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",r)];t.$9KP(_g.$66,l,_u.Strings.l_PersonaCardNotesPivotOption_Text)}}else{var a=[new _d.$tn(_u.Strings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",null)];t.$9KP(_g.$66,a,_u.Strings.l_PersonaCardNotesPivotOption_Text)}}function $6QU(n){var t=!1;var r=n.$2I.get_$1v();var i=new _d.$4e(n.$2I,_u.Strings.l_Work_Text);i.$1Us=!0;var s=!1;var f=n.$2I.get_$5L();if(f!==2){if(!r.get_$3f()||!r.get_$3f().get_$F())return;for(var e=null,v=",",h,c,y=(c=$6QZ(n,h={val:e}),e=h.val,c),p=e.length,o=0;o<p;o++){var l=e[o];if(_js.$8.$c(l))s=!0;else{var w=y.get_$48(l);var u=w.split(v);t=$1e7(n,i,r.get_$kK(),u,"PersonaTitles",_u.Strings.l_JobTitle_Text,!0)||t;t=$1e7(n,i,r.get_$r1(),u,"PersonaDepartments",_u.Strings.l_Department_Text,!0)||t;t=$1e7(n,i,r.get_$qV(),u,"PersonaCompanyNames",_u.Strings.l_Company_Text,!0)||t;t=$1e7(n,i,r.get_$o5(),u,"PersonaOfficeLocations",_u.Strings.l_OfficeLocation_Text,!0)||t;t=$1e7(n,i,r.get_$yr(),u,"PersonaManagers",_u.Strings.l_Manager_Text,!0)||t;t=$1e7(n,i,r.get_$vW(),u,"PersonaAssistantNames",_u.Strings.l_Assistant_Text,!0)||t;var a=i.get_$3T().get_$F();a>0&&i.get_$3T().get_$48(a-1).set_$16E(!1)}}(f===1||f===3)&&s&&(t=$4Ov(n,i))}else t=$4Ov(n,i);(!f&&t||f)&&(n.$Lp[n.$Lp.length]=i)}function $6QZ(n,t){t.val=[];for(var f=_a.$5H.$$(String).$8M(),i=n.$2I.get_$1v(),s=i.get_$3f().get_$F(),o=0;o<s;++o){var r=i.get_$3f().get_$48(o);var u=new Sys.StringBuilder;if(!i.$xQ(r.get_$1y()).get_$15()){u.append($1e8(n,i.get_$kK(),r.get_$1y()));u.append($1e8(n,i.get_$r1(),r.get_$1y()));u.append($1e8(n,i.get_$qV(),r.get_$1y()));u.append($1e8(n,i.get_$o5(),r.get_$1y()));u.append($1e8(n,i.get_$yr(),r.get_$1y()));u.append($1e8(n,i.get_$vW(),r.get_$1y()));var e=u.toString().toLowerCase();if(f.$Lg(e))f.set_$48(e,f.get_$48(e)+","+r.get_$1y());else{f.set_$48(e,r.get_$1y());t.val[o]=e}}}return f}function $1e8(n,t,i){var u="";var r=t?$4Ox(n,t,i):null;r&&r.get_$1d()&&(u=r.get_$1d().toString());return u}function $1e7(n,t,i,r,u,f,e){var l=$6QH(n,t,i,r,u,f,e);var s=n.$2I.get_$5L();if(!l&&(s===1||s===3)){for(var h=!1,a=r.length,o=0;o<a;o++){var c=r[o];if(n.$2I.get_$1v().$xQ(c).get_$mh()||$6QW(n,i,c)){h=!0;break}}h&&$6QL(n,t,i,r,u,f,e);return!1}return!0}function $6QW(n,t,i){if(!t)return!1;for(var o=t.get_$F(),r=0;r<o;++r){var f=t.$6tv(r);if(f)for(var e=f.get_$3f(),s=e.length,u=0;u<s;u++){var h=e[u];if(h===i)return!0}}return!1}function $6QH(n,t,i,r,u,f,e){if(!i||!i.get_$F())return!1;var o=$4Ox(n,i,r[0]);if(!o)return!1;var s=new _g.$30(o.get_$1d().toString());s.Attributions=r;var h=new _d.$2Y(n.$2I,new _c.$pd(s),u,f,e);h.set_$4hB(r.join(","));t.get_$3T().$H(h);return!0}function $6QL(n,t,i,r,u,f,e){if(!i){var o=n.$2I.get_$1v();switch(u){case"PersonaTitles":i=o.set_$kK(new(_c.$1D.$$(String)));break;case"PersonaDepartments":i=o.set_$r1(new(_c.$1D.$$(String)));break;case"PersonaCompanyNames":i=o.set_$qV(new(_c.$1D.$$(String)));break;case"PersonaOfficeLocations":i=o.set_$o5(new(_c.$1D.$$(String)));break;case"PersonaManagers":i=o.set_$yr(new(_c.$1D.$$(String)));break;case"PersonaAssistantNames":i=o.set_$vW(new(_c.$1D.$$(String)));break}}i.$9Hj("",r);var h=i.$6tv(i.get_$F()-1);var s=new _d.$2Y(n.$2I,h,u,f,e);s.set_$4hB(r.join(","));s.set_$IF(!0);t.get_$3T().$H(s)}function $4Ov(n,t){var i=n.$2I.get_$1v();var r=n.$2I.get_$5L();var u=[new _d.$FX(_u.Strings.l_JobTitle_Text,"PersonaTitles",i.get_$kK()),new _d.$FX(_u.Strings.l_Department_Text,"PersonaDepartments",i.get_$r1()),new _d.$FX(_u.Strings.l_Company_Text,"PersonaCompanyNames",i.get_$qV()),new _d.$FX(_u.Strings.l_OfficeLocation_Text,"PersonaOfficeLocations",i.get_$o5()),new _d.$FX(_u.Strings.l_Manager_Text,"PersonaManagers",i.get_$yr()),new _d.$FX(_u.Strings.l_Assistant_Text,"PersonaAssistantNames",i.get_$vW())];r===2||r===3?n.$9KY(String,t,u,_u.Strings.l_Work_Text,!1):t.$9KP(String,u,_u.Strings.l_Work_Text);return!0}function $4Ox(n,t,i){for(var e=null,s=t.get_$F(),r=0;r<s;++r){var u=t.$6tv(r);if(u)for(var o=u.get_$3f(),h=o.length,f=0;f<h;f++)if(o[f]===i){e=u;break}}return e}function $6QX(n){var t=n.$2I.get_$1v();switch(n.$2gB){case 0:t.set_$1Fo(_d.$1H.$9KT(String,t.get_$1Fo(),!0));t.set_$1JH(_d.$1H.$9KT(String,t.get_$1JH(),!0));t.set_$1B0(_d.$1H.$9KT(String,t.get_$1B0(),!0));t.set_$Qr(_d.$1H.$9KT(_g.$1m,t.get_$Qr(),!1));t.set_$wz(_d.$1H.$9KT(_g.$1m,t.get_$wz(),!1));t.set_$x0(_d.$1H.$9KT(_g.$1m,t.get_$x0(),!1));t.set_$hH(_d.$1H.$9KT(_g.$2u,t.get_$hH(),!0));t.set_$vf(_d.$1H.$9KT(_g.$2u,t.get_$vf(),!0));t.set_$m5(_d.$1H.$9KT(_g.$2u,t.get_$m5(),!0));t.set_$xh(_d.$1H.$9KT(_g.$2u,t.get_$xh(),!0));t.set_$np(_d.$1H.$9KT(_g.$2u,t.get_$np(),!0));t.set_$zx(_d.$1H.$9KT(_g.$2u,t.get_$zx(),!0));t.set_$19D(_d.$1H.$9KT(_g.$2u,t.get_$19D(),!0));t.set_$15x(_d.$1H.$9KT(_g.$2u,t.get_$15x(),!0));t.set_$19C(_d.$1H.$9KT(_g.$2u,t.get_$19C(),!0));t.set_$19A(_d.$1H.$9KT(_g.$2u,t.get_$19A(),!0));t.set_$13T(_d.$1H.$9KT(_g.$2u,t.get_$13T(),!0));t.set_$13r(_d.$1H.$9KT(_g.$2u,t.get_$13r(),!0));t.set_$19F(_d.$1H.$9KT(_g.$2u,t.get_$19F(),!0));t.set_$19m(_d.$1H.$9KT(_g.$2u,t.get_$19m(),!0));t.set_$1B9(_d.$1H.$9KT(_g.$2u,t.get_$1B9(),!0));t.set_$1BN(_d.$1H.$9KT(_g.$2u,t.get_$1BN(),!0));t.set_$1Bm(_d.$1H.$9KT(_g.$2u,t.get_$1Bm(),!0));t.set_$bd(_d.$1H.$9KT(String,t.get_$bd(),!0));break;case 1:t.set_$2St(_d.$1H.$9KT(String,t.get_$2St(),!0));t.set_$1dZ(_d.$1H.$9KT(String,t.get_$1dZ(),!0));t.set_$1db(_d.$1H.$9KT(String,t.get_$1db(),!0));t.set_$kK(_d.$1H.$9KT(String,t.get_$kK(),!0));t.set_$r1(_d.$1H.$9KT(String,t.get_$r1(),!0));t.set_$qV(_d.$1H.$9KT(String,t.get_$qV(),!0));t.set_$o5(_d.$1H.$9KT(String,t.get_$o5(),!0));t.set_$yr(_d.$1H.$9KT(String,t.get_$yr(),!0));t.set_$vW(_d.$1H.$9KT(String,t.get_$vW(),!0));t.set_$1DF(_d.$1H.$9KT(String,t.get_$1DF(),!0));t.set_$1KR(_d.$1H.$9KT(String,t.get_$1KR(),!0));t.set_$1Zu(_d.$1H.$9KT(String,t.get_$1Zu(),!0));t.set_$1bu(_d.$1H.$9KT(String,t.get_$1bu(),!0));t.set_$1Pl(_d.$1H.$9KT(Array,t.get_$1Pl(),!0));t.set_$1T4(_d.$1H.$9KT(String,t.get_$1T4(),!0));t.set_$1dM(_d.$1H.$9KT(_a.$7,t.get_$1dM(),!0));t.set_$1P4(_d.$1H.$9KT(_a.$7,t.get_$1P4(),!0));t.set_$1VP(_d.$1H.$9KT(String,t.get_$1VP(),!0));t.set_$2OF(_d.$1H.$9KT(String,t.get_$2OF(),!0));t.set_$dm(_d.$1H.$9KT(_g.$33,t.get_$dm(),!0));t.set_$ej(_d.$1H.$9KT(_g.$33,t.get_$ej(),!0));t.set_$fz(_d.$1H.$9KT(_g.$33,t.get_$fz(),!0));break;case 2:t.set_$HP(_d.$1H.$9KT(_g.$66,t.get_$HP(),!0));break}}_d.$1H.prototype={$2gB:0,$Lp:null,$2FF:null,$3wW:null,$29B:null,$2JN:null,$2F4:null,get_$7Pp:function(){return this},$qb:function(){this.get_$3T().$1u();this.$Lp=[];this.$2I.get_$5L()&&_d.$1H.$60H(this.$2I);switch(this.$2gB){case 0:$6QK(this);$6QG(this);$6QO(this);$6QI(this);break;case 1:_g.$S.get_$L().get_$38().get_$73()==="ja-JP"&&$6QV(this);$6QS(this);$6Qa(this,this.$2I.get_$1v().get_$1DF());$6QU(this);$6QP(this);$6QN(this);$6QJ(this);break;case 2:this.$2I.get_$5L()?$6QM(this):$4Ow(this);break}this.get_$3T().$6G(this.$Lp)},$1Ch:function(){var n=[];if(!this.$2gB){n=_d.$1H.$1fY(this.$29B,n);n=_d.$1H.$1fY(this.$2JN,n);n=_d.$1H.$1fY(this.$2F4,n)}for(var u=this.get_$3T().get_$F(),t=0;t<u;t++)for(var r=this.get_$3T().get_$48(t),f=r.get_$3T().get_$F(),i=0;i<f;i++)n=_d.$1H.$1fY(r.get_$3T().get_$48(i),n);return n},$eC:function(){$6QX(this)},$4EJ:function(n){return n},$45K:function(n){return n},$7AV:function(n){var t=n;t&&t.$1M()},$7I6:function(n){for(var t=n,r=t.$4z6(),i=0;i<t.get_$3T().get_$F();i++){var u=t.get_$3T().get_$48(i);r+=u.$4z6()}return r},$9KW:function(n,t,i,r,u,f,e){return this.$9KX(n,t,i,r,u,f,e,!1)},$9KX:function(n,t,i,r,u,f,e,o){if(!u)return!1;var y=u.get_$F();if(!y)return!1;var w=!this.$2I.get_$5L()&&(f||!e);var c=!1;var l=!t;var h=null;var p="";if(!l){h=new Array(0);p=i}for(var a=0;a<y;++a){var v=u.$6tv(a);if(this.$2I.get_$1v().$7Xg(v)){var s=new _d.$2Y(this.$2I,v,r,p,w,o);if(_g.$33.isInstanceOfType(v.get_$1d())){if(_js.$8.$14(s.$1zK)&&_js.$8.$14(s.$1zL)&&_js.$8.$14(s.$1zM))continue}else if(_js.$8.$14(s.$Fm))continue;c=this.$2I.get_$15w()?!1:$6QT(this,s,!1);if(l){t=new _d.$4e(this.$2I,i);t.$1Us=s.get_$5EK();t.get_$3T().$H(s);this.$Lp[this.$Lp.length]=t;c&&t.$68w()}else Array.add(h,s)}}if(!l&&h.length>0){t.get_$3T().$6G(h);c&&t.$68w()}return!0},$9KY:function(n,t,i,r,u){for(var f=!1,s=_d.$1H.$9KU(n,i),h=i.length,e=0;e<h;e++){var o=i[e];f=this.$9KW(n,t,o.get_$5N(),o.get_$2Mg(),o.get_$9Ih(),u,s)||f}this.$2I.get_$5L()&&t&&t.$9KP(n,i,r);return f},$9KZ:function(n,t,i){if(t)for(var f=t.get_$F(),r=0;r<f;r++){var u=t.$6tv(r);i.$4e2(u.get_$1d(),u.get_$3f())}},$7C7:function(n){var t=n.$9c.get_$1d();this.$2I.$2b8(t)},$7UQ:function(n){var t=n.$9c.get_$1d();this.$2I.$3dX(t)},$8WO:function(){if(!this.$2I.get_$5L()){var n=this.get_$25();if(n){var t=n.get_$3T().get_$48(0);_g.$2I.$Uf(t.$9c.get_$1d())&&t.get_$Bs().$s()}}}};_d.$2Y=function(n,t,i,r,u,f){this.$$d_$8Vs=Function.createDelegate(this,this.$8Vs);this.$$d_$8Vr=Function.createDelegate(this,this.$8Vr);this.$$d_$8dE=Function.createDelegate(this,this.$8dE);this.$$d_$fs=Function.createDelegate(this,this.$fs);this.$25V=new(_js.$CJ.$$(_d.$2Y));_d.$2Y.initializeBase(this);this.$2I=n;this.$9c=t;this.$KL=i;this.$BG=r;this.$1g4="";this.$2CV=u;this.$37R=f;$4Oy(this);this.$2I.get_$5L()&&this.get_$BQ()||this.$2CV?this.set_$1g3(""):this.set_$1g3(_d.$2Y.$29g(this.$9c,this.$2I.get_$1v(),this.$1g4))};_d.$2Y.$29g=function(n,t,i){var r=null;var u="";var e=null;if(!n||!n.get_$3f()||!n.get_$3f().length)return u;e=new(_a.$3Y.$$(String));for(var s=i.split(","),o=0,h=n.get_$3f().length;o<h;++o){r=t.$xQ(n.get_$3f()[o]);if(r&&!r.get_$15()&&(_js.$8.$c(i)||_d.$2Y.$7Xh(r.get_$1y(),s))){var f=r.get_$1SN();_js.$8.$14(f)&&(f=_u.Strings.l_Unknown_Text);if(e.$6l(f))continue;_js.$8.$c(u)||(u+=_u.Strings.l_AttributionsSepartor_Text);u+=f;e.$H(f)}}return u};_d.$2Y.$yR=function(n){return n?String.isInstanceOfType(n)?_js.$8.$c(n):Array.isInstanceOfType(n)?!n.length:_g.$2I.$Uf(n)?_g.$2I.$1HA(n)||_js.$8.$c(n.RoutingType)?_js.$8.$c(n.OriginalDisplayName):_js.$8.$c(n.EmailAddress):_g.$Ja.$1o5(n)?_js.$8.$c(n.Number):_g.$33.isInstanceOfType(n)?_js.$8.$c(n.get_$WA())&&!n.$4Dr().$Fy.$Sv():_g.$66.isInstanceOfType(n)?_js.$8.$c(n.get_$1d()):!1:!0};_d.$2Y.get_$4Fl=function(){return _a.$z.get_$73()in _a.$1e.$2Er};_d.$2Y.$7Xh=function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];if(f===n)return!0}return!1};function $6Qe(n){return _g.$66.isInstanceOfType(n.$9c.get_$1d())?n.$9c.get_$1d().get_$Sx():!1}function $6Qf(n){var t=$21l(n);var i=$6Qd(n);if(_d.$2Y.$yR(t)&&_d.$2Y.$yR(i))return!1;else if(n.$2I.get_$5L()===3)return!0;else if(_d.$2Y.$yR(t)!==_d.$2Y.$yR(i))return!0;else{if(n.$Lm===_g.$33){var r=t.get_$WA();var u=i.get_$WA();return r!==u}if(n.$Lm===_g.$1m){var f=_g.$2I.$rS(t);var e=i.EmailAddress;var o=t.Name;var s=i.Name;return f!==e||o!==s}if(n.$Lm===_a.$7){var h=t;var c=i;return!h.$4W(c)}return t!==i}}function $6Qd(n){if(n.$Lm===_a.$7)return n.$1EQ;if(n.$Lm===_g.$33)return n.$1vv;if(n.$Lm===_g.$1m){var t=new _g.$1m;t.Name=n.$bM;t.RoutingType=n.$9c.get_$1d().RoutingType;_g.$2I.$1HA(n.$9c.get_$1d())||_js.$8.$c(t.RoutingType)?t.OriginalDisplayName=n.$Fm:t.EmailAddress=n.$Fm;return n.set_$7C6(t)}if(n.$KL==="PersonaBodies"){n.$HB&&n.$HB.$s();return n.$Fm}return n.$Fm}function $3Fd(n,t,i){if(!t&&(!n.$2I.get_$12m()||!n.$2I.get_$12m().length))return null;var r=[];var s={};var u=0;if(t)for(var f=0;f<t.get_$F();++f)if(n.$2I.get_$1v().$2bM(t.$6tv(f).get_$3f())){r[u]=new _g.$IZ(new _g.$1i(n.$KL));r[u].OldValue=t.$6tv(f).get_$1d();r[u].NewValue=i;for(var e=0;e<t.$6tv(f).get_$3f().length;e++)s[t.$6tv(f).get_$3f()[e]]="1";u++}if(!_js.$8.$c(i))for(var o=0;o<n.$2I.get_$12m().length;o++)if(!s[n.$2I.get_$12m()[o].get_$1y()]){r[u]=new _g.$IZ(new _g.$1i(n.$KL));r[u].OldValue="";r[u].NewValue=i;break}return r}function $6Qb(n){var i=_g.$2I.$rS(n.$wy);var r=n.$9c.get_$1d().EmailAddress;var f=n.$9c.get_$1d().OriginalDisplayName;var e=_g.$2I.$rS(n.$wy);var t=n.$wy.Name;var o=n.$9c.get_$1d().Name;t===r&&(t=i);var u=[];switch(n.$KL){case"PersonaEmails1":u=$3Fe(n,r,i,o,t,f,e,"PersonaEmails1","PersonaEmails1OriginalDisplayNames","PersonaEmails1DisplayNames");break;case"PersonaEmails2":u=$3Fe(n,r,i,o,t,f,e,"PersonaEmails2","PersonaEmails2OriginalDisplayNames","PersonaEmails2DisplayNames");break;case"PersonaEmails3":u=$3Fe(n,r,i,o,t,f,e,"PersonaEmails3","PersonaEmails3OriginalDisplayNames","PersonaEmails3DisplayNames");break}return u}function $3Fe(n,t,i,r,u,f,e,o,s,h){var l=[];var c=0;if(n.$2I.get_$5L()===3||t!==i){l[c]=new _g.$IZ(new _g.$1i(o));l[c].OldValue=t||null;l[c].NewValue=i||null;++c;l[c]=new _g.$IZ(new _g.$1i(s));l[c].OldValue=f||null;l[c].NewValue=e||null;++c}if(n.$2I.get_$5L()===3||r!==u){l[c]=new _g.$IZ(new _g.$1i(h));l[c].OldValue=r||null;l[c].NewValue=u||null}return l}function $4Oy(n){var t=$21l(n);if(String.isInstanceOfType(t)){n.$Fm=t;n.$Lm=String}else if(n.$KL==="PersonaBirthdaysLocal"||n.$KL==="PersonaWeddingAnniversariesLocal"){n.$Lm=_a.$7;if(!_d.$2Y.$yR(t)){n.$1EQ=t;n.$Fm=n.$1EQ.get_$4M()!==1604||n.get_$BQ()?t.$2P(1):t.$2P(8)}}else if(_g.$33.isInstanceOfType(t)){n.$1vv=$6Qc(n,t);var i=n.$1vv.get_$5Gw();n.$1zK=i.length>0?i[0]:null;n.$1zL=i.length>1?i[1]:null;n.$1zM=i.length>2?i[2]:null;n.$Lm=_g.$33}else if(_g.$2I.$Uf(t)){n.$wy=t;$6Qg(n);n.$Lm=_g.$1m;n.$7CA=t.OriginalDisplayName}else if(_g.$66.isInstanceOfType(t)){n.$Fm=t.get_$1d();n.$Lm=String}}function $21l(n){if(_g.$2I.$Uf(n.$9c.get_$1d()))return n.$9c.get_$1d();else if(_g.$Ja.$1o5(n.$9c.get_$1d()))return n.$9c.get_$1d().Number;else if(_g.$33.isInstanceOfType(n.$9c.get_$1d()))return n.$9c.get_$1d();else if(_g.$66.isInstanceOfType(n.$9c.get_$1d()))return n.$9c.get_$1d().get_$dl().Value;else if(n.$KL==="PersonaBirthdaysLocal"||n.$KL==="PersonaWeddingAnniversariesLocal"){_d.$2Y.$yR(n.$9c.get_$1d())||(n.$4qp=n.$9c.get_$1d());return n.$4qp}else return n.$KL==="PersonaBusinessHomePages"&&n.$37R?n.$9c.get_$3f()&&n.$9c.get_$3f().length>0?n.$9c.get_$3f()[0]===_u.Strings.l_PeopleSharepointProfileName_Text?_u.Strings.l_PeopleSharepointProfileName_Text:n.$2I.get_$1v().$xQ(n.$9c.get_$3f()[0]).get_$1SN():"":Array.isInstanceOfType(n.$9c.get_$1d())?n.$9c.get_$1d().join(", "):n.$9c.get_$1d()?n.$9c.get_$1d():""}function $6Qc(n,t){var i=_g.$33.$qo();i.set_$LN(t.get_$LN());i.set_$PP(t.get_$PP());i.set_$52(t.get_$52());i.set_$Ot(t.get_$Ot());i.set_$OD(t.get_$OD());return i}function $6Qg(n){n.$Fm=null;n.$bM=null;var t=_g.$2I.$rS(n.$wy);if(_js.$8.$14(t)){n.$bM="";n.$Fm="";return}switch(n.$2I.get_$5L()){case 2:case 3:case 1:n.$bM=_js.$8.$c(n.$wy.Name)?n.$29o(n.$wy.EmailAddress):n.$wy.Name;break}n.$Fm=t}_d.$2Y.prototype={$2I:null,$9c:null,$BG:null,$KL:"FolderId",$37R:!1,$1ct:null,$1g4:null,$1g2:null,$2CV:!1,$Lm:null,$bM:null,$7CA:null,$Fm:null,$1zK:null,$1zL:null,$1zM:null,$1EQ:null,$1vv:null,$wy:null,$Jv:null,$3yl:null,$HB:null,$3xs:null,$3xo:null,$jz:!1,$4qp:null,add_$w0:function(n){this.$25V.$pv(n)},remove_$w0:function(n){this.$25V.$uA(n)},get_$Kp:function(){return _a.UserAgent.getInstance().$8O},get_$Ug:function(){return _a.UserAgent.getInstance().$JT},get_$2fB:function(){return this.$bM},set_$2fB:function(n){this.$bM=n;this.$2I.set_$1ml(!0);return n},get_$7AK:function(){return _u.Strings.l_DisplayAs_Text},get_$BQ:function(){return!!this.$2I.get_$5L()&&this.$2I.get_$1v().$2bM(this.$9c.get_$3f())&&!$6Qe(this)},get_$1mv:function(){return this.$25V.get_$2B0()},get_$92j:function(){return this.$2I.get_$2mi()&&this.$2I.get_$1v().get_$5l()&&this.$2I.get_$1v().get_$5l().length>1&&_g.$2I.$Uf(this.$9c.get_$1d())&&_g.$2I.$4W(this.$9c.get_$1d(),this.$2I.get_$4rH())?!0:!1},get_$IF:function(){return this.$jz},set_$IF:function(n){if(this.$jz!==n){this.$jz=n;$6(this,"SetFocusOnActive")}return n},get_$7b1:function(){return this.$Lm!==_g.$1m},get_$7b6:function(){return this.$Lm!==String||this.$37R||this.$KL==="PersonaBodies"},get_$5Bt:function(){return!this.$37R},get_$5EK:function(){return this.$KL==="PersonaTitles"||this.$KL==="PersonaDepartments"||this.$KL==="PersonaCompanyNames"||this.$KL==="PersonaManagers"||this.$KL==="PersonaOfficeLocations"||this.$KL==="PersonaAssistantNames"},get_$7b4:function(){return this.$Lm!==String||this.$KL!=="PersonaBodies"},get_$7b0:function(){return this.$Lm!==_a.$7||!this.get_$BQ()},get_$7YP:function(){return!this.$2I.get_$5L()||this.$Lm!==_a.$7||this.get_$BQ()},get_$7XI:function(){return this.$Lm===_g.$33&&this.get_$16E()&&!_js.$8.$c(this.$1zK)&&_js.$8.$c(this.$1zL)&&_js.$8.$c(this.$1zM)},get_$7XK:function(){return this.$Lm===_g.$33&&this.get_$16E()&&!_js.$8.$c(this.$1zK)&&!_js.$8.$c(this.$1zL)&&_js.$8.$c(this.$1zM)},get_$7XJ:function(){return this.$Lm===_g.$33&&this.get_$16E()&&!_js.$8.$c(this.$1zK)&&!_js.$8.$c(this.$1zL)&&!_js.$8.$c(this.$1zM)},get_$3hl:function(){return this.$Lm!==_g.$33},get_$7XH:function(){return!this.get_$3hl()&&this.get_$16E()},get_$971:function(){return this.$Fm},set_$971:function(n){this.$Fm=n;this.$2I.set_$1ml(!0);return n},get_$77W:function(){return this.$1EQ},set_$77W:function(n){this.$1EQ=n;this.$2I.set_$1ml(!0);return n},get_$7C6:function(){return this.$wy},set_$7C6:function(n){this.$wy=n;this.$2I.set_$1ml(!0);return n},get_$1g3:function(){return this.$1g2},set_$1g3:function(n){if(this.$1g2!==n){this.$1g2=n;$6(this,"AttributionDisplayString")}return n},get_$4hB:function(){return this.$1g4},set_$4hB:function(n){if(this.$1g4!==n){this.$1g4=n;this.get_$16E()||this.set_$1g3(_d.$2Y.$29g(this.$9c,this.$2I.get_$1v(),n))}return n},get_$7SV:function(){return!!this.$2I.get_$1v().get_$HP()&&this.$2I.get_$1v().get_$HP().get_$F()>1},get_$16E:function(){return this.$2CV||_js.$8.$c(this.$1g2)},set_$16E:function(n){if(this.$2CV!==n){this.$2CV=n;n?this.set_$1g3(""):this.set_$1g3(_d.$2Y.$29g(this.$9c,this.$2I.get_$1v(),this.$1g4))}return n},get_$Bs:function(){this.get_$1mv()?this.$Jv||(this.$Jv=new _C(this.$$d_$fs,_d.$2Y.$D)):this.$Jv=null;return this.$Jv},get_$8dD:function(){this.$3yl||(this.$3yl=new _C(this.$$d_$8dE,_d.$2Y.$D));return this.$3yl},get_$8Vq:function(){this.$3xs||(this.$3xs=new _C(this.$$d_$8Vr,_d.$2Y.$D));return this.$3xs},get_$8VL:function(){this.$3xo||(this.$3xo=new _C(this.$$d_$8Vs,_d.$2Y.$D));return this.$3xo},$4z6:function(){var n="";if(this.get_$3hl())n+=_js.$8.$14(this.$BG)?" "+this.$Fm:_js.$8.$4C(_u.Strings.l_PersonaCardProfileFieldConcatenationLabel_Text," "+this.$BG,this.$Fm);else for(var i=this.$1vv.get_$5Gw(),u=i.length,t=0;t<u;++t){var r=i[t];_js.$8.$14(r)||(n+=" "+r)}this.get_$1mv()&&(n+=" "+_u.Strings.l_PersonaCardClickableGroup_Link_Text);n+=".";this.get_$16E()||(n=_js.$8.$4C(_u.Strings.l_PersonaCardProfileFieldAttributionConcatenationLabel_Text,n,this.$1g2+"."));return n},$1Ch:function(){if(!this.get_$BQ()||!$6Qf(this))return null;var n="";var t="";if(this.$Lm===_a.$7){_d.$2Y.$yR(this.$1EQ)||(n=this.$1EQ.$3u().$506());_d.$2Y.$yR(this.$9c.get_$1d())||(t=$21l(this).$3u().$506())}else if(this.$Lm===_g.$33){n=this.$1vv.get_$4mS();t=this.$9c.get_$1d().get_$4mS()}else if(this.$Lm===_g.$1m)return $6Qb(this);else if(this.$Lm===String&&this.$KL==="PersonaBodies"){n=this.$Fm;_js.$8.$c(this.$9c.get_$1d().get_$1d())||(t=$21l(this))}else{n=this.$Fm;_d.$2Y.$yR(this.$9c.get_$1d())||(t=$21l(this))}if(this.$KL==="PersonaGivenNames")return $3Fd(this,this.$2I.get_$1v().get_$1Fo(),n);else if(this.$KL==="PersonaMiddleNames")return $3Fd(this,this.$2I.get_$1v().get_$1JH(),n);else if(this.$KL==="PersonaSurnames")return $3Fd(this,this.$2I.get_$1v().get_$1B0(),n);else{var i=new _g.$IZ(new _g.$1i(this.$KL));i.OldValue=t;i.NewValue=n;return[i]}},$fs:function(){this.$25V.$19n(this)},$8dE:function(){this.$2I.set_$1ml(!0)},$8xP:function(n){this.$9c.set_$1d(n);$4Oy(this);$6(this,"StringDisplayValue")},$8Vr:function(){if(!this.$1ct){this.$1ct=new _g.$1m;this.$1ct.EmailAddress=this.$Fm;this.$1ct.Name=this.$bM}var n=!1;if(_js.$8.$c(this.$Fm)){this.set_$2fB("");n=!0}else{var i=this.$9c.get_$1d();if(_js.$8.$c(this.$bM)||this.$bM===this.$29o(_g.$2I.$rS(i))||this.$bM===this.$29o(this.$1ct.EmailAddress)){var t=this.$29o(this.$Fm);if(t!==this.$bM){this.set_$2fB(t);n=!0}}}if(n){this.$1ct.EmailAddress=this.$Fm;this.$1ct.Name=this.$bM;$6(this,"EmailDisplayAs")}},$8Vs:function(){if(_js.$8.$c(this.$bM)&&!_js.$8.$c(this.$Fm)){this.set_$2fB(this.$29o(this.$Fm));$6(this,"EmailDisplayAs")}},$29o:function(n){if(_js.$8.$14(n))return"";if(!this.get_$BQ())return n;var t=this.$2I.$eY(_d.$2Y.get_$4Fl());return _js.$8.$c(t)?_js.$8.$4C("({0})",n):_js.$8.$4C("{0} ({1})",t,n)}};_d.$5B=function(n,t){_d.$5B.initializeBase(this);if(!$8(n)){this.set_$1v(n.$12);this.set_$5L(t)}};_d.$5B.prototype={get_$1v:function(){return this.$W(_d.$5B.$19Q)},set_$1v:function(n){this.$N(_d.$5B.$19Q,n);return n},get_$O9:function(){return this.$W(_d.$5B.$3QX)},set_$O9:function(n){this.$N(_d.$5B.$3QX,n);return n},get_$7eP:function(){return this.$W(_d.$5B.$3kc)},set_$7eP:function(n){this.$N(_d.$5B.$3kc,n);return n},get_$5L:function(){return this.$W(_d.$5B.$zz)},set_$5L:function(n){this.$N(_d.$5B.$zz,n);return n},get_$bh:function(){return this.$W(_d.$5B.$3gJ)},set_$bh:function(n){this.$N(_d.$5B.$3gJ,n);return n},get_$AG:function(){return this.$W(_d.$5B.$41a)},set_$AG:function(n){this.$N(_d.$5B.$41a,n);return n},get_$iM:function(){return this.$W(_d.$5B.$3fd)},set_$iM:function(n){this.$N(_d.$5B.$3fd,n);return n},get_$22:function(){return this.$W(_d.$5B.$40M)},set_$22:function(n){this.$N(_d.$5B.$40M,n);return n},get_$3Rw:function(){return this.$W(_d.$5B.$3Rx)},set_$3Rw:function(n){this.$N(_d.$5B.$3Rx,n);return n},get_$1tl:function(){return!$8(this.get_$1v())&&!$8(this.get_$1v().get_$5s())?[this.get_$1v()]:null}};_d.$to=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$G=n;this.$1K=t;this.$p=i;this.$3K=r;this.$2q3=u;this.$2MA=f;this.$fF=e;this.$hW=o;this.$2LK=s;this.$2l0=h;this.$1Sq=c;this.$1lI=l;this.$53N=a;this.$6M=v;this.$1tm=y;this.$CZ=p;this.$9X=w;this.$6n=b};_d.$to.prototype={$6n:null,$G:null,$1K:null,$p:null,$3K:null,$2MA:null,$fF:null,$hW:null,$2LK:null,$2l0:null,$1Sq:null,$9X:null,$CZ:null,$1lI:null,$53N:null,$tw:null,$2q3:null,$14q:!1,$6M:null,$1tm:null};_d.$Es=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_d.$Es.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};function $6Qp(n,t,i,r,u,f){var e=this;n.$1tm.$I(function(e){var o=e.$73C(t,i,r,n.$G,n.$p,n.$1lI,n.$14q,n.$6n,n.$tw,u);o.$3v();f(o)})}function $6Qq(n,t,i,r,u){var f=new _d.$Fx(t,i,r,n.$G,n.$p,n.$14q,n.$6n,n.$tw,u);f.$3v();return f}function $6Qo(n,t,i,r,u){var f=new _d.$J2(t,i,r,n.$G,n.$p,n.$1lI,n.$53N,n.$14q,n.$6n,n.$tw,u);f.$3v();return f}function $6Qs(n,t,i,r,u){var f=new _d.$Aa(t,r,i,n.$G,n.$p,n.$3K,n.$fF,n.$14q,n.$6n,n.$tw,u);f.$3v();return f}function $6Qr(n,t,i,r,u){var f=new _d.$4r(t,r,i,n.$G,n.$p,n.$3K,n.$1Sq,n.$14q,n.$6n,n.$tw,u);f.$3v();return f}function $6Qu(n,t,i,r,u){var f=new _d.$2F(t,r,i,n.$G,n.$1K,n.$p,n.$3K,n.$2q3,n.$fF,n.$2LK,n.$2l0,n.$14q,n.$CZ,n.$6n,n.$tw,n.$1tm,u);f.$3v();return f}function $6Qt(n,t,i,r,u,f){var e=this;n.$1tm.$I(function(e){var o=e.$750(t,r,i,n.$G,n.$p,n.$3K,n.$1Sq,n.$14q,n.$6n,n.$tw,u);o.$3v();f(o)})}_d.$Es.prototype={$739:function(n,t,i,r,u,f,e){var o=null;switch(n.get_$18()){case 5:$6Qp(this,n,t,u,f,e);break;case 2:o=$6Qo(this,n,t,u,f);break;default:o=$6Qq(this,n,t,u,f);break}o&&e(o)},$2c2:function(n,t,i,r,u,f){var e=null;switch(n.get_$18()){case 2:e=$6Qr(this,n,t,r,u);break;case 4:e=$6Qs(this,n,t,r,u);break;case 5:$6Qt(this,n,t,r,u,f);break;default:e=$6Qu(this,n,t,r,u);break}e&&f(e)}};_d.$tp=function(n,t,i){_d.$tp.initializeBase(this,[n,t,i])};_d.$tp.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaWeddingAnniversariesLocal":n.set_$1dM(new(_c.$1D.$$(_a.$7)));return n.get_$1dM();case"PersonaBirthdaysLocal":n.set_$1P4(new(_c.$1D.$$(_a.$7)));return n.get_$1P4();default:throw this.$9Il();}},$9Ij:function(){return null}};_d.$hP=function(n,t,i,r){_d.$hP.initializeBase(this,[n,t,i]);this.$2I=r};_d.$hP.prototype={$2I:null,$1Rw:null,get_$9Ih:function(){if($8(this.$1Rw)&&!$8(_d.$nP.prototype.get_$9Ih.call(this))){this.$1Rw=new(_c.$1D.$$(_g.$1m));for(var n=0;n<_d.$nP.prototype.get_$9Ih.call(this).get_$F();++n)this.$2I.get_$1v().$2bM(_d.$nP.prototype.get_$9Ih.call(this).$6tv(n).get_$3f())?this.$1Rw.$4e2(_d.$nP.prototype.get_$9Ih.call(this).get_$48(n),_d.$nP.prototype.get_$9Ih.call(this).$6tv(n).get_$3f()):this.$1Rw.$9Hj(_d.$nP.prototype.get_$9Ih.call(this).get_$48(n),_d.$nP.prototype.get_$9Ih.call(this).$6tv(n).get_$3f())}return this.$1Rw},set_$9Ih:function(n){this.$1Rw=null;_d.$nP.prototype.set_$9Ih.call(this,n);return n},$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaEmails1":n.set_$Qr(new(_c.$1D.$$(_g.$1m)));return n.get_$Qr();case"PersonaEmails2":n.set_$wz(new(_c.$1D.$$(_g.$1m)));return n.get_$wz();case"PersonaEmails3":n.set_$x0(new(_c.$1D.$$(_g.$1m)));return n.get_$x0();default:throw this.$9Il();}},$9Ik:function(n,t){_d.$nP.prototype.get_$9Ih.call(this).$9Hj(n,t);this.$1Rw=null;return _d.$nP.prototype.get_$9Ih.call(this).$6tv(_d.$nP.prototype.get_$9Ih.call(this).get_$F()-1)},$9Ij:function(){var n=new _g.$1m;n.EmailAddress="";n.RoutingType="SMTP";return n}};_d.$NS=function(n){this.$$d_$8fC=Function.createDelegate(this,this.$8fC);_d.$NS.initializeBase(this);this.set_$wK("");this.set_$bO(_u.Strings.l_MailSearchError_Text);this.set_$1uB(_u.Strings.l_MailSearchNoResults_Text);this.set_$2FQ(_u.Strings.l_MailSearchInProgress_Text);this.add_$9KC(this.$$d_$8fC);this.$Zy=n==="Mouse"?1:2};function $4P0(n,t){n.$1yE(t);$6Qv(n,t)}function $6Qv(n,t){var i=t.get_$1v();var r="";_js.$8.$c(i.get_$hV())||_js.$8.$c(i.get_$5N())?_js.$8.$c(i.get_$hV())?_js.$8.$c(i.get_$5N())?i.get_$1h()&&!_js.$8.$c(i.get_$1h().EmailAddress)&&i.get_$1h().RoutingType==="SMTP"?r=i.get_$1h().EmailAddress:i.get_$1h()&&!_js.$8.$c(i.get_$1h().OriginalDisplayName)&&i.get_$1h().RoutingType==="EX"&&(r=i.get_$1h().OriginalDisplayName):r=i.get_$5N():r=i.get_$hV():r=String.format(_u.Strings.l_PeopleModulePersonaInformation_Text,i.get_$hV(),i.get_$5N());t.$Xp(1,null,r)}_d.$NS.prototype={$Zy:0,$1hx:null,$26T:null,$bN:null,$41F:null,$Gd:!1,get_$28W:function(){return this.$bN},set_$28W:function(n){this.$bN=n;$6(this,"EnterKeyCommand");return n},get_$8kb:function(){return this.$41F},set_$8kb:function(n){this.$41F=n;$6(this,"PersonaItemsRenderedCommand");return n},get_$4mn:function(){return _u.Strings.l_PeopleSearchPersonaList_AT_Text},get_$24C:function(){return _y.$EE.prototype.get_$24C.call(this)},set_$24C:function(n){if(this.get_$24C()!==n){n===1?this.set_$1FH(!1):this.set_$1FH(!0);_y.$EE.prototype.set_$24C.call(this,n)}return n},get_$1hy:function(){_a.$3.$17(this.$1hx,"PersonaListVM.CurrentDisplayOption");return this.$1hx},set_$1hy:function(n){_a.$3.$17(n,"PersonaListVM.CurrentDisplayOption");this.$1hx=n;return n},get_$1FH:function(){return this.$Gd},set_$1FH:function(n){this.$Gd=n;$6(this,"FocusItemOnSelect");return n},get_$5o8:function(){return this},$4EJ:function(n){return _c.$i.isInstanceOfType(n)?this.$SX(n):n},$45K:function(n){return _d.$7u.isInstanceOfType(n)?n.get_$1v():n},$7AV:function(n){var t=n;t&&t.$1M()},$7I6:function(n){var t=n;var i=t.$Ex;var r=t.$uM;_js.$8.$c(r)||(i+=" "+r);return i},$1yE:function(n){n.$Xp(0,_d.$JZ.$51S(this.get_$1hy().$2eO),_u.Strings.l_NameIsUnavailable_Text);this.$26T&&(n.$2M4=this.$26T.get_$4Cy())},$SX:function(n){var t=new _d.$7u(n,_y.$q.$Hr,!1,this.$Zy);$4P0(this,t);return t},$4pT:function(n){return n},$8fC:function(n,t){this.set_$1FH(!0)}};_d.$bi=function(n,t,i){_a.$3.$17(n,"owaShell");_a.$3.$17(t,"offlineBootstrapper");_a.$3.$17(i,"personaViewModelFactory");this.$G=n;this.$AF=t;this.$50=i};_d.$bi.prototype={$G:null,$AF:null,$50:null,$75T:function(){return new _d.$DN(this.$G,this.$AF,this.$50)},$75R:function(n){return new _d.$14c(this.$G,this.$AF,this.$50,n)}};_d.$DN=function(n,t,i){this.$$d_$8vv=Function.createDelegate(this,this.$8vv);_d.$DN.initializeBase(this,[n,n.get_$O()==="TouchNarrow"?0:1]);_a.$3.$M(t,"offlineBootstrapper");_a.$3.$M(i,"personaViewModelFactory");this.$AF=t;this.$50=i;this.$2Lu=_y.$q.$1gC;this.$5CP=(this.$2Lu&1)==1&&_y.$q.$2DJ(n.get_$O(),this.$2Lu)};_d.$DN.$7YD=function(n){var i=n;if(i.get_$2Nl()==="ErrorConnectionFailed")return!0;if(!n.$1b)return!1;var t=n.$1b.ErrorCode;return $8(t)?!1:!_g.$7N.$11r(t)};function $4P1(n,t){n.$1yE(t);$6Qw(n,t,n.$5o5);t.$64i()}function $6Qw(n,t,i){if(i){t.set_$l9(!0);for(var u=i.length,f=new Array(u),r=0;r<u;r++){var e=new(_a.$BS.$$(_d.$7u))(t,i[r].get_$pp());f[r]=new _0365m.$n(i[r].get_$1N(),null,new _C(e.$$d_$9Hu,_d.$DN.$D))}t.set_$1hZ(f)}}_d.$DN.prototype={$5CP:!1,$AF:null,$50:null,$Zy:0,$2Lu:0,$5o6:!1,$5o5:null,$HC:null,$1hx:null,$2md:!0,$3k0:null,$3k1:null,$1a5:null,get_$4mn:function(){return _u.Strings.l_PeoplePersonaList_AT_Text},get_$8ka:function(){return this.$G.get_$O()==="Mouse"?41:3},get_$2pP:function(){this.$3k0||(this.$3k0=this.get_$7dl().$I());return this.$3k0},get_$7dj:function(){return this.get_$2pP()},get_$7dk:function(){return this.get_$2pP()},get_$1hy:function(){_a.$3.$17(this.$1hx,"PersonaPagedListVM.CurrentDisplayOption");return this.$1hx},set_$1hy:function(n){_a.$3.$17(n,"PersonaPagedListVM.CurrentDisplayOption");this.$1hx=n;return n},get_$4q9:function(){return this.get_$R4().$AJ},set_$4q9:function(n){this.get_$R4().set_$4q9(n);return n},get_$R4:function(){this.$HC||(this.$HC=new _d.$Ke(this.$5CP));return this.$HC},get_$3gZ:function(){return this.$2md},set_$3gZ:function(n){if(this.$2md!==n){this.$2md=n;$6(this,"IsGroupHeadersEnabled")}return n},get_$3T:function(){return this.$1w.$1p},get_$419:function(){return this.$Zy},set_$419:function(n){if(this.$Zy!==n){this.$Zy=n;$6(this,"PersonaControlSize")}return n},get_$7dl:function(){this.$3k1||(this.$3k1=new _d.$DN.$7dm(this.$G,this.get_$R4()));return this.$3k1},$8vv:function(n,t){$6(this,"SelectedItemModelPropertiesChanged")},$SX:function(n){var t=this.$50.$SX(n,this.$2Lu,this.$5o6,this.$Zy);$4P1(this,t);return t},$710:function(n){this.$5o6=n;n?this.set_$419(this.$G.get_$O()==="TouchWide"?3:2):this.set_$419(this.$G.get_$O()==="Mouse"?1:2)},$1yE:function(n){n.$Xp(0,_d.$JZ.$51S(this.get_$1hy().$2eO),_u.Strings.l_NameIsUnavailable_Text);if(this.$1w&&_c.$IY.isInstanceOfType(this.$1w)){var t=this.$1w.get_$tv();t&&t.$2B&&_c.$P3.isInstanceOfType(t.$2B)&&(n.$2M4=t.$2B.get_$4Cy())}},$8SW:function(){this.$13&&this.$13.$w("PropertiesChanged",this.$$d_$8vv)},$8RQ:function(){this.$13&&this.$13.$a("PropertiesChanged",this.$$d_$8vv)},$8Zk:function(){if(this.$G.get_$O()==="TouchNarrow"){_a.$5.$1G(null,"NavigateToPeople");_a.$5.endPT("NavigateToPeopleHub_TouchNarrow");_a.$5.$1G(null,"PeoplePicker");_a.$5.endPT("PeoplePicker")}},$1SX:function(){if(this.$AF.get_$X1()&&_d.$DN.$7YD(this.$1w.$sW)){var n=this.$1w.get_$tv();if(n.$dz)return _u.Strings.l_OfflinePivotsError_Text;if(n.get_$2D1())return _u.Strings.l_OfflineUnsupportedFolder_Text}return _d.$4C.prototype.$1SX.call(this)}};_d.$DN.$7dm=function(n,t){_a.$3.$M(n,"owaShell");_a.$3.$M(t,"peopleGroupGenerator");this.$G=n;this.$40k=t};_d.$DN.$7dm.prototype={$G:null,$40k:null,$I:function(){return this.$G.get_$O()==="TouchNarrow"?new _d.$aP(this.$G,this.$40k):new _d.$12q(this.$G,this.$40k)}};_d.$Rz=function(n,t){_d.$Rz.initializeBase(this,[_d.$Rz.$3Zs(n),t]);_a.$3.$M(n,"owaShell");this.$G=n};_d.$Rz.$3Zs=function(n){switch(n.get_$O()){case"Mouse":return 50;case"TouchWide":return 40;case"TouchNarrow":return 25;default:throw Error.argumentOutOfRange("this.owaShell.CurrentLayout",n.get_$O());}};_d.$Rz.prototype={$G:null,get_$5o8:function(){return this},$4EJ:function(n){return _c.$i.isInstanceOfType(n)?this.$SX(n):n},$45K:function(n){return _d.$7u.isInstanceOfType(n)?n.get_$1v():n},$7AV:function(n){var t=n;t&&t.$1M()},$7I6:function(n){var t=n;var i=t.$Ex;var r=t.$uM;_js.$8.$c(r)||(i+=" "+r);return i},$SX:function(n){var t=new _d.$7u(n,_y.$q.$Hr,!1);var i=[1];t.$Xp(1,i,"");return t}};_d.$tn=function(n,t,i){_d.$tn.initializeBase(this,[n,t,i])};_d.$tn.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaBodies":n.set_$HP(new(_c.$1D.$$(_g.$66)));return n.get_$HP();default:throw this.$9Il();}},$9Ij:function(){var n=new _g.$66;n.set_$1d("");n.set_$45("Text");return n}};_d.$Dn=function(n,t,i){_d.$Dn.initializeBase(this,[n,t,i])};_d.$Dn.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaBusinessPhoneNumbers":n.set_$hH(new(_c.$1D.$$(_g.$2u)));return n.get_$hH();case"PersonaBusinessPhoneNumbers2":n.set_$vf(new(_c.$1D.$$(_g.$2u)));return n.get_$vf();case"PersonaHomePhones":n.set_$m5(new(_c.$1D.$$(_g.$2u)));return n.get_$m5();case"PersonaHomePhones2":n.set_$xh(new(_c.$1D.$$(_g.$2u)));return n.get_$xh();case"PersonaMobilePhones":n.set_$np(new(_c.$1D.$$(_g.$2u)));return n.get_$np();case"PersonaCarPhones":n.set_$zx(new(_c.$1D.$$(_g.$2u)));return n.get_$zx();case"PersonaOtherTelephones":n.set_$19D(new(_c.$1D.$$(_g.$2u)));return n.get_$19D();case"PersonaWorkFaxes":n.set_$1Bm(new(_c.$1D.$$(_g.$2u)));return n.get_$1Bm();case"PersonaHomeFaxes":n.set_$15x(new(_c.$1D.$$(_g.$2u)));return n.get_$15x();case"PersonaOtherFaxes":n.set_$19C(new(_c.$1D.$$(_g.$2u)));return n.get_$19C();case"PersonaOrganizationMainPhones":n.set_$19A(new(_c.$1D.$$(_g.$2u)));return n.get_$19A();case"PersonaAssistantPhoneNumbers":n.set_$13T(new(_c.$1D.$$(_g.$2u)));return n.get_$13T();case"PersonaCallbackPhones":n.set_$13r(new(_c.$1D.$$(_g.$2u)));return n.get_$13r();case"PersonaPagers":n.set_$19F(new(_c.$1D.$$(_g.$2u)));return n.get_$19F();case"PersonaRadioPhones":n.set_$19m(new(_c.$1D.$$(_g.$2u)));return n.get_$19m();case"PersonaTelexNumbers":n.set_$1B9(new(_c.$1D.$$(_g.$2u)));return n.get_$1B9();case"PersonaTTYTDDPhoneNumbers":n.set_$1BN(new(_c.$1D.$$(_g.$2u)));return n.get_$1BN();default:throw this.$9Il();}},$9Ij:function(){return new _g.$2u("","Mobile")}};_d.$nO=function(n,t,i){_d.$nO.initializeBase(this,[n,t,i])};_d.$nO.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaBusinessAddresses":n.set_$dm(new(_c.$1D.$$(_g.$33)));return n.get_$dm();case"PersonaHomeAddresses":n.set_$ej(new(_c.$1D.$$(_g.$33)));return n.get_$ej();case"PersonaOtherAddresses":n.set_$fz(new(_c.$1D.$$(_g.$33)));return n.get_$fz();default:throw this.$9Il();}},$9Ij:function(){var n=new _g.$33;n.set_$LN("");return n}};_d.$nP=function(n,t,i){this.$BG=n;this.$I7=t;this.$1g1=i};_d.$nP.$$=function(n){var t="$nP"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$nP"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$nP.apply(this,i)};r.registerClass("_d."+t);var u=_d.$nP.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$nP.prototype={$BG:null,$I7:"FolderId",$1g1:null,get_$5N:function(){return this.$BG},get_$2Mg:function(){return this.$I7},get_$9Ih:function(){return this.$1g1},set_$9Ih:function(n){this.$1g1=n;return n},$9Ik:function(n,t){this.$1g1.$9Hj(n,t);return this.$1g1.$6tv(this.$1g1.get_$F()-1)},$9Il:function(){return Error.invalidOperation(String.format("Property '{0}' is not supported for {1} fields: ",this.$I7,this.$$gta["_d.$nP"].T.getName()))}};_d.$14t=function(n,t,i){_d.$14t.initializeBase(this,[n,t,i])};_d.$14t.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaChildren":n.set_$1Pl(new(_c.$1D.$$(Array)));return n.get_$1Pl();default:throw this.$9Il();}},$9Ij:function(){return new Array(0)}};_d.$FX=function(n,t,i){_d.$FX.initializeBase(this,[n,t,i])};_d.$FX.prototype={$9Ii:function(n){switch(this.get_$2Mg()){case"PersonaYomiCompanyNames":n.set_$2St(new(_c.$1D.$$(String)));return n.get_$2St();case"PersonaYomiLastNames":n.set_$1db(new(_c.$1D.$$(String)));return n.get_$1db();case"PersonaYomiFirstNames":n.set_$1dZ(new(_c.$1D.$$(String)));return n.get_$1dZ();case"PersonaImAddresses":n.set_$bd(new(_c.$1D.$$(String)));return n.get_$bd();case"PersonaBusinessHomePages":n.set_$1DF(new(_c.$1D.$$(String)));return n.get_$1DF();case"PersonaSchools":n.set_$2OF(new(_c.$1D.$$(String)));return n.get_$2OF();case"PersonaPersonalHomePages":n.set_$1KR(new(_c.$1D.$$(String)));return n.get_$1KR();case"PersonaProfessions":n.set_$1Zu(new(_c.$1D.$$(String)));return n.get_$1Zu();case"PersonaSpouseNames":n.set_$1bu(new(_c.$1D.$$(String)));return n.get_$1bu();case"PersonaHobbies":n.set_$1T4(new(_c.$1D.$$(String)));return n.get_$1T4();case"PersonaOfficeLocations":n.set_$o5(new(_c.$1D.$$(String)));return n.get_$o5();case"PersonaTitles":n.set_$kK(new(_c.$1D.$$(String)));return n.get_$kK();case"PersonaDepartments":n.set_$r1(new(_c.$1D.$$(String)));return n.get_$r1();case"PersonaCompanyNames":n.set_$qV(new(_c.$1D.$$(String)));return n.get_$qV();case"PersonaManagers":n.set_$yr(new(_c.$1D.$$(String)));return n.get_$yr();case"PersonaAssistantNames":n.set_$vW(new(_c.$1D.$$(String)));return n.get_$vW();case"PersonaLocations":n.set_$1VP(new(_c.$1D.$$(String)));return n.get_$1VP();default:throw this.$9Il();}},$9Ij:function(){return""}};_d.$7u=function(n,t,i,r,u,f,e,o,s){_d.$7u.initializeBase(this,[n,t,i,r,null,u,f,e,o,s]);u||this.set_$3QB(new _d.$F7(f,this,null))};function $4P2(n,t,i,r,u){var f=null;if(!$8(i)&&!$8(r)){for(var e=0,l=r.get_$F();e<l;e++){f=r.$6tv(e);if(f.get_$1d().toString()===u)break;f=null}for(var h=i.get_$3f(),a=h.length,o=0;o<a;++o)for(var v=h[o],c=f.get_$3f(),y=c.length,s=0;s<y;++s){var p=c[s];if(p===v)return _js.$8.$4C(_u.Strings.l_PersonCard_Title_Text,t.get_$5N(),u)}}return t.get_$5N()}_d.$7u.prototype={$2M4:null,get_$1v:function(){return this.$12},set_$1v:function(n){this.set_$3N5(n);this.$PR&&this.$PR.$1d5(n);return n},get_$4mQ:function(){return this.$EW},get_$2Fx:function(){return this.get_$1v().get_$2g().$4Dr()},get_$2qv:function(){return this.get_$1v().get_$1l()},get_$1pp:function(){return this.get_$1v().get_$2g()},$2by:function(n,t){return new _d.$qG(this.get_$1v(),n,t)},$51t:function(){var n=this.get_$1v();if(n.get_$9m()===2)return" ";var f=n.get_$5N();var i=n.get_$27O();var r=n.get_$hV();if(_js.$8.$c(f))return _js.$8.$c(i)?_js.$8.$c(r)?" ":r:i;else{var t=null;if(!$8(n.get_$kK()))for(var u=0,e=n.get_$kK().get_$F();u<e;u++){t=n.get_$kK().$6tv(u);if(t.get_$1d().toString()===n.get_$5N())break;t=null}return _js.$8.$c(i)?_js.$8.$c(r)?f:$4P2(this,n,t,n.get_$qV(),r):$4P2(this,n,t,n.get_$r1(),i)}},$4zy:function(){var t=null;if(this.$2M4&&this.get_$1v().get_$4Cz()&&this.get_$1v().get_$3f())for(var i=0,f=this.get_$1v().get_$4Cz().get_$F();i<f;i++){var n=this.get_$1v().get_$4Cz().$6tv(i);if(n.get_$1d()&&n.get_$3f()){for(var r=0,e=n.get_$3f().length;r<e;r++){var u=this.get_$1v().$xQ(n.get_$3f()[r]);if(u&&u.get_$1l()===this.$2M4){t=n.get_$1d();break}}if(!_js.$8.$c(t))break}}if(_js.$8.$c(t)){if(!this.$2M4)return _y.$q.prototype.$4zy.call(this)}else return t;return null}};_d.$7l=function(n,t,i,r,u,f,e){this.$EI=-1;_d.$7l.initializeBase(this,[n,t,i,u,f,e,!1,null,r]);$8(n.get_$1h())||this.set_$46a(n.get_$1h());$8(n.get_$2g())||this.set_$5xX(n.get_$2g())};function $3Fg(n,t,i,r){if(i)for(var u=0;u<i.get_$F();++u)r.$4W(i.get_$48(u))||t.$H(i.get_$48(u))}function $4P4(n,t){if($3Fh(n,t)){n.set_$HU(n.$EI+1);return!0}n.set_$HU(-1);return!1}function $3Fh(n,t){return n.$EI<t.get_$F()-1&&n.$ma?!0:!1}function $4P3(n,t){if(n.$EI===-1&&n.$ma){n.set_$HU(t.get_$F()-1);return!0}n.set_$HU(-1);return!1}function $6Qx(n){if(n.$EI>0&&n.$ma){n.set_$HU(n.$EI-1);return!0}n.set_$HU(-1);return!1}_d.$7l.prototype={$I6:null,$cm:null,$11S:null,$46k:null,$ma:!1,add_$5CB:function(n){this.$a("IsPersonaDetailsShown",n)},remove_$5CB:function(n){this.$w("IsPersonaDetailsShown",n)},get_$5oC:function(){return this.$I6},set_$5oC:function(n){if(this.$I6!==n){this.$I6=n;$6(this,"PersonaEmailAddresses")}return n},get_$8kc:function(){return this.$cm},set_$8kc:function(n){if(this.$cm!==n){this.$cm=n;$6(this,"PersonaPostalAddresses")}return n},get_$7SL:function(){return this.get_$3bq()&&!this.get_$1lY()},get_$3bq:function(){return!!this.$I6},get_$HU:function(){return this.$EI},set_$HU:function(n){if(this.$EI!==n){this.$EI=n;$6(this,"ResultItemHighlightedIndex")}return n},get_$46a:function(){return this.$11S},set_$46a:function(n){if(this.$11S!==n){this.$11S=n;$6(this,"SelectedEmailItem")}return n},get_$5xX:function(){return this.$46k},set_$5xX:function(n){if(this.$46k!==n){this.$46k=n;$6(this,"SelectedPostalAddressItem")}return n},get_$2nl:function(){return this.$ma},set_$2nl:function(n){if(this.$ma!==n){this.$ma=n;$6(this,"IsPersonaDetailsShown")}return n},$67t:function(){return $8(this.$I6)?$8(this.$cm)?!1:$4P4(this,this.$cm):$4P4(this,this.$I6)},$Wp:function(){return $8(this.$11S)?_y.$q.prototype.$Wp.call(this):$3JG(this,this.$11S)},$6wZ:function(){return $8(this.$I6)?$8(this.$cm)?!1:$3Fh(this,this.$cm):$3Fh(this,this.$I6)},$9Bj:function(){return $8(this.$I6)?$8(this.$cm)?!1:$4P3(this,this.$cm):$4P3(this,this.$I6)},$9Bk:function(){return!$8(this.$I6)||!$8(this.$cm)?$6Qx(this):!1},$8yV:function(){$8(this.$I6)?$8(this.$cm)||this.$EI>-1&&this.$EI<this.$cm.get_$F()&&this.set_$5xX(this.$cm.get_$48(this.$EI)):this.$EI>-1&&this.$EI<this.$I6.get_$F()&&this.set_$46a(this.$I6.get_$48(this.$EI))},$420:function(){if(!$8(this.$cm))throw Error.invalidOperation("Email Addresses should not be populated when PostallAddresses are already populated!");if(this.get_$1v().get_$5l()&&this.$FO(8)){for(var t=new _js.$X,n=0;n<this.get_$1v().get_$5l().length;++n)this.get_$1v().get_$1h()&&this.get_$1v().get_$5l()[n]&&this.get_$1v().get_$1h().EmailAddress!==this.get_$1v().get_$5l()[n].EmailAddress&&t.$H(this.get_$1v().get_$5l()[n]);if(t.get_$F()>0){this.set_$5oC(new _js.$X);this.set_$5oC(t)}}},$3bp:function(){return!$8(this.$I6)||!$8(this.$cm)?!0:!1},$8lg:function(){if(!$8(this.$I6))throw Error.invalidOperation("Postal Addresses should not be populated when EmailAddresses are already populated!");if(this.$FO(8)){var n=new _js.$X;$3Fg(this,n,this.get_$1v().get_$ej(),this.get_$1v().get_$2g());$3Fg(this,n,this.get_$1v().get_$dm(),this.get_$1v().get_$2g());$3Fg(this,n,this.get_$1v().get_$fz(),this.get_$1v().get_$2g());n.get_$F()>0&&this.set_$8kc(n)}}};_d.$15B=function(n,t,i){this.$$d_$5k8=Function.createDelegate(this,this.$5k8);_d.$15B.initializeBase(this,[n,null,i,!0]);_a.$3.$1C(t,"sipUri");this.$12=_h.$3q.$3RV(n,t);this.$12.$a("Presence",this.$$d_$5k8);this.set_$Bh(_y.$PC.$3aW(this.$12.$LA))};_d.$15B.prototype={$12:null,$59:function(){this.$12.$w("Presence",this.$$d_$5k8);this.$12.$1M();_js.$9.prototype.$59.call(this)},$5k8:function(n,t){this.set_$Bh(_y.$PC.$3aW(this.$12.$LA))}};_d.$uB=function(n){_d.$uB.initializeBase(this,[n])};_d.$uB.prototype={get_$4rH:function(){return this.get_$gF().$2d6},get_$2mi:function(){return this.get_$gF().$X5},get_$1m4:function(){return this.get_$gF().get_$1m4()},get_$15w:function(){return this.get_$gF().get_$15w()},get_$gF:function(){return this.$2I},$3zN:function(n){this.get_$gF().$3zN(n)},$41O:function(n){if(this.get_$gF().get_$41A()){this.get_$gF().get_$41A().$PR.$41O(n);_d.$6j.$mo(11,this.get_$2bD().$9S,this.get_$1v().get_$18())}},$3dX:function(n){if(this.get_$gF().get_$41A()){this.get_$gF().get_$41A().$PR.$3dX(n);_d.$6j.$mo(12,this.get_$2bD().$9S,this.get_$1v().get_$18())}},$2b8:function(n){if(this.get_$gF().get_$41A()){this.get_$gF().get_$41A().$PR.$2b8(n);_d.$6j.$mo(10,this.get_$2bD().$9S,this.get_$1v().get_$18())}}};_d.$nh=function(n){_d.$nh.initializeBase(this,[n])};_d.$nh.prototype={get_$2WM:function(){return this.get_$1wJ().get_$2WM()},get_$55N:function(){return this.get_$1wJ().get_$55N()},get_$2FC:function(){return this.get_$1wJ().get_$2FC()},get_$1wJ:function(){return this.$2I},$eY:function(n){var r=_d.$1Cf.prototype.$eY.call(this,n);if(!_js.$8.$c(r))return r;var u=this.get_$1wJ().$Zx.$29B;var h=u?u.$Fm:null;var f=this.get_$1wJ().$Zx.$2JN;var c=f?f.$Fm:null;var e=this.get_$1wJ().$Zx.$2F4;var l=e?e.$Fm:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$6X.$3Np(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$SM=function(){this.$3Xt=new _d.$Kp([new _h.$BA("PersonaDisplayNameFirstLast","Ascending")],_u.Strings.l_FolderSortListFirstName_Text,_u.Strings.l_FolderSortListFirstName_LowerCase_Text);this.$3kQ=new _d.$Kp([new _h.$BA("PersonaDisplayNameLastFirst","Ascending")],_u.Strings.l_FolderSortListLastName_Text,_u.Strings.l_FolderSortListLastName_LowerCase_Text);this.$4lu=new _d.$Kp([new _h.$BA("PersonaCompanyName","Ascending"),new _h.$BA("PersonaDisplayNameFirstLast","Ascending")],_u.Strings.l_FolderSortListCompanyName_Text,_u.Strings.l_FolderSortListCompanyName_LowerCase_Text);this.$55i=new _d.$Kp([new _h.$BA("PersonaHomeCity","Ascending"),new _h.$BA("PersonaDisplayNameFirstLast","Ascending")],_u.Strings.l_FolderSortListHomeCity_Text,_u.Strings.l_FolderSortListHomeCity_LowerCase_Text);this.$6Bo=new _d.$Kp([new _h.$BA("PersonaWorkCity","Ascending"),new _h.$BA("PersonaDisplayNameFirstLast","Ascending")],_u.Strings.l_FolderSortListWorkCity_Text,_u.Strings.l_FolderSortListWorkCity_LowerCase_Text);this.$5rv=new _d.$Kp([new _h.$BA("PersonaCreationTime","Descending"),new _h.$BA("PersonaDisplayNameFirstLast","Ascending")],_u.Strings.l_FolderSortListRecentlyAdded_Text,_u.Strings.l_FolderSortListRecentlyAdded_LowerCase_Text);_d.$SM.initializeBase(this);this.set_$5N(_d.$SM.$1iW);this.set_$24C(1);this.get_$3T().$H(this.$3Xt);this.get_$3T().$H(this.$3kQ);this.get_$3T().$H(this.$4lu);this.get_$3T().$H(this.$55i);this.get_$3T().$H(this.$6Bo);this.get_$3T().$H(this.$5rv)};_d.$SM.prototype={$9FR:function(n){for(var t=0;t<this.get_$3T().get_$F();t++){var i=this.get_$3T().get_$48(t);i.$S6.length>1&&(i.$S6[1]=n.get_$25().$F2)}},$4pT:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$Kp=function(n,t,i){_d.$Kp.initializeBase(this);_a.$3.$M(n,"sortByProperties");_a.$3.$6v(n.length,1,2,"sortByProperties");_a.$3.$M(t,"displayName");_a.$3.$M(i,"contextMenuDisplayName");this.$S6=n;this.$6m=t;this.$14C=i};_d.$Kp.prototype={$S6:null,$6m:null,$14C:null,get_$1l:function(){return this.$6m},toString:function(){return this.$6m}};_d.$2n=function(n,t,i,r,u,f,e){this.$$d_$6qd=Function.createDelegate(this,this.$6qd);this.$$d_$798=Function.createDelegate(this,this.$798);this.$$d_$8cN=Function.createDelegate(this,this.$8cN);this.$$d_$8br=Function.createDelegate(this,this.$8br);this.$$d_$3z0=Function.createDelegate(this,this.$3z0);this.$$d_$8eE=Function.createDelegate(this,this.$8eE);this.$$d_$8eD=Function.createDelegate(this,this.$8eD);this.$163=-1;_d.$2n.initializeBase(this,[n,t,i,r,0,u,!1,f]);this.$908(e,f)};_d.$2n.$2bq=function(n,t){t.val=!1;if(_js.$8.$14(n))return null;var i="";var s="";var l="SMTP";var r=n.indexOf("[");var u=n.lastIndexOf("]");var f=n.indexOf(":");if(r>=0&&u>=0&&f>=0&&f>r&&f<u){s=n.substring(0,r);l=n.substring(r+1,f);i=n.substring(f+1,u).trim();if(_js.$8.$14(i))return null;t.val=!0}else{var a=n.indexOf("<");var v=n.indexOf(">");var y=n.indexOf("(");var p=n.indexOf(")");if(r>=0&&u>=0&&u>r||a>=0&&v>=0&&v>a||y>=0&&p>=0&&p>y){var e=n.match(_d.$2n.$2f9);if(e&&e.length>0){if(!_js.$8.$14(e[0])){var c=n.indexOf(e[0]);if(c!==-1){i=e[0];var w=i.replace(_d.$2n.$4v6,"\\$1");var b=new RegExp(String.format("\\(\\s*{0}\\s*\\)|\\<\\s*{0}\\s*\\>|\\[\\s*{0}\\s*\\]",w));var h=n.match(b);h&&h.length>0&&!_js.$8.$14(h[0])&&(c=n.indexOf(h[0]));s=n.substring(0,c).trimEnd()}}}else i=n}else i=n;if(_js.$8.$14(i))return null;i=i.trim();t.val=_a.$3I.$OZ(i)}var o=new _g.$1m;o.MailboxType="OneOff";o.RoutingType=l.trim();o.EmailAddress=i;o.Name=_js.$8.$14(s)?i:s.trim();return _c.$i.$E5(o)};_d.$2n.$5nB=function(n){for(var f=[],t=0,i=0,u=!1,r=!1;t<n.length;){switch(n.charAt(t)){case"[":r||(u=!0);break;case"]":u&&!r&&(u=!1);break;case";":if(!u&&!r){var e=n.substr(i,t-i);Array.add(f,e);i=t+1}break;case'"':r=r?!1:!0;break;default:break}t++}i<t&&Array.add(f,n.substr(i,n.length-i));return f};_d.$2n.$2AJ=function(n){var t=n.$4U.$Ex;_js.$8.$14(t)||(t=t.substr(0,t.length-1));return t};function $131(n){return n.$163!==-1}function $4PK(n){$131(n)?n.$24y():$4PL(n)}function $4PJ(n,t,i){i&&n.$36.$67k(t.get_$1v())}function $6RZ(n){var t=n.$36.get_$Vm();var i=$6Rc(n,t);i&&i.$11S&&t.get_$1v().set_$1h(i.$11S);var r=$1Ny(n,t.get_$1v());r.$1AQ=!0;n.$2X3(r,n.$Tw,!0)}function $6Rc(n,t){return _d.$7l.isInstanceOfType(t)?t:null}function $2UK(n){n.$36.set_$D5("");n.$19v()}function $4PL(n){var i=n.$36.$2k;if(!_js.$8.$14(i)){for(var r=_d.$2n.$5nB(i),t=0,u=r.length;t<u;t++)$2UL(n,r[t]);$2UK(n)}}function $2UL(n,t){var i;var r,u;var f=(u=_d.$2n.$2bq(t,r={val:i}),i=r.val,u);if(f){var e=$1Ny(n,f);n.$2X3(e,n.$Tw,i);$4PJ(n,e,i)}}function $6Ra(n,t,i){var r=$1Ny(n,t);var u=n.$2X3(r,n.$Tw,i);$4PJ(n,r,i);$2UK(n);if(!i){n.$12Y.$H(u);$131(n)||$4PM(n,u)}}function $4PM(n,t){n.$163=0;n.$5rw=t;n.$1wL=_d.$2n.$2AJ(t)}function $6Re(n){for(var t=!1,r=n.$1L.get_$F(),i=0;i<r;i++){t=!n.$1L.get_$48(i).$Kq;if(t)break}n.set_$58r(t)}function $3Fp(n){if(!$131(n)){n.$36.set_$1BC(n.$1BB);n.set_$1Mk("");n.set_$19t(null);return}n.$36.set_$3OW(!1);var t=n.$12Y.get_$48(n.$163);var i=t.$4U.$Ex;n.$12Y.$67(n.$163);if(n.$163<n.$12Y.get_$F()){t=n.$12Y.get_$48(n.$163);n.set_$1Mk(_d.$2n.$2AJ(t));n.set_$19t(t)}else{n.$12Y=null;n.$163=-1;n.$36.$5u0();n.set_$2dx(!1);n.$36.set_$1BC(n.$1BB);n.$36.remove_$xd(n.$$d_$8eE);n.set_$1Mk("");n.set_$19t(null);if(n.$1lU){$EQ(n,"BulkResolveOperationComplete",!0);n.$1lU=!1}}}function $6Rb(n,t){for(var i=0,f=n.$1L.get_$F();i<f;i++){var r=n.$1L.get_$48(i);var u=r.$4U;u.set_$l9(!t);u.$1AQ=!t;u.set_$368(!t);t?r.$44F():r.$4eF()}}function $6Rd(n,t,i){var r=t;i||(r^=1);return r}_d.$2n.prototype={$2RK:null,$oe:null,$1GT:!1,$36:null,$12Y:null,$5rw:null,$1wL:null,$1Ed:!1,$37I:!1,$3Bf:!1,$1lU:!1,$1BB:null,add_$jN:function(n){this.$2Z("BulkResolveOperationComplete",n)},remove_$jN:function(n){this.$2b("BulkResolveOperationComplete",n)},get_$19t:function(){return this.$oe},set_$19t:function(n){if(this.$oe!==n){this.$oe&&!$131(this)&&this.$36.remove_$xd(this.$$d_$8eD);this.$oe=n;this.$oe&&!$131(this)&&this.$36.add_$xd(this.$$d_$8eD);$6(this,"RecipientBeingEdited")}return n},get_$ll:function(){return this.$36},set_$ll:function(n){if(this.$36!==n){this.$36=n;$6(this,"FindRecipientViewModel")}return n},get_$58r:function(){return this.$1GT},set_$58r:function(n){if(this.$1GT!==n){this.$1GT=n;$6(this,"IsAnyRecipientInvalid")}return n},get_$1Mk:function(){return this.$2RK},set_$1Mk:function(n){if(this.$2RK!==n){this.$2RK=n;$6(this,"TextBeingEdited")}return n},get_$2dx:function(){return this.$1Ed},set_$2dx:function(n){if(this.$1Ed!==n){this.$1Ed=n;$6Rb(this,n);$6(this,"DisableActionsOnAllRecipients")}return n},get_$612:function(){return this.$37I},set_$612:function(n){if(this.$37I!==n){this.$37I=n;$6(this,"ShouldShowHiddenRecipient")}return n},get_$20c:function(){return this.$3Bf},set_$20c:function(n){if(this.$3Bf!==n){this.$3Bf=n;$6(this,"UpdateFindControlPopupPosition")}return n},get_$Ug:function(){return _a.UserAgent.getInstance().$JT},$15P:function(){$4PK(this)},$9Bx:function(){this.$36&&this.$36.set_$a9(!1)},$1kO:function(){$4PK(this);this.$1lU=!0;if(this.$1GT){this.$12Y=new _js.$X;this.$36.set_$9Cd(new _js.$X);for(var t=0,r=this.$1L.get_$F();t<r;t++){var n=this.$1L.get_$48(t);if(!n.$Kq){this.$12Y.$H(n);var i=_d.$2n.$2AJ(n);this.$36.$W2.$H(i);if(!$131(this)){this.$36.$5Hx(i);this.set_$2dx(!0);this.$36.set_$1BC(null);$4PM(this,n);this.set_$1Mk(i);this.set_$19t(n);this.$36.add_$xd(this.$$d_$8eE)}}}}else{$EQ(this,"BulkResolveOperationComplete",!0);this.$1lU=!1}},$2NT:function(n){for(var i=[],t=0,f=this.$1L.get_$F();t<f;t++){var u=this.$1L.get_$48(t).$BY.get_$1h();$8(u.EmailAddress)||u.EmailAddress!==n||Array.add(i,t)}for(var r=i.length-1;r>=0;r--)this.$1L.$67(i[r])},$Ar:function(){_y.$28.prototype.$Ar.call(this);this.$36&&this.$36.set_$D5(null)},$24y:function(){if($131(this)){this.$163=-1;this.$36.$5u0();this.set_$2dx(!1);this.$36.remove_$xd(this.$$d_$8eE);this.$36.set_$1BC(this.$1BB);if(this.$36.$2k===this.$2RK)this.set_$612(!0);else{var n=this.$36.$2k;_js.$8.$c(n)||$2UL(this,n)}this.set_$1Mk("");this.set_$19t(null);this.set_$612(!1);if(this.$1lU){$EQ(this,"BulkResolveOperationComplete",!1);this.$1lU=!1}}},$237:function(n){return this.$4eI(n)},$4eI:function(n){var i;var r;var t=!1;if(this.$617){var u=n.EmailAddress;var f=n.Name;if(_js.$8.$c(u))if(_js.$8.$c(f))throw Error.argumentNull("Address and Name parameters are set to null in emailAddress");else if(n.RoutingType!=="MAPIPDL"){var e,o;i=(o=_d.$2n.$2bq(f,e={val:t}),t=e.val,o)}else{t=!0;i=_c.$i.$E5(n)}else{t=_g.$2I.$1HA(n)?!0:_a.$3I.$OZ(u);i=_c.$i.$E5(n)}}else{t=!0;i=_c.$i.$E5(n)}r=$1Ny(this,i);this.$2X3(r,this.$Tw,t);this.set_$58r(!!(this.$1GT|!t));return r},$59:function(){this.$36.remove_$jv(this.$$d_$3z0);this.$36.remove_$5gE(this.$$d_$8br);this.$36.remove_$5oH(this.$$d_$8cN);this.set_$19t(null);$131(this)&&this.$36.remove_$xd(this.$$d_$8eE);_y.$28.prototype.$59.call(this)},$908:function(n,t){var i=new _d.$IG(n,t);this.$1BB=new _C(this.$$d_$798,_d.$2n.$D);i.set_$8pY(new _C(this.$$d_$19v,_d.$2n.$D));i.set_$1BC(this.$1BB);i.set_$4Cu(new _C(this.$$d_$6qd,_d.$2n.$D));i.add_$jv(this.$$d_$3z0);i.add_$5gE(this.$$d_$8br);i.add_$5oH(this.$$d_$8cN);this.set_$ll(i)},$798:function(){var n=this.$1L.get_$F();if(n>0){var t=this.$1L.get_$48(n-1);$1ej(this,t)}},$3z0:function(n,t){var i=this.$36.get_$Vm();if(i){$6RZ(this);this.$oe||$2UK(this)}},$6qd:function(){$131(this)?$2UL(this,this.$36.$2k):$4PL(this);this.$oe||$2UK(this)},$8dY:function(n,t){var i=n;if(i.$1mp){this.$36.set_$1BC(null);this.set_$1Mk(_d.$2n.$2AJ(i));this.set_$19t(i)}},$2L3:function(n,t){_y.$28.prototype.$2L3.call(this,n,t);$6Re(this)},$2X3:function(n,t,i){if(!n)throw Error.argument("personaViewModel");var f=$6Rd(this,t,i);var r=this.$3S4(n,f,i);this.$2YV(r,f);if(this.$oe){var e=this.$1L.$7h(this.$oe);$1ej(this,this.$1L.get_$48(e));var u=r.$4U;u.set_$l9(!this.$1Ed);u.$1AQ=!this.$1Ed;u.set_$368(!this.$1Ed);this.$1Ed&&r.$44F();this.$1L.$6z(e,r);$3Fp(this)}else this.$1L.$H(r);this.$19v();return r},$8br:function(n){if(!$8(n)&&n.get_$F()&&!$8(this.$36.$1NM)&&this.$36.$1NM.get_$F()){this.$12Y=new _js.$X;for(var t=0,i=n.get_$F();t<i;t++)$6Ra(this,n.get_$48(t),this.$36.$1NM.get_$48(t));if(this.$12Y.get_$F()>0){this.set_$2dx(!0);this.$36.set_$1BC(null);this.set_$1Mk(this.$1wL);this.set_$19t(this.$5rw);this.$36.add_$xd(this.$$d_$8eE)}}},$8cN:function(n,t){for(var r=0,f=this.$1L.get_$F();r<f;r++){var i=this.$1L.get_$48(r);var u=i.$4U.$12;if(i.$Kq&&u.get_$9m()===1&&!_js.$8.$14(u.get_$1h().EmailAddress)&&u.get_$1h().EmailAddress.toLowerCase()===n.toLowerCase()){i.$4U.set_$3N5(t);$4cJ(this,i.$4U)}}},$8eD:function(n,t){var r=n;if(!r.$jm){var i=this.$1L.$7h(this.$oe);if(i>=0){var u=this.$36.$2k;if(_js.$8.$c(u)){$1ej(this,this.$1L.get_$48(i));$3Fp(this)}else $2UL(this,this.$36.$2k)}}},$8eE:function(n,t){var r=n;if(!r.$jm){var i=this.$1L.$7h(this.$oe);if(i>=0){var u=this.$36.$2k;if(_js.$8.$c(u)){$1ej(this,this.$1L.get_$48(i));$3Fp(this)}else this.$36.$2Zr&&this.$24y()}}}};_d.$22=function(n,t,i,r,u,f,e,o){this.$$d_$3y2=Function.createDelegate(this,this.$3y2);this.$$d_$8cE=Function.createDelegate(this,this.$8cE);this.$$d_$4eW=Function.createDelegate(this,this.$4eW);this.$$d_$8rF=Function.createDelegate(this,this.$8rF);this.$$d_$9BR=Function.createDelegate(this,this.$9BR);this.$$d_$67p=Function.createDelegate(this,this.$67p);this.$$d_$8XL=Function.createDelegate(this,this.$8XL);this.$$d_$3zB=Function.createDelegate(this,this.$3zB);this.$$d_$8vi=Function.createDelegate(this,this.$8vi);this.$$d_$46V=Function.createDelegate(this,this.$46V);this.$$d_$8cP=Function.createDelegate(this,this.$8cP);this.$2zd={};this.$EI=-1;this.$FC=-1;_d.$22.initializeBase(this,[_y.$j.$g.get_$O()]);this.set_$OY(!0);this.$1k4=this.$1oi?"Email":"Text";this.$2Zp=!$8(i)&&i;this.$1T=$8(r)?OwaApplication.$1T:r;this.$4wl=!$8(u)&&u;this.$S=o?o:OwaApplication.get_$Qt();this.$3S3=n;this.$19P=t;this.$50=f;this.$1K=e};function $6NY(n){$2Tt(n);$3F3(n);var t=_a.$5.acss(_a.$0.$UN,"GetPersonasFromCache");var i=_d.$5S.$51T(n.$19P,n.$2k,8,0);_a.$5.aces(t);i.length>0&&_d.$6j.$7fs(_js.$8.$14(n.$2k)?-1:n.$2k.length,i.length);t=_a.$5.acss(_a.$0.$UN,"CreatePersonaViewModels");var r=this;Array.forEach(i,function(t){n.$8a.$H(n.$2c0(t))});_a.$5.aces(t);n.set_$2oK(!0);n.$11Y=!0;n.$2Pb=!1;$6Nb(n);t=_a.$5.acss(_a.$0.$UN,"ToggleResultVisible");$3F4(n);_a.$5.aces(t);n.$5uA();$2Ts(n);$4NP(n);$Q(n,"ShouldHideBordersForUseThisLocationButton")}function $6Nb(n){n.set_$1aX(n.get_$5wh());n.$8a.get_$F()===8?n.set_$12L(String.format(_u.Strings.l_ResultsDisplayedString_Text,8)):n.set_$12L("");$2Tv(n);if(n.$2Zp){n.set_$6qz(String.format(_u.Strings.l_AddRecipient_Text,n.$2k));$4NO(n)}}function $21g(n,t){$3F3(n);n.$2Pb=!0;if(t.get_$F()===1){var u=t.get_$48(0);if($4NM(n,u)){n.$11Y=n.$iV;n.set_$Vm(n.$2c0(u));return 1}}for(var i=0,r=0;r<t.get_$F()&&i<20;r++){n.$8a.$H(n.$2c0(t.get_$48(r)));i++}n.$8a.get_$F()===20?n.set_$12L(String.format(_u.Strings.l_ServerResultsDisplayedString_Text,20)):n.$8a.get_$F()?n.set_$12L(""):n.set_$12L(_u.Strings.l_NoMatchFound_Text);n.set_$1aX("");$4NN(n);i===1&&n.$67p();$4NP(n);$Q(n,"ShouldHideBordersForUseThisLocationButton");return i}function $4NM(n,t){return!!t.get_$5l()&&t.get_$5l().length===1}function $6NT(n){n.set_$12L(_u.Strings.l_ServerSearchError_Text);n.set_$1aX("");$4NN(n)}function $2Tv(n){n.set_$93J(n.$2Np!==""||n.$20D!==""||n.$1wB)}function $4NO(n){n.set_$926(n.$2Zp&&_a.$3I.$OZ(n.$2k))}function $3F3(n){var t=this;n.$8a.$Bx(function(t){t.remove_$5CB(n.$$d_$8cE)});n.$8a.$1u()}function $6NV(n){n.$2NI&&n.$2NI.$s()}function $4NP(n){if(n.$8a.get_$F()>0&&n.$8a.get_$48(0).$3bp()){var t=n.$8a.get_$48(0);if(!_d.$5S.$7XV(t.get_$1v(),n.$2k)){t.set_$2nl(!0);var i=_d.$5S.$7Md(t.$I6,n.$2k);if(i!==-1){t.set_$HU(i);n.set_$e4(n.$EI);n.set_$HU(-1)}}}}function $4NN(n){n.set_$33F(!1);$2Tv(n);n.$iV&&$3F4(n);n.$5uA();$2Ts(n)}function $21h(n){n.set_$91T(n.get_$9Fv()&&n.$jm&&(n.$8a.get_$F()>0&&n.$FC<n.$8a.get_$F()||n.$1HE&&n.$mK||n.$xx))}function $2Ts(n){if(!_js.$8.$c(n.$2k)){var t=_a.$5.acss(_a.$0.$UN,"ApplyHitHighlight");n.get_$3cp().$55e(n.$2k,".searchHitHighlight");_a.$5.aces(t)}}function $6NU(n){n.set_$e4(0);n.set_$HU(0);n.set_$ev(!1);n.set_$1GO(!1)}function $6NW(n){n.set_$a9(!1);$2Tt(n);n.set_$HU(-1);n.set_$e4(-1);n.set_$ev(!1);n.set_$1GO(!1);n.$2Pb=!1;n.$6yF()}function $3F4(n){!_js.$8.$14(n.$2k)&&n.$bo&&(n.$8a.get_$F()>0||n.$1Af)?n.set_$a9(!0):n.set_$a9(!1)}function $6Na(n){if(n.$FC>=0&&n.$FC<n.$8a.get_$F()){var t=n.$8a.get_$48(n.$FC);t.$8yV();n.set_$Vm(t)}}function $6NZ(n,t,i){if($8(t.$1b)){var r=t.get_$11D();var u=_a.$5.acss(_a.$0.$UN,"HandleServerResults");i.val=$21g(n,r);_a.$5.aces(u)}else $6NT(n)}function $6NX(n){n.$8a.get_$F()>0?n.$8a.get_$F()===n.$FC?n.set_$HU(n.$FC-1):n.set_$HU(n.$FC):n.$3bT()}function $2Tt(n){if(n.$1wB){n.set_$33F(!1);n.$2Os=null;n.set_$1aX(_u.Strings.l_SearchOutlookDirectory_Text);n.set_$12L("");n.set_$2oK(!0)}}function $6NS(n){return n.$3S3(n.$2k)}function $2Tw(n){return $2Tu(n)?n.$8a.get_$48(n.$FC):null}function $2Tu(n){return n.$FC>-1&&n.$FC<n.$8a.get_$F()}_d.$22.prototype={$1T:null,$2Zp:!1,$19P:null,$4wl:!1,$S:null,$3S3:null,$1K:null,$50:null,$4eX:null,$46m:null,$ux:null,$2EK:!0,$2NI:null,$1BB:null,$3A8:null,$1k4:null,$2Np:null,$20D:null,$1O2:null,$1Af:!0,$jm:!1,$2Kc:!1,$3cC:!1,$8a:null,$2Os:null,$mK:!1,$xx:!1,$23B:null,$1HE:!0,$1wB:!1,$34y:null,$1yP:!1,$2PY:!1,$1be:!1,$jn:null,$ZG:null,$26M:null,$IX:null,$OS:null,$2Pb:!1,$11Y:!1,$15t:!1,$7Ga:!1,add_$jv:function(n){this.$a("SelectedResultItem",n)},remove_$jv:function(n){this.$w("SelectedResultItem",n)},add_$xd:function(n){this.$a("ResultVisible",n)},remove_$xd:function(n){this.$w("ResultVisible",n)},add_$5oH:function(n){this.$2Z("PersonaResolutionCompleted",n)},remove_$5oH:function(n){this.$2b("PersonaResolutionCompleted",n)},get_$Vm:function(){return this.$46m},set_$Vm:function(n){if(n&&_c.$i.isInstanceOfType(n.$12)&&n.get_$1v().get_$9m()!==1){var t=new _c.$i;t.$P3(n.get_$1v().$OR());n.set_$1v(t)}this.$46m=n;$Q(this,"SelectedResultItem");n&&this.$8fA();return n},get_$9Fv:function(){return!0},get_$7eT:function(){return null},get_$67z:function(){return _y.$j.$g.get_$O()==="Mouse"?3:_y.$j.$g.get_$O()==="TouchWide"?11:10},get_$9GD:function(){return""},set_$9GD:function(n){return n},get_$93P:function(){return!_js.$8.$c(this.get_$7eT())},get_$7d7:function(){return!1},set_$7d7:function(n){return n},get_$94a:function(){return!1},set_$94a:function(n){return n},get_$9GC:function(){return null},get_$91K:function(){return!this.$8a.get_$F()&&this.get_$2lb()},get_$91T:function(){return this.$1yP},set_$91T:function(n){if(this.$1yP!==n){this.$1yP=n;$Q(this,"ShouldPreventDefaultOnTab")}return n},get_$60g:function(){return this.$11Y},set_$60g:function(n){this.$11Y=n;return n},get_$36z:function(){return!this.$1Af||!$2Tu(this)},get_$48m:function(){return this.$2PY},set_$48m:function(n){if(this.$2PY!==n){this.$2PY=n;$Q(this,"ShouldPreventDefaultOnLeftArrow")}return n},get_$1aY:function(){return this.$34y},set_$1aY:function(n){if(this.$34y!==n){this.$34y=n;$Q(this,"ResultItemTemplateId")}return n},get_$8pY:function(){return this.$2NI},set_$8pY:function(n){if(this.$2NI!==n){this.$2NI=n;$Q(this,"RefreshLayoutCommand")}return n},get_$1BC:function(){return this.$1BB},set_$1BC:function(n){if(this.$1BB!==n){this.$1BB=n;$Q(this,"TextBoxBackspaceCommand")}return n},get_$4Cu:function(){return this.$3A8},set_$4Cu:function(n){this.$3A8!==n&&(this.$3A8=n);return n},get_$2c9:function(){return this.$26M},set_$2c9:function(n){if(this.$26M!==n){this.$26M=n;$Q(this,"CtrlKCommand")}return n},get_$4dF:function(){return this.$1O2},set_$4dF:function(n){this.$1O2!==n&&(this.$1O2=n);return n},get_$7eS:function(){return null},get_$45O:function(){return this.$jn},set_$45O:function(n){this.$jn!==n&&(this.$jn=n);return n},get_$3kf:function(){return this.$ZG},set_$3kf:function(n){this.$ZG!==n&&(this.$ZG=n);return n},get_$4C8:function(){return this.$ux},set_$4C8:function(n){this.$ux!==n&&(this.$ux=n);return n},get_$1aX:function(){return this.$2Np},set_$1aX:function(n){if(this.$2Np!==n){this.$2Np=n;$Q(this,"ResultInformation")}return n},get_$12L:function(){return this.$20D},set_$12L:function(n){if(this.$20D!==n){this.$20D=n;$Q(this,"TopResultInformation")}return n},get_$93J:function(){return this.$1Af},set_$93J:function(n){if(this.$1Af!==n){this.$1Af=n;$9G(this,"ShowInformationButton","ShouldDeleteKeyBeIgnored")}return n},get_$7ci:function(){return this.$2EK},set_$7ci:function(n){if(n!==this.$2EK){this.$2EK=n;$Q(this,"IsTextBoxEnabled")}return n},get_$8SV:function(){return this.$2Kc},set_$8SV:function(n){if(this.$2Kc!==n){this.$2Kc=n;$Q(this,"OnBeforeResultsVisible")}return n},get_$a9:function(){return this.$jm},set_$a9:function(n){OwaApplication.$xO&&(n=!1);if(this.$jm!==n){this.$jm=n;$21h(this);this.set_$8SV(n);n||this.$cy("");$Q(this,"ResultVisible")}return n},get_$2B9:function(){return this.$3cC},set_$2B9:function(n){this.$3cC=n;$Q(this,"HaveInvokedTypedownForQueryString");return n},get_$HU:function(){return this.$EI},set_$HU:function(n){var t=$2Tw(this);if(t){this.set_$48m(t.$ma);var i="";t.$I6&&t.$I6.get_$F()>0&&!t.$ma&&(i=" "+_u.Strings.l_FindRecipient_AT_MultipleEmailAddresses_Text);this.$jm?this.$8a.get_$F()===1?this.$cy(String.format(_u.Strings.l_FindRecipient_AT_SingleResult_Text,t.$Ex)+i):this.$cy(String.format(_u.Strings.l_FindRecipient_AT_MultipleResults_Text,t.$Ex)+i):this.$cy("")}else this.set_$48m(!1);if(this.$EI!==n){this.$EI=n;$Q(this,"ResultItemHighlightedIndex")}return n},get_$33F:function(){return this.$1wB},set_$33F:function(n){if(this.$1wB!==n){this.$1wB=n;$Q(this,"QueryInProgress")}return n},get_$ev:function(){return this.$mK},set_$ev:function(n){n&&(this.$1HE?this.$cy(String.format(_u.Strings.l_FindRecipient_AT_Search_Text,this.get_$5wh(),this.$2k)):this.$cy(_u.Strings.l_NoMatchFound_Text));if(this.$mK!==n){this.$mK=n;$21h(this);$Q(this,"IsActionButtonHighlighted")}return n},get_$7aG:function(){return!1},set_$7aG:function(n){return n},get_$1GO:function(){return this.$xx},set_$1GO:function(n){n&&this.$cy(this.$23B);if(this.$xx!==n){this.$xx=n;$21h(this);$Q(this,"IsAddSmtpAddressAsPersonaButtonHighlighted")}return n},get_$2oK:function(){return this.$1HE},set_$2oK:function(n){if(this.$1HE!==n){this.$1HE=n;$21h(this);$Q(this,"IsServerSearchAllowed")}return n},get_$926:function(){return this.$1be},set_$926:function(n){if(this.$1be!==n){this.$1be=n;$Q(this,"ShowAddSmtpAddressAsPersonaButton")}return n},get_$6qz:function(){return this.$23B},set_$6qz:function(n){if(this.$23B!==n){this.$23B=n;$Q(this,"AddSmtpAddressAsPersonaString")}return n},get_$7F5:function(){return this.$1k4},set_$7F5:function(n){if(this.$1k4!==n){this.$1k4=n;$Q(this,"FindTextBoxType")}return n},get_$2jO:function(){return this.$15t},set_$2jO:function(n){if(this.$15t!==n){this.$15t=n;$Q(this,"HasTextBeenPasted")}return n},get_$7i:function(){return _a.UserAgent.getInstance().$8O},get_$2lb:function(){return!_a.UserAgent.getInstance().$Lr},get_$5wh:function(){return this.$4wl?_u.Strings.l_SearchDirectory_Text:_u.Strings.l_SearchOutlookDirectory_Text},get_$75c:function(){return this.$3S3},get_$e4:function(){return this.$FC},set_$e4:function(n){if(this.$FC!==n){this.$FC=n;$21h(this);$Q(this,"ShouldDeleteKeyBeIgnored")}return n},get_$3cp:function(){this.$OS||(this.$OS=new _a.$7j("psearchHighlight"));return this.$OS},$vd:function(){this.$19P.$Oq=_c.$14.$qp(0,220);this.$19P.$NR(null)},$67k:function(n){var t=_d.$5S.$9Bf(n,this.$19P);if(t){if(n.get_$9m()===1&&t.get_$9m()!==1){var i=new _c.$i;i.$P3(t.$OR());i.set_$1h(n.get_$1h());$SM(this,"PersonaResolutionCompleted",n.get_$1h().EmailAddress,i)}}else if(this.$19P.$ic)if(n.get_$9m()===1){this.$2zd[n.get_$1h().EmailAddress]=n;var r=_c.$14.$4oS(n.get_$1h().EmailAddress,_c.$14.$hn);r.add_$2m(this.$$d_$8cP);this.$1T.$y(r)}else _d.$5S.$4eD(n,this.$19P)},$794:function(n){_d.$5S.$795(n,this.$19P);if(n.get_$9m()!==1){var t=new _c.$qa(n.get_$5s(),"recipientcache");this.$1T.$y(t)}},$cy:function(n){this.$S.$8oV(_a.$Hj,new _a.$Hj(n))},$574:function(){_y.$6Y.prototype.$574.call(this);this.set_$Gb(new _C(this.$$d_$46V,_d.$22.$D));this.set_$4C8(new _C(this.$$d_$8vi,_d.$22.$D));this.set_$1BO(new _C(this.$$d_$3zB,_d.$22.$D));this.set_$4dF(new _C(this.$$d_$8XL,_d.$22.$D));this.set_$45O(new _C(this.$$d_$67p,_d.$22.$D));this.set_$3kf(new _C(this.$$d_$9BR,_d.$22.$D));this.$26M=new _C(this.$$d_$8XL,_d.$22.$D);this.$IX=new _C(this.$$d_$8rF,_d.$22.$D);this.$4eX=new _C(this.$$d_$4eW,_d.$22.$D);this.$8a=new _js.$X},$8fA:function(){this.$2Pb&&this.$67k(this.$46m.get_$1v());_d.$6j.$7fu(_js.$8.$14(this.$2k)?-1:this.$2k.length,this.$8a.get_$F(),this.$EI!==-1?this.$EI:this.$FC);$6NW(this)},$6yF:function(){this.set_$D5("")},$5uA:function(){this.$8a.get_$F()>0?$6NU(this):this.$3bT()},$2c0:function(n){var t;t=this.$50?this.$50.$75U(n,_y.$q.$Hr,!1):new _d.$7l(n,_y.$q.$Hr,!1,this.$1K);var i=[1];t.$Xp(1,i,"");t.$420();t.add_$5CB(this.$$d_$8cE);return t},$8gs:function(){if(this.$bo){this.$11Y=!0;this.$1oi||this.set_$2eH(!1);if($8(this.$2k)||this.$2k.trim()==="")this.set_$a9(!1);else if(!this.$3cC&&this.$pS.$2K)this.$3zB();else{var n=this.$jm;$3F4(this);n||$2Ts(this)}}},$5l5:function(){if(this.$bo&&!this.$1oi)if(this.$1UH){var n=this;_js.$K.get_$L().$3i(_a.$0.$41E,"TextBox.SetFocus",function(){n.set_$HE(!0)})}else this.set_$a9(!1)},$8Rs:function(){if(this.$jm&&!this.$4ji()&&this.$FC>=0&&this.$8a.get_$F()>0){var n=this.$8a.get_$48(this.$FC);if(this.$EI!==-1&&this.$FC){var t=this.$8a.get_$48(this.$FC-1);if(t.$9Bj()){this.set_$e4(this.$FC-1);this.set_$HU(-1);var r=t.$I6.get_$48(t.$EI).EmailAddress;this.$cy(String.format(_u.Strings.l_FindRecipient_AT_SecondaryItemSelected_Text,r,t.$Ex))}else{this.set_$e4(this.$FC-1);this.set_$HU(this.$FC)}}else if(n.$9Bk()){if(this.$EI!==-1){this.set_$e4(this.$EI);var i=n.$I6.get_$48(n.$EI).EmailAddress;this.$cy(String.format(_u.Strings.l_FindRecipient_AT_SecondaryItemSelected_Text,i,n.$Ex))}this.set_$HU(-1)}else this.set_$HU(this.$FC)}},$8Rr:function(){if(this.$jm&&!this.$4jh()&&$2Tu(this)){var n=this.$8a.get_$48(this.$FC);if(n.$67t()){if(this.$EI!==-1){this.set_$e4(this.$EI);this.set_$HU(-1);var t=n.$I6.get_$48(n.$EI).EmailAddress;this.$cy(String.format(_u.Strings.l_FindRecipient_AT_SecondaryItemSelected_Text,t,n.$Ex))}}else{this.set_$e4(this.$FC+1);this.set_$HU(this.$FC)}}},$91Y:function(){return!0},$8W1:function(){this.set_$a9(!1);$2Tt(this)},$921:function(){return!0},$3bT:function(){if(this.$1be){this.set_$1GO(!0);this.set_$ev(!1)}else{this.set_$1GO(!1);this.$1Af?this.set_$ev(!0):this.set_$ev(!1)}this.set_$e4(-1);this.set_$HU(-1)},$4jh:function(){if(this.$mK)return!0;if(this.$xx&&this.$1Af){this.set_$1GO(!1);this.set_$ev(!0);return!0}if(this.$FC===this.$8a.get_$F()-1){var n=this.$8a.get_$48(this.$FC);if(!n.$6wZ()){this.$1be?this.set_$1GO(!0):this.$1Af&&this.set_$ev(!0);if(this.$xx||this.$mK){n.$67t();this.set_$e4(this.$8a.get_$F());this.set_$HU(this.$FC)}return!0}}return!1},$4ji:function(){if(this.$mK)if(this.$1be){this.set_$1GO(!0);this.set_$ev(!1)}else this.$8a.get_$F()>0&&this.set_$ev(!1);else this.$xx&&this.$8a.get_$F()>0&&this.set_$1GO(!1);return this.$mK||this.$xx},$46V:function(){this.$mK?this.$1HE&&this.$1O2.$2K&&this.$1O2.$s():this.$xx&&this.$2Zp&&_a.$3I.$OZ(this.$2k)?this.$4eW():this.$jm&&this.$8a.get_$F()>0&&(this.$EI!==-1?this.set_$Vm(this.$8a.get_$48(this.$EI)):$6Na(this))},$8vi:function(){this.$1yP?this.$46V():this.set_$a9(!1)},$8XL:function(){var t=this.$921();if(t){if(!this.$1HE||$8(this.$2k)||this.$2k.trim()==="")return;_a.$5.stPT(_a.$0.$UN,"VM.FindRecipient.Search",3);_a.$5.$1V(_a.$0.$UN,"ServerSearch");this.set_$2oK(!1);this.set_$33F(!0);this.set_$1aX("");this.set_$12L(String.format(_u.Strings.l_SearchingForResultsString_Text,this.$2k));$2Tv(this);this.set_$HE(!0);this.$cy(this.$20D);var n=$6NS(this);if(!Object.getType(n).implementsInterface(_c.$sU))throw Error.argument("The server search action must implement IQueryAction interface");this.$2Os=n;this.$2Os.add_$2m(this.$$d_$3y2);this.$1T.$y(this.$2Os);_d.$6j.$7ft(_js.$8.$14(this.$2k)?-1:this.$2k.length,this.$8a.get_$F())}},$8cP:function(n){var t=n;if($8(t.$1b)){var u=this.$2zd[t.$2k];if(t.$As.get_$F()>0){var i=t.$As.get_$48(0);var f=null;if(!$8(i.get_$5l()))for(var r=0;r<i.get_$5l().length;r++)i.get_$5l()[r]&&i.get_$5l()[r].EmailAddress&&i.get_$5l()[r].EmailAddress.toLowerCase()===t.$2k.toLowerCase()&&(f=i.get_$5l()[r]);if(f){u=i;var e=new _c.$i;e.$P3(u.$OR());e.set_$1h(f);$SM(this,"PersonaResolutionCompleted",t.$2k,e)}}_d.$5S.$4eD(u,this.$19P)}delete this.$2zd[t.$2k];n.remove_$2m(this.$$d_$3y2)},$4eW:function(){var n=new _g.$1m;n.MailboxType="OneOff";n.RoutingType="SMTP";n.EmailAddress=this.$2k;n.Name=this.$2k;this.$2Pb=!0;this.set_$Vm(this.$2c0(_c.$i.$E5(n)))},$3zB:function(){if(this.$iV||this.$7Ga){$6NV(this);if(!this.$bo||_js.$8.$14(this.$2k)){this.set_$a9(!1);this.set_$HU(-1);$2Tt(this);return}var n=this.$91Y();if(n){_a.$5.stPT(_a.$0.$UN,"VM.FindRecipient.TypeDown",3);var t=_a.$5.$1V(_a.$0.$UN,"NicknameCacheSearch",!0);$6NY(this);_a.$5.$1G(t,null,null,null,this.$8a.get_$F().toString());_a.$5.endPT("VM.FindRecipient.TypeDown")}this.set_$2B9(!0)}},$3y2:function(n){if($8(n.$1b)&&$8(n.get_$11D()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2Os){var i;$6NZ(this,n,i={val:t});t=i.val}n.remove_$2m(this.$$d_$3y2);_a.$5.$1G(null,"ServerSearch",null,null,t.toString());_a.$5.endPT("VM.FindRecipient.Search")},$8rF:function(){if($2Tu(this)){var n=this.$8a.get_$48(this.$FC).get_$1v();this.$794(n);this.set_$HU(-1);this.$8a.$67(this.$FC);$6NX(this)}},$67p:function(){var n=$2Tw(this);n&&n.$3bp()&&n.set_$2nl(!0)},$9BR:function(){var n=$2Tw(this);if(n&&n.$3bp()){n.set_$2nl(!1);n.set_$HU(-1);this.set_$HU(this.$FC)}},$8cE:function(n,t){var r=$2Tw(this);if(r){var i=n;if(r===i){this.set_$48m(i.$ma);if(!i.$ma){r.set_$HU(-1);this.set_$HU(this.$FC)}}if(i.$ma){var u=this;_js.$K.get_$L().$3i(_d.$22.$D,"FindRecipientViewModel.ApplyHitHighlight",function(){$2Ts(u)})}}}};_d.$193=function(n,t,i,r,u,f,e,o){_d.$193.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$193.prototype={$3S4:function(n,t,i){return new _d.$o4(n,t,i)}};_d.$194=function(n,t,i,r,u,f,e,o){_d.$194.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$194.prototype={$2X3:function(n,t,i){if($8(n))throw Error.argument("personaViewModel is invalid");n.set_$14y(!1);n.$Xp(1,new Array(0),n.$12.get_$1h().EmailAddress);var r=this.$3S4(n,2,i);this.$2YV(r,2);this.$1L.$H(r);return r}};_d.$EI=function(n,t,i,r){this.$1QA_0=n;this.$G_0=t;this.$1K=i;this.$p=r};_d.$EI.prototype={$G_0:null,$1K:null,$1QA_0:null,$p:null,$SX:function(n,t,i,r,u,f){u=u?!0:!1;return new _d.$7u(n,t,i,r,this.$1QA_0,this.$G_0,u,f,this.$1K)},$75U:function(n,t,i){return new _d.$7l(n,t,!1,this.$1K)},$75S:function(n,t,i,r,u,f){return new _d.$GD(n,t,i,r,this.$p,u,f)},$qm:function(n,t,i,r){return _c.$i.isInstanceOfType(n)?this.$SX(n,t,i,r):this.$SX(_c.$i.$1QP(n),t,i,r)}};_d.$Bi=function(){this.$$d_$5mT=Function.createDelegate(this,this.$5mT);_d.$Bi.initializeBase(this);this.$31C=new _C(this.$$d_$5mT,_d.$Bi.$D);this.$8a=new _js.$X};function $6Rf(n,t){var i=new _d.$7l(t,_y.$q.$Hr,!1);var r=[1];i.$Xp(1,r,"");i.$420();return i}function $6Rg(n,t){var i=new Sys.StringBuilder;i.append("Name,Main Email,Secondary Email"+t);for(var f=0;f<n.$8a.get_$F();f++){var r=n.$8a.get_$48(f);i.append("Name: "+r.$Ex+",");i.append("Email: "+r.$uM);if(!$8(r.$I6))for(var u=0;u<r.$I6.get_$F();u++){i.append(",");var e=r.$I6.get_$48(u);i.append("Email "+(u+1).toString()+": "+e.EmailAddress)}i.append(t)}return i.toString()}_d.$Bi.prototype={$8a:null,$31C:null,$1Mx:null,get_$66z:function(){return this.$1Mx},set_$66z:function(n){if(this.$1Mx!==n){this.$1Mx=n;$6(this,"TotalResultsInRecipientCache")}return n},$Fe:function(){this.$8a.$1u();for(var n=_c.$14.$bV(),t=0;t<n.$1p.get_$F();t++)this.$8a.$H($6Rf(this,n.$1p.get_$48(t)));this.set_$66z(String.format(_u.Strings.l_RecipientCacheTotalItems_Text,n.$1p.get_$F()))},$co:function(){},$Rx:function(){},$gC:function(){},$5mT:function(){console.log($6Rg(this,"\r\n"))}};_d.$S6=function(n,t,i){_d.$S6.initializeBase(this,[n,t]);this.$p=i};_d.$S6.prototype={$p:null,$2c3:function(n,t,i,r){$8(r)&&(r=!0);return new _d.$2n(this.$G.get_$O(),n,t,i,r,this.$wU,this.$p)}};_d.$Sc=function(n,t){this.$G=n;this.$50=t};_d.$Sc.prototype={$G:null,$50:null,$1QU:function(n,t,i){return new _d.$193(this.$G.get_$O(),i,n,t,1,!1,!1,this.$50)},$76e:function(n,t){return new _d.$194(this.$G.get_$O(),3,n,t,1,!1,!1,this.$50)}};_d.$jz=function(n,t,i,r){if(n==="Mouse"&&t){var u=this;i.$ps.add_$1Z(function(n,t){if(!t.$3R)for(var i=0;i<t.$2t.length;i++){var u=t.$2t[i];r.$8iD(u)}})}};_d.$kE=function(n){n.$y(new _h.$f5(!0))};_d.$nG=function(n){var t=new _c.$Mx;n.$y(t)};_d.$nj=function(){var n=_c.$14.$bV();n.$Oq=_c.$14.$qp(0,220);n.$NR(null)};_d.$BB=function(){this.$$d_$53v=Function.createDelegate(this,this.$53v);this.$$d_$142=Function.createDelegate(this,this.$142);this.$$d_$78O=Function.createDelegate(this,this.$78O);this.$$d_$78z=Function.createDelegate(this,this.$78z);_d.$BB.initializeBase(this);this.$1r=new _y.$4p;this.$2N7=new _js.$X;this.$2N7.$H(new _a.$2E(new _C(this.$$d_$78z,_d.$BB.$D),_u.Strings.l_TaskDeleteOneOccurrence_Text));this.$2N7.$H(new _a.$2E(new _C(this.$$d_$78O,_d.$BB.$D),_u.Strings.l_TaskDeleteAllOccurrences_Text));this.$2N7.$H(new _a.$2E(new _C(this.$$d_$142,_d.$BB.$D),_u.Strings.l_ConfirmDialog_Cancel_Text))};function $6Sg(n,t){for(var i=0;i<t.get_$F();i++){var r=t.get_$48(i);if(_g.$9G.isInstanceOfType(r)&&r.get_$2lR())return!0}return!1}function $6Sh(n,t){var i="";t===2?i=_u.Strings.l_PontTypeDeleteFlaggedMessage_Text:t===4?i=_u.Strings.l_PontTypeDeleteFlaggedContacts_Text:t===8&&(i=_u.Strings.l_PontTypeDeleteFlaggedItems_Text);n.$5pD=t;n.$1r.$3A(2,i,n.$$d_$53v,!0,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_u.Strings.l_Warning_Text)}function $4Pq(n){while(n.$1EC<n.$1Ux.get_$F()){var t=n.$1Ux.get_$48(n.$1EC);if(_g.$9G.isInstanceOfType(t)&&t.get_$Uk()){n.set_$8pB(String.format(_u.Strings.l_TaskDeleteRecurringPrompt_Text,t.get_$2h()));n.set_$33i(!0);return}Array.add(n.$23S,t.get_$i());n.$1EC++}n.$23S.length>0&&$4Pp(n,n.$23S,0,!n.$2Qb.length);n.$2Qb.length>0&&$4Pp(n,n.$2Qb,1,!0);n.$1EC=0}function $4Po(n,t){var i=n.$1Ux.get_$48(n.$1EC);Array.add(t,i.get_$i());n.set_$33i(!1);n.$1EC++;$4Pq(n)}function $4Pp(n,t,i,r){var u=new _h.$J7(t,"MoveToDeletedItems",0);u.$3Ku=i;u.$Ew=n.$2i;u.$1R0=1;if(r){var f=this;u.add_$2m(function(t){$8(n.$3UL)||n.$3UL()})}OwaApplication.$1T.$y(u);r&&($8(n.$3UM)||n.$3UM())}_d.$BB.prototype={$33j:null,$2N7:null,$33h:!1,$1r:null,$2i:null,$1Ux:null,$23S:null,$2Qb:null,$1EC:0,$3UM:null,$3UL:null,$5pD:0,get_$33i:function(){return this.$33h},set_$33i:function(n){if(this.$33h!==n){this.$33h=n;$6(this,"RecurrenceDeletionDialogIsShow")}return n},get_$8pB:function(){return this.$33j},set_$8pB:function(n){if(this.$33j!==n){this.$33j=n;$6(this,"RecurrenceDialogMessage")}return n},$GX:function(n,t,i,r){if(!this.$1EC){if($6Sg(this,n)){_a.$6R.$3A(_u.Strings.l_AssignedTaskInformation_Text,1);return}this.$1Ux=n;this.$2i=t;this.$3UM=i;this.$3UL=r;var e=n.get_$F();if(e){var u=0;if(n.get_$F()===1){var o=n.get_$48(0);_c.$i.isInstanceOfType(o)?u=4:_g.$9G.isInstanceOfType(o)||(u=2)}else for(var f=0;f<e;f++){var s=n.get_$48(f);_g.$9G.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.$S.get_$L().get_$1t().get_$10A())===u){$6Sh(this,u);return}this.$53v(!0,!1)}}},$53v:function(n,t){if(t){var i;(i=_g.$S.get_$L().get_$1t()).set_$10A(i.get_$10A()&~this.$5pD);_h.$2x.$H4(_g.$S.get_$L().get_$1t().$PB,OwaApplication.$1T)}if(n){this.$23S=[];this.$2Qb=[];this.$1EC=0;$4Pq(this)}},$78z:function(){$4Po(this,this.$2Qb)},$78O:function(){$4Po(this,this.$23S)},$142:function(){this.set_$33i(!1)}};_d.$MF=function(n){this.$$d_$1ui=Function.createDelegate(this,this.$1ui);_d.$MF.initializeBase(this);this.set_$Cu(this);this.set_$16U(!0);this.$II=new _d.$oW(n,!0);this.$II.$3v();this.$II.$a("SelectedTreeNode",this.$$d_$1ui)};function $6Sj(n){n.$w3||(n.$w3=new _a.$2E(n.$4a,_u.Strings.l_CancelButtonLabel_LowerCase_Text));return n.$w3}function $6Si(n,t,i){n.$22l?n.$22l.$Jv!==t&&n.$22l.set_$Bs(t):n.$22l=new _a.$2E(t,i);return n.$22l}_d.$MF.prototype={$II:null,$4AM:null,$22l:null,$w3:null,get_$251:function(){return this.$II.get_$1xf()?this.$4AM?!_g.$1v.$4F(this.$4AM,this.$II.get_$1xf().get_$n())&&this.$II.get_$1xf().get_$9H()!=="todosearch":!1:!1},$d1:function(n,t,i,r){var u=this,f=this;var e=new _C(function(){n.$s();u.set_$1X(!1)},_d.$MF.$D,this,"CanExecuteAction",function(){return f.get_$251()});this.set_$OO(new _js.$X);this.$6g.$H($6Si(this,e,i));this.$6g.$H($6Sj(this));this.set_$5N(t);this.$4AM=r;$6(this,"CanExecuteAction");this.$II.$3v();this.set_$1X(!0)},$1ui:function(n,t){$6(this,"CanExecuteAction")}};_d.$18G=function(n){_d.$18G.initializeBase(this,[n])};_d.$18G.prototype={get_$2DG:function(){return!0},get_$62f:function(){return!1}};_d.$No=function(n){_d.$No.initializeBase(this);_a.$3.$M(n,"parentTaskFolderPicker");this.$V=new _js.$X;this.$II=n;this.$1r=n.$1r};function $3G0(n,t){n.$1r.$3A(0,t,null,!1,null,null,_u.Strings.l_TaskActionErrorDialogTitle_Text)}_d.$No.prototype={$dr:null,$1mO:null,$1in:null,$uB:null,$qn:null,$AL:0,$V:null,$3G:!1,$we:!1,$mQ:!1,$1JW:null,$1r:null,$br:!1,$8W:null,$II:null,$8P:!1,get_$RG:function(){return this.$mQ},set_$RG:function(n){if(n!==this.$mQ){this.$mQ=n;$6(this,"IsEdit")}return n},get_$Ua:function(){return this.$V.get_$F()>0},get_$2X:function(){return this.$3G},set_$2X:function(n){if(this.$3G!==n){this.$3G=n;$6(this,"IsSelected")}return n},get_$lW:function(){return this.$we},set_$lW:function(n){if(n!==this.$we){this.$we=n;$6(this,"DisableSelection")}return n},get_$Bb:function(){return this.$AL},set_$Bb:function(n){if(n!==this.$AL){this.$AL=n;$6(this,"TreeNodeMode")}return n},get_$1u5:function(){return this.$1JW},set_$1u5:function(n){if(n!==this.$1JW){this.$1JW=n;$6(this,"NewNodeViewModel")}return n},get_$1E2:function(){return this.$qn},set_$1E2:function(n){if(n!==this.$qn){this.$qn=n;$6(this,"CreateCommand")}return n},get_$1L8:function(){return this.$uB},set_$1L8:function(n){if(n!==this.$uB){this.$uB=n;$6(this,"RenameCommand")}return n},get_$79I:function(){return this.$1in},set_$79I:function(n){if(n!==this.$1in){this.$1in=n;$6(this,"DeleteTaskFolderPromptCommand")}return n},get_$7Vp:function(){return this.$1mO},set_$7Vp:function(n){if(n!==this.$1mO){this.$1mO=n;$6(this,"InitiateRenameTaskFolderCommand")}return n},get_$2Zt:function(){return this.$dr},set_$2Zt:function(n){if(n!==this.$dr){this.$dr=n;$6(this,"CancelRenameCommand")}return n},get_$Gi:function(){return this.$8P},set_$Gi:function(n){if(n!==this.$8P){this.$8P=n;$6(this,"IsCollapsed")}return n}};_d.$oW=function(n,t){this.$$d_$5l2=Function.createDelegate(this,this.$5l2);_d.$oW.initializeBase(this);this.$51=t;this.$1r=new _y.$4p;this.$P8=n;this.$P8.add_$2ZS(this.$$d_$5l2);this.$3v()};_d.$oW.prototype={$1r:null,$51:!1,$3Tv:null,$Bn:null,$QR:null,$8wX:null,$P8:null,get_$gW:function(){return this.$Bn},set_$gW:function(n){if(this.$Bn!==n){this.$Bn=n;$6(this,"SelectedTreeNode")}return n},get_$1xf:function(){if(!this.$Bn||!this.$P8.$X8)return null;var n=this.$Bn;return this.$P8.$52T(n.$1Mh.get_$125())},get_$2Nx:function(){return this.$QR},set_$2Nx:function(n){if(n!==this.$QR){this.$QR=n;$6(this,"RootTreeNode")}return n},$3v:function(){this.$P8.$X8&&this.$5l2(this.$P8)},$5l2:function(n){for(var r=null,h=n.$23X,u=new _d.$18G(this),t,i,f,e,o=0;o<h.get_$F();o++){t=h.get_$48(o);if(!$8(t)){i=new _d.$Pb(t,this);if(!$8(t.get_$1B6())){for(var s=0;s<t.get_$1B6().get_$F();s++){e=t.get_$1B6().get_$48(s);f=new _d.$GO(e,i,this);e.get_$1zi()===1&&(r=f);i.$V.$H(f)}u.$V.$H(i)}}}if(!u.$V.get_$F())throw Error.invalidOperation("Unable to get task folders");if($8(r))throw Error.argumentNull("Couldn't get default task folder");this.set_$2Nx(u);this.$3Tv=r;this.$3Tv.set_$2X(!0)}};_d.$GO=function(n,t,i){this.$$d_$79G=Function.createDelegate(this,this.$79G);this.$$d_$79F=Function.createDelegate(this,this.$79F);this.$$d_$8rV=Function.createDelegate(this,this.$8rV);this.$$d_$8rU=Function.createDelegate(this,this.$8rU);this.$$d_$6wP=Function.createDelegate(this,this.$6wP);this.$$d_$44O=Function.createDelegate(this,this.$44O);this.$$d_$3UK=Function.createDelegate(this,this.$3UK);this.$$d_$79H=Function.createDelegate(this,this.$79H);this.$$d_$7Vo=Function.createDelegate(this,this.$7Vo);_d.$GO.initializeBase(this,[i]);this.$1Mh=n;this.$Fb=t;this.$Ge=n.get_$JM();this.set_$Bb(1);this.set_$7Vp(new _C(this.$$d_$7Vo,_d.$GO.$D));this.set_$79I(new _C(this.$$d_$79H,_d.$GO.$D));this.$4s2=new _C(this.$$d_$3UK,_d.$GO.$D);if(n.get_$1zi()){this.$1mO.set_$5P(!1);this.$1in.set_$5P(!1)}this.set_$1L8(new _C(this.$$d_$44O,_d.$GO.$D));this.set_$2Zt(new _C(this.$$d_$6wP,_d.$GO.$D));this.$II.$51||(this.$8W=new _0365m.$2c([new _0365m.$n(_u.Strings.l_Rename_LowerCase_Text,null,this.$1mO),new _0365m.$n(_u.Strings.l_Delete_LowerCase_Text,null,this.$1in)]))};_d.$GO.prototype={$uC:null,$1im:null,$4s2:null,$27J:0,$1Mh:null,$Ge:null,$Fb:null,$6BI:!1,get_$JM:function(){return this.$Ge},set_$JM:function(n){if(n!==this.$Ge){this.$Ge=n;$6(this,"FolderName")}return n},get_$2DG:function(){return!1},get_$62f:function(){return!1},$7Vo:function(){if(!this.$br){this.set_$1u5(this);this.set_$RG(!0);this.set_$Bb(4)}},$6wP:function(){this.set_$RG(!1);this.set_$JM(this.$1Mh.get_$JM());this.set_$Bb(1)},$44O:function(){if(_js.$8.$14(this.$Ge)){this.set_$JM(this.$1Mh.get_$JM());this.set_$RG(!1);return}if(this.$Ge.trim()===this.$1Mh.get_$JM()){this.set_$RG(!1);return}if(!$8(this.$uC)){this.$uC.remove_$20(this.$$d_$8rU);this.$uC.remove_$2A(this.$$d_$8rV);this.$uC=null}var n=this.$uC=new _c.$15f(this.$1Mh,this.$Ge,this.$II.$P8);n.add_$20(this.$$d_$8rU);n.add_$2A(this.$$d_$8rV);this.$br=!0;OwaApplication.$1T.$y(n);this.set_$RG(!1)},$8rV:function(n){this.$br=!1},$8rU:function(n){this.$br=!1;this.set_$JM(this.$1Mh.get_$JM());$3G0(this,this.$uC.$1b.message)},$79H:function(){var n=this;this.$1r.$3A(1,String.format(_u.Strings.l_DeleteFolderConfirmation_Text,this.$Ge),function(t,i){t&&n.$4s2.$s()},!1,null,null,_u.Strings.l_DeleteFolderDialogTitle_Text)},$3UK:function(){if(!this.$br){if(!$8(this.$1im)){this.$1im.remove_$20(this.$$d_$79F);this.$1im.remove_$2A(this.$$d_$79G);this.$1im=null}var n=this.$1im=new _c.$yN(this.$1Mh,this.$Fb.$BN,this.$II.$P8);n.add_$20(this.$$d_$79F);n.add_$2A(this.$$d_$79G);this.$br=!0;this.$Fb.$br=!0;OwaApplication.$1T.$y(n);this.$6BI=this.$3G;this.set_$2X(!1);this.$27J=this.$Fb.$V.$7h(this);this.$27J>=0&&this.$Fb.$V.$67(this.$27J)}},$79G:function(n){this.$Fb.$br=!1;this.$br=!1;this.$6BI&&this.$II.$3Tv.set_$2X(!0)},$79F:function(n){this.$27J>=0&&this.$Fb.$V.$6z(this.$27J,this);this.$Fb.$br=!1;this.$br=!1;$3G0(this,this.$1im.$1b.message)}};_d.$Pb=function(n,t){this.$$d_$76U=Function.createDelegate(this,this.$76U);this.$$d_$76V=Function.createDelegate(this,this.$76V);this.$$d_$7Vd=Function.createDelegate(this,this.$7Vd);this.$$d_$3SG=Function.createDelegate(this,this.$3SG);_d.$Pb.initializeBase(this,[t]);this.$BN=n;this.$UY=n.get_$Ph();this.set_$1E2(new _C(this.$$d_$3SG,_d.$Pb.$D));var i=new _C(this.$$d_$7Vd,_d.$Pb.$D);this.set_$lW(!0);this.set_$Bb(1);if(!this.$II.$51){this.$8Pj=new _0365m.$n(null,_d.$4.get_$4dg(),i);this.$8W=new _0365m.$2c([new _0365m.$n(_u.Strings.l_CreateNewFolder_LowerCase_Text,null,i)])}};_d.$Pb.prototype={$BN:null,$8Pj:null,$1Ja:null,$qq:null,$UY:null,get_$2DG:function(){return!0},get_$62f:function(){return!0},$7Vd:function(){if(!this.$br){if(!$8(this.$qq)){this.$qq.remove_$2A(this.$$d_$76V);this.$qq.remove_$20(this.$$d_$76U);this.$qq=null}this.$qq=new _c.$xz(this.$BN,this.$II.$P8);this.$qq.add_$2A(this.$$d_$76V);this.$qq.add_$20(this.$$d_$76U);var n=new _d.$GO(this.$qq.$1JZ,this,this.$II);n.set_$RG(!0);n.set_$lW(!0);this.set_$1u5(this.$1Ja=n);this.set_$Bb(3)}},$3SG:function(){if(!_js.$8.$14(this.$1Ja.$Ge)){this.$1Ja.set_$RG(!1);this.$1Ja.set_$Bb(2);this.$qq.$8z6(this.$1Ja.$Ge);this.$br=!0;OwaApplication.$1T.$y(this.$qq);this.$V.$H(this.$1Ja)}},$76U:function(n){this.$V.$3Q(this.$1Ja);this.$br=!1;$3G0(this,this.$qq.get_$bO())},$76V:function(n){this.$1Ja.set_$Bb(1);this.$br=!1}};_d.$18J=function(n,t){_d.$18J.initializeBase(this,[n,t])};_d.$ST=function(n,t,i,r,u,f,e){this.$$d_$8Z4=Function.createDelegate(this,this.$8Z4);this.$$d_$8WY=Function.createDelegate(this,this.$8WY);this.$$d_$7hY=Function.createDelegate(this,this.$7hY);_d.$ST.initializeBase(this,[n,t,i,r,u,f,e]);this.$3m2=new _C(this.$$d_$7hY,_d.$ST.$D);this.$1cL=new _d.$BB};_d.$ST.prototype={$3m2:null,$43u:null,$1cL:null,$3Zz:function(n,t){if((n&1)==1)throw Error.notImplemented();var f=new _c.$18I(this.$Gf(),this.$5d,this.$SZ);var i=_h.$13.$7N6(_c.$dh,f);var r=i.$1p.get_$F();r||(r=25);var u=new _h.$85(0,25);u.$1pU=1;i.$NR(u);return i},$74P:function(n){this.set_$DG(!0);var t=new _y.$RO(!1);var i=new _y.$IQ;switch(this.$SZ.$AJ){case"TaskStartDate":var r=this;return new(_y.$Bo.$$(_a.$8f))(t,function(n){if(_g.$9G.isInstanceOfType(n)&&n.get_$7p())return n.get_$7p();else if(n.get_$6K())return n.get_$6K().get_$7p();return null},n);case"TaskDueDate":var u=this;return new(_y.$Bo.$$(_a.$8f))(t,function(n){if(_g.$9G.isInstanceOfType(n)&&n.get_$Cw())return n.get_$Cw();else if(n.get_$6K())return n.get_$6K().get_$Cw();return null},n);case"ItemClass":var f=this,e=this;return new(_y.$AJ.$$(_g.$w))(i,function(n){return n.get_$7G()},function(n){return $8(n)?"":n.startsWith("IPM.Note")?_u.Strings.l_ItemClassMessage_Text:n.startsWith("IPM.Task")?_u.Strings.l_ItemClassTask_Text:_u.Strings.l_ItemClassOther_Text},_u.Strings.l_EmptyGroupHeader_Text);case"TaskStatus":var o=this,s=this;return new(_y.$AJ.$$(_a.$8f))(i,function(n){if(_g.$9G.isInstanceOfType(n))return n.get_$A3();else if(n.get_$6K())return n.get_$6K().get_$Hg()?"Completed":"NotStarted";return null},function(n){var t=new _d.$ih;return t.$39(n,!1)},_u.Strings.l_EmptyGroupHeader_Text);default:return _lv.$4l.prototype.$74P.call(this,n)}},$GX:function(n){var i=$pn(this,$vK(this));var t=this;this.$1cL.$GX(this.$3U,this.$Gf(),function(){$YB(t,null);$YB(t,i);$kW(t)},null)},$58B:function(){if(!$8(this.$Kh)){if(!_g.$1v.$4F(this.$1w.get_$n(),this.$Kh)){var n=$vK(this);if(n&&n.length>0){var t=$pn(this,n);var i=new _h.$KX(n,this.$Kh,0);$YB(this,null);$YB(this,t);OwaApplication.$1T.$y(i)}}$kW(this)}},$4De:function(){if(this.$13)if(_g.$9G.isInstanceOfType(this.$13)){var n=this.$13;var t=n.get_$A3()==="Completed"?"Today":"MarkComplete";this.$ow(t)}else _lv.$4l.prototype.$4De.call(this)},$ow:function(n){if(this.$3U){var o=this.get_$7D();if(!o)return;for(var r=[],u=[],f=0;f<o;f++){var t=this.$3U.get_$48(f);if(_g.$9G.isInstanceOfType(t)){if(t.get_$2lR()){_a.$6R.$3A(_u.Strings.l_AssignedTaskInformation_Text,1);return}Array.add(r,t)}else Array.add(u,t)}if(r.length>0){var i=new _c.$Yo(n,this.$Gf());i.set_$3T(r);this.$hx=i;i.add_$2m(this.$$d_$8WY);OwaApplication.$1T.$y(i)}if(u.length){var e=new _h.$Tn(n,this.$Gf());e.set_$3T(u);this.$hx=e;OwaApplication.$1T.$y(e);$1C5(this)}else $1C5(this)}},$7OG:function(){return"Sort by"},$7VC:function(){this.$Aj=new _0365m.$2c([new _0365m.$n(_u.Strings.l_Move_LowerCase_Text,null,this.$167),this.$Lc.$1QT()]);this.$Aj.$a("IsShown",this.$$d_$8Z4)},$56y:function(){_lv.$d.prototype.$56y.call(this);var n=this;this.$Wi.$a("IsShown",function(t,i){if(n.$Wi.$2R&&n.$13){var r=n.$Wi.$1B.get_$48(n.$Wi.$1B.get_$F()-1);r.set_$15(_g.$9G.isInstanceOfType(n.$13))}})},$69K:function(){this.set_$1gv(!0)},$8Z4:function(n,t){if(this.$Aj.$2R){var i=this.$Aj.$1B.get_$48(0);_g.$1v.$4F(this.$Gf(),_g.$2Q.$9K("todosearch").get_$n())?i.set_$15(!0):i.set_$15(!1);this.$Lc.$1hR(this.$7Nv(),this.get_$7D())}},$7hY:function(){this.$3U&&this.$ow("MarkComplete")},$8WY:function(n){$8(this.$43u)||this.$43u.get_$N5()()}};_d.$oY=function(n,t,i,r,u,f,e){this.$G=n;this.$3K=t;this.$t=i;this.$S=r;this.$30=u;this.$AF=f;this.$6W=e};_d.$oY.prototype={$G:null,$3K:null,$t:null,$S:null,$AF:null,$30:null,$6W:null,$76W:function(){return new _d.$ST(this.$G,this.$3K,this.$t,this.$S,this.$30,this.$AF,this.$6W)}};_d.$MG=function(n,t){_d.$MG.initializeBase(this);this.set_$3m(!1);this.$P8=t};_d.$MG.prototype={$74:0,$2W:!1,$x8:null,$II:null,$P8:null,get_$3YG:function(){return this.$2W?_u.Strings.l_CollapseFolderPane_AT_Text:_u.Strings.l_ExpandFolderPane_AT_Text},get_$3m:function(){return this.$2W},set_$3m:function(n){if(this.$2W!==n){this.$2W=n;$4Z(this,"IsExpanded","FolderPaneExpandCollapseButtonLabel")}this.set_$Tu(this.$2W?_d.$MG.$3Au:_d.$MG.$3At);return n},get_$Tu:function(){return this.$74},set_$Tu:function(n){if(this.$74!==n){this.$74=n;$6(this,"Width")}return n},$3v:function(){this.$II=new _d.$oW(this.$P8,!1);this.$II.$3v()}};_d.$18O=function(){_d.$18O.initializeBase(this,[!1])};_d.$18O.prototype={$26J:function(){var n=this.$H8.$65j;return new _h.$BA(n,this.$bE)},$73Z:function(){this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_TaskDueDate_Text,_u.Strings.l_SortBy_TaskDueDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",11,"TaskDueDate",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_TaskStartDate_Text,_u.Strings.l_SortBy_TaskStartDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",10,"TaskStartDate",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_TaskStatus_Text,_u.Strings.l_SortBy_TaskStatus_UpperCase_Text,_u.Strings.l_NotStartedOnTop_Text,_u.Strings.l_NotStartedOnBottom_Text,"Ascending",12,"TaskStatus",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_Subject_Text,_u.Strings.l_SortBy_Subject_UpperCase_Text,_u.Strings.l_AOnTop_Text,_u.Strings.l_ZOnTop_Text,"Ascending",8,"Subject",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_Attachments_Text,_u.Strings.l_SortBy_Attachments_UpperCase_Text,_u.Strings.l_WithOnTop_Text,_u.Strings.l_WithoutOnTop_Text,"Descending",4,"HasAttachments",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_Importance_Text,_u.Strings.l_SortBy_Importance_UpperCase_Text,_u.Strings.l_HighOnTop_Text,_u.Strings.l_LowOnTop_Text,"Descending",5,"Importance",!0));this.$BF.$H(new _d.$Pc(_u.Strings.l_SortBy_Type_Text,_u.Strings.l_SortBy_Type_UpperCase_Text,_u.Strings.l_MessagesOnTop_Text,_u.Strings.l_MessagesOnBottom_Text,"Ascending",6,"ItemClass",!0))}};_d.$Pc=function(n,t,i,r,u,f,e,o){_d.$Pc.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.$65j=e};_d.$Pc.prototype={$65j:"FolderId"};_d.$8T=function(){_d.$8T.initializeBase(this)};_d.$8T.prototype={get_$bg:function(){return this.$W(_d.$8T.$3gB)},set_$bg:function(n){this.$N(_d.$8T.$3gB,n);return n},get_$s9:function(){return this.$W(_d.$8T.$3hi)},set_$s9:function(n){this.$N(_d.$8T.$3hi,n);return n},get_$4u6:function(){return this.$W(_d.$8T.$3Vm)},set_$4u6:function(n){this.$N(_d.$8T.$3Vm,n);return n},get_$aS:function(){return this.$W(_d.$8T.$4Cf)},set_$aS:function(n){this.$N(_d.$8T.$4Cf,n);return n},get_$CK:function(){return this.$W(_d.$8T.$1n9)},set_$CK:function(n){this.$N(_d.$8T.$1n9,n);return n},get_$1tl:function(){return this.get_$s9()?null:[this.get_$aS()]}};_d.$4n=function(n,t){this.$$d_$5kG=Function.createDelegate(this,this.$5kG);this.$$d_$5ia=Function.createDelegate(this,this.$5ia);this.$$d_$8hW=Function.createDelegate(this,this.$8hW);this.$$d_$13y=Function.createDelegate(this,this.$13y);this.$$d_$8Vf=Function.createDelegate(this,this.$8Vf);this.$$d_$8Uq=Function.createDelegate(this,this.$8Uq);this.$$d_$7Oe=Function.createDelegate(this,this.$7Oe);this.$$d_$8Ue=Function.createDelegate(this,this.$8Ue);this.$$d_$Xj=Function.createDelegate(this,this.$Xj);this.$$d_$4mY=Function.createDelegate(this,this.$4mY);this.$$d_$25T=Function.createDelegate(this,this.$25T);this.$$d_$79E=Function.createDelegate(this,this.$79E);this.$$d_$7hS=Function.createDelegate(this,this.$7hS);this.$$d_$6pj=Function.createDelegate(this,this.$6pj);this.$$d_$8lO=Function.createDelegate(this,this.$8lO);this.$$d_$6yV=Function.createDelegate(this,this.$6yV);this.$$d_$45v=Function.createDelegate(this,this.$45v);this.$$d_$7By=Function.createDelegate(this,this.$7By);_d.$4n.initializeBase(this);this.$S=n||null;this.$DD=t;this.$Wf=new _C(this.$$d_$7By,_d.$4n.$D);this.$DS=new _C(this.$$d_$45v,_d.$4n.$D);this.$4a=new _C(this.$$d_$6yV,_d.$4n.$D);this.$1vq=new _C(this.$$d_$8lO,_d.$4n.$D);this.$dh=new _C(this.$$d_$6pj,_d.$4n.$D);this.$3m3=new _C(this.$$d_$7hS,_d.$4n.$D);this.$IX=new _C(this.$$d_$79E,_d.$4n.$D);this.$du=new _C(this.$$d_$25T,_d.$4n.$D);this.$1r=new _y.$4p;this.$1cL=new _d.$BB;this.get_$16a()&&$4Pr(this);_y.$j.$g.add_$U5(this.$$d_$4mY);_y.$j.$g.add_$Nm(this.$$d_$Xj)};function $6Sl(n){var t={};if(n.$FD.get_$5p()&&n.$FD.get_$5p().get_$F()>0){var i=n.$FD.get_$5p().$7V();t["Tasks reading pane item categories"]=i}return t}function $4Ps(n){n.set_$9N(!1);n.set_$bg(!1);n.$mX?$2UQ(n):n.$FD?!n.$FD.get_$18i()&&n.$FD.get_$I3()&&n.$FD.get_$I3().get_$1d()?$2UQ(n):n.$2q7():n.set_$3A3(null)}function $2UQ(n){n.set_$3A3(new _d.$Kv(n.$FD,n.$DD));n.set_$3il(n.$9q.get_$54Z());n.$9q.$a("DueDate",n.$$d_$8Uq);n.$9q.$a("Status",n.$$d_$8Uq);n.$9q.$a("ReminderIsSet",n.$$d_$8Vf);n.$9q.$a("ReminderDueBy",n.$$d_$8Vf);n.$9q.$a("IsPrivate",n.$$d_$8Vf);$6Sn(n);n.$mX?_a.$5.$1G(null,"TasksCompose.New"):_a.$5.$1G(null,"TasksOpen.ItemOpen")}function $6Sm(n){n.$Lc=new _y.$Eb(n.get_$5Ic(),n.$$d_$13y,n.$du,n.$1mM)}function $6Sk(n){var i=n.$9q.get_$5dE();var t=new _c.$fK(i,n.$GH);var r=this;t.add_$2A(function(i){n.set_$3A3(null);n.set_$bg(!1);n.set_$s9(!1);n.set_$C5(!1);n.set_$9N(!0);n.get_$16a()?n.get_$8K()&&n.get_$8K()():$Bc(n,"NewTaskClosed",n,t.$5J)});t.add_$20(n.$$d_$8hW);OwaApplication.$1T.$y(t)}function $6So(n,t){var r=n.$9q.get_$5dE();var i=new _c.$ot(r);var u=this;i.add_$2A(function(i){n.set_$bg(!1);n.set_$C5(!1);n.set_$9N(!0);if(n.get_$16a()){n.$FD&&_h.$13.$9IJ(_g.$9G,Boolean,n.$FD,"NeedsUpdate",n.$FD.get_$18i(),!0,function(n,t){n.set_$18i(t)});n.get_$8K()&&n.get_$8K()()}else if(t){var r=n.$9q?n.$9q.$IH.get_$i():null;$Bc(n,"NewTaskClosed",n,r)}else n.$2q7()});i.add_$20(n.$$d_$8hW);OwaApplication.$1T.$y(i)}function $2UP(n,t){n.set_$bg(!1);if(n.$9q&&n.$9q.$Z9&&!t){var i=new _js.$X;i.$H(n.$9q.$IH);n.$1cL.$GX(i,null,null,null)}if(n.$mX){n.set_$3A3(null);$Bc(n,"NewTaskClosed",n,null)}else $2UQ(n);n.set_$s9(!1);n.get_$16a()&&n.get_$8K()&&n.get_$8K()()}function $4Pr(n){$6Sm(n);n.$2N0=new _0365m.$2c([new _0365m.$n(_u.Strings.l_Delete_LowerCase_Text,null,n.$IX),n.$Lc.$1QT()]);n.get_$16a()||n.$2N0.$1B.$H(new _0365m.$n(_u.Strings.l_OpenInSeparateWindowMenuItem_LowerCase_Text,null,n.$1vq));n.$2ey=new _0365m.$2c([new _0365m.$n(_u.Strings.l_Delete_LowerCase_Text,null,n.$IX),n.$Lc.$1QT(),new _0365m.$n(_u.Strings.l_TaskFormMarkCompleteButton_LowerCase_Text,null,n.$3m3)]);n.$2N0.$a("IsShown",n.$$d_$5ia);n.$2ey.$a("IsShown",n.$$d_$5ia)}function $6Sn(n){n.set_$3Q9(new _d.$40(n.$9q.$AH,_g.$S.get_$L().get_$1t().get_$Tv(),new _y.$4p,_y.$j.$g));n.$Ct.$a("RecurrenceSelected",n.$$d_$5kG);n.$Ct.set_$1X(!1)}_d.$4n.prototype={$S:null,$R7:null,$mX:!1,$Pk:!1,$9q:null,$FD:null,$Po:!1,$OU:!1,$11Z:!1,$2E8:!1,$Wf:null,$DS:null,$4a:null,$1vq:null,$dh:null,$3m3:null,$IX:null,$du:null,$1mM:null,$1MW:null,$1w4:null,$1RT:null,$1r:null,$HB:null,$Gg:null,$2AM:null,$mR:!1,$2N0:null,$2ey:null,$Ct:null,$1cL:null,$6B0:null,$GH:null,$2D2:!1,$2mx:!1,$Cf:!1,$Lc:null,$DD:null,add_$8Pi:function(n){this.$2Z("NewTaskClosed",n)},remove_$8Pi:function(n){this.$2b("NewTaskClosed",n)},add_$98t:function(n){this.$2Z("TaskDelete",n)},remove_$98t:function(n){this.$2b("TaskDelete",n)},get_$5Ic:function(){return _g.$S.get_$L().get_$GB()},get_$2Bo:function(){return this.$9q?this.$9q.$z:null},get_$C5:function(){return this.$Cf},set_$C5:function(n){if(this.$Cf!==n){this.$Cf=n;$6(this,"IsSaving")}return n},get_$9N:function(){return this.$Po},set_$9N:function(n){if(this.$Po!==n){this.$Po=n;$6(this,"Loading")}return n},get_$bg:function(){return this.$OU},set_$bg:function(n){if(this.$OU!==n){this.$OU=n;$6(this,"IsEditMode");this.$Gg&&this.$Gg.$s();if(this.$OU){this.$Pk&&this.$Xj();this.$9q&&(this.$6B0=new _a.$hb(this.$9q))}}return n},get_$s9:function(){return this.$mX},set_$s9:function(n){if(this.$mX!==n){this.$mX=n;$6(this,"IsNewTask");if(this.$mX){this.$FD=null;$4Ps(this);this.set_$bg(!0)}}return n},get_$3il:function(){return this.$2E8},set_$3il:function(n){if(this.$2E8!==n){this.$2E8=n;$6(this,"IsShowDetails");this.$Xj()}return n},get_$26j:function(){return this.$FD},set_$26j:function(n){if(this.$FD!==n){_a.$5.$1V(_d.$4n.$D,"TasksOpen.ItemOpen");this.$FD&&this.$FD.remove_$1YR(this.$$d_$8Ue);this.$FD=n;$6(this,"CurrentTask");this.$FD&&this.$FD.add_$1YR(this.$$d_$8Ue);this.set_$s9(!1);$4Ps(this)}return n},get_$3A3:function(){return this.$9q},set_$3A3:function(n){if(this.$9q!==n){this.$9q=n;$6(this,"TaskViewModel");$6(this,"IsReadOnly")}return n},get_$2m5:function(){return this.$mR},set_$2m5:function(n){if(this.$mR!==n){this.$mR=n;$6(this,"IsEditorInitialized")}return n},get_$96i:function(){if(!this.$1MW){this.$1MW=new _js.$X;this.$1MW.$H("NotStarted");this.$1MW.$H("InProgress");this.$1MW.$H("Completed");this.$1MW.$H("WaitingOnOthers");this.$1MW.$H("Deferred")}return this.$1MW},get_$8n5:function(){if(!this.$1w4){this.$1w4=new _js.$X;this.$1w4.$H("Low");this.$1w4.$H("Normal");this.$1w4.$H("High")}return this.$1w4},get_$7BY:function(){if(!this.$1RT){this.$1RT=new _js.$X;this.$1RT.$H(0);this.$1RT.$H(1);this.$1RT.$H(2);this.$1RT.$H(3)}return this.$1RT},get_$16a:function(){return!_y.$j.$g.get_$6Q()},get_$3g2:function(){return this.$2D2},set_$3g2:function(n){if(this.$2D2!==n){this.$2D2=n;$6(this,"IsDiscoveryMode");$6(this,"IsReadOnly")}return n},get_$7a3:function(){return this.$2mx},set_$7a3:function(n){if(this.$2mx!==n){this.$2mx=n;$6(this,"IsItemAttachment");$6(this,"IsReadOnly")}return n},get_$C4:function(){var n=!1;this.$9q&&this.$9q.$IH&&this.$9q.$IH.get_$2lR()&&(n=!0);return this.$2D2||n||this.$2mx},get_$8K:function(){return this.$R7},set_$8K:function(n){this.$R7=n;return n},get_$7A8:function(){return!1},get_$3Q9:function(){return this.$Ct},set_$3Q9:function(n){if(this.$Ct!==n){this.$Ct=n;$6(this,"ComposeRecurrenceViewModel")}return n},get_$427:function(){return 1},get_$2Ao:function(){return null},get_$5AT:function(){if(this.$OU){this.$Gg&&this.$Gg.$s();return this.$6B0.$7XX()||this.$9q.$1CR.get_$zu()!==this.$9q.$IH.get_$230()||this.$9q.$1My.get_$zu()!==this.$9q.$IH.get_$2Rb()||!_g.$E.$4F(this.$9q.$AH.get_$Nd(),this.$9q.$IH.get_$1L0())||this.$9q.$lg.get_$G7()||this.$9q.$Z9}else return!1},get_$22:function(){return this.$GH},set_$22:function(n){this.$GH=n;return n},$33E:function(n){if(!this.$1r.$2R)if(this.get_$5AT()){var t=this;this.$1r.$3A(2,_u.Strings.l_DiscardTaskEntryMessage_Text,function(i,r){if(i){t.get_$16a()&&(t.$11Z=!0);$2UP(t)}n&&n(i)},!1,_u.Strings.l_Discard_Text,_u.Strings.l_ConfirmDialog_Back_Text,_u.Strings.l_DiscardTaskEntryTitle_Text)}else if(n){this.$OU&&$2UP(this);n(!0)}},$jy:function(n){this.$1mM=n;$4Pr(this)},$2q7:function(){var n=new _c.$CQ(500,[this.$FD.get_$i()],0,this.$2D2);n.add_$2m(this.$$d_$7Oe);this.set_$9N(!0);OwaApplication.$1T.$y(n)},$Fe:function(){_y.$1De.prototype.$Fe.call(this);this.$Pk=!0;this.$mX&&this.$Xj()},$Rx:function(){_y.$1De.prototype.$Rx.call(this);this.$Pk=!1},$8Ue:function(n,t){var i=t;i.$EF!=="NeedsUpdate"||this.$OU||this.$2q7()},$7Oe:function(n){var t=n;if(this.$FD&&t.$CN.length===1&&t.$CN[0].Id===this.$FD.get_$i().Id){var i=_h.$1M.get_$L().$3k(this.$FD.get_$i().Id);this.$FD=i;this.$FD.set_$18i(!1);$2UQ(this);this.set_$9N(!1)}},$8Vf:function(n,t){this.get_$C4()||this.$OU||this.$45v()},$8Uq:function(n,t){this.$9q.$5zS()},$25T:function(){this.$13y(null,null,!0)},$13y:function(n,t,i){var r=_g.$B5.$1d2(this.$FD.get_$5p(),i,t,n);if(r){var u=new _h.$O3([r],null);u.set_$3T([this.$FD]);OwaApplication.$1T.$y(u)}},$7By:function(){this.set_$bg(!0)},$45v:function(){if(this.$9q.get_$AU())if(this.$Cf){_js.Trace.logInfo(_d.$4n.$D,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.set_$C5(!0);else{this.$1r.$3A(0,this.$9q.$kP,null);return}this.$Gg&&this.$Gg.$s();this.$mX&&!this.$9q.$Z9?$6Sk(this):$6So(this,this.$9q.$Z9)},$8hW:function(n){var t=n;if(t&&t.$1b){this.get_$2Bo().$Ff(this.$9q.get_$65h());var i=new _d.$BN(this.$1r);var r=i.$3Zr(t,41,51,63,700,88,89,42);this.get_$2Bo().$2r(r);this.set_$C5(!1)}},$6yV:function(){var n=this;this.$33E(function(t){t&&$2UP(n)})},$8lO:function(){if(this.$9q.$lg.get_$Ik()){this.$1r.$3A(0,_u.Strings.l_TaskValidationAttachmentInProgress_Text,null);return}var t={};this.$mX||(t.ItemID=this.$FD.get_$i());var n=new _d.$8T;n.set_$aS(this.$FD);n.set_$bg(this.$OU);n.set_$s9(this.$mX);if(this.$OU){this.$Gg&&this.$Gg.$s();n.set_$4u6(this.$9q.$8ul());n.set_$CK(this.$9q.$Z9);if(n.get_$CK()){n.set_$s9(!1);n.set_$aS(this.$9q.$IH)}}_y.$j.$g.$L9(_d.$di,null,t,_y.$3p.get_$RN(),n,!1);$2UP(this,!0)},$6pj:function(){this.$9q.$lg.$194(!1,null,null)},$7hS:function(){this.$9q.set_$Hg(_a.$7.get_$2M().$3u());this.$45v()},$5ia:function(n,t){(this.$2N0.$2R||this.$2ey.$2R)&&this.$Lc.$1hR($6Sl(this),1)},$79E:function(){if(!this.get_$C4())if(this.get_$16a()){var n=new _js.$X;n.$H(this.$FD);this.$1cL.$GX(n,this.$FD.get_$22(),null,this.get_$8K())}else $Bc(this,"TaskDelete",this,this.$FD)},$5kG:function(n,t){this.$Ct.$Vd&&!_d.$RA.isInstanceOfType(this.$Ct.$Vd)&&this.$Ct.set_$1X(!0)},$4mY:function(n){if(!this.$11Z&&this.get_$5AT()){n.$1OY(_u.Strings.l_DiscardTaskEntryMessage_Text);!this.get_$16a()&&this.$S&&this.$S.$8oV(_y.$FS,new _y.$FS(3,null))}else this.$11Z=!1},$Xj:function(){this.$2AM&&this.$2AM.$2K&&this.$2AM.$s()}};_d.$v9=function(n,t){this.$S=n;this.$DD=t};_d.$v9.prototype={$S:null,$DD:null,$I:function(){return new _d.$4n(this.$S,this.$DD)}};_d.$di=function(n,t){this.$S=n;this.$DD=t};_d.$di.prototype={$S:null,$DD:null,$ct:function(n){var i=n.ItemID;var t=new _d.$4n(this.$S,this.$DD);if($8(i))t.set_$s9(!0);else{var f=new _g.$1j(i);var r=new _g.$9G;r.set_$i(f);_h.$1M.get_$L().$H0(i,r);t.set_$26j(r)}var u=n.DiscoveryMode;!$8(u)&&Boolean.parse(u)&&t.set_$3g2(!0);return t},$wD:function(n){var i=n;var t=new _d.$4n(this.$S,this.$DD);var r=this;t.$a("TaskViewModel",function(n,r){if(i.get_$bg()&&t.$9q){t.set_$bg(i.get_$bg());t.$9q.$8tB(i.get_$4u6());t.$9q.$Z9=i.get_$CK();t.set_$3il(t.$9q.get_$54Z())}});t.set_$26j(i.get_$aS());t.set_$s9(i.get_$s9());return t}};_d.$Kv=function(n,t){this.$$d_$8dj=Function.createDelegate(this,this.$8dj);this.$$d_$8Vc=Function.createDelegate(this,this.$8Vc);this.$$d_$5kv=Function.createDelegate(this,this.$5kv);this.$$d_$8U3=Function.createDelegate(this,this.$8U3);this.$$d_$8c3=Function.createDelegate(this,this.$8c3);this.$$d_$1Yp=Function.createDelegate(this,this.$1Yp);this.$$d_$10H=Function.createDelegate(this,this.$10H);_d.$Kv.initializeBase(this);this.$IH=n?n:_d.$Kv.$73a();$4Pt(this,this.$IH);this.set_$en(new _y.$8L);this.$5zS();this.$nq=new _a.$hb(this.$IH);var i=this;t.$I(function(n){i.$6I=n.$1hr(i.$IH.get_$i(),i.$IH.get_$1e()?i.$IH.get_$1e().get_$9JV():new _js.$X,!0,!0,null,!0,null,null);i.$lg=n.$1hq(i.$IH.get_$i(),i.$IH.get_$1e()?i.$IH.get_$1e().get_$9JV():new _js.$X,!1,3,!0,null,!0,new _y.$8L,null);i.$lg.add_$10H(i.$$d_$10H)});this.$a("Status",this.$$d_$1Yp);this.$a("PercentComplete",this.$$d_$8c3);this.$a("CompleteDate",this.$$d_$8U3);this.$a("StartDate",this.$$d_$5kv);this.$a("DueDate",this.$$d_$8Vc);this.$a("ReminderIsSet",this.$$d_$8dj)};_d.$Kv.$73a=function(){var n=new _g.$9G;n.set_$6A("Normal");n.set_$3c(new _g.$66(new _g.$67("Text","")));return n};function $4Pt(n,t){n.$Vw=t.get_$2h();n.$De=t.get_$Cw()?t.get_$Cw().$46():null;n.$5f=t.get_$7p()?t.get_$7p().$46():null;n.$Dx=t.get_$A3();n.$1TL=t.get_$6A();n.$IS=t.get_$Hg()?t.get_$Hg().$46():null;n.$Er=t.get_$g4()?t.get_$g4():"0";isNaN(_a.$BQ.$tr(n.$Er))&&(n.$Er="0");n.$1UX=t.get_$7J()==="Private";n.$1L2=t.get_$Nk();n.$cr=t.get_$19x()?t.get_$19x().$46():null;n.$1XZ=t.get_$2JP();n.$1P2=t.get_$24N();var r=t.get_$3c()?t.get_$3c().get_$1d():null;_js.$8.$c(r)&&(r="<html><head></head></html>");n.set_$3c(r);n.set_$Cx("");var u=new Sys.StringBuilder;if(!$8(t.get_$qU()))for(var i=0;i<t.get_$qU().get_$F();i++){u.append(t.get_$qU().get_$48(i));i!==t.get_$qU().get_$F()-1&&u.append(" ")}n.$b9=u.toString();n.$1My=new _d.$eL(t.get_$2Rb());n.$1CR=new _d.$eL(t.get_$230());n.$AH=new _d.$uF(t.$46(),new _g.$18K,_a.$7.get_$2M(),null)}function $4Pu(n,t){t.set_$2h(n.$Vw);t.set_$Cw(n.$De);t.set_$7p(n.$5f);t.set_$A3(n.$Dx);t.set_$6A(n.$1TL);t.set_$Hg(n.$IS);t.set_$g4(n.$Er.toString());t.set_$7J(n.$1UX?"Private":"Normal");t.set_$Nk(n.$1L2);t.set_$19x(n.$cr);t.set_$2JP(n.$1XZ);t.set_$24N(n.$1P2);var i;i="Mouse"!==_y.$j.$g.get_$O()?new _g.$67("Text",n.$3V):new _g.$67("HTML",n.$3V);var u=new _g.$66(i);t.set_$3c(u);var r=new(_a.$U.$$(String));_js.$8.$c(n.$b9)||r.$H(n.$b9);t.set_$qU(r);t.set_$2Rb(n.$1My.get_$zu());t.set_$230(n.$1CR.get_$zu());t.get_$A3()!=="Completed"&&n.$nq.$uI("CompleteDate");if(n.$nq.$bn("CompleteDate")){n.$nq.$uI("Status");n.$nq.$uI("PercentComplete")}t.set_$1L0(n.$AH.get_$Nd())}_d.$Kv.prototype={$Z9:!1,$r8:null,$3V:null,$b9:null,$1P2:null,$1XZ:null,$cr:null,$1L2:!1,$1UX:!1,$Er:null,$IS:null,$1TL:"Low",$Dx:"NotStarted",$5f:null,$De:null,$IH:null,$1My:null,$1CR:null,$Vw:null,$4Cc:null,$z:null,$6I:null,$lg:null,$AH:null,$kP:null,$nq:null,get_$2h:function(){return this.$Vw},set_$2h:function(n){if(this.$Vw!==n){this.$Vw=n;$6(this,"Subject")}return n},get_$en:function(){return this.$z},set_$en:function(n){if(this.$z!==n){this.$z=n;$6(this,"InfoBarViewModel")}return n},get_$Cw:function(){return this.$De},set_$Cw:function(n){if(!_a.$7.$4F(this.$De,n)){this.$De=n;$6(this,"DueDate")}return n},get_$7p:function(){return this.$5f},set_$7p:function(n){if(!_a.$7.$4F(this.$5f,n)){this.$5f=n;$6(this,"StartDate")}return n},get_$A3:function(){return this.$Dx},set_$A3:function(n){if(this.$Dx!==n){this.$Dx=n;$6(this,"Status")}return n},get_$6A:function(){return this.$1TL},set_$6A:function(n){if(this.$1TL!==n){this.$1TL=n;$6(this,"Importance")}return n},get_$Hg:function(){return this.$IS},set_$Hg:function(n){if(!_a.$7.$4F(this.$IS,n)){this.$IS=n;$6(this,"CompleteDate")}return n},get_$g4:function(){return this.$Er},set_$g4:function(n){if(this.$Er!==n){this.$Er=n;$6(this,"PercentComplete")}return n},get_$bm:function(){return this.$1UX},set_$bm:function(n){if(this.$1UX!==n){this.$1UX=n;$6(this,"IsPrivate")}return n},get_$Nk:function(){return this.$1L2},set_$Nk:function(n){if(this.$1L2!==n){this.$1L2=n;$6(this,"ReminderIsSet")}return n},get_$19x:function(){return this.$cr},set_$19x:function(n){if(!_a.$7.$4F(this.$cr,n)){this.$cr=n;$6(this,"ReminderDueBy")}return n},get_$2JP:function(){return this.$1XZ},set_$2JP:function(n){if(this.$1XZ!==n){this.$1XZ=n;$6(this,"Mileage")}return n},get_$24N:function(){return this.$1P2},set_$24N:function(n){if(this.$1P2!==n){this.$1P2=n;$6(this,"BillingInformation")}return n},get_$qU:function(){return this.$b9},set_$qU:function(n){if(this.$b9!==n){this.$b9=n;$6(this,"Companies")}return n},get_$3c:function(){return this.$3V},set_$3c:function(n){if(this.$3V!==n){this.$3V=n;$6(this,"Body")}return n},get_$Cx:function(){return this.$r8},set_$Cx:function(n){if(this.$r8!==n){this.$r8=n;$6(this,"EditorContent")}return n},get_$54Z:function(){return!!this.$5f||this.$Dx!=="NotStarted"||this.$1TL!=="Normal"||!!this.$IS||_a.$BQ.$tr(this.$Er)>0||this.$1UX||this.$1L2||!!this.$cr||this.$1My.get_$zu()>0||this.$1CR.get_$zu()>0||!_js.$8.$c(this.$1XZ)||!_js.$8.$c(this.$1P2)||!_js.$8.$c(this.$b9)||!!this.$AH.get_$Nd()},get_$AU:function(){var t=!0;if(this.$lg.get_$Ik()){this.$kP=_u.Strings.l_TaskValidationAttachmentInProgress_Text;return!1}if(_js.$8.$14(this.$Vw)){this.$kP=_u.Strings.l_TaskValidationEmptySubject_Text;return!1}if(this.$De&&this.$5f&&this.$5f.$2Y(this.$De)>0){this.$kP=_u.Strings.l_TaskValidationEarlyDueDate_Text;return!1}var n=_a.$BQ.$tr(this.$Er);if(isNaN(n)||n<0||n>100){this.$kP=_u.Strings.l_TaskValidationPercentInvalid_Text;return!1}if(isNaN(_a.$BQ.$tr(this.$1My.$kT))||_a.$BQ.$tr(this.$1My.$kT)<0){this.$kP=_u.Strings.l_TaskValidationTotalWorkInvalid_Text;return!1}if(isNaN(_a.$BQ.$tr(this.$1CR.$kT))||_a.$BQ.$tr(this.$1CR.$kT)<0){this.$kP=_u.Strings.l_TaskValidationActualWorkInvalid_Text;return!1}if(this.$1My.get_$zu()>1525252319){this.$kP=_u.Strings.l_TaskValidationMaxTotalWork_Text;return!1}if(this.$1CR.get_$zu()>1525252319){this.$kP=_u.Strings.l_TaskValidationMaxActualWork_Text;return!1}return t},get_$5dE:function(){$4Pu(this,this.$IH);return this.$nq},$8ul:function(){var n=this.$IH.$46();$4Pu(this,n);return n},$8tB:function(n){$4Pt(this,n)},get_$65h:function(){this.$4Cc||(this.$4Cc=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.$4Cc},$5zS:function(){this.$z.$Ff(this.get_$65h());this.$IH.get_$2lR()&&this.$z.$2r(10010);if(this.$Dx==="Completed")this.$z.$2r(10080,this.$IS.$2P(1));else if(this.$De){var t=new _a.$Kb(_a.$7.get_$2M().$3u(),this.$De.$3u()).get_$pM();var n=Math.floor(t);n?n===1?this.$z.$2r(10040):n>1&&n<15?this.$z.$2r(10050,n.toString()):n===-1?this.$z.$2r(10030):n<-1&&n>-15?this.$z.$2r(10070,Math.abs(n).toString()):n<-14&&this.$z.$2r(10060):this.$z.$2r(10020)}},$1Yp:function(n,t){if(this.$Dx==="Completed"){this.$IS||this.set_$Hg(_a.$7.get_$2M().$3u());this.set_$g4("100")}else{this.set_$Hg(null);(this.$Dx==="NotStarted"||_a.$BQ.$tr(this.$Er)===100)&&this.set_$g4("0")}},$8c3:function(n,t){var i=_a.$BQ.$tr(this.$Er);i?i>0&&i<100?this.set_$A3("InProgress"):i===100&&this.set_$A3("Completed"):this.set_$A3("NotStarted")},$8U3:function(n,t){this.$IS?this.set_$A3("Completed"):this.set_$A3("NotStarted")},$5kv:function(n,t){this.$5f&&(!this.$De||this.$De.$2Y(this.$5f)<0)&&this.set_$Cw(this.$5f)},$8Vc:function(n,t){this.$De||this.set_$7p(null)},$8dj:function(n,t){if(this.$1L2&&!this.$cr){var i=_a.$7.get_$2M();this.$De?this.$De.$8c(i)<=0?this.set_$19x(new _a.$7(i.get_$4M(),i.get_$3D(),i.get_$5z(),8,0,0)):this.set_$19x(new _a.$7(this.$De.get_$4M(),this.$De.get_$3D(),this.$De.get_$5z(),8,0,0)):this.set_$19x(new _a.$7(i.get_$4M(),i.get_$3D(),i.get_$5z(),8,0,0).$2q(1))}},$10H:function(){if($8(this.$IH.get_$i())){var i=new _a.$hb(this.$IH);var t=new _c.$fK(i);var n=this;t.add_$2m(function(i){n.$IH.set_$i(t.$5J);n.$Z9=!0;$8(n.$lg)||n.$lg.$1aB(n.$IH.get_$i(),n.$IH.get_$1e()?n.$IH.get_$1e().get_$9JV():new _js.$X,null)});OwaApplication.$1T.$y(t)}else this.$Z9&&($8(this.$lg)||this.$lg.$1aB(this.$IH.get_$i(),this.$IH.get_$1e().get_$9JV(),null))}};_d.$eL=function(n){_d.$eL.initializeBase(this);$6T0(this,n)};function $6T0(n,t){n.$kT=t.toString();n.$12l=0;if(t){if(t>0){for(var r=[1,60,480,2400],f=[10,4],i=0;i<r.length-1&&t>=r[i+1];)i++;while(i>0){for(var u=0;u<f.length;u++)for(var e=1;e<=f[u];e++)if(!(t%(r[i]*e/f[u]))){n.$kT=(t/r[i]).toString();n.$12l=i;return}i--}}}else n.$12l=1}_d.$eL.prototype={$12l:0,$kT:null,get_$9HC:function(){return this.$kT},set_$9HC:function(n){if(this.$kT!==n){this.$kT=n;$Q(this,"WorkAmount")}return n},get_$9HF:function(){return this.$12l},set_$9HF:function(n){if(this.$12l!==n){this.$12l=n;$Q(this,"WorkUnit")}return n},get_$zu:function(){var n=_a.$BQ.$tr(this.$kT);switch(this.$12l){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.$qr;var t=_a.$BQ.$tr(this.$kT)===1?n.$39(this.$12l,1):n.$39(this.$12l,2);return String.format(_u.Strings.l_WorkUnitFormatString_Text,this.$kT,t)},$4W:function(n){if(!n||!_d.$eL.isInstanceOfType(n))return!1;var t=n;return this.get_$zu()===t.get_$zu()}};_d.$4A=function(n){this.$$d_$7A6=Function.createDelegate(this,this.$7A6);this.$$d_$wi=Function.createDelegate(this,this.$wi);this.$$d_$4dO=Function.createDelegate(this,this.$4dO);this.$$d_$8lA=Function.createDelegate(this,this.$8lA);this.$$d_$8cg=Function.createDelegate(this,this.$8cg);this.$$d_$5p2=Function.createDelegate(this,this.$5p2);this.$$d_$2MD=Function.createDelegate(this,this.$2MD);_d.$4A.initializeBase(this);this.$P=n;this.set_$5p0(new _C(this.$$d_$2MD,_d.$4A.$D));this.set_$5p3(new _C(this.$$d_$5p2,_d.$4A.$D));this.set_$5oz(new _C(this.$$d_$8cg,_d.$4A.$D));this.$1r=new _y.$4p;this.set_$2do(_g.$S.get_$L().get_$38().get_$5p1());$3Fj(this)};function $6R3(n,t){switch(t){case"Idle":case"Disconnected":return"";case"Connecting":return _u.Strings.l_PlayOnPhoneDialing_Text;case"Connected":return _u.Strings.l_PlayOnPhoneConnected_Text;default:throw Error.invalidOperation("Invalid Call State.");}}function $3Fj(n){if(!$8(n.$1ZV)){n.$9Ch();n.$1ZV=""}n.set_$2Zy(!0);n.set_$1qE("");n.set_$2Dp(!1)}_d.$4A.prototype={$1ZV:null,$P:null,$1r:null,get_$5p0:function(){return this.$W(_d.$4A.$41j)},set_$5p0:function(n){this.$N(_d.$4A.$41j,n);return n},get_$5p3:function(){return this.$W(_d.$4A.$41k)},set_$5p3:function(n){this.$N(_d.$4A.$41k,n);return n},get_$5oz:function(){return this.$W(_d.$4A.$41h)},set_$5oz:function(n){this.$N(_d.$4A.$41h,n);return n},get_$2Zy:function(){return this.$W(_d.$4A.$3Od)},set_$2Zy:function(n){this.$N(_d.$4A.$3Od,n);return n},get_$2Dp:function(){return this.$W(_d.$4A.$3i1)},set_$2Dp:function(n){this.$N(_d.$4A.$3i1,n);return n},get_$5oy:function(){return this.$W(_d.$4A.$41i)},set_$5oy:function(n){this.$N(_d.$4A.$41i,n);return n},get_$2do:function(){return this.$W(_d.$4A.$3UZ)},set_$2do:function(n){this.$N(_d.$4A.$3UZ,n);return n},get_$1qE:function(){return this.$W(_d.$4A.$3mu)},set_$1qE:function(n){this.$N(_d.$4A.$3mu,n);return n},$6y0:function(){$8(this.$1ZV)||this.$5p2()},$8lA:function(n){if(n.EventType!=="Reload"){var t=n;this.set_$1qE($6R3(this,t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&$3Fj(this)}},$4BH:function(){var n=new _g.$Bm;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1ZV;var t=new _h.$DH(n);t.$HX(_d.$4A.$D,"PlayOnPhoneNotification",this.$$d_$8lA,2)},$9Ch:function(){var n=new _g.$Bm;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1ZV;var t=new _h.$DH(n);t.$20X()},$2MD:function(){this.set_$1qE(_u.Strings.l_PlayOnPhoneDialing_Text);var n=new _c.$14x(this.$P.get_$i().Id,this.get_$2do());this.set_$2Dp(!0);n.add_$2A(this.$$d_$4dO);n.add_$20(this.$$d_$wi);OwaApplication.$1T.$y(n)},$5p2:function(){var n=new _c.$14z(this.$1ZV);this.set_$1qE(_u.Strings.l_PlayOnPhoneDisconnecting_Text);n.add_$2m(this.$$d_$7A6);OwaApplication.$1T.$y(n)},$8cg:function(){this.set_$5oy(!0)},$4dO:function(n){this.$1ZV=n.$CW.PhoneCallId.Id;this.set_$2Zy(!1);this.$4BH()},$wi:function(n){var i=n;var t=_u.Strings.l_PLayOnPhoneFailed_Text;if(i.get_$cu()&&i.get_$cu().Body){var r=i.get_$cu().Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_u.Strings.l_ErrorUMInvalidObjectID_Text;break;case"ErrorPhoneNumberNotDialable":t=_u.Strings.l_ErrorUMDialingRules_Text;break;case"ErrorIPGatewayNotFound":t=_u.Strings.l_ErrorUMIPGateway_Text;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_u.Strings.l_InvalidPhoneNumber_Text;break}}this.set_$1qE("");this.$1r.$3A(0,t,null);this.set_$2Zy(!0);this.set_$2Dp(!1)},$7A6:function(n){$3Fj(this)}};_d.$BT=function(n){_d.$BT.initializeBase(this);this.set_$48(n);this.$2ow=!1;this.$5Cq=_g.$S.get_$L().get_$38().get_$1oH();this.set_$41l(new _d.$4A(n));$6Sq(this)};function $6Sq(n){if(n.get_$48().get_$1e())for(var i=0;i<n.get_$48().get_$1e().get_$F();i++){var t=n.get_$48().get_$1e().get_$48(i);if(t.get_$1Q()===n.get_$48().get_$4GI()){if(!n.get_$1oH()){n.set_$EN(new _d.$jS(t,_y.$8D.$2hS(t.get_$40(),!1),n.get_$48().get_$i().Id));n.$2ow=_g.$w.$3iC(n.get_$48().get_$7G())?!0:t.get_$BL()==="audio/mp3"?!0:!1}if(n.get_$493()||n.get_$61s()){n.$di=new Array(1);n.$di[0]=t.get_$40().Id}break}}}_d.$BT.prototype={$5Cq:!1,$2ow:!1,$49p:!1,$di:null,get_$48:function(){return this.$W(_d.$BT.$yY)},set_$48:function(n){this.$N(_d.$BT.$yY,n);return n},get_$EN:function(){return this.$W(_d.$BT.$4AP)},set_$EN:function(n){this.$N(_d.$BT.$4AP,n);return n},get_$41l:function(){return this.$W(_d.$BT.$41m)},set_$41l:function(n){this.$N(_d.$BT.$41m,n);return n},get_$493:function(){var n=!1;this.get_$3jS()&&this.$2ow&&!this.get_$1oH()&&(this.get_$7ZX()||_a.NativeBridge.get_$L().$24D.$Cp)&&(n=!0);return n},get_$61s:function(){return!this.get_$1oH()&&this.get_$3jS()&&!this.get_$493()&&_a.UserAgent.getInstance().$5G6},get_$4gu:function(){return this.$di},get_$3jS:function(){return _g.$w.$5Dx(this.get_$48().get_$7G())},get_$94o:function(){return this.$49p},set_$94o:function(n){this.$49p=n;$6(this,"SignalCleanup");return n},get_$1oH:function(){return this.$5Cq&&_g.$w.$3iC(this.get_$48().get_$7G())},get_$7ZX:function(){return _a.UserAgent.getInstance().$3d6},$f7:function(){this.set_$94o(!0);this.get_$41l().$6y0()}};_d.$1Cp=function(){};_d.$1Cp.$1o=function(){};_d.$1Cp.$1o.$YZ=function(){};_d.$1Cp.$1o.$YZ.$2cf=function(n,t,i,r,u,f){var e=new _a.$7t;t&&e.$7c("N",1);n&&e.$7c("K",1);var o=0;if(!$8(r.$r.get_$72())&&r.$r.get_$72().get_$F()>0){o+=r.$r.get_$72().get_$F();e.$7c("RC",r.$r.get_$72().get_$F())}if(!$8(r.$r.get_$8A())&&r.$r.get_$8A().get_$F()>0){o+=r.$r.get_$8A().get_$F();e.$7c("OC",r.$r.get_$8A().get_$F())}o>0&&e.$7c("TC",o);!$8(r.$r.get_$5m())&&r.$r.get_$5m()&&e.$7c("A",1);!$8(r.$r.get_$9D())&&r.$r.get_$9D().get_$F()>0&&e.$7c("R",r.$r.get_$9D().get_$F());$8(u)||u.get_$DE()/6e4==30||e.$7c("DU",u.get_$DE()/6e4);r.get_$cs()!==15&&e.$7c("RM",r.get_$cs());$8(r.$r.get_$92())||r.$r.get_$92()==="Busy"||e.$IN("F",r.$r.get_$92());!$8(r.$r.get_$bm())&&r.$r.get_$bm()&&e.$7c("P",1);i&&e.$IN("RP",f.$Cm.get_$GK().$20C());!$8(r.$r.get_$2nY())&&r.$r.get_$2nY()&&e.$7c("OM",1);$8(r.$r.get_$Cz())||r.$r.get_$Cz()||e.$7c("NR",1);return e.toString()};_d.$1Cp.$1o.$YZ.$63y=function(n,t,i,r,u){var f="";f=n?t?i==="Mouse"?r?"SendRecurringMeetingOnPopout":"SendRecurringMeetingOnCompose":u?"SendRecurringMeetingOnQuickCompose":"SendRecurringMeetingOnCompose":i==="Mouse"?r?"SendMeetingOnPopout":"SendMeetingOnCompose":u?"SendMeetingOnQuickCompose":"SendMeetingOnCompose":t?i==="Mouse"?r?"SaveRecurringAppointmentOnPopout":"SaveRecurringAppointmentOnCompose":u?"SaveRecurringAppointmentOnQuickCompose":"SaveRecurringAppointmentOnCompose":i==="Mouse"?r?"SaveAppointmentOnPopout":"SaveAppointmentOnCompose":u?"SaveAppointmentOnQuickCompose":"SaveAppointmentOnCompose";return _a.$5.$1V(_a.$0.$1o,f,!0)};_d.$1Cp.$1o.$YZ.$2fM=function(n,t,i,r){_a.$5.$1G(n,null,t,i,r)};_d.$1Cp.$1o.$GM=function(){};_d.$1Cp.$1o.$GM.$96J=function(n){var t=n?"OpenSchedulingAssistantFormOnPopout":"OpenSchedulingAssistantForm";_a.$5.$1V(_d.$1Cp.$1o.$GM.$2OD,t);return t};_d.$1Cp.$1o.$GM.$63w=function(n){var t=n?"ApplySchedulingAssistantChangesOnPopout":"ApplySchedulingAssistantChanges";return _a.$5.$1V(_d.$1Cp.$1o.$GM.$2OD,t,!0)};_d.$1Cp.$1o.$GM.$63x=function(n){var t=n?"DiscardSchedulingAssistantChangesOnPopout":"DiscardSchedulingAssistantChanges";return _a.$5.$1V(_d.$1Cp.$1o.$GM.$2OD,t,!0)};_d.$1Cp.$1o.$GM.$96K=function(){return _a.$5.$1V(_d.$1Cp.$1o.$GM.$2OD,"PopoutSchedulingAssistantForm",!0)};_d.$1Cp.$1o.$GM.$28R=function(n,t,i,r){_a.$5.$1G(n,null,t,i,r)};_d.$1Cp.$1o.$Hv=function(){};_d.$1Cp.$1o.$Hv.$7Jh=function(n){return n?3:0};_d.$1Cp.$1o.$Hv.$7Jn=function(n){return n?4:1};_d.$1Cp.$1o.$Hv.$7O2=function(n){return n?5:2};_d.$1Cp.$1o.$Hv.$6vY=function(n,t){switch(n){case"Accept":switch(t){case 0:return"AcceptMeetingOnMailReadingPane";case 1:return"AcceptMeetingOnCalendarPeek";case 2:return"AcceptMeetingOnCalendarReadingPane";case 3:return"AcceptMeetingOnCalendarContextMenu"}break;case"Tentative":switch(t){case 0:return"TentativelyAcceptMeetingOnMailReadingPane";case 1:return"TentativelyAcceptMeetingOnCalendarPeek";case 2:return"TentativelyAcceptMeetingOnCalendarReadingPane";case 3:return"TentativelyAcceptMeetingOnCalendarContextMenu"}break;case"Decline":switch(t){case 0:return"DeclineMeetingOnMailReadingPane";case 1:return"DeclineMeetingOnCalendarPeek";case 2:return"DeclineMeetingOnCalendarReadingPane";case 3:return"DeclineMeetingOnCalendarContextMenu"}break}_js.Trace.logError(_d.$1Cp.$1o.$Hv.$3me,"Expected Accept, Tentatively Accept or Decline as valid Meeting Responses. But it is {0}",n);return null};_d.$1Cp.$1o.$Hv.$4Aj=function(n,t){var i=_d.$1Cp.$1o.$Hv.$6vY(n,t);return i?_a.$5.$1V(_d.$1Cp.$1o.$Hv.$3me,i,!0):null};_d.$1Cp.$1o.$Hv.$3WI=function(n,t,i,r,u,f,e){var o=new _a.$7t;r?o.$7c("R",1):o.$7c("R",0);u?o.$7c("C",1):o.$7c("C",0);f?o.$7c("O",1):o.$7c("O",0);o.$IN("S",_d.$1Cp.$1o.$Hv.$5yF.toString(e));_a.$5.$1G(n,null,t,i,o.toString())};_d.$1Cp.$1o.$Hv.$5yF=function(){};_d.$1Cp.$1o.$Hv.$5yF.prototype={dontSendResponse:0,editBeforeSendResponse:1,sendResponseDirectly:2,dontSendResponse_MasterFromOccurrence:3,editBeforeSendResponse_MasterFromOccurrence:4,sendResponseDirectly_MasterFromOccurrence:5};_d.$1Cp.$1o.$Hv.$5yF.registerEnum("_d.$1Cp.$1o.$Hv.$5yF",!1);_d.$aw=function(n,t){_a.$3.$1C(n,"text");_a.$3.$M(t,"action");this.$2E=n;this.$3R=t};_d.$aw.$$=function(n){var t="$aw"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$aw"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$aw.apply(this,i)};r.registerClass("_d."+t);var u=_d.$aw.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$aw.prototype={$2E:null,$3R:null,get_$1N:function(){return this.$2E},get_$pp:function(){return this.$3R}};_d.$yk=function(){};_d.$yk.prototype={singular:1,plural:2};_d.$yk.registerEnum("_d.$yk",!1);_d.$w6=function(){};_d.$w6.prototype={$39:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if($8(n))return"";if(!_js.$X.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$X,"Value must be an ObservableCollection");if(!n.get_$F())return"";for(var f=n,i=null,r=0;r<f.get_$F();r++){i=f.get_$48(r);i.get_$Xr()||u.append(_js.$8.$4C(e,i.get_$CC().get_$1Q()))}return u.toString()},$4nO:function(n,t){throw Error.notImplemented();}};_d.$wk=function(){};_d.$wk.prototype={$39:function(n,t){var r=n;var i=null;switch(r){case 0:i=_u.Strings.l_ZeroMinutesDuration_Text;break;case 18e5:i=_u.Strings.l_ThirtyMinutesDuration_Text;break;case 36e5:i=_u.Strings.l_OneHourDuration_Text;break;case 54e5:i=_u.Strings.l_NinetyMinutesDuration_Text;break;case 72e5:i=_u.Strings.l_TwoHoursDuration_Text;break;case-1:i=_u.Strings.l_AllDayDuration_Text;break;case-2:i=_u.Strings.l_CustomDuration_Text;break;default:i="";break}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$wt=function(){};_d.$wt.prototype={$39:function(n,t){var r=n;var i=null;switch(r){case 0:i="";break;case 1:i=_u.Strings.l_CalendarLayoutTypeStandard_Text;break;case 2:i=_u.Strings.l_CalendarLayoutTypeHorizontalAgenda_Text;break;case 3:i=_u.Strings.l_CalendarLayoutTypeVerticalAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$X,String.format("Value '{0}' is not a supported CalendarLayoutType.",n));}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$wq=function(){};_d.$wq.prototype={$39:function(n,t){if(Number.isInstanceOfType(n)){var i=Math.abs(n)%24;return new _a.$7(1,1,1,i,0,0).$2P(0)}throw Error.argument(String.format("Expected an int for the hour value. Actual type was '{0}'",n?Object.getType(n).getName():"null"));},$4nO:function(n,t){throw Error.notImplemented();}};_d.$Iu=function(){};_d.$Iu.$7Ki=function(n){if(_g.$39.isInstanceOfType(n)){var t=n;return t.get_$3ij()?"RecurringMaster":t.get_$Ju()}else return n.get_$Ju()};_d.$Iu.$51i=function(n,t){switch(_d.$Iu.$7Ki(n)){case"RecurringMaster":switch(t){case 1:return _u.Strings.l_RemoveSeriesFromCalendar_LowerCase_Text;case 3:return _u.Strings.l_RemoveSeriesFromCalendar_SentenceCase_Text;default:return _u.Strings.l_RemoveSeriesFromCalendar_UpperCase_Text}case"Occurrence":case"Exception":switch(t){case 1:return _u.Strings.l_RemoveOccurrenceFromCalendar_LowerCase_Text;case 3:return _u.Strings.l_RemoveOccurrenceFromCalendar_SentenceCase_Text;default:return _u.Strings.l_RemoveOccurrenceFromCalendar_UpperCase_Text}default:switch(t){case 1:return _u.Strings.l_RemoveFromCalendar_LowerCase_Text;case 3:return _u.Strings.l_RemoveFromCalendar_SentenceCase_Text;default:return _u.Strings.l_RemoveFromCalendar_UpperCase_Text}}};_d.$Iu.prototype={$39:function(n,t){if(!n)return"";var i=n;var r=$8(t)?_d.$Iu.$4rW:t;return _d.$Iu.$51i(i,r)},$4nO:function(n,t){throw Error.notImplemented();}};_d.$Iz=function(){};_d.$Iz.$52p=function(n,t){var i="";if(!n||!t)return i;i=n.$3u().$4W(t.$3u())?String.format(_u.Strings.l_WhenStartEndsSameDay_Text,n.$2P(5),n.$2P(0),t.$2P(0)):String.format(_u.Strings.l_WhenStartsEndsDifferentDay_Text,n.$2P(5),n.$2P(0),t.$2P(5),t.$2P(0));return i};_d.$Iz.$7PL=function(n,t,i,r){if(!n.$8c(t))return String.format(_u.Strings.l_WhenStartEndsSameDay_Long_AT_Text,n.$2P(3),n.$2P(0),t.$2P(0));if(i&&r&&t.$2Y(n)===864e5)return n.$2P(3);if(i&&r){var u=t.$9b(-1).$2P(3);return String.format(_u.Strings.l_WhenStartsEndsDifferentDayDateOnly_Long_AT_Text,n.$2P(3),u)}return String.format(_u.Strings.l_WhenStartsEndsDifferentDay_Long_AT_Text,n.$2P(3),n.$2P(0),t.$2P(3),t.$2P(0))};function $6LS(n,t,i){if(!t||!i)return"";var r=i.$6E(t);if(r<=864e5)return String.format(_u.Strings.l_WhenStartsEndsSameDayAllDAyEvent_Text,t.$2P(5));var u=i.$2q(-1).$2P(5);return String.format(_u.Strings.l_WhenStartsEndsDifferentDayMultiDayEvent_Text,t.$2P(5),u)}_d.$Iz.prototype={$43R:null,get_$8p9:function(){$8(this.$43R)&&(this.$43R=new _d.$15O);return this.$43R},$39:function(n,t){if($8(n))return"";if(!_g.ICalendarTimePeriod.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.ICalendarTimePeriod,"Value must be an ICalendarTimePeriod");var i=n;return i.get_$ZC()?this.get_$8p9().$39(_d.$GG.$43T(i.get_$Jh(),i.get_$10(),i.get_$23()),t):_g.$11M.isInstanceOfType(n)&&n.get_$5m()?$6LS(this,i.get_$10(),i.get_$23()):_d.$Iz.$52p(i.get_$10(),i.get_$23())},$4nO:function(n,t){throw Error.notImplemented();}};_d.$q5=function(){};_d.$q5.prototype={$39:function(n,t){return _g.$Q7.isInstanceOfType(n)?n.get_$1l():n},$4nO:function(n,t){throw Error.notImplemented();}};_d.$x3=function(){};_d.$x3.prototype={$39:function(n,t){var r=n;var i=null;switch(r){case 1:i=_u.Strings.l_CalendarViewTypeDay_Text;break;case 2:i=_u.Strings.l_CalendarViewTypeWeek_Text;break;case 3:i=_u.Strings.l_CalendarViewTypeWorkWeek_Text;break;case 4:i=_u.Strings.l_CalendarViewTypeMonth_Text;break;case 5:i=_u.Strings.l_CalendarViewTypeAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$X,String.format("Value '{0}' is not a supported CalendarViewType.",n));}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$y8=function(){};_d.$y8.prototype={$39:function(n,t){switch(n){case 1:return _u.Strings.l_Sunday_Text;case 2:return _u.Strings.l_Monday_Text;case 4:return _u.Strings.l_Tuesday_Text;case 8:return _u.Strings.l_Wednesday_Text;case 16:return _u.Strings.l_Thursday_Text;case 32:return _u.Strings.l_Friday_Text;case 64:return _u.Strings.l_Saturday_Text;default:return""}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$yR=function(){};_d.$yR.prototype={$39:function(n,t){switch(n){case 0:return _d.$5g;case 1:return _d.$Jn;case 2:return _d.$Of;default:throw Error.invalidOperation("Not supported CalendarItemDetailsPivotType: "+n.toString());}},$4nO:function(n,t){var i=n;if(i===_d.$5g)return 0;if(i===_d.$Jn)return 1;if(i===_d.$Of)return 2;throw Error.invalidOperation("Not supported Type: "+i);}};_d.$qq=function(){};_d.$qq.prototype={$39:function(n,t){var i=_js.$8q.$W(Number,n);if(i===_d.$6N.$1Jf)return _u.Strings.l_ReminderPickerDurationNone_Text;var r=i*60;return _a.$7.$2hh(r)},$4nO:function(n,t){throw Error.notImplemented();}};_d.$qr=function(){};_d.$qr.prototype={$39:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_js.$2B.$jX(_d.$yk,t.toString());switch(n){case 0:i=r===1?_u.Strings.l_DurationUnitMinute_Text:_u.Strings.l_DurationUnitMinutes_Text;break;case 1:i=r===1?_u.Strings.l_DurationUnitHour_Text:_u.Strings.l_DurationUnitHours_Text;break;case 2:i=r===1?_u.Strings.l_DurationUnitDay_Text:_u.Strings.l_DurationUnitDays_Text;break;case 3:i=r===1?_u.Strings.l_DurationUnitWeek_Text:_u.Strings.l_DurationUnitWeeks_Text;break}}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$rB=function(){};_d.$rB.prototype={$39:function(n,t){if($8(n))return"calendarFree";var i=n;switch(i){case"NoData":case"Free":return"calendarFree";case"Busy":return"calendarBusy";case"Tentative":return"calendarTentative";case"WorkingElsewhere":return"calendarOutside";case"OOF":return!$8(t)&&t?"calendarAwayEmphasis":"calendarAway";default:return"calendarFree"}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$ft=function(){};_d.$ft.prototype={$39:function(n,t){var i=n;switch(i){case"Free":return _u.Strings.l_FreeBusyFree_Text;case"Busy":return _u.Strings.l_FreeBusyBusy_Text;case"Tentative":return _u.Strings.l_FreeBusyTentative_Text;case"WorkingElsewhere":return _u.Strings.l_FreeBusyWorkingElsewhere_Text;case"OOF":return _u.Strings.l_FreeBusyOof_Text;case"NoData":return _u.Strings.l_NoDataAvailable_Text;default:return""}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$mV=function(){};_d.$mV.prototype={$39:function(n,t){t===null&&(t=!0);var i=n;return i>=0&&i<=11?t?_a.$7.$515(i):_js.$2B.$J7(_a.$mU,i):""},$4nO:function(n,t){throw Error.notImplemented();}};_d.$14q=function(){};_d.$14q.prototype={$39:function(n,t){if(!_js.$X.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$X,"Value must be an ObservableCollection");var r=n;var i=new _js.$X;var f=this;r.$Bx(function(n){var t=n;_js.$8.$14(t.get_$1l())?_js.$8.$14(t.get_$8e())&&i.$H(t.get_$8e()):i.$H(t.get_$1l())});var u=new _d.$16E;return u.$39(i,null)},$4nO:function(n,t){throw Error.notImplemented();}};_d.$15O=function(){};_d.$15O.prototype={$39:function(n,t){var i=n;var r="";$8(i)||(r=i.$9AP());return r},$4nO:function(n,t){throw Error.notImplemented();}};_d.$15Q=function(){};_d.$15Q.prototype={$39:function(n,t){switch(n){case"None":return _u.Strings.l_None_Text;case"First":return _u.Strings.l_First_Text;case"Second":return _u.Strings.l_Second_Text;case"Third":return _u.Strings.l_Third_Text;case"Fourth":return _u.Strings.l_Fourth_Text;case"Last":return _u.Strings.l_Last_Text;default:return""}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$uE=function(){};_d.$uE.prototype={$39:function(n,t){if(String.isInstanceOfType(n))return n;var i=n;var r="";$8(i)||(r=i.$20C());return r},$4nO:function(n,t){throw Error.notImplemented();}};_d.$15W=function(){};_d.$15W.prototype={$39:function(n,t){var r=n;var i=null;switch(r){case-15:i=_u.Strings.l_ReminderSnoozeOption_FifteenMinutesBeforeStart_Text;break;case-10:i=_u.Strings.l_ReminderSnoozeOption_TenMinutesBeforeStart_Text;break;case-5:i=_u.Strings.l_ReminderSnoozeOption_FiveMinutesBeforeStart_Text;break;case 0:i=_u.Strings.l_ReminderSnoozeOption_ZeroMinutesBeforeStart_Text;break;case 5:i=_u.Strings.l_ReminderSnoozeOption_FiveMinutes_Text;break;case 10:i=_u.Strings.l_ReminderSnoozeOption_TenMinutes_Text;break;case 15:i=_u.Strings.l_ReminderSnoozeOption_FifteenMinutes_Text;break;case 30:i=_u.Strings.l_ReminderSnoozeOption_ThirtyMinutes_Text;break;case 60:i=_u.Strings.l_ReminderSnoozeOption_OneHour_Text;break;case 120:i=_u.Strings.l_ReminderSnoozeOption_TwoHours_Text;break;case 240:i=_u.Strings.l_ReminderSnoozeOption_FourHours_Text;break;case 480:i=_u.Strings.l_ReminderSnoozeOption_EightHours_Text;break;case 720:i=_u.Strings.l_ReminderSnoozeOption_HalfDay_Text;break;case 1440:i=_u.Strings.l_ReminderSnoozeOption_OneDay_Text;break;case 2880:i=_u.Strings.l_ReminderSnoozeOption_TwoDays_Text;break;case 4320:i=_u.Strings.l_ReminderSnoozeOption_ThreeDays_Text;break;case 5760:i=_u.Strings.l_ReminderSnoozeOption_FourDays_Text;break;case 10080:i=_u.Strings.l_ReminderSnoozeOption_OneWeek_Text;break;case 20160:i=_u.Strings.l_ReminderSnoozeOption_TwoWeeks_Text;break;default:i="";break}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$15k=function(){};_d.$15k.prototype={$39:function(n,t){var i=n;switch(i){case"Accept":return _u.Strings.l_Accepted_Text;case"Tentative":return _u.Strings.l_Tentative_Text;case"Decline":return _u.Strings.l_Declined_Text;case"Unknown":case"NoResponseReceived":return _u.Strings.l_NoResponseReceived_Text;case"Organizer":default:return""}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$16E=function(){};_d.$16E.prototype={$39:function(n,t){var e="...";var o=30;var s=27;if(!_js.$X.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$X,"Value must be an ObservableCollection");var u=n;var i=new Sys.StringBuilder;if(!u)return null;for(var f=0;f<u.get_$F();f++){i.isEmpty()||i.append("; ");i.append(u.get_$48(f))}var r=i.toString();return _js.$8.$14(r)||r.length<=o?r:r.substring(0,s)+e},$4nO:function(n,t){throw Error.notImplemented();}};_d.$16H=function(){};_d.$16H.prototype={$39:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_u.Strings.l_Normal_Text;break;case"Personal":i=_u.Strings.l_Personal_Text;break;case"Private":i=_u.Strings.l_Private_Text;break;case"Confidential":i=_u.Strings.l_Confidential_Text;break;default:i=_u.Strings.l_Normal_Text;break}return i},$4nO:function(n,t){throw Error.notImplemented();}};_d.$ih=function(){};_d.$ih.prototype={$39:function(n,t){if($8(n))return"";else switch(n){case"NotStarted":return _u.Strings.l_TaskStatusNotStarted_Text;case"InProgress":return _u.Strings.l_TaskStatusInProgress_Text;case"Completed":return _u.Strings.l_TaskStatusCompleted_Text;case"Deferred":return _u.Strings.l_TaskStatusDeferred_Text;case"WaitingOnOthers":return _u.Strings.l_TaskStatusWaitingOnOthers_Text;default:return""}},$4nO:function(n,t){throw Error.notImplemented();}};_d.$wm=function(){};_d.$wm.prototype={$39:function(n,t){if($8(n))return"";if(!_g.$39.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.$39,"Value must be an CalendarItemModel");var u=n;var i=u.get_$10();var r=u.get_$23();var f="";var e=i.$3u().$4W(r.$3u());f=u.get_$5m()?e?String.format(_u.Strings.l_ConflictAllSameDay_Text,i.$2P(1)):String.format(_u.Strings.l_ConflictAllDifferentDay_Text,i.$2P(1),r.$2P(1)):e?String.format(_u.Strings.l_ConflictStartEndsSameDay_Text,i.$2P(18),r.$2P(18)):String.format(_u.Strings.l_ConflictStartEndsDifferentDay_Text,i.$2P(1),i.$2P(18),r.$2P(1),r.$2P(18));return f},$4nO:function(n,t){throw Error.notImplemented();}};_d.$19E=function(){};_d.$19E.prototype={$39:function(n,t){var i=n;return i?i.toLocaleString():""},$4nO:function(n,t){throw Error.notImplemented();}};_d.$CA=function(n){_d.$CA.initializeBase(this);this.$G=n};function $6Sr(n){}function $6Ss(n){if(n.$G.get_$O()==="TouchNarrow"){var t=_y.$26.$Bv(n);t.$dc(new _C(n.$$d_$18v,_a.$0.$ji));n.set_$7E(t)}}_d.$CA.prototype={$G:null,$IX:null,$tZ:null,$2C:null,$3fv:!1,$2xi:null,$3To:null,$2pB:null,$77u:null,$5j:null,get_$8N:function(){return this.$2C},set_$8N:function(n){if(n===this.$2C)return n;this.$2C=n;$6(this,_d.$CA.$4ps);return n},get_$1wI:function(){return this.$5j},set_$1wI:function(n){this.$5j=n;return n},get_$3jj:function(){return this.$2pB},set_$3jj:function(n){if(n===this.$2pB)return n;this.$2pB=n;$6(this,_d.$CA.$5Ee);return n},get_$5dZ:function(){return this.$2xi},set_$5dZ:function(n){if(n===this.$2xi)return n;this.$2xi=n;$6(this,_d.$CA.$5da);return n},get_$Jr:function(){return this.$G.get_$O()==="TouchNarrow"?_y.$1De.prototype.get_$Jr.call(this):0},$Fe:function(){_js.Trace.logInfo(_a.$0.$ji,"UIRPVM ->PostTransitionIn");_y.$1De.prototype.$Fe.call(this);$6Sr(this)},$Rx:function(){_y.$1De.prototype.$Rx.call(this);this.$5j&&this.$5j.set_$2DR(!1)},$jy:function(n,t){this.$IX=n;this.$tZ=t},$5z7:function(n,t){if($8(n))throw Error.argumentNull("item");if(n!==this.$2C){this.set_$8N(n);this.$3fv=t;var i=this.$2C.$29p();this.$3To=_h.$l.$Ia(i);$8(this.$3To)?this.set_$5dZ(_u.Strings.l_Move_UpperCase_Text):this.set_$5dZ(String.format(_u.Strings.l_MoveToFolder_UpperCase_Text,this.$3To.get_$1l()));this.$2C.get_$7A()?this.$2C.get_$7A()===3&&this.$3fv?this.set_$3jj(_u.Strings.l_ContactMustBeViewedFromPeopleModule_Text):this.set_$3jj(_u.Strings.l_ItemMustBeMoved_Text):this.set_$3jj(_u.Strings.l_ItemNotSupported_Text);$6Ss(this)}}};_d.$rw=function(){};_d.$rw.registerInterface("_d.$rw");_d.$zU=function(n,t){_d.$zU.initializeBase(this,[1,"ForgottenAttachment.AttachmentEvent"]);this.set_$4vB(n);this.set_$8uP(t)};_d.$zU.prototype={get_$4vB:function(){return this.$W("Event")},set_$4vB:function(n){$1O(this,"Event",n);return n},get_$8uP:function(){return this.$W("RuleNum")},set_$8uP:function(n){$1O(this,"RuleNum",n);return n}};_d.$E9=function(){};_d.$E9.$$cctor=function(){_d.$E9.$39b={};_d.$E9.$39b.en=!0};_d.$E9.$7Gg=function(n){return typeof window.NLG!="undefined"&&typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&!!window.Microsoft_NaturalLanguage_AttachmentRes[n]};_d.$E9.$2FR=function(n){var t=document.createElement("script");t.type="text/javascript";t.src=String.format("{0}/{1}",_y.$j.$g.get_$1ai(),n).toLowerCase();document.getElementsByTagName("head")[0].appendChild(t)};_d.$E9.$50l=function(n){return n.substr(0,2)};_d.$E9.prototype={$Kt:function(n){if($8(n))return!1;var t=_d.$E9.$50l(n);if(!(t in _d.$E9.$39b))return!1;typeof window.NLG=="undefined"&&_d.$E9.$2FR("microsoft.naturallanguage.clientruntime.js");typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&window.Microsoft_NaturalLanguage_AttachmentRes[t]||_d.$E9.$2FR("microsoft.naturallanguage.attachmentres."+t+".js");return!0},$3bu:function(n,t,i,r,u){u.val=null;if($8(r)||r.length<2)return!1;$8(t)&&(t="");$8(n)&&(n="");var f=_d.$E9.$50l(r);if(!_d.$E9.$7Gg(f))return!1;var o=_a.$5.$1V(_a.$0.$Dn,"ForgottenAttachment.Start",!0);var s=this.$7KQ();var h=i?NLG.PlainTextConverter.getPlainText(t):t;var e=new NLG.EmailData;e.body=NLG.PlainTextConverter.getLastMessage(h,f);e.subject=n;u.val=s.hasAttachments(e,f);_a.$5.$1G(o);return u.val.hasAttachment},$33e:function(n,t){OwaApplication.$8p.$H(new _d.$zU(n,t.ruleNumber))},$7KQ:function(){return new NLG.FAD.ForgottenAttachmentDetector}};_d.$Qm=function(n,t,i,r,u){this.$$d_$7Qn=Function.createDelegate(this,this.$7Qn);this.$1r=t;this.$EK=i;this.$t=r;var f=_a.UserAgent.getInstance();this.$36x=n.get_$O()==="Mouse"&&!!r.get_$Mm()&&r.get_$Mm().get_$4kQ()&&!!r.get_$1t()&&r.get_$1t().get_$3P5()&&!(f.$8O&&f.$EU.$8b<9);this.$ln=u;this.$36x&&u.$Kt(r.get_$38().get_$73())};function $6Nh(n,t){var r=document.createElement("div");var i=$(r);i.html(t);i.find("#divRplyFwdMsg").nextAll().remove();var u=String.format('img[src*="{0}"]',_d.$Qm.$4h5);var f=i.find(u).first();return f.size()>0}_d.$Qm.prototype={$36x:!1,$ln:null,$4sK:!1,$2Ew:null,$56G:!1,$1r:null,$EK:null,$t:null,$3bu:function(n,t){if(!this.$36x||this.$56G)return!1;var f=!1;if($8(t)){t=n.get_$85();f=!0}if(!$8(n.get_$502())){n.get_$502().$s();var i=!1;if(t)if(f)i=t.get_$F()>0;else for(var r=0;r<t.get_$F();r++){var h=t.get_$48(r);if(!h.get_$Xr()){i=!0;break}}var e=n.get_$45()==="HTML";if(i||e&&$6Nh(this,n.get_$Cx()))this.$4sK&&this.$ln.$33e(2,this.$2Ew);else{var u;var o,s;if(s=this.$ln.$3bu(n.get_$2h(),n.get_$Cx(),e,this.$t.get_$38().get_$73(),o={val:u}),u=o.val,s){this.$2Ew=u;this.$4sK=!0;this.$1r.$3A(1,_u.Strings.l_MailComposeForgottenAttachmentMessage_Text,this.$$d_$7Qn,!0,_u.Strings.l_MailComposeForgottenAttachmentSendAnyway_Text,_u.Strings.l_MailComposeForgottenAttachmentDontSend_Text,_u.Strings.l_MailComposeForgottenAttachmentTitle_Text);return!0}}}return!1},$7Qn:function(n,t){if(t){this.$t.get_$1t().set_$3P5(!1);_h.$2x.$H4(this.$t.get_$1t().$PB,OwaApplication.$1T);this.$ln.$33e(3,this.$2Ew);this.$36x=!1}if(n){this.$56G=!0;this.$ln.$33e(0,this.$2Ew);this.$EK.$s()}else this.$ln.$33e(1,this.$2Ew)}};_d.$fr=function(n,t,i){this.$G=n;this.$t=t;this.$4xx=i};_d.$fr.prototype={$G:null,$t:null,$4xx:null,$4oR:function(n,t){return new _d.$Qm(this.$G,n,t,this.$t,this.$4xx)}};_d.$1Bh=function(){};_d.$1Bh.registerInterface("_d.$1Bh");_d.$1Bk=function(){};_d.$1Bk.registerInterface("_d.$1Bk");_d.$Ia=function(){this.$jf=new(_0365f.$s.$$(_g.$YK));this.$1L=new(_0365f.$s.$$(_g.$1m));this.$PH=new _js.$X};function $4P7(n,t){switch(t){case 1:return 0;case 4:return 1;case 2:return 1;case 3:return 1;case 5:return 2;default:return 3}}function $4P8(n,t){for(var i=n.$jf.get_$F()-1;i>=0;i--)$6R4(n,n.$jf.get_$48(i),t)||n.$jf.$67(i)}function $6R4(n,t,i){if(t&&t.Recipients&&t.Recipients.length>0){for(var f=t.Recipients,r=new(_0365f.$s.$$(_g.$1m)),u=0;u<f.length;u++){var e=f[u];_g.$2I.$4mq(i,e)&&r.$H(e)}if(!r.get_$F())return!1;t.Recipients=r.$7V()}return!0}_d.$Ia.prototype={$5J:null,$ut:0,$qh:0,$PH:null,$1L:null,$jf:null,$2fl:0,$1u:function(){this.$jf.$1u();this.$1L.$1u();this.$PH.$1u();this.$ut=0;this.$qh=0},$6qY:function(n){this.$jf.$1u();this.$jf.$6G(n)},$9Es:function(n){this.$1L.$1u();this.$1L.$6G(n);$4P8(this,n)},$2k7:function(){for(var n=null,t=0;t<this.$jf.get_$F();t++)(!n||$4P7(this,n.Action)<$4P7(this,this.$jf.get_$48(t).Action))&&(n=this.$jf.get_$48(t));return n},$7X0:function(n){$4P8(this,n)}};_d.$3T=function(n,t,i,r,u){this.$$d_$8ci=Function.createDelegate(this,this.$8ci);this.$$d_$8cj=Function.createDelegate(this,this.$8cj);this.$$d_$8ck=Function.createDelegate(this,this.$8ck);this.$$d_$6w1=Function.createDelegate(this,this.$6w1);this.$$d_$3OO=Function.createDelegate(this,this.$3OO);this.$$d_$6vz=Function.createDelegate(this,this.$6vz);this.$$d_$6w0=Function.createDelegate(this,this.$6w0);this.$$d_$8r6=Function.createDelegate(this,this.$8r6);this.$p=n;this.$QM=t;this.$z=r;this.$4gq=i;this.$G=u;this.$2lq=!0};function $6R8(n,t,i,r){return r===8&&t.$PH.get_$F()>i.$PH.get_$F()?16:r}function $3Fn(n){for(var i=n.$QM.get_$Vc(),f=new(_0365f.$s.$$(_g.$1m)),t=0;t<i.get_$F();t++)for(var r=0;r<i.get_$48(t).$1L.get_$F();r++){var u=i.get_$48(t).$1L.get_$48(r);u.$BY&&u.$Kq&&f.$H(u.$BY.get_$1h())}return f.$7V()}function $3Fo(n,t){if(t&&t.Id){n.$1Zf=_a.$5.$1V(_a.$0.$HT,"DlpPolicyTipsGeneric",!0);var i=new _g.$Z9;i.ItemId=_g.$1j.$pP(t,!0);i.BodyOrSubjectChanged=n.$Sm.$ut!==n.$J4.$ut||n.$Sm.$qh!==n.$J4.$qh;i.NeedToReclassify=!n.$J4.$5J;i.CustomizedStringsNeeded=n.$2lq;i.Recipients=$3Fn(n);i.EventTrigger=n.$Sm.$2fl;var r=new _c.$zu(i);_js.Trace.logInfo(_a.$0.$HT,"Sending PolicyTip request to server for ItemId: "+t.Id+" CorrelationId: "+r.$9K9());$6RI(n,r,n.$$d_$8ck,n.$$d_$8cj,n.$$d_$8ci)}}function $6RC(n,t){return!t.$PH.get_$F()&&!t.$ut&&!t.$qh}function $6RB(n,t){return t.$ut!==n.$J4.$ut||t.$qh!==n.$J4.$qh}function $6RA(n,t){if(t.$PH.get_$F()!==n.$J4.$PH.get_$F())return!0;for(var i=0;i<n.$J4.$PH.get_$F();i++){var r=t.$PH.get_$48(i);var u=n.$J4.$PH.get_$48(i);if(r.get_$40()&&u.get_$40()&&r.get_$40().Id!==u.get_$40().Id)return!0}return!1}function $6RD(n){var t=$3Fn(n);return n.$J4.$1L?!$3Fl(n,n.$J4.$1L.get_$3T(),t)||!$3Fl(n,t,n.$J4.$1L.get_$3T()):!!t&&!!t.length}function $3Fl(n,t,i){if(!i||!i.length)return!0;if(!t||!i.length)return!1;for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];if(!_g.$2I.$4mq(t,e))return!1}return!0}function $6RI(n,t,i,r,u){i&&t.add_$2A(i);t.add_$20(r);u&&t.add_$2m(u);n.$44e=!0;n.$p.$y(t)}function $3Fk(n){_js.Trace.logInfo(_a.$0.$HT,"Clearing Existing PolicyTips");n.$z.$Ff(_d.$3T.$QH);n.$19V.$1u();n.$1KW.$1u();n.$1KX.$1u();n.$gA.set_$2nc(!1);n.$gA.set_$3iU(!1);$2UI(n);$2UH(n);n.$3OO()}function $6R5(n){n.get_$5jz()&&n.get_$5jz()(n.$z)}function $6RK(n,t,i){if(t&&i){var r=t.Recipients;var u=i.Recipients;$3Fl(n,r,u)||n.$gA.set_$2nc(!1);t.Action!==i.Action&&n.$gA.set_$2nc(!1)}}function $6RJ(n,t){if(t){t.ComplianceURL&&n.$gA.$8xe(t.ComplianceURL);t.PolicyTipMessageBlockString&&n.$gA.set_$6ug(t.PolicyTipMessageBlockString);t.PolicyTipMessageNotifyString&&n.$gA.set_$8QN(t.PolicyTipMessageNotifyString);t.PolicyTipMessageOverrideString&&n.$gA.set_$8im(t.PolicyTipMessageOverrideString)}}function $3Fm(n){var t=new _a.$7t;if(n.$1KW.get_$F()>0){for(var i="",u=0;u<n.$1KW.get_$F();u++){var e=n.$1KW.get_$48(u);i+=e.ContentType}t.$IN("A",i.length>=20?i.substring(0,20):i)}if(n.$1KX.get_$F()>0){for(var r="",f=0;f<n.$1KX.get_$F();f++)r+=n.$1KX.get_$48(f);t.$IN("C",r.length>=20?r.substring(0,20):r)}t.$7c("T",n.$2hP());t.$IN("MS",n.$5Jd?"T":"F");return t.toString()}function $4PA(n){var t=n.$J4.$2k7();if(t){_js.Trace.logInfo(_a.$0.$HT,"PolicyTipResponse: Action:{0}, Recipients:{1}",t.Action,t.Recipients);n.$gA.set_$6pY(t.Action);$6RG(n,t);$6RE(n,t);$6RF(n,t);$2UI(n);$2UH(n);n.$z.$1UG(91)||n.$z.$vP(91,n.$gA);n.$3OO()}else $3Fk(n)}function $6RH(n,t){for(var i=0;i<n.$QM.get_$Vc().get_$F();i++){var r=n.$QM.get_$Vc().get_$48(i);if(_d.$2n.isInstanceOfType(r)){r.$36.$11Y=!1;r.$2NT(t)}}}function $6RG(n,t){n.$19V.$1u();if(t.Recipients)for(var u=t.Recipients,f=u.length,i=0;i<f;++i){var e=u[i];var r=$6R9(n,e);r&&($4P9(n,n.$19V,r)||n.$19V.$H(new _d.$M1(r)))}}function $4P9(n,t,i){if(i&&i.$BY&&i.$BY.get_$1h()){var u=this;var r=t.$DK(function(n){var t=n.$2N5;return t&&t.$BY&&t.$BY.get_$1h()?t.$BY.get_$1h().EmailAddress===i.$BY.get_$1h().EmailAddress:!1});return r<t.get_$F()}return!1}function $6R6(n,t,i){if(i&&i.$1J&&i.$1J.get_$CE()&&i.$1J.get_$CE().AttachmentId){var u=this;var r=t.$DK(function(n){return n.AttachmentId.Id===i.$1J.get_$CE().AttachmentId.Id});return r<t.get_$F()}return!1}function $6RE(n,t){n.$1KW.$1u();if(t.AttachmentIds)for(var r=t.AttachmentIds,f=r.length,i=0;i<f;++i){var e=r[i];var u=$6R7(n,n.$J4.$PH,e);u&&n.$1KW.$H(u)}}function $6R7(n,t,i){for(var r=0;r<t.get_$F();r++){var u=t.get_$48(r);if(i.Id===u.get_$CE().AttachmentId.Id)return u.get_$CE()}return null}function $6RF(n,t){n.$1KX.$1u();if(t.Classifications)for(var r=t.Classifications,u=r.length,i=0;i<u;++i){var f=r[i];n.$1KX.$H(f)}}function $2UI(n){for(var f=n.$gA.$an===1,t=0;t<n.$QM.get_$Vc().get_$F();t++){var i=n.$QM.get_$Vc().get_$48(t);if(i.$1L)for(var r=0;r<i.$1L.get_$F();r++){var u=i.$1L.get_$48(r);u.set_$7cu(!f&&$4P9(n,n.$19V,u))}}}function $2UH(n){var t=n.$4gq.get_$5o();if(t&&t.get_$1e())for(var i=0;i<t.get_$1e().get_$F();i++){var r=t.get_$1e().get_$48(i);r.set_$7ct($6R6(n,n.$1KW,r))}}function $6R9(n,t){if(t)for(var r=0;r<n.$QM.get_$Vc().get_$F();r++){var u=n.$QM.get_$Vc().get_$48(r);if(u.$1L)for(var f=0;f<u.$1L.get_$F();f++){var i=u.$1L.get_$48(f);if(i.$BY&&i.$BY.get_$1h()&&t.EmailAddress===i.$BY.get_$1h().EmailAddress)return i}}return null}_d.$3T.prototype={$p:null,$z:null,$QM:null,$4gq:null,$G:null,$Sm:null,$J4:null,$ja:null,$40g:!1,$44e:!1,$3bZ:!1,$30r:0,$19V:null,$1KX:null,$1KW:null,$5jy:null,$5jx:null,$5k2:null,$5k0:null,$307:null,$gA:null,$1Zf:null,$5Jd:!1,$2lq:!1,get_$3yj:function(){return this.$5jx},set_$3yj:function(n){this.$5jx=n;return n},get_$5jz:function(){return this.$5jy},set_$5jz:function(n){this.$5jy=n;return n},get_$306:function(){return this.$5k2},set_$306:function(n){this.$5k2=n;return n},get_$305:function(){return this.$5k0},set_$305:function(n){this.$5k0=n;return n},get_$5k5:function(){return this.$307},set_$5k5:function(n){this.$307=n;return n},$3v:function(){this.$Sm=new _d.$Ia;this.$J4=new _d.$Ia;this.$ja=new _d.$Ia;this.$19V=new _js.$X;this.$1KW=new _js.$X;this.$1KX=new _js.$X;this.$gA=new _d.$Gv("PolicyTipsComplexContent",1,this.$19V,this.$1KX,this.$$d_$8r6,this.$$d_$6w0,this.$$d_$6vz,this.$$d_$3OO,this.$$d_$6w1,this.$G);this.$30r=0},$2hP:function(){if(_a.$5a.$2x&&this.$J4){var n=this.$J4.$2k7();if(n)return n.Action}return 0},$2Qv:function(n,t,i,r,u){if(_a.$5a.$2x&&!this.$3bZ){_js.Trace.logInfo(_a.$0.$HT,"Prepares to submit PolicyTips action...");if(this.$44e){_js.Trace.logInfo(_a.$0.$HT,"PolicyTips action is pending. Wating for the request to be completed before sending the new one.");this.$40g=!0;this.$ja.$5J=n;this.$ja.$PH.$1u();if(t&&t.get_$F()>0)for(var e=0;e<t.get_$F();e++)_at.$18.isInstanceOfType(t.get_$48(e))?this.$ja.$PH.$H(t.get_$48(e).$1J):_g.Attachment.isInstanceOfType(t.get_$48(e))&&this.$ja.$PH.$H(t.get_$48(e));this.$ja.$ut=i;this.$ja.$qh=r;this.$ja.$2fl=u}else{this.$40g=!1;this.$Sm.$5J=n;this.$Sm.$PH.$1u();this.$Sm.$ut=i;this.$Sm.$qh=r;if(t&&t.get_$F()>0)for(var f=0;f<t.get_$F();f++)_at.$18.isInstanceOfType(t.get_$48(f))?this.$Sm.$PH.$H(t.get_$48(f).$1J):_g.Attachment.isInstanceOfType(t.get_$48(f))&&this.$Sm.$PH.$H(t.get_$48(f));this.$Sm.$2fl=$6R8(this,this.$J4,this.$Sm,u);if(this.$gA.$yL)return;if($6RC(this,this.$Sm)){this.$J4.$1u();$3Fk(this);return}var o=$6RD(this);var s=$6RB(this,this.$Sm);var h=$6RA(this,this.$Sm);var c=s||h;o&&c?$3Fo(this,n):s&&!this.$gA.$16X||h?$3Fo(this,n):o&&this.$30r!==2&&$3Fo(this,n)}}},$3OO:function(){this.get_$3yj()&&this.get_$3yj()()},$6w0:function(n){if(this.get_$306()){this.get_$306()(n);$2UH(this);$2UI(this)}},$6vz:function(n){if(this.get_$305()){this.get_$305()(n);$2UH(this);$2UI(this)}},$6w1:function(){this.$307&&this.$307()},$8ck:function(n){var t=n;_js.Trace.logInfo(_a.$0.$HT,"PolicyTips succeeded: {0}",t.$1vo.EvaluationResult+" CorrelationId: "+t.$9K9());var i=this.$J4.$2k7();this.$J4.$5J=this.$Sm.$5J;this.$J4.$PH.$1u();this.$J4.$PH.$6G(this.$Sm.$PH.$7V());this.$J4.$ut=this.$Sm.$ut;this.$J4.$qh=this.$Sm.$qh;this.$J4.$6qY(t.$jf);this.$J4.$9Es(t.$41r.Recipients);var r=this.$J4.$2k7();$6RK(this,i,r);this.$30r=t.$1vo.OptimizationResult;this.$30r===1&&(this.$3bZ=!0);if(this.$2lq){this.$2lq=!1;$6RJ(this,t.$1vo.CustomizedStrings)}$4PA(this);this.$1Zf&&_a.$5.$1G(this.$1Zf,"DlpPolicyTipsGeneric","",null,$3Fm(this))},$8cj:function(n){var i=n;var t=i.$1vo;if(t){_js.Trace.logWarning(_a.$0.$HT,"PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult+" CorrelationId: "+i.$9K9()+" Diagnostic: "+t.DiagnosticData);this.$1Zf&&_a.$5.$1G(this.$1Zf,"DlpPolicyTipsGeneric",_g.$Te.toString(t.EvaluationResult),null,$3Fm(this))}else{_js.Trace.logWarning(_a.$0.$HT,"PolicyTipsResponse is null (PolicyTipsRequest is timed out) CorrelationId: "+i.$9K9());this.$1Zf&&_a.$5.$1G(this.$1Zf,"DlpPolicyTipsGeneric","PolicyTipsResponse is null (PolicyTipsRequest is timed out)",null,$3Fm(this));this.$3bZ=!0}$3Fk(this)},$8ci:function(n){_js.Trace.logInfo(_a.$0.$HT,"PolicyTips completed: {0}",n);this.$44e=!1;$6R5(this);if(this.$40g){_js.Trace.logInfo(_a.$0.$HT,"Submiting pending PolicyTips request...");this.$2Qv(this.$ja.$5J,this.$ja.$PH,this.$ja.$ut,this.$ja.$qh,this.$ja.$2fl)}},$8r6:function(){for(var t=this.$19V.get_$F()-1;t>=0;t--){var i=this.$19V.get_$48(t);var n=i.$2N5.$BY;n&&n.get_$1h()&&n.get_$1h().EmailAddress&&$6RH(this,n.get_$1h().EmailAddress)}var r=$3Fn(this);this.$J4.$7X0(r);$4PA(this)}};_d.$3w=function(n,t,i,r){this.$$d_$3ON=Function.createDelegate(this,this.$3ON);this.$$d_$2NT=Function.createDelegate(this,this.$2NT);this.$$d_$8a4=Function.createDelegate(this,this.$8a4);this.$$d_$8a5=Function.createDelegate(this,this.$8a5);this.$$d_$7LV=Function.createDelegate(this,this.$7LV);this.$p=n;this.$QM=t;this.$z=i;this.$1K=r};_d.$3w.$8a3=function(n){var t=n.$1Vf;var i=t?t.length:-1;_js.Trace.logInfo(_a.$0.$177,String.format("GetMailTipsAction completed. Number of MailTips Retrieved From Server: {0}",i))};function $4OR(n){var i=[];if(n.$QM.get_$Vc()&&n.$QM.get_$Vc().get_$F()>0)for(var t=0;t<n.$QM.get_$Vc().get_$F();t++)n.$QM.get_$Vc().get_$48(t)&&$6PG(n,i,n.$QM.get_$Vc().get_$48(t).$1L);return i}function $4OT(n,t){if(!t.length){$4ON(n);$2U8(n);return}for(var r=$4OQ(n,n.$x7,t),i=0;i<r.length;i++)n.$2NT(r[i].EmailAddress)}function $6PL(n,t,i,r,u){i&&t.add_$2A(i);t.add_$20(r);u&&t.add_$2m(u);n.$p.$y(t)}function $6PM(n,t){for(var u=[],r=0;r<t.length;r++){var i=t[r].EmailAddress;if(!Array.contains(u,i)){Array.add(u,i);var f=$4OS(n,i);if(!f)continue;f.$1UE&&n.$5Hr(i)}}}function $4ON(n){_js.Trace.logInfo(_a.$0.$177,"Clearing Existing MailTips...");n.$z.$Ff(_d.$3w.$QH);n.$1Vd.$1u();n.$1Xe.$1u();n.$1Ys.$1u();n.$1aV.$1u();n.$1Rt.$1u();n.$2Es.$1u();n.$1Ql.$1u();Array.clear(n.$x7);n.$12M=0;n.$1mG=0;n.$1jr=0;n.$3ON()}function $3FN(n){if(n.$1Hu){for(var c=!n.$1Xe.get_$F(),l=!n.$1Vd.get_$F(),a=!n.$1aV.get_$F(),v=!n.$1Ql.get_$F(),y=!n.$1Ys.get_$F(),p=!n.$1Rt.get_$F(),w=n.$12M<_g.$S.get_$L().get_$2qm(),f=0;f<n.$1Hu.length;f++){for(var r=!1,t=n.$1Hu[f],s=!1,e=0;e<n.$x7.length;e++){var b=n.$x7[e];if(b.EmailAddress===t.recipientAddress){s=!0;break}}if(!s){var h=$4OS(n,t.recipientAddress);if(h){var i=new _d.$M1(h);var o=new _g.$1m;o.EmailAddress=i.get_$WA();o.Name=i.get_$1l();Array.add(n.$x7,o);if(t.isModerated){n.$1Xe.$H(i);r=!0}if(t.mailboxFull){n.$1Vd.$H(i);r=!0}if(t.totalMemberCount>0){n.$12M+=t.totalMemberCount;if(t.totalMemberCount>1){i.$u5=t.totalMemberCount;n.$2Es.$H(i);r=!0}else n.$1mG+=t.totalMemberCount}if(t.externalMemberCount>0){n.$1jr+=t.externalMemberCount;i.$2fz=t.externalMemberCount;n.$1Rt.$H(i);r=!0}if(t.deliveryRestricted){n.$1aV.$H(i);r=!0}if(!_js.$8.$c(t.customMailTip)){i.$4qS=_y.$3A.$4nN(t.customMailTip);n.$1Ql.$H(i);r=!0}if(!_js.$8.$c(t.outOfOffice)){i.$3Mb=_y.$3A.$4nN(t.outOfOffice);n.$1Ys.$H(i);r=!0}r&&n.$5Hr(t.recipientAddress)}}}var u=new _y.$sB;if(n.$1Xe.get_$F()>0&&c){var k=new _d.$13i("MailtipsComplexContent",n.$1Xe,n.$$d_$2NT,n.$$d_$3ON,u.$39(300,null),n.$1K);n.$z.$5c(300);n.$z.$vP(300,k)}if(n.$1Vd.get_$F()>0&&l){var d=new _d.$15M("MailtipsComplexContent",n.$1Vd,n.$$d_$2NT,n.$$d_$3ON,u.$39(100,null),n.$1K);n.$z.$5c(100);n.$z.$vP(100,d)}if(n.$1aV.get_$F()>0&&a){var g=new _d.$15l("MailtipsComplexContent",n.$1aV,n.$$d_$2NT,n.$$d_$3ON,u.$39(200,null),n.$1K);n.$z.$5c(200);n.$z.$vP(200,g)}if(n.$1Ys.get_$F()>0&&y){var nt=new _d.$wT("MailtipsComplexContent",n.$1Ys,n.$$d_$2NT,n.$$d_$3ON,u.$39(4100,null),n.$1K);n.$z.$5c(4100);n.$z.$vP(4100,nt)}if(n.$1Ql.get_$F()>0&&v){var tt=new _d.$y2("MailtipsComplexContent",n.$1Ql,n.$$d_$2NT,n.$$d_$3ON,u.$39(4e3,null),n.$1K);n.$z.$5c(4e3);n.$z.$vP(4e3,tt)}if(n.$1Rt.get_$F()>0)if(p||!n.$1Rs){n.$z.$5c(4300);n.$1Rs=new _d.$z8("MailtipsComplexContent",n.$1Rt,n.$$d_$2NT,n.$$d_$3ON,u.$39(4300,null),n.$1K);n.$1Rs.set_$3XF(n.$1jr);n.$z.$vP(4300,n.$1Rs)}else n.$1Rs.set_$3XF(n.$1jr);if(n.$12M>=_g.$S.get_$L().get_$2qm())if(w||!n.$ya){n.$z.$5c(3900);n.$ya=new _d.$12t("MailtipsComplexContent",n.$2Es,n.$$d_$2NT,n.$$d_$3ON,u.$39(3900,null),n.$1K);n.$ya.set_$3dj(n.$1mG);n.$ya.set_$4Dz(n.$12M);n.$z.$vP(3900,n.$ya)}else{n.$ya.set_$3dj(n.$1mG);n.$ya.set_$4Dz(n.$12M)}}n.$3ON()}function $2U8(n){n.get_$5jG()&&n.get_$5jG()(n.$z)}function $6PI(n,t){for(var s=Sys.Net.XMLDOM(t),r=new _h.$13R,u=0;u<s.firstChild.childNodes.length;u++){var i=s.firstChild.childNodes[u];if(i.nodeType===1){var c=_a.$36.$Sj(i);switch(c){case"RecipientAddress":r.recipientAddress=_a.$36.$Id(i.childNodes[1]);break;case"OutOfOffice":if(i.childNodes)for(var f=0;f<i.childNodes.length;f++){var h=i.childNodes[f];var l=_a.$36.$Sj(h);if(l==="ReplyBody"){var e=$4OP(n,_a.$36.$Id(h));if(e&&!_js.$8.$c(e)){r.outOfOffice=e;break}}}break;case"MailboxFull":r.mailboxFull=Boolean.parse(_a.$36.$Id(i));break;case"IsModerated":r.isModerated=Boolean.parse(_a.$36.$Id(i));break;case"CustomMailTip":var o=$4OP(n,_a.$36.$Id(i));o&&!_js.$8.$c(o)&&(r.customMailTip=o);break;case"TotalMemberCount":r.totalMemberCount=Number.parseInvariant(_a.$36.$Id(i));break;case"ExternalMemberCount":r.externalMemberCount=Number.parseInvariant(_a.$36.$Id(i));break;case"MaxMessageSize":r.maxMessageSize=Number.parseInvariant(_a.$36.$Id(i));break;case"DeliveryRestricted":r.deliveryRestricted=Boolean.parse(_a.$36.$Id(i));break}}}return r}function $4OP(n,t){var i;var r,u;return(u=_a.$1T.$71p(_a.UserAgent.getInstance(),t,r={val:i}),i=r.val,u)?i:""}function $4OO(n,t,i){for(var r=0;r<t.length;r++)if(t[r].EmailAddress===i)return!0;return!1}function $6PG(n,t,i){if(i)for(var r=0;r<i.get_$F();r++)if(i.get_$48(r).$BY.get_$1h()){var f=i.get_$48(r).$BY.get_$1h().EmailAddress;if(!$4OO(n,t,f)){var u=new _g.$1m;u.EmailAddress=f;u.Name=i.get_$48(r).$BY.get_$1l();Array.add(t,u)}}}function $4OQ(n,t,i){if(!i||!i.length)return t;var r=[];if(!t)return r;for(var u=0;u<t.length;u++){var f=t[u];$4OO(n,i,f.EmailAddress)||Array.add(r,f)}return r}function $6PH(n,t){var u=[];if(t)for(var f=_h.$CU.get_$L(),i=0;i<t.length;i++){var r=t[i];f.$4ms(r.EmailAddress)?Array.add(n.$1Hu,f.$50q(r.EmailAddress)):Array.add(u,r)}return u}function $4OS(n,t){for(var u=null,r=0;r<n.$QM.get_$Vc().get_$F();r++){var f=n.$QM.get_$Vc().get_$48(r).$1L;if(f){var i=$6PF(n,t,f);if(i){if(i.$1UE)return i;u=i}}}return u}function $6PF(n,t,i){for(var r=0;r<i.get_$F();r++){var u=i.get_$48(r);if(u.$BY.get_$1h().EmailAddress===t)return u}return null}function $6PK(n,t){for(var i=0;i<n.$QM.get_$Vc().get_$F();i++){var r=n.$QM.get_$Vc().get_$48(i);if(_d.$2n.isInstanceOfType(r)){r.$36.$11Y=!1;r.$2NT(t)}}}function $6PJ(n,t){$1Ni(n,t,300,n.$1Xe);$1Ni(n,t,100,n.$1Vd);$1Ni(n,t,4100,n.$1Ys);$1Ni(n,t,200,n.$1aV);$1Ni(n,t,4e3,n.$1Ql);$1Ni(n,t,3900,n.$2Es);$1Ni(n,t,4300,n.$1Rt)}function $1Ni(n,t,i,r){for(var e=!1,o=[],f=0;f<r.get_$F();f++){var u=r.get_$48(f);if(u.get_$WA()===t){e=!0;i===3900&&u.$u5>0&&(n.$12M-=u.$u5);i===4300&&u.$2fz>0&&(n.$1jr-=u.$2fz);r.get_$F()===1&&i!==3900&&n.$z.$5c(i);Array.add(o,f)}}if(i===3900){if(!e){n.$12M--;n.$1mG--}if(n.$ya){n.$ya.set_$4Dz(n.$12M);n.$ya.set_$3dj(n.$1mG)}n.$12M<_g.$S.get_$L().get_$2qm()&&n.$z.$5c(3900)}i===4300&&e&&n.$1Rs&&n.$1Rs.set_$3XF(n.$1jr);for(var s=o.length-1;s>=0;s--)r.$67(o[s])}_d.$3w.prototype={$1K:null,$5jF:null,$5jE:null,$p:null,$QM:null,$z:null,$1Vd:null,$1Xe:null,$1Ys:null,$1Ql:null,$1aV:null,$1Rt:null,$2Es:null,$ya:null,$1Rs:null,$1Hu:null,$x7:null,$12M:0,$1mG:0,$1jr:0,get_$5jG:function(){return this.$5jF},set_$5jG:function(n){this.$5jF=n;return n},get_$3yP:function(){return this.$5jE},set_$3yP:function(n){this.$5jE=n;return n},$3v:function(){this.$1Vd=new _js.$X;this.$1Xe=new _js.$X;this.$1Ys=new _js.$X;this.$1aV=new _js.$X;this.$1Rt=new _js.$X;this.$2Es=new _js.$X;this.$1Ql=new _js.$X;this.$1Hu=[];this.$x7=[];$4ON(this)},$39O:function(){_js.Trace.logInfo(_a.$0.$177,"Prepares to submit mailtips action");var n=$4OR(this);Array.clear(this.$1Hu);_h.$CU.get_$L().$4l4();if(_g.$1Q.$KM)for(var i=0;i<n.length;i++){var e=n[i].EmailAddress;_g.$1Q.$KM.$50p(e,this.$$d_$7LV)}$4OT(this,n);var o=$4OQ(this,n,this.$x7);var r=$6PH(this,o);if(!r.length){this.$1Hu.length&&$3FN(this);$6PM(this,n);$2U8(this);return}for(var u=new Array(r.length),t=0;t<u.length;t++)u[t]=r[t];var f=new _g.$1m;f.EmailAddress=_g.$S.get_$L().get_$38().get_$Br();f.Name=_g.$S.get_$L().get_$38().get_$Gz();var s=new _c.$106(f,u,1);$6PL(this,s,this.$$d_$8a5,this.$$d_$8a4,_d.$3w.$8a3)},$5t1:function(){$4OT(this,$4OR(this))},$5Hr:function(n){if(this.$QM)for(var t=0;t<this.$QM.get_$Vc().get_$F();t++)for(var u=this.$QM.get_$Vc().get_$48(t),i=0;i<u.$1L.get_$F();i++){var r=u.$1L.get_$48(i);if(r.$BY.get_$1h().EmailAddress===n){r.set_$5BM(!0);r.set_$5BM(!0)}}},$8a5:function(n){var t=n;if(t.$1Vf)for(var i=0;i<t.$1Vf.length;i++){_js.Trace.logInfo(_a.$0.$177,String.format("Raw XML Mailtip Node: [{0}]",t.$1Vf[i]));var r=$6PI(this,t.$1Vf[i]);_h.$CU.get_$L().$4e1(r);Array.add(this.$1Hu,r)}$3FN(this);$2U8(this)},$8a4:function(n){!n.$1b||_js.$8.$14(n.$1b.message)?_js.Trace.logWarning(_a.$0.$177,"GetMailTips action failed without server error."):_js.Trace.logWarning(_a.$0.$177,"GetMailTips action failed with server error {0}",n.$1b.message);$3FN(this);$2U8(this)},$3ON:function(){this.get_$3yP()&&this.get_$3yP()()},$2NT:function(n){for(var t=0;t<this.$x7.length;t++)if(this.$x7[t].EmailAddress===n){Array.removeAt(this.$x7,t);break}$6PK(this,n);$6PJ(this,n);this.$z.$7FE()},$7LV:function(n){var t=JsonParser.deserialize(n);t&&_h.$CU.get_$L().$4e1(t)}};_d.$14l=function(){};_d.$14l.prototype={};_d.$14l.registerEnum("_d.$14l",!1);_d.$TC=function(){};_d.$TC.prototype={$14G:!1,$4tP:null,$iR:!1,$5CG:!1,$5H5:!1,$GH:null,$7R:0,$2f0:null,get_$28E:function(){this.$2f0||(this.$2f0=new _d.$yl);return this.$2f0},set_$28E:function(n){this.$2f0=n;return n}};_d.$Bu=function(n,t,i,r,u,f,e,o,s){this.$$d_$2Zq=Function.createDelegate(this,this.$2Zq);this.$$d_$Ey=Function.createDelegate(this,this.$Ey);this.$$d_$1lg=Function.createDelegate(this,this.$1lg);this.$$d_$3VI=Function.createDelegate(this,this.$3VI);this.$$d_$35Q=Function.createDelegate(this,this.$35Q);this.$$d_$2bE=Function.createDelegate(this,this.$2bE);_d.$Bu.initializeBase(this,[n,t,i,r,u,f,e,o,s]);_a.$3.$kI(t,0,"mode");this.$G.add_$U5(this.$$d_$2bE);this.$2D6=this.$7R===1||this.$7R===3?!0:!1};function $4Mn(n,t){n.$2zb(t)}function $4Mm(n,t,i){var r=t;if(r){var u=!!r.get_$4dL()&&!!r.get_$4dL().response&&r.get_$4dL().response.responseKind===-2;n.$7S4(u,r.get_$cu(),r.$1b,i,Object.getType(r)===_c.$fJ)}}function $4Ml(n){n.$7WZ();n.$2zb(null)}function $6MA(n){if(n.$Ij){n.set_$1Ts(!0);return!0}return!1}function $6M9(n){n.$Cs=n.$tw.$75W(n.$12,n.$7R);n.$Cs.add_$8ua(n.$$d_$Ey);n.$Cs.add_$6wE(n.$$d_$2Zq);n.$Cs.add_$5pI(n.$$d_$5pH)}_d.$Bu.prototype={$Cs:null,$45l:null,$qL:null,$lX:null,$16H:!1,$Ij:!1,$GH:null,$14G:!1,$6Bu:null,$3KH:null,$2D6:!1,add_$2ex:function(n){this.$2Z("EditCompleted",n)},remove_$2ex:function(n){this.$2b("EditCompleted",n)},get_$on:function(){return this.$Cs.get_$on()},get_$SR:function(){return this.$Cs.get_$SR()},get_$bg:function(){return this.$7R===1},get_$Jr:function(){return this.$G.get_$O()!=="Mouse"?1:0},get_$1Ts:function(){return this.$16H},set_$1Ts:function(n){if(this.$16H!==n){this.$16H=n;$6(this,"IsDiscardChangesDialogShown")}return n},get_$3Uq:function(){if(!this.$lX){this.$lX=new _js.$X;this.$lX.$H(new _a.$2E(new _C(this.$$d_$35Q,_d.$Bu.$D),_u.Strings.l_ConfirmDialog_Save_Text,null));this.$lX.$H(new _a.$2E(new _C(this.$$d_$3VI,_d.$Bu.$D),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$lX.$H(new _a.$2E(new _C(this.$$d_$1lg,_d.$Bu.$D),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$lX},get_$iM:function(){return this.$Cs.$yH},get_$41A:function(){return this.$Cs.$7S},get_$5AV:function(){return _d.$88.prototype.get_$5AV.call(this)&&this.$7R!==2},get_$45m:function(){this.$45l||(this.$45l=new _y.$2f(_y.$c.get_$Ey(),_y.$c.get_$2OA(),_u.Strings.l_SaveMenuItem_LowerCase_Text,this.get_$on()));return this.$45l},get_$3OS:function(){this.$qL||(this.$qL=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItem_LowerCase_Text,this.get_$SR()));return this.$qL},get_$3gF:function(){return this.$2D6},set_$3gF:function(n){this.$2D6=n;$6(this,"IsEnteringEditMode");return n},$3v:function(){$6M9(this);this.get_$41A()&&this.get_$41A().set_$7TN(!0);_d.$88.prototype.$3v.call(this)},$xs:function(n){if(this.get_$41A()){this.get_$41A().set_$2eQ(n.$4tP);this.get_$41A().$1VR=n.$5H5}this.$Cs.set_$1o7(n.$5CG);var t=_a.$5.acss(_a.$0.$6q,"SetParentFolderId");if(this.$7R===3||this.$7R===2)if(n.$GH){this.$GH=n.$GH;this.$14G=n.$14G}else{this.$GH=_g.$2Q.$9K("contacts").get_$n();this.$14G=!0}_a.$5.aces(t)},$570:function(n){_d.$88.prototype.$570.call(this,n);this.$Cs.set_$1o7(n.get_$iM());this.$GH=n.get_$22();this.$14G=n.get_$3Rw()},$7S4:function(n,t,i,r,u){if(this.$Cs.$Cf){this.$Cs.set_$C5(!1);if(i){var f=this.$7Nb(u);this.get_$D2().$3A(0,f,null)}else if(t){var e=_c.$i.$1E5(t,r===1?3:2);this.$2zb(e)}else r===2?this.$2zb(null):n&&this.get_$D2().$3A(0,_u.Strings.l_OfflineErrorInfoMessage_Text,null)}},$4lW:function(){this.$2Zq()},$8cB:function(){this.$Ij=!1},$2Zq:function(){$6MA(this)||$4Ml(this)},$2zb:function(n){$EQ(this,"EditCompleted",n)},$7Wb:function(){},$4z3:function(n,t){n.val=[this.get_$45m(),this.get_$3OS()];t.val=null},$7Nb:function(n){return n?_u.Strings.l_SaveContactFailureMessage_Text:_u.Strings.l_UpdateContactFailureMessage_Text},$1YQ:function(n,t){if(this.$Cs.$Cf)return!0;if(this.$Ij){this.$2Zq();return!0}else{this.$1M();return!1}},$59:function(){this.$G.remove_$U5(this.$$d_$2bE);_a.$1.prototype.$59.call(this)},$2bE:function(n){this.$Ij&&n.$1OY(_u.Strings.l_PersonaCard_BrowserWindowUnloadWarning_Text)},$35Q:function(){this.$Cs.set_$C5(!0);this.$1lg();this.$Ey()},$3VI:function(){this.$1lg();$4Ml(this)},$1lg:function(){this.set_$1Ts(!1)}};_d.$J2=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9DT=Function.createDelegate(this,this.$9DT);this.$$d_$8Ve=Function.createDelegate(this,this.$8Ve);this.$$d_$5lL=Function.createDelegate(this,this.$5lL);this.$$d_$5jh=Function.createDelegate(this,this.$5jh);_d.$J2.initializeBase(this,[n,t,i,r,u,o,s,h,c]);_a.$3.$8z(this.get_$1UQ(),"ComposeGroupCard is only supported for PDLs. Specified persona is not a PDL.");_a.$3.$8z(this.$G.get_$O()==="Mouse","ComposeGroupCard is only supported for Mouse Layout.");this.$1lI=f;this.$53M=e};function $6MG(n){if(_js.$8.$14(n.$rb.$1lJ.$Fm)){_a.$6R.$3A(_u.Strings.l_GroupNamePrompt_Text,0);n.$Cs.set_$C5(!1);return!0}return!1}function $6MF(n){n.set_$7Pn(new _d.$Qs(new _d.$k8(n)));if(n.$1lI){var t=null;n.$7R===1&&(t=n.$12.get_$1h().ItemId);n.set_$8ks(n.$1lI.$4oc(t,new _d.$k8(n),_u.Strings.l_GroupCardAddMembersWatermark_Text));n.$1ZX.set_$61S(n.get_$bg())}n.$14N=new _js.$X}function $6ME(n){if(n.$14N)for(var t=0;t<n.$14N.get_$F();t++){var i=n.$14N.get_$48(t);if(i&&i.$Lv){var f=i.$4U.$12;var e=_d.$EB.$4oJ(f);var r=new _g.$IZ(new _g.$1i("PersonaMembers"));r.DeleteMemberFromPDL=e;var o=[r];var u;n.$1ii=(u=n.$1ii).concat.apply(u,o)}}}_d.$J2.prototype={$1lI:null,$53M:null,$14N:null,$eG:null,$1ii:null,$1EH:null,$rb:null,$1ZX:null,$Ax:null,get_$2cO:function(){return this.$1EH},set_$2cO:function(n){if(this.$1EH!==n){this.$1EH=n;$6(this,"CurrentMembersCountLabel")}return n},get_$7Yh:function(){return this.$eG.$1nb},get_$7Bf:function(){return this.$eG},set_$7Bf:function(n){if(this.$eG!==n){this.$eG=n;$6(this,"EditableMembers")}return n},get_$7Pn:function(){return this.$rb},set_$7Pn:function(n){this.$rb=n;$6(this,"GroupCardProfileFieldsListViewModel");return n},get_$8ks:function(){return this.$1ZX},set_$8ks:function(n){this.$1ZX=n;$6(this,"PickerViewModel");return n},get_$1PY:function(){return this.$Ax},set_$1PY:function(n){if(this.$Ax!==n){this.$Ax&&this.$Ax.$w("IsNotesLoaded",this.$$d_$5jh);this.$Ax=n;this.$Ax&&this.$Ax.$a("IsNotesLoaded",this.$$d_$5jh);$6(this,"CardNotesViewModel")}return n},get_$1UQ:function(){return!!this.$12.get_$1h()&&this.$12.get_$1h().RoutingType==="MAPIPDL"},$xs:function(n){_d.$Bu.prototype.$xs.call(this,n);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p,n.$iR));this.$7R===1&&this.$Ax.$Kt();$6MF(this);$1Nj(this)},$691:function(n){if(n){n.$Lv?this.$14N.$H(n):this.$14N.$3Q(n);this.$Ij=!0}},$Ey:function(){_a.$5.stPT(_a.$0.$9C,"SaveGroup_"+this.$G.get_$O(),3);_a.$5.$1V(_a.$0.$9C,"SaveGroup");_a.$b.$20M("VM.GroupCard.Save");var n=[];var i=this.$rb.$1Ch();n=n.concat.apply(n,i);$6ME(this);this.$1ii&&this.$1ii.length>0&&(n=n.concat.apply(n,this.$1ii));var r=this.$1ZX.$1Ch();n=n.concat.apply(n,r);if(n&&n.length>0){if($6MG(this))return;var t;if(this.$7R===1)t=new _c.$vK(this.$12.get_$5s(),n,_h.$Ae.toString(2));else{if(!this.$GH)throw Error.argumentNull("parentFolderId","Can't create group when parent folder is undefined");t=new _c.$fJ(this.$12.get_$5s(),n,new _g.$Bn(this.$GH),_h.$Ae.toString(2),this.$14G)}t.add_$2A(this.$$d_$5lL);t.add_$20(this.$$d_$5lL);this.$p.$y(t)}else{this.$Ij=!1;this.$Cs.set_$C5(!1);this.get_$SR().$s()}},$7WZ:function(){this.$rb&&this.$rb.$eC();this.$Ij=!1},$8cB:function(){_d.$Bu.prototype.$8cB.call(this);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p));this.$Ax.$Kt();this.$rb&&this.$rb.$qb();this.$1ZX&&this.$1ZX.$8sU()},$7Nb:function(n){return n?_u.Strings.l_SaveGroupFailureMessage_Text:_u.Strings.l_UpdateGroupFailureMessage_Text},$7Wb:function(){this.$7R===1&&this.$7Bu()},$7Bu:function(){this.$14N?this.$14N.$1u():this.$14N=new _js.$X;this.$1ii=[];if(this.$eG){if(this.$eG.$1w){this.$eG.$1w.$w("TableSize",this.$$d_$9DT);this.$eG.$1w.$1p.$1u()}}else{this.set_$7Bf(this.$53M.$74T(this.$G,this));this.$eG.$a(_d.$4C.$2DU,this.$$d_$8Ve)}var n=_c.$Zz.$I(this.$12,_d.$Rz.$3Zs(this.$G));this.$eG.set_$F3(new _c.$rX(n,null));this.set_$2cO(String.format(_u.Strings.l_GroupCardCurrentMembersCount_Text,0));this.$eG.$1w.$a("TableSize",this.$$d_$9DT);this.$eG.$5F()},$9DT:function(n,t){this.set_$2cO(String.format(_u.Strings.l_GroupCardCurrentMembersCount_Text,this.$eG.$1w.$SB))},$8Ve:function(n,t){$6(this,"IsEditableMembersListLoading")},$5lL:function(n){$4Mm(this,n,2)},$5jh:function(n,t){this.$Ax.$1Gv&&this.$Ax.$iR&&this.$rb.$TN&&this.$rb.$TN.$8xP(this.$12.get_$HP().get_$48(0))}};_d.$Fx=function(n,t,i,r,u,f,e,o,s){this.$$d_$5lL=Function.createDelegate(this,this.$5lL);this.$$d_$5jh=Function.createDelegate(this,this.$5jh);_d.$Fx.initializeBase(this,[n,t,i,r,u,f,e,o,s])};function $6MI(n){var t=new _d.$xN(n);n.set_$8kV(new _d.$1H(t,0));n.set_$8kW(new _d.$1H(t,1));n.set_$8kU(new _d.$1H(t,2))}function $6MJ(n){n.$Zx.$qb();n.$10n.$qb();n.$jc.$qb()}function $6MK(n){var t=new _c.$5n;t.set_$mh(!0);t.set_$1l("Outlook");t.set_$15(!1);n.$12.get_$3f()||n.$12.set_$3f(new _js.$X);if(n.$12.$54H()){n.$31u=_h.$3q.$26K();t.set_$1y(n.$12.get_$3f().get_$F().toString());n.$12.get_$3f().$H(t);n.$12.get_$Qr()&&n.$12.get_$Qr().$H(n.$12.get_$Qr().get_$48(0),n.$12.get_$3f().get_$F().toString())}else{n.$31u=n.$12.$7SC()?n.$12.get_$5s():_h.$3q.$26K();for(var r=n.$12.get_$3f().get_$F(),i=0;i<r;i++){var u=n.$12.get_$3f().get_$48(i);if(u.get_$1l()==="GAL"){t.set_$1y(i.toString());n.$12.get_$3f().set_$48(i,t);break}}}n.$3KH=t.get_$1y()}_d.$Fx.prototype={$Zx:null,$10n:null,$jc:null,$Ax:null,$31u:null,get_$7Te:function(){return _g.$S.get_$L().get_$38().get_$73()==="ja-JP"},get_$7at:function(){return this.$7R===2&&this.get_$mf()},get_$8kV:function(){return this.$Zx},set_$8kV:function(n){this.$Zx=n;$6(this,"PersonaCardProfileFieldsListViewModelLeft");return n},get_$8kW:function(){return this.$10n},set_$8kW:function(n){this.$10n=n;$6(this,"PersonaCardProfileFieldsListViewModelRight");return n},get_$8kU:function(){return this.$jc},set_$8kU:function(n){this.$jc=n;$6(this,"PersonaCardProfileFieldsListViewModelBottom");return n},get_$1PY:function(){return this.$Ax},set_$1PY:function(n){if(this.$Ax!==n){this.$Ax&&this.$Ax.$w("IsNotesLoaded",this.$$d_$5jh);this.$Ax=n;this.$Ax&&this.$Ax.$a("IsNotesLoaded",this.$$d_$5jh);$6(this,"CardNotesViewModel")}return n},$3v:function(){_d.$Bu.prototype.$3v.call(this);$6MI(this);this.$7R===3&&$6MK(this);$1Nj(this)},$xs:function(n){_d.$Bu.prototype.$xs.call(this,n);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p,n.$iR));this.$7R===1&&this.$Ax.$Kt()},$7WZ:function(){this.$Zx.$eC();this.$10n.$eC();this.$jc.$eC();this.$Ij=!1},$8cB:function(){_d.$Bu.prototype.$8cB.call(this);$6MJ(this)},$Ey:function(){_a.$5.stPT(_a.$0.$9C,"SavePersona_"+this.$G.get_$O(),3);_a.$5.$1V(_a.$0.$9C,"SaveContact");_a.$b.$20M("VM.PersonCard.Save");var i=this.$Zx.$1Ch();var u=this.$10n.$1Ch();var f=this.$jc.$1Ch();var r=i.concat.apply(i,u);var t=r.concat.apply(r,f);if(!$8(t)&&t.length>0){var n=null;if(this.$7R===1)n=new _c.$vK(this.$12.get_$5s(),t,_h.$Ae.toString(1));else{if($8(this.$GH))throw Error.argumentNull("parentFolderId","Can't create persona when parent folder is undefined");n=new _c.$fJ(this.$7R===3?this.$31u:this.$12.get_$5s(),t,new _g.$Bn(this.$GH),_h.$Ae.toString(1),this.$14G)}n.add_$2A(this.$$d_$5lL);n.add_$20(this.$$d_$5lL);n.$BP=this.$8L.$9S;this.$p.$y(n)}else{this.$Ij=!1;this.$Cs.set_$C5(!1);this.get_$SR().$s()}},$5lL:function(n){$4Mm(this,n,1)},$5jh:function(n,t){this.$Ax.$1Gv&&this.$Ax.$iR&&this.$jc&&this.$jc.$qb()}};_d.$4r=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$8XF=Function.createDelegate(this,this.$8XF);this.$$d_$3y2=Function.createDelegate(this,this.$3y2);this.$$d_$8aS=Function.createDelegate(this,this.$8aS);this.$$d_$5ke=Function.createDelegate(this,this.$5ke);_d.$4r.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$1Sq=e};_d.$4r.$51R=function(n){return!n.get_$1h()||_js.$8.$c(n.get_$1h().EmailAddress)?"":n.get_$1h().EmailAddress};function $6Nv(n){return n.get_$1UQ()?0:0}function $6Nx(n){return 1}function $6Nw(n){return n.get_$1UQ()?1:2}function $6Ny(n,t){var i=new _c.$Mt(t.$5J,t.$23G,t.$9e,t.$ob,1);n.set_$Lu(!0);i.add_$2m(n.$$d_$8XF);n.$p.$y(i)}function $6Nu(n,t,i){i.val=null;if(!$8(t)&&t.length>0){i.val=new _js.$X;for(var r=0;r<t.length;r++)i.val.$H($6Nt(n,t[r]))}}function $6Nt(n,t){var i=n.$1Sq.$I(t);i.add_$417(n.$$d_$4oB);return i}function $6Ns(n){if(!$8(n.$1K9)){n.$1K9.$1u();n.$1K9=null}}_d.$4r.prototype={$1K9:null,$HI:null,$1Sq:null,$Ax:null,get_$1PY:function(){return this.$Ax},set_$1PY:function(n){if(this.$Ax!==n){this.$Ax=n;$6(this,"CardNotesViewModel")}return n},get_$2BD:function(){return this.$8L.$27i?!0:this.$12.$2Aw()||!this.get_$1UQ()},get_$5AY:function(){return this.get_$AG()===$6Nv(this)},get_$5AZ:function(){return this.get_$AG()===$6Nx(this)},get_$2me:function(){return this.get_$AG()===$6Nw(this)},get_$7aa:function(){return this.$HI.$1nb},get_$25l:function(){var n=_d.$6S.prototype.get_$25l.call(this);n.$iR=this.$Ax.$iR;return n},get_$37f:function(){return this.$8L.$1RB?!1:!this.$12.$2Aw()&&this.get_$1UQ()},get_$7Yd:function(){return!!this.$12.get_$1h()&&this.$12.get_$1h().RoutingType.toUpperCase()==="SMTP"},get_$1UQ:function(){return!!this.$12.get_$1h()&&this.$12.get_$1h().RoutingType.toUpperCase()==="MAPIPDL"},get_$78W:function(){return _u.Strings.l_DeleteGroupConfirmationPromptTile_Text},$3v:function(){_d.$6S.prototype.$3v.call(this);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p));this.$HI=new _d.$Rz(this.$G,0);this.$HI.add_$5xO(this.$$d_$5ke);this.$HI.$a(_d.$4C.$2DU,this.$$d_$8aS);var n=_d.$4r.$51R(this.$12);this.get_$41A().$J1(2,n,0);$1Nj(this)},$7Wi:function(){this.get_$2me()&&this.$Ax.$Kt()},$51U:function(){var n=_u.Strings.l_GroupCardMembersWithoutCountPivotOption_Text;var i=_u.Strings.l_GroupCardOwnersWithoutCountPivotOption_Text;var t=_u.Strings.l_GroupCardNotesPivotOption_Text;return this.get_$1UQ()?[new _a.$5D(n,null),new _a.$5D(t,null)]:[new _a.$5D(n,null),new _a.$5D(i,null),new _a.$5D(t,null)]},$7Ma:function(){return this.get_$5AZ()?24:this.get_$2me()?21:this.get_$5AY()?25:100},$8cB:function(){_d.$6S.prototype.$8cB.call(this);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p));var n=_d.$4r.$51R(this.$12);this.get_$41A().$J1(2,n,0)},$7bV:function(){return!0},$8w0:function(){$Ha(this,[_d.$4r.$3ga,_d.$4r.$3gc,_d.$4r.$3gb]);this.get_$2me()&&this.$Ax.$Kt()},$7Wb:function(){if(this.$12.get_$1h()&&this.$12.get_$1h().ItemId||this.$12.get_$5s()){var t=_c.$Zz.$I(this.$12,_d.$Rz.$3Zs(this.$G));$6Ny(this,t);this.$HI.set_$F3(new _c.$rX(t,null));this.$HI.$5F()}else if(this.$12.get_$1h()&&_a.$3I.$OZ(this.$12.get_$1h().EmailAddress)){this.set_$Lu(!0);var n=_c.$14.$4oS(this.$12.get_$1h().EmailAddress,_c.$14.$hn);n.add_$2m(this.$$d_$3y2);this.$p.$y(n)}},$5ke:function(n,t){var i=n;if(i&&i.$13){this.$4oB(i.$13);this.$HI.set_$25(null)}},$3y2:function(n){var t=n;($8(this.$12.get_$1h())||$8(this.$12.get_$1h().ItemId))&&$8(this.$12.get_$5s())&&this.set_$Lu(!1);if($8(t.$1b)&&t.$As.get_$F()>0){$8(this.get_$41A())||(this.get_$41A().$1VR=!0);var i=t.$As.get_$48(0);this.set_$1v(i)}t.remove_$2m(this.$$d_$3y2)},$8XF:function(n){var t=n;this.set_$Lu(!1);if(!t.$1b){var r=_a.$5.acss(_a.$0.$2Aj,"SetGroupMembers");$6Ns(this);var i;$6Nu(this,t.$1K9,i={val:this.$1K9});this.$1K9=i.val;this.get_$7Yd()&&this.$Ax.set_$HP(t.$TN);t.$8w&&this.$12.set_$5s(t.$8w);this.get_$1UQ()&&this.get_$AG()===1&&this.$Ax.$Kt();this.get_$41A().$J1(1,t.$Sb,0);_a.$5.aces(r);_a.$5.$1G(null,"OpenContact");_a.$5.$1G(null,"NavigateToPeople");_a.$5.endPT("OpenPersonCard_"+this.$G.get_$O());_a.$5.endPT("NavigateToPeopleHub_"+this.$G.get_$O());$4PI(this);$1e9(this);$Ha(this,[_d.$4r.$5JM,_d.$4r.$5mp,_d.$4r.$3ga,_d.$4r.$3gc,_d.$4r.$3gb])}},$8aS:function(n,t){$6(this,"IsMembersListLoading")}};_d.$Aa=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$8WQ=Function.createDelegate(this,this.$8WQ);_d.$Aa.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};function $6OH(n){n.$42l=new _d.$RJ(new _d.$uB(n));n.$42l.$8y6(n.$12);$6(n,_d.$Aa.$5qw)}function $6OG(n,t){var i=new _g.$Qi;i.Id=t.get_$2g().get_$yi();i.Sources=4;i.MaxResults=1;var r=new _c.$kk(i);r.add_$2m(n.$$d_$8WQ);n.$p.$y(r)}_d.$Aa.prototype={$42l:null,get_$2BD:function(){return!0},get_$5BI:function(){return this.get_$AG()===1},get_$37f:function(){return!1},$3v:function(){_d.$Lm.prototype.$3v.call(this);$4OU(this,0);$1Nj(this)},$51U:function(){var n=new(_0365f.$s.$$(_a.$5D));n.$H(new _a.$5D(_u.Strings.l_PersonaCardLocationPivotOption_Text,null));this.$12.get_$2g().get_$RR()==="PhonebookServices"&&n.$H(new _a.$5D(_u.Strings.l_PersonaCardLocationInformationPivotOption_Text,null));return n.$7V()},$7Wb:function(){var n=this.$12;if(n.get_$2g().get_$RR()==="PhonebookServices"&&!_js.$8.$c(n.get_$2g().get_$yi()))if(n.get_$9m()!==3){this.set_$Lu(!0);$6OG(this,n)}else $6OH(this)},$8w0:function(){_d.$Lm.prototype.$8w0.call(this);$6(this,_d.$Aa.$5BJ)},$7Ma:function(){return this.get_$5BI()?20:this.get_$3hQ()?26:100},$8WQ:function(n){this.set_$Lu(!1);var t=n;if(!t.$1b&&t.$As.get_$F()===1){var i=t.$As.get_$48(0);i.set_$9m(3);this.set_$1v(i)}}};_d.$x5=function(n,t,i,r){_d.$x5.initializeBase(this,[1,"VM.PersonCard.Open"]);this.set_$pp(n);this.set_$4h(t);this.set_$3cy(i);this.set_$5E(r)};_d.$x5.prototype={get_$pp:function(){return this.$W("a")},set_$pp:function(n){$1O(this,"a",n);return n},get_$4h:function(){return this.$W("loc")},set_$4h:function(n){$1O(this,"loc",n);return n},get_$3cy:function(){return this.$W("h")},set_$3cy:function(n){$1O(this,"h",n);return n},get_$5E:function(){return this.$W("t")},set_$5E:function(n){$1O(this,"t",n);return n}};_d.$ni=function(n,t,i,r){_d.$ni.initializeBase(this,[1,"VM.Recipient.Cache"]);this.set_$pp(n);this.set_$5rS(t);this.set_$4iT(i);$8(r)?this.set_$P0(-100):this.set_$P0(r)};_d.$ni.prototype={get_$pp:function(){return this.$W("A")},set_$pp:function(n){$1O(this,"A",n);return n},get_$5rS:function(){return this.$W("QL")},set_$5rS:function(n){$1O(this,"QL",n);return n},get_$4iT:function(){return this.$W("CRL")},set_$4iT:function(n){$1O(this,"CRL",n);return n},get_$P0:function(){return this.$W("SI")},set_$P0:function(n){$1O(this,"SI",n);return n},$4DX:function(){var n=new _a.$7t;n.$7c("a",this.get_$pp()).$7c("ql",this.get_$5rS()).$7c("crl",this.get_$4iT()).$7c("si",this.get_$P0());return n.toString()}};_d.$yl=function(){};_d.$yl.prototype={$2GG:null,$BN:null,$2zu:!1};_d.$EB=function(n,t,i,r,u,f){this.$$d_$3yX=Function.createDelegate(this,this.$3yX);this.$$d_$8b5=Function.createDelegate(this,this.$8b5);_d.$EB.initializeBase(this);_a.$3.$17(t,"findRecipientViewModelFactory");_a.$3.$17(i,"recipientWellViewModelFactory");_a.$3.$17(r,"personaViewModelFactory");_a.$3.$17(f,"groupCard");this.$Ys=t;this.$50=r;this.$53K=u;this.$3bE=f;this.$36=$6No(this,n);this.set_$7hy(i.$74V(_y.$q.$Hr));this.$Oe.$1L.add_$1Z(this.$$d_$8b5)};_d.$EB.$4oJ=function(n){var t=n.get_$1h();t.RoutingType==="MAPIPDL"&&(t.EmailAddress="");t.ItemId&&(t.ItemId.ChangeKey=null);return t};function $6No(n,t){var r=_c.$14.$rT;n.$328=!1;if(n.$3bE.get_$1v().get_$18()===5){r=_c.$14.$7KD;n.$328=!0}var i=n.$Ys.$I(r,_c.$14.$bV(),!0,"PersonaDetailedView",n.$328,n.$50);_d.$CO.$1QB(i);i.$vd();i.set_$L8(t);i.set_$1aY("PersonaDetailedView");i.add_$jv(n.$$d_$3yX);return i}function $6Nj(n,t){var i=t.$Wp();if(n.$328&&!$6Nn(n,i))n.get_$D2().$3A(0,_u.Strings.l_RecipientNotInAd_PeoplePicker_Text,null);else if(!$6Nk(n,i)){var r=_c.$i.$E5(i);r.set_$18(t.get_$1v().get_$18());r.set_$5s(t.get_$1v().get_$5s());var u=$6Nm(n,r);u.$1AQ=!0;n.$Oe.$6rG(u,3)}}function $6Nn(n,t){return t.MailboxType==="Mailbox"}function $6Nk(n,t){var i=t.ItemId;return i&&t.MailboxType==="PrivateDL"&&i===n.$53K?!0:$6Nl(n,t)}function $6Nl(n,t){if(t){if(!$8(t.ItemId)&&!$8(t.ItemId.Id)){for(var e=t.ItemId.Id.toLowerCase(),r=0;r<n.$Oe.$84.get_$F();r++){var i=n.$Oe.$84.get_$48(r);if(i&&!$8(i.ItemId)&&!$8(i.ItemId.Id)&&i.ItemId.Id.toLowerCase()===e)return!0}return!1}if(t.EmailAddress)for(var o=t.EmailAddress.toLowerCase(),u=0;u<n.$Oe.$84.get_$F();u++){var f=n.$Oe.$84.get_$48(u);if(f&&f.EmailAddress&&f.EmailAddress.toLowerCase()===o)return!0}}return!1}function $6Nm(n,t){var i=n.$50.$SX(t,n.$Oe.$1Kz,!0,1);var r=[1];i.$Xp(1,r,"");return i}_d.$EB.prototype={$36:null,$Ys:null,$50:null,$53K:null,$3bE:null,$Oe:null,$2yP:null,$328:!1,$1r:null,$497:!1,get_$7hy:function(){return this.$Oe},set_$7hy:function(n){this.$Oe=n;$6(this,"MembersRecipientWellViewModel");return n},get_$8Pc:function(){return this.$2yP},set_$8Pc:function(n){if(this.$2yP!==n){this.$2yP=n;$4Z(this,"NewlyAddedMembersCountLabel","IsNewlyAddedMembersLabelShown")}return n},get_$D2:function(){return this.$1r||(this.$1r=new _y.$4p)},get_$7as:function(){return!!this.$Oe&&!!this.$Oe.$1L&&this.$Oe.$1L.get_$F()>0},get_$61S:function(){return this.$497},set_$61S:function(n){this.$497=n;$6(this,"ShowCompactList");return n},$8sU:function(){this.$Oe.$1L.$1u()},$1Ch:function(){var n=[];if(this.$Oe&&this.$Oe.$1L)for(var t=0;t<this.$Oe.$1L.get_$F();t++){var i=this.$Oe.$1L.get_$48(t);if(i){var r=i.$4U.$12;if(r){var f=_d.$EB.$4oJ(r);var u=new _g.$IZ(new _g.$1i("PersonaMembers"));u.AddMemberToPDL=f;var e=[u];n=n.concat.apply(n,e)}}}return n},$3yX:function(n,t){var i=n.get_$Vm();if(!$8(i)){$6Nj(this,i);this.$3bE.set_$1ml(!0)}},$8b5:function(n,t){this.set_$8Pc(String.format(_u.Strings.l_GroupCardNewlyAddedMembersCount_Text,this.$Oe.$1L.get_$F()))}};_d.$My=function(n,t){this.$$d_$8cC=Function.createDelegate(this,this.$8cC);_d.$My.initializeBase(this);$8(n)&&Error.argumentNull("persona");this.$12=n;this.$7S=$6Ni(this,t)};function $6Ni(n,t){var i=null;i=$8(t)?new _d.$7u(n.$12,_y.$q.$Hr,!1,1):t.$SX(n.$12,_y.$q.$Hr,!1,1);i.set_$14y(!0);i.set_$DA(!0);i.set_$We(new _C(n.$$d_$8cC,_a.$0.$6q));i.set_$Bs(i.$1RK);return i}_d.$My.prototype={$12:null,$7S:null,add_$417:function(n){this.$2Z("PersonaClicked",n)},remove_$417:function(n){this.$2b("PersonaClicked",n)},$8cC:function(){$EQ(this,"PersonaClicked",this.$12)}};_d.$59=function(n,t){this.$3jq=this.$$gta["_d.$59"].T===Number||Type.isEnum(this.$$gta["_d.$59"].T)?0:this.$$gta["_d.$59"].T===Boolean?!1:null;this.$3jq=n;this.$2eR=t};_d.$59.$$=function(n){var i="$59"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[i]){var t=_d[i]=function(){(this.$$gta=this.$$gta||{})["_d.$59"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$59.apply(this,i)};t.registerClass("_d."+i);var u=_d.$59.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$9IT=function(n){var r=null;var u=new(_0365f.$s.$$(String));if($8(n.get_$5l())||!n.get_$5l().length)return null;r=[];for(var t=0,e=0,o=n.get_$5l().length;t<o;++t){var f=!$8(n.get_$5l()[t])&&n.get_$5l()[t].RoutingType==="MAPIPDL";if(!$8(n.get_$5l()[t])&&(f||!_js.$8.$c(n.get_$5l()[t].EmailAddress))){var i=_g.$2I.$1HA(n.get_$5l()[t])?n.get_$5l()[t].OriginalDisplayName:n.get_$5l()[t].EmailAddress;if(!f&&(_js.$8.$14(i)||u.$6l(i.toLowerCase())))continue;r[e++]=new(_d.$59.$$(_g.$1m))(n.get_$5l()[t],i);n.get_$5l()[t].RoutingType!=="MAPIPDL"&&u.$H(i.toLowerCase())}}return r};t.$9IU=function(n,t){var s=new(_0365f.$s.$$(String));var r=n.get_$bd();if($8(r)||!r.get_$F())return null;for(var h=[],f=0,c=0,l=r.get_$F();f<l;++f){var e=r.$6tv(f);if(!$8(e)&&!$8(e.get_$1d())){var o=e.get_$1d();if(!_js.$8.$c(t)&&o.trim().toLowerCase()===t)continue;var u=o.trimStart();var i=u.toLowerCase();if(i.startsWith("sip:")){u=i.substr(4).trimStart();i=u.toLowerCase()}if(s.$7h(i)<0){s.$H(i);h[c]=new(_d.$59.$$(String))(o,u);c++}}}return h};t.$9IV=function(n){var i=[];t.$ES(n.get_$hH(),_u.Strings.l_BusinessPhoneNumber_Text,n,i);t.$ES(n.get_$vf(),_u.Strings.l_BusinessPhoneNumber_Text,n,i);t.$ES(n.get_$np(),_u.Strings.l_MobilePhoneNumber_Text,n,i);t.$ES(n.get_$zx(),_u.Strings.l_MobilePhoneNumber_Text,n,i);t.$ES(n.get_$m5(),_u.Strings.l_HomePhoneNumber_Text,n,i);t.$ES(n.get_$xh(),_u.Strings.l_HomePhoneNumber_Text,n,i);t.$ES(n.get_$19D(),_u.Strings.l_OtherPhoneNumber_Text,n,i);t.$ES(n.get_$1Bm(),_u.Strings.l_BusinessFaxPhoneNumber_Text,n,i);t.$ES(n.get_$15x(),_u.Strings.l_HomeFaxPhoneNumber_Text,n,i);t.$ES(n.get_$19C(),_u.Strings.l_OtherFaxPhoneNumber_Text,n,i);t.$ES(n.get_$19A(),_u.Strings.l_OrganizationMainPhoneNumber_Text,n,i);t.$ES(n.get_$13T(),_u.Strings.l_AssistantPhoneNumber_Text,n,i);t.$ES(n.get_$13r(),_u.Strings.l_CallbackPhoneNumber_Text,n,i);t.$ES(n.get_$19F(),_u.Strings.l_PagerPhoneNumber_Text,n,i);t.$ES(n.get_$19m(),_u.Strings.l_RadioPhoneNumber_Text,n,i);t.$ES(n.get_$1B9(),_u.Strings.l_TelexPhoneNumber_Text,n,i);t.$ES(n.get_$1BN(),_u.Strings.l_TTYTDDPhoneNumber_Text,n,i);return i};t.$ES=function(n,t,i,r){if(!$8(n)&&n.get_$F())for(var e=0,s=r.length,h=n.get_$F();e<h;++e){var u=n.$6tv(e);if(!$8(u)&&!$8(u.get_$1d())){var o=u.get_$1d();if(!_js.$8.$14(o.Number)){var f=h>1?_d.$2Y.$29g(u,i,""):"";f=_js.$8.$c(f)?"":String.format(" {0}",f);var c=String.format("{0} [{1}{2}]",o.Number,t,f);r[s]=new(_d.$59.$$(_g.$2u))(o,c);s++}}}};t.$7UR="sip:"}return _d[i]};_d.$59.prototype={$2eR:null,get_$9IS:function(){return this.$3jq},get_$1jB:function(){return this.$2eR}};_d.$NN=function(n,t,i,r,u){this.$$d_$2zG=Function.createDelegate(this,this.$2zG);this.$$d_$8hc=Function.createDelegate(this,this.$8hc);this.$$d_$8TT=Function.createDelegate(this,this.$8TT);_d.$NN.initializeBase(this,[n,t,i]);this.$p=r;this.$CR=u;this.$G.get_$O()==="TouchNarrow"&&this.set_$7E($6Pl(this))};_d.$NN.$I=function(n,t,i,r,u){return new _d.$NN(n,t,i,r,u)};function $6Pl(n){var t;t=n.get_$pW().get_$254()?[n.get_$pW().get_$45m(),n.get_$pW().get_$4rf(),new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItem_LowerCase_Text,new _C(n.$$d_$2zG,_a.$0.$1d8))]:[new _y.$2f(_y.$c.get_$1Cs(),_y.$c.get_$1Ok(),_u.Strings.l_ButtonBack_Text,new _C(n.$$d_$AQ,_a.$0.$1d8))];return _y.$26.$Bv(n,t,null)}_d.$NN.prototype={$p:null,$CR:null,$v6:null,get_$6x6:function(){return this.get_$pW().get_$254()?new _C(this.$$d_$8TT,_a.$0.$1d8):null},get_$pW:function(){if(!this.$v6){this.$v6=_d.$5I.$4oQ(this.$G,this.$p,this.$CR);this.$v6.add_$69s(this.$$d_$8hc)}return this.$v6},get_$7cp:function(){return this.$G.get_$O()==="TouchWide"},get_$2ec:function(){return 15},get_$2Bc:function(){return this.get_$pW().$1GB},$Rx:function(){_y.$1De.prototype.$Rx.call(this);this.get_$pW().$5u8()},$74J:function(){return null},$768:function(){return null},$73f:function(){return{}},$8TT:function(){this.$G.$9T(this.get_$pW())},$8hc:function(){this.$G.get_$O()==="TouchNarrow"?this.$AQ():$6(this,"ImageSource")},$2zG:function(){this.get_$pW().$2zG()||this.$AQ()}};_d.$ta=function(n,t,i,r,u,f){_d.$ta.initializeBase(this,[n,t,i,r,u]);this.$23U=f};_d.$ta.prototype={$23U:!1,$75k:function(n,t){var i=n.$2c3(2,_y.$q.$Mp,t);i.$36.set_$OY(!1);return i},$542:function(){this.get_$Xh().$15P();_d.$7b.prototype.$542.call(this)},$5js:function(n){this.$23U||this.get_$Xh().$1L.$1u();_d.$7b.prototype.$5js.call(this,n)}};_d.$12z=function(n,t,i,r){this.$$d_$8hM=Function.createDelegate(this,this.$8hM);this.$$d_$3BP=Function.createDelegate(this,this.$3BP);_d.$12z.initializeBase(this,[n,t,i,r]);this.$68U=new _d.$ga(_u.Strings.l_LinkPersonaCardUnlinkButtonText_Text,this.$$d_$3BP,this)};_d.$12z.prototype={$68U:null,get_$3kr:function(){return 0},$3BP:function(){this.set_$1Hf(!0);var n=new _c.$18e(this.get_$1v().get_$5s(),this.get_$1v().get_$3f().get_$48(0).get_$pA());n.add_$2m(this.$$d_$8hM);OwaApplication.$1T.$y(n)},$8hM:function(n){var t=n;if(t.$1b)$2Ty(this,t.$1b,_u.Strings.l_LinkPersonaCardUnlinkFailureText_Text);else{var i=t.$1N9;$2Tx(this);$2Tz(this,i)}this.set_$1Hf(!1)}};_d.$ga=function(n,t,i){var r=this;_d.$ga.initializeBase(this,[t,_a.$0.$1Hg,i,_d.$7F.$3kq,function(){return!i.$2q0}]);this.$2eR=n};_d.$ga.prototype={$2eR:null};_d.$7F=function(n,t,i,r){_d.$7F.initializeBase(this);_a.$3.$17(n,"personaGetter");_a.$3.$17(t,"updatePersona");_a.$3.$17(i,"closeLinkPersonaCard");_a.$3.$17(r,"showErrorMessage");this.$5oD=n;this.$69M=t;this.$4lS=i;this.$1yY=r};_d.$7F.$3aL=function(n){var i=n.$3b3();var t;switch(i.length){case 0:t="";break;case 1:t=i[0].get_$1SN();break;default:t=String.format(_u.Strings.l_LinkPersonaCardSuggestedPersonaDescription_Text,i.length);break}return t};_d.$7F.$9Bh=function(n,t){t.val=n[_d.$7F.$64D];return!$8(t.val)};function $2Tz(n,t){n.$69M(t)}function $2Tx(n){n.$4lS()}function $2Ty(n,t,i){var u=i;var r;var f,e;(e=_d.$7F.$9Bh(t,f={val:r}),r=f.val,e)&&(_g.$7N.$11r(r)||(u=_u.Strings.l_LinkPersonaCardConnectionFailureText_Text));n.$1yY(u)}_d.$7F.prototype={$69M:null,$4lS:null,$1yY:null,$5oD:null,$2q0:!1,get_$1Hf:function(){return this.$2q0},set_$1Hf:function(n){if(this.$2q0!==n){this.$2q0=n;$Q(this,_d.$7F.$3kq)}return n},get_$1v:function(){return this.$5oD()}};_d.$Oe=function(n,t,i,r,u,f){this.$$d_$7Mc=Function.createDelegate(this,this.$7Mc);this.$$d_$6yY=Function.createDelegate(this,this.$6yY);_d.$Oe.initializeBase(this);_a.$3.$17(n,"owaShell");_a.$3.$17(i,"parentSummaryCardViewModel");_a.$3.$17(u,"persona");_a.$3.$17(f,"onLinkActionCompleted");this.$G=n;this.$1KQ=t;this.$2al=new _C(this.$$d_$6yY,_d.$Oe.$D);this.$1lZ=new _d.$7u(u,2,!1,3);this.$1G5=new _d.$7u(u,8,!1);this.$1G5.$J1(1,_d.$7F.$3aL(u),0);this.$HS=$6O9(this,u);this.$HS.$1Aj(u);this.$N3=new _y.$4p;var o=this;var e=function(n){o.$N3.$3A(0,n,null)};r?r===1?this.$ye=new _d.$131(i.$12,this.$$d_$7Mc,f,this.$$d_$6yY,e):r===2&&(this.$ye=new _d.$13S(i.$12,this.$$d_$7Mc,f,this.$$d_$6yY,e)):this.$ye=new _d.$12z(this.$$d_$7Mc,f,this.$$d_$6yY,e);this.$31U=i;this.set_$7E(this.$1QM())};function $6O9(n,t){var i=new _d.$Gu;i.$9S=9;if(n.$G.get_$O()!=="TouchNarrow"){i.$2e3=!0;i.$1RB=!0}i.$1Ee=!0;i.$27j=!0;return n.$1KQ.$I(i,0)}_d.$Oe.prototype={$G:null,$1KQ:null,$ye:null,$2al:null,$1lZ:null,$1G5:null,$HS:null,$N3:null,$31U:null,get_$1nk:function(){return this.$G.get_$O()==="Mouse"},get_$7Zh:function(){return!this.$ye.get_$3kr()},get_$7a0:function(){return this.$ye.get_$3kr()===1},get_$7Zs:function(){return this.$ye.get_$3kr()===2},get_$9CU:function(){return this.$ye.$68U},get_$6pN:function(){return this.$ye.$4d7},get_$7gi:function(){return this.$ye.$5I4},get_$8px:function(){return this.$ye.$5sT},$6yY:function(){if(_d.$Oe.isInstanceOfType(this.$31U.get_$3L().get_$7L())){this.$HS.$1M();this.$31U.$2aX();this.$31U.get_$3L().$BX()}},$7Mc:function(){return this.$HS.$5u.$12}};_d.$aS=function(n,t,i,r,u,f){_d.$aS.initializeBase(this,[n,t,i,r,u,f])};_d.$aS.prototype={get_$Jr:function(){return this.$G.get_$O()==="TouchWide"?1:this.$G.get_$O()==="TouchNarrow"?2:0},$1QM:function(){if(this.$G.get_$O()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,this.$2al);return _y.$26.$Bv(this,n,null)}else if(this.$G.get_$O()==="TouchNarrow"){var t=_y.$26.$Bv(this);t.$dc(this.$2al);return t}return null}};_d.$131=function(n,t,i,r,u){this.$$d_$8dh=Function.createDelegate(this,this.$8dh);this.$$d_$8Qz=Function.createDelegate(this,this.$8Qz);this.$$d_$8pw=Function.createDelegate(this,this.$8pw);this.$$d_$6pM=Function.createDelegate(this,this.$6pM);_d.$131.initializeBase(this,[t,i,r,u]);_a.$3.$17(n,"originalPersona");this.$2LN=n;this.$4d7=new _d.$ga(_u.Strings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$6pM,this);this.$5sT=new _d.$ga(_u.Strings.l_LinkPersonaCardRejectSuggestionButtonText_Text,this.$$d_$8pw,this)};_d.$131.prototype={$2LN:null,$4d7:null,$5sT:null,get_$3kr:function(){return 1},$6pM:function(){this.set_$1Hf(!0);var n=new _c.$vY(this.$2LN.get_$5s(),this.get_$1v().get_$5s());n.add_$2m(this.$$d_$8Qz);OwaApplication.$1T.$y(n)},$8Qz:function(n){var t=n;if(t.$1b)$2Ty(this,t.$1b,_u.Strings.l_LinkPersonaCardAcceptSuggestionFailureText_Text);else{var i=t.$1N9;$2Tx(this);$2Tz(this,i)}this.set_$1Hf(!1)},$8pw:function(){this.set_$1Hf(!0);var n=new _c.$15S(this.$2LN.get_$5s(),this.get_$1v().get_$5s());n.add_$2m(this.$$d_$8dh);OwaApplication.$1T.$y(n)},$8dh:function(n){var t=n;if(t.$1b)$2Ty(this,t.$1b,_u.Strings.l_LinkPersonaCardRejectSuggestionFailureText_Text);else{var i=t.$1N9;$2Tx(this);$2Tz(this,i)}this.set_$1Hf(!1)}};_d.$IN=function(){this.$$d_$8XU=Function.createDelegate(this,this.$8XU);_d.$IN.initializeBase(this);this.$Ar()};function $6OB(n,t,i){_a.$3.$17(t,"personaId");var r=$8(i)||!i.length?3:2;$2U0(n,r,t,i,null)}function $6OA(n,t,i){_a.$3.$17(t,"personaId");$2U0(n,4,t,null,i)}function $2U0(n,t,i,r,u){var f=!1;if(n.$Dx!==t){n.$Dx=t;f=!!(f|!0)}if(n.$8w!==i){n.$8w=i;f=!!(f|!0)}if(n.$gf!==r){n.$gf=r;f=!!(f|!0)}if(n.$1b!==u){n.$1b=u;f=!!(f|!0)}f&&$4Z(n,"LinkSuggestionIdsStatusText","LinkSuggestionsAvailable")}_d.$IN.prototype={$Dx:0,$8w:null,$gf:null,$1b:null,get_$7em:function(){switch(this.$Dx){case 0:case 1:return _u.Strings.l_LoadingWithEllipses_Text;case 2:return _u.Strings.l_PersonaCardSuggestionsAvailable_Text;case 3:return _u.Strings.l_LinkSummaryCardNoSuggestionsText_Text;case 4:return _u.Strings.l_LinkSummaryCardGetSuggestionsFailureText_Text;default:throw Error.invalidOperation("LinkSuggestionIdsViewModel are in an unknown status: "+this.$Dx);}},get_$7eo:function(){return this.$Dx===2},get_$7en:function(){return this.$Dx===1},$Ar:function(){$2U0(this,0,null,null,null)},$7OU:function(n){_a.$3.$17(n,"newPersonaId");if(!this.$Dx||n!==this.$8w){$2U0(this,1,n,null,null);var t=new _c.$10W(n);t.add_$2m(this.$$d_$8XU);OwaApplication.$1T.$y(t)}},$8XU:function(n){var t=n;_0365f.$2t.$4F(t.$8w,this.$8w)&&(t.$1b?$6OA(this,this.$8w,t.$1b):$6OB(this,this.$8w,t.$gf))}};_d.$50=function(n,t,i){this.$$d_$3y2=Function.createDelegate(this,this.$3y2);this.$$d_$8Xc=Function.createDelegate(this,this.$8Xc);this.$$d_$5it=Function.createDelegate(this,this.$5it);this.$$d_$392=Function.createDelegate(this,this.$392);this.$$d_$WM=Function.createDelegate(this,this.$WM);this.$$d_$4uw=Function.createDelegate(this,this.$4uw);this.$$d_$8eu=Function.createDelegate(this,this.$8eu);this.$$d_$8gb=Function.createDelegate(this,this.$8gb);this.$$d_$8U4=Function.createDelegate(this,this.$8U4);this.$$d_$8ZU=Function.createDelegate(this,this.$8ZU);this.$$d_$3Pb=Function.createDelegate(this,this.$3Pb);_d.$50.initializeBase(this);_a.$3.$17(n,"owaShell");_a.$3.$17(t,"linkPersonaCardViewModelFactory");_a.$3.$17(i,"persona");this.$G=n;this.$2q1=t;this.$25c=new _C(this.$$d_$3Pb,_d.$50.$D);this.$N3=new _y.$4p;this.$25j=new _js.$X;this.set_$630(!0);this.$fA=new _d.$IN;this.$fA.$a("LinkSuggestionsAvailable",this.$$d_$8ZU);this.$gg=new _js.$X;this.$1ap=new _js.$X;this.$5zj(i);this.set_$7E(this.$1QM());this.set_$1i2("");this.$4m9=new _C(this.$$d_$8U4,_d.$50.$D);this.$64z=new _C(this.$$d_$8gb,_d.$50.$D);this.$5wq=new _C(this.$$d_$8eu,_d.$50.$D)};function $4NU(n){n.$fA.$Ar();n.$fA.$7OU(n.$12.get_$5s())}function $4NV(n,t){if(n.$12!==t||!n.$2q9){n.$2q9=!0;n.$12=t;n.set_$7Sv(new _d.$7u(t,2,!1,3));n.set_$7T0(new _d.$7u(t,4,!1));$6OC(n);n.set_$950(String.format(_u.Strings.l_LinkSummaryCardSingleComponentText_Text,n.$1G5.$Ex));n.$WM()}}function $6OC(n){n.$418=new _c.$Rw(n.$12);n.$25j.$1u();for(var t=0;t<n.$418.$1Dj.length;t++){var i=n.$418.$1Dj[t];n.$25j.$H($3F6(n,i,_d.$7F.$3aL(i),n.$$d_$8U4))}n.set_$630(n.$25j.get_$F()===1)}function $6OD(n){if(!n.$fA.get_$7en()){var f=!1;if($8(n.$fA.$gf))n.$gg.$1u();else{for(var t=0;t<n.$gg.get_$F();t++){for(var c=n.$gg.get_$48(t),l=c.get_$1v().get_$5s(),e=!1,i=0;i<n.$fA.$gf.length;i++){var a=n.$fA.$gf[i];if(_0365f.$2t.$4F(a,l)){e=!0;break}}if(!e){n.$gg.$67(t);t--}}for(var r=0;r<n.$fA.$gf.length;r++){for(var o=n.$fA.$gf[r],s=!0,u=0;u<n.$gg.get_$F();u++){var v=n.$gg.get_$48(u);var y=v.get_$1v().get_$5s();if(_0365f.$2t.$4F(o,y)){s=!1;break}}if(s){f=!0;var h=_c.$II.$76l(o);h.add_$2m(n.$$d_$8Xc);OwaApplication.$1T.$y(h)}}}f||_a.$5.$1G(null,"PersonCard.ContactLinking")}}function $6OE(n,t){if($8(t.$1b)){var r=t.get_$11D();n.$1ap.$1u();for(var i=0;i<r.get_$F();i++){var u=r.get_$48(i);_0365f.$2t.$4F(u.get_$5s(),n.$12.get_$5s())||n.$1ap.$H($3F6(n,u,"",n.$$d_$8eu))}if(n.$1ap.get_$F()){n.set_$1i2("");$6b(n,"SearchCompletedWithResults")}else n.set_$1i2(_u.Strings.l_NoMatchFound_Text)}else n.set_$1i2(_u.Strings.l_ServerSearchError_Text)}function $3F6(n,t,i,r){var u=new _d.$7u(t,10,!1,1,null,n.$G,!0);u.$J1(1,i,0);u.set_$Bs(new _C(r,_d.$50.$D));u.set_$DA(!0);return u}function $1e4(n,t){n.get_$3L().$B9(t)}_d.$50.prototype={$G:null,$2q1:null,$25c:null,$4m9:null,$64z:null,$5wq:null,$N3:null,$12:null,$1lZ:null,$1G5:null,$418:null,$25j:null,$fA:null,$gg:null,$1ap:null,$38T:!1,$38U:null,$2q9:!1,$R7:null,$1g:null,$3WR:null,$xB:null,$3Sv:null,$1xT:null,$1xe:null,$1xc:null,add_$5wf:function(n){this.$2Z("SearchCompletedWithResults",n)},remove_$5wf:function(n){this.$2b("SearchCompletedWithResults",n)},get_$7Sv:function(){return this.$1lZ},set_$7Sv:function(n){if(this.$1lZ!==n){this.$1lZ=n;$6(this,_d.$50.$54y)}return n},get_$7T0:function(){return this.$1G5},set_$7T0:function(n){if(this.$1G5!==n){this.$1G5=n;$6(this,_d.$50.$551)}return n},get_$7Cs:function(){this.$3WR||(this.$3WR=new _C(this.$$d_$4uw,_d.$50.$D));return this.$3WR},get_$1nk:function(){return this.$G.get_$O()==="Mouse"},get_$Vj:function(){if(!this.$1g){this.$1g=new _y.$6Y(this.$G.get_$O());this.$1g.set_$OY(!1);this.$1g.set_$15(!1);this.$1g.set_$L8(_u.Strings.l_LinkSummaryCardFindContact_Text);this.$1g.set_$SR(new _C(this.$$d_$WM,_d.$50.$D));this.$1g.set_$Gb(new _C(this.$$d_$392,_d.$50.$D));var n=this;this.$1g.$a("IsExpanded",function(t,i){n.$1g.$2W||n.get_$Vj().set_$HE(!1)})}return this.$1g},get_$6wx:function(){return _u.Strings.l_LinkSummaryCardDisplayName_Text},get_$5xG:function(){return this.$1xT},set_$5xG:function(n){if(this.$1xT!==n){this.$1xT=n;$6(this,"SelectedComponentItem");this.$G.get_$O()==="TouchNarrow"&&n&&$1e4(this,this.$1hn(0,n.get_$1v(),this.$$d_$5it))}return n},get_$5xe:function(){return this.$1xe},set_$5xe:function(n){if(this.$1xe!==n){this.$1xe=n;$6(this,"SelectedSuggestionItem");this.$G.get_$O()==="TouchNarrow"&&n&&$1e4(this,this.$1hn(1,n.get_$1v(),this.$$d_$5it))}return n},get_$5xb:function(){return this.$1xc},set_$5xb:function(n){if(this.$1xc!==n){this.$1xc=n;$6(this,"SelectedSearchItem");this.$G.get_$O()==="TouchNarrow"&&n&&$1e4(this,this.$1hn(2,n.get_$1v(),this.$$d_$5it))}return n},get_$6ww:function(){return _u.Strings.l_LinkSummaryCardDescription_Text},get_$6zL:function(){return _u.Strings.l_LinkSummaryCardComponentsHeader_Text},get_$6zK:function(){return _u.Strings.l_LinkSummaryCardComponentsDescription_Text},get_$630:function(){return this.$38T},set_$630:function(n){if(this.$38T!==n){this.$38T=n;$6(this,_d.$50.$631)}return n},get_$950:function(){return this.$38U},set_$950:function(n){if(this.$38U!==n){this.$38U=n;$6(this,_d.$50.$632)}return n},get_$97X:function(){return _u.Strings.l_LinkSummaryCardSuggestionsHeader_Text},get_$97W:function(){return _u.Strings.l_LinkSummaryCardSuggestionsDescription_Text},get_$7gk:function(){return _u.Strings.l_LinkSummaryCardManualLinkTitle_Text},get_$1i2:function(){return this.$3Sv},set_$1i2:function(n){this.$3Sv=n;$6(this,"CurrentSearchPeopleMessage");return n},get_$427:function(){return 0},get_$2Ao:function(){return null},get_$8K:function(){return this.$R7},set_$8K:function(n){this.$R7=n;return n},get_$7A8:function(){return!0},$5zj:function(n){_a.$3.$17(n,"newPersona");$4NV(this,n);$4NU(this)},$2aX:function(){this.set_$5xG(null);this.set_$5xe(null);this.set_$5xb(null)},$5it:function(n){_a.$3.$17(n,"newPersona");$4NV(this,n);$4NU(this)},$3Pb:function(){$8(this.get_$8K())||_d.$Oe.isInstanceOfType(this.get_$3L().get_$7L())?this.get_$3L().$BX():this.get_$8K()()},$8ZU:function(n,t){$6OD(this)},$8Xc:function(n){var i=n;if(i.$1b){if(this.$2q9){this.$N3.$3A(0,_u.Strings.l_LinkSummaryCardGetSuggestionsFailureText_Text,null);this.$3Pb();this.$2q9=!1}return}for(var f=!1,r=0;r<this.$fA.$gf.length;r++){var o=this.$fA.$gf[r];if(_0365f.$2t.$4F(o,i.$8w)){f=!0;break}}if(f){for(var u=i.$12,e=$3F6(this,u,_d.$7F.$3aL(u),this.$$d_$8gb),t=0;t<this.$gg.get_$F();t++){var s=this.$gg.get_$48(t);if(_0365f.$2t.$4F(s.get_$1v().get_$5s(),u.get_$5s())){this.$gg.$67(t);this.$gg.$6z(t,e);return}}this.$gg.$H(e)}this.$fA.$gf.length===this.$gg.get_$F()&&_a.$5.$1G(null,"PersonCard.ContactLinking")},$392:function(){if(!_js.$8.$14(this.get_$Vj().$2k)){var n=_c.$14.$7KC(this.get_$Vj().$2k);this.$xB=n;this.$xB.add_$2m(this.$$d_$3y2);this.set_$1i2(_u.Strings.l_ListViewModelDefaultLoadingMessage_Text);this.$1ap.$1u();OwaApplication.$1T.$y(this.$xB)}},$3y2:function(n){if($8(n.$1b)&&$8(n.get_$11D()))throw Error.invalidOperation("The response is not processed correctly!");n===this.$xB&&$6OE(this,n);n.remove_$2m(this.$$d_$3y2)},$4uw:function(){this.get_$Vj().set_$3m(!0);this.get_$Vj().set_$HE(!0)},$WM:function(){this.set_$1i2("");this.$1ap.$1u();this.get_$Vj().set_$3m(!1);this.get_$Vj().set_$D5("");this.get_$Vj().set_$HE(!1);this.$xB=null},$8U4:function(){this.$1xT&&this.$G.get_$O()!=="TouchNarrow"&&$1e4(this,this.$1hn(0,this.$1xT.get_$1v(),this.$$d_$5it))},$8gb:function(){this.$1xe&&this.$G.get_$O()!=="TouchNarrow"&&$1e4(this,this.$1hn(1,this.$1xe.get_$1v(),this.$$d_$5it))},$8eu:function(){this.$1xc&&this.$G.get_$O()!=="TouchNarrow"&&$1e4(this,this.$1hn(2,this.$1xc.get_$1v(),this.$$d_$5it))}};_d.$Uv=function(n,t,i){_d.$Uv.initializeBase(this,[n,t,i])};_d.$Uv.prototype={get_$Jr:function(){return this.$G.get_$O()==="TouchWide"?1:this.$G.get_$O()==="TouchNarrow"?2:0},$1hn:function(n,t,i){return this.$2q1.$I(this,n,t,i)},$1QM:function(){if(this.$G.get_$O()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_Text,this.$25c);return _y.$26.$Bv(this,n,null)}else if(this.$G.get_$O()==="TouchNarrow")return _y.$26.$I(this);return null}};_d.$13S=function(n,t,i,r,u){this.$$d_$5it=Function.createDelegate(this,this.$5it);this.$$d_$7gj=Function.createDelegate(this,this.$7gj);_d.$13S.initializeBase(this,[t,i,r,u]);_a.$3.$17(n,"originalPersona");this.$2LN=n;this.$5I4=new _d.$ga(_u.Strings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$7gj,this)};_d.$13S.prototype={$2LN:null,$5I4:null,get_$3kr:function(){return 2},$7gj:function(){this.set_$1Hf(!0);var n=new _c.$130(this.$2LN.get_$5s(),this.get_$1v().get_$5s());n.add_$2m(this.$$d_$5it);OwaApplication.$1T.$y(n)},$5it:function(n){var t=n;if(t.$1b)$2Ty(this,t.$1b,_u.Strings.l_LinkPersonaCardAcceptSuggestionTwoGALContactsFailure_Text);else{var i=t.$1N9;$2Tx(this);$2Tz(this,i)}this.set_$1Hf(!1)}};_d.$Lm=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$8aB=Function.createDelegate(this,this.$8aB);this.$2qw=_d.$Lm.$4Ep;_d.$Lm.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$fF=e};function $4OU(n,t){n.$2qw=t}_d.$Lm.prototype={$fF:null,$171:null,$1pr:null,$1Hw:null,$3lw:null,$3lu:null,get_$1pW:function(){!this.$171&&this.get_$179()&&(this.$171=this.$fF.$3RW(this.get_$179().get_$48(0),!0));return this.$171},get_$179:function(){this.$1pr||(this.$1pr=this.$12.$50t());return this.$1pr},get_$3lz:function(){this.get_$179()&&(this.$1Hw=this.get_$179().get_$48(0).get_$2Fx());return this.$1Hw},get_$3hQ:function(){return this.$2qw===_d.$Lm.$4Ep?!1:this.get_$AG()===this.$2qw},get_$5BO:function(){return!this.get_$mf()&&this.get_$5C7()||this.get_$iM()},get_$5C7:function(){return this.$8L.$9S===2},$3v:function(){_d.$6S.prototype.$3v.call(this);this.$3lu=new _C(this.$$d_$8aB,_a.$0.$4h);this.$3lu.set_$5P(!this.get_$15w()&&!this.get_$5BO());this.$3lw="";(this.get_$bh()&&!this.get_$5C7()&&!this.get_$1o3()||this.get_$16j()||this.$G.get_$O()==="TouchNarrow")&&(this.$3lw="mapErrorMessage")},$8w0:function(){$6(this,"IsMapPivotSelected")},$8aB:function(){this.get_$mf()?this.get_$179()&&this.$G.$9T(this.get_$1pW()):this.get_$8lJ().$s()}};_d.$Rj=function(n,t,i){this.$$d_$8cF=Function.createDelegate(this,this.$8cF);_d.$Rj.initializeBase(this);this.$12=n;this.$4gT=t;this.$7S=$6Pv(this,i)};function $6Pv(n,t){var i=null;i=$8(t)?new _d.$7u(n.$12,_y.$q.$1VE,!1,1):t.$SX(n.$12,_y.$q.$1VE,!1,1);i.set_$14y(!0);i.set_$DA(!0);i.set_$We(new _C(n.$$d_$8cF,_a.$0.$6q));i.set_$Bs(i.$1RK);i.$J1(1,n.$12.get_$5N(),0);return i}_d.$Rj.prototype={$12:null,$7S:null,$4gT:0,add_$5oA:function(n){this.$2Z("PersonaDoubleClicked",n)},remove_$5oA:function(n){this.$2b("PersonaDoubleClicked",n)},get_$6t3:function(){switch(this.$4gT){case 1:return _d.$4.get_$6tD();case 2:return _d.$4.get_$6tC();default:return _y.$4.get_$O7()}},$8cF:function(){$EQ(this,"PersonaDoubleClicked",this.$12)}};_d.$4J=function(n,t,i){this.$$d_$5oA=Function.createDelegate(this,this.$5oA);this.$$d_$8XT=Function.createDelegate(this,this.$8XT);_d.$4J.initializeBase(this);this.$2I=n;this.$10m=t;this.$2LJ=i;this.$1U0=!1};function $2UE(n,t){return $8(t)||!t.get_$F()}function $6Pw(n){if(!$8(n.$yp)){n.$yp.$1u();n.$yp=null}if(!$8(n.$yq)){n.$yq.$1u();n.$yq=null}if(!$8(n.$10f)){n.$10f.$1u();n.$10f=null}if(!$8(n.$wc)){n.$wc.$1u();n.$wc=null}}function $3FW(n,t,i,r){r.val=null;if(!$8(t)){r.val=new _js.$X;for(var u=0;u<t.length;u++){var f=0;switch(i){case 1:u>0&&(f=1);break;case 2:n.$2hA===t[u].get_$ls()&&(f=2);break}r.val.$H($4On(n,t[u],f))}}}function $4On(n,t,i){var r=null;r=$8(n.$2LJ)?new _d.$Rj(t,i,null):n.$2LJ.$I(t,i);n.$2I.get_$1nW()||r.add_$5oA(n.$$d_$5oA);return r}_d.$4J.prototype={$2I:null,$10m:null,$2LJ:null,$2nb:!1,$2hA:null,$wc:null,$10f:null,$yp:null,$yq:null,$1U0:!1,get_$93g:function(){return this.$2I.get_$AG()===2&&this.$1U0},get_$5By:function(){return this.$2nb},set_$5By:function(n){if(this.$2nb!==n){this.$2nb=n;$6(this,_d.$4J.$5Bz)}return n},get_$7ZS:function(){return this.$1U0},set_$7ZS:function(n){this.$1U0!==n&&(this.$1U0=n);return n},get_$7TO:function(){return $2UE(this,this.$wc)},get_$7Tb:function(){return $2UE(this,this.$yp)},get_$7Tc:function(){return $2UE(this,this.$yq)},get_$7Ti:function(){return $2UE(this,this.$10f)},add_$5m3:function(n){this.$2Z(_d.$4J.$30y,n)},remove_$5m3:function(n){this.$2b(_d.$4J.$30y,n)},$7MA:function(n){this.$2hA=n;if(!_js.$8.$c(n)){var i=_a.$5.acss(_a.$0.$6q,"GetOrganizationHierarchy");this.set_$5By(!0);var t=new _c.$K8(n);t.add_$2m(this.$$d_$8XT);t.$BP=this.$2I.$8L.$9S;OwaApplication.$1T.$y(t);_a.$5.aces(i)}},$8XT:function(n){var t=n;$6Pw(this);var i;$3FW(this,t.$wc,0,i={val:this.$wc});this.$wc=i.val;var r;$3FW(this,t.$yp,1,r={val:this.$yp});this.$yp=r.val;var u;$3FW(this,t.$10f,2,u={val:this.$10f});this.$10f=u.val;if(!$8(t.$yq)){this.$yq=new _js.$X;this.$yq.$H($4On(this,t.$yq,1))}this.$1U0=!0;$Ha(this,[_d.$4J.$4sq,_d.$4J.$5ng,_d.$4J.$5I2,_d.$4J.$5I3,_d.$4J.$5Ab,_d.$4J.$55T,_d.$4J.$55M,_d.$4J.$55P,_d.$4J.$55G,_d.$4J.$627]);this.set_$5By(!1);$6b(this,_d.$4J.$30y)},$5oA:function(n){this.$10m.$1Aj(n)}};_d.$7H=function(n,t,i,r,u){this.$$d_$8lG=Function.createDelegate(this,this.$8lG);this.$$d_$8U5=Function.createDelegate(this,this.$8U5);this.$$d_$8cA=Function.createDelegate(this,this.$8cA);this.$$d_$8Vk=Function.createDelegate(this,this.$8Vk);this.$$d_$8dL=Function.createDelegate(this,this.$8dL);this.$$d_$8RH=Function.createDelegate(this,this.$8RH);this.$$d_$2jy=Function.createDelegate(this,this.$2jy);this.$$d_$75A=Function.createDelegate(this,this.$75A);this.$$d_$759=Function.createDelegate(this,this.$759);this.$$d_$3Rq=Function.createDelegate(this,this.$3Rq);this.$$d_$75B=Function.createDelegate(this,this.$75B);_d.$7H.resolveInheritance();this.dispose=this.$1M;_d.$7H.initializeBase(this);this.$G=u;this.$1K=r;this.$qc=n;this.$2Mw=t;this.$jd=i;this.$5o2=new _y.$F8};function $3FZ(n,t,i,r){var u;switch(i){case 3:u="AddPersonaCardViewModel";break;case 2:u="CreatePersonaCardViewModel";break;case 1:u="EditPersonaCardViewModel";break;default:throw Error.invalidOperation(String.format("Cannot call CreateAndShowComposeCardViewModel with mode not in (Add,Create,Edit). Actual value = {0}",i));}var e=_a.$5.acsa(_a.$0.$6q,u,!0);var f=n.$qc;if(i===1||i===3){f=new _d.$Gu;f.$9S=n.$qc.$9S}r=r||new _d.$TC;r.$7R=i;$EQ(n,"BeforeComposeCardCreate",r);var o=this;n.$jd.$739(t,i,null,null,f,n,function(t){$6QD(n,t,r,e)})}function $6QD(n,t,i,r){_a.$5.acea(r);if(n.$j){n.$Fx.$570(n.$j);n.$j=null}n.set_$bA(t);n.$Fx.$xs(i);if(n.$G.get_$6Q()||t.$7R!==2){var u=_a.$5.acss(_a.$0.$6q,"OwaShell.PopUp");n.$G.$9T(n.$Fx);_a.$5.aces(u)}else n.$5o2.$MZ(n.$Fx);(n.$Fx.$7R===3||n.$Fx.$7R===1)&&n.$140(n.$Fx)}function $4Ou(n){var t=_a.$5.$1V(_a.$0.$6q,"PersonCard.Popout",!0);if(n.$G.get_$O()!=="Mouse")throw Error.invalidOperation("Persona/Group Card can only be popped out in MUI");var i=$6QC(n);if(n.get_$1Mv().$7R){n.$Fx.$Ij=!1;n.$Fx.get_$SR().$s()}n.get_$1Mv().$4lW();n.$G.$L9(_d.$JY,null,null,_y.$3p.get_$6q(),i,!1);_a.$5.$1G(t);_d.$6j.$mo(32,8,n.get_$1Mv().$12.get_$18())}function $6QC(n){var t=new _d.$5B(n.get_$1Mv(),n.get_$1Mv().$7R);if(n.get_$1Mv().get_$41A()){t.set_$7eP(n.get_$1Mv().get_$41A().$NO);t.set_$O9(n.get_$1Mv().get_$41A().get_$O9())}if(n.$Fx){t.set_$22(n.$Fx.$GH);t.set_$3Rw(n.$Fx.$14G)}else t.set_$AG(n.$5u.get_$AG());t.set_$iM(!0);t.set_$bh(!1);return t}function $4Ot(n,t,i,r){_a.$5.acea(r);var u=!1;if(n.$j){u=!0;t.$570(n.$j);n.$j=null}n.set_$gF(t);i&&$4Os(n,u)}function $4Os(n,t){if(n.$2Mw===3)if(t)n.set_$3iF(!0);else{n.$5u.$5k.set_$1o7(!0);n.$5u.$5pH()}else if(n.$2Mw)if(n.$2Mw===1&&n.get_$7bu()){var i=_a.$5.acss(_a.$0.$6q,"OwaShell.PopUp");n.$G.$hu(n.$5u,1,!1);_a.$5.aces(i)}else{var r=_a.$5.acss(_a.$0.$6q,"OwaShell.PopUp");n.$G.$9T(n.$5u);_a.$5.aces(r)}else n.set_$3iF(!0)}function $2UF(n,t){var i="";t===1?i="NewContact":t===2?i="NewGroup":t===5&&(i="NewModernGroup");_a.$5.stPT(_a.$0.$9C,i,3);_a.$5.$1V(_a.$0.$9C,i);var r=_c.$i.$3SM();r.set_$18(t);if(t===2){r.set_$1h(new _g.$1m);r.get_$1h().RoutingType="MAPIPDL"}n.$2Pp(r,null)}_d.$7H.prototype={$G:null,$1K:null,$jd:null,$5o2:null,$1r:null,$5u:null,$Fx:null,$1Xx:null,$2nQ:!1,$2Mw:0,$qc:null,$j:null,$1UY:!1,add_$5o7:function(n){this.$2Z("PersonaCreated",n)},remove_$5o7:function(n){this.$2b("PersonaCreated",n)},add_$2b6:function(n){this.$2Z("ComposeCardChanged",n)},remove_$2b6:function(n){this.$2b("ComposeCardChanged",n)},add_$4mD:function(n){this.$2Z("ComposeCardChanging",n)},remove_$4mD:function(n){this.$2b("ComposeCardChanging",n)},add_$4hf:function(n){this.$2Z("BeforeComposeCardCreate",n)},remove_$4hf:function(n){this.$2b("BeforeComposeCardCreate",n)},add_$19q:function(n){this.$2Z("ReadCardChanged",n)},remove_$19q:function(n){this.$2b("ReadCardChanged",n)},add_$2Mv:function(n){this.$2Z("ReadCardChanging",n)},remove_$2Mv:function(n){this.$2b("ReadCardChanging",n)},get_$D2:function(){this.$1r||(this.$1r=new _y.$4p);return this.$1r},get_$8PY:function(){if(!this.$1Xx){this.$1Xx=new _js.$X;this.$1K&&this.$1K.$7x("ModernGroups")&&this.$1Xx.$H(new _a.$2E(new _C(this.$$d_$3Rq,_d.$7H.$D),_u.Strings.l_CreateModernGroupString_LowerCase_Text,null));this.$1Xx.$H(new _a.$2E(new _C(this.$$d_$759,_d.$7H.$D),_u.Strings.l_CreateContactString_LowerCase_Text,null));this.$G.get_$O()==="Mouse"&&this.$1Xx.$H(new _a.$2E(new _C(this.$$d_$75A,_d.$7H.$D),_u.Strings.l_CreateGroupString_LowerCase_Text,null));this.$1Xx.$H(new _a.$2E(new _C(this.$$d_$2jy,_d.$7H.$D),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$1Xx},get_$3hh:function(){return this.$2nQ},set_$3hh:function(n){if(this.$2nQ!==n){this.$2nQ=n;$6(this,"IsNewDialogShown")}return n},get_$3iF:function(){return this.$1UY},set_$3iF:function(n){if(this.$1UY===n)return n;this.$1UY=n;$6(this,"IsReadCardVisible");this.$5u.set_$CM(this.$1UY);return n},get_$gF:function(){return this.$5u},set_$gF:function(n){if(this.$5u===n)return n;$6b(this,"ReadCardChanging");if(this.$5u){this.set_$3iF(!1);this.$5u.remove_$4eb(this.$$d_$8RH);this.$5u.remove_$2Lv(this.$$d_$8dL);this.$5u.$5k.remove_$4u5(this.$$d_$8Vk);this.$5u.$w("IsVisible",this.$$d_$8cA);this.$5u.$1M()}this.$5u=n;if(this.$5u){this.$5u.$a("IsVisible",this.$$d_$8cA);this.$5u.add_$4eb(this.$$d_$8RH);this.$5u.add_$2Lv(this.$$d_$8dL);this.$5u.$5k.add_$4u5(this.$$d_$8Vk)}$6b(this,"ReadCardChanged");$4Z(this,"ReadCard","HideConductor");return n},get_$bA:function(){return this.$Fx},set_$bA:function(n){if(this.$Fx===n)return n;$6b(this,"ComposeCardChanging");if(this.$Fx){this.$Fx.remove_$2ex(this.$$d_$8U5);this.$Fx.$w("IsVisible",this.$$d_$8cA);this.$Fx.$1M()}this.$Fx=n;if(this.$Fx){this.$Fx.$a("IsVisible",this.$$d_$8cA);this.$Fx.add_$2ex(this.$$d_$8U5)}$6b(this,"ComposeCardChanged");$6(this,"ComposeCard");return n},get_$1Mv:function(){return this.$Fx||this.$5u},get_$7bu:function(){return _d.$6S.isInstanceOfType(this.$G.$bW().get_$7L())},$2c2:function(n){var t=_a.$5.acsa(_a.$0.$6q,"CreatePersonaCardViewModel",!0);var i=this;this.$jd.$2c2(n,null,null,this.$qc,this,function(n){$4Ot(i,n,!1,t)})},$1Aj:function(n){if(this.$5u&&_c.$i.$1fg(this.$5u.$12,n)){$4Os(this,!1);return}var t=_a.$5.acsa(_a.$0.$6q,"CreatePersonaCardViewModel",!0);var i=this;this.$jd.$2c2(n,null,null,this.$qc,this,function(n){$4Ot(i,n,!0,t)})},$25U:function(){this.set_$gF(null)},$75B:function(){this.$G.get_$O()==="Mouse"||this.$G.get_$O()==="TouchWide"&&this.$1K&&this.$1K.$7x("ModernGroups")?this.set_$3hh(!0):$2UF(this,1)},$759:function(){this.$2jy();$2UF(this,1)},$75A:function(){this.$2jy();$2UF(this,2)},$3Rq:function(){this.$2jy();$2UF(this,5)},$2Pp:function(n,t){$3FZ(this,n,2,t)},$3Kk:function(n){_a.$5.$1V(_a.$0.$6q,"PersonCard.AddToContacts");$3FZ(this,n,3)},$2f2:function(n,t){switch(n.get_$18()){case 1:_a.$5.stPT(_a.$0.$9C,"EditContact",3);_a.$5.$1V(_a.$0.$9C,"EditContact");break;case 2:_a.$5.stPT(_a.$0.$9C,"EditGroup",3);_a.$5.$1V(_a.$0.$9C,"EditGroup");break;case 5:_a.$5.stPT(_a.$0.$9C,"EditModernGroup",3);_a.$5.$1V(_a.$0.$9C,"EditModernGroup");break;default:break}$3FZ(this,n,1,t)},$7f7:function(n){this.$j=n;switch(this.$j.get_$5L()){case 3:this.$3Kk(this.$j.get_$1v());break;case 1:this.$2f2(this.$j.get_$1v(),this.$5u?this.$5u.get_$25l():new _d.$TC);break;case 2:var t=new _d.$TC;t.$GH=n.get_$22();t.$14G=n.get_$3Rw();this.$2Pp(this.$j.get_$1v(),t);break;default:this.$1Aj(this.$j.get_$1v());break}},$5i:function(){this.$Fx&&this.$Fx.$Ij?this.get_$D2().$S5(2,this.$Fx.$12.get_$18()===5?[_u.Strings.l_ModernGroupCardDirtyPopoutWarning_Text]:[_u.Strings.l_PersonaCardDirtyPopoutWarning_Text],this.$$d_$8lG,!1,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_u.Strings.l_PopoutCardConfirmationPromptTile_Text):$4Ou(this)},$59:function(){this.set_$bA(null);this.set_$gF(null);_a.$1.prototype.$59.call(this)},$8RH:function(){this.$3Kk(this.$5u.$12)},$8Vk:function(){this.$2f2(this.$5u.$12,this.$5u.get_$25l())},$8U5:function(n){var t=this.$Fx.$7R;if(n)if(n.get_$18()===1){_a.$5.$1G(null,"SaveContact");_a.$5.endPT("SavePersona_"+this.$G.get_$O())}else if(n.get_$18()===2){_a.$5.$1G(null,"SaveGroup");_a.$5.endPT("SaveGroup_"+this.$G.get_$O())}if(this.$Fx.get_$8K()){this.$Fx.$Ij=!1;this.$Fx.get_$8K()()}(t===3||t===1)&&n&&this.$5u&&this.$5u.$8cG(n);this.set_$bA(null);t===2&&$EQ(this,"PersonaCreated",n)},$8lG:function(n,t){n&&$4Ou(this)},$140:function(n){var u=n.$94&&(n.$7R===2||n.$7R===3||n.$12.get_$9m()===3);if(u){var t=null;var i=null;var r=n.$12.get_$18();switch(n.$7R){case 2:switch(r){case 1:t="NewContact";i="NewContact";break;case 2:t="NewGroup";i="NewGroup";break;case 5:t="NewModernGroup";i="NewModernGroup";break}break;case 1:switch(r){case 1:t="EditContact";i="EditContact";break;case 2:t="EditGroup";i="EditGroup";break}break;case 0:t="OpenContact";i="OpenPersonCard_"+this.$G.get_$O();break;case 3:t="PersonCard.AddToContacts";break}t&&_a.$5.$1G(null,t);i&&_a.$5.endPT(i)}},$8cA:function(n,t){if(_d.$88.isInstanceOfType(n)){var i=n;i.$94&&this.$140(i)}},$8dL:function(){this.$140(this.$5u)},$2jy:function(){this.set_$3hh(!1)}};_d.$6j=function(){};_d.$6j.$mo=function(n,t,i){_d.$6j.$3lR(0,n,t,i)};_d.$6j.$7fr=function(n,t,i){_d.$6j.$3lR(1,n,t,i)};_d.$6j.$3lQ=function(n,t,i){_d.$6j.$3lR(n,100,t,i)};_d.$6j.$3lR=function(n,t,i,r){if(_a.$b.get_$Pa()){var u=new _d.$x5(n,t,i,r);_a.$b.$8E.$A7(u)}};_d.$6j.$7fs=function(n,t){if(_a.$b.get_$Pa()){var i=new _d.$ni(0,n,t);var r=_a.$5.$1V(_a.$0.$1v,"RecipientCache",!0);_a.$5.$1G(r,"RecipientCache","","",i.$4DX())}};_d.$6j.$7ft=function(n,t){if(_a.$b.get_$Pa()){var i=new _d.$ni(1,n,t);var r=_a.$5.$1V(_a.$0.$1v,"RecipientCache",!0);_a.$5.$1G(r,"RecipientCache","","",i.$4DX())}};_d.$6j.$7fu=function(n,t,i){if(_a.$b.get_$Pa()){var r=new _d.$ni(2,n,t,i);var u=_a.$5.$1V(_a.$0.$1v,"RecipientCache",!0);_a.$5.$1G(u,"RecipientCache","","",r.$4DX())}};_d.$6j.$7fg=function(n,t){if(!_js.$8.$14(t)){var i=_a.$5.$1V(n,t,!0);_a.$5.$1G(i)}};_d.$9y=function(n){this.$$d_$943=Function.createDelegate(this,this.$943);this.$$d_$4vW=Function.createDelegate(this,this.$4vW);this.$$d_$7Du=Function.createDelegate(this,this.$7Du);this.$$d_$5gk=Function.createDelegate(this,this.$5gk);_d.$9y.$$(this.$$gta["_d.$9y"].T).initializeBase(this);this.$4vX=n};_d.$9y.$$=function(n){var t="$9y"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var i=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$9y"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$9y.apply(this,i)};i.registerClass("_d."+t,_a.$ER);var u=_d.$9y.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(i.prototype[r.key]=r.value)}i.$737=function(n,t,i){return new _0365m.$n(n,null,i,!0)};i.$D=_a.$0.$6q}return _d[t]};_d.$9y.prototype={$1O3:null,$1xR:null,$1as:null,$o:null,$4vX:null,get_$2WW:function(){return this.$1O3},set_$2WW:function(n){if(n!==this.$1O3){this.$1O3=n;$6(this,"ActionCommand")}return n},get_$46S:function(){return this.$1xR},set_$46S:function(n){if(n!==this.$1xR){this.$1xR=n;$8(n)||this.$1xR.$a("IsShown",this.$$d_$5gk);$6(this,"SelectActionItemMenuViewModel")}return n},get_$3T:function(){return this.$o},$9KJ:function(n,t){t||(t=_d.$9y.$$(this.$$gta["_d.$9y"].T).$737);if($8(n)||!n.length)this.$1u();else if(n.length===1){this.$1as=null;this.set_$46S(null);this.set_$2WW(new _C(this.$$d_$7Du,_d.$9y.$$(this.$$gta["_d.$9y"].T).$D))}else{var r=n.length;this.$1as=new Array(r);for(var i=0;i<r;++i){var u=new(_a.$BS.$$(_d.$59.$$(this.$$gta["_d.$9y"].T)))(n[i],this.$$d_$4vW);this.$1as[i]=t(n[i].get_$1jB(),n[i].get_$9IS(),new _C(u.$$d_$9Hu,_d.$9y.$$(this.$$gta["_d.$9y"].T).$D))}this.set_$46S(new _0365m.$2c(this.$1as));this.set_$2WW(new _C(this.$$d_$943,_d.$9y.$$(this.$$gta["_d.$9y"].T).$D))}this.$o=n},$1u:function(){if(!$8(this.$1as))for(var t=this.$1as,i=t.length,n=0;n<i;++n){var r=t[n];r.$1M()}this.$1as=null;this.set_$46S(null);this.set_$2WW(null);this.$o=null},$59:function(){this.$1u();_a.$1.prototype.$59.call(this)},$943:function(){this.$1xR.set_$1X(!0)},$4vW:function(n){this.$4vX(n.get_$9IS())},$7Du:function(){this.$4vW(this.$o[0])},$5gk:function(n,t){_d.$6S.$1mk=this.$1xR.$2R}};_d.$Gu=function(){this.$3Ui=!1;this.$2e0=!1;this.$27i=!1;this.$2dy=!1;this.$27m=!1;this.$1Ee=!1;this.$2e5=!1;this.$1RB=!1;this.$2e3=!1;this.$27j=!1;this.$2e4=!0;this.$9S=8;this.$3Uj=!1;this.$3Ul=!1};_d.$Gu.get_$8k6=function(){var n=new _d.$Gu;n.$3Ui=!0;n.$2e0=!0;n.$27i=!0;n.$27m=!0;n.$1Ee=!0;n.$2e5=!0;n.$2e3=!0;n.$1RB=!0;n.$2dy=!0;n.$4st=!0;n.$2e4=!1;n.$9S=0;return n};_d.$Gu.get_$8l5=function(){var n=new _d.$Gu;n.$3Ui=!0;n.$2dy=!0;n.$2e0=!0;n.$27i=!0;n.$27m=!0;n.$1Ee=!0;n.$2e5=!0;n.$1RB=!0;n.$2e3=!0;n.$27j=!0;n.$2e4=!0;n.$9S=1;return n};_d.$Gu.prototype={$2e3:!1,$27j:!1,$2e0:!1,$27i:!1,$2dy:!1,$27m:!1,$3Ui:!1,$1Ee:!1,$1RB:!1,$2e5:!1,$4st:!1,$9S:0,$2W:!0,$2e4:!1,$3Uj:!1,$3Ul:!1};_d.$2F=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$5i2=Function.createDelegate(this,this.$5i2);this.$$d_$6r9=Function.createDelegate(this,this.$6r9);this.$$d_$8RJ=Function.createDelegate(this,this.$8RJ);this.$$d_$8dq=Function.createDelegate(this,this.$8dq);this.$$d_$8RI=Function.createDelegate(this,this.$8RI);this.$$d_$99y=Function.createDelegate(this,this.$99y);this.$$d_$7eM=Function.createDelegate(this,this.$7eM);this.$$d_$3Kk=Function.createDelegate(this,this.$3Kk);this.$$d_$8cK=Function.createDelegate(this,this.$8cK);this.$2Bz=_d.$2F.$2S5;this.$2xR=_d.$2F.$2S5;_d.$2F.initializeBase(this,[n,t,i,r,f,e,s,l,v,y,w]);this.$2q3=o;this.$1K=u;this.$2LK=h;this.$2l0=c;this.$1tm=p;this.$CZ=a};function $6Qh(n,t){return n.$2q3.$I(t)}function $6Qi(n){n.$Zx=new _d.$1H(new _d.$nh(n),0);n.$10n=new _d.$1H(new _d.$nh(n),1);n.$jc=new _d.$1H(new _d.$nh(n),2)}function $6Ql(n){n.$Zx.$qb();n.$10n.$qb();n.$jc.$qb()}function $2UG(n){var t=new(_0365f.$s.$$(_0365m.$n));n.get_$2jh()||t.$H(n.get_$6q2());n.get_$3cQ()||t.$H(n.get_$6rA());if(n.$5k.$1qC){n.$5k.$1qC.$1B.$1u();n.$5k.$1qC.$1B.$6G(t.$7V())}else n.$5k.set_$7hz(new _0365m.$2c(t.$7V()))}function $6Qn(n,t){n.$2Bz=t}function $6Qk(n){if(n.$xv&&!n.$xv.get_$2mq())n.$xv.$50R();else if(!n.$xv){var t=this;n.$2l0.$I(function(t){n.set_$7Vx(t.$I(n));n.$xv.get_$2mq()||n.$xv.$50R()})}}function $6Qj(n,t){if(_a.$3I.$OZ(t.get_$1h().EmailAddress)){var r=_a.$5.acss(_a.$0.$6q,"GetPersonaAction");n.set_$Lu(!0);var i=_c.$II.$4pW(t.get_$1h());i.add_$2m(n.$$d_$5i2);i.$BP=n.$8L.$9S;i.$2W=n.$8L.$2W;n.$p.$y(i);_a.$5.aces(r)}}function $4Oz(n,t){var r=_a.$5.acss(_a.$0.$6q,"GetPersonaAction");var i=_c.$II.$4pX(t.get_$5s(),t.get_$ls());i.add_$2m(n.$$d_$5i2);i.$BP=n.$8L.$9S;i.$2W=n.$8L.$2W;n.$p.$y(i);_a.$5.aces(r)}function $3Ff(n){$4Oz(n,n.$12)}function $6Qm(n){_a.$5.stPT(_a.$0.$9C,"PersonCard.ModernGroupPivot",5);_a.$5.$1V(_a.$0.$9C,"PersonCard.ModernGroupPivot",!1);var t=this;n.$1tm.$I(function(t){if(!n.$1JL){n.set_$8OU(t.$751(n.$12,n.$10m));n.$1JL.$Kt()}})}_d.$2F.prototype={$2q3:null,$2LK:null,$2l0:null,$1K:null,$1tm:null,$Zx:null,$10n:null,$jc:null,$30z:null,$CZ:null,$xv:null,$1JL:null,$NQ:null,$Ax:null,$3U1:null,$3KE:null,$3Ko:null,$3Kl:null,$3Km:null,$3XR:null,$3kX:null,$3cR:!1,get_$1uy:function(){this.$30z||(this.$30z=this.$2LK?this.$2LK.$I(this,this.$10m):new _d.$4J(this,this.$10m));return this.$30z},get_$7Vx:function(){return this.$xv},set_$7Vx:function(n){if(n!==this.$xv){this.$xv=n;$6(this,"InlineExploreListViewModel")}return n},get_$8OU:function(){return this.$1JL},set_$8OU:function(n){if(n!==this.$1JL){this.$1JL=n;$4Z(this,_d.$2F.$5dF,_d.$2F.$3cf)}return n},get_$1PY:function(){return this.$Ax},set_$1PY:function(n){if(this.$Ax!==n){this.$Ax&&this.$Ax.$w("IsNotesLoaded",this.$$d_$8cK);this.$Ax=n;this.$Ax&&this.$Ax.$a("IsNotesLoaded",this.$$d_$8cK);$6(this,"CardNotesViewModel")}return n},get_$25l:function(){var n=_d.$6S.prototype.get_$25l.call(this);n.$iR=this.$Ax.$iR;return n},get_$2WM:function(){return this.$CZ&&this.$CZ.$34&&this.$CZ.$34.get_$LT()?this.$CZ.$34.get_$LT().get_$82():""},get_$1le:function(){return this.get_$2jh()&&this.get_$3cQ()?!0:!1},get_$3cQ:function(){return this.$8L.$4st||!this.$5k.get_$1yh()||this.get_$1m4()||!(this.$3K.get_$Az()?this.$3K.get_$Az().get_$7YL():!1)||this.$12.$7Ab()||this.$12.get_$9m()!==3?!0:this.$3cR},set_$3cQ:function(n){this.$3cR!==n&&(this.$3cR=n);return n},get_$2jh:function(){return this.$8L.$2dy?!0:!this.$5k.get_$1yh()||this.get_$iM()&&this.get_$iP()||this.$12.get_$9m()!==1&&(this.$12.get_$9m()!==3||!this.$12.$2Aw())},get_$2BD:function(){return this.$8L.$27i?!0:!this.$5k.get_$1yh()||this.get_$iM()&&this.get_$iP()||this.$12.get_$9m()!==3||this.$12.$2Aw()},get_$55N:function(){return this.get_$bh()||!this.$5k.get_$1yh()},get_$7Tf:function(){return!this.get_$3hb()||!this.$1JL},get_$7cv:function(){return this.$X5&&this.$10n.get_$3T().get_$F()>0&&this.$Zx.get_$3T().get_$F()>0},get_$5Al:function(){return this.get_$AG()===0},get_$5At:function(){return this.$12.get_$18()!==1||this.$2Bz===_d.$2F.$2S5?!1:this.get_$AG()===this.$2Bz},get_$3hb:function(){return this.$12.get_$18()!==1||this.$2xR===_d.$2F.$2S5?!1:this.get_$AG()===this.$2xR},get_$5Aq:function(){return!this.$8L.$3Ul&&!!this.$1K&&this.$1K.$7x("InlineExploreUI")},get_$2nV:function(){return this.get_$AG()===1},get_$7bE:function(){return this.get_$AG()===2},get_$4ec:function(){this.$3Km||(this.$3Km=new _C(this.$$d_$3Kk,_d.$2F.$D));return this.$3Km},get_$2FC:function(){this.$3kX||(this.$3kX=new _C(this.$$d_$7eM,_d.$2F.$D));return this.$3kX},get_$37f:function(){return this.$8L.$1RB?!1:!this.$12.$2Aw()&&this.$12.get_$9m()===3},get_$2BE:function(){return this.$8L.$2e0||this.$1K&&!this.$1K.$7x("PeopleFavorites")?!0:this.get_$2BD()&&this.get_$2jh()},get_$7ag:function(){return!!this.$1K&&this.$1K.$7x("ModernGroups")},get_$93V:function(){return this.$8L.$3Uj?!1:this.$12.get_$18()!==1?!1:this.get_$7ag()?this.$12.$3bm():!1},get_$6r4:function(){this.$3Kl||(this.$3Kl=new _y.$2f(_y.$c.get_$6px(),_y.$c.get_$6q1(),_u.Strings.l_AddMenuItem_LowerCase_Text,this.get_$4ec()));return this.$3Kl},get_$78P:function(){this.$3U1||(this.$3U1=new _y.$2j(_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$4ru()));return this.$3U1},get_$4wB:function(){return new _y.$2j(this.$12.get_$mT()?_u.Strings.l_RemoveFromFavorites_LowerCase_Text:_u.Strings.l_AddToFavorites_LowerCase_Text,this.get_$99z())},get_$99z:function(){this.$3XR||(this.$3XR=new _C(this.$$d_$99y,_d.$2F.$D));return this.$3XR},$3v:function(){_d.$Lm.prototype.$3v.call(this);this.$5k.set_$1le(this.get_$1le());this.$5k.set_$2BE(this.get_$2BE());this.$5k.add_$7Ea(this.$$d_$99y);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p));$2UG(this);$6Qi(this);$1Nj(this)},$570:function(n){_d.$6S.prototype.$570.call(this,n);$6(this,_d.$2F.$3zZ)},$5iS:function(){_d.$6S.prototype.$5iS.call(this);$2UG(this);$Ha(this,[_d.$2F.$3jJ,_d.$2F.$55O])},$8XQ:function(){$2UG(this);_d.$6S.prototype.$8XQ.call(this)},$6r6:function(){this.$12.set_$mT(!0);var t=this.$12.$3Zq();var n=new _c.$vg(t);n.$BP=this.$8L.$9S;n.$2W=this.$8L.$2W;n.add_$2m(this.$$d_$8RI);this.$p.$y(n)},$5sz:function(){this.$12.set_$mT(!1);var n=new _c.$15Z(this.$12.get_$5s());n.add_$2m(this.$$d_$8dq);this.$p.$y(n)},$6r9:function(){this.$5k.set_$Uh(!0);var i=this.$12.$3Zq();var n=new _g.$Uj;n.GroupType="OtherContacts";var t=new _c.$vj(i,n);t.add_$2m(this.$$d_$8RJ);this.$p.$y(t)},$4yv:function(){var n=_d.$6S.prototype.$4yv.call(this);this.get_$2BE()||(n[n.length]=new _0365m.$n(this.$12.get_$mT()?_u.Strings.l_RemoveFromFavorites_LowerCase_Text:_u.Strings.l_AddToFavorites_LowerCase_Text,null,new _C(this.$$d_$99y,_d.$2F.$D)));return n},$8cB:function(){$6Ql(this);this.set_$1PY(new _d.$MX(this.$12,this.$8L,this.$G,this.$p));this.$5k.set_$1le(this.get_$1le());this.$5k.set_$2BE(this.get_$2BE());_d.$6S.prototype.$8cB.call(this);$Ha(this,[_d.$2F.$55K,_d.$2F.$3jJ])},$7Wb:function(){if(this.$12.get_$9m()===2&&this.$12.get_$5s()){this.set_$Lu(!0);$4Oz(this,this.$12)}else this.$12.get_$9m()!==1&&this.$12.get_$9m()!==2||$8(this.$12.get_$1h())||$8(this.$12.get_$1h().EmailAddress)||$6Qj(this,this.$12)},$7Wi:function(){this.get_$2nV()&&this.$Ax.$Kt();$3Ff(this)},$4z3:function(n,t){n.val=[];t.val=null;if((this.$G.get_$O()!=="TouchNarrow"||!this.$8L.$2e5)&&this.$12.get_$9m()===3){this.get_$37f()&&(t.val=[this.get_$78P()]);this.get_$2BE()||(t.val?t.val[t.val.length]=this.get_$4wB():t.val=[this.get_$4wB()]);this.get_$2jh()?this.get_$2BD()||(n.val[n.val.length]=this.get_$3Vj()):n.val[n.val.length]=this.get_$6r4();this.get_$16j()&&(n.val[n.val.length]=this.get_$3PW())}},$8w0:function(){_d.$Lm.prototype.$8w0.call(this);$Ha(this,[_d.$2F.$5Am,_d.$2F.$5Br,_d.$2F.$3zZ,_d.$2F.$5Au,_d.$2F.$5BZ,_d.$2F.$3cf]);this.get_$AG()!==2||this.get_$1uy().$1U0||this.get_$1uy().$7MA(this.$12.get_$ls());this.get_$AG()===1&&this.$12.get_$9m()===3&&this.$Ax.$Kt();this.get_$AG()===this.$2Bz&&this.$12.get_$18()===1&&$6Qk(this);this.get_$3hb()&&(this.$1JL||$6Qm(this))},$51U:function(){var n=new(_0365f.$s.$$(_a.$5D));n.$H(new _a.$5D(_u.Strings.l_PersonaCardInformationPivotOption_Text,null));n.$H(new _a.$5D(_u.Strings.l_PersonaCardNotesPivotOption_Text,null));this.$12.get_$18()===1&&this.$12.get_$ls()&&this.$12.$3bm()&&n.$H(new _a.$5D(_u.Strings.l_PersonaCardOrganizationPivotOption_Text,null));if(this.$12.get_$3by()){n.$H(new _a.$5D(_u.Strings.l_PersonaCardLocationPivotOption_Text,null));$4OU(this,n.get_$F()-1)}if(this.$12.get_$18()===1&&this.get_$5Aq()){var t=_g.$S.get_$L().get_$9B().InlineExploreContent==="VersionB"?_u.Strings.l_InlineExplorePivotOptionVersionB_Text:_u.Strings.l_InlineExplorePivotOptionVersionC_Text;n.$H(new _a.$5D(t,null));$6Qn(this,n.get_$F()-1)}if(this.get_$93V()){n.$H(new _a.$5D(_u.Strings.l_PersonaCardModernGroupMembershipPivotOption_Text,null));this.$2xR=n.get_$F()-1}return n.$7V()},$7Ma:function(){return this.get_$5Al()?20:this.get_$2nV()?21:this.get_$7bE()?22:this.get_$3hb()?27:this.get_$5At()?23:this.get_$3hQ()?26:100},get_$6q2:function(){this.$3KE||(this.$3KE=new _0365m.$n(_u.Strings.l_AddToContact_LowerCase_Text,null,this.get_$4ec()));return this.$3KE},get_$6rA:function(){this.$3Ko||(this.$3Ko=new _0365m.$n(_u.Strings.l_AddToLyncContact_LowerCase_Text,null,new _C(this.$$d_$6r9,_d.$2F.$D)));return this.$3Ko},$3Kk:function(){$6b(this,"AddToContactsClicked")},$8RJ:function(n){var t=n;if(t.$1b)this.get_$D2().$3A(0,_u.Strings.l_AddToLyncContactError_LowerCase_Text,null);else{this.set_$3cQ(!0);$2UG(this)}this.$5k.set_$Uh(!1)},$5i2:function(n){var t=n;this.set_$Lu(!1);if(!t.$1b){$8(this.get_$41A())||(this.get_$41A().$1VR=!0);var i=_a.$5.acss(_a.$0.$6q,"SetFullPersona");this.set_$1v(t.$12);this.get_$2nV()&&this.$12.get_$9m()===3&&this.$Ax.$Kt();_a.$5.aces(i);_a.$5.$1G(null,"NavigateToPeople");_a.$5.endPT("NavigateToPeopleHub_"+this.$G.get_$O());_a.$5.$1G(null,"PeoplePicker");_a.$5.endPT("PeoplePicker")}this.$8XQ()},$8cK:function(n,t){this.$Ax.$1Gv&&this.$Ax.$iR&&this.$jc&&this.$jc.$qb()},$99y:function(){if(this.$12.get_$mT()){_a.$5.$1V(_a.$0.$9C,"RemovePeopleFavorite");this.$5sz()}else{_a.$5.$1V(_a.$0.$9C,"AddPeopleFavorite");this.$6r6()}$21n(this);$1e9(this)},$8RI:function(n){var t=n;if(t.$1b){this.$12.set_$mT(!1);this.get_$D2().$3A(0,_u.Strings.l_AddToFavoritesError_LowerCase_Text,null)}else this.$12.set_$mT(!0);$3Ff(this);_a.$5.$1G(null,"AddPeopleFavorite",t.$1b?t.$1b.message:null)},$8dq:function(n){var t=n;t.$1b?this.get_$D2().$3A(0,_u.Strings.l_RemoveFromFavoritesError_LowerCase_Text,null):this.$12.set_$mT(!1);$3Ff(this);_a.$5.$1G(null,"RemovePeopleFavorite",t.$1b?t.$1b.message:null)},$7eM:function(){_a.$b.$20M("VM.PersonCard.ContactLinking");if(!this.$12||this.$12.get_$9m()!==3){this.get_$D2().$3A(0,_u.Strings.l_LinkSummaryCardCannotBeLaunched_Text,null);return}this.$NQ?this.$NQ.$5zj(this.$12):this.$NQ=$6Qh(this,this.$12);this.$G.$9T(this.$NQ);this.get_$5o4()==="Mouse"&&this.$4lW()}};_d.$88=function(n,t,i,r,u,f,e,o,s){this.$$d_$4lW=Function.createDelegate(this,this.$4lW);this.$$d_$1YQ=Function.createDelegate(this,this.$1YQ);this.$$d_$5pH=Function.createDelegate(this,this.$5pH);_d.$88.resolveInheritance();this.apcl=this.$a;this.rpcl=this.$w;_d.$88.initializeBase(this);this.$12=n;this.$14q=f;this.$tw=o;this.$G=r;this.$p=u;this.$8L=i;this.$7R=t;this.$6n=e;this.$10m=s};function $1Nj(n){n.get_$5AV()&&n.$7Wb()}function $1e9(n){if(n.$3t){var t;var i;var r,u;n.$4z3(r={val:t},u={val:i});t=r.val;i=u.val;n.$3t.set_$MS(t);n.$3t.set_$XL(i);$6(n,"ApplicationBarViewModel")}}_d.$88.prototype={$tw:null,$G:null,$6n:null,$p:null,$7R:0,$8L:null,$10m:null,$14q:!1,$1r:null,$12:null,$2o:null,$R7:null,$3t:null,$94:!1,$3Pe:null,$Dm:!1,$7M:!1,add_$5gZ:function(n){this.$2Z("ClosePopup",n)},remove_$5gZ:function(n){this.$2b("ClosePopup",n)},get_$7E:function(){return this.$3t},set_$7E:function(n){if(this.$3t!==n){this.$3t=n;$6(this,"ApplicationBarViewModel")}return n},get_$Jr:function(){return 2},get_$D2:function(){this.$1r||(this.$1r=new _y.$4p);return this.$1r},get_$4Ei:function(){return this.$12.get_$18()},get_$1v:function(){return this.$12},set_$1v:function(n){this.$12=n;this.$8cB();$1Nj(this);$6(this,_d.$88.$5oF);return n},get_$5o4:function(){return this.$G.get_$O()},get_$CM:function(){return this.$94},set_$CM:function(n){this.$94!==n&&(this.$94=n);$6(this,"IsVisible");return n},get_$iP:function(){return!_a.UserAgent.getInstance().$Lr},get_$30c:function(){return null},get_$30e:function(){return null},get_$mf:function(){return this.$G.get_$O()!=="Mouse"},get_$427:function(){return 0},get_$2Ao:function(){return this.$$d_$1YQ},get_$3L:function(){return this.$2o},set_$3L:function(n){this.$2o=n;return n},get_$8K:function(){return this.$R7},set_$8K:function(n){this.$R7=n;return n},get_$7A8:function(){return!0},get_$1hI:function(){this.$3Pe||(this.$3Pe=new _C(this.$$d_$4lW,_d.$88.$D));return this.$3Pe},get_$ZD:function(){return this.$Dm},set_$ZD:function(n){if(n!==this.$Dm){this.$Dm=n;$6(this,"IsTransitionedIn")}return n},get_$5AV:function(){return!this.$14q},$3v:function(){if(this.$7M){var n="Initialize should be called on any given instance only once.";_js.Trace.logError(_d.$88.$D,n)}this.$7M=!0;this.$G.get_$O()!=="Mouse"&&this.set_$7E(this.$1QM())},$570:function(n){this.set_$7E(null)},$5pH:function(){this.$10m.$5i()},$co:function(){},$Fe:function(){this.set_$CM(!0);this.set_$ZD(!0)},$gC:function(){this.set_$CM(!1);this.set_$ZD(!1)},$Rx:function(){},$1QM:function(){_js.Trace.logInfo(_a.$0.$6q,"PersonaCardViewModelBase::CreateApplicationBarViewModel - Layout: {0}",this.$G.get_$O());var n;var t;var i,r;this.$4z3(i={val:n},r={val:t});n=i.val;t=r.val;return _y.$26.$Bv(this,n,t)}};_d.$6S=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$791=Function.createDelegate(this,this.$791);this.$$d_$792=Function.createDelegate(this,this.$792);this.$$d_$99q=Function.createDelegate(this,this.$99q);this.$$d_$8l2=Function.createDelegate(this,this.$8l2);this.$$d_$6uB=Function.createDelegate(this,this.$6uB);this.$$d_$78V=Function.createDelegate(this,this.$78V);this.$$d_$7QL=Function.createDelegate(this,this.$7QL);this.$$d_$1EZ=Function.createDelegate(this,this.$1EZ);this.$$d_$4oB=Function.createDelegate(this,this.$4oB);_d.$6S.initializeBase(this,[n,0,t,r,u,e,o,s,h]);this.$3K=f;this.$ym=i;this.$16O=!0;this.$X5=!1;this.set_$3m(!0)};function $6RT(n){n.$5k.set_$g8(n.$51U())}function $4PI(n){var t=n.$51U();$6RS(n,t)&&n.$5k.set_$g8(t)}function $21n(n){n.$5k.set_$3ml(new _0365m.$2c(n.$4yv()))}function $6RU(n){n.$5k=n.$tw.$75V(n.$12,n.$7R,n.$8L,n.$ym);n.$5k.set_$2BE(!0);n.$5k.set_$2BD(n.get_$2BD());n.$5k.set_$1le(!0);n.$5k.set_$2jj(!n.get_$37f()&&n.get_$2BE());n.$5k.add_$8l1(n.$$d_$8l2);n.$5k.add_$99s(n.$$d_$99q);n.$5k.add_$5pI(n.$$d_$5pH)}function $6RS(n,t){return!n.$5k.$GJ&&!t?!1:n.$5k.$GJ&&t?n.$5k.$GJ.length!==t.length:!0}function $6RV(n){var t=n.$7Ma();_d.$6j.$7fr(t,n.$8L.$9S,n.get_$4Ei())}function $6RR(n){return n.$12.$7SD()?[String.format(_u.Strings.l_DeletePersonaMessageFirstLine_Text,n.get_$41A().$Ex),_u.Strings.l_DeletePersonaMessageSecondLine_Text]:[String.format(_u.Strings.l_DeletePersonaMessageFirstLine_Text,n.get_$41A().$Ex)]}function $6RW(n,t){var i=new _c.$5n;i.set_$mh(!0);i.set_$1l("Outlook");i.set_$15(!1);t.get_$3f()||t.set_$3f(new _js.$X);if(t.$54H()){i.set_$1y(t.get_$3f().get_$F().toString());t.get_$3f().$H(i);t.get_$Qr()&&t.get_$Qr().$H(t.get_$Qr().get_$48(0),t.get_$3f().get_$F().toString())}else for(var u=t.get_$3f().get_$F(),r=0;r<u;r++){var f=t.get_$3f().get_$48(r);if(f.get_$1l()==="GAL"){i.set_$1y(r.toString());t.get_$3f().set_$48(r,i);break}}if(t.get_$1h()){t.set_$Qr(new(_c.$1D.$$(_g.$1m)));t.get_$Qr().$H(t.get_$1h(),(t.get_$3f().get_$F()-1).toString())}return t}_d.$6S.prototype={$ym:null,$5k:null,$1jO:null,$w3:null,$IX:null,$2W:!1,$X5:!1,$3K:null,$2d6:null,$16O:!1,$rz:!1,add_$4eb:function(n){this.$2Z("AddToContactsClicked",n)},remove_$4eb:function(n){this.$2b("AddToContactsClicked",n)},add_$4s1:function(n){this.$2Z("DeleteSucceeded",n)},remove_$4s1:function(n){this.$2b("DeleteSucceeded",n)},add_$2zD:function(n){this.$2Z("OnBack",n)},remove_$2zD:function(n){this.$2b("OnBack",n)},add_$2Lv:function(n){this.$2Z("PersonaInCompletedState",n)},remove_$2Lv:function(n){this.$2b("PersonaInCompletedState",n)},get_$7Bv:function(){return this.$5k.get_$28A()},get_$4ru:function(){this.$IX||(this.$IX=new _C(this.$$d_$1EZ,_d.$6S.$D));return this.$IX},get_$8lJ:function(){return this.$5k.get_$41t()},get_$Jr:function(){switch(this.$G.get_$O()){case"TouchWide":return 1;case"TouchNarrow":return 2;default:return 0}},get_$25l:function(){var n=new _d.$TC;n.$4tP=this.get_$41A().get_$2eQ();n.$5H5=!0;n.$5CG=this.get_$iM();return n},get_$iM:function(){return this.$5k.$yH},get_$41A:function(){return this.$5k.$7S},get_$3m:function(){return this.$8L.$27j?!0:this.$2W},set_$3m:function(n){this.$2W=n;this.$5k&&this.$5k.set_$3m(n);this.$X5&&(_d.$6S.$3fE=n);$Ha(this,["IsExpanded","IsHoverCardExpanded"]);return n},get_$2mi:function(){return this.$X5},set_$2mi:function(n){this.$X5=n;if(this.$5k){this.$5k.set_$92w(n);this.$5k.set_$2mi(n)}$6(this,"IsHoverCard");return n},get_$5Af:function(){return this.get_$bh()&&this.get_$3m()?!0:!1},get_$16j:function(){return this.$X5&&this.$G.get_$O()==="TouchWide"},get_$7co:function(){return this.$X5&&this.$G.get_$O()!=="Mouse"},get_$AG:function(){return this.$5k.$Jg},get_$1m4:function(){return this.get_$41A()?this.get_$41A().$PR.get_$1m4():!0},get_$58l:function(){return!!this.get_$41A()&&this.get_$41A().$PR.$6xW()},get_$4rH:function(){return this.$2d6},set_$4rH:function(n){if(this.$2d6!==n){this.$2d6=n;$6(this,"DefaultEmailAddress")}return n},get_$bh:function(){return this.$8L.$27j?!1:this.$16O},set_$bh:function(n){this.$16O=n;this.$5iS();$Ha(this,["IsExpandable","IsHoverCardExpanded"]);return n},get_$1nW:function(){return this.$8L.$9S===9},get_$1o3:function(){return!this.$8L.$9S},get_$3i3:function(){return this.$8L.$9S===1},get_$Lu:function(){return this.$rz},set_$Lu:function(n){if(this.$rz!==n){this.$rz=n;$Ha(this,["IsCardLoading","HidePersonaActions","HideNameControlForMouse"]);this.$8Yo()}return n},get_$15w:function(){return this.$8L.$1Ee||this.get_$Lu()?!0:!1},get_$3Vj:function(){this.$1jO||(this.$1jO=new _y.$2f(_y.$c.get_$Yo(),_y.$c.get_$2f3(),_u.Strings.l_EditMenuItem_LowerCase_Text,this.get_$7Bv()));return this.$1jO},get_$3PW:function(){this.$w3||(this.$w3=new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Close_LowerCase_Text,this.get_$1hI()));return this.$w3},get_$78W:function(){return _u.Strings.l_DeletePersonaConfirmationPromptTile_Text},get_$2BE:function(){return!0},$3v:function(){$6RU(this);!this.get_$mf()&&this.get_$41A()&&this.get_$41A().$PR.add_$8R1(this.$$d_$7QL);$21n(this);$6RT(this);this.$5k.set_$AG(0);_d.$88.prototype.$3v.call(this)},$570:function(n){_d.$88.prototype.$570.call(this,n);this.set_$bh(n.get_$bh());this.$5k.set_$AG(n.get_$AG());this.$5k.set_$1o7(n.get_$iM())},$1EZ:function(){if(!this.$7bV()){this.get_$D2().$3A(0,_u.Strings.l_WaitAndRetry_Text,null);return}if(!this.get_$37f()){this.get_$D2().$3A(0,String.format(_u.Strings.l_DeletePersonaFailed_Text,this.get_$41A().$Ex),null);return}this.get_$D2().$S5(2,$6RR(this),this.$$d_$78V,!1,_u.Strings.l_Delete_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,this.get_$78W())},$8XQ:function(){$4PI(this);$21n(this);this.$5k.set_$AG(this.$78E());$1e9(this);$6b(this,"PersonaInCompletedState")},$8cG:function(n){this.get_$41A()&&(this.get_$41A().$1VR=!0);this.set_$1v(n);$1e9(this);$21n(this);this.$7Wi()},$4lW:function(){if(!this.get_$iM()){$6b(this,"ClosePopup");this.get_$8K()&&this.get_$8K()()}},$5iS:function(){this.$5k.set_$bh(this.get_$bh());$21n(this)},$3zN:function(n){try{this.$6n.$Q9(n);_d.$6j.$mo(14,this.$8L.$9S,this.$12.get_$18())}catch(t){_js.Trace.logException(_d.$6S.$D,t,"Failed to open URL")}},$6qJ:function(){if(this.$3K&&this.$G.get_$O()==="Mouse"){var n=this;this.$3K.add_$XW(function(){if(!n.$9v&&n.$3K.$NH&&n.get_$41A()){var t=n.get_$41A().$PR;n.$3K.get_$Az().apcl(_c.$2G.$1bq,t.$$d_$5DH||(t.$$d_$5DH=Function.createDelegate(t,t.$5DH)))}})}},$8qp:function(){if(this.$3K&&this.$G.get_$O()==="Mouse"){var n=this;this.$3K.add_$XW(function(){if(n.$3K.$NH&&n.get_$41A()){var t=n.get_$41A().$PR;n.$3K.get_$Az().rpcl(_c.$2G.$1bq,t.$$d_$5DH||(t.$$d_$5DH=Function.createDelegate(t,t.$5DH)))}})}},$8cB:function(){this.$5k.set_$2BD(this.get_$2BD());this.$5k.set_$2jj(!this.get_$37f()&&this.get_$2BE());this.$5k.set_$1v(this.$12)},$7Wi:function(){},$8Yo:function(){this.$5k.set_$Lu(this.get_$Lu())},$1YQ:function(n,t){this.get_$iM()||$6b(this,"ClosePopup");return!1},$4oB:function(n){if(n.get_$18()!==2&&!n.get_$5s()){n.set_$9m(1);n=$6RW(this,n)}this.$10m.$1Aj(n)},$78E:function(){return 0},$1QM:function(){var n=_d.$88.prototype.$1QM.call(this);this.$G.get_$O()==="TouchNarrow"&&n.$dc(new _C(this.$$d_$6uB,_d.$6S.$D));return n},$4z3:function(n,t){n.val=[];t.val=null;this.get_$16j()&&(n.val[n.val.length]=this.get_$3PW())},$4yv:function(){var n=[];this.get_$37f()&&(n[n.length]=new _0365m.$n(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$1EZ,_d.$6S.$D)));return n},$7bV:function(){return this.$12.get_$9m()===3},$7QL:function(){this.get_$mf()||$6b(this,"ClosePopup")},$8l2:function(n){$6(this,"PivotSelectedOptionIndex");this.$8w0();$6RV(this)},$78V:function(n,t){if(n){var i=new _c.$qa(this.$12.get_$5s());i.add_$2A(this.$$d_$792);i.add_$20(this.$$d_$791);i.$BP=this.$8L.$9S;this.$p.$y(i);this.get_$8K()&&this.get_$8K()()}},$792:function(n){var t=n.$8w;_a.$3.$M(t,"personaId");$Bc(this,"DeleteSucceeded",this,t)},$791:function(n){n.$1b&&this.get_$D2().$3A(0,String.format(_u.Strings.l_DeletePersonaFailed_Text,this.get_$41A().$Ex),null)},$99q:function(n){this.set_$3m(n);_d.$6j.$mo(31,this.$8L.$9S,this.get_$4Ei())},$6uB:function(){$6b(this,"OnBack");if(this.get_$8K()){$6b(this,"ClosePopup");this.get_$8K()()}}};_d.$7b=function(n,t,i,r,u){this.$$d_$2L3=Function.createDelegate(this,this.$2L3);this.$$d_$5wG=Function.createDelegate(this,this.$5wG);this.$$d_$4lX=Function.createDelegate(this,this.$4lX);this.$$d_$5js=Function.createDelegate(this,this.$5js);this.$$d_$1YQ=Function.createDelegate(this,this.$1YQ);_d.$7b.initializeBase(this);this.$G=n;this.$1ZL=t;this.$66=i;this.$C7=r;this.set_$5rx(u);this.set_$7E($6Rp(this));this.$N3=new _y.$4p};function $3Fr(n){n.$s0=!1;n.$1GS=!1;n.get_$Xh().$36.set_$D5("");n.get_$Xh().$36.set_$HE(!1);n.get_$Xh().$36.set_$a9(!1);n.get_$KK().$6e()}function $4PQ(n){n.$542()}function $6Rp(n){switch(n.$G.get_$O()){case"TouchWide":return $6Ro(n);case"TouchNarrow":return $6Rn(n)}return null}function $6Rn(n){var t=_y.$26.$Bv(n,null,null);t.set_$1VC([t.$dc(n.get_$1RC()),t.$1CS()]);t.set_$MS([new _y.$2f(_y.$c.get_$2j(),_y.$c.get_$2gr(),_u.Strings.l_Folders_Text,n.get_$KK().get_$4xd())]);t.set_$XL($6Rq(n));t.set_$46Q(n.get_$KK().get_$uT());return t}function $6Ro(n){var t=_y.$26.$Bv(n,null,null);t.set_$1VC([t.$1CS()]);t.set_$MS([new _y.$2f(_y.$c.get_$qO(),_y.$c.get_$1Pg(),_u.Strings.l_AcceptItem_LowerCase_Text,n.get_$on()),new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_Discard_LowerCase_Text,n.get_$1RC())]);t.set_$46Q(n.get_$KK().get_$uT());return t}function $6Rq(n){return[n.get_$KK().$4pM()]}function $4PR(n,t){t?n.set_$1hU(_u.Strings.l_LeaveConfirmationDialogTitle_PeoplePicker_Text):n.set_$1hU(_u.Strings.l_CancelConfirmationDialogTitle_PeoplePicker_Text);n.set_$713($6Rr(n,t));n.set_$1mz(!0)}function $6Rr(n,t){var i=new _js.$X;var r=this;i.$H(new _a.$2E(new _C(function(){n.set_$1mz(!1);t&&$4PQ(n);n.$s0=!0;n.$423()},_d.$7b.$D),_u.Strings.l_Ok_LowerCase_Text,""));if(t){var u=this;i.$H(new _a.$2E(new _C(function(){n.set_$1mz(!1);n.$s0=!0;n.$423()},_d.$7b.$D),_u.Strings.l_DiscardAndCloseDialogButton_PeoplePicker_Text,""))}var f=this;i.$H(new _a.$2E(new _C(function(){n.set_$1mz(!1)},_d.$7b.$D),_u.Strings.l_CancelButtonText_Text,""));return i}_d.$7b.prototype={$1ZL:null,$66:null,$G:null,$N3:null,$113:null,$R7:null,$C7:null,$Zw:null,$Cv:null,$DS:null,$4G5:null,$44:null,$1GS:!1,$2Ch:!1,$qe:null,$25v:null,$423:null,$s0:!1,add_$1af:function(n){this.$2Z("SaveCompleted",n)},remove_$1af:function(n){this.$2b("SaveCompleted",n)},add_$5oX:function(n){this.$2Z("PickerClosed",n)},remove_$5oX:function(n){this.$2b("PickerClosed",n)},get_$427:function(){return 1},get_$8K:function(){return this.$R7},set_$8K:function(n){this.$R7=n;return n},get_$7A8:function(){return!0},get_$2Ao:function(){return this.$$d_$1YQ},get_$KK:function(){if(!this.$Zw){this.$Zw=this.$1ZL.$75Q();this.$Zw.add_$2Lz(this.$$d_$5js)}return this.$Zw},get_$1RC:function(){this.$Cv||(this.$Cv=new _C(this.$$d_$4lX,_d.$7b.$D));return this.$Cv},get_$on:function(){this.$DS||(this.$DS=new _C(this.$$d_$5wG,_d.$7b.$D));return this.$DS},get_$5rx:function(){return this.$113},set_$5rx:function(n){if(this.$113!==n){this.$113=n;$6(this,"RecipientWellLabel")}return n},get_$Xh:function(){if(!this.$44){var n=null;this.$C7&&this.$C7.get_$F()>0&&this.$G.get_$O()!=="TouchNarrow"&&(n=this.$C7.$46());this.$44=this.$75k(this.$66,n);this.$44.set_$48s(!1);this.$44.$1L.add_$1Z(this.$$d_$2L3)}return this.$44},get_$6Az:function(){this.$4G5||(this.$4G5=this.get_$KK().$52j());return this.$4G5},get_$Jr:function(){return this.$G.get_$O()!=="Mouse"?1:0},get_$1mz:function(){return this.$2Ch},set_$1mz:function(n){if(n!==this.$2Ch){this.$2Ch=n;$6(this,"IsConfirmDialogShown")}return n},get_$713:function(){return this.$25v},set_$713:function(n){if(n!==this.$25v){this.$25v=n;$6(this,"ConfirmDialogButtonData")}return n},get_$1hU:function(){return this.$qe},set_$1hU:function(n){if(n!==this.$qe){this.$qe=n;$6(this,"ConfirmDialogTitle")}return n},get_$Ug:function(){return _a.UserAgent.getInstance().$JT},$co:function(){_y.$1De.prototype.$co.call(this);this.get_$KK().$5F()},$Rx:function(){_y.$1De.prototype.$Rx.call(this);var n=this;_js.$K.get_$L().$3i(_a.$0.$cl,"RichPeoplePicker.PostTransitionOut",function(){$6b(n,"PickerClosed")})},$69X:function(n){this.get_$Xh().$1L.$1u();if(this.$G.get_$O()!=="TouchNarrow"&&n&&n.get_$F()>0){var t=this;n.$Bx(function(n){if(_y.$Cr.isInstanceOfType(n)){var i=n;i.$Kq?t.get_$Xh().$1fK(i.$BY):t.get_$Xh().$234(i.$BY)}})}this.$s0=!1;this.$1GS=!1},$75k:function(n,t){return n.$2c3(_d.$IP.$1wK,_y.$q.$Mp,t)},$542:function(){this.$1GS&&$EQ(this,"SaveCompleted",this.get_$Xh().$1L)},$5js:function(n){if(n.get_$1h()){_a.$3I.$OZ(_g.$2I.$rS(n.get_$1h()))||n.get_$1h().RoutingType==="MAPIPDL"?this.get_$Xh().$1fK(n):this.get_$Xh().$234(n);this.$G.get_$O()==="TouchNarrow"&&this.$5wG()}else{if(this.$G.get_$O()==="TouchNarrow"){this.get_$KK().get_$19R().set_$25(null);this.get_$KK().get_$jp().set_$25(null)}this.$N3.$3A(0,_u.Strings.l_NoEmailAddressError_PeoplePicker_Text,null)}},$59:function(){if(this.$Zw&&Sys.IDisposable.isInstanceOfType(this.$Zw)){this.$Zw.dispose();this.$Zw=null}_a.$1.prototype.$59.call(this)},$4lX:function(){this.$R7()},$1YQ:function(n,t){if(this.$s0){$3Fr(this);return!1}this.$423=n;if(this.$1GS){$4PR(this,!0);return!0}if(t===1||!t){$4PR(this,!1);return!0}$3Fr(this);return!1},$2L3:function(n,t){this.$1GS=!0},$5wG:function(){this.$s0=!0;$4PQ(this);this.$4lX();$3Fr(this)}};_d.$hu=function(n,t,i){this.$G=n;this.$1ZL=t;this.$66=i};_d.$hu.prototype={$G:null,$1ZL:null,$66:null,$4pF:function(n,t){return new _d.$7b(this.$G,this.$1ZL,this.$66,n,t)}};_d.$5S=function(){};_d.$5S.$51T=function(n,t,i,r,u){if(!n)throw Error.argumentNull("cacheTable invalid");if(!t)throw Error.argumentNull("querystring invalid");var f=[];if(""===t.trim()||!i)return f;for(var s=0,e=null,h=0;h<n.$1p.get_$F()&&s<i;h++){var o=n.$1p.get_$48(h);if(o&&_d.$5S.$7bU(o,t,r))if(u){e?e.set_$1v(o):e=new _d.$qG(o,u,"");for(var l=!1,a=f.length,c=0;c<a;c++)if(f[c].toLowerCase()===e.get_$1jB().toLowerCase()){l=!0;break}if(!l){Array.add(f,e.get_$1jB());s++}}else{Array.add(f,o);s++}}return f};_d.$5S.$3aP=function(n,t,i,r){return _d.$5S.$51T(_c.$14.$bV(),n,t,i,r)};_d.$5S.$9Bf=function(n,t){return t.$ic?_d.$5S.$7Me(n,t):null};_d.$5S.$4eD=function(n,t){if(n){_a.$3.$M(n.get_$1h(),"Persona with no email address can't be added to the cache");if(n.get_$1h().RoutingType==="SMTP"&&n.get_$1h().EmailAddress&&_a.$3I.$OZ(n.get_$1h().EmailAddress)){t.$1p.$H(n);var i=new Array(0);n.$9GM();Array.add(i,_d.$5S.$1Fh("PersonaDisplayNames","",n.get_$1l()));Array.add(i,_d.$5S.$1Fh("PersonaSurnames","",n.get_$1MZ()));Array.add(i,_d.$5S.$1Fh("PersonaMiddleNames","",n.get_$2JO()));Array.add(i,_d.$5S.$1Fh("PersonaGivenNames","",n.get_$1lC()));Array.add(i,_d.$5S.$1Fh("PersonaEmails1","",n.get_$1h().EmailAddress));Array.add(i,_d.$5S.$1Fh("PersonaEmails1DisplayNames","",n.get_$1h().Name));Array.add(i,_d.$5S.$1Fh("PersonaType","",_h.$Ae.toString(n.get_$18())));n.get_$1h().MailboxType==="Mailbox"&&Array.add(i,_d.$5S.$1Fh("PersonaImAddresses","",n.get_$8e()));var r=new _c.$fJ(n.get_$5s(),i,new _g.$Bn(new _g.$7o("recipientcache")),_h.$Ae.toString(1));OwaApplication.$1T.$y(r)}}};_d.$5S.$795=function(n,t){for(var r=t.$1p.get_$F(),i=0;i<r;i++){var u=t.$1p.get_$48(i);if(_c.$i.$1fg(n,u)){t.$1p.$67(i);return}}};_d.$5S.$7Me=function(n,t){if(!t.$ic)throw Error.invalidOperation("IsPersonaInRecipientCache should not be called if the cache was not loaded!");for(var u=t.$1p.get_$F(),i=0;i<u;i++){var r=t.$1p.get_$48(i);if(_c.$i.$2j0(n,r))return r}return null};_d.$5S.$7XV=function(n,t){return _d.$5S.$1Tu(n.get_$1l(),t,0)||_d.$5S.$5CC(n,t,0)||_d.$5S.$1Tu(n.get_$1h().EmailAddress,t,0)?!0:!1};_d.$5S.$7Md=function(n,t){for(var r=n.get_$F(),i=0;i<r;i++)if(n.get_$48(i)&&_d.$5S.$1Tu(n.get_$48(i).EmailAddress,t,0))return i;return-1};_d.$5S.$7bU=function(n,t,i){if(_d.$5S.$1Tu(n.get_$1l(),t,i)||_d.$5S.$1Tu(n.get_$KY(),t,i)||_d.$5S.$5CC(n,t,i))return!0;if(n.get_$5l())for(var u=n.get_$5l().length,r=0;r<u;r++)if(_d.$5S.$1Tu(n.get_$5l()[r].EmailAddress,t,i))return!0;return!1};_d.$5S.$1Tu=function(n,t,i){if(!_js.$8.$14(n)){t=t.toLocaleLowerCase();if(i===1&&n.toLowerCase()===t||!i&&n.toLowerCase().startsWith(t))return!0}return!1};_d.$5S.$5CC=function(n,t,i){if(!_js.$8.$14(n.get_$1l()))for(var u=n.get_$1l().split(" "),f=u.length,r=0;r<f;r++)if(_d.$5S.$1Tu(u[r],t,i))return!0;return!1};_d.$5S.$1Fh=function(n,t,i){var r=new _g.$IZ(new _g.$1i(n));r.OldValue=t;r.NewValue=i;return r};_d.$5S.$4dA=function(){};_d.$5S.$4dA.prototype={$7N9:function(n,t,i,r){return _d.$5S.$3aP(n,t,i,r)}};_d.$5I=function(n,t,i,r,u,f){this.$$d_$4wO=Function.createDelegate(this,this.$4wO);this.$$d_$8WL=Function.createDelegate(this,this.$8WL);this.$$d_$9Fo=Function.createDelegate(this,this.$9Fo);this.$$d_$9Fp=Function.createDelegate(this,this.$9Fp);this.$$d_$40F=Function.createDelegate(this,this.$40F);this.$$d_$2X2=Function.createDelegate(this,this.$2X2);this.$$d_$1lg=Function.createDelegate(this,this.$1lg);this.$$d_$3VI=Function.createDelegate(this,this.$3VI);this.$$d_$35Q=Function.createDelegate(this,this.$35Q);this.$$d_$1YQ=Function.createDelegate(this,this.$1YQ);this.$$d_$5h7=Function.createDelegate(this,this.$5h7);this.$$d_$2ao=Function.createDelegate(this,this.$2ao);this.$$d_$5kW=Function.createDelegate(this,this.$5kW);this.$$d_$8cR=Function.createDelegate(this,this.$8cR);this.$$d_$8cS=Function.createDelegate(this,this.$8cS);this.$$d_$8TG=Function.createDelegate(this,this.$8TG);this.$1Qh=0;_d.$5I.initializeBase(this);if(_js.$8.$c(r))throw Error.argumentNull("emailAddress");this.$G=n;this.$p=t;this.$CR=i;this.set_$7E($6St(this));this.$9e=r.toLocaleLowerCase();this.$1vi=_d.$5I.$7JR(r);this.$2oq=u;this.$4fG=f;this.set_$2Bc(this.$1vi+"&isPreview=false")};_d.$5I.$4oQ=function(n,t,i){return new _d.$5I(n,t,i,_g.$S.get_$L().get_$38().get_$Br(),!0,!1)};_d.$5I.$747=function(n,t,i,r){return new _d.$5I(t,i,r,n,!1,!0)};_d.$5I.$7JR=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetUserPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};function $6St(n){var t;t=n.get_$254()?[n.get_$45m(),n.get_$4rf(),n.get_$3OS()]:[n.get_$3OS()];return _y.$26.$Bv(n,t,null)}function $21p(n,t,i,r){return new _c.$18v(t,i,r,n.$9e,!n.$2oq)}function $6Sv(n,t){var i=new _at.$r1;i.$438(t,n.$$d_$8WL,n.$$d_$4wO,_d.$5I.$dF)}function $6Su(n,t){var i=null;switch(t){case 1:i=_u.Strings.l_CannotAttachFilesInSnapView_Text;break;case 0:i=_u.Strings.l_AttachmentFileReadError_Text;break;default:break}_js.$8.$c(i)||n.get_$D2().$3A(0,i,null)}_d.$5I.prototype={$G:null,$p:null,$CR:null,$1vi:null,$1GB:null,$Yr:null,$1r:null,$2LE:null,$sO:!1,$1MU:0,$2M3:null,$9e:null,$2oq:!1,$4fG:!1,$DS:null,$79:null,$IX:null,$lX:null,$16H:!1,$s0:!1,add_$69s:function(n){this.$2Z("UploadPhotoClosed",n)},remove_$69s:function(n){this.$2b("UploadPhotoClosed",n)},get_$254:function(){return this.$4fG||_g.$S.get_$L().get_$6D().get_$2PE()&&this.get_$5CE()},get_$1nk:function(){return this.$G.get_$O()==="Mouse"},get_$3jH:function(){return this.$G.get_$O()==="TouchNarrow"},get_$D2:function(){this.$1r||(this.$1r=new _y.$4p);return this.$1r},get_$7CJ:function(){return!this.get_$3gY()&&!this.$CR.get_$fm().get_$2y0()&&_a.UserAgent.getInstance().$U1?!0:!1},get_$1Ts:function(){return this.$16H},set_$1Ts:function(n){if(this.$16H!==n){this.$16H=n;$6(this,"IsDiscardChangesDialogShown")}return n},get_$sP:function(){return this.$sO},set_$sP:function(n){if(this.$sO!==n){this.$sO=n;$6(this,"IsWorking")}return n},get_$6w4:function(){return this.get_$59H()&&_g.$S.get_$L().get_$6D().get_$2PE()?new _C(this.$$d_$8TG,_d.$5I.$dF):null},get_$8kl:function(){return this.get_$5CE()&&_g.$S.get_$L().get_$6D().get_$2PE()?new _C(this.$$d_$8cS,_d.$5I.$dF):null},get_$8iA:function(){return this.$2LE},set_$8iA:function(n){this.$2LE=n;$6(this,"OpenPhotoPickerCommand");return n},get_$6qP:function(){return new _C(this.$$d_$8cR,_d.$5I.$dF)},get_$eN:function(){return this.$Yr},set_$eN:function(n){this.$Yr=n;$6(this,"Files");return n},get_$2ec:function(){return 15},get_$Jr:function(){return this.get_$1nk()?0:1},get_$on:function(){this.$DS||(this.$DS=new _C(this.$$d_$5kW,_d.$5I.$dF));return this.$DS},get_$1RC:function(){this.$79||(this.$79=new _C(this.$$d_$2ao,_d.$5I.$dF));return this.$79},get_$1R2:function(){this.$IX||(this.$IX=new _C(this.$$d_$5h7,_d.$5I.$dF));return this.$IX},get_$45m:function(){return new _y.$2f(_y.$c.get_$Ey(),_y.$c.get_$2OA(),_u.Strings.l_SaveMenuItem_LowerCase_Text,this.get_$on())},get_$4rf:function(){return new _y.$2f(_y.$c.get_$wg(),_y.$c.get_$wh(),_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$1R2())},get_$427:function(){return this.get_$1nk()?2:0},get_$2Ao:function(){return this.$$d_$1YQ},get_$3OS:function(){return new _y.$2f(_y.$c.get_$AQ(),_y.$c.get_$PO(),_u.Strings.l_CancelItem_LowerCase_Text,this.get_$1RC())},get_$3gY:function(){return this.$2oq&&this.$CR.get_$fm().get_$2hB()},get_$59H:function(){return this.$2oq&&this.$CR.get_$fm().get_$2Zo()},get_$5CE:function(){return this.get_$3gY()||this.get_$59H()||_a.UserAgent.getInstance().$U1},get_$2Bc:function(){return this.$1GB},set_$2Bc:function(n){this.$1GB=n!==""?n+String.format("&sc={0}",(new Date).getTime()):n;$6(this,"ImageSource");return n},get_$3Uq:function(){if(!this.$lX){this.$lX=new _js.$X;this.$lX.$H(new _a.$2E(new _C(this.$$d_$35Q,_d.$5I.$dF),_u.Strings.l_ConfirmDialog_Save_Text,null));this.$lX.$H(new _a.$2E(new _C(this.$$d_$3VI,_d.$5I.$dF),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$lX.$H(new _a.$2E(new _C(this.$$d_$1lg,_d.$5I.$dF),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$lX},$Rx:function(){_y.$1De.prototype.$Rx.call(this);this.$5u8()},$5u8:function(){this.$1Qh=0;this.$1MU=0;this.set_$sP(!1);this.set_$2Bc(this.$1vi+"&isPreview=false");this.$2M3=this.$1GB;this.$s0=!1},$8cS:function(){if(this.get_$3gY()){_js.Trace.logInfo(_d.$5I.$dF,"Call to get photo from gallery");this.$CR.$3aT(!1,this.$$d_$2X2,this.$$d_$40F);return}if(this.$CR.get_$fm().get_$2y0()){_js.Trace.logInfo(_d.$5I.$dF,"Call to native file picker");var n=this,t=this;this.$CR.$3zK(!1,"*",1,function(t){t.length>0&&n.$2X2(t[0])},function(n){$6Su(t,n)});return}_a.UserAgent.getInstance().$U1&&this.$2LE&&this.$2LE.$s()},$8TG:function(){_js.Trace.logInfo(_d.$5I.$dF,"Call to get photo from camera");this.$CR.$3aS(!1,this.$$d_$2X2,this.$$d_$40F)},$8cR:function(){$6Sv(this,this.$Yr.$48(0))},$2X2:function(n){var t=$21p(this,1,null,n);t.add_$2A(this.$$d_$9Fp);t.add_$20(this.$$d_$9Fo);this.$1MU=1;this.$2M3=this.$1vi+"&isPreview=true";this.set_$sP(!0);this.$p.$y(t)},$8WL:function(n){var t=$21p(this,1,n,null);t.add_$2A(this.$$d_$9Fp);t.add_$20(this.$$d_$9Fo);this.$1MU=1;this.$2M3=this.$1vi+"&isPreview=true";this.set_$sP(!0);this.$p.$y(t)},$9Fp:function(n){this.set_$sP(!1);this.set_$2Bc(this.$2M3);this.$1Qh=this.$1MU;if(this.$1MU===3){this.$s0=!0;$6b(this,"UploadPhotoClosed");this.$2ao()}},$9Fo:function(n){this.set_$sP(!1);this.get_$D2().$3A(0,n.$1b.message,null)},$5kW:function(){if(!this.$sO)switch(this.$1Qh){case 0:this.$2ao();break;case 1:var n=$21p(this,0,"",null);n.add_$2A(this.$$d_$9Fp);n.add_$20(this.$$d_$9Fo);this.$1MU=3;this.set_$sP(!0);this.$p.$y(n);break;case 2:var t=$21p(this,2,"",null);t.add_$2A(this.$$d_$9Fp);t.add_$20(this.$$d_$9Fo);this.$1MU=3;this.set_$sP(!0);this.$p.$y(t);break}},$2zG:function(){return this.$1YQ(null,2)},$5h7:function(){if(!this.$sO)switch(this.$1Qh){case 0:this.set_$2Bc("");this.$1Qh=2;break;case 1:var n=$21p(this,3,"",null);n.add_$2A(this.$$d_$9Fp);n.add_$20(this.$$d_$9Fo);this.$1MU=0;this.$2M3=this.$1vi+"&isPreview=false";this.set_$sP(!0);this.$p.$y(n);break;case 2:break}},$1YQ:function(n,t){if(this.$sO)return!0;if(this.$s0)return!1;if(this.$1Qh){this.set_$1Ts(!0);return!0}return!1},$40F:function(n){_js.Trace.logError(_d.$5I.$dF,n.message)},$4wO:function(){this.get_$D2().$3A(0,"Error when reading the file",null)},$2ao:function(){this.get_$3L()&&this.get_$3L().get_$7L()===this&&this.$18v()},$35Q:function(){this.$s0=!0;this.$1lg();this.$5kW()},$3VI:function(){this.$s0=!0;this.$1lg();this.$2ao();this.get_$3jH()&&$6b(this,"UploadPhotoClosed")},$1lg:function(){this.set_$1Ts(!1)}};_d.$jS=function(n,t,i){this.$1J=n;this.$38v=t;this.$5n5=i};_d.$jS.prototype={$1J:null,$38v:null,$5n5:null};OSF.AppSpecificSetup.registerClass("OSF.AppSpecificSetup");_d.$nC.registerClass("_d.$nC");_d.$14U.registerClass("_d.$14U");CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.$1C3);_d.$Et.registerClass("_d.$Et",_a.$ER,IPopOutViewModel);_d.$C4.registerClass("_d.$C4",null,IPopOutHelper);_d.$NU.registerClass("_d.$NU",_js.$9,_d.$19G);_d.$SN.registerClass("_d.$SN");_d.$Cz.registerClass("_d.$Cz",_a.$ER);_d.$Wz.registerClass("_d.$Wz");_d.$EY.registerClass("_d.$EY",_a.$ER);_d.$HC.registerClass("_d.$HC",_a.$ER);_d.$5N.registerClass("_d.$5N",_0365m.$2c);_d.$wu.registerClass("_d.$wu",_y.$99);_d.$X5.registerClass("_d.$X5");_d.$6N.registerClass("_d.$6N",_a.$ER);_d.$T0.registerClass("_d.$T0");_d.$61.registerClass("_d.$61",_a.$ER);_d.$jl.registerClass("_d.$jl");_d.$BV.registerClass("_d.$BV",_a.$ER);_d.$jk.registerClass("_d.$jk");_d.$Jr.registerClass("_d.$Jr",_a.$ER);_d.$1Dx.registerClass("_d.$1Dx",_y.$1De);_d.$8W.registerClass("_d.$8W");_d.$1Dp.registerClass("_d.$1Dp",_a.$ER,_g.$IK,_js.$sJ,_g.$N1);_d.$Jw.registerClass("_d.$Jw",_d.$1Dp);_d.$X8.registerClass("_d.$X8");_d.$DZ.registerClass("_d.$DZ",_a.$ER,_y.$1AG);_d.$oO.registerClass("_d.$oO");_d.$6b.registerClass("_d.$6b",_y.$K3);_d.$q6.registerClass("_d.$q6",_a.$ER,_g.ICalendarTimePeriod);_d.$O9.registerClass("_d.$O9");_d.$Bt.registerClass("_d.$Bt");_d.$h8.registerClass("_d.$h8",_js.$9);_d.$18R.registerClass("_d.$18R",_js.$9,_g.$11M);_d.$Hy.registerClass("_d.$Hy",_a.$ER);_d.$1n.registerClass("_d.$1n",_a.$ER,_d.$ri,_d.$11L);_d.$1Dy.registerClass("_d.$1Dy",_d.$1n);_d.$1E6.registerClass("_d.$1E6",_d.$1Dy);_d.$j9.registerClass("_d.$j9",_d.$1E6);_d.$I1.registerClass("_d.$I1",_d.$Jw);_d.$Ps.registerClass("_d.$Ps",null,_0365m.$11n);_d.$je.registerClass("_d.$je");_d.$X7.registerClass("_d.$X7",_a.$ER);_d.$Sy.registerClass("_d.$Sy",_d.$X7);_d.$RZ.registerClass("_d.$RZ",_0365m.$Fg);_d.$wj.registerClass("_d.$wj",_d.$RZ);_d.$jg.registerClass("_d.$jg",_a.$ER);_d.$pv.registerClass("_d.$pv");_d.$wl.registerClass("_d.$wl",_d.$pv);_d.$I5.registerClass("_d.$I5");_d.$HB.registerClass("_d.$HB",_a.$ER);_d.$6t.registerClass("_d.$6t",_a.$ER);_d.$7S.registerClass("_d.$7S",_d.$1n);_d.$EZ.registerClass("_d.$EZ",_d.$7S);_d.$jj.registerClass("_d.$jj");_d.$LB.registerClass("_d.$LB",_d.$X7);_d.$9U.registerClass("_d.$9U",_d.$LB);_d.$O0.registerClass("_d.$O0",_0365m.$n);_d.$9p.registerClass("_d.$9p");_d.$It.registerClass("_d.$It",_a.$ER,_y.$aH);_d.$3Q.registerClass("_d.$3Q",_d.$1Dx,_c.$1Bn);_d.$Iw.registerClass("_d.$Iw",_js.$9);_d.$HD.registerClass("_d.$HD");_d.$jn.registerClass("_d.$jn",_d.$1Dp);_d.$ep.registerClass("_d.$ep");_d.$jo.registerClass("_d.$jo",_d.$9U);_d.$jp.registerClass("_d.$jp");_d.$wx.registerClass("_d.$wx",_d.$X7);_d.$7y.registerClass("_d.$7y",_y.$1De,_y.$lV);_d.$T1.registerClass("_d.$T1",_d.$LB);_d.$I8.registerClass("_d.$I8",_y.$1De);_d.$XB.registerClass("_d.$XB");_d.$8X.registerClass("_d.$8X",_d.$X7);_d.$MW.registerClass("_d.$MW",_d.$7S);_d.$x4.registerClass("_d.$x4",_d.$MW);_d.$jw.registerClass("_d.$jw",_d.$MW);_d.$TP.registerClass("_d.$TP",_0365m.$n);_d.$8o.registerClass("_d.$8o",_d.$1n);_d.$1E8.registerClass("_d.$1E8",_d.$8o);_d.$t7.registerClass("_d.$t7",_d.$1E8);_d.$vV.registerClass("_d.$vV",_d.$Hy,_d.$ri,_d.$11L);_d.$eJ.registerClass("_d.$eJ",_d.$vV);_d.$hq.registerClass("_d.$hq");_d.$1DP.registerClass("_d.$1DP",_js.$9,_d.$19l,_js.$sJ,Sys.IDisposable);_d.$Fo.registerClass("_d.$Fo",_d.$1DP);_d.$8u.registerClass("_d.$8u",_a.$ER);_d.$Sz.registerClass("_d.$Sz",null,_js.$OV);_d.$ji.registerClass("_d.$ji",null,_js.$OV);_d.$LN.registerClass("_d.$LN",_d.$1DP);_d.$Jy.registerClass("_d.$Jy",null,_y.$1AR,_y.$1AP,_y.$1AO);_d.$7e.registerClass("_d.$7e",_a.$OE,_y.$1AI);_d.$DU.registerClass("_d.$DU",_a.$ER);_d.$CH.registerClass("_d.$CH",_d.$DU);_d.$k5.registerClass("_d.$k5");_d.$IA.registerClass("_d.$IA",_a.$ER);_d.$pc.registerClass("_d.$pc",null,_d.$1Bh);_d.$xK.registerClass("_d.$xK",_d.$Bt);_d.$k6.registerClass("_d.$k6");_d.$k7.registerClass("_d.$k7",_d.$Bt);_d.$TB.registerClass("_d.$TB");_d.$10.registerClass("_d.$10",_y.$1De,_y.$lV,_y.$Un,_y.$aG,_y.$rn,_d.$19G,_y.$ro,_d.$1Bk);_d.$Aq.registerClass("_d.$Aq",null,_y.$12O,_y.$sR);_d.$xO.registerClass("_d.$xO");_d.$Ed.registerClass("_d.$Ed",_a.$ER,_c.$1Bo);_d.$GV.registerClass("_d.$GV",_a.$ER);_d.$kA.registerClass("_d.$kA");_d.$40.registerClass("_d.$40",_y.$K3);_d.$3i.registerClass("_d.$3i",_js.$9,_d.$19k);_d.$P5.registerClass("_d.$P5",_a.$ER);_d.$Cw.registerClass("_d.$Cw",_js.$9);_d.$WA.registerClass("_d.$WA");_d.$LQ.registerClass("_d.$LQ");_d.$mo.registerClass("_d.$mo",_y.$K3);_d.$3f.registerClass("_d.$3f",_d.$P5);_d.$my.registerClass("_d.$my",null,_y.$12O);_d.$F2.registerClass("_d.$F2");_d.$cR.registerClass("_d.$cR");_d.$2n.registerClass("_d.$2n",_y.$28);_d.$4X.registerClass("_d.$4X",_d.$2n);_d.$jQ.registerClass("_d.$jQ");_d.$CD.registerClass("_d.$CD",_a.$OE,_y.$1AI);_d.$Q6.registerClass("_d.$Q6",_a.$ER,ICalendarMiniatureItemViewModel,_js.$sJ,Sys.IDisposable);_d.$58.registerClass("_d.$58",_a.$ER,ICalendarMiniatureNextAppointmentManager,_js.$sJ);_d.$58.$6vq.registerClass("_d.$58.$6vq",_c.$A6);_d.$4B.registerClass("_d.$4B",_d.$1Dx,_y.$Un,_y.$aG,_y.$rn);_d.$NY.registerClass("_d.$NY",_a.$ER);_d.$Ag.registerClass("_d.$Ag",_a.$ER);_d.$AH.registerClass("_d.$AH",_d.$Ag);_d.$PF.registerClass("_d.$PF",_d.$Ag);_d.$PE.registerClass("_d.$PE",_d.$PF);_d.$nY.registerClass("_d.$nY",_d.$1E6);_d.$ha.registerClass("_d.$ha",_d.$1Dp);_d.$NZ.registerClass("_d.$NZ",_d.$Ag);_d.$nb.registerClass("_d.$nb",_d.$PF);_d.$nc.registerClass("_d.$nc",_d.$PF);_d.$Jm.registerClass("_d.$Jm",_a.$ER);_d.$EV.registerClass("_d.$EV",_a.$ER);_d.$Jn.registerClass("_d.$Jn",_a.$ER);_d.$O1.registerClass("_d.$O1",_a.$OE,_y.$1AI);_d.$6M.registerClass("_d.$6M",_a.$ER,_y.$11O);_d.$eo.registerClass("_d.$eo");_d.$L6.registerClass("_d.$L6",_a.$ER);_d.$MS.registerClass("_d.$MS",_d.$Bt);_d.$tX.registerClass("_d.$tX");_d.$YO.registerClass("_d.$YO",_d.$Bt);_d.$3P.registerClass("_d.$3P",_y.$1De,_y.$Un,_y.$aG,_y.$rn,_d.$19G,_y.$19y);_d.$I6.registerClass("_d.$I6",null,_y.$12O,ICalendarReadingPaneViewModelFactory);_d.$5g.registerClass("_d.$5g",_a.$ER);_d.$fe.registerClass("_d.$fe");_d.$Wr.registerClass("_d.$Wr");_d.$ID.registerClass("_d.$ID",null,_d.$RA,_y.$11d);_d.$IS.registerClass("_d.$IS",null,_d.$RA,_y.$11d);_d.$IT.registerClass("_d.$IT",null,_d.$RA,_y.$11d);_d.$Gs.registerClass("_d.$Gs",null,_d.$RA,_y.$11d);_d.$GG.registerClass("_d.$GG");_d.$CX.registerClass("_d.$CX",_js.$9);_d.$2h.registerClass("_d.$2h");_d.$uF.registerClass("_d.$uF",_a.$ER);_d.$I0.registerClass("_d.$I0",null,_d.$RA,_y.$11d);_d.$Io.registerClass("_d.$Io",null,_d.$RA,_y.$11d);_d.$Ji.registerClass("_d.$Ji",null,_d.$RA,_y.$11d);_d.$7K.registerClass("_d.$7K",_a.$ER);_d.$Ie.registerClass("_d.$Ie",_a.$ER,_y.$11O);_d.$uS.registerClass("_d.$uS",_a.$ER,_g.$IK,_js.$sJ);_d.$7u.registerClass("_d.$7u",_y.$q,_g.$19X);_d.$Jd.registerClass("_d.$Jd",_d.$7u);_d.$EI.registerClass("_d.$EI",null,_y.$19P);_d.$Vf.registerClass("_d.$Vf",_d.$EI);_d.$3H.registerClass("_d.$3H",_d.$7e);_d.$6B.registerClass("_d.$6B",_a.$ER,_d.$19j,_g.ICalendarTimePeriod);_d.$4K.registerClass("_d.$4K",_d.$7S,_y.$Oc,_d.$19Z);_d.$4K.$3M0.registerClass("_d.$4K.$3M0");_d.$5M.registerClass("_d.$5M",_y.$1De,_y.$lV);_d.$If.registerClass("_d.$If",_a.$ER,_g.$IK,_js.$sJ,_g.$N1);_d.$o4.registerClass("_d.$o4",_y.$Cr);_d.$15y.registerClass("_d.$15y",null,_g.$11M);_d.$6J.registerClass("_d.$6J",_y.$1De,_y.$lV,_y.$aG);_d.$PK.registerClass("_d.$PK");_d.$8R.registerClass("_d.$8R",_d.$MW,_y.$Oc,Sys.IDisposable,_d.$19Z);_d.$Dw.registerClass("_d.$Dw",_a.$ER);_d.$eT.registerClass("_d.$eT");_d.$EX.registerClass("_d.$EX",_a.$ER,_d.$19e,_js.$sJ);_d.$FB.registerClass("_d.$FB",_y.$1De);_d.$Mj.registerClass("_d.$Mj");_d.$H0.registerClass("_d.$H0",_a.$ER,_d.$19f,_js.$sJ,_d.$19j);_d.$hv.registerClass("_d.$hv",_a.$ER);_d.$Ds.registerClass("_d.$Ds",_a.$ER,_d.$19g,_js.$sJ);_d.$uO.registerClass("_d.$uO",_a.$ER);_d.$Ni.registerClass("_d.$Ni",_d.$EX);_d.$Kl.registerClass("_d.$Kl",_d.$EX);_d.$16B.registerClass("_d.$16B",_d.$Kl);_d.$XL.registerClass("_d.$XL",_a.$ER);_d.$qW.registerClass("_d.$qW",_a.$ER);_d.$Tm.registerClass("_d.$Tm",_a.$ER);_d.$LV.registerClass("_d.$LV",_a.$ER);_d.$Ax.registerClass("_d.$Ax",_a.$1);_d.$Vn.registerClass("_d.$Vn",null,_0365m.$Ek);_d.$LX.registerClass("_d.$LX",null,IModuleHelpProvider);_d.$4.registerClass("_d.$4");_d.$Dv.registerClass("_d.$Dv",_js.$9);_d.$RS.registerClass("_d.$RS",_js.$9,_y.$19w);_d.$13a.registerClass("_d.$13a",null,IMeetNowManagerFactory);_d.$24.registerClass("_d.$24",_a.$ER);_d.$gl.registerClass("_d.$gl");_d.$RY.registerClass("_d.$RY");_d.$bU.registerClass("_d.$bU",_a.$ER,IOpenAnotherMailboxViewModel);_d.$VF.registerClass("_d.$VF",null,_d.$12L);_d.$4C.registerClass("_d.$4C",_a.$ER);_d.$Fa.registerClass("_d.$Fa",_a.$ER);_d.$np.registerClass("_d.$np",_a.$ER);_d.$7v.registerClass("_d.$7v",_a.$ER);_d.$AI.registerClass("_d.$AI",_y.$1De);_d.$vF.registerClass("_d.$vF",null,_d.$1BG);_d.$15m.registerClass("_d.$15m",_d.$vF);_d.$1Dm.registerClass("_d.$1Dm",_a.$ER);_d.$xE.registerClass("_d.$xE",_d.$1Dm);_d.$14d.registerClass("_d.$14d",_d.$1Dm);_d.$tj.registerClass("_d.$tj",null,_y.$11z);_d.$2s.registerClass("_d.$2s",_y.$K3,_y.$11z);_d.$MI.registerClass("_d.$MI",_a.$ER);_d.$TW.registerClass("_d.$TW",null,_y.$12O);_d.$TW.$41v.registerClass("_d.$TW.$41v");_d.$kZ.registerClass("_d.$kZ");_d.$z4.registerClass("_d.$z4",null,_d.$1BE);_d.$Av.registerClass("_d.$Av",null,_d.$1BE);_d.$3n.registerClass("_d.$3n");_d.$p9.registerClass("_d.$p9",_d.$3n);_d.$vk.registerClass("_d.$vk",_d.$p9);_d.$vi.registerClass("_d.$vi",_d.$p9);_d.$pC.registerClass("_d.$pC",_d.$3n);_d.$iC.registerClass("_d.$iC",_d.$3n);_d.$we.registerClass("_d.$we",_d.$iC);_d.$wd.registerClass("_d.$wd",_d.$iC);_d.$fi.registerClass("_d.$fi");_d.$Ti.registerClass("_d.$Ti");_d.$2T.registerClass("_d.$2T");_d.$1DH.registerClass("_d.$1DH",_d.$2T);_d.$z3.registerClass("_d.$z3",_d.$1DH);_d.$5z.registerClass("_d.$5z",_d.$2T);_d.$ka.registerClass("_d.$ka",_d.$5z);_d.$kb.registerClass("_d.$kb");_d.$z6.registerClass("_d.$z6",_d.$1DH);_d.$QY.registerClass("_d.$QY",_d.$5z);_d.$zf.registerClass("_d.$zf",_d.$3n);_d.$105.registerClass("_d.$105",_d.$3n);_d.$l1.registerClass("_d.$l1",_d.$3n);_d.$10e.registerClass("_d.$10e",_d.$3n);_d.$10i.registerClass("_d.$10i",_d.$3n);_d.$135.registerClass("_d.$135",_d.$3n);_d.$15X.registerClass("_d.$15X",_d.$3n);_d.$cU.registerClass("_d.$cU",_d.$3n);_d.$16X.registerClass("_d.$16X",_d.$3n);_d.$16h.registerClass("_d.$16h",_d.$3n);_d.$16k.registerClass("_d.$16k",_d.$3n);_d.$4o.registerClass("_d.$4o");_d.$vM.registerClass("_d.$vM",null,_y.$gW,_a.$11g);_d.$2r.registerClass("_d.$2r",_a.$ER,_y.$1AQ);_d.$J1.registerClass("_d.$J1",_d.$2r);_d.$qC.registerClass("_d.$qC",_y.$1De,_y.$Un,_y.$aG,_y.$rn,_y.$lV);_d.$OI.registerClass("_d.$OI");_d.$z5.registerClass("_d.$z5",_a.$T);_d.$z5.prototype.$J7=_a.$T.prototype.$J7;_d.$HP.registerClass("_d.$HP",null,IExtensibilityStatistics);_d.$HP.$4dT.registerClass("_d.$HP.$4dT");_d.$HP.$6uj.registerClass("_d.$HP.$6uj");_d.$HP.$4vw.registerClass("_d.$HP.$4vw");_d.$HP.$7ES.registerClass("_d.$HP.$7ES");_d.$Gc.registerClass("_d.$Gc",_a.$ER);_d.$qy.registerClass("_d.$qy",_y.$1De,_y.$Un,_y.$aG,_y.$rn,_y.$lV);_d.$kc.registerClass("_d.$kc");_d.$QZ.registerClass("_d.$QZ",_d.$2r);_d.$z7.registerClass("_d.$z7",_a.$T);_d.$z7.prototype.$J7=_a.$T.prototype.$J7;_d.$qz.registerClass("_d.$qz",_js.$CG);_d.$Qa.registerClass("_d.$Qa",null,IExtensibilityViewModelFactory);_d.$HQ.registerClass("_d.$HQ",_a.$ER,_y.$1AM);_d.$Bq.registerClass("_d.$Bq");_d.$xC.registerClass("_d.$xC",_d.$Bq);_d.$qv.registerClass("_d.$qv");_d.$75.registerClass("_d.$75");_d.$12h.registerClass("_d.$12h",_d.$Bq);_d.$5Y.registerClass("_d.$5Y",_d.$Bq);_d.$Gj.registerClass("_d.$Gj",_d.$Bq);_d.$KN.registerClass("_d.$KN",_d.$Bq);_d.$Fu.registerClass("_d.$Fu",_a.$ER);_d.$XG.registerClass("_d.$XG",null,_y.$12O);_d.$O6.registerClass("_d.$O6",_a.$OE,_y.$1AI);_d.$17B.registerClass("_d.$17B",null,_c.$sc);_d.$1Ce.registerClass("_d.$1Ce",null,_y.$11z);_d.$Qg.registerClass("_d.$Qg",_d.$1Ce);_d.$r7.registerClass("_d.$r7",_d.$1Ce);_d.$22.registerClass("_d.$22",_y.$6Y);_d.$Yk.registerClass("_d.$Yk",_d.$22);_d.$5i.registerClass("_d.$5i",_y.$1De,_y.$aG);_d.$aZ.registerClass("_d.$aZ");_d.$Of.registerClass("_d.$Of",_a.$ER);_d.$mC.registerClass("_d.$mC");_d.$DC.registerClass("_d.$DC",_a.$ER);_d.$8m.registerClass("_d.$8m",_a.$ER,_y.$rn);_d.$mD.registerClass("_d.$mD");_d.$87.registerClass("_d.$87",_d.$7e);_d.$VN.registerClass("_d.$VN",_y.$EE.$$(_d.$7u));_d.$14v.registerClass("_d.$14v",_a.$ER);_d.$hR.registerClass("_d.$hR",_d.$14v);_d.$tv.registerClass("_d.$tv",_d.$5i);_d.$VO.registerClass("_d.$VO",_d.$14v);_d.$5w.registerClass("_d.$5w",_y.$1De,_y.$lV,_y.$Un,_y.$aG,_y.$rn);_d.$bm.registerClass("_d.$bm");_d.$9X.registerClass("_d.$9X",_a.$OE,_g.ICalendarTimePeriod);_d.$mI.registerClass("_d.$mI");_d.$lq.registerClass("_d.$lq");_d.$nV.registerClass("_d.$nV");_d.$9c.registerClass("_d.$9c",_js.$9);_d.$BO.registerClass("_d.$BO",_d.$9c,_d.$1Bk);_d.$6i.registerClass("_d.$6i",_d.$9c);_d.$13F.registerClass("_d.$13F",_d.$6i);_d.$CT.registerClass("_d.$CT",_d.$9c);_d.$N7.registerClass("_d.$N7");_d.$N8.registerClass("_d.$N8",_d.$9c);_d.$Oh.registerClass("_d.$Oh",_d.$9c);_d.$RM.registerClass("_d.$RM",_d.$9c);_d.$13I.registerClass("_d.$13I",_d.$9c);_d.$IO.registerClass("_d.$IO",_d.$9c);_d.$mH.registerClass("_d.$mH",_d.$9c);_d.$CS.registerClass("_d.$CS",_d.$9c);_d.$7X.registerClass("_d.$7X",_d.$9c);_d.$B4.registerClass("_d.$B4",_d.$9c,_y.$1AH);_d.$8O.registerClass("_d.$8O",_d.$9c);_d.$FN.registerClass("_d.$FN",_d.$9c);_d.$13K.registerClass("_d.$13K",_d.$9c,_y.$1AA);_d.$13L.registerClass("_d.$13L",_d.$9c);_d.$N9.registerClass("_d.$N9",_d.$9c);_d.$4O.registerClass("_d.$4O",_d.$9c,_d.$1Bh);_d.$IP.registerClass("_d.$IP",_js.$9);_d.$4I.registerClass("_d.$4I",_d.$9c);_d.$Dj.registerClass("_d.$Dj",_d.$9c);_d.$Bd.registerClass("_d.$Bd",_d.$9c);_d.$13M.registerClass("_d.$13M",_d.$9c);_d.$DD.registerClass("_d.$DD",_d.$9c);_d.$FO.registerClass("_d.$FO",_d.$9c);_d.$Gm.registerClass("_d.$Gm",_d.$9c);_d.$13J.registerClass("_d.$13J",_d.$9c);_d.$ac.registerClass("_d.$ac",_d.$9c);_d.$EF.registerClass("_d.$EF",_d.$9c,_y.$1AS,_y.$1AP,_y.$1AO);_d.$1Dv.registerClass("_d.$1Dv",_y.$1Df);_d.$Gv.registerClass("_d.$Gv",_d.$1Dv);_d.$hV.registerClass("_d.$hV",_y.$K3);_d.$hW.registerClass("_d.$hW",_a.$ER,_y.$11O);_d.$1Do.registerClass("_d.$1Do",_a.$ER);_d.$nR.registerClass("_d.$nR",_d.$1Do);_d.$9v.registerClass("_d.$9v");_d.$13G.registerClass("_d.$13G");_d.$13H.registerClass("_d.$13H",null,IMailComposeContextFactory);_d.$V1.registerClass("_d.$V1",null,IMailComposeViewModelFactory,_y.$12O);_d.$sY.registerClass("_d.$sY",_a.$ER);_d.$KS.registerClass("_d.$KS",_d.$1Dv);_d.$wT.registerClass("_d.$wT",_d.$KS);_d.$y2.registerClass("_d.$y2",_d.$KS);_d.$z8.registerClass("_d.$z8",_d.$KS);_d.$12t.registerClass("_d.$12t",_d.$KS);_d.$NC.registerClass("_d.$NC",_d.$1Do);_d.$13i.registerClass("_d.$13i",_d.$KS);_d.$M1.registerClass("_d.$M1",_a.$ER);_d.$15M.registerClass("_d.$15M",_d.$KS);_d.$15l.registerClass("_d.$15l",_d.$KS);_d.$BN.registerClass("_d.$BN",_js.$9,_y.$1AD);_d.$Q.registerClass("_d.$Q",_a.$1,_g.$19b,_y.$1AC,_y.$1AI);_d.$mG.registerClass("_d.$mG",null,IMailComposeDiscardManager);_d.$1Z.registerClass("_d.$1Z",_a.$OE);_d.$13N.registerClass("_d.$13N");_d.$AA.registerClass("_d.$AA",_y.$1De,_y.$KF,_y.$KK,_y.$rn,_js.$sJ,_y.$lp,_y.$lV,_y.$Un,_y.$aG);_d.$KR.registerClass("_d.$KR",_a.$ER,_y.$1A8);_d.$mK.registerClass("_d.$mK",null,IMailResponseViewModelFactory);_d.$gr.registerClass("_d.$gr",_a.$ER);_d.$CC.registerClass("_d.$CC");_d.$sK.registerClass("_d.$sK",null,IInstantSearchFactory);_d.$lr.registerClass("_d.$lr",null,IInstantSearchRefinerManager);_d.$PI.registerClass("_d.$PI",_a.$ER,IRefinerViewModel,_js.$sJ);_d.$hL.registerClass("_d.$hL",_d.$PI);_d.$PP.registerClass("_d.$PP",_js.$9,ISearchRefinerCategoryViewModel,_js.$sJ);_d.$ce.registerClass("_d.$ce",null,_y.$19v);_d.$Cd.registerClass("_d.$Cd",_a.$ER);_d.$jJ.registerClass("_d.$jJ");_d.$kC.registerClass("_d.$kC",null,_0365m.$11n);_d.$AT.registerClass("_d.$AT",_a.$ER);_d.$qp.registerClass("_d.$qp",_y.$1De);_d.$CM.registerClass("_d.$CM",_lv.$4l);_d.$zR.registerClass("_d.$zR");_d.$12b.registerClass("_d.$12b",null,_y.$lf,_y.$12O);_d.$Bc.registerClass("_d.$Bc",_y.$1De);_d.$RF.registerClass("_d.$RF",_y.$1De);_d.$sh.registerClass("_d.$sh",null,IItemPartPartnerViewModelFactory);_d.$si.registerClass("_d.$si",null,IItemReadingPaneContextFactory);_d.$12j.registerClass("_d.$12j",null,_y.$G1,_y.$12O);_d.$Ok.registerClass("_d.$Ok",null,IMailErrorHandler);_d.$gh.registerClass("_d.$gh",_a.$ER);_d.$4s.registerClass("_d.$4s",_y.$K3,IMailFolderPermissionsDialogViewModel);_d.$ar.registerClass("_d.$ar",_a.$ER);_d.$NE.registerClass("_d.$NE",_d.$ar);_d.$as.registerClass("_d.$as");_d.$kD.registerClass("_d.$kD");_d.$13Y.registerClass("_d.$13Y",_d.$Bt);_d.$NF.registerClass("_d.$NF",_d.$Bt);_d.$mO.registerClass("_d.$mO",_d.$Bt);_d.$JK.registerClass("_d.$JK",_d.$ar);_d.$t0.registerClass("_d.$t0",_d.$ar);_d.$Oo.registerClass("_d.$Oo",_a.$ER,_y.$1AG);_d.$uD.registerClass("_d.$uD",_d.$ar);_d.$SG.registerClass("_d.$SG",_a.$ER,ISharedFolderViewModel);_d.$Hh.registerClass("_d.$Hh",_a.$ER);_d.$HG.registerClass("_d.$HG",_d.$Hh);_d.$jy.registerClass("_d.$jy",_a.$ER);_d.$L8.registerClass("_d.$L8",_d.$Hh);_d.$F1.registerClass("_d.$F1",_d.$Hh);_d.$DG.registerClass("_d.$DG",_d.$Hh);_d.$NL.registerClass("_d.$NL",_a.$ER);_d.$Ot.registerClass("_d.$Ot",_a.$ER,INotificationTrayViewModel);_d.$tO.registerClass("_d.$tO",null,INotificationTrayViewModel);_d.$nB.registerClass("_d.$nB",_js.$9,_d.$12Y,_js.$sJ);_d.$nq.registerClass("_d.$nq",_d.$Hh);_d.$oy.registerClass("_d.$oy",_js.$9,_d.$12Y,_js.$sJ);_d.$Dl.registerClass("_d.$Dl",_y.$1De,_y.$Un,_y.$aG,_y.$rn);_d.$Lw.registerClass("_d.$Lw",_d.$Dl);_d.$IV.registerClass("_d.$IV",_d.$Dl);_d.$JR.registerClass("_d.$JR",_d.$Dl);_d.$KZ.registerClass("_d.$KZ",_d.$Dl);_d.$Lu.registerClass("_d.$Lu",_d.$Dl);_d.$mp.registerClass("_d.$mp",_js.$9);_d.$Hi.registerClass("_d.$Hi",_a.$ER);_d.$JS.registerClass("_d.$JS",_y.$EE.$$(_d.$Hi));_d.$tV.registerClass("_d.$tV",_y.$1De,IOptionsViewModel);_d.$8r.registerClass("_d.$8r",_d.$tV,_y.$Un,_y.$aG,_y.$rn);_d.$tU.registerClass("_d.$tU",_d.$tV);_d.$Ri.registerClass("_d.$Ri",_d.$Dl);_d.$Vz.registerClass("_d.$Vz",_a.$ER);_d.$Lt.registerClass("_d.$Lt",_d.$Dl);_d.$Bg.registerClass("_d.$Bg",_d.$Dl);_d.$MX.registerClass("_d.$MX",_a.$ER);_d.$1Cf.registerClass("_d.$1Cf",null,_d.$1Ak);_d.$k8.registerClass("_d.$k8",_d.$1Cf);_d.$HJ.registerClass("_d.$HJ",_a.$ER);_d.$xN.registerClass("_d.$xN",_d.$k8);_d.$hN.registerClass("_d.$hN");_d.$9E.registerClass("_d.$9E",_a.$ER);_d.$jd.registerClass("_d.$jd",_a.$ER);_d.$TY.registerClass("_d.$TY",_a.$ER);_d.$l7.registerClass("_d.$l7");_d.$Rz.registerClass("_d.$Rz",_d.$4C,_0365f.$rp);_d.$lA.registerClass("_d.$lA",_d.$Rz,_0365f.$rp);_d.$lB.registerClass("_d.$lB");_d.$l6.registerClass("_d.$l6");_d.$Qs.registerClass("_d.$Qs",_a.$ER);_d.$2Y.registerClass("_d.$2Y",_a.$ER);_d.$4e.registerClass("_d.$4e",_y.$EE.$$(_d.$2Y));_d.$1Du.registerClass("_d.$1Du",_y.$EE.$$(_d.$4e));_d.$Fv.registerClass("_d.$Fv",_a.$ER,_y.$Qy);_d.$f2.registerClass("_d.$f2");_d.$qG.registerClass("_d.$qG",_y.$Dm);_d.$F7.registerClass("_d.$F7",_a.$ER,_y.$19S);_d.$QF.registerClass("_d.$QF",null,ICompositePersonaViewModelFactory);_d.$f7.registerClass("_d.$f7",_a.$ER);_d.$4d.registerClass("_d.$4d",_a.$ER);_d.$TV.registerClass("_d.$TV",_a.$ER);_d.$YJ.registerClass("_d.$YJ",_y.$EE.$$(_d.$TV));_d.$JZ.registerClass("_d.$JZ");_d.$z9.registerClass("_d.$z9",null,_y.$11z);_d.$1Dk.registerClass("_d.$1Dk",_a.$ER);_d.$82.registerClass("_d.$82",_y.$EE.$$(_d.$1Dk),_y.$KK,_y.$rn,_js.$sJ,_y.$lp,_y.$Oc);_d.$IW.registerClass("_d.$IW",_d.$82);_d.$CO.registerClass("_d.$CO");_d.$IG.registerClass("_d.$IG",_d.$22,_y.$19Q,_js.$sJ);_d.$Mm.registerClass("_d.$Mm",_d.$1Dk);_d.$1Cg.registerClass("_d.$1Cg");_d.$12p.registerClass("_d.$12p",_a.$ER);_d.$sl.registerClass("_d.$sl",_a.$ER);_d.$sm.registerClass("_d.$sm",_a.$ER);_d.$12q.registerClass("_d.$12q",_d.$sm,_y.$11O);_d.$aP.registerClass("_d.$aP",_d.$sm,_y.$KK,_y.$rn,_js.$sJ,_y.$lp,_y.$Oc);_d.$gb.registerClass("_d.$gb");_d.$gc.registerClass("_d.$gc");_d.$RJ.registerClass("_d.$RJ",_d.$1Du);_d.$3Z.registerClass("_d.$3Z",_0365m.$2c,_y.$19R);_d.$sz.registerClass("_d.$sz",null,IMeCardViewModelFactory);_d.$ms.registerClass("_d.$ms");_d.$mr.registerClass("_d.$mr");_d.$P2.registerClass("_d.$P2");_d.$Rr.registerClass("_d.$Rr",_a.$ER,_0365m.$Ek);_d.$Ke.registerClass("_d.$Ke",null,_0365m.$11n);_d.$JY.registerClass("_d.$JY",null,_y.$12O);_d.$NS.registerClass("_d.$NS",_y.$EE.$$(_a.$8f),_0365f.$rp,_d.$1Am);_d.$14b.registerClass("_d.$14b",_d.$NS);_d.$P4.registerClass("_d.$P4",_y.$mf);_d.$DN.registerClass("_d.$DN",_d.$Rz,_d.$1Am);_d.$14c.registerClass("_d.$14c",_d.$DN);_d.$GD.registerClass("_d.$GD",_d.$7u);_d.$nJ.registerClass("_d.$nJ",_a.$ER);_d.$P6.registerClass("_d.$P6",_js.$9,IPeopleSearchSuggestionAdaptorViewModel,_y.$19u,_js.$sJ);_d.$1H.registerClass("_d.$1H",_d.$1Du,_0365f.$rp);_d.$5B.registerClass("_d.$5B",_a.$OE,_y.$1AI);_d.$to.registerClass("_d.$to");_d.$Es.registerClass("_d.$Es",_d.$to,IPersonaCardViewModelFactory);_d.$tp.registerClass("_d.$tp",_d.$nP.$$(_a.$7));_d.$hP.registerClass("_d.$hP",_d.$nP.$$(_g.$1m));_d.$bi.registerClass("_d.$bi");_d.$DN.$7dm.registerClass("_d.$DN.$7dm");_d.$tn.registerClass("_d.$tn",_d.$nP.$$(_g.$66));_d.$Dn.registerClass("_d.$Dn",_d.$nP.$$(_g.$2u));_d.$nO.registerClass("_d.$nO",_d.$nP.$$(_g.$33));_d.$14t.registerClass("_d.$14t",_d.$nP.$$(Array));_d.$FX.registerClass("_d.$FX",_d.$nP.$$(String));_d.$7l.registerClass("_d.$7l",_d.$7u);_d.$15B.registerClass("_d.$15B",_0365m.$n);_d.$uB.registerClass("_d.$uB",_d.$1Cf);_d.$nh.registerClass("_d.$nh",_d.$uB);_d.$Kp.registerClass("_d.$Kp",_a.$ER,_y.$11d);_d.$SM.registerClass("_d.$SM",_y.$EE.$$(_d.$Kp));_d.$193.registerClass("_d.$193",_y.$28);_d.$194.registerClass("_d.$194",_d.$193);_d.$Bi.registerClass("_d.$Bi",_a.$ER,_y.$Oc);_d.$S6.registerClass("_d.$S6",_y.$Q0,IRecipientWellViewModelFactory);_d.$Sc.registerClass("_d.$Sc");_d.$jz.registerClass("_d.$jz");_d.$kE.registerClass("_d.$kE");_d.$nG.registerClass("_d.$nG");_d.$nj.registerClass("_d.$nj");_d.$BB.registerClass("_d.$BB",_a.$ER);_d.$MF.registerClass("_d.$MF",_y.$K3);_d.$No.registerClass("_d.$No",_a.$ER);_d.$18G.registerClass("_d.$18G",_d.$No);_d.$oW.registerClass("_d.$oW",_y.$1De);_d.$GO.registerClass("_d.$GO",_d.$No);_d.$Pb.registerClass("_d.$Pb",_d.$No);_d.$18J.registerClass("_d.$18J",_lv.$mJ);_d.$ST.registerClass("_d.$ST",_lv.$4l);_d.$oY.registerClass("_d.$oY");_d.$MG.registerClass("_d.$MG",_y.$1De);_d.$18O.registerClass("_d.$18O",_lv.$5r);_d.$Pc.registerClass("_d.$Pc",_lv.$NB);_d.$8T.registerClass("_d.$8T",_a.$OE,_y.$1AI);_d.$4n.registerClass("_d.$4n",_y.$1De,_y.$Un,_y.$aG,_y.$rn,_d.$19c,_y.$12a);_d.$v9.registerClass("_d.$v9",null,ITaskReadingPaneViewModelFactory);_d.$di.registerClass("_d.$di",null,_y.$12O);_d.$Kv.registerClass("_d.$Kv",_a.$ER);_d.$eL.registerClass("_d.$eL",_js.$9,_js.$OV);_d.$4A.registerClass("_d.$4A",_a.$ER);_d.$BT.registerClass("_d.$BT",_a.$ER,_y.$1AG);_d.$1Cp.registerClass("_d.$1Cp");_d.$1Cp.$1o.registerClass("_d.$1Cp.$1o");_d.$1Cp.$1o.$YZ.registerClass("_d.$1Cp.$1o.$YZ");_d.$1Cp.$1o.$GM.registerClass("_d.$1Cp.$1o.$GM");_d.$1Cp.$1o.$Hv.registerClass("_d.$1Cp.$1o.$Hv");_d.$w6.registerClass("_d.$w6",null,_js.$1CF);_d.$wk.registerClass("_d.$wk",null,_js.$1CF);_d.$wt.registerClass("_d.$wt",null,_js.$1CF);_d.$wq.registerClass("_d.$wq",null,_js.$1CF);_d.$Iu.registerClass("_d.$Iu",null,_js.$1CF);_d.$Iz.registerClass("_d.$Iz",null,_js.$1CF);_d.$q5.registerClass("_d.$q5",null,_js.$1CF);_d.$x3.registerClass("_d.$x3",null,_js.$1CF);_d.$y8.registerClass("_d.$y8",null,_js.$1CF);_d.$yR.registerClass("_d.$yR",null,_js.$1CF);_d.$qq.registerClass("_d.$qq",null,_js.$1CF);_d.$qr.registerClass("_d.$qr",null,_js.$1CF);_d.$rB.registerClass("_d.$rB",null,_js.$1CF);_d.$ft.registerClass("_d.$ft",null,_js.$1CF);_d.$mV.registerClass("_d.$mV",null,_js.$1CF);_d.$14q.registerClass("_d.$14q",null,_js.$1CF);_d.$15O.registerClass("_d.$15O",null,_js.$1CF);_d.$15Q.registerClass("_d.$15Q",null,_js.$1CF);_d.$uE.registerClass("_d.$uE",null,_js.$1CF);_d.$15W.registerClass("_d.$15W",null,_js.$1CF);_d.$15k.registerClass("_d.$15k",null,_js.$1CF);_d.$16E.registerClass("_d.$16E",null,_js.$1CF);_d.$16H.registerClass("_d.$16H",null,_js.$1CF);_d.$ih.registerClass("_d.$ih",null,_js.$1CF);_d.$wm.registerClass("_d.$wm",null,_js.$1CF);_d.$19E.registerClass("_d.$19E",null,_js.$1CF);_d.$CA.registerClass("_d.$CA",_y.$1De,IUnsupportedItemReadingPaneViewModel);_d.$zU.registerClass("_d.$zU",_a.$T);_d.$zU.prototype.$J7=_a.$T.prototype.$J7;_d.$E9.registerClass("_d.$E9",null,_d.$rw);_d.$Qm.registerClass("_d.$Qm");_d.$fr.registerClass("_d.$fr");_d.$Ia.registerClass("_d.$Ia");_d.$3T.registerClass("_d.$3T");_d.$3w.registerClass("_d.$3w");_d.$TC.registerClass("_d.$TC");_d.$88.registerClass("_d.$88",_a.$ER,_y.$KK,_y.$rn,_js.$sJ,_y.$lp,_y.$Un,_y.$aG,_y.$Oc);_d.$Bu.registerClass("_d.$Bu",_d.$88,_y.$lV);_d.$J2.registerClass("_d.$J2",_d.$Bu,_d.$1Al);_d.$Fx.registerClass("_d.$Fx",_d.$Bu);_d.$6S.registerClass("_d.$6S",_d.$88,_y.$lV);_d.$4r.registerClass("_d.$4r",_d.$6S);_d.$Lm.registerClass("_d.$Lm",_d.$6S);_d.$Aa.registerClass("_d.$Aa",_d.$Lm);_d.$x5.registerClass("_d.$x5",_a.$T);_d.$x5.prototype.$J7=_a.$T.prototype.$J7;_d.$ni.registerClass("_d.$ni",_a.$T);_d.$ni.prototype.$J7=_a.$T.prototype.$J7;_d.$yl.registerClass("_d.$yl");_d.$EB.registerClass("_d.$EB",_a.$ER);_d.$My.registerClass("_d.$My",_y.$1De);_d.$NN.registerClass("_d.$NN",_d.$Dl);_d.$7b.registerClass("_d.$7b",_y.$1De,_y.$lV,_y.$Un,_y.$aG,_y.$rn);_d.$ta.registerClass("_d.$ta",_d.$7b);_d.$7F.registerClass("_d.$7F",_js.$9);_d.$12z.registerClass("_d.$12z",_d.$7F);_d.$ga.registerClass("_d.$ga",_C);_d.$Oe.registerClass("_d.$Oe",_y.$1De);_d.$aS.registerClass("_d.$aS",_d.$Oe,_y.$lV);_d.$131.registerClass("_d.$131",_d.$7F);_d.$IN.registerClass("_d.$IN",_a.$ER);_d.$50.registerClass("_d.$50",_y.$1De,_y.$Un,_y.$aG,_y.$rn);_d.$Uv.registerClass("_d.$Uv",_d.$50,_y.$lV);_d.$13S.registerClass("_d.$13S",_d.$7F);_d.$Rj.registerClass("_d.$Rj",_y.$1De);_d.$4J.registerClass("_d.$4J",_y.$1De);_d.$7H.registerClass("_d.$7H",_a.$ER,_d.$1Ao,_d.$1Aj,Sys.IDisposable,IModernGroupsComposeFactory);_d.$6j.registerClass("_d.$6j");_d.$Gu.registerClass("_d.$Gu");_d.$2F.registerClass("_d.$2F",_d.$Lm);_d.$hu.registerClass("_d.$hu");_d.$5S.registerClass("_d.$5S");_d.$5S.$4dA.registerClass("_d.$5S.$4dA",null,IPeopleSuggestionLoader);_d.$5I.registerClass("_d.$5I",_y.$1De,_y.$aG);_d.$jS.registerClass("_d.$jS");_d.$C4.$3A6=null;_d.$NU.$D=_a.$0.$5i;_d.$Cz.$D=_a.$0.$1o;_d.$EY.$D=_a.$0.$1o;_d.$5N.$1yU=[new _d.$RY(_u.Strings.l_FreeBusyFree_Text,null,"Free"),new _d.$RY(_u.Strings.l_FreeBusyWorkingElsewhere_Text,null,"WorkingElsewhere"),new _d.$RY(_u.Strings.l_FreeBusyTentative_Text,null,"Tentative"),new _d.$RY(_u.Strings.l_FreeBusyBusy_Text,null,"Busy"),new _d.$RY(_u.Strings.l_FreeBusyOof_Text,null,"OOF")];_d.$6N.$1Jf=-1;_d.$6N.$D=_a.$0.$1o;_d.$61.$D=_a.$0.$Ag;_d.$BV.$D=_a.$0.$Ag;_d.$DZ.$D=_a.$0.$4jF;_d.$6b.$D=_a.$0.$1o;_d.$Hy.$66v=["TotalEvents0","TotalEvents1","TotalEvents2","TotalEvents3","TotalEvents4","TotalEvents5","TotalEvents6"];_d.$I1.$4qq=["Duration","TimeLabel","IsStartingEvent","IsEndingEvent"];_d.$1n.$5gy=["CanOpenItem","CanSelectItem","IsOwnerOfItem","CanUpdateItemDetails"];_d.$1n.$3Uk=!1;_d.$Sy.$D=_a.$0.$Kc;_d.$6t.$4qE=6e4;_d.$LB.$1zW=!1;_d.$9U.$D=_a.$0.$Kc;_d.$3Q.$D=_a.$0.$1o;_d.$3Q.$3xY=["CalendarHeaderHeight","CalendarHeadersHidden"];_d.$Iw.$1Y=_a.$0.$3OC;_d.$X7.$D=_a.$0.$Kc;_d.$I8.$1Y=_a.$0.$3OC;_d.$8X.$D=_a.$0.$Kc;_d.$7e.$1gm=new _H("CalendarItem",_g.$39,_d.$7e);_d.$7e.$3zb=new _H("OriginalCalendarItem",_g.$39,_d.$7e);_d.$7e.$2Yk=new _H("Attendees",_js.$X,_d.$7e);_d.$7e.$1n9=new _H("IsDraft",Boolean,_d.$7e);_d.$7e.$3YP=new _H("ForceDirty",Boolean,_d.$7e);_d.$7e.$$cctor();_d.$10.$D=_a.$0.$1o;_d.$GV.$D=_a.$0.$1o;_d.$3i.$3vW="OOF";_d.$Cw.$4yD="DetailedMerged";_d.$3f.$GN=null;_d.$3f.$aB=null;_d.$F2.$mi="ItemID";_d.$4X.$4r7=0;_d.$CD.$1Ev=new _H("EmailAddress",_g.$1m,_d.$CD);_d.$CD.$3MR=new _H("AttendeeType",_d.$jR,_d.$CD);_d.$CD.$1ok=new _H("IsValid",Boolean,_d.$CD);_d.$Q6.$2Zc=_a.$0.$2Zb;_d.$58.$2Zc=_a.$0.$2Zb;_d.$4B.$1DN=null;_d.$4B.$1VB=null;_d.$O1.$1gm=new _H("CalendarItem",_g.$39,_d.$O1);_d.$MS.$3mW=1;_d.$3P.$78D=0;_d.$3P.$D=_a.$0.$1o;_d.$5g.$D=_a.$0.$1o;_d.$3H.$3Wl=new _H("EventStart",_a.$7,_d.$3H);_d.$3H.$3Wg=new _H("EventEnd",_a.$7,_d.$3H);_d.$3H.$3Vd=new _H("DurationSelectedValue",_d.$xL,_d.$3H);_d.$3H.$4G3=new _H("ViewStartDate",_a.$7,_d.$3H);_d.$3H.$2fj=new _H("EventRequiredAttendees",_js.$X,_d.$3H);_d.$3H.$2fi=new _H("EventOptionalAttendees",_js.$X,_d.$3H);_d.$3H.$315=new _H("OriginalResourceAttendees",_js.$X,_d.$3H);_d.$3H.$314=new _H("OriginalRequiredAttendees",_js.$X,_d.$3H);_d.$3H.$313=new _H("OriginalOptionalAttendees",_js.$X,_d.$3H);_d.$3H.$46n=new _H("SelectedRoomList",_g.$1m,_d.$3H);_d.$3H.$46o=new _H("SelectedRoom",_g.$1m,_d.$3H);_d.$3H.$3fC=new _H("IsAnyAvailableRoomSelected",Boolean,_d.$3H);_d.$3H.$$cctor();_d.$4K.$5m4=0;_d.$4K.$4hA=3;_d.$5M.$D=_a.$0.$DT;_d.$6J.$D=_a.$0.$DT;_d.$DU.$D=_a.$0.$DT;_d.$Ax.$5W=_a.$0.$9h;_d.$Dv.$1Y=_a.$0.$681;_d.$RS.$1Y=_a.$0.$5JK;_d.$24.$D=_a.$0.$Hv;_d.$4C.$1Qa="CurrentMessage";_d.$4C.$2Eg="ItemsLoaded";_d.$4C.$2DU="IsLoadingRows";_d.$4C.$2FQ=_u.Strings.l_ListViewModelDefaultLoadingMessage_Text;_d.$4C.$1uB=_u.Strings.l_MailNoResults_Text;_d.$4C.$61p="ShowInfoMessage";_d.$4C.$3l8="";_d.$4C.$bO=_u.Strings.l_FailedRequestError_Text;_d.$7v.$3xE=-864e5;_d.$AI.$D=_a.$0.$Ix;_d.$2s.$2EV=new _H("IsVisible",Boolean,_d.$2s,!1);_d.$2s.$3gH=new _H("IsError",Boolean,_d.$2s,!1,null,_d.$2s.$8Yp);_d.$2s.$3ia=new _H("IsRetriable",Boolean,_d.$2s,!1);_d.$2s.$3h9=new _H("IsListening",Boolean,_d.$2s,!1,null,_d.$2s.$8Yu);_d.$2s.$3jB=new _H("IsThinking",Boolean,_d.$2s,!1,null,_d.$2s.$8Z0);_d.$2s.$4AX=new _H("SpeechLevel",Number,_d.$2s,0);_d.$2s.$4As=new _H("StateDescription",String,_d.$2s,"");_d.$2s.$3KU=new _H("AdditionalInformation",_js.$X,_d.$2s);_d.$2s.$3wZ=new _H("NoResultsAvailableText",String,_d.$2s,_u.Strings.l_SpeechNoResultsAvailable_Text);_d.$2s.$4Am=new _H("StartListeningCommand",_js.$CG,_d.$2s);_d.$2s.$4B0=new _H("StopListeningCommand",_js.$CG,_d.$2s);_d.$MI.$3lP=!1;_d.$Av.$2KC=null;_d.$Av.$3wQ=["junkemail","drafts"];_d.$fi.$3Tm=18e5;_d.$Ti.$3Tm=18e5;_d.$Ti.$2r9=1e6;_d.$2T.$1kf={wasSuccessful:!1};_d.$2T.$4gZ={wasProxySuccessful:!1,errorMessage:_d.$2T.$vX};_d.$2T.$23z={wasSuccessful:!1,errorMessage:_d.$2T.$vX};_d.$2T.$4ga={error:1,errorMessage:_d.$2T.$vX};_d.$2T.$vX=String.format(_u.Strings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2T.$1dQ=new RegExp(" ","g");_d.$cU.$4qV={wasSuccessful:!0};_d.$2r.$4vx="ExtensionBecomeActiveTestOnly";_d.$2r.$2KE="NoActiveOwaExtensions";_d.$2r.$2G2="MarketplaceUrl";_d.$2r.$2zi="OnGetExtensibilityContextCompleted";_d.$2r.$55H="HideExtensionContainer";_d.$2r.$4dU="ActiveExtensionsCount";_d.$2r.$vX=String.format(_u.Strings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2r.$2mb=!1;_d.$2r.$2hk=new Sys.EventHandlerList;_d.$OI.$Cg={};_d.$Gc.$55J="HideExtensionContextMenu";_d.$Gc.$4CV="TabSelectedExtension";_d.$Fu.$47N=new _H("SendText",String,_d.$Fu,"");_d.$Fu.$40U=new _H("ParticipantsViewModel",_y.$28,_d.$Fu);_d.$O6.$3P3=new _H("Chat",_h.$1Y,_d.$O6);_d.$Qg.$4rT=new _g.$P8("Default");_d.$5i.$D=_a.$0.$4h;_d.$DC.$2qK=[7,0];_d.$8m.$D=_a.$0.$4h;_d.$87.$46P=new _H("SearchTerm",String,_d.$87);_d.$87.$46K=new _H("SearchPositionLatitude",Number,_d.$87);_d.$87.$46L=new _H("SearchPositionLongitude",Number,_d.$87);_d.$87.$46h=new _H("SelectedOptionIndex",Number,_d.$87);_d.$87.$46f=new _H("SelectedLocation",_g.$3G,_d.$87);_d.$9X.$33l=new _H("Recurrence",_g.$EK,_d.$9X);_d.$9X.$3iL=new _H("IsRecurringMaster",Boolean,_d.$9X);_d.$9X.$393=new _H("Start",_a.$7,_d.$9X);_d.$9X.$2fO=new _H("End",_a.$7,_d.$9X);_d.$BO.$3MO=new _H("AttachmentWellViewModel",_y.$11J,_d.$BO);_d.$BO.$17G=new _H("Menu",_0365m.$2c,_d.$9c);_d.$CT.$3lD=new _y.$2j(_u.Strings.l_LoadingPermissions_LowerCase_Text,null,null);_d.$Oh.$17G=new _H("Menu",_0365m.$2c,_d.$Oh);_d.$CS.$5pX=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_d.$B4.$QH=[84,85,86,87];_d.$8O.$3Yb=new _H("FromDetailsViewModel",_d.$7u,_d.$8O);_d.$8O.$47D=new _H("SenderDetailsViewModel",_d.$7u,_d.$8O);_d.$8O.$3lL=new _H("LocationViewModel",_d.$DC,_d.$8O);_d.$8O.$3hU=new _H("IsMeetingForwardOnBehalfOf",Boolean,_d.$8O);_d.$8O.$8pE=new _H("RecurrencePatternDataObject",_d.$CX,_d.$8O);_d.$IP.$1wK=7;_d.$IP.$5rs=1;_d.$4I.$44t=new _H("ResizeEditorCommand",_js.$CG,_d.$4I);_d.$6i.$QH=[60,40,43,1001,700,50,800,88,89,742,743];_d.$Dj.$17G=new _H("Menu",_0365m.$2c,_d.$Dj);_d.$Bd.$3mO=10;_d.$Bd.$QH=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89,735,750,745,741,739];_d.$DD.$62q=_a.UserAgent.getInstance().$8O?_js.$8.$4C("{0}{0}","<P></P>"):_js.$8.$4C("{0}{0}","<P><BR></P>");_d.$DD.$5sG=new RegExp("[\n\r]+","g");_d.$KS.$1Ce=["mailto:"];_d.$NC.$1Ce=["mailto:"];_d.$M1.$4y1=new RegExp("([\\w-\\.@]+)\\s\\<\\s*[\\w-\\.]+@[\\w-\\.]+\\s*\\>");_d.$M1.$2f9=new RegExp("([\\w-\\.]+)@[\\w-\\.]+");_d.$Q.$4G7=new _H("ViewModelId",String,_d.$Q);_d.$Q.$2LG=new _H("Operation",_y.$Oi,_d.$Q);_d.$Q.$zz=new _H("Mode",_y.$st,_d.$Q);_d.$Q.$3zf=new _H("OriginalId",_g.$1j,_d.$Q);_d.$Q.$3ze=new _H("OriginalDocumentId",Number,_d.$Q);_d.$Q.$3zg=new _H("OriginalItem",_g.$w,_d.$Q);_d.$Q.$3VU=new _H("DraftId",_g.$1j,_d.$Q);_d.$Q.$4B3=new _H("StoreId",String,_d.$Q);_d.$Q.$Vx=new _H("Subject",String,_d.$Q,"");_d.$Q.$1jQ=new _H("EditorContent",String,_d.$Q,"");_d.$Q.$436=new _H("RawEditorContent",String,_d.$Q);_d.$Q.$4Cv=new _H("TextEditorContent",String,_d.$Q);_d.$Q.$3NH=new _H("BodyType",String,_d.$Q);_d.$Q.$1BG=new _H("ToRecipients",_js.$KJ,_d.$Q);_d.$Q.$38w=new _H("SpeechResultRecipients",_js.$KJ,_d.$Q);_d.$Q.$20E=new _H("ToQueryString",String,_d.$Q);_d.$Q.$13z=new _H("CcRecipients",_js.$KJ,_d.$Q);_d.$Q.$1h3=new _H("CcQueryString",String,_d.$Q);_d.$Q.$13f=new _H("BccRecipients",_js.$KJ,_d.$Q);_d.$Q.$1gF=new _H("BccQueryString",String,_d.$Q);_d.$Q.$36v=new _H("AutoAddSignature",Boolean,_d.$Q,!0);_d.$Q.$1m5=new _H("Importance",String,_d.$Q,"Normal");_d.$Q.$431=new _H("QuotedBody",String,_d.$Q);_d.$Q.$4A6=new _H("SmimeQuotedBody",String,_d.$Q);_d.$Q.$4A2=new _H("SmimeDataPackage",_g.$HR,_d.$Q);_d.$Q.$4A0=new _H("SmimeAttachmentsTypeProperty",String,_d.$Q);_d.$Q.$4A4=new _H("SmimeException",Error,_d.$Q);_d.$Q.$4A7=new _H("SmimeRecipientCerts",Array,_d.$Q);_d.$Q.$4A8=new _H("SmimeType",Number,_d.$Q);_d.$Q.$4A1=new _H("SmimeCertRawData",String,_d.$Q);_d.$Q.$3fl=new _H("IsComplete",Boolean,_d.$Q);_d.$Q.$2nG=new _H("IsMeeting",Boolean,_d.$Q);_d.$Q.$3hV=new _H("IsMeetingForward",Boolean,_d.$Q);_d.$Q.$3iR=new _H("IsReplyAllOnBcc",Boolean,_d.$Q);_d.$Q.$1pY=new _H("Location",_g.$3G,_d.$Q);_d.$Q.$3bw=new _H("HasLocation",Boolean,_d.$Q);_d.$Q.$3mb=new _H("MeetingCalendarTimeBlock",_d.$9X,_d.$Q);_d.$Q.$1SL=new _H("From",_g.$Bk,_d.$Q);_d.$Q.$36M=new _H("Sender",_g.$Bk,_d.$Q);_d.$Q.$3jO=new _H("IsUpgraded",Boolean,_d.$Q);_d.$Q.$3gW=new _H("IsFromShown",Boolean,_d.$Q);_d.$Q.$3fR=new _H("IsBccShown",Boolean,_d.$Q);_d.$Q.$1vL=new _H("ParentFolderNameToPost",String,_d.$Q);_d.$Q.$40N=new _H("ParentFolderIdToPost",_g.$3J,_d.$Q);_d.$Q.$1Or=new _H("AttachmentCollection",_js.$X,_d.$Q);_d.$Q.$3MI=new _H("AttachmentsToHide",Array,_d.$Q);_d.$Q.$4FS=new _H("UpgradeFailed",Boolean,_d.$Q);_d.$Q.$3N4=new _H("Baseline",_d.$1Z,_d.$Q);_d.$Q.$3bk=new _H("HasBeenSavedByUser",Boolean,_d.$Q);_d.$Q.$3iT=new _H("IsReplyForward",Boolean,_d.$Q);_d.$Q.$3VV=new _H("Draft",_g.$w,_d.$Q);_d.$Q.$45Q=new _H("RightsManagementLicenseData",_g.$cQ,_d.$Q);_d.$Q.$1hP=new _H("ComplianceId",String,_d.$Q);_d.$Q.$3fg=new _H("IsClassified",Boolean,_d.$Q);_d.$Q.$3PF=new _H("ClassificationGuid",String,_d.$Q);_d.$Q.$3PH=new _H("Classification",String,_d.$Q);_d.$Q.$3PE=new _H("ClassificationDescription",String,_d.$Q);_d.$Q.$3PG=new _H("ClassificationKeep",Boolean,_d.$Q);_d.$Q.$1bJ=new _H("Sensitivity",String,_d.$Q,"Normal");_d.$Q.$1Tr=new _H("IsDeliveryReceiptRequested",Boolean,_d.$Q);_d.$Q.$1UZ=new _H("IsReadReceiptRequested",Boolean,_d.$Q);_d.$Q.$1yy=new _H("SmimeEncryptMessage",Boolean,_d.$Q);_d.$Q.$1z1=new _H("SmimeSignMessage",Boolean,_d.$Q);_d.$Q.$1hc=new _H("ConversationId",_g.$1j,_d.$Q);_d.$Q.$40K=new _H("ParentConversationNodeId",String,_d.$Q);_d.$Q.$3hs=new _H("IsOriginalIdCalendarItemId",Boolean,_d.$Q);_d.$Q.$3hn=new _H("IsOccurrenceReferencingMaster",Boolean,_d.$Q);_d.$Q.$3i4=new _H("IsPoppedOutFromInline",Boolean,_d.$Q);_d.$Q.$3hD=new _H("IsLoadedDraft",Boolean,_d.$Q);_d.$Q.$4GO=new _H("WasCleanNewMessageBeforePopout",Boolean,_d.$Q);_d.$Q.$3ce=new _H("HideIncludeEntrypoint",Boolean,_d.$Q,!1);_d.$Q.$4GS=new _H("WasSavingBeforePopout",Boolean,_d.$Q,!1);_d.$Q.$3hg=new _H("IsMovedToDraftFromOutbox",Boolean,_d.$Q,!1);_d.$Q.$40t=new _H("PerfContext",_a.$AF,_d.$Q,null);_d.$Q.$45N=new _H("RichTextEditorSupported",Boolean,_d.$Q,null);_d.$Q.$3VC=new _H("DlpSenderOverride",String,_d.$Q,null);_d.$Q.$3VB=new _H("DlpFalsePositive",String,_d.$Q,null);_d.$Q.$1Ro=new _H("ExtendedPropertyCollection",_js.$X,_d.$Q,null);_d.$Q.$ua=null;_d.$Q.$$cctor();_d.$1Z.$Vx=new _H("Subject",String,_d.$1Z,"");_d.$1Z.$1jQ=new _H("EditorContent",String,_d.$1Z,"");_d.$1Z.$1BG=new _H("ToRecipients",_js.$X,_d.$1Z);_d.$1Z.$20E=new _H("ToQueryString",String,_d.$1Z);_d.$1Z.$13z=new _H("CcRecipients",_js.$X,_d.$1Z);_d.$1Z.$1h3=new _H("CcQueryString",String,_d.$1Z);_d.$1Z.$13f=new _H("BccRecipients",_js.$X,_d.$1Z);_d.$1Z.$1gF=new _H("BccQueryString",String,_d.$1Z);_d.$1Z.$1m5=new _H("Importance",String,_d.$1Z,"Normal");_d.$1Z.$1SL=new _H("From",_g.$1m,_d.$1Z);_d.$1Z.$1hP=new _H("ComplianceId",String,_d.$1Z);_d.$1Z.$1bJ=new _H("Sensitivity",String,_d.$1Z,"Normal");_d.$1Z.$1Tr=new _H("IsDeliveryReceiptRequested",Boolean,_d.$1Z);_d.$1Z.$1UZ=new _H("IsReadReceiptRequested",Boolean,_d.$1Z);_d.$1Z.$1yy=new _H("SmimeEncryptMessage",Boolean,_d.$1Z);_d.$1Z.$1z1=new _H("SmimeSignMessage",Boolean,_d.$1Z);_d.$1Z.$1Or=new _H("AttachmentCollection",_js.$X,_d.$1Z);_d.$1Z.$1Ro=new _H("ExtendedPropertyCollection",_js.$X,_d.$1Z,null);_d.$1Z.$2f7=new _a.$DB(_g.$1m);_d.$1Z.$$cctor();_d.$KR.$D=_a.$0.$d;_d.$Bc.$D=_a.$0.$1e;_d.$RF.$D=_a.$0.$5i;_d.$4s.$IR=_a.$0.$9h;_d.$4s.$2bR=null;_d.$4s.$$cctor();_d.$Oo.$D=_a.$0.$3vI;_d.$Lw.$D=_a.$0.$fx;_d.$IV.$D=_a.$0.$fx;_d.$JR.$D=_a.$0.$fx;_d.$KZ.$D=_a.$0.$fx;_d.$Dl.$D=_a.$0.$fx;_d.$JS.$3kU=new _H("LastSelectedItem",_d.$Hi,_d.$JS,null,null,null);_d.$8r.$D=_a.$0.$fx;_d.$Vz.$6AR="\\((?:UTC|GMT)[\\s\\d\\+\\-:]*\\)";_d.$Bg.$5W=_a.$0.$1zZ;_d.$HJ.$D=_a.$0.$6q;_d.$9E.$D=_a.$0.$6q;_d.$4d.$D=_a.$0.$9h;_d.$YJ.$1iW=_u.Strings.l_DisplayPreferences_LowerCase_Text;_d.$JZ.$5oI=[8,0,2,1];_d.$JZ.$5oJ=[9,0,2,1];_d.$82.$D=_a.$0.$9C;_d.$82.$1iW=_u.Strings.l_PeopleFilterListDefaultTitle_Text;_d.$IG.$D=_a.$0.$UN;_d.$3Z.$2aO="ChatSignInState";_d.$3Z.$3go="IsIMPresenceStateAvailable";_d.$3Z.$5q0="PresenceImageType";_d.$3Z.$59C="IsBusy";_d.$3Z.$4iO="BusyMessage";_d.$3Z.$3WZ="ErrorMessage";_d.$3Z.$D=_a.$0.$2GC;_d.$3Z.$4uD="PersonalSettings/EditAccount.aspx?chgPhoto=1";_d.$3Z.$4uF="_blank";_d.$3Z.$4uE="width=600,height=400,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no";_d.$3Z.$5fI=7;_d.$GD.$D=_a.$0.$31t;_d.$4e.$D=_a.$0.$6q;_d.$2Y.$D=_a.$0.$6q;_d.$5B.$3gJ=new _H("IsExpandable",Boolean,_d.$5B);_d.$5B.$19Q=new _H("Persona",_c.$i,_d.$5B);_d.$5B.$zz=new _H("Mode",_d.$14l,_d.$5B);_d.$5B.$3kc=new _H("LayoutType",_y.$nN,_d.$5B);_d.$5B.$3QX=new _H("ControlSize",_y.$14r,_d.$5B);_d.$5B.$41a=new _H("PivotSelectedOptionIndex",Number,_d.$5B);_d.$5B.$3fd=new _H("IsCardInPopoutState",Boolean,_d.$5B);_d.$5B.$3Rx=new _H("CreatePersonaCardUnderMyContactsFolder",Boolean,_d.$5B);_d.$5B.$40M=new _H("ParentFolderId",_g.$3J,_d.$5B);_d.$DN.$D=_a.$0.$9C;_d.$SM.$1iW=_u.Strings.l_SortOptionsListDefaultTitle_Text;_d.$2n.$D=_a.$0.$cq;_d.$2n.$2f9=new RegExp("[\\w-\\.!#%&'=~`/\\$\\|\\?\\*\\+\\{\\}]+@[\\w-\\.]+");_d.$2n.$4v6=new RegExp("([.*+?${}/])","g");_d.$22.$D=_a.$0.$UN;_d.$Bi.$D=_a.$0.$UN;_d.$BB.$D=_a.$0.$1B8;_d.$MF.$D=_a.$0.$1B8;_d.$GO.$D=_a.$0.$1B8;_d.$Pb.$D=_a.$0.$1B8;_d.$ST.$D=_a.$0.$65n;_d.$MG.$3Au=175;_d.$MG.$3At=47;_d.$8T.$4Cf=new _H("Task",_g.$9G,_d.$8T);_d.$8T.$3Vm=new _H("EditedTask",_g.$9G,_d.$8T);_d.$8T.$3hi=new _H("IsNewTask",Boolean,_d.$8T);_d.$8T.$3gB=new _H("IsEditMode",Boolean,_d.$8T);_d.$8T.$1n9=new _H("IsDraft",Boolean,_d.$8T);_d.$4n.$D=_a.$0.$1B8;_d.$4A.$D=_a.$0.$2MD;_d.$4A.$3Od=new _H("CanDial",Boolean,_d.$4A,!0);_d.$4A.$41i=new _H("PlayOnPhoneActive",Boolean,_d.$4A,!1);_d.$4A.$3UZ=new _H("DialString",String,_d.$4A,"");_d.$4A.$3mu=new _H("MessageText",String,_d.$4A,"");_d.$4A.$41j=new _H("PlayOnPhoneCommand",_js.$CG,_d.$4A);_d.$4A.$41k=new _H("PlayOnPhoneDisconnectCommand",_js.$CG,_d.$4A);_d.$4A.$41h=new _H("PlayOnPhoneActiveCommand",_js.$CG,_d.$4A);_d.$4A.$3i1=new _H("IsPhoneCallActive",Boolean,_d.$4A,!1);_d.$BT.$yY=new _H("Item",_g.$do,_d.$BT);_d.$BT.$4AP=new _H("Source",_d.$jS,_d.$BT,null);_d.$BT.$41m=new _H("PlayOnPhoneViewModel",_d.$4A,_d.$BT);_d.$1Cp.$1o.$GM.$2OD=_a.$0.$DT;_d.$1Cp.$1o.$Hv.$3me=_a.$0.$Hv;_d.$Iu.$4rW=2;_d.$CA.$4ps="CurrentItem";_d.$CA.$5Ee="ItemNotSupported";_d.$CA.$5da="MoveButtonText";_d.$CA.$77v="DebugInfo";_d.$CA.$7YJ="IsCurrentModuleTasksModule";_d.$E9.$39b=null;_d.$E9.$$cctor();_d.$Qm.$4h5=String.format("service.svc/s/GetFileAttachment?id={0}","");_d.$3T.$QH=[91];_d.$3w.$QH=[300,100,200,4100,4300,3900,4e3];_d.$Bu.$D=_a.$0.$6q;_d.$4r.$5JM="Members";_d.$4r.$5mp="Owners";_d.$4r.$3gc="IsGroupOwnersPivotSelected";_d.$4r.$3ga="IsGroupMembersPivotSelected";_d.$4r.$3gb="IsGroupNotesPivotSelected";_d.$Aa.$5BJ="IsLocationInformationPivotSelected";_d.$Aa.$5qw="ProfileFieldsForLocations";_d.$7F.$3kq="LinkingActionInProgress";_d.$7F.$64D="ErrorCode";_d.$Oe.$D=_a.$0.$1Hg;_d.$50.$551="HeaderTextViewModel";_d.$50.$54y="HeaderImageViewModel";_d.$50.$631="SingleComponent";_d.$50.$632="SingleComponentText";_d.$50.$D=_a.$0.$1Hg;_d.$Lm.$4Ep=-1;_d.$4J.$627="ShowOrganizationPanel";_d.$4J.$55P="HideManagerList";_d.$4J.$4sq="DirectReports";_d.$4J.$5ng="Peers";_d.$4J.$5I3="Manager";_d.$4J.$5I2="ManagementChain";_d.$4J.$5Ab="IsHierarchyAvailable";_d.$4J.$30y="OrganizationHierarchyLoadCompleted";_d.$4J.$55G="HideDirectReportsList";_d.$4J.$55M="HideManagementChainList";_d.$4J.$55T="HidePeersList";_d.$4J.$5Bz="IsOrganizationHierachyLoading";_d.$7H.$D=_a.$0.$6q;_d.$2F.$55K="HideFavoriteButton";_d.$2F.$55O="HideManageProfiles";_d.$2F.$3cf="HideModernGroupMembershipPivotContent";_d.$2F.$5Am="IsInformationPivotSelected";_d.$2F.$5Au="IsInlineExplorePivotSelected";_d.$2F.$5BZ="IsModernGroupMembershipPivotSelected";_d.$2F.$5Br="IsNotesPivotSelected";_d.$2F.$3jJ="IsTwoColumnWidth";_d.$2F.$5dF="ModernGroupMembershipPivotViewModel";_d.$2F.$3zZ="OrganizationHierarchyViewModel";_d.$2F.$D=_a.$0.$6q;_d.$2F.$2S5=-1;_d.$88.$5oF="Persona";_d.$88.$D=_a.$0.$6q;_d.$6S.$D=_a.$0.$6q;_d.$6S.$3fE=!1;_d.$6S.$1mk=!1;_d.$7b.$D=_a.$0.$cl;_d.$5I.$dF=_a.$0.$1d8