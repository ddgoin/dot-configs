Type.registerNamespace("_h");_h.$ti=function(n){this.$$d_$83X=Function.createDelegate(this,this.$83X);_h.$ti.initializeBase(this);this.$2lp=n;this.$4d=new _C(this.$$d_$83X,_a.$0.$Kf);this.set_$q(!0);this.set_$BG(this.$2lp.$v2);var t=this;this.$2lp.$Y("AppStatus",function(){t.set_$BG(t.$2lp.$v2)})};_h.$ti.prototype={$2lp:null,$Dn:null,$4d:null,$6g:!1,get_$BG:function(){return this.$Dn},set_$BG:function(n){if(n!==this.$Dn){this.$Dn=n;$3(this,"Status");_js.$9.$a(this.$Dn)?this.set_$q(!0):this.set_$q(!1)}return n},get_$q:function(){return this.$6g},set_$q:function(n){if(n!==this.$6g){this.$6g=n;$3(this,"IsHidden")}return n},get_$G1:function(){return this.$4d},$83X:function(){this.set_$q(!0)}};_h.$SN=function(){};_h.$SN.prototype={initialize:1,reachShowLimit:2,appCacheStatusChanges:3,removeALT1doneText:4,removeUpdatingPausedText:5,removeDisconnectedText:6,removeConnectingText:7,removeUpToDateText:8,connectionStatusChange:9,detectingConnectivityChange:10,syncingStatusEvent:11,postALT1SyncOrderChange:12};_h.$SN.registerEnum("_h.$SN",!1);_h.$hK=function(){};_h.$AH=function(n,t,i,r,u){this.$$d_$4Ii=Function.createDelegate(this,this.$4Ii);this.$$d_$81h=Function.createDelegate(this,this.$81h);this.$$d_$80F=Function.createDelegate(this,this.$80F);this.$$d_$80E=Function.createDelegate(this,this.$80E);this.$5y=_a.$0.$Kf;this.$1NP=new Sys.EventHandlerList;this.$Eh=t;this.$M=n;this.$4P=i;this.$TB=r;this.$1Ip=!1;this.$1a8=!1;this.$1bh=!1;this.$345=this.$TB.get_$Ws();this.$2Kr=_a.$7.$an.$5R();this.$1Ck=null;u&&($4rq(this,u.status)?this.$Eh.set_$1p4(!0):$4rr(this,u.status)&&this.$Eh.set_$1p4(!1));$74p(this);$4rs(this)};function $74p(n){_js.Trace.logInfo(n.$5y,"AppCacheStatusMonitor subscribe to events");n.$M.$IU(_h.$ms,n.$$d_$80E);n.$M.$IU(_h.$hd,n.$$d_$80F);n.$M.$IU(_a.$Nu,n.$$d_$81h);n.$M.$IU(_h.$hg,n.$$d_$4Ii)}function $2iJ(n){var t=n.$1NP.getHandler("StatusChanged");t&&t()}function $74m(n,t){n.$1NP.addHandler("StatusChanged",t)}function $74o(n,t){n.$1NP.removeHandler("StatusChanged",t)}function $74n(n){if(n.$TB.get_$Ws().$5R()-n.$345.$5R()>3e5){_js.Trace.logInfo(n.$5y,"AppCacheInstaller stopped");if(n.$1Ck){n.$4P.$4z(n.$1Ck);n.$1Ck=null}n.set_$5YJ(!0)}}function $4rq(n,t){return t===1||t===4}function $4rr(n,t){return t===5||!t}function $4rs(n){if(!n.$Eh.get_$1p4()&&!n.$1Ck){n.set_$5YJ(!1);var t=this;n.$1Ck=n.$4P.$oE(n.$5y,"installerStoppedDuringALT1Check",function(){$74n(n)},3e5)}}_h.$AH.prototype={$M:null,$Eh:null,$4P:null,$TB:null,$345:null,$1Ck:null,$1bh:!1,$1Ip:!1,$2Kr:0,$1a8:!1,add_$9rz:function(n){$74m(this,n)},remove_$9rz:function(n){$74o(this,n)},get_$6fp:function(){return this.$1Ip},set_$6fp:function(n){if(this.$1Ip!==n){this.$1Ip=n;$2iJ(this)}return n},get_$5ND:function(){return this.$1a8},set_$5ND:function(n){if(this.$1a8!==n){this.$1a8=n;$2iJ(this)}return n},get_$5YJ:function(){return this.$1bh},set_$5YJ:function(n){if(this.$1bh!==n){this.$1bh=n;$2iJ(this)}return n},get_$9pk:function(){var n=this.$TB.get_$Ws().$5R();_js.Trace.logInfo(this.$5y,String.format("Now = {0}, ResumeTime = {1}, pausedShowTime = {2}, ConnectingShowtime = {3}, InactiveTime = {4}, FirstVersionMismatchTime = {5}",n,this.$Eh.get_$2lk(),5e3,3e3,this.$Eh.get_$2lj(),this.$2Kr));return this.$Eh.get_$2lj()>this.$2Kr&&n<this.$Eh.get_$2lk()+5e3+3e3},$80E:function(n){_js.Trace.logInfo(this.$5y,String.format("Receiving AppCacheStatus={0}",_a.$td.toString(n.$Dn)));this.$345=this.$TB.get_$Ws();if($4rq(this,n.$Dn)){_js.Trace.logInfo(this.$5y,"AppCache finishes downloading");this.$Eh.set_$1p4(!0);this.$1a8=!0;this.$1Ip=!1;if(this.$1Ck){this.$4P.$4z(this.$1Ck);this.$1Ck=null}$2iJ(this)}else $4rr(this,n.$Dn)&&this.$Eh.set_$1p4(!1);$4rs(this)},$80F:function(n){_js.Trace.logInfo(this.$5y,"AppCache finishs the update");this.set_$6fp(!1);this.set_$5ND(!0)},$81h:function(n){if(!n.$VZ&&!this.$1Ip){this.$2Kr=this.$TB.get_$Ws().$5R();_js.Trace.logInfo(this.$5y,String.format("firstVersionMismatchTime={0}",this.$2Kr));this.set_$6fp(!0);this.set_$5ND(!1)}},$4Ii:function(n){_js.Trace.logInfo(this.$5y,"Reset lastStatusEventTime when app comes from background to foreground");this.$345=this.$TB.get_$Ws()}};_h.$6w=function(n,t,i,r,u,f,e,o){this.$$d_$82K=Function.createDelegate(this,this.$82K);this.$$d_$82F=Function.createDelegate(this,this.$82F);this.$$d_$4J9=Function.createDelegate(this,this.$4J9);this.$$d_$4Ii=Function.createDelegate(this,this.$4Ii);this.$5y=_a.$0.$Kf;_h.$6w.initializeBase(this);this.$19d=e;this.$Eh=i;this.$M=n;this.$13=t;this.$TB=u;this.$4P=r;this.$Be=f;var s=this;this.$Be.$Y("DetectingConnectivity",function(){$74s(s)});this.$44Z=_a.$7.$an.$5R();this.$2RX=_a.$7.$an.$5R();this.$3JY=null;this.$265=null;this.$2HK=null;this.$3Dw=!1;o&&(this.$1PO=o);$74t(this);$74v(this)};function $74v(n){n.$M.$IU(_h.$hg,n.$$d_$4Ii);n.$M.$IU(_a.$Su,n.$$d_$4J9);n.$M.$IU(_h.$S7,n.$$d_$82F);n.$M.$IU(_h.$hK,n.$$d_$82K);var t=this;n.$19d.add_$9rz(function(){$1JH(n,3)})}function $74u(n){$4rt(n);switch(n.$v2){case _u.Strings.l_AppStatus_ALT1Done_Text:n.$Eh.set_$2Mm(!0);$1nq(n,null,1e4,4);break;case _u.Strings.l_AppStatus_AppCachePaused_Text:$1nq(n,null,5e3,5);break;case _u.Strings.l_AppStatus_Disconnected_Text:$1nq(n,null,1e4,6);break;case _u.Strings.l_AppStatus_Connecting_Text:$1nq(n,null,3e3,7);break;case _u.Strings.l_AppStatus_MailSyncComplete_Text:n.$5gW=n.$1PO.get_$3yo();$1nq(n,null,3e3,8);break;default:break}}function $1nq(n,t,i,r){_js.Trace.logInfo(n.$5y,"Scheduling timer callback to {0} with delay {1}",_h.$SN.toString(r),i);$4rt(n);var u=this;n.$265=n.$4P.$1w(n.$5y,_h.$SN.toString(r),function(){n.$265=null;t&&t();$1JH(n,r)},i)}function $4rt(n){if(n.$265){_js.Trace.logInfo(_a.$0.$Kf,"Cancelling existing pending updater");n.$4P.$4z(n.$265);n.$265=null}}function $74t(n){if(n.$Eh.get_$56A())n.set_$Kf(_u.Strings.l_AppStatus_Connecting_Text);else{n.$Eh.set_$56A(!0);$1JH(n,1)}}function $1JH(n,t){_js.Trace.logInfo(n.$5y,"TryUpdateAppStatus {0}",_h.$SN.toString(t));if(!n.$Be.$1ZB)if(n.$Be.$Pf)if(n.$Eh.get_$1p4()&&n.$Eh.get_$18j()||n.$19d.$1a8)if(n.$19d.$1Ip){_js.Trace.logInfo(n.$5y,"VersionMismatchReported");n.$19d.get_$9pk()?n.set_$Kf(_u.Strings.l_AppStatus_AppCachePaused_Text):n.set_$Kf(_u.Strings.l_AppStatus_AppCacheDownloading_Text)}else if(n.$Eh.get_$2Mm()||!n.get_$4W7()){_js.Trace.logInfo(n.$5y,"Check syncing status");n.$1PO&&n.$1PO.$2fr?n.$1PO.$1Ok?n.set_$Kf(_u.Strings.l_AppStatus_MailSyncing_Text):n.$TB.get_$Ws().$5R()-n.$1PO.get_$3yo()<3e3?n.$v2===_u.Strings.l_AppStatus_MailSyncComplete_Text?n.$5gW!==n.$1PO.get_$3yo()&&$1nq(n,null,3e3,8):n.set_$Kf(_u.Strings.l_AppStatus_MailSyncComplete_Text):n.set_$Kf(""):n.set_$Kf("")}else n.set_$Kf(_u.Strings.l_AppStatus_ALT1Done_Text);else{_js.Trace.logInfo(n.$5y,"ALT1");n.get_$4W7()&&(n.$19d.$1bh?n.set_$Kf(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$Kf(_u.Strings.l_AppStatus_ALT1_Text))}else{var i=n.$TB.get_$Ws().$5R();_js.Trace.logInfo(n.$5y,"App disconnected, now={0},lostconnectionTimeMS={1}",i,n.$2RX);if(i-n.$2RX<1e4||n.$v2===_u.Strings.l_AppStatus_Connecting_Text)n.set_$Kf(_u.Strings.l_AppStatus_Disconnected_Text);else{_js.Trace.logInfo(n.$5y,"InstallerStoppedDuringALT1={0}",n.$19d.$1bh);n.get_$4W7()&&n.$19d.$1bh&&!n.$19d.$1a8?n.set_$Kf(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$Kf("")}}}function $74s(n){_js.Trace.logInfo(_a.$0.$Kf,"HandleConnectionManagerChanges");if(!n.$Be.$1ZB){if(n.$3Dw){n.$Be.$Pf||$4ru(n,10);n.$3Dw=!1}$1JH(n,10)}}function $4ru(n,t){if(n.$v2!==_u.Strings.l_AppStatus_Disconnected_Text){n.$2RX=n.$TB.get_$Ws().$5R();_js.Trace.logInfo(_a.$0.$Kf,"{0} Set lostConnectionTimeMS = {1}",_h.$SN.toString(t),n.$2RX)}}_h.$6w.prototype={$Eh:null,$M:null,$4P:null,$TB:null,$13:null,$Be:null,$v2:null,$44Z:0,$2RX:0,$3Dw:!1,$3JY:null,$265:null,$2HK:null,$19d:null,$1PO:null,$5gW:0,get_$Kf:function(){return this.$v2},set_$Kf:function(n){if(n!==this.$v2){var t;t=this.$v2===""?0:this.$44Z+3e3-this.$TB.get_$Ws().$5R();if(t<=0){this.$v2=n;this.$44Z=this.$TB.get_$Ws().$5R();_js.Trace.logInfo(this.$5y,"Rasing AppStatusEvent Status = {0}",this.$v2);$74u(this);$N(this,"AppStatus")}else if(!this.$3JY){_js.Trace.logInfo(this.$5y,"Can't set status to {0} within the limit, scheduling a timer callback to update the status with delay = {1}",n,t);var i=this;this.$3JY=this.$4P.$1w(this.$5y,"UpdateAppStatus",function(){i.$3JY=null;$1JH(i,2)},t)}}return n},get_$4W7:function(){return this.$13.get_$3Ev()},$4J9:function(n){_js.Trace.logInfo(_a.$0.$Kf,"OnConnectionStatusChanged");if(this.$2HK){_js.Trace.logInfo(_a.$0.$Kf,"Cancel connectionStatusDelayer");this.$4P.$4z(this.$2HK)}var t=this;this.$2HK=this.$4P.$1w(this.$5y,"ConnectionStatusDelayer",function(){t.$2HK=null;if(t.$Be.$1ZB){_js.Trace.logInfo(_a.$0.$Kf,"Don't change the app status since it's still detecting the connectivity");t.$3Dw=!0}else{t.$Be.$Pf||$4ru(t,9);$1JH(t,9)}},3e3)},$4Ii:function(n){_js.Trace.logInfo(this.$5y,"OnAppResume");this.set_$Kf(_u.Strings.l_AppStatus_Connecting_Text)},$82F:function(n){if(_h.$4N.isInstanceOfType(n.$2D)){this.$1PO=n.$2D;$1JH(this,11)}},$82K:function(n){$1JH(this,12)}};_h.$JW=function(n,t,i){_h.$JW.resolveInheritance();this.dispose=this.$1Q;_h.$JW.initializeBase(this,[n,t,i,[10]])};function $2iK(n){n.set_$1Ol(n.$Be.$Pf&&n.$2QB)}_h.$JW.prototype={$2QB:!1,$81S:function(n){this.$2QB=!0;$2iK(this)},$81R:function(n){this.$2QB=!1;$2iK(this)},$82E:function(n){if(this.$2QB){_js.Trace.logWarning(_h.$JW.$A,"Failed to get module finish event for calendar module and received sync complete event. This may indicate a problem in the sync framework.");this.$2QB=!1;$2iK(this)}},$80a:function(){$2iK(this)}};_h.$4N=function(n,t,i,r,u,f,e,o){this.$$d_$80D=Function.createDelegate(this,this.$80D);this.$$d_$9DW=Function.createDelegate(this,this.$9DW);this.$$d_$80i=Function.createDelegate(this,this.$80i);this.$$d_$3vU=Function.createDelegate(this,this.$3vU);_h.$4N.resolveInheritance();this.dispose=this.$1Q;_h.$4N.initializeBase(this,[i,u,e,[4,11,5,12]]);_a.$4.$J(n,"userConfiguration");_a.$4.$J(t,"folderMappings");_a.$4.$J(r,"clientStore");_a.$4.$J(f,"syncFolderSettingProcessor");this.$c=n;this.$1i=t;this.$7F=r;this.$E9=f;this.$uV=o;this.$on=_a.$3n.$$(Number).$8A();this.$3rm=_a.$3n.$$(Number).$8A();$75a(this);$75b(this);this.set_$6fv(this.$uV.get_$2E5()===_h.$4N.$46M);$1nr(this)};function $75Y(n,t,i){_a.$4.$J(t,"unsentInfo");_a.$4.$J(i,"updateInfo");var r;r=t.length>0?i.length>0?String.format("{0}{1}{2}",t,_u.Strings.l_OfflineActivityInfoSeperator_Text,i):t:i;return r}function $4sD(n){_js.Trace.logInfo(_h.$4N.$A,"UpdateModuleFinishStatus");n.$3rm.set_$3q(n.$2eF,_a.$7.get_utcNow().$5R());n.$a7.Id===n.$2eF&&n.set_$2O9(!1);n.$2eF=""}function $75a(n){var t=n.$1i.nameToId("inbox");n.set_$13x(t)}function $75b(n){$4sE(n);n.$M.$IU(_h.$Mj,n.$$d_$3vU);n.$M.$IU(_h.$ib,n.$$d_$80i);n.$M.$IU(_a.$ai,n.$$d_$9DW);n.$uV.add_$53J(n.$$d_$80D)}function $1nr(n){_js.Trace.logInfo(_h.$4N.$A,"UpdateMailActivityInfo: Connected:{0}",n.$Be.$Pf);if(n.$Be.$Pf&&n.$2O8&&n.$2fr){n.set_$469("");n.set_$1Ol(!0);return}n.set_$1Ol(!1);$75c(n);if(n.$Be.$Pf)n.set_$469($4sC(n));else{var t=this;$75Z(n,function(t){n.$Be.$Pf||n.set_$469($75Y(n,$4sC(n),t))})}}function $75c(n){n.set_$7VH(!n.$Be.$Pf&&n.$1hq>0)}function $4sC(n){return n.$1hq>0?String.format(_u.Strings.l_UnsentInfo_Text,n.$1hq):""}function $75Z(n,t){var i="";var u=n.$c.get_$5M().$Zq(n.$a7);var r=-1;u.$BV===1?r=4:(u.$BV===2||u.$BV===3)&&(r=5);if(!n.$E9.$8A4(r,n.$a7.Id)){t(i);return}if(n.$7F.get_$fZ()){var f=this;n.$4K.$7ur(r,new _bc.$Hz(n.$a7),function(r){i=$75X(n,r);t(i)})}else{_js.Trace.logError(_h.$4N.$A,"ClientStore should be available when we try to GetLastUpdateInfo");t(i)}}function $4sE(n){_js.Trace.logInfo(_h.$4N.$A,"Update outbox total count");if(n.$7F.get_$fZ()){var t=n.$1i.nameToId("outbox");if(!t){_js.Trace.logError(_h.$4N.$A,"There is no FolderId for outbox");return}var i=new _e.$bj(n.$7F,n.$c.get_$1I().get_$DM());var r=this,u=this,f=this;i.$BT(new _a.$6j("MailOfflineActivityIndicator.UpdateOutboxTotalCount"),function(r){i.$7tu(r,t,function(t,i){n.set_$4Lp(t)})},function(){},function(n){_js.Trace.logWarning(_h.$4N.$A,"Failed to get outbox total count due to error:",n.$3v)})}else _js.Trace.logError(_h.$4N.$A,"ClientStore is not available when we try to UpdateOutboxTotalCount")}function $75X(n,t){if(!$6(t)){var i=_a.$7.$42(t);var r;r=i.$93(_a.$7.get_$29())?1:0;return $75W(n,i,r)}return""}function $75W(n,t,i){return String.format(_u.Strings.l_UpdatedOn_Text,t.$2Z(i))}_h.$4N.prototype={$7F:null,$c:null,$1i:null,$E9:null,$on:null,$3rm:null,$2O8:!1,$1hq:0,$2Rh:null,$a7:null,$2oE:!1,$uV:null,$2fr:!1,$2eF:null,$2qM:!1,get_$6fv:function(){return this.$2fr},set_$6fv:function(n){if(this.$2fr!==n){this.$2fr=n;$1nr(this)}return n},get_$469:function(){return this.$2Rh},set_$469:function(n){if(n!==this.$2Rh){this.$2Rh=n;_js.Trace.logInfo(_h.$4N.$A,"MailActivityInfo changes to {0}, Connected = {1}",this.$2Rh,this.$Be.$Pf);this.$M.$9Yf(_h.$qj,new _h.$qj(this,this.$2Rh))}return n},get_$4Lp:function(){return this.$1hq},set_$4Lp:function(n){if(this.$1hq!==n){this.$1hq=n;$1nr(this)}return n},get_$7VH:function(){return this.$2oE},set_$7VH:function(n){if(n!==this.$2oE){this.$2oE=n;this.$M.$9Yf(_h.$oc,new _h.$oc(this.$2oE))}return n},get_$13x:function(){return this.$a7},set_$13x:function(n){if(this.$a7!==n){this.$a7=n;this.set_$2O9(this.$on.$Mj(this.$a7.Id));$1nr(this)}return n},get_$2O9:function(){return this.$2O8},set_$2O9:function(n){if(this.$2O8!==n){this.$2O8=n;$1nr(this)}return n},get_$3yo:function(){return this.$3rm.get_$3q(this.$a7.Id)},$4c:function(){this.$M.$18g(_h.$Mj,this.$$d_$3vU);this.$M.$18g(_h.$ib,this.$$d_$80i);this.$M.$18g(_a.$ai,this.$$d_$9DW);this.$uV.remove_$53J(this.$$d_$80D);_h.$RP.prototype.$4c.call(this)},$81S:function(n){if($6(n.$wO)||!n.$wO.length)_js.Trace.logWarning(_h.$4N.$A,"FoldersToSync is empty, moduleName:{0} for enqueued event",n.$H5);else{_js.Trace.logInfo(_h.$4N.$A,"FoldersToSync: {0}, event:{1}",n.$wO.toString(),_a.$GM.toString(n.$Mq));Array.contains(n.$wO,this.$a7.Id)&&this.set_$2O9(!0);for(var r=n.$wO,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$on.$Mj(t)){var u;this.$on.set_$3q(t,(u=this.$on).set_$3q(t,u.get_$3q(t)+1))}else this.$on.set_$3q(t,1)}}},$81R:function(n){if($6(n.$wO)||!n.$wO.length)_js.Trace.logWarning(_h.$4N.$A,"FoldersToSync is empty, moduleName:{0} event:{1}",n.$H5,_a.$GM.toString(n.$Mq));else{_js.Trace.logInfo(_h.$4N.$A,"FoldersToSync: {0}, event:{1}",n.$wO.toString(),_a.$GM.toString(n.$Mq));if(Array.contains(n.$wO,this.$a7.Id)&&this.$2O8)if(n.$Mq===3){this.$2eF=this.$a7.Id;this.$2qM||$4sD(this)}else this.set_$2O9(!1);for(var r=n.$wO,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$on.$Mj(t)){var u=this.$on.get_$3q(t);u>1?this.$on.set_$3q(t,--u):this.$on.$34(t)}else _js.Trace.logWarning(_h.$4N.$A,"We can't find folder {0} in the syncingFoldersMap, moduleName:{1} event:{2}",t,n.$H5,_a.$GM.toString(n.$Mq))}}},$82E:function(n){if(this.$on.$A3p()>0){var t=new Sys.StringBuilder;var i=this;this.$on.$A3q(function(n,i){t.append(String.format("Key:{0},Value:{1};",n,i))});_js.Trace.logWarning(_h.$4N.$A,"syncingFoldersMap = {0} when sync session completes",t.toString());this.set_$2O9(!1);this.$on=_a.$3n.$$(Number).$8A()}},$80a:function(){$1nr(this)},$80i:function(n){this.$2qM=n.$Sr;_js.Trace.logInfo(_h.$4N.$A,"CurrentMailListTableLoading = {0}",this.$2qM);this.$2qM||_js.$9.$a(this.$2eF)||$4sD(this)},$80D:function(){this.set_$6fv(this.$uV.get_$2E5()===_h.$4N.$46M)},$3vU:function(n){var t=n.$2G;t&&t.get_$r()&&this.set_$13x(t.get_$r())},$9DW:function(n){n.$1Lv===5&&$4sE(this)}};_h.$2o=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$81e=Function.createDelegate(this,this.$81e);this.$$d_$81M=Function.createDelegate(this,this.$81M);this.$$d_$81f=Function.createDelegate(this,this.$81f);this.$$d_$80y=Function.createDelegate(this,this.$80y);this.$$d_$80z=Function.createDelegate(this,this.$80z);this.$$d_$87f=Function.createDelegate(this,this.$87f);this.$$d_$80s=Function.createDelegate(this,this.$80s);this.$$d_$80w=Function.createDelegate(this,this.$80w);this.$$d_$69K=Function.createDelegate(this,this.$69K);this.$5p=new Sys.EventHandlerList;_h.$2o.resolveInheritance();this.dispose=this.$1Q;_h.$2o.initializeBase(this);_a.$4.$l(f,"nativeBridge");this.$z5=n;this.$6p=u;this.set_$5a(t);this.$13=i;this.$M=r;this.$12=f;this.$1IA=o;this.$67Q=s;this.$E9=e;this.$1J=h;this.$xl=c;this.$Us=l;$75x(this)};function $75m(n){return n.$12.$3E.$Co?new _g.$rC(n.$12,n.$1J,n.$xl,n.$Us):new _g.$eP(n.$1J,n.$xl,n.$Us)}function $4sM(n,t,i){_a.$4.$J(t,"successCallback");_a.$4.$J(i,"failureCallback");if(n.$13.get_$3Ev()){_js.Trace.logInfo(_h.$2o.$1p,"Removing client store and associated local storage.");var r=this,u=this;n.$7F.$6d6(function(){n.$6p.$3KU();n.$z5.$1r();_js.Trace.logInfo(_h.$2o.$1p,"Client store successfully removed.");t()},function(n){_js.Trace.logError(_h.$2o.$1p,"We failed to uninstall client store due to error: "+n.message);i(n)})}else{_js.Trace.logWarning(_h.$2o.$1p,"Remove client store called, but offline is not supported by this user agent");t()}}function $4sL(n,t,i){if(_e.$68.isInstanceOfType(t)){var r=t;r.$3nQ()}n.$z5.$1r();if(i){var u=n.$5PW(i);u.$AF("DeprovisionAndReload")}}function $75q(n){_js.Trace.logInfo(_h.$2o.$1p,"Initializing UI Dependent Offline Components");var t=this;n.$E9.$E(function(t){_js.Trace.logInfo(_h.$2o.$1p,"sync folder setting cache has been initialized");n.$4Z8=new _h.$19w(_g.$h.$1i);n.$z5.$9UG(n.$7F,window.owaSD);n.$1dz=new _h.$4N(_g.$V.get_$I(),_g.$h.$1i,n.$M,n.$7F,n.get_$DK(),t,n.$Be,n.get_$DK().get_$9xm());n.$2G2=new _h.$JW(n.$M,n.get_$DK(),n.$Be);n.$6a8&&n.get_$DK().$y();n.$M.$A4x(_h.$eN,new _h.$eN)})}function $4sN(n){if(n.$5O4&&n.$1br){var t=this;n.$E9.$E(function(n){n.$6Tf(_h.$j.$cN("msgfolderroot"))})}}function $75u(n,t){n.$Be=t.$Be;$4sN(n)}function $75x(n){n.$M.$IU(_h.$oU,n.$$d_$80s);n.$M.$IU(_a.$Nu,n.$$d_$87f);n.$M.$IU(_h.$WU,n.$$d_$80z);n.$M.$IU(_h.$bl,n.$$d_$80y);n.$M.$IU(_a.$Dr,n.$$d_$81f)}function $75y(n){n.$M.$18g(_a.$Nu,n.$$d_$87f);n.$M.$18g(_h.$WU,n.$$d_$80z);n.$M.$18g(_h.$bl,n.$$d_$80y);n.$M.$18g(_a.$Dr,n.$$d_$81f)}function $75n(n,t,i,r,u,f){var e="sync";n.$6a8=$6(r)||$6(r.get_$3q(e))||r.get_$3q(e).toString()==="true";n.$1IA.get_$1g().$E(t,i,_a.$10.get_$7Z(),u,OwaApplication.$2Ix,f)}function $75r(n,t,i,r,u,f,e){var o=this,s=this;$75t(n,t,function(o){var s=new _g.$V(o);$75v(n,t,u,function(t){$75l(n,t,i,r,s,function(n){n.$HL.set_$1qW(OwaApplication.$2Ix);f(n,s)},function(t){_js.Trace.logError(_h.$2o.$1p,"CreateOfflineMailboxDataContextFromClientStore Failed: {0}",t.$3v);n.$7F.$c1();e(new _e.$1f(t).$SQ())})},function(t){_js.Trace.logError(_h.$2o.$1p,"Failed to provision the offline client: {0}",t.message);n.$7F.$c1();e(t)})},function(t){_js.Trace.logError(_h.$2o.$1p,"Failed to load OWA user configuration: {0}",t.message);n.$7F.$c1();e(t)})}function $75v(n,t,i,r,u){var f=new _g.$f1(n.$7F.get_$84b(),"DeviceType","1.0");f.HasPAL=n.$13.get_$67();if(n.$13.get_$67()){if(n.$12.get_device().$Co){f.DeviceModel=n.$12.get_device().get_$8T().get_$2J6();f.DeviceFriendlyName=n.$12.get_device().get_$8T().get_$7ia();if(n.$12.get_device().get_$8T().get_$1ZC()===1){f.DeviceOS="iOS "+n.$12.$3E.get_$7w().get_$1hl();f.DeviceType="iPhone"}else if(n.$12.get_device().get_$8T().get_$1ZC()===2){f.DeviceOS="iOS "+n.$12.$3E.get_$7w().get_$1hl();f.DeviceType="iPad"}else if(n.$12.get_device().get_$8T().get_$1ZC()===3){f.DeviceOS="Android "+n.$12.$3E.get_$7w().get_$1hl();f.DeviceType="Android"}else if(n.$12.get_device().get_$8T().get_$1ZC()===4){f.DeviceOS="Windows "+n.$12.$3E.get_$7w().get_$1hl();f.DeviceType="Windows 8"}}f.ClientVersion=n.$12.$3E.get_$7w().get_$39();f.DeviceOSLanguage=n.$12.$3E.get_$7w().get_$8F9()}var e=_e.$AB.$2L8(n.$7F);var o=this;e.$7wm(function(o){if(o){_js.Trace.logInfo(_h.$2o.$1p,"Client is already provisioned.");r(f)}else if(f.HasPAL||i){_js.Trace.logInfo(_h.$2o.$1p,"Provisioning the client with the server...");var h=t?t.get_$3U2():new _g.$3d(function(){},n.$1J,n.$xl,n.$Us);var s=new _g.$Jo("Exchange2013");s.TimeZoneContext=new _g.$LJ;s.TimeZoneContext.TimeZoneDefinition=new _g.$JG;s.TimeZoneContext.TimeZoneDefinition.Id="UTC";n.$13.get_$67()&&n.$6p.$3KU();h.$6LB(new _g.$ez(s,f),null,function(t,i){if("Success"===i.Body.ResponseMessages.Items[0].ResponseClass){_js.Trace.logInfo(_h.$2o.$1p,"...server call succeeded, saving results to the database...");e.$9kO(!0,function(){_js.Trace.logInfo(_h.$2o.$1p,"Provisioning completed.");r(f)},u)}else if("Error"===i.Body.ResponseMessages.Items[0].ResponseClass&&"ErrorMaximumDevicesReached"===i.Body.ResponseMessages.Items[0].ResponseCode){_js.Trace.logError(_h.$2o.$1p,"Maximum number of allowed partnerships already created.");var o=new _a.$4a([_u.Strings.l_ProvisionFailedDueToMaxDevices_Text],0,n.$$d_$81M,0,!1,_u.Strings.l_Close_Text,"",_u.Strings.l_ProvisionFailedDueToMaxDevices_Title_Text);n.$M.$9Yf(_a.$4a,o)}else{_js.Trace.logError(_h.$2o.$1p,"Provisioning call returned a response error.");var s=Error.create(i.Body.ResponseMessages.Items[0].MessageText);u(s)}},u)}else{_js.Trace.logWarning(_h.$2o.$1p,"The client is not provisioned, and we should not provision it automatically.  Removing the 'offline enabled' flag and reloading.");n.$2a4(t,window.location)}},u)}function $75t(n,t,i,r){if(_g.$V.get_$I().$5aW){var u=_e.$AB.$2L8(n.$7F);var f=this;u.$qg(function(u){if(u){_js.Trace.logInfo(_h.$2o.$1p,"Found OWA user configuration in client store.");i(u)}else{_js.Trace.logInfo(_h.$2o.$1p,"Getting OWA user configuration from the server...");var f=t?t.get_$3U2():new _g.$3d(function(){},n.$1J,n.$xl,n.$Us);f.$qg(null,function(n,t){_js.Trace.logInfo(_h.$2o.$1p,"...server call succeeded");i(t)},r)}},_e.$1f.$5EE(r))}else{_js.Trace.logInfo(_h.$2o.$1p,"OWA user configuration has already been loaded.");i(_g.$V.get_$I().get_$9j())}}function $75l(n,t,i,r,u,f,e){var h=_e.$AB.$2L8(n.$7F);var o=new _e.$6E(n.$7F);var s=null;_js.Trace.logInfo(_h.$2o.$1p,"Creating OfflineMailboxDataContext from client store database.");var c=this,l=this;n.$7F.get_$127().$BT(new _a.$6j("OfflineManager.CreateOfflineMailboxDataContextFromClientStore"),function(t){$75s(n,t,h,o,function(n){s=n});o.$85O(t)},function(){_js.Trace.logInfo(_h.$2o.$1p,"CreateOfflineMailboxDataContextFromClientStore transaction succeeded.");n.$1IA.$E(function(e){var h=new _e.$68(n.$7F,u.get_$1I().get_$DM(),i,r,new _g.$AA(n.$M),n.$M,o,t.HasPAL,t.DeviceID,t.DeviceType,s,u.get_$31(),e);h.$8Ga(function(){h.set_$7nC(function(){return OwaApplication.$2Ix});h.$9rk(_js.$J.get_$I());f(h)})})},e)}function $75s(n,t,i,r,u){_js.Trace.logInfo(_h.$2o.$1p,"Checking if action queue is empty.");var f=this;r.$89X(t,function(n){if(n){_js.Trace.logInfo(_h.$2o.$1p,"Action queue is empty therefore we're removing the IdentityCorrelationTable setting.");i.$7WO(t,function(){_js.Trace.logInfo(_h.$2o.$1p,"IdentityCorrelationTable setting reset.");u(null)})}else{_js.Trace.logInfo(_h.$2o.$1p,"Action queue is not empty therefore we're loading the IdentityCorrelationTable setting.");i.$7uO(t,function(n){n?_js.Trace.logInfo(_h.$2o.$1p,"IdentityCorrelationTable setting loaded with {0} items.",n.map.count):_js.Trace.logInfo(_h.$2o.$1p,"IdentityCorrelationTable setting loaded but had no value.");u(n)})}})}function $75p(n,t,i){t=t||"";i=i||"";var r=t.split("@")[0];var u=i.split("@")[0];return r===u}function $75w(n,t){n.$43Z=!0;n.$6p.set_$1y6(!0);var i=this;t.$oE(_a.$0.$EM,"StartOfflineSessionInUseThread",function(){if(n.$1br&&!n.$AV){n.get_$DK()&&n.get_$DK().get_$1Ol()&&n.$6p.get_$9v4()>1e4&&_a.$g.$8r("Core.Models.Sync.SuspendedDuringSync");n.$6p.set_$1y6(!0)}},5e3)}function $75o(n,t){if(n.$12.get_device().$Co&&n.$12.get_device().get_$8T().get_$55j()){_js.Trace.logInfo(_h.$2o.$1p,"the native bridge device state indicates the application was reset.  the offline manager will clear all offline data.");var i=this,r=this;$4sM(n,function(){t()},function(t){n.$12.$3E.$2oT(0,"Unable to remove the client store. "+t.message)})}else t()}_h.$2o.prototype={$z5:null,$13:null,$M:null,$12:null,$E9:null,$1IA:null,$67Q:null,$1J:null,$xl:null,$Us:null,$7F:null,$Be:null,$1br:!1,$6p:null,$5O4:!1,$5Z6:!1,$1dz:null,$2G2:null,$4Z8:null,$6a8:!1,$43Z:!1,$8F7:null,get_$5a:function(){return this.$7F},set_$5a:function(n){this.$7F&&this.$7F.remove_$2zw(this.$$d_$69K);this.$7F=n;if(this.$7F){this.$69K(!1);this.$7F.add_$2zw(this.$$d_$69K)}else this.set_$a9(!1);return n},get_$2nF:function(){return this.$2G2},set_$2nF:function(n){this.$2G2=n;return n},get_$4Z9:function(){return this.$4Z8},set_$4Z9:function(n){this.$4Z8=n;return n},get_$a9:function(){return this.$1br},set_$a9:function(n){if(n!==this.$1br){this.$1br=n;var t=this.$5p.getHandler("IsClientStoreInstalled");t&&t()}return n},get_$A1r:function(){return this.$6p},set_$A1r:function(n){this.$6p=n;return n},get_$4Lp:function(){return this.$1dz?this.$1dz.$1hq:0},get_$4WY:function(){return this.$6p.get_$Lx()&&this.$1br&&this.$6p.get_$6WW()?!this.$Be.$Pf:!1},get_$1y7:function(){return this.$43Z},get_$DK:function(){var n=null;this.$1IA.get_$5f3()&&(n=this.$1IA.get_$1g().$ic());return n},$3xw:function(n,t,i,r,u,f,e){var s=this.$6p.get_$1y6();var h=this.$6p.get_$Lx();if(h&&!s){_js.Trace.logInfo(_a.$0.$HN,"Initializing offline mailbox data context");var c=this,o=this;this.$4OV(null,t,!1,i,r,e,function(t){_js.Trace.logInfo(_a.$0.$HN,"Prepare offline component completed successfully");n(t)},function(t){_js.Trace.logError(_a.$0.$HN,"Offline Initialization failed - reverting to KIOSK mode. {0}",t.message);o.$8F7=String.format("OfflineInit failed:{0}",t.message);var i=new _g.$1U(null,u,f,new _g.$AA(o.$M),o.$M);i.$Be.set_$2W8(!0);n(i)})}else throw Error.invalidOperation();},$4OV:function(n,t,i,r,u,f,e,o){_a.$4.$J(e,"onOfflineReady");var s=this,h=this;this.$87L(n,t,i,u,f,function(n){$.cookie("X-Offline","1",{path:"/"});$75w(s,r);s.$z5.$4YS(s.$M,s.get_$DK(),s.$12,n.$HL);e(n)},function(n){h.$12.$3E.$Co&&h.$12.$3E.$2oT(1,n.message||"prepare offline component failed with an unknown error");o(n)})},$4QW:function(n,t){this.$M.$9Yf(_a.$RQ,new _a.$RQ(!1));this.$2a4(n,t)},$2a4:function(n,t){$.cookie("X-Offline",null,{path:"/"});this.$6p.$6dM();$4sL(this,n,t)},$9ad:function(n,t){_a.$4.$J(n,"successCallback");_a.$4.$J(t,"failureCallback");this.$6p.get_$4Vv()?$4sM(this,n,t):n()},$4c:function(){$75y(this);this.$43Z&&this.$6p.set_$1y6(!1);this.$1dz&&this.$1dz.$1Q();this.$2G2&&this.$2G2.dispose();if(this.$1IA.get_$5f3()&&this.get_$DK()){this.$M.$18g(_a.$j6,this.$$d_$80w);this.get_$DK().dispose()}},$5PW:function(n){return new _a.$SV(n,this.$12.$3E)},$87L:function(n,t,i,r,u,f,e){var o=this;$75o(this,function(){o.$7F.$3yS(function(){$75r(o,n,$75m(o),new _g.$o4,i,function(n,e){o.$7F.$9sW(n.$7e,o.$M);var s=t?t.get_$3q("connected"):null;if("false"===s){n.$Be.set_$1YG(!1);n.$Be.set_$2W8(!1)}else n.$Be.set_$2W8(!0);$75u(o,n);o.$67Q.$E(function(s){var h=s.$E(new _a.$10w,OwaApplication.get_$1gp(),OwaApplication.get_$Rb(),t);OwaApplication.get_$Rb().set_$Um(h);o.$1IA.$E(function(s){$75n(o,n,h,t,r,u);o.$M.$IU(_a.$j6,o.$$d_$80w);i&&o.$6p.$9lC(e.get_$31().get_$Aj(),e.get_$31().get_$FS());f(n)})})},function(n){_js.Trace.logWarning(_h.$2o.$1p,"Failed to initialize the offline mailbox data context - disposing the client store. {0}",n);o.$7F.$c1();e(n)})},e)})},$80s:function(n){var t;if(this.$13.get_$67()){var r=this;t=new _a.$4a([_u.Strings.l_PALFatalQuotaError_Text],0,function(n,t){},0,!1,null,null,null)}else{this.$6p.$6dM();this.$M.$9Yf(_a.$RQ,new _a.$RQ(!1));var i=this;t=new _a.$4a([_u.Strings.l_BrowserFatalQuotaError1_Text,_u.Strings.l_BrowserFatalQuotaError2_Text],0,function(n,t){n&&$4sL(i,_g.$1U.$v,window.location)},0,!1,_u.Strings.l_Refresh_StartWithUpperCase_Text,null,null)}this.$M.$9Yf(_a.$4a,t)},$81f:function(n){_js.Trace.logInfo(_h.$2o.$1p,"Handling OwaApplicationStartedEvent");this.$6p.$7is(_g.$V.get_$I().get_$Ot().AllowOfflineOn)&&this.$2a4(_g.$1U.$v,window.location)},$80w:function(n){_js.Trace.logInfo(_h.$2o.$1p,"Handling FolderMappingsLoadedEvent");$75q(this)},$80z:function(n){if(this.$1br){if(!this.$1dz){_js.Trace.logInfo(_h.$2o.$1p,"SyncFolderEvent can only be processed after MailActivityIndicator initialization");return}this.get_$DK().$6Yp(n.$2G.get_$r().Id)}},$80y:function(n){this.$5O4=!0;$4sN(this)},$69K:function(n){this.$6p.get_$4Vv()?this.set_$a9(!1):this.set_$a9(this.$7F.get_$fZ());n&&this.$6p.$4Rx()},$87f:function(n){if(n.$VZ===1)if(this.$5Z6)_js.Trace.logInfo(_h.$2o.$1p,"ignoring invalid device id error because it has already been handled.");else{this.$5Z6=!0;if(this.$12.$3E.$Co)this.$12.$3E.$2oT(0,"The mowa device id is not longer valid.  It may have been removed via ECP.");else if($75p(this,n.$3TE,this.$6p.get_$4IP())){_js.Trace.logWarning(_h.$2o.$1p,"The user {0} does not have a valid device id.  Removing store and restarting.",this.$6p.get_$4IP());this.$2a4(_g.$1U.$v,window.location)}else{_js.Trace.logWarning(_h.$2o.$1p,"The user {0} is not the same as the offline enabled user {1}.",n.$3TE,this.$6p.get_$4IP());var t=new _a.$4a([String.format(_u.Strings.l_OfflineUserOtherUserMessage_Text,this.$6p.get_$995())],1,this.$$d_$81e,3,!1,_u.Strings.l_OfflineUserOtherUserMessage_SignIn_Text,_u.Strings.l_OfflineUserOtherUserMessage_Cancel_Text,null);this.$M.$9Yf(_a.$4a,t)}}},$81e:function(n,t){n?this.$2a4(_g.$1U.$v,window.location):this.$M.$9Yf(_a.$MY,new _a.$MY(!1))},$81M:function(n,t){var i=new _g.$ag(5);this.$M.$9Yf(_g.$ag,i)}};_h.$Nv=function(n){this.$Yr=_a.$3n.$$(Object).$8A();this.$2cl=n};function $760(n,t,i,r){var u=[new _h.$Nv.$7w7];var f=new _h.$Nv.$7o4(t,r,n.$2cl);var e=new _h.$Nv.$7oA(t,r,n.$2cl);Array.add(u,f);Array.add(u,e);if(i!=="TouchNarrow"){Array.add(u,new _h.$Nv.$7sZ(f));Array.add(u,new _h.$Nv.$7vA(e))}return u}function $4sP(n,t,i,r){if(i===t.length)r();else{var u=this;$761(n,t[i],function(){$4sP(n,t,i+1,r)})}}function $761(n,t,i){_js.Trace.logInfo(_a.$0.$J5,"Executing page data payload action for '"+t.get_$4M3()+"' variable");var r=this;t.$n(function(t){_js.Trace.logInfo(_a.$0.$J5,"Saving result to page data payload variable '"+t.get_$4M3()+"'");n.$Yr.set_$3q(_bc.$kf.toString(t.get_$4M3()),t.get_$gq());i()})}_h.$Nv.prototype={$2cl:!1,$y:function(n,t,i,r){_js.Trace.logInfo(_a.$0.$J5,"Start generatint the page data payload for layout '{0}' with '{1}' rows to load...",t,i);var u=$760(this,n,t,i);$4sP(this,u,0,r)},$1NA:function(n){return this.$Yr.get_$3q(_bc.$kf.toString(n))}};_h.$Nv.$7w9=function(n){this.$6GW=n};_h.$Nv.$7w9.prototype={$6GW:0,$17L:null,get_$4M3:function(){return this.$6GW},get_$gq:function(){return this.$17L},set_$gq:function(n){this.$17L=n;return n},$n:function(n){var t;var i,r;if(r=this.$9x2(i={val:t}),t=i.val,r){var u=this;t.add_$2C(function(t){u.$9kW(t);n(u)});var f=this;t.add_$1x(function(t){_js.Trace.logWarning(_a.$0.$J5,"Action '"+t.$1Wv+"' failed. Clearing page data payload and moving on.");f.set_$gq(null);n(f)});OwaApplication.$1W.$z(t)}else{this.set_$gq(null);n(this)}}};_h.$Nv.$2fH=function(n){_h.$Nv.$2fH.$$(this.$$gta["_h.$Nv.$2fH"].TResult).initializeBase(this,[n])};_h.$Nv.$2fH.$$=function(n){var t="$2fH"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$Nv[t]){var r=_h.$Nv[t]=function(){(this.$$gta=this.$$gta||{})["_h.$Nv.$2fH"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$Nv.$2fH.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$Nv.$7w9);var u=_h.$Nv.$2fH.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$Nv[t]};_h.$Nv.$2fH.prototype={$9kW:function(n){var t=n;this.set_$gq(t.get_$gq())}};_h.$Nv.$7w7=function(){_h.$Nv.$7w7.initializeBase(this,[1])};_h.$Nv.$7w7.prototype={$9x2:function(n){n.val=new _h.$NI;return!0}};_h.$Nv.$45Y=function(n,t,i,r){_h.$Nv.$45Y.$$(this.$$gta["_h.$Nv.$45Y"].TResult).initializeBase(this,[i]);this.$5XC=n;this.$ti=t;this.$2cl=r};_h.$Nv.$45Y.$$=function(n){var t="$45Y"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$Nv[t]){var r=_h.$Nv[t]=function(){(this.$$gta=this.$$gta||{})["_h.$Nv.$45Y"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$Nv.$45Y.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$Nv.$2fH.$$(n));var u=_h.$Nv.$45Y.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$Nv[t]};_h.$Nv.$45Y.prototype={$5XC:!1,$ti:0,$2cl:!1,get_$A5v:function(){return this.$5XC},get_$4SA:function(){return this.$ti},get_$AR:function(){return this.$2cl?"NoClutter":"All"}};_h.$Nv.$7o4=function(n,t,i){_h.$Nv.$7o4.initializeBase(this,[n,t,3,i])};_h.$Nv.$7o4.prototype={$9x2:function(n){if(this.get_$A5v()){n.val=null;return!1}n.val=new _h.$d4(_g.$2X.$Bi("inbox").get_$r(),null,_h.$5p.$1ab(0,this.get_$4SA()),!1,"All",this.get_$AR(),null);return!0}};_h.$Nv.$7oA=function(n,t,i){_h.$Nv.$7oA.initializeBase(this,[n,t,4,i])};_h.$Nv.$7oA.prototype={$9x2:function(n){if(!this.get_$A5v()){n.val=null;return!1}n.val=new _h.$j2(_g.$2X.$Bi("inbox").get_$r(),null,null,"MailListItem",_h.$5p.$1ab(0,this.get_$4SA()),!0,"All",this.get_$AR(),null,!1,null,null);return!0}};_h.$Nv.$7vA=function(n){_h.$Nv.$7vA.initializeBase(this,[6]);this.$5Mz=n};_h.$Nv.$7vA.prototype={$5Mz:null,$9x2:function(n){var i=this.$5Mz.get_$gq();if(!i){n.val=null;return!1}var t=i.Body.ResponseMessages.Items[0];if(!t.RootFolder.Items||!t.RootFolder.Items.length){n.val=null;return!1}var r=t.RootFolder.Items[0];n.val=new _h.$Ip(101,[r.ItemId],_h.$15.$3dm(_h.$15.get_$1Ot()),"ItemNormalizedBody",2,!1);return!0}};_h.$Nv.$7sZ=function(n){_h.$Nv.$7sZ.initializeBase(this,[5]);this.$5Ms=n};_h.$Nv.$7sZ.prototype={$5Ms:null,$9x2:function(n){var t=this.$5Ms.get_$gq();if(!t||!t.Body.Conversations.length){n.val=null;return!1}var i=t.Body.Conversations[0];var r=_a.$7.$42(i.LastModifiedTime);n.val=_h.$FL.$E(101,i.ConversationId.Id,i.ConversationId.ChangeKey,20,r,_h.$15.get_$1Ot(),"ItemPartUniqueBody","");return!0}};_h.$yg=function(){};_h.$yg.prototype={$E:function(n,t,i,r,u){return _h.$yg.$6Yc.$E(n,t,i,r,u)}};_h.$yg.$7a7=function(n,t,i,r,u,f){_h.$yg.$7a7.initializeBase(this,[n,t,i,r,u]);_a.$4.$J(f,"response");this.$30=f};_h.$yg.$7a7.prototype={$30:null,$9iZ:function(){this.get_$6GS().set_$1a7(this.$30);this.get_$2qk().set_$5Mt(0)},$9UH:function(){for(var t=this.$30.Body.Conversations,i=t,u=i.length,n=0;n<u;++n){var f=i[n];f.FolderId=this.get_$3xa()}var r=new _e.$T0(new _e.$Qa(this.get_$5a(),_g.$V.get_$I().get_$1I().get_$DM()),t,[]);r.set_$A5L(11);var e=this;r.$A5O(function(){})}};_h.$yg.$7gI=function(n,t,i,r,u,f){_h.$yg.$7gI.initializeBase(this,[n,t,i,r,u]);_a.$4.$J(f,"response");this.$30=f};_h.$yg.$7gI.prototype={$30:null,$9iZ:function(){this.get_$6GS().set_$3r2(this.$30);this.get_$2qk().set_$5N0(0)},$9UH:function(){var t=this.$30.Body.ResponseMessages.Items[0];var i=t.RootFolder.Items;var n=new _e.$U7(new _e.$kF(this.get_$5a(),_g.$V.get_$I().get_$1I().get_$DM()),i,[],[],null);n.set_$A5L(11);var r=this;n.$A5O(function(){})}};_h.$yg.$6Yc=function(n,t,i,r,u){_a.$4.$J(n,"pageDataPayloadAdapter");_a.$4.$J(t,"clientStore");_a.$4.$J(i,"inboxFolderId");_a.$4.$J(r,"datapoint");this.$dK=n;this.$7F=t;this.$1bS=i;this.$Ll=r;this.$57x=u};_h.$yg.$6Yc.$E=function(n,t,i,r,u){var f=JsonParser.deserialize(u.responseText);var e=f.findMailFolderItem;if(e)return new _h.$yg.$7gI(n,t,i,r,r.get_$5My(),e);else{var o=f.findConversation;if(!o){_js.Trace.logWarning(_a.$0.$J5,"Both FindMailFolderItem and FindConversation values in the SSSD response are null");return null}return new _h.$yg.$7a7(n,t,i,r,r.get_$5Mr(),o)}};_h.$yg.$6Yc.prototype={$dK:null,$7F:null,$1bS:null,$Ll:null,$57x:0,get_$6GS:function(){return this.$dK},get_$5a:function(){return this.$7F},get_$2qk:function(){return this.$Ll},get_$3xa:function(){return this.$1bS},$9UB:function(){if(this.$57x){var n=_a.$6.acss(_a.$0.$Q4,"PersistSSSD_GenerateReloadNotification");this.$9iZ();this.$1aU();_a.$Q.$2de=1;_a.$6.aces(n)}else{var t=_a.$6.acss(_a.$0.$Q4,"PersistSSSD_NoReloadRequired");if(_a.$Q.get_$14O()){_a.$Q.$3Rt();_a.$Q.$2de=2}_a.$6.aces(t)}this.$9UH()},$1aU:function(){this.$Ll.set_$6Ss((new Date).toString());_js.Trace.logInfo(_a.$0.$J5,"SSSD receive time = {0}, Reload notification time = {1}",this.get_$2qk().get_$6Sr(),this.get_$2qk().get_$6Ss());_e.$2l.$2vF(this.$1bS.Id,"SSSD",!1);_a.$Q.$3Pp++}};function OfflineBootComponent(){}OfflineBootComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_h.$2o).$A5E(IOfflineManager).$A5F().$A5G(function(){return new _h.$2o(n.$6OW(_bc.$jh),n.$6OW(IClientStore),n.$6OW(_a.$p),n.$6OW(_0365f.$L),n.$6OW(_h.$Na),n.$6OW(_a.NativeBridge),n.$A3W(ISyncFolderSettingProcessor),n.$A3W(ISyncManagerFactory),n.$A3W(INotificationHandlerProxyFactory),n.$6OW(_a.$3O),n.$6OW(_g.$jV),n.$6OW(_g.$UQ))});var u=this;n.$Ad(_h.$ti).$A5E(IAppStatusBarViewModel).$A5F().$A5G(function(){return new _h.$ti(n.$6OW(_h.$6w))});var f=this;n.$Ad(_h.$AH).$A5F().$A5G(function(){return new _h.$AH(n.$6OW(_0365f.$L),n.$6OW(_h.$2o).$6p,n.$6OW(_js.$CQ),n.$6OW(_a.$XU),OwaApplication.$1p8)});var e=this;n.$Ad(_h.$6w).$A5F().$A5G(function(){return new _h.$6w(n.$6OW(_0365f.$L),n.$6OW(_a.$p),n.$6OW(_h.$2o).$6p,n.$6OW(_js.$CQ),n.$6OW(_a.$XU),n.$6OW(_h.$2o).$Be,n.$6OW(_h.$AH),n.$6OW(_h.$2o).$1dz)});var o=this;n.$Ad(_h.$Nv).$A5E(IPageDataPayloadGenerator).$A5G(function(){return new _h.$Nv(n.$6OW(_g.$44).get_$1I().get_$MO())});var s=this;n.$Ad(_h.$yg).$A5E(IPageDataPayloadPersisterFactory).$A5G(function(){return new _h.$yg})},$7sM:function(){return[]}};_h.$ti.registerClass("_h.$ti",_a.$F2,IAppStatusBarViewModel);_h.$hK.registerClass("_h.$hK");_h.$AH.registerClass("_h.$AH");_h.$6w.registerClass("_h.$6w",_js.$8);_h.$JW.registerClass("_h.$JW",_h.$RP,_h.$wS,_h.$1H7,Sys.IDisposable);_h.$4N.registerClass("_h.$4N",_h.$RP,_h.$wp,_h.$1H7,Sys.IDisposable);_h.$2o.registerClass("_h.$2o",_js.$147,IOfflineManager,Sys.IDisposable);_h.$Nv.registerClass("_h.$Nv",null,IPageDataPayloadGenerator);_h.$Nv.$7w9.registerClass("_h.$Nv.$7w9");_h.$Nv.$7w7.registerClass("_h.$Nv.$7w7",_h.$Nv.$2fH.$$(_g.$L3));_h.$Nv.$7o4.registerClass("_h.$Nv.$7o4",_h.$Nv.$45Y.$$(_g.$Oy));_h.$Nv.$7oA.registerClass("_h.$Nv.$7oA",_h.$Nv.$45Y.$$(_g.$Kk));_h.$Nv.$7vA.registerClass("_h.$Nv.$7vA",_h.$Nv.$2fH.$$(_g.$Qo));_h.$Nv.$7sZ.registerClass("_h.$Nv.$7sZ",_h.$Nv.$2fH.$$(_g.$Qn));_h.$yg.registerClass("_h.$yg",null,IPageDataPayloadPersisterFactory);_h.$yg.$6Yc.registerClass("_h.$yg.$6Yc",null,_bc.$1Hv);_h.$yg.$7a7.registerClass("_h.$yg.$7a7",_h.$yg.$6Yc);_h.$yg.$7gI.registerClass("_h.$yg.$7gI",_h.$yg.$6Yc);OfflineBootComponent.registerClass("OfflineBootComponent",null,_a.$1In);_h.$JW.$A=_a.$0.$EM;_h.$4N.$46M=0;_h.$4N.$A=_a.$0.$EM;_h.$2o.$1p=_a.$0.$EM