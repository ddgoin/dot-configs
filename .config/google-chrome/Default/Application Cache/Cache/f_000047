Type.registerNamespace("_h");_h.$pJ=function(n){this.$$d_$7TE=Function.createDelegate(this,this.$7TE);_h.$pJ.initializeBase(this);this.$2YG=n;this.$4a=new _C(this.$$d_$7TE,_a.$0.$JC);this.set_$15(!0);this.set_$A3(this.$2YG.$q2);var t=this;this.$2YG.$a("AppStatus",function(){t.set_$A3(t.$2YG.$q2)})};_h.$pJ.prototype={$2YG:null,$Dx:null,$4a:null,$4Q:!1,get_$A3:function(){return this.$Dx},set_$A3:function(n){if(n!==this.$Dx){this.$Dx=n;$6(this,"Status");_js.$8.$c(this.$Dx)?this.set_$15(!0):this.set_$15(!1)}return n},get_$15:function(){return this.$4Q},set_$15:function(n){if(n!==this.$4Q){this.$4Q=n;$6(this,"IsHidden")}return n},get_$GT:function(){return this.$4a},$7TE:function(){this.set_$15(!0)}};_h.$Pn=function(){};_h.$Pn.prototype={initialize:1,reachShowLimit:2,appCacheStatusChanges:3,removeALT1doneText:4,removeUpdatingPausedText:5,removeDisconnectedText:6,removeConnectingText:7,removeUpToDateText:8,connectionStatusChange:9,detectingConnectivityChange:10,syncingStatusEvent:11,postALT1SyncOrderChange:12};_h.$Pn.registerEnum("_h.$Pn",!1);_h.$eC=function(){};_h.$9S=function(n,t,i,r,u){this.$$d_$5fs=Function.createDelegate(this,this.$5fs);this.$$d_$7RV=Function.createDelegate(this,this.$7RV);this.$$d_$7Q3=Function.createDelegate(this,this.$7Q3);this.$$d_$7Q2=Function.createDelegate(this,this.$7Q2);this.$5W=_a.$0.$JC;this.$1Fy=new Sys.EventHandlerList;this.$DP=t;this.$S=n;this.$5w=i;this.$QC=r;this.$1NP=!1;this.$1S1=!1;this.$1Tb=!1;this.$2pT=this.$QC.get_$Tr();this.$29E=_a.$7.$cV.$55();this.$16A=null;u&&($4TG(this,u.status)?this.$DP.set_$1fS(!0):$4TH(this,u.status)&&this.$DP.set_$1fS(!1));$6Zh(this);$4TI(this)};function $6Zh(n){_js.Trace.logInfo(n.$5W,"AppCacheStatusMonitor subscribe to events");n.$S.$HX(_h.$jF,n.$$d_$7Q2);n.$S.$HX(_h.$eW,n.$$d_$7Q3);n.$S.$HX(_a.$Ka,n.$$d_$7RV);n.$S.$HX(_h.$eY,n.$$d_$5fs)}function $2Uv(n){var t=n.$1Fy.getHandler("StatusChanged");t&&t()}function $6Ze(n,t){n.$1Fy.addHandler("StatusChanged",t)}function $6Zg(n,t){n.$1Fy.removeHandler("StatusChanged",t)}function $6Zf(n){if(n.$QC.get_$Tr().$55()-n.$2pT.$55()>3e5){_js.Trace.logInfo(n.$5W,"AppCacheInstaller stopped");if(n.$16A){n.$5w.$5G(n.$16A);n.$16A=null}n.set_$57j(!0)}}function $4TG(n,t){return t===1||t===4}function $4TH(n,t){return t===5||!t}function $4TI(n){if(!n.$DP.get_$1fS()&&!n.$16A){n.set_$57j(!1);var t=this;n.$16A=n.$5w.$oa(n.$5W,"installerStoppedDuringALT1Check",function(){$6Zf(n)},3e5)}}_h.$9S.prototype={$S:null,$DP:null,$5w:null,$QC:null,$2pT:null,$16A:null,$1Tb:!1,$1NP:!1,$29E:0,$1S1:!1,add_$96h:function(n){$6Ze(this,n)},remove_$96h:function(n){$6Zg(this,n)},get_$9GZ:function(){return this.$1NP},set_$9GZ:function(n){if(this.$1NP!==n){this.$1NP=n;$2Uv(this)}return n},get_$7FD:function(){return this.$1S1},set_$7FD:function(n){if(this.$1S1!==n){this.$1S1=n;$2Uv(this)}return n},get_$57j:function(){return this.$1Tb},set_$57j:function(n){if(this.$1Tb!==n){this.$1Tb=n;$2Uv(this)}return n},get_$94Y:function(){var n=this.$QC.get_$Tr().$55();_js.Trace.logInfo(this.$5W,String.format("Now = {0}, ResumeTime = {1}, pausedShowTime = {2}, ConnectingShowtime = {3}, InactiveTime = {4}, FirstVersionMismatchTime = {5}",n,this.$DP.get_$2YA(),5e3,3e3,this.$DP.get_$2Y9(),this.$29E));return this.$DP.get_$2Y9()>this.$29E&&n<this.$DP.get_$2YA()+5e3+3e3},$7Q2:function(n){_js.Trace.logInfo(this.$5W,String.format("Receiving AppCacheStatus={0}",_a.$pH.toString(n.$Dx)));this.$2pT=this.$QC.get_$Tr();if($4TG(this,n.$Dx)){_js.Trace.logInfo(this.$5W,"AppCache finishes downloading");this.$DP.set_$1fS(!0);if(this.$16A){this.$5w.$5G(this.$16A);this.$16A=null}$2Uv(this)}else $4TH(this,n.$Dx)&&this.$DP.set_$1fS(!1);$4TI(this)},$7Q3:function(n){_js.Trace.logInfo(this.$5W,"AppCache finishs the update");this.set_$7FD(!0)},$7RV:function(n){if(!n.$SU&&!this.$1NP){this.$29E=this.$QC.get_$Tr().$55();_js.Trace.logInfo(this.$5W,String.format("firstVersionMismatchTime={0}",this.$29E));this.set_$9GZ(!0)}},$5fs:function(n){_js.Trace.logInfo(this.$5W,"Reset lastStatusEventTime when app comes from background to foreground");this.$2pT=this.$QC.get_$Tr()}};_h.$6Z=function(n,t,i,r,u,f,e,o){this.$$d_$7S5=Function.createDelegate(this,this.$7S5);this.$$d_$7S1=Function.createDelegate(this,this.$7S1);this.$$d_$3xg=Function.createDelegate(this,this.$3xg);this.$$d_$5fs=Function.createDelegate(this,this.$5fs);this.$5W=_a.$0.$JC;_h.$6Z.initializeBase(this);this.$vT=e;this.$DP=i;this.$S=n;this.$1D=t;this.$QC=u;this.$5w=r;this.$AS=f;var s=this;this.$AS.$a("DetectingConnectivity",function(){$6Zl(s)});this.$3k6=_a.$7.$cV.$55();this.$2Fb=_a.$7.$cV.$55();this.$33R=null;this.$1vV=null;this.$25y=null;this.$2yB=!1;o&&(this.$1Ht=o);$6Zm(this);$6Zo(this)};function $6Zo(n){n.$S.$HX(_h.$eY,n.$$d_$5fs);n.$S.$HX(_a.$QG,n.$$d_$3xg);n.$S.$HX(_h.$PV,n.$$d_$7S1);n.$S.$HX(_h.$eC,n.$$d_$7S5);var t=this;n.$vT.add_$96h(function(){$1C3(n,3)})}function $6Zn(n){$4TJ(n);switch(n.$q2){case _u.Strings.l_AppStatus_ALT1Done_Text:n.$DP.set_$2B7(!0);$1eI(n,null,1e4,4);break;case _u.Strings.l_AppStatus_AppCachePaused_Text:$1eI(n,null,5e3,5);break;case _u.Strings.l_AppStatus_Disconnected_Text:$1eI(n,null,1e4,6);break;case _u.Strings.l_AppStatus_Connecting_Text:$1eI(n,null,3e3,7);break;case _u.Strings.l_AppStatus_MailSyncComplete_Text:n.$5Fh=n.$1Ht.get_$3es();$1eI(n,null,3e3,8);break;default:break}}function $1eI(n,t,i,r){_js.Trace.logInfo(n.$5W,"Scheduling timer callback to {0} with delay {1}",_h.$Pn.toString(r),i);$4TJ(n);var u=this;n.$1vV=n.$5w.$21(n.$5W,_h.$Pn.toString(r),function(){n.$1vV=null;t&&t();$1C3(n,r)},i)}function $4TJ(n){if(n.$1vV){_js.Trace.logInfo(_a.$0.$JC,"Cancelling existing pending updater");n.$5w.$5G(n.$1vV);n.$1vV=null}}function $6Zm(n){if(n.$DP.get_$4gB())n.set_$JC(_u.Strings.l_AppStatus_Connecting_Text);else{n.$DP.set_$4gB(!0);$1C3(n,1)}}function $1C3(n,t){_js.Trace.logInfo(n.$5W,"TryUpdateAppStatus {0}",_h.$Pn.toString(t));if(!n.$AS.$1R8)if(n.$AS.$NF)if(n.$DP.get_$1fS()&&n.$DP.get_$12c()||n.$vT.$1S1)if(n.$vT.$1NP){_js.Trace.logInfo(n.$5W,"VersionMismatchReported");n.$vT.$1S1?n.set_$JC(""):n.$vT.get_$94Y()?n.set_$JC(_u.Strings.l_AppStatus_AppCachePaused_Text):n.set_$JC(_u.Strings.l_AppStatus_AppCacheDownloading_Text)}else if(n.$DP.get_$2B7()||!n.get_$491()){_js.Trace.logInfo(n.$5W,"Check syncing status");n.$1Ht&&n.$1Ht.$2Sg?n.$1Ht.$1HK?n.set_$JC(_u.Strings.l_AppStatus_MailSyncing_Text):n.$QC.get_$Tr().$55()-n.$1Ht.get_$3es()<3e3?n.$q2===_u.Strings.l_AppStatus_MailSyncComplete_Text?n.$5Fh!==n.$1Ht.get_$3es()&&$1eI(n,null,3e3,8):n.set_$JC(_u.Strings.l_AppStatus_MailSyncComplete_Text):n.set_$JC(""):n.set_$JC("")}else n.set_$JC(_u.Strings.l_AppStatus_ALT1Done_Text);else{_js.Trace.logInfo(n.$5W,"ALT1");n.get_$491()&&(n.$vT.$1Tb?n.set_$JC(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$JC(_u.Strings.l_AppStatus_ALT1_Text))}else{var i=n.$QC.get_$Tr().$55();_js.Trace.logInfo(n.$5W,"App disconnected, now={0},lostconnectionTimeMS={1}",i,n.$2Fb);if(i-n.$2Fb<1e4||n.$q2===_u.Strings.l_AppStatus_Connecting_Text)n.set_$JC(_u.Strings.l_AppStatus_Disconnected_Text);else{_js.Trace.logInfo(n.$5W,"InstallerStoppedDuringALT1={0}",n.$vT.$1Tb);n.get_$491()&&n.$vT.$1Tb&&!n.$vT.$1S1?n.set_$JC(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$JC("")}}}function $6Zl(n){_js.Trace.logInfo(_a.$0.$JC,"HandleConnectionManagerChanges");if(!n.$AS.$1R8){if(n.$2yB){n.$AS.$NF||$4TK(n,10);n.$2yB=!1}$1C3(n,10)}}function $4TK(n,t){if(n.$q2!==_u.Strings.l_AppStatus_Disconnected_Text){n.$2Fb=n.$QC.get_$Tr().$55();_js.Trace.logInfo(_a.$0.$JC,"{0} Set lostConnectionTimeMS = {1}",_h.$Pn.toString(t),n.$2Fb)}}_h.$6Z.prototype={$DP:null,$S:null,$5w:null,$QC:null,$1D:null,$AS:null,$q2:null,$3k6:0,$2Fb:0,$2yB:!1,$33R:null,$1vV:null,$25y:null,$vT:null,$1Ht:null,$5Fh:0,get_$JC:function(){return this.$q2},set_$JC:function(n){if(n!==this.$q2){var t;t=this.$q2===""?0:this.$3k6+3e3-this.$QC.get_$Tr().$55();if(t<=0){this.$q2=n;this.$3k6=this.$QC.get_$Tr().$55();_js.Trace.logInfo(this.$5W,"Rasing AppStatusEvent Status = {0}",this.$q2);$6Zn(this);$Q(this,"AppStatus")}else if(!this.$33R){_js.Trace.logInfo(this.$5W,"Can't set status to {0} within the limit, scheduling a timer callback to update the status with delay = {1}",n,t);var i=this;this.$33R=this.$5w.$21(this.$5W,"UpdateAppStatus",function(){i.$33R=null;$1C3(i,2)},t)}}return n},get_$491:function(){return this.$1D.get_$2z4()},$3xg:function(n){_js.Trace.logInfo(_a.$0.$JC,"OnConnectionStatusChanged");if(this.$25y){_js.Trace.logInfo(_a.$0.$JC,"Cancel connectionStatusDelayer");this.$5w.$5G(this.$25y)}var t=this;this.$25y=this.$5w.$21(this.$5W,"ConnectionStatusDelayer",function(){t.$25y=null;if(t.$AS.$1R8){_js.Trace.logInfo(_a.$0.$JC,"Don't change the app status since it's still detecting the connectivity");t.$2yB=!0}else{t.$AS.$NF||$4TK(t,9);$1C3(t,9)}},3e3)},$5fs:function(n){_js.Trace.logInfo(this.$5W,"OnAppResume");this.set_$JC(_u.Strings.l_AppStatus_Connecting_Text)},$7S1:function(n){if(_h.$43.isInstanceOfType(n.$28)){this.$1Ht=n.$28;$1C3(this,11)}},$7S5:function(n){$1C3(this,12)}};_h.$I7=function(n,t,i){_h.$I7.resolveInheritance();this.dispose=this.$1M;_h.$I7.initializeBase(this,[n,t,i,[10]])};function $2Uw(n){n.set_$1HL(n.$AS.$NF&&n.$2EI)}_h.$I7.prototype={$2EI:!1,$7RG:function(n){this.$2EI=!0;$2Uw(this)},$7RF:function(n){this.$2EI=!1;$2Uw(this)},$7S0:function(n){if(this.$2EI){_js.Trace.logWarning(_h.$I7.$D,"Failed to get module finish event for calendar module and received sync complete event. This may indicate a problem in the sync framework.");this.$2EI=!1;$2Uw(this)}},$7QO:function(){$2Uw(this)}};_h.$43=function(n,t,i,r,u,f,e,o){this.$$d_$7Q1=Function.createDelegate(this,this.$7Q1);this.$$d_$8Ux=Function.createDelegate(this,this.$8Ux);this.$$d_$7QW=Function.createDelegate(this,this.$7QW);this.$$d_$3bf=Function.createDelegate(this,this.$3bf);_h.$43.resolveInheritance();this.dispose=this.$1M;_h.$43.initializeBase(this,[i,u,e,[4,11,5,12]]);_a.$3.$M(n,"userConfiguration");_a.$3.$M(t,"folderMappings");_a.$3.$M(r,"clientStore");_a.$3.$M(f,"syncFolderSettingProcessor");this.$t=n;this.$1i=t;this.$6T=r;this.$DW=f;this.$pT=o;this.$kB=_a.$5H.$$(Number).$8M();this.$3YM=_a.$5H.$$(Number).$8M();$6aO(this);$6aP(this);this.set_$6Ax(this.$pT.get_$22y()===_h.$43.$3ln);$1eJ(this)};function $6aM(n,t,i){_a.$3.$M(t,"unsentInfo");_a.$3.$M(i,"updateInfo");var r;r=t.length>0?i.length>0?String.format("{0}{1}{2}",t,_u.Strings.l_OfflineActivityInfoSeperator_Text,i):t:i;return r}function $4TY(n){_js.Trace.logInfo(_h.$43.$D,"UpdateModuleFinishStatus");n.$3YM.set_$48(n.$2R4,_a.$7.get_utcNow().$55());n.$Wx.Id===n.$2R4&&n.set_$2CL(!1);n.$2R4=""}function $6aO(n){var t=n.$1i.nameToId("inbox");n.set_$16C(t)}function $6aP(n){$4TZ(n);n.$S.$HX(_h.$Ky,n.$$d_$3bf);n.$S.$HX(_h.$fN,n.$$d_$7QW);n.$S.$HX(_a.$Xp,n.$$d_$8Ux);n.$pT.add_$4dW(n.$$d_$7Q1)}function $1eJ(n){_js.Trace.logInfo(_h.$43.$D,"UpdateMailActivityInfo: Connected:{0}",n.$AS.$NF);if(n.$AS.$NF&&n.$2CK&&n.$2Sg){n.set_$3la("");n.set_$1HL(!0);return}n.set_$1HL(!1);$6aQ(n);if(n.$AS.$NF)n.set_$3la($4TX(n));else{var t=this;$6aN(n,function(t){n.$AS.$NF||n.set_$3la($6aM(n,$4TX(n),t))})}}function $6aQ(n){n.set_$6x4(!n.$AS.$NF&&n.$1Z5>0)}function $4TX(n){return n.$1Z5>0?String.format(_u.Strings.l_UnsentInfo_Text,n.$1Z5):""}function $6aN(n,t){var i="";var u=n.$t.get_$4r().$Wm(n.$Wx);var r=-1;u.$Av===1?r=4:(u.$Av===2||u.$Av===3)&&(r=5);if(!n.$DW.$7ZH(r,n.$Wx.Id)){t(i);return}if(n.$6T.get_$rx()){var f=this;n.$3x.$7LA(r,new _bc.$Ga(n.$Wx),function(r){i=$6aL(n,r);t(i)})}else{_js.Trace.logError(_h.$43.$D,"ClientStore should be available when we try to GetLastUpdateInfo");t(i)}}function $4TZ(n){_js.Trace.logInfo(_h.$43.$D,"Update outbox total count");if(n.$6T.get_$rx()){var t=n.$1i.nameToId("outbox");if(!t){_js.Trace.logError(_h.$43.$D,"There is no FolderId for outbox");return}var i=new _e.$Yq(n.$6T,n.$t.get_$1t().get_$IJ());var r=this,u=this,f=this;i.$AK(new _a.$6L("MailOfflineActivityIndicator.UpdateOutboxTotalCount"),function(r){i.$7KJ(r,t,function(t,i){n.set_$3zu(t)})},function(){},function(n){_js.Trace.logWarning(_h.$43.$D,"Failed to get outbox total count due to error:",n.$4P)})}else _js.Trace.logError(_h.$43.$D,"ClientStore is not available when we try to UpdateOutboxTotalCount")}function $6aL(n,t){if(!$8(t)){var i=_a.$7.$4Y(t);var r;r=i.$8c(_a.$7.get_$2M())?1:0;return $6aK(n,i,r)}return""}function $6aK(n,t,i){return String.format(_u.Strings.l_UpdatedOn_Text,t.$2P(i))}_h.$43.prototype={$6T:null,$t:null,$1i:null,$DW:null,$kB:null,$3YM:null,$2CK:!1,$1Z5:0,$2Fl:null,$Wx:null,$2aK:!1,$pT:null,$2Sg:!1,$2R4:null,$2cN:!1,get_$6Ax:function(){return this.$2Sg},set_$6Ax:function(n){if(this.$2Sg!==n){this.$2Sg=n;$1eJ(this)}return n},get_$3la:function(){return this.$2Fl},set_$3la:function(n){if(n!==this.$2Fl){this.$2Fl=n;_js.Trace.logInfo(_h.$43.$D,"MailActivityInfo changes to {0}, Connected = {1}",this.$2Fl,this.$AS.$NF);this.$S.$8oV(_h.$mm,new _h.$mm(this,this.$2Fl))}return n},get_$3zu:function(){return this.$1Z5},set_$3zu:function(n){if(this.$1Z5!==n){this.$1Z5=n;$1eJ(this)}return n},get_$6x4:function(){return this.$2aK},set_$6x4:function(n){if(n!==this.$2aK){this.$2aK=n;this.$S.$8oV(_h.$ko,new _h.$ko(this.$2aK))}return n},get_$16C:function(){return this.$Wx},set_$16C:function(n){if(this.$Wx!==n){this.$Wx=n;this.set_$2CL(this.$kB.$Lg(this.$Wx.Id));$1eJ(this)}return n},get_$2CL:function(){return this.$2CK},set_$2CL:function(n){if(this.$2CK!==n){this.$2CK=n;$1eJ(this)}return n},get_$3es:function(){return this.$3YM.get_$48(this.$Wx.Id)},$59:function(){this.$S.$12Z(_h.$Ky,this.$$d_$3bf);this.$S.$12Z(_h.$fN,this.$$d_$7QW);this.$S.$12Z(_a.$Xp,this.$$d_$8Ux);this.$pT.remove_$4dW(this.$$d_$7Q1);_h.$Ou.prototype.$59.call(this)},$7RG:function(n){if($8(n.$rK)||!n.$rK.length)_js.Trace.logWarning(_h.$43.$D,"FoldersToSync is empty, moduleName:{0} for enqueued event",n.$FZ);else{_js.Trace.logInfo(_h.$43.$D,"FoldersToSync: {0}, event:{1}",n.$rK.toString(),_a.$F0.toString(n.$N4));Array.contains(n.$rK,this.$Wx.Id)&&this.set_$2CL(!0);for(var r=n.$rK,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$kB.$Lg(t)){var u;this.$kB.set_$48(t,(u=this.$kB).set_$48(t,u.get_$48(t)+1))}else this.$kB.set_$48(t,1)}}},$7RF:function(n){if($8(n.$rK)||!n.$rK.length)_js.Trace.logWarning(_h.$43.$D,"FoldersToSync is empty, moduleName:{0} event:{1}",n.$FZ,_a.$F0.toString(n.$N4));else{_js.Trace.logInfo(_h.$43.$D,"FoldersToSync: {0}, event:{1}",n.$rK.toString(),_a.$F0.toString(n.$N4));if(Array.contains(n.$rK,this.$Wx.Id)&&this.$2CK)if(n.$N4===3){this.$2R4=this.$Wx.Id;this.$2cN||$4TY(this)}else this.set_$2CL(!1);for(var r=n.$rK,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$kB.$Lg(t)){var u=this.$kB.get_$48(t);u>1?this.$kB.set_$48(t,--u):this.$kB.$3Q(t)}else _js.Trace.logWarning(_h.$43.$D,"We can't find folder {0} in the syncingFoldersMap, moduleName:{1} event:{2}",t,n.$FZ,_a.$F0.toString(n.$N4))}}},$7S0:function(n){if(this.$kB.$9J3()>0){var t=new Sys.StringBuilder;var i=this;this.$kB.$9J4(function(n,i){t.append(String.format("Key:{0},Value:{1};",n,i))});_js.Trace.logWarning(_h.$43.$D,"syncingFoldersMap = {0} when sync session completes",t.toString());this.set_$2CL(!1);this.$kB=_a.$5H.$$(Number).$8M()}},$7QO:function(){$1eJ(this)},$7QW:function(n){this.$2cN=n.$Po;_js.Trace.logInfo(_h.$43.$D,"CurrentMailListTableLoading = {0}",this.$2cN);this.$2cN||_js.$8.$c(this.$2R4)||$4TY(this)},$7Q1:function(){this.set_$6Ax(this.$pT.get_$22y()===_h.$43.$3ln)},$3bf:function(n){var t=n.$2B;t&&t.get_$n()&&this.set_$16C(t.get_$n())},$8Ux:function(n){n.$1EU===5&&$4TZ(this)}};_h.$2d=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$7RT=Function.createDelegate(this,this.$7RT);this.$$d_$7R9=Function.createDelegate(this,this.$7R9);this.$$d_$7RU=Function.createDelegate(this,this.$7RU);this.$$d_$7Ql=Function.createDelegate(this,this.$7Ql);this.$$d_$7Qm=Function.createDelegate(this,this.$7Qm);this.$$d_$7X2=Function.createDelegate(this,this.$7X2);this.$$d_$7Qf=Function.createDelegate(this,this.$7Qf);this.$$d_$7Qj=Function.createDelegate(this,this.$7Qj);this.$$d_$5gW=Function.createDelegate(this,this.$5gW);this.$5T=new Sys.EventHandlerList;_h.$2d.resolveInheritance();this.dispose=this.$1M;_h.$2d.initializeBase(this);this.$to=n;this.$6H=u;this.set_$57(t);this.$1D=i;this.$S=r;this.$27=f;this.$1B1=o;this.$5ex=s;this.$DW=e;this.$1K=h;this.$sd=c;$6al(this)};function $6aa(n){return n.$1D.get_$5h()?new _g.$n8(_a.NativeBridge.get_$L(),n.$1K,n.$sd):new _g.$bT(n.$1K,n.$sd)}function $4Th(n,t,i){_a.$3.$M(t,"successCallback");_a.$3.$M(i,"failureCallback");if(n.$1D.get_$2z4()){_js.Trace.logInfo(_h.$2d.$1n,"Removing client store and associated local storage.");var r=this,u=this;n.$6T.$68N(function(){n.$6H.$34H();n.$to.$1u();_js.Trace.logInfo(_h.$2d.$1n,"Client store successfully removed.");t()},function(n){_js.Trace.logError(_h.$2d.$1n,"We failed to uninstall client store due to error: "+n.message);i(n)})}else{_js.Trace.logWarning(_h.$2d.$1n,"Remove client store called, but offline is not supported by this user agent");t()}}function $4Tg(n,t,i,r){if(_e.$5s.isInstanceOfType(t)){var u=t;u.$3UO()}n.$to.$1u();if(i){var f=n.$4z4(i,r);f.$BA()}}function $6ae(n){_js.Trace.logInfo(_h.$2d.$1n,"Initializing UI Dependent Offline Components");var t=this;n.$DW.$I(function(t){_js.Trace.logInfo(_h.$2d.$1n,"sync folder setting cache has been initialized");n.$4Bz=new _h.$148(_g.$g.$1i);n.$to.$8kO(n.$6T,window.owaSD);n.$1Vc=new _h.$43(_g.$S.get_$L(),_g.$g.$1i,n.$S,n.$6T,n.get_$Bq(),t,n.$AS,n.get_$Bq().get_$9C9());n.$24j=new _h.$I7(n.$S,n.get_$Bq(),n.$AS);n.$65L&&n.get_$Bq().$10();n.$S.$9Io(_h.$bR,new _h.$bR)})}function $4Ti(n){if(n.$4xf&&n.$1Ti){var t=this;n.$DW.$I(function(n){n.$5zM(_h.$l.$ea("msgfolderroot"))})}}function $6ai(n,t){n.$AS=t.$AS;$4Ti(n)}function $6al(n){n.$S.$HX(_h.$kd,n.$$d_$7Qf);n.$S.$HX(_a.$Ka,n.$$d_$7X2);n.$S.$HX(_h.$Ts,n.$$d_$7Qm);n.$S.$HX(_h.$Ys,n.$$d_$7Ql);n.$S.$HX(_a.$DL,n.$$d_$7RU)}function $6am(n){n.$S.$12Z(_a.$Ka,n.$$d_$7X2);n.$S.$12Z(_h.$Ts,n.$$d_$7Qm);n.$S.$12Z(_h.$Ys,n.$$d_$7Ql);n.$S.$12Z(_a.$DL,n.$$d_$7RU)}function $6ab(n,t,i,r,u,f){var e="sync";n.$65L=$8(r)||$8(r.get_$48(e))||r.get_$48(e).toString()==="true";n.$1B1.get_$1d().$I(t,i,_a.$z.get_$73(),u,OwaApplication.$27P,f)}function $6af(n,t,i,r,u,f,e){var o=this,s=this;$6ah(n,t,function(o){var s=new _g.$S(o);$6aj(n,t,u,function(t){$6aZ(n,t,i,r,s,function(n){n.$Fp.set_$1gx(OwaApplication.$27P);f(n,s)},function(t){_js.Trace.logError(_h.$2d.$1n,"CreateOfflineMailboxDataContextFromClientStore Failed: {0}",t.$4P);n.$6T.$YX();e(new _e.$1W(t).$IU())})},function(t){_js.Trace.logError(_h.$2d.$1n,"Failed to provision the offline client: {0}",t.message);n.$6T.$YX();e(t)})},function(t){_js.Trace.logError(_h.$2d.$1n,"Failed to load OWA user configuration: {0}",t.message);n.$6T.$YX();e(t)})}function $6aj(n,t,i,r,u){var f=new _g.$c3(n.$6T.get_$7U9(),"DeviceType","1.0");f.HasPAL=n.$1D.get_$5h();if(n.$1D.get_$5h()){if(n.$27.get_device().$Cp){f.DeviceModel=n.$27.get_device().get_$7u().get_$27W();f.DeviceFriendlyName=n.$27.get_device().get_$7u().get_$79l();if(n.$27.get_device().get_$7u().get_$1R9()===1){f.DeviceOS="iOS "+n.$27.$32.get_$7r().get_$1Z0();f.DeviceType="iPhone"}else if(n.$27.get_device().get_$7u().get_$1R9()===2){f.DeviceOS="iOS "+n.$27.$32.get_$7r().get_$1Z0();f.DeviceType="iPad"}else if(n.$27.get_device().get_$7u().get_$1R9()===3){f.DeviceOS="Android "+n.$27.$32.get_$7r().get_$1Z0();f.DeviceType="Android"}else if(n.$27.get_device().get_$7u().get_$1R9()===4){f.DeviceOS="Windows "+n.$27.$32.get_$7r().get_$1Z0();f.DeviceType="Windows 8"}}f.ClientVersion=n.$27.$32.get_$7r().get_$3Z();f.DeviceOSLanguage=n.$27.$32.get_$7r().get_$7e2()}var e=_e.$9O.$29U(n.$6T);var o=this;e.$7N3(function(o){if(o){_js.Trace.logInfo(_h.$2d.$1n,"Client is already provisioned.");r(f)}else if(f.HasPAL||i){_js.Trace.logInfo(_h.$2d.$1n,"Provisioning the client with the server...");var h=t?t.get_$3Cf():new _g.$3d(function(){},n.$1K,n.$sd);var s=new _g.$RI("Exchange2013");s.TimeZoneContext=new _g.$SV;s.TimeZoneContext.TimeZoneDefinition=new _g.$Np;s.TimeZoneContext.TimeZoneDefinition.Id="UTC";n.$1D.get_$5h()&&n.$6H.$34H();h.$5rC(new _g.$c1(s,f),null,function(t,i){if("Success"===i.Body.ResponseMessages.Items[0].ResponseClass){_js.Trace.logInfo(_h.$2d.$1n,"...server call succeeded, saving results to the database...");e.$8zW(!0,function(){_js.Trace.logInfo(_h.$2d.$1n,"Provisioning completed.");r(f)},u)}else if("Error"===i.Body.ResponseMessages.Items[0].ResponseClass&&"ErrorMaximumDevicesReached"===i.Body.ResponseMessages.Items[0].ResponseCode){_js.Trace.logError(_h.$2d.$1n,"Maximum number of allowed partnerships already created.");var o=new _a.$4f([_u.Strings.l_ProvisionFailedDueToMaxDevices_Text],0,n.$$d_$7R9,0,!1,_u.Strings.l_Close_Text,"",_u.Strings.l_ProvisionFailedDueToMaxDevices_Title_Text);n.$S.$8oV(_a.$4f,o)}else{_js.Trace.logError(_h.$2d.$1n,"Provisioning call returned a response error.");var s=Error.create(i.Body.ResponseMessages.Items[0].MessageText);u(s)}},u)}else{_js.Trace.logWarning(_h.$2d.$1n,"The client is not provisioned, and we should not provision it automatically.  Removing the 'offline enabled' flag and reloading.");n.$2NR(t,window.location,_a.NativeBridge.get_$L().$32)}},u)}function $6ah(n,t,i,r){if(_g.$S.get_$L().$59l){var u=_e.$9O.$29U(n.$6T);var f=this;u.$lu(function(u){if(u){_js.Trace.logInfo(_h.$2d.$1n,"Found OWA user configuration in client store.");i(u)}else{_js.Trace.logInfo(_h.$2d.$1n,"Getting OWA user configuration from the server...");var f=t?t.get_$3Cf():new _g.$3d(function(){},n.$1K,n.$sd);f.$lu(null,function(n,t){_js.Trace.logInfo(_h.$2d.$1n,"...server call succeeded");i(t)},r)}},_e.$1W.$4oA(r))}else{_js.Trace.logInfo(_h.$2d.$1n,"OWA user configuration has already been loaded.");i(_g.$S.get_$L().get_$9B())}}function $6aZ(n,t,i,r,u,f,e){var h=_e.$9O.$29U(n.$6T);var o=new _e.$5v(n.$6T);var s=null;_js.Trace.logInfo(_h.$2d.$1n,"Creating OfflineMailboxDataContext from client store database.");var c=this,l=this;n.$6T.get_$wQ().$AK(new _a.$6L("OfflineManager.CreateOfflineMailboxDataContextFromClientStore"),function(t){$6ag(n,t,h,o,function(n){s=n});o.$7Uq(t)},function(){_js.Trace.logInfo(_h.$2d.$1n,"CreateOfflineMailboxDataContextFromClientStore transaction succeeded.");n.$1B1.$I(function(e){var h=new _e.$5s(n.$6T,u.get_$1t().get_$IJ(),i,r,new _g.$A0(n.$S),n.$S,o,t.HasPAL,t.DeviceID,t.DeviceType,s,u.get_$38(),e);h.$7fF(function(){h.set_$7E2(function(){return OwaApplication.$27P});h.$96U(_js.$K.get_$L());f(h)})})},e)}function $6ag(n,t,i,r,u){_js.Trace.logInfo(_h.$2d.$1n,"Checking if action queue is empty.");var f=this;r.$7Yo(t,function(n){if(n){_js.Trace.logInfo(_h.$2d.$1n,"Action queue is empty therefore we're removing the IdentityCorrelationTable setting.");i.$6y9(t,function(){_js.Trace.logInfo(_h.$2d.$1n,"IdentityCorrelationTable setting reset.");u(null)})}else{_js.Trace.logInfo(_h.$2d.$1n,"Action queue is not empty therefore we're loading the IdentityCorrelationTable setting.");i.$7Kk(t,function(n){n?_js.Trace.logInfo(_h.$2d.$1n,"IdentityCorrelationTable setting loaded with {0} items.",n.map.count):_js.Trace.logInfo(_h.$2d.$1n,"IdentityCorrelationTable setting loaded but had no value.");u(n)})}})}function $6ad(n,t,i){t=t||"";i=i||"";var r=t.split("@")[0];var u=i.split("@")[0];return r===u}function $6ak(n,t){n.$3jC=!0;n.$6H.set_$1nr(!0);var i=this;t.$oa(_a.$0.$DO,"StartOfflineSessionInUseThread",function(){if(n.$1Ti&&!n.$9v){n.get_$Bq()&&n.get_$Bq().get_$1HL()&&n.$6H.get_$99Y()>1e4&&_a.$b.$7W("Core.Models.Sync.SuspendedDuringSync");n.$6H.set_$1nr(!0)}},5e3)}function $6ac(n,t){if(n.$27.get_device().$Cp&&n.$27.get_device().get_$7u().get_$4fj()){_js.Trace.logInfo(_h.$2d.$1n,"the native bridge device state indicates the application was reset.  the offline manager will clear all offline data.");var i=this,r=this;$4Th(n,function(){t()},function(t){n.$27.$32.$2aY(0,"Unable to remove the client store. "+t.message)})}else t()}_h.$2d.prototype={$to:null,$1D:null,$S:null,$27:null,$DW:null,$1B1:null,$5ex:null,$1K:null,$sd:null,$6T:null,$AS:null,$1Ti:!1,$6H:null,$4xf:!1,$58S:!1,$1Vc:null,$24j:null,$4Bz:null,$65L:!1,$3jC:!1,$7e0:null,get_$57:function(){return this.$6T},set_$57:function(n){this.$6T&&this.$6T.remove_$2lU(this.$$d_$5gW);this.$6T=n;if(this.$6T){this.$5gW(!1);this.$6T.add_$2lU(this.$$d_$5gW)}else this.set_$X1(!1);return n},get_$2ZU:function(){return this.$24j},set_$2ZU:function(n){this.$24j=n;return n},get_$4C0:function(){return this.$4Bz},set_$4C0:function(n){this.$4Bz=n;return n},get_$X1:function(){return this.$1Ti},set_$X1:function(n){if(n!==this.$1Ti){this.$1Ti=n;var t=this.$5T.getHandler("IsClientStoreInstalled");t&&t()}return n},get_$9G8:function(){return this.$6H},set_$9G8:function(n){this.$6H=n;return n},get_$3zu:function(){return this.$1Vc?this.$1Vc.$1Z5:0},get_$49P:function(){return this.$6H.get_$NI()&&this.$1Ti&&this.$6H.get_$621()?!this.$AS.$NF:!1},get_$1ns:function(){return this.$3jC},get_$Bq:function(){var n=null;this.$1B1.get_$5E7()&&(n=this.$1B1.get_$1d().$ed());return n},$3dz:function(n,t,i,r,u,f,e){var s=this.$6H.get_$1nr();var h=this.$6H.get_$NI();if(h&&!s){_js.Trace.logInfo(_a.$0.$H1,"Initializing offline mailbox data context");var c=this,o=this;this.$42K(null,t,!1,i,r,e,function(t){_js.Trace.logInfo(_a.$0.$H1,"Prepare offline component completed successfully");n(t)},function(t){_js.Trace.logError(_a.$0.$H1,"Offline Initialization failed - reverting to KIOSK mode. {0}",t.message);o.$7e0=String.format("OfflineInit failed:{0}",t.message);var i=new _g.$1Q(null,u,f,new _g.$A0(o.$S),o.$S);i.$AS.set_$2Jd(!0);n(i)})}else throw Error.invalidOperation();},$42K:function(n,t,i,r,u,f,e,o){_a.$3.$M(e,"onOfflineReady");var s=this,h=this;this.$7Wj(n,t,i,u,f,function(n){$.cookie("X-Offline","1",{path:"/"});$6ak(s,r);s.$to.$4BH(s.$S,s.get_$Bq(),s.$27,n.$Fp);e(n)},function(n){h.$27.$32.$Cp&&h.$27.$32.$2aY(1,n.message||"prepare offline component failed with an unknown error");o(n)})},$44E:function(n,t,i){this.$S.$8oV(_a.$Ov,new _a.$Ov(!1));this.$2NR(n,t,i)},$2NR:function(n,t,i){$.cookie("X-Offline",null,{path:"/"});this.$6H.$68a();$4Tg(this,n,t,i)},$8qU:function(n,t){_a.$3.$M(n,"successCallback");_a.$3.$M(t,"failureCallback");this.$6H.get_$48o()?$4Th(this,n,t):n()},$59:function(){$6am(this);this.$3jC&&this.$6H.set_$1nr(!1);this.$1Vc&&this.$1Vc.$1M();this.$24j&&this.$24j.dispose();if(this.$1B1.get_$5E7()&&this.get_$Bq()){this.$S.$12Z(_a.$fq,this.$$d_$7Qj);this.get_$Bq().dispose()}},$4z4:function(n,t){return new _a.$Pu(n,t)},$7Wj:function(n,t,i,r,u,f,e){var o=this;$6ac(this,function(){o.$6T.$3eV(function(){$6af(o,n,$6aa(o),new _g.$kF,i,function(n,e){o.$6T.$97E(n.$6t,o.$S);var s=t?t.get_$48("connected"):null;if("false"===s){n.$AS.set_$1QC(!1);n.$AS.set_$2Jd(!1)}else n.$AS.set_$2Jd(!0);$6ai(o,n);o.$5ex.$I(function(s){var h=s.$I(new _a.$vT,OwaApplication.get_$1Y9(),OwaApplication.get_$Rk(),t);OwaApplication.get_$Rk().set_$Rl(h);o.$1B1.$I(function(s){$6ab(o,n,h,t,r,u);o.$S.$HX(_a.$fq,o.$$d_$7Qj);i&&o.$6H.$90C(e.get_$38().get_$Br(),e.get_$38().get_$Gz());f(n)})})},function(n){_js.Trace.logWarning(_h.$2d.$1n,"Failed to initialize the offline mailbox data context - disposing the client store. {0}",n);o.$6T.$YX();e(n)})},e)})},$7Qf:function(n){var t;if(this.$1D.get_$5h()){var r=this;t=new _a.$4f([_u.Strings.l_PALFatalQuotaError_Text],0,function(n,t){},0,!1,null,null,null)}else{this.$6H.$68a();this.$S.$8oV(_a.$Ov,new _a.$Ov(!1));var i=this;t=new _a.$4f([_u.Strings.l_BrowserFatalQuotaError1_Text,_u.Strings.l_BrowserFatalQuotaError2_Text],0,function(n,t){n&&$4Tg(i,_g.$1Q.$g,window.location,_a.NativeBridge.get_$L().$32)},0,!1,_u.Strings.l_Refresh_StartWithUpperCase_Text,null,null)}this.$S.$8oV(_a.$4f,t)},$7RU:function(n){_js.Trace.logInfo(_h.$2d.$1n,"Handling OwaApplicationStartedEvent");this.$6H.$7A1(_g.$S.get_$L().get_$QG().AllowOfflineOn)&&this.$2NR(_g.$1Q.$g,window.location,_a.NativeBridge.get_$L().$32)},$7Qj:function(n){_js.Trace.logInfo(_h.$2d.$1n,"Handling FolderMappingsLoadedEvent");$6ae(this)},$7Qm:function(n){if(this.$1Ti){if(!this.$1Vc){_js.Trace.logInfo(_h.$2d.$1n,"SyncFolderEvent can only be processed after MailActivityIndicator initialization");return}this.get_$Bq().$63z(n.$2B.get_$n().Id)}},$7Ql:function(n){this.$4xf=!0;$4Ti(this)},$5gW:function(n){this.$6H.get_$48o()?this.set_$X1(!1):this.set_$X1(this.$6T.get_$rx());n&&this.$6H.$45L()},$7X2:function(n){if(n.$SU===1)if(this.$58S)_js.Trace.logInfo(_h.$2d.$1n,"ignoring invalid device id error because it has already been handled.");else{this.$58S=!0;if(this.$27.$32.$Cp)this.$27.$32.$2aY(0,"The mowa device id is not longer valid.  It may have been removed via ECP.");else if($6ad(this,n.$3C4,this.$6H.get_$3xA())){_js.Trace.logWarning(_h.$2d.$1n,"The user {0} does not have a valid device id.  Removing store and restarting.",this.$6H.get_$3xA());this.$2NR(_g.$1Q.$g,window.location,_a.NativeBridge.get_$L().$32)}else{_js.Trace.logWarning(_h.$2d.$1n,"The user {0} is not the same as the offline enabled user {1}.",n.$3C4,this.$6H.get_$3xA());var t=new _a.$4f([String.format(_u.Strings.l_OfflineUserOtherUserMessage_Text,this.$6H.get_$8Qu())],1,this.$$d_$7RT,3,!1,_u.Strings.l_OfflineUserOtherUserMessage_SignIn_Text,_u.Strings.l_OfflineUserOtherUserMessage_Cancel_Text,null);this.$S.$8oV(_a.$4f,t)}}},$7RT:function(n,t){n?this.$2NR(_g.$1Q.$g,window.location,_a.NativeBridge.get_$L().$32):this.$S.$8oV(_a.$Ko,new _a.$Ko(!1))},$7R9:function(n,t){var i=new _g.$Xn(5);this.$S.$8oV(_g.$Xn,i)}};_h.$Lx=function(n){this.$Vg=_a.$5H.$$(Object).$8M();this.$2Pt=n};function $6ao(n,t,i,r){var u=[new _h.$Lx.$7MO];var f=new _h.$Lx.$7Eu(t,r,n.$2Pt);var e=new _h.$Lx.$7F0(t,r,n.$2Pt);Array.add(u,f);Array.add(u,e);if(i!=="TouchNarrow"){Array.add(u,new _h.$Lx.$7J5(f));Array.add(u,new _h.$Lx.$7LU(e))}return u}function $4Tk(n,t,i,r){if(i===t.length)r();else{var u=this;$6ap(n,t[i],function(){$4Tk(n,t,i+1,r)})}}function $6ap(n,t,i){_js.Trace.logInfo(_a.$0.$IG,"Executing page data payload action for '"+t.get_$409()+"' variable");var r=this;t.$s(function(t){_js.Trace.logInfo(_a.$0.$IG,"Saving result to page data payload variable '"+t.get_$409()+"'");n.$Vg.set_$48(_bc.$hD.toString(t.get_$409()),t.get_$cu());i()})}_h.$Lx.prototype={$2Pt:!1,$10:function(n,t,i,r){_js.Trace.logInfo(_a.$0.$IG,"Start generatint the page data payload for layout '{0}' with '{1}' rows to load...",t,i);var u=$6ao(this,n,t,i);$4Tk(this,u,0,r)},$1Fk:function(n){return this.$Vg.get_$48(_bc.$hD.toString(n))}};_h.$Lx.$7MQ=function(n){this.$5mu=n};_h.$Lx.$7MQ.prototype={$5mu:0,$1aW:null,get_$409:function(){return this.$5mu},get_$cu:function(){return this.$1aW},set_$cu:function(n){this.$1aW=n;return n},$s:function(n){var t;var i,r;if(r=this.$9BT(i={val:t}),t=i.val,r){var u=this;t.add_$2A(function(t){u.$8ze(t);n(u)});var f=this;t.add_$20(function(t){_js.Trace.logWarning(_a.$0.$IG,"Action '"+t.$2Yv+"' failed. Clearing page data payload and moving on.");f.set_$cu(null);n(f)});OwaApplication.$1T.$y(t)}else{this.set_$cu(null);n(this)}}};_h.$Lx.$2Rz=function(n){_h.$Lx.$2Rz.$$(this.$$gta["_h.$Lx.$2Rz"].TResult).initializeBase(this,[n])};_h.$Lx.$2Rz.$$=function(n){var t="$2Rz"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$Lx[t]){var r=_h.$Lx[t]=function(){(this.$$gta=this.$$gta||{})["_h.$Lx.$2Rz"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$Lx.$2Rz.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$Lx.$7MQ);var u=_h.$Lx.$2Rz.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$Lx[t]};_h.$Lx.$2Rz.prototype={$8ze:function(n){var t=n;this.set_$cu(t.get_$cu())}};_h.$Lx.$7MO=function(){_h.$Lx.$7MO.initializeBase(this,[1])};_h.$Lx.$7MO.prototype={$9BT:function(n){n.val=new _h.$K7;return!0}};_h.$Lx.$3l3=function(n,t,i,r){_h.$Lx.$3l3.$$(this.$$gta["_h.$Lx.$3l3"].TResult).initializeBase(this,[i]);this.$56f=n;this.$uO=t;this.$2Pt=r};_h.$Lx.$3l3.$$=function(n){var t="$3l3"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$Lx[t]){var r=_h.$Lx[t]=function(){(this.$$gta=this.$$gta||{})["_h.$Lx.$3l3"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$Lx.$3l3.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$Lx.$2Rz.$$(n));var u=_h.$Lx.$3l3.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$Lx[t]};_h.$Lx.$3l3.prototype={$56f:!1,$uO:0,$2Pt:!1,get_$9JU:function(){return this.$56f},get_$45X:function(){return this.$uO},get_$B0:function(){return this.$2Pt?"NoClutter":"All"}};_h.$Lx.$7Eu=function(n,t,i){_h.$Lx.$7Eu.initializeBase(this,[n,t,3,i])};_h.$Lx.$7Eu.prototype={$9BT:function(n){if(this.get_$9JU()){n.val=null;return!1}n.val=new _h.$Uk(_g.$2Q.$9K("inbox").get_$n(),null,_h.$4t.$15Y(0,this.get_$45X()),!1,"All",this.get_$B0(),null);return!0}};_h.$Lx.$7F0=function(n,t,i){_h.$Lx.$7F0.initializeBase(this,[n,t,4,i])};_h.$Lx.$7F0.prototype={$9BT:function(n){if(!this.get_$9JU()){n.val=null;return!1}n.val=new _h.$fl(_g.$2Q.$9K("inbox").get_$n(),null,null,"MailListItem",_h.$4t.$15Y(0,this.get_$45X()),!0,"All",this.get_$B0(),null,!1,null,null);return!0}};_h.$Lx.$7LU=function(n){_h.$Lx.$7LU.initializeBase(this,[6]);this.$4wh=n};_h.$Lx.$7LU.prototype={$4wh:null,$9BT:function(n){var i=this.$4wh.get_$cu();if(!i){n.val=null;return!1}var t=i.Body.ResponseMessages.Items[0];if(!t.RootFolder.Items||!t.RootFolder.Items.length){n.val=null;return!1}var r=t.RootFolder.Items[0];n.val=new _h.$Gf(101,[r.ItemId],_h.$11.$3LX(_h.$11.get_$1HU()),"ItemNormalizedBody",2,!1);return!0}};_h.$Lx.$7J5=function(n){_h.$Lx.$7J5.initializeBase(this,[5]);this.$4wX=n};_h.$Lx.$7J5.prototype={$4wX:null,$9BT:function(n){var t=this.$4wX.get_$cu();if(!t||!t.Body.Conversations.length){n.val=null;return!1}var i=t.Body.Conversations[0];var r=_a.$7.$4Y(i.LastModifiedTime);n.val=_h.$EA.$I(101,i.ConversationId.Id,i.ConversationId.ChangeKey,20,r,_h.$11.get_$1HU(),"ItemPartUniqueBody","");return!0}};_h.$tc=function(){};_h.$tc.prototype={$I:function(n,t,i,r,u){return _h.$tc.$63p.$I(n,t,i,r,u)}};_h.$tc.$71h=function(n,t,i,r,u,f){_h.$tc.$71h.initializeBase(this,[n,t,i,r,u]);_a.$3.$M(f,"response");this.$2n=f};_h.$tc.$71h.prototype={$2n:null,$8xo:function(){this.get_$5mq().set_$1Rz(this.$2n);this.get_$2cm().set_$4wY(0)},$8kP:function(){for(var t=this.$2n.Body.Conversations,i=t,u=i.length,n=0;n<u;++n){var f=i[n];f.FolderId=this.get_$3dZ()}var r=new _e.$QM(new _e.$OA(this.get_$57(),_g.$S.get_$L().get_$1t().get_$IJ()),t,[]);r.set_$9JL(11);var e=this;r.$9JO(function(){})}};_h.$tc.$77Y=function(n,t,i,r,u,f){_h.$tc.$77Y.initializeBase(this,[n,t,i,r,u]);_a.$3.$M(f,"response");this.$2n=f};_h.$tc.$77Y.prototype={$2n:null,$8xo:function(){this.get_$5mq().set_$3Xj(this.$2n);this.get_$2cm().set_$4wi(0)},$8kP:function(){var t=this.$2n.Body.ResponseMessages.Items[0];var i=t.RootFolder.Items;var n=new _e.$RU(new _e.$gp(this.get_$57(),_g.$S.get_$L().get_$1t().get_$IJ()),i,[],[],null);n.set_$9JL(11);var r=this;n.$9JO(function(){})}};_h.$tc.$63p=function(n,t,i,r,u){_a.$3.$M(n,"pageDataPayloadAdapter");_a.$3.$M(t,"clientStore");_a.$3.$M(i,"inboxFolderId");_a.$3.$M(r,"datapoint");this.$Zt=n;this.$6T=t;this.$1TM=i;this.$Wc=r;this.$4i0=u};_h.$tc.$63p.$I=function(n,t,i,r,u){var f=JsonParser.deserialize(u.responseText);var e=f.findMailFolderItem;if(e)return new _h.$tc.$77Y(n,t,i,r,r.get_$4wg(),e);else{var o=f.findConversation;if(!o){_js.Trace.logWarning(_a.$0.$IG,"Both FindMailFolderItem and FindConversation values in the SSSD response are null");return null}return new _h.$tc.$71h(n,t,i,r,r.get_$4wW(),o)}};_h.$tc.$63p.prototype={$Zt:null,$6T:null,$1TM:null,$Wc:null,$4i0:0,get_$5mq:function(){return this.$Zt},get_$57:function(){return this.$6T},get_$2cm:function(){return this.$Wc},get_$3dZ:function(){return this.$1TM},$8kJ:function(){if(this.$4i0){this.$8xo();this.$1kb()}this.$8kP()},$1kb:function(){this.$Wc.set_$5yX((new Date).toString());_js.Trace.logInfo(_a.$0.$IG,"SSSD receive time = {0}, Reload notification time = {1}",this.get_$2cm().get_$5yW(),this.get_$2cm().get_$5yX());_e.$2a.$2hL(this.$1TM.Id,"SSSD",!1);_a.$m.$38y++}};function OfflineBootComponent(){}OfflineBootComponent.prototype={$1QB:function(n,t,i){var r=this;n.$9V(_h.$2d).$9Iy(IOfflineManager).$9Iz().$9J0(function(){return new _h.$2d(n.$5uT(_bc.$gN),n.$5uT(IClientStore),n.$5uT(_a.$o),n.$5uT(_0365f.$M),n.$5uT(_h.$OX),n.$5uT(_a.NativeBridge),n.$9HY(ISyncFolderSettingProcessor),n.$9HY(ISyncManagerFactory),n.$9HY(INotificationHandlerProxyFactory),n.$5uT(_a.$5X),n.$5uT(_g.$g9))});var u=this;n.$9V(_h.$pJ).$9Iy(IAppStatusBarViewModel).$9Iz().$9J0(function(){return new _h.$pJ(n.$5uT(_h.$6Z))});var f=this;n.$9V(_h.$9S).$9Iz().$9J0(function(){return new _h.$9S(n.$5uT(_0365f.$M),n.$5uT(_h.$2d).$6H,n.$5uT(_js.$Cm),n.$5uT(_a.$aE),OwaApplication.$1fW)});var e=this;n.$9V(_h.$6Z).$9Iz().$9J0(function(){return new _h.$6Z(n.$5uT(_0365f.$M),n.$5uT(_a.$o),n.$5uT(_h.$2d).$6H,n.$5uT(_js.$Cm),n.$5uT(_a.$aE),n.$5uT(_h.$2d).$AS,n.$5uT(_h.$9S),n.$5uT(_h.$2d).$1Vc)});var o=this;n.$9V(_h.$Lx).$9Iy(IPageDataPayloadGenerator).$9J0(function(){return new _h.$Lx(n.$5uT(_g.$4H).get_$1t().get_$KR())});var s=this;n.$9V(_h.$tc).$9Iy(IPageDataPayloadPersisterFactory).$9J0(function(){return new _h.$tc})},$7Is:function(){return[]}};_h.$pJ.registerClass("_h.$pJ",_a.$ER,IAppStatusBarViewModel);_h.$eC.registerClass("_h.$eC");_h.$9S.registerClass("_h.$9S");_h.$6Z.registerClass("_h.$6Z",_js.$9);_h.$I7.registerClass("_h.$I7",_h.$Ou,_h.$rj,_h.$1B2,Sys.IDisposable);_h.$43.registerClass("_h.$43",_h.$Ou,_h.$s4,_h.$1B2,Sys.IDisposable);_h.$2d.registerClass("_h.$2d",_js.$yd,IOfflineManager,Sys.IDisposable);_h.$Lx.registerClass("_h.$Lx",null,IPageDataPayloadGenerator);_h.$Lx.$7MQ.registerClass("_h.$Lx.$7MQ");_h.$Lx.$7MO.registerClass("_h.$Lx.$7MO",_h.$Lx.$2Rz.$$(_g.$JU));_h.$Lx.$7Eu.registerClass("_h.$Lx.$7Eu",_h.$Lx.$3l3.$$(_g.$Mk));_h.$Lx.$7F0.registerClass("_h.$Lx.$7F0",_h.$Lx.$3l3.$$(_g.$OL));_h.$Lx.$7LU.registerClass("_h.$Lx.$7LU",_h.$Lx.$2Rz.$$(_g.$OP));_h.$Lx.$7J5.registerClass("_h.$Lx.$7J5",_h.$Lx.$2Rz.$$(_g.$OO));_h.$tc.registerClass("_h.$tc",null,IPageDataPayloadPersisterFactory);_h.$tc.$63p.registerClass("_h.$tc.$63p",null,_bc.$1B7);_h.$tc.$71h.registerClass("_h.$tc.$71h",_h.$tc.$63p);_h.$tc.$77Y.registerClass("_h.$tc.$77Y",_h.$tc.$63p);OfflineBootComponent.registerClass("OfflineBootComponent",null,_a.$1C3);_h.$I7.$D=_a.$0.$DO;_h.$43.$3ln=0;_h.$43.$D=_a.$0.$DO;_h.$2d.$1n=_a.$0.$DO