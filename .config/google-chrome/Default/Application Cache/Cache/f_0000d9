Type.registerNamespace("_cc");function CalendarCoreComponent(){}CalendarCoreComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_cc.$1Q).$A5F().$A5G(function(){_cc.$1Q.get_$I().$41o=n.$6OW(_a.$3O).$3u("ModernGroups");return _cc.$1Q.get_$I()});var u=this;n.$Ad(_cc.$oe).$A5F().$A5G(function(){return new _cc.$oe(n.$6OW(_a.$43))});var f=this;n.$Ad(_cc.$IQ).$A5F().$A5E(_cc.$R1).$A5G(function(){var t=n.$6OW(_a.$3O);return new _cc.$IQ(t.$3u("CalendarEventSearch")||t.$3u("CalendarSearchAndPin")?10:5,n.$6OW(_cc.$1Q),n.$6OW(_cc.$Pz),n.$6OW(_js.$CQ))});var e=this;n.$Ad(_cc.$Pz).$A5F().$A5G(function(){return new _cc.$Pz(i.get_$9p(),i.get_$VR()==="AnonymousCalendar",n.$6OW(_g.$44),n.$6OW(_a.$43))});var o=this;n.$Ad(_cc.$My).$A5F().$A5G(function(){return new _cc.$My(n.$6OW(_cc.$R1).get_$IS(),n.$6OW(_cc.$oe),n.$6OW(_cc.$1Q),n.$6OW(_js.$CQ))})},$7sM:function(){return null}};_cc.$17K=function(){};_cc.$17K.registerInterface("_cc.$17K");_cc.$17L=function(){};_cc.$17L.registerInterface("_cc.$17L");_cc.$1Fa=function(){};_cc.$1Fa.registerInterface("_cc.$1Fa");_cc.$i8=function(){};_cc.$i8.prototype={invalid:0,Day:1,Week:2,WorkWeek:3,Month:4,Agenda:5,Miniature:6};_cc.$i8.registerEnum("_cc.$i8",!1);_cc.$R1=function(){};_cc.$R1.registerInterface("_cc.$R1");_cc.$EV=function(){this.$8w=String.format(_u.Strings.l_CalendarActionDefaultError_Text,-1);_cc.$EV.$$(this.$$gta["_cc.$EV"].T).initializeBase(this);_cc.$EV.$$(_g.$F6).$68P&&this.add_$2m(_cc.$EV.$$(_g.$F6).$68P)};_cc.$EV.$$=function(n){var i="$EV"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_cc[i]){var t=_cc[i]=function(){(this.$$gta=this.$$gta||{})["_cc.$EV"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_cc.$EV.apply(this,i)};t.registerClass("_cc."+i,_h.$F3.$$(n));var u=_cc.$EV.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$A6b=function(n){_cc.$EV.$$(_g.$F6).$68P=n};t.$3u7=function(n){return _h.$Mv.$3sf(n)};t.$68P=null}return _cc[i]};_cc.$EV.prototype={get_$cH:function(){return this.$8w},$6Kg:function(n,t,i){if(!n.WasSuccessful){this.$8w=_cc.$EV.$$(this.$$gta["_cc.$EV"].T).$3u7(n.ErrorCode);i(Error.create(this.$8w));return}try{this.$26f(n)}catch(r){i(r);return}t()}};_cc.$5g=function(){};_cc.$5g.$1C0=function(n,t){_cc.$5g.$3sU(n.$1f,t)};_cc.$5g.$3sU=function(n,t){if(!n){_js.Trace.logError(_cc.$5g.$A,"Action shouldn't fail without an error.");_cc.$5g.$6XR(t);return}var u;var e;var i=null;var c,l,a;(a=_h.$BF.$2xT(n,c={val:e},l={val:i}),e=c.val,i=l.val,a)?_js.Trace.logWarning(_cc.$5g.$A,"Offline service command rejected with the following rejection error code: {0}",_bc.$lF.toString(e)):i=n;var o;var f;var r="";var v,y,p,w;if(w=_cc.$5g.$82l(i,v={val:o},y={val:u},p={val:f}),o=v.val,u=y.val,f=p.val,w)if(o){r=_h.$BF.$7xA(f);if(r===""){r=_ucc.CalCoreStrings.l_DefaultResponseCodeError_Text;var s=String.format("Action finished with an unknown response code: {0}. Status code {1}",f,u);$6(i.message)||i.message===""||(s=s+String.format(" Server message: {0}",i.message));_js.Trace.logWarning(_cc.$5g.$A,s)}}else r=_h.$BF.$7yB(u);if(r===""){var h=String.format("Action failed with an unknown error format.");$6(i.message)||i.message===""||(h=h+String.format(" Server message: {0}",i.message));_js.Trace.logError(_cc.$5g.$A,h);_cc.$5g.$6XR(t);return}var b=_ucc.CalCoreStrings.l_ErrorCalendarActionFailed_Text;var k=[b,r];_a.$4b.$V6(k,0,t)};_cc.$5g.$82l=function(n,t,i,r){i.val=0;t.val=!1;r.val="NoError";if(_cc.$5g.$82e(n,i)){if(i.val>=200&&i.val<300){t.val=!0;r.val="ErrorInternalServerError"}return!0}var u=n[_cc.$5g.$3SO];if(u===_g.$3x.dataContractName){t.val=!0;r.val=_cc.$5g.$5SA(n);return!0}return!1};_cc.$5g.$5SA=function(n){var t=n[_cc.$5g.$6Og];if($6(t)){_js.Trace.logWarning(_cc.$5g.$A,"Server exception doesn't contain a response code.");return"ErrorInternalServerError"}return t};_cc.$5g.$6XR=function(n){var t=[_ucc.CalCoreStrings.l_ErrorCalendarActionFailed_Text,_u.Strings.l_UnknownConnectionError_Text];_a.$4b.$V6(t,0,n)};_cc.$5g.$82e=function(n,t){t.val=n[_cc.$5g.$6Z6];return $6(t.val)?!1:!0};_cc.$uw=function(n,t,i){_cc.$uw.initializeBase(this);_a.$4.$1G(n,"parentGroupId");this.$YV=t;this.$66l=i};_cc.$uw.prototype={$YV:null,$66l:null,$5ZC:function(n){var t=_g.$9G.isInstanceOfType(this.$YV)?this.$YV.get_$D2():null;n.$2pc(this.$YV.get_$Bd(),this.$YV.get_$o1(),t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){if(_g.$Ej.isInstanceOfType(this.$YV)){this.$66l.set_$r(n.NewFolderId);this.$YV.set_$vD(n.NewFolderId)}this.$YV.set_$i(n.NewCalendarEntryId)}};_cc.$9e=function(n,t,i,r){_cc.$9e.initializeBase(this,[1]);_a.$4.$J(n,"item");this.set_$3q(n);this.set_$6SR(t);this.$Po=_cc.$9e.$Rr;$6(n.get_$28())||(this.$oM=_g.$28.$Z7(n.get_$28()));this.$cJ=r;this.$Qc=i;this.$Eo="CreateCalendarItemAction"};_cc.$9e.$3EL=function(n){if(n)for(var t=0;t<n.length;t++){var i=n[t];i.Mailbox.ItemId&&(i.Mailbox.ItemId.ChangeKey=null)}return n};_cc.$9e.$7Sp=function(n){var t=new _g.$6O;$6(n.get_$i())||(t.ItemId=n.get_$i());t.Subject=n.get_$2i();if(n.get_$3C()){var i=n.get_$3C().get_$3n();i||(i="Text");t.Body=new _g.$6R(i,n.get_$3C().get_$1g())}$6(n.get_$84())?n.set_$84("Normal"):t.Sensitivity=n.get_$84();n.get_$6J()&&n.get_$6J().get_$B()>0&&(t.Categories=n.get_$6J().$6Z());t.ReminderIsSet=n.get_$QH();t.ReminderMinutesBeforeStart=n.get_$tc();t.IsResponseRequested=!!n.get_$Du();t.IsAllDayEvent=$6(n.get_$5V())?!1:n.get_$5V();n.get_$y()&&(t.Start=n.get_$y().$99());n.get_$1u()&&(t.End=t.IsAllDayEvent?n.get_$1u().$4F().$2o(1).$99():n.get_$1u().$99());$6(n.get_$9S())||(t.FreeBusyType=n.get_$9S());n.get_$7S()&&n.get_$7S().get_$B()>0&&(t.RequiredAttendees=_cc.$9e.$3EL(n.get_$7S().get_$1rl()));n.get_$8W()&&n.get_$8W().get_$B()>0&&(t.OptionalAttendees=_cc.$9e.$3EL(n.get_$8W().get_$1rl()));n.get_$9F()&&n.get_$9F().get_$B()>0&&(t.Resources=_cc.$9e.$3EL(n.get_$9F().get_$1rl()));var r=_cc.$9e.$7T0(n);r&&(t.Recurrence=r);var u=_g.$3Y.$3fq(n.get_$4j());u&&(t.Location=u);n.get_$mc()&&n.get_$mc().get_$B()>0&&(t.InboxReminders=n.get_$mc().get_$1rl());_h.$3F.$4Ut(t,n);return t};_cc.$9e.$7eb=function(){var n=new _g.$DM("IdOnly");n.AdditionalProperties=[new _g.$1X("InstanceKey")];return n};_cc.$9e.$7T0=function(n){var i=null;var t=n;t&&t.get_$1Se()&&(i=_g.$FY.$58F(t.get_$1Se()));return i};_cc.$9e.prototype={$Qc:null,$cJ:null,$5N:null,$2Wd:null,get_$3q:function(){return this.$U(_cc.$9e.$14Y)},set_$3q:function(n){this.$K(_cc.$9e.$14Y,n);return n},get_$6SR:function(){return this.$U(_cc.$9e.$4UF)},set_$6SR:function(n){this.$K(_cc.$9e.$4UF,n);return n},$G3:function(){var n=_h.$1Ku.prototype.$G3.call(this);n.userDisplayName=_g.$V.get_$I().get_$31().get_$FS();n.userEmailAddress=_g.$V.get_$I().get_$31().get_$Aj();n.calendarFolderId=new _g.$3S(_g.$h.$1i.nameToId("calendar").Id);n.explicitLogonUser=this.$cJ;return n},$2He:function(){var n=_h.$1Ku.prototype.$2He.call(this);n.Body.SendMeetingInvitations=_h.$Zr.toString(this.get_$6SR());return n},$5Et:function(){this.$2Wd=_cc.$9e.$7Sp(this.get_$3q());return[this.$2Wd]},$4Os:function(n){this.$5N=n.Items[0].ItemId;this.get_$3q().set_$i(n.Items[0].ItemId);var i=this.$Qc;var u;var f,e;if(!i||!i.$8p||this.$2Wd.Recurrence||(e=i.$2uA(this.$5N.Id,f={val:u}),u=f.val,e))this.$2Wd.Recurrence&&i&&_cc.$S1.isInstanceOfType(i)&&i.$3KF();else{var t=new _g.$33(this.$2Wd);t.set_$i(n.Items[0].ItemId);t.set_$28(this.get_$3q().get_$28());t.set_$TM("Organizer");t.set_$I2(!0);t.set_$4S(3);t.set_$W0(t.get_$5LX());t.set_$G9(!!t.get_$1N()&&t.get_$1N().get_$B()>0);t.set_$Ea(n.Items[0].InstanceKey);var r=new _g.$Qg;r.Read=!0;r.Modify=!0;r.Delete=!0;r.ViewPrivateItems=!0;t.set_$K4(r);i.$8p.$2lv(t.get_$y(),t.get_$1u())&&i.$2kU(t)}}};_cc.$ux=function(n){_cc.$ux.initializeBase(this);this.$2WV=n};_cc.$ux.prototype={$2WV:null,$5ZC:function(n){n.$2pd(this.$2WV.get_$Vr(),null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$2WV.set_$8k(n.NewGroupClassId);this.$2WV.set_$i(n.NewGroupItemId)}};_cc.$v4=function(n,t,i){_cc.$v4.initializeBase(this);this.$2nc=n;this.$16Y=t;this.$2U=i};_cc.$v4.prototype={$2nc:null,$16Y:null,$2U:null,$5ZC:function(n){var t=new _g.$1q(this.$2nc.get_$i().Id);t.ChangeKey=this.$2nc.get_$i().ChangeKey;n.$3mx(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$2U.$3KI(this.$16Y,this.$2nc)}};_cc.$v5=function(n){_cc.$v5.initializeBase(this);this.$8x=n};_cc.$v5.prototype={$8x:null,$5ZC:function(n){n.$3my(this.$8x.get_$8k(),null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){}};_cc.$og=function(n){this.$$d_$9RZ=Function.createDelegate(this,this.$9RZ);_cc.$og.initializeBase(this);_a.$4.$J(n,"requestedLinkedCalendar");this.$27R=n};function $6nz(n,t){var i;if(t.get_$rL()){var r=new _g.$7P("calendar");r.Mailbox=new _g.$1l;r.Mailbox.EmailAddress=n.$27R.get_$D2();i=r}else i=new _g.$3S(n.$27R.get_$A5().Id);return i}_cc.$og.prototype={$27R:null,$595:null,$2oB:null,$43k:!1,$5ZC:function(n){var t=new _g.$WW;t.FolderId=$6nz(this,this.$27R);n.$2vP(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$595=new _g.$Sj(n.CalendarFolder);n.MasterList&&(this.$2oB=new _g.$Bs(n.MasterList));this.$43k=!0},$9RZ:function(n){this.get_$gq()&&(this.$43k=this.get_$gq().ErrorCode===31);_h.$F3.prototype.$9RZ.call(this,n)}};_cc.$GW=function(n,t){_cc.$GW.initializeBase(this,[n,[t.get_$i()],null,"FullCalendarItem",1,t.$1jI==="discoveryMailboxMode"]);var i=_a.$6.acss(_a.$0.$1k,"GetCalendarItemAction");this.$t=null;this.$Nq=t;this.$Eo="GetCalendarItem";this.$Po=t.$1KL==="Text"?_h.$15.get_$7qO():_h.$15.get_$5Ot();t.$1jI==="unblockMode"&&(this.$Po.BlockExternalImagesIfSenderUntrusted=!1);_a.$6.aces(i)};_cc.$GW.$G3=function(n,t,i,r,u){i=$6(i)?_cc.$GW.$5HL:i;r=$6(r)?"defaultMode":r;u=$6(u)?0:u;n=t?new _h.$7U(n):n;return new _cc.$oh(n,i,r,u)};_cc.$GW.$97P=function(n){if(n.get_$I2()&&n.get_$7S())for(var u=n.get_$FE().Mailbox.EmailAddress.toLowerCase(),t=0;t<n.get_$7S().get_$B();t++){var i=n.get_$7S().get_$3q(t).get_$7B().EmailAddress;if(i&&i.toLowerCase()===u){var r=n.get_$7S().$3p();_js.Trace.logInfo(_a.$0.$6y,"Normalizing the RequiredAttendees Collection.");r.$68(t);n.set_$7S(r);break}}};function $6o0(n,t){}_cc.$GW.prototype={$Nq:null,$t:null,$4Os:function(n){var i=_a.$6.acss(_a.$0.$6y,"ProcessResponseMessage:GetCalItem");var t=new _g.$33(n.Items[0]);t.set_$4S(2);(this.$Nq.$1jI==="discoveryMailboxMode"||this.$Nq.$1jI==="archiveMode")&&t.set_$1Kb(!0);OwaApplication.$1Jv||_cc.$GW.$97P(t);t.$3NN();this.$t=t;$6o0(this,this.$t);_a.$6.aces(i)}};_cc.$oh=function(n,t,i,r){this.$5N=n;this.$1KL=t;this.$1jI=i;this.$58T=r;this.$59=$6o1(this)};function $6o1(n){var t=_g.$7U.isInstanceOfType(n.$5N)?_g.$7U.getName():_g.$1q.getName();var i=$6(n.$1KL)?"":n.$1KL;var r=$6(n.$1jI)?"":n.$1jI;return String.format("{0}_{1}_{2}_{3}",n.get_$i().Id,t,i,r)}_cc.$oh.prototype={$5N:null,$59:null,$1KL:"Best",$1jI:"defaultMode",$58T:0,get_$i:function(){return this.$5N}};_cc.$I4=function(){_cc.$I4.initializeBase(this)};_cc.$I4.$$cctor=function(){_cc.$I4.$Rr=new _g.$DM("IdOnly");_cc.$I4.$Rr.AdditionalProperties=[new _g.$1X("ItemParentId"),new _g.$1X("Sensitivity"),new _g.$1X("AppointmentState"),new _g.$1X("IsCancelled"),new _g.$1X("HasAttachments"),new _g.$1X("LegacyFreeBusyStatus"),new _g.$1X("CalendarItemType"),new _g.$1X("Start"),new _g.$1X("End"),new _g.$1X("IsAllDayEvent"),new _g.$1X("Organizer"),new _g.$1X("Subject"),new _g.$1X("IsMeeting"),new _g.$1X("UID"),new _g.$1X("InstanceKey"),new _g.$1X("ItemEffectiveRights"),new _g.$1X("JoinOnlineMeetingUrl"),new _g.$1X("ConversationId"),new _g.$1X("CalendarIsResponseRequested"),new _g.$1X("Categories"),new _g.$1X("IsRecurring"),new _g.$1X("IsOrganizer"),_g.$l.get_$4j(),new _g.$1X("IsSeriesCancelled")]};_cc.$I4.prototype={$2uD:null,$5ZC:function(n){_cc.$oi.prototype.$5ZC.call(this,n);$6(this.get_$r())&&this.set_$r(_g.$h.$1i.nameToId("calendar"));var i=new _g.$Kl(_cc.$I4.$Rr,"Shallow");i.ParentFolderIds=[_g.$28.$S9(this.get_$r())];if(_g.$11z.isInstanceOfType(this.get_$3HL()))i.Paging=this.get_$3HL();else if(_h.$4e.isInstanceOfType(this.get_$3HL())){var r=this.get_$3HL();var u=new _g.$KX(r.$2Q.$99(),r.$3D.$99());i.Paging=u}else throw Error.invalidOperation("Unsupported paging type");var t=new _g.$9E(this.$2D);t.isAutomated=this.get_$88P();t.isReload=this.get_$1cr();t.actionName=this.get_$1qN()?"GetCalendarItemsAction_"+_cc.$i8.toString(this.get_$1qN()):"GetCalendarItemsAction";var f=new _g.$Lk(this.get_$6u(),i);_js.Trace.logInfo(_a.$0.$6y,String.format("FindItem paging: {0}",Object.getType(this.get_$3HL()).getName()));this.$2uD=t;n.$2Kj(f,t,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){if(!$6(n.RootFolder)&&!$6(n.RootFolder.Items)){var i=_a.$6.acss(_a.$0.$6y,"ProcessResponseMessages:FindItem_"+n.RootFolder.Items.length);this.get_$1XI().$1r();for(var t=0;t<n.RootFolder.Items.length;t++)this.$A6o(n.RootFolder.Items[t]);_a.$6.aces(i)}}};_cc.$oi=function(){this.$3gi=0;_cc.$oi.$$(this.$$gta["_cc.$oi"].TResult,this.$$gta["_cc.$oi"].TResponseMessage).initializeBase(this)};_cc.$oi.$$=function(n,t){var i="$oi"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_cc[i]){var u=_cc[i]=function(){(this.$$gta=this.$$gta||{})["_cc.$oi"]={TResult:n,TResponseMessage:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_cc.$oi.apply(this,r)};u.registerClass("_cc."+i,_h.$JQ.$$(n,t),_cc.$17K);var f=_cc.$oi.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _cc[i]};_cc.$oi.prototype={$5Zm:!1,$2k:null,$3gM:null,$6Ga:null,$1OP:!1,$9Td:null,$1yV:!1,get_$r:function(){return this.$2k},set_$r:function(n){this.$2k=n;return n},get_$1XI:function(){return this.$3gM},set_$1XI:function(n){this.$3gM=n;return n},get_$3HL:function(){return this.$6Ga},set_$3HL:function(n){this.$6Ga=n;return n},get_$88P:function(){return this.$5Zm},set_$88P:function(n){this.$5Zm=n;return n},get_$1qN:function(){return this.$3gi},set_$1qN:function(n){this.$3gi=n;return n},get_$1cr:function(){return this.$1yV},set_$1cr:function(n){this.$1yV=n;return n},get_$3jk:function(){return this.$A6R()},$5ZC:function(n){},$A6o:function(n){var t=new _g.$33(n);this.$3gM.$D(t)},$6Kf:function(n){this.$1OP?this.$9Td=n:_h.$JQ.prototype.$6Kf.call(this,n)}};_cc.$15H=function(n,t){_cc.$15H.initializeBase(this);this.$fv=n;this.$6VU=t};_cc.$15H.prototype={$fv:null,$6VU:!1,$58s:null,$58r:null,$2r6:null,$1qG:null,$6Fz:null,$5ZC:function(n){var t=new _g.$15B(this.$2D);n.$1ua(t,this.$$d_$A6H,this.$$d_$9RZ)},$6D0:function(){if(PageDataPayload.calendarFolders){this.$26f(PageDataPayload.calendarFolders);OwaApplication.$1Jv||(PageDataPayload.calendarFolders=null);return!0}return!1},$26f:function(n){var p=_a.$6.acss(_a.$0.$1k,"ProcessResponse:GetCalendar");var i;var e;var t;var r;this.$1qG=new _js.$Z;var f={};var v={};var o={};var s;this.$fv&&(o[this.$fv.toLowerCase()]=!0);for(var h=0;h<n.CalendarGroups.length;h++){i=new _cc.$6x;i.$QR(n.CalendarGroups[h]);switch(i.get_$ql()){case 0:i.set_$Vr(_ucc.CalCoreStrings.l_CalendarPicker_MyCalendarsGroupName_Text);break;case 1:i.set_$Vr(_ucc.CalCoreStrings.l_CalendarPicker_OtherCalendarsGroupName_Text);this.$6Fz=i;break;case 2:i.set_$Vr(_ucc.CalCoreStrings.l_CalendarPicker_PeoplesCalendarsGroupName_Text);break}if(i.get_$Cp())for(var c=i.get_$Cp().get_$B()-1;c>=0;c--){t=i.get_$Cp().get_$3q(c);if(t.get_$1c1()){this.$2r6=t;this.$2r6.set_$Bd(_ucc.CalCoreStrings.l_CalendarPicker_DefaultCalendarName_Text)}else if(_g.$9G.isInstanceOfType(t)){r=t;if(r.get_$1yD())continue;r.set_$D2(r.get_$D2().toLowerCase());if(this.$6VU&&r.get_$Xs()){i.get_$Cp().$34(t);continue}s=r.get_$rL()?r.get_$D2():r.get_$4VR().Id;if(s in o){i.get_$Cp().$34(t);continue}o[s]=!0;var y=new _g.$Sh;y.FolderId=t.get_$A5();var l=new _g.$Sj(y);l.set_$1o(t.get_$Bd());var u=new _g.$Qg;u.CreateAssociated=u.CreateContents=u.CreateHierarchy=u.Read=u.Modify=u.ViewPrivateItems=!1;l.set_$K4(u);f[t.get_$A5().Id]=l}v[t.get_$A5().Id]=t;t.set_$1K6(t.get_$bv())}this.$1qG.$D(i)}for(var a=0;a<n.CalendarFolders.length;a++){e=new _g.$Sj(n.CalendarFolders[a]);f[e.get_$r().Id]=e}var w=f[this.$2r6.get_$A5().Id];w.set_$1BR("calendar");this.$58s=f;this.$58r=v;_a.$6.aces(p)}};_cc.$C7=function(n,t,i){_cc.$C7.initializeBase(this,[n]);var r=_a.$6.acss(_a.$0.$1k,"GetExpandedCalendarItemAction");this.set_$1Cl(null);this.set_$1y(t);i&&(this.$28e=i);_a.$6.aces(r)};_cc.$C7.get_$6Ol=function(){_cc.$C7.$Rr||(_cc.$C7.$Rr=_cc.$I4.$Rr);return _cc.$C7.$Rr};_cc.$C7.prototype={$28e:null,get_$1Cl:function(){return this.$U(_cc.$C7.$3yV)},set_$1Cl:function(n){this.$K(_cc.$C7.$3yV,n);return n},get_$1y:function(){return this.$U(_cc.$C7.$1Cb)},set_$1y:function(n){this.$K(_cc.$C7.$1Cb,n);return n},$5ZC:function(n){var t;var i=null;if(this.get_$1y().$3qQ)t=i=new _g.$bM(this.get_$1y().$3qQ.$99());else{t=new _g.$eK;t.Start=this.get_$1y().$ED.$2Q.$99();t.End=this.get_$1y().$ED.$3D.$99()}t.Count=this.get_$1y().$5ju;var r=new _g.$Uk(this.get_$1y().Id);i?r.ExpandAroundDateOccurrenceRange=i:r.Ranges=[t];var f=new _g.$P9(_cc.$C7.get_$6Ol());f.ItemIds[0]=r;var e=new _g.$P8(this.get_$6u(),f);var u=new _g.$Wl(this.$2D);u.clientStoreItem=1;u.actionName="GetExpandedCalendarItemAction";n.$3x(e,u,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){throw Error.notImplemented("Messages are processed in ProcessResponseMessages method.");},$6Kf:function(n){var u=_a.$6.acss(_a.$0.$6y,"ProcessResponseMessages:GetExpandedCalendarItemAction");if(!n.length||n[0].ResponseClass==="Error")throw Error.create("GetExpandedCalendarItemAction failed.");if(n.length>0&&n[0].ResponseClass==="Success"){var t=n[0];if(t.Items.length>1){this.set_$1Cl(new _cc.$Zq);for(var i=1;i<t.Items.length;i++){var r=new _g.$33(t.Items[i]);r.set_$4S(0);this.get_$1Cl().$D(r)}}}_a.$6.aces(u)}};_cc.$w5=function(n){this.$4dC=new(_a.$3X.$$(String));this.$1VT=new(_a.$3X.$$(_g.$SR));_cc.$w5.initializeBase(this);this.$1Tp=n;this.$4dC.$D(n.get_$D2())};_cc.$w5.prototype={$1Tp:null,get_$4R3:function(){return this.$4dC},get_$6gk:function(){return this.$1VT},$5ZC:function(n){var o=_a.$6.acss(_a.$0.$1k,"GetSharedCalendarItemsRequest:PreProcessing");_cc.$oi.prototype.$5ZC.call(this,n);var t=new _g.$Lq(this.get_$6u());var u=new Array(1);var f=u[0]=new _g.$M9;f.Email=new _g.$Le;f.Email.Address=this.$1Tp.get_$D2();var i=new _g.$Lm;i.RequestedView="Detailed";var e=this.get_$3HL();i.TimeWindow=new _g.$Ld(_a.$7.$EZ(e.$2Q),_a.$7.$EZ(e.$3D));t.Body.MailboxDataArray=u;t.Body.FreeBusyViewOptions=i;var r=new _g.$w7(this.$2D);r.isAutomated=this.get_$88P();r.actionName=this.get_$1qN()?"GetSharedCalendarItemsAction_"+_cc.$i8.toString(this.get_$1qN()):"GetSharedCalendarItemsAction";_a.$6.aces(o);_a.$6.acsa(_a.$0.$1k,"GetUserAvailabilityInternalRequest");n.$2wc(t,r,this.$$d_$A6H,this.$$d_$9RZ)},$TA:function(){_a.$2p.prototype.$TA.call(this);_a.$6.acea(null,"GetUserAvailabilityInternalRequest");_js.Trace.logWarning(_a.$0.$6y,"Unable to fetch calendar data for user: "+this.$1Tp.get_$D2())},$7cL:function(n,t){var u=_h.$JQ.prototype.$7cL.call(this,n,t);if(!u){var f=t.get_$A5s()[0];var i=f.Responses;if(!i||i.length!==1||!i[0].ResponseMessage)return Error.create("GetSharedCalendarItemsAction received malformed response.",n);var r=i[0].ResponseMessage;if(r.ResponseClass!=="Success"||r.ResponseCode!=="NoError"){n.responseCode=r.ResponseCode;return Error.create(r.MessageText,n)}}return u},$4Os:function(n){_a.$6.acea(null,"GetUserAvailabilityInternalRequest");var u=_a.$6.acss(_a.$0.$6y,"ProcessResponseMessages:GetUserAvailabilityInternal");this.get_$1XI().$1r();var t=n.Responses[0].CalendarView;var r=t.WorkingHours;if(r)this.$1VT.$D(new _g.$SR(r));else{_js.Trace.logInfo(_a.$0.$6y,"Unable to fetch working hours for user: "+this.$1Tp.get_$D2());this.$1VT.$D(null)}this.$1Tp.$5Og=t.FreeBusyViewType==="Detailed"?"Detailed":"FreeBusy";for(var i=0;i<t.Items.length;i++)this.$A6o(t.Items[i]);_a.$6.aces(u)}};_cc.$zZ=function(n,t,i){_cc.$zZ.initializeBase(this);_a.$4.$l(n,"calendarToRename");_a.$4.$1G(t,"newCalendarName");_a.$4.$l(i,"calendarsCache");this.$1XK=n;this.$3E3=t;this.$2U=i};_cc.$zZ.prototype={$1XK:null,$3E3:null,$2U:null,$5ZC:function(n){var t=new _g.$1q(this.$1XK.get_$i().Id);t.ChangeKey=this.$1XK.get_$i().ChangeKey;n.$3KY(t,this.$3E3,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$1XK.get_$i().ChangeKey=n.NewCalendarEntryId.ChangeKey;this.$1XK.set_$Bd(this.$3E3);if(_g.$Ej.isInstanceOfType(this.$1XK)){var i=this.$1XK;if(this.$2U.get_$I1()){var t=this.$2U.$wW(i.get_$A5());if(!$6(t)){t.get_$r().ChangeKey=n.NewFolderId.ChangeKey;t.set_$1o(this.$3E3)}}}}};_cc.$za=function(n,t){_cc.$za.initializeBase(this);this.$2G5=n;this.$4HI=t};_cc.$za.prototype={$2G5:null,$4HI:null,$5ZC:function(n){var t=new _g.$1q(this.$2G5.get_$i().Id);t.ChangeKey=this.$2G5.get_$i().ChangeKey;n.$3KZ(t,this.$4HI,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$2G5.set_$Vr(this.$4HI);this.$2G5.get_$i().ChangeKey=n.NewGroupItemId.ChangeKey}};_cc.$Fg=function(n,t,i,r,u,f){_cc.$Fg.initializeBase(this,[1]);this.$2X2=n;this.$24U=t;this.$4UE=i;this.$5dZ=r;this.$Qc=u;this.$cJ=f;this.$Eo="UpdateCalendarItemAction";var e=n;$6(e.get_$28())||(this.$oM=_g.$28.$Z7(e.get_$28()))};_cc.$Fg.$7qr=function(n){if($6(n))return new _g.$Ee(new _g.$1X("Recurrence"));var t=new _g.$6z(new _g.$1X("Recurrence"));var i=new _g.$6O;i.Recurrence=_g.$FY.$58F(n);t.Item=i;return t};_cc.$Fg.$7qp=function(n){var t=new _g.$6z(new _g.$1X("EnhancedLocation"));var i=new _g.$6O;i.Location=_g.$3Y.$3fq(n);t.Item=i;return t};_cc.$Fg.$3sN=function(n,t){if(!t||!t.get_$B())return new _g.$Ee(new _g.$1X(n));var r=_cc.$9e.$3EL(t.get_$1rl());var u=new _g.$6z(new _g.$1X(n));var i=new _g.$6O;n==="RequiredAttendees"?i.RequiredAttendees=r:n==="OptionalAttendees"?i.OptionalAttendees=r:i.Resources=r;u.Item=i;return u};_cc.$Fg.$7qo=function(n){var t=new _g.$1X("Categories");if(!n||!n.get_$B())return new _g.$Ee(t);var u=n.$6Z();var i=new _g.$6z(t);var r=new _g.$6O;r.Categories=u;i.Item=r;return i};_cc.$Fg.$7qq=function(n){if(!n||!n.get_$B())return new _g.$Ee(new _g.$1X("InboxReminders"));var t=new _g.$6z(new _g.$1X("InboxReminders"));var i=new _g.$6O;i.InboxReminders=n.get_$1rl();t.Item=i;return t};_cc.$Fg.$9x8=function(n,t){t.val=null;if(!n||!n.get_$B())return!1;for(var i=new(_0365f.$o.$$(_g.$1B8)),u=0;u<n.get_$B();u++){var h=n.get_$3q(u);var r;var f,e;if(e=_h.$7z.$4bm(h,f={val:r}),r=f.val,e){var o=new _g.$6O;var s=new _g.$6z(r.ExtendedFieldURI);_h.$3F.$1kQ(o,r);s.Item=o;i.$D(s)}}i.get_$B()>0&&(t.val=i.$6Z());return i.get_$B()>0};function $6o3(n,t,i){var r=[];if(t.get_$2i()!==i.get_$2i()){var s=new _g.$6z(new _g.$1X("Subject"));var h=new _g.$6O;h.Subject=i.get_$2i();s.Item=h;Array.add(r,s)}if(i.get_$5Uo()){var c=new _g.$6z(new _g.$1X("Body"));var l=new _g.$6O;l.Body=new _g.$6R(i.get_$3C().get_$3n()==="HTML"?"HTML":"Text",i.get_$3C().get_$1g());c.Item=l;Array.add(r,c)}_g.$y.$56C(t.get_$6J(),i.get_$6J())&&Array.add(r,_cc.$Fg.$7qo(i.get_$6J().get_$A5d()));if(i.get_$JW()&&t.get_$Du()!==i.get_$Du()){var a=new _g.$6z(new _g.$1X("CalendarIsResponseRequested"));var v=new _g.$6O;v.IsResponseRequested=i.get_$Du();a.Item=v;Array.add(r,a)}var kt=!_a.$7.$4N(t.get_$y(),i.get_$y());var dt=!_a.$7.$4N(t.get_$1u(),i.get_$1u());var gt=t.get_$5V()!==i.get_$5V();if(gt||kt||dt){if(i.get_$5V()!==undefined){var y=new _g.$6z(new _g.$1X("IsAllDayEvent"));var p=new _g.$6O;p.IsAllDayEvent=i.get_$5V();y.Item=p;Array.add(r,y)}if(i.get_$y()){var w=new _g.$6z(new _g.$1X("StartTimeZone"));var b=new _g.$6O;var k=new _g.$JG;k.Id=n.get_$DM();b.StartTimeZone=k;w.Item=b;Array.add(r,w);var d=new _g.$6z(new _g.$1X("Start"));var g=new _g.$6O;g.Start=i.get_$y().$99();d.Item=g;Array.add(r,d)}if(i.get_$1u()){var nt=new _g.$6z(new _g.$1X("EndTimeZone"));var tt=new _g.$6O;var it=new _g.$JG;it.Id=n.get_$DM();tt.EndTimeZone=it;nt.Item=tt;Array.add(r,nt);var rt=new _g.$6z(new _g.$1X("End"));var ut=new _g.$6O;var ft;ft=i.get_$5V()?i.get_$1u().$4F().$2o(1):i.get_$1u();ut.End=ft.$99();rt.Item=ut;Array.add(r,rt)}}if(t.get_$9S()!==i.get_$9S()){var et=new _g.$6z(new _g.$1X("LegacyFreeBusyStatus"));var ot=new _g.$6O;ot.FreeBusyType=i.get_$9S();et.Item=ot;Array.add(r,et)}var ni=t.get_$QH()!==i.get_$QH();var ti=t.get_$tc()!==i.get_$tc();if(ni||ti){var st=new _g.$6z(new _g.$1X("ReminderIsSet"));var ht=new _g.$6O;ht.ReminderIsSet=i.get_$QH();st.Item=ht;Array.add(r,st);var ct=new _g.$6z(new _g.$1X("ReminderMinutesBeforeStart"));var lt=new _g.$6O;lt.ReminderMinutesBeforeStart=i.get_$tc();ct.Item=lt;Array.add(r,ct)}if(t.get_$84()!==i.get_$84()){var at=new _g.$6z(new _g.$1X("Sensitivity"));var vt=new _g.$6O;vt.Sensitivity=i.get_$84();at.Item=vt;Array.add(r,at)}_g.$D.$4N(t.get_$4j(),i.get_$4j())||Array.add(r,_cc.$Fg.$7qp(i.get_$4j()));_g.$D.$4N(t.get_$LT(),i.get_$LT())||Array.add(r,_cc.$Fg.$7qr(i.get_$LT()));_g.$3i.$1K1(t.get_$7S(),i.get_$7S())&&Array.add(r,_cc.$Fg.$3sN("RequiredAttendees",i.get_$7S()));_g.$3i.$1K1(t.get_$8W(),i.get_$8W())&&Array.add(r,_cc.$Fg.$3sN("OptionalAttendees",i.get_$8W()));_g.$3i.$1K1(t.get_$9F(),i.get_$9F())&&Array.add(r,_cc.$Fg.$3sN("Resources",i.get_$9F()));_g.$NY.$56G(t.get_$mc(),i.get_$mc())&&Array.add(r,_cc.$Fg.$7qq(i.get_$mc()));if(!$6(i.get_$Vg())){var yt=new _g.$6z(_g.$l.get_$Vg());var f=new _g.$6O;f.ExtendedProperty=new Array(1);f.ExtendedProperty[0]=new _g.$Cq;f.ExtendedProperty[0].ExtendedFieldURI=_g.$l.get_$Vg();f.ExtendedProperty[0].Value=i.get_$Vg();yt.Item=f;Array.add(r,yt)}if(!$6(i.get_$Tw())){var pt=new _g.$6z(_g.$l.get_$Tw());var e=new _g.$6O;e.ExtendedProperty=new Array(1);e.ExtendedProperty[0]=new _g.$Cq;e.ExtendedProperty[0].ExtendedFieldURI=_g.$l.get_$Tw();e.ExtendedProperty[0].Value=i.get_$Tw();pt.Item=e;Array.add(r,pt)}if(i.get_$Gm()&&i.get_$Gm().get_$B()>0){var o;var wt,bt;!_h.$WK.$56D(t.get_$Gm().get_$A5d(),i.get_$Gm().get_$A5d())&&(bt=_cc.$Fg.$9x8(i.get_$Gm(),wt={val:o}),o=wt.val,bt)&&Array.addRange(r,o)}var u=new _g.$HP;if(i.get_$4S()===1){u.ItemId=new _g.$7U(i.get_$i().Id);u.ItemId.__type=_g.$7U._dataContractName}else{u.ItemId=i.get_$i();u.ItemId.__type=_g.$1q._dataContractName}u.Updates=r;return u}_cc.$Fg.prototype={$5dZ:!1,$cJ:null,$Qc:null,$2X2:null,$24U:null,$5fP:null,$2Yq:function(){_h.$SL.prototype.$2Yq.call(this);this.$d.isReferencedItemRecurring=this.$5dZ;this.$d.explicitLogonUser=this.$cJ},$4Os:function(n){this.$2X2.set_$i(n.Items[0].ItemId);this.$24U.set_$i(n.Items[0].ItemId);this.$Qc&&_cc.$S1.isInstanceOfType(this.$Qc)&&this.$Qc.$3KF()},$Yb:function(){this.$5fP=$6o3(this,this.$2X2,this.$24U);_a.$2p.prototype.$Yb.call(this)},$7dG:function(){return[this.$5fP]}};_cc.$IW=function(n){this.$$d_$6BH=Function.createDelegate(this,this.$6BH);_cc.$IW.initializeBase(this,[n,new _cc.$OX(n.get_$r().Id)]);if(!_h.$24.$1BN){var t=new _g.$At;t.NotificationType="HierarchyNotification";var i=new _h.$BS(t);i.$IU(this.get_$1b(),"HierarchyNotification",this.$$d_$6BH,2)}};_cc.$IW.$58H=function(n,t,i){var u=new _g.$lg(n.get_$y(),n.get_$1V4());var r=new _g.$JB("Beginning",u);r.Offset=t;r.MaxEntriesReturned=i;return r};function $6nP(n,t){var i;var r;var u=n.$1t;if(n.$2aI){r=0;i=u.get_$3q(u.get_$B()-1)}else{r=t.$FQ-n.$B7;i=u.get_$3q(0)}var f=Math.abs(t.$FQ-n.$B7)+1;return _cc.$IW.$58H(i,r,f)}function $4ip(n,t){var i=new _cc.$I4;i.set_$r(_g.$h.$1i.nameToId("calendar"));i.set_$3HL(t);i.set_$1XI(new _cc.$Zq);i.set_$1cr(n.get_$1cr());return i}function $6nO(n){return n.get_$1cr()&&n.$1t.get_$B()>0?4:n.$10g?5:n.$2aI?2:3}_cc.$IW.prototype={$xd:null,$1jG:null,$2aI:!1,get_$1b:function(){return _a.$0.$2kp},get_$1cr:function(){return this.$RB===4},$1Kn:function(){this.$xd=null;this.$1jG=null;this.$2aI=!1;this.$1t.$1r()},$7yv:function(n){return null},$9yv:function(n){return!1},$3l3:function(n){return new _g.$33(n)},$jL:function(n,t,i,r,u,f){f=$6nO(this);if(this.$1jG){if(this.get_$1cr())_h.$24.prototype.$jL.call(this,n,t,i,r,u,f);else if(this.$2aI){_h.$24.prototype.$jL.call(this,n,t,i,!1,!1,f);var o=Math.min(this.$1jG.$FQ-this.$B7,this.$1t.get_$B());o>0&&this.$1t.$A69(0,o,f)}else{_h.$24.prototype.$jL.call(this,n,t,i,!1,!0,f);var e=this.$1t.get_$B()-this.$1jG.$Dl;if(e>0){var s=this.$1t.get_$B()-e;this.$1t.$A69(s,e,f)}}this.set_$F7(this.$1jG.$FQ);this.$1TQ=-1}else _h.$24.prototype.$jL.call(this,n,t,i,r,u,f)},$9aE:function(){if(this.$xd){this.set_$Y3(4);var n=_g.$C8.isInstanceOfType(this.$xd)?_cc.$IW.$58H(this.$1t.get_$3q(0),0,this.$xd.MaxEntriesReturned):this.$xd;var t=$4ip(this,n);$eK(this,t)}else this.set_$Y3(0)},$A0o:function(n,t){var i=n;var r=i.get_$y();this.$3T0(n,t);var u=i.get_$y();return r.$93(u)?!0:!1},$3T0:function(n,t){var i=n;i.$2BV(t)},$7cp:function(n){var i;if(_h.$8R.isInstanceOfType(n)){var t=n;this.$1jG=t;this.$2aI=t.$FQ>this.$B7;i=$6nP(this,t);var u=new _g.$C8("Beginning");u.Offset=t.$FQ;u.MaxEntriesReturned=t.$Dl;this.$xd=u}else if(_h.$lf.isInstanceOfType(n)){var f=n;var r=new _g.$JB("Beginning",f.$2HD);r.Offset=f.$8o;r.MaxEntriesReturned=f.$Dl;i=r;this.$xd=i;this.$1jG=null;var e=r.Condition.Item;var o=e.FieldURIOrConstant.Item}else throw Error.argumentType("loadRowsArg");this.set_$Y3(1);return $4ip(this,i)},$6B4:function(n){var t=n;this.set_$P8(t.$2uD.tableSize);this.$10g=_g.$JB.isInstanceOfType(this.$xd);if(this.$10g){this.set_$F7(t.$2uD.loadedStartIndex);this.$1TQ=t.$2uD.firstMatchingRowIndex}var i=t.get_$gq().Body.ResponseMessages.Items[0].RootFolder.Items;return new _cc.$15C(i)},$6VA:function(n){var t=n;return t.get_$2aS()==="ErrorCalendarSeekToConditionNotSupported"?!0:_h.$24.prototype.$6VA.call(this,n)},$6BH:function(n){if(n.clientGenerated){var t=n;this.get_$r().Id===t.folderId&&_cc.$OX.$5Tx(n,this)}}};_cc.$uM=function(n,t,i,r){this.dispose=this.$1Q;this.$Nq=n;var u=this;this.$4YY=t||function(){};var f=this;this.$3qd=i||function(){};var e=this;this.$3ie=r||function(){}};_cc.$uM.prototype={$Nq:null,$4YY:null,$3qd:null,$3ie:null,get_$lq:function(){return this.$Nq.$59},get_$4YZ:function(){return this.$4YY},get_$5MQ:function(){return this.$3qd},get_$3if:function(){return this.$3ie},$1Q:function(){this.$4YY=null;this.$3qd=null;this.$3ie=null}};_cc.$Zt=function(n,t){_cc.$Zt.initializeBase(this,[n,t||new _cc.$5Y(n.get_$r().Id)])};_cc.$Zt.prototype={$1wf:function(){return new _cc.$I4}};_cc.$6d=function(n,t){this.$$d_$4J0=Function.createDelegate(this,this.$4J0);this.$$d_$6BH=Function.createDelegate(this,this.$6BH);this.$2I7=0;_cc.$6d.initializeBase(this,[n,t]);if(t&&!_cc.$wB.isInstanceOfType(t)&&!_h.$24.$1BN){this.$2ak=t;var i=new _g.$At;i.NotificationType="HierarchyNotification";this.$ok=new _h.$BS(i);this.$ok.$IU(this.get_$1b(),"HierarchyNotification",this.$$d_$6BH,2)}this.$1t.add_$1Z(this.$$d_$4J0)};_cc.$6d.$2wW=function(n){return _cc.$6d.$5So(n.get_$28())};_cc.$6d.$7yQ=function(){return _cc.$6d.$5So(_g.$h.$1i.nameToId("calendar"))};_cc.$6d.$5So=function(n){var i=null;if(n){var r=_g.$h.$1i.nameToId("calendar");var t;t=r&&_g.$28.$4N(n,r)?_g.$28.$Bi("calendar"):n;var u=_cc.$1Q.get_$I().$2vO(t);if(_g.$9G.isInstanceOfType(u)){var f=new(_h.$CH.$$(_cc.$S1))(t);i=_h.$12.$7wp(_cc.$S1,f)}else{var e=new(_h.$CH.$$(_cc.$Zt))(t);i=_h.$12.$7wp(_cc.$Zt,e)}}return i};_cc.$6d.$7XS=function(n,t){var i=n;var r=t;return i.get_$y().$2R(r.get_$y())};function $6nU(n,t){var r=this;var i=n.$1t.$DY(function(n){return n.get_$Ea()===t.get_$Ea()});return i<n.$1t.get_$B()?i:-1}function $4iq(n,t,i,r,u){t.set_$r(n.get_$r());if(n.$2I7){t.set_$1qN(n.$2I7);n.$2I7=0}t.set_$3HL(new _h.$4e(i.$2Q.$9K(1),i.$3D));var f=new _cc.$Zq;t.set_$1XI(f);t.set_$88P(r);t.set_$1cr(u)}function $6nW(n,t){return!$6(n.$8p)&&(n.$8p.$3D.$2R(t.$2Q)>=0||n.$8p.$2Q.$2R(t.$3D)<=0)}function $6nR(n,t){var r=t.get_$3HL();var f;var e=!0;var a=!!n.$8p&&_h.$4e.$56E(n.$8p,r);if(a){var v=String.format("CalendarItemQueryTableBase.AddResultsToCache: Disjointed range encountered when adding items, range in cache: {0}, range in action: {1}",n.$8p,r);_js.Trace.logError(n.get_$1b(),v);n.$1Kn()}if(n.$8p)if(r.$7G(n.$8p,!1)){n.$1Kn();f=!0;e=!1}else if(n.$8p.$7G(r,!0))return;else f=r.$2Q.$2R(n.$8p.$2Q)>=0;else{f=!0;e=!1}var u=[];if(n.$8p&&_h.$4e.$1Wc(r,n.$8p)){var i;if(f)for(var h=t.get_$1XI().get_$B()-1;h>=0;h--){i=t.get_$1XI().get_$3q(h);if(i.get_$y().$2R(n.$8p.$3D)<0)break;$3Vn(n,i,e)||Array.insert(u,0,i)}else for(var c,l=0,p=t.get_$1XI().get_$B();l<p;l++){i=t.get_$1XI().get_$3q(l);if(i.get_$y().$2R(n.$8p.$2Q)>=0)break;c=n.$8p.$3ic(i);c<0?$3Vn(n,i,e)||Array.add(u,i):c>0&&_js.Trace.logError(n.get_$1b(),"Unexpected item that occurs after the range in cache")}}else for(var o,s=0,y=t.get_$1XI().get_$B();s<y;s++){o=t.get_$1XI().get_$3q(s);$3Vn(n,o,e)||Array.add(u,o)}u.length>0&&(f?n.$1t.$69(u):n.$1t.$a5(0,u));n.$8p=_h.$4e.$6d7(r,n.$8p)}function $3Vn(n,t,i){return i&&(t.get_$AW()||t.get_$y().get_$51()!==t.get_$1u().get_$51())&&$6nS(n,t)}function $6nS(n,t){return n.$3r0(t)!==-1}function $6nT(n,t){if(!t.$7G(n.$8p,!0)){var h=n.$8p.$2Q.$2o(n.$5jv);if(!(n.$8p.$3D.$2R(h)<=0)){var c=t.$2Q.$4e(n.$8p.$2Q);var r;var i=-1;var s=[];var f=0;var u;if(c){r=new _h.$4e(n.$8p.$2Q,h);for(var e=n.$1t.get_$B()-1;e>=0;--e){u=n.$1t.get_$3q(e);if(u.get_$y().$2R(r.$3D)<=0){i=e;break}}if(i!==-1){i=Math.min(i+1,n.$1t.get_$B());f=Math.max(0,n.$1t.get_$B()-i)}}else{r=new _h.$4e(n.$8p.$3D.$2o(-n.$5jv),n.$8p.$3D);for(var o=0;o<n.$1t.get_$B()-1;o++){u=n.$1t.get_$3q(o);if(u.get_$y().$2R(r.$2Q)>=0){i=0;f=o;break}r.$3ic(u)||Array.add(s,u)}}if(i!==-1&&f>0){n.$1t.$V3(i,f);s.length>0&&n.$1t.$a5(0,s)}n.$8p=r}}}function $6nX(n,t){var i=!1;n.$8p&&(i=n.$8p.$7G(t,!0));return i}function $6nV(n,t){return $6(n.$8p)?t:$6nX(n,t)?null:t}function $3Vm(n,t,i,r,u,f){var e=t?"CalendarDataLoaded":"CalendarError";$Ju(n,e,n,new _cc.$uK(null,i,r,u,f))}function $4ir(n,t){return t.get_$3HL()}_cc.$6d.prototype={$ok:null,$2ak:null,$5jv:90,$8p:null,add_$58n:function(n){this.$2N("CalendarDataLoaded",n)},remove_$58n:function(n){this.$2P("CalendarDataLoaded",n)},add_$2nK:function(n){this.$2N("CalendarError",n)},remove_$2nK:function(n){this.$2P("CalendarError",n)},add_$2nR:function(n){this.$2N("CalendarNotification",n)},remove_$2nR:function(n){this.$2P("CalendarNotification",n)},get_$1b:function(){return _a.$0.$JF},$9rm:function(){},$9s8:function(){},$3QX:function(){this.$2ak&&this.$2ak.$3QX()},$3LH:function(){this.$2ak&&this.$2ak.$3LH(this)},$8Gh:function(n,t,i){this.$2I7=t;if(this.$8p&&this.$8p.$7G(n,!0)){_js.Trace.logInfo(this.get_$1b(),"[CalendarItemsCache] Requesting items from cache. Source: {0}, date range: {1}, calendar: {2}.",t,n,i.Id);var r=this;_js.$J.get_$I().$3r(this.get_$1b(),"CalendarItemsCache.LoadRowsForView_FromCache",function(){$3Vm(r,!0,i,n,!1)})}else{_js.Trace.logInfo(this.get_$1b(),"[CalendarItemsCache] Requesting items from server. Source: {0}, date range: {1}, calendar: {2}.",t,n,i.Id);this.$OQ(n)}},$3l3:function(n){return new _g.$33(n)},$1Kn:function(){this.$8p=null;this.$1t.$1r()},$2kU:function(n){var t=_0365f.$Fd.$3r1(n,_cc.$6d.$7XS,this.$1t);t!==-1&&this.$1t.$72(t,n);return t},$27H:function(n,t){for(var r=!1,i=this.$1t.get_$B()-1;i>=0;i--){var u=this.$1t.get_$3q(i);if(u.get_$Ea()===n||t&&u.get_$Ea()===t){this.$1t.$68(i);r=!0}}return r},$3cj:function(n,t,i){if(this.$8p){var r=-1;switch(t){case 0:r=this.$3r0(n);break;case 1:r=$6nU(this,n);break;default:_js.Trace.logError(this.get_$1b(),"Unknown AddOrModifyMode value: "+t);break}if(r!==-1){var u=this.$1t.get_$3q(r);u.get_$W2()&&t===1?this.$27H(u.get_$Ea(),null):this.$1t.$68(r);if(this.$8p.$2lv(n.get_$y(),n.get_$1u())){var f=this.$2kU(n);f===-1&&_js.Trace.logWarning(this.get_$1b(),"Couldn't find index to insert calendar item. Id="+n.get_$i().Id)}}else if(!i&&this.$8p.$2lv(n.get_$y(),n.get_$1u())){var e=this.$2kU(n);e===-1&&_js.Trace.logWarning(this.get_$1b(),"Couldn't find index to insert new calendar item. Id="+n.get_$i().Id)}}},$3r0:function(n){_a.$4.$l(n,"calItem");var t;var i,r;return(r=this.$2uA(n.get_$i().Id,i={val:t}),t=i.val,r)?t:-1},$5Mx:function(n){var t;var u=null;var i,r;return(r=this.$2uA(n.Id,i={val:t}),t=i.val,r)?this.$1t.get_$3q(t):u},$3se:function(n){_a.$4.$l(n,"dateRange");var i=[];var r;if($6nW(this,n))for(var f=this.$1t.get_$B(),t=0;t<f;++t){r=this.$1t.get_$3q(t);var u=n.$3ic(r);if(u){if(u>0)break}else Array.add(i,this.$1t.get_$3q(t))}return i},$9aE:function(){if(this.$8p){var n=this.$8p;if(this.$FW){var i=$4ir(this,this.$FW);n=_h.$4e.$6d7(this.$8p,i)}var t=this.$1wf();$4iq(this,t,n,!0,!0);$eK(this,t)}},$4c:function(){!_h.$24.$1BN&&this.$ok&&this.$ok.$2fQ(this.$$d_$6BH);if(this.$FW){this.$FW.$1Q();this.$FW=null}_h.$24.prototype.$4c.call(this)},$6B4:function(n){throw Error.invalidOperation();},$6B3:function(n){var t=n;$3Vm(this,!1,t.get_$r(),$4ir(this,n),t.get_$1cr(),t.get_$3jk())},$7cp:function(n){if(!_h.$4e.isInstanceOfType(n))throw Error.argumentType("loadRowsArg",n?Object.getType(n):null,_h.$4e,"loadRowsArg needs to be a DateRange object");var i=n;var t=null;this.$8p&&_h.$4e.$56E(this.$8p,i)&&this.$1Kn();var r=$6nV(this,i);if(r){t=this.$1wf();$4iq(this,t,r,!1,!1)}return t},$1eJ:function(n){var t=n;var i=t.get_$3HL();if(this.$FW&&this.$FW!==n){var r=String.format("Detected invalid action in merge rows, table [{0}], action: [{1}], date range: [{2}]. Will discard results as there is another action in progress.",this.$4J.get_$R(),n.$1n_2,i);_js.Trace.logError(this.get_$1b(),r);return!1}this.$1t.remove_$1Z(this.$$d_$4J0);try{i.$2Q.get_$yf()===1&&(i.$2Q=i.$2Q.$9K(-1));t.get_$1cr()&&this.$1Kn();$6nR(this,t);$6nT(this,i)}finally{this.$1t.add_$1Z(this.$$d_$4J0)}$3Vm(this,!0,t.get_$r(),i,t.get_$1cr(),t.get_$3jk());return!0},$6BH:function(n){var t=n;t.folderId?n.clientGenerated&&n.EventType==="Reload"&&this.$iw&&this.get_$r().Id===t.folderId&&this.$cl():this.$cl()},$4J0:function(n,t){$Ju(this,"CalendarNotification",this,new _cc.$uQ(this.get_$r(),t))}};_cc.$Ay=function(n,t,i,r,u,f,e){this.$$d_$2XV=Function.createDelegate(this,this.$2XV);this.$1XD={};_cc.$Ay.initializeBase(this);_a.$4.$J(n,"selectedCalendars");this.$2X8=i;this.$4Iw=r;this.$2X9=u;this.$4Iz=f;this.$4Iu=e;this.$56=n;this.$2U=t;this.$56.add_$1Z(this.$$d_$2XV);for(var o=0;o<n.get_$B();++o){var s=n.get_$3q(o);$4is(this,s)}};function $4it(n,t){var i=$1J7(n,t);if(!i){var r=t.get_$A5();if(_g.$Ej.isInstanceOfType(t)){var e=n.$5EC(r);i=_h.$12.$7wp(_cc.$Zt,e)}else{var u=t;if(u.get_$Xs()){var o=n.$5EC(r);i=_h.$12.$A4B(_cc.$16T,o,u.get_$D2())}else{var s=n.$7er(r);i=_h.$12.$7wp(_cc.$S1,s)}var f=i;f.$1Tp=t;f.$2U=n.$2U}n.$1XD[r.Id]=i;i.$2oK()}return i}function $1J7(n,t){var i=t.get_$A5();return n.$1XD[i.Id]}function $6nZ(n,t){var i=t.get_$A5().Id;if(n.$1XD[i]){var r=n.$1XD[i];r.$1Kn();_h.$3L.get_$I().$3KD(r);delete n.$1XD[i];r.$1Q()}}function $4is(n,t){var i=$4it(n,t);n.$2X9&&i.add_$2nK(n.$2X9);n.$2X8&&i.$1t.add_$1Z(n.$2X8);i.add_$2nR(n.$4Iz);i.add_$58n(n.$4Iw);i.add_$25M(n.$4Iu);i.$9rm()}function $6nY(n,t){var i=$1J7(n,t);if(i){i.$1Kn();n.$2X9&&i.remove_$2nK(n.$2X9);n.$2X8&&i.$1t.remove_$1Z(n.$2X8);i.remove_$2nR(n.$4Iz);i.remove_$58n(n.$4Iw);i.remove_$25M(n.$4Iu);i.$9s8()}}_cc.$Ay.prototype={$56:null,$2U:null,$2X8:null,$4Iz:null,$4Iw:null,$2X9:null,$4Iu:null,$2aJ:function(n,t,i,r){var u=$4it(this,t);u.$8Gh(i,r,t.get_$A5())},$1ag:function(n){for(var t=null,i,r=0;r<this.$56.get_$B();++r){i=$1J7(this,this.$56.get_$3q(r));if(i){t=i.$5Mx(n);if(t)return t}}return t},$65n:function(n,t){var i=$1J7(this,n.get_$5k());i&&i.$3cj(n,t,!0)},$3QX:function(){for(var n,t=0;t<this.$56.get_$B();++t){n=$1J7(this,this.$56.get_$3q(t));n&&n.$3QX()}},$3LH:function(){for(var n,t=0;t<this.$56.get_$B();++t){n=$1J7(this,this.$56.get_$3q(t));n&&n.$3LH()}},$2LK:function(n,t){var i=$1J7(this,n);return i?i.$3se(t):[]},$2Gj:function(){_js.Trace.logInfo(_a.$0.$JF,"CalendarItemsCache:CheckAndReloadCache");var n=!1;var t=this.$1XD;for(var i in t){var r={key:i,value:t[i]};var u=r.value;n=u.$2oK()||n}return n},$9a8:function(n){var t=$1J7(this,n);t&&t.$AF()},$4c:function(){this.$56.remove_$1Z(this.$$d_$2XV);_js.$8.prototype.$4c.call(this)},$5EC:function(n){return new(_h.$CH.$$(_cc.$Zt))(n)},$7er:function(n){return new(_h.$CH.$$(_cc.$S1))(n)},$2XV:function(n,t){var i;var r;switch(t.$2v){case 0:r=_a.$6.acss(_a.$0.$1k,"CalendarItemsCache.OnSelectedCalendarsChanged.Add");for(var u=0;u<t.$2l.length;++u){i=t.$2l[u];$4is(this,i)}_a.$6.aces(r);break;case 2:r=_a.$6.acss(_a.$0.$1k,"CalendarItemsCache.OnSelectedCalendarsChanged.Remove");for(var f=0;f<t.$38.length;++f){i=t.$38[f];$6nY(this,i);$6nZ(this,i)}_a.$6.aces(r);break}}};_cc.$My=function(n,t,i,r){this.$$d_$692=Function.createDelegate(this,this.$692);this.$$d_$4J0=Function.createDelegate(this,this.$4J0);this.$$d_$697=Function.createDelegate(this,this.$697);this.$$d_$4Ix=Function.createDelegate(this,this.$4Ix);this.$$d_$9BF=Function.createDelegate(this,this.$9BF);this.$$d_$9R6=Function.createDelegate(this,this.$9R6);this.$$d_$9R8=Function.createDelegate(this,this.$9R8);this.$$d_$9R7=Function.createDelegate(this,this.$9R7);this.$$d_$2XV=Function.createDelegate(this,this.$2XV);_cc.$My.initializeBase(this);_a.$4.$J(n,"selectedCalendars");this.$2bd=0;this.$4P=r;this.$3sC=t;this.$2U=i;this.$56=n;this.$49()};function $6na(n,t,i){var r=n.$2LK(n.$2U.$2vO(t),i);$Ju(n,"CalendarNotification",n,new _cc.$uQ(t,new _js.$II(0,0,r,null)))}_cc.$My.prototype={$3sC:null,$4P:null,$3sB:null,$bw:null,$2U:null,$2bd:0,$vI:null,$56:null,$1B3:null,$2fc:!1,add_$5Mb:function(n){this.$2N("FetchingCalendarsCompleted",n)},remove_$5Mb:function(n){this.$2P("FetchingCalendarsCompleted",n)},add_$2nK:function(n){this.$2N("CalendarError",n)},remove_$2nK:function(n){this.$2P("CalendarError",n)},add_$2nR:function(n){this.$2N("CalendarNotification",n)},remove_$2nR:function(n){this.$2P("CalendarNotification",n)},add_$58j:function(n){this.$2N("CalendarCacheStaleStatusChanged",n)},remove_$58j:function(n){this.$2P("CalendarCacheStaleStatusChanged",n)},get_$3N3:function(){return this.$2bd},set_$3N3:function(n){this.$2bd=n;return n},get_$11U:function(){return this.$vI.$7rB()},$49:function(){this.$vI=new _cc.$12S;this.$bw=this.$7bP();this.$3sC&&(this.$3sB=this.$3sC.$E(this.$bw));this.$56.add_$1Z(this.$$d_$2XV);for(var n=0,t=this.$56.get_$B();n<t;n++)this.$vI.$1ol(this.$56.get_$3q(n).get_$A5())},$9cD:function(n,t,i){this.$vI.$9cd();this.$2fc=!0;this.$1B3=this.$4P.$4z(this.$1B3);for(var r=0,u=this.$56.get_$B();r<u;r++)this.$2aJ(n,this.$56.get_$3q(r),t,i)},$2aJ:function(n,t,i,r){_a.$4.$J(i,"dateRange");_a.$6.acsa(_a.$0.$6y,"RequestItems");this.$vI.$1ol(t.get_$A5());this.$bw.$2aJ(n,t,i,r)},$1ag:function(n){return this.$bw.$1ag(n)},$65n:function(n,t){this.$bw.$65n(n,t)},$5Qt:function(n){return this.$vI.$2M6(n)===1},$3QX:function(){this.$bw.$3QX()},$3LH:function(){this.$bw.$3LH()},$2LK:function(n,t){var i=_a.$6.acss(_a.$0.$6y,"CacheManager_GetCachedItemsFromCalendar");var r=this.$bw.$2LK(n,t);_a.$6.aces(i);return r},$3se:function(n){for(var u=_a.$6.acss(_a.$0.$6y,"CacheManager_GetCachedItems"),i=[],t=0;t<this.$56.get_$B();++t){var r=this.$56.get_$3q(t);this.$vI.$2M6(r.get_$A5())===1&&Array.addRange(i,this.$2LK(r,n))}_a.$6.aces(u);return i},$8GU:function(n){for(var t=0;t<n.length;++t){var i=n[t];var r=this.$2U.$2vO(i.get_$28());_g.$Ej.isInstanceOfType(r)&&this.$8GT(300,i.get_$i())}},$7lY:function(n){n.add_$3qF(this.$$d_$9R7);n.add_$1x(this.$$d_$9R8);n.add_$2m(this.$$d_$9R6)},$1uq:function(n,t,i,r,u,f,e){return this.$3sB.$1uq(n,t,f,e,i,r,u)},$8GT:function(n,t){return this.$3sB.$1uq(n,t,"HTML","defaultMode",null,null,null,1)},$2Gj:function(){return this.$bw.$2Gj()},$692:function(){$eM(this,"CalendarCacheStaleStatusChanged")},$4Ix:function(n,t){_a.$6.acea(null,"RequestItems");var r=_a.$6.acss(_a.$0.$1k,"OnCalendarDataLoaded");this.$vI.$8IU(t.$hm);$Ju(this,"CalendarDataLoaded",this,t);if(this.$2fc||t.$1yV){if(this.get_$11U()===3||this.get_$11U()===2){this.$1B3=this.$4P.$4z(this.$1B3);this.$2fc=!1;$Ju(this,"FetchingCalendarsCompleted",this,t)}else if(!this.$1B3&&!t.$1yV){var i=this;this.$1B3=this.$4P.$1w(_a.$0.$JF,"CalendarItemsCacheManager_WaitForMoreItems",function(){i.$1B3=null;i.$2fc=!1;$Ju(i,"FetchingCalendarsCompleted",i,t)},500)}}else $6na(this,t.$hm,t.$4R1);_a.$6.aces(r)},$697:function(n,t){this.$vI.$5jF(t.$hm);$Ju(this,"CalendarError",this,t);if(this.get_$11U()===3||this.get_$11U()===2){this.$1B3=this.$4P.$4z(this.$1B3);this.$2fc=!1;$Ju(this,"FetchingCalendarsCompleted",this,new _cc.$uK(null,t.$hm,t.$4R1,t.$1yV,t.$1YP))}},$7bP:function(){return new _cc.$Ay(this.$56,this.$2U,this.$$d_$9BF,this.$$d_$4Ix,this.$$d_$697,this.$$d_$4J0,this.$$d_$692)},$9R7:function(n){var t=n;t.$24U.get_$Lf()==="RecurringMaster"?t.$2X2.$2BV(t.$24U.get_$3A()):this.$65n(t.$24U,0)},$9R8:function(n){this.$bw.$9a8(n.$2X2.get_$5k())},$9R6:function(n){n.remove_$3qF(this.$$d_$9R7);n.remove_$1x(this.$$d_$9R8);n.remove_$2m(this.$$d_$9R6)},$9BF:function(n,t){var i=_a.$6.acss(_a.$0.$6y,"OnCachedItemsChanged");++this.$2bd;_a.$6.aces(i)},$4J0:function(n,t){$Ju(this,"CalendarNotification",this,t)},$2XV:function(n,t){++this.$2bd;var i;switch(t.$2v){case 0:for(var r=0;r<t.$2l.length;++r){i=t.$2l[r];this.$vI.$1ol(i.get_$A5())}break;case 2:for(var u=0;u<t.$38.length;++u){i=t.$38[u];this.$vI.$3KI(i.get_$A5())}break}}};_cc.$1Q=function(){this.$$d_$9Fk=Function.createDelegate(this,this.$9Fk);this.$$d_$9Fl=Function.createDelegate(this,this.$9Fl);this.$$d_$9Fm=Function.createDelegate(this,this.$9Fm);this.$$d_$9GV=Function.createDelegate(this,this.$9GV);this.$$d_$9GU=Function.createDelegate(this,this.$9GU);this.$2fl={};this.$2YH=new(_a.$3X.$$(_cc.$17L));this.$11W={};this.$24u=new(_a.$3X.$$(Function));_cc.$1Q.initializeBase(this);this.$M=OwaApplication.get_$XS()};_cc.$1Q.$$cctor=function(){_cc.$1Q.$2l0.set_$Gu(new _a.$EC(_cc.$6x));_g.$33.$6TC(_cc.$1Q.$v);var n=new _g.$VN;n.WorkDays=n.WorkHoursEndTimeInMinutes=n.WorkHoursStartTimeInMinutes=0;_cc.$1Q.$3Eb=new _g.$SR(n)};_cc.$1Q.get_$I=function(){_cc.$1Q.$v||_cc.$1Q.set_$I(new _cc.$1Q);return _cc.$1Q.$v};_cc.$1Q.set_$I=function(n){_cc.$1Q.$v=n;_g.$33.$6TC(_cc.$1Q.$v);return n};_cc.$1Q.$5EQ=function(n){var t=new _cc.$1Q;t.set_$ux(new _js.$Z);t.set_$I1(!0);t.$5J9=n;return t};_cc.$1Q.$1cW=function(n){return n.get_$8k()==="CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2"||n.get_$8k()==="6151B1C8-E005-4366-B4E2-2DBED40129CA"||n.get_$8k()==="78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF"||n.get_$8k()==="51978C8F-D6FE-48C6-9ADE-BBE39E935963"};function $4iw(n,t){var i=new _g.$Sj;i.set_$1o(t.get_$Bd());i.set_$K4(new _g.$Qg);i.get_$K4().CreateAssociated=i.get_$K4().CreateContents=i.get_$K4().CreateHierarchy=i.get_$K4().Read=i.get_$K4().Modify=i.get_$K4().ViewPrivateItems=_g.$Ej.isInstanceOfType(t);_g.$9G.isInstanceOfType(t)&&i.set_$r(new _g.$3S(t.get_$D2()));return i}function $4iz(n,t,i,r,u,f,e){var o=new _cc.$uw(t,i,r);if(u){var s=this;o.add_$2C(function(){u()})}if(f){var h=this;o.add_$1x(function(n){f(n.get_$cH(),o.$A6R())})}var c=this;o.add_$2m(function(){n.set_$mu(!1);e&&e()});n.set_$mu(!0);n.get_$10u().$z(o)}function $1nW(n,t){return n.$11W[t]}function $2gp(n,t){return t?$1nW(n,t.Id):null}function $4iy(n,t){var i=n.$11W[t];if(!i){i=new _cc.$8g;n.$11W[t]=i}return i}function $6nm(n,t,i){_a.$4.$J(t,"userSmtpAddress");_a.$4.$J(i,"workingHoursModel");if(!(t in n.$2fl)||n.$2fl[t]!==i){n.$2fl[t]=i;$CY(n,"WorkingHoursUpdated",t,null)}}function $4ix(n){if(!n.$1C3){n.$1C3=!0;$4j0(n)}}function $4j0(n){var t=new _cc.$15H(n.get_$8H2(),n.$41o);t.add_$2C(n.$$d_$9Fm);t.add_$1x(n.$$d_$9Fl);t.add_$2m(n.$$d_$9Fk);n.get_$10u().$z(t)}function $6no(n,t){var r=t.$58s;for(var u in r){var i={key:u,value:r[u]};var f=i.value;var e=t.$58r[i.key];var o=$4iy(n,i.key);o.$6TF(f,e)}}function $2CZ(n,t,i){var r=new _cc.$6x;r.set_$Cp(new _js.$Z);r.set_$Vr(t);r.set_$8k(i);r.set_$i(new _g.$1q(i));r.get_$i().ChangeKey="";return r}function $6nj(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$JF,"Loading linked calendar effective rights from server for {0} ",t);var f=new _cc.$og(t);var e=this;f.add_$2C(function(r){$6nl(n,r);if(i){var u=$1nW(n,t.get_$A5().Id);i(u.get_$lX())}});var o=this;f.add_$1x(function(i){$6nk(n,i);r&&r(t)});var s=this;f.add_$2m(function(){u&&u(t)});n.get_$10u().$z(f)}function $6nk(n,t){var r=t;var u=r.$27R.get_$A5().Id;var i=$1nW(n,u);if(i){_js.Trace.logInfo(_a.$0.$JF,"Unable to find effective rights from server for linked calendar {0}",i.get_$lX());i.$9ib(r.$43k)}else _js.Trace.logError(_a.$0.$JF,"CalendarEntry {0} is not on the cache",u)}function $6nl(n,t){var u=t;var f=u.$595;var s=u.$2oB;var e=u.$27R.get_$A5().Id;var r=f.get_$r().Id;var o=f.get_$r().ChangeKey;var i=$1nW(n,e);if(!i){_js.Trace.logInfo(_a.$0.$JF,"Could not find a CalendarsCacheEntry with Id:{0}",e);return}_js.Trace.logInfo(_a.$0.$JF,"Loaded effective rights for the linked calendar {0}",i.get_$lX());i.$9iJ(f.get_$K4(),s);i.get_$vG().get_$r().Id=r;i.get_$vG().get_$r().ChangeKey=o;i.get_$lX().get_$A5().Id=r;i.get_$lX().get_$A5().ChangeKey=o;if(e!==r){n.$11W[r]=i;$CY(n,"EffectiveRightsFetchedForCalendar",n,i.get_$lX())}}function $6nn(n,t){var i={};var r=n.$11W;for(var u in r){var f={key:u,value:r[u]};i[f.key]=f.value.$OH()}t.CalendarsCacheDictionary=i}function $6ni(n,t){var e=t.CalendarsCacheDictionary;n.$11W={};var i=e;for(var r in i){var u={key:r,value:i[r]};var f=new _cc.$8g;f.$QR(u.value);n.$11W[u.key]=f}}_cc.$1Q.prototype={$M:null,$1C3:!1,$kU:0,$14R:!1,$5J9:!1,$41o:!1,add_$2nC:function(n){this.$2N("CachePopulated",n)},remove_$2nC:function(n){this.$2P("CachePopulated",n)},add_$3UC:function(n){this.$2N("WorkingHoursUpdated",n)},remove_$3UC:function(n){this.$2P("WorkingHoursUpdated",n)},add_$5KW:function(n){this.$2N("EffectiveRightsFetchedForCalendar",n)},remove_$5KW:function(n){this.$2P("EffectiveRightsFetchedForCalendar",n)},get_$mu:function(){return this.$14R},set_$mu:function(n){if(n!==this.$14R){this.$14R=n;$3(this,"IsWaitingForCalendarAction")}return n},get_$iB:function(){return this.$U(_cc.$1Q.$3mX)},set_$iB:function(n){this.$K(_cc.$1Q.$3mX,n);return n},get_$ux:function(){return this.$U(_cc.$1Q.$2l0)},set_$ux:function(n){this.$K(_cc.$1Q.$2l0,n);return n},get_$3H6:function(){return this.$U(_cc.$1Q.$4Lk)},set_$3H6:function(n){this.$K(_cc.$1Q.$4Lk,n);return n},get_$1HO:function(){return this.$U(_cc.$1Q.$4St)},set_$1HO:function(n){this.$K(_cc.$1Q.$4St,n);return n},get_$16m:function(){var n=this.$U(_cc.$1Q.$4Ne);if(!n){n=$2CZ(this,_u.Strings.l_Favorites_UpperCase_Text,"6151B1C8-E005-4366-B4E2-2DBED40129CA");this.$K(_cc.$1Q.$4Ne,n)}return n},get_$1DV:function(){var n=this.$U(_cc.$1Q.$44K);if(!n){n=$2CZ(this,_ucc.CalCoreStrings.l_JoinedGroups_UpperCase_Text,"78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF");this.$K(_cc.$1Q.$44K,n)}return n},get_$1mk:function(){var n=this.$U(_cc.$1Q.$4dh);if(!n){n=$2CZ(this,_ucc.CalCoreStrings.l_OtherVisitedGroups_UpperCase_Text,"51978C8F-D6FE-48C6-9ADE-BBE39E935963");this.$K(_cc.$1Q.$4dh,n)}return n},get_$7og:function(){var n=this.$U(_cc.$1Q.$3rE);if(!n){n=$2CZ(this,_ucc.CalCoreStrings.l_Groups_UpperCase_Text,"CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2");this.$K(_cc.$1Q.$3rE,n)}return n},get_$I1:function(){return this.$U(_cc.$1Q.$41O)},set_$I1:function(n){this.$K(_cc.$1Q.$41O,n);return n},get_$8H2:function(){return this.get_$4d4().get_$31().get_$Aj()},get_$4d4:function(){return _g.$V.get_$I()},get_$XS:function(){return this.$M},get_$10u:function(){return OwaApplication.$1W},$wW:function(n){var t=$2gp(this,n);return t?t.get_$vG():null},$3sg:function(n){var t=$1nW(this,n);return t?t.get_$lX():null},$2vO:function(n){var t=$2gp(this,n);return t?t.get_$lX():null},$5AP:function(n){var t=$2gp(this,n);return!!t&&t.get_$Bj()},$2o2:function(n){return n.get_$2Oy()&&(this.$5AP(n.get_$A5())||_g.$9G.isInstanceOfType(n)&&n.get_$rL())},$2Ln:function(n){var t=$2gp(this,n);return t?_g.$Ej.isInstanceOfType(t.get_$lX())&&!t.get_$lX().get_$1D0()?this.get_$4d4().get_$HY():t.get_$HY():null},$4Q0:function(n){var t=n;t.add_$2m(this.$$d_$9GU);t.add_$2C(this.$$d_$9GV);this.$2YH.$D(n)},$1NE:function(n){if(_g.$9G.isInstanceOfType(n)){var t=n;var r=this.$2fl[t.get_$D2()];if(r)return r;if(!this.$5J9){for(var u=!0,i=0;i<this.$2YH.get_$B();i++){var f=this.$2YH.get_$3q(i);if(f.get_$4R3().$7G(t.get_$D2())){u=!1;break}}u&&this.$7nr(t)}return _cc.$1Q.$3Eb}else return this.get_$4d4().get_$1I().get_$Nl()},$5hh:function(n,t,i,r){var u=$1nW(this,n.get_$A5().Id);if(!u){_js.Trace.logError(_a.$0.$JF,"Entry {0} is not in the cache",n.get_$A5().Id);return}if(u.get_$307()){t&&t(n);r&&r(n)}else $6nj(this,n,t,i,r)},$AF:function(n){n&&this.$24u.$D(n);this.get_$XS().$9Yf(_h.$eH,new _h.$eH);$4ix(this)},$1Mx:function(n){if(this.get_$I1()){$6(n)||n();return!0}$6(n)||this.$24u.$D(n);$4ix(this);return!1},$7bN:function(){var n=new _g.$Ej;n.set_$bv(-1);return n},$7da:function(){var n=new _cc.$6x;n.set_$Cp(new _js.$Z);n.set_$ql(3);return n},$3cM:function(n,t){_a.$4.$Js(n.get_$rC(),!0,"AddClientOnlyCalendar is only supporting client-only calendar entries");var i=$4iw(this,n);this.$1ol(t,n,i)},$4QO:function(n,t){_a.$4.$Js(n.get_$rC(),!0,"RemoveClientOnlyCalendar is only supporting client-only calendar entries");return this.$3KI(t,n)},$9Uk:function(n,t,i,r){_a.$4.$Js(n.get_$rC(),!0,"unpinnedCalendar.IsClientOnlyCalendar");_a.$4.$Js(this.get_$1HO().get_$Cp().$7G(n),!0,"SearchedCalendars.Contains()");this.get_$1HO().get_$Cp().$34(n);n.set_$o1(this.get_$3H6().get_$8k());this.get_$3H6().get_$Cp().$D(n);var u=this;$4iz(this,this.get_$3H6().get_$8k(),n,this.$wW(n.get_$A5()),t,function(t,r){_js.Trace.logWarning(_a.$0.$JF,"Error while trying to pin calendar with name: {0}. Error:{1} Correlation ID:{2}",n.get_$Bd(),t,r);i&&i(t,r);u.$AF()},r)},$2pc:function(n,t,i,r,u){t.set_$o1(n.get_$8k());var f=$4iw(this,t);var e=this;$4iz(this,t.get_$o1(),t,f,function(){e.$1ol(n,t,f);i&&i()},r,u)},$3KY:function(n,t,i,r){var u=new _cc.$zZ(n,t,this);u.add_$2C(i);u.add_$1x(r);var f=this;u.add_$2m(function(n){f.set_$mu(!1)});this.set_$mu(!0);this.get_$10u().$z(u)},$3mx:function(n,t,i,r){var u=new _cc.$v4(n,t,this);u.add_$2C(i);u.add_$1x(r);var f=this;u.add_$2m(function(n){f.set_$mu(!1)});this.set_$mu(!0);this.get_$10u().$z(u)},$2pd:function(n,t,i,r){var u=new _cc.$ux(n);var f=this;u.add_$2C(function(n){f.get_$ux().$D(n.$2WV);t&&t()});if(i){var o=this;u.add_$1x(function(n){i(n.get_$cH())})}if(r){var e=this;u.add_$2m(function(n){e.set_$mu(!1);r()})}this.set_$mu(!0);this.get_$10u().$z(u)},$1ol:function(n,t,i,r){_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"calendarEntry");_a.$4.$J(i,"calendarModel");t.set_$o1(n.get_$8k());var u=$4iy(this,t.get_$A5().Id);u.$6TF(i,t);r===undefined?n.get_$Cp().$D(t):n.get_$Cp().$72(r,t)},$3KI:function(n,t){_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"calendar");if(t.get_$2Oy()){delete this.$11W[t.get_$A5().Id];if(_g.$9G.isInstanceOfType(t)){var i=t;i.get_$rL()&&delete this.$11W[i.get_$D2()]}}return n.get_$Cp().$34(t)},$3KZ:function(n,t,i,r){var u=new _cc.$za(n,t);u.add_$2C(i);u.add_$1x(r);var f=this;u.add_$2m(function(n){f.set_$mu(!1)});this.set_$mu(!0);this.get_$10u().$z(u)},$3my:function(n,t,i){var r=new _cc.$v5(n);r.add_$2C(t);r.add_$1x(i);var u=this;r.add_$2m(function(n){u.set_$mu(!1)});this.set_$mu(!0);this.get_$10u().$z(r)},$OH:function(){var n=_a.$Qe.prototype.$OH.call(this);$6nn(this,n);return n},$QR:function(n){_a.$Qe.prototype.$QR.call(this,n);$6ni(this,n)},$7nr:function(n){var t=new _cc.$w5(n);var i=_a.$7.get_$29().$4F();t.set_$3HL(new _h.$4e(i,i.$BX(30)));t.set_$1XI(new _cc.$Zq);this.$4Q0(t);this.get_$10u().$z(t)},$9GV:function(n){for(var i=n,t=0;t<i.get_$4R3().get_$B();t++)$6(i.get_$6gk().get_$3q(t))||$6nm(this,i.get_$4R3().get_$3q(t),i.get_$6gk().get_$3q(t))},$9GU:function(n){this.$2YH.$34(n);n.remove_$2m(this.$$d_$9GU);n.remove_$2C(this.$$d_$9GV)},$9Fm:function(n){var t=n;$6no(this,t);this.set_$ux(t.$1qG);this.set_$iB(t.$2r6);this.set_$3H6(t.$6Fz);this.get_$1HO()||this.set_$1HO($2CZ(this,"Searched Calendars","12B353D3-3078-4E85-875B-F905CCB65E9B"));for(var u=!1,i=0,f=t.$1qG.get_$B();i<f;i++)if(t.$1qG.get_$3q(i).get_$ql()===1){t.$1qG.$72(i+1,this.get_$1HO());u=!0;break}u||_js.Trace.logError(_a.$0.$JF,"Unable to insert SearchedCalendars directly after Other Calendars group.");this.set_$I1(!0);this.$1C3=!1;$CY(this,"CachePopulated",this,null);for(var r=0;r<this.$24u.get_$B();r++)this.$24u.get_$3q(r)();this.$24u=new(_a.$3X.$$(Function))},$9Fl:function(n){if(this.$kU<3){var t=this;_js.$J.get_$I().$1w(_a.$0.$JF,"GetCalendarsActionRetry",function(){$4j0(t)},2e3);this.$kU++}else{this.$kU=0;this.$1C3=!1}},$9Fk:function(n){n.remove_$2C(this.$$d_$9Fm);n.remove_$1x(this.$$d_$9Fl);n.remove_$2m(this.$$d_$9Fk)}};_cc.$8g=function(){_cc.$8g.initializeBase(this)};_cc.$8g.prototype={get_$vG:function(){return this.$U(_cc.$8g.$3gQ)},set_$vG:function(n){this.$K(_cc.$8g.$3gQ,n);return n},get_$lX:function(){return this.$U(_cc.$8g.$3gI)},set_$lX:function(n){this.$K(_cc.$8g.$3gI,n);return n},get_$Bj:function(){return this.$U(_cc.$8g.$1z1)},set_$Bj:function(n){this.$K(_cc.$8g.$1z1,n);return n},get_$307:function(){return this.$U(_cc.$8g.$3zZ)},set_$307:function(n){this.$K(_cc.$8g.$3zZ,n);return n},get_$HY:function(){return this.$U(_cc.$8g.$20Q)},set_$HY:function(n){this.$K(_cc.$8g.$20Q,n);return n},$9iJ:function(n,t){this.get_$vG().set_$K4(n);this.set_$HY(t);this.set_$307(!0)},$9ib:function(n){this.set_$307(!0);this.set_$Bj(n)},$6TF:function(n,t){var i=this.get_$vG()?this.get_$vG().get_$r():null;var r=this.get_$vG()?this.get_$vG().get_$K4():null;this.set_$lX(t);this.set_$vG(n);this.set_$Bj(!!(this.get_$Bj()&this.get_$lX().get_$2Oy()));if(this.get_$307()){this.get_$lX().get_$A5().Id=i.Id;this.get_$vG().get_$r().Id=i.Id;this.get_$vG().set_$K4(r)}}};_cc.$12S=function(){this.$Fz={}};_cc.$12S.prototype={$Fz:null,$1ol:function(n){var t=n.Id;t in this.$Fz?Error.invalidOperation("Tried to track calendar that was already being tracked."):this.$Fz[t]=0},$3KI:function(n){var t=n.Id;t in this.$Fz?delete this.$Fz[t]:Error.invalidOperation("Tried to remove calendar from tracking when the calendar was not being tracked.")},$2M6:function(n){var t=n.Id;t in this.$Fz||Error.invalidOperation("Tried get state of a calendar that was not being tracked.");return this.$Fz[t]},$8IU:function(n){var t=n.Id;t in this.$Fz&&!this.$Fz[t]?this.$Fz[t]=1:Error.invalidOperation("Tried to mark calendar as 'loaded' when the calendar wasn't in the 'loading' state.")},$5jF:function(n){var t=n.Id;t in this.$Fz&&!this.$Fz[t]?this.$Fz[t]=2:Error.invalidOperation("Tried to mark calendar as 'error' when the calendar wasn't in the 'loading' state.")},$9cd:function(){var n=this.$Fz;for(var t in n){var i={key:t,value:n[t]};this.$Fz[i.key]=0}},$7rB:function(){var n=0;var i=0;var t=0;var r=this.$Fz;for(var u in r){var f={key:u,value:r[u]};f.value===1?n++:f.value||i++;t++}return i===t&&t>0?0:n===t?3:n>0&&i>0?1:n>0?2:-1},toString:function(){var n=new Sys.StringBuilder("Calendars in CalendarStateTracker: ");var t;var i=this.$Fz;for(var r in i){var u={key:r,value:i[r]};t=_js.$9.$4R("Id = '{0}', State = {1}; ",u.key,u.value);n.append(t)}return n.toString()}};_cc.$9k=function(n,t){this.$k=t;this.$1oP={};this.$1zD=n};function $4j1(n,t){return!!n.$1Mv&&$6nq(n,t)&&n.$1Mv.$59===t.$59&&!!n.$1zD.$1ag(t.get_$i())&&n.$1zD.$1ag(t.get_$i()).get_$x8()}function $6nq(n,t){return!_g.$xQ.isInstanceOfType(t.get_$i())&&t.$1KL==="HTML"}function $6nr(n,t){return t.get_$Lf()!=="RecurringMaster"&&t.get_$3C().get_$3n()==="HTML"}function $6ny(n,t,i){var r=new _cc.$GW(t,i.$Nq);r.$59=i.get_$lq();var u=this;r.add_$2C(function(t){var i=t;$6nt(n,i.$Nq,i.$t)});var f=this;r.add_$1x(function(t){var i=t;$6ns(n,i.$Nq,i.$1f)});var e=this;r.add_$2m(function(t){var i=t;$6nu(n,i.$Nq);_a.$6.acea(null,"GetFullItem")});_a.$6.acsa(_a.$0.$6y,"GetFullItem");n.$k.$z(r)}function $2gq(n,t){var i=n.$1oP[t];i||_js.Trace.logError(_a.$0.$JF,"AsyncResult should not be null for contextId {0}",t);return i}function $6np(n,t){var i=t.$3p();i.set_$7S(null);i.set_$8W(null);i.set_$9F(null);i.set_$3C(null);i.set_$9uZ(null);i.set_$4S(0);return i}function $6nw(n){if(n.$1Mv){var t=n.$1zD.$1ag(n.$1Mv.get_$i());if(!t||!t.get_$x8()){n.$1Mv=null;return}n.$1Mv.$58T||n.$9zZ(t);n.$1Mv=null}}function $6nt(n,t,i){n.$7TM(i,t);for(var u=$2gq(n,t.$59),r=0;r<u.get_$B();r++)try{u.get_$3q(r).get_$4YZ()&&u.get_$3q(r).get_$4YZ()(i)}catch(f){_js.Trace.logWarning(_a.$0.$JF,"Failed to execute one of the asyncResult.SuceedCallback for contextId {0}. Exception: {1}",t.$59,f)}}function $6ns(n,t,i){for(var u=$2gq(n,t.$59),r=0;r<u.get_$B();r++)try{u.get_$3q(r).get_$5MQ()&&u.get_$3q(r).get_$5MQ()(i)}catch(f){_js.Trace.logWarning(_a.$0.$JF,"Failed to execute one of the asyncResult.FailedCallBack for contextId {0}. Exception: {1}",t.$59,f)}}function $6nu(n,t){for(var r=$2gq(n,t.$59),i=0;i<r.get_$B();i++)try{r.get_$3q(i).get_$3if()&&r.get_$3q(i).get_$3if()()}catch(u){_js.Trace.logWarning(_a.$0.$JF,"Failed to execute one of the asyncResult.CompletedCallBack for contextId {0}. Exception: {1}",t.$59,u)}$6nx(n,t.$59)}function $6nx(n,t){for(var r=$2gq(n,t),i=0;i<r.get_$B();i++){var u=r.get_$3q(i);u.$1Q()}delete n.$1oP[t]}function $6nv(n,t){var i;if(n.$1oP[t.get_$lq()])i=n.$1oP[t.get_$lq()];else{i=new(_0365f.$o.$$(_cc.$uM));n.$1oP[t.get_$lq()]=i}i.$D(t);return i.get_$B()>1}_cc.$9k.prototype={$k:null,$1oP:null,$1zD:null,$1Mv:null,$1uq:function(n,t,i,r,u,f,e,o){var s=new _cc.$uM(_cc.$GW.$G3(t,!1,i,r,o),u,f,e);if($4j1(this,s.$Nq)){try{s.get_$4YZ()(this.$1zD.$1ag(t));s.get_$3if()()}finally{s.$1Q()}return null}var h=$6nv(this,s);h||$6ny(this,n,s);return s},$7TM:function(n,t){if($6nr(this,n)&&!$4j1(this,t)){$6nw(this);this.$A0N(n);this.$1Mv=t}},$9zZ:function(n){var t=$6np(this,n);n.$2BV(t.get_$3A())},$A0N:function(n){var t=this.$1zD.$1ag(n.get_$i());t&&t.$2BV(n.get_$3A())}};_cc.$oe=function(n){this.$k=n};_cc.$oe.prototype={$k:null,$E:function(n){return new _cc.$9k(n,this.$k)}};_cc.$S1=function(n){_cc.$S1.initializeBase(this,[n,null])};_cc.$S1.prototype={$1Tp:null,$2U:null,$4Pt:null,$9rm:function(){_js.Trace.logInfo(this.get_$1b(),"Starting refresh timer for shared calendar "+this.get_$r().Id);var n=this;this.$4Pt=_js.$J.get_$I().$oE(this.get_$1b(),"SharedCalendarItemQueryTable",function(){_js.Trace.logInfo(n.get_$1b(),"Will issue a periodic refresh for shared calendar "+n.get_$r().Id);n.$cl()},3e5)},$9s8:function(){_js.Trace.logInfo(this.get_$1b(),"Cancelling refresh timer for shared calendar "+this.get_$r().Id);this.$4Pt=_js.$J.get_$I().$4z(this.$4Pt)},$3KF:function(){_js.Trace.logInfo(this.get_$1b(),"Reloading shared calendar after an action. Folder ID "+this.get_$r().Id);this.$AF();this.$9s8();this.$9rm()},$1wf:function(){var t=this.$2U.$wW(this.$1Tp.get_$A5());if(!t.get_$K4().Read){var n=new _cc.$w5(this.$1Tp);this.$2U.$4Q0(n);return n}return new _cc.$I4}};_cc.$nQ=function(){this.$$d_$9BI=Function.createDelegate(this,this.$9BI);this.$$d_$693=Function.createDelegate(this,this.$693);this.$hg={};this.$1pc={};this.$2FQ=[];this.$1Ij=new Array(9);for(var n=0;n<9;n++)this.$1Ij[n]=0};function $6nQ(n){for(var i=n.$1Ij[0],r=0,t=1;t<9;t++)if(n.$1Ij[t]<i){i=n.$1Ij[t];r=t}return r}_cc.$nQ.prototype={$1Ij:null,$1pc:null,$hg:null,$2FQ:null,$6Oa:function(n){this.$9YX(n);this.$9dE()},$9YX:function(n){var t=n.get_$R();var i=!1;if(t in this.$hg){this.$1Ij[this.$hg[t]]--;delete this.$hg[t]}if(n.get_$bv()===-1)if(t in this.$1pc)n.set_$1K6(this.$1pc[t]);else{Array.add(this.$2FQ,n);i=!0}else{delete this.$1pc[n.get_$R()];n.set_$1K6(n.get_$bv())}if(!i){this.$1Ij[n.$Kh]++;this.$hg[t]=n.$Kh}n.$Y("CalendarColor",this.$$d_$693);n.get_$rC()&&n.get_$3h3()&&n.add_$3g6(this.$$d_$9BI)},$6Mx:function(n,t){var i=n.get_$R();if(i in this.$hg){var r=this.$hg[i];delete this.$hg[i];delete this.$1pc[i];this.$1Ij[r]--}n.$u("CalendarColor",this.$$d_$693);n.get_$rC()&&n.get_$3h3()&&n.remove_$3g6(this.$$d_$9BI);t||n.set_$1K6(n.get_$bv())},$9dE:function(){for(var t=0;t<this.$2FQ.length;t++){var n=this.$2FQ[t];var i=n.get_$R();n.set_$1K6($6nQ(this));this.$1Ij[n.$Kh]++;this.$1pc[i]=this.$hg[i]=n.$Kh}Array.clear(this.$2FQ)},$693:function(n,t){var i=n;this.$6Mx(i,!0);this.$6Oa(i)},$9BI:function(n,t){var i=n.get_$R();if(!i){_js.Trace.logError(_a.$0.$1k,"CalendarColorResolver: Received CacheKey change for linked calendar with ItemId=null: {0}",n.get_$Bd()?n.get_$Bd():"");return}if(t in this.$hg&&i!==t){this.$hg[i]=this.$hg[t];delete this.$hg[t]}else _js.Trace.logError(_a.$0.$1k,"Received CacheKey change event, but could not act on it. CalendarName {0}, InAssignedColorsTable:{1}, OldId:{2}, NewId:{3}",n.get_$Bd()?n.get_$Bd():"",t in this.$hg,t,i);!n.get_$rC()&&n.get_$3h3()&&n.remove_$3g6(this.$$d_$9BI)}};_cc.$uK=function(n,t,i,r,u){this.$A2Q=n;this.$hm=t;this.$4R1=i;this.$1yV=r;this.$1YP=u};_cc.$uK.prototype={$A2Q:null,$hm:null,$4R1:null,$1yV:!1,$1YP:null};_cc.$6x=function(){_cc.$6x.initializeBase(this)};_cc.$6x.$$cctor=function(){_cc.$6x.$2nY.set_$Gu(new _a.$EC(_g.$KS))};_cc.$6x.prototype={get_$i:function(){return this.$U(_cc.$6x.$xV)},set_$i:function(n){this.$K(_cc.$6x.$xV,n);return n},get_$8k:function(){return this.$U(_cc.$6x.$3uy)},set_$8k:function(n){this.$K(_cc.$6x.$3uy,n);return n},get_$Vr:function(){return this.$U(_cc.$6x.$3v0)},set_$Vr:function(n){this.$K(_cc.$6x.$3v0,n);return n},get_$Cp:function(){return this.$U(_cc.$6x.$2nY)},set_$Cp:function(n){this.$K(_cc.$6x.$2nY,n);return n},get_$ql:function(){return this.$U(_cc.$6x.$3v8)},set_$ql:function(n){this.$K(_cc.$6x.$3v8,n);return n}};_cc.$Zq=function(){_cc.$Zq.initializeBase(this)};_cc.$uQ=function(n,t){this.$hm=n;this.$2ol=t};_cc.$uQ.prototype={$hm:null,$2ol:null};_cc.$15C=function(n){this.$Xy=n};_cc.$15C.prototype={$Xy:null,$1uv:function(){return this.$Xy},$1af:function(n){var t=n;return t.unfoldedIndex>0?t.ItemId.Id+"_"+t.unfoldedIndex:t.ItemId.Id}};_cc.$IQ=function(n,t,i,r){this.$$d_$54P=Function.createDelegate(this,this.$54P);_cc.$IQ.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_cc.$IQ.initializeBase(this);this.$35r=n;this.$2U=t;this.$28D=i;this.$56=new _js.$Z;this.$zB=new _js.$Z;this.$4P=r};function $4j2(n,t,i){if(n.$56.$7G(t)||n.$zB.$7G(t))return!1;n.$zB.$D(t);$2gr(n);if(_g.$9G.isInstanceOfType(t)){var r=t;n.$2U.$5hh(r,null,i,n.$$d_$54P)}else n.$54P(t);return!0}function $2gr(n){if(n.$2U.get_$iB()){var i=n.$56.get_$B()+n.$zB.get_$B();if(!i)if(n.$4P){var t=n.$2U.get_$iB();n.$zB.$D(t);n.$4TH&&_js.Trace.logError(_a.$0.$2nZ,"Making attempt to select default calendar twice");var r=this;n.$4TH=n.$4P.$1w(_a.$0.$2nZ,"SelectedCalendarsModel.CalendarPostSelectionCheck",function(){n.$4TH=null;n.$zB.$34(t);n.$56.$D(t);n.$28D.$2kK(t)},0)}else n.$56.$D(n.$2U.get_$iB());n.set_$2GV(i<n.$35r)}}_cc.$IQ.prototype={$2U:null,$28D:null,$35r:0,$4P:null,$56:null,$zB:null,$2GU:!0,$4TH:null,get_$IS:function(){return this.$56},get_$4Mm:function(){return this.$zB},get_$8Is:function(){return this.$35r},get_$2GV:function(){return this.$2GU},set_$2GV:function(n){if(this.$2GU!==n){this.$2GU=n;$3(this,"CanSelectMoreCalendars")}return n},$3zc:function(n){return this.$56.$7G(n)||this.$zB.$7G(n)},$4TE:function(n,t){if(this.$2GU&&$4j2(this,n,t)){this.$28D.$4TE(n);return!0}return!1},$6Rv:function(n){var t=this.$2U.$3sg(n);if(t)this.$4TE(t,null);else{var i=_g.$9G.$2q3(n,n,!0);this.$28D.$2kK(i)}},$3Sa:function(n){if(this.$56.$34(n)||this.$zB.$34(n)){$2gr(this);this.$28D.$3Sa(n)}},$9dY:function(n){var t=this;this.$28D.$9dX(n,this.$35r,function(n){$4j2(t,n,null)});$2gr(this)},$54P:function(n){var t=n?n.get_$Bd()||"":"null";this.$2U.$wW(n.get_$A5())&&this.$2U.$2o2(n)&&this.$56.$D(n);this.$zB.$34(n);$2gr(this)}};_cc.$Pz=function(n,t,i,r){this.$$d_$9R1=Function.createDelegate(this,this.$9R1);this.$ny=n;this.$5ZT=t;this.$c=i;this.$k=r;this.$m2=this.get_$4TK()};function $4j3(n,t){n.set_$4TK(t);n.$5ZT||_h.$2J.$po(n.$c.get_$5M().get_$Te(),n.$k)}function $6o2(n,t,i){for(var r=0,u=t.get_$B();r<u;r++){var f=t.get_$3q(r);if(f.get_$i().Id===i)return r}return-1}_cc.$Pz.prototype={$c:null,$ny:0,$5ZT:!1,$k:null,$m2:null,get_$4TK:function(){switch(this.$ny){case"Mouse":return this.$c.get_$5M().get_$6RK();case"TouchWide":return this.$c.get_$5M().get_$6RN();default:return this.$c.get_$5M().get_$6RM()}},set_$4TK:function(n){switch(this.$ny){case"Mouse":this.$c.get_$5M().set_$6RK(n);break;case"TouchWide":this.$c.get_$5M().set_$6RN(n);break;default:this.$c.get_$5M().set_$6RM(n);break}return n},$5Bt:function(){$4j3(this,new(_a.$W.$$(String))(this.$m2.$6Z()))},$4TE:function(n){this.$m2&&!this.$m2.$7G(n.get_$i().Id)&&(n.get_$rC()&&!n.get_$Xs()?n.$Y("ItemId",this.$$d_$9R1):this.$2kK(n))},$3Sa:function(n){if(this.$m2)if(n.get_$rC()&&!n.get_$Xs())n.$u("ItemId",this.$$d_$9R1);else{this.$m2.$34(n.get_$i().Id);this.$5Bt()}},$9dX:function(n,t,i){this.$m2=this.get_$4TK();if(this.$m2){for(var r=new(_a.$W.$$(String)),u=0,o=this.$m2.get_$B();u<o;u++){var f=$6o2(this,n,this.$m2.get_$3q(u));if(f>-1){if(r.get_$B()>=t){_js.Trace.logWarning(_a.$0.$2nZ,"RestoreCalendarsSelectionFromViewState: We attempted to re-select more than the maximum number of calendars. Was the ViewState corrupted?");break}var e=n.get_$3q(f);r.$D(e.get_$i().Id);i(e)}}this.$m2=r;$4j3(this,this.$m2)}},$2kK:function(n){this.$m2.$D(n.get_$i().Id);this.$5Bt()},$9R1:function(n,t){var i=n;if(!i.get_$rC()){this.$2kK(i);i.$u("ItemId",this.$$d_$9R1)}}};_cc.$OX=function(n){this.$2k=n};_cc.$OX.$5Tx=function(n,t){t.$iw&&t.$cl()};_cc.$OX.prototype={$2k:null,$1ZU:null,get_$3QM:function(){var n=new _g.$At;n.NotificationType="CalendarItemNotification";n.FolderId=this.$2k;return n},get_$Ko:function(){return _a.$0.$2kp},get_$Bw:function(){return"AgendaNotificationStrategy"},get_$3gk:function(){return 2},$3vK:function(n,t){this.$1ZU||(this.$1ZU=this.$7cC(n,t))},$7cC:function(n,t){var i=this;return _js.$J.get_$I().$1w(t.get_$1b(),"AgendaNotificationStrategy",function(){_cc.$OX.$5Tx(n,t);i.$1ZU=null},_cc.$OX.$2ZE)}};_cc.$16T=function(n,t){_cc.$16T.initializeBase(this,[n,new _cc.$wB(n.get_$r().Id,t)])};_cc.$5Y=function(n){this.$1Rw={};this.$k0=new(_0365f.$o.$$(_g.$Zs));this.$2zW={};this.$3K=new _g.$At;this.$3K.NotificationType="CalendarItemNotification";this.$3K.FolderId=n};_cc.$5Y.get_$1b=function(){return _a.$0.$3gR};function $6nb(n,t,i){if($4iv(n,t)){n.$k0.$1r();n.$k0.$D(t);$2go(n);$3Vo(n,i)}else{for(var u=n.$k0.get_$B()-1;u>=0;u--){var o=n.$k0.get_$3q(u).Item;var f="";var e="";if($6(t.Item.InstanceKey)||_js.$9.$a(t.Item.InstanceKey)){e=t.Item.ItemId.Id;f=o.ItemId.Id}else{e=t.Item.InstanceKey;f=o.InstanceKey}if(e===f){n.$k0.$68(u);break}}var s=!1;if(!$6(t.Item.InstanceKey)&&!_js.$9.$a(t.Item.InstanceKey))if(t.EventType==="RowModified"&&t.Item.CalendarItemType==="RecurringMaster")$6(t.Item.UID)||(n.$2zW[t.Item.InstanceKey]=t.Item.UID);else if(t.EventType==="RowDeleted"){var h=n.$2zW[t.Item.InstanceKey];delete n.$2zW[t.Item.InstanceKey];if(!$6(h))for(var r=n.$k0.get_$B()-1;r>=0;r--){var c=n.$k0.get_$3q(r).Item.UID;if(n.$k0.get_$3q(r).EventType==="RowAdded"&&c===h){n.$k0.get_$3q(r).$2Nx=t.Item.InstanceKey;s=!0;break}}}s||n.$k0.$D(t)}}function $2go(n){n.$1ZU=_js.$J.get_$I().$4z(n.$1ZU)}function $4iv(n,t){return t.EventType==="Reload"||t.Reload}function $4iu(n,t,i){if(i.$iw&&i.get_$r().Id===t.FolderId){t.Item&&!t.Item.__type&&(t.Item.__type="CalendarItem:#Exchange");$4iv(n,t)?i.$cl():t.EventType==="RowDeleted"?$6nd(n,i,t):t.Item.CalendarItemType==="RecurringMaster"?$6nc(n,i,t):$6ne(n,i,t)}}function $3Vo(n,t){for(var r=n.$k0.get_$B(),i=0;i<r;i++){var u=n.$k0.get_$3q(i);$4iu(n,u,t)}n.$k0.$1r();$2go(n)}function $6nd(n,t,i){var r=t.$3l3(i.Item);var s=String.format("Will handle a RowDeleted notification for instance key {0}",r.get_$Ea());r.get_$Ea()in n.$1Rw&&delete n.$1Rw[r.get_$Ea()];if(r.get_$i()&&r.get_$i().Id)if(r.get_$Lf()!=="RecurringMaster"){var e=t.$3r0(r);e!==-1&&t.$1t.$68(e)}else r.get_$Ea()?t.$27H(r.get_$Ea(),null):t.$cl();else for(var u=t.$1t.get_$B()-1;u>=0;u--){var f=t.$1t.get_$3q(u);var o=f.get_$Ea();if($6(o)){t.$cl();return}if(o===r.get_$Ea()){t.$1t.$68(u);if(!$6(f.get_$Lf())&&f.get_$Lf()==="Single")return}}}function $6nc(n,t,i){var r=i.Item;if(!$6(t.$8p))if($6(r.UID))t.$cl();else{var e=new _g.$1q(r.ItemId.Id);var f=new _h.$7U(e);f.$ED=t.$8p;var u=new _cc.$C7(300,f,r.InstanceKey);var o=this;u.add_$2C(function(r){$6nh(n,r,t,$6(i.$2Nx)?null:i.$2Nx)});var s=this;u.add_$1x(function(r){$6ng(n,r,t,$6(i.$2Nx)?null:i.$2Nx)});var h=this;u.add_$2m(function(t){$6nf(n,t)});r.InstanceKey in n.$1Rw;n.$1Rw[r.InstanceKey]=u;OwaApplication.$1W.$z(u)}}function $3Vp(n,t){return t.$28e in n.$1Rw&&n.$1Rw[t.$28e]===t}function $6nf(n,t){$3Vp(n,t)&&delete n.$1Rw[t.$28e]}function $6nh(n,t,i,r){if($3Vp(n,t)&&!$6(i.$1t)){var o=t.get_$1y();if(!o.$ED.$4e(i.$8p)){i.$cl();return}!$6(r);i.$27H(t.$28e,r);var e=0;if(!$6(t.get_$1Cl()))for(var u=0;u<t.get_$1Cl().get_$B();u++){var f=t.get_$1Cl().get_$3q(u);e=i.$2kU(f);if(e===-1){_js.Trace.logWarning(_cc.$5Y.get_$1b(),"Couldn't find index to insert instance of series. Id={0}. UID={1}. Reloading",f.get_$i().Id,f.get_$18c());i.$cl();break}}}}function $6ng(n,t,i,r){if($3Vp(n,t)){var u=t.$1f.responseCode;if(u==="ErrorItemNotFound"){_js.Trace.logWarning(_cc.$5Y.get_$1b(),"Action [{0}] to expand recurring series failed with item not found. Since the item isn't on the server, we will remove the series. Error: {1}",t.$1n_2,t.$1f);!$6(r);i.$27H(t.$28e,r)}else{_js.Trace.logWarning(_cc.$5Y.get_$1b(),"Action [{0}] to expand recurring series failed. Will reload the table. Error: {1}",t.$1n_2,t.$1f);i.$cl()}}}function $6ne(n,t,i){var r=t.$3l3(i.Item);switch(i.EventType){case"RowAdded":t.$3cj(r,0,!1);break;case"RowDeleted":_js.Trace.logError(_cc.$5Y.get_$1b(),"RowDeleted notifications should have been handled by the HandleRowDeletedNotification method.");break;case"RowModified":var u=!i.Item.InstanceKey||r.get_$GC()?0:1;t.$3cj(r,u,!1);break;default:_js.Trace.logWarning(_cc.$5Y.get_$1b(),"Unsupported notification type");break}}_cc.$5Y.prototype={$3K:null,$4Oq:!0,$1ZU:null,get_$3QM:function(){return this.$3K},get_$Ko:function(){return _cc.$5Y.get_$1b()},get_$Bw:function(){return"CalendarNotificationStrategy"},get_$3gk:function(){return 2},$3QX:function(){$2go(this);this.$4Oq=!1},$3LH:function(n){this.$4Oq=!0;$3Vo(this,n)},$3vK:function(n,t){var i=n;var r=n;if(r.clientGenerated)$4iu(this,i,t);else{$6nb(this,i,t);if(this.$4Oq){this.$1ZU&&$2go(this);var u=this;this.$1ZU=_js.$J.get_$I().$1w(_cc.$5Y.get_$1b(),"CalendarNotificationStrategy",function(){$3Vo(u,t)},_cc.$5Y.$2ZE)}}}};_cc.$wB=function(n,t){_cc.$wB.initializeBase(this,[n]);this.$1PL=t};_cc.$wB.prototype={$1PL:null,get_$1Dt:function(){return this.$1PL}};_cc.$7L=function(){};_cc.$7L.$7XP=function(n,t){var i=n;var r=t;var u=i.get_$51().$2R(r.get_$51());return u?u:_cc.$7L.$3ib(i,r)};_cc.$7L.$vU=function(n,t){return _cc.$7L.$3ib(n,t)};_cc.$7L.$3ib=function(n,t){var i=t.get_$AW()-n.get_$AW();if(i)return i;i=_cc.$7L.$2vu(t)-_cc.$7L.$2vu(n);if(i)return i;i=n.get_$y().$5z(t.get_$y());if(i)return i;i=(n.get_$5k()&&n.get_$5k().get_$1c1()?0:1)-(t.get_$5k()&&t.get_$5k().get_$1c1()?0:1);if(i)return i;i=_cc.$7L.$35d(n.get_$9S())-_cc.$7L.$35d(t.get_$9S());if(i)return i;i=t.get_$1u().$5z(n.get_$1u());return i?i:_cc.$7L.$5C3(n,t)};_cc.$7L.$5C3=function(n,t){return $6(n.get_$2i())?$6(t.get_$2i())?0:1:$6(t.get_$2i())?-1:n.get_$2i().localeCompare(t.get_$2i())};_cc.$7L.$35d=function(n){switch(n){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}};_cc.$7L.$2vu=function(n){var t=n.get_$1u().$5z(n.get_$y());return t>864e5?Math.ceil(t/864e5):1};_cc.$S3=function(n,t){_cc.$S3.initializeBase(this);this.$2E=n;this.$1CN=t};_cc.$S3.prototype={$2E:null,$1CN:null,$6g:!1,get_$8k:function(){return this.$1CN},get_$q:function(){return this.$6g},set_$q:function(n){if(this.$6g!==n){this.$6g=n;$3(this,"IsHidden")}return n}};CalendarCoreComponent.registerClass("CalendarCoreComponent",null,_a.$1In);_cc.$5g.registerClass("_cc.$5g");_cc.$uw.registerClass("_cc.$uw",_cc.$EV.$$(_g.$QJ));_cc.$9e.registerClass("_cc.$9e",_h.$1Ku);_cc.$ux.registerClass("_cc.$ux",_cc.$EV.$$(_g.$Vi));_cc.$v4.registerClass("_cc.$v4",_cc.$EV.$$(_g.$F6));_cc.$v5.registerClass("_cc.$v5",_cc.$EV.$$(_g.$F6));_cc.$og.registerClass("_cc.$og",_cc.$EV.$$(_g.$WX));_cc.$GW.registerClass("_cc.$GW",_h.$ol);_cc.$oh.registerClass("_cc.$oh");_cc.$I4.registerClass("_cc.$I4",_cc.$oi.$$(_g.$Kk,_g.$P0));_cc.$15H.registerClass("_cc.$15H",_cc.$EV.$$(_g.$Jh));_cc.$C7.registerClass("_cc.$C7",_h.$JQ.$$(_g.$Qo,_g.$Xb));_cc.$w5.registerClass("_cc.$w5",_cc.$oi.$$(_g.$NM,_g.$NN),_cc.$17L);_cc.$zZ.registerClass("_cc.$zZ",_cc.$EV.$$(_g.$QJ));_cc.$za.registerClass("_cc.$za",_cc.$EV.$$(_g.$Vi));_cc.$Fg.registerClass("_cc.$Fg",_h.$SL);_cc.$IW.registerClass("_cc.$IW",_h.$24);_cc.$uM.registerClass("_cc.$uM",null,Sys.IDisposable);_cc.$6d.registerClass("_cc.$6d",_h.$24);_cc.$Zt.registerClass("_cc.$Zt",_cc.$6d);_cc.$Ay.registerClass("_cc.$Ay",_js.$8,_cc.$1Fa);_cc.$My.registerClass("_cc.$My",_js.$8);_cc.$1Q.registerClass("_cc.$1Q",_a.$1,_g.$1Hm,_h.$185);_cc.$8g.registerClass("_cc.$8g",_a.$Qe);_cc.$12S.registerClass("_cc.$12S");_cc.$9k.registerClass("_cc.$9k");_cc.$oe.registerClass("_cc.$oe");_cc.$S1.registerClass("_cc.$S1",_cc.$6d);_cc.$nQ.registerClass("_cc.$nQ");_cc.$uK.registerClass("_cc.$uK");_cc.$6x.registerClass("_cc.$6x",_a.$9I);_cc.$Zq.registerClass("_cc.$Zq",_js.$Z);_cc.$uQ.registerClass("_cc.$uQ");_cc.$15C.registerClass("_cc.$15C",null,_h.$1G6);_cc.$IQ.registerClass("_cc.$IQ",_a.$1,_cc.$R1,_js.$x6);_cc.$Pz.registerClass("_cc.$Pz");_cc.$OX.registerClass("_cc.$OX",null,_h.$17s);_cc.$16T.registerClass("_cc.$16T",_cc.$Zt);_cc.$5Y.registerClass("_cc.$5Y",null,_h.$17s);_cc.$wB.registerClass("_cc.$wB",_cc.$5Y,_h.$17N,_h.$17s);_cc.$7L.registerClass("_cc.$7L");_cc.$S3.registerClass("_cc.$S3",_a.$F2,_0365m.$FQ);_cc.$5g.$A=_a.$0.$3gC;_cc.$5g.$6Z6="ErrorCode";_cc.$5g.$3SO="__type";_cc.$5g.$6Og="responseCode";_cc.$9e.$14Y=new _H("Item",_g.$33,_cc.$9e);_cc.$9e.$4UF=new _H("SendMeetingInvitations",_h.$Zr,_cc.$9e);_cc.$9e.$Rr=_cc.$9e.$7eb();_cc.$GW.$5HL="HTML";_cc.$I4.$Rr=null;_cc.$I4.$$cctor();_cc.$C7.$1Cb=new _H("Id",_h.$7U,_cc.$C7);_cc.$C7.$3yV=new _H("CalendarItemCollection",_cc.$Zq,_cc.$C7);_cc.$C7.$Rr=null;_cc.$1Q.$41O=new _H("IsLoaded",Boolean,_cc.$1Q);_cc.$1Q.$2l0=new _H("AllCalendars",_js.$Z,_cc.$1Q);_cc.$1Q.$4St=new _H("SearchedCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$4Ne=new _H("PinnedModernGroupsCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$44K=new _H("JoinedModernGroupsCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$4dh=new _H("VisitedModernGroupsCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$3rE=new _H("FirstLevelModernGroupsCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$4Lk=new _H("OtherCalendarsGroup",_cc.$6x,_cc.$1Q);_cc.$1Q.$3mX=new _H("DefaultCalendar",_g.$KS,_cc.$1Q);_cc.$1Q.$3Eb=null;_cc.$1Q.$v=null;_cc.$1Q.$$cctor();_cc.$8g.$3gI=new _H("CalendarEntryModel",_g.$KS,_cc.$8g);_cc.$8g.$3gQ=new _H("CalendarModel",_g.$Sj,_cc.$8g);_cc.$8g.$20Q=new _H("MasterCategoryList",_g.$Bs,_cc.$8g);_cc.$8g.$3zZ=new _H("IsCalendarFolderConfigurationRetrieved",Boolean,_cc.$8g);_cc.$8g.$1z1=new _H("IsValid",Boolean,_cc.$8g,!0);_cc.$6x.$xV=new _H("ItemId",_g.$1q,_cc.$6x);_cc.$6x.$3uy=new _H("GroupId",String,_cc.$6x);_cc.$6x.$3v0=new _H("GroupName",String,_cc.$6x);_cc.$6x.$3v8=new _H("GroupType",_g.$12E,_cc.$6x);_cc.$6x.$2nY=new _H("Calendars",_js.$Z,_cc.$6x);_cc.$6x.$$cctor();_cc.$OX.$2ZE=_cc.$5Y.$2ZE;_cc.$5Y.$2ZE=1.5*1e3