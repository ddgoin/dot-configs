Type.registerNamespace("_c");_c.$19I=function(){};_c.$19I.registerInterface("_c.$19I");_c.$19H=function(){};_c.$19H.registerInterface("_c.$19H");_c.$gP=function(){};_c.$gP.registerInterface("_c.$gP");_c.$Fn=function(n,t){this.$2Wm=7;_c.$Fn.initializeBase(this,[n,t])};function $6Gj(n,t){_a.$3.$M(t,"folderId");for(var i=!0,u=n.get_$pE(),f=n.get_$pE(),e=f.length,r=0;r<e;++r){var o=f[r];if(o.FolderId===t){_js.Trace.logWarning(_c.$8n.$IR,"Trying to add an already existing folder to the SyncFolderSetting, folderId = {0}",t);return i}}if(n.get_$66r()<_h.$1y.$fK){Array.add(u,new SyncFolderListItem(t,_a.$7.$Eb(_a.$7.get_$2M())));n.set_$pE(u)}else{i=!1;$2TX(n,new _g.$3J(t));_js.Trace.logWarning(_c.$8n.$IR,"Not adding folder to the sync list because syncing max ({0}) number of email folders for this client.",_h.$1y.$fK);n.$3lT("",_a.$b.$8E,!1,!0)}return i}function $4K2(n,t,i,r){var u=t.$Pe(i);u&&u.set_$65T(r)}function $4K1(n,t,i,r,u,f){f.val=0;var h=0;var e=n.$4zw(r,i);if(t){for(var o=0;o<t.length;o++){var s=t[o];if(($6Gi(n,s)||!u)&&(r===-1||$3EF(n,s.FolderId,r))){$4Kd(n,i,s.FolderId,e);h++}}f.val=t.length-h}_a.$3.$8z(!!e,"activelySyncingFolderListForModule can never be null. At the least it should have default list of folders.");return e}function $6Gi(n,t){var i=_a.$7.$4Y(t.LastAccessTime);var r=_a.$7.get_$2M();var u=new _a.$Kb(i,r);return Math.floor(u.get_$pM())<=n.$2Wm}function $6Gh(n,t,i,r,u){var f=new _a.$Kb(t.$3u(),i.$3u());if(f.get_$pM()>n.$2Wm){u(!0);var e=new _c.$zM;e.set_$8QV(f.get_$pM());r.$A7(e);return}u(!1)}_c.$Fn.prototype={$1cA:null,get_$pE:function(){this.$1cA||(this.$1cA=_a.$69.$9I1(Array,this.$4N,"SyncFolders.Mail.AutoSelected"));this.$1cA||(this.$1cA=new Array(0));return this.$1cA},set_$pE:function(n){this.$4N.$Bp("SyncFolders.Mail.AutoSelected",JsonParser.serialize(n));this.$1cA=n;return n},get_$66r:function(){var n;var t,i;return(i=this.$7Hn(null,-1,t={val:n}),n=t.val,i).length},$34H:function(){_js.Trace.logInfo(_c.$8n.$IR,"Remove AutoSelectedMailSyncFolders settings");for(var t=this.get_$pE(),i=t.length,n=0;n<i;++n){var r=t[n];$2TX(this,new _g.$3J(r.FolderId))}this.$4N.$BB("SyncFolders.Mail.AutoSelected")},$7Hn:function(n,t,i){return $4K1(this,this.get_$pE(),n,t,!0,i)},$6qI:function(n,t,i){_a.$3.$M(n,"folderId");_a.$3.$M(t,"successCallback");$6Gj(this,n)?t():i(Error.create("Failed to add folder into the sync list"))},$7OZ:function(n){var t;var i,r;return r=$4K1(this,this.get_$pE(),null,n,!1,i={val:t}),t=i.val,r},$9EC:function(n,t){_a.$3.$M(n,"folder");for(var i=this.get_$pE(),u=0;u<i.length;u++){var e=i[u];if(e.FolderId===n.get_$n().Id){var f=_a.$7.$4Y(e.LastAccessTime);var r=_a.$7.get_$2M();var o=new _a.$Kb(f.$3u(),r.$3u());if(o.get_$pM()>this.$2Wm&&this.get_$66r()>=_h.$1y.$fK){_js.Trace.logInfo(_c.$8n.$IR,"Already syncing {0} email folders for this client. This is the max allowed limit.",_h.$1y.$fK);Array.removeAt(i,u);this.set_$pE(i);$2TX(this,n.get_$n());t(!1)}else if(r.get_$4M()!==f.get_$4M()||r.get_$3D()!==f.get_$3D()||r.get_$5z()!==f.get_$5z()){i[u]=new SyncFolderListItem(n.get_$n().Id,_a.$7.$Eb(r));this.set_$pE(i);$6Gh(this,f,r,_a.$b.$8E,t)}else t(!1);break}}},$2AK:function(n,t,i){_a.$3.$M(i,"completeCallback");var r;var u,f;var e=(f=this.$7Hn(t,n,u={val:r}),r=u.val,f);i(e)},$5HH:function(n,t,i){this.$3lT(n,t,i)},$6AX:function(n,t,i){_a.$3.$M(n,"allFolderIds");_a.$3.$M(t,"successCallback");_a.$3.$M(i,"errorCallback");for(var f=!1,u=this.get_$pE(),e=[],r=0;r<u.length;r++)u[r].FolderId in n?Array.add(e,u[r]):f=!0;if(f){_js.Trace.logWarning(_c.$8n.$IR,"SyncFolderSetting needs to be updated based on folder hierarchy sync results.");this.set_$pE(e)}t()},$5zM:function(n){_a.$3.$M(n,"folderTable");for(var u=_h.$1y.get_$2dG(),r=u,f=r.length,t=0;t<f;++t){var e=r[t];$4K2(this,n,new _g.$3J(e),2)}for(var i=0;i<this.get_$pE().length;i++){var o=this.$1cA[i];$4K2(this,n,new _g.$3J(o.FolderId),1)}},$3lT:function(n,t,i,r){var u=new _c.$v3;var f;var e,o;var s=(o=this.$7Hn(null,-1,e={val:f}),f=e.val,o);u.set_$5gR(f);u.set_$4dV(s.length);u.set_$fL(n);u.set_$5Iz(_h.$1y.$fK);u.set_$59M($8(i)?!1:i);u.set_$5J0($8(r)?!1:r);u.set_$6AK(!1);t.$A7(u)}};_c.$8n=function(n,t){_a.$3.$M(n,"localStorageAdapter");_a.$3.$M(t,"eventAggregator");this.$4N=n;this.$S=t};function $3EF(n,t,i){var r=_g.$S.get_$L().get_$4r().$Wm(new _g.$3J(t));if(r.$Av===1&&(i===11||i===4))return!0;else if((r.$Av===2||r.$Av===3)&&(i===12||i===5))return!0;return!1}function $4Kd(n,t,i,r){t&&i===t.Id?Array.insert(r,0,i):Array.add(r,i)}function $2TX(n,t){var i=_g.$S.get_$L().get_$4r().$Wm(t);var r=-1;i.$Av===1?r=4:(i.$Av===2||i.$Av===3)&&(r=5);n.$S.$8oV(_h.$hk,new _h.$hk(r,new _bc.$Ga(t)))}_c.$8n.prototype={$4N:null,$S:null,$4zw:function(n,t){for(var r=new Array(0),f=_h.$1y.get_$2dG(),e=f.length,u=0;u<e;++u){var i=f[u];(n===-1||$3EF(this,i,n))&&(t&&i===t.Id?Array.insert(r,0,i):Array.add(r,i))}return r}};_c.$vQ=function(n,t){_c.$vQ.initializeBase(this,[n,t])};_c.$vQ.prototype={$bT:null,get_$1FI:function(){this.$bT||(this.$bT=_a.$69.$9I1(Array,this.$4N,"SyncFolders.Mail.UserSelected"));this.$bT||(this.$bT=new Array(0));return this.$bT},set_$1FI:function(n){if(n){this.$4N.$Bp("SyncFolders.Mail.UserSelected",JsonParser.serialize(n));this.$bT=n}return n},$34H:function(){_js.Trace.logInfo(_c.$8n.$IR,"Remove UserSelectedSyncFolders settings");for(var t=this.get_$1FI(),i=t.length,n=0;n<i;++n){var r=t[n];$2TX(this,new _g.$3J(r))}this.$4N.$BB("SyncFolders.Mail.UserSelected")},$7Hn:function(n,t,i){for(var u=this.$4zw(t,n),f=this.get_$1FI(),o=f.length,r=0;r<o;++r){var e=f[r];(t===-1||$3EF(this,e,t))&&$4Kd(this,n,e,u)}i.val=0;return u},$7OZ:function(n){var t;var i,r;return r=this.$7Hn(null,n,i={val:t}),t=i.val,r},$5HH:function(n,t,i){var r=new _c.$v3;r.set_$5gR(this.get_$1FI().length);r.set_$4dV(this.get_$1FI().length);r.set_$fL(n);r.set_$5Iz(_h.$1y.$fK);r.set_$59M($8(i)?!1:i);r.set_$5J0(!1);r.set_$6AK(!0);t.$A7(r)},$2AK:function(n,t,i){_a.$3.$M(i,"completeCallback");var r;var u,f;var e=(f=this.$7Hn(t,n,u={val:r}),r=u.val,f);i(e)},$6AX:function(n,t,i){_a.$3.$M(n,"allFolderIds");_a.$3.$M(t,"successCallback");_a.$3.$M(i,"errorCallback");for(var u=!1,f=[],e=this.get_$1FI(),s=e.length,r=0;r<s;++r){var o=e[r];o in n?Array.add(f,o):u=!0}if(u){_js.Trace.logWarning(_c.$8n.$IR,"SyncFolderSetting needs to be updated based on folder hierarchy sync results.");this.set_$1FI(f)}t()}};_c.$uG=function(n){_c.$uG.initializeBase(this,[5,0,!0,n])};_c.$uG.prototype={get_$1y:function(){return"Refresh"},get_$78K:function(){return!1},$48Z:function(n){return n.$91s()}};_c.$1D8=function(n,t,i,r){_c.$1D8.initializeBase(this,[n,0,i,r]);this.$2i=t};_c.$1D8.prototype={$2i:null,get_$1y:function(){return this.$2i}};_c.$hg=function(n){_c.$hg.initializeBase(this,[6,0,!0,n])};_c.$hg.prototype={get_$78K:function(){return!1},get_$3gj:function(){return!0},$48Z:function(n){return n.$91q()}};_c.$us=function(n){this.$$d_$3bY=Function.createDelegate(this,this.$3bY);var t=this;n.$HX(_a.$VG,function(){t.$3bY(new _a.$ba(!0))});n.$HX(_a.$ba,this.$$d_$3bY);var i=this;n.$HX(_a.$nD,function(){i.$3bY(new _a.$ba(!0))})};_c.$us.prototype={$3x:null,$3hv:!1,$4Bx:!1,$3v:function(n){this.$3x=n},$3bS:function(n){if(this.$3x){this.$3x.$Ar();if(this.$3hv){_c.$1q.$4w("Pending get request is alive, starting full sync");this.$3x.$1MR(n)}else{if(this.$3x.get_$1GQ())_c.$1q.$4w("Pending get request is not alive and in ALT1, will start full sync when it comes alive");else{_c.$1q.$4w("Pending get request is not alive, starting quick sync now and full sync when it comes alive");_a.$m.set_$2R8(_a.$PY.toString(n));this.$3x.$643()}this.$4Bx=!0}}},$3bY:function(n){_c.$1q.$4w("Pending get request alive changed to {0}",n.$3iV);this.$3hv=n.$3iV;if(this.$4Bx&&this.$3hv){_c.$1q.$4w("Pending get just came alive -> starting sync");this.$4Bx=!1;this.$3x.$1MR(4)}}};_c.$iT=function(n,t){_c.$iT.initializeBase(this,[n,t])};function $4Kq(n,t,i){var u=t;if(i.ModuleSpecificContext)for(var f=i.ModuleSpecificContext,o=f.length,r=0;r<o;++r){var e=f[r];if(e.FolderId.Id===u.FolderId.Id)return e}_js.Trace.logInfo(_c.$1b.$D,"We can't find the folderEntry inside Conversation SyncState for folder:{0}",u.FolderId.Id);return null}_c.$iT.prototype={$7LD:function(n,t){var i=null;var r=$4Kq(this,n,t);r&&(i=r.LastSuccessfulSyncTime);return i},$3P6:function(n,t){_a.$3.$8z(_bc.$Ga.isInstanceOfType(n),"The context type should match the module.");var i=n;_a.$3.$M(i.FolderId,"Invalid call to IsSynced with no folder ID specified.");if(t){var r=$4Kq(this,n,t);return!!r}return!1},$3al:function(){return"ConversationSyncStateId"},$8qd:function(n,t){if(t.ModuleSpecificContext){for(var r=t.ModuleSpecificContext,i=0;i<r.length;i++){var u=r[i];if(u.FolderId.Id===n)break}if(i!==r.length){_js.Trace.logInfo(_c.$1b.$D,"Removing Folder {0} Conversation SyncState",n);Array.removeAt(r,i)}}}};_c.$1D7=function(n,t){_c.$1D7.initializeBase(this,[n,t])};_c.$1D7.prototype={get_$65Q:function(){return 0},$5su:function(n){_a.$3.$8z(_bc.$Ga.isInstanceOfType(n),"The context type should match the module.");var t=n;_a.$3.$M(t.FolderId,"Invalid call to IsSynced with no folder ID specified.");var i=this,r=this;this.$Np.get_$Y1().$3BI(function(n){i.$8qd(t.FolderId.Id,n)},function(){})},$7LB:function(n,t){_a.$3.$8z(_bc.$Ga.isInstanceOfType(n),"The context type should match the module.");var u=n;_a.$3.$M(u.FolderId,"Invalid call to IsSynced with no folder ID specified.");var i=null;var r=this,f=this;this.$Np.$2iL(function(u){u?i=r.$7LD(n,u):_js.Trace.logInfo(_c.$1b.$D,"Getting null SyncState for {0}",r.$3al());t(i)},function(){t(i)})}};_c.$Rc=function(n){this.$u0={};this.$1Zi={};_a.$3.$6v(n,1,50,"maxNotifications");this.$5Iu=n;this.$20H=0};function $6Hy(n,t,i){if(t===1){var f=n.$u0[i];if(f){n.$20H-=f.length;n.$1Zi[i]=f;delete n.$u0[i]}}else if(t===3){var e=n.$1Zi[i];if(e){for(var o;o=Array.dequeue(e);)n.$32X&&n.$32X(o);delete n.$1Zi[i];e=null}}else if(t===6){var u=n.$1Zi[i];if(u){_js.Trace.logWarning(_a.$0.$fp,"Discarding notifications due to abort event Notification id : {0}, Total Count: {1}",i,u.length);Array.clear(u);u=null;delete n.$1Zi[i]}}else if(t===4){var r=n.$u0[i];if(r){_js.Trace.logWarning(_a.$0.$fp,"Discarding notifications due to canceled event Notification id : {0}, Total Count: {1}",i,r.length);n.$20H-=r.length;Array.clear(r);r=null;delete n.$u0[i]}}}function $4Kg(n,t){var r=new(_0365f.$s.$$(_a.$bK));var u=t;for(var f in u){var e={key:f,value:u[f]};var i=e.value;if(i)while(i.length>0){var o=Array.dequeue(i);var s=new _a.$bK(e.key,o.EventType,!1);r.$H(s)}}return r}_c.$Rc.prototype={$5Iu:0,$32X:null,$20H:0,$2fS:function(n,t){_a.$3.$1C(n,"id");_a.$3.$M(t,"notification");if(this.$20H<this.$5Iu){this.$20H++;var i=this.$u0[n];if(!i){i=[];this.$u0[n]=i}Array.enqueue(i,t);return!0}_js.Trace.logWarning(_a.$0.$fp,"Max Notification Queue limit reached.");return!1},$6yB:function(){_js.Trace.logWarning(_a.$0.$fp,"Clear Sync Notification Queue");var t=this.$u0;for(var i in t){var r={key:i,value:t[i]};var n=this.$u0[r.key];if(n){Array.clear(n);delete this.$u0[r.key];n=null}}this.$20H=0},$8pp:function(n){_a.$3.$M(n,"postSyncCallback");this.$32X=n},$9Ca:function(){this.$32X=null},$7Mw:function(){var n=_0365f.$57.$46(this.$u0);return $4Kg(this,n)},$7Mt:function(){var n=_0365f.$57.$46(this.$1Zi);return $4Kg(this,n)},$8ne:function(n){_a.$3.$M(n,"e");if(!_js.$8.$c(n.$1YA)){_js.Trace.logInfo(_a.$0.$fp,"Processing sync event type: {0} for notification sync context id: {1}",n.$N4,n.$1YA);$6Hy(this,n.$N4,n.$1YA)}}};_c.$17T=function(n,t){_c.$17T.initializeBase(this,[n,t,"CalendarItemNotification"])};_c.$17T.prototype={$7RN:function(n,t,i){var r=n;if($8(r.FolderId)){_js.Trace.logInfo(_a.$0.$5v,String.format("Rejecting CalendarItem notification with null FolderId : {0}",r.id));i(n);return}var u=new _c.$Qu(r.FolderId,this.$3x.get_$1GQ(),this.$37);if(this.$3x.$372(u,r.EventType==="Reload")){$2Tc(this,r,u);return}i(r);this.$3x.$ur(u)}};_c.$17d=function(n,t,i,r,u){this.$$d_$3bf=Function.createDelegate(this,this.$3bf);this.$$d_$8gg=Function.createDelegate(this,this.$8gg);this.$$d_$7Rg=Function.createDelegate(this,this.$7Rg);this.$$d_$7Rv=Function.createDelegate(this,this.$7Rv);this.$$d_$8bt=Function.createDelegate(this,this.$8bt);this.$$d_$3be=Function.createDelegate(this,this.$3be);this.$$d_$7QH=Function.createDelegate(this,this.$7QH);_c.$17d.resolveInheritance();this.dispose=this.$1M;_c.$17d.initializeBase(this);_a.$3.$M(n,"syncManager");_a.$3.$M(r,"dataPointTracker");this.$3x=n;this.$S=t;this.$AS=i;this.$4qf=r;this.$1VO=new _e.$ge(_a.$69.$I());this.$DW=u};_c.$17d.prototype={$3x:null,$S:null,$AS:null,$4qf:null,$DW:null,$1VO:null,$2jN:!1,$97F:function(){if(!this.$2jN){this.$S.$HX(_h.$LF,this.$$d_$7QH);this.$S.$HX(_h.$Il,this.$$d_$3be);this.$S.$HX(_a.$hH,this.$$d_$8bt);this.$S.$HX(_h.$PT,this.$$d_$7Rv);this.$S.$HX(_h.$hk,this.$$d_$7Rg);_c.$9P.add_$5lM(this.$$d_$8gg);this.$DW.get_$12e()||this.$S.$HX(_h.$Ky,this.$$d_$3bf);this.$2jN=!0}},$59:function(){if(this.$2jN){this.$S.$12Z(_h.$LF,this.$$d_$7QH);this.$S.$12Z(_h.$Il,this.$$d_$3be);this.$S.$12Z(_a.$hH,this.$$d_$8bt);this.$S.$12Z(_h.$PT,this.$$d_$7Rv);this.$S.$12Z(_h.$hk,this.$$d_$7Rg);_c.$9P.remove_$5lM(this.$$d_$8gg);this.$DW.get_$12e()||this.$S.$12Z(_h.$Ky,this.$$d_$3bf);this.$2jN=!1}},$8gg:function(){this.$DW.get_$12e()?this.$S.$12Z(_h.$Ky,this.$$d_$3bf):this.$S.$HX(_h.$Ky,this.$$d_$3bf)},$3bf:function(n){_c.$1q.$yj("Receiving ViewFolderEvent");var t=n.$2B;if(t&&t.get_$n()){var i=this;this.$DW.$8nH(t,function(n){n&&i.$3x.$63z(t.get_$n().Id)})}},$7QH:function(n){n.$4kh?this.$1VO.$3KR(n.$4Bu,this.$3x.get_$1Av()):this.$1VO.$3KR(n.$4Bu,"")},$3be:function(n){var t=new _h.$190;t.set_$1QC(this.$AS.$NF);this.$4qf.$A7(t);this.$3x.$96V()},$8bt:function(n){_c.$1q.$4w("OnPauseResumeSyncEvent, PauseEvent: {0}",n.$2Dn);if(n.$2Dn){if(_h.$4g.$2l){_c.$1q.$ij("Stopping sync manager on version mismatch error");var t=this;this.$3x.$1zI(function(){_c.$1q.$4w("Successfully stopped sync manager on version mismatch error")})}}else{_c.$1q.$4w("Enable sync and start full sync");this.$3x.$7CT()}},$7Rv:function(n){_c.$1q.$4w("Receiving StartFullSyncEvent");this.$3x.$1MR(n.$11z)},$7Rg:function(n){_c.$1q.$yj("Receiving StartFullSyncEvent");this.$3x.$5su(n.$9l,n.$j)}};_c.$wo=function(n,t){_c.$wo.initializeBase(this,[3,0,n,t])};_c.$wo.prototype={get_$1y:function(){return"CalendarFoldersModule"},$48Z:function(n){return n.$91m()}};_c.$LG=function(n,t,i){_c.$LG.initializeBase(this,[4,0,!1,t]);_a.$3.$M(i,"postCleanup");this.$1DY=n;this.$5pZ=i};_c.$LG.prototype={$1DY:0,$5pZ:null,get_$1y:function(){return"CleanupSyncContextId"},$48Z:function(n){return n.$91B(this.$1DY)},$8cy:function(n){this.$5pZ(n)}};_c.$14I=function(n){_c.$14I.initializeBase(this,[3,0,!0,n])};_c.$14I.prototype={$48Z:function(n){return n.$91p()}};_c.$zM=function(){_c.$zM.initializeBase(this,[1,"Core.Models.Sync.FolderActiveSyncingAgain"])};_c.$zM.prototype={get_$8QV:function(){return this.$W("NDBLACA")},set_$8QV:function(n){$1O(this,"NDBLACA",n);return n}};_c.$zX=function(n,t){_a.$3.$6v(n,0,Number.MAX_VALUE,"Interval");_a.$3.$6v(t,2,Number.MAX_VALUE,"maxTimes");this.$9t=n;this.$3mU=t;this.$1wN=[]};_c.$zX.prototype={$9t:0,$3mU:0,$1wN:null,$390:0,$9Et:function(n){_a.$3.$6v(n,1,Number.MAX_VALUE,"actionTimeInUtcMinutes");if(this.$390)if(this.$1wN.length<this.$3mU-1)Array.enqueue(this.$1wN,n);else{this.$390=Array.dequeue(this.$1wN);Array.enqueue(this.$1wN,n)}else this.$390=n},$7XG:function(n){return this.$1wN.length<this.$3mU-1?!0:n-this.$390>=this.$9t}};_c.$kr=function(n,t){_c.$kr.initializeBase(this,[1,t,!0,n])};_c.$kr.prototype={get_$78K:function(){return!1},get_$3gj:function(){return!0},$48Z:function(n){return n.$91n(this.$11z)}};_c.$Qu=function(n,t,i){_c.$Qu.initializeBase(this,[3,n,t,i])};_c.$Qu.prototype={$48Z:function(n){return n.$91o(this.$2i)}};_c.$15V=function(n,t){_c.$15V.initializeBase(this,[3,0,n,t])};_c.$15V.prototype={get_$1y:function(){return"RemindersModule"},$48Z:function(n){return n.$91t()}};_c.$dH=function(n,t,i){this.$$d_$4ma=Function.createDelegate(this,this.$4ma);_c.$dH.initializeBase(this,[n,t,i]);$vC(this,this.$$d_$4ma,"ConfirmSyncCompleted")};function $6IK(n){return new _e.$jL(n.$B3.get_$95().get_$1Cz(),n.$B3.get_$95().get_$3eD())}function $6IJ(n,t,i){if(!_a.UserAgent.getInstance().$3hk(n.get_$57(),n.get_$5e4())||n.get_$4kp().get_$7Yy())t();else{var r=this;n.get_$4kp().$6xs(n.get_$5e4(),t,function(n){i&&i(n)})}}_c.$dH.prototype={get_$Oj:function(){return 14},get_$5e4:function(){return this.$At.$37.$27},get_$4kp:function(){return this.$At.$37.$4h2},get_$57:function(){return this.$At.$37.get_$57()},$63v:function(n,t){$12t(this,"Starting cleanup");var i=this,r=this;this.$B3.$YX(this.$At.$1DY,$6IK(this),function(){$6IJ(i,n,t)},function(n){$PE(r,"Module cleanup failed with error: "+n.get_$4i());var i=Error.create(n.get_$4i());t(i)})},$4ma:function(){this.$1c9()}};_c.$ur=function(n,t){_c.$ur.initializeBase(this,[n,t])};_c.$ur.prototype={get_$65Q:function(){return 0},$76Q:function(n,t,i){_a.$3.$M(i,"completeCallback");if(!_c.$LG.isInstanceOfType(n))throw Error.argumentType("only CleanupSyncContext is supported by the SyncAttachmentModule");var r=new _c.$dH(n,t,this.$Np);i([r])},$91o:function(n){return!1},$91n:function(n){return!1},$91s:function(){return!1},$91u:function(n){return!1},$3P6:function(n,t){return!0},$3al:function(){return"AttachmentsStateId"}};_c.$17P=function(){this.$$d_$8X0=Function.createDelegate(this,this.$8X0);_c.$17P.initializeBase(this,[null])};_c.$17P.prototype={$7XB:function(n){n.$1ki(null,this.$$d_$8X0,this.$$d_$9K8)},$8X0:function(n,t){t.WasSuccessful?this.$9K7(n,t):this.$9K8(Error.create(_h.$L9.$3Z9(t.ErrorCode)))}};_c.$17Q=function(n,t,i){this.$$d_$489=Function.createDelegate(this,this.$489);this.$$d_$36o=Function.createDelegate(this,this.$36o);_c.$17Q.initializeBase(this,[n,t,i])};_c.$17Q.prototype={get_$Oj:function(){return 9},$6xi:function(n){return!0},$75D:function(){return new SyncState("CalendarFoldersSyncStateId","")},$76L:function(n){n(new _c.$17P)},$7WV:function(){return new(_e.$Ku.$$(_g.$Mq))(this.get_$9JR(),this.$$d_$36o)},$730:function(){return new _e.$k2(this.$$d_$489)},$36o:function(n,t){var i=new _e.$9O(this.$B3.get_$95());var r=this;i.$8xZ(t,n,function(){})},$489:function(n){_e.$9O.$78Q(n);this.$B3.get_$95().get_$kC().$GW(n,_e.$1X.$54("CalendarFoldersSyncStateId"))}};_c.$17R=function(n,t){_c.$17R.initializeBase(this,[n,t])};_c.$17R.prototype={get_$65Q:function(){return 2},$76Q:function(n,t,i){i([new _c.$17Q(n,t,this.$Np)])},$91o:function(n){return!1},$91C:function(){return!0},$91m:function(){return!0},$3al:function(){return"CalendarFoldersSyncStateId"}};_c.$17S=function(n,t){this.$$d_$8bM=Function.createDelegate(this,this.$8bM);_c.$17S.initializeBase(this,[n,t,"CalendarFoldersNotification"]);t.$S.$HX(_h.$bL,this.$$d_$8bM)};_c.$17S.prototype={$7RN:function(n,t,i){_js.Trace.logError(_a.$0.$5v,String.format("Receiving unexpected CalendarFolders offline notification. Id: {0}",n.id||""));i(n)},$8bM:function(n){var i=new _e.$RG(this.$37.get_$57(),_e.$1a.$6t);var r=new _e.$id(i.get_$kC(),"CalendarFoldersSyncStateId");_js.Trace.logInfo(_a.$0.$5v,"Processing (client-only) CalendarFolders notification.");var t=this;r.$9Bz(!1,function(){_js.Trace.logInfo(_a.$0.$5v,"Successfully set isSynced to false for CalendarFolders table. Starting notification based sync.");var n=new _c.$wo(t.$3x.get_$1GQ(),t.$37);t.$3x.$ur(n)})}};_c.$17U=function(n){_c.$17U.initializeBase(this,[n])};_c.$17U.prototype={get_$9Ad:function(){return this.$W("rmi")},set_$9Ad:function(n){$1O(this,"rmi",n);return n},get_$9Ae:function(){return this.$W("rmwi")},set_$9Ae:function(n){$1O(this,"rmwi",n);return n},get_$989:function(){return this.$W("sws")},set_$989:function(n){$1O(this,"sws",n);return n},get_$988:function(){return this.$W("swe")},set_$988:function(n){$1O(this,"swe",n);return n},get_$97t:function(){return this.$W("sf")},set_$97t:function(n){$1O(this,"sf",n);return n},get_$6sj:function(){return this.$W("aws")},set_$6sj:function(n){$1O(this,"aws",n);return n},get_$9Bw:function(){return this.$W("ttiw")},set_$9Bw:function(n){$1O(this,"ttiw",n);return n}};_c.$17Y=function(n,t,i,r){_c.$17Y.initializeBase(this,[n,t,i,r])};_c.$17Y.prototype={get_$Oj:function(){return 16},$91l:function(){return this.get_$1hg().length>0}};_c.$17Z=function(n,t,i,r){_c.$17Z.initializeBase(this,[n,t,i,r])};_c.$17Z.prototype={get_$Oj:function(){return 15},$91W:function(n){return this.$At.$KU!==3&&!n},$91l:function(){var n=this.get_$1hg().length>0&&this.get_$4E0()<_h.$1y.$1Mb;$12t(this,"Should Sync changes from sever = "+n);return n}};_c.$17a=function(n){_c.$17a.initializeBase(this,[n])};_c.$17a.prototype={get_$71d:function(){return this.$W("cis")},set_$71d:function(n){$1O(this,"cis",n);return n},get_$7dW:function(){return this.$W("ciips")},set_$7dW:function(n){$1O(this,"ciips",n);return n}};_c.$uu=function(n,t,i){this.$$d_$4FO=Function.createDelegate(this,this.$4FO);_c.$uu.initializeBase(this,[n,t,i]);$vC(this,this.$$d_$4FO,"UpdateReadFlagDirtyConversations");$vC(this,this.$$d_$1c9,"SyncCompleted")};_c.$uu.prototype={get_$Oj:function(){return 19},get_$91Z:function(){return!1},get_$1YA:function(){return""},$5D7:function(){return!0},$63v:function(n,t){n()},$4FO:function(){$9a(this,"Updating conversation items read flags");var n=this.$B3.get_$95().get_$Hh();var i=this.$B3.get_$95().get_$4i();var r=this.$B3.get_$95().get_$Hi();var f=this,u=this,t=this;n.$AK(new _a.$6L("SyncConversationItemsReadFlagModule.UpdateReadFlagDirtyConversations"),function(t){n.$4FO(t,r,i)},function(){u.$d7()},function(n){$1Bt(t,"Failed to update read flags",n.$4P);t.$1YL(Error.create(n.$4P))})}};function ExternalSyncDependencies(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_a.$3.$M(n,"offlineMailboxDataContext");_a.$3.$M(t,"localStorageAdapter");_a.$3.$M(i,"offlineUserSettings");_a.$3.$M(r,"syncFolderSettingProcessor");_a.$3.$M(u,"nativeBridge");_a.$3.$M(f,"attachmentsCleanupManager");_a.$3.$M(e,"datapointTracker");_a.$3.$M(o,"offlineNotificationHandler");_a.$3.$M(s,"userAgent");_a.$3.$1C(h,"userCulture");_a.$3.$M(l,"taskRunner");_a.$3.$M(a,"eventAggregator");_a.$3.$M(v,"syncController");_a.$3.$M(y,"uiModuleService");_a.$3.$M(p,"featureManager");this.$6C=n;this.$4N=t;this.$DP=i;this.$DW=r;this.$27=u;this.$4h2=f;this.$1Qo=e;this.$18s=o;this.$1D=s;this.$F5=h;this.$Am=c;this.$5w=l;this.$S=a;this.$1zY=v;this.$pT=y;this.$87=p;var w=this;this.$S.$HX(_h.$Ky,function(n){var t=n.$2B;t&&(w.$Wx=t.get_$n())})}ExternalSyncDependencies.prototype={$1zY:null,$4N:null,$DP:null,$DW:null,$27:null,$4h2:null,$1Qo:null,$18s:null,$1D:null,$F5:null,$Wx:null,$5w:null,$S:null,$6C:null,$pT:null,$Am:0,$87:null,get_$1Dr:function(){return this.$6C.get_$1Dr()},get_$YC:function(){return this.$6C.get_$YC()},get_$57:function(){return this.$6C.get_$57()},get_$3CD:function(){return this.$6C.get_$IJ()},get_$16C:function(){if(!this.$Wx)if(_g.$g.$1i)this.$Wx=_g.$g.$1i.nameToId("inbox");else throw Error.invalidOperation("Trying access ExternalSyncDependencies.InViewFolderId before FolderMappings is initialized. That should not happen.");return this.$Wx},set_$16C:function(n){this.$Wx=n;return n},$5zW:function(n,t,i){this.$6C.$5zW(n,t,i)}};_c.$17e=function(){_c.$17e.initializeBase(this,[null])};_c.$17e.prototype={$7XB:function(n){var t=new _g.$rI(this.$28);n.$29v(t,this.$$d_$9K7,this.$$d_$9K8)}};_c.$17f=function(n,t,i){this.$$d_$489=Function.createDelegate(this,this.$489);this.$$d_$36o=Function.createDelegate(this,this.$36o);_c.$17f.initializeBase(this,[n,t,i])};_c.$17f.prototype={get_$Oj:function(){return 6},$6xi:function(n){return!0},$75D:function(){return new SyncState("FavoriteFoldersSyncStateId","")},$76L:function(n){n(new _c.$17e)},$7WV:function(){return new(_e.$Ku.$$(_g.$Mr))(this.get_$9JR(),this.$$d_$36o)},$730:function(){return new _e.$k2(this.$$d_$489)},$36o:function(n,t){var i=new _e.$9O(this.$B3.get_$95());var r=this;i.$8y2(t,n,function(){})},$489:function(n){_e.$9O.$78f(n)}};_c.$17g=function(n,t){_c.$17g.initializeBase(this,[n,t])};_c.$17g.prototype={get_$65Q:function(){return 2},$76Q:function(n,t,i){i([new _c.$17f(n,t,this.$Np)])},$91o:function(n){return!1},$3al:function(){return"FavoriteFoldersSyncStateId"}};_c.$9P=function(n,t){_a.$3.$M(n,"localStorageAdapter");_a.$3.$M(t,"eventAggregator");this.$4N=n;this.$S=t;$4Kr(this)};_c.$9P.add_$5lM=function(n){_c.$9P.$6rF(n)};_c.$9P.remove_$5lM=function(n){_c.$9P.$5t8(n)};_c.$9P.$7XA=function(){var n=_c.$9P.$3C9.getHandler("UserSelected");$8(n)||n()};_c.$9P.$6rF=function(n){_c.$9P.$3C9.addHandler("UserSelected",n)};_c.$9P.$5t8=function(n){_c.$9P.$3C9.removeHandler("UserSelected",n)};function $6IT(n){n.$il.$34H();$4Kr(n)}function $4Kr(n){n.$il=n.get_$12e()?new _c.$vQ(n.$4N,n.$S):new _c.$Fn(n.$4N,n.$S)}_c.$9P.prototype={$4N:null,$S:null,$il:null,get_$12e:function(){return this.$4N.$3k("SyncFolders.UserSelected")==="true".toLowerCase()},set_$12e:function(n){var t=this.$4N.$3k("SyncFolders.UserSelected")==="true".toLowerCase();this.$4N.$Bp("SyncFolders.UserSelected",n.toString().toLowerCase());if(n!==t){$6IT(this);_c.$9P.$7XA()}return n},get_$5Hk:function(){return this.$il},$5Bo:function(n){_a.$3.$M(n,"folder");if(n.$9i||!_g.$8d.isInstanceOfType(n)||_h.$8A.$X4(n.get_$n())||n.get_$Dl()||n.get_$5D3()){_js.Trace.logInfo(_c.$9P.$IR,"{0} is not syncable because it is not mail folder or is an archive/public/shared/search folder",n.get_$n().Id);return!1}else return _h.$1y.$97b(n)},$8nH:function(n,t){_a.$3.$M(n,"folder");_a.$3.$M(t,"onCompletedCallback");if(_c.$vQ.isInstanceOfType(this.$il)){t(!1);return}if(n.$1cB===2){t(!1);return}var i=this.$il;if(n.$1cB)i.$9EC(n,t);else{if(!this.$5Bo(n)){t(!1);return}var r=this,u=this;i.$6qI(n.get_$n().Id,function(){n.set_$65T(1);t(!0);i.$3lT("",_a.$b.$8E)},function(i){_js.Trace.logWarning(_c.$9P.$IR,"We failed to add {0} into sync list",n.get_$n().Id);t(!1)})}},$2DD:function(n,t){_a.$3.$1C(t,"folderId");var i=!1;switch(n){case 11:case 4:case 12:case 5:var r;var u,f;var e=(f=this.$il.$7Hn(null,n,u={val:r}),r=u.val,f);i=Array.contains(e,t);break;default:break}return i},$7ZH:function(n,t){_a.$3.$1C(t,"folderId");var i=this.$il.$7OZ(n);return Array.contains(i,t)},$3gQ:function(n){_a.$3.$M(n,"folderId");return this.$2DD(12,n)},$5HH:function(n,t,i){this.$il.$5HH(n,t,i)},$5zM:function(n){if(_c.$Fn.isInstanceOfType(this.$il)){var t=this.$il;t.$5zM(n)}},$2AK:function(n,t,i){this.$il.$2AK(n,t,i)},$6AX:function(n,t,i){this.$il.$6AX(n,t,i)}};_c.$Nl=function(n,t,i){this.$14M=[];this.$CD=[];_c.$Nl.$$(this.$$gta["_c.$Nl"].TSyncAction,this.$$gta["_c.$Nl"].TSyncResponse,this.$$gta["_c.$Nl"].TSyncResponseType).initializeBase(this,[n,t,i]);this.$sh=-1};_c.$Nl.$$=function(n,t,i){var r="$Nl"+"$3"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!_c[r]){var u=_c[r]=function(){(this.$$gta=this.$$gta||{})["_c.$Nl"]={TSyncAction:n,TSyncResponse:t,TSyncResponseType:i};for(var u=[],r=0;r<arguments.length;++r)u[r]=arguments[r];_c.$Nl.apply(this,u)};u.registerClass("_c."+r,_c.$Ht.$$(n,t));var e=_c.$Nl.prototype;for(var o in e){var f={key:o,value:e[o]};"constructor"!==f.key&&(u.prototype[f.key]=f.value)}u.$4Du=1048576;u.$9AS=10}return _c[r]};_c.$Nl.prototype={$66y:0,$5Eb:null,$sh:0,get_$9Jh:function(){return this.$14M},get_$1e:function(){return this.$CD},get_$9Ji:function(){return this.$66y},set_$9Ji:function(n){this.$66y=n;return n},get_$9Jj:function(){return this.get_$H9().$5n},get_$9Jk:function(){return this.$5Eb},set_$9Jk:function(n){this.$5Eb=n;return n},get_$7We:function(){return this.$At.get_$3gj()},get_$fL:function(){if(this.$sh===-1){var n=this.$37.$4N.$3k("MaxSyncModuleType");this.$sh=_js.$8.$c(n)?_c.$1b.$1kA:parseInt(n)}return this.$sh},$5D7:function(){return!0},$6xi:function(n){return!1},$8sb:function(){this.$14M=[];this.$CD=[];_c.$Ht.prototype.$8sb.call(this)},$9Jl:function(n,t){for(var r=[],i=0;i<n.length;i++)$8(t[n[i].Id])&&Array.add(r,n[i].Id);r.length>0&&_js.Trace.logWarning(_c.$1b.$D,"Following items were not synced due to servers errors. This warning message is there to help troubleshoot such errors. ItemIds = '{0}'",r.join(", "))},$9Jm:function(n){if(n&&n.length>0&&14<=this.get_$fL()){$12t(this,"Processing attachments to sync");for(var o=n,h=o.length,f=0;f<h;++f){var t=o[f];if(t.Attachments){for(var r=0,u=0,s=t.Attachments,c=s.length,e=0;e<c;++e){var i=s[e];if(this.$6xX(i)){if(r+i.Size>_c.$Nl.$$(this.$$gta["_c.$Nl"].TSyncAction,this.$$gta["_c.$Nl"].TSyncResponse,this.$$gta["_c.$Nl"].TSyncResponseType).$4Du||u+1>10){$9a(this,String.format("Threshold to sync attachments for item : {0} has reached. Size: {1}, Total attachments: {2}",t.ItemId.Id,r,u));break}r+=i.Size;++u;var l=_e.$4W.$72h(i,t.ItemId.Id,t.DateTimeReceived,!1,!0);$12t(this,String.format("Adding Attachmend id: {0} to sync list",i.AttachmentId.Id));Array.add(this.$CD,l)}}$12t(this,String.format("MessageItem: {0} has {1} inline attachments, total size: {2} to sync",t.ItemId.Id,u,r))}}}}};_c.$oR=function(n,t,i,r){this.$2XT=new Array(0);_c.$oR.$$(this.$$gta["_c.$oR"].TSyncAction,this.$$gta["_c.$oR"].TSyncResponseMessage,this.$$gta["_c.$oR"].TSyncResponseType).initializeBase(this,[n,i,r]);_a.$3.$M(t,"foldersToSync");this.$1FM=t};_c.$oR.$$=function(n,t,i){var r="$oR"+"$3"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!_c[r]){var f=_c[r]=function(){(this.$$gta=this.$$gta||{})["_c.$oR"]={TSyncAction:n,TSyncResponseMessage:t,TSyncResponseType:i};for(var u=[],r=0;r<arguments.length;++r)u[r]=arguments[r];_c.$oR.apply(this,u)};f.registerClass("_c."+r,_c.$Ht.$$(n,t));var e=_c.$oR.prototype;for(var o in e){var u={key:o,value:e[o]};"constructor"!==u.key&&(f.prototype[u.key]=u.value)}}return _c[r]};_c.$oR.prototype={$1FM:null,$2RZ:0,$4E1:0,$26i:null,$4wx:!1,get_$rK:function(){return this.$1FM},get_$9JY:function(){return this.$2XT},get_$9JZ:function(){return this.$26i},set_$9JZ:function(n){this.$26i=n;return n},get_$9Ja:function(){return this.$2RZ},set_$9Ja:function(n){this.$2RZ=n;return n},get_$9Jb:function(){return this.$4E1},set_$9Jb:function(n){this.$4E1=n;return n},get_$7Z5:function(){return this.get_$7cc()},get_$7We:function(){return this.$At.get_$3gj()},$7Io:function(){return 11},$7Hb:function(n){if(!n&&this.$26i.get_$9IZ().length>0&&(!this.$4wx||this.get_$7Z5())&&(this.$At.$1kd||!this.$218)){$9a(this,"Raising Hierarchy notification for mail synced folders");var t=_a.$5.acss(_a.$0.$XV,"GenerateSyncNotificationForChanges_"+this.get_$FZ());this.get_$9JT().$2hF(this.$26i.get_$9IZ());_a.$5.aces(t);if(this.$37.$pT.get_$22y()&&!_a.$m.$y7){_a.$m.$4E9();_a.$m.$39l=!0}this.$4wx=!0;_a.$m.$2R5++}else{$9a(this,"No changes received hence not raising Hierarchy notification for mail synced folders");var i=_a.$5.acss(_a.$0.$XV,"NoSyncNotificationForChanges_"+this.get_$FZ()+"_"+_a.$tJ.toString(n));_a.$5.$1G(null,"ALT3.1");_a.$5.endPT("ALT3.1s");if(!_a.$m.$2R5&&n!==1&&!_a.$m.$y7){_a.$m.$4E9();_a.$m.$2yd=!0}_a.$5.aces(i)}_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){if(n===2||n===1){$9a(this,"Raising Hierarchy notification for mail all folders");this.get_$9JT().$2hF(this.$1FM)}_c.$Ht.prototype.$7Ha.call(this,n)},$76S:function(n,t){return _a.$PX.$I(n,this.get_$Oj(),this.$3Az,this.get_$1y(),this.get_$1YA(),this.$2mR,this.$1FM,this.$2XT,t)},$9DX:function(){var n=this.get_$Q7();n.$4xg(this.$2XT);n.set_$5En(this.$2RZ);_c.$1q.$4w(this.get_$FZ()+" module data point: Synced "+this.$2RZ+" messages, ")},$753:function(){return new _c.$17c(this.get_$Oj())},$8sb:function(){this.$26i=null;_c.$Ht.prototype.$8sb.call(this)},$544:function(n){_c.$Ht.prototype.$544.call(this,n)},$543:function(n){_c.$Ht.prototype.$543.call(this,n)},$8SK:function(){if(this.get_$H9().IsSynced&&this.$8ok()){$PE(this,"Reaching max sync limit PostALT1, will revert to ALT1 sync");var n=new _h.$13Q;n.set_$FZ(this.get_$FZ());this.$37.$1Qo.$A7(n);this.$37.$S.$8oV(_h.$LF,new _h.$LF(11,!1));this.$37.$S.$8oV(_h.$PT,new _h.$PT(11));this.$1YL(Error.create("Sync aborts since reaching the max sync limit PostALT1"))}else _c.$Ht.prototype.$8SK.call(this)},$8ok:function(){return this.$4E1+this.$2RZ>=_h.$1y.$fK*_h.$1y.$1B2*2}};_c.$oS=function(){this.$29L=[];this.$3jp=[];this.$1Ux=[]};_c.$oS.$$=function(n){var t="$oS"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_c[t]){var r=_c[t]=function(){(this.$$gta=this.$$gta||{})["_c.$oS"]={TServiceObjectType:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_c.$oS.apply(this,i)};r.registerClass("_c."+t);var u=_c.$oS.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _c[t]};_c.$oS.prototype={get_$9IW:function(){return null},get_$9IX:function(){return this.$3jp},set_$9IX:function(n){this.$3jp=n;return n},get_$9IY:function(){return this.$1Ux},set_$9IY:function(n){this.$1Ux=n;return n},get_$9IZ:function(){return this.$29L},set_$9IZ:function(n){this.$29L=n;return n},$9Ia:function(n){Array.contains(this.$29L,n)||Array.add(this.$29L,n)}};_c.$oT=function(n,t,i){_c.$oT.initializeBase(this,[t,i,"HierarchyNotification"]);_a.$3.$M(n,"clientStore");this.$6T=n};function $6IU(n,t){var i=new _e.$Yq(n.$6T,n.$37.get_$3CD());var r=this,u=this,f=this;i.$AK(new _a.$6L("SyncHierarchyNotificationStrategy.UpdateClientStoreFolderCounts",!1),function(n){i.$693(n,new _g.$3J(t.folderId),t.itemCount,t.unreadCount)},function(){},function(n){_js.Trace.logWarning(_a.$0.$5v,"Failed to update counts for folder id={0}, Error={1}",t.folderId,n.$4P)})}_c.$oT.prototype={$6T:null,$7RN:function(n,t,i){var r=n;if($8(r.folderId)){if(r.EventType==="Reload"){_js.Trace.logInfo(_a.$0.$5v,"Received reload hierarchy notificaiton, start full sync");this.$3x.$1MR(5)}i(r)}else if(r.folderId!==_g.$g.$1i.nameToId("outbox").Id){$6IU(this,r);if(t[r.folderId]&&r.EventType!=="Reload"){i(r);return}var u=new _c.$Qu(r.folderId,this.$3x.get_$1GQ(),this.$37);if(this.$3x.$372(u,r.EventType==="Reload"||this.$37.$18s.get_$59w())){$2Tc(this,r,u);return}i(r);this.$3x.$ur(u)}}};_c.$17p=function(n,t,i,r){_c.$17p.initializeBase(this,[t]);_a.$3.$1C(n,"folderToSync");_a.$3.$M(t,"syncState");_a.$3.$6v(i,1,100,"maxChangesReturned");this.$4xh=new _g.$Bn(new _g.$3J(n));this.$2r7=i;this.$2eb=r};_c.$17p.prototype={$4xh:null,$2r7:0,$2eb:!1,$7XB:function(n){var t=new _g.$dV(null,this.$4xh,this.$2r7);t.ShapeName="MailListItem";t.SyncState=this.get_$kC().State;t.NumberOfDays=_h.$1y.$1ze;t.MinimumCount=_h.$1y.$11y;t.MaximumCount=_h.$1y.$1B2;t.DoQuickSync=this.$2eb;t.ItemShape=new _g.$El("IdOnly");t.ItemShape.InferenceEnabled=_g.$S.get_$L().get_$6D().get_$Ry();var i=new _g.$dT(this.get_$6o(),t);var r=new _g.$17l(this.$28);n.$65P(i,r,this.$$d_$9K7,this.$$d_$9K8)}};_c.$v0=function(n,t,i){_c.$v0.initializeBase(this,[n,t]);this.$1K=i};_c.$v0.prototype={$1K:null,$91o:function(n){return this.$37.$DW.$2DD(12,n)},$76Q:function(n,t,i){var r=this;this.$37.$DW.$2AK(12,this.$37.get_$16C(),function(u){var f=null;if(_c.$LG.isInstanceOfType(n)||u.length){_c.$Qu.isInstanceOfType(n)&&(u=[n.$2i]);f=[new _c.$17q(n,u,t,r.$Np),new _c.$17r(n,t,new _e.$t1(r.get_$57(),_h.$1y.$1HX),r.$1K)]}i(f)})}};_c.$17r=function(n,t,i,r){_c.$17r.initializeBase(this,[n,t,i,r])};_c.$17r.prototype={get_$Oj:function(){return 18},$91l:function(){return this.get_$9Jj().length>0}};_c.$17s=function(n,t,i,r){_c.$17s.initializeBase(this,[n,t,i,r])};_c.$17s.prototype={get_$Oj:function(){return 17},$91W:function(n){return this.$At.$KU!==3&&!n},$91l:function(){var n=this.get_$9Jj().length>0&&this.get_$9Ji()<_h.$1y.$1Mb;$12t(this,"Should Sync changes from sever = "+n);return n}};_c.$Hs=function(n,t,i,r){_c.$Hs.initializeBase(this,[n,t,i]);var u=this;_c.$Hs.$3Vg=new(_0365f.$3k.$$(_g.$El))(function(){return _h.$11.$501(r.get_$A0())});var f=this;_c.$Hs.$3wV=new(_0365f.$3k.$$(_g.$El))(function(){return _h.$11.get_$yZ()})};function $6Ij(n){for(var i=Math.min(_h.$1y.$1HX,n.get_$9Jj().length),r=new Array(i),t=0;t<i;t++){var u=new _g.$1j(n.get_$9Jj()[t].Id);r[t]=u}return r}_c.$Hs.prototype={$76L:function(n){var t=$6Ij(this);_c.$1q.$4w("Creating SyncItems action for {0} items",t.length);n(new _c.$dY(this.get_$Oj(),t,this.get_$H9().$3kv?_c.$Hs.$3Vg.get_$1d():_c.$Hs.$3wV.get_$1d(),this.get_$H9().$3kv?"EditableItems":"ItemNormalizedBody"))},$730:function(){return null},$7WV:function(){return new _e.$13h(this.$B3.get_$95().get_$4i(),this.$B3.get_$95().get_$1Cz(),this.get_$9Jh(),this.get_$1e(),[])},$8nC:function(n){$9a(this,"Process current SyncItems response");var f={};this.set_$9Jk([]);for(var u=!1,t=0;t<this.get_$9JR().length;t++){var i=this.get_$9JR()[t];if(i.ResponseClass!=="Success"){var e=this.get_$9Jj()[t];_js.Trace.logWarning(_c.$1b.$D,"Error [{0}:{1}:{2}] while syncing item id {3}, SyncContext = {4}",i.ResponseClass,i.ResponseCode,i.MessageText||"",e.Id,this.$At.get_$1y());i.ResponseCode!=="ErrorItemNotFound"&&(u=!0);Array.add(this.get_$9Jk(),e);continue}var r=this.get_$9JR()[t].Items;if(r&&r.length>0){_js.Trace.logInfo(_c.$1b.$D,"Setting item IsDataSynced flag to true");_e.$B6.$2P1(r[0],CustomSyncData.$1iL,2);Array.add(this.get_$9Jh(),r[0]);f[r[0].ItemId.Id]=!0;this.set_$9Ji(this.get_$9Ji()+1)}else u=!0}u&&this.$9Jl(this.get_$9Jj(),f);this.$9Jm(this.get_$9Jh());_c.$Ht.prototype.$8nC.call(this,n)},$75D:function(){return new MessageItemSyncState(this.get_$9Jk(),null,!1)},$753:function(){return new _c.$17t(this.get_$Oj())},$9DX:function(){var n=this.get_$Q7();n.set_$5En(this.get_$9Ji());_c.$1q.$4w(this.get_$FZ()+" module data point: Synced "+this.get_$9Ji()+" items")},$6xX:function(n){return n?n.IsInlineToNormalBody:!1}};_c.$17q=function(n,t,i,r){_c.$17q.initializeBase(this,[n,t,i,r])};_c.$17q.prototype={get_$Oj:function(){return 12}};_c.$17t=function(n){_c.$17t.initializeBase(this,[n])};_c.$17t.prototype={get_$5En:function(){return this.$W("miis")},set_$5En:function(n){$1O(this,"miis",n);return n}};_c.$17u=function(n,t,i,r){_c.$17u.initializeBase(this,[n,[t],i,r])};_c.$17u.prototype={get_$Oj:function(){return 5},$91W:function(n){return this.$At.$KU!==3&&!n},$6xi:function(n){return!0}};_c.$v1=function(n,t,i){_c.$v1.initializeBase(this,[n||new _e.$tA(t.get_$57(),"MessageSyncStateId"),t]);this.$1K=i};_c.$v1.prototype={$1K:null,$76Q:function(n,t,i){var r=this;this.$37.$DW.$2AK(5,this.$37.get_$16C(),function(u){_a.$3.$8z(!_c.$Qu.isInstanceOfType(n),"sync message minimum module factory should not be invoked on notification based sync");var f=null;(_c.$LG.isInstanceOfType(n)||u.length)&&(f=[new _c.$17u(n,u[0],t,r.$Np),new _c.$17s(n,t,new _e.$t1(r.get_$57(),_h.$1y.$1HX),r.$1K)]);i(f)})},$91o:function(n){return!1},$91q:function(){var n=this.$37.get_$16C().Id;return this.$37.$DW.$3gQ(n)}};_c.$Vs=function(n,t,i,r){_c.$Vs.initializeBase(this,[n,t,i,r])};function $6Ik(n,t,i,r){var u=i.PerFolderSyncStateContainer[t];u||(u=n.get_$Y1().$503(t));u.State=r.get_$kC();u.IsSynced=i.IsSynced;u.LastSuccessfulSyncTime=_a.$7.$Eb(_a.$7.get_$2M());u.LastAttemptedSyncTime=u.LastSuccessfulSyncTime;u.ModuleSpecificContext=new MessageSyncStateContext(r.get_$8Og(),r.get_$8Qw(),_h.$1y.$11y,_h.$1y.$1B2,r.get_$LP());i.PerFolderSyncStateContainer[t]=u}function $4Ky(n,t,i){return i in t.PerFolderSyncStateContainer?t.PerFolderSyncStateContainer[i]:null}_c.$Vs.prototype={$3Sx:0,get_$7Z5:function(){return this.$3Sx>=this.get_$rK().length-1&&this.get_$9JR().IncludesLastItemInRange},get_$1i3:function(){return this.get_$rK()[this.$3Sx]},$50U:function(n){var t=$4Ky(this,n,this.get_$1i3());return!t||t.State===""},$6xi:function(n){if(this.get_$7Z5())return!0;else{n.IncludesLastItemInRange&&this.$3Sx++;return!1}},$76L:function(n){var t=this.get_$H9();var i=new _c.$17p(this.get_$1i3(),$4Ky(this,t,this.get_$1i3())||this.get_$Y1().$503(this.get_$1i3()),_h.$1y.$1Mb,_c.$hg.isInstanceOfType(this.$At));n(i)},$7WV:function(){var n=this.get_$9JZ();return new _e.$RU(this.$B3.get_$95().get_$4i(),n.get_$9IX(),n.get_$9IY(),n.$1wH,new _e.$jL(this.$B3.get_$95().get_$1Cz(),this.$B3.get_$95().get_$3eD()))},$8nC:function(n){this.set_$9JZ(new _c.$17v(this.get_$9JR(),this.get_$1i3()));this.get_$9JZ().$2Mc();var r=this.get_$9JZ().get_$9IX().length;this.set_$9Jb(this.get_$9Jb()+this.get_$9JZ().get_$9IY().length);if(r>0){this.set_$9Ja(this.get_$9Ja()+r);for(var i=this.get_$9JZ().get_$9IZ(),t=0;t<i.length;t++)Array.contains(this.get_$9JY(),i[t])||Array.add(this.get_$9JY(),i[t])}_c.$Ht.prototype.$8nC.call(this,n)},$75D:function(){var n=this.get_$H9()||this.get_$Y1().$29q();$6Ik(this,this.get_$1i3(),n,this.get_$9JZ());return n},$730:function(){return null}};_c.$Vt=function(n,t){_c.$Vt.initializeBase(this,[n||new _e.$tA(t.get_$57(),"MessageSyncStateId"),t])};function $3EK(n,t,i){var r=i;_a.$3.$M(r.FolderId,"FolderId should be present");var u=t.PerFolderSyncStateContainer[r.FolderId.Id];u||_js.Trace.logInfo(_c.$1b.$D,"We didn't find the syncState for folder:{0}",r.FolderId.Id);return u}_c.$Vt.prototype={$7LD:function(n,t){var i=$3EK(this,t,n);return i?i.LastSuccessfulSyncTime:null},$3P6:function(n,t){_a.$3.$8z(_bc.$Ga.isInstanceOfType(n),"The context type should match the module.");if(t){var i=$3EK(this,t,n);if(i)return i.IsSynced}return!1},$7Lj:function(n,t){_a.$3.$8z(_bc.$Ga.isInstanceOfType(n),"The context type should match the module.");if(t){var i=$3EK(this,t,n);if(i)return i.ModuleSpecificContext}return null},$3al:function(){return"MessageSyncStateId"},$8qd:function(n,t){var i=t.PerFolderSyncStateContainer;if(n in i){_js.Trace.logInfo(_c.$1b.$D,"Removing Folder {0} Message SyncState",n);delete i[n]}}};_c.$17v=function(n,t){this.$1wH=[];_c.$17v.initializeBase(this);this.$2n=n;this.$65K=t};_c.$17v.prototype={$65K:null,$2n:null,get_$kC:function(){return this.$2n.SyncState},get_includesLastItemInRange:function(){return this.$2n.IncludesLastItemInRange},get_$LP:function(){return this.$2n.TotalCount},get_$8Og:function(){return this.$2n.MoreItemsOnServer},get_$8Qw:function(){return this.$2n.OldestReceivedTime},$2Mc:function(){for(var i=this.$2n.Changes.Changes,u=i.length,t=0;t<u;++t){var n=i[t];switch(n.ChangeType){case"Create":case"Update":var r=n;Array.add(this.get_$9IX(),r.Item);var f=r.Item.ParentFolderId.Id;this.$9Ia(f);break;case"Delete":Array.add(this.get_$9IY(),_e.$1X.$54(n.ItemId.Id));this.$9Ia(this.$65K);break;case"ReadFlagChange":var e=n;Array.add(this.$1wH,e);break;default:throw Error.invalidOperation("Invalid value of change type "+n.ChangeType+" change JSON = '"+JsonParser.serialize(n)+"'");}}}};_c.$Ks=function(n,t){_a.$3.$M(n,"offlineSettings");this.$6H=n;this.$S=t};_c.$Ks.$I=function(n,t){return new _c.$Ks(n,t)};function $6Ix(n,t,i){var r=i<11?4:11;var u=i<12?5:12;n.$1vw||(n.$1vw=[t?5:4,10,3,r,u,0,2,6,9,7,8,1,13,14]);n.$1vw[0]=t?5:4;n.$1vw[3]=r;n.$1vw[4]=u;return n.$1vw}function $6Iy(n,t,i){var r=null;if(i===1){r=[10,3];r=$4L1(n,r,t)}else if(i===2){r=[7,8];r=$4L1(n,r,t)}else r=t;return r}function $4L1(n,t,i){var u=_a.$5H.$$(Boolean).$8M();var f=new(_0365f.$s.$$(_a.$9l));t=t.concat.apply(t,i);for(var r=0;r<t.length;++r)if(!u.get_$48(_a.$9l.toString(t[r]))){f.$H(t[r]);u.set_$48(_a.$9l.toString(t[r]),!0)}return f.$7V()}_c.$Ks.prototype={$6H:null,$S:null,$2XU:null,$1vw:null,get_$12c:function(){return this.$6H.get_$12c()},get_$6rr:function(){if(!this.$2XU){var t=15;this.$2XU=new Array(t);for(var n=0;n<t;n++)this.$2XU[n]=n}return this.$2XU},$7Li:function(n,t,i,r){var u;_c.$1q.$4w("GetModuleList - isInViewFolderSyncingInDateView: {0}, currentUIModule: {1}",i,r);if((_c.$kr.isInstanceOfType(n)||_c.$uG.isInstanceOfType(n))&&this.$6H.get_$12c()){_c.$1q.$4w("Getting post-ALT1 module list, syncType: {0}",n.$KU);u=$6Ix(this,i,t);u=$6Iy(this,u,r)}else{_c.$1q.$4w("Getting ALT1 module list, syncType: {0}",n.$KU);u=this.get_$6rr()}return u},$8zV:function(){if(!this.$6H.get_$12c()){this.$6H.set_$12c(!0);_c.$1q.$4w("UsePostALT1SyncOrder changed to true");this.$S.$8oV(_h.$eC,new _h.$eC)}},$8tZ:function(){if(this.$6H.get_$12c()){this.$6H.set_$12c(!1);_c.$1q.$4w("UsePostALT1SyncOrder changed to false");this.$S.$8oV(_h.$eC,new _h.$eC)}}};_c.$PW=function(n,t,i){_a.$3.$M(n,"syncManager");_a.$3.$M(t,"externalSyncDependencies");_a.$3.$M(i,"notificationType");this.$3x=n;this.$37=t;this.$5f5=i};function $2Tc(n,t,i){_a.$3.$17(t,"notification");_a.$3.$17(i,"syncContext");if(n.get_$fp().$2fS(i.get_$1y(),t))n.$3x.$ur(i);else{_js.Trace.logWarning(_a.$0.$5v,"NQM rejected enqueue notification, clear notification queue and start full sync");n.get_$fp().$6yB();n.$3x.$Ar();n.$3x.$1MR(7)}}_c.$PW.prototype={$3x:null,$5f5:"HierarchyNotification",$37:null,get_$1Jl:function(){return this.$5f5},get_$fp:function(){return this.$37.$18s.get_$fp()},$53q:function(n,t,i){_a.$3.$17(n,"notification");_a.$3.$17(t,"granularNotificationFolders");_a.$3.$17(i,"callback");_a.$3.$kI(n.clientGenerated,!0,"notification.ClientGenerated");this.$7RN(n,t,i)}};_c.$17x=function(){_c.$17x.initializeBase(this,[null])};_c.$17x.prototype={$7XB:function(n){n.$15b(null,this.$$d_$9K7,this.$$d_$9K8)}};_c.$17y=function(n,t,i){this.$$d_$489=Function.createDelegate(this,this.$489);this.$$d_$36o=Function.createDelegate(this,this.$36o);_c.$17y.initializeBase(this,[n,t,i])};_c.$17y.prototype={get_$Oj:function(){return 13},$6xi:function(n){return!0},$75D:function(){return new SyncState("OtherMailboxConfigurationSyncStateId","")},$76L:function(n){n(new _c.$17x)},$7WV:function(){return new(_e.$Ku.$$(_g.$Oy))(this.get_$9JR(),this.$$d_$36o)},$730:function(){return new _e.$k2(this.$$d_$489)},$36o:function(n,t){var i=new _e.$9O(this.$B3.get_$95());var r=this;i.$8zE(t,n,function(){})},$489:function(n){_e.$9O.$790(n)}};_c.$17z=function(n,t){_c.$17z.initializeBase(this,[n,t])};_c.$17z.prototype={get_$65Q:function(){return 2},$76Q:function(n,t,i){i([new _c.$17y(n,t,this.$Np)])},$91o:function(n){return!1},$3al:function(){return"OtherMailboxConfigurationSyncStateId"}};_c.$187=function(n){_c.$187.initializeBase(this,[n])};_c.$187.prototype={get_$9H8:function(){return this.$W("wr")},set_$9H8:function(n){$1O(this,"wr",n);return n}};_c.$oU=function(n,t){this.$Z7=new(_0365f.$s.$$(_c.$gP));this.$1wE=_a.$5H.$$(Boolean).$8M();this.$3x=n;this.$1i7=t;this.$34V=!1};function $6J4(n){if((n.$1i7!==n.$3x.get_$1i8()||n.$34V)&&!n.$3x.get_$1GQ()){_c.$1q.$4w("CurrentUIModue: {0}, NewUIModule: {1}, readjusting sync queue",n.$1i7,n.$3x.get_$1i8());n.$1i7=n.$3x.get_$1i8();n.$34V=!1;for(var t=new(_0365f.$s.$$(_c.$gP)),r=new(_0365f.$s.$$(_c.$gP));n.$Z7.get_$F()>0;){var i=n.$Z7.get_$48(0);n.$Z7.$67(0);i.$91V(n.$1i7)?t.$H(i):r.$H(i)}t.$6G(r.$7V());n.$Z7=t}}_c.$oU.prototype={$97z:0,$3x:null,$1i7:0,$34V:!1,$3WO:function(n,t){_a.$3.$M(n,"module");var r=!1;if(n.get_$Oj()>this.$3x.get_$fL()&&!n.$5D7()){_c.$1q.$ij("Currently sync module type {0} is not supported",n.get_$FZ());return}if(t){_c.$1q.$yj("Enquing module '{0} at the front of the sync internalQueue",n);if(this.$1wE.get_$48(n.get_$1y()))for(var i=0;i<this.$Z7.get_$F();i++)if(this.$Z7.get_$48(i).get_$1y()===n.get_$1y()){r=!0;n=this.$Z7.get_$48(i);this.$Z7.$67(i);break}this.$Z7.$9HX(0,n)}else{if(this.$1wE.get_$48(n.get_$1y())){r=!0;_c.$1q.$yj("Module '{0}' is already present in the sync internalQueue.",n);return}else{_c.$1q.$yj("Module '{0}' is not already present in the sync internalQueue. Enquing at the back of the internalQueue",n);this.$Z7.$H(n)}this.$1i7!==this.$3x.get_$1i8()&&(this.$34V=!0)}if(!r){this.$1wE.set_$48(n.get_$1y(),!0);n.set_$3B0(++this.$97z);_c.$1q.$yj("Completed enqueuing module : {0}",n);n.$8Vw()}},$79R:function(){var n=null;if(this.$Z7.get_$F()>0){$6J4(this);n=this.$Z7.get_$48(0);if(n){this.$Z7.$67(0);this.$1wE.$3Q(n.get_$1y());n.$8V9()}}return n},$1u:function(){for(var i=this.$Z7.$7V(),r=i.length,n=0;n<r;++n){var t=i[n];_c.$1q.$yj("Module {0} sync cancelled, TrackingId {1} during sync internalQueue cleanup before FullSync",t.get_$FZ(),t.get_$3B0());t.$3xc()}this.$Z7=new(_0365f.$s.$$(_c.$gP));this.$1wE=_a.$5H.$$(Boolean).$8M()}};_c.$188=function(n,t){_c.$188.initializeBase(this,[n,t,"ReminderNotification"])};_c.$188.prototype={$7RN:function(n,t,i){_a.$3.$HZ(n.id,"ReminderNotification","reminderNotification.id");var r=new _c.$15V(this.$3x.get_$1GQ(),this.$37);if(this.$3x.$372(r,!1)){$2Tc(this,n,r);return}i(n);this.$3x.$ur(r)}};_c.$dc=function(n,t){_c.$dc.initializeBase(this,[n,t,"RowNotification"]);_js.Trace.logInfo(_a.$0.$5v,"[SyncRowNotificationStrategy::Ctor]");var i=this;this.$1hd=new(_0365f.$3k.$$(_e.$OA))(function(){return new _e.$OA(i.$37.get_$57(),i.$37.get_$3CD())});var r=this;this.$2GK=new(_0365f.$3k.$$(_e.$gp))(function(){return new _e.$gp(r.$37.get_$57(),r.$37.get_$3CD())})};function $6J6(n,t){var i=_0365f.$57.$46(t);if(i.Item)if(i.Conversation)_js.Trace.logError(_a.$0.$5v,"NOT saving the row notification to the client store. Both the Item and the Converation properties are non null. That should never happen. Folder Id={0}",i.FolderId);else if(n.$37.$DW.$2DD(12,i.FolderId)){var r=i.Item;r.ParentFolderId=new _g.$3J(i.FolderId);var u=new _e.$RU(n.$2GK.get_$1d(),[r],[],[],null);u.set_$9JL(10);u.$9JO(null)}else return;else if(i.Conversation){if(n.$37.$DW.$2DD(11,i.FolderId)){var f=i.Conversation;f.FolderId=new _g.$3J(i.FolderId);var e=new _e.$QM(n.$1hd.get_$1d(),[f],[]);e.set_$9JL(10);e.$9JO(null)}}else _js.Trace.logError(_a.$0.$5v,"NOT saving the row notification to the client store. Both the Item and the Converation properties are null. That should never happen. Folder Id={0}",i.FolderId)}function $6J7(n,t){if(t.Conversation){var r=t.Conversation;_js.Trace.logInfo(_a.$0.$5v,"Handling RowNotification id: {0}, EventType: {1}, ConversationType: true, convId: {2}, topic: {3}, lastDeliveryTime: {4}",t.FolderId||"",t.EventType,r.ConversationId?r.ConversationId.Id:"",r.ConversationTopic||"",r.LastDeliveryTime||"")}else{var i=t.Item;i&&_js.Trace.logInfo(_a.$0.$5v,"Handling RowNotification id: {0}, EventType: {1}, ConversationType: false, itemId: {2}, subject: {3}, lastReceivedTime: {4}",t.FolderId||"",t.EventType,i.ItemId?i.ItemId.Id:"",i.Subject||"",i.DateTimeReceived||"")}}_c.$dc.prototype={$1hd:null,$2GK:null,$7RN:function(n,t,i){var r=n;if($8(r.FolderId)){i(n);return}$6J7(this,r);if(r.FolderId!==_g.$g.$1i.nameToId("outbox").Id)if(t[r.FolderId]){var f=r.FolderId===_g.$g.$1i.nameToId("drafts").Id;var u=new _c.$Qu(r.FolderId,this.$3x.get_$1GQ()||f,this.$37);if(this.$3x.$372(u,r.EventType==="Reload"||this.$37.$18s.get_$59w())){$2Tc(this,r,u);return}if(!f){(r.EventType==="RowAdded"||r.EventType==="RowModified")&&$6J6(this,r);i(r)}this.$3x.$ur(u)}else{i(r);return}}};_c.$v3=function(){_c.$v3.initializeBase(this,[1,"Core.Models.Sync.Setting"])};_c.$v3.prototype={get_$6AK:function(){return this.$W("USSF")},set_$6AK:function(n){$1O(this,"USSF",n);return n},get_$4dV:function(){return this.$W("ASMFC")},set_$4dV:function(n){$1O(this,"ASMFC",n);return n},get_$5gR:function(){return this.$W("OSMFC")},set_$5gR:function(n){$1O(this,"OSMFC",n);return n},get_$fL:function(){return this.$W("MSMT")},set_$fL:function(n){$1O(this,"MSMT",n);return n},get_$5Iz:function(){return this.$W("MSFC")},set_$5Iz:function(n){$1O(this,"MSFC",n);return n},get_$59M:function(){return this.$W("ICU")},set_$59M:function(n){$1O(this,"ICU",n);return n},get_$5J0:function(){return this.$W("MCEE")},set_$5J0:function(n){$1O(this,"MCEE",n);return n}};_c.$18B=function(){_c.$18B.initializeBase(this,[null])};_c.$18B.prototype={$7XB:function(n){var t=new _g.$Zk(_a.$7.get_$2M().$h2(-2).$8r(),_a.$7.get_$2M().$h2(3).$8r());var i=new _g.$Zi(this.get_$6o(),t);var r=new _g.$10l(this.$28);n.$2AX(i,r,this.$$d_$9K7,this.$$d_$9K8)}};_c.$18C=function(n,t,i){_c.$18C.initializeBase(this,[n,t,i])};_c.$18C.prototype={get_$Oj:function(){return 1},$91l:function(){$12t(this,"Last sync time of time zone table = "+this.get_$H9().LastSuccessfulSyncTime);var n=_a.$7.$cV;_js.$8.$c(this.get_$H9().LastSuccessfulSyncTime)||(n=_a.$7.$4Y(this.get_$H9().LastSuccessfulSyncTime));return n.$2Y(_a.$7.get_$2M().$2q(-7))<0},$6xi:function(n){return!0},$75D:function(){return new SyncState("TimeZoneOffsetsSyncStateId","")},$76L:function(n){n(new _c.$18B)},$7WV:function(){$9a(this,String.format("Number of time zones = {0}",this.get_$9JR().Body.TimeZones.length));return new(_e.$LE.$$(_bc.$gV,_g.$W0))(this.$B3.get_$95().get_$206(),this.get_$9JR().Body.TimeZones)},$730:function(){return null},$8SK:function(){var t=this.$B3.get_$95().get_$206();var r=this,n=this,i=this;t.$AK(new _a.$6L("SyncTimeZoneOffsetsModule.OnBatchCompleted"),function(n){r.$37.get_$57().$5Gs(t,n,null,null)},function(){$9a(n,"The time zone offsets table has been loaded");n.$37.$5zW(!0,function(){_c.$Ht.prototype.$8SK.call(n)},function(t){$1Bt(n,"Failed to set the offline component as ready to use after synchronizing the time zone data.",t.get_$4i());n.$1YL(Error.create(t.get_$4i()))})},function(n){$1Bt(i,"Failed to load the time zone offsets table",n.$4P);i.$1YL(Error.create(n.$4P))})}};_c.$18D=function(n,t){_c.$18D.initializeBase(this,[n,t])};_c.$18D.prototype={get_$65Q:function(){return 2},$76Q:function(n,t,i){i([new _c.$18C(n,t,this.$Np)])},$91o:function(n){return!1},$3al:function(){return"TimeZoneOffsetsSyncStateId"}};_c.$17X=function(n,t,i,r,u){_c.$17X.initializeBase(this,[1102,n,t,i,r,u])};_c.$17X.prototype={get_syncResponse:function(){return this.$8R},get_$IJ:function(){return"UTC"},$91w:function(n){return n!=="ErrorItemNotFound"}};_c.$p4=function(n){this.$2R7=this.$$gta["_c.$p4"].TSyncResponse===Number||Type.isEnum(this.$$gta["_c.$p4"].TSyncResponse)?0:this.$$gta["_c.$p4"].TSyncResponse===Boolean?!1:null;_c.$p4.$$(this.$$gta["_c.$p4"].TSyncResponse).initializeBase(this);this.$uw=n};_c.$p4.$$=function(n){var t="$p4"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_c[t]){var r=_c[t]=function(){(this.$$gta=this.$$gta||{})["_c.$p4"]={TSyncResponse:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_c.$p4.apply(this,i)};r.registerClass("_c."+t,_h.$Im.$$(n),_a.$aL.$$(n),_a.$m3,_a.$le);var u=_c.$p4.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _c[t]};_c.$p4.prototype={$uw:null,get_syncResponse:function(){return this.$2R7},$8nZ:function(n,t,i){this.$2R7=n;t()}};_c.$oQ=function(n){_c.$oQ.$$(this.$$gta["_c.$oQ"].TResult,this.$$gta["_c.$oQ"].TResponseMessage).initializeBase(this);this.$uw=n};_c.$oQ.$$=function(n,t){var i="$oQ"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_c[i]){var u=_c[i]=function(){(this.$$gta=this.$$gta||{})["_c.$oQ"]={TResult:n,TResponseMessage:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_c.$oQ.apply(this,r)};u.registerClass("_c."+i,_h.$I3.$$(n,t),_a.$aL.$$(t),_a.$m3,_a.$le);var f=_c.$oQ.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _c[i]};_c.$oQ.prototype={$uw:null,$2R7:null,get_syncResponse:function(){return this.$2R7},get_$kC:function(){return this.$uw},get_$IJ:function(){return"UTC"},$42h:function(n){_a.$3.$17(n,"responseMessage");this.$2R7=n}};_c.$1Cd=function(n,t,i,r){_a.$3.$17(r,"ExternalSyncDependencies");this.$KU=n;this.$11z=t;this.$37=r;this.$1kd=i;this.$65X=_a.$7.get_$2M().$55().toString()};_c.$1Cd.prototype={$KU:0,$11z:0,$37:null,$65X:null,$1kd:!1,get_$1y:function(){return""},get_$120:function(){return this.$KU},get_$2hN:function(){return this.$1kd},get_$78K:function(){return!0},get_$3gj:function(){return!1}};_c.$ut=function(n,t,i){_c.$ut.initializeBase(this,[n,t]);this.$1K=i};_c.$ut.prototype={$1K:null,$91o:function(n){return this.$37.$DW.$2DD(11,n)},$91E:function(){return this.$37.$DP.get_$31o()-this.$1Fn()<=0},$91C:function(){return!0},$76Q:function(n,t,i){if(_c.$LG.isInstanceOfType(n))i([new _c.$iS(n,[],t,this.$Np)]);else{var r=this;this.$37.$DW.$2AK(11,this.$37.get_$16C(),function(u){var f=null;u.length&&(f=[new _c.$iS(n,u,t,r.$Np),new _c.$uu(n,t,r.$Np),new _c.$17Y(n,t,new _e.$qK(r.get_$57(),_h.$1y.$1HX),r.$1K)]);i(f)})}}};_c.$uv=function(n,t,i){_c.$uv.initializeBase(this,[n,t]);this.$1K=i};_c.$uv.prototype={$1K:null,$91o:function(n){return!1},$91q:function(){var n=this.$37.get_$16C().Id;return!this.$37.$DW.$3gQ(n)},$76Q:function(n,t,i){var r=this;this.$37.$DW.$2AK(4,this.$37.get_$16C(),function(u){_a.$3.$8z(!_c.$Qu.isInstanceOfType(n),"sync conversation minimum module factory should not be invoked on notification based sync");var f=null;(_c.$LG.isInstanceOfType(n)||u.length)&&(f=[new _c.$17b(n,u[0],t,r.$Np),new _c.$uu(n,t,r.$Np),new _c.$17Z(n,t,new _e.$qK(r.get_$57(),_h.$1y.$1HX),r.$1K)]);i(f)})}};_c.$17k=function(n,t){_c.$17k.initializeBase(this,[n,t])};_c.$17k.prototype={get_$65Q:function(){return 0},$76Q:function(n,t,i){i([new _c.$17j(n,t,this.$Np)])},$91o:function(n){return!1},$3al:function(){return"FolderHierarchySyncStateId"}};_c.$180=function(){_c.$180.initializeBase(this,[null])};_c.$180.prototype={$7XB:function(n){var t=new _g.$rM(this.$28);n.$lu(t,this.$$d_$9K7,this.$$d_$9K8)}};_c.$Kt=function(n,t,i){this.$$d_$36o=Function.createDelegate(this,this.$36o);_c.$Kt.initializeBase(this,[n,t,i]);this.$1zJ=null;this.$5mj=new _h.$n0};function $6Iz(n,t,i){if(t.UserOptions.HideDeletedItems!==i.UserOptions.HideDeletedItems||t.UserOptions.ConversationSortOrder!==i.UserOptions.ConversationSortOrder||t.SegmentationSettings.PredictedActions!==i.SegmentationSettings.PredictedActions){$9a(n,String.format("UserOption changed. Marking Email data for cleanup."));n.$37.$S.$8oV(_h.$LF,new _h.$LF(11,!0))}return $6J0(n,t,i)}function $4L2(n,t){if(t===1&&n.get_$9JR()&&n.$1zJ){var i=$6Iz(n,n.$1zJ,n.get_$9JR());i=i||!n.$5mj.$4W(n.$1zJ,n.get_$9JR());$9a(n,String.format("SyncType={0}, ShouldReload={1}",_a.$ME.toString(n.$At.$KU),i));n.get_$9JT().$4yo(i);_a.$3m.$OQ(n.get_$9JR().SessionSettings.UserCulture)!==_a.$3m.$OQ(n.$1zJ.SessionSettings.UserCulture)&&n.$37.$S.$8oV(_a.$oo,new _a.$oo)}}function $6J0(n,t,i){var e=!1;if(!t.SessionSettings||!i.SessionSettings||!t.SessionSettings.DefaultFolderIds||!t.SessionSettings.DefaultFolderNames||!i.SessionSettings.DefaultFolderIds||!i.SessionSettings.DefaultFolderNames)return e;var h=new _g.$S(t);var c=new _g.$S(i);var p=h;var w=c;h.$3dq();c.$3dq();for(var b=["inbox","drafts","outbox","sentitems","calendar","contacts","recipientcache","quickcontacts"],r=new Array(0),f,l=b,k=l.length,o=0;o<k;++o){var u=l[o];f=!1;var a=p.nameToId(u);var v=w.nameToId(u);if(a)if(v){if(a.Id!==v.Id){$PE(n,String.format("FolderId for distinguishedFolderIdName:{0} has changed",u));f=!0}}else{$1Bt(n,String.format("Couldn't find FolderId for {0} in newUserConfiguraiton",u),"");f=!0}else{$1Bt(n,String.format("Couldn't find FolderId for {0} in oldUserConfiguraiton",u),"");f=!0}if(f){var d=$6J1(n,u);r=r.concat.apply(r,d)}}if(r.length>0){$9a(n,String.format("We need to clean up modules {0} due to FolderId changes",r.join()));e=!0;n.$37.$DP.$45L();for(var y=r,g=y.length,s=0;s<g;++s){var nt=y[s];n.$37.$S.$8oV(_h.$LF,new _h.$LF(nt,!0))}}return e}function $6J1(n,t){var i;switch(t){case"inbox":case"drafts":case"outbox":case"sentitems":i=[11];break;case"calendar":i=[9,10];break;case"contacts":case"recipientcache":case"quickcontacts":i=[7,8];break;default:$PE(n,String.format("We dont' cleanup module for distinguishedFolderIdName:{0}",t));i=new Array(0);break}return i}_c.$Kt.prototype={$1zJ:null,$5mj:null,get_$Oj:function(){return 0},$6xi:function(n){return!0},$75D:function(){return new SyncState("OwaUserConfigurationSyncStateId","")},$76L:function(n){n(new _c.$180)},$8kD:function(){this.$7OQ(this.$$d_$d7,this.$$d_$64Q)},$7WV:function(){return new(_e.$Ku.$$(_g.$JU))(this.get_$9JR(),this.$$d_$36o)},$730:function(){return null},$7Hb:function(n){$4L2(this,n);_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){$4L2(this,n);_c.$Ht.prototype.$7Ha.call(this,n)},$36o:function(n,t){var i=new _e.$9O(this.$B3.get_$95());var r=this;i.$36j(t,n,function(){})},$7OQ:function(n,t){var i=new _e.$9O(this.$B3.get_$95());var r=this;i.$lu(function(t){r.$1zJ=t;n()},t)}};_c.$181=function(n,t){_c.$181.initializeBase(this,[n,t])};_c.$181.prototype={get_$65Q:function(){return 1},$76Q:function(n,t,i){i([new _c.$Kt(n,t,this.$Np)])},$91o:function(n){return!1},$91u:function(n){return!1},$91p:function(){return!0},$3al:function(){return"OwaUserConfigurationSyncStateId"}};_c.$17N=function(n,t,i,r){_c.$17N.initializeBase(this,[n]);this.$1cC=new _g.$dI;this.$1cC.FolderId=t;this.$1cC.WindowStart=i.$8r();this.$1cC.WindowEnd=r.$8r();this.$1cC.SyncState=n.State;this.$1cC.MaxChangesReturned=50};_c.$17N.prototype={$1cC:null,$7XB:function(n){var t=new _g.$17O(this.$28);n.$65G(this.$1cC,t,this.$$d_$9K7,this.$$d_$9K8)}};_c.$dY=function(n,t,i,r){_c.$dY.initializeBase(this,[_c.$dY.$7Hm(n),t,i,r,0,!1])};_c.$dY.$7Hm=function(n){switch(n){case 15:case 16:return 1102;case 17:case 18:return 1103;case 10:return 1101;default:return 1100}};_c.$dY.prototype={$As:null,get_syncResponse:function(){return this.$As},get_$IJ:function(){return"UTC"},$91w:function(n){return this.$28===1101?!1:n!=="ErrorItemNotFound"},$5qj:function(n){this.$As=n},$42h:function(n){}};_c.$1C=function(n,t,i){this.$$d_$3WU=Function.createDelegate(this,this.$3WU);this.$$d_$2iL=Function.createDelegate(this,this.$2iL);this.$$d_$7Oa=Function.createDelegate(this,this.$7Oa);this.$$d_$2fp=Function.createDelegate(this,this.$2fp);this.$$d_$64Q=Function.createDelegate(this,this.$64Q);this.$$d_$d7=Function.createDelegate(this,this.$d7);this.$$d_$1c9=Function.createDelegate(this,this.$1c9);this.$39B=[];this.$14R=-1;_a.$3.$M(n,"syncContext");_a.$3.$M(n.$37,"syncContext.ExternalSyncDependencies");_a.$3.$M(n.$37.get_$YC(),"syncContext.ExternalSyncDependencies.ActionQueue");_a.$3.$M(n.$37.get_$1Dr(),"syncContext.ExternalSyncDependencies.ConnectionManager");_a.$3.$M(n.$37.$1Qo,"syncContext.ExternalSyncDependencies.DatapointTracker");_a.$3.$M(i,"itemSynchronizer");_a.$3.$M(i.get_$Y1(),"itemSynchronizer.SyncStateProvider");this.$65W=t;this.$At=n;this.$37=n.$37;this.$B3=i;this.$4DO=0;this.$4Az=0;this.$218=!1;$3EN(this)};_c.$1C.$7Lh=function(n,t){_a.$3.$1C(n,"moduleName");_a.$3.$M(t,"syncContext");return n+":"+t.get_$1y()};function $3EN(n){n.$2BA=_a.$7.get_$2M()}function $6Ip(n){$9a(n,"Restart syncing current module");n.$14R=-1;n.$d7()}function $vC(n,t,i){Array.add(n.$39B,new _c.$17m(t,i))}function $6Iv(n,t){if(n.get_$91z()){var i=this;$4L0(n,function(t){t.IsSynced=!0;t.Diagnostics.SyncType=n.get_$120();t.Diagnostics.SyncInProgress=!1;t.Diagnostics.SyncError="";var i=_a.$7.get_$2M();t.LastSuccessfulSyncTime=_a.$7.$Eb(i);t.LastAttemptedSyncTime=t.LastSuccessfulSyncTime;n.$37.$DP.$8yr(t.Id,i.$55())},t)}else t()}function $6Iq(n){n.$1HK=!0;n.get_$YC().set_$1gx(!1)}function $3EL(n){n.$1HK=!1;n.get_$1Dr().$2db();n.get_$YC().set_$1gx(!0)}function $2Tb(n){if(n.$1Te){$PE(n,String.format("{0} has been aborted when invoking ExecuteCurrentStep",n.get_$1y()));return}$3EN(n);if(!_h.$4g.$2l){n.$91.$1by=Error.create("Abort syncing because Sync is disabled");$3EM(n,n.$91.$1by);return}if(!$6Il(n)){$9a(n,"Cannot execute current sync step number "+n.$14R+" is triggering action queue process and waiting until it finishes.");n.$2cV=!0;$3EL(n);return}n.get_$3gj()?$6Im(n):$6In(n)}function $6Im(n){var t=String.format("SyncModule_{0}.{1}",n.get_$FZ(),n.$91.$39C);var i=_a.$5.ads(_a.$0.$Bq,t);$4Kz(n);_a.$5.ade(i)}function $6In(n){n.$4Az=n.$1Fn();var t=n.get_$FZ()+":"+n.$91.$39C;$9a(n,String.format("Enqueing sync task: {0} on idle queue.",t));var i=this;n.$37.$5w.$Xf(_c.$1b.$D,t,function(){var i=n.$1Fn()-n.$4Az;i>=1e3&&$9a(n,String.format("Sync task {0} was delayed for {1} milliseconds",t,i));$4Kz(n)})}function $4Kz(n){$9a(n,String.format("Executing step #{0}: {1}",n.$14R,n.$91.$39C));$6Iq(n);n.$91.$5u4();n.$91.$39A++;n.$91.get_$96j()()}function $6Il(n){return!n.get_$YC().get_$5Ac()}function $6Io(n){$9a(n,String.format("Re-executing step number {0}. Step execution count = {1}",n.$14R,n.$91.$39A));if(_h.$4g.$39E>0){var t=this;_js.$K.get_$L().$21(_c.$1b.$D,"SyncExecuteCurrentStep",function(){$2Tb(n)},n.$91.get_$8tV())}else $2Tb(n)}function $3EM(n,t){if(n.$1Te){$PE(n,String.format("{0} has been aborted when invoking SyncAborted",n.get_$1y()));return}n.$1Te=!0;$PE(n,"Aborting syncing module Id "+n.get_$1y());t&&$PE(n,"Error: "+t.message);var i=this;$6Iu(n,!1,t,function(){n.$543(function(){n.$1me(6,t)})})}function $6It(n,t){var i=this;$4L0(n,function(t){t.Diagnostics.SyncType=n.get_$120();t.Diagnostics.SyncInProgress=!0;t.LastAttemptedSyncTime=_a.$7.$Eb(_a.$7.get_$2M())},t)}function $6Iu(n,t,i,r){$9a(n,String.format("Updating the sync diagnostics for module '{0}', SyncType: {1}, SyncInProgress: {2}, Error: {3}",n.get_$FZ(),n.get_$120(),t,i));n.get_$Y1().$9C0(n.get_$120(),t,i,r)}function $9a(n,t){_js.Trace.logInfo(_c.$1b.$D,"{0}: {1}",n.get_$FZ(),t)}function $12t(n,t){}function $PE(n,t){_js.Trace.logWarning(_c.$1b.$D,"{0}: {1}",n.get_$FZ(),t)}function $1Bt(n,t,i){_js.Trace.logError(_c.$1b.$D,n.get_$FZ()+": "+t+" [Data] {0}",i)}function $6Ir(n){n.$39o=_a.$7.get_$2M()}function $6Is(n){n.$4DO=_a.$7.get_$2M().$55()-n.$39o.$55()}function $4L0(n,t,i){$12t(n,String.format("Updating the SyncStateProperties"));n.get_$Y1().$3BI(t,i)}_c.$1C.prototype={$65W:null,$At:null,$37:null,$B3:null,$2JZ:null,$3Sy:null,$91:null,$2mR:!1,$3Wn:!1,$1HK:!1,$2cV:!1,$4DO:0,$3Az:0,$39o:null,$218:!1,$2BA:null,$4Az:0,$1Te:!1,get_$1HL:function(){return this.$1HK},get_$G5:function(){var n=new _a.$Kb(this.$2BA,_a.$7.get_$2M());return n.get_$9Ac()<5},get_$3B0:function(){return this.$3Az},set_$3B0:function(n){this.$3Az=n;return n},get_$985:function(){return this.$39o},get_$Y1:function(){return this.$B3.get_$Y1()},get_$552:function(){return this.$2BA},set_$552:function(n){this.$2BA=n;return n},get_$4vH:function(){return this.$3Wn},set_$4vH:function(n){this.$3Wn=n;return n},get_$H9:function(){return this.$3Sy},get_$FZ:function(){return _a.$9l.toString(this.get_$Oj())},get_$1Dr:function(){return this.$37.get_$1Dr()},get_$YC:function(){return this.$37.get_$YC()},get_$hk:function(){return this.$37.$1Qo},get_$120:function(){return _a.$ME.toString(this.$At.$KU)},get_$1y:function(){return _c.$1C.$7Lh(this.get_$FZ(),this.$At)},get_$7dD:function(){return this.$2cV},get_$Q7:function(){this.$2JZ||(this.$2JZ=this.$753());return this.$2JZ},get_$91Z:function(){return this.get_$1Dr().$NF||_c.$hg.isInstanceOfType(this.$At)},get_$1YA:function(){return this.$At.$KU===3?this.$At.get_$1y():""},get_$7We:function(){return!1},get_$3gj:function(){return this.$37.$DP.get_$12c()&&this.get_$7We()},get_$91z:function(){return!_c.$LG.isInstanceOfType(this.$At)||this.$At.$1DY===2},$5D7:function(){return!1},$91V:function(n){return this.$At.$KU!==4&&this.$At.$KU!==7&&this.$91W(n)},$10:function(){$6Ir(this);this.$1Te=!1;if(_c.$LG.isInstanceOfType(this.$At)){_js.Trace.logInfo(_c.$1b.$D,"{0}: Starting cleanup for module {1}",_a.$7.get_$2M(),this.get_$FZ());_a.$3.$8z(this.$At.$1DY!==1,"Quota exceeded error is not processed through this code path at present");var n=this,t=this;this.$63v(function(){var t=n.$At;t.$8cy(n.get_$Oj());n.$1c9()},function(n){_js.Trace.logError(_a.$0.$Bq,"Cleanup failed, but continuing with the rest of the sync. Error = "+n.message);n.message&&t.get_$Q7().set_$65N(n.message);t.$1c9()})}else{_js.Trace.logInfo(_c.$1b.$D,"{0}: Starting sync for module {1}",_a.$7.get_$2M(),this.get_$FZ());this.$ur()}},$ur:function(){$9a(this,String.format("Starting Sync with SyncContext Id '{0}', Time: {1}",this.$At.get_$1y(),this.$39o));this.$1me(1);$6It(this,this.$$d_$2fp)},$71R:function(){$9a(this,"Continue sync");if(this.$2cV){this.$2cV=!1;_js.Trace.logInfo(_c.$1b.$D,"{0}: Syncing module {1} step {2} continues its execution",_a.$7.get_$2M(),this.get_$FZ(),this.$14R);$2Tb(this)}},$8Vw:function(){this.$1me(0)},$8V9:function(){$3EN(this)},$3xc:function(){this.$1me(4)},$1YL:function(n){if(this.$91){this.$91.$39D=1;this.$91.$1by=n;this.$91.$1ba=!1;this.$d7()}else $3EM(this,n)},$91W:function(n){return!1},$2fp:function(){this.$91&&this.$91.$Ar();if(this.$14R>=this.$39B.length)throw Error.invalidOperation("All the steps in this module have already been executed");this.$91=this.$39B[++this.$14R];$2Tb(this)},$2iL:function(){$9a(this,"Getting a currentSyncState");this.get_$Y1().$2AU(this.$$d_$7Oa,this.$$d_$64Q)},$7Oa:function(n){var t=$8(n)?this.get_$Y1().$29q():n.get_$1s();this.$42j(t)},$42j:function(n){if(this.$50U(n)){$9a(this,"This module is being synced for the first time i.e. the SyncState is <empty>");this.$2mR=!0}else $9a(this,"The module is NOT being synced for the first time. SyncState is "+n.State);$9a(this,"Got a currentSyncState");this.$3Sy=n;this.$218=_js.$8.$14(n.Diagnostics.SyncError);this.$d7()},$64Q:function(n){var t=null;t=Error.create(n.get_$4i());this.$91.$1ba=n.get_$7cs();this.$3Wn=n.get_$7br();this.$3WU(t)},$50U:function(n){return n.State===""},$1c9:function(){if(this.$1Te){$PE(this,String.format("{0} has been aborted when invoking SyncCompleted",this.get_$1y()));return}$9a(this,"Completed syncing");$3EL(this);var n=this;$6Iv(this,function(){n.$544(function(){n.$1me(3)})})},$544:function(n){$9a(this,"Post sync completed");n()},$753:function(){return new _c.$3r(this.get_$Oj())},$d7:function(){if(this.$1Te){$9a(this,"Ignoring StepCompleted as the module has been aborted");return}$3EL(this);if(this.$91.$39D)this.$91.get_$60z()?$6Io(this):$3EM(this,this.$91.$1by);else{if(!$8(this.$91.$1by))throw Error.invalidOperation("previous StepError should be null at this point");this.$2fp()}},$1Fn:function(){return _a.$7.get_utcNow().$55()},$1me:function(n,t){if(n===6||n===3){$6Is(this);var r=this.get_$hk();if(r.get_$2l()){this.$9DX();this.get_$Q7().set_$5AH(this.$2mR);this.get_$Q7().set_$986(_a.$F0.toString(n));this.get_$Q7().set_$120(this.get_$120());this.get_$Q7().set_$2R8(_a.$PY.toString(this.$At.$11z));this.$2JZ.set_$984(this.$At.$65X);this.get_$Q7().set_$99h(this.$4DO);t&&t.message&&this.get_$Q7().set_$65N(t.message);r.$A7(this.get_$Q7());_a.$b.$7W(this.$2JZ.get_$Oj())}}var i=this;_js.$K.get_$L().$3i(_c.$1b.$D,"SyncInvokeProgressEventHandler_"+this.get_$FZ()+"_"+_a.$F0.toString(n),function(){i.$65W(i.$76S(n,t));n===3&&_a.$5.acea(null,"SyncModule_"+i.get_$FZ())})},$76S:function(n,t){return _a.$PX.$I(n,this.get_$Oj(),this.$3Az,this.get_$1y(),this.get_$1YA(),this.$2mR,null,null,t)},$543:function(n){$9a(this,"Processing sync aborted");n()},$9DX:function(){return},$6pS:function(n){_a.$3.$M(n,"action");_a.$3.$M(n.$1b,"action.Error");if(this.$1Te){$9a(this,"Ignoring ActionErrorCallback as the module has been aborted");return}$PE(this,String.format("Action failed, action name: {0}, error: {1}",n.$1j_2,n.$1b));this.get_$91Z()||(this.$91.$1ba=!1);this.$3WU(n.$1b)},$3WU:function(n){$PE(this,String.format("Error in current step number {0}. Error = {1}",this.$14R,n?n.toString():""));this.$91.$39D=1;this.$91.$1by=n;this.$d7()},$8sb:function(){$9a(this,"Resetting currentSyncState to null");this.$3Sy=null}};_c.$Ht=function(n,t,i){this.$$d_$6pS=Function.createDelegate(this,this.$6pS);this.$$d_$97q=Function.createDelegate(this,this.$97q);this.$$d_$8nF=Function.createDelegate(this,this.$8nF);this.$$d_$4ma=Function.createDelegate(this,this.$4ma);this.$$d_$5ry=Function.createDelegate(this,this.$5ry);this.$$d_$8SK=Function.createDelegate(this,this.$8SK);this.$$d_$97u=Function.createDelegate(this,this.$97u);this.$$d_$8kD=Function.createDelegate(this,this.$8kD);this.$$d_$97p=Function.createDelegate(this,this.$97p);_c.$Ht.$$(this.$$gta["_c.$Ht"].TSyncAction,this.$$gta["_c.$Ht"].TSyncResponse).initializeBase(this,[n,t,i]);$vC(this,this.$$d_$2iL,"GetSyncState");$vC(this,this.$$d_$97p,"SyncChangesFromServer");$vC(this,this.$$d_$8kD,"PerformModuleSpecificAction");$vC(this,this.$$d_$97u,"SynchronizeChangesToClientStore");$vC(this,this.$$d_$8SK,"OnBatchCompleted");switch(this.$At.$KU){case 7:$vC(this,this.$$d_$5ry,"ReconcileClientData");break;default:break}$vC(this,this.$$d_$4ma,"ConfirmSyncCompleted")};_c.$Ht.$$=function(n,t){var i="$Ht"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_c[i]){var u=_c[i]=function(){(this.$$gta=this.$$gta||{})["_c.$Ht"]={TSyncAction:n,TSyncResponse:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_c.$Ht.apply(this,r)};u.registerClass("_c."+i,_c.$1C);var f=_c.$Ht.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _c[i]};_c.$Ht.prototype={$1i4:null,$4Bw:null,$2MW:null,get_$9JR:function(){return this.$1i4},get_$8p2:function(){return 100},get_$9JS:function(){return this.$2MW},get_$7cc:function(){return!$8(this.$1i4)&&this.$6xi(this.$1i4)},get_$9JT:function(){this.$4Bw||(this.$4Bw=this.$7WW());return this.$4Bw},$7Io:function(){return this.get_$Oj()},$5ry:function(){if(_e.$sV.isInstanceOfType(this.$2MW)){this.$8ST();var t=this.$2MW;var n=this,i=this;this.$B3.$5ry(t,this.get_$8p2(),this.$$d_$8nF,function(){n.get_$Q7().set_$3Ud(t.get_$4sJ());n.get_$Q7().set_$33d(t.get_$33d());_js.Trace.logInfo(_a.$0.$Bq,"Finished sync reconciliation (Reconciled/Detected: {0}/{1}).",n.get_$Q7().get_$33d(),n.get_$Q7().get_$3Ud());n.get_$YC().$4yz(function(t){n.get_$Q7().set_$6pV(t.length);for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];_js.Trace.logWarning(_a.$0.$Bq,"Existing action in the queue after sync reconciliation was done: {0}",_g.$47.$R1(f))}n.$d7()},n.$$d_$3WU)},function(n){_js.Trace.logError(_a.$0.$Bq,"Failed to reconcile client data. Error: {0}",n.get_$4i());i.$64Q(n)})}else{this.get_$Q7().set_$3Ud(-1);this.get_$Q7().set_$33d(-1);this.$d7()}},$63v:function(n,t){_a.$3.$M(n,"onCleanupComplete");_a.$3.$M(t,"errorCallback");_js.Trace.logInfo(_c.$1b.$D,"Starting cleanup for module '{0}'",this.get_$1y());this.$8SM();var i=this.$730();if(i){var r=this;this.$B3.$YX(this.$At.$1DY,i,n,function(n){$PE(r,"Module cleanup failed with error: "+n.get_$4i());var i=Error.create(n.get_$4i());t(i)})}else n()},$97u:function(){$9a(this,"Persisting changes to client store");this.$2MW=this.$76M();var n=this.$75D();n.IsSynced=this.get_$H9().IsSynced;n.LastSuccessfulSyncTime=this.get_$H9().LastSuccessfulSyncTime;n.Diagnostics.SyncInProgress=!0;this.$B3.$987(n,this.$2MW,this.$$d_$d7,this.$$d_$64Q)},$8nC:function(n){n()},$8nF:function(n){n()},$7WW:function(){return new _e.$17w},$8sb:function(){_c.$1C.prototype.$8sb.call(this);this.$1i4=null},$6pS:function(n){var t=n;if(t.get_$4dL()&&t.get_$4dL().responseCode==="ErrorInvalidSyncStateData"){$PE(this,"Receiving ErrorInvalidSyncStateData response");this.$37.$S.$8oV(_h.$LF,new _h.$LF(this.$7Io(),!1));this.$37.$DP.$45L();this.$37.$S.$8oV(_h.$PT,new _h.$PT(12));this.$1YL(Error.create("Abort syncing current module because receiving ErrorInvalidSyncStateData response"))}else _c.$1C.prototype.$6pS.call(this,n)},$76M:function(){if(!this.$1i4)throw Error.invalidOperation("CurrentSyncResponse should not be null at this point");return this.$7WV()},$97p:function(){if($8(this.get_$H9()))throw Error.invalidOperation("CurrentSyncState cannot be null before starting this step");if(this.$91l()){var n=this;this.$76L(function(t){if(t){t.add_$2A(n.$$d_$97q);t.add_$20(n.$$d_$6pS);OwaApplication.$1T.$y(t)}else{$PE(n,"Sync action is null");n.$1YL(Error.invalidOperation("Sync action is null"))}})}else this.$1c9()},$91l:function(){return!0},$8kD:function(){this.$d7()},$8SK:function(){this.$2hN(0);this.$d7()},$4ma:function(){$9a(this,"Confirming sync is complete");if(this.get_$7cc())this.$1c9();else{this.$1me(2,null);this.$8sb();$6Ip(this)}},$544:function(n){this.$2hN(1);_c.$1C.prototype.$544.call(this,n)},$543:function(n){this.$2hN(2);_c.$1C.prototype.$543.call(this,n)},$2hN:function(n){this.$At.$KU===5?this.$7Ha(n):n!==2&&this.$7Hb(n)},$7Ha:function(n){},$7Hb:function(n){},$8SM:function(){},$8ST:function(){},$97q:function(n){var t=n;this.$1i4=t.get_syncResponse();var i=this;this.$8nC(function(){i.$d7()})}};_c.$3r=function(n){_c.$3r.initializeBase(this,[1,"Core.Models.Sync.ModuleStats"]);$1O(this,_c.$3r.$2xZ,_a.$9l.toString(n))};_c.$3r.prototype={get_$Oj:function(){return this.$W(_c.$3r.$2xZ)},set_$Oj:function(n){$1O(this,_c.$3r.$2xZ,n);return n},get_$5AH:function(){return this.$W(_c.$3r.$3gN)},set_$5AH:function(n){$1O(this,_c.$3r.$3gN,n);return n},get_$120:function(){return this.$W(_c.$3r.$4C6)},set_$120:function(n){$1O(this,_c.$3r.$4C6,n);return n},get_$2R8:function(){return this.$W(_c.$3r.$4C1)},set_$2R8:function(n){$1O(this,_c.$3r.$4C1,n);return n},get_$986:function(){return this.$W(_c.$3r.$4C3)},set_$986:function(n){$1O(this,_c.$3r.$4C3,n);return n},get_$65N:function(){return this.$W(_c.$3r.$4Bp)},set_$65N:function(n){$1O(this,_c.$3r.$4Bp,n);return n},get_$99h:function(){return this.$W(_c.$3r.$4DP)},set_$99h:function(n){$1O(this,_c.$3r.$4DP,n);return n},get_$4FA:function(){return this.$W(_c.$3r.$4FB)},set_$4FA:function(n){$1O(this,_c.$3r.$4FB,n);return n},get_$4rn:function(){return this.$W(_c.$3r.$3U7)},set_$4rn:function(n){$1O(this,_c.$3r.$3U7,n);return n},get_$984:function(){return this.$W(_c.$3r.$4By)},set_$984:function(n){$1O(this,_c.$3r.$4By,n);return n},get_$3Ud:function(){return this.$W(_c.$3r.$3Ue)},set_$3Ud:function(n){$1O(this,_c.$3r.$3Ue,n);return n},get_$33d:function(){return this.$W(_c.$3r.$43O)},set_$33d:function(n){$1O(this,_c.$3r.$43O,n);return n},get_$6pV:function(){return this.$W(_c.$3r.$3Jx)},set_$6pV:function(n){$1O(this,_c.$3r.$3Jx,n);return n}};_c.$17W=function(n,t,i,r,u){_c.$17W.initializeBase(this,[t]);_a.$3.$M(n,"foldersToSync");_a.$3.$M(t,"syncState");_a.$3.$6v(i,1,100,"maxChangesReturned");this.$1FM=new Array(n.length);for(var f=0;f<n.length;f++)this.$1FM[f]=new _g.$3J(n[f]);this.$2r7=i;this.$5C5=r;this.$2eb=u};_c.$17W.prototype={$1FM:null,$2r7:0,$5C5:!1,$2eb:!1,$76O:function(n){var t=new _g.$dM(this.$2r7);t.NumberOfDays=_h.$1y.$1ze;t.MinimumCount=_h.$1y.$11y;t.MaximumCount=_h.$1y.$1B2;t.FolderIds=this.$1FM;t.SyncState=this.get_$kC().State;t.IsPartialFolderList=this.$5C5;t.DoQuickSync=this.$2eb;t.ConversationShape=_h.$11.get_$562();t.ConversationShape.InferenceEnabled=_g.$S.get_$L().get_$6D().get_$Ry();t.ShapeName=_h.$11.$4z5(this.$1FM[0],null);return new _g.$dK(n,t)},$7XB:function(n){var t=this.$76O(this.get_$6o());var i=new _g.$17V(this.$28);n.$65I(t,i,this.$$d_$9K7,this.$$d_$9K8)}};_c.$dN=function(n){this.$4n9=[];_c.$dN.initializeBase(this);this.$2n=n};function $6IS(n,t){for(var u=[],f=t,e=f.length,r=0;r<e;++r){var i=f[r];Array.add(n.get_$9IY(),_e.$D8.$xL(i.FolderId,i.ConversationId));Array.add(u,i.ConversationId.Id);n.$9Ia(i.FolderId.Id)}_c.$1q.$4w("SyncConversation received {0} deletes. List of conversations deleted = [{1}]",t.length,u.join(","))}function $6IR(n,t){for(var f={},e=[],o=t,s=o.length,r=0;r<s;++r){var i=o[r];Array.add(n.get_$9IX(),i);var u=i.ConversationId.Id;if($8(f[u])){f[u]=!0;Array.add(n.$4n9,new _g.$QL(i.ConversationId))}var h=i.FolderId.Id;n.$9Ia(h);Array.add(e,u+"::"+i.LastDeliveryTime+"::"+i.ConversationTopic)}_c.$1q.$4w("SyncConversation received {0} AddsAndChanges. List of conversations added = [{1}]",t.length,e.join(","))}_c.$dN.prototype={$2n:null,get_$kC:function(){return this.$2n.SyncState},get_includesLastItemInRange:function(){return this.$2n.IncludesLastItemInRange},get_$9IW:function(){return this.$2n.ConversationViewDataList},$2Mc:function(){var n=this.$2n.DeletedConversations;var t=this.$2n.Conversations;n&&$6IS(this,n);t&&$6IR(this,t)}};_c.$9F=function(n,t,i,r){_c.$9F.initializeBase(this,[n,t,i]);this.$1K=r;this.$2cD=_a.$5H.$$(_g.$6P).$8M();this.$1BP=_a.$5H.$$(String).$8M();this.$48b=!1;this.$1cn=0;this.$1cl=0;this.$3Aq=0;this.$3Ar=0};_c.$9F.$7Oc=function(n,t,i,r){var u=n.$3u();var f=u.$2q(1-u.get_$5z());var e=f.$GR(t);i.val=f.$2q(_c.$9F.$6Bj);r.val=e.$2q(14)};function $6IL(n){var t=new _g.$Bn(new _g.$3J(n.$2i.Id));return new _c.$17N(n.get_$H9(),t,n.$1Bk,n.$1NW)}function $4Kn(n,t,i,r,u,f){var e=[];$9a(n,String.format("Items to sync: {0}",t.length));var o=this;$3EI(n,t,0,n.get_$7hh(),i,r,u,e,function(){$9a(n,String.format("Failed items to sync: {0}",e.length));$4Ko(n,e,u,f)})}function $4Ko(n,t,i,r){var u=this;$3EI(n,t,0,1,!1,!1,i,[],function(){r()})}function $3EI(n,t,i,r,u,f,e,o,s){var l=t.length-i;var h=Math.min(l,r);$9a(n,String.format("SyncItems with offset = {0}, remaining = {1}, count = {2}",i,l,h));if(h){for(var a=new Array(h),c=0;c<h;c++)a[c]=t[i+c];i+=h;var v=this;n.$97x(a,e,u,f,o,function(){$3EI(n,t,i,r,u,f,e,o,s)})}else{$9a(n,"Done syncing items");s()}}_c.$9F.prototype={$1K:null,$1Bk:null,$1NW:null,$2i:null,$2cD:null,$1BP:null,$48b:!1,$1cn:0,$1cl:0,$3Aq:0,$3Ar:0,$3k7:!1,get_$Oj:function(){return 10},get_$3Sz:function(){return _g.$S.get_$L().get_$1t().get_$IJ()},get_$7hh:function(){return 50},$91W:function(n){return n===1},$7L7:function(){if(!_c.$9F.$iX){var n=this.$1K.get_$A0()?_h.$11.get_$4yT():_h.$11.get_$7H4();_c.$9F.$iX=_0365f.$2t.$46(n);_c.$9F.$iX.MaximumBodySize=this.$37.$Am==="Mouse"?51200:25600}return _c.$9F.$iX},$6xi:function(n){this.$3k7=n.IncludesLastItemInRange;return this.$3k7&&!this.get_$H9().TryToIncrementWindowSizeOnNextSync},$75D:function(){return new CalendarSyncState(this.get_$9JR().SyncState,this.$2i.Id,this.$1Bk,this.$1NW,this.get_$3Sz(),this.get_$H9().ApproximateWindowSize,this.get_$H9().TryToIncrementWindowSizeOnNextSync)},$42j:function(n){var t=n;if(this.$50U(n)){t.ApproximateWindowSize=3;t.TryToIncrementWindowSizeOnNextSync=6>t.ApproximateWindowSize}else if($8(t.ApproximateWindowSize)){t.ApproximateWindowSize=6;t.TryToIncrementWindowSizeOnNextSync=!1}else if(t.TryToIncrementWindowSizeOnNextSync&&this.$3k7){var i=t.ApproximateWindowSize+3;if(i>=6){t.ApproximateWindowSize=6;t.TryToIncrementWindowSizeOnNextSync=!1}else t.ApproximateWindowSize=i}var r,u;_c.$9F.$7Oc(_a.$7.get_$2M(),t.ApproximateWindowSize,r={val:this.$1Bk},u={val:this.$1NW});this.$1Bk=r.val;this.$1NW=u.val;_c.$1C.prototype.$42j.call(this,n)},$7WV:function(){var i=this.$B3;var t=this.$At;var n=this.get_$9JR();return new _e.$7T(i.get_$95(),_c.$vC.isInstanceOfType(t)||_c.$kr.isInstanceOfType(t),this.$1Bk.$8r(),n.UpdatedItems,n.RecurrenceMastersWithInstances,n.RecurrenceMastersWithoutInstances,n.DeletedItems,this.$2cD,this.$1BP)},$730:function(){return new _e.$wh(this.$B3.get_$95().get_$hL(),this.$B3.get_$95().get_$1o(),this.$B3.get_$95().get_$kC())},$8nC:function(n){var t=this.get_$9JR();this.$1cn+=t.UpdatedItems.length;this.$1cl+=t.DeletedItems.length;this.$3Aq+=t.RecurrenceMastersWithInstances.length;this.$3Ar+=t.RecurrenceMastersWithoutInstances.length;(this.$1cn>0||this.$1cl>0||this.$3Aq>0||this.$3Ar>0)&&(this.$48b=!0);for(var i=[],u=0;u<t.RecurrenceMastersWithInstances.length;u++){var f=t.RecurrenceMastersWithInstances[u];this.$1BP.set_$48(f.UID,f.ItemId.Id);Array.add(i,f.ItemId)}for(var e=0;e<t.UnchangedRecurrenceMastersWithInstances.length;e++){var r=t.UnchangedRecurrenceMastersWithInstances[e];if(!this.$1BP.$Lg(r.UID)){this.$1BP.set_$48(r.UID,r.ItemId.Id);Array.add(i,r.ItemId)}}for(var o=0;o<t.UpdatedItems.length;o++){var s=t.UpdatedItems[o];s.CalendarItemType==="Occurrence"&&this.$1BP.$Lg(s.UID)||Array.add(i,s.ItemId)}$4Kn(this,i,!0,!0,this.$2cD,n)},$8nF:function(n){var t=this.get_$9JS();var i=new Array(t.get_$4sJ());var r=0;var f=this;t.$3YQ(function(n){var t=new _g.$1j(n);i[r++]=t});var u=this;$4Kn(this,i,!1,!1,t.$1a7,function(){_c.$Ht.prototype.$8nF.call(u,n)})},$76L:function(n){var t=this;_c.$Du.$7Ic(this.$37.get_$57(),function(i){if(i){$9a(t,String.format("Syncing calendar folder ('{0}').",i.Id));t.$2i=i;var r=$6IL(t);n(r)}else{$PE(t,"Could not find the primary calendar folder.");n(null)}})},$9DX:function(){var n=this.get_$Q7();n.set_$4FA(this.$1cn);n.set_$4rn(this.$1cl);n.set_$9Ad(this.$3Aq);n.set_$9Ae(this.$3Ar);n.set_$989($8(this.$1Bk)?"":this.$1Bk.$8r());n.set_$988($8(this.$1NW)?"":this.$1NW.$8r());n.set_$97t($8(this.$2i)?"":this.$2i.Id);if(this.get_$H9()){var t=this.get_$H9();n.set_$6sj(t.ApproximateWindowSize);n.set_$9Bw(t.TryToIncrementWindowSizeOnNextSync)}},$753:function(){return new _c.$17U(this.get_$Oj())},$7Hb:function(n){if(n===1&&this.$48b&&(this.$At.$1kd||!this.$218)){$9a(this,"Raising Hierarchy notification for calendar synced folders");this.get_$9JT().$2hF([this.$2i.Id])}_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){if(n===2||n===1){$9a(this,"Raising Hierarchy notification for calendar all folders");this.get_$9JT().$2hF([this.$2i.Id])}_c.$Ht.prototype.$7Ha.call(this,n)},$8sb:function(){this.$2cD=_a.$5H.$$(_g.$6P).$8M();this.$1BP=_a.$5H.$$(String).$8M();_c.$Ht.prototype.$8sb.call(this)},$8ST:function(){if(this.$At.$KU===7){var n=this.$1Fn()+288e5;this.$37.$DP.set_$31n(n);$9a(this,String.format("Next calendar reconcile time: {0} utc ms",n))}_c.$Ht.prototype.$8ST.call(this)},$97x:function(n,t,i,r,u,f){var s=new _c.$dY(this.get_$Oj(),n,this.$7L7(),"FullCalendarItem");var e=this;s.add_$2A(function(r){e.$2BA=_a.$7.get_$2M();for(var h=r,l=h.$As.length,o=0;o<l;o++){var s=h.$As[o];if(!e.$9Bq(t,s))if(i&&s.ResponseCode!=="ErrorItemNotFound")Array.add(u,n[o]);else{var c=String.format("Failed to sync item: {0}, ResponseCode: {1}",n[o].Id,s.ResponseCode);s.ResponseCode==="ErrorItemNotFound"?$PE(e,c):$1Bt(e,c,"");Array.add(e.get_$9JR().DeletedItems,n[o])}}f()});var o=this;s.add_$20(function(i){if(r){$PE(o,"Retry sync items action");$4Ko(o,n,t,f)}else{$PE(o,"Sync items action failed");o.$6pS(i)}});OwaApplication.$1T.$y(s)},$9Bq:function(n,t){switch(t.ResponseCode){case"NoError":var r=t.Items;if(r&&r.length>0){_a.$3.$HZ(r.length,1,String.format("There are unexpected number of items ({0}) in the response.",r.length));var i=r[0];_a.$3.$kI(i,null,String.format("The item should not be null with the response code '{0}'.",t.ResponseCode));!$8(i.Body)&&i.Body.IsTruncated&&(i.Body.Value="");!$8(i.TextBody)&&i.TextBody.IsTruncated&&(i.TextBody.Value="");n.set_$48(i.ItemId.Id,i)}return!0;default:$PE(this,String.format("SyncItems encountered error (ResponseCode: {0}; MessageText: '{1}').",t.ResponseCode,t.MessageText));return!1}}};_c.$Du=function(n,t,i){_c.$Du.initializeBase(this,[n||new _e.$ws(t.get_$57()),t]);this.$1K=i};_c.$Du.$7Ic=function(n,t){_c.$Du.$6vI(n,function(){t(_c.$Du.$1gY)})};_c.$Du.$6vI=function(n,t){_c.$Du.$1gY?t():_e.$7i.$1SK(new _e.$Yq(n,"UTC"),"calendar",function(n){n?_c.$Du.$1gY=n.get_$1s().FolderId:_c.$1q.$ij("The primary calendar folder is not present in the folder hierarchy.");t()},function(n){_c.$1q.$DL("Failed to find the calendar folder. Error: {0}",n);t()})};_c.$Du.prototype={$1K:null,get_$65Q:function(){return 0},$76Q:function(n,t,i){i([new _c.$9F(n,t,this.$Np,this.$1K)])},$91o:function(n){return!!_c.$Du.$1gY&&n===_c.$Du.$1gY.Id},$91r:function(){return this.$37.$DP.get_$31n()-this.$1Fn()<=0},$91C:function(){return!0},$3al:function(){return"CalendarSyncState"},$3P6:function(n,t){if(_e.$eu.isInstanceOfType(n)){var i=t;var r=n;if(_c.$v2.prototype.$3P6.call(this,n,t)&&r.$4ir===i.FolderId){var u=_g.$S.get_$L().get_$1t().get_$IJ();if(i.TimeZone===u){var f=r.$1Bk.localeCompare(i.WindowStart);if(f>=0){var e=r.$1NW.localeCompare(i.WindowEnd);if(!(e>0))return!0}}else _js.Trace.logWarning(_c.$1b.$D,"Calendar module is synced to a different time zone ('{0}') than expected ('{1}').",i.TimeZone,u)}return!1}else throw Error.argumentType("context",Object.getType(n),_e.$eu,"The context type should match the module.");}};_c.$17h=function(n){_c.$17h.initializeBase(this,[n])};_c.$17h.prototype={$7XB:function(n){var t=new _g.$dP(this.get_$6o(),new _g.$dR(_h.$11.get_$3dF()));t.Body.ShapeName="Folder";t.Body.ReturnRootFolder=!0;t.Body.SyncState=this.get_$kC().State||"";t.Body.ReturnPeopleIKnowFolder=!0;var i=new _g.$17i(this.$28);n.$65O(t,i,this.$$d_$9K7,this.$$d_$9K8)}};_c.$17j=function(n,t,i){_c.$17j.initializeBase(this,[n,t,i]);this.$14M=[];this.$3Sb=[]};_c.$17j.prototype={$14M:null,$3Sb:null,$31B:0,$10U:null,get_$Oj:function(){return 2},$6xi:function(n){return n.IncludesLastFolderInRange},$76L:function(n){n(new _c.$17h(this.get_$H9()))},$7WV:function(){return new _e.$zP(this.$B3.get_$95().get_$2j(),this.$14M,this.$10U,this.$31B)},$730:function(){return null},$75D:function(){return new SyncState("FolderHierarchySyncStateId","")},$8nC:function(n){if(!this.get_$9JR().RootFolder)throw Error.invalidOperation("Server returned null value for RootFolder in the SyncFolderHierarchy response. That should never happen");_e.$7i.$5zL(this.get_$9JR().RootFolder,0);Array.add(this.$14M,this.get_$9JR().RootFolder);for(var r={},u=this.get_$9JR().Changes.Changes,t=0;t<u.length;t++){var f=u[t];switch(f.ChangeType){case"Create":case"Update":var i=f.Folder;if(i.DistinguishedFolderId==="outbox"){this.$10U=i.FolderId.Id;this.$31B=t+1}_e.$7i.$5zL(i,t+1);Array.add(this.$14M,i);r[i.FolderId.Id]=!0;break;case"Delete":break}}$9a(this,String.format("Number of created/updated folders = {0} and number of deleted folders = {1}",this.$14M.length,this.$3Sb.length));var o=this,e=this;this.$37.$DW.$6AX(r,function(){_c.$Ht.prototype.$8nC.call(o,n)},function(t){$1Bt(e,"An error occured during updating the sync folder settings: {0}",t.toString());_c.$Ht.prototype.$8nC.call(e,n)})},$7Hb:function(n){!n&&this.get_$9JR()&&this.$At.$KU===1&&this.get_$9JT().$3Yr(this.get_$9JR());_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){this.get_$9JR()&&!n&&this.get_$9JT().$3Yr(this.get_$9JR());_c.$Ht.prototype.$7Ha.call(this,n)},$8sb:function(){this.$14M=[];this.$3Sb=[];_c.$Ht.prototype.$8sb.call(this)}};_c.$17m=function(n,t){_a.$3.$M(n,"stepDelegate");this.$64G=n;this.$39C=t;this.$Ar()};_c.$17m.prototype={$64G:null,$39C:null,$39D:0,$1by:null,$39A:0,$1ba:!1,get_$96j:function(){return this.$64G},get_$60z:function(){return this.$1ba&&this.$39A<_h.$4g.$3mP},set_$60z:function(n){this.$1ba=n;return n},get_$8tV:function(){return _h.$4g.$39E},$5u4:function(){this.$39D=0;this.$1by=null},$Ar:function(){this.$39A=0;this.$1ba=!0;this.$5u4()}};_c.$v2=function(n,t){_a.$3.$M(t,"ExternalSyncDependencies");this.$37=t;this.$Np=n||new _e.$aN(this.get_$57(),this.$3al())};function $6Iw(n,t){var r=n.$37.$DP.$7LC(n.$3al());if(t!==100){var i=_h.$4g.$1za[n.get_$65Q()];i||t!==5||n.$3gM||(i=_h.$4g.$43w);return n.get_$65Q()===1&&(n.$3gM||t===2||t===7||t===8||t===9||t===11)||_a.$7.get_$2M().$55()-r>i}else return!0}_c.$v2.prototype={$Np:null,$37:null,$3gM:!0,get_$57:function(){return this.$37.get_$57()},$91n:function(n){return $6Iw(this,n)},$8sW:function(){this.$3gM=!1},$91s:function(){return!0},$91u:function(n){var t=OwaApplication.$3x;return t.$4D5===n},$91t:function(){return!1},$91r:function(){return!1},$91m:function(){return!1},$91p:function(){return!1},$91q:function(){return!1},$91B:function(n){var t=!1;switch(n){case 1:t=!0;break;case 2:t=this.$91E();break;case 4:t=this.$91C();break;case 3:t=this.$91D();break;default:break}return t},$91E:function(){return!1},$91C:function(){return!1},$91D:function(){return!1},$4EZ:function(n,t,i){n.$48Z(this)?this.$76Q(n,t,i):i(null)},$NL:function(n,t){var i=this,r=this;this.$Np.$2iL(function(r){var u=i.$3P6(n,r);t(u)},function(){t(!1)})},$1Up:function(n,t){var i=this,r=this;this.$Np.$2iL(function(r){var u=i.$3P6(n,r);var f=i.$7Lj(n,r);t(u,f)},function(){t(!1,null)})},$1Fn:function(){return _a.$7.get_utcNow().$55()},$3P6:function(n,t){return t.IsSynced},$7Lj:function(n,t){return t.ModuleSpecificContext}};_c.$182=function(n,t){_c.$182.initializeBase(this,[n]);this.$5F7=t};_c.$182.prototype={$5F7:null,$7XB:function(n){var t=new _g.$db(50);t.SyncState=this.get_$kC().State||"";t.JumpHeaderValues=this.$5F7;t.MaxPersonas=5e3;var i=new _g.$dZ(this.get_$6o(),t);var r=new _g.$183(this.$28);n.$65U(i,r,this.$$d_$9K7,this.$$d_$9K8)}};_c.$184=function(){_c.$184.initializeBase(this,[null])};_c.$184.prototype={$7XB:function(n){var t=new _g.$rN(this.$28);n.$1Sg(t,this.$$d_$9K7,this.$$d_$9K8)}};_c.$185=function(n,t,i){_c.$185.initializeBase(this,[n,t,i])};_c.$185.prototype={get_$Oj:function(){return 7},$6xi:function(n){return!0},$75D:function(){return new SyncState("PeopleFiltersSyncStateId","")},$76L:function(n){n(new _c.$184)},$91W:function(n){return n===2},$7WV:function(){$9a(this,String.format("Number of created/updated people filters = {0}",this.get_$9JR().length));return new(_e.$LE.$$(_bc.$aF,_g.$bb))(this.$B3.get_$95().get_$40j(),this.get_$9JR())},$730:function(){return new(_e.$QB.$$(_bc.$aF))(this.$B3.get_$95().get_$40j())},$544:function(n){var t=this;_c.$H4.$6vJ(this.$37.get_$57(),function(){_c.$Ht.prototype.$544.call(t,n)})}};_c.$186=function(n,t){_c.$186.initializeBase(this,[n,t])};_c.$186.prototype={get_$65Q:function(){return 1},$76Q:function(n,t,i){i([new _c.$185(n,t,this.$Np)])},$91o:function(n){return!1},$91C:function(){return!0},$3al:function(){return"PeopleFiltersSyncStateId"}};_c.$Ij=function(n,t,i,r,u){this.$2Sr=0;_c.$Ij.initializeBase(this,[n,t,i]);this.$WB=u;this.$39h={};this.$1cl=0;this.$1cn=0;this.$4mp=r};function $4L3(n,t){t.length?n.get_$9JT().$7HU(t):$1Bt(n,"Contacts folder list should not be empty","")}function $6J2(n,t){var r=null;if(t){var u=$4L4(n);r={};for(var i=0;i<t.length;++i)r[u[i]]=t[i]}return r}function $4L4(n){return _a.$z.get_$By().culture().people.headerSeekToValues}function $6J3(n){return!_js.$8.$c(n.get_$H9().State)}_c.$Ij.prototype={$39h:null,$1cn:0,$1cl:0,$4mp:null,$WB:null,get_$Oj:function(){return 8},$91W:function(n){return n===2},$6xi:function(n){return n.IncludesLastItemInRange},$42j:function(n){if(n.UserCultureAtLastSync&&n.UserCultureAtLastSync!==this.$37.$F5){$PE(this,String.format("User culture has changed from '{0}' to '{1}', existing personas will be wiped",n.UserCultureAtLastSync,this.$37.$F5));this.$2Sr=1;var t=this;this.$B3.$YX(3,this.$730(),function(){n.State="";t.$5qk(n)},this.$$d_$64Q)}else this.$5qk(n)},$76L:function(n){var t=$6J3(this)?null:$4L4(this);n(new _c.$182(this.get_$H9(),t))},$9DX:function(){var n=this.get_$Q7();n.set_$4FA(this.$1cn);n.set_$4rn(this.$1cl);n.set_$9H8(this.$2Sr)},$753:function(){return new _c.$187(this.get_$Oj())},$7WV:function(){return new _e.$bj(_e.$5T.$I(this.$B3.get_$95()),new _e.$9O(this.$B3.get_$95()),this.$B3.get_$95().get_$3Q1(),this.$B3.get_$95().get_$5nE(),this.get_$9JR().People,this.get_$9JR().DeletedPeople,$6J2(this,this.get_$9JR().JumpHeaderSortKeys))},$8nC:function(n){if(this.get_$H9().SortKeyVersionAtLastSync!==SyncState.$3wb&&this.get_$9JR().SortKeyVersion!==this.get_$H9().SortKeyVersionAtLastSync){$PE(this,String.format("Sort key version has changed from '{0}' to '{1}', existing personas will be wiped",this.get_$H9().SortKeyVersionAtLastSync,this.get_$9JR().SortKeyVersion));this.$2Sr=4;var i=this;this.$B3.$YX(3,this.$730(),function(){i.get_$9JR().SyncState="";i.get_$9JR().IncludesLastItemInRange=!1;_c.$Ht.prototype.$8nC.call(i,n)},this.$$d_$64Q);return}this.$1cn+=this.get_$9JR().People.length;this.$1cl+=this.get_$9JR().DeletedPeople.length;for(var t=0;t<this.get_$9JR().People.length;++t)for(var r=0;r<this.get_$9JR().People[t].FolderIds.length;++r)this.$39h[this.get_$9JR().People[t].FolderIds[r].Id]=!0;$9a(this,String.format("Number of created/updated persona = {0} and number of deleted persona = {1}",this.get_$9JR().People.length,this.get_$9JR().DeletedPeople.length));_c.$Ht.prototype.$8nC.call(this,n)},$6pS:function(n){var t=n;if(t.get_$2Nl()==="ErrorFullSyncRequiredException"||t.get_$2Nl()==="ErrorTooManyContactsException"){_c.$1q.$4w("Sync action failed with {0}, wiping the persona store",t.get_$2Nl());this.$2Sr=t.get_$2Nl()==="ErrorFullSyncRequiredException"?2:3;var i=this;this.$B3.$YX(3,this.$730(),function(){i.get_$H9().State="";_c.$Ht.prototype.$6pS.call(i,n)},this.$$d_$64Q)}else _c.$Ht.prototype.$6pS.call(this,n)},$7Hb:function(n){if(n===1&&_0365f.$57.$F(this.$39h)>0&&(this.$At.$1kd||!this.$218)){var t=[];var i=this.$39h;for(var r in i){var u={key:r,value:i[r]};Array.add(t,u.key)}$9a(this,"Raising Persona notification for people synced folders");$4L3(this,t)}_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){if(n===2||n===1){$9a(this,"Raising Persona notification for people all folders");$4L3(this,this.$4mp)}_c.$Ht.prototype.$7Ha.call(this,n)},$75D:function(){var n=new SyncState("PeopleSyncStateId",this.get_$9JR().SyncState);n.UserCultureAtLastSync=this.$37.$F5;n.SortKeyVersionAtLastSync=this.get_$9JR().SortKeyVersion;return n},$730:function(){return new _e.$14p(_e.$5T.$I(this.$B3.get_$95()))},$1c9:function(){this.$WB.get_$2X5().get_$2X4()===1&&this.$WB.$981();_c.$1C.prototype.$1c9.call(this)},$5qk:function(n){_c.$1C.prototype.$42j.call(this,n)}};_c.$H4=function(n,t,i){_c.$H4.initializeBase(this,[n,t]);_a.$3.$M(i,"NativeBridge should not be null.");this.$27=i};_c.$H4.$6vJ=function(n,t){_e.$FW.$1Sg(new(_e.$7E.$$(_bc.$aF,_e.$FW))(n,_e.$1a.$6t),function(i){for(var u=[],r=0;r<i.length;++r)if(_js.$8.$c(i[r].$3Zf()))_c.$1q.$ij("PeopleFilterItem entry folderId is empty");else{_c.$1q.$4w("Caching contacts folder '{0}' ",i[r].$3Zf());Array.add(u,i[r].$3Zf())}_e.$7i.$1SK(new _e.$Yq(n,_e.$1a.$6t),"recipientcache",function(n){if(n){var i=n.get_$1y().toString();if(_js.$8.$c(i))_c.$1q.$ij("RecipientCacheFolderItem folderId is empty");else{_c.$1q.$4w("Cacheing recipient cache folder '{0}'.",i);Array.add(u,i)}}else _c.$1q.$ij("RecipientCacheFolderItem is null");_c.$H4.$2ZH=u;t()},function(n){_c.$1q.$DL("Failed to fetch the recipient cache folder. Error: {0}",n);t()})},function(n){_c.$1q.$DL("Failed to get all folders. Error: {0}",n);t()})};_c.$H4.prototype={$27:null,get_$65Q:function(){return 1},$76Q:function(n,t,i){i([new _c.$Ij(n,t,this.$Np,_c.$H4.$2ZH,this.$27.$WB)])},$91o:function(n){_c.$1q.$4w("Checking if sync people should occur for folder '{0}'",n);return Array.contains(_c.$H4.$2ZH,n)},$91C:function(){return!0},$3al:function(){return"PeopleSyncStateId"}};_c.$189=function(n,t,i){_c.$189.initializeBase(this,[n,t,i])};_c.$189.prototype={get_$Oj:function(){return 3},$6xi:function(n){return!0},$76L:function(n){n(new _c.$oV(this.get_$H9(),this.$37.$1D.get_$5h()))},$91W:function(n){return n===1},$9DX:function(){this.get_$9JR()&&this.get_$Q7().set_$4FA(this.get_$9JR().Reminders.length)},$7WV:function(){$9a(this,String.format("Number of created reminders = {0}",this.get_$9JR().Reminders.length));return new(_e.$LE.$$(_bc.$Um,_g.$VX))(this.$B3.get_$95().get_$jj(),this.get_$9JR().Reminders)},$730:function(){return new(_e.$QB.$$(_bc.$Um))(this.$B3.get_$95().get_$jj())},$7Hb:function(n){n===1&&this.get_$9JR()&&this.get_$9JR().Reminders.length>0&&(this.$At.$1kd||!this.$218)&&this.get_$9JT().$29d();_c.$Ht.prototype.$7Hb.call(this,n)},$7Ha:function(n){(n===2||n===1)&&this.get_$9JT().$29d();_c.$Ht.prototype.$7Ha.call(this,n)},$543:function(n){if(this.$At.$KU===1&&!this.$37.$1D.get_$5h()){$9a(this,"Generating reminder notification on sync aborted");this.get_$9JT().$29d()}_c.$Ht.prototype.$543.call(this,n)},$75D:function(){return new SyncState("RemindersSyncStateId","")}};_c.$oV=function(n,t){_c.$oV.initializeBase(this,[n]);this.$2ne=t};function $6J5(n){var t=new _g.$UL(n.get_$6o());var i=_a.$7.get_$2M().$2q(14);t.Body.EndTime=_a.$7.$Eb(i);t.Body.ReminderType=0;t.Body.MaxItems=_e.$9k.$2rD;n.$2ne&&(t.Body.ReminderGroupType=0);return t}_c.$oV.prototype={$2ne:!1,$7XB:function(n){var t=$6J5(this);var i=new _g.$rO(this.$28);n.$15f(t,i,this.$$d_$9K7,this.$$d_$9K8)}};_c.$18A=function(n,t){_c.$18A.initializeBase(this,[n,t])};_c.$18A.prototype={get_$65Q:function(){return 0},$76Q:function(n,t,i){i([new _c.$189(n,t,this.$Np)])},$91o:function(n){return!1},$91t:function(){return!0},$3al:function(){return"RemindersSyncStateId"}};_c.$1q=function(){};_c.$1q.$yj=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t]};_c.$1q.$4w=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_js.Trace.logInfo(_c.$1b.$D,n,i)};_c.$1q.$ij=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_js.Trace.logWarning(_c.$1b.$D,n,i)};_c.$1q.$DL=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_js.Trace.logError(_c.$1b.$D,n,i)};_c.$vC=function(n,t){_c.$vC.initializeBase(this,[2,0,!0,t]);this.$65V=n};_c.$vC.prototype={$65V:0,get_$1y:function(){return"TimeBasedSyncContextId"},$48Z:function(n){return n.$91u(this.$65V)}};_c.$1b=function(n,t,i,r){this.$$d_$97y=Function.createDelegate(this,this.$97y);this.$$d_$8ds=Function.createDelegate(this,this.$8ds);this.$$d_$8R2=Function.createDelegate(this,this.$8R2);this.$$d_$3ym=Function.createDelegate(this,this.$3ym);this.$4D5=288e5;this.$4ki=144e5;this.$5J1=6048e5;this.$39m=new Sys.EventHandlerList;this.$3Ya=new _c.$zX(_c.$1b.$65R,_c.$1b.$5J3);_c.$1b.resolveInheritance();this.dispose=this.$1M;_c.$1b.initializeBase(this);_a.$3.$M(n,"ExternalSyncDependencies");_a.$3.$M(i,"taskRunner");this.$37=n;this.$sh=-1;this.$5w=i;this.$1K=r;_h.$4g.$2l=t;_c.$1q.$4w("SyncSettings IsEnabled :"+_h.$4g.$2l);_e.$1W.add_$3ym(this.$$d_$3ym);n.get_$YC().add_$3gD(this.$$d_$8R2);n.$DP.add_$9G4(this.$$d_$8ds);n.$18s.$8pu(this);this.$39j=new Array(0);this.$4Bq=new _c.$17d(this,n.$S,n.get_$1Dr(),_a.$b.$8E,n.$DW);this.$1zb=new _c.$oU(this,this.get_$1i8());this.$1VO=new _e.$ge(n.$4N);_h.$1y.$44o(n.$Am);n.$1zY.$3v(this);$6IV(this)};function $6If(n,t){var i=this;return n.$5w.$oa(_c.$1b.$D,"CleanupAndReconcilation",function(){_h.$4g.$2l&&n.$5pP(function(){$2Ta(n,0,4)})},t)}function $21X(n,t,i){_a.$3.$17(t,"context");var r=n.$37.$DW.$3gQ(n.$37.get_$16C().Id);$4Ku(n,0,n.get_$39k().$7Li(t,n.get_$fL(),r,n.get_$1i8()),t,i)}function $6Ic(n,t){var i=n.$1VO.$7Ip(n.$7T);if(!i||!i.length){t();return}for(var e=0,c=this,o=function(t){_js.Trace.logInfo(_c.$1b.$D,"Removing {0} from ConfigCleanup list",_a.$9l.toString(t));n.$1VO.$5sx(t)},s=new _c.$LG(4,n.$37,o),f=i,h=f.length,u=0;u<h;++u){var r=f[u];var l=this;n.get_$eL()[r].$4EZ(s,n.$$d_$97y,function(u){if($8(u)||!u.length||$8(u[0])){_js.Trace.logWarning(_c.$1b.$D,"We can't get the CleanupModule base on SyncModuleType {0}",_a.$9l.toString(r));n.$1VO.$5sx(r)}else for(var o=u,s=o.length,f=0;f<s;++f){var h=o[f];_js.Trace.logInfo(_c.$1b.$D,"Enqueuing {0} for ConfigChangeCleanup",_a.$9l.toString(r));n.$1zb.$3WO(h)}++e===i.length&&t()})}}function $4Kx(n,t){switch(t){case 5:case 12:case 4:case 11:break;default:throw Error.invalidOperation("We don't support VerifyEmailModuleFactory for "+_a.$9l.toString(t));}}function $4Ks(n){if(n.$42z){_c.$1q.$4w("Quota cleanup already in progress");return}if(n.get_$fL()<=5){_c.$1q.$4w("Reached minimum module limit for cleanup");if(n.get_$hk().get_$2l()){var t=new _a.$T(1,"FatalQuotaError",_a.$7.get_$2M());n.get_$hk().$A7(t)}n.$37.$S.$8oV(_h.$kd,new _h.$kd);$3EJ(n)}else{_c.$1q.$4w("Start cleanup");n.$42z=!0;var i=this;$6IZ(n,n.get_$fL(),function(t){t.$63v(function(){_c.$1q.$4w("Quota Cleanup Succeeded, Module: {0}",t.get_$FZ());n.set_$fL(n.get_$fL()-1);$3EJ(n);if(n.get_$hk().get_$2l()){var i=new _a.$T(1,"QuotaExceededError",_a.$7.get_$2M());n.get_$hk().$A7(i)}n.$37.$DW.$5HH(_a.$9l.toString(n.get_$fL()),_a.$b.$8E,!0)},function(i){_c.$1q.$DL("Quota Cleanup Failed, Module: {0}, Exception:{1}",t.get_$FZ(),i.message);$3EJ(n)})})}}function $6Id(n,t){n.$37.$DP.get_$1d9()&&_c.$1q.$ij("Aborted syncing the module Id {0} due to error: {1} ",t.$2Ja,t.$Qs?t.$Qs.message:"");if(!n.$37.$DP.get_$12c()&&!n.$240){var i=t.$Qs;if(i)i.responseCode!=="ErrorTooManyContactsException"&&(n.$240=!0);else{_c.$1q.$ij("Can't cast error to ActionRecord for module {0}",t.$Oj);n.$240=!0}}if(n.$E7.get_$4vH()){n.$E7.set_$4vH(!1);n.$1zb.$3WO(n.$E7)}$21Y(n)}function $2Ta(n,t,i){if(n.get_$39n()){if(n.$E7&&!n.$E7.get_$G5()){_c.$1q.$ij("Module {0} is not active, lastHeartBeatTime = {1}. SyncManager continues to sync the next module.",n.$E7.get_$FZ(),n.$E7.get_$552());n.$E7.$1YL(Error.create(String.format("Aborted by sync manager due to inactive,lastHeartBeatTime={0}, IsWaitingForActionQueue={1},IsHighPriorityActionEnqueued={2}",n.$E7.get_$552(),n.$E7.get_$7dD(),n.$37.get_$YC().get_$5Ac())))}}else{var r=this;n.$39r=n.$5w.$21(_c.$1b.$D,"SyncNextModule",function(){n.$4C5=!0;_c.$1q.$4w("Start a new sync session");n.$kD=i;(1===n.$kD||2===n.$kD||4===n.$kD)&&_a.$5.$1V(_c.$1b.$D,$4Kv(n));$21Y(n)},t)}}function $21Y(n){if(n.$430){n.$E7=null;n.$4Bv=!0;$4Ks(n)}else{_c.$1q.$4w("Syncing next module");n.$E7=n.$1zb.$79R();if(!n.$E7){$4Kt(n,5,null);return}Array.add(n.$39j,n.$E7.get_$FZ());$6Ii(n)}}function $6Ii(n){var t=n.$E7.get_$FZ();if(n.$E7.get_$Oj()<=n.get_$fL()||n.$E7.$5D7()){var i=Math.floor(_a.$7.get_$2M().$55()/6e4);if(n.$3Ya.$7XG(i)){n.$3Ya.$9Et(i);var u=this;n.$5w.$3i(_c.$1b.$D,"SyncStartCurrentModule_"+t,function(){_js.Trace.logInfo(_c.$1b.$D,"{0}: Starting module {1}",_a.$7.get_$2M(),t);_a.$5.acsa(_a.$0.$XV,"SyncModule_"+t);n.$E7.$10()})}else{_c.$1q.$ij("Aborted module {0}, TrackingId {1} due to sync frequency throttling",t,n.$E7.get_$3B0());if(n.get_$hk().get_$2l()){var r=new _a.$T(1,"FrequencyThrottlingModuleAborted",_a.$7.get_$2M());n.get_$hk().$A7(r)}n.$E7.$3xc();$4Kt(n,6,null)}}else{_c.$1q.$ij("Aborted module {0}, TrackingId {1} because it is higher than the MaxSyncModuleType {2}",t,n.$E7.get_$3B0(),n.get_$fL());n.$E7.$3xc();$21Y(n)}}function $4Kt(n,t,i){_c.$1q.$4w("Sync session completed");$6Ih(n);$6Ib(n);(1===n.$kD||2===n.$kD||4===n.$kD)&&_a.$5.$1G(null,$4Kv(n));1!==n.$kD||t!==5||n.$240||n.get_$39k().$8zV();$6Ia(n,t,i)}function $6Ib(n){if(n.$1va&&(n.$kD===6||n.$kD===1)){_a.$5.$2Wn(n.$1va);_a.$m.$1Cc=n.get_$1GQ()?"ALT1":_a.$m.$1Cc;_a.$m.$3m1(2);n.$1va=null}}function $6Ih(n){n.$39r=null;n.$4C5=!1;Array.clear(n.$39j)}function $4Ku(n,t,i,r,u){var f=this;n.get_$eL()[i[t]].$4EZ(r,n.$$d_$97y,function(f){if(f)for(var o=f,s=o.length,e=0;e<s;++e){var h=o[e];n.$1zb.$3WO(h)}++t<i.length?$4Ku(n,t,i,r,u):u()})}function $4Kw(n,t){_a.$3.$17(t,"e");_a.$3.$17(t.$Oj,"e");_a.$3.$17(t.$N4,"e.ModuleType");_c.$1q.$yj("Module {0}, TrackingId {1}, Event {2}",t.$Oj,t.$5dO,_a.$F0.toString(t.$N4));var i=n.$39m.getHandler(_a.$9l.toString(t.$Oj).toLowerCase());if(i){_c.$1q.$4w("Invoke sync progress event handler for moduleType: {0}, eventType: {1}",_a.$9l.toString(t.$Oj),t.$N4);i(t)}}function $6Ia(n,t,i){_c.$1q.$yj("Receiving sync completed event");var r=_a.$PX.$76N(t,i);$4Kw(n,r)}function $3EJ(n){n.$430=!1;n.$42z=!1;if(n.$4Bv){_c.$1q.$4w("Resuming sync after quota cleanup");n.$4Bv=!1;$21Y(n)}}function $6IZ(n,t,i){if(t===15||t===16||t===17||t===18||t===19)throw Error.argumentOutOfRange("ItemsMinimum and ItemsFull do not have factories and hence should never be provided to this method");var r=n.get_$eL()[t];var f=this;var u=new _c.$LG(1,n.$37,function(n){});var e=this;r.$4EZ(u,n.$$d_$97y,function(n){i(n[0])})}function $6Ig(n,t){var i=this;return n.$5w.$oa(_c.$1b.$D,"SyncTimeBased",function(){_h.$4g.$2l&&$6IY(n,t,function(){$2Ta(n,0,2)})},t)}function $6IY(n,t,i){_c.$1q.$4w("Populate time based sync with period {0}",t);var r=this;$21X(n,new _c.$vC(t,n.$37),function(){i()})}function $6IW(n,t){_c.$1q.$4w("Populate periodic cleanup modules");var i=this,r=this;$21X(n,new _c.$LG(2,n.$37,function(n){}),function(){t()})}function $6IX(n,t){_c.$1q.$4w("Populate periodic reconcile modules");var i=this;$21X(n,new _c.$15N(n.$37),function(){t()})}function $6Ie(n){if(!_js.$8.$c(n.get_$29D())&&_a.$7.get_$2M().$55()>_a.$7.$4Y(n.get_$29D()).$9b(n.$5J1).$55()){_js.Trace.logInfo(_c.$1b.$D,"Reseting MaxSyncModule to its default value");n.set_$fL(_c.$1b.$1kA);n.set_$29D(null);if(n.get_$hk().get_$2l()){var t=new _a.$T(1,"MaxSyncModuleReset",_a.$7.get_$2M());n.get_$hk().$A7(t)}}}function $4Kv(n){return 1===n.$kD?"Core.Models.Sync.Full":3===n.$kD?"Core.Models.Sync.NotificationBased":2===n.$kD?"Core.Models.Sync.TimeBased":"Core.Models.Sync.Cleanup"}function $6IV(n){n.$37.$DP.get_$31o()||n.$37.$DP.set_$31o(n.get_$2cW()+144e5);n.$37.$DP.get_$31n()||n.$37.$DP.set_$31n(n.get_$2cW()+288e5)}_c.$1b.prototype={$37:null,$5w:null,$1K:null,$2g1:null,$E7:null,$1zb:null,$39r:null,$430:!1,$42z:!1,$4Bv:!1,$sh:0,$29C:null,$66I:null,$66H:null,$2KQ:null,$4Bt:null,$240:!1,$kD:0,$7T:null,$4Bq:null,$4C5:!1,$39j:null,$1VO:null,$1va:null,$JS:!1,get_$1HL:function(){return!!this.$E7&&this.$E7.get_$1HL()},get_$774:function(){return this.$E7.get_$FZ()},get_$39n:function(){return!!this.$39r},set_$39n:function(n){this.$39r=n?new _js.$Vw(null):null;return n},get_$1GQ:function(){return!this.get_$39k().get_$12c()},get_$1i8:function(){return this.$37.$pT.get_$22y()},get_$eL:function(){$8(this.$2g1)&&(this.$2g1=this.$73t());return this.$2g1},set_$eL:function(n){this.$2g1=n;return n},get_$97s:function(){return this.$37.$1zY},get_$57:function(){return this.$37.get_$57()},get_$7V1:function(){return this.$JS},get_$fL:function(){if(this.$sh===-1){var n=this.get_$1VN().$3k("MaxSyncModuleType");this.$sh=_js.$8.$c(n)?_c.$1b.$1kA:parseInt(n)}return this.$sh},set_$fL:function(n){_a.$3.$6v(n,0,_c.$1b.$1kA,"MaxSyncModuleType");this.$sh=n;this.get_$1VN().$Bp("MaxSyncModuleType",n.toString());_c.$1q.$4w("Set local storage maxSyncModuleType = {0}",n);return n},get_$29D:function(){_js.$8.$c(this.$29C)&&(this.$29C=this.get_$1VN().$3k("FirstQuotaExceededErrorTime"));return this.$29C},set_$29D:function(n){if(_js.$8.$c(n)){this.get_$1VN().$BB("FirstQuotaExceededErrorTime");this.$29C=n}else{_a.$7.$4Y(n);this.$29C=n;this.get_$1VN().$Bp("FirstQuotaExceededErrorTime",n);_c.$1q.$4w("Set local storage FirstQuotaExceededErrorTime = {0}",n)}return n},get_$39k:function(){this.$4Bt||(this.$4Bt=this.$76P());return this.$4Bt},get_$1Av:function(){return this.$7T},set_$1Av:function(n){this.$7T=n;return n},get_$8Qs:function(){return this.$37.$18s},get_$9C9:function(){return this.$37.$pT},get_$2cW:function(){return _a.$7.get_utcNow().$55()},get_$5f4:function(){$8(this.$2KQ)&&(this.$2KQ=this.$76R());return this.$2KQ},get_$YC:function(){return this.$37.get_$YC()},get_$hk:function(){return this.$37.$1Qo},get_$1VN:function(){return this.$37.$4N},$1aC:function(n,t){_a.$3.$17(n,"type");_a.$3.$17(t,"handler");this.$39m.addHandler(_a.$9l.toString(n).toLowerCase(),t)},$2S8:function(n,t){_a.$3.$17(n,"type");_a.$3.$17(t,"handler");this.$39m.removeHandler(_a.$9l.toString(n).toLowerCase(),t)},$10:function(){_js.Trace.logInfo(_c.$1b.$D,"Starting the sync manager");this.$7T=_a.$7.$eV(_a.$7.get_$2M());if(!_h.$4g.$2l){_js.Trace.logInfo(_c.$1b.$D,"Sync is disabled");return}this.$JS=!0;this.$37.$1zY.$3bS(1);this.$97G();this.$37.$1D.get_$5h()||this.$8uq();this.$4Bq.$97F()},$1zI:function(n){_a.$3.$M(n,"onSyncStopped");_c.$1q.$4w("Stopping");_h.$4g.$2l=!1;this.$Ar();if(this.get_$39n()){_c.$1q.$4w("Wait for sync complete");if(this.$E7)_c.$1q.$4w("The current sync module : {0}, StartTime {1}",this.$E7.get_$FZ(),this.$E7.get_$985());else{var t=new Sys.StringBuilder;t.appendLine("SyncSession is on while currentSyncModule is null.");t.appendLine(String.format("SyncTimerCallbackInvoked:{0}",this.$4C5));t.appendLine(String.format("SyncModuleLogForCurrentSyncSession:{0}",this.$39j));_c.$1q.$DL(t.toString())}var i=this;this.$1aC(20,function(t){t.$N4===5&&n()})}else n()},$NL:function(n,t,i){_a.$3.$M(t,"context");_a.$3.$M(i,"syncStatusCallback");this.get_$eL()[n].$NL(t,i)},$1Up:function(n,t,i){_a.$3.$M(t,"context");_a.$3.$M(i,"syncStatusCallback");this.get_$eL()[n].$1Up(t,i)},$7LA:function(n,t,i){$4Kx(this,n);var r=null;r=this.get_$eL()[n];r.$7LB(t,i)},$5su:function(n,t){_a.$3.$8z(_bc.$Ga.isInstanceOfType(t),"The context type should match the module.");var i=t;_a.$3.$M(i.FolderId,"Invalid call to IsSynced with no folder ID specified.");$4Kx(this,n);_js.Trace.logInfo(_c.$1b.$D,"Removing Folder {0} SyncState for module {1}",i.FolderId.Id,_a.$9l.toString(n));var r=null;r=this.get_$eL()[n];r.$5su(t)},$3ym:function(){_c.$1q.$4w("OnQuotaExceeded");_js.$8.$c(this.get_$29D())&&this.set_$29D(_a.$7.get_$2M().$8r());this.$430=!0;this.$E7&&this.$E7.get_$G5()||$4Ks(this)},$372:function(n,t){_a.$3.$M(n,"syncContext");if(!_h.$4g.$2l||n.get_$2hN())return!1;for(var i=0;i<this.get_$fL();i++)if(n.$48Z(this.get_$eL()[i])&&!_c.$ur.isInstanceOfType(this.get_$eL()[i])){var r=_c.$v1.isInstanceOfType(this.get_$eL()[i])||_c.$uv.isInstanceOfType(this.get_$eL()[i])||_c.$v0.isInstanceOfType(this.get_$eL()[i])||_c.$ut.isInstanceOfType(this.get_$eL()[i]);return r&&!t?!1:!0}return!1},$ur:function(n){_a.$3.$M(n,"syncContext");_c.$1q.$4w("Starting {0} sync",_a.$ME.toString(n.get_$120()));this.$9Bo(n)},$96V:function(){_c.$1q.$4w("Handling user refresh event");this.$ur(new _c.$uG(this.$37))},$96S:function(){this.$ur(new _c.$14I(this.$37))},$1MR:function(n){if(!_h.$4g.$2l){_js.Trace.logInfo(_c.$1b.$D,"Sync is disabled");return}this.$1va=this.$1va||_a.$5.$2Wo(_a.$0.$TS,"Sync");_a.$m.set_$2R8(_a.$PY.toString(n));_a.$m.set_$120(_a.$ME.toString(1));_c.$1q.$4w("Starting full sync {0}",_a.$PY.toString(n));this.$240=!1;var t=this;$6Ic(this,function(){$21X(t,new _c.$kr(t.$37,n),function(){t.$5pP(function(){$2Ta(t,0,1)})})})},$8uq:function(){_c.$1q.$4w("Schedule periodic sync, cleanup and reconcilation...");this.$66I=$6Ig(this,this.$4D5);this.$66H=$6If(this,this.$4ki)},$63z:function(n){this.$ur(new _c.$Qu(n,!0,this.$37))},$643:function(){this.$1va=_a.$5.$2Wo(_a.$0.$TS,"Sync");_a.$m.set_$120(_a.$ME.toString(6));this.$ur(new _c.$hg(this.$37))},$7CT:function(){if(!_h.$4g.$2l){_c.$1q.$4w("Enable sync manager");_h.$4g.$2l=!0;this.$Ar();this.$1MR(2)}},$Ar:function(){_js.Trace.logInfo(_c.$1b.$D,"Resetting sync state");$6Ie(this);this.$1zb.$1u()},$59:function(){_c.$1q.$yj("SyncManager is disposing");this.$4Bq.dispose();_e.$1W.remove_$3ym(this.$$d_$3ym);this.get_$YC().remove_$3gD(this.$$d_$8R2);this.$5w.$5G(this.$66I);this.$5w.$5G(this.$66H);this.$9Cj();this.$37.$18s.$9Cc(this);this.$2KQ=null},$73t:function(){var n=new Array(_c.$1b.$1kA+1);n[0]=new _c.$181(null,this.$37);n[1]=new _c.$18D(null,this.$37);n[2]=new _c.$17k(null,this.$37);n[3]=new _c.$18A(null,this.$37);n[4]=new _c.$uv(null,this.$37,this.$1K);n[5]=new _c.$v1(null,this.$37,this.$1K);n[6]=new _c.$17g(null,this.$37);n[7]=new _c.$186(null,this.$37);n[8]=new _c.$H4(null,this.$37,_a.NativeBridge.get_$L());n[9]=new _c.$17R(null,this.$37);n[10]=new _c.$Du(null,this.$37,this.$1K);n[11]=new _c.$ut(null,this.$37,this.$1K);n[12]=new _c.$v0(null,this.$37,this.$1K);n[13]=new _c.$17z(null,this.$37);n[14]=new _c.$ur(null,this.$37);return n},$76R:function(){var n=new Array(5);n[0]=new _c.$oT(this.get_$57(),this,this.$37);n[1]=new _c.$188(this,this.$37);n[2]=new _c.$dc(this,this.$37);n[3]=new _c.$17T(this,this.$37);n[4]=new _c.$17S(this,this.$37);return n},$76P:function(){return _c.$Ks.$I(this.$37.$DP,this.$37.$S)},$5pP:function(n){var t=this;$6IW(this,function(){$6IX(t,function(){n()})})},$97y:function(n){_a.$3.$M(n,"e");$4Kw(this,n);if(n.$N4===1||n.$N4===2||n.$N4===6||n.$N4===3)if(this.$E7){if(n.$2Ja!==this.$E7.get_$1y()){_c.$1q.$ij("Ignore event {0} from moduleId {1}  since it is different from currentSyncModuleId:{2}",_a.$F0.toString(n.$N4),n.$2Ja,this.$E7.get_$1y());return}}else{_c.$1q.$ij("Ignore event {0} from moduleId {1}  since CurrentSyncModule is null",_a.$F0.toString(n.$N4),n.$2Ja);return}if(n.$N4===6)$6Id(this,n);else if(n.$N4===3){var t=this.get_$eL()[n.$Oj];t&&t.$8sW();$21Y(this)}},$97G:function(){for(var i=this.get_$5f4(),u=i.length,t=0;t<u;++t){var r=i[t];var n=r;this.$37.$18s.$8pt(r.get_$1Jl(),n.$$d_$53q||(n.$$d_$53q=Function.createDelegate(n,n.$53q)))}},$9Cj:function(){if(!$8(this.$2KQ))for(var t=this.get_$5f4(),i=t.length,n=0;n<i;++n){var r=t[n];this.$37.$18s.$9Cb(r.get_$1Jl())}},$9Bo:function(n){if(!_h.$4g.$2l){_js.Trace.logInfo(_c.$1b.$D,"Sync is disabled");return}var t=this;$21X(this,n,function(){$2Ta(t,n.get_$78K()?500:0,n.$KU)})},$8R2:function(n,t){_c.$1q.$4w(Object.getType(n).getName()+"."+t+" changed");this.get_$YC().get_$C2()&&this.$E7&&this.$E7.$71R()},$8ds:function(n){n||this.get_$39k().$8tZ()}};_c.$iS=function(n,t,i,r){_c.$iS.initializeBase(this,[n,t,i,r])};function $6IM(n){if(n.$6U){var t=_a.$7.get_$2M();n.$6U.$BM.set_$3Ak(t.$55()-n.$6U.$1Ps);var i=String.format("{0}, TT:{1}(ms), TTBT={2}, C={3}, CNC={4}, CN={5}, M={6}, TS={7}, I={8}",_a.$7.$Eb(t),n.$6U.$BM.get_$3Ak(),n.$6U.$BM.get_$66s(),n.$6U.$BM.get_$2KT(),n.$6U.$BM.get_$2yr(),n.$6U.$BM.get_$2yq(),n.$6U.$BM.get_$1YC(),n.$6U.$BM.get_$2KV(),n.$6U.$BM.get_$5fH());n.$6U.$1VN.$Bp("LastSuccessfullEmailCleanup",i);_js.Trace.logInfo(_a.$0.$57,"Completed full email cleanup, time taken {0} ms",n.$6U.$BM.get_$3Ak());n.$6U.$97A()}}_c.$iS.prototype={$6U:null,get_$Oj:function(){return 11},get_$7bJ:function(){return!1},$730:function(){this.$6U=new _e.$yp(this.$At.$1DY,this.$B3.get_$95(),"ConversationSyncStateId","MessageSyncStateId",_g.$g.$1i,this.get_$hk(),_h.$1y.$11y,_h.$1y.$1ze,this.$37.$4N);return new _e.$BY(this.$6U)},$544:function(n){$6IM(this);_c.$oR.prototype.$544.call(this,n)},$8SM:function(){if(this.$At.$KU===4&&this.$At.$1DY===2){var n=this.$1Fn()+144e5;this.$37.$DP.set_$31o(n);$9a(this,String.format("Next email cleanup time {0} utc ms",n))}_c.$Ht.prototype.$8SM.call(this)}};_c.$MD=function(n,t,i,r){this.$$d_$7Jk=Function.createDelegate(this,this.$7Jk);this.$1i0=[];this.$2cI=_a.$5H.$$(Boolean).$8M();this.$1jM=[];this.$2dr={};_c.$MD.initializeBase(this,[n,t,i]);this.$1K=r};function $6IP(n){if($8(n.$1jM)||!n.$1jM.length){n.$d7();return}var t=new _c.$dY(n.get_$Oj(),n.$1jM,_h.$11.$501(n.$1K.get_$A0()),"EditableItems");t.add_$2A(n.$$d_$7Jk);t.add_$20(n.$$d_$6pS);OwaApplication.$1T.$y(t)}function $6IO(n){for(var i=Math.min(_h.$1y.$1HX,n.get_$1hg().length),r=new Array(i),t=0;t<i;t++){var u=n.get_$1hg()[t];var f=new _g.$QL(u);f.SyncState=$4Kp(n).$4nL[u.Id]||"";r[t]=f}return r}function $6IN(n,t){var i=t.ConversationId.Id;var r=$4Kp(n).$4kH;if($8(r[i]))throw Error.invalidOperation("Last modified time for conversation not available. This should never happen. Conversation Id = "+i);t.LastModifiedTime=r[i]}function $4Kp(n){return n.get_$H9()}_c.$MD.prototype={$1K:null,$3Ap:0,get_$4E0:function(){return this.get_$9Ji()},get_$1hg:function(){return this.get_$9Jj()},$76L:function(n){var t=$6IO(this);_c.$1q.$4w("Creating SyncConversationItems action for {0} items",t.length);var r=_h.$11.get_$1HU();var u=_h.$1y.$39i?"ItemPartNormalizedBody":"ItemPartUniqueBody";var f=this.$At.$37.$87.$7x("ModernMail");var i=0;f&&(i=1);var e=new _c.$17X(t,20,r,u,i);n(e)},$730:function(){return null},$7WV:function(){return new _e.$XP(this.$B3.get_$95(),this.get_$9Jh(),this.$1i0,this.$2cI,this.get_$1e())},$8nC:function(n){$9a(this,"Process current SyncConversationItems response");for(var s={},h=!1,f=0;f<this.get_$9JR().length;f++){var c=this.get_$9JR()[f];if(c.ResponseClass!=="Success"){h=!0;continue}var i=c.Conversation;s[i.ConversationId.Id]=!0;if(i.ConversationNodes){$6IN(this,i);Array.add(this.get_$9Jh(),i);for(var l=i.ConversationNodes,a=l.length,e=0;e<a;++e){for(var r=l[e],u=0;u<r.Items.length;u++){var t=r.Items[u];if(_g.$g.$1i.doesIdEqualName(t.ParentFolderId,"drafts")){var o=t.ItemId.Id;if($8(this.$2dr[o])){this.$2dr[o]=!0;var v=new _g.$1j(o);Array.add(this.$1jM,v)}}_js.Trace.logInfo(_c.$1b.$D,"Setting item IsDataSynced flag to true for conversation item parts");_e.$B6.$2P1(t,CustomSyncData.$1iL,1);var y=_e.$Ma.$4ow(t);Array.add(this.$1i0,t);this.$2cI.set_$48(t.ItemId.Id,!0);r.Items[u]=y}this.$3Ap+=r.Items.length}}this.set_$9Ji(this.get_$9Ji()+1)}h&&this.$9Jl(this.get_$1hg(),s);this.$9Jm(this.$1i0);_c.$Ht.prototype.$8nC.call(this,n)},$75D:function(){return new ConversationItemSyncState(this.get_$1hg(),null,null)},$753:function(){return new _c.$17a(this.get_$Oj())},$9DX:function(){var n=this.get_$Q7();n.set_$71d(this.get_$4E0());n.set_$7dW(this.$3Ap);_c.$1q.$4w(this.get_$FZ()+" module data point: Synced "+this.get_$4E0()+" conversations and "+this.$3Ap+" item parts")},$8sb:function(){this.$1i0=[];this.$2cI=_a.$5H.$$(Boolean).$8M();this.$1jM=[];this.$2dr={};_c.$Nl.prototype.$8sb.call(this)},$6xX:function(n){return n?_h.$1y.$39i?n.IsInlineToNormalBody:n.IsInlineToUniqueBody:!1},$8kD:function(){$6IP(this)},$7Jk:function(n){$12t(this,"SyncItems action completed event received for editable items (drafts)");for(var i=n.$As,r=0;r<i.length;r++){var t=i[r].Items;if(t&&t.length>0){_js.Trace.logInfo(_c.$1b.$D,"Setting item IsDataSynced flag to true for editable items");_e.$B6.$2P1(t[0],CustomSyncData.$1iL,2);Array.add(this.$1i0,t[0])}}this.$3Ap+=i.length;this.$d7()}};_c.$17b=function(n,t,i,r){_c.$17b.initializeBase(this,[n,[t],i,r])};_c.$17b.prototype={get_$Oj:function(){return 4},get_$7bJ:function(){return!0},$91W:function(n){return this.$At.$KU!==3&&!n},$6xi:function(n){return!0}};_c.$uw=function(n,t,i,r){_c.$uw.initializeBase(this,[n,t,i,r])};function $6IQ(n,t,i,r,u){if(i)if(r){for(var h=i,c=i,p=c.length,f=0;f<p;++f){var e=c[f];e.LastSuccessfulSyncTime=_a.$7.$Eb(_a.$7.get_$2M());e.SyncMinimum=_h.$1y.$11y;e.SyncMaximum=_h.$1y.$1B2}for(var l=r,w=l.length,o=0;o<w;++o){for(var a=l[o],v=!1,y=i,b=y.length,s=0;s<b;++s){var k=y[s];if(k.FolderId.Id===a.FolderId.Id){v=!0;break}}v||Array.add(h,a)}t.ModuleSpecificContext=h}else t.ModuleSpecificContext=i;else t.ModuleSpecificContext=r}_c.$uw.prototype={$6xi:function(n){return n.IncludesLastItemInRange},$76L:function(n){var t=new _c.$17W(this.get_$rK(),this.get_$H9(),_h.$1y.$1Mb,this.get_$7bJ(),_c.$hg.isInstanceOfType(this.$At));n(t)},$7WV:function(){return new _e.$QM(this.$B3.get_$95().get_$Hh(),this.get_$9JZ().get_$9IX(),this.get_$9JZ().get_$9IY())},$8nC:function(n){this.set_$9JZ(new _c.$dN(this.get_$9JR()));this.get_$9JZ().$2Mc();var r=this.get_$9JZ().get_$9IX().length;this.set_$9Jb(this.get_$9Jb()+this.get_$9JZ().get_$9IY().length);if(r>0){this.set_$9Ja(this.get_$9Ja()+r);for(var i=this.get_$9JZ().get_$9IZ(),t=0;t<i.length;t++)Array.contains(this.get_$9JY(),i[t])||Array.add(this.get_$9JY(),i[t])}_c.$Ht.prototype.$8nC.call(this,n)},$75D:function(){var n=new SyncState("ConversationSyncStateId",this.get_$9JZ().get_$kC());$6IQ(this,n,this.get_$9JZ().get_$9IW(),this.get_$H9()?this.get_$H9().ModuleSpecificContext:null,this.get_$rK());return n},$730:function(){return null}};_c.$17c=function(n){_c.$17c.initializeBase(this,[n])};_c.$17c.prototype={get_$5En:function(){return this.$W("is")},set_$5En:function(n){$1O(this,"is",n);return n},$4xg:function(n){n&&$1O(this,"fs",n.join())}};function CoreSyncComponent(){}CoreSyncComponent.prototype={$1QB:function(n,t,i){var r=this;n.$9V(_c.$9P).$9Iy(ISyncFolderSettingProcessor).$9Iz().$9J0(function(){return new _c.$9P(n.$5uT(_a.$OW),n.$5uT(_0365f.$M))});var u=this;n.$9V(_c.$us).$9Iy(ISyncController).$9J0(function(){return new _c.$us(n.$5uT(_0365f.$M))});var f=this;n.$9V(_c.$h4).$9Iy(INotificationHandlerProxyFactory).$9J0(function(){return new _c.$h4});var e=this;n.$9V(_c.$uz).$9Iy(ISyncManagerFactory).$9Iy(ISyncManagerSingleton).$9Iz().$9J0(function(){return new _c.$uz(n.$5uT(ISyncFolderSettingProcessor),n.$5uT(ISyncController),n.$5uT(_a.$OW),n.$5uT(_h.$OX),n.$5uT(_a.NativeBridge),n.$5uT(IAttachmentsCleanupManager),_a.$b.$8E,n.$5uT(_a.$o),n.$5uT(_js.$Cm),n.$5uT(_0365f.$M),n.$5uT(_a.$5X),n.$5uT(_a.$BK))})},$7Is:function(){return[]}};_c.$EH=function(n,t,i,r,u,f){this.$$d_$983=Function.createDelegate(this,this.$983);this.$$d_$7Ra=Function.createDelegate(this,this.$7Ra);_c.$EH.resolveInheritance();this.dispose=this.$1M;_c.$EH.initializeBase(this,[n,t,i,r,u]);this.$2Ag={};this.$2R6={};this.$59x=f;this.$5ey=this.$75F();this.get_$fp().$8pp(this.$$d_$7Ra);$6Hx(this)};function $6Hx(n){var t=n.$LO;for(var i in t){var r={key:i,value:t[i]};var u=n.$LO[r.key];$4Kf(n,u)}}function $4Kf(n,t){if($4Ke(n,t)){var i=t.get_$n();if(!$8(i)){_js.Trace.logInfo(_a.$0.$5v,"Granular notification is subscribed for folder id : {0}",i);n.$2Ag[i]=!0}}}function $4Ke(n,t){var r=t.get_$1Jl().toLowerCase();if(r===_c.$EH.$5vM){var i=t.$3l;return!$8(i)&&!$8(i.Filter)?i.Filter==="All":!0}else return r===_c.$EH.$4j0}_c.$EH.prototype={$2Ag:null,$2R6:null,$59x:!1,$5ey:null,get_$59w:function(){return this.$59x},get_$fp:function(){return this.$5ey},$rc:function(n){_a.$3.$M(n,"notification");_js.Trace.logInfo(_a.$0.$5v,"Handling notification: {0}, ClientGenerated: {1}",n.id,n.clientGenerated);if(!n.clientGenerated){var t=this.$LO[n.id];if(t){var i=this.$2R6[t.get_$1Jl().toLowerCase()];if(!$8(i)){var r=this;i(n,this.$2Ag,function(n){_a.$bJ.prototype.$rc.call(r,n)});return}}}_a.$bJ.prototype.$rc.call(this,n)},$43m:function(n){_js.Trace.logInfo(_a.$0.$5v,"[NotificationHandlerProxy::RegisterSubscription] Adding subscription id : {0}",n.get_$Qc());$4Kf(this,n);_a.$bJ.prototype.$43m.call(this,n)},$7Ra:function(n){_a.$3.$M(n,"notification");_a.$3.$kI(n.clientGenerated,!0,"notification.ClientGenerated");_a.$bJ.prototype.$rc.call(this,n)},$8pt:function(n,t){_a.$3.$1C(n,"notificationType");_a.$3.$M(t,"callback");_js.Trace.logInfo(_a.$0.$5v,"Registering sync notification handler for notification type {0}",n);this.$2R6[n.toLowerCase()]=t},$9Cb:function(n){_a.$3.$1C(n,"notificationType");_js.Trace.logInfo(_a.$0.$5v,"Unregistering sync notification handler for notification type {0}",n);$8(this.$2R6[n.toLowerCase()])||delete this.$2R6[n.toLowerCase()]},$8pu:function(n){_a.$3.$17(n,"syncManager");_js.Trace.logInfo(_a.$0.$5v,"Registering sync progress event handlers for all modules");for(var t=0;t<20;t++)n.$1aC(t,this.$$d_$983)},$9Cc:function(n){_a.$3.$17(n,"syncManager");_js.Trace.logInfo(_a.$0.$5v,"Unregistering sync progress event handlers for all modules");for(var t=0;t<20;t++)n.$2S8(t,this.$$d_$983)},$1wb:function(n){var i=this.$LO[n];if(i&&$4Ke(this,i)){var t=i.get_$n();if(!$8(t)&&!$8(this.$2Ag[t])){_js.Trace.logInfo(_a.$0.$5v,"Removing granular notification entry for folder id : {0}",t);delete this.$2Ag[t]}}_a.$bJ.prototype.$1wb.call(this,n)},$59:function(){this.get_$fp().$9Ca();_a.$bJ.prototype.$59.call(this)},$75F:function(){return new _c.$Rc(50)},$983:function(n){_a.$3.$17(n,"e");this.get_$fp().$8ne(n)}};_c.$h4=function(){};_c.$h4.$7Ym=function(n){var t=!1;var i="emailProxy";if(n&&n.$Lg(i)){var r=n.get_$48(i);t="true"===r}return t};_c.$h4.prototype={$3g:null,$I:function(n,t,i,r){this.$3g||(this.$3g=new _c.$EH(n,t,i.get_$5ev(),i.get_$4BL(),i.get_$357(),_c.$h4.$7Ym(r)));return this.$3g}};_c.$15N=function(n){_c.$15N.initializeBase(this,[7,0,!0,n])};_c.$15N.prototype={get_$1y:function(){return"ReconcileSyncContextId"},$48Z:function(n){return n.$91r()}};_c.$uz=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$DW=n;this.$1zY=t;this.$XH=i;this.$6H=r;this.$27=u;this.$4gm=f;this.$Jq=e;this.$1D=o;this.$5w=s;this.$23I=h;this.$87=c;this.$1K=l};_c.$uz.prototype={$DW:null,$1zY:null,$XH:null,$6H:null,$27:null,$4gm:null,$Jq:null,$1D:null,$5w:null,$23I:null,$87:null,$1K:null,$3x:null,$I:function(n,t,i,r,u,f){if(this.$3x){_js.Trace.logWarning(_a.$0.$Bq,"Sync manager create called, but a sync manager already exists");this.$3x.dispose()}var e=new ExternalSyncDependencies(n,this.$XH,this.$6H,this.$DW,this.$27,this.$4gm,this.$Jq,t,this.$1D,i,r,this.$5w,this.$23I,this.$1zY,f,this.$87);this.$3x=new _c.$1b(e,u,this.$5w,this.$1K);OwaApplication.set_$4s7(this.$3x);return this.$3x},$ed:function(){return this.$3x}};_c.$8n.registerClass("_c.$8n",null,_h.$19m);_c.$Fn.registerClass("_c.$Fn",_c.$8n);_c.$vQ.registerClass("_c.$vQ",_c.$8n);_c.$1Cd.registerClass("_c.$1Cd",null,_a.$1BL);_c.$uG.registerClass("_c.$uG",_c.$1Cd);_c.$1D8.registerClass("_c.$1D8",_c.$1Cd);_c.$hg.registerClass("_c.$hg",_c.$1Cd);_c.$us.registerClass("_c.$us",null,ISyncController);_c.$v2.registerClass("_c.$v2");_c.$1D7.registerClass("_c.$1D7",_c.$v2);_c.$iT.registerClass("_c.$iT",_c.$1D7);_c.$Rc.registerClass("_c.$Rc",null,_a.$1BK);_c.$PW.registerClass("_c.$PW",null,_c.$19I);_c.$17T.registerClass("_c.$17T",_c.$PW);_c.$17d.registerClass("_c.$17d",_js.$yd,_a.$1BC,Sys.IDisposable);_c.$wo.registerClass("_c.$wo",_c.$1Cd);_c.$LG.registerClass("_c.$LG",_c.$1Cd);_c.$14I.registerClass("_c.$14I",_c.$1Cd);_c.$zM.registerClass("_c.$zM",_a.$T);_c.$zM.prototype.$J7=_a.$T.prototype.$J7;_c.$zX.registerClass("_c.$zX");_c.$kr.registerClass("_c.$kr",_c.$1Cd);_c.$Qu.registerClass("_c.$Qu",_c.$1D8);_c.$15V.registerClass("_c.$15V",_c.$1Cd);_c.$1C.registerClass("_c.$1C",null,_c.$gP);_c.$dH.registerClass("_c.$dH",_c.$1C);_c.$ur.registerClass("_c.$ur",_c.$v2);_c.$17P.registerClass("_c.$17P",_c.$p4.$$(_g.$Mq));_c.$17Q.registerClass("_c.$17Q",_c.$Ht.$$(_c.$17P,_g.$Mq));_c.$17R.registerClass("_c.$17R",_c.$v2);_c.$17S.registerClass("_c.$17S",_c.$PW);_c.$3r.registerClass("_c.$3r",_a.$T);_c.$3r.prototype.$J7=_a.$T.prototype.$J7;_c.$17U.registerClass("_c.$17U",_c.$3r);_c.$17U.prototype.$J7=_a.$T.prototype.$J7;_c.$17X.registerClass("_c.$17X",_h.$EA,_a.$m3,_a.$le);_c.$MD.registerClass("_c.$MD",_c.$Nl.$$(_c.$17X,Array,_g.$XR));_c.$17Y.registerClass("_c.$17Y",_c.$MD);_c.$17Z.registerClass("_c.$17Z",_c.$MD);_c.$17a.registerClass("_c.$17a",_c.$3r);_c.$17a.prototype.$J7=_a.$T.prototype.$J7;_c.$uu.registerClass("_c.$uu",_c.$1C);ExternalSyncDependencies.registerClass("ExternalSyncDependencies");_c.$17e.registerClass("_c.$17e",_c.$p4.$$(_g.$Mr));_c.$17f.registerClass("_c.$17f",_c.$Ht.$$(_c.$17e,_g.$Mr));_c.$17g.registerClass("_c.$17g",_c.$v2);_c.$9P.registerClass("_c.$9P",null,ISyncFolderSettingProcessor);_c.$oT.registerClass("_c.$oT",_c.$PW);_c.$17p.registerClass("_c.$17p",_c.$oQ.$$(_g.$dU,_g.$ib));_c.$Vt.registerClass("_c.$Vt",_c.$1D7);_c.$v0.registerClass("_c.$v0",_c.$Vt);_c.$dY.registerClass("_c.$dY",_h.$kx,_a.$m3,_a.$le);_c.$Hs.registerClass("_c.$Hs",_c.$Nl.$$(_c.$dY,Array,_g.$7q));_c.$17r.registerClass("_c.$17r",_c.$Hs);_c.$17s.registerClass("_c.$17s",_c.$Hs);_c.$Vs.registerClass("_c.$Vs",_c.$oR.$$(_c.$17p,_g.$ib,_g.$7q));_c.$17q.registerClass("_c.$17q",_c.$Vs);_c.$17t.registerClass("_c.$17t",_c.$3r);_c.$17t.prototype.$J7=_a.$T.prototype.$J7;_c.$17u.registerClass("_c.$17u",_c.$Vs);_c.$v1.registerClass("_c.$v1",_c.$Vt);_c.$17v.registerClass("_c.$17v",_c.$oS.$$(_g.$7q));_c.$Ks.registerClass("_c.$Ks",null,_c.$19H);_c.$17x.registerClass("_c.$17x",_c.$p4.$$(_g.$Oy));_c.$17y.registerClass("_c.$17y",_c.$Ht.$$(_c.$17x,_g.$Oy));_c.$17z.registerClass("_c.$17z",_c.$v2);_c.$187.registerClass("_c.$187",_c.$3r);_c.$187.prototype.$J7=_a.$T.prototype.$J7;_c.$oU.registerClass("_c.$oU");_c.$188.registerClass("_c.$188",_c.$PW);_c.$dc.registerClass("_c.$dc",_c.$PW);_c.$v3.registerClass("_c.$v3",_a.$T);_c.$v3.prototype.$J7=_a.$T.prototype.$J7;_c.$18B.registerClass("_c.$18B",_c.$p4.$$(_g.$Zj));_c.$18C.registerClass("_c.$18C",_c.$Ht.$$(_c.$18B,_g.$Zj));_c.$18D.registerClass("_c.$18D",_c.$v2);_c.$ut.registerClass("_c.$ut",_c.$iT);_c.$uv.registerClass("_c.$uv",_c.$iT);_c.$17k.registerClass("_c.$17k",_c.$v2);_c.$180.registerClass("_c.$180",_c.$p4.$$(_g.$JU));_c.$Kt.registerClass("_c.$Kt",_c.$Ht.$$(_c.$180,_g.$JU));_c.$181.registerClass("_c.$181",_c.$v2);_c.$17N.registerClass("_c.$17N",_c.$p4.$$(_g.$dJ));_c.$17W.registerClass("_c.$17W",_c.$oQ.$$(_g.$dL,_g.$iU));_c.$dN.registerClass("_c.$dN",_c.$oS.$$(_g.$TI));_c.$9F.registerClass("_c.$9F",_c.$Ht.$$(_c.$17N,_g.$dJ));_c.$Du.registerClass("_c.$Du",_c.$v2);_c.$17h.registerClass("_c.$17h",_c.$oQ.$$(_g.$dQ,_g.$iW));_c.$17j.registerClass("_c.$17j",_c.$Ht.$$(_c.$17h,_g.$iW));_c.$17m.registerClass("_c.$17m");_c.$182.registerClass("_c.$182",_c.$oQ.$$(_g.$da,_g.$ic));_c.$184.registerClass("_c.$184",_c.$p4.$$(Array));_c.$185.registerClass("_c.$185",_c.$Ht.$$(_c.$184,Array));_c.$186.registerClass("_c.$186",_c.$v2);_c.$Ij.registerClass("_c.$Ij",_c.$Ht.$$(_c.$182,_g.$ic));_c.$H4.registerClass("_c.$H4",_c.$v2);_c.$oV.registerClass("_c.$oV",_c.$oQ.$$(_g.$UM,_g.$Zd));_c.$189.registerClass("_c.$189",_c.$Ht.$$(_c.$oV,_g.$Zd));_c.$18A.registerClass("_c.$18A",_c.$v2);_c.$1q.registerClass("_c.$1q");_c.$vC.registerClass("_c.$vC",_c.$1Cd);_c.$1b.registerClass("_c.$1b",_js.$yd,_a.$1BB,Sys.IDisposable);_c.$uw.registerClass("_c.$uw",_c.$oR.$$(_c.$17W,_g.$iU,_g.$TI));_c.$iS.registerClass("_c.$iS",_c.$uw);_c.$17b.registerClass("_c.$17b",_c.$uw);_c.$17c.registerClass("_c.$17c",_c.$3r);_c.$17c.prototype.$J7=_a.$T.prototype.$J7;CoreSyncComponent.registerClass("CoreSyncComponent",null,_a.$1C3);_c.$EH.registerClass("_c.$EH",_a.$bJ,_a.$aA,Sys.IDisposable,_a.$1Ay);_c.$h4.registerClass("_c.$h4",null,INotificationHandlerProxyFactory);_c.$15N.registerClass("_c.$15N",_c.$1Cd);_c.$uz.registerClass("_c.$uz",null,ISyncManagerFactory,ISyncManagerSingleton);_c.$8n.$IR=_a.$0.$1zZ;_c.$9P.$3C9=new Sys.EventHandlerList;_c.$9P.$IR=_a.$0.$1zZ;_c.$Hs.$3Vg=null;_c.$Hs.$3wV=null;_c.$3r.$2xZ="m";_c.$3r.$3gN="fts";_c.$3r.$4C6="st";_c.$3r.$4C1="ss";_c.$3r.$4C3="sse";_c.$3r.$4Bp="se";_c.$3r.$4FB="u";_c.$3r.$3U7="d";_c.$3r.$4DP="syt";_c.$3r.$4By="sid";_c.$3r.$3Ue="dic";_c.$3r.$43O="ric";_c.$3r.$3Jx="aqcar";_c.$9F.$6Bj=-7;_c.$9F.$iX=null;_c.$Du.$1gY=null;_c.$H4.$2ZH=[];_c.$1b.$1kA=14;_c.$1b.$D=_a.$0.$Bq;_c.$1b.$65R=10;_c.$1b.$5J3=500;_c.$EH.$5vM="RowNotification".toLowerCase();_c.$EH.$4j0="CalendarItemNotification".toLowerCase()