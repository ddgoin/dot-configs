Type.registerNamespace("OSF");OSF.AppSpecificSetup=function(){};OSF.AppSpecificSetup._setupFacade=function(n,t,i){n.$9ki(i);t.getLocalizedCSSFilePath=OSF.AppSpecificSetup.$7v2;t.getLocalizedImageFilePath=OSF.AppSpecificSetup.$7v4};OSF.AppSpecificSetup.$7v2=function(n){var t=n==="MOEErrorUx.css";var i=_g.$V.get_$I().get_$31().get_$W5()?"moeerroruxrtl.css":n;return t?_y.$v.$v.$7se(i.toLowerCase()):""};OSF.AppSpecificSetup.$7v4=function(n){var t=n==="Progress.gif"||n==="agavedefaulticon96x96.png"||n==="moe_status_icons.png";return t?_y.$v.$v.$wY(n.toLowerCase()):""};Type.registerNamespace("_d");_d.$1Fc=function(){};_d.$1Fc.registerInterface("_d.$1Fc");_d.$z5=function(){};_d.$z5.prototype={thirdParty:1,owaUrlParameters:2,owaContext:3,unitTest:4};_d.$z5.registerEnum("_d.$z5",!1);_d.$16v=function(){};_d.$16v.registerInterface("_d.$16v");var ISharingCalendarViewModelFactory=function(){};ISharingCalendarViewModelFactory.registerInterface("ISharingCalendarViewModelFactory");var ICalendarSharingPermissionsViewModelFactory=function(){};ICalendarSharingPermissionsViewModelFactory.registerInterface("ICalendarSharingPermissionsViewModelFactory");var ICalendarPickerModernGroupsViewModel=function(){};ICalendarPickerModernGroupsViewModel.registerInterface("ICalendarPickerModernGroupsViewModel");var ICalendarPickerModernGroupsProvider=function(){};ICalendarPickerModernGroupsProvider.registerInterface("ICalendarPickerModernGroupsProvider");_d.$wQ=function(){};_d.$wQ.registerInterface("_d.$wQ");var ICalendarEventSearchViewModel=function(){};ICalendarEventSearchViewModel.registerInterface("ICalendarEventSearchViewModel");var ICalendarEventSearchViewModelFactory=function(){};ICalendarEventSearchViewModelFactory.registerInterface("ICalendarEventSearchViewModelFactory");var ICalendarSurfaceTimelineViewModel=function(){};ICalendarSurfaceTimelineViewModel.registerInterface("ICalendarSurfaceTimelineViewModel");_d.$1FR=function(){};_d.$1FR.registerInterface("_d.$1FR");_d.$12n=function(){};_d.$12n.prototype={Zero:0,ThirtyMinutes:18e5,OneHour:36e5,NinetyMinutes:54e5,TwoHours:72e5,AllDay:-1,Custom:-2};_d.$12n.registerEnum("_d.$12n",!1);_d.$u3=function(){};_d.$u3.prototype={singleDay:0,week:1};_d.$u3.registerEnum("_d.$u3",!1);_d.$4P=function(){};_d.$4P.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.$4P.registerEnum("_d.$4P",!1);_d.$1FP=function(){};_d.$1FP.registerInterface("_d.$1FP");_d.$1FQ=function(){};_d.$1FQ.registerInterface("_d.$1FQ");_d.$xI=function(){};_d.$xI.registerInterface("_d.$xI");var IEmailRemindersViewModel=function(){};IEmailRemindersViewModel.registerInterface("IEmailRemindersViewModel");var IEmailRemindersViewModelFactory=function(){};IEmailRemindersViewModelFactory.registerInterface("IEmailRemindersViewModelFactory");_d.$To=function(){};_d.$To.registerInterface("_d.$To");_d.$1FX=function(){};_d.$1FX.registerInterface("_d.$1FX");_d.$1FW=function(){};_d.$1FW.registerInterface("_d.$1FW");_d.$1FU=function(){};_d.$1FU.registerInterface("_d.$1FU");_d.$1FV=function(){};_d.$1FV.registerInterface("_d.$1FV");_d.$1FZ=function(){};_d.$1FZ.registerInterface("_d.$1FZ");_d.$n8=function(){};_d.$n8.prototype={required:0,optional:1,resource:2,organizer:3};_d.$n8.registerEnum("_d.$n8",!1);_d.$1FY=function(){};_d.$1FY.registerInterface("_d.$1FY");_d.$1Fo=function(){};_d.$1Fo.registerInterface("_d.$1Fo");_d.$1G2=function(){};_d.$1G2.registerInterface("_d.$1G2");_d.$13c=function(){};_d.$13c.prototype={};_d.$13c.registerEnum("_d.$13c",!1);_d.$wR=function(){};_d.$wR.registerInterface("_d.$wR");_d.$1G4=function(){};_d.$1G4.registerInterface("_d.$1G4");_d.$180=function(){};_d.$180.registerInterface("_d.$180");_d.$mK=function(){};_d.$mK.prototype={day:1,month:2,week:3};_d.$mK.registerEnum("_d.$mK",!1);_d.$1G3=function(){};_d.$1G3.registerInterface("_d.$1G3");_d.$1G1=function(){};_d.$1G1.registerInterface("_d.$1G1");_d.$rI=function(n){this.$4Vk=n};_d.$1AK=function(n,t){this.$2AK=n;this.$2tw=t};_d.$18J=function(){};_d.$18J.registerInterface("_d.$18J");_d.$vG=function(){};_d.$vG.prototype={firstLast:0,lastFirst:1};_d.$vG.registerEnum("_d.$vG",!1);_d.$1Hh=function(){};_d.$1Hh.registerInterface("_d.$1Hh");_d.$1Hi=function(){};_d.$1Hi.registerInterface("_d.$1Hi");var IModernGroupCardViewModelFactory=function(){};IModernGroupCardViewModelFactory.registerInterface("IModernGroupCardViewModelFactory");var IModernGroupMembershipPivotViewModel=function(){};IModernGroupMembershipPivotViewModel.registerInterface("IModernGroupMembershipPivotViewModel");_d.$1Hk=function(){};_d.$1Hk.registerInterface("_d.$1Hk");_d.$1Hj=function(){};_d.$1Hj.registerInterface("_d.$1Hj");_d.$1HU=function(){};_d.$1HU.registerInterface("_d.$1HU");var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.$pr=function(){};_d.$pr.registerInterface("_d.$pr");function CoreViewModelsComponent(){}CoreViewModelsComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_d.$qG).$A5E(IMailComposeDiscardManager).$A5F().$A5G(function(){return new _d.$qG});n.$Ad(_d.$5j.$52x).$A5E(IPeopleSuggestionLoader).$A5F();n.$Ad(_d.$5j.$52x).$A5E(IPeopleSuggestionLoader).$A5F();var u=this;n.$Ad(_d.$5Z).$A5F().$A5G(function(){return new _d.$5Z(n.$6OW(_d.$s1),n.$6OW(_0365f.$L),n.$6OW(_a.NativeBridge),n.$6OW(_h.$Na),n.$6OW(_a.$p),n.$6OW(_g.$V))});if(i.get_$9p()!=="Mouse"&&!n.$6OW(_a.NativeBridge).$3E.get_$7w().get_$1gV()){var f=this;n.$Ad(_d.$5U).$A5E(ICalendarMiniatureNextAppointmentManager).$A5G(function(){return new _d.$5U(i.get_$9p(),n.$6OW(_a.$XU),n.$6OW(_js.$CQ),n.$6OW(_cc.$1Q),n.$6OW(_cc.$R1).get_$IS())}).$A5F()}var e=this;n.$Ad(_d.$D0).$A5E(IPopOutHelper).$A5F().$A5G(function(){return new _d.$D0(n.$6OW(_y.$xF))});var o=this;n.$Ad(_d.$9Z).$A5E(IPopOutViewModel).$A5F().$A5G(function(){return new _d.$9Z(n.$6OW(_y.$M),n.$6OW(IPopOutHelper),n.$6OW(_a.$X9),n.$6OW(_a.$3O))});var s=this;n.$Ad(_d.$qK).$A5F().$A5G(function(){return new _d.$qK(n.$6OW(IInferenceTracker),n.$6OW(_g.$V),n.$6OW(IMailComposeContextFactory))});var h=this,c=this;n.$Ad(_d.$kB).$A5G(function(){return new _d.$kB(n.$6OW(IInferenceTracker),n.$6OW(_a.$43),n.$6OW(_y.$M),n.$6OW(IMailComposeContextFactory),n.$6OW(_y.$Ty),n.$6OW(_g.$Si),n.$6OW(_a.$p),n.$A3X(_d.$xI),n.$6OW(_a.$3O).$3u("ProposeNewTime"))}).$A5H(function(t){t.$592=n.$6OW(_d.$Zu)});var l=this;n.$Ad(_d.$Fu).$A5F().$A5E(ICalendarPickerViewModel).$A5G(function(){var t=n.$6OW(_a.$3O);return new _d.$Fu(n.$6OW(_d.$nb),n.$6OW(_cc.$IQ),n.$6OW(_y.$M),n.$6OW(_cc.$1Q),n.$6OW(_d.$sb),t.$3u("ModernGroups")&&i.get_$VR()!=="SharedHoverCard"?n.$A3Y(ICalendarPickerModernGroupsProvider):null,t.$3u("ModernGroups")&&i.get_$VR()!=="SharedHoverCard"?n.$A3Y(ICalendarPickerModernGroupsViewModel):null)});var a=this;n.$Ad(_d.$sb).$A5F().$A5G(function(){return new _d.$sb(n.$6OW(_d.$DJ),n.$6OW(_a.$43),n.$6OW(_0365f.$L),n.$6OW(_cc.$1Q))});var v=this;n.$Ad(_d.$a1).$A5F().$A5G(function(){return new _d.$a1(n.$6OW(_cc.$R1),n.$A3W(ICalendarSharingPermissionsViewModelFactory),n.$A3W(ISharingCalendarViewModelFactory),n.$6OW(_cc.$1Q),n.$6OW(_y.$QF),n.$6OW(_a.$3O),n.$6OW(_y.$M),n.$6OW(_g.$44),n.$6OW(_a.$p))});var y=this;n.$Ad(_d.$nV).$A5F().$A5G(function(){return new _d.$nV(n.$6OW(_cc.$R1),n.$6OW(_d.$a1),n.$6OW(_cc.$1Q),n.$6OW(_y.$M))});var p=this;n.$Ad(_d.$nb).$A5F().$A5G(function(){return new _d.$nb(n.$6OW(_d.$nV),n.$6OW(_d.$a1),n.$6OW(_cc.$1Q))});var w=this;n.$Ad(_c.$nk).$A5F().$A5G(function(){var t=n.$6OW(_h.$Na);return t.get_$Lx()||OwaApplication.$13D?null:new _c.$nk(n.$6OW(_cc.$1Q),n.$6OW(_0365f.$L),n.$6OW(_js.$CQ))});var b=this;n.$Ad(_d.$nX).$A5F().$A5G(function(){return new _d.$nX(n.$6OW(_a.$43),n.$6OW(_y.$M),n.$6OW(IMailComposeContextFactory),n.$A3X(_d.$Zu),n.$6OW(_cc.$My))});var k=this;n.$Ad(_d.$iu).$A5F().$A5G(function(){return new _d.$iu(n.$6OW(_d.$Eq),n.$6OW(_y.$M),n.$6OW(_g.$Fa),n.$6OW(_d.$Zo),n.$6OW(_cc.$1Q),n.$A3Y(IAttachmentWellViewModelFactory),n.$6OW(_a.$3O),n.$A3Y(IEmailRemindersViewModelFactory))});var d=this;n.$Ad(_d.$hz).$A5F().$A5G(function(){return new _d.$hz(n.$6OW(_d.$Eq),n.$6OW(_y.$M),n.$6OW(_g.$Fa),n.$6OW(_cc.$My),n.$6OW(_d.$iu))});var g=this;n.$Ad(_d.$nN).$A5F().$A5G(function(){return new _d.$nN(n.$6OW(_d.$C4),n.$6OW(_d.$QP),n.$6OW(_d.$hz),n.$6OW(_d.$7K))});var nt=this;n.$Ad(_d.$Ht).$A5F().$A5G(function(){return new _d.$Ht(n.$6OW(_cc.$R1),n.$6OW(_d.$Fu),n.$6OW(_cc.$My),n.$6OW(_cc.$1Q),i.get_$9p()==="Mouse"?n.$6OW(_d.$Zo):null,n.$6OW(_y.$M),n.$6OW(_g.$44),n.$A3Y(ICalendarSurfaceTimelineViewModel),n.$6OW(_0365f.$L))});var tt=this;n.$Ad(_d.$Og).$A5F().$A5G(function(){return new _d.$Og(n.$6OW(_d.$3e),n.$A3W(ICalendarEventSearchViewModelFactory),n.$6OW(_0365f.$L))});var it=this;n.$Ad(_d.$7K).$A5F().$A5G(function(){return new _d.$7K});var rt=this;n.$Ad(_d.$Im).$A5E(IExtensibilityStatistics).$A5F().$A5G(function(){return new _d.$Im});var ut=this;n.$Ad(_d.$oQ).$A5F().$A5G(function(){return new _d.$oQ(n.$6OW(_g.$Ti),n.$6OW(IExtensibilityStatistics),n.$6OW(_a.$3O))});var ft=this;n.$Ad(_d.$oT).$A5F().$A5G(function(){return new _d.$oT});var et=this,ot=this;n.$Ad(_d.$oS).$A5F().$A5G(function(){var t=n.$6OW(_g.$V);return new _d.$oS(t.get_$Ta(),t.get_$31().get_$FS(),t.get_$31().get_$Aj(),t.get_$1I().get_$DM(),n.$6OW(_y.$M),n.$6OW(IItemReadingPaneContextFactory),n.$6OW(_y.$HN),n.$6OW(IMailComposeContextFactory),n.$6OW(_a.$p),n.$6OW(_a.NativeBridge).$9Q,n.$6OW(_a.$43),n.$6OW(_a.$Dl))}).$A5H(function(t){t.$Kl=n.$6OW(_d.$JU);t.$I5=n.$6OW(_d.$Xl);t.$Eu=n.$6OW(_d.$C4)});var st=this;n.$Ad(_d.$TG).$A5E(IExtensibilityViewModelFactory).$A5F().$A5G(function(){var t=n.$6OW(_g.$V);return new _d.$TG(n.$6OW(_a.$25),n.$6OW(_d.$oT),t.get_$31().get_$7Z(),i.get_$9SV(),n.$6OW(_a.NativeBridge).$9Q,n.$6OW(_a.$p),n.$6OW(_y.$M),n.$6OW(_0365f.$L),n.$6OW(_d.$oQ),n.$6OW(_d.$oS),n.$6OW(IExtensibilityStatistics))});var ht=this;n.$Ad(_d.$dp).$A5F().$A5G(function(){return new _d.$dp(n.$6OW(_d.$kB),n.$6OW(_d.$Eq),n.$6OW(_y.$4K),n.$6OW(_y.$M),n.$6OW(_a.$43),n.$6OW(_g.$Ti),n.$6OW(_d.$C4),n.$6OW(_d.$o2),n.$6OW(_g.$OE),n.$6OW(_a.$p))});var ct=this;n.$Ad(_d.$o2).$A5F().$A5G(function(){return new _d.$o2(n.$6OW(_cc.$1Q),n.$6OW(_a.$43),n.$6OW(_y.$M))});var lt=this;n.$Ad(_d.$mw).$A5F().$A5G(function(){return new _d.$mw(n.$6OW(_y.$M),n.$6OW(_y.$4K),n.$6OW(_a.$43),n.$6OW(IMailComposeContextFactory),n.$6OW(_a.$p))});if(i.get_$VR()!=="SharedHoverCard"){var at=this;n.$Ad(_d.$xc).$A5E(IItemPartPartnerViewModelFactory).$A5F().$A5G(function(){return new _d.$xc(n.$6OW(_d.$dp),n.$6OW(_d.$Zy),n.$6OW(_d.$mw),n.$6OW(_a.$43),n.$6OW(_d.$K5),n.$A3Y(IModernGroupsProvider),n.$6OW(_a.$3O),n.$6OW(_a.NativeBridge))})}var vt=this;n.$Ad(IMailComposeContextFactory).$A5F().$A5G(function(){return new _d.$193(n.$6OW(_y.$k2),n.$6OW(_a.$Dl))});var yt=this;n.$Ad(_d.$xd).$A5E(IItemReadingPaneContextFactory).$A5F().$A5G(function(){return new _d.$xd});var pt=this;n.$Ad(IMailResponseViewModelFactory).$A5F().$A5G(function(){return new _d.$qK(n.$6OW(IInferenceTracker),n.$6OW(_g.$44),n.$6OW(IMailComposeContextFactory))});var wt=this;n.$Ad(_d.$QP).$A5F().$A5G(function(){return new _d.$QP(n.$6OW(_y.$dd),n.$6OW(_d.$kB),n.$6OW(_d.$nX),n.$6OW(_a.$p),n.$A3X(_d.$nW),n.$A3X(_d.$Zu),n.$6OW(_g.$Si),n.$6OW(_a.$8A))});var bt=this;n.$Ad(_d.$Zo).$A5F().$A5G(function(){return new _d.$Zo(n.$6OW(_y.$M),n.$6OW(_cc.$1Q),n.$6OW(_a.$43))});var kt=this;n.$Ad(_d.$nW).$A5F().$A5G(function(){return new _d.$nW(n.$6OW(_d.$C4),n.$6OW(_d.$JU),n.$6OW(_y.$M))});var dt=this;n.$Ad(_d.$s1).$A5F().$A5G(function(){return new _d.$s1(n.$6OW(_y.$M))});var gt=this;n.$Ad(_d.$a7).$A5G(function(){return new _d.$a7(n.$6OW(_y.$M),n.$6OW(_d.$Ui),n.$6OW(_y.$Gb))});var ni=this;n.$Ad(IUnsupportedItemReadingPaneViewModel).$A5G(function(){return new _d.$D8(n.$6OW(_y.$v))});var ti=this;n.$Ad(_d.$56).$A5E(_y.$18L).$A5G(function(){return new _d.$56(n.$6OW(_0365f.$L),n.$A3Y(IAttachmentWellViewModelFactory))});var ii=this;n.$Ad(_d.$10Y).$A5E(ITaskReadingPaneViewModelFactory).$A5F().$A5G(function(){return new _d.$10Y(n.$6OW(_0365f.$L),n.$A3Y(IAttachmentWellViewModelFactory))});var ri=this;n.$Ad(_d.$gk).$A5G(function(){return new _d.$gk(n.$6OW(_0365f.$L),n.$A3Y(IAttachmentWellViewModelFactory))});var ui=this;n.$Ad(_d.$Rd).$A5E(IPeopleSearchSuggestionAdaptorViewModel).$A5G(function(){return new _d.$Rd(n.$6OW(_y.$M),n.$6OW(_d.$Eq))});var fi=this;n.$Ad(_d.$Zu).$A5F().$A5G(function(){return new _d.$Zu(n.$6OW(IMailComposeViewModelFactory),n.$6OW(_y.$M))});var ei=this;n.$Ad(_d.$Eq).$A5F().$A5G(function(){return new _d.$Eq(n.$6OW(_d.$St),n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$6OW(_a.$43))});var oi=this;n.$Ad(_d.$ed).$A5F().$A5G(function(){return new _d.$ed(n.$6OW(_y.$M),n.$6OW(_h.$5Q),n.$6OW(_d.$Eq))});var si=this;n.$Ad(_d.$St).$A5E(ICompositePersonaViewModelFactory).$A5F().$A5G(function(){return new _d.$St(n.$6OW(_y.$M),n.$A3X(_d.$K5))});var hi=this;n.$Ad(_d.$YT).$A5F().$A5G(function(){return new _d.$YT(n.$6OW(_d.$St),n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$6OW(_a.$43))});var ci=this;n.$Ad(_d.$xx).$A5E(IMeCardViewModelFactory).$A5F().$A5G(function(){return new _d.$xx(n.$6OW(_g.$Fa),n.$6OW(_c.$2M),n.$6OW(_d.$Eq),n.$6OW(_a.$43),n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$6OW(_a.NativeBridge))});var li=this,ai=this;n.$Ad(_d.$qs).$A5F().$A5G(function(){return new _d.$qs}).$A5H(function(t){t.$5C=n.$6OW(_d.$Eq)});var vi=this,yi=this;n.$Ad(_d.$ow).$A5F().$A5G(function(){return new _d.$ow}).$A5H(function(t){t.$5C=n.$6OW(_d.$Eq)});var pi=this,wi=this;n.$Ad(_d.$ox).$A5F().$A5G(function(){return new _d.$ox(n.$6OW(_d.$DJ),n.$6OW(_y.$Sa))}).$A5H(function(t){t.$5C=n.$6OW(_d.$Eq)});var bi=this,ki=this;n.$Ad(_d.$p2).$A5F().$A5G(function(){return new _d.$p2}).$A5H(function(t){t.$5C=n.$6OW(_d.$Eq)});var di=this,gi=this;n.$Ad(_d.$qt).$A5F().$A5G(function(){return new _d.$qt}).$A5H(function(t){t.$2Xq=n.$6OW(_d.$qs)});var nr=this;n.$Ad(_d.$Ui).$A5E(IRecipientWellViewModelFactory).$A5F().$A5G(function(){return new _d.$Ui(n.$6OW(_y.$M),n.$6OW(_d.$Eq),n.$6OW(_a.$43))});var tr=this;n.$Ad(_d.$VI).$A5F().$A5G(function(){return new _d.$VI(n.$6OW(_y.$M),n.$6OW(_d.$YT))});if(i.get_$9p()!=="Mouse")if(i.get_$9p()==="TouchNarrow"){var ir=this;n.$Ad(_d.$yZ).$A5E(IOptionsViewModel).$A5G(function(){return new _d.$yY(n.$6OW(_0365f.$L),n.$6OW(_d.$pr))})}else{var rr=this;n.$Ad(_d.$yZ).$A5E(IOptionsViewModel).$A5G(function(){return new _d.$9X(n.$6OW(_0365f.$L),n.$6OW(_d.$pr),n.$6OW(_a.NativeBridge),n.$6OW(_y.$Tc),n.$6OW(_a.$p))})}var ur=this;n.$Ad(_d.$Yy).$A5F().$A5G(function(){return new _d.$Yy(n.$6OW(_y.$M),n.$6OW(_g.$V))});var fr=this,er=this;n.$Ad(_d.$Gs).$A5F().$A5G(function(){return new _d.$Gs(n.$6OW(_d.$DJ),n.$6OW(_y.$M),n.$6OW(_g.$V),n.$6OW(_d.$Yy),n.$6OW(_d.$fR),n.$6OW(_d.$hb),n.$6OW(_a.$43),n.$6OW(_js.$CQ),n.$6OW(_g.$Si))}).$A5H(function(t){t.$3Ti=n.$6OW(_d.$VI);t.$zp=n.$6OW(_d.$YT);t.$JE=n.$6OW(_d.$QP)});var or=this,sr=this;n.$Ad(_d.$eh).$A5F().$A5G(function(){return new _d.$eh(n.$6OW(_a.$Os),n.$6OW(_y.$M),n.$6OW(_a.$8A))}).$A5H(function(t){t.$11p=n.$6OW(_d.$St);t.$5C=n.$6OW(_d.$Eq)});var hr=this,cr=this;n.$Ad(_d.$qD).$A5F().$A5G(function(){return new _d.$qD(n.$6OW(_d.$eh),n.$6OW(_y.$M),n.$6OW(_a.$8A))}).$A5H(function(t){t.$5C=n.$6OW(_d.$Eq)});var lr=this;n.$Ad(_d.$dR).$A5F().$A5G(function(){return new _d.$dR(n.$6OW(_a.$Os),n.$6OW(_a.$8A))});var ar=this;n.$Ad(_d.$qC).$A5F().$A5G(function(){return new _d.$qC(n.$6OW(_a.$Os),n.$6OW(_a.$8A))});var vr=this;n.$Ad(_d.$fR).$A5F().$A5G(function(){return new _d.$fR(n.$6OW(_a.$43))});var yr=this;n.$Ad(_d.$Ox).$A5F().$A5G(function(){return new _d.$Ox(n.$6OW(_a.$43),n.$6OW(_g.$V).get_$5M(),n.$6OW(_y.$M))});var pr=this;n.$Ad(_d.$n7).$A5F().$A5G(function(){return new _d.$n7(n.$6OW(_d.$YT),n.$6OW(_y.$M),n.$6OW(_a.$43))});var wr=this;n.$Ad(_d.$nu).$A5F().$A5G(function(){return new _d.$nu(n.$6OW(_d.$n7),n.$A3X(_d.$lO),n.$6OW(_y.$M),n.$6OW(_a.$43),n.$6OW(_a.$Dl))});var br=this;n.$Ad(_d.$Ey).$A5F().$A5G(function(){return new _d.$Ey(n.$6OW(_g.$V).get_$31(),n.$6OW(_a.$43))});var kr=this;n.$Ad(_d.$ka).$A5F().$A5G(function(){return new _d.$ka(n.$6OW(_d.$Ey),n.$6OW(_cc.$1Q))});var dr=this;n.$Ad(IMeetNowManagerFactory).$A5F().$A5G(function(){return new _d.$19N(n.$6OW(_d.$Ey),n.$6OW(_a.$43),n.$6OW(_a.$8A))});var gr=this;n.$Ad(_d.$ny).$A5F().$A5G(function(){return new _d.$ny(n.$6OW(_d.$ka),n.$6OW(_a.$43))});var nu=this;n.$Ad(_d.$C4).$A5F().$A5G(function(){var t=new _d.$C4(n.$6OW(_d.$Yy),n.$6OW(_d.$Gs),n.$6OW(_d.$Ox),n.$6OW(_d.$qD),n.$6OW(_d.$QP),n.$6OW(_d.$nu),n.$6OW(_g.$V),n.$6OW(_a.$43),n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$A3X(_cc.$My),n.$6OW(_d.$j8),n.$6OW(_0365f.$L),n.$6OW(_d.$ny),n.$6OW(_d.$nt),n.$6OW(_g.$Si),n.$6OW(_d.$Zo),n.$A3Y(IAttachmentWellViewModelFactory),n.$A3Y(IExtensibilityViewModelFactory),n.$6OW(_a.$Dl),n.$6OW(_a.NativeBridge));var i=n.$6OW(_y.$Gb);var r=n.$6OW(IPopOutHelper);i.$3K9(r.$1v7(_d.$C4),[n.$6OW(_cc.$1Q)]);return t});var tu=this,iu=this;n.$Ad(_d.$Zf).$A5F().$A5G(function(){return new _d.$Zf(n.$6OW(_y.$M))}).$A5H(function(t){t.$6Q=n.$6OW(_d.$Ui)});var ru=this;n.$Ad(_d.$hb).$A5F().$A5G(function(){return new _d.$hb(n.$6OW(_d.$Ox),n.$6OW(_y.$M))});var uu=this;n.$Ad(_d.$nt).$A5F().$A5G(function(){return new _d.$nt(n.$6OW(_d.$Ox),n.$6OW(_d.$Yy),n.$6OW(_d.$fR),n.$6OW(_y.$M))});var fu=this;n.$Ad(_d.$JU).$A5F().$A5E(ICalendarReadingPaneViewModelFactory).$A5G(function(){var t=new _d.$JU(n.$6OW(_d.$QP),n.$6OW(_d.$qC),n.$6OW(_d.$TG),n.$6OW(_d.$Zf),n.$6OW(_d.$Eq),n.$6OW(_cc.$My),n.$6OW(_y.$M),n.$6OW(_d.$iu),n.$6OW(_a.$43),n.$6OW(_a.$p));var i=n.$6OW(_y.$Gb);var r=n.$6OW(IPopOutHelper);i.$3K9(r.$1v7(_d.$JU),[n.$6OW(_cc.$1Q)]);return t});var eu=this;n.$Ad(_d.$DJ).$A5F().$A5G(function(){return new _d.$DJ(n.$6OW(_a.$43),n.$6OW(_a.$3O),n.$6OW(_0365f.$L))});var ou=this;n.$Ad(_d.$Zy).$A5F().$A5G(function(){var t=new _d.$Zy(n.$A3W(ISharingCalendarViewModelFactory),n.$6OW(_d.$Fu),n.$6OW(_0365f.$L),n.$6OW(_y.$M),n.$6OW(_cc.$1Q),n.$6OW(_a.$43),n.$6OW(_g.$OE));var i=n.$6OW(_y.$Gb);var r=n.$6OW(IPopOutHelper);i.$3K9(r.$1v7(_d.$Zy),[n.$6OW(_cc.$1Q)]);return t});var su=this;n.$Ad(_d.$Bv).$A5G(function(){return new _d.$Bv(n.$6OW(_0365f.$L),n.$6OW(_g.$44))});var hu=this;n.$Ad(_d.$Ie).$A5G(function(){return new _d.$Ie(n.$6OW(_c.$2M))});var cu=this;n.$Ad(_d.$Mu).$A5G(function(){return new _d.$Mu(n.$6OW(_c.$2M))});n.$Ad(_d.$Da).$A5F();var lu=this;n.$Ad(_d.$rH).$A5F().$A5G(function(){return new _d.$rH(n.$6OW(_0365f.$L),n.$6OW(_d.$Da))});var au=this;n.$Ad(_d.$tI).$A5F().$A5G(function(){return new _d.$tI(n.$6OW(_d.$Da))});if(i.get_$9p()==="Mouse"){var vu=this;n.$Ad(INotificationTrayViewModel).$A5F().$A5G(function(){var i=n.$6OW(_g.$V);if(!i.get_$6H().get_$5q())return new _d.$yP;var t=new _d.$Kx;_g.$V.get_$I().get_$1I().get_$4HL()&2&&t.$110(n.$6OW(_d.$Bv));t.$110(n.$6OW(_d.$Ie));t.$110(n.$6OW(_d.$Mu));_g.$V.get_$I().get_$1I().get_$1tC()&&t.$110(new _d.$Rs(n.$6OW(_d.$5Z)));t.$110(n.$6OW(_d.$Da));n.$6OW(_d.$rH);n.$6OW(_d.$tI);return t})}else{var yu=this;n.$Ad(INotificationTrayViewModel).$A5F().$A5G(function(){return new _d.$yP})}var pu=this;n.$Ad(_d.$Xl).$A5E(IMailComposeViewModelFactory).$A5F().$A5G(function(){return new _d.$Xl(n.$6OW(IExtensibilityViewModelFactory),n.$6OW(_d.$Ui),n.$6OW(_d.$j8),n.$6OW(_d.$lO),n.$6OW(IMailComposeContextFactory),n.$6OW(_d.$Eq),n.$6OW(_y.$M),n.$6OW(_d.$Y0),n.$6OW(_d.$qG),n.$6OW(_y.$Gb),n.$6OW(_0365f.$L),n.$A3Y(IAttachmentWellViewModelFactory),n.$6OW(_a.$3O),n.$6OW(_a.$Dl),n.$A3W(IAttachmentsFilePickerPanelViewModel),n.$6OW(IInferenceTracker),n.$6OW(_g.$On),n.$6OW(_a.NativeBridge))});var wu=this;n.$Ad(_d.$qz).$A5G(function(){return new _d.$qz(n.$6OW(_d.$VI))});var bu=this;n.$Ad(_y.$HN).$A5E(_y.$HN).$A5G(function(){return new _d.$18U(n.$6OW(_y.$cw),n.$6OW(_h.$87),n.$6OW(_y.$M),n.$6OW(_g.$V))});var ku=this;n.$Ad(_y.$pd).$A5G(function(){return new _d.$18M(n.$6OW(_y.$M),n.$6OW(_y.$cw),n.$6OW(_d.$JU),n.$A3W(ITaskReadingPaneViewModelFactory))});var du=this;n.$Ad(_a.$VO).$A5F().$A5G(function(){return new _a.$VO});var gu=this;n.$Ad(_d.$WE).$A5F().$A5G(function(){return new _d.$WE(n.$6OW(_y.$M),n.$6OW(_g.$44),n.$6OW(_0365f.$L),n.$6OW(_h.$5Q),n.$6OW(IInferenceTracker),n.$A3W(IMailErrorHandler),n.$6OW(_h.$Th))});var nf=this;n.$Ad(_d.$WE.$4O4).$A5F().$A5G(function(){return new _d.$WE.$4O4(n.$6OW(_d.$WE))});var tf=this;n.$Ad(_c.$xX).$A5F().$A5G(function(){return new _d.$1D8(n.$6OW(_y.$Gb))});var rf=this;n.$Ad(_d.$wf).$A5F().$A5G(function(){return new _d.$FJ});var uf=this;n.$Ad(_d.$j8).$A5F().$A5G(function(){return new _d.$j8(n.$6OW(_y.$M),n.$6OW(_g.$44),n.$6OW(_d.$wf))});var ff=this;n.$Ad(_d.$NS).$A5E(IModuleHelpProvider).$A5F().$A5G(function(){var t=n.$6OW(_g.$Fa);return new _d.$NS(t.get_$5Vb(),t.get_$Xp(),n.$6OW(_a.$8A),n.$6OW(_d.$Y0),n.$6OW(_y.$6v),i.get_$9p(),n.$6OW(_y.$M))});var ef=this;n.$Ad(_d.$Y0).$A5E(_d.$180).$A5F().$A5G(function(){return new _d.$Y0(n.$6OW(_h.$Na),n.$6OW(_y.$M),n.$6OW(_g.$V).get_$Ot().AllowOfflineOn,n.$6OW(_0365f.$L))});var of=this;n.$Ad(_d.$iF).$A5E(_d.$iF).$A5F().$A5G(function(){return new _d.$iF(n.$6OW(_y.$M),n.$6OW(_a.$43),n.$6OW(_h.$87),n.$6OW(_d.$dR),n.$6OW(_d.$C4),n.$6OW(IMailComposeContextFactory),n.$6OW(_g.$OE),n.$6OW(_a.$8A))});var sf=this;n.$Ad(_d.$kp).$A5E(_d.$kp).$A5F().$A5G(function(){return new _d.$kp(n.$6OW(_y.$M),n.$6OW(_a.$43),n.$6OW(_h.$87),n.$6OW(_d.$dR),n.$6OW(_d.$C4),n.$6OW(IMailComposeContextFactory),n.$6OW(_g.$OE),n.$6OW(_a.$8A),n.$6OW(_d.$Eq),n.$6OW(_d.$iF))});var hf=this;n.$Ad(_d.$jy).$A5E(_d.$jy).$A5F().$A5G(function(){return new _d.$jy(n.$6OW(_y.$M),n.$6OW(_d.$jx))});var cf=this,lf=this;n.$Ad(_d.$jx).$A5E(_d.$jx).$A5F().$A5G(function(){return new _d.$jx(n.$6OW(_y.$M))}).$A5H(function(t){t.$zD=n.$6OW(_d.$K5)});var af=this,vf=this;n.$Ad(_d.$GG).$A5E(_d.$yu).$A5F().$A5G(function(){return new _d.$GG(n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$6OW(_a.$43),n.$6OW(_h.$87),n.$6OW(_d.$jy),n.$6OW(_d.$eh),n.$6OW(_d.$dR),n.$6OW(_d.$qt),n.$6OW(_d.$ow),n.$6OW(_d.$ox),n.$6OW(_d.$p2),n.$6OW(IMailComposeContextFactory),n.$A3Y(IModernGroupCardViewModelFactory),n.$6OW(_y.$6M),n.$6OW(_g.$OE),n.$6OW(_a.$8A))}).$A5H(function(t){t.$zF=n.$6OW(_d.$kp)});var yf=this;n.$Ad(_d.$K5).$A5E(_d.$K5).$A5F().$A5G(function(){return new _d.$K5(n.$6OW(_y.$M),n.$6OW(_a.$3O),n.$6OW(_h.$87),n.$6OW(_d.$yu))});var pf=this;n.$Ad(IModernGroupsComposeFactory).$A5F().$A5G(function(){var t=n.$6OW(_d.$K5);return t.$E(new _d.$Ha,0)});var wf=this;n.$Ad(_d.$rv).$A5F().$A5G(function(){return new _d.$rv});var bf=this;n.$Ad(_d.$o3).$A5F().$A5G(function(){return new _d.$o3(n.$6OW(_a.$43))});var kf=this;n.$Ad(_d.$nn).$A5F().$A5G(function(){return new _d.$nn(i.get_$9p(),n.$6OW(_g.$V).get_$5X3(),n.$6OW(_c.$2M),n.$6OW(_d.$a7))});var df=this;n.$Ad(_d.$Uw).$A5E(ISharedFolderViewModel).$A5G(function(){return new _d.$Uw(n.$6OW(_d.$DJ),n.$6OW(_a.$43))});var gf=this;n.$Ad(_d.$XR).$A5E(IInstantSearchFactory).$A5F().$A5G(function(){return new _d.$XR(n.$6OW(IInferenceTracker),n.$6OW(_g.$Fa).get_$aN())});var ne=this;n.$Ad(_d.$eQ).$A5E(IOpenAnotherMailboxViewModel).$A5G(function(){return new _d.$eQ(n.$6OW(_0365f.$L),n.$6OW(_d.$DJ))});var te=this;n.$Ad(_d.$5E).$A5E(IMailFolderPermissionsDialogViewModel).$A5G(function(){return new _d.$5E(n.$6OW(_d.$DJ),n.$6OW(_a.$43))});var ie=this;n.$Ad(_d.$RB).$A5E(IMailErrorHandler).$A5F().$A5G(function(){return new _d.$RB(n.$6OW(_0365f.$L))});if(i.get_$1DC()){var ue=this;n.$Ad(_c.$z6).$A5E(IPresenceManager).$A5F().$A5G(function(){return new _c.$z6(n.$6OW(_c.$2M),n.$6OW(_c.$E2),n.$6OW(_y.$Gb))})}else{var re=this;n.$Ad(_c.$Hc).$A5E(IPresenceManager).$A5F().$A5G(function(){return new _c.$Hc(n.$6OW(_c.$2M),n.$6OW(_c.$E2),n.$6OW(_y.$Gb))})}var fe=this;n.$Ad(_d.$Rb).$A5F().$A5G(function(){return _d.$Rb.$7e2(n.$6OW(_y.$M),n.$6OW(_a.$I8),n.$6OW(_a.$3O),n.$A3Y(IModernGroupsProvider))});var ee=this;n.$Ad(_d.$xI).$A5F().$A5G(function(){return new _d.$ex(n.$6OW(_y.$M),n.$6OW(_d.$Gs),n.$6OW(IMailComposeContextFactory))})},$7sM:function(){return[new _a.$65(_d.$rv,2,9),new _a.$65(_d.$nn,1,1),new _a.$65(_y.$k8,1,13),new _a.$65(_d.$5Z,2,9),new _a.$65(_a.$63,2,1),new _a.$65(_c.$nk,2,9),new _a.$65(_y.$r0,2,9),new _a.$65(_d.$WE.$4O4,2,9),new _a.$65(_d.$o3,2,9)]}};_d.$9Z=function(n,t,i,r){this.$4G=new Sys.EventHandlerList;_d.$9Z.initializeBase(this);this.$C=n;this.$zG=t;this.$D9=i;this.$1J=r};function $1Vf(n,t,i,r){var u=t[r];_js.$9.$18(u)||(i[r]=u)}function $4nY(n,t,i,r,u,f){var e;if($6(t))throw Error.argumentNull("factory");if($6(r))e=n.$zG.$3l9(t,i,f);else{e=n.$zG.$3l8(t,r,f);r.get_$4O6()&&!$4nZ(n,u)&&(window.document.title=r.get_$4O6())}return e}function $4nZ(n,t){return n.$D9.get_$4l()!==1&&!!n.$1J&&n.$1J.$3u("InstantPopout")&&Array.contains(_d.$9Z.$6Kw,n.$zG.$1v7(t))}function $6wT(n,t,i,r,u){var e=window.location.href;var f=_a.$3R.$1Rp(e);$1Vf(n,f,i,"flights");$1Vf(n,f,i,"features");$1Vf(n,f,i,"traceMessageMaxLength");$1Vf(n,f,i,"traceComponents");$1Vf(n,f,i,"traceLevel");$1Vf(n,f,i,"perfTraceLevel");$1Vf(n,f,i,"analyticsEnabled");n.$62(t,i,r,u,"_blank")}function $6wV(n,t,i,r,u,f){if(!n.$zG.$3Tb(t))throw Error.argumentType("The parameter vmType should be ViewModel type!");if($6(n.$2Xk))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var e=n.$2Xk(n,u,"_blank");if(e&&!e.closed){var o=$4nY(n,i(),r,f,t,e);if(o.length>1)throw Error.invalidOperation("Popping up more than one view model is not currently supported for projection popout.");n.$2Yp.$7O9(o[0],e,f?f.get_$4O6():null)}}function $6wU(n,t,i,r,u,f){var e=$4nY(n,t(),i,r,f,null);if(e.length>1)throw Error.invalidOperation("Popping up more than one view model is not supported in touch environments. Please contact the Shell team if you have this requirement.");n.$C.$fC(e[0],0,u)}_d.$9Z.prototype={$C:null,$zG:null,$2Yp:null,$2Xk:null,$D9:null,$1J:null,add_$6J2:function(n){this.$4G.addHandler("OpenWindowRequested",n)},remove_$6J2:function(n){this.$4G.removeHandler("OpenWindowRequested",n)},get_$6FI:function(){return this.$2Xk},set_$6FI:function(n){this.$2Xk;this.$2Xk=n;return n},get_$9VD:function(){if(!this.$2Yp){this.$2Yp=new _y.$1At;window.popOutProjectionManager=this.$2Yp}return this.$2Yp},$62:function(n,t,i,r,u){if(!this.$zG.$3Tb(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var f=this.$4G.getHandler("OpenWindowRequested");if($6(f))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var e=this.$zG.$1v7(n);u=$6(u)?"_blank":u;f(this,new _y.$1AE(e,t,i,r,u))},$9VB:function(n,t,i,r){this.$6J0(n,t,i,r,null,!1)},$6J0:function(n,t,i,r,u,f){if(!this.$zG.$3Tb(n))throw Error.argumentType("The parameter vmType should be ViewModel or IParameterableViewModelFactory type!");this.$C.get_$L()==="Mouse"?$4nZ(this,n)?$6wV(this,n,t,i,r,u):$6wT(this,n,i,r,u):$6wU(this,t,i,u,f,n)}};_d.$D0=function(n){this.$3IS=n};_d.$D0.$7Th=function(n,t){if(_d.$D0.$3Qz)return 4;var i=_d.$D0.$6P1(n,t);return i?_y.$Er.$5V6(i)?3:2:1};_d.$D0.$6P1=function(n,t){return!_js.$9.$18(t)&&n?n.getContext(t):null};function $6wS(n,t){if(!n.$3Tb(t))throw Error.argument("The pop out control only supports creating ViewModels by passing in a IParameterizeableViewModelFactory");var i=n.$3IS.$27X(t);$6(i)&&(i=new t);if($6(i))throw Error.argument(String.format("Could not instantiate IParameterizeableViewModelFactory {0}",t));return i}function $6wR(n,t,i){if(!$6(i.get_$241())&&i.get_$241().length>0){t.get_mainWindowInstance()&&!t.get_mainWindowInstance().closed&&new _y.$kk(t.get_mainWindowInstance(),i.get_$241());for(var u=i.get_$241(),e=u.length,r=0;r<e;++r){var f=u[r];_h.$1O.get_$I().$IX(f.get_$R(),f)}}}function $4nX(n,t,i,r){var u=this;t.add_$18e(function(){_a.$40.$GA(i.get_mainWindowInstance(),function(n){i.deRegisterWindow(r)})})}_d.$D0.prototype={$dx:null,$3IS:null,get_$6a3:function(){if(!this.$dx){this.$dx={};this.$dx.ReadMessageItem=_y.$HN;this.$dx.ItemReadingPaneViewModelPopOutFactory=_y.$HN;this.$dx.Chat=_d.$a7;this.$dx.ItemAttachment=_y.$pd;this.$dx.ComposeCalendarItemViewModelFactory=_d.$C4;this.$dx.OwaOptionPeoplePickerViewModelFactory=_d.$qz;this.$dx.CalendarItemDetailsViewModelFactory=_d.$JU;this.$dx.ISharingCalendarViewModelFactory=ISharingCalendarViewModelFactory;this.$dx.IMailComposeViewModelFactory=_d.$Xl;this.$dx.PersonaCardViewModelFactory=_d.$GG;this.$dx.TaskReadingPaneViewModelPopOutFactory=_d.$gk;this.$dx.IAttachmentViewModelPopoutFactory=IAttachmentViewModelPopoutFactory;this.$dx.CalendarShareMessageViewModelFactory=_d.$Zy}return this.$dx},$3Tb:function(n){return Type.isClass(n)&&(_a.$F2===n||n.inheritsFrom(_a.$F2)||n.implementsInterface(_y.$183))||Type.isInterface(n)},$1v7:function(n){var t=this.get_$6a3();for(var i in t){var r={key:i,value:t[i]};var u=r.value;if(n===u)return r.key}return n.getName()},$7yr:function(n){return this.get_$6a3()[n]},$7z8:function(n,t,i,r,u){var f=null;var o=$6wS(this,i);var e=r.wid;var s=_d.$D0.$6P1(t,e);_a.$40.$1mv=e;var h=_d.$D0.$7Th(t,e);switch(h){case 4:f=this.$3l8(o,_d.$D0.$3Qz,u);_d.$D0.$3Qz=null;break;case 1:f=this.$3l9(o,r,u);break;case 2:$4nX(this,n,t,e);_y.$Er.$5II(s,this.$3IS);f=this.$3l9(o,r,u);break;case 3:$4nX(this,n,t,e);_y.$Er.$5II(s,this.$3IS);var c=_y.$Er.$7iM(s);$6wR(this,t,c);f=this.$3l8(o,c,u);break;default:_a.$4.$9n(!0,"Unknown PopOutMode "+_d.$z5.toString(h));break}if(!f||!f.length)throw Error.argument("The ViewModel provided in the url is not valid!");n.$6Ye(f[0],n.$Zs());return f},$3l8:function(n,t,i){var r;if(_y.$xE.isInstanceOfType(n)){var u=n;r=u.$7ex(t)}else r=[n.$vo(t,i)];return r},$3l9:function(n,t,i){var r;if(_y.$xE.isInstanceOfType(n)){var u=n;r=u.$9de(t)}else r=[n.$bC(t,i)];return r}};_d.$Pk=function(n,t){_d.$Pk.initializeBase(this);this.$26R=new _C(n,_d.$Pk.$A);this.set_$do(t)};_d.$Pk.prototype={$26R:null,$4Wh:!1,get_$1GW:function(){return this.$26R},get_$do:function(){return this.$4Wh},set_$do:function(n){this.$4Wh=n;$N(this,"ShowPopOutControl");return n}};_d.$V4=function(){this.$2Vx=-1};_d.$V4.prototype={$46k:0,$46t:null,$6Zq:0,$B:0,get_$7Ru:function(){return this.$B?Math.round(this.$6Zq/this.$B):-1},$6I:function(n,t){this.$B++;this.$6Zq+=n;if(n>=this.$46k){this.$46k=n;this.$46t=t}(this.$2Vx===-1||n<this.$2Vx)&&(this.$2Vx=n)},$1Hc:function(){if(!this.$B)return"";var n=$6(this.$46t)?"":this.$46t;var t=[this.$2Vx,this.get_$7Ru(),this.$46k,n];return t.join(",")}};_d.$Dz=function(n,t,i,r){this.$$d_$1mT=Function.createDelegate(this,this.$1mT);this.$$d_$9sM=Function.createDelegate(this,this.$9sM);this.$$d_$1AK=Function.createDelegate(this,this.$1AK);this.$$d_$7Ul=Function.createDelegate(this,this.$7Ul);this.$$d_$8Hr=Function.createDelegate(this,this.$8Hr);this.$$d_$2Gq=Function.createDelegate(this,this.$2Gq);_d.$Dz.initializeBase(this);this.$5cl=n;this.$1PW=t;this.$2e=i;this.$k=r;this.$hv=new _C(this.$$d_$2Gq,_d.$Dz.$A);this.$1e3=new _C(this.$$d_$8Hr,_d.$Dz.$A,this.$2e,"CalendarEntry",this.$$d_$7Ul)};function $6ou(n){var t={};if(n.$2e.get_$6J()&&n.$2e.get_$6J().get_$B()>0){var i=n.$2e.get_$6J().$6Z();t["Compose Form Item Categories"]=i}return t}function $6ov(n){n.$ZW||n.set_$1qb(new _y.$C3(n.$1PW,n.$$d_$1mT))}function $6ot(n){return _g.$33.$1us(n.$2e)}function $6os(n,t,i){var f=this;var u=new _y.$2v("dummy",new _C(function(){},_d.$Dz.$A));var e=this;var r=new _y.$2v(t,new _C(function(){$6ow(n,u)},_d.$Dz.$A));u=r;r.$7lS();r.set_$3RV(i);return r}function $6ow(n,t){var i=t.$2E;var r=null;var u=null;t.get_$3RV()?r=i:u=i;n.$1AK(r,u,!1)}_d.$Dz.prototype={$hv:null,$1e3:null,$5cl:!1,$2e:null,$1PW:null,$k:null,$O0:null,$ZW:null,$2GZ:null,add_$2oA:function(n){this.$2N("CategoriesChanged",n)},remove_$2oA:function(n){this.$2P("CategoriesChanged",n)},get_$1qb:function(){return this.$ZW},set_$1qb:function(n){if(this.$ZW!==n){this.$ZW=n;$3(this,"CategoryManagementDialog")}return n},get_$58x:function(){return this.$2e.get_$6J()},get_$5A4:function(){this.$O0||(this.$O0=new _y.$Fw(this.$1PW,this.$$d_$1AK,this.$hv,this.$1e3));return this.$O0},$7sE:function(){if(this.$2GZ)return this.$2GZ;this.$2GZ=new(_0365f.$o.$$(_y.$2v));if(this.$1PW&&!this.$2e.get_$GC()){var t=this.$1PW.$4XK();var i=this.$2e.get_$6J()?this.$2e.get_$6J().$6Z():new Array(0);i.sort(this.$$d_$9sM);for(var f=t.length,e=i.length,n=0,r=0;n<f;n++){var u=!1;if(r<e&&t[n].get_$1L()===i[r]){u=!0;r++}this.$2GZ.$D($6os(this,t[n].get_$1L(),u))}}return this.$2GZ},$3sl:function(){return this.$2e.get_$GC()?null:this.get_$5A4().$1YV()},$4O9:function(){this.get_$5A4().$1r3($6ou(this),1)},$1AK:function(n,t,i){var r=this.$2e.get_$6J();var u=_g.$Bs.$1mR(r,i,t,n);this.$2e.set_$6J(u);$6C(this,"CategoriesChanged")},$2Gq:function(){this.$1AK(null,null,!0)},$7Ul:function(){var n=this.$2e.get_$5k();return this.$5cl&&(_g.$Ej.isInstanceOfType(n)&&!n.get_$1D0()||this.$2e.get_$aH())?!0:!1},$8Hr:function(){$6ov(this);this.$ZW.$bL()},$1mT:function(n,t,i){var r=new _h.$hB(n,t,i,$6ot(this));var u=this;r.add_$2C(function(){var n=r.$3Sm;u.$1PW.set_$1PY(n);$3(u,"MasterCategories")});r.add_$1x(_cc.$5g.$1C0);this.$k.$z(r)},$9sM:function(n,t){var i=n.toLowerCase();var r=t.toLowerCase();return i.localeCompare(r)}};_d.$Zo=function(n,t,i){this.$C=n;this.$2U=t;this.$k=i};_d.$Zo.prototype={$C:null,$2U:null,$k:null,$8A:function(n){if(!this.$2U.get_$I1()){_js.Trace.logError(_a.$0.$JF,"Make sure that calendarcache is loaded before creating CalendarCategoryViewModel");return null}var t=this.$2U.$2Ln(n.get_$28());return t?new _d.$Dz(this.$C.get_$9A(),t,n,this.$k):null}};_d.$Fq=function(n){this.$$d_$7UT=Function.createDelegate(this,this.$7UT);this.$$d_$9b3=Function.createDelegate(this,this.$9b3);this.$$d_$3iE=Function.createDelegate(this,this.$3iE);this.$$d_$7Uc=Function.createDelegate(this,this.$7Uc);this.$$d_$9bd=Function.createDelegate(this,this.$9bd);_d.$Fq.initializeBase(this);_a.$4.$l(n,"itemViewModel");this.$5m=n;$6oz(this);var t=this;this.$2a8=new _C(this.$$d_$9bd,_d.$Fq.$A,this,"CanRemoveWithConfirmation",function(){return t.get_$7Us()});var i=this;this.$2nm=new _C(this.$$d_$7Uc,_d.$Fq.$A,this,"CanCancelWithConfirmation",function(){return i.get_$7UF()});this.$PJ=new _C(this.$$d_$3iE,_d.$Fq.$A)};function $6oz(n){var t=this;n.$5m.$Y("CanCancel",function(){$3(n,"CanCancelWithConfirmation")});var i=this;n.$5m.$Y("CanRemove",function(){$3(n,"CanRemoveWithConfirmation")})}_d.$Fq.prototype={$5m:null,$2a8:null,$2nm:null,$PJ:null,$vd:null,$1r5:null,$vc:null,$11q:!1,get_$7Us:function(){return this.$5m.get_$VX()},get_$7UF:function(){return this.$5m.get_$hp()},get_$1r6:function(){return this.$vd},set_$1r6:function(n){if(this.$vd!==n){this.$vd=n;$3(this,"ConfirmDialogTitle")}return n},get_$3it:function(){return this.$1r5},set_$3it:function(n){if(this.$1r5!==n){this.$1r5=n;$3(this,"ConfirmDialogMessage")}return n},get_$2p9:function(){return this.$vc},set_$2p9:function(n){if(this.$vc!==n){this.$vc=n;$3(this,"ConfirmDialogButtonDataList")}return n},get_$O4:function(){return this.$11q},set_$O4:function(n){if(this.$11q!==n){this.$11q=n;$3(this,"ConfirmDialogIsShown")}return n},$3iE:function(){this.set_$O4(!1)},$9bd:function(){this.set_$1r6(_nbs.NonBootStrings.l_DeleteEvent_Text);this.set_$3it(_nbs.NonBootStrings.l_AreYouSureYouWantToDeleteThisEvent_Text);var n=new _js.$Z;n.$D(new _a.$2G(new _C(this.$$d_$9b3,_d.$Fq.$A),_nbs.NonBootStrings.l_DeleteButtonLabel_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));this.set_$2p9(n);this.set_$O4(!0)},$7Uc:function(){this.set_$1r6(_nbs.NonBootStrings.l_CancelEvent_Text);this.set_$3it(_nbs.NonBootStrings.l_AreYouSureYouWantToCancelTheEvent_Text);var n=new _js.$Z;n.$D(new _a.$2G(new _C(this.$$d_$7UT,_d.$Fq.$A),_u.Strings.l_Yes_Text,_nbs.NonBootStrings.l_YouWillHaveAnOpportunityToTypeAMessageToAttendees_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text,_nbs.NonBootStrings.l_ReturnToTheEvent_Text));this.set_$2p9(n);this.set_$O4(!0)},$9b3:function(){this.$PJ.$n();this.$5m.$TL.$n()},$7UT:function(){this.$PJ.$n();this.$5m.$7V.$n()}};_d.$IY=function(n){this.$$d_$9DM=Function.createDelegate(this,this.$9DM);_d.$IY.initializeBase(this);this.$13=n};function $4k2(n){if($6(n.$2e)){n.$2Nf="";return}n.$2e.get_$AW()?n.$2e.get_$y().$93(n.$2e.get_$1u())?n.$2e.get_$5V()?$2h2(n,8,8):$2h2(n,11,11):n.set_$5XN(n.$2e.get_$y().$2Z(8)):n.$2e.get_$1cZ()?$2h2(n,11,11):$2h2(n,11,18)}function $2h2(n,t,i){n.set_$5XN(String.format(_nbs.NonBootStrings.l_CalendarDragDrop_InfoTip_Text,n.$2e.get_$y().$2Z(t),n.$2e.get_$1u().$2Z(i)))}_d.$IY.prototype={$13:null,$2e:null,$2Nf:null,get_$6n:function(){return this.$2e},set_$6n:function(n){if(this.$2e!==n){if(this.$2e){this.$2e.$u("Start",this.$$d_$9DM);this.$2e.$u("End",this.$$d_$9DM)}this.$2e=n;$4k2(this);if(this.$2e){this.$2e.$Y("Start",this.$$d_$9DM);this.$2e.$Y("End",this.$$d_$9DM)}}return n},get_$5XN:function(){return this.$2Nf},set_$5XN:function(n){if(this.$2Nf!==n){this.$2Nf=n;$3(this,"InfoTipString")}return n},get_$ml:function(){return!this.$13.get_$qw()},$9DM:function(n,t){$4k2(this)}};_d.$5e=function(n,t){this.$$d_$9PE=Function.createDelegate(this,this.$9PE);this.$$d_$9Br=Function.createDelegate(this,this.$9Br);this.$$d_$3FC=Function.createDelegate(this,this.$3FC);_d.$5e.initializeBase(this,[new Array(0)]);_a.$4.$J(n,"calendarItemViewModel");this.$o=n;n.$t.get_$GC()&&(this.$tE=this.$o.$1YU());if(t){this.$ph=n.$t.get_$GC()?t.$8A(this.$tE.$t):t.$8A(n.$t);this.$ph&&this.$ph.add_$2oA(this.$$d_$3FC)}$6pD(this)};_d.$5e.$1on=function(n,t){var i=n.length;t();n.length!==i&&Array.add(n,new _0365m.$9y)};_d.$5e.$2Lt=function(n,t,i,r,u){if(u&&r){var f=new _0365m.$2b([new _0365m.$m(t,null,r),new _0365m.$m(i,null,u)]);return new _0365m.$Gv(n,null,f)}return u?new _0365m.$m(i,null,u):r?new _0365m.$m(n,null,r):null};_d.$5e.$5P5=function(n,t){if(!t){_js.Trace.logWarning(_a.$0.$1k,"Empty context sub-menu generated for item. OptionText: {0}",n);return new _0365m.$Gv(n,null,new _0365m.$2b([]))}for(var r=t.$1C.get_$B(),u=new Array(r),i=0;i<r;++i)u[i]=t.$1C.get_$3q(i).$3p();return new _0365m.$Gv(n,null,new _0365m.$2b(u))};_d.$5e.$5P6=function(n,t,i){if($6(i))return new _0365m.$m(n,null,t);for(var u=i.$1C.get_$B(),f=new Array(u),r=0;r<u;++r)f[r]=i.$1C.get_$3q(r).$3p();return new _0365m.$Gv(n,null,new _0365m.$2b(f))};function $6pD(n){if(n.$o.$t.get_$1Ka()){var t=[];var i=n.$o.$t;var r=i.get_$GC();var f=this;_d.$5e.$1on(t,function(){i.get_$vL()&&Array.add(t,new _0365m.$m(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$o.$j7))});var e=this;_d.$5e.$1on(t,function(){i.get_$UH()&&!i.get_$I2()&&Array.add(t,new _0365m.$m(_d.$KV.$5S8(n.$o.$t,1),null,n.$o.$5m.$TL))});var o=this;_d.$5e.$1on(t,function(){Array.add(t,_d.$5e.$2Lt(_nbs.NonBootStrings.l_Open_LowerCase_Text,_nbs.NonBootStrings.l_OpenOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$o.$k5.$m0(1,!1),r?n.$o.$k5.$m0(1,!0):null))});$6pE(n,t);if(i.get_$11b()){Array.add(t,$6p9(n));if(n.$ph){n.$1XW=n.$ph.$3sl();if(n.$1XW){n.$1XW.$Hm.$Y("IsShown",n.$$d_$9Br);Array.add(t,n.$1XW)}}Array.add(t,new _0365m.$9y)}$6pC(n,r,t,i);$6pB(n,r,t,i);t.length>0&&Array.removeAt(t,t.length-1);for(var u=0;u<t.length;u++)t[u].set_$tC(n);n.$1C.$69(t)}}function $6pE(n,t){var i=n.$o.$t;var r=i.get_$GC();var u=this;_d.$5e.$1on(t,function(){i.get_$ej()&&Array.add(t,new _0365m.$m(_u.Strings.l_Reply_LowerCase_Text,null,n.$o.$QJ.$IO));i.get_$hr()&&Array.add(t,new _0365m.$m(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$o.$QJ.$KS));var r=$6pA(n);r&&Array.add(t,r)})}function $6pA(n){var t=null;var i=null;if(n.$o.$t.get_$GC()){i=n.$tE.$QJ.$Hx;n.$o.$t.get_$ei()&&(t=n.$o.$QJ.$Hx)}else n.$o.$t.get_$ei()&&(t=n.$o.$QJ.$Hx);return _d.$5e.$2Lt(_u.Strings.l_Forward_LowerCase_Text,_nbs.NonBootStrings.l_ForwardOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_ForwardSeries_LowerCase_Text,t,i)}function $6pB(n,t,i,r){var u=n.$o.$RF;var f=this;_d.$5e.$1on(i,function(){n.$o.$t.get_$aH()||!r.get_$JW()||r.get_$I2()||r.get_$UH()?n.$o.$5m.$TL.$2M&&!r.get_$UH()&&Array.add(i,_d.$5e.$2Lt(_u.Strings.l_Delete_LowerCase_Text,_nbs.NonBootStrings.l_DeleteOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_DeleteSeries_LowerCase_Text,n.$o.$5m.$TL,t?n.$tE.$5m.$TL:null)):r.get_$Du()?Array.add(i,_d.$5e.$5P5(_u.Strings.l_Delete_LowerCase_Text,u.$2Ip)):Array.add(i,_d.$5e.$5P6(_u.Strings.l_Delete_LowerCase_Text,u.$2r4,u.$2Ip));r.get_$hp()&&Array.add(i,_d.$5e.$2Lt(_nbs.NonBootStrings.l_CancelMeeting_LowerCase_Text,_nbs.NonBootStrings.l_CancelOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_CancelSeries_LowerCase_Text,n.$o.$5m.$7V,t?n.$tE.$5m.$7V:null))})}function $6pC(n,t,i,r){var u=n.$o.$RF;var f=this;_d.$5e.$1on(i,function(){if(n.$o.$t.get_$aH())r.get_$UH()||Array.add(i,_d.$5e.$2Lt(_nbs.NonBootStrings.l_AddToMyCalendar_Lowercase_Text,_nbs.NonBootStrings.l_AddToMyCalendar_Occurrence_Text,_nbs.NonBootStrings.l_AddToMyCalendar_Series_Text,n.$o.$5m.$3d2,t?n.$tE.$5m.$3d2:null));else{$3W5(n,r.get_$1AD(),i,r.get_$Du(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,u.$2Dp,u.$3bs);$3W5(n,r.get_$1AI(),i,r.get_$Du(),_nbs.NonBootStrings.l_TentativelyAcceptItem_LowerCase_Text,u.$2eW,u.$4a1);$3W5(n,r.get_$11Z(),i,r.get_$Du(),_nbs.NonBootStrings.l_DeclineItem_LowerCase_Text,u.$2IV,u.$2r4)}})}function $3W5(n,t,i,r,u,f,e){t&&(r?Array.add(i,_d.$5e.$5P5(u,f)):Array.add(i,_d.$5e.$5P6(u,e,f)))}function $6p9(n){for(var u=null,t=0;t<_d.$5e.$29I.length;t++)_d.$5e.$29I[t].$3s===n.$o.$t.get_$9S()&&(u=_d.$5e.$29I[t]);var i=new _d.$UC(_nbs.NonBootStrings.l_Calendar_ItemContextMenu_ShowAs_Text,null,n.$$d_$9PE,_d.$5e.$29I,u);i.set_$6Vs(!1);i.set_$2n(!n.$o.$t.get_$2Oz());for(var r=0;r<_d.$5e.$29I.length;r++)i.$Hm.$1C.get_$3q(r).$1zO="CalendarItemTemplates.ShowAsMenuItemTemplate";return i}_d.$5e.prototype={$o:null,$tE:null,$1XW:null,$ph:null,$4c:function(){if(this.$ph){this.$ph.remove_$2oA(this.$$d_$3FC);this.$1XW&&this.$1XW.$Hm.$u("IsShown",this.$$d_$9Br)}_js.$8.prototype.$4c.call(this)},$9Br:function(n,t){this.$1XW.$Hm.$2y&&this.$ph.$4O9()},$9PE:function(n){if(this.$tE){this.$tE.$t.set_$9S(n);this.$tE.$5m.$FK()}else{this.$o.$t.set_$9S(n);this.$o.$5m.$FK()}},$3FC:function(){if(this.$tE){this.$tE.$t.set_$6J(this.$ph.get_$58x());this.$tE.$5m.$FK()}else{this.$o.$t.set_$6J(this.$ph.get_$58x());this.$o.$5m.$FK()}}};_d.$6k=function(n,t,i,r,u,f,e,o,s){this.$$d_$1Oy=Function.createDelegate(this,this.$1Oy);_d.$6k.initializeBase(this);_a.$4.$l(n,"item");this.$jG=t;this.$3Hy=f;this.$1E2=i;this.$JE=r;this.$2nP=u;this.$1PN=e;this.$lZ=o;this.$VJ=s;$6pn(this,n)};_d.$6k.$1xn=function(n){var t;var i=n.get_$Pk()&&!$6(n.get_$LT());t=i?_d.$2r.$7Tc(n.get_$LT()):_d.$6k.$3sv(n).$3D;return!!t&&t.$2R(_a.$7.get_$29())<0};_d.$6k.$3uR=function(n){var t=$6(n.get_$7S())?0:n.get_$7S().get_$B();var i=$6(n.get_$8W())?0:n.get_$8W().get_$B();return t+i};_d.$6k.$3sv=function(n){var t;var i;if(n.get_$5V()){var r=n.get_$1u().$5z(n.get_$y());t=n.get_$y().$4F();i=n.get_$1u().$3j2()||!r?n.get_$1u().$4F().$2o(1):n.get_$1u()}else{t=n.get_$y();i=n.get_$1u()}return new _h.$4e(t,i)};function $6pm(n){n.$85s();n.$k5=n.$2nP.$8A(n);n.$QJ=n.$jG.$8A(n.$t,null,n.$1PN.$$d_$E);n.$E5=new _d.$zP(n.$t,new _g.$1BL,n.$t.get_$y(),n.$t.get_$1u())}function $6pn(n,t){t.$3NN();n.set_$1Rg(t);n.set_$6n(n.$6d.$3p())}_d.$6k.prototype={$cb:!1,$jG:null,$3Hy:null,$1E2:null,$JE:null,$2nP:null,$1PN:null,$VJ:null,$lZ:null,$6d:null,$t:null,$QJ:null,$5m:null,$k5:null,$E5:null,$j7:null,$5MG:!1,$RF:null,get_$1OF:function(){return $6(this.$6d.get_$i())&&$6(this.$t.get_$i())},get_$1Iu:function(){return this.$6d.get_$JW()||this.$t.get_$JW()},get_$A2i:function(){return this.$6d.get_$JW()&&this.$t.get_$JW()},get_$8JA:function(){return this.$RF},set_$8JA:function(n){if(this.$RF!==n){this.$RF=n;$3(this,"MeetingResponseViewModel")}return n},get_$6n:function(){return this.$t},set_$6n:function(n){if(this.$t!==n){this.$t=n;$6pm(this);this.set_$gp(this.$t.get_$QH()?this.$t.get_$tc():_d.$6k.$1RH);var t=this;this.set_$33y(new _C(this.$$d_$1Oy,_d.$6k.$A,this.$t,"CanJoin",function(){return t.$t.get_$vL()}));$3(this,"CalendarItem")}return n},get_$gp:function(){return this.$t.get_$QH()?this.$t.get_$tc():_d.$6k.$1RH},set_$gp:function(n){if(this.get_$gp()!==n){this.$t.set_$QH(n!==_d.$6k.$1RH);this.$t.get_$QH()&&this.$t.get_$tc()!==n&&this.$t.set_$tc(n);$3(this,"ReminderSelectedValue")}return n},get_$33y:function(){return this.$j7},set_$33y:function(n){if(this.$j7!==n){this.$j7=n;$3(this,"JoinCommand")}return n},get_$1ww:function(){if($6(this.$6d.get_$28())){if(!_g.$h.$1i.doesIdEqualName(this.$t.get_$28(),"calendar"))return!0}else if(this.$5a0())return!0;return this.get_$5V4()},get_$5V4:function(){return this.$6d.get_$2i()!==this.$t.get_$2i()||this.$6d.get_$5V()!==this.$t.get_$5V()||!_a.$7.$4N(this.$6d.get_$y(),this.$t.get_$y())||!_a.$7.$4N(this.$6d.get_$1u(),this.$t.get_$1u())||this.$6d.get_$9S()!==this.$t.get_$9S()||this.$6d.get_$QH()!==this.$t.get_$QH()||this.$6d.get_$tc()!==this.$t.get_$tc()||this.$6d.get_$84()!==this.$t.get_$84()||this.$6d.get_$Du()!==this.$t.get_$Du()||!_g.$D.$4N(this.$6d.get_$4j(),this.$t.get_$4j())||!_g.$D.$4N(this.$6d.get_$LT(),this.$t.get_$LT())||_g.$3i.$1K1(this.$6d.get_$7S(),this.$t.get_$7S())||_g.$3i.$1K1(this.$6d.get_$8W(),this.$t.get_$8W())||_g.$3i.$1K1(this.$6d.get_$9F(),this.$t.get_$9F())||_g.$NY.$56G(this.$6d.get_$mc(),this.$t.get_$mc())||_g.$y.$56C(this.$6d.get_$6J(),this.$t.get_$6J())||this.$5MG?!0:this.$t.get_$5Uo()},get_$82P:function(){return _g.$3i.$1K1(this.$6d.get_$7S(),this.$t.get_$7S())||_g.$3i.$1K1(this.$6d.get_$8W(),this.$t.get_$8W())},get_$1Rg:function(){return this.$6d},set_$1Rg:function(n){if(this.$6d!==n){this.$6d=n;this.$5EG()}return n},get_$Cx:function(){return this.$cb},set_$Cx:function(n){this.$cb=n;$3(this,"IsDraft");return n},get_$2i:function(){return this.$t.get_$2i()},$5a0:function(){return!$6(this.$6d.get_$28())&&!$6(this.$t.get_$28())&&!_g.$28.$4N(this.$t.get_$28(),this.$6d.get_$28())},$9yk:function(n){this.set_$6n(n)},$9yl:function(n){this.set_$6n(n);this.$A0J()},$1YU:function(){if(!this.$t.get_$GC())throw Error.invalidOperation("Cannot create partial recurring master model from a non-recurring event.");var n=this.$lZ.$1YU(this.$6d);return this.$JE.$8A(n)},$A0J:function(){this.$6d.$2BV(this.$t.get_$3A());this.$5EG()},$iF:function(){this.set_$6n(this.$6d.$3p())},$5jN:function(){this.$5MG=!0},$85s:function(){this.$5m=this.$3Hy.$E(this)},$5EG:function(){this.set_$8JA(this.$1E2.$8A(this.$6d,1))},$1Oy:function(){this.$VJ.$Re(this.$t.get_$2Qa())}};_d.$QP=function(n,t,i,r,u,f,e,o){this.$jG=n;this.$1E2=t;this.$lZ=e;this.$13=r;this.$3Hy=i;this.$2nP=u;this.$1PN=f;this.$VJ=o};_d.$QP.prototype={$jG:null,$1E2:null,$13:null,$3Hy:null,$lZ:null,$1PN:null,$2nP:null,$VJ:null,get_$9UE:function(){return this.$3Hy},get_$2Rk:function(){return this.$1PN.get_$1g()},get_$7Tr:function(){return this.$2nP.get_$1g()},$8A:function(n){return new _d.$6k(n,this.$jG,this.$1E2,this,this.get_$7Tr(),this.get_$9UE(),this.get_$2Rk(),this.$lZ,this.$VJ)}};_d.$5X=function(n,t,i,r,u,f){this.$$d_$7oa=Function.createDelegate(this,this.$7oa);this.$$d_$7oY=Function.createDelegate(this,this.$7oY);this.$$d_$7oZ=Function.createDelegate(this,this.$7oZ);this.$$d_$7oX=Function.createDelegate(this,this.$7oX);this.$$d_$9f7=Function.createDelegate(this,this.$9f7);this.$$d_$6SX=Function.createDelegate(this,this.$6SX);this.$$d_$9hh=Function.createDelegate(this,this.$9hh);this.$$d_$FK=Function.createDelegate(this,this.$FK);this.$$d_$9b=Function.createDelegate(this,this.$9b);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$7Om=Function.createDelegate(this,this.$7Om);this.$$d_$7On=Function.createDelegate(this,this.$7On);_d.$5X.initializeBase(this);this.$1W=t;this.$C=i;this.$9N=f;this.$f=n;this.$6h=r;this.$1PN=u;$6pf(this);var e=this;this.$3d2=new _C(this.$$d_$7On,_d.$5X.$A,this,"CanAddToMyCalendar",function(){return e.get_$1AE()});var o=this;this.$2kj=new _C(this.$$d_$7Om,_d.$5X.$A,this,"CanAddToMyCalendar",function(){return o.get_$1AE()});var s=this;this.$TL=new _C(this.$$d_$34,_d.$5X.$A,this,"CanRemove",function(){return s.get_$VX()});var h=this;this.$7V=new _C(this.$$d_$9b,_d.$5X.$A,this,"CanCancel",function(){return h.get_$hp()});var c=this;this.$El=new _C(this.$$d_$FK,_d.$5X.$A,this,"CanSave",function(){return c.get_$2GT()});var l=this;this.$4UJ=new _C(this.$$d_$9hh,_d.$5X.$A,this,"CanSend",function(){return l.get_$lf()});var a=this;this.$6SY=new _C(this.$$d_$6SX,_d.$5X.$A,this,"CanSend",function(){return a.get_$lf()});var v=this;this.$6QG=new _C(this.$$d_$9f7,_d.$5X.$A,this,"CanSaveDraft",function(){return v.get_$7Ux()});var y=this;this.$3nt=new _C(this.$$d_$34,_d.$5X.$A,this,"CanDiscardDraft",function(){return y.get_$7Uf()})};function $4kJ(n,t){n.$ha=_a.$6.$1c(_d.$5X.$A,t,!0);_a.$6.stPT(_d.$5X.$A,t,3);var r=new _g.$VP;r.ItemId=_h.$7U.$3tT(n.$f.$6d);var u=_g.$33.$1us(n.$f.$6d);var i=new _c.$hZ(r,u);var f=this;i.add_$1x(function(i){if(n.$ha){_a.$6.$1E(n.$ha,null,_d.$1Jb.$6w.$iV(i),_d.$1Jb.$6w.$PX(i),null);n.$ha=null}_a.$6.endPT(t);_cc.$5g.$1C0(i)});var e=this;i.add_$2C(function(r){$1nZ(n,"AddCalendarItemToMyCalendarAction",i);if(n.$ha){_a.$6.$1E(n.$ha,null,"",_d.$1Jb.$6w.$PX(r),null);n.$ha=null}_a.$6.endPT(t)});n.$1W.$z(i)}function $6pe(n,t,i){var u=t?2:0;var r=n.$f.$t;if(i){r=n.$f.$6d;r.set_$y(n.$f.$t.get_$y().$hb(1));r.set_$1u(n.$f.$t.get_$1u().$hb(1))}else $6(n.$f.$t.$Hy)||n.$f.$t.$Hy.$n();return new _cc.$9e(r,u,_cc.$6d.$2wW(r),_g.$33.$1us(r))}function $2Cc(n,t,i,r,u){if(t&&i)throw Error.invalidOperation("Cannot send and save as draft.");var f=new(_0365f.$o.$$(_a.$2p));var h=!1;if(n.$f.get_$1OF())f.$D($6pe(n,t,i));else{if(i)throw Error.invalidOperation("Cannot save a draft of an existing calendar item.");$6(n.$f.$t.$Hy)||n.$f.$t.$Hy.$n();if(n.$f.get_$5V4()){var c=new _cc.$Fg(n.$f.$6d,n.$f.$t,r,n.$f.$6d.get_$Pk(),_cc.$6d.$2wW(n.$f.$t),_g.$33.$1us(n.$f.$6d));f.$D(c);n.$9N.$7lY(c)}if(n.$f.$5a0()){h=!0;var a=n.$7vV();f.$D(a)}}if(f.get_$B()>0){for(var e=null,l=f.get_$3T(),v=l.length,o=0;o<v;++o){var s=l[o];$6pg(n,s,u);if(e){var p=this;e.add_$2C(function(t){n.$1W.$z(s)})}e=s}var y=f.get_$3q(f.get_$B()-1);$6ph(n,y,i,h,t);n.$1W.$z(f.get_$3q(0))}else $1nZ(n,t?"SendCalendarItemAction":"SaveCalendarItemAction",null)}function $6pg(n,t,i){var r=this;t.add_$1x(function(t){i||_cc.$5g.$1C0(t);$1nZ(n,"PersistActionFailed",t)})}function $6ph(n,t,i,r,u){var f=this;t.add_$2C(function(f){var e;e=i?"SaveDraftCalendarItemAction":r?"MoveCalendarItemAction":u?"SendCalendarItemAction":"SaveCalendarItemAction";$1nZ(n,e,t)})}function $1nZ(n,t,i){$CY(n,"Completed",t,i)}function $6pf(n){n.$f.$t.$3NN();n.$f.$t.$Y("RequiredAttendees",n.$$d_$7oX);n.$f.$t.$Y("OptionalAttendees",n.$$d_$7oX);n.$f.$t.$Y("Resources",n.$$d_$7oX);n.$f.$t.$Y("IsCancelled",n.$$d_$7oZ);n.$f.$t.$3K8(n.$$d_$7oY);n.$f.$Y("IsDraft",n.$$d_$7oa)}function $4kK(n){$45(n,"CanSend","CanSave")}_d.$5X.prototype={$3d2:null,$2kj:null,$TL:null,$7V:null,$El:null,$4UJ:null,$6SY:null,$6QG:null,$3nt:null,$1PN:null,$f:null,$1W:null,$C:null,$6h:null,$9N:null,$ha:null,add_$2m:function(n){this.$2N("Completed",n)},remove_$2m:function(n){this.$2P("Completed",n)},get_$1AE:function(){return!this.$C.get_$Er()&&this.$f.$6d.get_$1AE()&&!this.$f.$6d.get_$UH()},get_$7Ud:function(){return this.get_$1AE()&&!this.$f.$6d.get_$I2()},get_$VX:function(){return this.get_$11b()&&(this.$f.$6d.get_$UH()||this.$f.$6d.get_$VX())},get_$hp:function(){return this.$f.$6d.get_$hp()&&this.$f.$6d.get_$JW()},get_$2GT:function(){return!this.$f.get_$1Iu()&&!this.$f.$t.get_$UH()&&this.$f.$t.get_$I2()},get_$lf:function(){return this.$f.get_$1Iu()&&this.$f.$t.get_$I2()},get_$7Ux:function(){return this.$f.$t.get_$I2()},get_$7Uf:function(){return this.$f.$cb},get_$eh:function(){return!this.$C.get_$Er()&&this.$f.$t.get_$eh()},get_$11b:function(){return!this.$C.get_$Er()&&this.$f.$t.get_$11b()},get_$1Ka:function(){return(!this.$C.get_$Er()||!_d.$1r.$3nn&&!this.$f.$t.get_$cg())&&this.$f.$t.get_$1Ka()},get_$8HV:function(){return this.$1PN.$E()},$7On:function(){$4kJ(this,"AddToMyCalendarFromSurfaceContextMenu")},$7Om:function(){$4kJ(this,"AddToMyCalendarFromCalendarReadingPaneOrPeekForm")},$34:function(){var t=this.$f.$6d;t.get_$435()&&(t=this.$f.$1YU().$t);var i=_d.$1Jb.$1k.$9rW(t.get_$aH());var n=new _c.$13k(t,"MoveToDeletedItems",_cc.$6d.$2wW(this.$f.$t),_g.$33.$1us(this.$f.$6d));n.$4UD=2;var u=this;n.add_$1x(function(n){i&&_a.$6.$1E(i,null,_d.$1Jb.$6w.$iV(n),_d.$1Jb.$6w.$PX(n),null);_cc.$5g.$1C0(n)});var r=this;n.add_$2C(function(t){i&&_a.$6.$1E(i,null,"",_d.$1Jb.$6w.$PX(t),null);$1nZ(r,"RemoveCalendarItemAction",n)});this.$1W.$z(n)},$9b:function(){var n=this.get_$8HV();var t=this.$7dT();this.$C.get_$9A()&&$1nZ(this,"CancelCalendarItemAction",null);n.$T7(t)},$7dT:function(){var n=this.$6h.$G3(!0,!1);n.set_$40(8);n.set_$Na(!0);var t=_g.$33.$1us(this.$f.$6d);n.set_$3qS(t);t&&n.set_$5XF(!0);if(this.$f.$6d.get_$x8()){this.$f.$t.$Hy&&this.$f.$t.$Hy.$n();n.$13p(this.$f.$6d)}else{n.set_$14D(!0);n.set_$dJ(this.$f.$6d.get_$i());n.set_$rN(_g.$33.$rN(this.$f.$6d))}return n},$FK:function(){$2Cc(this,!1,!1,0,!1)},$9fK:function(){$2Cc(this,!1,!1,0,!0)},$9hh:function(){$2Cc(this,!0,!1,3,!1)},$6SX:function(){$2Cc(this,!0,!1,4,!1)},$9f7:function(){$2Cc(this,!1,!0,0,!1)},$6I:function(){this.$f.get_$1Iu()?this.$6SX():this.$FK()},$7vV:function(){return new _h.$MG([this.$f.$t],this.$f.$t.get_$28(),0)},$7oX:function(n,t){this.$f.$t.$3K8(this.$$d_$7oY);$4kK(this)},$7oY:function(n,t){$4kK(this)},$7oZ:function(n,t){$3(this,"CanSave")},$7oa:function(n,t){$3(this,"CanDiscardDraft")}};_d.$nX=function(n,t,i,r,u){this.$1W=n;this.$C=t;this.$9N=u;this.$6h=i;this.$1PN=r};_d.$nX.prototype={$1PN:null,$1W:null,$C:null,$6h:null,$9N:null,get_$3g7:function(){return this.$9N},get_$2Rk:function(){return this.$1PN.get_$1g()},$E:function(n){return new _d.$5X(n,this.$1W,this.$C,this.$6h,this.get_$2Rk(),this.get_$3g7())}};_d.$CK=function(n,t,i,r){_d.$CK.initializeBase(this);this.$C=n;this.$o=r;this.$Eu=i;this.$Kl=t};function $6pW(n){if(n.$2Xf){_a.$6.$1E(n.$2Xf);n.$2Xf=null}_a.$6.endPT("OpenCalendarItemOnReadingPane")}function $6pV(n){if(n.$2Xe){_a.$6.$1E(n.$2Xe);n.$2Xe=null}_a.$6.endPT("OpenCalendarItemOnComposeForm")}function $6pU(n,t,i,r){$4kD(n,n.$Kl,t);_a.$6.stPT(_a.$0.$6y,"OpenCalendarItemOnReadingPane",3);n.$2Xf=t?_a.$6.$1c(_a.$0.$6y,"OpenCalendarSeriesItemOnReadingPane",!0):_a.$6.$1c(_a.$0.$6y,"OpenCalendarItemOnReadingPane",!0);var u=$4kE(n,t);var f=$4kC(n);var s=this;var e=function(t){r&&r(t);$6pW(n)};var o=n.$Kl.$bC(u.$3K,null,e);n.$C.$fC(o,f,!1);i&&i()}function $4kC(n){if(n.$C.get_$9A()){var t=n.$C.$Zs();return _d.$3a.isInstanceOfType(t.get_$7u())||_d.$13.isInstanceOfType(t.get_$7u())?1:0}else return 1}function $6pT(n,t,i,r){$4kD(n,n.$Eu,t);_a.$6.stPT(_a.$0.$6y,"OpenCalendarItemOnComposeForm",3);n.$2Xe=t?_a.$6.$1c(_a.$0.$6y,"OpenCalendarSeriesItemOnComposeForm",!0):_a.$6.$1c(_a.$0.$6y,"OpenCalendarItemOnComposeForm",!0);var u=$4kE(n,t);var f=$4kC(n);var e=_a.$6.acss(_a.$0.$6y,"Setting ComposeCalendarItemVM");var h=this;var o=function(t){r&&r(t);$6pV(n)};var s=n.$Eu.$bC(u.$3K,null,o);_a.$6.aces(e);n.$C.$fC(s,f,!1);i&&i()}function $4kE(n,t){var i=new _y.$Ax;t?i.$9kS(new _h.$7U(n.$o.$t.get_$i())):i.$V5(n.$o.$t.get_$i());return i}function $4kD(n,t,i){}_d.$CK.prototype={$Kl:null,$Eu:null,$C:null,$o:null,$2Xf:null,$2Xe:null,get_$2nt:function(){return this.get_$59i()||this.get_$59j()},get_$59i:function(){return this.$o.$5m.get_$eh()},get_$7Uo:function(){return this.$o.$5m.get_$eh()&&this.get_$59k()},get_$59j:function(){return this.$o.$5m.get_$1Ka()},get_$7Up:function(){return this.$o.$5m.get_$1Ka()&&this.get_$59k()},get_$59k:function(){return this.$o.$t.get_$GC()},$m0:function(n,t,i,r){var e=null;var u=null;var f=null;switch(n){case 1:var o=this;e=function(){$6pU(o,t,i,r)};u="CanOpenItemInRead";var s=this;f=function(){return s.get_$59j()};if(t){u="CanOpenSeriesInRead";var h=this;f=function(){return h.get_$7Up()}}break;case 0:var c=this;e=function(){$6pT(c,t,i,r)};u="CanOpenItemInCompose";var l=this;f=function(){return l.get_$59i()};if(t){u="CanOpenSeriesInCompose";var a=this;f=function(){return a.get_$7Uo()}}break}return new _C(e,_d.$CK.$A,this,u,f)}};_d.$nW=function(n,t,i){this.$Eu=n;this.$Kl=t;this.$C=i};_d.$nW.prototype={$C:null,$Eu:null,$Kl:null,$8A:function(n){return new _d.$CK(this.$C,this.$Kl,this.$Eu,n)}};_d.$LR=function(){this.$$d_$3wQ=Function.createDelegate(this,this.$3wQ);this.$$d_$7ha=Function.createDelegate(this,this.$7ha);this.$$d_$7hZ=Function.createDelegate(this,this.$7hZ);this.$$d_$7hk=Function.createDelegate(this,this.$7hk);_d.$LR.initializeBase(this);var n=this;this.$3nB=new _C(this.$$d_$7hk,this.get_$1b(),this,"CanDeleteItemOrSeries",function(){return n.get_$7Ue()})};_d.$LR.$iD=function(n){var t=n.$5m;var i=n.$RF;t.$TL.$2M?t.$TL.$n():t.$7V.$2M?t.$7V.$n():i.$qF.$2M&&i.$qF.$n()};function $6pi(n){if(!n.$1Z7){var t=new _js.$Z;t.$D(new _a.$2G(new _C(n.$$d_$7hZ,n.get_$1b()),_nbs.NonBootStrings.l_Occurrence_LowerCase_Text));t.$D(new _a.$2G(new _C(n.$$d_$7ha,n.get_$1b()),_nbs.NonBootStrings.l_Series_LowerCase_Text));t.$D(new _a.$2G(new _C(n.$$d_$3wQ,n.get_$1b()),_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));n.set_$7i0(t)}}function $6pj(n){n.set_$2Ok(!0)}_d.$LR.prototype={$3nB:null,$1xG:!1,$1Z7:null,$37:null,get_$xb:function(){return this.$37},set_$xb:function(n){this.$37=n;$45(this,"ItemViewModel","CanDeleteItemOrSeries");return n},get_$7Ue:function(){return!$6(this.$37)&&!this.$37.get_$1OF()&&(this.$37.$5m.get_$VX()||this.$37.$5m.get_$hp()||this.$37.$RF.get_$11Z())},get_$2Ok:function(){return this.$1xG},set_$2Ok:function(n){if(this.$1xG!==n){this.$1xG=n;$3(this,"IsDeleteRecurringEventDialogShown")}return n},get_$7i0:function(){return this.$1Z7},set_$7i0:function(n){if(n!==this.$1Z7){this.$1Z7=n;$3(this,"DeleteRecurringEventDialogButtonData")}return n},get_$1b:function(){return _a.$0.$1k},$7hk:function(){if(this.$37){var n=this.$37.$t;if(n.get_$GC()){$6pi(this);$6pj(this)}else _d.$LR.$iD(this.$37)}},$7hZ:function(){this.$3wQ();_d.$LR.$iD(this.$37)},$7ha:function(){this.$3wQ();var n=this.$37.$1YU();_d.$LR.$iD(n)},$3wQ:function(){this.set_$2Ok(!1)}};_d.$EX=function(){};_d.$EX.$7kV=function(n){return String.format("\tStart: '{0}', End: '{1}', ItemId: '{2}'",n.get_$y(),n.get_$1u(),_d.$EX.$1BZ(n))};_d.$EX.$1BZ=function(n){var t=n.get_$i();return!t||!t.Id?"<null>":t.Id};_d.$1Ki=function(){_d.$1Ki.initializeBase(this)};_d.$9A=function(){};_d.$9A.$E=function(n,t,i,r){var f=_a.$6.$1c(n,t,!0);_a.$6.acsa(n,t);var u=null;if(f){u=new _d.$9A;u.$3lE=f;u.$6gq=i;u.$gs=t;u.$1p=n;u.$3pX=r}return u};function $3W7(n,t,i){_a.$6.acea(null,n.$gs);n.$6gq&&n.$3lE&&_a.$6.$1E(n.$3lE,null,t,i,n.$3m1);_a.$6.endPT(null)}_d.$9A.prototype={$3lE:null,$gs:null,$3m1:null,$6gq:!1,$3pX:!1,$5M9:1,$1p:null,$8IO:function(){--this.$5M9>0||$3W7(this)},$7pg:function(n,t){$3W7(this,n,t)},$5L8:function(){this.$3pX?_js.Trace.logWarning(this.$1p,"EndTrace was called for an animation based scenario."):$3W7(this)}};_d.$LU=function(n,t){_d.$LU.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$LU.initializeBase(this,[n]);_a.$4.$l(t,"date");this.$7h=t;var i=_d.$LU.$5R3(t,n);this.$2Q=i.$2Q;this.$3D=i.$3D};_d.$LU.$5R3=function(n,t){var i;var r;i=n.$2R(t.get_$y())>0?n:t.get_$y();var u=n.$2o(1);r=u.$2R(t.get_$1u())<0?u:t.get_$1u();return new _h.$4e(i,r)};_d.$LU.prototype={$7h:null,$2Q:null,$3D:null,get_$51:function(){return this.$7h},set_$51:function(n){this.$7h=n;return n},get_$y:function(){return this.$2Q},get_$1u:function(){return this.$3D}};_d.$1KY=function(n){this.$$d_$3gO=Function.createDelegate(this,this.$3gO);_d.$1KY.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$1KY.initializeBase(this);_a.$4.$l(n,"calendarItemModel");this.$2e=n;this.$2e.add_$7q(this.$$d_$3gO)};_d.$1KY.prototype={$2e:null,get_$i:function(){return this.$2e.get_$i()},get_$y:function(){return this.$2e.get_$y()},get_$1u:function(){return this.$2e.get_$1u()},get_$2i:function(){return this.$2e.get_$2i()},get_$5V:function(){return this.$2e.get_$5V()},get_$9S:function(){return this.$2e.get_$9S()},get_$5k:function(){return this.$2e.get_$5k()},get_$mw:function(){return this.$2e.get_$mw()},get_$2Xt:function(){return this.$2e.get_$2Xt()},get_$GC:function(){return this.$2e.get_$GC()},get_$1y5:function(){return this.$2e.get_$1y5()},get_$2Oz:function(){return this.$2e.get_$2Oz()},get_$G9:function(){return this.$2e.get_$G9()},get_$cg:function(){return this.$2e.get_$cg()},get_$4j:function(){return this.$2e.get_$4j()},get_$AW:function(){return this.$2e.get_$AW()},get_$1cZ:function(){return this.$2e.get_$1cZ()},get_$F5:function(){return this.$2e.get_$F5()},get_$43h:function(){return this.$2e.get_$43h()},get_$I2:function(){return this.$2e.get_$I2()},get_$eh:function(){return this.$2e.get_$eh()},$4c:function(){this.$2e.remove_$7q(this.$$d_$3gO);_a.$1.prototype.$4c.call(this)},$3gO:function(n,t){$3(this,t)}};_d.$Zy=function(n,t,i,r,u,f,e){this.$1Tq=n;this.$M=i;this.$C=r;this.$2U=u;this.$Tn=t;this.$k=f;this.$96=e};_d.$Zy.prototype={$1Tq:null,$M:null,$C:null,$2U:null,$Tn:null,$k:null,$96:null,$E:function(n){return this.$96.get_$1k()?new _d.$EY(n,this.$Tn,this.$1Tq,this.$M,this.$C,this.$2U,this.$k):null}};_d.$EY=function(n,t,i,r,u,f,e){this.$$d_$96O=Function.createDelegate(this,this.$96O);this.$$d_$99V=Function.createDelegate(this,this.$99V);this.$$d_$1ol=Function.createDelegate(this,this.$1ol);this.$$d_$9m2=Function.createDelegate(this,this.$9m2);_d.$EY.initializeBase(this);this.$1A9=n;this.$1Tq=i;this.$M=r;this.$C=u;this.$6Ur=new _C(this.$$d_$9m2,_d.$EY.$A);this.$58h=new _C(this.$$d_$1ol,_d.$EY.$A);this.$2U=f;this.$Tn=t;this.$2OD=!1;this.$k=e;$6qK(this)};function $6qK(n){n.set_$6Vc(!1);n.set_$6XC(!1);var t=$6qL(n);if(t&&!_g.$h.$1i.doesIdEqualName(t,"sentitems")){var i=this;n.$2U.$1Mx(function(){n.set_$6XC(n.$C.get_$L()==="Mouse")});n.set_$6Vc(!0)}}function $6qL(n){var t;if(n.$1A9.get_$28()&&_g.$h.$1i.idToName(n.$1A9.get_$28())===_g.$Ac.$WN){var i=_h.$8p.$7yj(n.$1A9.get_$28());if(i)t=i.get_$r();else{_js.Trace.logError(_d.$EY.$A,"Not able to found the WellKnownFolder for the Share message");t=null}}else t=n.$1A9.get_$28();return t}function $6qI(n){var t=this;_js.$J.get_$I().$3r(_a.$0.$62,"PopOutClose",function(){window.self.close()})}function $6qJ(n){var t=new(_0365f.$o.$$(String));if(n.$1A9.get_$92()){var i=this;n.$1A9.get_$92().$Bh(function(n){var i=n;i.get_$Bf()==="application/x-sharing-metadata-xml"&&t.$D(i.get_$3i().Id)})}return t.$6Z()}function $6qM(n,t){for(var u=n.$2U.get_$ux(),i=0;i<u.get_$B();++i)for(var f=u.get_$3q(i),r=0;r<f.get_$Cp().get_$B();r++){var e=f.get_$Cp().get_$3q(r);if(e.get_$i().Id===t.Id){n.$Tn.$3NE(e,!0);return}}}_d.$EY.prototype={$1A9:null,$Tn:null,$6Ur:null,$C:null,$M:null,$1Tq:null,$2U:null,$k:null,$58h:null,$3O6:!1,$3Oy:!1,$2OD:!1,$X1:null,get_$56r:function(){this.$X1||(this.$X1=$6qJ(this));return this.$X1},get_$6Vc:function(){return this.$3O6},set_$6Vc:function(n){if(this.$3O6!==n){this.$3O6=n;$3(this,"ShowAddButton")}return n},get_$6XC:function(){return this.$3Oy},set_$6XC:function(n){if(this.$3Oy!==n){this.$3Oy=n;$3(this,"ShowShareBackButton")}return n},$j6:function(){},$9m2:function(){var n=this;this.$1Tq.$E(function(t){t.$4LE(n.$2U.get_$iB().get_$A5(),n.$1A9.get_$8X().Mailbox,!0)})},$1ol:function(){if(!this.$2OD){this.$2OD=!0;var n=new _c.$11H(this.$1A9.get_$i());n.add_$1x(this.$$d_$99V);this.$C.get_$9A()&&n.add_$2C(this.$$d_$96O);this.$k.$z(n);this.$C.get_$9A()||$6qI(this)}},$99V:function(n){this.$2OD=!1;_cc.$5g.$1C0(n)},$96O:function(n){var i=n;this.$M.$9Yf(_y.$Gi,new _y.$Gi(1,null));var t=this;this.$2U.$AF(function(){t.$2OD=!1;$6qM(t,i.$66k)})}};_d.$sb=function(n,t,i,r){this.$iP=n;this.$k=t;this.$M=i;this.$2U=r};_d.$sb.prototype={$iP:null,$k:null,$M:null,$2U:null,$E:function(n,t){var i=this.$iP.$E(_pc.$14.$1C9,_pc.$14.$iZ(),!1,"PersonaDetailedView");return new _d.$70(n,t,i,this.$k,this.$M,this.$2U)}};_d.$70=function(n,t,i,r,u,f){this.$$d_$9BJ=Function.createDelegate(this,this.$9BJ);this.$$d_$9sc=Function.createDelegate(this,this.$9sc);this.$$d_$9sd=Function.createDelegate(this,this.$9sd);this.$$d_$9b1=Function.createDelegate(this,this.$9b1);this.$$d_$7kw=Function.createDelegate(this,this.$7kw);this.$$d_$9Hb=Function.createDelegate(this,this.$9Hb);this.$$d_$9Mx=Function.createDelegate(this,this.$9Mx);this.$$d_$11k=Function.createDelegate(this,this.$11k);this.$$d_$6F2=Function.createDelegate(this,this.$6F2);_d.$70.initializeBase(this);this.$BM=n;this.$k=r;this.$Tn=t;this.$2U=f;this.$M=u;this.set_$DP(this);this.set_$1D6(!0);this.set_$1wt(!1);this.set_$3zX(!1);var e=this;this.$3Ga=new _C(this.$$d_$6F2,_d.$70.$A,this,"CanOpenCalendar",function(){return e.get_$7Um()});this.$7J.$D(new _a.$2G(this.$3Ga,_nbs.NonBootStrings.l_OpenCalendarButton_Text));var o=this;this.$7J.$D(new _a.$2G(new _C(this.$$d_$11k,_d.$70.$A,this,"IsActionPending",function(){return!o.$JV}),_u.Strings.l_CancelButtonText_Text));this.$PU=new _y.$4c;this.$2r=i;this.$2r.$Y("QueryString",this.$$d_$9Mx);$6xl(this)};function $6xl(n){n.$2r.set_$tx(!0);_d.$DJ.$1YD(n.$2r);n.$2r.$11N();n.$2r.add_$gw(n.$$d_$9Hb);n.set_$5Yy(!1)}function $6xh(n,t){t.set_$er(!0);t.set_$1YK($6xi(n))}function $6xi(n){return[new _0365m.$m(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(n.$$d_$7kw,_d.$70.$A)),new _0365m.$m(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(n.$$d_$9b1,_d.$70.$A))]}function $6xo(n){$4oA(n,1)}function $6xn(n){$4oA(n,0)}function $4oA(n,t){n.$4YX=t;if(!$6(n.$dw)){n.$dw.remove_$2C(n.$$d_$9sd);n.$dw.remove_$1x(n.$$d_$9sc);n.$dw=null}switch(n.$4YX){case 0:var r=n.$1Nk.get_$1s();var u=r.get_$1F()===5;if(u&&n.$2U.$41o){n.$Iy=_a.$6.$1c(_a.$0.$1k,"SubscribeToInternalGroupCalendar",!0);var f=_g.$9G.$2q3(r.get_$1o(),r.get_$1l().EmailAddress,u);var i=n.$Tn.$J1.$1Ma(f);if(!i&&n.$Tn.$1vO){n.$M.$9Yf(_d.$Ia,new _d.$Ia(1));i=n.$Tn.$6Qb(f)}if(i){n.$Tn.$4Uj(i,!0);n.$M.$9Yf(_d.$YM,new _d.$YM(f))}n.$11k();if(n.$Iy){_a.$6.$1E(n.$Iy);n.$Iy=null}return}else{n.$Iy=_a.$6.$1c(_a.$0.$1k,"SubscribeToInternalCalendar",!0);n.$dw=new _c.$1DI(n.$BM,n.$1Nk.get_$1s().get_$1l().EmailAddress,u)}break;case 1:n.$Iy=_a.$6.$1c(_a.$0.$1k,"SubscribeToInternetCalendar",!0);n.$dw=new _c.$1DJ(n.$BM,n.$1wl);break}n.$dw.add_$2C(n.$$d_$9sd);n.$dw.add_$1x(n.$$d_$9sc);n.set_$1wt(!0);n.$k.$z(n.$dw)}function $6xj(n){var t=null;switch(n.$4YX){case 0:t=n.$dw.$YV;break;case 1:t=n.$dw.$YV;break}return t}function $6xk(n){if(!$6(n.$dw)){n.$dw.remove_$2C(n.$$d_$9sd);n.$dw.remove_$1x(n.$$d_$9sc)}n.$2r.set_$Ac(null);n.set_$3yj(null);n.set_$5Z3(null)}function $3XR(n){n.$2r.set_$8Dj(!n.$1wl);n.set_$87a(!n.$2r.$2s&&!n.$1Nk)}function $6xg(n){for(var t=0;t<n.$7J.get_$B();t++)n.$7J.get_$3q(t).$Kn.set_$5u(!n.$JV)}function $4o9(n){n.set_$3yj(null);n.$2r.set_$Ac("");n.$2r.set_$HW(!0)}function $6xm(n,t,i){n.$PU.$32(0,i,null,!1,null,null,t)}_d.$70.prototype={$PU:null,$BM:null,$2U:null,$Tn:null,$k:null,$M:null,$3Ga:null,$2r:null,$1wh:!1,$2za:!1,$JV:!1,$306:!1,$2zZ:!0,$4YX:0,$dw:null,$1Nk:null,$1wl:null,$Iy:null,get_$3yj:function(){return this.$1Nk},set_$3yj:function(n){if(this.$1Nk!==n){this.$1Nk=n;this.set_$5Yy(!$6(n));$3(this,"InternalSubscriptionSource")}return n},get_$5Z3:function(){return this.$1wl},set_$5Z3:function(n){if(this.$1wl!==n){this.$1wl=n;this.set_$87b(!_js.$9.$a(n)&&!_js.$9.$18(n));$3(this,"InternetSubscriptionSource");$3XR(this)}return n},get_$87a:function(){return this.$2zZ},set_$87a:function(n){if(n!==this.$2zZ){this.$2zZ=n;$3(this,"InternetSubscriptionSourceEnabled")}return n},get_$5Yy:function(){return this.$1wh},set_$5Yy:function(n){if(this.$1wh!==n){this.$1wh=n;$45(this,"InternalSubscriptionSourceIsResolved","CanOpenCalendar")}return n},get_$87b:function(){return this.$2za},set_$87b:function(n){if(this.$2za!==n){this.$2za=n;$45(this,"InternetSubscriptionSourceIsResolved","CanOpenCalendar")}return n},get_$7Um:function(){return!this.$JV&&(this.$1wh||this.$2za)},get_$1wt:function(){return this.$JV},set_$1wt:function(n){if(this.$JV!==n){this.$JV=n;$45(this,"IsActionPending","CanOpenCalendar");$6xg(this)}return n},get_$3zX:function(){return this.$306},set_$3zX:function(n){if(this.$306!==n){this.$306=n;$3(this,"IsCacheReloadPending")}return n},$4c:function(){this.$2r.$1Q();this.$PU.$1Q();this.$dw=null;_a.$1.prototype.$4c.call(this)},$9Hb:function(n,t){var i=n.get_$Wh();if(i){$6xh(this,i);this.set_$3yj(i)}},$11k:function(){$6xk(this);this.$4d.$n()},$6F2:function(){this.$1wh?$6xn(this):$6xo(this)},$9sc:function(n){this.set_$1wt(!1);if(this.$Iy){_a.$6.$1E(this.$Iy,null,_d.$1Jb.$6w.$iV(n),_d.$1Jb.$6w.$PX(n),null);this.$Iy=null}$6xm(this,_nbs.NonBootStrings.l_CalendarActionErrorDialogTitle_Text,n.get_$cH())},$9sd:function(n){this.set_$3zX(!0);this.$2U.$AF(this.$$d_$9BJ);this.set_$1wt(!1);this.$11k();if(this.$Iy){_a.$6.$1E(this.$Iy,null,"",_d.$1Jb.$6w.$PX(n),null);this.$Iy=null}},$9BJ:function(){var n=$6xj(this);if(n){this.$Tn.$3NE(n,!0);this.$dw=null}this.set_$3zX(!1)},$7kw:function(){var n=this.$1Nk.get_$1s().get_$1o();$4o9(this);this.$2r.set_$Ac(n)},$9Mx:function(n,t){$3XR(this)},$9b1:function(){$4o9(this);$3XR(this)}};_d.$Cm=function(n){this.$$d_$9zc=Function.createDelegate(this,this.$9zc);this.$w=n;this.$8Gf()};function $3W4(n,t,i){if(_d.$6k.$1xn(t)){var r=0;var u=1;var f=new Array(2);f[r]=4600;f[u]=6200;var e=new Array(2);e[r]=1100;e[u]=2200;var o=i?f:e;t.get_$Pk()?n.$w.$2a(o[u]):n.$w.$2a(o[r])}}function $4k6(n,t,i){t.get_$I2()&&i&&!t.get_$Du()&&n.$w.$2a(1400)}function $4k5(n,t){if(t.get_$UH()){var i=_nbs.NonBootStrings.l_None_Text;var r=_nbs.NonBootStrings.l_None_Text;if(t.get_$As()){r=t.get_$As().$2Z(5);i=t.get_$As().$2Z(0)}n.$w.$2a(1200,r,i)}}function $4k3(n,t){t.get_$I2()||t.get_$UH()||_d.$6k.$1xn(t)||(t.get_$TM()==="NoResponseReceived"||t.get_$TM()==="Unknown")&&(t.get_$Du()||n.$w.$2a(1300))}function $4k4(n,t,i){if(!t.get_$I2()&&t.get_$2li()){var r=_js.$9.$18(t.get_$2lh())||i.get_$FS()===t.get_$2lh();var u=t.get_$2li().$2Z(5);var f=t.get_$2li().$2Z(0);var e=null;e=r?[u,f]:[t.get_$2lh(),u,f];var o=$6p8(n,t.get_$TM(),r);if(o!==-1){var s;(s=n.$w).$2a.apply(s,[o].concat(e))}}}function $6p8(n,t,i){var r=-1;switch(t){case"Accept":r=i?1600:1700;break;case"Tentative":r=i?1800:1900;break;case"Decline":r=i?2e3:2100;break;default:break}return r}_d.$Cm.prototype={$w:null,$TE:null,$9zc:function(n,t){this.$18h()},$18h:function(){this.$w.$DG(this.$TE);this.$7qZ()}};_d.$1EU=function(n){_d.$1EU.initializeBase(this);this.$S8=n};_d.$1EU.prototype={$S8:null,get_$y:function(){return this.$S8.get_$y()},set_$y:function(n){if(!this.get_$y()||!this.get_$y().$4e(n)){var t=this.get_$DS();this.$S8.set_$y(n.$3p());this.$S8.set_$1u(n.$9K(t));$9J(this,"Start","End")}return n},get_$1u:function(){return this.$S8.get_$1u()},set_$1u:function(n){if(!this.get_$1u()||!this.get_$1u().$4e(n)){n.$2R(this.get_$y())<0?this.$S8.set_$1u(this.get_$y().$3p()):this.$S8.set_$1u(n.$3p());$N(this,"End")}return n},get_$5V:function(){return this.$S8.get_$5V()},set_$5V:function(n){if(this.get_$5V()===n)return n;this.$S8.set_$5V(n);$N(this,"IsAllDayEvent");return n},get_$DS:function(){return this.get_$1u().$5z(this.get_$y())},set_$DS:function(n){if(n!==this.get_$DS()){var t=n-this.get_$DS();this.set_$1u(this.get_$1u().$9K(t))}return n}};_d.$JK=function(n){_d.$JK.initializeBase(this);this.$p=this.$7dJ();this.$Wp=new Array(7);for(var t=0;t<7;t++)this.$Wp[t]=0;this.set_$y(n)};_d.$JK.$vU=function(n,t){var r=n;var u=t;var i=(r.get_$AW()?0:1)-(u.get_$AW()?0:1);i||(i=r.get_$y().$5z(u.get_$y()));i||(i=_d.$JK.$5fT(u)-_d.$JK.$5fT(r));i||(i=r.get_$2i()?u.get_$2i()?r.get_$2i().localeCompare(u.get_$2i()):1:-1);return i};_d.$JK.$5fT=function(n){return Math.floor(n.get_$1u().$5z(n.get_$y())/6e4)};_d.$JK.prototype={$p:null,$Wp:null,$24h:0,$65:null,$SX:null,$4e9:null,$2CD:null,get_$y:function(){return this.$65},set_$y:function(n){if(!this.$65&&n||this.$65&&n&&!this.$65.$4e(n)){this.$65=n;this.$SX=this.$65.$2o(7);for(var t=this.$p.get_$B()-1;t>=0;--t)this.$2PL(this.$p.get_$3q(t))||this.$p.$68(t);this.$4e9=_a.$2D.$Mx(this.$65,1,!0);this.$2CD=new _h.$4e(this.$65,this.$SX);Array.removeAt(this.$4e9,this.$4e9.length-1);$45(this,"Start","WeekDateRange")}return n},get_$4I5:function(){return this.$24h},set_$4I5:function(n){this.$24h=n;return n},get_$6bg:function(){return this.$Wp},set_$6bg:function(n){this.$Wp=n;$JA(this,_d.$JK.$6bh);return n},get_$9w0:function(){return this.$Wp[0]},get_$9w1:function(){return this.$Wp[1]},get_$9w2:function(){return this.$Wp[2]},get_$9w3:function(){return this.$Wp[3]},get_$9w4:function(){return this.$Wp[4]},get_$9w5:function(){return this.$Wp[5]},get_$9w6:function(){return this.$Wp[6]},$2PL:function(n){var t=new _h.$4e(this.$65,this.$SX);return t.$1OL(n)},$7dJ:function(){return new _a.$RL(_d.$JK.$vU)}};_d.$1Kk=function(n,t,i,r,u,f){_d.$1Kk.initializeBase(this,[n,t,r,i,u,f])};_d.$1Kk.prototype={$3mQ:null,$2Wj:null,get_$1rn:function(){return null},get_$1qN:function(){return 5},get_$5H3:function(){this.$3mQ||(this.$3mQ=new _d.$ST(this.get_$1rn()));return this.$3mQ},get_$3EJ:function(){return this.$2Wj},set_$3EJ:function(n){if(this.$2Wj!==n){this.$2Wj=n;$3(this,"NoItemsMessage")}return n},$5TV:function(){},$5TW:function(){}};_d.$1Kw=function(n,t,i,r,u,f){this.$$d_$9I3=Function.createDelegate(this,this.$9I3);_d.$1Kw.initializeBase(this,[n,t,i,r,u,f]);this.$p=new _a.$RL(_cc.$7L.$7XP);this.$p.add_$1Z(this.$$d_$9I3)};_d.$1Kw.prototype={$p:null,$5R6:function(){return this.$p.get_$B()},$7uo:function(){return this.$p.get_$B()},$3cb:function(n){for(var r=n.length,f=_a.$6.acss(_a.$0.$6y,"AgendaDefaultVM_AddItems_"+r),e=this.$p.$6Yh(),u,t,i=0;i<r;i++){t=n[i];if(this.$1ka(t)){u=$1nY(this,t,this.$Gi);e.$69(u)}}this.$p.$5Kt();_a.$6.aces(f)},$IX:function(n){var t=$1nY(this,n,this.$Gi);this.$p.$69(t)},$Cl:function(n){this.$p.$34(n)},$7et:function(n,t){return new _d.$JO(n,t,this.$Op)},$27W:function(){_d.$1r.prototype.$27W.call(this);this.$p.$1r()},$9I3:function(n,t){this.set_$3EJ(this.$p.get_$B()?null:_nbs.NonBootStrings.l_Calendar_NoAgendaItems_Text)}};_d.$mm=function(n,t,i,r,u){_d.$mm.initializeBase(this,[n,!1,t,i,r,u])};_d.$mm.prototype={$1jx:null,get_$1L:function(){return"AgendaViewModel"},get_$1B8:function(){return 0},get_$2ju:function(){return String.format(_nbs.NonBootStrings.l_CalendarAgendaView_AT_Region_Text,this.get_$4PH())},get_$3w9:function(){return this.get_$91().$2Z(3).toLocaleUpperCase()},get_$6gH:function(){return this.get_$91().$2Z(21)},get_$9gM:function(){return this.$1jx},set_$9gM:function(n){if(this.$1jx!==n){this.$1jx=n;$3(this,"SelectedAgendaItem");this.get_$148()||this.$1h.set_$vv(n)}return n},$6ML:function(){var n=this.$1h.$9N.$3se(this.$ED);this.$27W();this.$3cb(n)},$7WX:function(){if(this.$1jx){this.$1jx=null;$3(this,"SelectedAgendaItem")}},get_$91:function(){return _d.$1r.prototype.get_$91.call(this)},set_$91:function(n){_d.$1r.prototype.set_$91.call(this,n);$45(this,"HeaderText","WatermarkText");return n},$6MM:function(){_d.$1r.prototype.$6MM.call(this);this.$6ML()},$2Gj:function(){return!1}};_d.$JO=function(n,t,i){_d.$JO.initializeBase(this,[n,t]);this.$Op=i};_d.$JO.prototype={$Op:null,get_$y:function(){return this.get_$5eA()?this.$7h:this.$2e.get_$y()},get_$1u:function(){return this.$2e.get_$1u()},get_$DS:function(){var i=this.$2e.get_$5V();var t=this.$2e.get_$y();var n=this.$2e.get_$1u();if(t.$2R(n)>0)throw Error.argumentOutOfRange("Cannot retrieve duration string. The start DateTime cannot be later than the end DateTime");i&&n.$9K(1).$4e(n.$2o(1).$4F())&&(n=n.$9K(1));var r=Math.floor((n.$5R()-t.$5R())/1e3);return _a.$7.$2vd(r)},get_$4aN:function(){return this.get_$5eA()?this.$7h.$2Z(18):this.get_$AW()?"":this.$2e.get_$y().$2Z(18)},get_$8DZ:function(){return this.$2e.get_$1u().$9K(-1).$2R(this.$7h)>=0&&!this.$2e.get_$y().$93(this.$7h)},get_$5eA:function(){return!this.$2e.get_$AW()&&this.$2e.get_$y().$2R(this.$7h)<0&&this.$2e.get_$1u().$4F().$4e(this.$7h)},get_$89c:function(){return this.$2e.get_$y().$2R(this.$7h)<=0&&!this.$2e.get_$1u().$9K(-1).$93(this.$7h)},get_$82o:function(){return!this.get_$mw()},$7uB:function(){return this.$7h.$7vL().toString()},$3gO:function(n,t){_d.$1KY.prototype.$3gO.call(this,n,t);var r=t==="Start";if(r){var i=this.get_$y().$4F();this.$2e.get_$1V4()&&(i=i.$2o(this.$2e.get_$1V4()));this.$7h=i}r||t==="End"?$JA(this,_d.$JO.$5H1):t==="CalendarItemType"?$3(this,"IsOccurrenceOrException"):t==="Sensitivity"?$3(this,"IsPrivate"):t==="Categories"&&$3(this,"HasNoCategories")}};_d.$ST=function(n){this.$JD={};this.$XN=n};function $4jT(n,t){return n.$XN?n.$XN.$4bT(t):t}function $6oJ(n,t){var i=t.$7uB();if(i in n.$JD)return n.$JD[i];var u=t.$7h.$2Z(3).toUpperCase();var r=new _cc.$S3(u,i);n.$JD[i]=r;return r}_d.$ST.prototype={$JD:null,$XN:null,get_$42g:function(){return!1},$Bj:function(){return!0},$5Pa:function(n,t){var i=$4jT(this,n);var r=$4jT(this,t);var u=!r||!!i.$7h.$93(r.$7h);var f=new _0365m.$cl($6oJ(this,i),u);if(this.$XN){this.$XN.$3oA(i);this.$XN.$3oA(r)}return f}};_d.$1r=function(n,t,i,r,u,f){this.$$d_$9K9=Function.createDelegate(this,this.$9K9);this.$$d_$7iw=Function.createDelegate(this,this.$7iw);this.$$d_$7Mi=Function.createDelegate(this,this.$7Mi);this.$$d_$9SC=Function.createDelegate(this,this.$9SC);this.$$d_$693=Function.createDelegate(this,this.$693);this.$$d_$9KT=Function.createDelegate(this,this.$9KT);this.$$d_$9id=Function.createDelegate(this,this.$9id);this.$$d_$3GB=Function.createDelegate(this,this.$3GB);this.$$d_$9BY=Function.createDelegate(this,this.$9BY);this.$$d_$69D=Function.createDelegate(this,this.$69D);this.$$d_$9Jm=Function.createDelegate(this,this.$9Jm);this.$$d_$69r=Function.createDelegate(this,this.$69r);this.$$d_$9DA=Function.createDelegate(this,this.$9DA);this.$$d_$5W0=Function.createDelegate(this,this.$5W0);this.$$d_$9ZP=Function.createDelegate(this,this.$9ZP);this.$$d_$7b1=Function.createDelegate(this,this.$7b1);this.$$d_$5TV=Function.createDelegate(this,this.$5TV);this.$$d_$5TW=Function.createDelegate(this,this.$5TW);this.$$d_$3up=Function.createDelegate(this,this.$3up);this.$$d_$7ap=Function.createDelegate(this,this.$7ap);this.$$d_$1Td=Function.createDelegate(this,this.$1Td);this.$$d_$9Rr=Function.createDelegate(this,this.$9Rr);this.$$d_$2Xg=Function.createDelegate(this,this.$2Xg);this.$$d_$5Dx=Function.createDelegate(this,this.$5Dx);this.$$d_$l2=Function.createDelegate(this,this.$l2);this.$$d_$7dD=Function.createDelegate(this,this.$7dD);this.$$d_$7dF=Function.createDelegate(this,this.$7dF);this.$$d_$7dE=Function.createDelegate(this,this.$7dE);this.$$d_$7dC=Function.createDelegate(this,this.$7dC);this.$$d_$2Xd=Function.createDelegate(this,this.$2Xd);this.$$d_$1hc=Function.createDelegate(this,this.$1hc);this.$$d_$9BK=Function.createDelegate(this,this.$9BK);this.$$d_$697=Function.createDelegate(this,this.$697);this.$$d_$9Ez=Function.createDelegate(this,this.$9Ez);this.$2WP=new _js.$Z;this.$1qB=-1;_d.$1r.initializeBase(this);var s=_a.$6.acss(_a.$0.$1k,"CalendarBaseViewModel:Init");this.$1h=f;this.$JE=i;this.$Eu=r;this.$6HJ=u;this.$1Ou=this.$1h.$C.get_$L()==="Mouse";this.$2Of=!0;this.$1Hk=t;this.$32U=!1;if(this.$1Hk){this.$1h.$9N.add_$5Mb(this.$$d_$9Ez);this.$1h.$9N.add_$2nK(this.$$d_$697)}this.$1h.$9N.add_$58j(this.$$d_$9BK);var e=this.$1h.$c.get_$1I();e.$Y("WeekStartDay",this.$$d_$1hc);e.get_$Nl().$Y("WorkDays",this.$$d_$2Xd);this.$C1=!1;var h=this;this.$2pn=new _C(this.$$d_$7dC,this.get_$1b(),this,"CanCreateItem",function(){return h.get_$59T()});var c=this;this.$5Es=new _C(this.$$d_$7dE,this.get_$1b(),this.$1h,"CanCreateItemOnCalendar",function(){return c.$1h.get_$1XP()});var l=this;this.$3kO=new _C(this.$$d_$7dF,this.get_$1b(),this,"CanCreateItem",function(){return l.get_$59T()});var a=this;this.$2po=new _C(this.$$d_$7dD,this.get_$1b(),this.$1h,"CanCreateItemOnCalendar",function(){return a.$1h.get_$1XP()});var v=this;this.$4cc=new _C(this.$$d_$l2,this.get_$1b(),this,"CanUpdateItemDetails",function(){return v.get_$7V5()});var y=this;this.$c5=new _C(this.$$d_$5Dx,this.get_$1b(),this.$1h,"CanCreateItemOnCalendar",function(){return y.$1h.get_$1XP()});var p=this;this.$Op=new _C(this.$$d_$2Xg,this.get_$1b(),this,"CanOpenItem",function(){return p.get_$2nt()});var w=this;this.$25U=new _C(this.$$d_$9Rr,this.get_$1b(),this,"CanOpenItem",function(){return w.get_$2nt()});var b=this;this.$3Mk=new _C(this.$$d_$1Td,this.get_$1b(),this,"CanSelectItem",function(){return b.get_$7Uy()});this.$pu=new _C(this.$$d_$7ap,this.get_$1b());this.$mR=new _C(this.$$d_$3up,this.get_$1b());this.$2MK=new _C(this.$$d_$5TW,this.get_$1b());this.$2MJ=new _C(this.$$d_$5TV,this.get_$1b());this.$3jp=new _C(this.$$d_$7b1,this.get_$1b());this.$4Gu=new _C(this.$$d_$9ZP,this.get_$1b());this.$2yD=new _C(this.$$d_$5W0,this.get_$1b());this.$eF=n;this.$3X=n;this.$24F={};var o=_a.$2D.$Mx(this.$eF,this.get_$1B8(),!1,this.$1h.$c.get_$1I().get_$Nl().get_$Nk());this.$Gi=$2gw(this);this.$ED=new _h.$4e(o[0],o[1]);this.$1A5=$6oc(this);this.$1h.$Y("CurrentItem",this.$$d_$9DA);this.$1h.$Y("CurrentItemModel",this.$$d_$69r);this.$1h.$Y("IsModuleSidePanelExpanded",this.$$d_$9Jm);if(this.$1h.$C.get_$L()==="Mouse"){$4js(this);this.$1h.$Y("CanCreateItemOnCalendar",this.$$d_$69D)}_a.$6.aces(s);if(this.$1h.$CS){this.$1h.$CS.get_$4Mm().add_$1Z(this.$$d_$9BY);this.$1h.$CS.get_$IS().add_$1Z(this.$$d_$3GB)}};_d.$1r.$7Tf=function(n,t){switch(n){case-1:return!1;case 0:case 1:return!0;default:return t>0}};_d.$1r.$4QN=function(n,t){for(var r,i=t.get_$B()-1;i>=0;i--){r=t.get_$3q(i);if(n.get_$F5()){if(r.get_$F5()){t.$68(i);break}}else r.get_$F5()||r.get_$i().Id!==n.get_$i().Id||t.$68(i)}};_d.$1r.$6c0=function(n){_a.$6.$1E(null,n.$2pe);_a.$6.endPT("CreateCalendarItemDefault")};_d.$1r.$9wL=function(n){_a.$6.$1E(null,n.$2pe);_a.$6.endPT("CreateAllDayCalendarItem")};function $3W0(n,t){$3W2(n,!1);n.$6a6();n.set_$3mL($2gw(n));t&&n.$6MM();$3W2(n,n.$2Od)}function $4jo(n,t,i){if(n.get_$Jx()){n.get_$Jx().$7pg(t,i);n.set_$Jx(null)}}function $3Vy(n){var t=new _d.$Vu;t.set_$3O9("Free");t.set_$QH(!1);t.set_$5V(!0);t.set_$DS(_a.$2D.$1IN(2));n.$Ab&&n.$Ab.$Fh.$2M&&t.set_$2i(n.$Ab.get_$2i());_js.$9.$a(t.get_$2i())||t.set_$2L1(!0);return t}function $6oc(n){return n.$1h.$C.get_$Er()?null:new _d.$LR}function $2gu(n,t){for(var u=0,i=0,e=t.get_$B();i<e;i++)if(_g.$Jl.isInstanceOfType(t.get_$3q(i))){var f=t.get_$3q(i);var r=f.get_$1u();var o=f.get_$y().$4F();var s=r.$93(r)?r.$4F().$9K(86399999):r.$9K(-1);var h=new _h.$4e(o,s);h.$lo(n.get_$91(),!0,!0)&&u++}return u}function $4jq(n){var t=new _d.$Vu;n.get_$91().$93(_a.$7.get_$29())?t.set_$y(_a.$2D.$2ph(n.get_$91(),n.$1h.$c.get_$1I().get_$Nl().get_$1VS())):t.set_$y(_a.$2D.$3k5(_a.$7.get_$29()));t.set_$DS(18e5);n.$1h.$Cb&&t.set_$1KW(n.$1h.$Cb.get_$A5());if(n.$Ab&&n.$Ab.$Fh.$2M){t.set_$2i(n.$Ab.get_$2i());t.set_$y(n.$Ab.get_$y())}_js.$9.$a(t.get_$2i())||t.set_$2L1(!0);return t}function $2gx(n){n.set_$3mK(n.$3sz(n.$eF))}function $6og(n,t){t.$2ol.$2l.length>0&&n.$1h.$9N.$5Qt(t.$hm)&&n.$3cb(t.$2ol.$2l)}function $6oh(n,t){t.$38.length>0&&n.$4QT(t.$38)}function $6oi(n,t){t.$38.length>0&&n.$9bt(t.$2l,t.$38)}function $1nY(n,t,i){for(var u=[],r,e,f=0,o=i.length;f<o;f++){r=i[f];e=new _h.$4e(r,r.$2o(1));e.$1OL(t)&&Array.add(u,n.$7et(t,r))}n.$24F[t.get_$i().Id]=u;return u}function $2gw(n){var t=_a.$2D.$Mx(n.get_$91(),n.get_$1B8(),!0,n.$1h.$c.get_$1I().get_$Nl().get_$Nk());Array.removeAt(t,t.length-1);return t}function $2gv(n){n.$Cl(n.$Ab);n.$Ab=null;$4jp(n)}function $4jr(n){$10k(n);if(n.$C1&&n.$1Hk){$3Vz(n);n.$1qB=n.$1h.$9N.get_$3N3()}else n.$1qB=-1}function $3Vz(n){var t=_a.$6.acss(_a.$0.$6y,"GetItems");if(!n.$1h.$CS){_a.$6.aces(t);return}n.set_$5aT(!1);n.set_$xJ(!1);n.$27W();$10k(n);n.$1h.$9N.$9cD(n.get_$1L(),n.get_$7um(),n.get_$1qN());$10k(n);_a.$6.aces(t)}function $3W1(n){n.$1Hk&&n.set_$xJ(n.$1h.$9N.get_$11U()>=1)}function $6ob(n,t,i,r){_a.$6.stPT(_a.$0.$1k,"CreateCalendarItemDefault",3);_a.$6.$1c(_a.$0.$1k,r);var u=_a.$6.acss(_a.$0.$1k,"Create ComposeCalendarItemViewModel");if(!$6(n.$Ab)){if(n.$lz){_a.$6.$1E(n.$lz);n.$lz=null}n.$Cl(n.$Ab)}var f=n.$Eu.$bC(t.$3K,null,_d.$1r.$6c0,r);_a.$6.aces(u);n.$1h.$C.$fC(f,0,i)}function $6oa(n,t){for(var i=0,r=t.get_$B();i<r;i++)t.get_$3q(i).$Y("AssignedCalendarColor",n.$$d_$693)}function $6oe(n,t){for(var i=0,r=t.get_$B();i<r;i++)t.get_$3q(i).$u("AssignedCalendarColor",n.$$d_$693)}function $4js(n){n.get_$59t()&&!n.$1mg?n.set_$6fs(n.$7fO()):!n.get_$59t()&&n.$1mg&&n.set_$6fs(null)}function $6op(n){n.$1A5&&n.$1A5.set_$xb(n.$1h.get_$97())}function $10k(n){if(n.$1Hk){n.set_$30e(n.$1h.$9N.get_$11U()===-1||n.$1h.$9N.get_$11U()===2);n.set_$5c4(_d.$1r.$7Tf(n.$1h.$9N.get_$11U(),n.$1h.$CS?n.$1h.$CS.get_$4Mm().get_$B():0))}}function $6or(n,t){if(n.$1Ou){$6oq(n,t);$3W2(n,t)}}function $6oq(n,t){n.$1Ou&&(t?n.$2Of?n.set_$33s(String.format(_nbs.NonBootStrings.l_CalendarViewLoaded_AT_LiveRegion_Text,n.get_$4PH(),n.$5R6())):n.set_$33s(String.format(_nbs.NonBootStrings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$5R6())):n.set_$33s(null))}function $3W2(n,t){n.$1Ou&&(t?n.set_$6RR(String.format(_nbs.NonBootStrings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$7uo())):n.set_$6RR(null))}function $6ok(n){var i=n.$1h.get_$97().$k5;var t=i.$m0(1,!1);if(t.$2M){t.$n();t.$1Q()}}function $6om(n){if(!n.$25V){var t=new _js.$Z;t.$D(new _a.$2G(new _C(n.$$d_$9SC,n.get_$1b()),_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_EditButton_Text,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_EditButtonDesc_Text));t.$D(new _a.$2G(n.$2yD,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_DiscardButton_Text,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_DiscardButtonDesc_Text));n.set_$9SB(t)}}function $6on(n){n.set_$325(!0)}function $6of(n){n.$1h.get_$97()&&n.$1h.get_$97().$iF()}function $6ol(n){n.$1ji=_d.$1Jb.$1k.$XF.$9rX(n.$Ab.get_$5V(),n.$Ab.$2e.get_$aH());var t=n.$JE.$8A(n.$Ab.$2e);t.$5m.add_$2m(n.$$d_$9K9);t.$5m.$9fK();$4jp(n)}function $4jp(n){n.$24M&&n.$24M.$2M&&n.$24M.$n()}function $6oj(n){if(!(n.$2WP.get_$B()>0)){n.$2WP.$D(new _a.$2G(n.$4Gu,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogContinueEditTitle_LowerCase_Text,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogContinueEditSubTitle_Text));var t=this;n.$2WP.$D(new _a.$2G(new _C(function(){n.set_$66X(!0);n.set_$31t(!1);$2gv(n)},_a.$0.$1k),_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogDiscardTitle_LowerCase_Text,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogDiscardSubTitle_Text))}}function $6oo(n,t){}function $3Vx(n,t){var i=!1;if(n.$1h.$Rj){var r=n.$1h.$Rj.$o.$t.get_$i();var u=n.$1h.get_$97()?n.$1h.get_$97().$t.get_$i():null;if(t||r!==u){n.$1h.$Rj.set_$1O(!1);i=!0}if(i&&r!==u){n.$1h.$Rj.$1Q();n.$1h.set_$6HI(null)}}else i=!0;return i}function $6oZ(n){return!!n.$1h.$C.get_$oC().get_$8t().get_$B()}function $6od(n,t){return!_h.$4e.$4N(n.$ED,n.$3sz(t))}_d.$1r.prototype={$1Hk:!0,$Eu:null,$JE:null,$6HJ:null,$1h:null,$2pn:null,$5Es:null,$3kO:null,$2po:null,$4cc:null,$c5:null,$Op:null,$25U:null,$3Mk:null,$pu:null,$mR:null,$2MK:null,$2MJ:null,$3jp:null,$2yD:null,$24F:null,$1Ou:!1,$4Gu:null,$1mg:null,$24M:null,$ED:null,$Gi:null,$eF:null,$3X:null,$2rJ:null,$C1:!1,$29F:!1,$2Od:!1,$1OB:!1,$1Cx:!1,$1y9:!1,$25V:null,$Ab:null,$1A5:null,$1Nz:!1,$32U:!1,$1Ov:null,$3MQ:null,$2Of:!1,$3Dl:!1,$31s:!1,$1D1:!1,$ld:null,$lw:null,$lz:null,$1ji:null,add_$2nH:function(n){this.$2N("CalendarColorsChanged",n)},remove_$2nH:function(n){this.$2P("CalendarColorsChanged",n)},add_$2sM:function(n){this.$2N("DisplayedDateChanging",n)},remove_$2sM:function(n){this.$2P("DisplayedDateChanging",n)},get_$6fs:function(){return this.$1mg},set_$6fs:function(n){if(this.$1mg!==n){this.$1mg=n;$3(this,"ViewContextMenuViewModel")}return n},get_$5c4:function(){return this.$1OB},set_$5c4:function(n){if(this.$1OB!==n){this.$1OB=n;$3(this,"IsLoadingItems")}return n},get_$41B:function(){return this.$1D1},set_$41B:function(n){if(n!==this.$1D1){this.$1D1=n;$3(this,"IsItemContextMenuShown")}return n},get_$31t:function(){return this.$31s},set_$31t:function(n){if(n!==this.$31s){n&&$6oj(this);this.$31s=n;$3(this,"IsNaturalInputSaveDialogShown")}return n},get_$66X:function(){return this.$3Dl},set_$66X:function(n){if(n!==this.$3Dl){this.$3Dl=n;$3(this,"NaturalInputSaveDialogShouldRestoreFocus")}return n},get_$66W:function(){return this.$24M},set_$66W:function(n){if(this.$24M!==n){this.$24M=n;$3(this,"NaturalInputExitCommand")}return n},get_$30e:function(){return this.$1Cx},set_$30e:function(n){if(this.$1Cx!==n){this.$1Cx=n;$3(this,"IsErrorLoadingItems")}return n},get_$7mA:function(){return _nbs.NonBootStrings.l_LoadingError_Text},get_$GB:function(){return this.$C1},set_$GB:function(n){if(this.$C1!==n){this.$C1=n;n?this.$3Ey():this.$69z()}return n},get_$3Ns:function(){return this.$29F},set_$3Ns:function(n){if(this.$29F!==n){this.$29F=n;n&&this.$2Gj()}return n},get_$59T:function(){return!this.$1h.$C.get_$Er()},get_$2nt:function(){return!!this.$Ab||!!this.$1h.get_$97()&&this.$1h.get_$97().$k5.get_$2nt()},get_$7Uy:function(){return this.get_$2nt()},get_$7V5:function(){return this.$1h.get_$97()?this.$1h.get_$97().$t.get_$eh():!1},get_$148:function(){return this.$1Nz},set_$148:function(n){if(this.$1Nz!==n){this.$1Nz=n;this.$698()}return n},get_$59Z:function(){return this.$1h.$C.get_$L()==="Mouse"},get_$3mK:function(){return this.$ED},set_$3mK:function(n){if($6(n))throw Error.argumentNull("DateRange");if($6(this.$ED)||!this.$ED.$4e(n)){this.$ED=n;this.set_$3mL($2gw(this));$4jr(this);$45(this,"DateRange","AccessibleName")}return n},get_$91:function(){return this.$eF},set_$91:function(n){if(!$6(n)&&!_a.$7.$4N(this.$eF,n)){var t=$6(this.$eF)||!_a.$7.$4N(this.$eF.$4F(),n.$4F());this.$eF=n;$3W0(this,t);$3(this,"VMSelectedDate")}return n},$2Gj:function(){return this.$1h.$9N.$2Gj()},$4Ur:function(n){this.$3X=n;$3(this,"DisplayedDate");this.set_$91(n)},get_$3ur:function(){return 0},get_$BJ:function(){return this.$3X},set_$BJ:function(n){if(this.$2rJ){$3(this,"DisplayedDate");return n}if(!_a.$7.$4N(this.$3X,n)){var t=this.$iW("DisplayedDateChanging");if(t&&$6od(this,n)){var i=!this.$3X||n.$2R(this.$3X)<0;this.$2rJ=n;t(i,this.$$d_$9id)}else this.$4Ur(n)}return n},get_$3mL:function(){return this.$Gi},set_$3mL:function(n){_a.$4.$J(n,"DateRangeArray cannot be null");if(!_a.$2D.$4N(this.$Gi,n)){this.$Gi=n;$3(this,"DateRangeArray")}return n},get_$3Dk:function(){return this.$Ab},set_$3Dk:function(n){if(this.$Ab!==n){this.$Ab=n;$3(this,"CanOpenItem")}return n},get_$325:function(){return this.$1y9},set_$325:function(n){if(this.$1y9!==n){this.$1y9=n;$3(this,"IsOpenUpdatedMeetingDialogShown")}return n},get_$9SB:function(){return this.$25V},set_$9SB:function(n){if(n!==this.$25V){this.$25V=n;$3(this,"OpenUpdatedMeetingDialogButtonData")}return n},get_$xJ:function(){return this.$32U},set_$xJ:function(n){if(this.$32U!==n){this.$32U=n;$3(this,"IsReadyToShowData")}return n},get_$33s:function(){return this.$1Ov},set_$33s:function(n){if(this.$1Ov!==n){this.$1Ov=n;$3(this,"ItemsLoadedNotificationMessage")}return n},get_$6RR:function(){return this.$3MQ},set_$6RR:function(n){if(this.$3MQ!==n){this.$3MQ=n;$3(this,"SelectedDateItemsLoadedNotificationMessage")}return n},get_$896:function(){return this.$2Of},set_$896:function(n){if(this.$2Of!==n){this.$2Of=n;$3(this,"IsDateInItemsLoadedNotificationMessage")}return n},get_$5aT:function(){return this.$2Od},set_$5aT:function(n){if(this.$2Od!==n){this.$2Od=n;$6or(this,n);$3(this,"IsDataProcessed")}return n},get_$4PH:function(){return this.get_$BJ().$2Z(3)},get_$Jx:function(){return this.$ld},set_$Jx:function(n){if(this.$ld!==n){this.$ld=n;$3(this,"CalendarScenarioContext")}return n},get_$7um:function(){return this.$ED},$3Ey:function(){this.$1h.$9N.add_$2nR(this.$$d_$9KT);this.set_$3Ns(!0);this.$1qB!==this.$1h.$9N.get_$3N3()&&this.$1Hk&&$3Vz(this);this.$1h.$CS&&$6oa(this,this.$1h.$CS.get_$IS());$10k(this)},$69z:function(){this.$1h.$9N.remove_$2nR(this.$$d_$9KT);this.set_$3Ns(!1);this.$1h.$CS&&$6oe(this,this.$1h.$CS.get_$IS())},get_$590:function(){return this.$JE},get_$1b:function(){return _a.$0.$1k},get_$59U:function(){return!this.$Ab&&this.$1h.get_$1XP()&&!this.get_$148()&&this.$1h.get_$88x()},get_$59t:function(){return this.$1h.get_$1XP()},$ly:function(n){if(!$6oZ(this)){$3Vx(this,!0);var t=this.$5Sa();$6ob(this,t,!1,n?n:"CreateCalendarItemDefault")}},$7dC:function(){this.$ly("CreateItemByClickNewEventButton")},$7dD:function(){this.$ly("CreateItemByClickOrTapOnSurface")},$7dE:function(){this.$ly("CreateItemByContextMenu")},$7dF:function(){this.$ly("CreateItemByHotkey")},$l2:function(){var n=_a.$6.$1c(this.get_$1b(),"UpdateItemViaDrop",!0);var i=this.$1h.get_$97().$t;if(i.get_$JW()){$6om(this);$6on(this);_a.$6.$1E(n)}else{$6oo(this,"Save");var t=this.$1h.get_$97();var r=this;t.$5m.add_$2m(function(t,i){i.$1f?n&&_a.$6.$1E(n,"UpdateItemViaDrop",_d.$1Jb.$6w.$iV(i),_d.$1Jb.$6w.$PX(i),null):n&&_a.$6.$1E(n,"UpdateItemViaDrop",null,_d.$1Jb.$6w.$PX(i),null)});t.$5m.$6I()}},$5Dx:function(){_a.$6.stPT(_a.$0.$1k,"CreateAllDayCalendarItem",3);_a.$6.$1c(_a.$0.$1k,"CreateAllDayCalendarItem");var n=_a.$6.acss(_a.$0.$1k,"ComposeCalendarItemViewModelAllDay");if(!$6(this.$Ab)){if(this.$lw){_a.$6.$1E(this.$lw);this.$lw=null}this.$Cl(this.$Ab)}var t=this.$7rD();this.$Ab&&this.$Ab.$Fh.$2M&&(this.$Ab=null);var i=this.$Eu.$bC(t.$3K,null,_d.$1r.$9wL,"CreateAllDayCalendarItem");_a.$6.aces(n);this.$1h.$C.$7X(i)},$1Td:function(){this.$1h.$C.get_$L()==="TouchNarrow"&&this.$2Xg()},$9Rr:function(){this.$2Xg("CreateItemByHotkeyEnter")},$2Xg:function(n){if(!$6(this.$Ab)&&this.$Ab.$Fh.$2M){this.$Cl(this.$Ab);if(this.$lz){_a.$6.$1E(this.$lz);this.$lz=null}if(this.$lw){_a.$6.$1E(this.$lw);this.$lw=null}this.$Ab.get_$AW()?this.$5Dx():n?this.$ly(n):this.$ly("CreateItemByClickOrTapOnSurface");return}var t=this.$1h.get_$97();if(!$6(t)&&!$6(t.$t)&&!t.get_$1OF()){$3Vx(this,!0);$6ok(this)}},$3up:function(){var n=_a.$7.get_$29().$4F();this.set_$91(new _a.$7(n.get_$3l(),n.get_$2z(),n.get_$51(),this.$eF.get_$DV(),this.$eF.get_$GJ(),this.$eF.get_$TR(),this.$eF.get_$yf()));this.$1h.$M.$9Yf(_d.$i1,new _d.$i1)},$5TW:function(){throw Error.notImplemented();},$5TV:function(){throw Error.notImplemented();},$ZZ:function(){if(this.$1h){this.$1h.set_$97(null);this.$1h.set_$vv(null)}},$7fO:function(){return this.$1h.$C.get_$Er()?null:new _0365m.$2b([new _0365m.$m(_u.Strings.l_NewString_LowerCase_Text,null,this.$c5)])},$4c:function(){if(this.$1Hk){this.$1h.$9N.remove_$5Mb(this.$$d_$9Ez);this.$1h.$9N.remove_$2nK(this.$$d_$697)}var n=this.$1h.$c.get_$1I();n.$u("WeekStartDay",this.$$d_$1hc);n.get_$Nl().$u("WorkDays",this.$$d_$2Xd);this.$1h.$9N.remove_$58j(this.$$d_$9BK);this.$1h.$u("CurrentItem",this.$$d_$9DA);this.$1h.$u("CurrentItemModel",this.$$d_$69r);this.$1h.$u("IsModuleSidePanelExpanded",this.$$d_$9Jm);this.$1h.$C.get_$L()==="Mouse"&&this.$1h.$u("CanCreateItemOnCalendar",this.$$d_$69D);if(this.$1h.$CS){this.$1h.$CS.get_$4Mm().remove_$1Z(this.$$d_$9BY);this.$1h.$CS.get_$IS().remove_$1Z(this.$$d_$3GB)}this.$c5.$1Q();this.$2po.$1Q();_a.$1.prototype.$4c.call(this)},$3sz:function(n){var t=_a.$2D.$Mx(n,this.get_$1B8(),!1,this.$1h.$c.get_$1I().get_$Nl().get_$Nk());return new _h.$4e(t[0],t[1])},$5Sa:function(){return $4jq(this)},$7rD:function(){var n=$3Vy(this);n.set_$y(_a.$2D.$2ph(this.get_$91(),this.$1h.$c.get_$1I().get_$Nl().get_$1VS()));n.set_$1KW(this.$1h.$Cb.get_$A5());return n},$6a6:function(){this.set_$BJ(this.get_$91())},$6MM:function(){$2gx(this)},$A0t:function(){$6(this.$1h.get_$97())||$6(this.$1h.get_$97().$t.get_$y())||this.$1h.get_$97().$t.get_$AW()||(this.$eF=new _a.$7(this.$eF.get_$3l(),this.$eF.get_$2z(),this.$eF.get_$51(),this.$1h.get_$97().$t.get_$y().get_$DV(),this.$1h.get_$97().$t.get_$y().get_$GJ(),0))},$9Ez:function(n,t){if(this.$C1){this.$1qB=this.$1h.$9N.get_$3N3();var i=this.$1h.$9N.$3se(this.$ED);var r=_a.$6.acss(_a.$0.$1k,"CalDataLoaded:"+this.get_$1L());this.$27W();this.$3cb(i);this.$694(n,t);$10k(this);$3W1(this);this.$1h.$9N.get_$11U()===2&&$4jo(this,"Failed to load some calendar folders",t.$1YP);_a.$6.aces(r)}},$9KT:function(n,t){var i=t.$2ol;var r=_a.$6.acss(_a.$0.$5q,"OnNotification");if(!this.$C1)throw Error.invalidOperation(String.format("[CalendarBaseViewModel: {0}] Inactive view model should not listen to cache changes.",this.get_$1L()));this.$1qB=this.$1h.$9N.get_$3N3();try{switch(i.$2v){case 0:$6og(this,t);break;case 2:$6oh(this,i);break;case 4:this.$27W();break;case 3:$6oi(this,i);break}}finally{$3W1(this);$10k(this)}_a.$6.aces(r)},$9BK:function(){_js.Trace.logInfo(this.get_$1b(),"CalendarBaseViewModel:CheckAndReloadCache, ShouldReloadCacheOnStale: {0}",this.$29F);this.$29F&&this.$2Gj()},$4QT:function(n){for(var t,r,u,i,f=0,o=n.length;f<o;++f){t=n[f];i=t.get_$i().Id;if(this.$1ka(t))if(i in this.$24F){r=this.$24F[i];for(var e=0,s=r.length;e<s;e++){u=r[e];this.$Cl(u);u.$1Q()}delete this.$24F[i]}else this.$Cl(t)}},$27W:function(){var t=this.$24F;for(var i in t)for(var u={key:i,value:t[i]},r=u.value,n=0,f=r.length;n<f;n++)r[n].$1Q()},$9bt:function(n,t){this.$4QT(n);this.$3cb(t)},$1ka:function(n){return this.$ED.$2Q.$2R(n.get_$y())<=0&&this.$ED.$3D.$2R(n.get_$y())>0||this.$ED.$3D.$2R(n.get_$1u())>=0&&this.$ED.$2Q.$2R(n.get_$1u())<0||n.get_$y().$2R(this.$ED.$2Q)<=0&&n.get_$1u().$2R(this.$ED.$3D)>=0},$7et:function(n,t){return new _d.$LU(n,t)},$68T:function(n){this.$1h.$C.get_$L()!=="Mouse"&&n!==this.$1h.$2U.get_$iB()&&this.$1h.$CS.get_$IS().$7G(this.$1h.$2U.get_$iB())||this.$1h.set_$11v(n)},$9NB:function(n){if(this.$1h.$Cb===n){var t=this.$1h.$CS.get_$IS().$71(this.$1h.$2U.get_$iB());t<0&&(t=this.$1h.$C.get_$L()==="Mouse"?0:this.$1h.$CS.get_$IS().get_$B()-1);this.$1h.set_$11v(this.$1h.$CS.get_$IS().get_$3q(t))}},$3GB:function(n,t){if(this.$C1){var i;switch(t.$2v){case 0:for(var r=0,f=t.$2l.length;r<f;r++){i=t.$2l[r];i.$Y("AssignedCalendarColor",this.$$d_$693);this.$1Hk&&this.$7sB(i);this.$68T(i)}break;case 2:for(var u=0,e=t.$38.length;u<e;u++){i=t.$38[u];i.$u("AssignedCalendarColor",this.$$d_$693);$10k(this);$3W1(this);this.$9NB(i)}break;case 3:throw Error.notImplemented();case 4:this.$1Hk&&$3Vz(this);break}}},$694:function(n,t){this.set_$5aT(!0)},$697:function(n,t){this.$1h.$9N.get_$11U()===-1&&$4jo(this,"Failed to load all calendars",t.$1YP);$10k(this)},$9i3:function(n){return n},$7Mi:function(){if(this.$lz){_a.$6.$1E(this.$lz);this.$lz=null}if(this.$lw){_a.$6.$1E(this.$lw);this.$lw=null}if(this.$Ab)if(_js.$9.$a(this.$Ab.get_$2i())){var n=null;this.$Ab&&(n=this.$Ab.get_$5V()?_a.$6.$1c(this.get_$1b(),"DiscardNaturalInputAllDayItem",!0):_a.$6.$1c(this.get_$1b(),"DiscardNaturalInputItem",!0));$2gv(this);if(n){_a.$6.$1E(n);n=null}}else{this.$Ab.$Fh.set_$5u(!1);$6ol(this)}},$7iw:function(){if(this.$lz){_a.$6.$1E(this.$lz);this.$lz=null}if(this.$lw){_a.$6.$1E(this.$lw);this.$lw=null}var n=null;this.$Ab&&(n=this.$Ab.get_$5V()?_a.$6.$1c(this.get_$1b(),"DiscardNaturalInputAllDayItem",!0):_a.$6.$1c(this.get_$1b(),"DiscardNaturalInputItem",!0));$2gv(this);if(n){_a.$6.$1E(n);n=null}},$698:function(){this.$1Nz?this.$1h.$9N.$3QX():this.$1h.$9N.$3LH();$3(this,"IsDraggingItem")},$A0P:function(){if(!this.$1h.$C.get_$Er()){var n=$3Vx(this);n&&this.$1h.get_$97()&&this.$1h.get_$97().$t.get_$1Ka()&&this.$1h.set_$6HI(this.$6HJ.$E(this.$1h.get_$97()))}},$9DA:function(n,t){if(this.$C1){$JA(this,_d.$1r.$69p);this.$A0P();this.$A0t();$6op(this)}},$69D:function(n,t){this.$C1&&$4js(this)},$7sB:function(n){var t=_a.$6.acss(_a.$0.$6y,"GetCalendarItems");this.$1h.$9N.$2aJ(this.get_$1L(),n,this.$ED,this.get_$1qN());$10k(this);_a.$6.aces(t)},$693:function(n,t){$CY(this,"CalendarColorsChanged",this,n)},$9Jm:function(n,t){this.$C1&&$3(this,"LayoutResize")},$69r:function(n,t){if(this.$C1)if(this.$1h.$Zc){var i;i=_g.$33.isInstanceOfType(this.$1h.$Zc)?this.$1h.$Zc:this.$1h.$Zc.$2e;this.$1h.get_$97()&&i===this.$1h.get_$97().$6d||this.$1h.set_$97(this.get_$590().$8A(i))}else this.$1h.set_$97(null)},$9SC:function(){var n=this.$1h.get_$97().$t;var t=new _d.$GN;t.set_$i(n.get_$i());t.set_$y(n.get_$y());t.set_$DS(n.get_$1u().$5z(n.get_$y()));t.set_$5V(n.get_$5V());var i=this.$Eu.$bC(t.$3K,null,_d.$1r.$6c0);this.$5W0();this.$1h.$C.$7X(i)},$5W0:function(){$6of(this);this.set_$325(!1)},$7b1:function(){if(this.$1h.$C.get_$L()==="Mouse"&&this.get_$59U()){this.$lw=_a.$6.$1c(this.get_$1b(),"CreateAllDayItemByNaturalInput",!0);this.$1h.set_$vv(null);var n=new _g.$1l;n.EmailAddress=this.$1h.$c.get_$31().get_$Aj();n.Name=this.$1h.$c.get_$31().get_$FS();n.MailboxType="Mailbox";var t=this.$Eu.get_$3gN().$1rL(n);t.set_$5V(!0);t.set_$9S("Free");t.set_$QH(!1);this.set_$3Dk(new _d.$nZ(this.$9i3(t),new _C(this.$$d_$7Mi,this.get_$1b()),new _C(this.$$d_$7iw,this.get_$1b())));this.$IX(this.$Ab)}},$9K9:function(n,t){if(t.$1f){this.set_$31t(!0);this.$1h.set_$vv(null);this.$1h.set_$97(null);if(this.$1ji){_a.$6.$1E(this.$1ji,null,_d.$1Jb.$6w.$iV(t),_d.$1Jb.$6w.$PX(t),null);this.$1ji=null}}else{$2gv(this);if(this.$1ji){_a.$6.$1E(this.$1ji,null,"",_d.$1Jb.$6w.$PX(t),null);this.$1ji=null}}},$9ZP:function(){this.set_$66X(!1);this.set_$31t(!1);this.$Ab.$Fh.set_$5u(!0)},$9BY:function(n,t){this.$C1&&$10k(this)},$7ap:function(){var n=this.$1h.get_$97()?this.$1h.get_$97().$6d:null;if(n){var t=_g.$8z.$5Ec(n);var i=_y.$AT.$3kD(t);_a.$Ka.$2cA(JsonParser.serialize(i.$OH()))}},$1hc:function(n,t){$2gx(this)},$2Xd:function(n,t){var r=this.$3sz(this.get_$91());if(r.$4e(this.$ED)){var i=$2gw(this);if(!_a.$2D.$4N(this.$Gi,i)){this.set_$3mL(i);$4jr(this)}}else $2gx(this)},$9id:function(){var n=this.$2rJ;this.$2rJ=null;n&&this.$4Ur(n)}};_d.$nN=function(n,t,i,r){this.$Eu=n;this.$JE=t;this.$11V=i;this.$ZT=r};_d.$nN.prototype={$Eu:null,$JE:null,$11V:null,$ZT:null,$3jo:function(n,t){return new _d.$mm(n,this.$Eu,this.$JE,this.$11V,t)},$5EB:function(n,t){return new _d.$Fr(n,this.$Eu,this.$JE,this.$11V,t)},$5Fj:function(n,t,i){return new _d.$nl(n,this.$Eu,this.$JE,this.$11V,t,i,this.$ZT)},$5Ff:function(n,t,i){return new _d.$LV(n,this.$Eu,this.$JE,this.$11V,t,i,this.$ZT)},$7fU:function(n,t){return new _d.$12V(n,this.$Eu,this.$JE,this.$11V,t)},$7eF:function(n,t,i,r,u){return new _d.$rh(n,this.$Eu,this.$JE,this.$11V,t,i,r,u)},$5F5:function(n,t,i,r){var u=_a.$6.acss(_a.$0.$1k,"CreateMonthAgendaVM");var f=new _d.$y6(this.$3jo(n,r),n,this.$Eu,this.$JE,this.$11V,i,r);_a.$6.aces(u);return f}};_d.$129=function(n,t,i){_d.$129.initializeBase(this,[_nbs.NonBootStrings.l_ChangeCalendarColorContextMenuTitle_LowerCase_Text,null,n,t,i]);this.set_$6Vs(!1);this.$558=!1;this.set_$3QF("CalendarColorPickerTemplates.ColorGridMenuItemTemplate")};_d.$nP=function(n,t){this.$$d_$9iH=Function.createDelegate(this,this.$9iH);this.$$d_$9iI=Function.createDelegate(this,this.$9iI);this.$$d_$9CO=Function.createDelegate(this,this.$9CO);_d.$nP.initializeBase(this);_a.$4.$l(n,"Need calendar entry for calendar we are managing the color for.");_a.$4.$l(t,"Error message handler must be specified.");this.$Jw=n;this.$58k=$6ox(this);this.$533=t};function $6ox(n){var t=new Array(10);t[0]=new _d.$UB(_nbs.NonBootStrings.l_AutomaticCalendarColorContextMenuTitle_LowerCase_Text,null,-1,"CalendarColorPickerTemplates.AutomaticColorMenuItemTemplate");for(var i=0;i<9;i++)t[i+1]=new _d.$UB(_g.$hw.toString(i).toLocaleLowerCase(),null,i,"CalendarColorPickerTemplates.ColorMenuItemTemplate");n.$5kV=new _d.$129(n.$$d_$9CO,t,t[n.$Jw.get_$bv()+1]);return t}_d.$nP.prototype={$Jw:null,$58k:null,$533:null,$5kV:null,$JV:!1,$Iy:null,get_$1wt:function(){return this.$JV},set_$1wt:function(n){if(this.$JV!==n){this.$JV=n;$3(this,"IsActionPending")}return n},$9CO:function(n){if(!this.$JV){var t=n;if(this.$Jw.get_$rC()){this.$Jw.set_$1K6(t);this.$Jw.set_$bv(t);return}this.$Iy=_a.$6.$1c(_a.$0.$1k,"SetCalendarColor",!0);var i=new _c.$zw(this.$Jw,t);i.add_$1x(this.$$d_$9iI);i.add_$2m(this.$$d_$9iH);this.set_$1wt(!0);OwaApplication.$1W.$z(i)}},$9iI:function(n){this.$58k[this.$Jw.get_$bv()+1].$4Tp();if(this.$Iy){_a.$6.$1E(this.$Iy,"SetCalendarColor",_d.$1Jb.$6w.$iV(n),_d.$1Jb.$6w.$PX(n),null);this.$Iy=null}this.$533(n.get_$cH())},$9iH:function(n){this.set_$1wt(!1);if(this.$Iy){_a.$6.$1E(this.$Iy,"SetCalendarColor",null,_d.$1Jb.$6w.$PX(n),null);this.$Iy=null}}};_d.$12A=function(){_d.$12A.initializeBase(this)};_d.$12A.prototype={$7Nk:function(n){for(var t=0,i=this.$p.length;t<i;t++)if(_cc.$7L.$vU(this.$p[t],n)>0){Array.insert(this.$p,t,n);return}Array.add(this.$p,n)}};_d.$JS=function(){this.$p=new _js.$Z};_d.$JS.$9dG=function(n,t){for(var i=0,r=t.length;i<r;i++)_d.$JS.$6OZ(n,t[i]);return n};_d.$JS.$6OZ=function(n,t){_a.$4.$J(n,"source");_a.$4.$J(t,"item");var i=_d.$JS.$5Py(n,t);var o=i.length;if(o){for(var r=i[0],u,f=1;f<o;f++){u=i[f].$p;for(var e=0,c=u.length;e<c;e++)r.$D(u[e])}r.$D(t);var h=n.$71(r);n.$V3(h,i.length);n.$72(h,r)}else{var s=new _d.$12A;s.$D(t);_d.$JS.$3cX(n,s)}};_d.$JS.$3cX=function(n,t){for(var i=0,r=n.get_$B();i<r;i++){var u=n.get_$3q(i);if(t.$6r.$2R(u.$6r)<0){n.$72(i,t);return}}n.$D(t)};_d.$JS.$5Py=function(n,t){for(var e=[],i,r,u,f=0,o=n.get_$B();f<o;f++){i=n.get_$3q(f);r=i.$6r;u=t.get_$1u();if(t.get_$y().$2R(i.$8B)<0&&u.$2R(r)>0)Array.add(e,i);else if(u.$2R(r)<=0)break}return e};function $6p0(n,t){for(var i,r=0,u=n.$p.get_$B();r<u;r++){i=n.$p.get_$3q(r);if(i.$6r.$2R(t.get_$y())<=0&&i.$8B.$2R(t.get_$1u())>=0)return i}return null}_d.$JS.prototype={$p:null,$D:function(n){_a.$4.$J(n,"item");_d.$JS.$6OZ(this.$p,n)},$34:function(n){_a.$4.$J(n,"item");var t=$6p0(this,n);if(!t){_js.Trace.logError(_a.$0.$6y,"Could not find conflict group for item: {0}",_d.$EX.$1BZ(n));return!1}if(!t.$34(n)){_js.Trace.logError(_a.$0.$6y,"Failed to remove item from conflict group. Item: {0}",_d.$EX.$1BZ(n));return!1}var i=this.$p.$71(t);if(i===-1||i>this.$p.get_$B()){_js.Trace.logError(_a.$0.$6y,"Unable to find index of item's conflict group for item: {0}",_d.$EX.$1BZ(n));return!1}this.$p.$68(i);for(var u=_d.$JS.$9dG(new _js.$Z,t.$p),r=u.get_$B()-1;r>=0;r--)this.$p.$72(i,u.get_$3q(r));return!0},$3oj:function(){for(var t=this.$p.get_$B(),i=new Sys.StringBuilder(String.format("\nConflict resolver conflict groups: {0}\n",t)),n=0;n<t;n++){var r=this.$p.get_$3q(n);i.append(r.$3oj())}return i.toString()}};_d.$Ht=function(n,t,i,r,u,f,e,o,s){this.$$d_$9L9=Function.createDelegate(this,this.$9L9);_d.$Ht.initializeBase(this);_a.$4.$J(f,"owaShell");_a.$4.$J(e,"userConfiguration");this.$C=f;this.$c=e;this.$M=s;this.$Tn=t;this.$CS=n;this.$9N=i;this.$2U=r;this.$2Gd=u;this.$4aO=o;this.$C.get_$L()==="Mouse"&&(this.$xD=e.get_$5M().get_$2nV())};function $6p2(n){if($6p1(n)&&n.$4aO){var t=this;n.$4aO.$E(function(t){n.set_$5GO(t)})}else n.set_$5GO(null)}function $6p1(n){if(n.$C.get_$L()==="TouchNarrow")return!1;var t=n.$Cb;return t?t.get_$Xs():!1}_d.$Ht.prototype={$CS:null,$Tn:null,$9N:null,$2U:null,$C:null,$c:null,$2J:null,$Rj:null,$Zc:null,$Cb:null,$2Hv:null,$2Gd:null,$M:null,$4aO:null,$xD:!1,$3PC:!1,$2dC:0,$1lM:!1,$2qW:null,get_$97:function(){return this.$2J},set_$97:function(n){if(this.$2J!==n){this.$2J=n;this.$C.get_$Er()||this.$C.get_$L()!=="Mouse"||!this.$2J||this.$2J.get_$1OF()?this.set_$5G1(null):this.set_$5G1(new _d.$5e(this.$2J,this.$2Gd));$3(this,"CurrentItem")}return n},get_$5GO:function(){return this.$2qW},set_$5GO:function(n){if(this.$2qW!==n){this.$2qW=n;$3(this,"CurrentTimeline")}return n},get_$vv:function(){return this.$Zc},set_$vv:function(n){if(this.$Zc!==n){this.$Zc=n;this.$Zc&&this.$C.get_$L()==="Mouse"&&this.set_$11v(this.$Zc.get_$5k());$3(this,"CurrentItemModel")}return n},get_$5G1:function(){return this.$2Hv},set_$5G1:function(n){if(this.$2Hv!==n){this.$2Hv=n;$3(this,"CurrentItemContextMenuViewModel")}return n},get_$11v:function(){return this.$Cb},set_$11v:function(n){if(n!==this.$Cb){this.$Cb=n;$6p2(this);$45(this,"CurrentCalendarModel","CanCreateItemOnCalendar")}return n},get_$1D9:function(){return this.$xD},set_$1D9:function(n){if(this.$xD!==n){this.$xD=n;$3(this,"IsModuleSidePanelExpanded")}return n},get_$6XV:function(){return this.$3PC},set_$6XV:function(n){if(this.$3PC!==n){this.$3PC=n;$3(this,"SidePanelItemsLoadedNotificationEnabled")}return n},get_$3PD:function(){return this.$2dC},set_$3PD:function(n){if(this.$2dC!==n){this.$2dC=n;$3(this,"SidePanelMonthPickerCount")}return n},get_$88x:function(){if(!this.$Cb)return!1;var n=this.$2U.$wW(this.$Cb.get_$A5());return this.$9N.$5Qt(n.get_$r())},get_$1XP:function(){if($6(this.$Cb))return!1;var n=this.$2U.$wW(this.$Cb.get_$A5());return!this.$C.get_$Er()&&!!n&&n.$2no(this.$Cb)},get_$6HI:function(){return this.$Rj},set_$6HI:function(n){if(this.$Rj!==n){this.$Rj&&this.$Rj.$u("IsShown",this.$$d_$9L9);this.$Rj=n;this.$Rj&&this.$Rj.$Y("IsShown",this.$$d_$9L9);$3(this,"PeekViewModel")}return n},$9L9:function(n,t){this.$1lM=!!(this.$1lM|!!this.$Rj)}};_d.$7K=function(){this.$$d_$9Bg=Function.createDelegate(this,this.$9Bg);this.$2Qr=_a.$7.get_$29();_d.$7K.initializeBase(this)};function $4jv(n){if(!n.$le){n.$2Qr=_a.$7.get_$29();n.$le=_js.$J.get_$I().$oE(_a.$0.$1k,"CalendarDateTimeNotification",n.$$d_$9Bg,_d.$7K.$5GQ)}}function $4ju(n){n.$le&&(n.$le=_js.$J.get_$I().$4z(n.$le))}_d.$7K.prototype={$le:null,$2nb:0,add_$59E:function(n){this.$2N("CalendarTimeChanged",n);++this.$2nb==1&&$4jv(this)},remove_$59E:function(n){this.$2P("CalendarTimeChanged",n);--this.$2nb||$4ju(this)},add_$2G3:function(n){this.$2N("CalendarDateChanged",n);++this.$2nb==1&&$4jv(this)},remove_$2G3:function(n){this.$2P("CalendarDateChanged",n);--this.$2nb||$4ju(this)},$9Bg:function(){var n=_a.$7.get_$29();var t=!!this.$2Qr.$93(n);this.$2Qr=n;$CY(this,"CalendarTimeChanged",this,n);t&&$CY(this,"CalendarDateChanged",this,n)}};_d.$Fr=function(n,t,i,r,u){this.$$d_$68Z=Function.createDelegate(this,this.$68Z);this.$$d_$9Pp=Function.createDelegate(this,this.$9Pp);_d.$Fr.initializeBase(this,[n,t,i,r,u]);var f=_a.$6.acss(_a.$0.$1k,"CalendarDayViewModel:Init");this.set_$91(n);this.$nA=new _0365m.$m(_nbs.NonBootStrings.l_SplitLabel_Caps_Text,_d.$3.get_$6YT(),new _C(this.$$d_$9Pp,this.get_$1b()),!1,null,null,null,_d.$3.get_$6YW());this.$3gF=new _d.$Fp([this.get_$91()],this.$CZ,this.$1h.$CS.get_$IS(),u.$2U,this.$1h.$c);_a.$6.aces(f)};function $6p3(n){if(!$6(n.$1IU)){n.$1IU.$1r();for(var i=Math.min(2,n.$CZ.get_$B()),t=0;t<i;t++)n.$1IU.$D(n.$CZ.get_$3q(t));$45(n,"CanShowInAgenda","ShowInAgendaItems")}}_d.$Fr.prototype={$1IU:null,$3gF:null,$R7:!1,$1kq:null,$nA:null,get_$1B8:function(){return 0},get_$1L:function(){return"CalendarDayViewModel"},get_$1qN:function(){return 1},get_$6bo:function(){return this.$1h.$C.get_$L()!=="TouchNarrow"?null:this.$1kq?this.$1IU:this.$CZ},get_$32z:function(){return this.$R7},set_$32z:function(n){if(this.$R7!==n){this.$R7=n;var t=[this.get_$91()];if(this.$R7){this.$3gF.set_$bG(t);this.set_$3lJ(this.$3gF);this.$nA.set_$1P(_nbs.NonBootStrings.l_MergeLabel_Caps_Text);this.$nA.set_$CJ(_d.$3.get_$8JL());this.$nA.set_$JT(_d.$3.get_$8JR())}else{this.$1B6.set_$bG(t);this.set_$3lJ(this.$1B6);this.$nA.set_$1P(_nbs.NonBootStrings.l_SplitLabel_Caps_Text);this.$nA.set_$CJ(_d.$3.get_$6YT());this.$nA.set_$JT(_d.$3.get_$6YW())}$45(this,"IsSideBySideMode","CanDimItems")}return n},get_$59Z:function(){return!this.$R7&&_d.$1r.prototype.get_$59Z.call(this)},get_$3hL:function(){return this.$1h.$CS.get_$IS().get_$B()>1},get_$59u:function(){return!$6(this.$1IU)&&this.$CZ.get_$B()>this.$1IU.get_$B()},get_$9oP:function(){return this.get_$59u()?String.format(_nbs.NonBootStrings.l_Calendar_ShowInAgendaLabel_Text,this.$CZ.get_$B()-this.$1IU.get_$B()):""},get_$9oO:function(){return this.$1kq},set_$9oO:function(n){if(this.$1kq!==n){this.$1kq=n;if(this.$1kq){this.$1IU=new _0365f.$Fd(_cc.$7L.$vU);this.$CZ.add_$1Z(this.$$d_$68Z)}else{this.$1IU=null;this.$CZ.remove_$1Z(this.$$d_$68Z)}$3(this,"ShowInAgendaCommand")}return n},get_$2ju:function(){return String.format(_nbs.NonBootStrings.l_CalendarDayView_AT_Region_Text,this.get_$4PH())},$5TW:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"DayView_GoPrev",!0,!0));this.set_$BJ(this.get_$BJ().$2o(-1))},$5TV:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"DayView_GoNext",!0,!0));this.set_$BJ(this.get_$BJ().$2o(1))},$2vZ:function(n){return this.$R7?$2Cb(this,this.get_$91(),n,0):_d.$7x.prototype.$2vZ.call(this,n)},$5Sa:function(){if(!this.$R7)return _d.$7x.prototype.$5Sa.call(this);var n=$4jq(this);if(this.$Ab&&this.$Ab.$Fh.$2M){n.set_$y(this.$Ab.get_$y());n.set_$DS(this.$Ab.get_$1u().$5z(this.$Ab.get_$y()));this.$Cl(this.$Ab);this.set_$3Dk(null)}else{if(this.$PZ){n.set_$y($2gz(this,this.get_$91(),this.$PZ.$LU));var t=this.$1h.$CS.get_$IS().get_$3q(this.$PZ.$LU.$JH);t&&n.set_$1KW(t.get_$A5());this.set_$2MN(null)}n.set_$DS(_a.$2D.$1IN(this.$1CL));n.set_$1KW(this.$1h.$Cb.get_$A5())}return n},$7rD:function(){if(this.$R7){var n=$3Vy(this);n.set_$y(_a.$2D.$2ph(this.get_$91(),this.$1h.$c.get_$1I().get_$Nl().get_$1VS()));if(this.$Xg){var t=this.$1h.$CS.get_$IS().get_$3q(this.$Xg.$LU.$JH);t&&n.set_$1KW(t.get_$A5())}return n}else return _d.$7x.prototype.$7rD.call(this)},$6Tx:function(n){if(!this.$R7)return _d.$7x.prototype.$6Tx.call(this,n);n.set_$y($2gz(this,this.get_$91(),this.$PZ.$LU));n.set_$1u($2gz(this,this.get_$91(),this.$PZ.$1kD).$9K(_a.$2D.$1IN(this.$1CL)));n.set_$5k(this.$1h.$CS.get_$IS().get_$3q(this.$PZ.$LU.$JH));return n},$9i3:function(n){if(!this.$R7)return _d.$7x.prototype.$9i3.call(this,n);n.set_$y(this.get_$91());n.set_$1u(this.get_$91());n.set_$5k(this.$1h.$CS.get_$IS().get_$3q(this.$Xg.$LU.$JH));return n},$68T:function(n){if(this.$1h.$C.get_$L()==="TouchNarrow")_d.$1r.prototype.$68T.call(this,n);else if(!this.$R7){this.$1h.set_$11v(n);this.$1h.$CS.get_$IS().get_$B()===2&&this.set_$32z(!0)}},$3GB:function(n,t){if(this.$C1){_d.$1r.prototype.$3GB.call(this,n,t);this.$nA.set_$q(!this.get_$3hL());this.set_$32z(this.$R7&&this.get_$3hL())}},$68Z:function(n,t){$6p3(this)},$9Pp:function(){this.set_$32z(!this.$R7)}};_d.$7x=function(n,t,i,r,u){this.$$d_$69y=Function.createDelegate(this,this.$69y);this.$$d_$9Ga=Function.createDelegate(this,this.$9Ga);this.$$d_$99f=Function.createDelegate(this,this.$99f);this.$$d_$9GW=Function.createDelegate(this,this.$9GW);this.$$d_$7di=Function.createDelegate(this,this.$7di);_d.$7x.initializeBase(this,[n,!0,i,t,r,u]);var f=_a.$6.acss(_a.$0.$1k,"CalendarDayWeekBaseVM:Init");this.$CZ=new _0365f.$Fd(_cc.$7L.$vU);this.$p=new _js.$Z;this.$3ka=new _C(this.$$d_$7di,this.get_$1b());this.$4Jn=new _C(this.$$d_$9GW,this.get_$1b());this.$4Ig=new _C(this.$$d_$99f,this.get_$1b());this.$6BB=new _C(this.$$d_$9Ga,this.get_$1b());this.$1h.$C.get_$L()==="Mouse"&&$4jx(this);this.$1CL=$6p5(this);this.$1B6=new _d.$HD(this.$Gi,this.$CZ,this.$1h,u.$2U,this.$1h.$c);this.$O8=this.$1B6;this.$Y("DateRangeArray",this.$$d_$69y);_a.$6.aces(f)};function $2Ca(n,t,i){return $2Cb(n,null,t,i)}function $2gz(n,t,i){return $2Cb(n,t,i,0)}function $2Cb(n,t,i,r){t||(t=n.$1B6.get_$bG()[i.$JH]);$6(r)&&(r=0);var u=36e5/_a.$2D.$1IN(n.$1CL);var f=60/u;var e=Math.floor((i.$TO+r)/u);var o=(i.$TO+r)%u*f;return new _a.$7(t.get_$3l(),t.get_$2z(),t.get_$51(),e,o,0)}function $6p5(n){if(n.$1h.$C.get_$L()==="TouchNarrow")return 3;if(n.$1h.$C.get_$L()==="TouchWide")return 2;switch(n.$1h.$c.get_$1I().get_$qv()){case 15:return 1;case 30:return 2}return 3}function $6p4(n){return n.$1h.$C.get_$Er()?null:new _0365m.$2b([new _0365m.$m(_u.Strings.l_NewString_LowerCase_Text,null,n.$c5)])}function $4jw(n,t){_js.Trace.logInfo(n.get_$1b(),"Ignoring click on the grid: {0}",n.$1h.$1lM);n.$1h.$1lM?n.$1h.$1lM=!1:t.$2M&&t.$n()}function $4jx(n){n.$1h.get_$1XP()&&!n.$1ox?n.set_$552($6p4(n)):!n.$1h.get_$1XP()&&n.$1ox&&n.set_$552(null)}_d.$7x.prototype={$3ka:null,$4Jn:null,$4Ig:null,$6BB:null,$1B6:null,$O8:null,$1ox:null,$1CL:0,$CZ:null,$p:null,$xT:!1,$PZ:null,$1CK:null,$Xg:null,$2zj:!1,get_$883:function(){return this.$2zj},set_$883:function(n){if(n!==this.$2zj){this.$2zj=n;$3(this,"IsAllDayItemContextMenuShown")}return n},get_$fn:function(){return this.$xT},set_$fn:function(n){if(this.$xT!==n){this.$xT=n;$3(this,"IsUpdatingItems")}return n},get_$3lJ:function(){return this.$O8},set_$3lJ:function(n){if(this.$O8!==n){this.$O8=n;$3(this,"CurrentColumnProviderViewModel")}return n},get_$552:function(){return this.$1ox},set_$552:function(n){if(this.$1ox!==n){this.$1ox=n;$3(this,"AllDayWellContextMenuViewModel")}return n},get_$wf:function(){return this.$1h.$C.get_$L()==="Mouse"?54:this.$1h.$C.get_$L()==="TouchWide"?60:52},get_$5Tc:function(){return this.$1CL===2?this.get_$wf()/2:this.$1CL===1?this.get_$wf()/4:this.get_$wf()},get_$3ur:function(){return this.$1h.$C.get_$L()==="TouchNarrow"?50:this.$1h.$C.get_$L()==="TouchWide"?63:58},get_$7zo:function(){return $6(this.$PZ)?null:this.$2vZ(this.$PZ.$LU)},get_$7zm:function(){return $6(this.$Xg)?null:this.$2vZ(this.$Xg.$LU)},get_$6gj:function(){return this.$1h.$c.get_$1I().get_$Nl().get_$1VS()},get_$2MN:function(){return this.$PZ},set_$2MN:function(n){if(this.$PZ!==n){this.$PZ=n;_d.$Fp.isInstanceOfType(this.$O8)&&this.$1h.$CS&&this.$PZ&&this.$1h.set_$11v(this.$1h.$CS.get_$IS().get_$3q(this.$PZ.$LU.$JH));$3(this,"GridSelectedRowColumnIndex")}return n},get_$5Tb:function(){return this.$1CK},set_$5Tb:function(n){if(this.$1CK!==n){this.$1CK=n;$3(this,"GridHoveredRowColumnIndex")}return n},get_$2wm:function(){return this.$Xg},set_$2wm:function(n){if(n&&n.$4e(this.$Xg))return n;this.$Xg=n;_d.$Fp.isInstanceOfType(this.$O8)&&this.$1h.$CS&&this.$Xg&&this.$1h.set_$11v(this.$1h.$CS.get_$IS().get_$3q(this.$Xg.$LU.$JH));$3(this,"GridAllDaySelectedRowColumnIndex");return n},$5R6:function(){return this.$p.get_$B()+this.$CZ.get_$B()},$7uo:function(){return $2gu(this,this.$p)+$2gu(this,this.$CZ)},$2vZ:function(n){return $2Cb(this,this.$1B6.get_$bG()[n.$JH],n,0)},$3cb:function(n){var u=n.length;var e=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:AddItems_"+u);this.set_$fn(!0);for(var f=[],i=[],t,r=0;r<u;r++){t=n[r];this.$1ka(t)&&(t.get_$AW()?Array.add(f,t):t.get_$y().$4F().$2R(t.get_$1u().$4F())?Array.addRange(i,$1nY(this,t,this.$Gi)):Array.add(i,t))}this.$CZ.$69(f);this.$p.$69(i);this.set_$fn(!1);_a.$6.aces(e)},$IX:function(n){var t=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:AddItem");n.get_$AW()?this.$CZ.$D(n):n.get_$y().$4F().$2R(n.get_$1u().$4F())?this.$p.$69($1nY(this,n,this.$Gi)):this.$p.$D(n);_a.$6.aces(t)},$Cl:function(n){var t=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:RemoveItem");var i=n===this.$Ab&&!n.$2e.get_$5V();n.get_$AW()&&!i?_d.$1r.$4QN(n,this.$CZ):_d.$1r.$4QN(n,this.$p);_a.$6.aces(t)},$27W:function(){this.set_$fn(!0);this.$CZ.$1r();this.$p.$1r();_d.$1r.prototype.$27W.call(this);this.set_$fn(!1)},$7fO:function(){return this.$1h.$C.get_$Er()?null:new _0365m.$2b([new _0365m.$m(_u.Strings.l_NewString_LowerCase_Text,null,this.$5Es)])},$69D:function(n,t){_d.$1r.prototype.$69D.call(this,n,t);$4jx(this)},$5Sa:function(){var n=_d.$1r.prototype.$5Sa.call(this);if(!$6(this.$Ab)&&this.$Ab.$Fh.$2M){n.set_$DS(this.$Ab.get_$1u().$5z(this.$Ab.get_$y()));this.$Cl(this.$Ab);this.set_$3Dk(null)}else{if(!$6(this.$PZ)){n.set_$y($2Ca(this,this.$PZ.$LU));this.set_$2MN(null)}n.set_$DS(_a.$2D.$1IN(this.$1CL))}return n},$7rD:function(){var n=$3Vy(this);var t=this.get_$91();$6(this.$Xg)||this.$Xg.$LU.$JH>=0&&this.$Xg.$LU.$JH<this.$1B6.get_$bG().length&&(t=this.$1B6.get_$bG()[this.$Xg.$LU.$JH]);this.$1h&&this.$1h.$Cb&&n.set_$1KW(this.$1h.$Cb.get_$A5());n.set_$y(_a.$2D.$2ph(t,this.$1h.$c.get_$1I().get_$Nl().get_$1VS()));return n},$9i3:function(n){var t=this.$1B6.get_$bG()[this.$Xg.$LU.$JH];n.set_$y(t);n.set_$1u(t);n.set_$5k(this.$1h.$Cb);return n},$6Tx:function(n){n.set_$y($2Ca(this,this.$PZ.$LU));n.set_$1u($2Ca(this,this.$PZ.$1kD,1));n.set_$5k(this.$1h.$Cb);return n},$7uA:function(){return this.$1h.$C.get_$L()==="Mouse"?this.$3ka:this.$2po},$7rC:function(){return this.$1h.$C.get_$L()==="Mouse"?this.$3jp:this.$c5},$69y:function(n,t){this.$O8&&this.$O8.set_$bG(this.$Gi);this.set_$2wm(null);this.set_$2MN(null)},$9GW:function(){$4jw(this,this.$7uA())},$99f:function(){$4jw(this,this.$7rC())},$9Ga:function(){var n;(n=this.$1h).$1lM=!!(n.$1lM|this.$1h.$xD)},$7di:function(){if(this.get_$59U()){this.$lz=_a.$6.$1c(this.get_$1b(),"CreateItemByNaturalInput",!0);this.$1h.set_$vv(null);var n=new _g.$1l;n.EmailAddress=this.$1h.$c.get_$31().get_$Aj();n.Name=this.$1h.$c.get_$31().get_$FS();n.MailboxType="Mailbox";var t=this.$Eu.get_$3gN().$1rL(n);this.set_$3Dk(new _d.$nZ(this.$6Tx(t),new _C(this.$$d_$7Mi,this.get_$1b()),new _C(this.$$d_$7iw,this.get_$1b())));this.$p.$D(this.$Ab)}}};_d.$QL=function(){};_d.$Fs=function(){};_d.$nV=function(n,t,i,r){this.$56=n;this.$eg=t;this.$2U=i;this.$C=r};_d.$nV.prototype={$56:null,$eg:null,$2U:null,$C:null,$E:function(n,t){return n.get_$ql()===1?new _d.$na(n,t,this.$56,t.$XA,this.$eg,this,this.$2U,this.$C):new _d.$AJ(n,t,this.$56,t.$XA,this.$eg,this.$2U,this.$C)},$7ei:function(n){return new _d.$i3(this.$2U.get_$1HO(),this.$56,n,this.$eg,this.$2U,this.$C)}};_d.$JT=function(n,t,i,r,u,f){this.$$d_$9Bb=Function.createDelegate(this,this.$9Bb);_d.$JT.initializeBase(this,[i,u]);this.$C=f;this.$56=t;this.$BM=n;this.$UC=n.get_$Vr();this.$BM.get_$Cp().add_$1Z(this.$$d_$9Bb);this.set_$qC(!0);this.set_$CW(1);this.$eg=r};_d.$JT.prototype={$BM:null,$eg:null,$56:null,$C:null,$UC:null,get_$9wj:function(){return"NavigationTreeTemplates.CalendarGroupTreeNodeView"},get_$Vr:function(){return this.$UC},set_$Vr:function(n){if(n!==this.$UC){this.$UC=n;this.$BM.set_$Vr(n);$45(this,"GroupName","GroupNameInUpperCase")}return n},get_$7zw:function(){return this.$UC?this.$UC.toUpperCase():this.$UC},get_$6ez:function(){return this.$C.get_$L()==="TouchNarrow"},$964:function(n,t){if(n.$Di!==this){_d.$JT.$2AN=!0;try{var i=n.$Di;n.set_$6Gl(this);this.$BM.get_$Cp().$72(t,n.$CE);this.$5YC(t,n);i.$BM.get_$Cp().$34(n.$CE);i.$S.$34(n)}finally{_d.$JT.$2AN=!1}}},$5YC:function(n,t){this.$S.$72(n,t)},$4c:function(){this.$BM.get_$Cp().remove_$1Z(this.$$d_$9Bb);_d.$nc.prototype.$4c.call(this)},$85S:function(n){n.set_$2O(this.$56.$3zc(n.$CE));n.set_$qC(!this.$56.get_$2GV())},$9Bb:function(n,t){if(!_d.$JT.$2AN)switch(t.$2v){case 0:for(var r=0,o=t.$2l.length;r<o;r++){var s=t.$2l[r];var e=this.$eg.$E(s,this);this.$85S(e);this.$5YC(t.$4V+r,e)}break;case 2:for(var f=0,h=t.$38.length;f<h;f++)for(var c=t.$38[f],u=0,l=this.$S.get_$B();u<l;u++){var i=this.$S.get_$3q(u);if(i.$CE&&i.$CE.$4e(c)){i.$2tC&&i.set_$2O(!1);this.$S.$68(u);i.$1Q();break}}break;default:break}}};_d.$AJ=function(n,t,i,r,u,f,e){this.$$d_$7he=Function.createDelegate(this,this.$7he);this.$$d_$7hf=Function.createDelegate(this,this.$7hf);this.$$d_$7hF=Function.createDelegate(this,this.$7hF);this.$$d_$9Cw=Function.createDelegate(this,this.$9Cw);this.$$d_$9Cx=Function.createDelegate(this,this.$9Cx);this.$$d_$9be=Function.createDelegate(this,this.$9be);this.$$d_$9Xq=Function.createDelegate(this,this.$9Xq);this.$$d_$86H=Function.createDelegate(this,this.$86H);this.$$d_$6F2=Function.createDelegate(this,this.$6F2);this.$$d_$865=Function.createDelegate(this,this.$865);this.$$d_$7UK=Function.createDelegate(this,this.$7UK);this.$$d_$3KZ=Function.createDelegate(this,this.$3KZ);this.$$d_$2pc=Function.createDelegate(this,this.$2pc);this.$$d_$9Bc=Function.createDelegate(this,this.$9Bc);_d.$AJ.initializeBase(this,[n,i,r,u,f,e]);this.$2af=t;n.get_$Cp().$Y("Count",this.$$d_$9Bc);this.set_$1LL(new _C(this.$$d_$2pc,_d.$AJ.$A));this.set_$1Sn(new _C(this.$$d_$3KZ,_d.$AJ.$A));this.set_$2nl(new _C(this.$$d_$7UK,_d.$AJ.$A));var o=new _C(this.$$d_$865,_d.$AJ.$A);this.$3Ga=new _C(this.$$d_$6F2,_d.$AJ.$A);this.$3y4=new _C(this.$$d_$86H,_d.$AJ.$A);this.$3mz=new _C(this.$$d_$9Xq,_d.$AJ.$A);$4k1(this);e.get_$Er()||this.get_$6ez()||_cc.$1Q.$1cW(n)||(this.$8Z=new _0365m.$2b([new _0365m.$m(_nbs.NonBootStrings.l_CreateCalendarContextMenuTitle_LowerCase_Text,null,o),new _0365m.$m(_nbs.NonBootStrings.l_OpenCalendarContextMenuTitle_LowerCase_Text,null,this.$3Ga),new _0365m.$9y,new _0365m.$m(_nbs.NonBootStrings.l_CreateCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$2af.$5Xj),new _0365m.$m(_nbs.NonBootStrings.l_RenameCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$3y4),new _0365m.$m(_nbs.NonBootStrings.l_DeleteCalendarGroupContextMenuTitle_LowerCase_Text,null,this.$3mz)]))};function $4k1(n){n.$3y4.set_$5u(n.$BM.get_$ql()===3);n.$3mz.set_$5u(n.$BM.get_$ql()===3&&!n.$BM.get_$Cp().get_$B())}function $3W3(n){n.set_$UI(!1);n.set_$CW(2)}function $6p7(n){if(!n.$2U.$14R){n.$2U.$3my(n.$BM,n.$$d_$7hf,n.$$d_$7he);n.$2It=n.$2af.$S.$71(n);n.$2It>=0&&n.$2af.$S.$68(n.$2It)}}_d.$AJ.prototype={$3y4:null,$3mz:null,$3Ga:null,$yq:null,$2af:null,$2It:0,$1iY:null,$4c:function(){this.$BM.get_$Cp().$u("Count",this.$$d_$9Bc);_d.$JT.prototype.$4c.call(this)},$9Bc:function(n,t){$4k1(this)},$86H:function(){if(!this.$2U.$14R){this.$1iY=this.$UC;this.set_$24T(this);this.set_$UI(!0);this.set_$CW(4)}},$7UK:function(){this.set_$UI(!1);this.set_$Vr(this.$1iY);this.$1iY=null;this.set_$CW(2)},$3KZ:function(){if(_js.$9.$18(this.$UC)){this.set_$Vr(this.$1iY);this.$1iY=null;$3W3(this);return}if(this.$UC.trim()===this.$BM.get_$Vr()){$3W3(this);return}this.$2U.$3KZ(this.$BM,this.$UC,null,this.$$d_$9be);$3W3(this)},$9be:function(n){this.set_$Vr(this.$1iY);this.$1iY=null;this.$1Hp(n.get_$cH())},$6F2:function(){this.$XA.$9S9(this.$BM)},$865:function(){if(!this.$2U.$14R){var n=this.$eg.$E(this.$2U.$7bN(),this);n.set_$UI(!0);n.set_$qC(!0);this.set_$24T(this.$yq=n);this.set_$CW(3)}},$2pc:function(){if(_js.$9.$18(this.$yq.$hn)){this.$yq.$1Q();this.$yq=null;return}this.$yq.set_$UI(!1);this.$yq.set_$CW(2);this.$2U.$2pc(this.$BM,this.$yq.$CE,null,this.$$d_$9Cx,this.$$d_$9Cw);this.$S.$D(this.$yq)},$9Cx:function(n,t){_js.Trace.logInfo(_d.$AJ.$A,"Failed to create a calendar with the correlation ID {0} and with this error message: {1}",t,n);this.$1Hp(n);this.$2U.$AF()},$9Cw:function(){this.$S.$34(this.$yq);this.$yq.$1Q();this.$yq=null},$9Xq:function(){this.$1z.$32(2,_nbs.NonBootStrings.l_DeleteCalendarGroupMessageBoxText_Text,this.$$d_$7hF,!1,null,null,_nbs.NonBootStrings.l_DeleteCalendarGroupMessageBoxTitle_Text)},$7hF:function(n,t){n&&$6p7(this)},$7he:function(n){this.$2It>=0&&this.$2af.$S.$72(this.$2It,this);this.$1Hp(n.get_$cH())},$7hf:function(n){this.$2U.get_$ux().$34(this.$BM);this.$1Q()}};_d.$QN=function(n,t,i,r,u){this.$$d_$9BX=Function.createDelegate(this,this.$9BX);this.$$d_$9R2=Function.createDelegate(this,this.$9R2);_d.$QN.initializeBase(this,[n.get_$Bd(),t,i,!0]);_a.$4.$J(n,"calendar");this.$6dL=new _C(this.$$d_$9R2,_a.$0.$1k);this.$4TF=r;this.$CS=u;this.$Bb=n;this.$Bb.$Y("CalendarName",this.$$d_$9BX)};_d.$QN.prototype={$6dL:null,$4TF:null,$CS:null,$Bb:null,get_$9yG:function(){return String.format(_nbs.NonBootStrings.l_CalendarHeaderUnselectCalendar_Aria_Text,this.$Bb.get_$Bd())},get_$9gI:function(){return String.format(_nbs.NonBootStrings.l_CalendarHeaderSelectCalendar_Aria_Text,this.$Bb.get_$Bd())},$4c:function(){this.$Bb.$u("CalendarName",this.$$d_$9BX);_js.$8.prototype.$4c.call(this)},$9R2:function(){this.$CS.$3Sa(this.$Bb)},$9BX:function(n,t){this.set_$1P(this.$Bb.get_$Bd())}};_d.$KU=function(n,t,i,r){_d.$KU.initializeBase(this);n&&t&&i&&n.$t.get_$eh()&&(r===4?$6pl(this,t,i):(r===1||r===2||r===3)&&$6pk(this,n,t,i,r))};_d.$KU.$7bz=function(){return new _d.$KU(null,null,null,0)};_d.$KU.$E=function(n,t,i,r){return new _d.$KU(n,t,i,r)};function $6pl(n,t,i){if(t.get_$AW()){n.$2o0=i.$lo(t.get_$y(),!0,!0);n.$2o1=i.$lo(t.get_$1u(),!0,!0)}}function $6pk(n,t,i,r,u){if(_d.$LU.isInstanceOfType(i)){n.$3hG=!t.$t.get_$y().$2R(i.get_$y());n.$3hF=!t.$t.get_$1u().$2R(i.get_$1u());n.$2o0=!1;n.$2o1=!1}else{n.$3hG=!t.$t.get_$AW();n.$3hF=!t.$t.get_$AW();n.$2o0=u!==1&&t.$t.get_$AW()&&r.$lo(i.get_$y(),!0,!0);n.$2o1=u!==1&&t.$t.get_$AW()&&r.$lo(i.get_$1u(),!0,!0)}}_d.$KU.prototype={$3hG:!1,$3hF:!1,$2o0:!1,$2o1:!1,get_$7Uw:function(){return this.$3hG},get_$7Ut:function(){return this.$3hF},get_$7Uu:function(){return this.$2o0},get_$7Uv:function(){return this.$2o1}};_d.$uN=function(){this.$p=[]};_d.$uN.prototype={$6r:null,$8B:null,$p:null,$D:function(n){_a.$4.$J(n,"item");(!this.$p.length||n.get_$y().$2R(this.$6r)<0)&&(this.$6r=n.get_$y().$3p());(!this.$p.length||n.get_$1u().$2R(this.$8B)>0)&&(this.$8B=n.get_$1u().$3p());this.$7Nk(n)},$34:function(n){_a.$4.$J(n,"item");var t=Array.remove(this.$p,n);t||_js.Trace.logError(_a.$0.$6y,"Failed to remove ICalendarSurfaceItem object from group, item id: {0}. ",_d.$EX.$1BZ(n));return t},$3oj:function(){var t=this.$p.length;var n=new Sys.StringBuilder;n.appendLine(String.format("Conflict group --> Date Range: '{0} - {1}', Item Count: {2}",this.$6r,this.$8B,t));n.appendLine(String.format("Items: ",t));for(var i=0;i<t;i++){var r=this.$p[i];n.appendLine(_d.$EX.$7kV(r))}return n.toString()},$7Nk:function(n){Array.add(this.$p,n)}};_d.$3e=function(n,t,i){this.$$d_$4dN=Function.createDelegate(this,this.$4dN);this.$$d_$9JF=Function.createDelegate(this,this.$9JF);this.$$d_$6CJ=Function.createDelegate(this,this.$6CJ);this.$$d_$3up=Function.createDelegate(this,this.$3up);this.$$d_$6WQ=Function.createDelegate(this,this.$6WQ);this.$$d_$9nJ=Function.createDelegate(this,this.$9nJ);this.$$d_$3GB=Function.createDelegate(this,this.$3GB);this.$$d_$69l=Function.createDelegate(this,this.$69l);this.$$d_$4Wy=Function.createDelegate(this,this.$4Wy);this.$$d_$9pt=Function.createDelegate(this,this.$9pt);this.$$d_$6Es=Function.createDelegate(this,this.$6Es);this.$$d_$6Eq=Function.createDelegate(this,this.$6Eq);this.$$d_$2ci=Function.createDelegate(this,this.$2ci);_d.$3e.initializeBase(this);var u=_a.$6.acss(_a.$0.$1k,"CalendarLayoutVM:Init");this.$1J=i;this.$7b=t;this.$hl=n;this.$11S=new _js.$Z;this.$2Fy={};this.$35W=new _y.$FB;this.$bN=new _C(this.$$d_$2ci,_d.$3e.$A);this.$2Bu=new _C(this.$$d_$6Eq,_a.$0.$1k);this.$1VM=new _C(this.$$d_$6Es,_a.$0.$1k);if(this.$7b.$C.get_$L()!=="TouchNarrow"){this.$1Hw=new _C(this.$$d_$9pt,_d.$3e.$A);this.$1Hv=new _C(this.$$d_$4Wy,_d.$3e.$A);this.$1qE=new _js.$Z;this.$lY=new _js.$Z;this.$7b.$Y("CurrentCalendarModel",this.$$d_$69l);var r=this.$7b.$CS.get_$IS();r.add_$1Z(this.$$d_$3GB);r.get_$B()>0&&$4kL(this,r.$6Z())}else this.$4W5=new _C(this.$$d_$9nJ,_d.$3e.$A);this.$108=new _C(this.$$d_$6WQ,_d.$3e.$A);this.$mR=new _C(this.$$d_$3up,_d.$3e.$A);this.$35=_a.$7.get_$29();if(this.$7b.$C.get_$L()!=="Mouse"){this.set_$7D(_y.$26.$Bg(this,null,null));this.$3w.set_$1kv(!0)}_a.$6.aces(u)};function $1JA(n,t){n.$6fw=t;n.$Im?$6pr(n,n.$Im.get_$1L(),t):$4kM(n,t)}function $4kM(n,t){n.$7b.set_$vv(null);var i=null;var r=!1;if(t in n.$2Fy)i=n.$2Fy[t];else{switch(t){case"DayViewModel":i=n.$hl.$5EB(n.$35,n.$7b);break;case"WorkWeekViewModel":i=n.$hl.$5Fj(n.$35,n.$7b.$C.get_$L()==="Mouse"?n.$bN:null,n.$7b);break;case"WeekViewModel":i=n.$hl.$5Ff(n.$35,n.$7b.$C.get_$L()==="Mouse"?n.$bN:null,n.$7b);break;case"MonthAgendaViewModel":i=n.$hl.$5F5(n.$35,!0,n.$bN,n.$7b);r=!0;break;case"AgendaViewModel":i=n.$hl.$3jo(n.$35,n.$7b);break;default:break}n.$2Fy[t]=i}var u=n.$Im?n.$Im.get_$1L():null;n.set_$EI(i);n.get_$EI().set_$Jx(n.$ld);r&&n.get_$EI().set_$ch(n.$DW);var f=this;_js.$J.get_$I().$3r(_a.$0.$1k,"CalendarLayoutViewModel",function(){$6pq(n,u,i.get_$1L())})}function $6pr(n,t,i){var r=n.$iW("ViewChanging");r&&r(t,n.$$d_$4dN)}function $6pq(n,t,i){var r=n.$iW("ViewChanged");r&&r(t,i)}function $10l(n,t,i){i===undefined&&(i=!0);_a.$6.stPT(_a.$0.$1k,"SwitchCalendarView",3);n.set_$Jx(_d.$9A.$E(_a.$0.$1k,t,!0,i))}function $6ps(n){n.get_$47N()&&(_d.$Fr.isInstanceOfType(n.get_$EI())?n.get_$47N().set_$q(!n.get_$EI().get_$3hL()):n.get_$47N().set_$q(!0))}function $6pu(n){_d.$92.isInstanceOfType(n.$Im)?n.set_$1lw(2):_d.$LV.isInstanceOfType(n.$Im)?n.set_$1lw(3):n.set_$1lw(1)}function $6pp(n,t){if(!n.$7b.$C.get_$Er()){n.$9iN(t);_h.$2J.$po(n.$7b.$c.get_$5M().get_$Te(),OwaApplication.$1W)}}function $4kL(n,t){for(var r=t.length,i=0;i<r;i++)$6po(n,t[i]);$JA(n,_d.$3e.$4Iy)}function $6po(n,t){var i=null;var u=this;var r=new _C(function(){n.set_$3MO(i)},_d.$3e.$A);i=n.$7bO(t,r);n.$lY.$D(i)}function $6pt(n,t,i){for(var r=t,u=t+i;r<u;r++)n.$lY.get_$3q(r).$1Q();n.$lY.$V3(t,i);$JA(n,_d.$3e.$4Iy)}_d.$3e.prototype={$hl:null,$7b:null,$35W:null,$bN:null,$4W5:null,$1Hw:null,$1Hv:null,$108:null,$mR:null,$2Bu:null,$1VM:null,$2Fy:null,$11S:null,$1J:null,$Im:null,$35:null,$e4:0,$55V:null,$6fw:null,$1qE:null,$lY:null,$zv:null,$nA:null,$ld:null,add_$4dR:function(n){this.$2N("ViewChanging",n)},remove_$4dR:function(n){this.$2P("ViewChanging",n)},add_$4dP:function(n){this.$2N("ViewChanged",n)},remove_$4dP:function(n){this.$2P("ViewChanged",n)},add_$2sM:function(n){this.$2N("DisplayedDateChanging",n)},remove_$2sM:function(n){this.$2P("DisplayedDateChanging",n)},get_$3GX:function(){return this.$2Bu},get_$3GZ:function(){return this.$1VM},get_$Ld:function(){return this.$7b.$C.get_$L()!=="Mouse"?_y.$1KT.prototype.get_$Ld.call(this):0},get_$55O:function(){return!0},get_$EI:function(){return this.$Im},set_$EI:function(n){if(this.$Im!==n){var i=_a.$6.acss(_a.$0.$1k,"MainVM_"+n.get_$1L());var t=null;if(this.$Im){this.$Im.remove_$7q(this.$$d_$6CJ);this.$Im.remove_$2sM(this.$$d_$9JF);this.$Im.set_$GB(!1);t=this.get_$EI().get_$91();this.get_$EI().set_$BJ(t);this.$Im.set_$Jx(null)}this.$Im=n;$6pp(this,this.$Im.get_$1qN());_js.Trace.logWarning(_a.$0.$1k,"[CalendarLayoutViewModel] MainViewModel: Before activating view model '{0}'",this.$Im.get_$1L());this.$7b.$C.get_$L()!=="TouchNarrow"&&$6ps(this);this.$11S.$7G(n)||this.$11S.$D(n);if(t){this.get_$EI().set_$BJ(t);this.get_$EI().set_$91(t)}this.$Im.add_$7q(this.$$d_$6CJ);this.$Im.add_$2sM(this.$$d_$9JF);$6pu(this);this.$35=n.get_$91();this.$Im.set_$GB(!0);$3(this,"MainViewModel");this.$35W.$MN(n);_a.$6.aces(i)}return n},$9JF:function(n,t){var i=this.$iW("DisplayedDateChanging");i?i(n,t):t()},get_$1lw:function(){return this.$e4},set_$1lw:function(n){if(n!==this.$e4){this.$e4=n;$45(this,"TimeStripMode","DisplayedDateString")}return n},get_$CT:function(){return this.$35},set_$CT:function(n){this.$35.$4e(n)||this.get_$EI().set_$91(n);return n},get_$5JO:function(){if($6(this.get_$EI())||$6(this.get_$EI().get_$BJ()))return"";var n;var t=this.get_$EI().get_$BJ();switch(this.$e4){case 1:n=t.$2Z(3);break;case 2:n=t.$2Z(2);break;case 3:var i=_a.$7.$Ky(t);var r=i.$2o(6);n=_a.$7.$2Lo(i,r);break;default:throw Error.notImplemented("Unexpected TimeStrip mode");}if(this.$7b.$C.get_$L()==="Mouse"&&_d.$LV.isInstanceOfType(this.get_$EI())&&this.$7b.$c.get_$1I().get_$1kz()){var u=_a.$7.$Ky(t).$2o(6);return _js.$9.$4R(_nbs.NonBootStrings.l_CalendarHeaderWeekNumbers_Text,n,_a.$7.$3uf(u))}return n},get_$Jx:function(){return this.$ld},set_$Jx:function(n){this.$ld=n;this.get_$EI()&&this.get_$EI().set_$Jx(n);return n},get_$3MO:function(){return this.$zv},set_$3MO:function(n){if(this.$zv!==n){this.$zv&&this.$zv.set_$2O(!1);this.$zv=n;if(this.$zv){this.$zv.set_$2O(!0);this.$7b.set_$11v(this.$zv.$Bb)}$3(this,"SelectedCalendarHeaderItem")}return n},get_$47N:function(){if(!this.$nA&&_d.$Fr.isInstanceOfType(this.get_$EI())){this.$nA=this.get_$EI().$nA;this.$1qE.$72(0,this.$nA)}return this.$nA},$2kA:function(){this.$7b.$2U.$1Mx();if(this.$7b.$C.get_$Er()){this.$7b.set_$11v(this.$7b.$2U.get_$iB());this.$55V=String.format(_nbs.NonBootStrings.l_AnonymousCalendarDisplayNameFormat_Text,this.$7b.$Cb.get_$Bd(),this.$7b.$c.get_$31().get_$FS())}else this.$7b.set_$11v(this.$7b.$CS.get_$IS().get_$3q(0))},$2ci:function(){$1JA(this,"DayViewModel")},$9nJ:function(){throw Error.notImplemented();},$9pt:function(){throw Error.notImplemented();},$4Wy:function(){throw Error.notImplemented();},$6WQ:function(){throw Error.notImplemented();},$9z9:function(n,t){throw Error.notImplemented();},$3up:function(){if(this.$Im&&this.$Im.$mR.$2M){this.$Im.$mR.$n();this.$Im.get_$1qN()!==3||_a.$2D.$2Og(this.$Im.$Gi,this.$Im.get_$91())||this.$4Wy()}},$4dN:function(){$4kM(this,this.$6fw)},$6CJ:function(n,t){if(t==="VMSelectedDate"){this.$35=this.$Im.get_$91();$3(this,"SelectedDate")}else t==="DisplayedDate"&&$3(this,"DisplayedDateString");$3(this,t)},$6Eq:function(){_js.Trace.logInfo(_a.$0.$1k,"CalendarLayoutViewModel activated");this.$Im&&this.$Im.set_$3Ns(!0)},$6Es:function(){_js.Trace.logInfo(_a.$0.$1k,"CalendarLayoutViewModel deactivated");this.$Im&&this.$Im.set_$3Ns(!1)},$4Wi:function(n){switch(n){case 1:this.$2c0(1);break;case 3:this.$7b.$C.get_$Er()?this.$2c0(2):this.$2c0(3);break;case 2:this.$2c0(2);break;case 4:this.$2c0(4);break;default:throw Error.argumentOutOfRange("viewType");}},$4Xn:function(){var n=null;var t=!0;switch(this.get_$9Vt()){case 1:n="NavigateToCalendarDay";break;case 4:n="NavigateToCalendarMonth";break;case 2:n="NavigateToCalendarWeek";break;case 3:n="NavigateToCalendarWorkWeek";break;case 5:n="NavigateToCalendarAgenda";t=!1;break}n&&this.set_$Jx(_d.$9A.$E(_a.$0.$1k,n,!0,t))},$7bO:function(n,t){return new _d.$QN(n,null,null,t,this.$7b.$CS)},get_$58v:function(){var n=this.$7b.$CS.get_$IS();var t=n.get_$B();return!t||t===1&&n.get_$3q(0).get_$1c1()},$3GB:function(n,t){switch(t.$2v){case 0:$4kL(this,t.$2l);break;case 2:$6pt(this,t.$4V,t.$38.length);break;default:throw Error.notImplemented();}},$69l:function(n,t){$45(this,"CanShareCalendar","CanPrint");if(this.$7b.$Cb)for(var i,r=0,u=this.$lY.get_$B();r<u;r++){i=this.$lY.get_$3q(r);if(this.$7b.$Cb.$4e(i.$Bb)){this.set_$3MO(i);return}}}};_d.$Og=function(n,t,i){this.$$d_$9BR=Function.createDelegate(this,this.$9BR);this.$$d_$9E0=Function.createDelegate(this,this.$9E0);this.$$d_$9LL=Function.createDelegate(this,this.$9LL);this.$Kp=new _y.$FB;_d.$Og.initializeBase(this);this.$SK=n;this.$58o=t;this.$M=i};_d.$Og.prototype={$SK:null,$58o:null,$M:null,$ew:null,$49:function(){this.$M.$IU(_d.$Vk,this.$$d_$9LL);this.$M.$IU(_d.$Fs,this.$$d_$9E0);this.$Kp.$Bt(this.$SK)},get_$2ID:function(){return this.$Kp.get_$7u()},get_$2WS:function(){return this.$Kp.get_$8t()},get_$5GI:function(){return this.$ew},set_$5GI:function(n){if(this.$ew===n)return n;this.$ew=n;var t=ICalendarEventSearchViewModel.isInstanceOfType(this.get_$2ID())?this.get_$2ID():null;t&&t.set_$P2(n);if(!n&&t){this.$Kp.$Bs();t.dispose();return n}n&&!t&&this.$58o.$E(this.$$d_$9BR);return n},$4c:function(){this.$M.$18g(_d.$Vk,this.$$d_$9LL);this.$M.$18g(_d.$Fs,this.$$d_$9E0);_js.$8.prototype.$4c.call(this)},$9LL:function(n){this.set_$5GI(n.$6q)},$9E0:function(n){this.set_$5GI(null)},$9BR:function(n){if(!this.$ew){_js.Trace.logInfo(_d.$Og.$1b,"Event Search factory was loaded but search context was not set.");return}var t=n.$E();t.set_$P2(this.$ew);this.$Kp.$Bt(t)}};_d.$Ia=function(n){this.$3v1=n};_d.$Ia.prototype={$3v1:0};_d.$nZ=function(n,t,i){_d.$nZ.initializeBase(this,[n]);this.$Fh=t;this.$Zm=i};_d.$nZ.prototype={$Fh:null,$Zm:null};_d.$i1=function(){};_d.$na=function(n,t,i,r,u,f,e,o){this.$$d_$9OH=Function.createDelegate(this,this.$9OH);_d.$na.initializeBase(this,[n,t,i,r,u,e,o]);this.$1KV=f;this.$3M8=this.$2U.get_$1HO().get_$Cp();this.$3M8.$Y("Count",this.$$d_$9OH)};function $6q8(n){if(n.$3M8.get_$B()){if(!n.$2b9){var t=n.$2b9=n.$1KV.$7ei(n.$XA);n.$S.$D(t)}}else if(n.$2b9){n.$S.$68(n.$S.get_$B()-1);n.$2b9.$1Q();n.$2b9=null}}_d.$na.prototype={$3M8:null,$1KV:null,$2b9:null,$4c:function(){this.$3M8.$u("Count",this.$$d_$9OH);_d.$AJ.prototype.$4c.call(this)},$9OH:function(n,t){$6q8(this)}};_d.$Vk=function(n){_js.$4.$l(n,"searchContext");this.$6q=n};_d.$Vk.prototype={$6q:null};_d.$nb=function(n,t,i){this.$2U=i;this.$1KV=n;this.$eg=t};_d.$nb.prototype={$2U:null,$1KV:null,$eg:null,$8A:function(n,t){return new _d.$uS(n,this.$1KV,this.$2U,t)},$E:function(n,t,i){for(var u=this.$8A(n,t),r,f=null,e,h,o=0,c=t.get_$B();o<c;o++){r=t.get_$3q(o);if(!r){_js.Trace.logError(_a.$0.$Ny,"Undefined calendar group in calendar groups collection.");continue}if(r.get_$8k()!=="12B353D3-3078-4E85-875B-F905CCB65E9B"&&!_cc.$1Q.$1cW(r)){f=this.$1KV.$E(r,u);for(var s=0,l=r.get_$Cp().get_$B();s<l;s++){h=r.get_$Cp().get_$3q(s);e=this.$eg.$E(h,f);i&&i(e);f.$S.$D(e)}u.$S.$D(f)}}u.$S.get_$B()||_js.Trace.logInfo(_a.$0.$Ny,"The created calendar tree is empty.");return u}};_d.$uS=function(n,t,i,r){this.$$d_$9Cy=Function.createDelegate(this,this.$9Cy);this.$$d_$9Cz=Function.createDelegate(this,this.$9Cz);this.$$d_$9BS=Function.createDelegate(this,this.$9BS);this.$$d_$2pd=Function.createDelegate(this,this.$2pd);this.$$d_$866=Function.createDelegate(this,this.$866);_d.$uS.initializeBase(this,[n,i]);this.$1KV=t;this.$5Xj=new _C(this.$$d_$866,_a.$0.$1k);this.set_$1LL(new _C(this.$$d_$2pd,_a.$0.$1k));this.$2G6=r;this.$2G6&&this.$2G6.add_$1Z(this.$$d_$9BS)};_d.$uS.prototype={$1KV:null,$2G6:null,$5Xj:null,$1Fi:null,get_$9wj:function(){return"CalendarPickerView.CalendarRootTreeNodeView"},$4c:function(){this.$2G6&&this.$2G6.remove_$1Z(this.$$d_$9BS);_d.$nc.prototype.$4c.call(this)},$9BS:function(n,t){switch(t.$2v){case 0:for(var r=0,s=t.$2l.length;r<s;r++){var f=t.$2l[r];if(!_cc.$1Q.$1cW(f)){var u=this.$1KV.$E(f,this);u.set_$qC(!0);u.set_$UI(!1);u.set_$CW(1);_js.Trace.logInfo(_a.$0.$Ny,"Handling calendar group added event - Group:{0}",f.get_$Vr());this.$S.$72(t.$4V+r,u)}}break;case 2:for(var e=0,h=t.$38.length;e<h;e++){var o=t.$38[e];_js.Trace.logInfo(_a.$0.$Ny,"Handling calendar group removed event - Group:{0}",o.get_$Vr());for(var i=0,c=this.$S.get_$B();i<c;i++){var l=this.$S.get_$3q(i);if(l.$BM.get_$8k()===o.get_$8k()){_js.Trace.logInfo(_a.$0.$Ny,"Calendar group '{0}' found at index {1}",o.get_$Vr(),i);this.$S.$68(i);break}}}break;default:break}},$866:function(){if(this.$2U.$14R){_js.Trace.logInfo(_a.$0.$Ny,"InitiateCreateCalendarGroup: Action ignored as we are currently waiting for an action to complete.");return}var n=this.$1Fi=this.$1KV.$E(this.$2U.$7da(),this);n.set_$UI(!0);n.set_$qC(!0);this.set_$24T(n);this.set_$CW(3)},$2pd:function(){if(_js.$9.$18(this.$1Fi.$UC)){_js.Trace.logInfo(_a.$0.$Ny,"CreateCalendarGroup: Action cancelled because group name is null or empty.");return}this.$1Fi.set_$UI(!1);this.$1Fi.set_$CW(2);this.$2U.$2pd(this.$1Fi.$BM,null,this.$$d_$9Cz,this.$$d_$9Cy);this.$S.$D(this.$1Fi)},$9Cy:function(){this.$S.$34(this.$1Fi);this.$1Fi.$1Q();this.$1Fi=null},$9Cz:function(n){this.$1Hp(n)}};_d.$nc=function(n,t){this.$$d_$1Hp=Function.createDelegate(this,this.$1Hp);this.$$d_$9Hy=Function.createDelegate(this,this.$9Hy);_d.$nc.initializeBase(this);_a.$4.$J(n,"parentCalendarPicker");this.$S=new _js.$Z;this.$XA=n;this.$2U=t;this.$1z=n.$1z;this.$2U.$Y("IsWaitingForCalendarAction",this.$$d_$9Hy)};_d.$nc.prototype={$2U:null,$hq:null,$zb:null,$vm:null,$17r:null,$BU:0,$S:null,$3G:!1,$12M:!1,$rI:!1,$1R9:null,$1z:null,$8Z:null,$XA:null,get_$9wj:function(){return"NavigationTreeTemplates.CalendarTreeNodeView"},get_$UI:function(){return this.$rI},set_$UI:function(n){if(n!==this.$rI){this.$rI=n;$45(this,"IsEdit","IsContextMenuEnabled")}return n},get_$Pa:function(){return this.$S.get_$B()>0},get_$2O:function(){return this.$3G},set_$2O:function(n){if(this.$3G!==n){this.$3G=n;$3(this,"IsSelected")}return n},get_$qC:function(){return this.$12M},set_$qC:function(n){if(n!==this.$12M){this.$12M=n;$3(this,"DisableSelection")}return n},get_$CW:function(){return this.$BU},set_$CW:function(n){if(n!==this.$BU){this.$BU=n;$3(this,"TreeNodeMode")}return n},get_$24T:function(){return this.$1R9},set_$24T:function(n){if(n!==this.$1R9){this.$1R9=n;$3(this,"NewNodeViewModel")}return n},get_$1LL:function(){return this.$vm},set_$1LL:function(n){if(n!==this.$vm){this.$vm=n;$3(this,"CreateCommand")}return n},get_$1Sn:function(){return this.$zb},set_$1Sn:function(n){if(n!==this.$zb){this.$zb=n;$3(this,"RenameCommand")}return n},get_$2nl:function(){return this.$hq},set_$2nl:function(n){if(n!==this.$hq){this.$hq=n;$3(this,"CancelRenameCommand")}return n},get_$9pq:function(){return this.$17r},set_$9pq:function(n){if(n!==this.$17r){this.$17r=n;$3(this,"ShowWarningMessageCommand")}return n},get_$88t:function(){return!this.$rI&&!this.$2U.$14R},$1Ma:function(n){for(var i=null,r=0,u=this.$S.get_$B();r<u;r++){var t=this.$S.get_$3q(r);_d.$JT.isInstanceOfType(t)?i=t.$1Ma(n):_d.$6C.isInstanceOfType(t)&&t.$CE.$4e(n)&&(i=t);if(i)break}return i},$1Hp:function(n){this.$1z.$32(0,n,null,!1,null,null,_nbs.NonBootStrings.l_CalendarActionErrorDialogTitle_Text)},$4c:function(){this.$2U.$u("IsWaitingForCalendarAction",this.$$d_$9Hy);if(this.$S)for(var n=0,t=this.$S.get_$B();n<t;n++)this.$S.get_$3q(n).$1Q();_a.$1.prototype.$4c.call(this)},$9Hy:function(n,t){$3(this,"IsContextMenuEnabled")}};_d.$Fu=function(n,t,i,r,u,f,e){this.$$d_$2XV=Function.createDelegate(this,this.$2XV);this.$$d_$4Iv=Function.createDelegate(this,this.$4Iv);this.$$d_$9Oo=Function.createDelegate(this,this.$9Oo);this.$$d_$4Kl=Function.createDelegate(this,this.$4Kl);this.$3iR=new _cc.$nQ;_d.$Fu.initializeBase(this);var s=_a.$6.acss(_a.$0.$1k,"CalendarPickerViewModel:Init");this.$56=t;this.$C=i;this.$3gV=n;this.$2U=r;this.$6ZV=u;this.$3gT=f;this.$Yv=new _js.$Z;this.$Yv.add_$1Z(this.$$d_$4Kl);this.$Yv.$Y("Count",this.$$d_$9Oo);this.$1z=new _y.$4c;i.get_$L()!=="Mouse"&&this.set_$7D(_y.$26.$E(this));if(this.$3gT){var o=this;f.$E(function(n){o.$la=n;o.$la.$7n0(function(){o.$4Iv(o.$2U)})})}this.$3gU=e;this.$2U.add_$2nC(this.$$d_$4Iv);this.$4Iv(this.$2U);_a.$6.aces(s)};function $4kR(n){if(n.$1Ys){var t=n.$Yv.get_$B();t===1?n.$1Ys.set_$qC(n.$Yv.get_$3q(0)===n.$1Ys):t>1&&n.$1Ys.set_$qC(!1)}}_d.$Fu.prototype={$56:null,$1z:null,$3gV:null,$6ZV:null,$C:null,$1Ys:null,$Yv:null,$3QJ:null,$AI:null,$J1:null,$1vO:null,$2U:null,$3gT:null,$3gU:null,$la:null,$3dI:null,get_$553:function(){if(!this.$3dI&&this.$3gU){var n=this;this.$3gU.$E(function(t){n.$3dI=t;$3(n,"AllModernGroupsViewModel")})}return this.$3dI},get_$dh:function(){return this.$AI},set_$dh:function(n){if(this.$AI!==n){this.$AI=n;$3(this,"SelectedTreeNode")}return n},get_$6ZU:function(){return this.$3QJ},set_$6ZU:function(n){if(n!==this.$3QJ){this.$3QJ=n;$3(this,"SubscribeCalendarViewModel")}return n},get_$MM:function(){return 3},get_$2ag:function(){return this.$J1},set_$2ag:function(n){if(n!==this.$J1){this.$J1=n;$3(this,"RootTreeNode")}return n},get_$803:function(){return this.$1vO},set_$803:function(n){if(n!==this.$1vO){this.$1vO=n;$3(this,"GroupsRootTreeNode")}return n},get_$Ld:function(){return this.$C.get_$L()!=="Mouse"?1:0},get_$5HM:function(){return this.$1Ys},set_$5HM:function(n){if(this.$1Ys!==n){this.$1Ys=n;$4kR(this)}return n},$9S9:function(n){var t=this.set_$6ZU(this.$6ZV.$E(n,this));var i=this;t.set_$G1(new _C(function(){i.set_$6ZU(null);t.$306?t.$Y("IsCacheReloadPending",function(n,t){n.$1Q()}):t.$1Q()},_a.$0.$Ny));t.set_$1O(!0)},$3NE:function(n,t){var i=null;if(t)i=this.$J1.$1Ma(n);else for(var r=0,f=this.$Yv.get_$B();r<f;r++){var u=this.$Yv.get_$3q(r);if(u.$CE.$4e(n)){i=u;break}}i?this.$4Uj(i,t):_js.Trace.logWarning(_a.$0.$1k,"couldnt find calendar {0} on the CalendarPicker and select it.",n.get_$Bd())},$4Uj:function(n,t){if(t&&!this.$56.$2GU&&!this.$56.$3zc(n.$CE)){_js.Trace.logInfo(_a.$0.$Ny,"Unable to select calendar as the maximum number of selected calendar has already been reached.");return}n.set_$2O(t);var i=this.$Yv.$7G(n);!i&&t?this.$Yv.$D(n):i&&!t&&this.$Yv.$34(n)},$6Qb:function(n){var t=this.$la.$5N7(n);if(t)return t;var i=n;this.$la.$4de(i);return this.$la.$5N7(n)},$9Uo:function(n){var t=n.$CE;if(!t.get_$Xs()){_js.Trace.logError(_a.$0.$Ny,"Calendar is not a modern groups calendar at PinGroupCalendar: {0}",t.get_$Bd());return}this.$la.$2Yd(t.get_$D2())},$8Ek:function(n){var t=n.$CE;if(!t.get_$Xs()){_js.Trace.logError(_a.$0.$Ny,"Calendar is not a modern groups calendar at JoinGroupCalendar: {0}",t.get_$Bd());return}this.$la.$1Oy(t)},$4QO:function(n){var t=n.$CE;if(_d.$i3.isInstanceOfType(n.$Di)){_a.$6.$1c(_a.$0.$Ny,"SearchDiscardCalendar");this.$2U.$4QO(t,this.$2U.get_$1HO());_a.$6.$1E(null,"SearchDiscardCalendar")}else n.$Di.$BM===this.$2U.get_$16m()&&this.$la.$2fO(t.get_$D2())},$4Iv:function(n){if(this.$2U.get_$I1()&&(!this.$3gT||this.$la&&this.$la.get_$I1())){if(this.$J1){this.$J1.$1Q();this.set_$5HM(null);this.$56.$56.remove_$1Z(this.$$d_$2XV);this.$56.$56.$1r();this.$56.$zB.$1r();this.$Yv.$1r()}this.$56.$56.add_$1Z(this.$$d_$2XV);var t=null;var i=new(_0365f.$o.$$(_g.$KS));var f=this;var r=this.$3gV.$E(this,this.$2U.get_$ux(),function(r){!t&&_g.$Ej.isInstanceOfType(r.$CE)&&r.$CE.get_$2Oi()&&(t=r);n.$5AP(r.$CE.get_$A5())&&i.$D(r.$CE)});if(this.$la){var u=this.$3gV.$8A(this,null);var e=this;this.$la.$9VO(r,u,function(n){i.$D(n.$CE)});this.$2U.get_$ux().$69([this.$2U.get_$16m(),this.$2U.get_$1DV(),this.$2U.get_$1mk()]);this.set_$803(u)}this.set_$2ag(r);if(!t)throw Error.create("DefaultCalendarNode not found in calendars response.");this.$56.$9dY(i);this.set_$5HM(t)}},$2XV:function(n,t){if(t.$2l)for(var i=0,u=t.$2l.length;i<u;i++){var f=t.$2l[i];this.$3NE(f,!0)}if(t.$38)for(var r=0,e=t.$38.length;r<e;r++)this.$3NE(t.$38[r],!1)},$4Kl:function(n,t){var i;var r;switch(t.$2v){case 0:for(var u=0,e=t.$2l.length;u<e;u++){i=t.$2l[u];r=i.$CE;_js.Trace.logInfo(_a.$0.$Ny,"Calendar tree node selected: '{0}' - IsValid: {1} ItemId:{2}",i.$hn||"",i.$CE.get_$2Oy()?"yes":"no",i.$CE.get_$i().Id);if(!i.$2tC)return;var o=this;this.$56.$4TE(r,function(n){if(!o.$2U.$2o2(r)){i.set_$qC(!0);i.set_$2O(!1);i.$17r.$2M&&i.$17r.$n()}});this.$3iR.$6Oa(r)}break;case 2:for(var f=0,s=t.$38.length;f<s;f++){i=t.$38[f];r=i.$CE;if(!i.$2tC){_js.Trace.logInfo(_a.$0.$Ny,"Selected tree node was removed but not processed. CalendarName: {0}",i.$hn);return}_js.Trace.logInfo(_a.$0.$Ny,"Calendar tree node un-selected: '{0}' - ItemId: {1}",i.$hn||"",i.$CE.get_$i().Id);this.$56.$3Sa(r);this.$3iR.$6Mx(r)}break;case 3:this.$4Kl(n,new _js.$II(2,t.$4V,null,t.$38));this.$4Kl(n,new _js.$II(0,t.$4V,t.$2l,null));break;default:throw Error.invalidOperation("Unsupported NotifyCollectionChangedAction");}},$9Oo:function(n,t){$4kR(this)}};_d.$i3=function(n,t,i,r,u,f){_d.$i3.initializeBase(this,[n,t,i,r,u,f]);for(var e=0,s=n.get_$Cp().get_$B();e<s;e++){var o=this.$eg.$E(n.get_$Cp().get_$3q(e),this);this.$85S(o);this.$S.$D(o)}};_d.$i3.prototype={get_$9wj:function(){return"CalendarSearchGroupTreeNodeView"},$85S:function(n){n.set_$2O(this.$56.get_$2GV())}};_d.$Ic=function(n,t,i){this.$$d_$9Ng=Function.createDelegate(this,this.$9Ng);this.$$d_$9KC=Function.createDelegate(this,this.$9KC);this.$$d_$9JE=Function.createDelegate(this,this.$9JE);this.$3To=new _js.$Z;_d.$Ic.initializeBase(this);this.$SK=n;this.$PG=t;this.$M=t.$M;this.$C=t.$C;this.$1PP=i;this.$of=this.$SK.get_$CT();this.$SK.$Y("MainViewModel",this.$$d_$9JE);this.$M.$IU(_d.$i1,this.$$d_$9KC);this.$C.get_$L()!=="Mouse"&&this.$1PP.get_$2WS().add_$1Z(this.$$d_$9Ng)};function $6qN(n){if(!_d.$3e.isInstanceOfType(n.get_$7fn())||!n.$AY){_js.Trace.logInfo(_d.$Ic.$1b,"Module visibility changed but no action was taken. IsVisible: {0}",n.$AY);return}n.$SK.get_$EI()&&n.$SK.get_$EI().$ZZ();n.$AY&&!n.$C.get_$43p()&&n.$SK.$3up()}function $6qO(n){n.set_$7D(_y.$M1.isInstanceOfType(n.$1PP.get_$2ID())?n.$1PP.get_$2ID().get_$7D():null)}_d.$Ic.prototype={$SK:null,$1PP:null,$PG:null,$M:null,$C:null,$of:null,$AY:!1,get_$7fn:function(){return this.$1PP.get_$2ID()},get_$5it:function(){return this.$1PP.get_$2WS()},get_$29g:function(){return this.$of},set_$29g:function(n){if(n!==this.$of){this.$of=n;$3(this,"SidePanelDisplayedDate")}return n},get_$1qM:function(){return this.$SK.get_$EI()},get_$DX:function(){return this.$AY},set_$DX:function(n){if(this.$AY!==n){this.$AY=n;$6qN(this)}return n},$49:function(){this.$3To.$D(this.$SK);this.$1PP.$49();this.$SK.$2kA()},$7QQ:function(n){switch(n.$ZU){case 2:this.$SK.$6WQ();break;case 1:this.$SK.$4Wy();break;case 0:this.$SK.$2ci();break}this.$SK.get_$EI().set_$91(n.$1Cg)},$9XD:function(n){_c.$Ew.$9XC(n,this.$SK)},$6F5:function(){this.$SK.get_$EI().$3kO.$2M&&this.$SK.get_$EI().$3kO.$n()},$4c:function(){this.$M.$18g(_d.$i1,this.$$d_$9KC);this.$1PP.get_$2WS().remove_$1Z(this.$$d_$9Ng);_a.$1.prototype.$4c.call(this)},$9JE:function(n,t){$3(this,"CalendarViewModel")},$9KC:function(n){this.set_$29g(this.$SK.get_$CT())},$9Ng:function(n,t){$6qO(this)}};_d.$a1=function(n,t,i,r,u,f,e,o,s){this.$56=n;this.$2U=r;this.$X5=u;this.$C=e;this.$1J=f;this.$c=o;this.$13=s;this.$3Nc=t;this.$1Tq=i};_d.$a1.prototype={$56:null,$2U:null,$X5:null,$C:null,$1J:null,$c:null,$13:null,$3Nc:null,$1Tq:null,$E:function(n,t){return new _d.$6C(n,t,this.$C.get_$L()==="TouchNarrow",this.$56,t.$XA,this.$3Nc,this.$1Tq,this.$2U,this.$X5,this.$1J,this.$C,this.$c,this.$13)}};_d.$6C=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$9Ln=Function.createDelegate(this,this.$9Ln);this.$$d_$9Lo=Function.createDelegate(this,this.$9Lo);this.$$d_$9Db=Function.createDelegate(this,this.$9Db);this.$$d_$9Dc=Function.createDelegate(this,this.$9Dc);this.$$d_$7hG=Function.createDelegate(this,this.$7hG);this.$$d_$9NJ=Function.createDelegate(this,this.$9NJ);this.$$d_$9CP=Function.createDelegate(this,this.$9CP);this.$$d_$9Xt=Function.createDelegate(this,this.$9Xt);this.$$d_$7UL=Function.createDelegate(this,this.$7UL);this.$$d_$3KY=Function.createDelegate(this,this.$3KY);this.$$d_$9Xp=Function.createDelegate(this,this.$9Xp);this.$$d_$8En=Function.createDelegate(this,this.$8En);this.$$d_$2fO=Function.createDelegate(this,this.$2fO);this.$$d_$2Yd=Function.createDelegate(this,this.$2Yd);this.$$d_$6Uj=Function.createDelegate(this,this.$6Uj);this.$$d_$9p1=Function.createDelegate(this,this.$9p1);this.$$d_$86G=Function.createDelegate(this,this.$86G);this.$$d_$9Bo=Function.createDelegate(this,this.$9Bo);_d.$6C.initializeBase(this,[u,o]);var p;var b;var v=null;this.$C=c;this.$13=a;this.$1J=h;this.$56=r;this.$1Tq=e;this.$3Nc=f;this.$CE=n;this.$hn=n.get_$Bd();this.set_$6Gl(t);this.$5bo=this.$1yj=_g.$9G.isInstanceOfType(n);this.$30C=this.get_$32l()||_cc.$1Q.$1cW(this.$Di.$BM);r.apcl("CanSelectMoreCalendars",this.$$d_$9Bo);this.set_$CW(1);var w=new _C(this.$$d_$86G,_d.$6C.$A);var d=new _C(this.$$d_$9p1,_d.$6C.$A);var g=new _C(this.$$d_$6Uj,_d.$6C.$A);this.$4NZ=new _C(this.$$d_$2Yd,_d.$6C.$A);this.$4cA=new _C(this.$$d_$2fO,_d.$6C.$A);this.$j7=new _C(this.$$d_$8En,_d.$6C.$A);var k=this.$TL=new _C(this.$$d_$9Xp,_d.$6C.$A);w.set_$5u(!0);d.set_$5u(!0);k.set_$5u(!0);this.set_$1Sn(new _C(this.$$d_$3KY,_d.$6C.$A));this.set_$2nl(new _C(this.$$d_$7UL,_d.$6C.$A));this.set_$9pq(new _C(this.$$d_$9Xt,_d.$6C.$A));if(this.$5bo){p=n;v=new _g.$1l;v.EmailAddress=p.get_$D2();v.Name=p.get_$Bd();p.get_$Xs()&&(v.MailboxType="GroupMailbox")}else{if(this.$1J.$3u("ModernGroups")&&n.get_$1c1()){v=new _g.$1l;v.EmailAddress=l.get_$31().get_$Aj();v.Name=n.get_$Bd()}b=n;this.$1yj=!!(this.$1yj|b.get_$1D0());w.set_$5u(!b.get_$2Oi());k.set_$5u(w.$2M)}v&&(this.$6e=s.$lx(_pc.$i.$DQ(v),2,!1,0));this.$2oo=new _d.$nP(n,this.$$d_$1Hp);this.$2oo.$Y("IsActionPending",this.$$d_$9CP);if(!i){var y=new(_0365f.$o.$$(_0365m.$m));if(!(this.$1yj||this.get_$Xs())){y.$D(new _0365m.$m(_nbs.NonBootStrings.l_ShareCalendarContextMenuTitle_LowerCase_Text,null,g));y.$D(new _0365m.$m(_nbs.NonBootStrings.l_SharedCalendarPermissions_Text,null,d))}_cc.$1Q.$1cW(this.$Di.$BM)?y.$D($4kY(this)):this.$CE.get_$1c1()||y.$69([new _0365m.$m(_nbs.NonBootStrings.l_RenameCalendarContextMenuTitle_LowerCase_Text,null,w),new _0365m.$m(this.$1yj?_nbs.NonBootStrings.l_RemoveCalendarContextMenuTitle_LowerCase_Text:_nbs.NonBootStrings.l_DeleteCalendarContextMenuTitle_LowerCase_Text,null,k)]);y.$D(this.$2oo.$5kV);this.$8Z=new _0365m.$2b(y.get_$3T())}$4kW(this)};function $4kW(n){n.set_$qC(!n.$2U.$2o2(n.$CE)||!n.$56.get_$2GV()&&!n.$56.$3zc(n.$CE))}function $4kX(n){if(!n.$2U.$14R){n.set_$2O(!1);if(n.$30C){n.$XA.$4QO(n);return}n.$2Iq=n.$Di.$S.$71(n);n.$2Iq>=0&&n.$Di.$S.$68(n.$2Iq);n.$2U.$3mx(n.$CE,n.$Di.$BM,n.$$d_$9Dc,n.$$d_$9Db)}}function $6qQ(n){_a.$6.$1c(_d.$6C.$A,"SearchPinCalendar");n.$2tC=!1;n.set_$2O(!1);n.$2U.$9Uk(n.$CE,null,n.$$d_$9Lo,n.$$d_$9Ln)}function $6qR(n){n.$8Z&&n.$8Z.$1C.set_$3q(0,$4kY(n))}function $4kY(n){return n.$Di.$BM===n.$2U.get_$16m()?new _0365m.$m(_u.Strings.l_RemoveFromFavorites_LowerCase_Text,null,n.$4cA):n.$Di.$BM===n.$2U.get_$1DV()?new _0365m.$m(_u.Strings.l_AddToFavorites_LowerCase_Text,null,n.$4NZ):new _0365m.$m(_nbs.NonBootStrings.l_GroupManagementOptions_Join_Text,null,n.$j7)}_d.$6C.prototype={$5bo:!1,$1yj:!1,$30C:!1,$56:null,$2oo:null,$2nx:!1,$2o8:!1,$3h7:!1,$2GR:!1,$2tC:!0,$3Nc:null,$1Tq:null,$13:null,$1J:null,$TL:null,$4NZ:null,$4cA:null,$j7:null,$6e:null,$CE:null,$C:null,$Di:null,$2Iq:0,$hn:null,$1SM:null,get_$82f:function(){return!this.$1J.$3u("ModernGroups")&&!this.$6e},get_$6Gl:function(){return this.$Di},set_$6Gl:function(n){if(this.$Di!==n){this.$Di=n;if(this.get_$32l()){this.set_$3hB(!0);this.set_$3hM(!1);this.set_$vL(!1);this.set_$VX(!0)}else{this.set_$3hB(this.$Di.$BM===this.$2U.get_$1DV());this.set_$3hM(this.$Di.$BM===this.$2U.get_$16m());this.set_$vL(this.$Di.$BM===this.$2U.get_$1mk());this.set_$VX(!1);_cc.$1Q.$1cW(this.$Di.$BM)&&$6qR(this)}}return n},get_$7jT:function(){return!this.$13.get_$qw()},get_$9nc:function(){return String.format(_nbs.NonBootStrings.l_CalendarPickerShowCalendar_AT_Checkbox_Text,this.$hn)},get_$Bd:function(){return this.$hn},set_$Bd:function(n){if(n!==this.$hn){this.$hn=this.$CE.set_$Bd(n);$45(this,"CalendarName","ShowCalendarText")}return n},get_$32l:function(){return _d.$i3.isInstanceOfType(this.$Di)},get_$3hB:function(){return this.$2nx},set_$3hB:function(n){if(this.$2nx!==n){this.$2nx=n;$45(this,"CanPin","IsActionable")}return n},get_$3hM:function(){return this.$2o8},set_$3hM:function(n){if(this.$2o8!==n){this.$2o8=n;$45(this,"CanUnpin","IsActionable")}return n},get_$vL:function(){return this.$3h7},set_$vL:function(n){if(this.$3h7!==n){this.$3h7=n;$45(this,"CanJoin","IsActionable")}return n},get_$VX:function(){return this.$2GR},set_$VX:function(n){if(this.$2GR!==n){this.$2GR=n;$45(this,"CanRemove","IsActionable")}return n},get_$5ZI:function(){return this.$2nx||this.$2o8||this.$2GR||this.$2GR},get_$9ae:function(){return this.$TL},get_$9Ul:function(){return this.$4NZ},get_$9y6:function(){return this.$4cA},get_$33y:function(){return this.$j7},$4c:function(){this.$2oo.$u("IsActionPending",this.$$d_$9CP);this.$56.rpcl("CanSelectMoreCalendars",this.$$d_$9Bo);_d.$nc.prototype.$4c.call(this)},get_$Xs:function(){return!!this.$CE&&this.$CE.get_$Xs()},$9CP:function(n,t){var i=n;this.$2U.set_$mu(i.$JV)},$9Xt:function(){if(this.$1z.$2y){_js.Trace.logInfo(_d.$6C.$A,"Unable to show a messagebox while there is another one already being shown.");return}if(this.$2U.$2o2(this.$CE)){if(!this.$56.get_$2GV()){_a.$6.$1c(_a.$0.$1k,"SelectedCalendarOverLimit");_a.$6.$1E(null,"SelectedCalendarOverLimit");this.$1z.$32(0,String.format(_nbs.NonBootStrings.l_CalendarPickerTooManyCalendarsSelected_Text,this.$56.get_$8Is()),null,!1,null,null,_u.Strings.l_Warning_Text)}}else this.$1z.$32(0,_nbs.NonBootStrings.l_CalendarPickerInvalidSharedCalendar_Text,null,!1,null,null,_nbs.NonBootStrings.l_CalendarActionErrorDialogTitle_Text)},$9Bo:function(n,t){$4kW(this)},$6Uj:function(){var n=this;this.$1Tq.$E(function(t){t.$4LE(n.$CE.get_$A5(),null,!1)})},$86G:function(){if(!this.$2U.$14R){this.$1SM=this.$hn;this.set_$24T(this);this.set_$UI(!0);this.set_$CW(4)}},$7UL:function(){this.set_$UI(!1);this.set_$Bd(this.$1SM);this.$1SM=null;this.set_$CW(1)},$3KY:function(){if(_js.$9.$18(this.$hn)){this.set_$Bd(this.$1SM);this.$1SM=null;this.set_$UI(!1);return}if(this.$hn.trim()===this.$1SM||this.$30C){this.set_$UI(!1);return}var n=this;this.$2U.$3KY(this.$CE,this.$hn,function(n){},this.$$d_$9NJ);this.set_$UI(!1)},$9NJ:function(n){this.set_$Bd(this.$1SM);this.$1SM=null;this.$1Hp(n.get_$cH());this.$2U.$AF()},$9Xp:function(){if(this.$30C||this.$1yj){$4kX(this);return}this.$1z.$32(2,_nbs.NonBootStrings.l_DeleteCalendarMessageBoxText_Text,this.$$d_$7hG,!1,null,null,_nbs.NonBootStrings.l_DeleteCalendarMessageBoxTitle_Text)},$9p1:function(){var n=this;this.$3Nc.$E(function(t){t.$9Rw(n.$CE)})},$7hG:function(n,t){n&&$4kX(this)},$9Dc:function(n){this.$CE.$1Q();this.$1Q()},$9Db:function(n){this.$2Iq>=0&&this.$Di.$S.$72(this.$2Iq,this);this.$1Hp(n.get_$cH());this.$2U.$AF()},$2Yd:function(){var n=this.$Di.$BM===this.$2U.get_$1DV()||this.$Di.$BM===this.$2U.get_$1mk();if(!this.get_$32l()&&!n){_js.Trace.logError(_d.$6C.$A,"Expecting that calendar being pinned is either searched or modern groups calendar. ParentGroupName: {0}",this.$Di?this.$Di.$UC:"isNull");return}n?this.$XA.$9Uo(this):$6qQ(this)},$2fO:function(){if(this.$Di.$BM!==this.$2U.get_$16m()){_js.Trace.logError(_d.$6C.$A,"Can only unpin modern group calendar from PinnedModernGroupsCalendarsGroup. ParentGroupName: {0}",this.$Di?this.$Di.$UC:"isNull");return}this.$XA.$4QO(this)},$8En:function(){if(this.$Di.$BM!==this.$2U.get_$1mk()){_js.Trace.logError(_d.$6C.$A,"Can only join modern group calendar from VisitedModernGroupsCalendarsGroup. ParentGroupName: {0}",this.$Di?this.$Di.$UC:"isNull");return}this.$XA.$8Ek(this)},$9Lo:function(n,t){_a.$6.$1E(null,"SearchPinCalendar",n,t);this.$1Hp(n)},$9Ln:function(){this.$1Q();_a.$6.$1E(null,"SearchPinCalendar")}};_d.$LV=function(n,t,i,r,u,f,e){this.$$d_$6eT=Function.createDelegate(this,this.$6eT);_d.$LV.initializeBase(this,[n,t,i,r,f]);var o=_a.$6.acss(_a.$0.$1k,"CalendarWeekViewModel:Init");this.$bN=u;$4kZ(this);e&&e.add_$2G3(this.$$d_$6eT);_a.$6.aces(o)};function $4kZ(n){n.$1Lo?n.$1Lo.$1r():n.$1Lo=new _js.$Z;for(var t,i,u=_a.$7.get_$29(),r=0,f=n.$O8.get_$bG().length;r<f;r++){t=n.$O8.get_$bG()[r];i=new _d.$W7(t,n.$bN);t.$93(u)||i.set_$2O(!0);n.$1Lo.$D(i)}}function $6qS(n){var u=_a.$7.get_$29().$4F();if(n.$Gi.length===n.$1Lo.get_$B())for(var t=0,f=n.$Gi.length;t<f;t++){var i=n.$Gi[t];var r=n.$1Lo.get_$3q(t);r.set_$51(i);r.set_$2O(i.$4e(u))}else $4kZ(n)}_d.$LV.prototype={$bN:null,$1Lo:null,$28G:null,get_$1B8:function(){return 1},get_$1L:function(){return"CalendarWeekViewModel"},get_$1qN:function(){return 2},get_$9gT:function(){return this.$28G},set_$9gT:function(n){if(this.$28G!==n){this.$28G=n;this.$28G&&this.set_$91(this.$28G.$7h)}return n},get_$4PH:function(){return _a.$7.$2Lo(this.$ED.$2Q,this.$ED.$3D.$2o(-1))},get_$2ju:function(){return String.format(_nbs.NonBootStrings.l_CalendarWeekView_AT_Region_Text,this.get_$4PH())},$5TW:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"WeekView_GoPrev",!0,!0));this.set_$BJ(this.$ED.$2Q.$2o(-7))},$5TV:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"WeekView_GoNext",!0,!0));this.set_$BJ(this.$ED.$2Q.$2o(7))},$IX:function(n){n.get_$AW()?this.$CZ.$D(n):n.get_$y().$4F().$2R(n.get_$1u().$4F())?this.$p.$69($1nY(this,n,this.$Gi)):this.$p.$D(n)},$3Ey:function(){_d.$1r.prototype.$3Ey.call(this);this.$6eT(this,_a.$7.get_$29())},$69y:function(n,t){_d.$7x.prototype.$69y.call(this,n,t);$6qS(this)},$6eT:function(n,t){for(var r,i=0,u=this.$Gi.length;i<u;i++){r=this.$Gi[i];this.$1Lo.get_$3q(i).set_$2O(!r.$93(t))}}};_d.$12V=function(n,t,i,r,u){_d.$12V.initializeBase(this,[n,t,i,r,null,u,null])};_d.$12V.prototype={get_$1B8:function(){return 5}};_d.$nl=function(n,t,i,r,u,f,e){_d.$nl.initializeBase(this,[n,t,i,r,u,f,e])};_d.$nl.prototype={get_$1B8:function(){return 2},get_$1L:function(){return"CalendarWorkWeekViewModel"},get_$1qN:function(){return 3},get_$2ju:function(){return String.format(_nbs.NonBootStrings.l_CalendarWorkWeekView_AT_Region_Text,this.get_$4PH())},get_$7um:function(){var n=_a.$2D.$Mx(this.get_$91(),1,!1,this.$1h.$c.get_$1I().get_$Nl().get_$Nk());return new _h.$4e(n[0],n[1])},$1ka:function(n){if(_d.$1r.prototype.$1ka.call(this,n))for(var t=0,r=this.$O8.get_$bG().length;t<r;t++){var i=this.$O8.get_$bG()[t];var u=new _h.$4e(i,i.$2o(1));if(u.$1OL(n))return!0}return!1},$3Ey:function(){_d.$LV.prototype.$3Ey.call(this);_a.$2D.$2Og(this.$Gi,this.get_$91())||this.set_$91(this.$Gi[0])}};_d.$W7=function(n,t){_d.$W7.initializeBase(this,[_d.$W7.$5OP(n),null,t,!0]);this.$7h=n};_d.$W7.$5OP=function(n){return String.format("{0} {1}",n.$2Z(19),_a.$7.$1C6(n.get_$Dr(),2))};_d.$W7.prototype={$7h:null,get_$51:function(){return this.$7h},set_$51:function(n){if(n&&!_a.$7.$4N(this.$7h,n)){this.$7h=n;$N(this,"FormattedDate")}return n},get_$7py:function(){return _d.$W7.$5OP(this.$7h)}};_d.$y6=function(n,t,i,r,u,f,e){this.$$d_$99e=Function.createDelegate(this,this.$99e);_d.$y6.initializeBase(this,[t,i,r,u,f,e]);this.$pN=n};_d.$y6.prototype={$pN:null,get_$1L:function(){return"MonthAgendaViewModel"},get_$91:function(){return _d.$1r.prototype.get_$91.call(this)},set_$91:function(n){_d.$1r.prototype.set_$91.call(this,n);this.$pN.set_$91(n);return n},get_$148:function(){return _d.$1r.prototype.get_$148.call(this)},set_$148:function(n){_d.$1r.prototype.set_$148.call(this,n);this.$pN.set_$148(n);return n},$694:function(n,t){_d.$1r.prototype.$694.call(this,n,t);this.$pN.$6ML()},$6F0:function(n,t){_d.$1Ks.prototype.$6F0.call(this,n,t);this.$1h.$Zc&&this.$pN.$7WX()},$3Ey:function(){_d.$92.prototype.$3Ey.call(this);this.$pN.set_$GB(!0);this.$pN.add_$7q(this.$$d_$99e)},$69z:function(){_d.$1r.prototype.$69z.call(this);this.$pN.set_$GB(!1);this.$pN.remove_$7q(this.$$d_$99e)},$99e:function(n,t){t==="VMSelectedDate"?this.set_$91(this.$pN.get_$91()):t==="SelectedAgendaItem"&&this.$pN.$1jx&&this.$ZZ()}};_d.$10z=function(n,t,i){_d.$10z.initializeBase(this,[n]);this.$1B7=t;this.$1HT=i};_d.$10z.prototype={$1B7:null,$1HT:null,$ld:null,add_$2nH:function(n){this.$2N("CalendarColorsChanged",n)},remove_$2nH:function(n){this.$2P("CalendarColorsChanged",n)},get_$Jx:function(){return this.$ld},set_$Jx:function(n){this.$ld=n;return n},get_$4I5:function(){return _d.$JK.prototype.get_$4I5.call(this)},set_$4I5:function(n){_d.$JK.prototype.set_$4I5.call(this,n);this.$ld&&(this.$ld.$5M9=n);return n},get_$8Ea:function(){return this.$p.get_$B()},$7oQ:function(n){$CY(this,"CalendarColorsChanged",this,n)},$ZZ:function(){}};_d.$hS=function(n,t,i,r,u,f,e,o,s){_d.$hS.initializeBase(this,[n,t,i]);this.$Tg=s;this.$1A5=e;this.$Op=r;this.$25U=u;this.$pu=f;this.$4GT=o};_d.$hS.prototype={$Tg:0,$1A5:null,$4GT:null,$Op:null,$25U:null,$pu:null,$11:null,$1D1:!1,$1Nz:!1,get_$41B:function(){return this.$1D1},set_$41B:function(n){if(n!==this.$1D1){this.$1D1=n;$3(this,"IsItemContextMenuShown")}return n},get_$1qN:function(){return 4},get_$22:function(){return this.$11},set_$22:function(n){if(this.$11!==n){this.$11=n;$3(this,"SelectedItem")}return n},get_$148:function(){return this.$1Nz},set_$148:function(n){if(this.$1Nz!==n){this.$1Nz=n;$45(this,"IsDraggingItem","ShouldPeekBeEnabled")}return n},get_$9mW:function(){return!this.$1Nz&&this.$4GT.$C.get_$L()==="Mouse"},$ZZ:function(){this.set_$22(null)}};_d.$1Ks=function(n,t,i,r,u,f){this.$$d_$6F0=Function.createDelegate(this,this.$6F0);_d.$1Ks.initializeBase(this,[n,t,i,r,f]);this.$bN=u;$4mz(this)};_d.$1Ks.prototype={$42q:!1,$bN:null,$7fT:function(n,t){var i=new _d.$hS(t,this.$bN,this.$3jp,this.$Op,this.$25U,this.$pu,this.$1A5,this.$1h,n);i.$Y("SelectedItem",this.$$d_$6F0);return i},$6MM:function(){_d.$92.prototype.$6MM.call(this);var n=this.$1h.$Zc;if(n&&!this.get_$148()){var r=n.get_$y();var u=n.get_$1u();var i=this.get_$91().$4F();var f=i.$2o(1).$9K(-1);var e=new _h.$4e(r,u);if(!e.$2lv(i,f)){for(var t=0,o=this.$AL.length;t<o;t++)this.$AL[t].set_$22(null);this.$1h.set_$vv(null)}}},$698:function(){for(var n=0,t=this.$AL.length;n<t;n++)this.$AL[n].set_$148(this.get_$148());_d.$1r.prototype.$698.call(this)},$6F0:function(n,t){if(!this.$42q){this.$42q=!0;var i=n;var r;this.$1h.set_$vv(i.$11);for(var u=0,f=this.$AL.length;u<f;u++){r=this.$AL[u];r!==i&&r.set_$22(i.$11)}this.$42q=!1}}};_d.$92=function(n,t,i,r,u){this.$$d_$9BM=Function.createDelegate(this,this.$9BM);_d.$92.initializeBase(this,[n,!0,i,t,r,u]);this.$AL=new Array(6);this.add_$2nH(this.$$d_$9BM)};_d.$92.$1v8=function(n){var t=_a.$2D.$Mx(n,3);var i=new _a.$7(n.get_$3l(),n.get_$2z(),1,t[0].get_$DV(),t[0].get_$GJ(),t[0].get_$TR());t[1]=_a.$7.$Ky(i.$HM(1).$2o(-1)).$2o(7);return t};function $4mz(n){for(var r=_a.$2D.$Mx(n.get_$91(),3)[0],i,t=0;t<6;++t){i=r.$2o(t*7);n.$AL[t]=n.$7fT(t,i)}}function $4n0(n){var t=_d.$92.$1v8(n.get_$BJ());var i=new _h.$4e(t[0],t[1]);return!i.$lo(n.get_$91(),!0,!1)||!i.$4e(n.$ED)}function $4n1(n,t){n.set_$BJ(new _a.$7(n.get_$2fz().$65.get_$3l(),n.get_$2fz().$65.get_$2z(),1).$HM(t?1:-1))}function $4n2(n){for(var i=_a.$6.acss(_a.$0.$1k,"MonthVM:UpdateDisplayedDateInWeeks"),r=_a.$2D.$Mx(n.get_$BJ(),3)[0],t=0;t<6;++t)n.$AL[t].set_$y(r.$2o(t*7));_a.$6.aces(i)}_d.$92.prototype={$AL:null,$24w:null,$DW:!1,get_$1L:function(){return"MonthViewModel"},get_$Jx:function(){return _d.$1r.prototype.get_$Jx.call(this)},set_$Jx:function(n){_d.$1r.prototype.set_$Jx.call(this,n);for(var t=0,i=this.$AL.length;t<i;t++)this.$AL[t].$ld=n;return n},get_$ch:function(){return this.$DW},set_$ch:function(n){if(this.$DW!==n){this.$DW=n;$3(this,"IsTransitionedIn")}return n},get_$1B8:function(){return 3},get_$9DN:function(){return this.$24w},set_$9DN:function(n){if(n!==this.$24w){this.$24w=n;$3(this,"OnDateClickedCommand")}return n},get_$1qN:function(){return 4},$3Ey:function(){var n=_d.$92.$1v8(this.get_$BJ());this.set_$3mK(new _h.$4e(n[0],n[1]));_d.$1r.prototype.$3Ey.call(this)},$4Ur:function(n){_d.$1r.prototype.$4Ur.call(this,n);$4n2(this);$3W0(this,!0)},get_$4e3:function(){return this.$AL[0]},get_$4e4:function(){return this.$AL[1]},get_$2fz:function(){return this.$AL[2]},get_$4e5:function(){return this.$AL[3]},get_$4e6:function(){return this.$AL[4]},get_$4e7:function(){return this.$AL[5]},get_$3ur:function(){return 12},get_$4PH:function(){return this.get_$BJ().$2Z(2)},get_$2ju:function(){return String.format(_nbs.NonBootStrings.l_CalendarMonthView_AT_Region_Text,this.get_$4PH())},$5R6:function(){for(var t=0,n=0,i=this.$AL.length;n<i;n++)t+=this.$AL[n].get_$8Ea();return t},$7uo:function(){for(var r=0,n,t,i=0,u=this.$AL.length;i<u;i++){n=this.$AL[i];t=n.$p;t&&n.$2CD.$lo(this.get_$91(),!0,!0)&&(r+=$2gu(this,t))}return r},$5TW:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"MonthView_GoPrev",!0,!0));$4n1(this,!1)},$5TV:function(){this.set_$Jx(_d.$9A.$E(_a.$0.$1k,"MonthView_GoNext",!0,!0));$4n1(this,!0)},$ZZ:function(){_d.$1r.prototype.$ZZ.call(this);for(var n=0,t=this.$AL.length;n<t;n++)this.$AL[n].$ZZ()},$3sz:function(n){var t=_d.$92.$1v8(n);return new _h.$4e(t[0],t[1])},$3cb:function(n){for(var h=[],t,r,u,c=n.length,l=_a.$6.acss(_a.$0.$6y,"MonthVM:AddItems_"+c),f=0;f<6;++f)Array.add(h,this.$AL[f].$p.$6Yh());for(var e=0;e<c;++e){t=n[e];if(this.$1ka(t)){r=!t.get_$AW()&&t.get_$y().$4F().$2R(t.get_$1u().$4F())?$1nY(this,t,this.$Gi):[t];for(var i=0;i<6;++i)for(var o=0,a=r.length;o<a;++o){u=r[o];this.$AL[i].$2PL(u)&&h[i].$D(u)}}}for(var s=0;s<6;++s)this.$AL[s].$p.$5Kt();_a.$6.aces(l)},$IX:function(n){var r=_a.$6.acss(_a.$0.$6y,"MonthVM:AddItem");var t;if(this.$1ka(n))for(var i=0;i<6;++i){t=this.$AL[i];t.$2PL(n)&&t.$p.$D(n)}_a.$6.aces(r)},$Cl:function(n){for(var t,i=0;i<6;++i){t=this.$AL[i];t.$2PL(n)&&_d.$1r.$4QN(n,t.$p)}},$27W:function(){for(var n=0,t=this.$AL.length;n<t;++n)this.$AL[n].$p.$1r();_d.$1r.prototype.$27W.call(this)},$4c:function(){var n;this.remove_$2nH(this.$$d_$9BM);for(var t=0,i=this.$AL.length;t<i;t++){n=this.$AL[t];n&&n.$1Q()}_d.$1r.prototype.$4c.call(this)},$6a6:function(){$4n0(this)&&_d.$1r.prototype.$6a6.call(this)},$6MM:function(){$4n0(this)&&this.set_$3mK(this.$3sz(this.get_$BJ()))},$9i3:function(n){n.set_$y(this.get_$91().$4F());n.set_$1u(n.get_$y().$2o(1).$9K(-1));n.set_$5k(this.$1h.$Cb);return n},$1hc:function(n,t){_d.$1r.prototype.$1hc.call(this,n,t);$4n2(this);$3W0(this,!1)},$9BM:function(n,t){for(var i=0,r=this.$AL.length;i<r;i++)this.$AL[i].$7oQ(t)}};_d.$YM=function(n){this.$Bb=n};_d.$YM.prototype={$Bb:null};_d.$Fp=function(n,t,i,r,u){this.$$d_$6F1=Function.createDelegate(this,this.$6F1);this.$$d_$9BL=Function.createDelegate(this,this.$9BL);_d.$Fp.initializeBase(this,[n,t,r,u]);_a.$4.$J(i,"calendars");this.$4LX=i;this.$Fz=i.$3p();this.$4LX.add_$1Z(this.$$d_$9BL);this.set_$qk($6oy(this));this.$2U.add_$3UC(this.$$d_$6F1)};function $4jt(n,t){if(t.get_$9S()!=="Free"){var i=n.$Fz.$71(t.get_$5k());i>=0&&i<n.$Vq.get_$B()&&n.$Vq.get_$3q(i).set_$3dF($2gy(n,t.get_$5k()))}}function $6oy(n){for(var r=new _js.$Z,t,u=n.$ER[0].$4F(),i=0,f=n.$Fz.get_$B();i<f;i++){t=n.$Fz.get_$3q(i);r.$D(new _d.$9b(n.$2U.$1NE(t),u,t,$2gy(n,t)))}return r}function $2gy(n,t){for(var i,r=null,u=0,f=n.$CZ.get_$B();u<f;u++){i=n.$CZ.get_$3q(u);if(i.get_$5k().$4e(t)&&i.get_$9S()!=="Free"){r||(r=new(_0365f.$o.$$(_g.$Jl)));r.$D(i)}}return r}_d.$Fp.prototype={$Fz:null,$4LX:null,$13H:function(n){return this.$Fz.$71(n.get_$5k())},$2LM:function(n){return 1},$5TB:function(n){var t;var i,r;var u=this;var f=(r=this.$Vq.$3SK(function(t){return t.$Bb===n},i={val:t}),t=i.val,r);return t},$2Xd:function(n,t){for(var i=0,u=this.$Fz.get_$B();i<u;i++){var r=this.$Fz.get_$3q(i);var f=this.$Vq.get_$3q(i);f.$6di(r,$2gy(this,r),this.$5TB(r).$uh)}_d.$1K4.prototype.$2Xd.call(this,n,t)},$4c:function(){this.$2U.remove_$3UC(this.$$d_$6F1);this.$4LX.remove_$1Z(this.$$d_$9BL);_d.$1K4.prototype.$4c.call(this)},$6dz:function(){for(var n=0,t=this.$Fz.get_$B();n<t;n++)this.$Vq.get_$3q(n).set_$51(this.$ER[0].$4F())},$68Z:function(n,t){switch(t.$2v){case 0:for(var i=0,u=t.$2l.length;i<u;i++)$4jt(this,t.$2l[i]);break;case 2:for(var r=0,f=t.$38.length;r<f;r++)$4jt(this,t.$38[r]);break}},$9BL:function(n,t){var i;var r=t.$4V;switch(t.$2v){case 0:for(var f=t.$2l,u=r,o=r+f.length;u<o;u++){var s=u-r;i=f[s];this.$Fz.$72(u,i);this.$Vq.$72(u,new _d.$9b(this.$2U.$1NE(i),this.$ER[0].$4F(),i,$2gy(this,i)))}break;case 2:for(var e=0,h=t.$38.length;e<h;e++){this.$Fz.$68(r);this.$Vq.$68(r)}break;default:break}$N(this,"ColumnCount")},$6F1:function(n){for(var i,t=0,r=this.$Fz.get_$B();t<r;t++)if(_g.$9G.isInstanceOfType(this.$Fz.get_$3q(t))){i=this.$Fz.get_$3q(t);i.get_$D2()===n&&this.$Vq.get_$3q(t).set_$6gl(this.$2U.$1NE(i))}}};_d.$9b=function(n,t,i,r){this.$$d_$9D8=Function.createDelegate(this,this.$9D8);_d.$9b.initializeBase(this);_a.$4.$J(n,"workingHoursModel");_a.$4.$J(t,"date");this.$uh=n;this.$7h=t;this.set_$1k(i);this.$114=[];this.set_$3dF(r);$2h1(this)};function $2h1(n){n.$2O4=$4jz(n,n.$uh.get_$1VS(),0);n.$2O3=$4jz(n,n.$uh.get_$4eL(),1440)}function $4k0(n){n.set_$bv(n.$Bb?n.$Bb.$Kh:-1)}function $4jz(n,t,i){return n.$uh.$8EK(n.$7h.$BX(1440-t).get_$Dr())?(1440+t)%1440:i}function $4jy(n,t){Array.clear(n.$114);if(t){$2h0(n,t,n.$114,"OOF");$2h0(n,t,n.$114,"Busy");$2h0(n,t,n.$114,"Tentative");$2h0(n,t,n.$114,"WorkingElsewhere")}}function $2h0(n,t,i,r){for(var u,e=i.length,f=0,o=t.get_$B();f<o;f++){u=t.get_$3q(f);u.get_$9S()===r&&$6p6(n,i,e,u)}}function $6p6(n,t,i,r){for(var u,f=null,e=i;e<t.length;e++){u=t[e];if(r.get_$y().$2R(u.$8B)<0&&r.get_$1u().$2R(u.$6r)>0)if(f){Array.addRange(f.$p,u.$p);Array.removeAt(t,e);e--}else{f=u;f.$D(r)}}if(!f){u=new _d.$uN;u.$D(r);Array.add(t,u)}}_d.$9b.prototype={$uh:null,$bu:0,$Bb:null,$2O4:0,$2O3:0,$7h:null,$CZ:null,$114:null,$2xE:!1,get_$1k:function(){return this.$Bb},set_$1k:function(n){if(this.$Bb!==n){this.$Bb&&this.$Bb.$u("AssignedCalendarColor",this.$$d_$9D8);n&&n.$Y("AssignedCalendarColor",this.$$d_$9D8);this.$Bb=n;$4k0(this)}return n},get_$51:function(){return this.$7h},set_$51:function(n){_a.$4.$J(n,"date");if(!_a.$7.$4N(this.$7h,n)){this.$7h=n;$2h1(this);$3(this,"Date")}return n},get_$6gl:function(){return this.$uh},set_$6gl:function(n){if(this.$uh!==n){this.$uh=n;$2h1(this);$3(this,"WorkingHoursModel")}return n},get_$82c:function(){return this.$2xE},set_$82c:function(n){if(this.$2xE!==n){this.$2xE=n;$3(this,"ResponseMessage")}return n},get_$8EL:function(){return this.$2O4<=this.$2O3},get_$bv:function(){return this.$bu},set_$bv:function(n){if(this.$bu!==n){this.$bu=n;$3(this,"CalendarColor")}return n},get_$3dF:function(){return this.$CZ},set_$3dF:function(n){if(this.$CZ!==n){this.$CZ=n;$4jy(this,this.$CZ);$3(this,"AllDayItems")}return n},$6di:function(n,t,i){_a.$4.$J(i,"workingHours");_a.$4.$J(n,"calendar");this.set_$1k(n);this.$uh=i;$4jy(this,t);$2h1(this);$3(this,"CalendarProperties")},$9D8:function(n,t){$4k0(this)}};_d.$Vj=function(n,t){this.$TO=n;this.$JH=t};_d.$Vj.prototype={$TO:0,$JH:0,$4e:function(n){if(n){var t=n;return this.$TO===t.$TO&&this.$JH===t.$JH}return!1}};_d.$nU=function(n,t){_a.$4.$J(n,"selectionStart");_a.$4.$J(t,"selectionEnd");this.$LU=new _d.$Vj(Math.min(n.$TO,t.$TO),Math.min(n.$JH,t.$JH));this.$1kD=new _d.$Vj(Math.max(n.$TO,t.$TO),Math.max(n.$JH,t.$JH))};_d.$nU.prototype={$LU:null,$1kD:null,$4e:function(n){if(n&&Object.getType(n).isInstanceOfType(this)){var t=n;return this.$LU.$4e(t.$LU)&&this.$1kD.$4e(t.$1kD)}return!1}};_d.$HD=function(n,t,i,r,u){this.$$d_$6F1=Function.createDelegate(this,this.$6F1);this.$$d_$69l=Function.createDelegate(this,this.$69l);_d.$HD.initializeBase(this,[n,t,r,u]);this.$1h=i;this.$1Yk=$6(i.$Cb)?_cc.$1Q.$3Eb:r.$1NE(i.$Cb);this.set_$qk($4lF(this));i.$Y("CurrentCalendarModel",this.$$d_$69l);this.$2U.add_$3UC(this.$$d_$6F1)};function $4lF(n){for(var i=new _js.$Z,t=0,r=n.$ER.length;t<r;t++)i.$D(new _d.$9b(n.$1Yk,n.$ER[t].$4F(),n.$1h.$Cb,$3WN(n,n.$ER[t])));return i}function $3WN(n,t){if(!n.$1h.$Cb)return null;for(var i,r=null,u=0,f=n.$CZ.get_$B();u<f;u++){i=n.$CZ.get_$3q(u);if(i.get_$5k()&&i.get_$5k().$4e(n.$1h.$Cb)&&i.get_$9S()!=="Free"&&i.get_$y().$93(t)<=0&&i.get_$1u().$9K(-1).$93(t)>=0){r||(r=new(_0365f.$o.$$(_g.$Jl)));r.$D(i)}}return r}function $4lG(n){for(var t=0,i=n.$Vq.get_$B();t<i;t++){var r=n.$Vq.get_$3q(t);r.$6di(n.$1h.$Cb,$3WN(n,n.$ER[t]),n.$1Yk)}}_d.$HD.prototype={$1h:null,$1Yk:null,$13H:function(n){for(var t=0,i=this.$ER.length;t<i;t++)if(n.get_$y().$2R(this.$ER[t].$2o(1))<0)return t;return-1},$2LM:function(n){for(var i=this.$13H(n),t=i+1;t<this.$ER.length&&n.get_$1u().$9K(-1).$2R(this.$ER[t])>0;)t++;return t-i},$4c:function(){this.$2U.remove_$3UC(this.$$d_$6F1);this.$1h.$u("CurrentCalendarModel",this.$$d_$69l);_d.$1K4.prototype.$4c.call(this)},$6dz:function(){if(this.$ER.length===this.$Vq.get_$B())for(var n=0,t=this.$ER.length;n<t;n++)this.$Vq.get_$3q(n).set_$51(this.$ER[n].$4F());else this.set_$qk($4lF(this))},$68Z:function(n,t){for(var i=0,r=this.$ER.length;i<r;i++)this.$Vq.get_$3q(i).set_$3dF($3WN(this,this.$ER[i]))},$2Xd:function(n,t){$4lG(this);_d.$1K4.prototype.$2Xd.call(this,n,t)},$69l:function(n,t){if(this.$1h.$Cb){this.$1Yk=this.$2U.$1NE(this.$1h.$Cb);$4lG(this)}},$6F1:function(n){if(_g.$9G.isInstanceOfType(this.$1h.$Cb)){var i=this.$1h.$Cb;if(i.get_$D2()===n){this.$1Yk=this.$2U.$1NE(i);for(var r,t=0,u=this.$Vq.get_$B();t<u;t++){r=this.$Vq.get_$3q(t);r.set_$6gl(this.$1Yk)}}}}};_d.$1K4=function(n,t,i,r){this.$$d_$2Xd=Function.createDelegate(this,this.$2Xd);this.$$d_$68Z=Function.createDelegate(this,this.$68Z);_d.$1K4.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;this.dispose=this.$1Q;_d.$1K4.initializeBase(this);_a.$4.$J(n,"dateRange");this.$ER=n;this.$2U=i;this.$CZ=t;this.$CZ.add_$1Z(this.$$d_$68Z);this.$c=r;this.$c.get_$1I().get_$Nl().$Y("WorkDays",this.$$d_$2Xd)};_d.$1K4.prototype={$CZ:null,$2U:null,$Vq:null,$hz:0,$ER:null,$c:null,get_$bG:function(){return this.$ER},set_$bG:function(n){if(this.$ER!==n){this.$ER=n;this.$6dz();$N(this,"SelectedDateRange")}return n},get_$JI:function(){return this.$hz},set_$JI:function(n){if(this.$hz!==n){this.$hz=n;$N(this,"ColumnWidth")}return n},get_$pn:function(){return this.$Vq.get_$B()},get_$qk:function(){return this.$Vq},set_$qk:function(n){if(this.$Vq!==n){this.$Vq=n;$N(this,"GridColumnViewModelCollection")}return n},$2Xd:function(n,t){this.$6dz()},$4c:function(){this.$c.get_$1I().get_$Nl().$u("WorkDays",this.$$d_$2Xd);_js.$8.prototype.$4c.call(this)}};_d.$D9=function(){_d.$D9.initializeBase(this)};_d.$D9.prototype={get_$19v:function(){return this.$U(_d.$D9.$3ej)},set_$19v:function(n){this.$K(_d.$D9.$3ej,n);return n},get_$1l:function(){return this.$U(_d.$D9.$1MK)},set_$1l:function(n){this.$K(_d.$D9.$1MK,n);return n},get_$Bj:function(){return this.$U(_d.$D9.$1z1)},set_$Bj:function(n){this.$K(_d.$D9.$1z1,n);return n},get_$241:function(){return null},get_$4O6:function(){return null}};_d.$4r=function(n,t,i,r,u,f,e){this.$$d_$68k=Function.createDelegate(this,this.$68k);this.$$d_$6DU=Function.createDelegate(this,this.$6DU);this.$$d_$4Im=Function.createDelegate(this,this.$4Im);_d.$4r.initializeBase(this,[f,n,t,i,r,u,e])};_d.$4r.$1YR=function(n,t,i){var r=new _d.$D9;r.set_$1l(n);r.set_$19v(t);r.set_$Bj(i);return r};function $6oQ(n,t){var i=new _js.$Z;var r=this;n.$1T.$Bh(function(n){var r=n.$5A;t===r.$ZP&&i.$D(n)});return i}function $3Vv(n,t){$4ja(n,!1);if(t){n.$2e.get_$7S().$1r();n.$2e.get_$8W().$1r();n.$2e.get_$9F().$1r();$4jZ(n,t)}else{$3Vu(n,n.$2e.get_$7S(),0);$3Vu(n,n.$2e.get_$8W(),1);$3Vu(n,n.$2e.get_$9F(),2)}}function $4ja(n,t){t||n.$1T.remove_$1Z(n.$$d_$6DU);n.$1T.$1r();t||n.$1T.add_$1Z(n.$$d_$6DU)}function $3Vu(n,t,i){for(var r=0;r<t.get_$B();r++){var u=_d.$4r.$1YR(t.get_$3q(r).get_$7B(),i,!0);$3Vt(n,u,!1)}}function $4jZ(n,t){for(var i=0;i<t.get_$B();i++)$3Vt(n,t.get_$3q(i),!0)}function $3Vt(n,t,i){i||n.$1T.remove_$1Z(n.$$d_$6DU);if(t.get_$Bj()){var r=n.$5C.$lx(_pc.$i.$DQ(t.get_$1l()),n.$1Sd,!0,n.$26z);r.set_$19v(t.get_$19v());r.$Y("AttendeeType",n.$$d_$68k);n.$1Jl(r)}else n.$2EC(_pc.$i.$DQ(t.get_$1l()));i||n.$1T.add_$1Z(n.$$d_$6DU)}function $4jd(n,t){switch(t){case 0:return n.$2e.get_$7S().get_$A5d();case 1:return n.$2e.get_$8W().get_$A5d();case 2:return n.$2e.get_$9F().get_$A5d();default:throw Error.argumentOutOfRange("Unknown AttendeeTypeType: "+_d.$n8.toString(t));}}function $6oR(n,t){switch(t){case 0:return 1;case 1:return 0;default:throw Error.invalidOperation("Operation supported only for Required and Optional Attendees");}}function $4je(n,t){var i=$4jd(n,t.get_$19v());var r=t.get_$1l();var u=this;i.$DY(function(n){if(_g.$2L.$4e(r,n.get_$7B())){i.$34(n);return!0}return!1})}function $4jY(n,t){var i=$4jd(n,t.get_$19v());i.$D(_g.$3i.$wR(t.get_$1l()))}function $6oS(n,t){switch(t.$2v){case 0:var i=this;Array.forEach(t.$2l,function(t){t.$5A.$Y("AttendeeType",n.$$d_$68k);var i=t.$5A;var r=_d.$4r.$1YR(i.$Zu(),i.$ZP,t.$N7);$4jY(n,r)});break;case 2:var r=this;Array.forEach(t.$38,function(t){var i=t.$5A;i.$u("AttendeeType",n.$$d_$68k);var r=t.$5A.$Zu();var u=_d.$4r.$1YR(r,i.$ZP,t.$N7);$4je(n,u)});break;case 3:case 4:throw Error.invalidOperation("People Picker only supports adding and removing attendees from the underlying recipient well.");}}function $4jc(n,t){var i=new _js.$Z;var r=this;t.$Bh(function(t){i.$D($4jb(n,t))});return i}function $4jb(n,t){var i=t.$5A;var r=_d.$4r.$5HH;_d.$LE.isInstanceOfType(i)&&(r=i.$ZP);return _d.$4r.$1YR(i.$Zu(),r,t.$N7)}_d.$4r.prototype={$2e:null,get_$4Mt:function(){return $6oQ(this,0)},set_$4Mt:function(n){var t=$4jc(this,n);if(this.$4VY!=="TouchNarrow"){var i=this;this.$1T.$Bh(function(n){var r=$4jb(i,n);r.get_$19v()&&t.$D(r)});$4ja(this,!0)}$4jZ(this,t);return n},get_$58y:function(){return this.$2e},set_$58y:function(n){if(this.$2e){this.$2e.$u("RequiredAttendees",this.$$d_$4Im);this.$2e.$u("OptionalAttendees",this.$$d_$4Im);this.$2e.$u("Resources",this.$$d_$4Im)}this.$2e=n;if(this.$2e){this.$2e.$Y("RequiredAttendees",this.$$d_$4Im);this.$2e.$Y("OptionalAttendees",this.$$d_$4Im);this.$2e.$Y("Resources",this.$$d_$4Im)}return n},$49:function(n,t){this.set_$58y(n);this.$1T.add_$1Z(this.$$d_$6DU);$3Vv(this,t)},$7rj:function(){this.$1Bw();return $4jc(this,this.$1T)},$7OK:function(n){if(n){var t=_d.$4r.$1YR(n,2,!0);$3Vt(this,t,!1)}},$9bO:function(n){if(n){var i=this;var t=this.$1T.$DY(function(t){return _g.$2L.$4e(n,t.$5A.$Zu())});t<this.$1T.get_$B()&&this.$3KX(this.$1T.get_$3q(t).$5A)}},$7WW:function(n){n?n===1?this.$2e.get_$8W().$1r():n===2&&this.$2e.get_$9F().$1r():this.$2e.get_$7S().$1r();$3Vv(this)},$4c:function(){this.set_$58y(null);this.$1T.remove_$1Z(this.$$d_$6DU);_d.$32.prototype.$4c.call(this)},$4Im:function(n,t){$3Vv(this)},$6DU:function(n,t){$6oS(this,t)},$68k:function(n,t){var r=!0;var i=n;var u=$6oR(this,i.$ZP);var f=_d.$4r.$1YR(i.$Zu(),u,r);$4je(this,f);var e=_d.$4r.$1YR(i.$Zu(),i.$ZP,r);$4jY(this,e)}};_d.$n7=function(n,t,i){this.$C=t;this.$zp=n;this.$537=i};_d.$n7.prototype={$C:null,$537:null,$zp:null,$E:function(){return new _d.$4r(7,_y.$w.$Mf,null,!0,this.$zp,this.$C.get_$L(),this.$537)}};_d.$DD=function(n,t,i,r,u){this.$$d_$9dJ=Function.createDelegate(this,this.$9dJ);this.$$d_$6Oc=Function.createDelegate(this,this.$6Oc);this.$$d_$7gD=Function.createDelegate(this,this.$7gD);_d.$DD.initializeBase(this,[t,i,r,u]);this.$2e=n;this.$Lj=this.$9w.get_$BD();this.$3co="AddRoom_ComposeForm"};function $4kc(n){var t=new _h.$4e(n.$2e.get_$y(),n.$2e.get_$1u());n.$Nw.set_$Lk(n.$2e.get_$y());n.$Nw.set_$5kG(n.$2e.get_$y().$4F());n.$9w.set_$bG(t)}function $3WC(n){var t=n.$2e.get_$9F();$4jS(n);t&&t.get_$B()>0?n.$9w.set_$BD(t.get_$3q(0).get_$7B()):n.$9w.set_$BD(null);$4jR(n);n.$Lj=n.$9w.get_$BD();$3Vr(n)}function $3WA(n){n.set_$5GG(n.$2e.get_$9F())}function $3WB(n){n.set_$5GG(null)}_d.$DD.prototype={$2e:null,$Lj:null,$1Yi:null,add_$9Nl:function(n){this.$2N("OnRoomSelectionChanged",n)},remove_$9Nl:function(n){this.$2P("OnRoomSelectionChanged",n)},$5j:function(){if(!this.$us){_d.$ES.prototype.$5j.call(this);$3WC(this);$4kc(this)}},$6MR:function(){_d.$ES.prototype.$6MR.call(this);this.$2e.$Y("Start",this.$$d_$7gD);this.$2e.$Y("End",this.$$d_$7gD);this.$2e.$Y("Resources",this.$$d_$6Oc);$3WA(this)},$4cE:function(){$3WB(this);this.$2e.$u("Start",this.$$d_$7gD);this.$2e.$u("End",this.$$d_$7gD);this.$2e.$u("Resources",this.$$d_$6Oc);_d.$ES.prototype.$4cE.call(this)},get_$5GG:function(){return this.$1Yi},set_$5GG:function(n){if(this.$1Yi!==n){this.$1Yi&&this.$1Yi.remove_$1Z(this.$$d_$9dJ);this.$1Yi=n;this.$1Yi&&this.$1Yi.add_$1Z(this.$$d_$9dJ)}return n},$7gD:function(n,t){$4kc(this)},$6Rj:function(n,t){_d.$ES.prototype.$6Rj.call(this,n,t);var i=this.$Lj;this.$Lj=this.$9w.get_$BD();$3WB(this);i&&this.$2e.get_$9F().get_$B()>0&&this.$2e.get_$9F().get_$3q(0).get_$7B().EmailAddress===i.EmailAddress&&this.$2e.get_$9F().$68(0);this.$Lj&&this.$2e.get_$9F().$72(0,_g.$3i.$wR(this.$Lj));$3WA(this);var r=this.$iW("OnRoomSelectionChanged");r&&r(i,this.$Lj)},$6Oc:function(n,t){$3WB(this);$3WA(this);$3WC(this)},$9dJ:function(n,t){$3WC(this);t.$2v===2&&t.$38.length===1&&t.$38[0].get_$7B().Name===this.$2e.get_$4j().get_$1o()&&this.$2e.set_$4j(_g.$3Y.$vn())}};_d.$nt=function(n,t,i,r){this.$2Kg=n;this.$3TF=t;this.$27g=i;this.$C=r};_d.$nt.prototype={$3TF:null,$27g:null,$2Kg:null,$C:null,$E:function(n){var u=_cc.$1Q.$5EQ(!0);var t=this.$3TF.$E(n,u);var r=this.$27g.$5EM(n,t);var i=this.$27g.$E(n,t,r);t.set_$6QS(i);var f=this.$2Kg.$7cb(i,r);return new _d.$DD(n.$t,t,i,f,this.$C)}};_d.$JY=function(n,t,i,r,u,f){this.$$d_$4KT=Function.createDelegate(this,this.$4KT);this.$$d_$6DU=Function.createDelegate(this,this.$6DU);this.$$d_$9AP=Function.createDelegate(this,this.$9AP);this.$$d_$3r7=Function.createDelegate(this,this.$3r7);this.$$d_$3L4=Function.createDelegate(this,this.$3L4);this.$$d_$5gm=Function.createDelegate(this,this.$5gm);_d.$JY.initializeBase(this);this.$C=r;this.$k=u;this.$2e=n;this.$6Q=i;this.$1T0=t;this.$451=new _C(this.$$d_$5gm,_a.$0.$dO);this.$1J=f;var e=this;this.$3L3=new _C(this.$$d_$3L4,_a.$0.$1k,this,"IsRecipientWellPopulated",function(){return e.get_$5dX()})};function $4kd(n){if(n.$2Nc){n.$L0=new _d.$12m(n.$D5,n.$2Nc,n.$k,n.$1J);$2h4(n)}}function $2h4(n,t){n.$L0&&n.$L0.$18h(t)}_d.$JY.prototype={$2e:null,$C:null,$6Q:null,$1T0:null,$451:null,$k:null,$3L3:null,$1J:null,$D5:null,$2Nc:null,$L0:null,$2kz:null,$3SY:null,$QM:null,get_$4Pd:function(){return this.$D5},set_$4Pd:function(n){if(this.$D5===n)return n;if(this.$D5){this.$D5.$2r.$u("QueryString",this.$$d_$3r7);this.$D5.remove_$np(this.$$d_$9AP);this.$D5.$2r.set_$2q9(null);this.$D5.$1T.remove_$1Z(this.$$d_$6DU);this.$D5.$1Q()}this.$D5=n;if(this.$D5){this.$D5.$2r.$Y("QueryString",this.$$d_$3r7);this.$D5.add_$np(this.$$d_$9AP);this.$D5.$2r.set_$2q9(this.$3L3);this.$D5.$1T.add_$1Z(this.$$d_$6DU);$4kd(this);this.$3r7()}$3(this,"RecipientWellViewModel");return n},$49:function(n){this.set_$4Pd(this.$6Q.$E());this.$D5.$49(this.$2e,n)},get_$85G:function(){return this.$2Nc},set_$85G:function(n){if(this.$2Nc!==n){this.$2Nc=n;$4kd(this)}return n},get_$mU:function(){return this.$D5.$1Nt||!_js.$9.$a(this.$D5.$2r.$2s)},get_$5dX:function(){return!!this.$D5&&(this.$D5.$1T.get_$B()>0||!_js.$9.$a(this.$D5.$2r.$2s))},$3L4:function(n,t){$2h4(this);this.$2kz=n;this.$3SY=t;this.$D5.$1uF()},$4c:function(){this.set_$4Pd(null);if(this.$QM){this.$QM.remove_$1jh(this.$$d_$4KT);this.$QM.$1Q();this.$QM=null}_a.$1.prototype.$4c.call(this)},$9AP:function(n){$2h4(this,!0);if(n){if(this.$2kz){this.$2kz();this.$2kz=null}}else if(this.$3SY){this.$3SY();this.$3SY=null}},$5gm:function(){this.$D5.$1Bw();_a.$g.$8s.$D("VM.PeoplePicker.Launched",_a.$7.get_$29());if(this.$QM)this.$QM.$6eO(this.$D5.get_$4Mt());else{this.$QM=this.$1T0.$5FN(this.$D5.get_$4Mt(),_nbs.NonBootStrings.l_RichPeoplePickerRequired_Text);this.$QM.add_$1jh(this.$$d_$4KT)}this.$C.$7X(this.$QM)},$4KT:function(n){this.$D5.set_$4Mt(n)},$3r7:function(n,t){$3(this,"IsRecipientWellPopulated")},$6DU:function(n,t){$2h4(this);this.$3r7()}};_d.$ty=function(n){this.$1Gw=new(_0365f.$o.$$(_y.$2T));this.$1Gw.$D(n)};_d.$ty.prototype={$1Gw:null,get_$Ym:function(){return this.$1Gw}};_d.$12m=function(n,t,i,r){_d.$12m.initializeBase(this,[t]);this.$D5=n;this.$46P=new _d.$46(i,new _d.$ty(n),t,r);this.$46P.$49()};_d.$12m.prototype={$D5:null,$46P:null,$3zK:!1,$18h:function(n){this.$3zK=n;_d.$Cm.prototype.$18h.call(this);this.$3zK=!1},$8Gf:function(){this.$TE=[67]},$7qZ:function(){this.$3zK&&this.$D5.$1Nt&&this.$w.$2a(67);this.$46P.$2e1()}};_d.$nu=function(n,t,i,r,u){this.$6Q=n;this.$1T0=t;this.$C=i;this.$k=r;this.$1J=u};_d.$nu.prototype={$1J:null,$C:null,$k:null,$6Q:null,$1T0:null,$E:function(n){return new _d.$JY(n,this.$1T0.get_$1g(),this.$6Q,this.$C,this.$k,this.$1J)}};_d.$LX=function(n){this.$Mi=n};_d.$LX.$4PZ=function(n){switch(n){case 0:return 0;case 1:return 1;default:throw Error.invalidOperation("Attendee type not supported");}};function $4ke(n,t,i){var u=n.$Mi.$X3.$D5;if(u.$1T.get_$B()+i.get_$B()>100)return!1;for(var r=0;r<i.get_$B();r++){var f=i.get_$3q(r);var e=u.$2EF(f);e.set_$19v(t)}return!0}_d.$LX.prototype={$Mi:null,$2Lm:function(){return this.$Mi.$o.$t.get_$4j().get_$1o()},$9jo:function(n){this.$Mi.$o.$t.set_$4j(_g.$3Y.$11t(n))},$53q:function(n,t){t.val=0;var r=_y.$AT.$3kD(n);if(this.$Mi.$5t){var i=new(_0365f.$o.$$(_y.$jM));this.$Mi.$5t.$1op(r,i);if(!i.get_$B()){_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$3q(0)}else{_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - max number exceeded.");t.val=9001;return null}},$53h:function(n,t,i){i.val=0;var r=this.$Mi.$5t;if(r){var u=new _d.$10q(n,t);return r.$53i(u)}_js.Trace.logError(_a.$0.$5d,"ComposeFormNotReadyForAttachments in calendar module");i.val=9015;return null},$7wt:function(n){for(var r=new _js.$Z,i=this.$Mi.$X3.$D5.$1T,u=_d.$LX.$4PZ(n),t=0;t<i.get_$B();t++)u===i.get_$3q(t).$5A.$ZP&&r.$D(i.get_$3q(t));return r},$9kQ:function(n,t){var i=_d.$LX.$4PZ(n);this.$Mi.$X3.$D5.$7WW(i);$4ke(this,i,t)},$9wy:function(n,t){return $4ke(this,_d.$LX.$4PZ(n),t)},$9kn:function(n){this.$Mi.$o.$t.set_$2i(n)},$13P:function(){return this.$Mi.$o.get_$2i()},$2wS:function(){return this.$Mi.$Lo.$pv.$2Q},$2vf:function(){return this.$Mi.$Lo.$pv.$3D},$9kl:function(n){var t=this.$Mi.$Lo;var i=t.$f7===-1;t.set_$f8(-2);t.set_$y(n);if(i){var r=n.$2EB(24);t.set_$1u(r)}},$9xT:function(n){var t=this.$Mi.$Lo;if(t.$f7===-1){var i=t.get_$y();var u=new _a.$7(i.get_$3l(),i.get_$2z(),i.get_$51(),0,0,0,0,i.$MX);t.set_$f8(-2);t.set_$y(u)}var r=n.$5z(t.get_$y());if(r<0)return!1;if(r>72e5||r%18e5){t.set_$f8(-2);t.set_$1u(n)}else t.set_$f8(r);return!0},$86k:function(n){var t=new _d.$pn(n,!0);this.$Mi.set_$JO(t)},$9W5:function(n){var t=new _d.$re(n);this.$Mi.set_$JO(t)},$2vN:function(){return this.$Mi.$1ya?"HTML":"Text"},$2Ll:function(){var n=this.$Mi.$o.$t.get_$i();return n?n.Id:null},$3t5:function(){this.$Mi.$o.$t.get_$Gm()||this.$Mi.$o.$t.set_$Gm(new(_a.$1s.$$(_g.$Kj,_g.$Cq)));return this.$Mi.$o.$t.get_$Gm().get_$A5d()},$8IS:function(){this.$Mi.$5jN()},$9sA:function(){var n=new _y.$a8(null);this.$Mi.set_$JO(n)},$7Vb:function(n){var t=new _y.$a8(n);this.$Mi.set_$JO(t)}};_d.$88=function(n){_d.$88.initializeBase(this);if(!$6(n)){$6(n.$t.$Hy)||n.$t.$Hy.$n();this.set_$6n(n.$t.$3p());this.set_$1Rg(n.$6d.$3p())}};_d.$88.$$cctor=function(){_d.$88.$2mO.set_$Gu(new _a.$EC(_d.$D9))};_d.$88.prototype={get_$6n:function(){return this.$U(_d.$88.$1qI)},set_$6n:function(n){this.$K(_d.$88.$1qI,n);return n},get_$1Rg:function(){return this.$U(_d.$88.$4LW)},set_$1Rg:function(n){this.$K(_d.$88.$4LW,n);return n},get_$2mN:function(){return this.$U(_d.$88.$2mO)},set_$2mN:function(n){this.$K(_d.$88.$2mO,n);return n},get_$Cx:function(){return this.$U(_d.$88.$1xO)},set_$Cx:function(n){this.$K(_d.$88.$1xO,n);return n},get_$2L1:function(){return this.$U(_d.$88.$3rp)},set_$2L1:function(n){this.$K(_d.$88.$3rp,n);return n},get_$241:function(){return!$6(this.get_$1Rg())&&!$6(this.get_$1Rg().get_$i())?[this.get_$1Rg()]:null},get_$4O6:function(){return null}};_d.$nv=function(n,t,i,r){_d.$nv.initializeBase(this,[r]);this.$2e=n;this.$1y3=t;this.$2Ju=i};function $6qV(n){if(!n.$1y3)if(n.$2e.get_$Pk())n.$w.$2a(4800);else if(n.$2e.get_$GC()&&n.$2Ju.$2M){var t=n.$2Ju.get_$OD();n.$w.$JC(4700,null,_nbs.NonBootStrings.l_EditSeries_Text,t)}}_d.$nv.prototype={$2e:null,$1y3:!1,$2Ju:null,$8Gf:function(){this.$TE=[6200,4600,975,4800,4700]},$7qZ:function(){this.$2e.get_$JW()&&this.$2e.get_$1k()&&!this.$2e.get_$5Lx()&&this.$w.$2a(975);$3W4(this,this.$2e,!0);$6qV(this)}};_d.$Vu=function(n){this.$3K=n||{}};_d.$Vu.prototype={$3K:null,get_$2i:function(){return this.$3K.Subject},set_$2i:function(n){this.$3K.Subject=n;return n},get_$4j:function(){return this.$3K.Location},set_$4j:function(n){this.$3K.Location=n;return n},get_$3C:function(){return this.$3K.Body},set_$3C:function(n){this.$3K.Body=n;return n},get_$y:function(){return this.$3K.Start},set_$y:function(n){this.$3K.Start=n;return n},get_$2L1:function(){return this.$3K.ForceDirty?Boolean.parse(this.$3K.ForceDirty):!1},set_$2L1:function(n){this.$3K.ForceDirty=n.toString();return n},get_$DS:function(){var n=this.$3K.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DS:function(n){this.$3K.Duration=n;return n},get_$1KW:function(){if($6(this.$3K.CalendarId))return null;return new _g.$3S(this.$3K.CalendarId)},set_$1KW:function(n){$6(n)?delete this.$3K.CalendarId:this.$3K.CalendarId=n.Id;return n},get_$7S:function(){return this.$3K.RequiredAttendees},set_$7S:function(n){this.$3K.RequiredAttendees=n;return n},get_$8W:function(){return this.$3K.OptionalAttendees},set_$8W:function(n){this.$3K.OptionalAttendees=n;return n},get_$3O9:function(){var n="Busy";if($6(this.$3K.ShowAs))return n;try{n=this.$3K.ShowAs}catch(t){}return n},set_$3O9:function(n){this.$3K.ShowAs=n;return n},get_$QH:function(){return this.$3K.ReminderIsSet?Boolean.parse(this.$3K.ReminderIsSet):!0},set_$QH:function(n){this.$3K.ReminderIsSet=n.toString();return n},get_$5V:function(){return $6(this.$3K.IsAllDayEvent)?!1:Boolean.parse(this.$3K.IsAllDayEvent)},set_$5V:function(n){this.$3K.IsAllDayEvent=n.toString();return n},$7Vq:function(n){return n in this.$3K}};_d.$13=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.$$d_$9Ni=Function.createDelegate(this,this.$9Ni);this.$$d_$56h=Function.createDelegate(this,this.$56h);this.$$d_$3eI=Function.createDelegate(this,this.$3eI);this.$$d_$5YE=Function.createDelegate(this,this.$5YE);this.$$d_$10y=Function.createDelegate(this,this.$10y);this.$$d_$3Ex=Function.createDelegate(this,this.$3Ex);this.$$d_$9VF=Function.createDelegate(this,this.$9VF);this.$$d_$9Nc=Function.createDelegate(this,this.$9Nc);this.$$d_$9Nd=Function.createDelegate(this,this.$9Nd);this.$$d_$4X=Function.createDelegate(this,this.$4X);this.$$d_$9Hf=Function.createDelegate(this,this.$9Hf);this.$$d_$A0a=Function.createDelegate(this,this.$A0a);this.$$d_$3G0=Function.createDelegate(this,this.$3G0);this.$$d_$6Oc=Function.createDelegate(this,this.$6Oc);this.$$d_$7Tm=Function.createDelegate(this,this.$7Tm);this.$$d_$89g=Function.createDelegate(this,this.$89g);this.$$d_$9B7=Function.createDelegate(this,this.$9B7);this.$$d_$2p8=Function.createDelegate(this,this.$2p8);this.$$d_$6OJ=Function.createDelegate(this,this.$6OJ);this.$$d_$68d=Function.createDelegate(this,this.$68d);this.$$d_$68f=Function.createDelegate(this,this.$68f);this.$$d_$4Jb=Function.createDelegate(this,this.$4Jb);this.$$d_$9HV=Function.createDelegate(this,this.$9HV);this.$$d_$9zu=Function.createDelegate(this,this.$9zu);this.$$d_$9VA=Function.createDelegate(this,this.$9VA);this.$$d_$563=Function.createDelegate(this,this.$563);this.$$d_$99b=Function.createDelegate(this,this.$99b);this.$$d_$5Yi=Function.createDelegate(this,this.$5Yi);this.$$d_$5JA=Function.createDelegate(this,this.$5JA);this.$$d_$9ym=Function.createDelegate(this,this.$9ym);this.$$d_$9N3=Function.createDelegate(this,this.$9N3);this.$$d_$6DV=Function.createDelegate(this,this.$6DV);this.$$d_$9EL=Function.createDelegate(this,this.$9EL);this.$$d_$3FC=Function.createDelegate(this,this.$3FC);this.$$d_$7dw=Function.createDelegate(this,this.$7dw);this.$$d_$4JD=Function.createDelegate(this,this.$4JD);this.$$d_$7RU=Function.createDelegate(this,this.$7RU);this.$$d_$bB=Function.createDelegate(this,this.$bB);this.$$d_$sx=Function.createDelegate(this,this.$sx);this.$$d_$7cB=Function.createDelegate(this,this.$7cB);this.$$d_$9Sh=Function.createDelegate(this,this.$9Sh);this.$$d_$9Sg=Function.createDelegate(this,this.$9Sg);this.$$d_$A1t=Function.createDelegate(this,this.$A1t);this.$$d_$A1u=Function.createDelegate(this,this.$A1u);this.$$d_$84n=Function.createDelegate(this,this.$84n);this.$$d_$84p=Function.createDelegate(this,this.$84p);this.$$d_$84m=Function.createDelegate(this,this.$84m);this.$$d_$3iE=Function.createDelegate(this,this.$3iE);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$96V=Function.createDelegate(this,this.$96V);this.$$d_$9UC=Function.createDelegate(this,this.$9UC);this.$$d_$26C=Function.createDelegate(this,this.$26C);this.$$d_$6eg=Function.createDelegate(this,this.$6eg);this.$$d_$9PI=Function.createDelegate(this,this.$9PI);this.$$d_$6dd=Function.createDelegate(this,this.$6dd);this.$$d_$62=Function.createDelegate(this,this.$62);_d.$13.initializeBase(this);this.$9N=h;this.$280=n;this.$356=t;this.$JE=i;this.$2ow=o;this.$C=r;this.$5B=u;this.$1ya=w;this.$k=s;this.$c=a;this.set_$1yq(!1);this.$3vY=!1;this.$2p3=v;this.$D8=b;this.$R0=k;this.$2pe="CreateCalendarItemDefault";this.$1z=f;this.$b4=new _d.$Pk(this.$$d_$62,!1);this.$eG=new _y.$hT;this.$1SJ=2;this.$AD=c;this.$13=l;this.$2ov=y;this.$1qF=p;this.$1uN=_d.$QY.$5EZ();this.$Y("BlockView",this.$$d_$6dd);this.$Y("IsUploadingAttachment",this.$$d_$6dd);this.$Y("ShowMoreDetails",this.$$d_$9PI);this.$Y("IsTransitionedIn",_d.$13.$1AO);this.$Y("IsInitialized",_d.$13.$1AO);this.$Y("ComposeOnlineMeetingViewModel",this.$$d_$6eg);var d=this;this.$26D=new _C(this.$$d_$26C,_d.$13.$A,this,"CanPersistChanges",function(){return d.get_$2nv()});var g=this;this.$4Sa=new _C(this.$$d_$9UC,_d.$13.$A,this,"CanSave",function(){return g.get_$2GT()});var nt=this;this.$4U9=new _C(this.$$d_$9UC,_d.$13.$A,this,"CanSend",function(){return nt.get_$lf()});this.$4LD=new _C(this.$$d_$96V,_d.$13.$A);var tt=this;this.$6WR=new _C(function(){_a.$6.$1c(_a.$0.$1k,"ClickOnMoreDetailsButton");tt.set_$17l(!0);_a.$6.$1E(null,"ClickOnMoreDetailsButton")},_d.$13.$A);this.$EW=new _C(this.$$d_$iF,_d.$13.$A);this.$PJ=new _C(this.$$d_$3iE,_d.$13.$A);this.$5Wm=new _C(this.$$d_$84m,_d.$13.$A);this.$5Wq=new _C(this.$$d_$84p,_d.$13.$A);this.$5Wn=new _C(this.$$d_$84n,_d.$13.$A);this.$4dD=new _C(this.$$d_$A1u,_d.$13.$A);this.$6fK=new _C(this.$$d_$A1t,_d.$13.$A);this.$6GA=new _C(this.$$d_$9Sg,_d.$13.$A);this.$6G9=new _C(this.$$d_$9Sh,_d.$13.$A);this.$qW=e.$5EV(this.$1z,this.$26D);if(this.$C.get_$L()!=="Mouse"){var it=_a.$6.acss(_a.$0.$Hq,"ApplicationBar:CreateRaw");this.set_$7D(_y.$26.$Bg(this));_a.$6.aces(it)}};_d.$13.$3tZ=function(n){for(var i=new Array(n.get_$B()),t=0;t<n.get_$B();t++)i[t]=n.get_$3q(t);return i.join(";")};_d.$13.$1AO=function(n,t){var i=n;i.$DW&&i.$7A&&$CY(i,"Ready",i,i)};function $6qj(n,t){var i=t.$3p();if(i.get_$5V()&&!_a.$7.$4N(i.get_$y(),i.get_$1u())){i.set_$1u(i.get_$1u().$19W(-1));i.$bA()}var r=n.$JE.$8A(i);n.$4cU&&n.$4cU.$7QP(r.$t);$4km(n,r)}function $4km(n,t,i){var f=_a.$6.acsa(_a.$0.$1k,"Initialize",!0);n.set_$1qK(t);$6r6(n,n.$o.$t);n.$1G5=n.$o.$k5.$m0(0,!0,n.$$d_$99b);n.$GU=n.$o.$5m.$4UJ;$6qg(n);$6qh(n,i);n.set_$5K3(new _d.$E5(n.$o.$t));n.set_$fX(new _y.$6J);$6qm(n,n.get_$F5());$4kq(n);$6r5(n);n.set_$3gG(new _d.$Fq(n.$o.$5m));$6qk(n);n.$27C=_d.$QY.$3ky(n.$o);$3(n,"ReminderPickerOptions");$6qs(n);n.$6dd(null,null);var r=n.$o.$t.get_$1N();var u=r?r.get_$A5d():null;var e=this;n.$D8.$E(function(t){n.$C.get_$L()==="TouchNarrow"?n.set_$5o(t.$1LU(n.$o.$t.get_$i(),u,!1,!0,null,!0,n.$w,null)):n.set_$5o(t.$1LT(n.$o.$t.get_$i(),u,!1,3,!0,null,!0,n.$w,null));n.set_$5Dn(_d.$aD.$5Ep(n.$C,n.$D8,n.$5t,_d.$13.$A))});var o=this;n.$R0.$E(function(t){n.set_$1Zx(t.$5EA(new _d.$LX(n),n.$$d_$563));$2h5(n)});$6qu(n);$2h5(n);n.$o.$t.$bA();n.set_$4Wo($3WE(n));n.set_$3zb($3WD(n));$6qf(n);$6ql(n);n.$4cb();var s=this;n.get_$JF().$1Mx(function(){$6qr(n);_a.$6.acea(f)})}function $6qr(n){n.set_$5CO(n.$2p3.$E(n.$o.$t,n.$1z));$6qi(n);n.set_$Cf(!0);$3(n,"BlockView")}function $6qk(n){n.set_$8Gu(n.$356.$E(n.$o,n.$$d_$9VA,n.get_$4i()));n.$UU.$Y("Location",n.$$d_$9zu);n.$3vd=$4kf(n)}function $3WF(n){if(n.$C.get_$L()!=="Mouse")throw Error.invalidOperation("Compose view can only be popped out in MUI");if(!n.$C.get_$9A())throw Error.invalidOperation("Compose view can only be popped out from the main window");}function $6r5(n){n.$b4.set_$do(n.$C.get_$L()==="Mouse"&&n.$C.get_$9A());$3(n,"ShowPopOutControl")}function $6qa(n){var t=new _d.$88(n.$o);t.set_$Cx(n.$o.$cb);t.set_$2mN(n.$X3.$D5.$7rj());return t}function $2h5(n){n.$C.get_$L()==="Mouse"?$6r4(n):$6r3(n);n.$bB()}function $6qt(n,t){if(n.$C.get_$L()!=="Mouse"){t.add_$252(n.$$d_$4Jb);t.add_$24s(n.$$d_$68f);t.add_$3F3(n.$$d_$68d)}}function $6r1(n,t){if(n.$C.get_$L()!=="Mouse"){t.remove_$252(n.$$d_$4Jb);t.remove_$24s(n.$$d_$68f);t.remove_$3F3(n.$$d_$68d)}}function $4kn(n){n.set_$3im(new _d.$4M(n.$o.$E5,n.get_$JF().$1NE(n.$o.$t.get_$5k()),n.$1z,n.$C));n.$EA.set_$1O(!1);n.$EA.set_$9pG(!n.$o.$t.get_$GC())}function $6qh(n,t){n.$X3=n.$2ow.$E(n.$o.$t);var i=!t||!t.get_$2mN()||!t.get_$2mN().get_$B()?null:t.get_$2mN();n.$X3.$49(i)}function $6ql(n){_a.$5t.$2t&&(n.$26O=new _d.$12r(n,n.$k,n.$C))}function $6qu(n){n.$C.add_$Jk(n.$$d_$bB);n.$C.add_$Tm(n.$$d_$2p8);n.$C.add_$18e(n.$$d_$9B7)}function $6r2(n){n.$C.remove_$Jk(n.$$d_$bB);n.$C.remove_$Tm(n.$$d_$2p8);n.$C.remove_$18e(n.$$d_$9B7)}function $6qs(n){n.$o.$t.$Y("IsEventAMeeting",n.$$d_$89g);n.$o.$t.$Y("Calendar",n.$$d_$7Tm);n.$o.$t.$Y("Resources",n.$$d_$6Oc);n.$o.$5m.add_$2m(n.$$d_$3G0);n.$o.$t.$Y("Location",n.$UU.$$d_$8Gt);n.$o.$t.$Y("Start",n.$$d_$A0a);n.$o.$t.$Y("IsAllDayEvent",n.$$d_$9Hf);n.$o.$5m.$Y("CanSend",n.$$d_$6dd);n.$o.$5m.$Y("CanSave",n.$$d_$6dd);n.$o.$Y("IsDraft",n.$$d_$6eg)}function $6r0(n){n.$o.$t.$u("IsEventAMeeting",n.$$d_$89g);n.$o.$t.$u("Calendar",n.$$d_$7Tm);n.$o.$t.$u("Resources",n.$$d_$6Oc);n.$o.$5m.remove_$2m(n.$$d_$3G0);n.$o.$t.$u("Location",n.$UU.$$d_$8Gt);n.$o.$t.$u("Start",n.$$d_$A0a);n.$o.$t.$u("IsAllDayEvent",n.$$d_$9Hf);n.$o.$5m.$u("CanSend",n.$$d_$6dd);n.$o.$5m.$u("CanSave",n.$$d_$6dd);n.$o.$u("IsDraft",n.$$d_$6eg)}function $4kl(n,t){for(var f=new _js.$Z,e=n.get_$JF().get_$ux(),r=0;r<e.get_$B();++r)for(var o=e.get_$3q(r),u=0;u<o.get_$Cp().get_$B();u++){var i=o.get_$Cp().get_$3q(u);if((!_g.$9G.isInstanceOfType(i)||!i.get_$1yD())&&(!t||$4kp(n,i,t.EmailAddress))){var s=n.get_$JF().$wW(i.get_$A5());s.$2no(i)&&f.$D(s)}}return f}function $4kp(n,t,i){if(_g.$Ej.isInstanceOfType(t)&&!t.get_$1D0())return n.$c.get_$31().get_$Aj()===i;if(_g.$9G.isInstanceOfType(t)){var r=t;return!r.get_$1yD()&&r.get_$D2()===i}return!1}function $3WD(n){var t=n.$1n3?n.$1n3.get_$B():0;return t<2?!1:n.$o.$t.get_$16L()?!1:n.$o.get_$1OF()?!0:n.$o.$t.get_$JW()?!1:n.get_$88o()?!n.$o.$t.get_$GC():!1}function $3WE(n){return n.$o.$t.get_$JW()&&n.$o.$t.get_$5Lx()}function $6qi(n){n.$o.$t.get_$28()||n.$o.$t.set_$5k(n.get_$JF().get_$iB());$6qq(n)}function $6qq(n){var t=n.$o.$t.get_$1k();if(t){if(!t.$2no(n.$o.$t.get_$5k())){_js.Trace.logInfo(_d.$13.$A,"Cannot create content on Calendar:{0}. Reverting to DefaultCalendar",n.$o.$t.get_$1k().get_$1o());n.$o.$t.set_$5k(n.get_$JF().get_$iB());n.$o.$6d.set_$5k(n.get_$JF().get_$iB())}}else{var i=[_ucc.CalCoreStrings.l_ErrorCalendarActionFailed_Text,_u.Strings.l_ErrorAccessDenied_Text];_a.$4b.$V6(i,0,n.$$d_$4X);return}$4ku(n);n.$o.$t.$bA();n.$6eg();n.$5XS();$4kn(n)}function $6qm(n,t){switch(n.$C.get_$L()){case"Mouse":n.set_$17l(!0);break;default:n.$C.get_$9A()?n.set_$17l(!t):n.set_$17l(!0);break}}function $195(n,t,i,r){n.$Bc.set_$1r6(t);n.$Bc.set_$3it(i);n.$Bc.set_$2p9(r);n.$3Fy&&n.$3Fy.$n()}function $6qw(n){if(!n.$3xL&&_js.$9.$a(n.$o.$t.get_$2i())){$195(n,n.$o.$t.get_$JW()?_nbs.NonBootStrings.l_NoMeetingTitle_Text:_nbs.NonBootStrings.l_NoEventTitle_Text,n.$o.get_$1Iu()?_nbs.NonBootStrings.l_AreYouSureYouWantToSendThisEventToAttendees_Text:_nbs.NonBootStrings.l_AreYouSureYouWantToSaveTheEventWithoutATitle_Text,n.get_$7lQ());n.$Bc.set_$O4(!0);return!0}return!1}function $6qx(n){if(!n.$3xN&&_d.$6k.$1xn(n.$o.$t)&&n.$o.get_$1Iu()){$195(n,_nbs.NonBootStrings.l_EventOccursInThePastTitle_Text,_nbs.NonBootStrings.l_AreYouSureYouWantToSendThisEventToAttendees_Text,n.get_$7ma());n.$Bc.set_$O4(!0);return!0}return!1}function $6qz(n){if(!n.get_$F5()&&n.$o.get_$A2i()&&!$6qn(n)){if(!n.get_$1ww()&&!n.$3vY){$195(n,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_Text,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_Description_Text,n.get_$9hV());n.$Bc.set_$O4(!0);return!0}if(n.$o.get_$82P()){$195(n,_nbs.NonBootStrings.l_SendUpdateToAttendees_Text,"",n.get_$9hW());n.$Bc.set_$O4(!0);return!0}}return!1}function $6qy(n){if(!n.$3xO&&!n.get_$F5()&&n.$o.$6d.get_$LT()&&!n.$o.$6d.get_$LT().$4e(n.$o.$t.get_$LT())){$195(n,_nbs.NonBootStrings.l_ExceptionsLostWarning_Text,"",n.get_$8HF());n.$Bc.set_$O4(!0);return!0}return!1}function $6qn(n){return!!n.$o.$t.get_$y()&&!n.$o.$t.get_$y().$4e(n.$o.$6d.get_$y())||!!n.$o.$t.get_$1u()&&!n.$o.$t.get_$1u().$4e(n.$o.$6d.get_$1u())||!$6(n.$o.$t.get_$Du())&&n.$o.$t.get_$Du()!==n.$o.$6d.get_$Du()||!$6(n.$o.$t.get_$5V())&&n.$o.$t.get_$5V()!==n.$o.$6d.get_$5V()||n.$UU.$1cQ||!!n.$o.$t.get_$4j()&&!n.$o.$t.get_$4j().$4e(n.$o.$6d.get_$4j())||!!n.$o.$t.get_$LT()&&!n.$o.$t.get_$LT().$4e(n.$o.$6d.get_$LT())||!n.$o.$t.get_$LT()&&!!n.$o.$6d.get_$LT()}function $4kv(n,t,i){n.$X3.$3L4(t,i)}function $3WG(n,t){n.$UU.$4cg();if(n.$o.$t.get_$5V()){n.$o.$t.set_$y(n.$Lo.$pv.$2Q);n.$o.$t.set_$1u(n.$Lo.$pv.$3D.$9K(-1))}if(n.$o.$6d.get_$1k()!==n.$o.$t.get_$1k()){_a.$6.$1c(_d.$13.$A,"CalendarChanged");_a.$6.$1E(null,"CalendarChanged")}var i=null;var r="";if(n.$GU.$2M){i=_d.$1Jb.$1k.$XF.$6Yo(!0,n.get_$F5(),n.get_$W2(),n.$C.get_$L(),!n.get_$do(),!n.$u4,n.$o.$t.get_$aH());r=_d.$1Jb.$1k.$XF.$2II(t,n.get_$F5(),n.get_$W2(),n.$o,n.$Lo,n.$EA);n.$GU.$n();n.set_$3ii(_nbs.NonBootStrings.l_Sending_Text);n.set_$1yq(!0);var u=this;n.$o.$5m.add_$2m(function(n,t){n==="PersistActionFailed"?_d.$1Jb.$1k.$XF.$2tE(i,_d.$1Jb.$6w.$iV(t),_d.$1Jb.$6w.$PX(t),r):n==="SendCalendarItemAction"&&_d.$1Jb.$1k.$XF.$2tE(i,"",_d.$1Jb.$6w.$PX(t),r)})}else if(n.$o.$5m.$El.$2M){i=_d.$1Jb.$1k.$XF.$6Yo(!1,n.get_$F5(),n.get_$W2(),n.$C.get_$L(),!n.get_$do(),!n.$u4,n.$o.$t.get_$aH());r=_d.$1Jb.$1k.$XF.$2II(t,n.get_$F5(),n.get_$W2(),n.$o,n.$Lo,n.$EA);n.$o.$5m.$El.$n();n.set_$3ii(_nbs.NonBootStrings.l_Saving_Text);n.set_$1yq(!0);var f=this;n.$o.$5m.add_$2m(function(n,t){n==="PersistActionFailed"?_d.$1Jb.$1k.$XF.$2tE(i,_d.$1Jb.$6w.$iV(t),_d.$1Jb.$6w.$PX(t),r):n==="SaveCalendarItemAction"&&_d.$1Jb.$1k.$XF.$2tE(i,"",_d.$1Jb.$6w.$PX(t),r)})}else _js.Trace.logError(_d.$13.$A,"Neither saveCommand nor sendCommand had their canExecute properties equals to true and thus neither got executed.");n.$xQ&&n.$UU.$7Od(n.$o.$t.get_$4j())}function $4kg(n){if(n.$3vd){$195(n,_nbs.NonBootStrings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_nbs.NonBootStrings.l_OverwriteLocationDescription_Text].concat([n.$o.$t.get_$4j().get_$1o(),_d.$13.$3tZ($4kj(n))])),n.get_$9Sj());n.$Bc.set_$O4(!0);return}$3WH(n)}function $3WH(n){var t=null;var i=n.$o.$t.get_$9F();if(i&&i.get_$B()>0){var r=n.$o.$t.get_$9F().get_$3q(0);t=_g.$3Y.$7cl(r);t.set_$hf(_d.$13.$3tZ($6qc(n)))}n.$o.$t.set_$4j(t)}function $4ks(n){n.$o.$t.set_$4j(_g.$3Y.$11t(_nbs.NonBootStrings.l_OnlineMeetingDisplayLocation_Text))}function $4kf(n){var i=$4kj(n);var r=$6qe(n,n.$UU.$54.get_$1o());if(i.get_$B()!==r.get_$B())return!0;for(var t=0;t<i.get_$B();t++)if(i.get_$3q(t)!==r.get_$3q(t))return!0;return!1}function $4kj(n){return $4kk(n,0)}function $6qc(n){return $4kk(n,1)}function $4kk(n,t){var r=new(_a.$3X.$$(String));var u=n.$o.$t.get_$9F();if(u)for(var i=t;i<n.$o.$t.get_$9F().get_$B();i++){var f=n.$o.$t.get_$9F().get_$3q(i);r.$D(f.get_$7B().Name)}return r}function $6qe(n,t){var r=new(_a.$3X.$$(String));if(t)for(var e=t.split(";"),u=e,o=u.length,i=0;i<o;++i){var f=u[i];_js.$9.$18(f)||r.$D(f.trim())}return r}function $4kq(n){var t=_d.$6k.$3uR(n.$o.$t)+1;n.set_$7Rd(t>1?String.format(_nbs.NonBootStrings.l_ManyAttendees_Caps_Text,t):_nbs.NonBootStrings.l_Calendar_Compose_AddAttendees_Text)}function $4kr(n,t,i){if(i!=="defaultMode"){_js.Trace.logError(_d.$13.$A,"Compose is only supported on CalendarItemRequestMode.DefaultMode. RequestMode:{0}",i);return}n.set_$17l(!0);var u=_a.$6.acss(_a.$0.$6y,"RetrieveCalendarItem");var r="HTML";n.$1ya||(r="Text");n.$eY=n.$9N.$1uq(300,t,n.$$d_$9Nd,n.$$d_$9Nc,null,r,i);_a.$6.aces(u)}function $6r6(n,t){if(n.$C.get_$L()==="Mouse"&&t.get_$3C().get_$3n()!=="HTML"){var i=_js.$9.$4R("BodyType should always be HTML on Mouse Layout. Current BodyType: {0}",t.get_$3C().get_$3n());_js.Trace.logError(_d.$13.$A,i);throw Error.invalidOperation("Not able to edit a meeting with this Body Type. "+i);}}function $4kh(n){n.$o.$5m.$3nt.$2M&&n.$o.$5m.$3nt.$n()}function $4ko(n,t){n.set_$17l(!0);n.$5t.$z3(t,null,null)}function $6qo(n){var i=!0;if(n.$EA.$Yn&&!_d.$IH.isInstanceOfType(n.$EA.$Yn)){var t=n.$o.$E5.$1um();if(t){n.$1z.$32(0,t,null);return!1}}if(n.$o.$t.get_$JW()&&n.$qW.$3vl(n.$o.$t,n.$5t.get_$1N()))return!1;if(_a.$5t.$2t&&n.get_$lf()&&n.$26O&&n.$26O.$82Z()){_js.Trace.logInfo(_d.$13.$A,"Not valid to send since policy violation detected");n.$1z.$32(0,n.$26O.$7tD(),null);return!1}return i}function $6r4(n){var t=[];var u=$6qZ(n);u.get_$B()>0&&Array.add(t,new _0365m.$Gv(_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,new _0365m.$2b(u.get_$3T())));if(!n.get_$F5()){n.$o.$t.get_$vL()&&Array.add(t,new _0365m.$m(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$o.$j7));var i=new(_0365f.$o.$$(_0365m.$m));n.$o.$t.get_$ej()&&i.$D(new _0365m.$m(_u.Strings.l_Reply_LowerCase_Text,null,n.$o.$QJ.$IO));n.$o.$t.get_$hr()&&i.$D(new _0365m.$m(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$o.$QJ.$KS));n.$o.$t.get_$ei()&&i.$D(new _0365m.$m(_u.Strings.l_Forward_LowerCase_Text,null,n.$o.$QJ.$Hx));i.get_$B()>0&&(i.get_$B()>1?Array.add(t,new _0365m.$Gv(_u.Strings.l_Reply_LowerCase_Text,null,new _0365m.$2b(i.get_$3T()))):Array.add(t,i.get_$3q(0)))}n.$o.$t.get_$GC()&&Array.add(t,new _0365m.$m(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,n.$1G5));var r=null;if(n.$Qb){r=n.$Qb.$3sl();r&&Array.add(t,r)}n.set_$2HM(t.length?new _0365m.$2b(t):null);r&&n.$DA.$Y("IsShown",n.$$d_$3Ex)}function $6qZ(n){var f=$4ki(n);var t=new(_0365f.$o.$$(_0365m.$m));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$D(new _0365m.$m(u.key,null,u.value))}return t}function $6qY(n){var f=$4ki(n);var t=new(_0365f.$o.$$(_y.$2v));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$D(new _y.$2v(u.key,u.value))}return t}function $6qg(n){var t=this;n.$2EA=new _C(n.$$d_$10y,_d.$13.$A,n,"",function(){return n.$13.get_$2FH()&&!n.$13.get_$67()});var i=this;n.$1Ni=new _C(n.$$d_$5YE,_d.$13.$A,n,"",function(){return n.$1ya});var r=this;n.$19n=new _C(n.$$d_$3eI,_d.$13.$A,n.$AD.get_$ao(),_a.$Em.$3gp.$1n,function(){return n.$AD.get_$ao().get_$2GF()&&n.$13.get_$67()});var u=this;n.$19o=new _C(n.$$d_$56h,_d.$13.$A,n.$AD.get_$ao(),_a.$Em.$3sG.$1n,function(){return n.$AD.get_$ao().get_$2v5()&&n.$13.get_$67()})}function $6qb(n){n.$2EA.$1Q();n.$2EA=null;n.$1Ni.$1Q();n.$1Ni=null;n.$19n.$1Q();n.$19n=null;n.$19o.$1Q();n.$19o=null}function $4ki(n){var t={};n.$2EA.$2M&&(t[_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text]=n.$2EA);n.$19n.$2M&&(t[_nbs.NonBootStrings.l_NewPhotoSubmenuItemText_Text]=n.$19n);n.$19o.$2M&&(t[_nbs.NonBootStrings.l_PhotoFromGallerySubmenuItemText_Text]=n.$19o);n.$1Ni.$2M&&(t[_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text]=n.$1Ni);return t}function $6r3(n){var r=new(_0365f.$o.$$(_y.$2W));var e=!!n.$5B&&n.$5B.$3u("ComposeApps");n.get_$lf()?r.$D(new _y.$2W(_y.$c.get_$1Tf(),_y.$c.get_$3N0(),_nbs.NonBootStrings.l_SendItemMobile_Text,n.$26D)):r.$D(new _y.$2W(_y.$c.get_$FK(),_y.$c.get_$1jj(),_nbs.NonBootStrings.l_SaveItemMobile_Text,n.$26D));r.$D(new _y.$2W(_y.$c.get_$EQ(),_y.$c.get_$9fS(),_nbs.NonBootStrings.l_SchedulingAssistant_AppBarButtonText_Text,n.$4LD));e&&n.$6a&&r.$D(new _y.$2W(_y.$c.get_$2lo(),_y.$c.get_$569(),_nbs.NonBootStrings.l_AppsTouch_Text,n.$6a.$1kl));r.$D(new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItemMobile_Text,n.$EW));var t=new(_0365f.$o.$$(_y.$2v));if(!n.get_$F5()){n.$o.$5m.get_$VX()?t.$D(new _y.$2v(_nbs.NonBootStrings.l_DeleteEvent_LowerCase_Text,n.$o.$5m.$TL)):n.$o.$5m.get_$hp()&&t.$D(new _y.$2v(_nbs.NonBootStrings.l_CancelEvent_LowerCase_Text,n.$o.$5m.$7V));n.$o.$t.get_$vL()&&t.$D(new _y.$2v(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,n.$o.$j7))}var u=$6qY(n);u.get_$B()>0&&t.$D(new _y.$2v(_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,u.get_$3T()));if(n.$Qb){var f=n.$Qb.$7sE();f.get_$B()>0&&t.$D(new _y.$2v(_u.Strings.l_Categorize_Text,null,f.get_$3T()))}var i=new(_0365f.$o.$$(_y.$2v));if(!n.get_$F5()){n.$o.$t.get_$ej()&&i.$D(new _y.$2v(_u.Strings.l_Reply_LowerCase_Text,n.$o.$QJ.$IO));n.$o.$t.get_$hr()&&i.$D(new _y.$2v(_u.Strings.l_ReplyAll_LowerCase_Text,n.$o.$QJ.$KS));n.$o.$t.get_$ei()&&i.$D(new _y.$2v(_u.Strings.l_Forward_LowerCase_Text,n.$o.$QJ.$Hx));i.get_$B()>0&&(i.get_$B()>1?t.$D(new _y.$2v(_u.Strings.l_Reply_LowerCase_Text,null,i.get_$3T())):t.$D(i.get_$3q(0)))}n.$o.$t.get_$GC()&&t.$D(new _y.$2v(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1G5));n.$3w.set_$J0(r.get_$3T());n.$3w.set_$aR(t.get_$3T())}function $4kt(n){n.set_$1iT(2)}function $6qv(n){n.set_$1iT(7)}function $6qX(n,t,i){var r=$6qd(n,t===1,i);$195(n,_nbs.NonBootStrings.l_Calendar_Compose_LeaveEventFormDialog_Title_Text,null,r);n.$Bc.set_$O4(!0)}function $6qp(n){return n.$7A&&!n.$Bc.$11q&&n.$F4()}function $6qd(n,t,i){var r=new _js.$Z;var u;var f;if(n.$o.get_$1Iu()){u=_nbs.NonBootStrings.l_ConfirmDialog_Send_Text;f=_nbs.NonBootStrings.l_SendUpdatedEventToAttendees_Text}else{u=_nbs.NonBootStrings.l_ConfirmDialog_Save_Text;f=_nbs.NonBootStrings.l_SaveChangesMadeToThisEvent_Text}var e=this;r.$D(new _a.$2G(new _C(function(){n.$26C();i&&i()},_d.$13.$A),u,f));var o=this;r.$D(new _a.$2G(new _C(function(){n.$5JA();i&&i()},_d.$13.$A),_u.Strings.l_ConfirmDialog_Discard_Text,_nbs.NonBootStrings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$C.get_$L()==="Mouse"&&t){var s=this;r.$D(new _a.$2G(new _C(function(){n.$62();i&&i()},_d.$13.$A),_nbs.NonBootStrings.l_ConfirmDialog_Popout_Text,_nbs.NonBootStrings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var h=this;r.$D(new _a.$2G(new _C(function(){n.$3iE();n.$1It=!1},_d.$13.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return r}function $4ku(n){var u=n.$o.$t.get_$5k();var t=new _g.$1l;t.MailboxType=n.$o.$t.get_$FE().Mailbox.MailboxType;t.RoutingType=n.$o.$t.get_$FE().Mailbox.RoutingType;if(_g.$Ej.isInstanceOfType(u)){t.EmailAddress=n.$c.get_$31().get_$Aj();t.Name=n.$c.get_$31().get_$FS();n.$Va.$yz.$1v0(n.$c.get_$31().get_$1VG())}else{var i=u;t.EmailAddress=i.get_$D2();if(i.get_$rL())t.Name=i.get_$Bd();else{var f=n.get_$JF().$3sg(i.get_$D2());f&&(t.Name=f.get_$Bd())}n.$Va.$yz.$1v0(i.get_$2Y3())}var r=new _g.$BY;r.Mailbox=t;n.$o.$t.set_$FE(r);n.$o.$6d.set_$FE(r)}function $6qf(n){n.$1L1=n.$2ov.$E(n.$o);n.$1L1.add_$9Nl(n.$$d_$9Ni);n.$1L1.$5j()}function $6qW(n){n.$AV||n.$1Q()}_d.$13.prototype={$1qF:null,$1z:null,$1uN:null,$280:null,$356:null,$C:null,$qW:null,$4Sa:null,$4U9:null,$26D:null,$4LD:null,$EW:null,$6WR:null,$5Wm:null,$5Wq:null,$5Wn:null,$PJ:null,$4dD:null,$6fK:null,$6GA:null,$6G9:null,$AD:null,$13:null,$1ya:!1,$JE:null,$b4:null,$9N:null,$c:null,$2ow:null,$2p3:null,$2ov:null,$1G5:null,$1Ni:null,$19n:null,$19o:null,$2EA:null,$3Fy:null,$3FA:null,$1SJ:0,$xQ:!1,$5OC:!1,$X3:null,$7A:!1,$2OP:!1,$29Y:!1,$eG:null,$UU:null,$o:null,$Qb:null,$w:null,$L0:null,$k:null,$27C:null,$1n3:null,$Lo:null,$eY:null,$EA:null,$u4:!1,$5t:null,$Va:null,$Bc:null,$3ei:null,$2H8:null,$1jN:null,$Et:null,$3xL:!1,$3xN:!1,$3xO:!1,$cc:!1,$GU:null,$DA:null,$3vd:!1,$4cU:null,$1It:!1,$1TH:null,$2Ah:null,$17g:!1,$33N:!1,$3vY:!1,$1L1:null,$1rH:null,$D8:null,$R0:null,$6a:null,$Zk:null,$2pe:null,$5B:null,$26O:null,add_$6DS:function(n){this.$2N("Ready",n)},remove_$6DS:function(n){this.$2P("Ready",n)},get_$1Zx:function(){return this.$6a},set_$1Zx:function(n){if(n!==this.$6a){if(this.$6a){$6r1(this,this.$6a);this.$6a.$7H()}this.$6a=n;if(this.$6a){$6qt(this,this.$6a);this.$6a.$5j()}$3(this,"ExtensibilityViewModel")}return n},get_$2HM:function(){return this.$DA},set_$2HM:function(n){if(n!==this.$DA){this.$DA=n;$3(this,"ContextMenu")}return n},get_$8Gu:function(){return this.$UU},set_$8Gu:function(n){if(this.$UU!==n){this.$UU=n;$3(this,"LocationWellViewModel")}return n},get_$7Rd:function(){return this.$3ei},set_$7Rd:function(n){if(this.$3ei!==n){this.$3ei=n;$3(this,"AttendeeLabel")}return n},get_$4i:function(){return _y.$1KT.prototype.get_$4i.call(this)},set_$4i:function(n){_y.$1KT.prototype.set_$4i.call(this,n);this.$UU&&(this.$UU.$3m=n);return n},get_$1A1:function(){return this.$xQ||!this.get_$JF().get_$I1()},get_$5ZP:function(){return this.$o.$t.get_$5V()&&this.get_$W2()},get_$8Cu:function(){return!this.$o.$t.get_$5V()&&this.get_$W2()},get_$W2:function(){return!$6(this.$EA)&&!$6(this.$EA.$E5)&&!_d.$IH.isInstanceOfType(this.$EA.$E5.get_$Hi())},get_$F5:function(){return this.$o.$cb||this.$o.get_$1OF()},get_$Ld:function(){return this.$C.get_$L()!=="Mouse"?1:0},get_$5o:function(){return this.$5t},set_$5o:function(n){if(this.$5t!==n){if(this.$5t){this.$5t.remove_$16G(this.$$d_$7cB);this.$5t.remove_$sx(this.$$d_$sx);this.$5t.remove_$4db(this.$$d_$bB);this.$5t.rpcl("IsInProgress",this.$$d_$7RU);this.$5t.rpcl("EditorCallContext",this.$$d_$7RU)}if(n){n.add_$16G(this.$$d_$7cB);n.add_$sx(this.$$d_$sx);n.add_$4db(this.$$d_$bB);n.apcl("IsInProgress",this.$$d_$7RU);n.apcl("EditorCallContext",this.$$d_$7RU)}this.$5t=n;$3(this,"AttachmentWellViewModel")}return n},get_$5CO:function(){return this.$Va},set_$5CO:function(n){if(this.$Va!==n){if(this.$Va){this.$Va.remove_$68t(this.$$d_$7cB);this.$Va.remove_$4JD(this.$$d_$4JD);this.$Va.$u("IsInProgress",this.$$d_$7dw);this.$Va.$1Q()}if(n){n.add_$68t(this.$$d_$7cB);n.add_$4JD(this.$$d_$4JD);n.$Y("IsInProgress",this.$$d_$7dw)}this.$Va=n;this.$Va&&this.$Va.$yz.$1v0(this.$c.get_$31().get_$1VG());$3(this,"ComposeOnlineMeetingViewModel")}return n},get_$3gG:function(){return this.$Bc},set_$3gG:function(n){if(this.$Bc!==n){this.$Bc=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$17l:function(){return this.$u4},set_$17l:function(n){if(n!==this.$u4){this.$u4=n;$3(this,"ShowMoreDetails")}return n},get_$3zb:function(){return this.$2OP},set_$3zb:function(n){if(this.$2OP!==n){this.$2OP=n;$3(this,"IsCalendarPickerEnabled")}return n},get_$4Wo:function(){return this.$29Y},set_$4Wo:function(n){if(this.$29Y!==n){this.$29Y=n;$3(this,"ShowRequestResponses")}return n},get_$lf:function(){var n=!!this.$GU&&this.$GU.$2M;return!this.get_$1A1()&&(n||this.get_$5Zj())},get_$2GT:function(){var n=!!this.$o&&this.$o.$5m.$El.$2M;return!this.get_$1A1()&&!this.get_$5Zj()&&n},get_$9nf:function(){return this.$C.get_$L()==="Mouse"&&this.get_$F5()},get_$9nu:function(){return this.$C.get_$L()==="Mouse"&&!this.get_$F5()&&!this.$o.get_$1Iu()&&this.$o.$t.get_$VX()},get_$9ne:function(){return this.$C.get_$L()==="Mouse"&&!this.get_$F5()&&this.$o.get_$1Iu()&&this.$o.$t.get_$hp()},get_$1jO:function(){return this.$1jN},set_$1jO:function(n){this.$1jN=n;$3(this,"ResizeEditorCommand");return n},get_$Cf:function(){return this.$7A},set_$Cf:function(n){if(this.$7A!==n){this.$7A=n;$3(this,"IsInitialized")}return n},get_$2nv:function(){var n=!!this.$o&&(this.$o.$5m.get_$2GT()||this.$o.$5m.get_$lf());return n&&!this.$xQ&&!this.$33N},get_$fX:function(){return this.$w},set_$fX:function(n){if(this.$w!==n){this.$w&&this.$9yA(this.$w);this.$w=n;this.$w&&this.$9Zp(this.$w);$3(this,"InfoBarViewModel")}return n},get_$1qK:function(){return this.$o},set_$1qK:function(n){this.$o=n;$3(this,"CalendarItemViewModel");return n},get_$3gD:function(){return this.$Qb},set_$3gD:function(n){if(this.$Qb!==n){this.$Qb&&this.$Qb.remove_$2oA(this.$$d_$3FC);n&&n.add_$2oA(this.$$d_$3FC);this.$Qb=n;$3(this,"CalendarCategoryViewModel")}return n},get_$5K3:function(){return this.$Lo},set_$5K3:function(n){if(this.$Lo!==n){this.$Lo&&this.$Lo.$u("DurationSelectedValue",this.$$d_$9EL);n&&n.$Y("DurationSelectedValue",this.$$d_$9EL);this.$Lo=n;$3(this,"DurationViewModel")}return n},get_$3im:function(){return this.$EA},set_$3im:function(n){if(this.$EA!==n){if(this.$EA){this.$EA.$u("RecurrenceSelected",this.$$d_$6DV);this.$EA.$E5.$Jg.$u("StartDate",this.$$d_$9N3);this.$EA.$E5.$u("Model",this.$$d_$9ym);this.$9y9(this.$EA)}this.$EA=n;if(this.$EA){this.$EA.$Y("RecurrenceSelected",this.$$d_$6DV);this.$EA.$E5.$Jg.$Y("StartDate",this.$$d_$9N3);this.$EA.$E5.$Y("Model",this.$$d_$9ym);this.$9Zo(this.$EA);this.$4cb()}$3(this,"ComposeRecurrenceViewModel")}return n},get_$7iu:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$26D,this.get_$lf()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,this.get_$lf()?_nbs.NonBootStrings.l_SendEventToAttendees_Text:_nbs.NonBootStrings.l_SaveChangesMadeToThisEvent_Text));var t=_nbs.NonBootStrings.l_YourChangesWillNotBeSaved_Text;this.$o.get_$1Iu()?t=_nbs.NonBootStrings.l_EventWillNotBeSent_Text:this.get_$F5()&&(t=_nbs.NonBootStrings.l_ThisEventWillBeDeleted_Text);n.$D(new _a.$2G(new _C(this.$$d_$5JA,_d.$13.$A),_u.Strings.l_ConfirmDialog_Discard_Text,t));n.$D(new _a.$2G(this.$PJ,_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return n},get_$7lQ:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$5Wm,this.get_$lf()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$7ma:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$5Wq,_nbs.NonBootStrings.l_ConfirmDialog_Send_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$9hW:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$6fK,_nbs.NonBootStrings.l_JustAddedOrRemoved_Lowercase_Text,_nbs.NonBootStrings.l_SendUpdatesToAddedOrRemovedAttendees_Text));n.$D(new _a.$2G(this.$4dD,_nbs.NonBootStrings.l_Everyone_Lowercase_Text,_nbs.NonBootStrings.l_SendUpdatesToAllAttendees_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_CancelAndContinueEditing_Text,_nbs.NonBootStrings.l_ReturnToTheEventForFurtherEditing_SentenceCase_Text));return n},get_$9hV:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_DontSend_Text));n.$D(new _a.$2G(this.$4dD,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_SendAnyway_Text));return n},get_$9Sj:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$6GA,_u.Strings.l_Yes_Text));n.$D(new _a.$2G(this.$PJ,_u.Strings.l_No_Text));return n},get_$9Si:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$6G9,_u.Strings.l_Yes_Text));n.$D(new _a.$2G(this.$PJ,_u.Strings.l_No_Text));return n},get_$8HF:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$5Wn,this.get_$lf()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text));n.$D(new _a.$2G(this.$PJ,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$6gp:function(){return this.$1n3},set_$6gp:function(n){if(this.$1n3!==n){this.$1n3=n;this.set_$3zb($3WD(this));$3(this,"WritableCalendars")}return n},get_$1xS:function(){return this.$cc},set_$1xS:function(n){this.$cc=n;n&&this.$o.$t.$Ih.$n();return n},get_$1GW:function(){return this.$b4.get_$1GW()},get_$do:function(){return this.$b4.get_$do()},get_$8Ag:function(){return this.$C.get_$9A()},get_$1iT:function(){return this.$1SJ},set_$1iT:function(n){if(this.$1SJ!==n){this.$1SJ=n;$3(this,"PopupPanelSize")}return n},get_$2MT:function(){return this.$$d_$5Yi},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$7iz:function(){return!0},get_$1ww:function(){return this.$o.get_$1ww()||this.$5OC},get_$9ug:function(){return this.$2Ah},set_$9ug:function(n){if(this.$2Ah!==n){this.$2Ah=n;if(this.$1ya)$3(this,"TextToAppend");else{this.$o.$t.$Hy&&this.$o.$t.$Hy.$n();this.$o.$t.get_$3C().set_$1g(this.$o.$t.get_$3C().get_$1g()+this.$2Ah)}}return n},get_$1yq:function(){return this.$xQ},set_$1yq:function(n){if(this.$xQ!==n){this.$xQ=n;$3(this,"IsSubmitted");$3(this,"BlockView")}return n},get_$JO:function(){return this.$Zk},set_$JO:function(n){this.$Zk=n;$3(this,"EditorCallContext");return n},get_$5Zj:function(){return!!this.$X3&&this.$X3.get_$5dX()},get_$4Si:function(){return this.$1TH},set_$4Si:function(n){this.$1TH&&this.$1TH.$1Q();this.$1TH=n;return n},get_$JF:function(){return this.$9N.$2U},get_$8E4:function(){return this.$33N},set_$8E4:function(n){if(this.$33N!==n){this.$33N=n;$3(this,"IsUploadingAttachment")}return n},get_$88o:function(){return $4kp(this,this.$o.$t.get_$5k(),this.$c.get_$31().get_$Aj())},get_$5Dn:function(){return this.$1rH},set_$5Dn:function(n){this.$1rH=n;$3(this,"CopyPasteViewModel");return n},get_$3ii:function(){return this.$2H8},set_$3ii:function(n){if(this.$2H8!==n){this.$2H8=n;$3(this,"ComposeActionString")}return n},get_$9of:function(){return!this.$o.$t.get_$GC()},get_$9nn:function(){return this.$Va.get_$427()},get_$6WY:function(){return!!this.$o.$t.get_$16L()},get_$887:function(){return this.get_$9of()||this.get_$9nn()||this.get_$6WY()||this.$29Y},$13o:function(n){var t;t=this.$JE.$8A(n.get_$1Rg());t.$9yk(n.get_$6n());t.set_$Cx(n.get_$Cx());this.$5OC=n.get_$2L1();$4km(this,t,n)},$3xv:function(n){$4kr(this,n.get_$3p1(),n.get_$2vQ())},$85d:function(n){this.$4cU=n;$4kr(this,n.get_$i(),"defaultMode")},$gk:function(){_y.$1KT.prototype.$gk.call(this);this.$7A&&this.$o.$t.get_$JW()&&this.set_$17l(!0)},$GN:function(){_y.$1KT.prototype.$GN.call(this);this.$bB()},$4J8:function(n){this.$1It=!1;if(this.$1L1&&this.$C.get_$L()!=="TouchNarrow")if(n){this.set_$4Si(null);this.$1L1.$5j()}else this.$1L1.$7H()},$9VF:function(){if(!this.$1TH)throw Error.invalidOperation("Cannot pop out scheduling when scheduling is not active.");$3WF(this);var n=new _d.$3Z(this.$o,this.$1TH.$d);n.set_$Cx(this.$o.$cb);this.$4X();this.$C.$MH(_d.$C4,null,null,_y.$48.get_$fF(),n,!1)},$9VA:function(){if(!this.$UU||!_d.$6I.isInstanceOfType(this.get_$4i().get_$7u()))throw Error.invalidOperation("Cannot pop out place picker when it is not active or available.");$3WF(this);var n=new _d.$8l(this.$o,this.$UU.get_$1iN());n.set_$Cx(this.$o.$cb);this.$4X();this.$C.$MH(_d.$C4,null,null,_y.$48.get_$fF(),n,!1)},$F4:function(){return!this.$xQ&&!this.$1It&&this.get_$1ww()},$5jN:function(){this.$o.$5jN()},$5XS:function(){this.set_$3gD(this.$1qF.$8A(this.$o.$t));$2h5(this)},$7cB:function(){this.$o.get_$1OF()&&this.$o.$5m.$6QG.$n()},$62:function(){$3WF(this);_a.$6.$1c(_a.$0.$1k,"PopoutCalendarComposeForm");var n=$6qa(this);this.$Bc.set_$O4(!1);this.$4X();this.$C.$MH(_d.$C4,null,null,_y.$48.get_$fF(),n,!1);_a.$6.$1E(null,"PopoutCalendarComposeForm")},$A19:function(){this.$4cb();$4kq(this);this.set_$3zb($3WD(this));this.set_$4Wo($3WE(this))},$9Zp:function(n){this.$X3.set_$85G(n);n.$Y("Count",this.$$d_$9HV);this.$L0=new _d.$nv(this.$o.$t,this.get_$F5(),this.$1G5,this.$w);this.$Lo.$Y("Start",this.$L0.$$d_$9zc);this.$Lo.$Y("End",this.$L0.$$d_$9zc);this.$Lo.$Y("IsAllDayEvent",this.$L0.$$d_$9zc);this.$o.$t.$Y("Calendar",this.$L0.$$d_$9zc)},$9yA:function(n){this.$Lo.$u("Start",this.$L0.$$d_$9zc);this.$Lo.$u("End",this.$L0.$$d_$9zc);this.$Lo.$u("IsAllDayEvent",this.$L0.$$d_$9zc);this.$o.$t.$u("Calendar",this.$L0.$$d_$9zc);n.$u("Count",this.$$d_$9HV)},$9Zo:function(n){n.$E5.$Jg.$Y("EndDate",this.$L0.$$d_$9zc);n.$E5.$Y("RecurrencePattern",this.$L0.$$d_$9zc)},$9y9:function(n){n.$E5.$Jg.$u("EndDate",this.$L0.$$d_$9zc);n.$E5.$u("RecurrencePattern",this.$L0.$$d_$9zc)},$4cb:function(){this.$L0.$18h()},$4c:function(){if(this.$7A){$6qb(this);this.$X3.$1Q();$6r0(this);this.$UU.$u("Location",this.$$d_$9zu);this.set_$3im(null);this.set_$fX(null);this.set_$3gD(null);this.set_$5K3(null);this.set_$5o(null);this.set_$5CO(null);this.set_$4Si(null);this.set_$1Zx(null)}if(this.$eY){this.$eY.$1Q();this.$eY=null}this.$u("BlockView",this.$$d_$6dd);this.$u("IsUploadingAttachment",this.$$d_$6dd);this.$u("ShowMoreDetails",this.$$d_$9PI);this.$u("IsTransitionedIn",_d.$13.$1AO);this.$u("IsInitialized",_d.$13.$1AO);this.$u("ComposeOnlineMeetingViewModel",this.$$d_$6eg);$6r2(this);_a.$1.prototype.$4c.call(this)},$68f:function(){this.$C.get_$L()==="TouchWide"&&this.$6a.get_$mm()&&!this.$u4&&$6qv(this)},$68d:function(){this.$C.get_$L()!=="TouchWide"||this.$u4||$4kt(this)},$4Jb:function(){this.$C.get_$L()!=="Mouse"&&this.set_$17l(!0)},$5Yi:function(n,t){var i=!0;var r=!i;if(this.$Bc&&this.$Bc.$11q)return i;if($6qp(this)){$6qX(this,t,n);return i}$6qW(this);return r},$2p8:function(n){this.$17g||this.$F4()&&n.$1Jw(_nbs.NonBootStrings.l_Calendar_BrowserWindowUnloadWarning_Text);this.$17g=!0;_js.$J.get_$I().$1w(_a.$0.$1k,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$6OJ,100)},$9B7:function(){this.$xQ||$4kh(this)},$sx:function(n){this.$3vY=!0;_a.$5t.$2t&&this.$2fD(8)},$7RU:function(n,t){t==="IsInProgress"?this.set_$8E4(this.$5t.get_$CM()):t==="EditorCallContext"&&this.set_$JO(this.$5t.get_$JO())},$2fD:function(n){_a.$5t.$2t&&this.$26O&&this.$o&&this.$26O.$2fD(this.$5t,this.$o.$t,n)},$7dw:function(n,t){this.set_$3ii(this.$Va.$L4?_nbs.NonBootStrings.l_OnlineMeetingCreationInProgress_Text:"");this.set_$1yq(this.$Va.$L4)},$4JD:function(n){this.$o.$t.set_$i(_0365f.$2t.$3p(this.$o.$6d.get_$i()));if(this.$o.$t.get_$4j()&&!_js.$9.$a(this.$o.$t.get_$4j().get_$1o())){$195(this,_nbs.NonBootStrings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_nbs.NonBootStrings.l_OverwriteLocationDescription_Text].concat([this.$o.$t.get_$4j().get_$1o(),_nbs.NonBootStrings.l_OnlineMeetingDisplayLocation_Text])),this.get_$9Si());this.$Bc.set_$O4(!0)}else $4ks(this);this.set_$9ug(n.$7ql(this.$1ya))},$99b:function(){this.$1Q()},$6dd:function(n,t){$3(this,"CanPersistChanges");$3(this,"CanSave");$3(this,"CanSend");$2h5(this)},$9Hf:function(n,t){if(this.$o.$t.get_$5V()){this.$o.$t.set_$9S("Free");this.$o.set_$gp(_d.$6k.$1RH)}else{this.$o.$t.set_$9S("Busy");this.$o.set_$gp(this.$c.get_$1I().get_$1tC()?this.$c.get_$1I().get_$3mk():_d.$6k.$1RH)}$45(this,"IsAllDayAndRecurring","IsRecurringAndNotAllDay")},$6eg:function(n,t){this.$o.$cb||!this.get_$F5()?this.set_$6gp($4kl(this,this.$o.$t.get_$FE().Mailbox)):this.set_$6gp($4kl(this,null))},$3iE:function(){this.$Bc.$PJ.$n();this.$3xN=!1;this.$3xL=!1;this.$3xO=!1;this.$3FA&&this.$3FA.$n()},$84m:function(){this.$3xL=!0;this.$Bc.$PJ.$n();this.$26C()},$84p:function(){this.$3xN=!0;this.$Bc.$PJ.$n();this.$26C()},$84n:function(){this.$3xO=!0;this.$Bc.$PJ.$n();this.$26C()},$A1u:function(){this.$GU=this.$o.$5m.$4UJ;this.$Bc.$PJ.$n();$3WG(this)},$A1t:function(){this.$GU=this.$o.$5m.$6SY;this.$Bc.$PJ.$n();$3WG(this)},$9UC:function(){this.$26C(!0)},$26C:function(n){var t=this;var r=function(){if($6qo(t)&&!$6qw(t)&&!$6qx(t)&&!$6qz(t)&&!$6qy(t)){t.$Bc.set_$O4(!1);$3WG(t,n)}};var i=this;var u=function(){i.$PJ.$2M&&i.$PJ.$n()};this.$Bc.set_$O4(!1);$4kv(this,r,u)},$89g:function(n,t){this.set_$17l(!0);this.$A19()},$7Tm:function(n,t){$4ku(this);var i=$3WE(this);this.$5XS();$4kn(this);this.$o.$t.set_$Du(i);this.set_$4Wo(i)},$6Oc:function(n,t){$4kg(this)},$9Sg:function(){$3WH(this);this.$Bc.set_$O4(!1)},$9Sh:function(){$4ks(this);this.$Bc.set_$O4(!1)},$9HV:function(n,t){this.$bB()},$9EL:function(n,t){this.$bB()},$6DV:function(n,t){this.$EA.$Yn&&!_d.$To.isInstanceOfType(this.$EA.$Yn)&&_nbs.NonBootStrings.l_EditPattern_Text===this.$EA.$Yn&&this.$EA.set_$1O(!0);this.$bB();$PB(this,"IsAllDayAndRecurring","IsRecurring","IsRecurringAndNotAllDay")},$9ym:function(n,t){this.$o.$t.get_$1Se()?this.$o.$t.set_$Lf("RecurringMaster"):this.$o.$t.set_$Lf("Single")},$9N3:function(n,t){var i=this.$Lo.get_$y().$5z(this.$Lo.get_$y().$4F());this.$Lo.set_$y(this.$EA.$E5.$Jg.$65.$4F().$9K(i))},$9PI:function(n,t){this.$u4?this.$4VO():$4kt(this)},$9Nc:function(n){_cc.$5g.$3sU(n,this.$$d_$4X)},$9Nd:function(n){var t=_a.$6.acss(_a.$0.$6y,"LoadExistingCalendarItem");$6qj(this,n);_a.$5t.$2t&&this.$2fD(32);_a.$6.aces(t)},$3G0:function(n,t){if(this.get_$89()&&(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="SaveCalendarItemAction"||n==="SendCalendarItemAction"||n==="MoveCalendarItemAction")){this.$4X();$CY(this,"EditingCompleted",n,null)}else if(n==="SaveDraftCalendarItemAction"){this.$o.set_$Cx(!0);this.$o.$t.set_$i(this.$o.$6d.get_$i());this.$5t&&this.$5t.$1Gz(this.$o.$t.get_$i(),this.$o.$t.get_$1N().get_$A5d(),null);this.$Va&&this.$Va.$9yb(this.$o.$t)}else n==="PersistActionFailed"&&this.set_$1yq(!1)},$iF:function(){this.$UU.$4cg();if(this.get_$1ww()||this.$X3.get_$mU()){$195(this,_nbs.NonBootStrings.l_CloseEventForm_Text,null,this.get_$7iu());this.$Bc.set_$O4(!0)}else this.$4X()},$5JA:function(){_a.$6.$1c(_a.$0.$1k,"DiscardComposeChanges");$4kh(this);this.$Bc.$PJ.$n();this.$4X();_a.$6.$1E(null,"DiscardComposeChanges")},$4X:function(){this.$1It=!0;this.get_$89()();this.$AV||this.$1Q()},$96V:function(){_a.$6.$1c(_a.$0.$1k,"OpenSchedulingAssistantForm_ResolveAttendees");var n=this;var t=function(){_a.$6.$1E(null,"OpenSchedulingAssistantForm_ResolveAttendees","",null,null);var i=_d.$1Jb.$1k.$Hj.$9rU(n.$C.get_$L()==="Mouse"&&!n.get_$do());n.set_$4Si(n.$280.$E(n.$o,n.$Lo,n.$$d_$9VF,!1,n.get_$F5(),i));var t;if(n.$C.get_$L()==="TouchNarrow")t=n.$1TH.$1BI;else{t=n.$1TH;_js.Trace.logWarning(_a.$0.$1k,"Navigating to scheduling form")}n.get_$4i().$Bt(t)};var r=this;var i=function(){_a.$6.$1E(null,"OpenSchedulingAssistantForm_ResolveAttendees","Attendees cannot be resolved",null,"Attendees cannot be resolved")};$4kv(this,t,i)},$10y:function(){$4ko(this,!1)},$5YE:function(){$4ko(this,!0)},$3eI:function(){this.$5t.$4L5()},$56h:function(){this.$5t.$6FB()},$A0a:function(n,t){var i=this.$o.$t.get_$y().$4F();_a.$7.$4N(this.$o.$E5.$Jg.$65.$4F(),i)||this.$o.$E5.$Jg.set_$8q(i)},$9zu:function(n,t){this.$o.$t.set_$4j(this.$UU.$54);this.$3vd=$4kf(this)},$3Ex:function(n,t){this.$DA.$2y&&this.$Qb&&this.$Qb.$4O9()},$bB:function(){this.$1jN&&this.$1jN.$2M&&this.$1jN.$n()},$563:function(n){this.$bB()},$6Ue:function(){this.set_$1iT(5)},$4VO:function(){this.set_$1iT(1)},$9Ni:function(n,t){if(t){this.$X3.$D5.$7OK(t);this.$X3.$D5.$9bO(n);this.$C.get_$L()==="TouchNarrow"?$4kg(this):$3WH(this)}},$6OJ:function(){this.$17g=!1},$3FC:function(){this.$bB();this.$u4||this.set_$17l(!0)}};_d.$C4=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){_a.$4.$l(g,"nativeBridge");this.$2Kg=i;this.$2ow=f;this.$c=e;this.$7Rs=n;this.$280=t;this.$356=r;this.$JE=u;this.$k=o;this.$C=s;this.$1J=d;this.$9N=c;this.$1uH=l;this.$M=a;this.$2p3=v;this.$2ov=y;this.$lZ=p;this.$1qF=w;this.$D8=b;this.$R0=k;this.$1J=d;this.$5B=h;this.$12=g};function $4kx(n){var t=new _g.$1l;t.EmailAddress=n.$c.get_$31().get_$Aj();t.Name=n.$c.get_$31().get_$FS();t.MailboxType="Mailbox";var i=n.get_$3gN().$1rL(t);i.get_$3C().set_$3n(n.get_$5do()?"HTML":"Text");return i}function $6r7(n){var t=new _d.$88(null);t.set_$1Rg($4kx(n));t.set_$6n($4kx(n));return t}function $4kw(n,t,i){t.get_$2i()&&i.set_$2i(t.get_$2i());i.set_$y(t.get_$y()||_a.$7.get_$29());var r=t.get_$DS()===undefined?_a.$2D.$1IN(2):t.get_$DS();i.set_$1u(i.get_$y().$9K(r));i.set_$9S(t.get_$3O9());i.set_$5V(t.get_$5V());t.$7Vq("ReminderIsSet")?i.set_$QH(t.get_$QH()):i.set_$QH(n.$c.get_$1I().get_$1tC());t.get_$7S()&&i.set_$7S(_g.$3i.$6bZ(t.get_$7S()));t.get_$8W()&&i.set_$8W(_g.$3i.$6bZ(t.get_$8W()));t.get_$4j()&&i.set_$4j(t.get_$4j());t.get_$3C()&&i.set_$3C(t.get_$3C());i.set_$28(t.get_$1KW())}_d.$C4.prototype={$c:null,$7Rs:null,$356:null,$280:null,$2Kg:null,$JE:null,$k:null,$C:null,$1uH:null,$9N:null,$M:null,$lZ:null,$2ow:null,$2p3:null,$2ov:null,$1qF:null,$D8:null,$R0:null,$1J:null,$12:null,$5B:null,get_$3gN:function(){return this.$lZ},get_$6QT:function(){return this.$280},get_$590:function(){return this.$JE},get_$3g7:function(){return this.$9N.get_$1g()},get_$7ps:function(){return this.$1uH},get_$5do:function(){return this.$1J.get_$BQ()},$2v6:function(n){var t=$6r7(this);$4kw(this,n,t.get_$6n());$4kw(this,n,t.get_$1Rg());t.set_$2L1(n.get_$2L1());return t},$bC:function(n,t,i,r){var u=this.$2Ny();i&&u.add_$6DS(i);if(_d.$GN.$Bj(n))u.$85d(new _d.$GN(n));else if(_y.$Ax.$Bj(n))u.$3xv(new _y.$Ax(n));else{var f=this.$2v6(new _d.$Vu(n));u.$13o(f)}r&&(u.$2pe=r);return u},$vo:function(n,t){var i=this.$2Ny();i.$13o(n);return i},$9de:function(n){return[this.$bC(n,null)]},$7ex:function(n){var t=this.$2Ny();t.$13o(n);if(_d.$3Z.isInstanceOfType(n)){var i=this.get_$6QT().$E(t.$o,t.$Lo,t.$$d_$9VF,!0,t.get_$F5());n.$5Dp(i.$d);return[t,i]}if(_d.$8l.isInstanceOfType(n)){var r=t.$UU.get_$1iN();n.$5Dp(r);return[t,r]}return[t]},$2Ny:function(){return new _d.$13(this.get_$6QT(),this.$356,this.get_$590(),this.$C,this.$5B,new _y.$4c,this.get_$7ps(),this.$2ow,this.$k,this.get_$3g7(),this.$12.$AD,_a.UserAgent.getInstance(),this.$c,this.$2p3,this.$2ov,this.$1qF,this.get_$5do(),this.$D8,this.$R0)}};_d.$QY=function(){};_d.$QY.$3ky=function(n){var t=new _js.$Z;t.$D(_d.$6k.$1RH);t.$D(0);t.$D(5);t.$D(10);t.$D(15);t.$D(30);t.$D(60);t.$D(120);t.$D(180);t.$D(240);t.$D(480);t.$D(720);t.$D(1440);t.$D(2880);t.$D(4320);t.$D(10080);t.$D(20160);if(n.get_$gp()>t.get_$3q(t.get_$B()-1))t.$D(n.get_$gp());else for(var i=0;i<t.get_$B();i++){if(n.get_$gp()===t.get_$3q(i))break;if(n.get_$gp()<t.get_$3q(i)){t.$72(i,n.get_$gp());break}}return t};_d.$QY.$5EZ=function(){var n=new _js.$Z;n.$D("Free");n.$D("WorkingElsewhere");n.$D("Tentative");n.$D("Busy");n.$D("OOF");return n};_d.$E5=function(n){this.$$d_$9Qd=Function.createDelegate(this,this.$9Qd);_d.$E5.initializeBase(this);this.$3P=n;this.$S8=new _d.$1EU(n);this.$pv=$2Ce(this);$6rA(this);this.$S8.add_$7q(this.$$d_$9Qd)};_d.$E5.$5VK=function(n,t){var i=n.$5z(t);return!!(i%864e5)};function $6rB(n,t){n.$S8.set_$y(t.get_$y());n.$S8.set_$1u(t.get_$1u());n.set_$f8(t.get_$5V()?-1:n.get_$DS())}function $6rA(n){n.$qM=new _js.$Z;n.$qM.$D(0);n.$qM.$D(18e5);n.$qM.$D(36e5);n.$qM.$D(54e5);n.$qM.$D(72e5);n.$qM.$D(-1);n.$qM.$D(-2);n.set_$f8(n.$3P.get_$5V()?-1:n.get_$DS())}function $2Ce(n){var t=_d.$6k.$3sv(n.$S8);n.$3jj=t.$3D.$5z(t.$2Q);return t}_d.$E5.prototype={$3P:null,$S8:null,$qM:null,$f7:0,$pv:null,$3jj:0,$1XN:!1,$1XO:!1,get_$y:function(){return this.$S8.get_$y()},set_$y:function(n){if(!this.$1XO&&_d.$E5.$5VK(n,this.get_$y()))throw Error.invalidOperation("Changing time part of Start is not allowed");this.$S8.set_$y(n);return n},get_$1u:function(){return this.$S8.get_$1u()},set_$1u:function(n){if(!this.$1XN)throw Error.invalidOperation("Changing the End date or time part are not allowed");if(!this.$1XO&&_d.$E5.$5VK(n,this.get_$1u()))throw Error.invalidOperation("Changing time part of End is not allowed");this.$S8.set_$1u(n);return n},get_$DS:function(){return this.$S8.get_$DS()},set_$DS:function(n){this.$S8.set_$DS(n);return n},get_$f8:function(){return this.$f7},set_$f8:function(n){this.$f7=n;switch(n){case 0:case 18e5:case 36e5:case 54e5:case 72e5:this.set_$3h2(!1);this.set_$3h4(!0);this.$3P.set_$5V(!1);this.set_$2pY($2Ce(this));this.set_$DS(this.$f7);break;case-1:this.$3P.set_$5V(!0);this.set_$2pY($2Ce(this));this.set_$3h2(!0);this.set_$3h4(!1);break;default:this.$f7=-2;this.$3P.set_$5V(!1);this.set_$2pY($2Ce(this));this.set_$3h2(!0);this.set_$3h4(!0);break}$45(this,"DurationSelectedValue","IsAllDayEvent");return n},get_$2pY:function(){return this.$pv},set_$2pY:function(n){if(this.$pv.$4e(n))return n;this.$pv=n;$3(this,"CorrectedDateRange");return n},get_$3h2:function(){return this.$1XN},set_$3h2:function(n){if(n!==this.$1XN){this.$1XN=n;$3(this,"CanChangeEndDateAndTime")}return n},get_$3h4:function(){return this.$1XO},set_$3h4:function(n){if(n!==this.$1XO){this.$1XO=n;$3(this,"CanChangeStartAndEndTime")}return n},get_$5V:function(){return this.$3P.get_$5V()},set_$5V:function(n){if(n!==this.$3P.get_$5V()){this.$3P.set_$5V(n);$3(this,"IsAllDayEvent")}return n},add_$3Mc:function(n){this.$2N("SelectedTimeChangedEvent",n)},remove_$3Mc:function(n){this.$2P("SelectedTimeChangedEvent",n)},get_$1HV:function(){return this},set_$1HV:function(n){if(!_g.$Vo.$4N(n,this)){$6rB(this,n);$Dp(this,"SelectedTimeChangedEvent",this)}return n},$6dj:function(n,t,i){this.$S8.set_$y(n);this.$S8.set_$DS(t);this.set_$f8(i?-1:this.get_$DS())},$9Qd:function(n,t){t==="Start"?$3(this,"Start"):t==="End"&&$3(this,"End");this.set_$2pY($2Ce(this));$Dp(this,"SelectedTimeChangedEvent",this)}};_d.$Hx=function(n,t,i,r){this.$$d_$9dx=Function.createDelegate(this,this.$9dx);this.$$d_$9D5=Function.createDelegate(this,this.$9D5);this.$$d_$9D6=Function.createDelegate(this,this.$9D6);this.$$d_$9D7=Function.createDelegate(this,this.$9D7);this.$$d_$2pv=Function.createDelegate(this,this.$2pv);this.$$d_$6WY=Function.createDelegate(this,this.$6WY);this.$$d_$4KL=Function.createDelegate(this,this.$4KL);_d.$Hx.initializeBase(this);this.$2e=n;this.$1z=i;this.$k=r;this.$yz=t;this.set_$CM(!1);this.$yz.add_$5Re(this.$$d_$4KL);this.$4Wc=new _C(this.$$d_$6WY,_d.$Hx.$A);var u=this;this.$3ki=new _C(this.$$d_$2pv,_d.$Hx.$A,this,"IsOnlineMeetingButtonEnabled",function(){return u.get_$426()});if(this.$2e.get_$16L()){this.set_$4K3(new _d.$qm(this.$2e.get_$16L()));this.$1Ra.set_$1O(!1)}else this.set_$4K3(null)};_d.$Hx.$7qU=function(n,t,i){var s=i?"<P><BR></P>":"\n";var r=[];if(t){_js.$9.$18(n.AcpInformation.TollNumber)||Array.add(r,String.format(i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollNumberFormatPlainText_Text,n.AcpInformation.TollNumber));for(var h=i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatPlainText_Text,o=n.AcpInformation.TollFreeNumbers,c=o.length,u=0;u<c;++u){var l=o[u];Array.add(r,String.format(h,l))}}else for(var a=i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberFormatPlainText_Text,f=0;f<n.Numbers.length;f++){var e=n.Numbers[f];Array.add(r,String.format(a,e.Number,e.RegionName,e.Language))}return r.length?String.format(i?_nbs.NonBootStrings.l_OnlineMeetingJoinByPhoneSectionRichText_Text:_nbs.NonBootStrings.l_OnlineMeetingJoinByPhoneSectionPlainText_Text,r.join(s)):""};function $3WI(n){var i=n.$yz.$7xz(n.$2e);var t=new _c.$13K(n.$2e,i);t.add_$2C(n.$$d_$9D7);t.add_$1x(n.$$d_$9D6);t.add_$2m(n.$$d_$9D5);n.$k.$z(t)}_d.$Hx.prototype={$4Wc:null,$3ki:null,$yz:null,$1z:null,$k:null,$L4:!1,$2e:null,$4K2:null,$1Ra:null,$Df:null,add_$68t:function(n){this.$2N("OnBeforeCreateOnlineMeeting",n)},remove_$68t:function(n){this.$2P("OnBeforeCreateOnlineMeeting",n)},add_$4JD:function(n){this.$2N("OnCreateOnlineMeetingSucceeded",n)},remove_$4JD:function(n){this.$2P("OnCreateOnlineMeetingSucceeded",n)},get_$427:function(){return!this.$2e.get_$16L()&&(this.$yz.get_$2PP()||this.get_$426())&&!this.$2e.get_$GC()},get_$6Br:function(){return this.get_$426()?_nbs.NonBootStrings.l_OnlineMeetingButton_Text:_nbs.NonBootStrings.l_OnlineMeetingButtonDisabledTooltip_Text},get_$426:function(){return!this.$L4&&!!this.$2e&&this.$yz.$88Z(this.$2e)},get_$4K3:function(){return this.$1Ra},set_$4K3:function(n){if(this.$1Ra!==n){this.$1Ra=n;$3(this,"OnlineMeetingSettingsViewModel")}return n},get_$CM:function(){return this.$L4},set_$CM:function(n){if(this.$L4!==n){this.$L4=n;$3(this,"IsInProgress");this.$4KL("")}return n},$4c:function(){this.$yz.remove_$5Re(this.$$d_$4KL);_a.$1.prototype.$4c.call(this)},$4KL:function(n){$PB(this,"IsOnlineMeetingButtonVisible","IsOnlineMeetingButtonEnabled","OnlineMeetingButtonTitleText")},$9yb:function(n){this.$2e=n;this.$L4&&$3WI(this)},$7ql:function(n){if(!this.$Df)return"";var o=!$6(this.$Df.AcpInformation);var i=n?"<P><BR></P>":"\n";var s;var r;var u="";var f="";var t="";if(n){r=o?String.format(_nbs.NonBootStrings.l_OnlineMeetingParticipantPasscodeRichText_Text,this.$Df.AcpInformation.ParticipantPassCode):String.format(_nbs.NonBootStrings.l_OnlineMeetingConferenceIdRichText_Text,this.$Df.ConferenceId);var e="";_js.$9.$18(this.$Df.LogoUrl)||(e=String.format('<img src="{0}" />{1}{1}',this.$Df.LogoUrl,i));_js.$9.$18(this.$Df.HelpUrl)||(u=String.format(_nbs.NonBootStrings.l_OnlineMeetingHelpSectionRichText_Text,this.$Df.HelpUrl));_js.$9.$18(this.$Df.LegalUrl)||(f=String.format(_nbs.NonBootStrings.l_OnlineMeetingLegalSectionRichText_Text,this.$Df.LegalUrl));_js.$9.$18(this.$Df.CustomFooterText)?_js.$9.$a(e)||(t=String.format("{1}{0}{1}",e,i)):t=String.format("{1}{2}{0}{1}",this.$Df.CustomFooterText,i,e)}else{r=o?String.format(_nbs.NonBootStrings.l_OnlineMeetingParticipantPasscodePlainText_Text,this.$Df.AcpInformation.ParticipantPassCode):String.format(_nbs.NonBootStrings.l_OnlineMeetingConferenceIdPlainText_Text,this.$Df.ConferenceId);_js.$9.$18(this.$Df.HelpUrl)||(u=String.format(_nbs.NonBootStrings.l_OnlineMeetingHelpSectionPlainText_Text,this.$Df.HelpUrl));_js.$9.$18(this.$Df.LegalUrl)||(f=String.format(_nbs.NonBootStrings.l_OnlineMeetingLegalSectionPlainText_Text,this.$Df.LegalUrl));_js.$9.$18(this.$Df.CustomFooterText)||(t=String.format("{1}{0}{1}",this.$Df.CustomFooterText,i))}var h=_d.$Hx.$7qU(this.$Df,o,n);s=n?String.format(_nbs.NonBootStrings.l_RichTextOnlineMeetingInformationForEventComposeForm_Text,this.$Df.WebUrl,h,this.$Df.ExternalDirectoryUri,r,this.$Df.InternalDirectoryUri,u,f,t):String.format(_nbs.NonBootStrings.l_PlainTextOnlineMeetingInformationForEventComposeForm_Text,this.$Df.WebUrl,h,this.$Df.ExternalDirectoryUri,r,this.$Df.InternalDirectoryUri,u,f,t);return s},$6WY:function(){this.$1Ra&&this.$1Ra.set_$1O(!0)},$2pv:function(){_a.$6.$1c(_a.$0.$6y,"CreateOnlineMeeting");this.set_$CM(!0);this.$Df=null;this.$2e.get_$i()?$3WI(this):$CY(this,"OnBeforeCreateOnlineMeeting",this,null)},$9D7:function(n){var t=n;this.$2e.set_$2Qa(t.$Df.WebUrl);this.set_$4K3(new _d.$qm(this.$2e.get_$16L()));this.$Df=t.$Df;this.set_$CM(!1);$CY(this,"OnCreateOnlineMeetingSucceeded",this,this);this.$4K2=""},$9D6:function(n){this.$1z.$V6(2,[_u.Strings.l_UnableToGetOnlineMeetingInformation_Text],this.$$d_$9dx,!1,_u.Strings.l_RetryButton_LowerCase_Text,_nbs.NonBootStrings.l_Close_LowerCase_Text,_nbs.NonBootStrings.l_UnableToGetOnlineMeetingInformationDialogTitle_Text);this.$4K2=_d.$1Jb.$6w.$iV(n)},$9D5:function(n){this.$4KL("");n.remove_$2m(this.$$d_$9D5);n.remove_$2C(this.$$d_$9D7);n.remove_$1x(this.$$d_$9D6);_a.$6.$1E(null,"CreateOnlineMeeting",this.$4K2,_d.$1Jb.$6w.$PX(n))},$9dx:function(n,t){n?$3WI(this):this.set_$CM(!1)}};_d.$ny=function(n,t){this.$yz=n;this.$k=t};_d.$ny.prototype={$yz:null,$k:null,$E:function(n,t){return new _d.$Hx(n,this.$yz,t,this.$k)}};_d.$12r=function(n,t,i){this.$$d_$6DI=Function.createDelegate(this,this.$6DI);this.$$d_$6DH=Function.createDelegate(this,this.$6DH);this.$$d_$6DF=Function.createDelegate(this,this.$6DF);if(_a.$5t.$2t){this.$o=n;this.$WW=new _d.$3U(t,new _d.$ty(n.$X3.$D5),n,n.$w,i);this.$WW.$49();this.$WW.set_$3G2(this.$$d_$6DF);this.$WW.set_$3G1(this.$$d_$6DH);this.$WW.set_$6DJ(this.$$d_$6DI)}};_d.$12r.prototype={$WW:null,$o:null,$6DF:function(n){_a.$5t.$2t&&this.$o.$o&&this.$o.$o.$t&&this.$o.$o.$t.set_$Vg(n)},$6DH:function(n){_a.$5t.$2t&&this.$o.$o&&this.$o.$o.$t&&this.$o.$o.$t.set_$Tw(n)},$6DI:function(){_a.$5t.$2t&&this.$o.$2fD(64)},$2fD:function(n,t,i){if(_a.$5t.$2t&&t&&t.get_$i()&&!t.get_$1y5()&&!t.get_$2Oz()){_js.Trace.logInfo(_a.$0.$1k,"Prepares to submit policyTips action");var r=_a.$3N.$1ub(t.get_$2i());var u=_a.$3N.$1ub(t.$mE);var f=t.get_$i();n?this.$WW.$2e2(f,n.get_$1N(),r,u,i):this.$WW.$2e2(f,null,r,u,i)}},$82Z:function(){if(!_a.$5t.$2t||!this.$o.$o||!this.$o.$o.$t)return!1;switch(this.$WW.$2vI()){case 1:return!1;case 2:case 3:return $6(this.$o.$o.$t.get_$Vg())&&$6(this.$o.$o.$t.get_$Tw());case 4:case 5:return $6(this.$o.$o.$t.get_$Tw());default:return!1}},$7tD:function(){if(!_a.$5t.$2t)return"";switch(this.$WW.$2vI()){case 2:case 3:return _nbs.NonBootStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _nbs.NonBootStrings.l_PolicyTipsBlockSend_Text;default:return""}}};_d.$4M=function(n,t,i,r){this.$$d_$7UG=Function.createDelegate(this,this.$7UG);this.$$d_$9f3=Function.createDelegate(this,this.$9f3);this.$$d_$6EI=Function.createDelegate(this,this.$6EI);this.$$d_$9zO=Function.createDelegate(this,this.$9zO);_d.$4M.initializeBase(this);this.$E5=n;this.$uh=t;this.$1z=i;this.$C=r;this.$TK=_d.$He.$5iz(this.$E5.$Jg.$65,this.$uh.get_$Nk(),this.$C);this.$1Ft=_d.$4M.$7vm();this.$4eA=_d.$4M.$7zD();this.$4Pk=_d.$4M.$7ww();this.$4GZ=_d.$4M.$7vT();$6rL(this);this.set_$1RT(this.$1Ft.get_$3q(0));this.set_$2g0(this.$4eA.get_$3q(0));this.set_$2WA(this.$4GZ.get_$3q(0));this.set_$2Zj(this.$4Pk.get_$3q(0));this.$E5.$Y("RecurrenceDataObject",this.$$d_$9zO);this.$E5.$Y("RecurrencePattern",this.$$d_$9zO);this.$E5.$Jg.$Y("StartDate",this.$$d_$6EI);this.$El=new _C(this.$$d_$9f3,_a.$0.$1k);this.$7V=new _C(this.$$d_$7UG,_a.$0.$1k);this.set_$DP(this);var u=new _js.$Z;u.$D(new _a.$2G(this.$El,_nbs.NonBootStrings.l_ComposeRecurrenceDialogSaveButtonTitle_Text));u.$D(new _a.$2G(this.$7V,_nbs.NonBootStrings.l_ComposeRecurrenceDialogCancelButtonTitle_Text));this.set_$Sc(u)};_d.$4M.$7vm=function(){var n=new _js.$Z;n.$D(new _d.$Jc(0));n.$D(new _d.$JM(0,0));n.$D(new _d.$Jx(0,0));n.$D(new _d.$Jy(0,"None",0));n.$D(new _d.$KP(0,0));n.$D(new _d.$LL("None",0,0));return n};_d.$4M.$7zD=function(){var n=new _js.$Z;n.$D(1);n.$D(2);n.$D(4);n.$D(8);n.$D(16);n.$D(32);n.$D(64);return n};_d.$4M.$7ww=function(){var n=new _js.$Z;n.$D("First");n.$D("Second");n.$D("Third");n.$D("Fourth");n.$D("Last");return n};_d.$4M.$7vT=function(){var n=new _js.$Z;n.$D(0);n.$D(1);n.$D(2);n.$D(3);n.$D(4);n.$D(5);n.$D(6);n.$D(7);n.$D(8);n.$D(9);n.$D(10);n.$D(11);return n};function $196(n,t){return(n.$1rx&t)===t}function $6rM(n){var t=_d.$2r.$5DT(n.$E5.$Jg.$65.get_$Dr());n.set_$2qz(t);$4l4(n);n.set_$2r1(n.$E5.$Jg.$65.get_$51().toString());n.set_$1wm("1");n.set_$2WA(n.$E5.$Jg.$65.get_$2z());n.set_$2Zj(_d.$2r.$2wg(n.$E5.$Jg.$65));n.set_$2g0(t)}function $1Vb(n,t,i){t&&!$196(n,i)?n.set_$2qz(n.$1rx|i):!t&&$196(n,i)&&n.set_$2qz(n.$1rx&~i)}function $3WJ(n){for(var i=null,t=0;t<n.$TK.get_$B();++t)if(_d.$To.isInstanceOfType(n.$TK.get_$3q(t))&&n.$TK.get_$3q(t).$2R(n.$E5.get_$Hi())){i=n.$TK.get_$3q(t);break}if($6(i)){var r=n.$C.get_$L()==="TouchNarrow"?n.$TK.get_$B()-1:n.$TK.get_$B()-2;if($6(n.$2qf)){r++;n.$TK.$72(r,_nbs.NonBootStrings.l_CustomPattern_Text)}n.$2qf=n.$E5.get_$Hi();return n.$TK.get_$3q(r)}else return i}function $4l3(n){var t=n.$E5.get_$Hi();if(_d.$Jc.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(0));n.set_$1wm(t.$B4.toString())}else if(_d.$JM.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(1));n.set_$1wm(t.$B4.toString());n.set_$2qz(t.$12A)}else if(_d.$Jx.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(2));n.set_$1wm(t.$B4.toString());n.set_$2r1(t.$Qr.toString())}else if(_d.$Jy.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(3));n.set_$1wm(t.$B4.toString());n.set_$2Zj(t.$Ck);n.set_$2g0(t.$Qs)}else if(_d.$KP.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(4));n.set_$2WA(t.$YT);n.set_$2r1(t.$Qr.toString())}else if(_d.$LL.isInstanceOfType(t)){n.set_$1RT(n.$1Ft.get_$3q(5));n.set_$2WA(t.$YT);n.set_$2Zj(t.$Ck);n.set_$2g0(t.$Qs)}n.set_$4Wm(!_d.$To.isInstanceOfType(n.$Yn))}function $6rL(n){var t=$3WJ(n);n.set_$273(t);n.set_$4Wm(!_d.$To.isInstanceOfType(t));n.set_$6Wo(!_d.$IH.isInstanceOfType(t))}function $4l4(n){$3(n,"MondaySelected");$3(n,"TuesdaySelected");$3(n,"WednesdaySelected");$3(n,"ThursdaySelected");$3(n,"FridaySelected");$3(n,"SaturdaySelected");$3(n,"SundaySelected")}function $6rN(n){var t=n.$24j;n.set_$9np(_d.$Jc.isInstanceOfType(t));n.set_$9ps(_d.$JM.isInstanceOfType(t));n.set_$9oj(_d.$Jx.isInstanceOfType(t));n.set_$9ok(_d.$Jy.isInstanceOfType(t));n.set_$9pv(_d.$KP.isInstanceOfType(t));n.set_$9pu(_d.$LL.isInstanceOfType(t))}function $6rO(n){if(_d.$To.isInstanceOfType(n.$Yn)){n.$E5.set_$Hi(n.$Yn);$3WK(n)}else if(n.$Yn===_nbs.NonBootStrings.l_CustomPattern_Text){n.$E5.set_$Hi(n.$2qf);$3WK(n)}else if(n.$Yn===_nbs.NonBootStrings.l_EditPattern_Text){$6rM(n);$4l3(n)}n.set_$6Wo(!_d.$IH.isInstanceOfType(n.$E5.get_$Hi()))}function $3WK(n){n.set_$4Wm(!_d.$To.isInstanceOfType(n.$Yn))}_d.$4M.prototype={$C:null,$uh:null,$1z:null,$E5:null,$1Ft:null,$4eA:null,$4GZ:null,$4Pk:null,$El:null,$7V:null,$TK:null,$1rx:0,$Yn:null,$272:null,$2IT:null,$2O5:null,$2cx:!1,$2cy:!1,$3OL:!1,$3P9:!1,$3Oe:!1,$3Of:!1,$3PB:!1,$3PA:!1,$2cw:!1,$24B:null,$2CF:null,$24j:null,$2qf:null,get_$1wm:function(){return this.$2O5},set_$1wm:function(n){if(this.$2O5!==n){this.$2O5=n;$3(this,"IntervalString")}return n},get_$2r1:function(){return this.$2IT},set_$2r1:function(n){if(this.$2IT!==n){this.$2IT=n;$3(this,"DayString")}return n},get_$9pG:function(){return this.$2cx},set_$9pG:function(n){if(this.$2cx!==n){this.$2cx=n;$3(this,"ShowRecurrencePicker")}return n},get_$4Wm:function(){return this.$2cy},set_$4Wm:function(n){if(this.$2cy!==n){this.$2cy=n;$3(this,"ShowRecurrenceString")}return n},get_$3DG:function(){return $196(this,2)},set_$3DG:function(n){$1Vb(this,n,2);return n},get_$3SN:function(){return $196(this,4)},set_$3SN:function(n){$1Vb(this,n,4);return n},get_$3U3:function(){return $196(this,8)},set_$3U3:function(n){$1Vb(this,n,8);return n},get_$3R5:function(){return $196(this,16)},set_$3R5:function(n){$1Vb(this,n,16);return n},get_$2uw:function(){return $196(this,32)},set_$2uw:function(n){$1Vb(this,n,32);return n},get_$3Ll:function(){return $196(this,64)},set_$3Ll:function(n){$1Vb(this,n,64);return n},get_$3QT:function(){return $196(this,1)},set_$3QT:function(n){$1Vb(this,n,1);return n},get_$9np:function(){return this.$3OL},set_$9np:function(n){if(this.$3OL!==n){this.$3OL=n;$3(this,"ShowDailyRecurrence")}return n},get_$9ps:function(){return this.$3P9},set_$9ps:function(n){if(this.$3P9!==n){this.$3P9=n;$3(this,"ShowWeeklyRecurrence")}return n},get_$9oj:function(){return this.$3Oe},set_$9oj:function(n){if(this.$3Oe!==n){this.$3Oe=n;$3(this,"ShowMonthlyByDayRecurrence")}return n},get_$9ok:function(){return this.$3Of},set_$9ok:function(n){if(this.$3Of!==n){this.$3Of=n;$3(this,"ShowMonthlyByWeekRecurrence")}return n},get_$9pv:function(){return this.$3PB},set_$9pv:function(n){if(this.$3PB!==n){this.$3PB=n;$3(this,"ShowYearlyRecurrence")}return n},get_$9pu:function(){return this.$3PA},set_$9pu:function(n){if(this.$3PA!==n){this.$3PA=n;$3(this,"ShowYearlyByWeekRecurrence")}return n},get_$6Wo:function(){return this.$2cw},set_$6Wo:function(n){if(this.$2cw!==n){this.$2cw=n;$3(this,"ShowRangeFields")}return n},get_$273:function(){return this.$Yn},set_$273:function(n){if(this.$Yn!==n){this.$Yn=n;$6rO(this);$3(this,"RecurrenceSelected")}return n},get_$2WA:function(){return this.$24B},set_$2WA:function(n){if(this.$24B!==n){this.$24B=n;$3(this,"MonthsSelected")}return n},get_$1RT:function(){return this.$24j},set_$1RT:function(n){if(this.$24j!==n){this.$24j=n;$6rN(this);$3(this,"OccursSelected")}return n},get_$2g0:function(){return this.$2CF},set_$2g0:function(n){if(this.$2CF!==n){this.$2CF=n;$3(this,"WeekdaysSelected")}return n},get_$2Zj:function(){return this.$272},set_$2Zj:function(n){if(this.$272!==n){this.$272=n;$3(this,"RecurrenceOrderSelected")}return n},get_$9ZK:function(){return this.$TK},set_$9ZK:function(n){if(this.$TK!==n){this.$TK=n;$3(this,"RecurrenceOptions")}return n},get_$2qz:function(){return this.$1rx},set_$2qz:function(n){this.$1rx=n;$4l4(this);return n},get_$a6:function(){var n=_a.$CD.$6Gr(this.$2O5);return isNaN(n)?0:n},get_$1Yq:function(){var n=_a.$CD.$6Gr(this.$2IT);return isNaN(n)?0:n},$9f3:function(){var n=this.$24j;if(_d.$Jc.isInstanceOfType(n))n.$B4=this.get_$a6();else if(_d.$JM.isInstanceOfType(n)){n.$B4=this.get_$a6();n.$12A=this.$1rx}else if(_d.$Jx.isInstanceOfType(n)){n.$B4=this.get_$a6();n.$Qr=this.get_$1Yq()}else if(_d.$Jy.isInstanceOfType(n)){n.$B4=this.get_$a6();n.$Qs=this.$2CF;n.$Ck=this.$272}else if(_d.$KP.isInstanceOfType(n)){n.$Qr=this.get_$1Yq();n.$YT=this.$24B}else if(_d.$LL.isInstanceOfType(n)){n.$Qs=this.$2CF;n.$YT=this.$24B;n.$Ck=this.$272}if(n.$3TY()){this.$1z.$32(0,_d.$DT.$1um(n.$3TY()),null);return}this.$E5.set_$Hi(n.$3p());$3WK(this);this.$4d.$n()},$7UG:function(){this.set_$273($3WJ(this));this.$4d.$n()},$9zO:function(n,t){this.set_$273($3WJ(this));$4l3(this)},$6EI:function(n,t){for(var i=0,i=0;i<this.$TK.get_$B();i++)if(String.isInstanceOfType(this.$TK.get_$3q(i))||this.$TK.get_$3q(i).$2R(this.$E5.get_$Hi()))break;this.set_$9ZK(_d.$He.$5iz(this.$E5.$Jg.$65,this.$uh.get_$Nk(),this.$C));$6(this.$2qf)||this.$TK.$72(this.$C.get_$L()==="TouchNarrow"?this.$TK.get_$B():this.$TK.get_$B()-1,_nbs.NonBootStrings.l_CustomPattern_Text);this.set_$273(this.$TK.get_$3q(i))}};_d.$4B=function(n,t,i,r,u){this.$$d_$99M=Function.createDelegate(this,this.$99M);this.$$d_$9Dn=Function.createDelegate(this,this.$9Dn);this.$$d_$4Jm=Function.createDelegate(this,this.$4Jm);this.$4G=new Sys.EventHandlerList;this.$2ad=new(_a.$3X.$$(String));_d.$4B.initializeBase(this);_a.$4.$l(r,"itemViewModel");_a.$4.$l(n,"gridUserAvailabilityCoordinator");this.$2mR=i;this.$JS=n;this.$SW=t;this.$c=u;this.$2L6=$6rQ(this);this.$6Op=_d.$4B.$7ec(r.$6d);this.$5Oe=new _d.$jA;var f=_d.$6k.$3sv(r.$6d);this.$6Fm=f.$2Q;this.$6Fg=f.$3D;this.set_$Lk(r.$t.get_$y());this.$1y1=r.$t.get_$1cZ();this.$31r=r.$t.get_$AW();this.$JS.add_$2nD(this.$$d_$4Jm);this.$SW.add_$2nD(this.$$d_$9Dn);this.$JS.$Y("HasActiveRequests",this.$$d_$99M);this.$SW.$Y("HasActiveRequests",this.$$d_$99M)};_d.$4B.$6V=function(n){return n==="Tentative"||n==="Busy"||n==="OOF"};_d.$4B.$7vx=function(n,t){for(var u=t.get_$Fc().get_$3T(),f=new(_a.$3X.$$(_d.$KE)),i=0;i<u.get_$B();++i){var r=new _d.$KE(u.get_$3q(i));n.$1OL(r)&&_d.$4B.$6V(r.$mM)&&f.$D(r)}return f};_d.$4B.$7vy=function(n,t){for(var u=new(_a.$3X.$$(_d.$KE)),i=0;i<t.get_$B();++i){var r=t.get_$3q(i);n.$1OL(r)&&_d.$4B.$6V(r.$mM)&&u.$D(r)}return u};_d.$4B.$7ec=function(n){var i={};if(n.get_$i()){for(var r=new _d.$1Bf,t=null,u=0;u<n.get_$7S().get_$B();u++){t=n.get_$7S().get_$3q(u);i[t.get_$7B().EmailAddress]=r.$36(t.get_$TM(),null)}for(var f=0;f<n.get_$8W().get_$B();f++){t=n.get_$8W().get_$3q(f);i[t.get_$7B().EmailAddress]=r.$36(t.get_$TM(),null)}for(var e=0;e<n.get_$9F().get_$B();e++){t=n.get_$9F().get_$3q(e);i[t.get_$7B().EmailAddress]=r.$36(t.get_$TM(),null)}var o=n.get_$FE();o?i[o.Mailbox.EmailAddress]=r.$36("Organizer",null):_js.Trace.logError(_a.$0.$ep,"Organizer is not expected to be null for this "+(n.get_$x8()?"full":"partial")+" calendar item, with ItemID "+n.get_$i()+". RequiredAttendees.Count = "+n.get_$7S().get_$B()+". OptionalAttendees.Count = "+n.get_$8W().get_$B()+". Resources.Count = "+n.get_$9F().get_$B()+". IsOrganizer = "+n.get_$I2())}return i};function $3WL(n,t,i,r){for(var u=_c.$G5.$3k7(t),w=n.$JS.$13G(i),f=[],a=0;a<w.get_$B();a++){var e=w.get_$3q(a);if(f.length)if($6(e.get_$Fc().get_$rx()))_js.Trace.logWarning(_a.$0.$ep,"MergedFreeBusy property for a room was null");else for(var o=0;o<f.length;o++)e.get_$Fc().get_$rx().charAt(o)<f[o]&&(f[o]=e.get_$Fc().get_$rx().charAt(o));else if($6(e.get_$Fc().get_$rx()))_js.Trace.logWarning(_a.$0.$ep,"MergedFreeBusy property for a room was null");else for(var v=0;v<e.get_$Fc().get_$rx().length;v++)Array.add(f,e.get_$Fc().get_$rx().charAt(v))}u.get_$Fc().$K(_c.$9j.$2SI,f.join(""));u.get_$Fc().$K(_c.$9j.$2L7,"FreeBusyMerged");if(r){var h;var y;var b,k;$3WM(n,n.$2mR,b={val:h},k={val:y});h=b.val;y=k.val;for(var d=n.$2mR===1?_a.$7.$Ky(n.$122).$4F():n.$122.$4F(),p=d.$3p(),c,s=h;s<y&&u.get_$Fc().get_$rx().length>0;s++){c=d.$BX((s-h+1)*n.$c.get_$1I().get_$qv());var g=new _h.$4e(p,c);if(_d.$4B.$6V($1na(n,u,s))&&_h.$4e.$1Wc(g,r)){var l=new _g.$33;l.set_$y(p);l.set_$1u(c);l.set_$9S($1na(n,u,s));u.get_$Fc().get_$3T().$D(l)}p=c}}return u}function $4l7(n,t){var o=new(_a.$3X.$$(_d.$KE));var i;var r;var h=1440/n.$c.get_$1I().get_$qv();var f;if(t.get_$Fc().get_$rx().length===h){i=0;r=h;f=n.$SW.$Kk.$2Q}else{var c,l;$3WM(n,0,c={val:i},l={val:r});i=c.val;r=l.val;f=n.$122}for(var s=i,e=$1na(n,t,i),u=i+1;u<r;u++){var a=$1na(n,t,u);if(a!==e){$4l5(n,o,f,e,i,s,u);s=u;e=a}}$4l5(n,o,f,e,i,s,r);return o}function $4l5(n,t,i,r,u,f,e){if(r!=="Free"){var s=(e-f)*n.$c.get_$1I().get_$qv();var o=new _g.$33;o.set_$y(i.$4F().$BX((f-u)*n.$c.get_$1I().get_$qv()));o.set_$1u(o.get_$y().$BX(s));o.set_$9S(r);t.$D(new _d.$KE(o))}}function $6rT(n,t,i){for(var u="Free",e=n.$2L6.Free,f=0;f<i.get_$Fc().get_$3T().get_$B();f++){var r=i.get_$Fc().get_$3T().get_$3q(f);if(t.$1OL(r)){var o=n.$2L6[r.get_$9S()];if(o>e){e=o;u=r.get_$9S()}if(u===_d.$4B.$4Gb)break}else if(r.get_$y().$2R(t.$3D)>0)break}return u}function $6rU(n,t,i){for(var u="Free",e=n.$2L6.Free,f=0;f<i.get_$B();f++){var r=i.get_$3q(f);if(t.$1OL(r)){var o=n.$2L6[r.$mM];if(o>e){e=o;u=r.$mM}if(u===_d.$4B.$4Gb)break}else if(r.$2Q.$2R(t.$3D)>0)break}return u}function $6rV(n,t,i){var r;if(_h.$4e.$1Wc(n.$JS.$Kk,t)){_js.Trace.logInfo(_a.$0.$ep,"Fetching free-busy information for attendees from grid cache...");r=n.$JS.$13G(i)}else r=n.$SW.$13G(i);return r}function $4l6(n,t){var i=n.$4G.getHandler("DetailsCacheUpdateEvent");i&&i(t)}function $6rR(n){var t=n.$4G.getHandler("CacheRefreshRequested");t&&t()}function $6rW(n,t,i,r,u){r.val=null;i.$D(t);var e=i.$3p();var o=null;if(n.$kd&&e.$7G(n.$kd.EmailAddress)){e.$34(n.$kd.EmailAddress);o=$3WL(n,n.$kd.EmailAddress,n.$2ad,null)}u.val=n.$JS.$13G(e);o&&u.val.$D(o);for(var f=0;f<u.val.get_$B();){if(u.val.get_$3q(f).$VI===t){_js.Trace.logInfo(_a.$0.$ep,"Found organizer{0} free busy model",u.val.get_$3q(f).$VI);r.val=u.val.get_$3q(f);u.val.$68(f);continue}f++}}function $6rS(n,t,i,r,u){var l=new _js.$Z;var e;var s;var a,v;$3WM(n,t,a={val:e},v={val:s});e=a.val;s=v.val;for(var y=t===1?_a.$7.$Ky(n.$122).$4F():n.$122.$4F(),p=y.$3p(),h,f=e;f<s;f++){var o=0;var w=$1na(n,i,f);_d.$4B.$6V(w)&&o++;for(var c=0;c<r.get_$B();c++)_d.$4B.$6V($1na(n,r.get_$3q(c),f))&&o++;h=y.$BX((f-e+1)*n.$c.get_$1I().get_$qv());o>0&&l.$D(new _d.$zh(w,$6rP(n,o,u),p,h,n.$1y1,n.$31r));p=h}return l}function $3WM(n,t,i,r){var u=null;var e=0;var f=1440/n.$c.get_$1I().get_$qv();switch(t){case 0:u=n.$122.$4F();break;case 1:u=_a.$7.$Ky(n.$122).$4F();f=f*7;break;default:throw Error.notImplemented(_d.$u3.toString(t));}e=Math.abs(n.$JS.$Kk.$2Q.$5z(u));var o=6e4*n.$c.get_$1I().get_$qv();i.val=e/o;r.val=i.val+f}function $1na(n,t,i){if($6(t)||_js.$9.$a(t.get_$Fc().get_$rx()))return"NoData";else{var r=t.get_$Fc().get_$rx().charAt(i).toString();switch(r){case"0":return"Free";case"1":return"Tentative";case"2":return"Busy";case"3":return"OOF";case"4":return"WorkingElsewhere";case"5":return"NoData";default:_js.Trace.logError(_a.$0.$ep,"Unexpected merged string encountered:'{0}')",r);return"NoData"}}}function $6rP(n,t,i){if(!i)return 0;var r=t/i;if(r>.9&&r<1)return.9;else if(r>0&&r<.15)return.15;return r}function $4l8(n,t,i,r,u,f,e){var o;var s;var h=!1;if($6(f)){o="NoData";s=_u.Strings.l_LoadingWithEllipses_Text;u="NoError"}else{o=f;s=n.$5Oe.$36(o,null)}if(n.$6Fm.$4e(i)&&n.$6Fg.$4e(r)){var c=n.$6Op[t];if(!$6(c)){h=!0;s=c}}return new _d.$F1(t,o,s,h,u,e)}function $6rQ(n){var t={};t.Free=0;t.WorkingElsewhere=1;t.Tentative=2;t.Busy=3;t.OOF=4;return t}function $6rX(n,t){if(_h.$4e.$1Wc(n.$JS.$Kk,n.$SW.$Kk)){var i=n.$JS.$13G(t);n.$SW.$9yi(i);if(i.get_$B()!==t.get_$B()){for(var r=new(_a.$3X.$$(String)),e={},u=0;u<i.get_$B();u++)e[i.get_$3q(u).$VI]=!0;for(var f=0;f<t.get_$B();f++){var o=t.get_$3q(f);e[o]||r.$D(o)}_js.Trace.logInfo(_a.$0.$ep,"Requesting FB for missing effective users {0}",r);n.$SW.$13G(r)}}}_d.$4B.prototype={$JS:null,$SW:null,$5Oe:null,$2mR:0,$6Fm:null,$6Fg:null,$2L6:null,$6Op:null,$c:null,$1y1:!1,$31r:!1,$kd:null,$122:null,$361:null,$41P:!1,$3Lt:null,add_$2wn:function(n){this.$JS.add_$2nD(n)},remove_$2wn:function(n){this.$JS.remove_$2nD(n)},add_$3nU:function(n){this.$4G.addHandler("DetailsCacheUpdateEvent",n)},remove_$3nU:function(n){this.$4G.removeHandler("DetailsCacheUpdateEvent",n)},get_$5kG:function(){return this.$361},set_$5kG:function(n){if(!_a.$7.$4N(this.$361,n)){if(n.$3j2())throw Error.argument("MeetingStartDate","value should not contain time part.");this.$361=n;this.$SW.$6eK(this.$361,null)}return n},get_$Lk:function(){return this.$122},set_$Lk:function(n){if(!_a.$7.$4N(this.$122,n)){this.$122=n;if(this.$JS.$5fI(n))return n;var t=this.$3Lt.$3t4(!1);var i=_a.$7.$Ky(n);$6rX(this,t);this.$JS.$6eK(i,t)}return n},get_$41Q:function(){return this.$41P},set_$41Q:function(n){if(this.$41P!==n){this.$41P=n;$N(this,"IsLoadingData")}return n},get_$6QS:function(){return this.$3Lt},set_$6QS:function(n){this.$3Lt=n;return n},get_$28M:function(){return this.$kd},set_$28M:function(n){this.$kd=n;return n},get_$6PI:function(){return this.$2ad},$7sP:function(n,t){var i=null;var r=null;t=t.$3p();var u,f;$6rW(this,n,t,u={val:r},f={val:i});r=u.val;i=f.val;return $6rS(this,this.$2mR,r,i,t.get_$B())},$7tY:function(n){for(var i=this.$JS.$13G(n),r={},t=0;t<i.get_$B();t++){var u=i.get_$3q(t);r[u.$VI]=u.$Oz}return r},$7xR:function(n,t,i){var a=new _h.$4e(n,t);var u={};var e=i.$3p();if(this.$kd&&e.$7G(this.$kd.EmailAddress)){e.$34(this.$kd.EmailAddress);for(var o=$3WL(this,this.$kd.EmailAddress,this.$2ad,a),v=new(_a.$3X.$$(_d.$KE)),s=0;s<o.get_$Fc().get_$3T().get_$B();s++)v.$D(new _d.$KE(o.get_$Fc().get_$3T().get_$3q(s)));u[o.$VI]=v}for(var y=this.$JS.$13G(e),h=0;h<y.get_$B();h++){var r=y.get_$3q(h);var f=null;switch(r.get_$Fc().get_$2uv()){case"None":break;case"MergedOnly":f=$4l7(this,r);break;default:f=new(_a.$3X.$$(_d.$KE));for(var c,l=0;l<r.get_$Fc().get_$3T().get_$B();l++){c=new _d.$KE(r.get_$Fc().get_$3T().get_$3q(l));a.$1OL(c)&&f.$D(c)}break}u[r.$VI]=f}var p=this;i.$Bh(function(n){$6(u[n])});return u},$82W:function(n,t,i,r){var u=new _h.$4e(n,t);if(_h.$4e.$1Wc(this.$JS.$Kk,u)){if(this.$JS.$5Uj(i))return!0;r&&this.$JS.$13G(i)}else{if(this.$SW.$5Uj(i))return!0;r&&this.$SW.$13G(i)}return!1},$2Lr:function(n,t,i,r){var f=new _h.$4e(n,t);var h=i.$3p();var c=null;if(r&&this.$kd&&h.$7G(this.$kd.EmailAddress)){h.$34(this.$kd.EmailAddress);c=$3WL(this,this.$kd.EmailAddress,this.$2ad,f)}var l=$6rV(this,f,h);c&&l.$D(c);for(var e={},a=0;a<l.get_$B();a++){var u=l.get_$3q(a);var o=null;var s="Free";switch(u.get_$Fc().get_$2uv()){case"None":s="NoData";break;case"MergedOnly":o=_d.$4B.$7vy(f,$4l7(this,u));s=$6rU(this,f,o);break;default:o=_d.$4B.$7vx(f,u);s=$6rT(this,f,u);break}e[u.$VI]=$4l8(this,u.$VI,n,t,u.$Oz,s,o)}var v=this;i.$Bh(function(i){$6(e[i])&&(e[i]=$4l8(v,i,n,t))});return e},$gm:function(){_js.Trace.logInfo(_a.$0.$ep,"Refreshing Scheduling Grid Cache...");$6rR(this);var n=this.$3Lt.$3t4(!0);this.$JS.$gm(n,!0);if(!this.$JS.$Kk.$7G(this.$SW.$Kk,!0)){_js.Trace.logInfo(_a.$0.$ep,"Refreshing Scheduling Details Cache...");this.$SW.$gm(n,!0)}},$9zA:function(n){this.$JS.$4RC(n);this.$SW.$4RC(n);this.$gm()},$4Jm:function(n){if(this.$JS.$Kk.$7G(this.$SW.$Kk,!0)){_js.Trace.logInfo(_a.$0.$ep,"[Grid] Fire details cache event. Grid:{0} - Detail{1}",this.$JS.$Kk,this.$SW.$Kk);$4l6(this,n)}else _js.Trace.logInfo(_a.$0.$ep,"[Grid] Suppress detail cache event. Grid:{0} - Detail{1}",this.$JS.$Kk,this.$SW.$Kk)},$9Dn:function(n){if(this.$JS.$Kk.$7G(this.$SW.$Kk,!0))_js.Trace.logInfo(_a.$0.$ep,"[Detail] Suppressing details cache event. Grid:{0} - Detail{1}",this.$JS.$Kk,this.$SW.$Kk);else{_js.Trace.logInfo(_a.$0.$ep,"[Detail] Fire details cache event. Grid:{0} - Detail{1}",this.$JS.$Kk,this.$SW.$Kk);$4l6(this,n)}},$99M:function(n,t){this.set_$41Q(this.$JS.$2MX||this.$SW.$2MX)}};_d.$NB=function(){};_d.$NB.$9hm=function(n){for(var r=[],t=0;t<n.get_$B();++t){var i={};i.DisplayName=n.get_$3q(t).get_$7B().Name;i.SmtpAddress=n.get_$3q(t).get_$7B().EmailAddress;i.RoutingType=n.get_$3q(t).get_$7B().RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$NB.$7iK=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$Z;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _g.$3i;var i=new _g.$1l;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.set_$7B(i);t.$D(u)});return t};_d.$NB.$9hn=function(n){for(var r=[],t=0;t<n.get_$B();++t){var i={};i.DisplayName=n.get_$3q(t).$CA.get_$1o();i.SmtpAddress=n.get_$3q(t).$CA.get_$1l().EmailAddress;i.RoutingType=n.get_$3q(t).$CA.get_$1l().RoutingType;i.GALContactGuid=n.get_$3q(t).$CA.get_$qc();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$NB.$7iL=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$Z;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.$1l;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.$D(i)});return t};_d.$ka=function(n,t){this.$$d_$7oT=Function.createDelegate(this,this.$7oT);this.$$d_$9BZ=Function.createDelegate(this,this.$9BZ);this.$$d_$9Ba=Function.createDelegate(this,this.$9Ba);_d.$ka.initializeBase(this);this.$2U=t;this.$l0=n;this.$2U.add_$2nC(this.$$d_$9Ba);this.$2U.add_$5KW(this.$$d_$9BZ)};_d.$ka.prototype={$2U:null,$l0:null,add_$5Re:function(n){this.$2N("GetOnlineMeetingInformationCompleted",n)},remove_$5Re:function(n){this.$2P("GetOnlineMeetingInformationCompleted",n)},get_$2PP:function(){return this.$l0.get_$2PP()},$88Z:function(n){return!!n&&!n.get_$16L()&&(_g.$Ej.isInstanceOfType(n.get_$5k())&&this.$l0.get_$2PP()||_g.$9G.isInstanceOfType(n.get_$5k())&&this.$l0.$30b(n.get_$5k().get_$2Y3()))},$7xz:function(n){return!n||!n.get_$5k()?null:_g.$9G.isInstanceOfType(n.get_$5k())?n.get_$5k().get_$2Y3():this.$l0.get_$2RQ()},$1v0:function(n){this.$l0.$1v0(n,this.$$d_$7oT)},$4c:function(){this.$2U.remove_$5KW(this.$$d_$9BZ);this.$2U.remove_$2nC(this.$$d_$9Ba);_js.$8.prototype.$4c.call(this)},$7oT:function(n,t){$Ju(this,"GetOnlineMeetingInformationCompleted",this,n)},$9BZ:function(n,t){var i=this.$2U.$wW(t.get_$A5());i.$2no(t)&&!t.get_$1yD()&&this.$l0.$1v0(t.get_$2Y3(),this.$$d_$7oT)},$9Ba:function(n){this.$l0.$49(this.$$d_$7oT)}};_d.$qm=function(n){_d.$qm.initializeBase(this);this.$z0=n;this.set_$DP(this);var t=new _js.$Z;t.$D(new _a.$2G(this.$4d,_u.Strings.l_Close_Text));this.set_$Sc(t)};_d.$qm.prototype={$z0:null,get_$9IT:function(){switch(this.$z0.get_$3c1()){case"Everyone":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelEveryone_Text;case"Internal":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelInternal_Text;case"Invited":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelInvited_Text;case"Locked":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelLocked_Text;default:return""}},get_$9IU:function(){switch(this.$z0.get_$45o()){case"Disabled":return _nbs.NonBootStrings.l_OnlineMeetingLobbyBypassDisabled_Text;case"EnabledForGatewayParticipants":return _nbs.NonBootStrings.l_OnlineMeetingLobbyBypassEnabledForGatewayParticipants_Text;default:return""}},get_$9IV:function(){switch(this.$z0.get_$4OW()){case"Disabled":return _nbs.NonBootStrings.l_OnlineMeetingPresentersDisabled_Text;case"Internal":return _nbs.NonBootStrings.l_OnlineMeetingPresentersInternal_Text;case"Everyone":return _nbs.NonBootStrings.l_OnlineMeetingPresentersEveryone_Text;default:return""}}};_d.$47=function(n){this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$7Q3=Function.createDelegate(this,this.$7Q3);_d.$47.initializeBase(this,[_d.$47.$9dp(),_d.$47.$9dr(),_d.$47.$9ds(),_d.$47.$9dq(),n,null]);this.$556=_d.$47.$6Oy("AllowMultipleSelection");this.$pV=new _C(this.$$d_$7Q3,_a.$0.$1k);this.$EW=new _C(this.$$d_$iF,_a.$0.$1k);var t=$6v7(this);this.set_$7D(_y.$26.$Bg(null,t,null));this.$3w.set_$4W8(!1);this.$Au()};_d.$47.get_$6Qf=function(){if(!_d.$47.$Hk){_d.$47.$Hk={};_d.$47.$Hk[_d.$4P.toString(0)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$47.$Hk[_d.$4P.toString(1)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$47.$Hk[_d.$4P.toString(2)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$47.$Hk[_d.$4P.toString(3)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$47.$Hk[_d.$4P.toString(4)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelOwners_Text;_d.$47.$Hk[_d.$4P.toString(6)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelGroupModerators_Text;_d.$47.$Hk[_d.$4P.toString(5)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelMembers_Text;_d.$47.$Hk[_d.$4P.toString(7)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelSenders_Text;_d.$47.$Hk[_d.$4P.toString(8)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelAllowedSenders_Text;_d.$47.$Hk[_d.$4P.toString(9)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$47.$Hk[_d.$4P.toString(10)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$47.$Hk[_d.$4P.toString(11)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text}return _d.$47.$Hk};_d.$47.get_$9fd=function(){if(!_d.$47.$dd){_d.$47.$dd={};_d.$47.$dd[_d.$4P.toString(0)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$47.$dd[_d.$4P.toString(1)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$47.$dd[_d.$4P.toString(2)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$47.$dd[_d.$4P.toString(3)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$47.$dd[_d.$4P.toString(4)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupOwner_Text;_d.$47.$dd[_d.$4P.toString(6)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupModerator_Text;_d.$47.$dd[_d.$4P.toString(5)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupMember_Text;_d.$47.$dd[_d.$4P.toString(7)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkSender_Text;_d.$47.$dd[_d.$4P.toString(8)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkAllowedSenders_Text;_d.$47.$dd[_d.$4P.toString(9)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$47.$dd[_d.$4P.toString(10)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$47.$dd[_d.$4P.toString(11)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text}return _d.$47.$dd};_d.$47.$9dp=function(){var n=window.dialogArguments;return _d.$NB.$7iK(n)};_d.$47.$6Oy=function(n){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);return i[n]};_d.$47.$9dr=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$47.get_$6Qf()[_d.$4P.toString(i)]};_d.$47.$9ds=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$47.get_$9fd()[_d.$4P.toString(i)]};_d.$47.$9dq=function(){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);var r=i.PickerCallerType;var n=null;switch(r){case 0:n=_pc.$14.$wX;break;case 1:n=_pc.$14.$wX;break;case 2:n=_pc.$14.$wX;break;case 3:n=_pc.$14.$wX;break;case 4:n=_pc.$14.$1C9;break;case 6:n=_pc.$14.$1C9;break;case 5:n=_pc.$14.$1C9;break;case 7:n=_pc.$14.$1C9;break;case 8:n=_pc.$14.$1C9;break;case 9:n=_pc.$14.$wX;break;case 10:n=_pc.$14.$1C9;break;case 11:n=_pc.$14.$1C9;break;default:n=_pc.$14.$wX;break}return new _d.$2C(n,_pc.$14.$iZ(),_d.$47.$6Oy("AllowAddAsSmtpAddress"))};function $6v7(n){var t=new Array(2);t[0]=new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItem_Text,n.$pV);t[1]=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,n.$EW);return t}_d.$47.prototype={$pV:null,$EW:null,$3w:null,$556:!1,get_$7D:function(){return this.$3w},set_$7D:function(n){if(this.$3w!==n){this.$3w=n;$3(this,"ApplicationBarViewModel")}return n},$7PI:function(n){return this.$556?!0:n.get_$B()>=1?!1:!0},$9jV:function(n){n.$dk(1,new Array(0),n.get_$1s().get_$1l().EmailAddress)},$1YW:function(n){return this.$6Q.$7fN(_y.$w.$KH,n)},$7Q3:function(){var n=window.dialogArguments;n.Properties=_d.$NB.$9hm(this.$hi);window.close()},$iF:function(){window.close()}};_d.$qz=function(n){this.$6Q=n};_d.$qz.prototype={$6Q:null,$bC:function(n,t){return new _d.$47(this.$6Q)},$vo:function(n,t){return new _d.$47(this.$6Q)}};_d.$ex=function(n,t,i){this.$C=n;this.$280=t;this.$6h=i};function $6wZ(n,t){var i=n.$280.$7cf(t);n.$C.$fC(i,0,!0);return i}function $6wY(n,t,i,r,u){var f=n.$6h.$G3(!1,!0);f.set_$40(_d.$1t.$5RG(i));f.set_$9Xz(r);if(_g.$y.isInstanceOfType(t))f.$13p(t);else throw Error.notImplemented(String.format("Event of type {0} is not supported.",Object.getType(t).getName()));u.$T7(f)}_d.$ex.prototype={$C:null,$280:null,$6h:null,$9rj:function(n,t,i){var r=new _c.$zk(n);var f=new _c.$ss(_nbs.NonBootStrings.l_CurrentMeetingTime_Text,r.get_$2GB());r.set_$2eg(new(_0365f.$o.$$(_c.$ss)));r.get_$2eg().$D(f);r.set_$6b9(_nbs.NonBootStrings.l_ProposeNewTime_UpperCase_Text);var u=$6wZ(this,r);var e=this;u.add_$9fQ(function(){$6wY(e,n,t,u.get_$9gk(),i)})}};_d.$Rc=function(n,t,i,r,u,f){this.$$d_$4Im=Function.createDelegate(this,this.$4Im);this.$$d_$4KH=Function.createDelegate(this,this.$4KH);_d.$Rc.initializeBase(this);this.$6Q=u;this.$3eh=f;this.$9fc=t;this.$2r=r;this.$2r.$11N();this.$2r.set_$NS(i);this.$2r.set_$1jW("PersonaDetailedView");this.$2r.set_$R8(!0);this.$2r.set_$q(!1);this.$2r.add_$gw(this.$$d_$4KH);this.$2r.set_$18b(100);this.$2r.set_$1gB(0);this.$hi=n};function $6vC(n,t){var i=$6vF(n,t);$6(i)||$6(i.$17X)||t.get_$1s().set_$1l(i.$17X);if(!$6vD(n,t.get_$1s().get_$1l().EmailAddress)){var r=new _d.$8a(t.get_$1s(),n.$v7.$1Sd,!0);r.$1HZ=!0;n.$9jV(r);n.$v7.$1Jl(r,3)}}function $6vE(n){for(var i=new _js.$Z,t=0;t<n.$hi.get_$B();t++)i.$D(n.$hi.get_$3q(t).get_$7B());return n.$1YW(i)}function $6vD(n,t){for(var i=0;i<n.$hi.get_$B();i++)if(n.$hi.get_$3q(i).get_$7B().EmailAddress.toLowerCase()===t.toLowerCase())return!0;return!1}function $6vF(n,t){return _d.$8a.isInstanceOfType(t)?t:null}_d.$Rc.prototype={$2r:null,$9fc:null,$hi:null,$6Q:null,$3eh:null,$v7:null,$1ML:null,get_$7Re:function(){return this.$v7},set_$7Re:function(n){this.$v7=n;$3(this,"AttendeeRecipientWellViewModel");return n},$Au:function(){this.$1ML={};this.set_$7Re($6vE(this));this.$v7.$77.remove_$1Z(this.$$d_$4Im);this.$v7.$77.add_$1Z(this.$$d_$4Im);for(var n=0;n<this.$v7.$1T.get_$B();n++){var t=this.$v7.$1T.get_$3q(n);var i=this.$v7.$77.get_$3q(n).EmailAddress;this.$1ML[i]=t}},$7PI:function(n){return!0},$9jV:function(n){},$1YW:function(n){return this.$6Q.$1YW(_y.$w.$KH,n,3)},$4KH:function(n,t){var i=n.get_$Wh();i&&this.$7PI(this.$hi)&&($6(this.$3eh)||this.$3eh(i.get_$1s().get_$1l().EmailAddress))&&$6vC(this,i)},$4Im:function(n,t){switch(t.$2v){case 0:var i=this;Array.forEach(t.$2l,function(n){var t=i.$v7.$1T.get_$3q(i.$v7.$1T.get_$B()-1);var r=t.$5A.$14;i.$1ML[r.get_$1l().EmailAddress]=t;i.$hi.$D(_g.$3i.$wR(r.get_$1l()))});break;case 2:var r=this;Array.forEach(t.$38,function(n){for(var i=n,t=0;t<r.$hi.get_$B();t++)if(r.$hi.get_$3q(t).get_$7B().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$hi.$68(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}}};_d.$fR=function(n){this.$k=n};_d.$fR.prototype={$k:null,$E:function(n,t,i){var f=new _h.$4e(n.$t.get_$y(),n.$t.get_$1u());var u=null;var r=n.$t.get_$9F();r&&r.get_$B()>0&&(u=r.get_$3q(0).get_$7B());return new _d.$IP(i,f,u)},$5EM:function(n,t){var i=new _h.$4e(n.$t.get_$y(),n.$t.get_$1u());var r=this;return new _d.$Ev(this.$k,t,function(){return new _c.$168},i,_d.$IH.isInstanceOfType(n.$E5.get_$Hi()))}};_d.$GN=function(n){if($6(n))this.$3K={};else{if(!_d.$GN.$Bj(n))throw Error.invalidOperation("Cannot construct a UpdateCalendarItemParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.$3K=n}};_d.$GN.$Bj=function(n){return!$6(n[_d.$GN.$rc])&&(!$6(n.Start)||!$6(n.Duration)||!$6(n.IsAllDayEvent))};_d.$GN.prototype={$3K:null,get_$i:function(){if($6(this.$3K[_d.$GN.$rc]))return null;var n=this.$3K[_d.$GN.$rc];return _g.$1q.$2Hc(n)},set_$i:function(n){$6(n)?delete this.$3K[_d.$GN.$rc]:this.$3K[_d.$GN.$rc]=n.Id;return n},get_$y:function(){return this.$3K.Start},set_$y:function(n){this.$3K.Start=n;return n},get_$DS:function(){var n=this.$3K.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DS:function(n){this.$3K.Duration=n;return n},get_$5V:function(){return $6(this.$3K.IsAllDayEvent)?!1:Boolean.parse(this.$3K.IsAllDayEvent)},set_$5V:function(n){this.$3K.IsAllDayEvent=n.toString();return n},$7QP:function(n){$6(this.get_$y())||n.set_$y(this.get_$y());$6(this.get_$DS())||n.set_$1u(n.get_$y().$9K(this.get_$DS()));$6(this.get_$5V())||n.set_$5V(this.get_$5V())}};_d.$F0=function(n,t,i,r,u,f){this.$$d_$7Rr=Function.createDelegate(this,this.$7Rr);this.$4G=new Sys.EventHandlerList;_d.$F0.initializeBase(this);if($6(t))throw Error.argumentNull("submitter");this.$c=i;this.$2U=f;this.$182=t;this.$67m=u;this.$67t=r;this.$1By={};this.$1Jg=new(_a.$3X.$$(_c.$ou));$4oM(this,n)};function $4oM(n,t){var r=t.$2o(-n.$67t).$4F();var i=t.$2o(n.$67m).$4F();r.$4e(i)&&(i=i.$2o(1));n.$Kk=new _h.$4e(r,i);_js.Trace.logInfo(_a.$0.$1mZ,"NewCacheRange: Range:{0}",n.$Kk)}function $3XT(n,t){$6y6(n,t);if(t.get_$B()>0){_js.Trace.logInfo(_a.$0.$1mZ,"Requesting FB:{0} - {1}",n.$Kk,t.toString());var i=new _c.$ou(n.$Kk.$2Q,n.$Kk.$3D,_d.$F0.$5Oc,n.$c.get_$1I().get_$qv(),t);n.$2U.$4Q0(i);i.add_$2m(n.$$d_$7Rr);n.$1Jg.$D(i);n.$182.$z(i)}n.set_$3vW(n.$1Jg.get_$B()>0)}function $6y6(n,t){for(var i=0;i<n.$1Jg.get_$B();i++){var r=n.$1Jg.get_$3q(i);var u=this;r.$zg.$Bh(function(n){t.$34(n)});if(!t.get_$B())return}}function $6y5(n,t){var i=n.$4G.getHandler("CacheUpdateEventName");i&&i(t)}_d.$F0.prototype={$1Jg:null,$67t:0,$67m:0,$2U:null,$182:null,$c:null,$Kk:null,$1By:null,$2MX:!1,add_$2nD:function(n){this.$4G.addHandler("CacheUpdateEventName",n)},remove_$2nD:function(n){this.$4G.removeHandler("CacheUpdateEventName",n)},get_$3vW:function(){return this.$2MX},set_$3vW:function(n){if(this.$2MX!==n){this.$2MX=n;$N(this,"HasActiveRequests")}return n},$5fI:function(n){return this.$Kk.$lo(n,!0,!1)},$6eK:function(n,t){if(!this.$5fI(n)){this.$4RC(n);t&&$3XT(this,t)}},$9yi:function(n){for(var t=0;t<n.get_$B();t++){var i=n.get_$3q(t);this.$1By[i.$VI]=_c.$G5.$7ag(i,this.$Kk)}},$gm:function(n,t){if(t){var i={};var r=this;n.$Bh(function(n){var t=r.$1By[n];t&&(i[n]=t)});this.$1By=i}$3XT(this,n)},$5Uj:function(n){for(var t=0;t<n.get_$B();t++){var i=this.$1By[n.get_$3q(t)];if(!i)return!1}return!0},$13G:function(n){for(var i=new(_a.$3X.$$(_c.$G5)),r=new(_a.$3X.$$(String)),t=0;t<n.get_$B();t++){var u=this.$1By[n.get_$3q(t)];u?i.$D(u):r.$D(n.get_$3q(t))}$3XT(this,r);return i},$4RC:function(n){this.$1By={};this.$1Jg.$1r();this.set_$3vW(!1);$4oM(this,n)},$7Rr:function(n){var f=_a.$6.$1c(_a.$0.$1mZ,"Scheduling.AvailabilityActionCompleted",!0);var t=n;t.remove_$2m(this.$$d_$7Rr);if(!this.$1Jg.$34(t)){_js.Trace.logInfo(_a.$0.$1mZ,"Discarding FB results {0}-{1} {2} ",t.$6r,t.$8B,t.$zg);return}var i=t.$3s4;if(t.$1f){_js.Trace.logError(_a.$0.$1mZ,"{0} failed with the following error {1}",t.$1n_2,t.$1f.message);i=new _js.$Z;var o=this;t.$zg.$Bh(function(n){i.$D(_c.$G5.$3k7(n))})}for(var u=0;u<i.get_$B();u++){var r=i.get_$3q(u);var e=this.$1By[r.$VI];e&&r.get_$Fc().get_$2uv()==="None"||(this.$1By[r.$VI]=r)}this.set_$3vW(this.$1Jg.get_$B()>0);$6y5(this,t.$zg);_a.$6.$1E(f)}};_d.$Yy=function(n,t){this.$Wl=n;this.$c=t};_d.$Yy.prototype={$Wl:null,$c:null,$E:function(n,t){var i=this.$Wl.get_$L()==="TouchNarrow"?0:1;var r=this.$7cq(n.$t.get_$y(),t);var u=this.$7c5(n.$t.get_$y(),t);return new _d.$4B(r,u,i,n,this.$c)},$7cq:function(n,t){return new _d.$F0(_a.$7.$Ky(n),OwaApplication.$1W,this.$c,7,14,t)},$7c5:function(n,t){return new _d.$F0(n,OwaApplication.$1W,this.$c,0,0,t)}};_d.$Ft=function(n,t,i,r){_d.$Ft.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;this.dispose=this.$1Q;_d.$Ft.initializeBase(this);_a.$4.$J(n,"model");this.$3P=n;this.$1xA=r;this.$TB=i;$6pv(this,t)};function $6pv(n,t){if(t){var i=n.$TB.get_$29();var r=n.$3P.get_$y().$BX(Math.min(15,n.$3P.get_$1ZX())).$5z(i);n.$fD=_js.$J.get_$I().$1w(_d.$Ft.$2nQ,"CalendarMiniatureItem",t,r)}}_d.$Ft.prototype={$fD:null,$3P:null,$1xA:!1,$TB:null,$4c:function(){this.$fD&&(this.$fD=_js.$J.get_$I().$4z(this.$fD));this.$3P=null;_a.$1.prototype.$4c.call(this)},get_$M8:function(){return this.$3P},get_$4j:function(){return this.$3P.get_$4j()},get_$88p:function(){return this.$1xA},get_$1On:function(){return _a.$7.$1On(this.$3P.get_$y())},get_$1UE:function(){var i=!(this.get_$1On()||this.$1xA);var n;if(!this.$3P.get_$y().$2R(this.$3P.get_$1u())){n=i?_nbs.NonBootStrings.l_CalendarMiniatureStartSameAsEndTomorrow_Text:_nbs.NonBootStrings.l_CalendarMiniatureStartSameAsEnd_Text;return String.format(n,this.$3P.get_$y().$2Z(18))}var f=this.$3P.get_$1ZX()>1440;var u=this.$3P.get_$5V();if(!f){if(u)return i?_nbs.NonBootStrings.l_CalendarMiniatureAllDayTomorrow_Text:_nbs.NonBootStrings.l_CalendarMiniatureAllDay_Text;n=i?_nbs.NonBootStrings.l_CalendarMiniatureTimeRangeTomorrow_Text:_nbs.NonBootStrings.l_CalendarMiniatureTimeRange_Text;return String.format(n,this.$3P.get_$y().$2Z(18),this.$3P.get_$1u().$2Z(18))}var r;var t=this.$3P.get_$1u();if(u){n=_nbs.NonBootStrings.l_CalendarMiniatureLongTimeRange_Text;r=this.get_$1On()?_nbs.NonBootStrings.l_CalendarMiniatureToday_Text:_nbs.NonBootStrings.l_CalendarMiniatureTomorrow_Text;t=t.$19W(-1)}else{n=i?_nbs.NonBootStrings.l_CalendarMiniatureLongTimeRangeTomorrow_Text:_nbs.NonBootStrings.l_CalendarMiniatureLongTimeRange_Text;r=this.$3P.get_$y().$2Z(18)}var e=t.$93(this.$TB.get_$29().$2o(6))<=0;var o=e?_a.$7.$1C6(t.get_$Dr()):t.$2Z(1);return String.format(n,r,o)},get_$2i:function(){return this.$3P.get_$2i()}};_d.$5U=function(n,t,i,r,u){this.$$d_$276=Function.createDelegate(this,this.$276);this.$$d_$3GB=Function.createDelegate(this,this.$3GB);this.$$d_$692=Function.createDelegate(this,this.$692);this.$$d_$4J0=Function.createDelegate(this,this.$4J0);this.$$d_$4Ix=Function.createDelegate(this,this.$4Ix);this.$mS=new(_0365f.$o.$$(Number));_d.$5U.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$5U.initializeBase(this);this.$4P=i;this.$TB=t;this.$4Gp=n==="TouchNarrow"?1:2;this.$56=u;this.$bw=new _d.$5U.$7Ts(this.$56,r,this.$$d_$4Ix,this.$$d_$4J0,this.$$d_$692);var f=this;r.$1Mx(function(){$6pw(f);f.$56.add_$1Z(f.$$d_$3GB);f.$6VV=!0})};_d.$5U.$1Y5=function(n,t){if(!n)return t?-1:0;if(!t)return 1;var i=n;var r=t;var u=i.get_$y().$93(r.get_$y());return u?u:_cc.$7L.$vU(i,r)};_d.$5U.$5QV=function(n){return n.$4F().$2o(2).$9K(-1)};function $6q2(n){$6q5(n);$6q0(n);$6q1(n);$6q6(n);$6q3(n)}function $6q3(n){var t=n.$au>1?0:n.$24f>1?1:-1;$6q4(n,t)}function $6q4(n,t){if(t<0)n.set_$1YF(null);else{for(var i=$6py(n,t),s=i+n.$mS.get_$3q(t),f=!0,r=i;r<s;r++)if(!n.$De.get_$3q(r).get_$5V()){f=!1;break}var e=n.$De.get_$3q(i).get_$y();var o=_a.$7.$1On(e);var u;if(f){var h=o?_nbs.NonBootStrings.l_CalendarMiniatureConflict_AllDay_Text:_nbs.NonBootStrings.l_CalendarMiniatureConflict_AllDay_Tomorrow_Text;u=String.format(h,n.$mS.get_$3q(t))}else{var c=o?_nbs.NonBootStrings.l_CalendarMiniatureConflict_Text:_nbs.NonBootStrings.l_CalendarMiniatureConflict_Tomorrow_Text;u=String.format(c,n.$mS.get_$3q(t),e.$2Z(18))}n.set_$1YF(u)}}function $6py(n,t){for(var r=0,i=0;i<t;i++)r+=n.$mS.get_$3q(i);return r}function $6q6(n){n.set_$3DJ(n.$au>n.$4Gp?String.format(_nbs.NonBootStrings.l_CalendarMiniatureMoreAppointments_Text,n.$au-n.$4Gp):null)}function $6q1(n){var t=n.$au>1;n.set_$3r8($4kP(n,t,n.$De.get_$B()>0,n.$fI,n.$De.get_$3q(0)));var i=t||n.$24f>1;n.set_$4T8($4kP(n,i,n.$De.get_$B()>1,n.$oR,n.$De.get_$3q(1)))}function $4kP(n,t,i,r,u){return i?!r||r.get_$M8()!==u||r.get_$88p()!==t?new _d.$Ft(u,n.$$d_$276,n.$TB,t):r:null}function $6q0(n){var t=n.$mS.get_$B()>0?n.$mS.get_$3q(0):0;var i=n.$mS.get_$B()>1?n.$mS.get_$3q(1):0;var r=n.$au!==t;var u=n.$24f!==i;n.$au=t;n.$24f=i;(r||u)&&$CY(n,"NumberOfAppointmentsChanged",n,null)}function $6q5(n){n.$mS.$1r();if(n.$De.get_$B())for(var i=null,e=n.$De.get_$B(),t=-1,r=0;r<e;r++){var u=n.$De.get_$3q(r);if(u&&i&&_a.$7.$4N(u.get_$y(),i.get_$y())){var f;(f=n.$mS).set_$3q(t,f.get_$3q(t)+1)}else{if(t===1)break;i=u;n.$mS.$D(1);t=n.$mS.get_$B()-1}}}function $4kO(n,t){var i=t.get_$y().$BX(Math.min(15,t.get_$1ZX()));return i.$2R(n.$TB.get_$29())}function $4kN(n){n.$1kc=!1;var t=n.$bw.$2Gj();n.$1kc=!0;t&&n.$276()}function $6pz(n){n.$8p=$2h3(n);for(var i=n.$56.get_$B(),t=0;t<i;t++){var r=n.$56.get_$3q(t);$4kQ(n,r)}}function $2h3(n){var t=n.$TB.get_$29();var i=_d.$5U.$5QV(t);return new _h.$4e(t,i)}function $6px(n){if(n.$1DP){for(var i=0,r=n.$56.get_$B(),t=0;t<r;t++){var u=n.$56.get_$3q(t);var f=n.$bw.$2LK(u,n.$8p);i+=f.length}(!n.$fI||i-(n.$au+n.$24f)<=1)&&n.$8p&&n.$8p.$3D.$2R(_d.$5U.$5QV(n.$TB.get_$29()))<0&&$6pz(n)}}function $6pw(n){n.$1kc=!0;var i=n.$56.get_$B();n.$8p=$2h3(n);for(var t=0;t<i;t++){var r=n.$56.get_$3q(t);n.$bw.$2aJ("CalendarMiniatureNextAppointmentManager",r,n.$8p,6)}}function $6q7(n,t,i){if(i&&i.length>0){n.$8p=$2h3(n);n.$276();return}var u;if(t&&(u=t.length)>0){n.$8p=$2h3(n);for(var r=0;r<u;r++)$4kQ(n,t[r]);return}}function $4kQ(n,t){n.$bw.$2aJ("CalendarMiniatureNextAppointmentManager",t,n.$8p,6)}_d.$5U.prototype={$4Gp:0,$56:null,$au:0,$24f:0,$fI:null,$oR:null,$De:null,$1YE:null,$1gL:null,$bw:null,$8p:null,$1DP:!1,$1kc:!1,$6VV:!1,$TB:null,$4P:null,get_$3r8:function(){return this.$fI},set_$3r8:function(n){if(this.$fI!==n){this.$fI&&this.$fI.dispose();this.$fI=n;$3(this,"FirstAppointment")}return n},get_$4T8:function(){return this.$oR},set_$4T8:function(n){if(this.$oR!==n){this.$oR&&this.$oR.dispose();this.$oR=n;$3(this,"SecondAppointment")}return n},get_$67q:function(){return this.$au},get_$983:function(){return this.$24f},add_$3Ec:function(n){this.$2N("NumberOfAppointmentsChanged",n)},remove_$3Ec:function(n){this.$2P("NumberOfAppointmentsChanged",n)},get_$1YF:function(){return this.$1YE},set_$1YF:function(n){if(this.$1YE!==n){this.$1YE=n;$3(this,"ConflictingAppointmentsMessage")}return n},get_$3DJ:function(){return this.$1gL},set_$3DJ:function(n){if(this.$1gL!==n){this.$1gL=n;$3(this,"MoreAppointmentsMessage")}return n},$3GW:function(){this.$1DP=!0;this.$1kc&&$4kN(this)},$3GY:function(){this.$1DP=!1},$276:function(){this.$De=new _0365f.$Fd(_d.$5U.$1Y5);for(var h=this.$56.get_$B(),u=0;u<h;u++){var c=this.$56.get_$3q(u);var i=this.$bw.$2LK(c,this.$8p);var r=this.$De;this.$De=new _0365f.$Fd(_d.$5U.$1Y5);for(var t=0,n=0,f=i.length,e=r.get_$B();t<e&&n<f;){var o=i[n];var l=$4kO(this,o);if(l<0){n++;continue}if(_d.$5U.$1Y5(r.get_$3q(t),i[n])<0){this.$De.$D(r.get_$3q(t));t++}else{this.$De.$D(o);n++}}while(t<e){this.$De.$D(r.get_$3q(t));t++}while(n<f){var s=i[n];var a=$4kO(this,s);a>=0&&this.$De.$D(s);n++}}$6q2(this);$6px(this)},$4c:function(){this.$6VV&&this.$56.remove_$1Z(this.$$d_$3GB);_a.$1.prototype.$4c.call(this)},$3GB:function(n,t){var i=this;this.$4P.$3r(_d.$5U.$2nQ,"OnSelectedCalendarsCollectionChanged",function(){$6q7(i,t.$2l,t.$38)})},$692:function(){this.$1DP&&this.$1kc&&$4kN(this)},$4J0:function(n,t){this.$1kc&&this.$276()},$4Ix:function(n,t){this.$1kc&&this.$276()}};_d.$5U.$7Ts=function(n,t,i,r,u){_d.$5U.$7Ts.initializeBase(this,[n,t,null,i,null,r,u])};_d.$5U.$7Ts.prototype={$5EC:function(n){return new _c.$uO(n)},$7er:function(n){return new _c.$1Cp(n)}};_d.$4Y=function(n,t,i,r,u){this.$$d_$9MR=Function.createDelegate(this,this.$9MR);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$1TV=1;this.$ka=24;_d.$4Y.initializeBase(this);this.$hl=n;this.$1h=t;this.$2Fx=i;this.$4Lg=r;this.$13=u;this.$EW=new _C(this.$$d_$iF,_a.$0.$1k);var e=this;this.$26c=new _C(function(){},_a.$0.$1k);$6qD(this);this.$2p6=new _js.$Z;this.$3Ix=new _y.$FB;$6qE(this);$6qF(this);this.$35=r.get_$91();if(this.get_$59o()){var f=t.$c.get_$1I().get_$Nl();this.$ke=Math.floor(f.get_$1VS()/60);this.$ka=Math.floor(f.get_$4eL()/60)}$6qH(this,r)};function $4kV(n,t){n.$2Ol&&(n.$2Om||t)?n.$4WM():n.$6Vy()}function $6qH(n,t){var i=t.get_$1L();switch(i){case"CalendarDayViewModel":n.set_$28E(1);break;case"CalendarWeekViewModel":n.set_$28E(2);break;case"CalendarWorkWeekViewModel":n.set_$28E(3);break;case"MonthAgendaViewModel":n.set_$28E(4);break;default:n.set_$28E(1);break}}function $2Cd(n){n.set_$9q(!0);n.set_$6KC($6qA(n,n.$1HS,n.$1TV));n.set_$9q(!1)}function $6qC(n,t,i){switch(t){case 1:return"DayViewModel";case 2:return i===3||i===2?"WeeklyAgenda":"WeekViewModel";case 3:return i===3||i===2?"WorkWeekAgenda":"WorkWeekViewModel";case 4:return"MonthAgendaViewModel";default:throw Error.argument("viewModelType","Unknown CalendarViewTypeEnum value");}}function $6qB(n,t,i){var r=null;if(i in n.$2Fx){r=n.$2Fx[i];if(r.get_$91()!==n.$35){delete n.$2Fx[i];r=null}}if(!r){switch(t){case 1:r=n.$hl.$5EB(n.$35,n.$1h);break;case 4:r=n.$hl.$5F5(n.$35,!0,null,n.$1h);break;case 2:r=n.$1TV===2||n.$1TV===3?n.$hl.$7fU(n.$35,n.$1h):n.$hl.$5Ff(n.$35,null,n.$1h);break;case 3:r=n.$hl.$5Fj(n.$35,null,n.$1h);break;default:break}n.$2Fx[i]=r}return r}function $6qA(n,t,i){var u=null;var f=$6qC(n,t,i);var r=$6qB(n,t,f);_js.Trace.logWarning(_a.$0.$1k,"Navigating to print view model for surface view model: {0}",f);switch(f){case"WeeklyAgenda":case"WorkWeekAgenda":u=new _d.$B9(r,t,i,n);break;case"DayViewModel":u=new _d.$Rm(r,n,n.$13);break;case"MonthAgendaViewModel":u=new _d.$MS(r,n);break;case"WeekViewModel":u=new _d.$rk(r,n,n.$13);break;case"WorkWeekViewModel":u=new _d.$rl(r,n,n.$13);break;default:break}n.set_$5IO(n.$hl.$7eF(n.$35,n.$1h,n,r.get_$1B8()===3?6:r.get_$1B8(),n.$13));return u}function $6qE(n){if($6(_d.$4Y.$1KZ)){_d.$4Y.$1KZ=new _js.$Z;_d.$4Y.$1KZ.$D(1);_d.$4Y.$1KZ.$D(2);_d.$4Y.$1KZ.$D(3);_d.$4Y.$1KZ.$D(4)}}function $6qF(n){if($6(_d.$4Y.$1dW)){_d.$4Y.$1dW=new _js.$Z;_d.$4Y.$1dW.$D(1);_d.$4Y.$1dW.$D(2);_d.$4Y.$1dW.$D(3)}}function $4kU(n){n.$2A5?n.$2A5.$1r():n.$2A5=new _js.$Z;for(var t=0;t<n.$ka;t++)n.$2A5.$D(t)}function $4kT(n){n.$1tG?n.$1tG.$1r():n.$1tG=new _js.$Z;for(var t=n.$ke+1;t<=24;t++)n.$1tG.$D(t)}function $6qD(n){n.set_$9Wz($6q9(n));n.$KU=n.$1h.$Cb}function $6q9(n){for(var r=new _js.$Z,u=n.$1h.$CS.get_$IS(),t=null,i=0,f=u.get_$B();i<f;++i){t=u.get_$3q(i);t&&r.$D(t)}return r}function $6qG(n,t,i,r){r.val=i===3||i===2;return!!((t===2||t===3)^r.val)}function $4kS(n){n.set_$6KC(null);n.set_$5IO(null);n.$4Lg=null}_d.$4Y.prototype={$hl:null,$1h:null,$2Fx:null,$2p6:null,$3Ix:null,$EW:null,$26c:null,$35:null,$13:null,$Sr:!1,$4Lg:null,$tT:null,$1BH:null,$Et:null,$KU:null,$3Iv:null,$1HS:0,$2Pe:!1,$2Ol:!1,$2Om:!1,$2A5:null,$1tG:null,$ke:0,get_$9q:function(){return this.$Sr},set_$9q:function(n){if(this.$Sr!==n){this.$Sr=n;$3(this,"Loading")}return n},get_$1TR:function(){return this.$KU},set_$1TR:function(n){if(n!==this.$KU){this.$KU=n;$3(this,"SelectedCalendar");$2Cd(this)}return n},get_$9Wz:function(){return this.$3Iv},set_$9Wz:function(n){if(this.$3Iv!==n){this.$3Iv=n;$3(this,"PrintableCalendars")}return n},get_$7U0:function(){return _d.$4Y.$1KZ},get_$28E:function(){return this.$1HS},set_$28E:function(n){if(this.$1HS!==n){var t;var i,r;var u=(r=$6qG(this,this.$1HS,n,i={val:t}),t=i.val,r);this.$1HS=n;u&&$3(this,"IsCalendarLayoutHidden");$2Cd(this)}return n},get_$88a:function(){return this.$1HS!==2&&this.$1HS!==3},get_$8FZ:function(){return _d.$4Y.$1dW},get_$9gc:function(){return this.$1TV},set_$9gc:function(n){if(this.$1TV!==n){this.$1TV=n;if(n){$3(this,"SelectedLayout");$2Cd(this)}}return n},get_$7iz:function(){return!0},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$1iT:function(){return 1},get_$2MT:function(){return this.$$d_$9MR},get_$1l0:function(){return 320},get_$9rt:function(){this.$2A5||$4kU(this);return this.$2A5},get_$7lp:function(){this.$1tG||$4kT(this);return this.$1tG},get_$9gj:function(){return this.$ke},set_$9gj:function(n){if(n!==this.$ke){this.$ke=n;$3(this,"SelectedStartTime");$4kT(this);this.$ke>=this.$ka&&this.set_$6RU(this.$ke+1);$2Cd(this)}return n},get_$6RU:function(){return this.$ka},set_$6RU:function(n){n||(n=24);if(n!==this.$ka){this.$ka=n;$3(this,"SelectedEndTime");$4kU(this);$2Cd(this)}return n},get_$8By:function(){return this.$2Pe},set_$8By:function(n){if(this.$2Pe!==n){this.$2Pe=n;$3(this,"IsNotesPanelExpanded")}return n},get_$59x:function(){return this.$1HS===1},get_$59o:function(){return this.$13.get_$qw()},get_$89D:function(){return this.$2Ol},set_$89D:function(n){if(this.$2Ol!==n){this.$2Ol=n;$3(this,"IsDetailedAgendaSelected");$4kV(this,!0)}return n},get_$5aZ:function(){return this.$2Om},set_$5aZ:function(n){if(this.$2Om!==n){this.$2Om=n;$3(this,"IsDetailedAgendaShown")}return n},get_$6KC:function(){return this.$tT},set_$6KC:function(n){if(this.$tT!==n){if(this.$tT){this.$tT.$bU!==this.$4Lg&&this.$tT.$bU.set_$GB(!1);this.$tT.$7Wa();this.$tT.$1Q()}this.$tT=n;if(this.$tT){this.$tT.$7RZ();this.$tT.$bU.set_$GB(!0);this.$2p6.$7G(n)||this.$2p6.$D(n);$4kV(this,!1)}$3(this,"CanShowNotes")}return n},get_$5IO:function(){return this.$1BH},set_$5IO:function(n){if(this.$1BH!==n){if(this.$1BH){this.$1BH.set_$GB(!1);this.$1BH.$1Q()}this.$1BH=n}return n},get_$Ld:function(){return 0},$6Vy:function(){this.$3Ix.$MN(this.$tT);this.$1BH.set_$GB(!1);this.set_$5aZ(!1)},$4WM:function(){this.$1BH.set_$GB(!0);this.$3Ix.$MN(this.$1BH);this.set_$5aZ(!0)},$iF:function(){$4kS(this);this.get_$89()&&this.get_$89()()},$9MR:function(n,t){$4kS(this);return!1}};_d.$Po=function(n){_d.$Po.initializeBase(this);this.$p=n};_d.$Po.prototype={$p:null};_d.$B9=function(n,t,i,r){this.$$d_$3xs=Function.createDelegate(this,this.$3xs);this.$$d_$68Y=Function.createDelegate(this,this.$68Y);_d.$B9.initializeBase(this,[n,r]);this.$om=n;this.$NA=i;this.$wH=new _0365f.$Fd(_cc.$7L.$vU);$2Co(this,this.$om.$CZ,this.$wH);this.$3xs(null,null)};function $1Vg(n,t){return t>=n.$1Lq.length?"":n.$1Lq[t].$2Z(3)}function $2hd(n,t,i,r,u){var f=t[r];t[r]=t[u];t[u]=f;f=i[r];i[r]=i[u];i[u]=f}_d.$B9.prototype={$NA:0,$Zh:null,$1Lq:null,$om:null,$wH:null,get_$981:function(){return this.$Zh.length},get_$7gJ:function(){return $1Vg(this,0)},get_$7gL:function(){return $1Vg(this,1)},get_$7gN:function(){return $1Vg(this,2)},get_$7gP:function(){return $1Vg(this,3)},get_$7gR:function(){return $1Vg(this,4)},get_$7gT:function(){return $1Vg(this,5)},get_$7gV:function(){return $1Vg(this,6)},get_$7gK:function(){return new _d.$Po(this.$Zh[0])},get_$7gM:function(){return new _d.$Po(this.$Zh[1])},get_$7gO:function(){return new _d.$Po(this.$Zh[2])},get_$7gQ:function(){return this.$Zh.length>=4?new _d.$Po(this.$Zh[3]):null},get_$7gS:function(){return new _d.$Po(this.$Zh[4])},get_$7gU:function(){return this.$Zh.length>=6?new _d.$Po(this.$Zh[5]):null},get_$7gW:function(){return new _d.$Po(this.$Zh[6])},$7Wa:function(){this.$om.$CZ.remove_$1Z(this.$$d_$68Y);this.$om.$p.remove_$1Z(this.$$d_$3xs)},$7RZ:function(){this.$om.$CZ.add_$1Z(this.$$d_$68Y);this.$om.$p.add_$1Z(this.$$d_$3xs)},$68Y:function(n,t){switch(t.$2v){case 0:$4na(this,t.$2l,this.$wH);break;case 2:$4nb(this,t.$38,this.$wH);break;case 3:throw Error.notImplemented();case 4:$2Co(this,this.$om.$CZ,this.$wH);break;default:break}this.$3xs(n,t)},$3xs:function(n,t){this.$Zh=new Array(this.$om.$Gi.length);this.$1Lq=new Array(this.$om.$Gi.length);var h=this.$Zh.length;if(this.$om.$p)for(var r=this.$om.$ED.$2Q,u,i,e,f=0;f<h;f++){u=new _js.$Z;for(var o=0,c=this.$wH.get_$B();o<c;o++){i=this.$wH.get_$3q(o);e=i.get_$y().$93(r);(!e||e<0&&i.get_$1u().$BX(-1).$93(r)>=0)&&u.$D(new _d.$l2(i))}for(var s=0,l=this.$om.$p.get_$B();s<l;s++){i=this.$om.$p.get_$3q(s);i.get_$y().get_$Dr()===r.get_$Dr()&&_d.$BW.$2cI(i,this.get_$ef().$ke,this.get_$ef().$ka,this.get_$ef().$KU)&&(_d.$LU.isInstanceOfType(i)?u.$D(new _d.$l2(i.$2e)):u.$D(new _d.$l2(i)))}this.$Zh[f]=u;this.$1Lq[f]=r;r=r.$2o(1)}if(this.$NA===3)switch(h){case 3:case 4:$2hd(this,this.$Zh,this.$1Lq,1,2);break;case 5:case 6:case 7:$2hd(this,this.$Zh,this.$1Lq,1,2);$2hd(this,this.$Zh,this.$1Lq,1,4);$2hd(this,this.$Zh,this.$1Lq,1,3);break}$6(n)||$JA(this,["Day1Items","Day2Items","Day3Items","Day4Items","Day5Items","Day6Items","Day7Items"])}};_d.$BW=function(n,t){this.$$d_$9BO=Function.createDelegate(this,this.$9BO);this.$$d_$696=Function.createDelegate(this,this.$696);_d.$BW.initializeBase(this);this.$bU=n;this.set_$ef(t);this.$bU.$Y("DateRangeArray",this.$$d_$696);this.$bU.$Y("DateRange",this.$$d_$9BO)};_d.$BW.$2cI=function(n,t,i,r){var s=n.get_$1u().get_$DV()?n.get_$1u().get_$DV():24;var u=n.get_$y().get_$GJ()+(n.get_$y().get_$DV()<<6);var f=n.get_$1u().get_$GJ()+(s<<6);var e=t<<6;var o=i<<6;return(!n.get_$5k()&&!r||n.get_$5k().$4e(r))&&(n.get_$AW()||_g.$33.isInstanceOfType(n)&&n.get_$1cZ()&&(u<o||f>e)||u<o&&f>e)};function $2Co(n,t,i){var r;i.$1r();for(var u=0,f=t.get_$B();u<f;u++){r=t.get_$3q(u);_d.$BW.$2cI(r,n.$lb.$ke,n.$lb.$ka,n.$lb.$KU)&&i.$D(r)}}function $4na(n,t,i){for(var r,u=0,f=t.length;u<f;u++){r=t[u];_d.$BW.$2cI(r,n.$lb.$ke,n.$lb.$ka,n.$lb.$KU)&&i.$D(r)}}function $4nb(n,t,i){for(var r=0,u=t.length;r<u;++r)i.$34(t[r])}_d.$BW.prototype={$bU:null,$lb:null,get_$4Xr:function(){return this.get_$ef().$ke},get_$7li:function(){return this.get_$ef().$ka},get_$ef:function(){return this.$lb},set_$ef:function(n){this.$lb=n;return n},$4c:function(){this.$bU.$u("DateRangeArray",this.$$d_$696);this.$bU.$u("DateRange",this.$$d_$9BO);this.set_$ef(null);_a.$1.prototype.$4c.call(this)},$696:function(n,t){},$9BO:function(n,t){}};_d.$Rm=function(n,t,i){this.$$d_$9KS=Function.createDelegate(this,this.$9KS);_d.$Rm.initializeBase(this,[n,t,i])};_d.$Rm.prototype={$1Gy:function(){$3(this,"LayoutResize")},$7Wa:function(){_d.$Rn.prototype.$7Wa.call(this);this.get_$ef().$u("IsNotesPanelExpanded",this.$$d_$9KS)},$7RZ:function(){_d.$Rn.prototype.$7RZ.call(this);this.get_$ef().$Y("IsNotesPanelExpanded",this.$$d_$9KS)},$9KS:function(n,t){$3(this,"IsNotesPanelExpanded")}};_d.$Rn=function(n,t,i){this.$$d_$68Y=Function.createDelegate(this,this.$68Y);this.$$d_$WQ=Function.createDelegate(this,this.$WQ);_d.$Rn.initializeBase(this,[n,t]);this.$13=i;this.$1A4=n;this.$O8=new _d.$HD(n.$Gi,n.$CZ,n.$1h,n.$1h.$2U,n.$1h.$c);this.$2u7=new _0365f.$Fd(_cc.$7L.$vU);$2Co(this,this.$1A4.$p,this.$2u7);this.$wH=new _0365f.$Fd(_cc.$7L.$vU);$2Co(this,this.$1A4.$CZ,this.$wH);$4nc(this)};function $4nd(n,t,i,r){switch(t.$2v){case 0:$4na(n,t.$2l,r);break;case 2:$4nb(n,t.$38,r);break;case 4:$2Co(n,i,r);break;default:throw Error.notImplemented(_js.$9.$4R("Action '{0}' is not supported in PrintDayWeekBaseViewModel",t.$2v));}}function $4nc(n){var t=n.get_$7li()-n.get_$4Xr();var i=875-n.$bj;n.set_$7gc(i/t)}_d.$Rn.prototype={$1A4:null,$O8:null,$2u7:null,$wH:null,$13:null,$2r2:50,$bj:0,get_$2EZ:function(){return this.$bj},set_$2EZ:function(n){if(this.$bj!==n){this.$bj=n;$4nc(this);$3(this,"AllDayPanelHeight")}return n},get_$7gc:function(){return this.$2r2},set_$7gc:function(n){this.$2r2=n;$3(this,"DayViewIntervalHeight");return n},get_$ml:function(){return!_a.UserAgent.getInstance().$cU},get_$7Tx:function(){return-(this.$2r2*this.get_$4Xr())},get_$83f:function(){return this.$13.get_$rA()},$7Wa:function(){this.$1A4.$p.remove_$1Z(this.$$d_$WQ);this.$1A4.$CZ.remove_$1Z(this.$$d_$68Y)},$7RZ:function(){this.$1A4.$p.add_$1Z(this.$$d_$WQ);this.$1A4.$CZ.add_$1Z(this.$$d_$68Y)},$WQ:function(n,t){$4nd(this,t,this.$1A4.$p,this.$2u7)},$68Y:function(n,t){$4nd(this,t,this.$1A4.$CZ,this.$wH)},$696:function(n,t){this.$O8.set_$bG(this.$bU.$Gi);_d.$BW.prototype.$696.call(this,n,t)}};_d.$rh=function(n,t,i,r,u,f,e,o){this.$3mM=6;_d.$rh.initializeBase(this,[n,!0,t,i,r,u]);this.$lb=f;this.$13=o;this.$3mM=e;$2gx(this)};_d.$rh.prototype={$13:null,$lb:null,get_$1L:function(){return"PrintDetailedAgendaViewModel"},get_$1B8:function(){return this.$3mM},get_$83W:function(){return this.$13.get_$rA()},$3cb:function(n){_d.$1Kw.prototype.$3cb.call(this,n);for(var r=[],t,i=0,u=n.length;i<u;i++){t=n[i];t.get_$x8()||Array.add(r,t)}r.length>0&&this.$1h.$9N.$8GU(n)},$1ka:function(n){return _d.$1r.prototype.$1ka.call(this,n)?_d.$BW.$2cI(n,this.$lb.$ke,this.$lb.$ka,this.$lb.$KU):!1}};_d.$l2=function(n){_d.$l2.initializeBase(this,[n])};_d.$l2.prototype={get_$9ru:function(){return this.$2e.get_$5V()?this.$2e.get_$y().$93(this.$2e.get_$1u().$BX(-1))<0?String.format(_nbs.NonBootStrings.l_PrintWeekRange_Text,this.$2e.get_$y().$2Z(4,0),this.$2e.get_$1u().$2Z(4,0)):String.format(_nbs.NonBootStrings.l_PrintWeekRange_Text,this.$2e.get_$y().$2Z(0,0),this.$2e.get_$1u().$2Z(4,0)):String.format(_nbs.NonBootStrings.l_PrintWeekRange_Text,this.$2e.get_$y().$2Z(0,0),this.$2e.get_$1u().$2Z(0,0))},get_$8J3:function(){return this.$2e.get_$JW()?this.$2e.get_$FE().Mailbox.Name:""}};_d.$MS=function(n,t){this.$$d_$9QA=Function.createDelegate(this,this.$9QA);_d.$MS.initializeBase(this,[n,t]);this.$35=this.$bU.get_$91();$6wW(this)};function $6wX(n){for(var i=n.get_$2eE().$ED.$2Q,t=0;t<6;++t)n.$AL[t].set_$y(i.$2o(t*7))}function $6wW(n){n.$AL=new Array(6);for(var i=n.get_$2eE().$ED.$2Q,t=0;t<6;++t)n.$AL[t]=new _d.$JK(i.$2o(t*7));$4ne(n)}function $4ne(n){for(var i,r,u,t=0;t<6;t++){i=n.$AL[t].$p;i.$1r();r=n.get_$2eE().$AL[t].$p;for(var f=0,e=r.get_$B();f<e;f++){u=r.get_$3q(f);_d.$BW.$2cI(u,n.get_$ef().$ke,n.get_$ef().$ka,n.get_$ef().$KU)&&i.$D(u)}}}_d.$MS.prototype={$AL:null,$35:null,get_$2eE:function(){return this.$bU},get_$4e3:function(){return this.$AL[0]},get_$4e4:function(){return this.$AL[1]},get_$2fz:function(){return this.$AL[2]},get_$4e5:function(){return this.$AL[3]},get_$4e6:function(){return this.$AL[4]},get_$4e7:function(){return this.$AL[5]},$7Wa:function(){this.$bU.$u("IsLoadingItems",this.$$d_$9QA)},$7RZ:function(){this.$bU.$Y("IsLoadingItems",this.$$d_$9QA)},$9BO:function(n,t){$6wX(this)},$9QA:function(n,t){this.get_$2eE().$1OB||$4ne(this)}};_d.$rk=function(n,t,i){_d.$rk.initializeBase(this,[n,t,i])};_d.$rk.prototype={get_$9t2:function(){return this.$bU}};_d.$rl=function(n,t,i){_d.$rl.initializeBase(this,[n,t,i])};_d.$rl.prototype={get_$9t3:function(){return this.$bU}};_d.$LN=function(n,t,i,r,u){_d.$LN.initializeBase(this);this.$EP=n;this.$EN=t;this.$Jl=i;this.$6Q=u;r&&this.$5XO()};function $3Vs(n,t){var r=new _js.$Z;if(t)for(var i=0;i<t.get_$B();i++)r.$D(t.get_$3q(i).get_$7B());return n.$6Q.$Tu(1,_y.$w.$1ph,r,1)}_d.$LN.prototype={$6Nv:null,$6FU:null,$6Od:null,$6Q:null,$EP:null,$EN:null,$Jl:null,$5XO:function(){this.$6Nv=$3Vs(this,this.$EP);this.$6FU=$3Vs(this,this.$EN);this.$6Od=$3Vs(this,this.$Jl);$PB(this,"RequiredAttendeesRecipientWellViewModel","OptionalAttendeesRecipientWellViewModel","ResourcesRecipientWellViewModel")},get_$9cW:function(){return String.format(_nbs.NonBootStrings.l_RequiredAttendeesLabelAndCount_Text,this.$EP.get_$B())},get_$9SH:function(){return String.format(_nbs.NonBootStrings.l_OptionalAttendeesLabelAndCount_Text,this.$EN.get_$B())},get_$9dK:function(){return String.format(_nbs.NonBootStrings.l_ResourcesLabelAndCount_Text,this.$Jl.get_$B())},get_$6Ww:function(){return!!this.$Jl&&this.$Jl.get_$B()>0},get_$6Wt:function(){return!!this.$EP&&this.$EP.get_$B()>0},get_$6WZ:function(){return!!this.$EN&&this.$EN.get_$B()>0}};_d.$Fm=function(n,t,i,r,u){_d.$Fm.initializeBase(this);this.$6Q=u;this.$TN=new _d.$Ms(n,t,i);r&&this.$5Xa()};_d.$Fm.$6U6=function(n,t){var i=n.$5A;i.$KW(1,t,0)};function $2gt(n,t,i){var o=new _js.$Z;if(t)for(var u=0;u<t.get_$B();u++)o.$D(t.get_$3q(u).get_$7B());for(var r=n.$6Q.$Tu(1,_y.$w.$KH,o,1),f=0;f<i;f++)_d.$Fm.$6U6(r.$1T.get_$3q(f),_nbs.NonBootStrings.l_AttendeeDetailsRequired_Text);for(var e=i;e<r.$1T.get_$B();e++)_d.$Fm.$6U6(r.$1T.get_$3q(e),_nbs.NonBootStrings.l_AttendeeDetailsOptional_Text);return r}_d.$Fm.prototype={$6Q:null,$TN:null,$52s:null,$6ag:null,$5HA:null,$67A:null,get_$3bt:function(){return this.$TN.get_$3bt()},get_$4a2:function(){return this.$TN.get_$4a2()},get_$3mU:function(){return this.$TN.get_$3mU()},get_$4Hh:function(){return this.$TN.get_$4Hh()},get_$6VZ:function(){return this.$TN.$pF.get_$B()>0},get_$6Vx:function(){return this.$TN.$q4.get_$B()>0},get_$6XK:function(){return this.$TN.$uJ.get_$B()>0},get_$6WV:function(){return this.$TN.$so.get_$B()>0},$5Xa:function(){this.$52s=$2gt(this,this.$TN.$pF,this.$TN.$52t);this.$6ag=$2gt(this,this.$TN.$uJ,this.$TN.$6ah);this.$5HA=$2gt(this,this.$TN.$q4,this.$TN.$5HB);this.$67A=$2gt(this,this.$TN.$so,this.$TN.$67B);$JA(this,["AcceptedAttendeesRecipientWellViewModel","TentativelyAcceptedAttendeesRecipientWellViewModel","DeclinedAttendeesRecipientWellViewModel","NoResponseReceivedAttendeesRecipientWellViewModel"])}};_d.$LO=function(n,t,i){this.$$d_$9nX=Function.createDelegate(this,this.$9nX);_d.$LO.initializeBase(this);this.$6Q=t;this.$KG=n;if(this.$KG.get_$JW()){this.$1kk=!i;this.$1kk&&(this.$4W6=new _C(this.$$d_$9nX,_a.$0.$3gd));this.get_$59z()?$6oO(this):$6oN(this)}};function $6oO(n){n.$2mK=new _d.$Fm(n.$KG.get_$7S().get_$A5d(),n.$KG.get_$8W().get_$A5d(),n.$KG.get_$9F().get_$A5d(),!n.$1kk,n.$6Q)}function $6oN(n){n.$2mJ=new _d.$LN(n.$KG.get_$7S().get_$A5d(),n.$KG.get_$8W().get_$A5d(),n.$KG.get_$9F().get_$A5d(),!n.$1kk,n.$6Q)}_d.$LO.prototype={$2mJ:null,$2mK:null,$KG:null,$6Q:null,$1kk:!1,$4W6:null,get_$59z:function(){return this.$KG.get_$I2()&&this.$KG.get_$Du()},get_$9nL:function(){return this.$1kk},set_$9nL:function(n){this.$1kk=n;$3(this,"ShowAllAttendeesButton");return n},$9nX:function(){this.set_$9nL(!1);this.$4W6.set_$5u(!1);if(this.$2mJ){this.$2mJ.$5XO();return}if(this.$2mK){this.$2mK.$5Xa();return}}};_d.$Zf=function(n){this.$Wl=n};function $6oP(n,t){var i=t.get_$7S()?t.get_$7S().get_$B():0;i+=t.get_$8W()?t.get_$8W().get_$B():0;i+=t.get_$9F()?t.get_$9F().get_$B():0;if(n.$Wl.get_$L()==="Mouse"){if(i>=100)return!1}else if(i>=50)return!1;return!0}_d.$Zf.prototype={$Wl:null,$6Q:null,$E:function(n){return new _d.$LO(n,this.$6Q,$6oP(this,n))}};_d.$Ms=function(n,t,i){_d.$Ms.initializeBase(this);$6oW(this,n,t,i)};function $6oW(n,t,i,r){n.$pF=new _js.$Z;n.$uJ=new _js.$Z;n.$q4=new _js.$Z;n.$so=new _js.$Z;var u,f,e,o;$3Vw(n,r,u={val:n.$pF},f={val:n.$uJ},e={val:n.$q4},o={val:n.$so});n.$pF=u.val;n.$uJ=f.val;n.$q4=e.val;n.$so=o.val;var s,h,c,l;$3Vw(n,t,s={val:n.$pF},h={val:n.$uJ},c={val:n.$q4},l={val:n.$so});n.$pF=s.val;n.$uJ=h.val;n.$q4=c.val;n.$so=l.val;n.$52t=n.$pF.get_$B();n.$6ah=n.$uJ.get_$B();n.$5HB=n.$q4.get_$B();n.$67B=n.$so.get_$B();var a,v,y,p;$3Vw(n,i,a={val:n.$pF},v={val:n.$uJ},y={val:n.$q4},p={val:n.$so});n.$pF=a.val;n.$uJ=v.val;n.$q4=y.val;n.$so=p.val}function $3Vw(n,t,i,r,u,f){if(!$6(t))for(var o=0;o<t.get_$B();o++){var e=t.get_$3q(o);switch(e.get_$TM()){case"Accept":case"Organizer":i.val.$D(e);break;case"Tentative":r.val.$D(e);break;case"Decline":u.val.$D(e);break;default:f.val.$D(e);break}}}_d.$Ms.prototype={$pF:null,$uJ:null,$q4:null,$so:null,$52t:0,$6ah:0,$5HB:0,$67B:0,get_$3bt:function(){return String.format(_nbs.NonBootStrings.l_AcceptedAttendeesLabelAndCount_Text,this.$pF.get_$B())},get_$4a2:function(){return String.format(_nbs.NonBootStrings.l_TentativelyAcceptedAttendeesLabelAndCount_Text,this.$uJ.get_$B())},get_$3mU:function(){return String.format(_nbs.NonBootStrings.l_DeclinedAttendeesLabelAndCount_Text,this.$q4.get_$B())},get_$4Hh:function(){return String.format(_nbs.NonBootStrings.l_NoResponseReceivedAttendeesLabelAndCount_Text,this.$so.get_$B())}};_d.$QO=function(){_d.$QO.initializeBase(this)};_d.$QO.prototype={get_$6n:function(){return this.$U(_d.$QO.$1qI)},set_$6n:function(n){this.$K(_d.$QO.$1qI,n);return n},get_$241:function(){return[this.get_$6n()]},get_$4O6:function(){return null}};_d.$3a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$7s8=Function.createDelegate(this,this.$7s8);this.$$d_$7s9=Function.createDelegate(this,this.$7s9);this.$$d_$9xt=Function.createDelegate(this,this.$9xt);this.$$d_$9xs=Function.createDelegate(this,this.$9xs);this.$$d_$6bP=Function.createDelegate(this,this.$6bP);this.$$d_$2oc=Function.createDelegate(this,this.$2oc);this.$$d_$7ZK=Function.createDelegate(this,this.$7ZK);this.$$d_$7s6=Function.createDelegate(this,this.$7s6);this.$$d_$7s7=Function.createDelegate(this,this.$7s7);this.$$d_$3si=Function.createDelegate(this,this.$3si);this.$$d_$3Fz=Function.createDelegate(this,this.$3Fz);this.$$d_$6Hf=Function.createDelegate(this,this.$6Hf);this.$$d_$3G0=Function.createDelegate(this,this.$3G0);this.$$d_$4K6=Function.createDelegate(this,this.$4K6);this.$$d_$62=Function.createDelegate(this,this.$62);_d.$3a.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;this.dispose=this.$1Q;_d.$3a.initializeBase(this);this.$1u5=l;this.$3zo=c;this.$JE=n;this.$353=t;this.$R0=i;this.$1MU=o;this.$C=r;this.$9N=u;this.$2mM=f;this.$5C=e;this.$k=s;this.$13=h;this.$eG=new _y.$hT;this.$b4=new _d.$Pk(this.$$d_$62,!this.$C.get_$Er()&&this.$C.get_$L()==="Mouse"&&this.$C.get_$9A());this.$C.get_$L()==="TouchNarrow"&&this.set_$7D(_y.$26.$E(this));this.$Y("IsTransitionedIn",_d.$3a.$1AO);this.$Y("IsInitialized",_d.$3a.$1AO)};_d.$3a.$1AO=function(n,t){var i=n;if(i.$DW&&i.$7A){$CY(i,"Ready",i,i);i.$Ig.$97r()}};function $6pQ(n,t){n.set_$1qK(n.$JE.$8A(t));n.set_$5cv(!0)}function $6pF(n){if(n.$C.get_$L()!=="Mouse")throw Error.invalidOperation("Calendar Item Details View can only be popped out in a new browser window in MUI");if(!n.$C.get_$9A())throw Error.invalidOperation("Calendar Item Details View can only be popped out from the main window");}function $6pO(n){var t=new _d.$yb(n.$5C);t.$dQ=2;t.$4NK=_y.$w.$KH;return t}function $6pH(n,t){t&&n.$o.$t.get_$JW()&&n.$o.$t.get_$XP()&&t.$KW(1,n.$o.$t.get_$XP().$2Z(4),0)}function $3W6(n){if(n.$6a){n.get_$4i()&&_js.$8.isInstanceOfType(n.get_$4i())&&n.get_$4i().$u("ActiveNavigationStack",n.$$d_$7ZK);n.$6a.$7H();n.$6a=null}}function $6pG(n){n.$4d=new _C(n.$$d_$2oc,_d.$3a.$A);n.$Zj=n.$o.$k5.$m0(0,!1,n.$$d_$2oc);n.$1G5=n.$o.$k5.$m0(1,!0,n.$$d_$2oc);n.$9vY=new _C(n.$$d_$6bP,_d.$3a.$A);n.$3ST=new _C(n.$$d_$9xs,_a.$0.$1k);n.$3SU=new _C(n.$$d_$9xt,_a.$0.$1k)}function $4k9(n,t){var i;i=t?n.$$d_$7s9:n.$$d_$7s8;n.$eY=n.$9N.$1uq(300,n.$o.$t.get_$i(),i,n.$$d_$7s7,n.$$d_$7s6,"HTML","unblockMode");n.$o.$t.set_$fP(!1);n.$o.$t.set_$pa(!1)}function $6pS(n){var t=n.$o.$t.get_$3C();if(t&&t.get_$3n()!=="HTML"){var i=_js.$9.$4R("BodyType should always be HTML on CalendarItemDetailsView. Current BodyType: {0}",t.get_$3n());_js.Trace.logWarning(n.get_$1b(),i)}if(!n.$C.get_$Er()){n.$6a=n.$R0.$5ED(n.$o.$t);n.$6a.$5j();n.get_$4i()&&_js.$8.isInstanceOfType(n.get_$4i())&&n.get_$4i().$Y("ActiveNavigationStack",n.$$d_$7ZK)}$4kA(n);n.set_$2tW(n.$1MU.$E(n.$o,n.$$d_$2oc,$6pO(n),n.$6a,n.$aM,n.$3ST,n.$3SU));n.$Ig.$3m=n.get_$4i();var r=this;n.$Ig.$aM.add_$9J1(function(){$4kA(n);$4kB(n);n.$Ig.$9zv(n.$aM)});n.set_$3gG(new _d.$Fq(n.$o.$5m));$4kB(n)}function $6pI(n){var t=[];Array.add(t,new _a.$5M(_nbs.NonBootStrings.l_EventDetailsTitle_Text,n.$Ig));if(!n.$C.get_$Er()&&n.$o.$t.get_$JW()){n.set_$7Rc(n.$2mM.$E(n.$o.$t));Array.add(t,new _a.$5M(_nbs.NonBootStrings.l_AttendeeDetailsTitle_Text,n.$2mL))}n.$aM.get_$W3()&&Array.add(t,new _a.$5M(_nbs.NonBootStrings.l_LocationDetailsTitle_Text,n.$aM));n.set_$4Ni(t)}function $4kA(n){n.set_$355(n.$353.$E(n.get_$4i(),n.$o.$t.get_$4j(),n.$C.get_$L()));n.$1uj=new _C(n.$aM.$$d_$1vA,_d.$3a.$A)}function $4kB(n){$6pI(n);n.$C.get_$L()==="TouchNarrow"&&$6pR(n)}function $6pP(n,t){return Object.getType(n.$WU[t].$10)}function $6pR(n){var t;var i;if(n.$C.get_$Er()||!n.$o.$t.get_$11b()){t=$6pJ(n);i=$6pK(n)}else{t=n.$o.$5m.get_$eh()?$6pM(n):$6pL(n);i=n.$o.$5m.get_$eh()?$6pN(n):$4k7(n)}n.$3w.set_$J0(t);n.$3w.set_$aR(i)}function $6pL(n){var t=[];var r=this;var i=$4k8(n,function(n){return new _y.$2W(_y.$c.get_$27K(),_y.$c.get_$6Nh(),_u.Strings.l_Reply_LowerCase_Text,null,n)});i&&Array.add(t,i);n.$o.$t.get_$UH()||n.$o.$5m.get_$VX()?Array.add(t,new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Bc.$2a8)):Array.add(t,new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$o.$RF.$qF));return t}function $6pM(n){var t=[];Array.add(t,new _y.$2W(_y.$c.get_$Zi(),_y.$c.get_$2Jt(),_nbs.NonBootStrings.l_EditItemMobile_Text,n.$Zj));n.$o.$5m.get_$VX()?Array.add(t,new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Bc.$2a8)):n.$o.$5m.get_$hp()&&Array.add(t,new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_nbs.NonBootStrings.l_CancelItemMobile_Text,n.$Bc.$2nm));return t}function $4k8(n,t){var i=[];n.$o.$t.get_$ej()&&Array.add(i,new _y.$2v(_u.Strings.l_Reply_LowerCase_Text,n.$o.$QJ.$IO));n.$o.$t.get_$hr()&&Array.add(i,new _y.$2v(_u.Strings.l_ReplyAll_LowerCase_Text,n.$o.$QJ.$KS));n.$o.$t.get_$ei()&&Array.add(i,new _y.$2v(_u.Strings.l_Forward_LowerCase_Text,n.$o.$QJ.$Hx));if(i.length<=0)return null;if(i.length===1)return i[0];return t(i)}function $6pN(n){var r=this;var i=$4k8(n,function(n){return new _y.$2v(_u.Strings.l_Reply_LowerCase_Text,null,n)});var t=[];i&&Array.add(t,i);Array.addRange(t,$4k7(n));return t}function $4k7(n){var t=[];n.$1G5.$2M&&Array.add(t,new _y.$2v(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1G5));n.$aM.get_$W3()&&Array.add(t,new _y.$2v(_nbs.NonBootStrings.l_GetDirections_LowerCase_Text,n.$1uj));n.$C.get_$L()!=="Mouse"&&n.$o.$t.get_$vL()&&Array.add(t,new _y.$2v(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,n.$o.$j7));return t}function $6pK(n){return n.$1G5.$2M?[new _y.$2v(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1G5)]:new Array(0)}function $6pJ(n){return new Array(0)}_d.$3a.prototype={$JE:null,$353:null,$R0:null,$C:null,$2mM:null,$5C:null,$b4:null,$9N:null,$1MU:null,$k:null,$13:null,$3zo:!0,$1u5:!0,$eY:null,$Zj:null,$4d:null,$1G5:null,$9vY:null,$1uj:null,$3ST:null,$3SU:null,$7A:!1,$1yF:!1,$3Dv:!1,$bH:0,$5dc:!1,$o:null,$eG:null,$WU:null,$Ig:null,$aM:null,$2mL:null,$Bc:null,$6a:null,$Et:null,add_$6DS:function(n){this.$2N("Ready",n)},remove_$6DS:function(n){this.$2P("Ready",n)},get_$4i:function(){return _y.$1KT.prototype.get_$4i.call(this)},set_$4i:function(n){_y.$1KT.prototype.set_$4i.call(this,n);this.$Ig&&(this.$Ig.$3m=n);this.$aM&&(this.$aM.$3m=n);return n},get_$1xz:function(){return this.$C.get_$L()==="Mouse"},get_$9pO:function(){return this.$o.$RF.get_$1qX()||this.$o.$5m.get_$eh()||this.$o.$5m.get_$VX()||this.$o.$5m.get_$hp()},get_$1qK:function(){return this.$o},set_$1qK:function(n){if(this.$o===n)return n;if(this.$o){this.$o.$RF.remove_$1W3(this.$$d_$4K6);this.$o.$5m.remove_$2m(this.$$d_$3G0);this.$o.$t.$u("IsPrivate",this.$$d_$6Hf);this.$o.$t.$u("FreeBusyType",this.$$d_$6Hf);this.$o.$t.$u("Categories",this.$$d_$6Hf);this.$o.$u("ReminderSelectedValue",this.$$d_$6Hf);this.$o.$t.$u("InboxReminders",this.$$d_$6Hf)}this.$o=n;if(this.$o){$6pG(this);$6pS(this);this.$o.$RF.add_$1W3(this.$$d_$4K6);this.$o.$5m.add_$2m(this.$$d_$3G0);this.$o.$t.$Y("IsPrivate",this.$$d_$6Hf);this.$o.$t.$Y("FreeBusyType",this.$$d_$6Hf);this.$o.$t.$Y("Categories",this.$$d_$6Hf);this.$o.$Y("ReminderSelectedValue",this.$$d_$6Hf);this.$o.$t.$Y("InboxReminders",this.$$d_$6Hf)}$3(this,"CalendarItemViewModel");return n},get_$1GW:function(){return this.$b4.$26R},get_$do:function(){return this.$b4.$4Wh},get_$4Ni:function(){return this.$WU},set_$4Ni:function(n){if(this.$WU!==n){this.$WU=n;$3(this,"PivotSelectionOptions")}return n},get_$2tW:function(){return this.$Ig},set_$2tW:function(n){if(this.$Ig!==n){this.$Ig&&this.$Ig.$1Q();this.$Ig=n;this.$Ig&&$6pH(this,this.$Ig.$1hi);$3(this,"EventDetailsViewModel")}return n},get_$7Rc:function(){return this.$2mL},set_$7Rc:function(n){if(this.$2mL!==n){this.$2mL=n;$3(this,"AttendeeDetailsViewModel")}return n},get_$355:function(){return this.$aM},set_$355:function(n){if(this.$aM!==n){this.$aM=n;$3(this,"LocationViewModel")}return n},get_$3gG:function(){return this.$Bc},set_$3gG:function(n){if(this.$Bc!==n){this.$Bc=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$Cf:function(){return this.$7A},set_$Cf:function(n){if(this.$7A!==n){this.set_$5cv(n);this.$7A=n;$3(this,"IsInitialized")}return n},get_$5cv:function(){return this.$1yF},set_$5cv:function(n){if(this.$1yF!==n){this.$1yF=n;$3(this,"IsPartiallyInitialized")}return n},get_$96k:function(){return this.$3Dv},set_$96k:function(n){if(this.$3Dv!==n){this.$3Dv=n;$3(this,"PopupPanelSize")}return n},get_$1iT:function(){return this.$C.get_$L()==="TouchWide"?4:this.$3Dv?1:0},get_$2MT:function(){return this.$$d_$3Fz},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$7iz:function(){return!0},get_$6Wg:function(){return this.$7A||this.$1yF},get_$1k7:function(){return this.$bH},set_$1k7:function(n){if(this.$bH!==n){this.$bH=n;$3(this,"SelectedPivotIndex")}return n},get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?_y.$1KT.prototype.get_$Ld.call(this):0},get_$j2:function(){return this.$13.get_$ZS().get_$j2()},get_$1b:function(){return _a.$0.$6y},$3xv:function(n){this.set_$Cf(!1);var t=null;this.$5dc=n.get_$5dd();t=this.$7sA(n.get_$3p1());if(t){$6pQ(this,t);this.$Ig.set_$4WU(!0)}this.$eY=this.$9N.$1uq(300,n.get_$3p1(),this.$$d_$3si,this.$$d_$7s7,this.$$d_$7s6,"HTML",n.get_$2vQ())},$5XX:function(n){this.set_$1qK(this.$JE.$8A(n));this.set_$Cf(!0)},$9gz:function(n){for(var i=new _d.$13w,r=i.$36(n),t=0;t<this.$WU.length;t++)if($6pP(this,t)===r){this.set_$1k7(t);return}this.set_$1k7(0)},$2oc:function(){if(!this.$3zo){_js.Trace.logInfo(this.get_$1b(),"Omitting close action as it is not allowed for this CalendarItemDetailsView.");return}this.get_$89()();this.$1Q()},$7sA:function(n){return this.$9N.$1ag(n)},$1Fv:function(){$3W6(this);_y.$1KT.prototype.$1Fv.call(this)},$62:function(){_a.$6.$1c(this.get_$1b(),"PopoutCalendarReadingPane");$6pF(this);var n=new _d.$QO;n.set_$6n(this.$o.$6d);this.$2oc();this.$C.$MH(_d.$JU,null,null,_y.$48.get_$fF(),n,!1);_a.$6.$1E(null,"PopoutCalendarReadingPane")},$3G0:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$2oc()},$4c:function(){this.$eY&&this.$eY.$1Q();$3W6(this);if(this.$o){this.$o.$1Q();this.set_$1qK(null)}this.set_$2tW(null);_a.$1.prototype.$4c.call(this)},$6bP:function(){this.$o.$t.set_$cg(!this.$o.$t.get_$cg())},$9xs:function(){$4k9(this,!1)},$7s8:function(n){this.$3si(n);var t=new _h.$t6(this.$o.$t);this.$k.$z(t)},$9xt:function(){$4k9(this,!0)},$7s9:function(n){this.$3si(n);var t=new _h.$mk(this.$o.$t);this.$k.$z(t)},$3si:function(n){this.$5XX(n)},$7s7:function(n){_cc.$5g.$3sU(n,this.$$d_$2oc);this.set_$Cf(!1)},$7s6:function(){this.$Ig&&this.$Ig.set_$4WU(!1)},$4K6:function(n){this.$2oc()},$6Hf:function(n,t){this.$o.$5m.$FK()},$7ZK:function(n,t){t!=="ActiveNavigationStack"||this.get_$4i().get_$8t()&&this.get_$4i().get_$8t().get_$B()||$3W6(this)},$3Fz:function(n,t){this.$Ig&&this.$Ig.$3Fz();this.$1Q();return!1}};_d.$JU=function(n,t,i,r,u,f,e,o,s,h){this.$JE=n;this.$353=t;this.$R0=i;this.$2mM=r;this.$5C=u;this.$C=e;this.$9N=f;this.$1MU=o;this.$k=s;this.$13=h};_d.$JU.prototype={$1MU:null,$JE:null,$353:null,$R0:null,$2mM:null,$5C:null,$C:null,$9N:null,$k:null,$13:null,get_$3g7:function(){return this.$9N},get_$10u:function(){return this.$k},$bC:function(n,t,i,r,u){var f=this.$2Ny(i,r===undefined?!0:r,u===undefined?!0:u);f.$3xv(new _y.$Ax(n));return f},$9df:function(n,t,i,r){return this.$bC(n,t,null,i,r)},$vo:function(n,t){return this.$3kG(n.get_$6n())},$3kG:function(n,t){var i=this.$2Ny(t,!0,!0);i.$5XX(n);return i},$2Ny:function(n,t,i){var r=new _d.$3a(this.$JE,this.$353,this.$R0,this.$C,this.get_$3g7(),this.$2mM,this.$5C,this.$1MU,this.get_$10u(),this.$13,t,i);n&&r.add_$6DS(n);return r}};_d.$6A=function(n,t,i,r,u,f){this.$$d_$9LP=Function.createDelegate(this,this.$9LP);this.$$d_$9Mm=Function.createDelegate(this,this.$9Mm);this.$$d_$9Ml=Function.createDelegate(this,this.$9Ml);this.$$d_$99a=Function.createDelegate(this,this.$99a);this.$$d_$7Tp=Function.createDelegate(this,this.$7Tp);this.$$d_$7Tq=Function.createDelegate(this,this.$7Tq);this.$$d_$3G0=Function.createDelegate(this,this.$3G0);this.$$d_$4K6=Function.createDelegate(this,this.$4K6);this.$$d_$4X=Function.createDelegate(this,this.$4X);_d.$6A.initializeBase(this);this.$9N=u;this.$C=i;this.$5C=t;this.$1MU=f;this.$Ax=r;this.$4d=new _C(this.$$d_$4X,_a.$0.$1k);this.$w=new _y.$6J;this.set_$1qK(n)};function $4kG(n){n.$o.$RF.add_$1W3(n.$$d_$4K6);n.$o.$5m.add_$2m(n.$$d_$3G0)}function $4kH(n){n.$o.$RF.remove_$1W3(n.$$d_$4K6);n.$o.$5m.remove_$2m(n.$$d_$3G0)}function $6pb(n){n.$o.$t.get_$x8()||n.$o.$t.get_$1Ka()&&n.$o.$t.get_$1k().get_$K4().Read&&(n.$eY=n.$9N.$1uq(300,n.$o.$t.get_$i(),n.$$d_$7Tq,n.$$d_$7Tp))}function $4kI(n){n.set_$2tW(n.$1MU.$7cc(n.$o,n.$$d_$99a,$6pZ(n)));if(n.$o.$t.get_$x8()){var t=n.$o.$k5;n.set_$9S3(t.$m0(1,!1,n.$$d_$99a,n.$$d_$9Ml));n.$o.$t.get_$4j()&&n.$o.$t.get_$4j().$W3()&&n.set_$9S4(t.$m0(1,!1,n.$$d_$99a,n.$$d_$9Mm));var i=new _d.$Od(n.$o.$t,n.$2Xl,n.$w,n.$Ax);i.$18h();n.$o.$t.get_$Du()&&n.set_$9dV(new _d.$Ms(n.$o.$t.get_$7S().get_$A5d(),n.$o.$t.get_$8W().get_$A5d(),n.$o.$t.get_$9F().get_$A5d()))}}function $4kF(n,t,i){t.$9gz(i)}function $6pa(n){n.$2Bv=n.$o.$5m.get_$11b()?n.$o.$t.get_$I2()?1:2:3}function $6pY(n,t){t&&n.$2Bv!==1&&t.$KW(1,n.get_$7Rf(),0)}function $6pc(n,t){t&&n.$C.get_$L()==="TouchWide"&&t.$Y("IsPersonaCardShown",n.$$d_$9LP)}function $6pd(n,t){t&&n.$C.get_$L()==="TouchWide"&&t.$u("IsPersonaCardShown",n.$$d_$9LP)}function $6pZ(n){var t=new _d.$yb(n.$5C);var i=_y.$w.$1ph;n.$2Bv!==1&&(i=_y.$w.$KH);t.$4NK=i;t.$dQ=1;return t}_d.$6A.prototype={$C:null,$5C:null,$4d:null,$w:null,$Ax:null,$1MU:null,$o:null,$eY:null,$2y:!1,$2Xl:null,$3Gj:null,$TN:null,$Ig:null,$9N:null,$2Bv:0,get_$1O:function(){return this.$2y},set_$1O:function(n){if(this.$2y===n)return n;this.$2y=n;this.$2y&&$6pb(this);$3(this,"IsShown");return n},get_$9nd:function(){return this.$o.$t.get_$hp()&&!this.$o.$t.get_$aH()},get_$9nY:function(){return!this.$o.$t.get_$aH()||!this.$o.$t.get_$vL()},get_$1qK:function(){return this.$o},set_$1qK:function(n){this.$o&&$4kH(this);this.$o=n;if(this.$o){$6pa(this);$4kG(this);this.$o.$RF.set_$9nR(!this.$o.$t.get_$vL());$4kI(this)}return n},get_$2tW:function(){return this.$Ig},set_$2tW:function(n){if(this.$Ig!==n){if(this.$Ig){$6pd(this,this.$Ig.$1hi);this.$Ig.$1Q()}this.$Ig=n;if(this.$Ig){$6pY(this,this.$Ig.$1hi);$6pc(this,this.$Ig.$1hi)}$3(this,"EventDetailsViewModel")}return n},get_$9dV:function(){return this.$TN},set_$9dV:function(n){if(this.$TN!==n){this.$TN=n;$3(this,"ResponseTypeManagerViewModel")}return n},get_$5jl:function(){return 420},get_$yg:function(){return 320},get_$9S3:function(){return this.$2Xl},set_$9S3:function(n){if(this.$2Xl!==n){this.$2Xl=n;$3(this,"OpenReadFormOnAttendeesPivotCommand")}return n},get_$9S4:function(){return this.$3Gj},set_$9S4:function(n){if(this.$3Gj!==n){this.$3Gj=n;$3(this,"OpenReadFormOnLocationPivotCommand")}return n},get_$5aP:function(){return!!this.$o&&!this.$o.get_$1OF()&&this.$o.$t.get_$7Uq()&&this.$C.get_$L()!=="TouchNarrow"},get_$7Rf:function(){var n=_d.$6k.$3uR(this.$o.$t);return n?_js.$9.$4R(_nbs.NonBootStrings.l_AttendeesInvitedLabel_Text,n):""},$99a:function(){this.$4X()},$9Ml:function(n){$4kF(this,n,1)},$9Mm:function(n){$4kF(this,n,2)},$4X:function(){this.set_$1O(!1)},$9LP:function(n,t){this.$4X()},$7Tq:function(n){$4kH(this);this.$o.$9yl(n);$4kG(this);$4kI(this);$3(this,"FullItemLoaded")},$7Tp:function(n){var i=n.responseCode;if(i&&i.toString()==="ErrorAccessDenied"){_js.Trace.logInfo(_a.$0.$6y,"Calendar Peek - Failed to load full calendar item because of access denied");return}var t="Calendar Peek - Failed to load full calendar item";n&&(t=String.format("{0}: {1}",t,n.message));_js.Trace.logWarning(_a.$0.$6y,t)},$4K6:function(n){this.$4X()},$3G0:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$4X()},$4c:function(){this.set_$2tW(null);this.set_$1qK(null);this.$eY&&this.$eY.$1Q();_a.$1.prototype.$4c.call(this)}};_d.$hz=function(n,t,i,r,u){this.$C=t;this.$Ax=i;this.$9N=r;this.$5C=n;this.$1MU=u};_d.$hz.prototype={$C:null,$9N:null,$Ax:null,$5C:null,$1MU:null,$E:function(n){return new _d.$6A(n,this.$5C,this.$C,this.$Ax,this.$9N,this.$1MU)}};_d.$Od=function(n,t,i,r){_d.$Od.initializeBase(this,[i]);this.$KG=n;this.$Ax=r;this.$4dT=t};function $6pX(n,t,i){if(t.get_$I2()&&t.get_$JW()&&!t.get_$Du()&&i.$2M){var r=n.$4dT.get_$OD();n.$w.$JC(1500,null,_nbs.NonBootStrings.l_ViewInvitedAttendeesInfobar_Text,r)}}_d.$Od.prototype={$KG:null,$4dT:null,$Ax:null,$8Gf:function(){this.$TE=[1500,1600,1800,2e3,1200,1700,1900,2100]},$7qZ:function(){if(!this.$KG.get_$aH()){$6pX(this,this.$KG,this.$4dT);$4k4(this,this.$KG,this.$Ax)}$4k5(this,this.$KG)}};_d.$12J=function(n,t){_d.$12J.initializeBase(this);this.$I5=n;this.$C=t};_d.$12J.prototype={$I5:null,$C:null,$T7:function(n){_js.$J.get_$I().$17w(_a.$0.$j,_y.$CS.$3Gm(n.get_$40()));_a.$6.acsa(_a.$0.$4i,"VM.MailCompose.Navigate");this.$Xt=!1;if(this.$C.get_$9A()){n.get_$61()===1&&n.set_$61(0);this.$C.$MH(IMailComposeViewModelFactory,null,null,_y.$48.get_$UP(),n,!0)}else{var t=this.$I5.$vo(n,null);this.$C.$fC(t,1,!0)}}};_d.$Zu=function(n,t){this.$$d_$E=Function.createDelegate(this,this.$E);this.$I5=n;this.$C=t};_d.$Zu.prototype={$I5:null,$C:null,$E:function(n,t){return n&&t===1?n:new _d.$12J(this.$I5,this.$C)}};_d.$uc=function(n){_d.$uc.initializeBase(this);if(n){this.$5V0=n.get_$5V1();this.$5VE=n.get_$5VF();this.$5Up=n.get_$5Uq();this.$54=n.get_$7ls();this.$2Q=n.get_$y();this.$3D=n.get_$1u();this.$BP=n.$BP}};_d.$uc.prototype={$5V0:!1,$5VE:!1,$5Up:!1,$54:null,$2Q:null,$3D:null,$BP:null,get_$y:function(){return this.$2Q},get_$1u:function(){return this.$3D},get_$LT:function(){return this.$BP},get_$Pk:function(){return!$6(this.$BP)}};_d.$bK=function(n,t,i,r,u,f,e){_d.$bK.initializeBase(this,[u]);this.$KG=n;this.$Ax=f;this.$4da=t;this.$3ST=i;this.$3SU=r;this.$1VP=e};function $6rq(n){if(n.$KG.get_$Pk())n.$w.$2a(4810);else if(n.$KG.get_$GC()&&n.$4da.$2M){var t=n.$4da.get_$OD();n.$w.$JC(4710,null,_nbs.NonBootStrings.l_ViewSeries_Text,t)}}function $6rp(n){if(n.$KG.get_$fP()&&!n.$1VP){var t=n.$3ST.get_$OD();n.$w.$JC(7700,null,_u.Strings.l_ClickHere_Text,t);var i=n.$3SU.get_$OD();n.$w.$JC(7750,null,_u.Strings.l_ClickHere_Text,i)}}_d.$bK.prototype={$KG:null,$Ax:null,$4da:null,$3ST:null,$3SU:null,$1VP:0,$8Gf:function(){this.$TE=[1200,2200,1100,1600,1800,2e3,1300,1400,1700,1900,2100,4810,4710,7700,7750]},$7qZ:function(){if(!this.$KG.get_$aH()){$4k4(this,this.$KG,this.$Ax);$4k3(this,this.$KG)}$4k5(this,this.$KG);$3W4(this,this.$KG);$4k6(this,this.$KG,this.$KG.get_$W0());$6rq(this);$6rp(this)}};_d.$5x=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$3Ex=Function.createDelegate(this,this.$3Ex);this.$$d_$4Is=Function.createDelegate(this,this.$4Is);this.$$d_$3G0=Function.createDelegate(this,this.$3G0);this.$$d_$8EV=Function.createDelegate(this,this.$8EV);this.$$d_$9b=Function.createDelegate(this,this.$9b);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$Zi=Function.createDelegate(this,this.$Zi);this.$$d_$54Z=Function.createDelegate(this,this.$54Z);this.$$d_$6bP=Function.createDelegate(this,this.$6bP);_d.$5x.initializeBase(this);this.$1h7=t;this.$o=n;this.$C=u;this.$6a=f;this.$1zu=e;this.$1qF=h;this.$1J=v;this.$3m=null;this.$o.$t.get_$GC()&&!this.$C.get_$Er()&&(this.$25y=this.$o.$1YU());this.$aM=new _d.$ED(this.$o.$t.get_$4j(),null,r,this.$C,!!this.$1zu);this.$1uN=_d.$QY.$5EZ();this.$27C=_d.$QY.$3ky(this.$o);this.$9vf=new _C(this.$$d_$6bP,_a.$0.$1k);this.$3d1=new _C(this.$$d_$54Z,_a.$0.$1k);this.$Zj=new _C(this.$$d_$Zi,_a.$0.$1k);this.$JN=new _C(this.$$d_$34,_a.$0.$1k);this.$7V=new _C(this.$$d_$9b,_a.$0.$1k);this.$3ou=this.$o.$k5.$m0(0,!1,this.$1h7);this.$6FE=this.$o.$k5.$m0(1,!1,this.$1h7);this.$3Gl=this.$o.$k5.$m0(1,!0,this.$1h7);this.set_$3gG(new _d.$Fq(this.$o.$5m));if(this.$C.get_$L()!=="TouchNarrow"){$2h8(this);this.$o.$t.$Y("IsPrivate",this.$$d_$8EV);this.$6MS=!0}if(this.$25y){this.$25y.$5m.add_$2m(this.$$d_$3G0);this.$2Ju=this.$o.$k5.$m0(0,!0,this.$1h7);this.set_$7Ol(new _0365m.$2b($6rr(this)));this.set_$7kp(new _0365m.$2b($6rv(this)));this.set_$7hN(new _0365m.$2b($6ru(this)));this.set_$7UO(new _0365m.$2b($6rt(this)))}if(this.$C.get_$Er()||this.$o.$t.get_$1Kb())this.$w=null;else{this.$w=new _y.$6J;this.$L0=new _d.$bK(this.$o.$t,this.$3Gl,c,l,this.$w,o,_g.$V.get_$I().get_$PE().get_$1a6());this.$L0.$18h();this.$o.$t.$Y("HasBlockedImages",this.$$d_$4Is)}var w=this.$o.$t.get_$1N();var k=w?w.get_$A5d():new _js.$Z;var p=this;a.$E(function(n){p.$5t=n.$1LU(p.$o.$t.get_$i(),k,!0,!0,null,!0,p.$w,null)});var d=this.$o.$t.get_$FE()?this.$o.$t.get_$FE().Mailbox:null;this.$1hi=i.$E(d);$6ry(this,s);if(y&&this.get_$4WP()){var b=this;y.$E(function(n){b.set_$7lK(n.$E(b.$o.$t))})}};function $2h8(n){var t=null;t=n.$C.get_$Er()||!n.$o.$t.get_$11b()?$6rs(n):$6rw(n);n.set_$7lD(t.length?new _0365m.$2b(t):null);n.$Qb&&n.$1Zc&&n.$1Zc.$Y("IsShown",n.$$d_$3Ex);n.set_$9by(n.$C.get_$Er()?null:new _0365m.$2b($6rx(n)))}function $6rw(n){var t=[];n.$3Gl.$2M&&Array.add(t,new _0365m.$m(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,n.$3Gl));if(!$6(n.$1zu)&&n.$1zu.get_$W3()){n.$1uj=new _C(n.$1zu.$$d_$1vA,_d.$5x.$A);Array.add(t,new _0365m.$m(_nbs.NonBootStrings.l_GetDirections_LowerCase_Text,null,n.$1uj))}var i=n.$Qb?n.$Qb.$3sl():null;i&&Array.add(t,i);return t}function $6ry(n,t){if(t&&!n.$o.$t.get_$1Kb()){var i=this;t.$1Mx(function(){var t=n.$o.$t.get_$1k();if(t){n.set_$3gD(n.$1qF.$8A(n.$o.$t));$2h8(n)}else _js.Trace.logError(_d.$5x.$A,"Could not find Calendar with Id: {0}. See #E15:3185198 to confimr if you are hitting a known bug",n.$o.$t.get_$28())})}}function $6rs(n){var t=n.$o.$k5.$m0(1,!0,n.$1h7);return t.$2M?[new _0365m.$m(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,t)]:new Array(0)}function $6rx(n){var t=[];if(n.$o.$t.get_$JW()){n.$o.$t.get_$ej()&&Array.add(t,new _0365m.$m(_u.Strings.l_Reply_LowerCase_Text,null,n.$o.$QJ.$IO));n.$o.$t.get_$hr()&&Array.add(t,new _0365m.$m(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$o.$QJ.$KS));n.$o.$t.get_$ei()&&Array.add(t,new _0365m.$m(_u.Strings.l_Forward_LowerCase_Text,null,n.$o.$QJ.$Hx))}else n.$o.$t.get_$ei()&&Array.add(t,new _0365m.$m(_u.Strings.l_Forward_LowerCase_Text,null,n.$o.$QJ.$Hx));return t}function $6rr(n){return[new _0365m.$m(_nbs.NonBootStrings.l_AddToMyCalendar_Occurrence_Text,null,n.$o.$5m.$2kj),new _0365m.$m(_nbs.NonBootStrings.l_AddToMyCalendar_Series_Text,null,n.$25y.$5m.$2kj)]}function $6rv(n){return[new _0365m.$m(_nbs.NonBootStrings.l_Calendar_ReadingPane_EditContextMenu_EditOccurrence_Text,null,n.$3ou),new _0365m.$m(_nbs.NonBootStrings.l_Calendar_ReadingPane_EditContextMenu_EditSeries_Text,null,n.$2Ju)]}function $6ru(n){return[new _0365m.$m(_nbs.NonBootStrings.l_DeleteOccurrence_LowerCase_Text,null,n.$o.$5m.$TL),new _0365m.$m(_nbs.NonBootStrings.l_DeleteSeries_LowerCase_Text,null,n.$25y.$5m.$TL)]}function $6rt(n){return[new _0365m.$m(_nbs.NonBootStrings.l_CancelOccurrence_LowerCase_Text,null,n.$o.$5m.$7V),new _0365m.$m(_nbs.NonBootStrings.l_CancelSeries_LowerCase_Text,null,n.$25y.$5m.$7V)]}function $2h7(n,t,i,r){t&&(n.$o.$t.get_$GC()?i.set_$1O(!0):r.$n())}_d.$5x.prototype={$1qF:null,$o:null,$1uN:null,$27C:null,$w:null,$1h7:null,$L0:null,$aM:null,$9vf:null,$3ou:null,$2Ju:null,$3d1:null,$Zj:null,$JN:null,$7V:null,$6FE:null,$3Gl:null,$25y:null,$6MS:!1,$1hi:null,$6a:null,$C:null,$1J:null,$1Zd:null,$5t:null,$1zu:null,$1uj:null,$Bc:null,$Qb:null,$3m:null,$1Zc:null,$27N:null,$1ou:null,$2Jn:null,$2Io:null,$2GH:null,$29Q:!1,get_$3gD:function(){return this.$Qb},set_$3gD:function(n){this.$Qb=n;$3(this,"CalendarCategoryViewModel");return n},get_$7lK:function(){return this.$1Zd},set_$7lK:function(n){if(this.$1Zd!==n){this.$1Zd=n;$3(this,"EmailRemindersViewModel")}return n},get_$7lD:function(){return this.$1Zc},set_$7lD:function(n){if(n!==this.$1Zc){this.$1Zc=n;$3(this,"EllipsesContextMenu")}return n},get_$9by:function(){return this.$27N},set_$9by:function(n){if(n!==this.$27N){this.$27N=n;$3(this,"ReplyContextMenu")}return n},get_$7Ol:function(){return this.$1ou},set_$7Ol:function(n){if(this.$1ou!==n){this.$1ou=n;$3(this,"AddToMyCalendarContextMenuForSeries")}return n},get_$7kp:function(){return this.$2Jn},set_$7kp:function(n){if(this.$2Jn!==n){this.$2Jn=n;$3(this,"EditContextMenuForSeries")}return n},get_$7hN:function(){return this.$2Io},set_$7hN:function(n){if(this.$2Io!==n){this.$2Io=n;$3(this,"DeleteContextMenuForSeries")}return n},get_$59r:function(){return!this.$C.get_$Er()&&this.$o.$t.get_$11b()},get_$7V3:function(){return!!this.$27N&&this.$27N.$1C.get_$B()>0},get_$5Zp:function(){var n=this.$o.$t.get_$3C();return!!n&&n.get_$3n()==="HTML"},get_$7UO:function(){return this.$2GH},set_$7UO:function(n){if(this.$2GH!==n){this.$2GH=n;$3(this,"CancelContextMenuForSeries")}return n},get_$4WU:function(){return this.$29Q},set_$4WU:function(n){if(this.$29Q!==n){this.$29Q=n;$45(this,"ShowLoading","ShowEmailRemindersControl")}return n},get_$3gG:function(){return this.$Bc},set_$3gG:function(n){if(this.$Bc!==n){this.$Bc=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$4WP:function(){return!!this.$1J&&this.$1J.$3u("EmailReminders")&&!this.$o.$t.get_$GC()&&!this.$o.$t.get_$W2()&&!this.$o.$t.get_$Pk()&&!this.$o.$t.get_$aH()&&!this.$29Q},$97r:function(){$CY(this,"Ready",this,this)},$3Fz:function(){this.$1Zd&&this.$1Zd.$3Fz()},$9zv:function(n){this.$1zu=n;$2h8(this)},$4c:function(){this.$6MS&&this.$o.$t.$u("IsPrivate",this.$$d_$8EV);this.$L0&&this.$o.$t.$u("HasBlockedImages",this.$$d_$4Is);_a.$1.prototype.$4c.call(this)},$3Ex:function(n,t){this.$1Zc.$2y&&this.$Qb&&this.$Qb.$4O9()},$6bP:function(){this.$o.$t.set_$cg(!this.$o.$t.get_$cg())},$8EV:function(n,t){$2h8(this)},$4Is:function(n,t){this.$L0.$18h()},$3G0:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$1h7()},$54Z:function(){$2h7(this,this.$o.$5m.get_$1AE(),this.$1ou,this.$o.$5m.$2kj)},$Zi:function(){$2h7(this,this.$o.$5m.get_$eh(),this.$2Jn,this.$3ou)},$34:function(){$2h7(this,this.$o.$5m.get_$VX(),this.$2Io,this.$Bc.$2a8)},$9b:function(){$2h7(this,this.$o.$5m.get_$hp(),this.$2GH,this.$Bc.$2nm)}};_d.$iu=function(n,t,i,r,u,f,e,o){this.$C=t;this.$2Gd=r;this.$5C=n;this.$Ax=i;this.$2U=u;this.$D8=f;this.$1J=e;this.$5Kc=o};_d.$iu.prototype={$5C:null,$C:null,$Ax:null,$2Gd:null,$2U:null,$D8:null,$1J:null,$5Kc:null,$E:function(n,t,i,r,u,f,e){return new _d.$5x(n,t,i,this.$5C,this.$C,r,u,this.$Ax,this.$2U,this.$2Gd,f,e,this.$D8,this.$1J,this.$5Kc)},$7cc:function(n,t,i){return new _d.$5x(n,t,i,this.$5C,this.$C,null,null,this.$Ax,null,this.$2Gd,null,null,this.$D8,null,null)}};_d.$1t=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9dN=Function.createDelegate(this,this.$9dN);this.$$d_$7jf=Function.createDelegate(this,this.$7jf);this.$$d_$9dL=Function.createDelegate(this,this.$9dL);this.$$d_$7gh=Function.createDelegate(this,this.$7gh);this.$$d_$9uT=Function.createDelegate(this,this.$9uT);this.$$d_$7Md=Function.createDelegate(this,this.$7Md);this.$$d_$54Z=Function.createDelegate(this,this.$54Z);this.$$d_$5H6=Function.createDelegate(this,this.$5H6);this.$$d_$9uU=Function.createDelegate(this,this.$9uU);this.$$d_$1Vz=Function.createDelegate(this,this.$1Vz);this.$$d_$7gm=Function.createDelegate(this,this.$7gm);this.$$d_$7kr=Function.createDelegate(this,this.$7kr);this.$$d_$9uX=Function.createDelegate(this,this.$9uX);this.$$d_$7l8=Function.createDelegate(this,this.$7l8);this.$$d_$7Mh=Function.createDelegate(this,this.$7Mh);this.$$d_$7km=Function.createDelegate(this,this.$7km);this.$$d_$7je=Function.createDelegate(this,this.$7je);this.$$d_$7jh=Function.createDelegate(this,this.$7jh);this.$$d_$7jc=Function.createDelegate(this,this.$7jc);this.$$d_$7gk=Function.createDelegate(this,this.$7gk);this.$$d_$7kq=Function.createDelegate(this,this.$7kq);this.$$d_$9uV=Function.createDelegate(this,this.$9uV);this.$$d_$7l7=Function.createDelegate(this,this.$7l7);this.$$d_$7Mf=Function.createDelegate(this,this.$7Mf);this.$$d_$7kl=Function.createDelegate(this,this.$7kl);this.$$d_$7jd=Function.createDelegate(this,this.$7jd);this.$$d_$7jg=Function.createDelegate(this,this.$7jg);this.$$d_$7jb=Function.createDelegate(this,this.$7jb);_d.$1t.initializeBase(this);_a.$4.$J(n,"item");this.$P=n;this.$2oy=t;this.$1L3=i;this.$2L=r;this.$1W=u;this.$C=f;this.$6h=e;this.$lZ=o;this.$13=s;this.$3JB=h;this.$32Q=c;this.$1kI=0;this.$1km=!0;var l=this;this.$2Jc=new _C(this.$$d_$7jb,_d.$1t.$A,this,"CanAccept",function(){return l.get_$1AD()});var a=this;this.$2Je=new _C(this.$$d_$7jg,_d.$1t.$A,this,"CanTentativelyAccept",function(){return a.get_$1AI()});var v=this;this.$qF=new _C(this.$$d_$7jd,_d.$1t.$A,this,"CanDecline",function(){return v.get_$11Z()});if(this.$P.get_$Du()){var y=this;this.$3op=new _C(this.$$d_$7kl,_d.$1t.$A,this,"CanAccept",function(){return y.get_$1AD()});var p=this;this.$3bv=new _C(this.$$d_$7Mf,_d.$1t.$A,this,"CanAccept",function(){return p.get_$1AD()});var w=this;this.$3oz=new _C(this.$$d_$7l7,_d.$1t.$A,this,"CanTentativelyAccept",function(){return w.get_$1AI()});var b=this;this.$4a3=new _C(this.$$d_$9uV,_d.$1t.$A,this,"CanTentativelyAccept",function(){return b.get_$1AI()});var k=this;this.$2Jo=new _C(this.$$d_$7kq,_d.$1t.$A,this,"CanDecline",function(){return k.get_$11Z()});var d=this;this.$2IW=new _C(this.$$d_$7gk,_d.$1t.$A,this,"CanDecline",function(){return d.get_$11Z()})}if(_g.$33.isInstanceOfType(this.$P)&&this.$P.get_$GC()){var g=this;this.$3oN=new _C(this.$$d_$7jc,_d.$1t.$A,this,"CanAccept",function(){return g.get_$1AD()});var nt=this;this.$3oO=new _C(this.$$d_$7jh,_d.$1t.$A,this,"CanTentativelyAccept",function(){return nt.get_$1AI()});var tt=this;this.$2Jd=new _C(this.$$d_$7je,_d.$1t.$A,this,"CanDecline",function(){return tt.get_$11Z()});if(this.$P.get_$Du()){var it=this;this.$5K4=new _C(this.$$d_$7km,_d.$1t.$A,this,"CanAccept",function(){return it.get_$1AD()});var rt=this;this.$52u=new _C(this.$$d_$7Mh,_d.$1t.$A,this,"CanAccept",function(){return rt.get_$1AD()});var ut=this;this.$5KV=new _C(this.$$d_$7l8,_d.$1t.$A,this,"CanTentativelyAccept",function(){return ut.get_$1AI()});var ft=this;this.$6ai=new _C(this.$$d_$9uX,_d.$1t.$A,this,"CanTentativelyAccept",function(){return ft.get_$1AI()});var et=this;this.$3or=new _C(this.$$d_$7kr,_d.$1t.$A,this,"CanDecline",function(){return et.get_$11Z()});var ot=this;this.$3mV=new _C(this.$$d_$7gm,_d.$1t.$A,this,"CanDecline",function(){return ot.get_$11Z()})}}this.$3bs=new _C(this.$$d_$1Vz,_d.$1t.$A);this.$4a1=new _C(this.$$d_$9uU,_d.$1t.$A);this.$2r4=new _C(this.$$d_$5H6,_d.$1t.$A);this.$53s=new _C(this.$$d_$54Z,_d.$1t.$A);$6uf(this);this.$2Ds=1};_d.$1t.$5RG=function(n){var t=4;switch(n){case"Accept":t=5;break;case"Tentative":t=6;break;case"Decline":t=7;break;default:throw Error.invalidOperation("Expected Accept, Tentatively Accept or Decline as valid Meeting Responses");}return t};_d.$1t.$1an=function(n){switch(n){case 5:return"Accept";case 6:return"Tentative";case 7:return"Decline";default:throw Error.invalidOperation("Unable to get ResponseType from MailComposeOperation "+_y.$Iw.toString(n));}};_d.$1t.$3sM=function(n,t,i,r,u){var f=new _c.$Qc(n,t,r,u);f.$G6=i;return f};function $3Ws(n,t){$4mu(n,t,!1)}function $3Wt(n,t){$4mu(n,t,!0)}function $6uf(n){n.get_$3hD()&&(n.$6L7=$6ug(n));if(n.$P.get_$Du())if(_g.$33.isInstanceOfType(n.$P)&&n.$P.get_$GC()){n.$2Dp=$2hT(n,_nbs.NonBootStrings.l_AcceptOccurrence_UpperCase_Text,_nbs.NonBootStrings.l_AcceptSeries_UpperCase_Text,n.$3op,n.$3bv,n.$2Jc,n.$5K4,n.$52u,n.$3oN);n.$2eW=$2hT(n,_nbs.NonBootStrings.l_TentativelyAcceptOccurrence_UpperCase_Text,_nbs.NonBootStrings.l_TentativelyAcceptSeries_UpperCase_Text,n.$3oz,n.$4a3,n.$2Je,n.$5KV,n.$6ai,n.$3oO);n.$2IV=$2hT(n,_nbs.NonBootStrings.l_DeclineOccurrence_UpperCase_Text,_nbs.NonBootStrings.l_DeclineSeries_UpperCase_Text,n.$2Jo,n.$2IW,n.$qF,n.$3or,n.$3mV,n.$2Jd);n.$2Ip=$2hT(n,_nbs.NonBootStrings.l_DeleteOccurrence_UpperCase_Text,_nbs.NonBootStrings.l_DeleteSeries_UpperCase_Text,n.$2Jo,n.$2IW,n.$qF,n.$3or,n.$3mV,n.$2Jd)}else{n.$2Dp=$2hS(n,_nbs.NonBootStrings.l_AcceptMeeting_UpperCase_Text,n.$3op,n.$3bv,n.$2Jc);n.$2eW=$2hS(n,_nbs.NonBootStrings.l_TentativelyAcceptMeeting_UpperCase_Text,n.$3oz,n.$4a3,n.$2Je);n.$2IV=$2hS(n,_nbs.NonBootStrings.l_DeclineMeeting_UpperCase_Text,n.$2Jo,n.$2IW,n.$qF);n.$2Ip=$2hS(n,_nbs.NonBootStrings.l_DeleteMeeting_UpperCase_Text,n.$2Jo,n.$2IW,n.$qF)}else if(_g.$33.isInstanceOfType(n.$P)&&n.$P.get_$GC()){n.$2Dp=$2hU(n,_nbs.NonBootStrings.l_AcceptMeeting_UpperCase_Text,n.$2Jc,n.$3oN);n.$2eW=$2hU(n,_nbs.NonBootStrings.l_TentativelyAcceptMeeting_UpperCase_Text,n.$2Je,n.$3oO);n.$2IV=$2hU(n,_nbs.NonBootStrings.l_DeclineMeeting_UpperCase_Text,n.$qF,n.$2Jd);n.$2Ip=$2hU(n,_nbs.NonBootStrings.l_DeleteMeeting_UpperCase_Text,n.$qF,n.$2Jd)}}function $2hS(n,t,i,r,u){var f=new(_0365f.$o.$$(_0365m.$Qt));f.$D(new _0365m.$HB(t));f.$D(new _0365m.$m(_nbs.NonBootStrings.l_EditResponseBeforeSending_LowerCase_Text,null,i));f.$D(new _0365m.$m(_nbs.NonBootStrings.l_SendResponseNow_LowerCase_Text,null,r));f.$D(new _0365m.$m(_nbs.NonBootStrings.l_DontSendResponse_LowerCase_Text,null,u));return new _0365m.$2b(f.get_$3T())}function $6ug(n){var i=new _C(n.$$d_$7Md,_d.$1t.$A);var r=new _C(n.$$d_$9uT,_d.$1t.$A);var u=new _C(n.$$d_$7gh,_d.$1t.$A);var t=new(_0365f.$o.$$(_0365m.$Qt));t.$D(new _0365m.$HB(_nbs.NonBootStrings.l_ProposeNewTime_UpperCase_Text));t.$D(new _0365m.$m(_nbs.NonBootStrings.l_AcceptAndProposeNewTime_LowerCase_Text,null,i));t.$D(new _0365m.$m(_nbs.NonBootStrings.l_TentativeAndProposeNewTime_LowerCase_Text,null,r));t.$D(new _0365m.$m(_nbs.NonBootStrings.l_DeclineAndProposeNewTime_LowerCase_Text,null,u));return new _0365m.$2b(t.get_$3T())}function $3Wv(n,t){n.$3JB.get_$1g().$9rj(n.$P,t,n.$2oy)}function $2hT(n,t,i,r,u,f,e,o,s){var h=new(_0365f.$o.$$(_0365m.$Qt));h.$D(new _0365m.$HB(t));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_EditResponseBeforeSending_LowerCase_Text,null,r));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_SendResponseNow_LowerCase_Text,null,u));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_DontSendResponse_LowerCase_Text,null,f));h.$D(new _0365m.$HB(i));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_EditResponseBeforeSending_LowerCase_Text,null,e));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_SendResponseNow_LowerCase_Text,null,o));h.$D(new _0365m.$m(_nbs.NonBootStrings.l_DontSendResponse_LowerCase_Text,null,s));return new _0365m.$2b(h.get_$3T())}function $2hU(n,t,i,r){var u=new(_0365f.$o.$$(_0365m.$Qt));u.$D(new _0365m.$HB(t));u.$D(new _0365m.$m(_nbs.NonBootStrings.l_Occurrence_LowerCase_Text,null,i));u.$D(new _0365m.$m(_nbs.NonBootStrings.l_Series_LowerCase_Text,null,r));return new _0365m.$2b(u.get_$3T())}function $4mu(n,t,i){n.$1kI=_d.$1Jb.$1k.$I8.$7tL(i);n.$ru=_d.$1Jb.$1k.$I8.$4Xp(t,n.$2Ds);if(n.$C.get_$9A()){n.$3JT();n.$6Lg()}_a.$g.$8r("VM.MeetResponse.EditResponseForTouchWideAndMouseStart");var r=n.$6h.$G3(!1,!1);r.set_$40(_d.$1t.$5RG(t));r.set_$Na(!0);if(_g.$33.isInstanceOfType(n.$P)){r.set_$14D(!0);r.set_$rN(i);if(i){var u=n.$lZ.$1YU(n.$P);r.set_$dJ(u.get_$i())}else r.set_$dJ(n.$P.get_$i())}else r.$13p(n.$P);r.set_$61(n.$1L3);n.$2oy.$T7(r);if(n.$ru){_d.$1Jb.$1k.$I8.$3pT(n.$ru,"",null,n.$P.get_$Du(),_g.$33.isInstanceOfType(n.$P),n.get_$GC(),n.$1kI);n.$ru=null}}function $3Wq(n,t){$4mt(n,t,!1)}function $3Wr(n,t){$4mt(n,t,!0)}function $4mv(n,t,i,r){var u=n.$P;_g.$33.isInstanceOfType(u)&&t&&(u=n.$lZ.$1YU(u));return _d.$1t.$3sM(u,i,$6ue(n),r,null)}function $4mt(n,t,i){n.$1kI=_d.$1Jb.$1k.$I8.$7tF(i);n.$ru=_d.$1Jb.$1k.$I8.$4Xp(t,n.$2Ds);var r=$4mv(n,i,t,0);r.add_$2C(n.$$d_$7jf);r.add_$1x(n.$$d_$9dL);n.$1W.$z(r);n.$3JT()}function $6ue(n){var t=new _g.$7g;t.set_$3C(n.$3j);t.set_$6U("Normal");return t}function $3Ww(n,t){$4mw(n,t,!1)}function $3Wx(n,t){$4mw(n,t,!0)}function $4mw(n,t,i){n.$1kI=_d.$1Jb.$1k.$I8.$7xp(i);n.$ru=_d.$1Jb.$1k.$I8.$4Xp(t,n.$2Ds);var r=$4mv(n,i,t,1);r.add_$1x(n.$$d_$9dL);r.add_$2C(n.$$d_$9dN);n.$1W.$z(r);n.$3JT();_a.$g.$8r("VM.MeetResponse.MeetingResponseEnd")}function $3Wu(n,t){if(n.get_$9nZ())switch(t){case"Accept":n.$2Jc.$n();break;case"Tentative":n.$2Je.$n();break;case"Decline":n.$qF.$n();break;default:throw Error.argument("Invalid meeting response argument");}}_d.$1t.prototype={$2L:null,$1W:null,$P:null,$53s:null,$3bs:null,$4a1:null,$2r4:null,$3bv:null,$52u:null,$4a3:null,$6ai:null,$2IW:null,$3mV:null,$3op:null,$5K4:null,$3oz:null,$5KV:null,$2Jo:null,$3or:null,$2Jc:null,$3oN:null,$2Je:null,$3oO:null,$qF:null,$2Jd:null,$C:null,$1L3:0,$2oy:null,$6h:null,$lZ:null,$13:null,$32Q:!1,$3JB:null,$2Dp:null,$2eW:null,$2IV:null,$2Ip:null,$6L7:null,$3j:null,$1km:!1,$2xG:!1,$2Ds:0,$1kI:0,$ru:null,$ha:null,add_$1W3:function(n){this.$2N("ActionSubmitted",n)},remove_$1W3:function(n){this.$2P("ActionSubmitted",n)},get_$7Mg:function(){return this.$1km?_nbs.NonBootStrings.l_AcceptItem_UpperCase_Text:""},get_$7gl:function(){return this.$1km?_nbs.NonBootStrings.l_DeclineItem_UpperCase_Text:""},get_$9uW:function(){return this.$1km?_nbs.NonBootStrings.l_TentativelyAcceptItem_UpperCase_Text:""},get_$1qX:function(){return this.get_$1AD()||this.get_$11Z()||this.get_$1AI()},get_$1AE:function(){return this.$P.get_$1AE()},get_$1AD:function(){return this.$P.get_$1AD()},get_$11Z:function(){return this.$P.get_$11Z()},get_$1AI:function(){return this.$P.get_$1AI()},get_$9nR:function(){return this.$1km},set_$9nR:function(n){if(this.$1km!==n){this.$1km=n;$JA(this,["TentativelyAcceptLabel","AcceptLabel","DeclineLabel"])}return n},get_$j2:function(){return this.$13.get_$ZS().get_$j2()},get_$fl:function(){return this.$C.get_$L()!=="Mouse"},get_$82d:function(){return this.$2xG},set_$82d:function(n){if(n!==this.$2xG){this.$2xG=n;$3(this,"HasEventAddedToCalendar")}return n},get_$7mS:function(){return this.$C.get_$L()==="TouchNarrow"?_nbs.NonBootStrings.l_EventAddedToCalendar_Short_UpperCase_Text:_nbs.NonBootStrings.l_EventAddedToCalendar_UpperCase_Text},get_$3hD:function(){return this.$32Q&&!this.get_$fl()&&this.$P.get_$3hD()&&this.$P.get_$Du()},get_$9nZ:function(){return!this.$P.get_$Du()&&(_g.$RD.isInstanceOfType(this.$P)||_g.$33.isInstanceOfType(this.$P)&&!this.$P.get_$GC())},$3JT:function(){$CY(this,"ActionSubmitted",this,null)},$6Lg:function(){$CY(this,"ActionSucceeded",this,null)},$7Md:function(){$3Wv(this,"Accept")},$9uT:function(){$3Wv(this,"Tentative")},$7gh:function(){$3Wv(this,"Decline")},$54Z:function(){this.$ha=_a.$6.$1c(_d.$1t.$A,"AddToMyCalendarFromGroupInvite",!0);_a.$6.stPT(_d.$1t.$A,"AddToMyCalendarFromGroupInvite",3);var i=new _g.$VP;i.ItemId=this.$P.get_$i();var r=this.$2oy.get_$3qS();var n=new _c.$hZ(i,r);n.add_$1x(this.$$d_$9dL);var t=this;n.add_$2C(function(n){t.set_$82d(!0);if(t.$ha){_a.$6.$1E(t.$ha,null,"",_d.$1Jb.$6w.$PX(n),null);t.$ha=null}});var u=this;n.add_$2m(function(n){_a.$6.endPT("AddToMyCalendarFromGroupInvite")});this.$1W.$z(n)},$7kl:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Ws(this,"Accept")},$7Mf:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Ww(this,"Accept")},$7jb:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Wq(this,"Accept")},$7km:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Wt(this,"Accept")},$7Mh:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Wx(this,"Accept")},$7jc:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.AcceptedMeetingRequest",n);$3Wr(this,"Accept")},$7l7:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Ws(this,"Tentative")},$9uV:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Ww(this,"Tentative")},$7jg:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Wq(this,"Tentative")},$7l8:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Wt(this,"Tentative")},$9uX:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Wx(this,"Tentative")},$7jh:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.TentativeMeetingRequest",n);$3Wr(this,"Tentative")},$7kq:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Ws(this,"Decline")},$7gk:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Ww(this,"Decline")},$7jd:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Wq(this,"Decline")},$7kr:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Wt(this,"Decline")},$7gm:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Wx(this,"Decline")},$7je:function(){var n=this.$P.get_$i();this.$2L.$SA("Inference.DeclinedMeetingRequest",n);$3Wr(this,"Decline")},$7jf:function(n){var t=n;t.remove_$2m(this.$$d_$7jf);if(!$6(t.meetingResponseMessageId)){var i=new _h.$Kf([t.meetingResponseMessageId],"HardDelete",2);i.add_$1x(this.$$d_$9dL);i.add_$2C(this.$$d_$9dN);this.$1W.$z(i);this.$3JT()}},get_$GC:function(){return _g.$33.isInstanceOfType(this.$P)&&this.$P.get_$GC()},$9dL:function(n){var t=_d.$1Jb.$6w.$iV(n);var i=_d.$1Jb.$6w.$PX(n);_js.Trace.logWarning(_d.$1t.$A,"MeetingResponse message failed with error: "+t);if(this.$ru){_d.$1Jb.$1k.$I8.$3pT(this.$ru,t,i,this.$P.get_$Du(),_g.$33.isInstanceOfType(this.$P),this.get_$GC(),this.$1kI);this.$ru=null}if(this.$ha){_a.$6.$1E(this.$ha,null,t,i,null);this.$ha=null}_cc.$5g.$1C0(n)},$9dN:function(n){if(this.$ru){_d.$1Jb.$1k.$I8.$3pT(this.$ru,"",_d.$1Jb.$6w.$PX(n),this.$P.get_$Du(),_g.$33.isInstanceOfType(this.$P),this.get_$GC(),this.$1kI);this.$ru=null}this.$6Lg()},$1Vz:function(){$3Wu(this,"Accept")},$9uU:function(){$3Wu(this,"Tentative")},$5H6:function(){$3Wu(this,"Decline")}};_d.$kB=function(n,t,i,r,u,f,e,o,s){this.$k=t;this.$2L=n;this.$Wl=i;this.$6h=r;this.$7ZL=u;this.$lZ=f;this.$13=e;this.$3JB=o;this.$32Q=s};_d.$kB.prototype={$k:null,$2L:null,$Wl:null,$6h:null,$lZ:null,$13:null,$3JB:null,$32Q:!1,$592:null,$5Hb:null,$7ZL:null,$7TY:function(n){var t;if(this.$Wl.get_$L()==="TouchNarrow")t=2;else switch(n){case 0:t=this.$Wl.get_$L()==="Mouse"?1:0;break;default:t=0;break}return t},$874:function(n,t,i){return new _d.$1t(n,t,i,this.$2L,this.$k,this.$Wl,this.$6h,this.$lZ,this.$13,this.$3JB,this.$32Q)},$8A:function(n,t){var i=this.$7TY(t);var r=this.$592.$E(this.$5Hb,i);return this.$874(n,r,i)}};_d.$yb=function(n){this.$5C=n};_d.$yb.prototype={$5C:null,$4NK:0,$dQ:0,$E:function(n){if(!n)return null;var i=_pc.$i.$DQ(n);var t=this.$5C.$SR(i,this.$4NK,!0,this.$dQ);t.set_$DJ(!0);return t}};_d.$Jc=function(n){this.$B4=n};function $4lE(n,t){_a.$4.$Js(t.length,3,"Expected three daily recurrence pattern strings");var i="";switch(n.$B4){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=String.format(t[2],n.$B4);break}return i}_d.$Jc.prototype={$B4:0,get_$1o:function(){return _nbs.NonBootStrings.l_Daily_Text},$2R:function(n){return _d.$Jc.isInstanceOfType(n)&&n.$B4===this.$B4},$2B7:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternDailyOne_Text,_nbs.NonBootStrings.l_Recurrence_PatternDailyTwoFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternDailyMoreFormat_Text];return $4lE(this,n)},$9vn:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternDailyOne_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternDailyTwoFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternDailyMoreFormat_StringSegment_Text];return $4lE(this,n)},$3TY:function(){return this.$B4<=0?4:0},$9vq:function(){var n=new _g.$ic(new _g.$Qd(this.$B4));n.set_$a6(this.$B4);return n},$3p:function(){return new _d.$Jc(this.$B4)}};_d.$Jx=function(n,t){this.$B4=n;this.$Qr=t};function $4mx(n,t){_a.$4.$Js(t.length,3,"Expected three month-by-day pattern strings");var i="";switch(n.$B4){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,n.$Qr,n.$B4)}_d.$Jx.prototype={$Qr:0,$B4:0,get_$1o:function(){return _nbs.NonBootStrings.l_MonthlyByDay_Text},$2B7:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayOneFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayTwoFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayMoreFormat_Text];return $4mx(this,n)},$9vn:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayOneFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayTwoFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByDayMoreFormat_StringSegment_Text];return $4mx(this,n)},$2R:function(n){return _d.$Jx.isInstanceOfType(n)&&n.$B4===this.$B4&&n.$Qr===this.$Qr},$3TY:function(){var n=0;this.$B4<=0?n|=4:(this.$Qr>31||this.$Qr<=0)&&(n|=1);return n},$9vq:function(){return new _g.$hV(new _g.$Q9(this.$B4,this.$Qr))},$3p:function(){return new _d.$Jx(this.$B4,this.$Qr)}};_d.$Jy=function(n,t,i){this.$B4=n;this.$Ck=t;this.$Qs=i};function $4my(n,t){_a.$4.$Js(t.length,3,"Expected three monthly-by-week recurrence pattern strings");var i="";switch(n.$B4){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,_d.$2r.$5P9(n.$Ck),_d.$2r.$3sI(n.$Qs),n.$B4)}_d.$Jy.prototype={$Ck:"None",$Qs:0,$B4:0,get_$1o:function(){return _nbs.NonBootStrings.l_MonthlyByWeek_Text},$2B7:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekOneFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekTwoFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekMoreFormat_Text];return $4my(this,n)},$9vn:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekOneFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekTwoFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternMonthlyByWeekMoreFormat_StringSegment_Text];return $4my(this,n)},$2R:function(n){return _d.$Jy.isInstanceOfType(n)&&n.$B4===this.$B4&&n.$Qs===this.$Qs&&n.$Ck===this.$Ck},$3TY:function(){var n=0;this.$B4<=0&&(n|=4);this.$Qs||(n|=2);this.$Ck==="None"&&(n|=16);return n},$9vq:function(){var n=new _g.$lG;n.set_$a6(this.$B4);n.set_$1BA(this.$Qs);n.set_$1Lu(this.$Ck);return n},$3p:function(){return new _d.$Jy(this.$B4,this.$Ck,this.$Qs)}};_d.$IH=function(){};_d.$IH.prototype={get_$1o:function(){return _nbs.NonBootStrings.l_Never_Text},$2B7:function(){return _nbs.NonBootStrings.l_Never_Text},$9vn:function(){return this.$2B7()},$2R:function(n){return _d.$IH.isInstanceOfType(n)},$3TY:function(){return 0},$9vq:function(){return null},$3p:function(){return new _d.$IH}};_d.$He=function(){};_d.$He.$5iz=function(n,t,i){var r=new _js.$Z;var u=_d.$2r.$5DT(n.get_$Dr());var f=n.get_$2z();r.$D(new _d.$IH);r.$D(new _d.$Jc(1));r.$D(new _d.$JM(1,u));t&&r.$D(new _d.$JM(1,t,t));r.$D(new _d.$Jx(1,n.get_$51()));r.$D(new _d.$Jy(1,_d.$2r.$2wg(n),u));r.$D(new _d.$KP(n.get_$51(),f));i.get_$L()!=="TouchNarrow"&&r.$D(_nbs.NonBootStrings.l_EditPattern_Text);return r};_d.$He.$9ZH=function(n,t){t.set_$Hi(n.$Jf.$9vq());t.set_$1iz(n.$9vr());t.set_$3RG(n.$7e)};_d.$He.$4Pj=function(n,t,i){if($6(n))return null;var r=new _d.$DT;r.set_$Hi(_d.$He.$6HA(n.get_$Hi()));r.set_$8q(n.get_$1iz().get_$8q());r.set_$1Bd(_d.$2r.$58a(n.get_$1iz(),r.$Jf));r.set_$17y(t);r.set_$12i(i);r.set_$3RG(n.get_$3RG());return r};_d.$He.$6HA=function(n){var t=new _d.$IH;_g.$ic.isInstanceOfType(n)?t=new _d.$Jc(n.get_$a6()):_g.$me.isInstanceOfType(n)?t=new _d.$JM(n.get_$a6(),n.get_$1BA()):_g.$hV.isInstanceOfType(n)?t=new _d.$Jx(n.get_$a6(),n.get_$1rw()):_g.$lG.isInstanceOfType(n)?t=new _d.$Jy(n.get_$a6(),n.get_$1Lu(),n.get_$1BA()):_g.$hW.isInstanceOfType(n)?t=new _d.$KP(n.get_$1rw(),_js.$1g.$Q9(_a.$qW,n.get_$2z())):_g.$rx.isInstanceOfType(n)&&(t=new _d.$LL(n.get_$1Lu(),n.get_$1BA(),_js.$1g.$Q9(_a.$qW,n.get_$2z())));return t};_d.$DT=function(n,t,i,r,u,f){_d.$DT.initializeBase(this);this.set_$8q(t||null);this.set_$1Bd(i||null);this.set_$17y(r||null);this.set_$12i(u||null);this.set_$3RG($6(f)?null:f);this.set_$Hi($6(n)?null:n)};_d.$DT.$1j0=function(n,t){return(n&t)===t};_d.$DT.$1um=function(n){var t=null;n?_d.$DT.$1j0(n,64)?t=_nbs.NonBootStrings.l_InvalidDateRange_Text:_d.$DT.$1j0(n,1)?t=_nbs.NonBootStrings.l_InvalidDay_Text:_d.$DT.$1j0(n,2)?t=_nbs.NonBootStrings.l_InvalidDaysOfWeek_Text:_d.$DT.$1j0(n,4)?t=_nbs.NonBootStrings.l_InvalidInterval_Text:_d.$DT.$1j0(n,32)?t=_nbs.NonBootStrings.l_InvalidMonth_Text:_d.$DT.$1j0(n,16)?t=_nbs.NonBootStrings.l_InvalidRecurrenceOrder_Text:_d.$DT.$1j0(n,8)&&(t=_nbs.NonBootStrings.l_InvalidStartDate_Text):t=null;return t};function $6wq(n){var t=0;$6(n.$65)?t=8:!$6(n.$SX)&&n.$65.$2R(n.$SX)>=0&&(t=64);return t}_d.$DT.prototype={$65:null,$SX:null,$6r:null,$8B:null,$Jf:null,$7e:null,get_$Hi:function(){return this.$Jf},set_$Hi:function(n){if(this.$Jf!==n){this.$Jf=n;$N(this,"RecurrencePattern")}return n},get_$8q:function(){return this.$65},set_$8q:function(n){if(this.$65!==n){this.$65=n;$N(this,"StartDate")}return n},get_$1Bd:function(){return this.$SX},set_$1Bd:function(n){if(this.$SX!==n){!$6(n)&&n.$2R(this.$65)<0&&(n=this.$65);this.$SX=n;$N(this,"EndDate")}return n},get_$17y:function(){return this.$6r},set_$17y:function(n){if(this.$6r!==n){this.$6r=n;$N(this,"StartTime")}return n},get_$12i:function(){return this.$8B},set_$12i:function(n){if(this.$8B!==n){!$6(n)&&n.$2R(this.$6r)<0&&(n=this.$6r);this.$8B=n;$N(this,"EndTime")}return n},get_$3RG:function(){return this.$7e},set_$3RG:function(n){if(this.$7e!==n){this.$7e=n;$N(this,"TimeZoneId")}return n},$9vs:function(){return _d.$IH.isInstanceOfType(this.$Jf)?this.$Jf.$2B7():String.format(_nbs.NonBootStrings.l_RecurrenceFormat_Text,this.$Jf.$9vn(),this.$6bc())},$6bc:function(){var n="";var t="";this.$6r&&this.$8B&&(t=String.format(_nbs.NonBootStrings.l_RangeTime_Text,this.$6r.$2Z(0),this.$8B.$2Z(0)));n=this.$SX?String.format(_nbs.NonBootStrings.l_RangeEndDate_Text,this.$65.$2Z(5),this.$SX.$2Z(5)):String.format(_nbs.NonBootStrings.l_RangeNoEndDate_Text,this.$65.$2Z(5));return String.format(_nbs.NonBootStrings.l_RangeFormat_Text,t,n)},$3TY:function(){return this.$Jf.$3TY()|$6wq(this)},$9vr:function(){var n;if(this.$SX){var t=new _g.$ir;t.set_$8q(this.$65);t.set_$1Bd(this.$SX);n=t}else{var i=new _g.$yF;i.set_$8q(this.$65);n=i}return n}};_d.$2r=function(){};_d.$2r.$2wg=function(n){for(var t=n.get_$51(),i=0;t>0;){t-=7;++i}switch(i){case 0:return"None";case 1:return"First";case 2:return"Second";case 3:return"Third";case 4:return"Fourth";default:return"Last"}};_d.$2r.$5DT=function(n){var t;switch(n){case 0:t=1;break;case 1:t=2;break;case 2:t=4;break;case 3:t=8;break;case 4:t=16;break;case 5:t=32;break;case 6:t=64;break;default:t=0;break}return t};_d.$2r.$1YN=function(n){var t=[];n&1&&Array.add(t,0);n&2&&Array.add(t,1);n&4&&Array.add(t,2);n&8&&Array.add(t,3);n&16&&Array.add(t,4);n&32&&Array.add(t,5);n&64&&Array.add(t,6);return t};_d.$2r.$7Tc=function(n){var t=_d.$He.$6HA(n.get_$Hi());var i=n.get_$1iz();return _d.$2r.$58a(i,t)};_d.$2r.$58a=function(n,t){if(_g.$ir.isInstanceOfType(n))return n.get_$1Bd();if(!_g.$yR.isInstanceOfType(n)||_d.$IH.isInstanceOfType(t))return null;var r=n.get_$67r();var i=n.get_$8q();if(_d.$Jc.isInstanceOfType(t)){var p=t.$B4*(r-1);return i.$2o(p)}else if(_d.$JM.isInstanceOfType(t)){var u=t.$12A;var o=t.$B4;if(!Array.contains(_d.$2r.$1YN(u),i.get_$Dr())){var w=_d.$2r.$5Rb(i.get_$Dr(),u,0);i=i.$2o(_d.$2r.$2LP(i.get_$Dr(),w))}var s=_d.$2r.$7xe(u);var b=Math.floor((r-1)/s);var h=(r-1)%s;var f=o*7*b;if(h>0){var e=_d.$2r.$5Rb(i.get_$Dr(),u,h);if(e<=i.get_$Dr()){f+=o*7;f-=_d.$2r.$2LP(e,i.get_$Dr())}else f+=_d.$2r.$2LP(i.get_$Dr(),e)}return i.$2o(f)}else if(_d.$Jy.isInstanceOfType(t)){var k=t.$Ck;var d=t.$B4;var g=_d.$2r.$1YN(t.$Qs)[0];(_d.$2r.$2wg(i)>k||i.get_$Dr()>g)&&(i=i.$HM(d));return _d.$2r.$54n(i.$HM((r-1)*t.$B4),_d.$2r.$1YN(t.$Qs)[0],t.$Ck)}else if(_d.$Jx.isInstanceOfType(t)){var c=t.$Qr;var l=t.$B4;if(i.get_$51()>c){i=i.$HM(l);i=new _a.$7(i.get_$3l(),i.get_$2z(),c)}return i.$HM((r-1)*l)}else if(_d.$LL.isInstanceOfType(t)){var nt=t.$Ck;var a=t.$YT;var tt=_d.$2r.$1YN(t.$Qs)[0];(i.get_$2z()>a||_d.$2r.$2wg(i)>nt||i.get_$Dr()>tt)&&(i=new _a.$7(i.get_$3l()+1,a,1));return _d.$2r.$54n(i.$hb(r-1),_d.$2r.$1YN(t.$Qs)[0],t.$Ck)}else if(_d.$KP.isInstanceOfType(t)){var v=t.$Qr;var y=t.$YT;(i.get_$2z()>y||i.get_$51()>v)&&(i=new _a.$7(i.get_$3l()+1,y,v));return i.$hb(r-1)}return null};_d.$2r.$5Rb=function(n,t,i){for(var r=_d.$2r.$1YN(t),f=0,u=0;u<r.length;u++)if(n<=r[u]){f=u;if(n===r[u])break}return r[(i+f)%r.length]};_d.$2r.$2LP=function(n,t){var i=t-n;return i<0?i+7:i};_d.$2r.$7xe=function(n){for(var i=0,t=n;t;){(t&1)>0&&i++;t=t>>1}return i};_d.$2r.$K1=function(n){switch(n){case 0:return _nbs.NonBootStrings.l_Sunday_Text;case 1:return _nbs.NonBootStrings.l_Monday_Text;case 2:return _nbs.NonBootStrings.l_Tuesday_Text;case 3:return _nbs.NonBootStrings.l_Wednesday_Text;case 4:return _nbs.NonBootStrings.l_Thursday_Text;case 5:return _nbs.NonBootStrings.l_Friday_Text;case 6:return _nbs.NonBootStrings.l_Saturday_Text;default:return""}};_d.$2r.$3sI=function(n,t){if(!$6(t)&&n===t)return _nbs.NonBootStrings.l_Workday_Text;if(n===62)return _nbs.NonBootStrings.l_Weekday_Text;if(n===65)return _nbs.NonBootStrings.l_WeekendDay_Text;if(n===127)return _nbs.NonBootStrings.l_Day_LowerCase_Text;var i=_d.$2r.$1YN(n);switch(i.length){case 0:return"";case 1:return String.format(_nbs.NonBootStrings.l_WhenOneDayOfWeek_Text,_d.$2r.$K1(i[0]));case 2:return String.format(_nbs.NonBootStrings.l_WhenTwoDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]));case 3:return String.format(_nbs.NonBootStrings.l_WhenThreeDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]),_d.$2r.$K1(i[2]));case 4:return String.format(_nbs.NonBootStrings.l_WhenFourDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]),_d.$2r.$K1(i[2]),_d.$2r.$K1(i[3]));case 5:return String.format(_nbs.NonBootStrings.l_WhenFiveDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]),_d.$2r.$K1(i[2]),_d.$2r.$K1(i[3]),_d.$2r.$K1(i[4]));case 6:return String.format(_nbs.NonBootStrings.l_WhenSixDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]),_d.$2r.$K1(i[2]),_d.$2r.$K1(i[3]),_d.$2r.$K1(i[4]),_d.$2r.$K1(i[5]));case 7:return String.format(_nbs.NonBootStrings.l_WhenSevenDaysOfWeek_Text,_d.$2r.$K1(i[0]),_d.$2r.$K1(i[1]),_d.$2r.$K1(i[2]),_d.$2r.$K1(i[3]),_d.$2r.$K1(i[4]),_d.$2r.$K1(i[5]),_d.$2r.$K1(i[6]));default:return""}};_d.$2r.$5P9=function(n){switch(n){case"First":return _nbs.NonBootStrings.l_WhenFirst_Text;case"Second":return _nbs.NonBootStrings.l_WhenSecond_Text;case"Third":return _nbs.NonBootStrings.l_WhenThird_Text;case"Fourth":return _nbs.NonBootStrings.l_WhenFourth_Text;case"Last":return _nbs.NonBootStrings.l_WhenLast_Text;case"None":default:return""}};_d.$2r.$54n=function(n,t,i){if(i!=="Last"){n=new _a.$7(n.get_$3l(),n.get_$2z(),1);var u=_d.$2r.$2LP(n.get_$Dr(),t);var r=0;switch(i){case"First":r=1;break;case"Second":r=2;break;case"Third":r=3;break;case"Fourth":r=4;break}u+=7*(r-1);return n.$2o(u)}else{n=new _a.$7(n.get_$3l(),n.get_$2z(),_a.$7.$1C7(n.get_$2z(),n.get_$3l()));return n.$2o(_d.$2r.$2LP(t,n.get_$Dr())*-1)}};_d.$zP=function(n,t,i,r){this.$$d_$A0Z=Function.createDelegate(this,this.$A0Z);_d.$zP.initializeBase(this);this.$P=n;this.$6MA=t;$6(this.get_$M8())||$6(this.get_$M8().get_$Hi())?this.set_$6M8(new _d.$DT(new _d.$IH,i,null,i,r,"")):this.set_$6M8(_d.$He.$4Pj(this.get_$M8(),i,r));this.$Y("RecurrenceDataObject",this.$$d_$A0Z);this.$Jg.$Y("StartDate",this.$$d_$A0Z);this.$Jg.$Y("EndDate",this.$$d_$A0Z);this.$Jg.$Y("RecurrencePattern",this.$$d_$A0Z);this.$Jg.$Y("TimeZoneId",this.$$d_$A0Z)};_d.$zP.prototype={$P:null,$6MA:null,$Jg:null,get_$6M8:function(){return this.$Jg},set_$6M8:function(n){if(this.$Jg!==n){this.$Jg=n;$3(this,"RecurrenceDataObject")}return n},get_$Hi:function(){return this.$Jg.$Jf},set_$Hi:function(n){if(this.$Jg.$Jf!==n){this.$Jg.set_$Hi(n);$45(this,"RecurrencePattern","RecurrenceDataObject")}return n},get_$M8:function(){return this.$P.get_$1Se()},set_$M8:function(n){if(this.$P.get_$1Se()!==n){this.$P.set_$1Se(n);$3(this,"Model")}return n},$1um:function(){return _d.$DT.$1um(this.$Jg.$3TY())},$A0Z:function(n,t){if(_d.$IH.isInstanceOfType(this.$Jg.$Jf))this.set_$M8(null);else{var i=this.$6MA.$E();_d.$He.$9ZH(this.$Jg,i);this.set_$M8(i)}}};_d.$JM=function(n,t,i){this.$B4=n;this.$12A=t;this.$6gi=i};function $4oN(n,t){_a.$4.$Js(t.length,3,"Expected three weekly recurrence pattern strings");var i="";switch(n.$B4){case 0:throw Error.argument("Interval cannot be zero.");case 1:i=t[0];break;case 2:i=t[1];break;default:i=t[2];break}return String.format(i,_d.$2r.$3sI(n.$12A,n.$6gi),n.$B4)}_d.$JM.prototype={$6gi:0,$12A:0,$B4:0,get_$1o:function(){return _nbs.NonBootStrings.l_Weekly_Text},$2B7:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternWeeklyOneFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternWeeklyTwoFormat_Text,_nbs.NonBootStrings.l_Recurrence_PatternWeeklyMoreFormat_Text];return $4oN(this,n)},$9vn:function(){var n=[_nbs.NonBootStrings.l_Recurrence_PatternWeeklyOneFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternWeeklyTwoFormat_StringSegment_Text,_nbs.NonBootStrings.l_Recurrence_PatternWeeklyMoreFormat_StringSegment_Text];return $4oN(this,n)},$2R:function(n){return _d.$JM.isInstanceOfType(n)&&n.$B4===this.$B4&&n.$12A===this.$12A},$3TY:function(){var n=0;this.$B4<=0?n|=4:this.$12A||(n|=2);return n},$9vq:function(){var n=new _g.$me;n.set_$a6(this.$B4);n.set_$1BA(this.$12A);n.set_$3rC(_a.$Fy.toString(_a.$7.$2vk()));return n},$3p:function(){return new _d.$JM(this.$B4,this.$12A)}};_d.$KP=function(n,t){this.$Qr=n;this.$YT=t;this.$2AB=new _d.$qX};function $4oO(n,t){return String.format(t,n.$2AB.$36(n.$YT,!0),n.$Qr)}_d.$KP.prototype={$2AB:null,$YT:0,$Qr:0,get_$1o:function(){return _nbs.NonBootStrings.l_YearlyByDay_Text},$2B7:function(){return $4oO(this,_nbs.NonBootStrings.l_Recurrence_PatternYearlyByDayOneFormat_Text)},$9vn:function(){return $4oO(this,_nbs.NonBootStrings.l_Recurrence_PatternYearlyByDayOneFormat_StringSegment_Text)},$2R:function(n){return _d.$KP.isInstanceOfType(n)&&n.$Qr===this.$Qr&&n.$YT===this.$YT},$3TY:function(){var n=0;(0>=this.$Qr||this.$Qr>31)&&(n|=1);return n},$9vq:function(){return new _g.$hW(new _g.$QA(this.$Qr,this.$2AB.$36(this.$YT,!1)))},$3p:function(){return new _d.$KP(this.$Qr,this.$YT)}};_d.$LL=function(n,t,i){this.$Ck=n;this.$Qs=t;this.$YT=i;this.$2AB=new _d.$qX};function $4oP(n,t){return String.format(t,_d.$2r.$5P9(n.$Ck),_d.$2r.$3sI(n.$Qs),n.$2AB.$36(n.$YT,!0))}_d.$LL.prototype={$2AB:null,$YT:0,$Ck:"None",$Qs:0,get_$1o:function(){return _nbs.NonBootStrings.l_YearlyByWeek_Text},$2B7:function(){return $4oP(this,_nbs.NonBootStrings.l_Recurrence_PatternYearlyByWeekOneFormat_Text)},$9vn:function(){return $4oP(this,_nbs.NonBootStrings.l_Recurrence_PatternYearlyByWeekOneFormat_StringSegment_Text)},$2R:function(n){return _d.$LL.isInstanceOfType(n)&&n.$Qs===this.$Qs&&n.$Ck===this.$Ck&&n.$YT===this.$YT},$3TY:function(){var n=0;this.$Qs||(n|=2);this.$Ck==="None"&&(n|=16);return n},$9vq:function(){var n=new _g.$rx;n.set_$2z(this.$2AB.$36(this.$YT,!1));n.set_$1BA(this.$Qs);n.set_$1Lu(this.$Ck);return n},$3p:function(){return new _d.$LL(this.$Ck,this.$Qs,this.$YT)}};_d.$7C=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$68k=Function.createDelegate(this,this.$68k);this.$$d_$9Nh=Function.createDelegate(this,this.$9Nh);this.$$d_$6Cu=Function.createDelegate(this,this.$6Cu);this.$$d_$3G5=Function.createDelegate(this,this.$3G5);this.$$d_$4KH=Function.createDelegate(this,this.$4KH);_d.$7C.initializeBase(this);this.$6Q=e;this.$zp=o;this.$2Pb=s;this.$2zt=h;this.$2r=f;this.$2r.$11N();this.$2r.set_$NS(u);this.$2r.set_$1jW("PersonaDetailedView");this.$2r.add_$gw(this.$$d_$4KH);this.$EP=n;this.$EN=t;this.$nw=i;this.$27U=new(_a.$3X.$$(String));this.$25X=new(_a.$3X.$$(String));this.$17R=r};function $4jg(n,t){for(var r,u,i=0;i<t.get_$B();i++){r=t.get_$3q(i);u=r.$5A;u.$7ip()}}function $4jn(n,t,i){var r=0;var f=0;var e=t;for(var o in e){var u={key:o,value:e[o]};var s=u.value;($6(s)||s.get_$6V())&&(n.$27U.$7G(u.key)?r++:n.$25X.$7G(u.key)&&f++)}n.$nw.$8J&&r++;n.$17R.get_$BD()&&n.$17R.get_$3MY().get_$6V()&&r++;$4jm(n);n.set_$9cX(_d.$F1.$3k0(r,!n.$2Pb&&!i));n.set_$9SI(_d.$F1.$3k0(f,!n.$2Pb&&!i))}function $4jm(n){var t=n.$27U.get_$B()+1+(n.$17R.get_$BD()?1:0);n.set_$9cY(_d.$F1.$5Fb(t));n.set_$9SJ(_d.$F1.$7fE(n.$25X.get_$B()))}function $4jj(n,t,i){for(var f,r,u=0;u<t.$1T.get_$B();u++){f=t.$1T.get_$3q(u);r=f.$5A;r.set_$19v(i);r.$Y("AttendeeType",n.$$d_$68k)}}function $4jl(n,t){for(var r,u,i=0;i<t.$1T.get_$B();i++){r=t.$1T.get_$3q(i);u=r.$5A;u.$u("AttendeeType",n.$$d_$68k)}}function $6oT(n,t){var r=_d.$6a.$5P3(t.$Zu());if(!$6oU(n,r)){var u=_pc.$i.$DQ(r);u.set_$1F(t.get_$1s().get_$1F());var i=n.$zp.$2pi(u,n.$b9.$1Sd,!0,0);i.$Y("AttendeeType",n.$$d_$68k);i.$1HZ=!0;n.$b9.$1Jl(i)}}function $6oV(n){var t=1;n.$2zt||(t|=2);return t}function $4jf(n,t,i){for(var f=new _js.$Z,r,u=0;u<t.get_$B();u++){r=t.get_$3q(u).get_$7B();f.$D(r);i.$D(r.EmailAddress)}return n.$6Q.$1YW(_y.$w.$KH,f,$6oV(n))}function $4jh(n,t,i,r,u){switch(t.$2v){case 0:var f=this;Array.forEach(t.$2l,function(t){var e=i.$1T.get_$3q(i.$1T.get_$B()-1);var f=e.$5A.$14;f.get_$1F()===2&&f.get_$1l().RoutingType==="MAPIPDL"&&(n.$1ML[f.get_$1l().Name]=e);n.$1ML[f.get_$1l().EmailAddress]=e;u.$D(f.get_$1l().EmailAddress);r.$D(_g.$3i.$wR(f.get_$1l()))});break;case 2:var e=this;Array.forEach(t.$38,function(n){var i=n;u.$34(i.EmailAddress);for(var t=0;t<r.get_$B();t++)if(r.get_$3q(t).get_$7B().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$68(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}$4jm(n);n.set_$6Wa(n.$gb.$1T.get_$B()>0)}function $6oU(n,t){for(var i=t.EmailAddress.toLowerCase(),r=0;r<n.$EP.get_$B();r++)if(n.$EP.get_$3q(r).get_$7B().EmailAddress.toLowerCase()===i)return!0;for(var u=0;u<n.$EN.get_$B();u++)if(n.$EN.get_$3q(u).get_$7B().EmailAddress.toLowerCase()===i)return!0;return n.$nw.$5A.$14.get_$1l().EmailAddress.toLowerCase()===i?!0:!!n.$17R.get_$BD()&&n.$17R.get_$BD().EmailAddress.toLowerCase()===i}function $4ji(n,t){for(var i=0;i<t.$1T.get_$B();i++){var r=t.$1T.get_$3q(i);var u=t.$77.get_$3q(i).EmailAddress;n.$1ML[u]=r}}function $4jk(n,t,i){i=i.toLowerCase();var u=this;var r=t.$1T.$DY(function(n){return i===n.$5A.$14.get_$1l().EmailAddress.toLowerCase()});if(r<t.$1T.get_$B()){t.$3KX(t.$1T.get_$3q(r).$5A);return!0}return!1}_d.$7C.prototype={$2zt:!1,$2r:null,$EP:null,$EN:null,$6Q:null,$2Pb:!1,$27U:null,$25X:null,$17R:null,$nw:null,$zp:null,$b9:null,$gb:null,$1ML:null,$3Ok:!1,$3Kr:null,$3Gq:null,$3Kq:null,$3Gp:null,get_$9cU:function(){return this.$b9},set_$9cU:function(n){this.$b9=n;$3(this,"RequiredAttendeeRecipientWellViewModel");return n},get_$9SF:function(){return this.$gb},set_$9SF:function(n){this.$gb=n;$3(this,"OptionalAttendeeRecipientWellViewModel");return n},get_$6Wa:function(){return this.$3Ok},set_$6Wa:function(n){if(this.$3Ok!==n){this.$3Ok=n;$3(this,"ShowOptionalRecipientWell")}return n},get_$9cY:function(){return this.$3Kr},set_$9cY:function(n){if(this.$3Kr!==n){this.$3Kr=n;$3(this,"RequiredCountLabel")}return n},get_$9SJ:function(){return this.$3Gq},set_$9SJ:function(n){if(this.$3Gq!==n){this.$3Gq=n;$3(this,"OptionalCountLabel")}return n},get_$9cX:function(){return this.$3Kq},set_$9cX:function(n){if(this.$3Kq!==n){this.$3Kq=n;$3(this,"RequiredConflictsLabel")}return n},get_$9SI:function(){return this.$3Gp},set_$9SI:function(n){if(this.$3Gp!==n){this.$3Gp=n;$3(this,"OptionalConflictsLabel")}return n},$Au:function(){if(!$6(this.$b9)){this.$b9.$77.remove_$1Z(this.$$d_$3G5);this.$gb.$77.remove_$1Z(this.$$d_$6Cu);$4jl(this,this.$b9);$4jl(this,this.$gb)}this.$1ML={};this.$27U.$1r();this.$25X.$1r();this.set_$9cU($4jf(this,this.$EP,this.$27U));this.set_$9SF($4jf(this,this.$EN,this.$25X));if(this.$2zt){$4jg(this,this.$b9.$1T);$4jg(this,this.$gb.$1T)}$4jj(this,this.$b9,0);$4jj(this,this.$gb,1);this.$b9.$77.add_$1Z(this.$$d_$3G5);this.$gb.$77.add_$1Z(this.$$d_$6Cu);this.set_$6Wa(this.$gb.$1T.get_$B()>0);$4ji(this,this.$b9);$4ji(this,this.$gb);$4jn(this,{},!1);this.$17R.apcl("selectedRoomEmailAddress",this.$$d_$9Nh)},$55n:function(n,t){var f=n;for(var e in f){var o={key:e,value:f[e]};var r=this.$1ML[o.key];if(!$6(r)){var s=r.$5A;var u=o.value;r.set_$6V(u.get_$6V());s.$KW(1,this.$5P2(u),0);s.set_$5LN(_h.$Mv.$5SN(u.$Oz))}}if(!$6(this.$nw)){var i=n[this.$nw.$5A.$14.get_$1l().EmailAddress];if(!$6(i)){this.$nw.set_$6V(i.get_$6V());this.$nw.$5A.$KW(1,this.$5P2(i),0);this.$nw.$5A.set_$5LN(_h.$Mv.$5SN(i.$Oz))}}$4jn(this,n,t)},$5P2:function(n){var t=n.$qE;_js.$9.$a(n.$2HJ)||n.$2HJ===t||(t+=String.format(_nbs.NonBootStrings.l_SchedulingConflictingMeetings_Text,n.$2HJ));return t},$4KH:function(n,t){var i=n.get_$Wh();$6(i)||$6oT(this,i)},$68k:function(n,t){var i=n;i.$u("AttendeeType",this.$$d_$68k);var r=this.$zp.$2pi(i.get_$1s(),this.$b9.$1Sd,!0,i.$ZP);r.$Y("AttendeeType",this.$$d_$68k);if(r.$ZP){this.$b9.$3KX(i);this.$gb.$1Jl(r)}else{this.$gb.$3KX(i);this.$b9.$1Jl(r)}},$3G5:function(n,t){$4jh(this,t,this.$b9,this.$EP,this.$27U)},$6Cu:function(n,t){$4jh(this,t,this.$gb,this.$EN,this.$25X)},$9Nh:function(n,t){this.$17R.get_$BD()&&($4jk(this,this.$b9,this.$17R.get_$BD().EmailAddress)||$4jk(this,this.$gb,this.$17R.get_$BD().EmailAddress))}};_d.$KD=function(n){this.$$d_$9LA=Function.createDelegate(this,this.$9LA);this.$$d_$9PR=Function.createDelegate(this,this.$9PR);_d.$KD.initializeBase(this);this.$kY=n;this.$kY.$Y("ShowSelectionPeek",this.$$d_$9PR);this.$Y("IsShown",this.$$d_$9LA)};function $6xA(n){var i=n.$kY.$26a;var r=n.$kY.$5PS();var t=$6x6(n,i,r);n.$5K2=_d.$GQ.$2wh(i.$2Q,i.$3D);n.$6Nu=_d.$F1.$5Fb(r.get_$B());n.$5Cd=_d.$F1.$3k0(t.get_$B(),!n.$kY.$2Pb&&!n.$kY.get_$3vj());n.$4dd=null;n.$3uv=null;if(t.get_$B()>0){n.$4dd=$6x8(n,t);t.get_$B()-4>0&&(n.$3uv=$6x7(n,t.get_$B()-4))}}function $6x7(n,t){switch(t){case 1:return _nbs.NonBootStrings.l_OneAdditionalConflict_Text;default:return _js.$9.$4R(_nbs.NonBootStrings.l_AdditionalConflicts_Text,t)}}function $6x6(n,t,i){var r=n.$kY.$Nw.$2Lr(t.$2Q,t.$3D,_g.$2L.$9vt(i),!0);return _d.$F1.$5Py(r)}function $6x8(n,t){for(var u=new _js.$Z,r,i=0;i<t.get_$B()&&i<4;i++){r=t.get_$3q(i);$6x9(n,r);u.$D(r)}return u}function $6x9(n,t){if(n.$kY.$Nw.get_$28M()&&_a.$3N.$My(n.$kY.$Nw.get_$28M().EmailAddress)===_a.$3N.$My(t.$Ao))t.$7i=n.$kY.$9w.get_$HE()?n.$kY.$9w.get_$HE().Name:n.$kY.$9w.get_$97R().Name;else{var i;i=n.$kY.get_$3PZ()[t.$Ao];$6(i)||(t.$7i=i.Name)}}_d.$KD.prototype={$kY:null,$6Nu:null,$5Cd:null,$5K2:null,$4dd:null,$3uv:null,$2y:!1,get_$1O:function(){return this.$2y},set_$1O:function(n){if(this.$2y!==n){this.$2y=n;this.$2y;$3(this,"IsShown")}return n},get_$5jl:function(){return 400},get_$yg:function(){return 330},get_$5aP:function(){return!!this.$kY.$26a},$9PR:function(n,t){this.get_$5aP()&&n.$2d2?this.set_$1O(!0):this.set_$1O(!1)},$9LA:function(n,t){this.$2y&&$6xA(this)}};_d.$zh=function(n,t,i,r,u,f){_d.$zh.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$zh.initializeBase(this);this.$2Q=$6(i)?null:i.$3p();this.$3D=$6(r)?null:r.$3p();this.$mM=n;this.$6HY=t;this.$54=_g.$3Y.$11t("");this.$1y1=u;this.$31r=f};_d.$zh.prototype={$54:null,$6HY:0,$2Q:null,$3D:null,$mM:"Free",$1y1:!1,$31r:!1,get_$AW:function(){return this.$31r},get_$1cZ:function(){return this.$1y1},get_$i:function(){return null},get_$y:function(){return this.$2Q},get_$F5:function(){return!1},get_$1u:function(){return this.$3D},get_$2i:function(){return""},get_$9S:function(){return this.$mM},get_$5V:function(){return!1},get_$8A7:function(){switch(this.$mM){case"Tentative":case"Busy":case"OOF":return!1;default:return!0}},get_$5k:function(){return null},get_$mw:function(){return""},get_$4j:function(){return this.$54},get_$43h:function(){return!1},get_$I2:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingConflictViewModel");},get_$eh:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingConflictViewModel");}};_d.$LE=function(n,t,i,r,u,f,e,o){this.$$d_$u3=Function.createDelegate(this,this.$u3);this.$$d_$9vZ=Function.createDelegate(this,this.$9vZ);_d.$LE.initializeBase(this,[n,t,i,u,f,e,!1,null,o]);this.$ZP=r;this.$1m2=new _0365m.$m(_nbs.NonBootStrings.l_MarkAsOptional_Text,null,new _C(this.$$d_$9vZ,_a.$0.$EQ));this.$1m2.set_$q(!this.get_$59S());this.$1m2.$Pn.set_$5u(this.get_$59S());var s=this;this.$3OT=new _0365m.$m(_nbs.NonBootStrings.l_ShowError_Text,null,new _C(this.$$d_$u3,_a.$0.$EQ,this,"CanShowError",function(){return s.get_$2o4()}));this.$3OT.set_$q(!0);$3XO(this);Array.add(this.$i2,this.$1m2);Array.add(this.$i2,this.$3OT);this.$1z=new _y.$4c};function $3XO(n){n.$1m2.set_$1P(n.$ZP?_nbs.NonBootStrings.l_MarkAsRequired_Text:_nbs.NonBootStrings.l_MarkAsOptional_Text)}function $4o1(n,t){var i=t.get_$1l().EmailAddress;return!!i&&i.startsWith("@")}_d.$LE.prototype={$1m2:null,$3OT:null,$1z:null,$ZP:0,$2KC:null,get_$2o4:function(){return!$6(this.$2KC)&&!$4o1(this,this.get_$1s())},get_$5LN:function(){return this.$2KC},set_$5LN:function(n){if(this.$2KC!==n){var t=this.get_$2o4();this.$2KC=n;if(t!==this.get_$2o4()){$3(this,"CanShowError");this.$3OT.set_$q(!this.get_$2o4())}}return n},get_$19v:function(){return this.$ZP},set_$19v:function(n){if(this.$ZP!==n){this.$ZP=n;$3XO(this);$3(this,"AttendeeType")}return n},get_$59S:function(){return!this.$ZP||this.$ZP===1},$7ip:function(){this.$1m2.set_$q(!0);this.$1m2.$Pn.set_$5u(!1)},$2Lx:function(){var n=_y.$w.prototype.$2Lx.call(this);if($4o1(this,n)){n=_pc.$i.$DQ(_0365f.$2t.$3p(n.get_$1l(),!0,!0));n.get_$1l().EmailAddress=null}return n},$9vZ:function(){this.set_$19v(this.$ZP?0:1);$3XO(this)},$u3:function(){this.$1z.$32(0,this.$2KC,null,!1)}};_d.$YT=function(n,t,i,r){_d.$YT.initializeBase(this,[n,t,i,r]);this.$1YC=n;this.$C=t};_d.$YT.prototype={$C:null,$1YC:null,$lx:function(n,t,i,r){return this.$2pi(n,t,i,0,r)},$2pi:function(n,t,i,r,u){return new _d.$LE(n,t,i,r,u,this.$1YC,this.$C,this.$1J)}};_d.$3Z=function(n,t){_d.$3Z.initializeBase(this,[n]);if(!$6(t)){this.set_$p7(t.$SD);this.set_$5LZ(t.$9l.get_$y());this.set_$5LW(t.$9l.get_$1u());this.set_$f8(t.$9l.$f7);this.set_$3py(new _js.$Z);this.get_$3py().$69(t.$OC.$6Z());this.set_$3px(new _js.$Z);this.get_$3px().$69(t.$fA.$6Z());this.set_$4Lf(new _js.$Z);this.get_$4Lf().$69(t.$1G8.$6Z());this.set_$4Le(new _js.$Z);this.get_$4Le().$69(t.$2Xw.$6Z());this.set_$4Lc(new _js.$Z);this.get_$4Lc().$69(t.$2Xu.$6Z());this.set_$6Rk(t.$9w.get_$HE());this.set_$6Ri(t.$9w.get_$BD());this.set_$5ZU(t.$9w.get_$1WO())}};_d.$3Z.$$cctor=function(){_d.$3Z.$2ta.set_$Gu(new _a.$EC(_g.$3i));_d.$3Z.$2tZ.set_$Gu(new _a.$EC(_g.$3i));_d.$3Z.$3H3.set_$Gu(new _a.$EC(_g.$3i));_d.$3Z.$3H2.set_$Gu(new _a.$EC(_g.$3i));_d.$3Z.$3H1.set_$Gu(new _a.$EC(_g.$3i))};_d.$3Z.prototype={get_$5LZ:function(){return this.$U(_d.$3Z.$3pz)},set_$5LZ:function(n){this.$K(_d.$3Z.$3pz,n);return n},get_$5LW:function(){return this.$U(_d.$3Z.$3pt)},set_$5LW:function(n){this.$K(_d.$3Z.$3pt,n);return n},get_$f8:function(){return this.$U(_d.$3Z.$3ol)},set_$f8:function(n){this.$K(_d.$3Z.$3ol,n);return n},get_$p7:function(){return this.$U(_d.$3Z.$4dS)},set_$p7:function(n){this.$K(_d.$3Z.$4dS,n);return n},get_$3py:function(){return this.$U(_d.$3Z.$2ta)},set_$3py:function(n){this.$K(_d.$3Z.$2ta,n);return n},get_$3px:function(){return this.$U(_d.$3Z.$2tZ)},set_$3px:function(n){this.$K(_d.$3Z.$2tZ,n);return n},get_$4Lf:function(){return this.$U(_d.$3Z.$3H3)},set_$4Lf:function(n){this.$K(_d.$3Z.$3H3,n);return n},get_$4Le:function(){return this.$U(_d.$3Z.$3H2)},set_$4Le:function(n){this.$K(_d.$3Z.$3H2,n);return n},get_$4Lc:function(){return this.$U(_d.$3Z.$3H1)},set_$4Lc:function(n){this.$K(_d.$3Z.$3H1,n);return n},get_$6Rk:function(){return this.$U(_d.$3Z.$4Ta)},set_$6Rk:function(n){this.$K(_d.$3Z.$4Ta,n);return n},get_$6Ri:function(){return this.$U(_d.$3Z.$4Tb)},set_$6Ri:function(n){this.$K(_d.$3Z.$4Tb,n);return n},get_$5ZU:function(){return this.$U(_d.$3Z.$3zD)},set_$5ZU:function(n){this.$K(_d.$3Z.$3zD,n);return n},$5Dp:function(n){n.set_$p7(this.get_$p7());n.$9l.set_$f8(this.get_$f8());n.$9l.set_$y(this.get_$5LZ());n.$9l.$1XN&&n.$9l.set_$1u(this.get_$5LW());n.$OC.$69(this.get_$3py().$6Z());n.$fA.$69(this.get_$3px().$6Z());n.$1G8.$69(this.get_$4Lf().$6Z());n.$2Xw.$69(this.get_$4Le().$6Z());n.$2Xu.$69(this.get_$4Lc().$6Z());n.$9w.set_$HE(this.get_$6Rk());n.$9w.set_$BD(this.get_$6Ri());n.$9w.set_$1WO(this.get_$5ZU())}};_d.$6a=function(n,t,i,r,u,f,e,o,s){this.$$d_$9PQ=Function.createDelegate(this,this.$9PQ);this.$$d_$25J=Function.createDelegate(this,this.$25J);this.$$d_$3G5=Function.createDelegate(this,this.$3G5);this.$$d_$9PS=Function.createDelegate(this,this.$9PS);this.$$d_$9MN=Function.createDelegate(this,this.$9MN);this.$$d_$9OZ=Function.createDelegate(this,this.$9OZ);this.$$d_$6Dv=Function.createDelegate(this,this.$6Dv);_d.$6a.initializeBase(this);this.$4aV=n;this.$o=t;this.$7kb=f;this.$4Ve=o;this.$2Pb=s;this.$3om=i;this.$Nw=r;this.$9w=u;this.$1z=e;this.$2Xw=new(_a.$1s.$$(_g.$3i,_g.$8x));this.$2Xu=new(_a.$1s.$$(_g.$3i,_g.$8x));this.$1G8=new(_a.$1s.$$(_g.$3i,_g.$8x));this.$OC=new(_a.$1s.$$(_g.$3i,_g.$8x));this.$fA=new(_a.$1s.$$(_g.$3i,_g.$8x));this.$9l=new _d.$E5(new _c.$zl(this.$o.$t.get_$y(),this.$o.$t.get_$1u(),this.$o.$t.get_$5V()));this.$9l.$Y("Start",this.$$d_$6Dv);this.$9l.$Y("End",this.$$d_$6Dv);this.$9l.$Y("CorrectedDateRange",this.$$d_$9OZ);this.$Y("PreviewDateRange",this.$$d_$9MN);this.$Y("ShowSelectionPreview",this.$$d_$9PS);this.set_$p7(this.$o.$t.get_$y().$4F());this.set_$29a(!this.$9l.get_$5V());this.$32C=!0};_d.$6a.$5P3=function(n){if(_js.$9.$a(n.EmailAddress)){n=_0365f.$2t.$3p(n,!0,!0);n.EmailAddress=n.ItemId&&!_js.$9.$a(n.ItemId.Id)?"@"+n.ItemId.Id:String.format("{0}{1}{2}","@",n.Name,n.MailboxType)}return n};_d.$6a.$9rM=function(n,t){var u={};_d.$6a.$3KK(u,n);for(var r=0;r<t.get_$B();r++)var e=t.get_$3q(r).get_$7B().EmailAddress;for(var i=0;i<t.get_$B();i++){var f=u[t.get_$3q(i).get_$7B().EmailAddress.toLowerCase()];if(f)n.$34(f);else{t.$68(i);i--}}};_d.$6a.$7rk=function(n,t,i,r){_d.$6a.$3sJ(t);_d.$6a.$3sJ(i);_d.$6a.$3sJ(n);var u={};u[r.EmailAddress.toLowerCase()]=r;_d.$6a.$3KK(u,n);_d.$6a.$3KK(u,t);_d.$6a.$3KK(u,i)};_d.$6a.$3KK=function(n,t){for(var i=0;i<t.get_$B();i++){var u=t.get_$3q(i);var r=u.get_$7B().EmailAddress.toLowerCase();if(n[r]){_js.Trace.logInfo(_a.$0.$EQ,"SchedulingContext: Removing duplicated entry {0}",r);t.$68(i);i--}else n[r]=u}};_d.$6a.$3sJ=function(n){for(var t=0;t<n.get_$B();t++)_js.$9.$a(n.get_$3q(t).get_$7B().EmailAddress)&&n.set_$3q(t,_g.$3i.$wR(_d.$6a.$5P3(n.get_$3q(t).get_$7B())))};_d.$6a.$3i3=function(n){for(var t=0;t<n.get_$B();t++){var i=n.get_$3q(t);i.get_$7B().EmailAddress.startsWith("@")&&(i.get_$7B().EmailAddress=null)}};_d.$6a.$2F4=function(n,t){if(n===t)return!0;if(!n||!t||n.get_$B()!==t.get_$B())return!1;for(var i=0;i<n.get_$B();i++)if(!(_0365f.$2t.$4N(t.get_$3q(i).get_$7B().ItemId,n.get_$3q(i).get_$7B().ItemId)&&t.get_$3q(i).get_$7B().EmailAddress===n.get_$3q(i).get_$7B().EmailAddress))return!1;return!0};function $6xB(n){for(var r=n.$5PS(),u={},t=0;t<r.get_$B();t++){var i=r.get_$3q(t);$6(i)||(u[i.EmailAddress]=i)}return u}function $4nt(n){n.$4aV.$3h1();n.$2d3&&n.$32C&&n.$4aV.$1w(n.$$d_$9PQ,400,_a.$0.$EQ)}function $6xD(n){var t=n.$3om;var i=n.$9l;return t.get_$y()!==i.get_$y()||t.get_$1u()!==i.get_$1u()||t.get_$DS()!==i.get_$DS()||t.$f7!==i.$f7}function $6xC(n){return!_d.$6a.$2F4(n.$2Xw,n.$OC)||!_d.$6a.$2F4(n.$2Xu,n.$fA)}function $6xE(n){return!n.$1G8.get_$B()&&n.$9w.get_$BD()?!0:n.$1G8.get_$B()>0&&!n.$9w.get_$BD()?!0:n.$1G8.get_$B()>0&&!!n.$9w.get_$BD()&&n.$1G8.get_$3q(0).get_$7B().EmailAddress!==n.$9w.get_$BD().EmailAddress}_d.$6a.prototype={$4aV:null,$o:null,$Nw:null,$9w:null,$7kb:0,$OC:null,$fA:null,$1G8:null,$3om:null,$2Pb:!1,$1z:null,$9l:null,$SD:null,$26a:null,$2d3:!1,$32C:!1,$4Ve:!1,$2d2:!1,$4XI:null,$2Xw:null,$2Xu:null,get_$p7:function(){return this.$SD},set_$p7:function(n){if($6(n))throw Error.argumentNull("ViewStartDate");if(n.$3j2())throw Error.argument("ViewStartDate","value should not contain time part.");if(!_a.$7.$4N(this.$SD,n)){this.$SD=n;this.$Nw.set_$Lk(this.$SD);$3(this,"ViewStartDate")}return n},get_$2tb:function(){return this.$o.$t.get_$2i()},get_$1Zm:function(){return this.$o.$t.get_$FE().Mailbox},get_$1ww:function(){return $6xD(this)||$6xE(this)||$6xC(this)},get_$1cH:function(){return!this.get_$W2()},get_$2nn:function(){return!this.get_$W2()},get_$6K1:function(){return this.$26a},set_$6K1:function(n){if($6(n))throw Error.argumentNull("PreviewDateRange");if(!_a.$7.$4N(this.$26a,n)){this.$26a=n;$3(this,"PreviewDateRange")}return n},get_$29a:function(){return this.$2d3},set_$29a:function(n){if(this.$2d3!==n){this.$2d3=n;$3(this,"ShowSelectionPreview")}return n},get_$4Wq:function(){return this.$2d2},set_$4Wq:function(n){if(this.$2d2!==n){this.$2d2=n;$3(this,"ShowSelectionPeek")}return n},get_$3PZ:function(){if(!this.$4XI){this.$4XI=$6xB(this);this.$OC.add_$1Z(this.$$d_$3G5);this.$9w.apcl("SelectedRoomViewModel",this.$$d_$25J)}return this.$4XI},get_$3vj:function(){return!_a.$7.$4N(this.$o.$t.get_$y(),this.$9l.get_$y())||!_a.$7.$4N(this.$o.$t.get_$1u(),this.$9l.get_$1u())},get_$y:function(){return this.$9l.get_$y()},get_$1u:function(){return this.$9l.get_$1u()},get_$LT:function(){return this.$o.$t.get_$LT()},get_$Pk:function(){return this.$o.$t.get_$Pk()},get_$W2:function(){return!_d.$IH.isInstanceOfType(this.$o.$E5.get_$Hi())},$7ad:function(){if(this.$4Ve){this.$4Ve=!1;var t;var i;var n;t=this.$o.$t.get_$7S()?this.$o.$t.get_$7S().$3p():new(_a.$1s.$$(_g.$3i,_g.$8x));i=this.$o.$t.get_$8W()?this.$o.$t.get_$8W().$3p():new(_a.$1s.$$(_g.$3i,_g.$8x));n=this.$o.$t.get_$9F()?this.$o.$t.get_$9F().$3p():new(_a.$1s.$$(_g.$3i,_g.$8x));_d.$6a.$7rk(n,t,i,this.$o.$t.get_$FE().Mailbox);if(n.get_$B()>0){this.$9w.set_$BD(n.get_$3q(0).get_$7B());for(var r=1;r<n.get_$B();r++)t.$D(n.get_$3q(r))}else this.$9w.set_$BD(null);this.$2Xw=t;this.$2Xu=i;this.$OC.$3jd(t);this.$fA.$3jd(i);this.$1G8.$3jd(n);this.set_$p7(this.$o.$t.get_$y().$4F());this.set_$29a(!this.$9l.get_$5V())}},$55q:function(){this.$3om.$6dj(this.$9l.get_$y(),this.$9l.get_$DS(),this.$9l.get_$5V())},$55p:function(){var t=this.$OC.$3p();var n=this.$1G8.$3p();var i=this.$fA.$3p();_d.$6a.$9rM(t,n);this.$9w.get_$BD()&&!this.$9w.get_$9gi()&&n.$72(0,_g.$3i.$wR(this.$9w.get_$BD()));_d.$6a.$3i3(t);_d.$6a.$3i3(i);_d.$6a.$3i3(n);_d.$6a.$2F4(t,this.$o.$t.get_$7S())||this.$o.$t.set_$7S(t);_d.$6a.$2F4(i,this.$o.$t.get_$8W())||this.$o.$t.set_$8W(i);_d.$6a.$2F4(n,this.$o.$t.get_$9F())||this.$o.$t.set_$9F(n)},$5PS:function(){var n=new(_a.$3X.$$(_g.$1l));n.$D(this.get_$1Zm());for(var t=0;t<this.$OC.get_$B();t++)n.$D(this.$OC.get_$3q(t).get_$7B());this.$9w.get_$BD()&&n.$D(this.$9w.get_$BD());return n},$3t4:function(n){var t=new(_a.$3X.$$(String));t.$D(this.get_$1Zm().EmailAddress);for(var i=0;i<this.$OC.get_$B();i++)t.$D(this.$OC.get_$3q(i).get_$7B().EmailAddress);for(var r=0;r<this.$fA.get_$B();r++)t.$D(this.$fA.get_$3q(r).get_$7B().EmailAddress);for(var f=this.$9w.$3t4(n),u=0;u<f.get_$B();u++)t.$D(f.get_$3q(u));return t},$25J:function(n,t){this.$9w.get_$BD()&&(this.get_$3PZ()[this.$9w.get_$BD().EmailAddress]=this.$9w.get_$BD())},$3G5:function(n,t){var i;switch(t.$2v){case 0:for(var r=t.$2l.length-1;r>=0;r--){i=t.$2l[r].get_$7B();this.get_$3PZ()[i.EmailAddress]=i}break;case 2:for(var u=t.$38.length-1;u>=0;u--){i=t.$38[u].get_$7B();delete this.get_$3PZ()[i.EmailAddress]}break;default:break}},$6Dv:function(n,t){var i=this.$9l.get_$y().$4F();this.$Nw.set_$5kG(i);this.set_$p7(i)},$9OZ:function(n,t){this.$9w.set_$bG(this.$9l.$pv.$3p());this.set_$29a(!1)},$9MN:function(n,t){this.set_$29a(!this.$9l.get_$5V());this.set_$4Wq(!1);$4nt(this)},$9PS:function(n,t){this.set_$4Wq(!1);$4nt(this)},$9PQ:function(){this.set_$4Wq(!this.$9l.get_$5V())}};_d.$4g=function(n,t){this.$$d_$4Jm=Function.createDelegate(this,this.$4Jm);this.$$d_$25J=Function.createDelegate(this,this.$25J);this.$$d_$6Cu=Function.createDelegate(this,this.$6Cu);this.$$d_$3G5=Function.createDelegate(this,this.$3G5);this.$$d_$4L0=Function.createDelegate(this,this.$4L0);this.$$d_$6B9=Function.createDelegate(this,this.$6B9);this.$$d_$6BA=Function.createDelegate(this,this.$6BA);this.$2m2={};_d.$4g.initializeBase(this,[n.$9l.get_$y(),null,null,null,t]);_a.$4.$J(t,"calendarContext");this.$d=n;this.$kF=new _js.$Z;this.$lY=new _js.$Z;this.$1xh=this.$1h.$C.get_$L()==="Mouse";this.set_$3lJ(new _d.$Fp([n.$9l.get_$y()],this.$CZ,this.$kF,t.$2U,this.$1h.$c));this.$Y("GridSelectedRowColumnIndex",this.$$d_$6BA);this.$1xh&&this.$Y("GridHoveredRowColumnIndex",this.$$d_$6B9);this.$1R4=!0;this.$vz=!0;this.$d.$Y("ViewStartDate",this.$$d_$4L0);this.$d.$OC.add_$1Z(this.$$d_$3G5);this.$d.$fA.add_$1Z(this.$$d_$6Cu);this.$d.$9w.apcl("SelectedRoomViewModel",this.$$d_$25J);this.$d.$Nw.add_$2wn(this.$$d_$4Jm)};function $6xF(n){n.set_$BJ(n.$d.$SD);$1ni(n,0,_g.$3i.$wR(n.$d.get_$1Zm()),!0);for(var t=0;t<n.$d.$OC.get_$B();t++)$1ni(n,t+1,n.$d.$OC.get_$3q(t),!1);for(var i=0;i<n.$d.$fA.get_$B();i++)$1ni(n,i+1+n.$d.$OC.get_$B(),n.$d.$fA.get_$3q(i),!1);if(n.$d.$9w.get_$BD()){n.$Lj=n.$d.$9w.get_$BD();$1ni(n,n.$kF.get_$B(),_g.$3i.$wR(n.$Lj),!1)}}function $1ni(n,t,i,r){var f=i.get_$7B().EmailAddress;var e=_js.$9.$a(i.get_$7B().Name)?f:i.get_$7B().Name;var u=new _g.$9G;u.set_$Bd(e);u.set_$D2(f);u.set_$i(new _g.$1q(f));u.set_$1K6(r?_d.$4g.$6Fc:_d.$4g.$575);u.set_$rL(!0);n.$kF.$72(t,u);n.$lY.$72(t,new _d.$QN(u,null,null,null,n.$1h.$CS));$3XM(n,new _d.$4g.$3eD(n.$1BB,u.get_$D2()))}function $4nx(n,t){var i=n.$kF.get_$3q(t);$4ny(n,i,!0);n.$kF.$68(t);n.$lY.$68(t)}function $3XM(n,t){if($4nu(n,t)){_js.Trace.logInfo(_a.$0.$EQ,"AddItemsForAttendee() Token already exists {0}. ",t.get_$2fN());return}var r=this;var i=function(){$6xH(n,t);var i=null;$1JB(n)&&n.$1BB===t.get_$7gb()&&(i=$4nv(n,t.get_$1l()));if(!i){_js.Trace.logInfo(_a.$0.$EQ,"AddItemsForAttendee() Ignore async calendar add. {0}",t.get_$2fN());return}var f=new(_a.$3X.$$(String));f.$D(i.get_$D2());var e=n.get_$BJ().$4F();var s=n.$d.$Nw.$7xR(e,e.$2o(1),f);var r=s[i.get_$D2()];var o=n.$d.$Nw.$7tY(f)[i.get_$D2()];var h=!$6(o)&&o!=="NoError";if(r)try{n.set_$fn(!0);for(var u=0;u<r.get_$B();u++){r.get_$3q(u).$Bb=i;n.$IX(r.get_$3q(u))}}finally{n.set_$fn(!1)}n.$O8.$5TB(i).set_$82c(h)};$6xG(n,t);n.get_$A1w()?_js.$J.get_$I().$1w(_a.$0.$EQ,"Scheduling",i,0):i()}function $4ny(n,t,i){try{i&&n.set_$fn(!0);_js.Trace.logInfo(_a.$0.$EQ,"Removing calendar items of user: {0} ",t.get_$Bd());for(var f=!1,r=0;r<n.$p.get_$B();r++)if(n.$p.get_$3q(r).$Bb===t){n.$p.$68(r);r--;f=!0}else if(f)break;for(var u=0;u<n.$CZ.get_$B();u++)if(n.$CZ.get_$3q(u).$Bb===t){n.$CZ.$68(u);u--}}finally{i&&n.set_$fn(!1)}}function $4nw(n,t,i){switch(t.$2v){case 0:for(var r=t.$2l.length-1;r>=0;r--){var f=i+t.$4V;$1ni(n,f,t.$2l[r],!1)}break;case 2:for(var u=t.$38.length-1;u>=0;u--){var e=i+t.$4V;$4nx(n,e)}break;default:break}}function $1JB(n){if(n.$vz){n.$1R4=!0;return!1}return!0}function $4nu(n,t){return!!n.$2m2[t.get_$2fN()]}function $6xG(n,t){n.$2m2[t.get_$2fN()]=t}function $6xH(n,t){delete n.$2m2[t.get_$2fN()]}function $4nv(n,t){for(var i=0;i<n.$kF.get_$B();i++)if(n.$kF.get_$3q(i).get_$D2()===t)return n.$kF.get_$3q(i);return null}_d.$4g.prototype={$vz:!1,$1R4:!1,$kF:null,$lY:null,$1xh:!1,$d:null,$1BB:0,$Lj:null,get_$Lh:function(){return this.$d},get_$1B8:function(){return 0},get_$1qN:function(){return 1},get_$1L:function(){return"SchedulingDayViewModel"},get_$3gK:function(){return 24},get_$59n:function(){return this.$d.get_$2nn()},get_$A1w:function(){return!0},$gk:function(){this.$vz=!1;this.$d.$32C=!1;if(this.$1R4){this.$1BB++;this.$27W();this.$kF.$1r();this.$lY.$1r();$6xF(this)}},$GN:function(){_a.$6.$1E(null,"SchedulingAssistant_SwitchToDayView")},$kK:function(){this.$vz=!0;this.$1R4=!1;this.$1BB++},$Uz:function(){},$2vZ:function(n){return $2Cb(this,this.get_$91(),n,0)},$4c:function(){this.$u("GridSelectedRowColumnIndex",this.$$d_$6BA);this.$1xh&&this.$u("GridHoveredRowColumnIndex",this.$$d_$6B9);this.$d.$OC.remove_$1Z(this.$$d_$3G5);this.$d.$fA.remove_$1Z(this.$$d_$6Cu);this.$d.$9w.rpcl("SelectedRoomViewModel",this.$$d_$25J);this.$d.$Nw.remove_$2wn(this.$$d_$4Jm);this.$O8.dispose();_d.$1r.prototype.$4c.call(this)},$7et:function(n,t){return _d.$KE.$7es(n,t)},$4L0:function(n,t){if($1JB(this)){this.set_$BJ(this.$d.$SD);this.$27W();this.$1BB++;for(var i=0;i<this.$kF.get_$B();i++)$3XM(this,new _d.$4g.$3eD(this.$1BB,this.$kF.get_$3q(i).get_$D2()))}},$4Jm:function(n){if($1JB(this))try{for(var t=0;t<n.get_$B();t++){var i=$4nv(this,n.get_$3q(t));if(i){var r=new _d.$4g.$3eD(this.$1BB,i.get_$D2());if(!$4nu(this,r)){this.set_$fn(!0);$4ny(this,i,!1);$3XM(this,r)}}}}finally{this.set_$fn(!1)}},$3G5:function(n,t){$1JB(this)&&$4nw(this,t,1)},$6Cu:function(n,t){$1JB(this)&&$4nw(this,t,this.$d.$OC.get_$B()+1)},$25J:function(n,t){if($1JB(this)){if(this.$Lj){$4nx(this,this.$kF.get_$B()-1);this.$Lj=null}if(this.$d.$9w.get_$BD()){this.$Lj=this.$d.$9w.get_$BD();$1ni(this,this.$kF.get_$B(),_g.$3i.$wR(this.$Lj),!1)}}},$6BA:function(n,t){if($1JB(this)&&this.$PZ)if(this.get_$59n()){var i=$2gz(this,this.get_$BJ(),this.$PZ.$LU);this.$d.$9l.get_$5V()?this.$d.$9l.set_$y(new _a.$7(i.get_$3l(),i.get_$2z(),i.get_$51(),this.$d.$9l.get_$y().get_$DV(),this.$d.$9l.get_$y().get_$GJ(),this.$d.$9l.get_$y().get_$TR(),this.$d.$9l.get_$y().get_$yf())):this.$d.$9l.set_$y(i)}else this.$d.$1z.$32(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$6B9:function(n,t){if($1JB(this))if(this.$1CK){var i=this.$2vZ(this.$1CK);var r=new _h.$4e(i,i.$9K(this.$d.$9l.$3jj));this.$d.set_$6K1(r)}else this.$d.set_$29a(!1)}};_d.$4g.$3eD=function(n,t){this.$1BB=n;this.$Ao=t;this.$6d8=String.format("{0}@{1}",n,t)};_d.$4g.$3eD.prototype={$1BB:0,$Ao:null,$6d8:null,get_$7gb:function(){return this.$1BB},get_$1l:function(){return this.$Ao},get_$2fN:function(){return this.$6d8}};_d.$5d=function(n,t,i,r,u,f){this.$$d_$25J=Function.createDelegate(this,this.$25J);this.$$d_$6Dv=Function.createDelegate(this,this.$6Dv);this.$$d_$9BH=Function.createDelegate(this,this.$9BH);this.$$d_$4Im=Function.createDelegate(this,this.$4Im);this.$$d_$9Qe=Function.createDelegate(this,this.$9Qe);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$55o=Function.createDelegate(this,this.$55o);_d.$5d.initializeBase(this);this.$d=t;this.$pV=new _C(this.$$d_$55o,_d.$5d.$A);this.$EW=new _C(this.$$d_$iF,_d.$5d.$A);this.$11F=i;this.$1pW=new(_a.$3X.$$(String));this.$3cp=r;this.$2Ax=u;this.$5dq=f;n.get_$L()==="TouchNarrow"&&this.set_$7D(_y.$26.$Bg(this,$6xJ(this),null));this.$3cp.$5j();this.$FV=new _0365m.$2b(new Array(0));this.$Kn=new _C(this.$$d_$9Qe,_d.$5d.$A);this.$16Q="OpenSchedulingAssistantForm"};function $6xM(n){n.$d.$7ad();n.$11F.$Au();n.$1pW.$1r()}function $6xI(n){n.$11F.$EP.add_$1Z(n.$$d_$4Im);n.$11F.$EN.add_$1Z(n.$$d_$4Im);n.$d.$Nw.add_$3nU(n.$$d_$9BH);n.$d.$9l.$Y("CorrectedDateRange",n.$$d_$6Dv);n.$d.$9w.apcl("SelectedRoomViewModel",n.$$d_$25J)}function $6xL(n){n.$11F.$EP.remove_$1Z(n.$$d_$4Im);n.$11F.$EN.remove_$1Z(n.$$d_$4Im);n.$d.$Nw.remove_$3nU(n.$$d_$9BH);n.$d.$9l.$u("CorrectedDateRange",n.$$d_$6Dv);n.$d.$9w.rpcl("SelectedRoomViewModel",n.$$d_$25J)}function $6xK(n){$1nj(n,n.$d.get_$1Zm());for(var t=0;t<n.$d.$OC.get_$B();t++){var r=n.$d.$OC.get_$3q(t);$1nj(n,r.get_$7B())}for(var i=0;i<n.$d.$fA.get_$B();i++){var u=n.$d.$fA.get_$3q(i);$1nj(n,u.get_$7B())}if(n.get_$1HE().get_$1b2()){$1nj(n,n.get_$1HE().get_$BD());n.$Lj=n.get_$1HE().get_$BD()}}function $1nj(n,t){n.$1pW.$D(t.EmailAddress)}function $4o0(n,t){n.$1pW.$34(t.EmailAddress)}function $3XN(n,t){if(n.$d.get_$1cH()){var i=n.$d.$9l.$pv;var r=n.$d.$Nw.$2Lr(i.$2Q,i.$3D,t,!1);n.$11F.$55n(r,n.$d.get_$3vj())}$2hj(n)}function $2hj(n){var t=n.$d.$9l.$pv;var i=n.$d.$Nw.$2Lr(t.$2Q,t.$3D,n.$1pW,!1);n.$11F.$55n(i,n.$d.get_$3vj())}function $4nz(n){n.get_$4i().$Bs()}function $6xJ(n){var t=new Array(2);t[0]=new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.$pV);t[1]=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,n.$EW);return t}_d.$5d.prototype={$1pW:null,$d:null,$pV:null,$EW:null,$5dq:!1,$3cp:null,$11F:null,$Kn:null,$FV:null,$Lj:null,$16Q:null,$2Ax:null,get_$1HE:function(){return this.$d.$9w},get_$2tb:function(){return _js.$9.$a(this.$d.get_$2tb())?_nbs.NonBootStrings.l_DefaultEventSubject_Text:this.$d.get_$2tb()},get_$4Sg:function(){return this.$d.$9l},get_$Ld:function(){return 1},get_$6FK:function(){return this.$16Q},set_$6FK:function(n){this.$16Q!==n&&(this.$16Q=n);return n},get_$9vA:function(){return this.$2Ax},set_$9vA:function(n){this.$2Ax&&this.$2Ax.$1Q();this.$2Ax=n;return n},$gk:function(){_y.$1KT.prototype.$gk.call(this);$6xM(this);$6xI(this);$6xK(this);$3XN(this,this.$1pW)},$kK:function(){_y.$1KT.prototype.$kK.call(this);$6xL(this);this.set_$9vA(null)},$GN:function(){_y.$1KT.prototype.$GN.call(this);_a.$6.$1E(null,this.$16Q)},$6Dv:function(n,t){$2hj(this)},$9BH:function(n){$3XN(this,n)},$4Im:function(n,t){if(t.$2v){if(t.$2v===2){var u=this;Array.forEach(t.$38,function(n){var t=n;$4o0(u,t.get_$7B())});$2hj(this)}}else{var i=new(_a.$3X.$$(String));var r=this;Array.forEach(t.$2l,function(n){var t=n;i.$D(t.get_$7B().EmailAddress);$1nj(r,t.get_$7B())});$3XN(this,i)}},$55o:function(){var n=_d.$1Jb.$1k.$Hj.$6Ym(!1);this.$d.$55q();this.$d.$55p();$4nz(this);_d.$1Jb.$1k.$Hj.$2K4(n,null,null,null)},$iF:function(){var n=_d.$1Jb.$1k.$Hj.$6Yn(!1);$4nz(this);_d.$1Jb.$1k.$Hj.$2K4(n,null,null,null)},$9Qe:function(){this.$d.get_$2nn()||this.$d.$1z.$32(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$25J:function(n,t){if(!$6(this.$Lj)){$4o0(this,this.$Lj);this.$Lj=null}if(this.get_$1HE().get_$1b2()){$1nj(this,this.get_$1HE().get_$BD());this.$Lj=this.get_$1HE().get_$BD()}$2hj(this)}};_d.$KE=function(n){_d.$KE.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$KE.initializeBase(this);this.$5N=new _g.$1q(null);this.$2Q=n.get_$y();this.$3D=n.get_$1u();this.$mM=n.get_$9S();this.$2Xx=n.get_$2i();this.$54=$6(n.get_$4j())?_g.$3Y.$11t(""):n.get_$4j();if(_js.$9.$a(this.$2Xx)){var t=new _d.$jA;this.$Z3=t.$36(this.$mM,null)}else this.$Z3=this.$2Xx;n.get_$y()&&n.get_$1u()&&(this.$1y1=n.get_$1cZ())};_d.$KE.$7es=function(n,t){var i=new _d.$KE(n);i.$Bb=n.$Bb;var r=_d.$LU.$5R3(t,n);i.$2Q=r.$2Q;i.$3D=r.$3D;return i};_d.$KE.prototype={$54:null,$Z3:null,$mM:"Free",$2Xx:null,$5N:null,$1y1:!1,$Bb:null,$2Q:null,$3D:null,get_$i:function(){return this.$5N},get_$F5:function(){return!1},get_$AW:function(){return this.$3D.$5z(this.$2Q)>=864e5},get_$1cZ:function(){return this.$1y1},get_$5V:function(){return!1},get_$GC:function(){return!1},get_$1y5:function(){return!1},get_$2Oz:function(){return!1},get_$cg:function(){return!1},get_$G9:function(){return!1},get_$2Xt:function(){return""},get_$4j:function(){return this.$54},get_$y:function(){return this.$2Q},get_$1u:function(){return this.$3D},get_$2i:function(){return this.$Z3},get_$9S:function(){return this.$mM},get_$5k:function(){return this.$Bb},set_$5k:function(n){this.$Bb=n;return n},get_$mw:function(){return""},get_$43h:function(){return!1},get_$I2:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingItemViewModel");},get_$eh:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingItemViewModel");}};_d.$sE=function(n,t,i){_d.$sE.initializeBase(this,[n,t,i]);this.$8J=!1};_d.$sE.prototype={$8J:!1,get_$6V:function(){return this.$8J},set_$6V:function(n){if(this.$8J!==n){this.$8J=n;$3(this,"IsBusy")}return n},get_$6NL:function(){return!this.$5A||!this.$5A.$14?String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$5A.$14.get_$1o())}};_d.$6g=function(n,t,i,r,u,f,e){this.$$d_$5Yi=Function.createDelegate(this,this.$5Yi);this.$$d_$62=Function.createDelegate(this,this.$62);this.$$d_$2p8=Function.createDelegate(this,this.$2p8);this.$$d_$4L0=Function.createDelegate(this,this.$4L0);this.$$d_$9pr=Function.createDelegate(this,this.$9pr);this.$$d_$9ns=Function.createDelegate(this,this.$9ns);this.$$d_$9Zb=Function.createDelegate(this,this.$9Zb);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$55o=Function.createDelegate(this,this.$55o);this.$$d_$5TW=Function.createDelegate(this,this.$5TW);this.$$d_$5TV=Function.createDelegate(this,this.$5TV);_d.$6g.initializeBase(this);_a.$4.$J(t,"calendarContext");this.$d=n;this.$17a=i;this.$1h=t;this.$k=u;this.$2az=new _d.$8c(n,t);this.$2ax=new _d.$4g(n,t);this.$1BI=r;this.$2MJ=new _C(this.$$d_$5TV,_d.$6g.$A);this.$2MK=new _C(this.$$d_$5TW,_d.$6g.$A);this.$pV=new _C(this.$$d_$55o,_d.$6g.$A);this.$EW=new _C(this.$$d_$iF,_d.$6g.$A);this.$4Pu=new _C(this.$$d_$9Zb,_d.$6g.$A);this.$2ch=new _C(this.$$d_$9ns,_a.$0.$EQ);this.$2dA=new _C(this.$$d_$9pr,_a.$0.$EQ);var s=this.$1h.$C;var o=s.get_$L();if(o==="Mouse"){this.$1BI.$pV.set_$OD(this.$$d_$55o);this.$1BI.$EW.set_$OD(this.$$d_$iF)}var h=new _0365m.$m(_nbs.NonBootStrings.l_Scheduling_Affordance_RefreshFreeBusy_Text,null,this.$4Pu);this.$1BI.$FV.$1C.$D(h);if(o!=="Mouse"){this.set_$7D(_y.$26.$Bg(this,$6xP(this),$6xO(this)));o==="TouchWide"&&this.$3w.set_$3hU($6xQ(this))}var c=!!f&&o==="Mouse"&&s.get_$9A();this.$b4=new _d.$Pk(f,c);this.$BW=t.$c.get_$5M();this.$11S=new _js.$Z;this.$11S.$D(this.$2ax);this.$11S.$D(this.$2az);this.$Kp=e;this.$PA=new _js.$Z;this.$PA.$D(new _0365m.$m(_nbs.NonBootStrings.l_Day_LowerCase_Text,null,this.$2ch));this.$PA.$D(new _0365m.$m(_nbs.NonBootStrings.l_Week_LowerCase_Text,null,this.$2dA));this.$d.$Y("ViewStartDate",this.$$d_$4L0);s.add_$Tm(this.$$d_$2p8);this.$16Q="OpenSchedulingAssistantForm"};_d.$6g.$7bh=function(n,t,i,r){var u=new _d.$Fq(n.$5m);u.set_$1r6(t);u.set_$2p9(i);u.set_$O4(r);return u};function $6xU(n){n.$1h.$C.remove_$Tm(n.$$d_$2p8)}function $4o2(n,t){n.$BW.set_$4Sj(t);_h.$2J.$Cq(n.$BW.get_$Te(),n.$k)}function $3XP(n){n.$1It=!0;n.$AV||n.$1Q();n.get_$4i().$Bs()}function $6xP(n){var t=new Array(2);t[0]=new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.$pV);t[1]=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,n.$EW);return t}function $6xQ(n){var t=[];Array.add(t,new _y.$2W(_y.$c.get_$1Yq(),_y.$c.get_$5H4(),_nbs.NonBootStrings.l_Day_LowerCase_Text,n.$2ch));Array.add(t,new _y.$2W(_y.$c.get_$6gR(),_y.$c.get_$6gT(),_nbs.NonBootStrings.l_Week_LowerCase_Text,n.$2dA));return t}function $6xO(n){return[new _y.$2v(_nbs.NonBootStrings.l_Scheduling_Affordance_RefreshFreeBusy_Text,n.$4Pu)]}function $6xR(n,t,i){var r=new _js.$Z;var u=this;r.$D(new _a.$2G(new _C(function(){var t=_d.$1Jb.$1k.$Hj.$6Yn(n.get_$1yM());n.$pr.set_$O4(!1);$3XP(n);i&&i();_d.$1Jb.$1k.$Hj.$2K4(t,null,null,null)},_a.$0.$EQ),_u.Strings.l_ConfirmDialog_Discard_Text,_nbs.NonBootStrings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$1h.$C.get_$L()==="Mouse"&&t){var f=this;r.$D(new _a.$2G(new _C(function(){n.$pr.set_$O4(!1);n.$62();i&&i()},_a.$0.$EQ),_nbs.NonBootStrings.l_ConfirmDialog_Popout_Text,_nbs.NonBootStrings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var e=this;r.$D(new _a.$2G(new _C(function(){n.$pr.set_$O4(!1);n.$1It=!1},_a.$0.$EQ),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return r}function $4o3(n,t,i){n.set_$7ZS(_d.$6g.$7bh(n.$d.$o,_nbs.NonBootStrings.l_Calendar_Scheduling_LeaveSchedulingFormDialog_Title_Text,$6xR(n,t===1,i),!0))}function $6xT(n){return(!n.$pr||!n.$pr.$11q)&&!n.$1It&&$6xS(n)}function $6xS(n){return n.get_$F4()||n.$d.$o.get_$1ww()}function $6xN(n){n.$AV||n.$1Q()}_d.$6g.prototype={$2az:null,$2ax:null,$k:null,$1BI:null,$d:null,$1h:null,$pV:null,$EW:null,$4Pu:null,$2MJ:null,$2MK:null,$BW:null,$b4:null,$Kp:null,$11S:null,$PA:null,$2dA:null,$2ch:null,$17a:null,$e4:0,$pr:null,$1It:!1,$16Q:null,add_$9fQ:function(n){this.$2N("SchedulingChangesApplied",n)},remove_$9fQ:function(n){this.$2P("SchedulingChangesApplied",n)},get_$9gk:function(){return this.$17a.get_$1HV()},get_$5JO:function(){var n=this.$d.$SD;switch(this.$e4){case 1:return n.$2Z(3);case 3:var t=_a.$7.$Ky(n);var i=t.$2o(6);return _a.$7.$2Lo(t,i);default:return""}},get_$Ld:function(){return this.$1h.$C.get_$L()!=="Mouse"?1:0},get_$6FK:function(){return this.$16Q},set_$6FK:function(n){this.$16Q!==n&&(this.$16Q=n);return n},get_$1GW:function(){return new _C(this.$$d_$62,_a.$0.$EQ)},get_$do:function(){return this.$b4.get_$do()},get_$1iT:function(){return 1},get_$2MT:function(){return this.$$d_$5Yi},get_$1lw:function(){return this.$e4},set_$1lw:function(n){if(this.$e4!==n){this.$e4=n;$45(this,"TimeStripMode","DisplayedDateString")}return n},get_$7ZS:function(){return this.$pr},set_$7ZS:function(n){if(this.$pr!==n){this.$pr=n;$3(this,"ConfirmationDialog")}return n},get_$F4:function(){return!this.$1It&&this.$d.get_$1ww()},get_$1yM:function(){return this.$1h.$C.get_$L()==="Mouse"&&!this.get_$do()},$gk:function(){_y.$1KT.prototype.$gk.call(this);this.$1BI.$gk();if(this.$BW.get_$4Sj()===1){this.set_$1lw(1);this.$Kp.$MN(this.$2ax);this.$PA.get_$3q(0).set_$2O(!0)}else{this.set_$1lw(3);this.$Kp.$MN(this.$2az);this.$PA.get_$3q(1).set_$2O(!0)}},$kK:function(){_y.$1KT.prototype.$kK.call(this);this.$1BI.$kK()},$GN:function(){_y.$1KT.prototype.$GN.call(this);_a.$6.$1E(null,this.$16Q)},$5Yi:function(n,t){var i=!0;var r=!i;if(this.$pr&&this.$pr.$11q)return i;if($6xT(this)){$4o3(this,t,n);return i}$6xN(this);return r},$4c:function(){$6xU(this);this.$2ax.$1Q();this.$2az.$1Q();_a.$1.prototype.$4c.call(this)},$2p8:function(n){this.get_$F4()&&_js.$9.$a(n.$1Gf)&&n.$1Jw(_nbs.NonBootStrings.l_Calendar_BrowserWindowUnloadWarning_Text)},$55o:function(){var n=_d.$1Jb.$1k.$Hj.$6Ym(this.get_$1yM());this.$d.$55q();this.$d.$55p();$Dp(this,"SchedulingChangesApplied",this);$3XP(this);_d.$1Jb.$1k.$Hj.$2K4(n,null,null,null)},$iF:function(){this.get_$F4()?$4o3(this,2,null):$3XP(this)},$5TV:function(){this.$e4===1?this.$d.set_$p7(this.$d.$SD.$2o(1)):this.$d.set_$p7(this.$d.$SD.$2o(7))},$5TW:function(){this.$e4===1?this.$d.set_$p7(this.$d.$SD.$2o(-1)):this.$d.set_$p7(this.$d.$SD.$2o(-7))},$9Zb:function(){this.$d.$Nw.$gm()},$9ns:function(){if(this.$e4!==1){_a.$6.$1c(_a.$0.$EQ,"SchedulingAssistant_SwitchToDayView");this.set_$1lw(1);this.$Kp.$MN(this.$2ax);$4o2(this,1);$3(this,"DisplayedDateString");this.$PA.get_$3q(0).set_$2O(!0);this.$PA.get_$3q(1).set_$2O(!1)}},$9pr:function(){if(this.$e4!==3){_a.$6.$1c(_a.$0.$EQ,"SchedulingAssistant_SwitchToWeekView");this.set_$1lw(3);this.$Kp.$MN(this.$2az);$4o2(this,2);$3(this,"DisplayedDateString");this.$PA.get_$3q(0).set_$2O(!1);this.$PA.get_$3q(1).set_$2O(!0)}},$4L0:function(n,t){$3(this,"DisplayedDateString")},$62:function(){var n=_d.$1Jb.$1k.$Hj.$9rV();this.$1It=!0;this.$b4.get_$1GW().$n();_d.$1Jb.$1k.$Hj.$2K4(n,null,null,null)}};_d.$Gs=function(n,t,i,r,u,f,e,o,s){this.$iP=n;this.$54M=f;this.$k=e;this.$3TF=r;this.$27g=u;this.$Wl=t;this.$c=i;this.$4P=o;this.$lZ=s};function $4o4(n,t,i,r,u,f,e,o,s,h){_a.$4.$l(n.$3Ti,"RecipientWellViewModelFactory");_a.$4.$l(n.$zp,"SchedulingPersonaViewModelFactory");_a.$4.$l(s,"parameters should not be null");var a=_cc.$1Q.$5EQ(!0);var g=new _cc.$My(new _js.$Z,null,a,n.$4P);var p=new _d.$Ht(null,null,g,a,null,n.$Wl,n.$c,null,null);var nt=n.$7ro();var l=n.$3TF.$E(t,a);var w=n.$27g.$5EM(t,l);var b=n.$27g.$E(t,l,w);var c=new _d.$6a(new _d.$10e("SchedulingContextViewModel"),t,i,l,b,nt,new _y.$4c,!u,f);l.set_$6QS(c);var v=new _g.$9G;v.set_$rL(!0);v.set_$D2(c.get_$1Zm().EmailAddress);p.set_$11v(v);var tt=n.$7b0(b,w,l);var it=new _d.$7C(c.$OC.get_$A5d(),c.$fA.get_$A5d(),$6xX(n,c),c.$9w,_nbs.NonBootStrings.l_AddAttendeeWatermark_Text,n.$7cR(),n.$3Ti,n.$zp,f,e);var y=null;if(s.get_$2eg()){var rt=new _d.$1EZ(s.get_$2eg());y=new _d.$st(rt,c.$9l);y.$7f=s.get_$6b9()}var k=$6xY(n,c,it,tt,y,o);k.set_$6FK(h);var d=new _d.$6g(c,p,c.$9l,k,n.$k,r,new _y.$FB);d.set_$6FK(h);return d}function $6xW(n){var t=new _g.$1l;t.EmailAddress=n.$c.get_$31().get_$Aj();t.Name=n.$c.get_$31().get_$FS();t.MailboxType="Mailbox";return n.$lZ.$1rL(t)}function $6xV(n,t,i){t.set_$2i(i.get_$7mc());t.set_$y(i.get_$2GB().get_$y());t.set_$1u(i.get_$2GB().get_$1u());t.set_$5V(i.get_$2GB().get_$5V());t.set_$7S(i.get_$7S());t.set_$8W(i.get_$8W());t.set_$9F(i.get_$9F())}function $6xY(n,t,i,r,u,f){return new _d.$5d(n.$Wl,t,i,r,u,f)}function $6xX(n,t){var i=_pc.$i.$DQ(t.get_$1Zm());var r=n.$zp.$2pi(i,_y.$w.$KH,!0,3);return new _d.$sE(r,1,!0)}_d.$Gs.prototype={$Wl:null,$c:null,$iP:null,$3TF:null,$27g:null,$54M:null,$k:null,$4P:null,$zp:null,$JE:null,$3Ti:null,$lZ:null,$E:function(n,t,i,r,u,f){return $4o4(this,n,t,i,r,u,!1,!1,new _c.$zk(n.$t),f)},$7cf:function(n){_a.$4.$l(this.$JE,"CalendarItemViewModelFactory");var t=$6xW(this);$6xV(this,t,n);return $4o4(this,this.$JE.$8A(t),new _d.$E5(n.get_$2GB()),null,!1,!0,!0,!0,n,null)},$7b0:function(n,t,i){return this.$54M.$E(n,t,i)},$7ro:function(){return 1},$7cR:function(){var n=this.$iP.$E(_pc.$14.$wX,_pc.$14.$iZ(),!0,"PersonaDetailedView",!1,this.$zp);_d.$DJ.$1YD(n);return n}};_d.$8c=function(n,t){this.$$d_$6B9=Function.createDelegate(this,this.$6B9);this.$$d_$6BA=Function.createDelegate(this,this.$6BA);this.$$d_$4Jm=Function.createDelegate(this,this.$4Jm);this.$$d_$25J=Function.createDelegate(this,this.$25J);this.$$d_$3G5=Function.createDelegate(this,this.$3G5);this.$$d_$4L0=Function.createDelegate(this,this.$4L0);_d.$8c.resolveInheritance();this.dispose=this.$1Q;_d.$8c.initializeBase(this,[n.$9l.get_$y(),null,null,null,null,t,null]);_a.$4.$J(t,"calendarContext");this.$d=n;this.$1L5=new(_a.$3X.$$(String));this.$5Ce=new _d.$KD(this.$d);this.$1xh=this.$1h.$C.get_$L()==="Mouse";this.$1R4=!0;this.$2r3=!0;this.$d.$Y("ViewStartDate",this.$$d_$4L0);this.$d.$OC.add_$1Z(this.$$d_$3G5);this.$d.$9w.apcl("SelectedRoomViewModel",this.$$d_$25J);this.$d.$Nw.add_$2wn(this.$$d_$4Jm);this.$Y("GridSelectedRowColumnIndex",this.$$d_$6BA);this.$1xh&&this.$Y("GridHoveredRowColumnIndex",this.$$d_$6B9)};function $4o6(n){if(n.$d.$9w.get_$BD()){n.$Lj=n.$d.$9w.get_$BD();n.$1L5.$D(n.$Lj.EmailAddress)}}function $6xZ(n){n.set_$BJ(n.$d.$SD);$4o5(n);n.$1L5.$1r();for(var t=0;t<n.$d.$OC.get_$B();t++)n.$1L5.$D(n.$d.$OC.get_$3q(t).get_$7B().EmailAddress);$4o6(n)}function $1nk(n){_js.Trace.logInfo(_a.$0.$EQ,"WeekView PopulatingItemCollection WeekViewModel");n.$27W();var i=n.$d.$Nw.$7sP(n.$d.get_$1Zm().EmailAddress,n.$1L5);try{n.set_$fn(!0);for(var t=0;t<i.get_$B();t++){var r=i.get_$3q(t);n.$IX(r)}}finally{n.set_$fn(!1)}}function $4o5(n){var t=_a.$7.$Ky(n.$d.$SD.$4F());var i=t.$2o(7);n.$11x=new _h.$4e(t,i)}function $1nl(n){if(n.$2r3){n.$1R4=!0;return!1}return!0}_d.$8c.prototype={$1L5:null,$d:null,$1xh:!1,$5Ce:null,$Lj:null,$2r3:!1,$1R4:!1,$11x:null,get_$Lh:function(){return this.$d},get_$1L:function(){return"SchedulingWeekViewModel"},get_$3gK:function(){return 24},get_$59n:function(){return this.$d.get_$2nn()},get_$BJ:function(){return _d.$1r.prototype.get_$BJ.call(this)},set_$BJ:function(n){_a.$7.$4N(_a.$7.$Ky(this.get_$BJ()).$4F(),_a.$7.$Ky(n).$4F())||_d.$1r.prototype.set_$BJ.call(this,n);return n},$gk:function(){this.$2r3=!1;this.$d.$32C=!0;if(this.$1R4){$6xZ(this);$1nk(this)}},$GN:function(){_a.$6.$1E(null,"SchedulingAssistant_SwitchToWeekView")},$kK:function(){this.$2r3=!0;this.$1R4=!1},$Uz:function(){},$2Xd:function(n,t){_d.$1r.prototype.$2Xd.call(this,n,t);var i=this.$1h.$Cb;var r=this.$1h.$c;if(_g.$Jq.isInstanceOfType(i.get_$5k())){var u=i.get_$5k();if(u.OwnerEmailAddress===r.get_$31().get_$Aj()){var f=this.$1h.$2U.$1NE(i);f.set_$Nk(r.get_$1I().get_$Nl().get_$Nk())}}},$1hc:function(n,t){_d.$1r.prototype.$1hc.call(this,n,t);this.$d.set_$p7(this.$ED.$2Q);this.set_$BJ(this.$d.$SD);var i=_a.$7.$Ky(this.$d.$SD.$4F());var u=i.$2o(7);var r=new _h.$4e(i,u);if(!_a.$7.$4N(r,this.$11x)){this.$11x=r;$1nk(this)}this.$d.$Nw.$9zA(this.$d.$SD)},$4c:function(){this.$O8.dispose();this.$d.$u("ViewStartDate",this.$$d_$4L0);this.$d.$OC.remove_$1Z(this.$$d_$3G5);this.$d.$9w.rpcl("SelectedRoomViewModel",this.$$d_$25J);this.$d.$Nw.remove_$2wn(this.$$d_$4Jm);this.$u("GridSelectedRowColumnIndex",this.$$d_$6BA);this.$1xh&&this.$u("GridHoveredRowColumnIndex",this.$$d_$6B9);_d.$1r.prototype.$4c.call(this)},$3cb:function(n){throw Error.notImplemented();},$IX:function(n){this.$p.$D(n)},$4Jm:function(n){$1nl(this)&&$1nk(this)},$3G5:function(n,t){if($1nl(this)){switch(t.$2v){case 0:for(var i=t.$2l.length-1;i>=0;i--)this.$1L5.$D(t.$2l[i].get_$7B().EmailAddress);break;case 2:for(var r=t.$38.length-1;r>=0;r--)this.$1L5.$34(t.$38[r].get_$7B().EmailAddress);break;default:break}$1nk(this)}},$4L0:function(n,t){if($1nl(this)){this.set_$BJ(this.$d.$SD);if(this.$11x.$lo(this.$d.$SD,!0,!1))_js.Trace.logInfo(_a.$0.$EQ,"Ignoring ViewStart :{0} because it is within the current date range:{1}",this.$d.$SD,this.$11x);else{$4o5(this);$1nk(this)}}},$6BA:function(n,t){if($1nl(this)&&this.$PZ)if(this.get_$59n()){var i=$2Ca(this,this.$PZ.$LU);this.$d.$9l.get_$5V()?this.$d.$9l.set_$y(new _a.$7(i.get_$3l(),i.get_$2z(),i.get_$51(),this.$d.$9l.get_$y().get_$DV(),this.$d.$9l.get_$y().get_$GJ(),this.$d.$9l.get_$y().get_$TR(),this.$d.$9l.get_$y().get_$yf())):this.$d.$9l.set_$y(i)}else this.$d.$1z.$32(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$6B9:function(n,t){if($1nl(this))if(this.$1CK){var i=$2Ca(this,this.$1CK);var r=new _h.$4e(i,i.$9K(this.$d.$9l.$3jj));this.$d.set_$6K1(r)}else this.$d.set_$29a(!1)},$25J:function(n,t){if($1nl(this)){if(this.$Lj){this.$1L5.$34(this.$Lj.EmailAddress);this.$Lj=null}$4o6(this);$1nk(this)}}};_d.$1EZ=function(n){this.$3RA=new(_a.$W.$$(_c.$ss))(n.$6Z())};_d.$1EZ.prototype={$3RA:null,get_$2eg:function(){return this.$3RA}};_d.$st=function(n,t){this.$$d_$9Om=Function.createDelegate(this,this.$9Om);this.$7f="";_d.$st.initializeBase(this);this.$6b7=n;this.$17a=t;this.$17a.add_$3Mc(this.$$d_$9Om)};_d.$st.prototype={$6b7:null,$17a:null,$p:null,$11:null,get_$3T:function(){if(!this.$p){var t=this.$6b7.get_$2eg();this.$p=new(_a.$W.$$(_d.$su));for(var n=0;n<t.get_$B();n++){this.$p.$D(new _d.$su(t.get_$3q(n)));this.$17a.get_$1HV()&&_g.$Vo.$4N(this.$17a.get_$1HV(),t.get_$3q(n).$1KY)&&this.set_$22(this.get_$3T().get_$3q(n))}}return this.$p},get_$22:function(){return this.$11},set_$22:function(n){if(n!==this.$11){this.$11&&this.$11.set_$2O(!1);this.$11=n;if(this.$11){this.$11.set_$2O(!0);this.$17a.remove_$3Mc(this.$$d_$9Om);this.$17a.set_$1HV(this.$11.$2Aw.$1KY);this.$17a.add_$3Mc(this.$$d_$9Om)}$3(this,"SelectedItem")}return n},$4c:function(){this.$17a.remove_$3Mc(this.$$d_$9Om);_a.$1.prototype.$4c.call(this)},$9Om:function(n){for(var i=!1,t=0;t<this.get_$3T().get_$B();t++){var r=this.get_$3T().get_$3q(t).$2Aw;if(_g.$Vo.$4N(r.$1KY,n)){this.set_$22(this.get_$3T().get_$3q(t));i=!0;break}}i||this.set_$22(null)}};_d.$su=function(n){_d.$su.initializeBase(this);this.$2Aw=n};_d.$su.prototype={$2Aw:null,$3G:!1,get_$7Ty:function(){var n=new _d.$9c;n.set_$y(this.$2Aw.$1KY.get_$y());n.set_$1u(this.$2Aw.$1KY.get_$1u());return n},get_$2O:function(){return this.$3G},set_$2O:function(n){if(n!==this.$3G){this.$3G=n;$3(this,"IsSelected")}return n}};_d.$F1=function(n,t,i,r,u,f){_d.$F1.initializeBase(this);this.$138=t;this.$Ao=n;this.$5VA=r;this.$Oz=u;this.$qE=i;this.$ve=f;this.$2HJ=$6y7(this)};_d.$F1.$5Py=function(n){var t=new _js.$Z;var i=n;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.get_$6V()&&t.$D(u.value)}return t};_d.$F1.$3k0=function(n,t){var i=t?_nbs.NonBootStrings.l_ZeroNewConflicts_Text:_nbs.NonBootStrings.l_ZeroConflicts_Text;var r=t?_nbs.NonBootStrings.l_OneNewConflict_Text:_nbs.NonBootStrings.l_OneConflict_Text;var u=t?_nbs.NonBootStrings.l_ManyNewConflicts_Text:_nbs.NonBootStrings.l_ManyConflicts_Text;switch(n){case 0:return i;case 1:return r;default:return String.format(u,n)}};_d.$F1.$5Fb=function(n){return String.format(_a.$8T.$3uJ(n,_nbs.NonBootStrings.l_TotalRequiredAttandees_Singular_Upper_Case_Text,_nbs.NonBootStrings.l_TotalRequiredAttandees_FirstPlural_Upper_Case_Text,_nbs.NonBootStrings.l_TotalRequiredAttandees_SecondGenitivePlural_Upper_Case_Text),n)};_d.$F1.$7fE=function(n){return String.format(_a.$8T.$3uJ(n,_nbs.NonBootStrings.l_TotalOptionalAttandees_Singular_Upper_Case_Text,_nbs.NonBootStrings.l_TotalOptionalAttandees_FirstPlural_Upper_Case_Text,_nbs.NonBootStrings.l_TotalOptionalAttandees_SecondGenitivePlural_Upper_Case_Text),n)};function $6y7(n){var t="";if(n.get_$6V()&&!$6(n.$ve)){var i=n.$ve.get_$B();if(i>1)t=String.format(_nbs.NonBootStrings.l_ConflictStatus_Text,i);else if(i===1){var r=n.$ve.get_$3q(0);$6(r)||_js.$9.$a(r.$2Xx)||(t=r.$2Xx)}}return t}_d.$F1.prototype={$138:"Free",$Ao:null,$qE:null,$2HJ:null,$5VA:!1,$Oz:"NoError",$ve:null,$7i:null,get_$6V:function(){return this.$5VA?!1:_d.$4B.$6V(this.$138)}};_d.$ES=function(n,t,i,r){this.$$d_$6Rj=Function.createDelegate(this,this.$6Rj);this.$$d_$7ny=Function.createDelegate(this,this.$7ny);_d.$ES.initializeBase(this);this.$Nw=n;this.$9w=t;this.$2u9=i;this.$C=r;this.$us=!1;this.$3co="AddRoom_SchedulingAssistant";this.$2Kf=new _C(this.$$d_$7ny,_d.$ES.$A);this.$2Kf.set_$5u(!1);$3Vr(this)};function $4jR(n){n.$9w.apcl("SelectedRoomViewModel",n.$$d_$6Rj)}function $4jS(n){n.$9w.rpcl("SelectedRoomViewModel",n.$$d_$6Rj)}function $3Vr(n){n.set_$7nz(n.$9w.get_$1b2()?_nbs.NonBootStrings.l_ChangeRoomButton_Text:_nbs.NonBootStrings.l_FindRoomButton_Text)}_d.$ES.prototype={$9w:null,$Nw:null,$us:!1,$C:null,$2Kf:null,$2u9:null,$2u8:null,$3co:null,get_$7nz:function(){return this.$2u8},set_$7nz:function(n){if(this.$2u8!==n){this.$2u8=n;$45(this,"FindARoomButtonLabel","HideFindARoomControl")}return n},get_$83n:function(){return this.$C.get_$L()==="TouchNarrow"&&this.$9w.get_$1b2()},$5j:function(){if(!this.$us){this.$6MR();this.$us=!0;this.$2Kf.set_$5u(!0)}},$7H:function(){if(this.$us){this.$4cE();this.$us=!1;this.$2Kf.set_$5u(!1)}},$4c:function(){this.$4cE();_a.$1.prototype.$4c.call(this)},$6MR:function(){$4jR(this)},$4cE:function(){$4jS(this)},$6Rj:function(n,t){$3Vr(this)},$7ny:function(){_a.$6.$1c(_a.$0.$EQ,this.$3co);this.$C.get_$L()==="TouchNarrow"?this.$C.$fC(this.$2u9,0,!1):this.$2u9.set_$16n(!0)}};_d.$hb=function(n,t){this.$2Kg=n;this.$C=t};_d.$hb.prototype={$2Kg:null,$C:null,$E:function(n,t,i){var r=this.$2Kg.$7cg(n,t);return new _d.$ES(i,n,r,this.$C)}};_d.$Fn=function(n,t){this.$$d_$AF=Function.createDelegate(this,this.$AF);this.$$d_$9Z0=Function.createDelegate(this,this.$9Z0);_d.$Fn.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Fn.initializeBase(this);this.$1n=n;this.$5v=t;this.$5p=new Sys.EventHandlerList;this.set_$3Ob(!0);this.$Y("IsDataLoaded",this.$$d_$9Z0);this.$Y("HasErrorOccurred",this.$$d_$9Z0);this.$1jZ=new _C(this.$$d_$AF,_a.$0.$EQ)};function $194(n,t){var i=n.$5p.getHandler("StepCompleted");$6(i)||i(t)}_d.$Fn.prototype={$5v:null,$5p:null,$1jZ:null,$1n:null,$C1:!1,$iv:!1,$1CR:!1,$1Hr:!1,$1m6:0,add_$h5:function(n){this.$5p.addHandler("StepCompleted",n)},remove_$h5:function(n){this.$5p.removeHandler("StepCompleted",n)},get_$1L:function(){return this.$1n},get_$GB:function(){return this.$C1},set_$GB:function(n){if(this.$C1!==n){this.$C1=n;$3(this,"IsActive")}return n},get_$1by:function(){return this.$iv},set_$1by:function(n){if(this.$iv!==n){this.$iv=n;$45(this,"IsDataLoaded","HasNoRoomsFound")}return n},get_$3vu:function(){return this.$iv&&!this.$1m6},get_$3Ob:function(){return this.$1Hr},set_$3Ob:function(n){if(this.$1Hr!==n){this.$1Hr=n;$3(this,"ShowLoadingMessage")}return n},get_$13V:function(){return this.$1CR},set_$13V:function(n){if(this.$1CR!==n){this.$1CR=n;$3(this,"HasErrorOccurred")}return n},get_$6bj:function(){return this.$1m6},set_$6bj:function(n){if(this.$1m6!==n){this.$1m6=n;$45(this,"TotalNumberOfItems","HasNoRoomsFound")}return n},$7lx:function(){this.$3FX();this.set_$GB(!0)},$7nG:function(){this.$3Fa();this.set_$GB(!1)},$9Z0:function(n,t){this.set_$3Ob(!this.$iv&&!this.$1CR)},$AF:function(){this.$3Fa();this.$3FX()}};_d.$GT=function(n,t,i,r){this.$$d_$6OV=Function.createDelegate(this,this.$6OV);this.$$d_$9Px=Function.createDelegate(this,this.$9Px);this.$$d_$4X=Function.createDelegate(this,this.$4X);_d.$GT.initializeBase(this);this.$3Q7={};this.$3Q7[n.get_$1L()]=n;this.$3Q7[t.get_$1L()]=t;this.$A2=n;this.$C=i;this.$TD=!1;this.$3qx=r||"AddRoom_SchedulingAssistant";if(this.$C.get_$L()==="TouchNarrow"){var u=[new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,new _C(this.$$d_$4X,_a.$0.$EQ))];this.set_$7D(_y.$26.$Bg(this,u,null))}};function $6sN(n,t){$6(n.$A2)||$3WT(n);n.set_$3ll(t);$3WS(n)}function $3WS(n){n.$A2.add_$h5(n.$$d_$9Px);n.$A2.add_$7q(n.$$d_$6OV);n.$A2.$7lx();n.$6OV(n,null);_a.$6.$1E(null,n.$3qx)}function $3WT(n){n.$A2.remove_$h5(n.$$d_$9Px);n.$A2.remove_$7q(n.$$d_$6OV);n.$A2.$7nG()}_d.$GT.prototype={$C:null,$3Q7:null,$A2:null,$kS:null,$TD:!1,$3qx:null,get_$16n:function(){return this.$TD},set_$16n:function(n){if(this.$TD===n)return n;this.$TD=n;$3(this,"PopupVisible");this.$TD?$3WS(this):$3WT(this);return n},get_$3ll:function(){return this.$A2},set_$3ll:function(n){if(this.$A2!==n){this.$A2=n;$3(this,"CurrentStep")}return n},get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?1:0},$gk:function(){_y.$1KT.prototype.$gk.call(this);$3WS(this)},$kK:function(){$3WT(this);_y.$1KT.prototype.$kK.call(this)},$GN:function(){_y.$1KT.prototype.$GN.call(this);_a.$6.$1E(null,this.$3qx)},$4X:function(){this.get_$4i().$Bs()},$9Px:function(n){if(_js.$9.$a(n)){this.$C.get_$L()==="TouchNarrow"?this.$4X():this.set_$16n(!1);return}var t=this.$3Q7[n];$6sN(this,t)},$6OV:function(n,t){_a.$4.$l(this.$kS,"ResizeCommand cannot be null.");this.$kS.$n()}};_d.$Ox=function(n,t,i){this.$k=n;this.$BW=t;this.$C=i};function $4lY(n,t){var i=this;return new _d.$Py(n.$k,n.$BW,t,function(){return new _c.$166})}_d.$Ox.prototype={$k:null,$BW:null,$C:null,$7cg:function(n,t){var i=$4lY(this,n);var r=new _d.$MW(n,t);return new _d.$GT(i,r,this.$C,"AddRoom_SchedulingAssistant")},$7cb:function(n,t){var i=$4lY(this,n);var r=new _d.$1C6(n,t);return new _d.$GT(i,r,this.$C,"AddRoom_ComposeForm")}};_d.$IP=function(n,t,i){this.$$d_$2bU=Function.createDelegate(this,this.$2bU);this.$$d_$9ai=Function.createDelegate(this,this.$9ai);this.$$d_$6E1=Function.createDelegate(this,this.$6E1);this.$$d_$4Kh=Function.createDelegate(this,this.$4Kh);this.$$d_$24v=Function.createDelegate(this,this.$24v);_d.$IP.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$IP.initializeBase(this);this.$2Y=n;this.$2Y.add_$2qj(this.$$d_$24v);this.$ER=t;this.$Y("SelectedDateRange",this.$$d_$4Kh);this.$Y("selectedRoomEmailAddress",this.$$d_$6E1);this.$4Qa=new _C(this.$$d_$9ai,_a.$0.$1k);var r=this;this.$4HT=new _C(this.$$d_$2bU,_a.$0.$1k,this,"CanSelectNextAvailableRoom",function(){return r.get_$1XQ()});this.$1RI=new _g.$1l;this.$1RI.Name=_nbs.NonBootStrings.l_GenericRoomListName_Text;this.$1RI.EmailAddress="@noRoomListsAvailableMailbox";this.$8Z=new _0365m.$2b([]);$4nr(this);this.set_$BD(i)};function $4nr(n){n.$8Z.$1C.$1r();n.$8Z.$1C.$D(new _0365m.$m(_nbs.NonBootStrings.l_RemoveRoom_LowerCase_Text,null,n.$4Qa));n.get_$1XQ()&&n.$8Z.$1C.$D(new _0365m.$m(_nbs.NonBootStrings.l_NextAvailableRoom_LowerCase_Text,null,n.$4HT))}function $3XK(n,t){$6x2(n,t);$6x1(n,t);$3(n,"CanSelectNextAvailableRoom")}function $6x1(n,t){if(n.get_$1XQ()){var r=t.get_$6V()?0:1;var i=n.$2Y.get_$qZ().get_$B()-r;i?i===1?t.set_$4Tm(_nbs.NonBootStrings.l_OneAvailableRoom_Text):t.set_$4Tm(String.format(_nbs.NonBootStrings.l_ManyAvailableRooms_Text,i)):t.set_$4Tm("")}}function $6x2(n,t){n.$1RJ?t.set_$5Od(new _d.$F1(n.$Yu.EmailAddress,"Busy",_nbs.NonBootStrings.l_NoRoomsAvailable_Text,!1,"NoError",null)):t.set_$5Od(n.$2Y.$7u5(n.$Yu,n.$ER))}_d.$IP.prototype={$2Y:null,$8Z:null,$4Qa:null,$4HT:null,$1RI:null,$1Ta:null,$3vv:!1,$1p3:!1,$Yu:null,$ER:null,$ts:null,$1RJ:!1,get_$1XQ:function(){if(!this.$2Y.get_$1cH()||!this.$1p3||!this.$2Y.get_$1by())return!1;var n=this.get_$1b2()&&!this.$ts.get_$6V()?1:0;return this.$2Y.get_$qZ().get_$B()-n>0},get_$3jB:function(){return this.$8Z},get_$1b2:function(){return!$6(this.$ts)&&!this.$1RJ},get_$1WO:function(){return this.$1p3},set_$1WO:function(n){if(this.$1p3===n)return n;this.$1p3=n;$3(this,"CanSelectNextAvailableRoom");this.$1RJ=!1;if(this.$1p3){this.$ts=null;if(this.get_$1XQ())this.$2bU();else{this.$1RJ=!0;this.set_$BD(this.$1Ta||this.$1RI);this.$2Y.get_$2mS().set_$28M(this.$Yu)}}else this.$2Y.get_$2mS().set_$28M(null);return n},get_$HE:function(){return this.$1Ta},set_$HE:function(n){if(this.$1Ta!==n||!n&&!this.$3vv){this.$3vv=!0;this.$1Ta=n;this.set_$1WO(!1);$3(this,"selectedRoomListEmailAddress")}return n},get_$BD:function(){return this.$Yu},set_$BD:function(n){if(this.$Yu!==n){this.$Yu=n;$3(this,"selectedRoomEmailAddress")}return n},get_$bG:function(){return this.$ER},set_$bG:function(n){if(this.$ER!==n){this.$ER=n;$3(this,"SelectedDateRange")}return n},get_$3MY:function(){return this.$ts},set_$3MY:function(n){if(this.$ts!==n){this.$ts=n;$3(this,"SelectedRoomViewModel")}return n},get_$97R:function(){return this.$1RI},get_$9gi:function(){return!!this.$Yu&&(_g.$2L.$4e(this.$Yu,this.$1Ta)||_g.$2L.$4e(this.$Yu,this.$1RI))},$3t4:function(n){var t=new(_a.$3X.$$(String));if(this.$Yu){t.$D(this.$Yu.EmailAddress);n=!0}if(this.$2Y.get_$1cH()&&n)for(var r=this.$2Y.get_$9eA(),i=0;i<r.get_$B();i++)t.$D(r.get_$3q(i));return t},$6E1:function(n,t){if($6(this.$Yu)){this.set_$3MY(null);this.set_$1WO(!1)}else{var i=new _d.$zc(this.$Yu,this.$4HT,this.$4Qa);i.set_$3Ob(!this.$2Y.get_$1by());$3XK(this,i);this.set_$3MY(i);$4nr(this)}},$4Kh:function(n,t){this.$3vv&&this.$2Y.$5SH(this.$1Ta,this.$ER);this.get_$1b2()&&$3XK(this,this.$ts);if(this.$1p3&&(this.$ts.get_$6V()||this.$1RJ))if(this.get_$1XQ()){this.$1RJ=!1;this.$2bU();$3(this,"CanSelectNextAvailableRoom")}else{this.$1RJ=!0;this.set_$BD(this.$1Ta||this.$1RI);this.$2Y.get_$2mS().set_$28M(this.$Yu)}},$24v:function(){if(this.get_$1XQ()&&(_g.$2L.$4e(this.$Yu,this.$1Ta)||_g.$2L.$4e(this.$Yu,this.$1RI))){this.$1RJ=!1;this.$2bU()}else if(this.$ts){this.$ts.set_$3Ob(!this.$2Y.get_$1by());$3XK(this,this.$ts);this.$ts.get_$6V()&&this.get_$1XQ()&&this.$2bU()}},$9ai:function(){this.set_$BD(null)},$2bU:function(){var n=this.$2Y.$3tJ(this.$Yu);var t=this.$2Y.get_$qZ();n=(n+1+t.get_$B())%t.get_$B();this.set_$BD(t.get_$3q(n).$Ao);this.$2Y.get_$2mS().set_$28M(this.$Yu)}};_d.$lP=function(n,t){_d.$lP.initializeBase(this);this.$Ao=n;if(t)switch(t.$138){case"Free":this.$qE=_nbs.NonBootStrings.l_FreeRoom_Text;break;case"NoData":this.$qE=_nbs.NonBootStrings.l_NoDataRoom_Text;break;case"Tentative":this.$qE=_nbs.NonBootStrings.l_TentativeRoom_Text;break;case"WorkingElsewhere":this.$qE=_nbs.NonBootStrings.l_WorkingElsewhereRoom_Text;break;case"OOF":this.$qE=_nbs.NonBootStrings.l_AwayRoom_Text;break;default:this.$qE=_nbs.NonBootStrings.l_BusyRoom_Text;break}else this.$qE=""};_d.$lP.prototype={$Ao:null,$qE:null};_d.$Ev=function(n,t,i,r,u){this.$$d_$9GI=Function.createDelegate(this,this.$9GI);this.$$d_$9GL=Function.createDelegate(this,this.$9GL);this.$$d_$9GM=Function.createDelegate(this,this.$9GM);this.$$d_$9Do=Function.createDelegate(this,this.$9Do);_d.$Ev.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Ev.initializeBase(this);this.$k=n;this.$1VD=t;this.$1VD.add_$3nU(this.$$d_$9Do);this.$5SI=i;this.$1q4=new _js.$Z;this.$1uP=new _js.$Z;this.$zm=new(_a.$3X.$$(String));this.$2ka={};this.$ER=r;this.$5Of=new _d.$jA;this.$5p=new Sys.EventHandlerList;this.$30v=u};_d.$Ev.$5SF=function(n,t){if(!t)return-1;var i=n.$DY(function(n){var i=n;return _g.$2L.$4e(t,i.$Ao)});return i===n.get_$B()?-1:i};function $6x4(n,t,i){return!t&&!i?!0:i?_g.$2L.$4e(i,t):!1}function $3XL(n){var t=null;if(n.$30v&&n.$zm.get_$B())if(n.$1VD.$82W(n.$ER.$2Q,n.$ER.$3D,n.$zm,!0)){t=n.$1VD.$2Lr(n.$ER.$2Q,n.$ER.$3D,n.$zm,!1);$4ns(n,t)}else n.$iv=!1;else{t={};$4ns(n,t)}}function $4ns(n,t){n.$1uP.$1r();n.$1q4.$1r();for(var u=[],f=[],i=0;i<n.$zm.get_$B();i++){var r=t[n.$zm.get_$3q(i)];var e=n.$2ka[n.$zm.get_$3q(i)];r&&r.$138!=="Free"?Array.add(u,new _d.$lP(e,r)):Array.add(f,new _d.$lP(e,r))}n.$1q4.$69(u);n.$1uP.$69(f);$6x3(n)}function $6x3(n){_js.Trace.logInfo(_a.$0.$EQ,"Firing Room Data Loaded {0}",n.$zm.toString());n.$iv=!0;var t=n.$5p.getHandler("DataLoaded");$6(t)||t()}_d.$Ev.prototype={$k:null,$1VD:null,$5SI:null,$1q4:null,$1uP:null,$zm:null,$5Of:null,$5p:null,$30v:!1,$2ka:null,$ER:null,$1CR:!1,$5V7:!1,$5GH:null,$Lj:null,$iv:!1,$i6:null,add_$2qj:function(n){this.$5p.addHandler("DataLoaded",n)},remove_$2qj:function(n){this.$5p.removeHandler("DataLoaded",n)},get_$1by:function(){return this.$iv},get_$qZ:function(){return this.$1uP},get_$1XC:function(){return this.$1q4},get_$1cH:function(){return this.$30v},get_$9eA:function(){return this.$zm},get_$13V:function(){return this.$1CR},set_$13V:function(n){if(this.$1CR!==n){this.$1CR=n;$3(this,"HasErrorOccurred")}return n},get_$2mS:function(){return this.$1VD},get_$5Fy:function(){return this.$i6},set_$5Fy:function(n){if(this.$i6){this.$i6.remove_$2C(this.$$d_$9GM);this.$i6.remove_$1x(this.$$d_$9GL);this.$i6.remove_$2m(this.$$d_$9GI)}this.$i6=n;if(this.$i6){this.$i6.add_$2C(this.$$d_$9GM);this.$i6.add_$1x(this.$$d_$9GL);this.$i6.add_$2m(this.$$d_$9GI)}return n},$7u5:function(n,t){($6(this.$Lj)||!_g.$2L.$4e(this.$Lj,n))&&(this.$Lj=n);var i;if(this.$30v){var r=new(_a.$3X.$$(String));r.$D(n.EmailAddress);this.$ER=t;i=this.$1VD.$2Lr(this.$ER.$2Q,this.$ER.$3D,r,!1)}else i={};return i[n.EmailAddress]||new _d.$F1(n.EmailAddress,"NoData",this.$5Of.$36("NoData",null),!1,"NoError",new(_a.$3X.$$(_d.$KE)))},$5SH:function(n,t){this.$iv=!1;this.set_$13V(!1);this.$ER=t;if(this.$5V7&&$6x4(this,this.$5GH,n))$3XL(this);else{this.$5V7=!0;this.$5GH=n;this.$1q4.$1r();this.$1uP.$1r();this.$zm.$1r();this.$2ka={};this.set_$5Fy(this.$5SI());this.$i6.$2ac=n;this.$k.$z(this.$i6)}},$3tJ:function(n){return _d.$Ev.$5SF(this.$1uP,n)},$5Pm:function(n){return _d.$Ev.$5SF(this.$1q4,n)},$9GL:function(n){this.set_$13V(!0)},$9GI:function(n){this.set_$5Fy(null)},$9GM:function(n){this.$1VD.get_$6PI().$1r();for(var i=0;i<this.$i6.$3LQ.length;i++){var t=this.$i6.$3LQ[i];this.$zm.$D(t.EmailAddress);this.$2ka[t.EmailAddress]=t;this.$1VD.get_$6PI().$D(t.EmailAddress)}$3XL(this)},$9Do:function(n){$3XL(this)}};_d.$zc=function(n,t,i){_d.$zc.initializeBase(this);this.$Ao=n;this.$6Rw=t;this.$TL=i};_d.$zc.prototype={$Ao:null,$6Rw:null,$TL:null,$138:null,$3Mn:null,$1Hr:!1,get_$5Od:function(){return this.$138},set_$5Od:function(n){if(this.$138!==n){this.$138=n;$PB(this,"FreeBusyStatus","IsBusy","DisplayStatus")}return n},get_$1o:function(){return this.$Ao.Name},get_$6V:function(){return this.$138.get_$6V()},get_$7jL:function(){return this.$138.$qE},get_$4Tm:function(){return this.$3Mn},set_$4Tm:function(n){if(this.$3Mn!==n){this.$3Mn=n;$3(this,"SelectNextAvailableRoomLabel")}return n},get_$3Ob:function(){return this.$1Hr},set_$3Ob:function(n){if(this.$1Hr!==n){this.$1Hr=n;$3(this,"ShowLoadingMessage")}return n}};_d.$Py=function(n,t,i,r){this.$$d_$9GJ=Function.createDelegate(this,this.$9GJ);this.$$d_$9GK=Function.createDelegate(this,this.$9GK);this.$$d_$57Q=Function.createDelegate(this,this.$57Q);_d.$Py.initializeBase(this,["SelectARoomList",i]);this.$k=n;this.$1mj=t;this.$5SG=r;this.$1HF=new _js.$Z;this.$Nx=new _C(this.$$d_$57Q,_a.$0.$EQ)};function $6xa(n){if(!n.$iv){var t=n.$5SG();t.add_$2C(n.$$d_$9GK);t.add_$1x(n.$$d_$9GJ);n.$k.$z(t)}}_d.$Py.prototype={$k:null,$1mj:null,$5SG:null,$1HF:null,$Nx:null,get_$7m7:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$1jZ,_nbs.NonBootStrings.l_TryAgainButton_Text));n.$D(new _a.$2G(this.$Nx,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},$9Nk:function(){if(this.$5v.get_$HE()){this.$1mj.set_$4Sh(this.$5v.get_$HE().Name);this.$1mj.set_$3Ls(this.$5v.get_$HE().EmailAddress);_h.$2J.$Cq(this.$1mj.get_$Te(),this.$k);$194(this,"SelectARoom")}},get_$9n8:function(){return!$6(this.$1mj.get_$3Ls())&&$6(this.$5v.get_$HE())},get_$6Sm:function(){return this.$iv&&!this.$1m6},$3FX:function(){this.set_$13V(!1);if(this.get_$9n8()){var n=new _g.$1l;n.Name=this.$1mj.get_$4Sh();n.EmailAddress=this.$1mj.get_$3Ls();this.$5v.set_$HE(n);$194(this,"SelectARoom")}else if(this.get_$6Sm()){this.$5v.set_$HE(null);$194(this,"SelectARoom")}else $6xa(this)},$3Fa:function(){},$9GJ:function(n){var t=n;t.remove_$2C(this.$$d_$9GK);t.remove_$1x(this.$$d_$9GJ);this.set_$13V(!0)},$9GK:function(n){var t=n;t.remove_$2C(this.$$d_$9GK);t.remove_$1x(this.$$d_$9GJ);this.$1HF.$69(t.$1HF);this.set_$6bj(this.$1HF.get_$B());if(this.$5v.get_$HE())for(var r=t.$1HF,f=r.length,i=0;i<f;++i){var u=r[i];if(u.EmailAddress===this.$5v.get_$HE().EmailAddress){this.$5v.set_$HE(u);break}}this.set_$1by(!0);if(this.get_$6Sm()){this.$5v.set_$HE(null);$194(this,"SelectARoom")}},$57Q:function(){this.set_$13V(!1);$194(this,null)}};_d.$MW=function(n,t){this.$$d_$A0u=Function.createDelegate(this,this.$A0u);this.$$d_$9Ej=Function.createDelegate(this,this.$9Ej);this.$$d_$24v=Function.createDelegate(this,this.$24v);this.$$d_$6E1=Function.createDelegate(this,this.$6E1);this.$$d_$25J=Function.createDelegate(this,this.$25J);this.$$d_$9Nj=Function.createDelegate(this,this.$9Nj);this.$$d_$7ji=Function.createDelegate(this,this.$7ji);this.$$d_$9gD=Function.createDelegate(this,this.$9gD);this.$$d_$9gF=Function.createDelegate(this,this.$9gF);this.$$d_$57Q=Function.createDelegate(this,this.$57Q);_d.$MW.initializeBase(this,["SelectARoom",n]);this.$2Y=t;this.$Nx=new _C(this.$$d_$57Q,_a.$0.$EQ);this.$2bG=new _C(this.$$d_$9gF,_a.$0.$EQ);this.$6RH=new _C(this.$$d_$9gD,_a.$0.$EQ);this.$6Vm=new _C(this.$$d_$7ji,_a.$0.$EQ);this.$5v.apcl("selectedRoomListEmailAddress",this.$$d_$9Nj);this.$5v.apcl("selectedRoomEmailAddress",this.$$d_$25J)};function $6xb(n){n.$iv?n.$24v():n.$2Y.$5SH(n.$5v.get_$HE(),n.$5v.get_$bG())}_d.$MW.prototype={$2Y:null,$2bG:null,$6RH:null,$6Vm:null,$Nx:null,$1HR:null,$17Y:null,$1U3:!1,$2x6:!1,$2xP:!1,$2xR:!1,$2ce:!1,$2N1:!1,$2x8:!1,$3OC:null,$3EM:null,$3MJ:null,get_$5Uf:function(){return this.$2x6},set_$5Uf:function(n){if(this.$2x6!==n){this.$2x6=n;$3(this,"HasAvailableRooms")}return n},get_$2xQ:function(){return this.$2xP},set_$2xQ:function(n){if(this.$2xP!==n){this.$2xP=n;$3(this,"HasNoRoomsAvailable")}return n},get_$2xS:function(){return this.$2xR},set_$2xS:function(n){if(this.$2xR!==n){this.$2xR=n;$3(this,"HasNoRoomsInDirectory")}return n},get_$6Vl:function(){return this.$2ce},set_$6Vl:function(n){if(this.$2ce!==n){this.$2ce=n;$3(this,"ShowBusyRooms")}return n},get_$59p:function(){return this.$2x8&&this.get_$9nV()},get_$9nW:function(){return this.$3OC},set_$9nW:function(n){if(this.$3OC!==n){this.$3OC=n;$3(this,"ShowBusyRoomsLabel")}return n},get_$67H:function(){return this.$3EM},set_$67H:function(n){if(this.$3EM!==n){this.$3EM=n;$3(this,"NoRoomAvailableLabel")}return n},get_$9gE:function(){return this.$3MJ},set_$9gE:function(n){if(this.$3MJ!==n){this.$3MJ=n;$3(this,"SelectAnyRoomLabelText")}return n},get_$6Vf:function(){return this.get_$1cH()},get_$1cH:function(){return this.$2Y.get_$1cH()},get_$qZ:function(){return this.$2Y.get_$qZ()},get_$1XC:function(){return this.$2Y.get_$1XC()},get_$9gP:function(){return this.$1HR},set_$9gP:function(n){if(this.$1HR!==n){this.$1HR=n;this.$17Y=null;$45(this,"SelectedBusyRoom","SelectedFreeRoom");this.$5v.set_$1WO(!1);this.$5v.set_$BD(n?n.$Ao:null)}return n},get_$6RW:function(){return this.$17Y},set_$6RW:function(n){if(this.$17Y!==n){this.$17Y=n;this.$1HR=null;$45(this,"SelectedFreeRoom","SelectedBusyRoom");this.$5v.set_$1WO(!1);this.$5v.set_$BD(n?n.$Ao:null)}return n},get_$9pM:function(){return this.$1U3},set_$9pM:function(n){if(this.$1U3!==n){this.$1U3=n;$3(this,"ShowSelectARoomListButton")}return n},get_$5Vq:function(){return this.$2N1},set_$5Vq:function(n){if(this.$2N1!==n){this.$2N1=n;$3(this,"HideListOfAvailableRooms")}return n},get_$7T9:function(){return this.$5v.get_$HE()?String.format(_nbs.NonBootStrings.l_FindingRoomsInRoomlist_Text,this.$5v.get_$HE().Name):_nbs.NonBootStrings.l_FindingRooms_Text},get_$7m8:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$1jZ,_nbs.NonBootStrings.l_TryAgainButton_Text));n.$D(new _a.$2G(this.$Nx,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$97S:function(){var n=new _js.$Z;n.$D(new _a.$2G(this.$Nx,_nbs.NonBootStrings.l_ChangeTimeButton_Text));this.$1U3&&n.$D(new _a.$2G(this.$2bG,_nbs.NonBootStrings.l_ChangeRoomListButton_Text));return n},get_$97T:function(){var n=new _js.$Z;this.$1U3&&n.$D(new _a.$2G(this.$2bG,_nbs.NonBootStrings.l_ChangeRoomListButton_Text));n.$D(new _a.$2G(this.$Nx,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$9nV:function(){return!0},get_$3va:function(){return this.$2x8},set_$3va:function(n){if(this.$2x8!==n){this.$2x8=n;$3(this,"CanShowBusyRooms")}return n},$3FX:function(){this.set_$9pM(!!this.$5v.get_$HE());this.set_$1by(!1);this.set_$6Vl(!1);this.set_$5Uf(!1);this.set_$2xQ(!1);this.set_$2xS(!1);this.set_$3va(!1);this.set_$5Vq(!0);this.$5v.apcl("selectedRoomEmailAddress",this.$$d_$6E1);this.$2Y.add_$2qj(this.$$d_$24v);this.$2Y.apcl("HasErrorOccurred",this.$$d_$9Ej);this.$2Y.get_$qZ().add_$1Z(this.$$d_$A0u);$6xb(this)},$3Fa:function(){this.$5v.rpcl("selectedRoomEmailAddress",this.$$d_$6E1);this.$2Y.remove_$2qj(this.$$d_$24v);this.$2Y.rpcl("HasErrorOccurred",this.$$d_$9Ej)},$9k0:function(){this.set_$67H(this.$5v.get_$HE()?String.format(_nbs.NonBootStrings.l_NoRoomsAvailableInRoomList_Text,this.$5v.get_$HE().Name):_nbs.NonBootStrings.l_NoRoomsAvailable_Text)},$9Ej:function(n,t){this.set_$13V(this.$2Y.get_$13V())},$24v:function(){this.set_$1by(!0);this.set_$6bj(this.get_$qZ().get_$B()+this.get_$1XC().get_$B());this.set_$5Uf(this.get_$qZ().get_$B()>0);this.set_$3va(this.get_$1XC().get_$B()>0);this.set_$2xQ(this.$1m6>0&&!this.get_$qZ().get_$B());this.set_$2xS(this.get_$3vu());this.set_$9nW(this.$5v.get_$HE()?String.format(_nbs.NonBootStrings.l_ShowBusyRooms_Text,this.$5v.get_$HE().Name):_nbs.NonBootStrings.l_ShowBusyRoomsWithoutRoomList_Text);this.$9k0();this.set_$5Vq(this.get_$3vu())},$6E1:function(n,t){$194(this,null)},$57Q:function(){this.set_$13V(!1);this.set_$2xQ(!1);this.set_$2xS(!1);$194(this,null)},$9gF:function(){this.set_$13V(!1);this.set_$2xQ(!1);this.set_$2xS(!1);$194(this,"SelectARoomList")},$9gD:function(){$194(this,null);this.$5v.set_$1WO(!0)},$7ji:function(){this.set_$6Vl(!0);this.set_$3va(!1)},$9Nj:function(n,t){this.set_$9gE(this.$5v.get_$HE()?String.format(_nbs.NonBootStrings.l_FindAnyAvailableRoomInRoomList_Text,this.$5v.get_$HE().Name):_nbs.NonBootStrings.l_FindAnyAvailableRoom_Text);this.set_$1by(!1)},$25J:function(n,t){if(!this.$5v.get_$1b2()&&(this.$17Y||this.$1HR)){this.$17Y=null;this.$1HR=null}else{var i=this.$2Y.$3tJ(this.$5v.get_$BD());if(i>=0){this.$17Y=this.get_$qZ().get_$3q(i);this.$1HR=null}else{i=this.$2Y.$5Pm(this.$5v.get_$BD());if(i>=0){this.$1HR=this.get_$1XC().get_$3q(i);this.$17Y=null}}}$45(this,"SelectedBusyRoom","SelectedFreeRoom")},$A0u:function(n,t){this.$25J(null,null)}};_d.$1C6=function(n,t){_d.$1C6.initializeBase(this,[n,t])};_d.$1C6.prototype={get_$6Vf:function(){return!1},$9k0:function(){this.set_$67H(this.$5v.get_$HE()?String.format(_nbs.NonBootStrings.l_NoRoomsAvailableInRoomListComposeForm_Text,this.$5v.get_$HE().Name):_nbs.NonBootStrings.l_NoRoomsAvailableComposeForm_Text)},get_$9nV:function(){return!1}};_d.$aD=function(n,t,i){this.$$d_$9AL=Function.createDelegate(this,this.$9AL);_d.$aD.initializeBase(this);this.$D8=n;this.$5t=t;this.set_$9AM(new _C(this.$$d_$9AL,i))};_d.$aD.$5Ep=function(n,t,i,r){return n.get_$L()==="Mouse"?new _d.$aD(t,i,r):null};_d.$aD.prototype={$180:null,$uf:!1,$sy:null,$5t:null,$D8:null,get_$9AM:function(){return this.$sy},set_$9AM:function(n){if(this.$sy!==n){this.$sy=n;$3(this,"OnAttachViaStringCommand")}return n},get_$2dv:function(){return this.$180},set_$2dv:function(n){if(this.$180!==n){this.$180=n;$3(this,"StringAttachContent")}return n},get_$2C8:function(){return this.$uf},set_$2C8:function(n){if(this.$uf!==n){this.$uf=n;$3(this,"WasStringAttachments")}return n},$9AL:function(){var n=this;this.$D8.$E(function(t){var i;var r,u;n.set_$2C8((u=t.$1mC(n.$180,r={val:i}),i=r.val,u));n.$uf&&n.$5t&&_js.$J.get_$I().$1w(_a.$0.$1N,"ComposeCopyPasteViewModel.OnAttachViaString",function(){n.$5t.$1op(i,null)},0)})}};_d.$v2=function(n){this.$$d_$9gy=Function.createDelegate(this,this.$9gy);this.$$d_$9h5=Function.createDelegate(this,this.$9h5);_d.$v2.initializeBase(this);this.$3Mu=new _C(this.$$d_$9h5,_a.$0.$Cs);this.$6S1=new _C(this.$$d_$9gy,_a.$0.$Cs);this.$5XU(n);this.$3X=n};_d.$v2.prototype={$3Mu:null,$6S1:null,$nq:null,$bT:null,$ek:!1,$35:null,$3X:null,$JX:!1,get_$pg:function(){return this.$ek},set_$pg:function(n){if(this.$ek!==n){this.$ek=n;$3(this,"CanSelectNone")}return n},get_$3QP:function(){return this.$bT},set_$3QP:function(n){if(n!==this.$bT){this.$bT=n;$3(this,"SuggestedDate")}return n},get_$CT:function(){return this.$35},set_$CT:function(n){this.$35=$6(this.$35)||$6(n)?n:new _a.$7(n.get_$3l(),n.get_$2z(),n.get_$51(),this.$35.get_$DV(),this.$35.get_$GJ(),this.$35.get_$TR());this.$3X=this.$35;this.set_$1OT(!1);$45(this,"DisplayedDate","SelectedDate");!$6(this.$nq)&&this.$nq.$2M&&this.$nq.$n();return n},get_$BJ:function(){return this.$3X},set_$BJ:function(n){if(!_a.$7.$4N(this.$3X,n)){this.$3X=n;$3(this,"DisplayedDate")}return n},get_$1OT:function(){return this.$JX},set_$1OT:function(n){if(this.$JX!==n){this.$JX=n;$3(this,"IsPickingMonth")}return n},$5XU:function(n){this.$3X=n;this.$35=n;$45(this,"DisplayedDate","SelectedDate")},$9h5:function(){var n=_a.$7.get_$29();$6(this.$35)||(n=new _a.$7(n.get_$3l(),n.get_$2z(),n.get_$51(),this.$35.get_$DV(),this.$35.get_$GJ(),this.$35.get_$TR()));this.set_$CT(n)},$9gy:function(){this.set_$CT(null)}};_d.$WO=function(n){this.$$d_$9RM=Function.createDelegate(this,this.$9RM);this.$$d_$9bD=Function.createDelegate(this,this.$9bD);_d.$WO.initializeBase(this);this.$iP=n;var t=this;this.$6NF=new _C(this.$$d_$9bD,_a.$0.$Cs,this,"Persona",function(){return!!t.$14})};_d.$WO.prototype={$iP:null,$2r:null,$6NF:null,$14:null,get_$mK:function(){if(!this.$2r){this.$2r=this.$iP.$E(_pc.$14.$1C9,_pc.$14.$iZ(),!1,"PersonaDetailedView");this.$2r.$11N();this.$2r.set_$tx(!0);this.$2r.set_$R8(!0);this.$2r.set_$q(!1);this.$2r.add_$gw(this.$$d_$9RM);this.$2r.set_$18b(100);this.$2r.set_$1gB(0)}return this.$2r},get_$1s:function(){return this.$14},set_$1s:function(n){if(this.$14!==n){this.$14=n;$45(this,"Persona","RemoveRecipientText")}return n},get_$6NL:function(){return!this.$14||!this.$14.$14?String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$14.$14.get_$1o())},$1r:function(){this.set_$1s(null);this.get_$mK().set_$Ac("")},$9RM:function(n,t){var i=n.get_$Wh();i&&this.set_$1s(i)},$9bD:function(){this.set_$1s(null);this.get_$mK().set_$HW(!0)}};_d.$NH=function(n,t,i,r,u,f){this.$$d_$68R=Function.createDelegate(this,this.$68R);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$9Rn=Function.createDelegate(this,this.$9Rn);_d.$NH.initializeBase(this);_a.$4.$J(i,"folderPickerContainer shouldn't be null");_a.$4.$J(r,"owaShell shouldn't be null");_a.$4.$J(u,"passFolderCheck shouldn't be null");_a.$4.$J(f,"conductor shouldn't be null");this.$iS=i;this.$C=r;this.set_$Kw(n);this.set_$r(t);this.$6Gz=u;this.$3m=f;this.$53Z=new _C(this.$$d_$9Rn,_a.$0.$EM);this.$TL=new _C(this.$$d_$34,_a.$0.$EM)};function $6sb(n){n.$iS.$130||n.$iS.$9x4();if(n.$iS.$130){var i=this;var t=new _C(function(){n.$iS.$130.$5e.get_$FN()&&$4lf(n,n.$iS.$130.$5e.get_$FN().$24)},_a.$0.$EM);n.$iS.$130.$4Wf(t,_nbs.NonBootStrings.l_Select_Text,_nbs.NonBootStrings.l_Select_Text)}}function $6sc(n){n.$iS.$K5||n.$iS.$9x5();if(n.$iS.$K5){n.$iS.$K5.$5e.$l8=new _C(n.$$d_$68R,_a.$0.$8i);n.$3m.$Bt(n.$iS.$K5)}}function $4lf(n,t){if(n.$6Gz(t)){n.set_$Kw(t.get_$1o());n.set_$r(t.get_$r().Id)}}_d.$NH.prototype={$iS:null,$C:null,$6Gz:null,$3m:null,$JR:null,$2k:null,$53Z:null,$TL:null,get_$Kw:function(){return this.$JR},set_$Kw:function(n){if(this.$JR!==n){this.$JR=n;$3(this,"FolderName")}return n},get_$r:function(){return this.$2k},set_$r:function(n){if(this.$2k!==n){this.$2k=n;$3(this,"FolderId")}return n},$9Rn:function(){switch(this.$C.get_$L()){case"Mouse":case"TouchWide":$6sb(this);break;case"TouchNarrow":$6sc(this);break}},$68R:function(){var n=this.$iS.$K5.$5e;n.get_$FN()&&$4lf(this,n.get_$FN().$24);n.$l8=null;this.$3m.$Bs()},$34:function(){this.set_$Kw("");this.set_$r("")}};_d.$Bi=function(n,t,i){this.$$d_$9ar=Function.createDelegate(this,this.$9ar);this.$$d_$9aq=Function.createDelegate(this,this.$9aq);_d.$Bi.initializeBase(this);this.$M=n;this.$4P=t;this.$C=i};function $4lg(n){var t=_h.$j.$cN("msgfolderroot");var i=_g.$2X.$Bi("msgfolderroot");if(t&&i){n.$1uC=new _js.$Z;var r=new _y.$PQ(n.$M,"msgfolderroot",i,t,_g.$V.get_$I());n.$1uC.$D(r);return!0}else{$6sf(n);return!1}}function $6sd(n){_js.Trace.logInfo(_d.$Bi.$5y,"Setting FolderPickerDialog to null");n.$1uC=null;n.set_$Ez(null)}function $6se(n){_js.Trace.logInfo(_d.$Bi.$5y,"Setting FolderPickerScreen to null");n.$1uC=null;n.$K5=null}function $6sf(n){var t=new _a.$4a([_nbs.NonBootStrings.l_FolderTreesIsNull_Text],0,null,0,!1,_u.Strings.l_OK_Text,null,_nbs.NonBootStrings.l_FolderPickerError_Text);n.$M.$9Yf(_a.$4a,t)}_d.$Bi.prototype={$M:null,$4P:null,$C:null,$1uC:null,$130:null,$K5:null,get_$Ez:function(){return this.$130},set_$Ez:function(n){if(n!==this.$130){this.$130=n;$3(this,"FolderPickerDialog")}return n},$9x4:function(){if($4lg(this)){_js.Trace.logInfo(_d.$Bi.$5y,"CreateFolderPickerDialog");this.set_$Ez(new _y.$I3(new _y.$4S(this.$M,this.$1uC,_g.$V.get_$I(),this.$C,null,null,!0,!1,!1,null,null)));this.$4P.$1w(_d.$Bi.$5y,"RemovePickerDialog",this.$$d_$9aq,18e4)}},$9x5:function(){if($4lg(this)){this.$K5=new _y.$TQ(new _y.$4S(this.$M,this.$1uC,_g.$V.get_$I(),this.$C,null,null,!0,!1,!1,null,null));this.$K5.set_$2uf(_nbs.NonBootStrings.l_SelectFolder_Text);this.$4P.$1w(_d.$Bi.$5y,"RemoveFolderPickerScreen",this.$$d_$9ar,18e4)}},$9aq:function(){this.$130.$2y?this.$4P.$1w(_d.$Bi.$5y,"RemovePickerDialog",this.$$d_$9aq,18e4):$6sd(this)},$9ar:function(){this.$K5.$2y?this.$4P.$1w(_d.$Bi.$5y,"RemoveFolderPickerScreen",this.$$d_$9ar,18e4):$6se(this)}};_d.$NS=function(n,t,i,r,u,f,e){this.$3wE=n;this.$F3=t;this.$25Y="";this.$VJ=i;this.$1RU=r;this.$6P=u;this.$7l=f;this.$C=e};function $6t1(n,t){var i=$6sy(n,t);if(i){var r=n.$F3?"MicrosoftOffice365Help":"OWAPremiumHelp";n.$VJ.$Re(i,r,$6sz(n))}}function $6t0(n){return n.$C.get_$L()==="TouchWide"&&_d.$9X.isInstanceOfType(n.$C.$Zs().get_$7u())?!0:!1}function $6sy(n,t){var i=null;if(n.$3wE){i=_js.$9.$4R(n.$3wE,_js.$1g.$9a(_y.$16j,t));n.$F3&&(i+=n.$25Y)}return i}function $6sz(n){return n.$7l==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""}_d.$NS.prototype={$3wE:null,$F3:!1,$VJ:null,$1RU:null,$25Y:null,$6P:null,$7l:0,$C:null,get_$4LK:function(){return this.$25Y},set_$4LK:function(n){this.$25Y=_js.$9.$18(n)?"":n.startsWith("&")?n:"&"+n;return n},$2cq:function(){var t=0;$6t0(this)?t=4:this.$6P&&this.$6P.get_$6l()&&(t=this.$6P.get_$6l().$9s);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.$1Tw(n)},$1Tw:function(n){this.$1RU.$9xU(_g.$1U.$v)||$6t1(this,n)}};_d.$3=function(){};_d.$3.get_$pl=function(){return _0365m.$B.$E("close_small.png")};_d.$3.get_$1Xw=function(){return _0365m.$B.$E("close_small_h.png")};_d.$3.get_$96e=function(){return _0365m.$B.$E("navigation_close.png")};_d.$3.get_$8Hg=function(){return _0365m.$B.$E("mail_notification_white.png")};_d.$3.get_$8He=function(){return _0365m.$B.$E("mail_notification.png")};_d.$3.get_$7Qv=function(){return _0365m.$B.$E("arrow_right_small_blue.png")};_d.$3.get_$7Qw=function(){return _0365m.$B.$E("arrow_up.png")};_d.$3.get_$7mZ=function(){return _0365m.$B.$E("event_notification_white.png")};_d.$3.get_$7mY=function(){return _0365m.$B.$E("event_notification.png")};_d.$3.get_$7VQ=function(){return _0365m.$B.$E("chat_white.png")};_d.$3.get_$4W=function(){return _0365m.$B.$E("chat.png")};_d.$3.get_$543=function(){return _0365m.$B.$E("add_people.png")};_d.$3.get_$7NJ=function(){return _0365m.$B.$E("add_circle_grey_large.png")};_d.$3.get_$7NH=function(){return _0365m.$B.$E("add_circle_blue_p.png")};_d.$3.get_$em=function(){return _0365m.$B.$E("close_large.png")};_d.$3.get_$c2=function(){return _0365m.$B.$E("close_large_h.png")};_d.$3.get_$1Kt=function(){return _0365m.$B.$E("close_large_d.png")};_d.$3.get_$9UY=function(){return _0365m.$B.$E("personcard_phone.png")};_d.$3.get_$9UZ=function(){return _0365m.$B.$E("personcard_phone_p.png")};_d.$3.get_$8Gq=function(){return _0365m.$B.$E("locationcard_directions_p.png")};_d.$3.get_$9UV=function(){return _0365m.$B.$E("personcard_event_p.png")};_d.$3.get_$9UX=function(){return _0365m.$B.$E("personcard_mail_p.png")};_d.$3.get_$9UW=function(){return _0365m.$B.$E("personcard_im_p.png")};_d.$3.get_$5hy=function(){return _0365m.$B.$E("locationcard_directions.png")};_d.$3.get_$5hz=function(){return _0365m.$B.$E("locationcard_directions_h.png")};_d.$3.get_$6I4=function(){return _0365m.$B.$E("personcard_event.png")};_d.$3.get_$6I5=function(){return _0365m.$B.$E("personcard_event_h.png")};_d.$3.get_$6I9=function(){return _0365m.$B.$E("personcard_mail.png")};_d.$3.get_$6IA=function(){return _0365m.$B.$E("personcard_mail_h.png")};_d.$3.get_$6I7=function(){return _0365m.$B.$E("personcard_im.png")};_d.$3.get_$6I8=function(){return _0365m.$B.$E("personcard_im_h.png")};_d.$3.get_$8JL=function(){return _0365m.$B.$E("merge.png")};_d.$3.get_$8JR=function(){return _0365m.$B.$E("merge_h.png")};_d.$3.get_$6YT=function(){return _0365m.$B.$E("split.png")};_d.$3.get_$6YW=function(){return _0365m.$B.$E("split_h.png")};_d.$3.get_$3Iu=function(){return _0365m.$B.$E("print.png")};_d.$3.get_$6KB=function(){return _0365m.$B.$E("print_h.png")};_d.$3.get_$59B=function(){return _0365m.$B.$E("calendar_share.png")};_d.$3.get_$59C=function(){return _0365m.$B.$E("calendar_share_h.png")};_d.$3.get_$9SY=function(){return _0365m.$B.$E("other_notification_white.png")};_d.$3.get_$9SX=function(){return _0365m.$B.$E("other_notification.png")};_d.$3.get_$53W=function(){return _0365m.$B.$E("add_circle_blue.png")};_d.$3.get_$53X=function(){return _0365m.$B.$E("add_circle_grey.png")};_d.$3.get_$7NI=function(){return _0365m.$B.$E("add_circle_grey_d.png")};_d.$3.get_$53Y=function(){return _0365m.$B.$E("add_circle_grey_h.png")};_d.$3.get_$7Mv=function(){return _0365m.$3A.$E("success_notification",8)};_d.$3.get_$7Mu=function(){return _0365m.$3A.$E("fail_notification",8)};_d.$Ey=function(n,t){this.$$d_$4Ic=Function.createDelegate(this,this.$4Ic);this.$$d_$99H=Function.createDelegate(this,this.$99H);this.$3TP={};_d.$Ey.initializeBase(this);this.$Ax=n;this.$k=t};function $4oL(n,t){return t in n.$3TP}_d.$Ey.prototype={$Ax:null,$k:null,$3uY:null,get_$2RQ:function(){return this.$Ax.get_$1VG()},$49:function(n){_js.$9.$a(this.get_$2RQ())||this.$1v0(this.get_$2RQ(),n)},$30b:function(n){return _js.$9.$a(n)?!1:$4oL(this,n)&&this.$3TP[n]},get_$2PP:function(){return this.$30b(this.get_$2RQ())},$1v0:function(n,t){if(_js.$9.$a(n)){_js.Trace.logInfo(_d.$Ey.$1b,"Ignoring request to fetch online meeting configuration for empty sipUri");t&&t(n,!1);return}if($4oL(this,n)){t&&t(n,this.$30b(n));return}_js.Trace.logInfo(_d.$Ey.$1b,String.format("Fetching user online meeting configuration for {0}",n));_a.$6.$1c(_d.$Ey.$1b,"GetUserOnlineMeetingSettings");var i=new _c.$16J(n);i.add_$2C(this.$$d_$99H);i.add_$1x(this.$$d_$4Ic);var r=this;i.add_$2m(function(n){_a.$6.$1E(null,"GetUserOnlineMeetingSettings",r.$3uY,_d.$1Jb.$6w.$PX(n));if(t){var i=n;var u=i.$c?i.$c.SipUri:"";t(u,r.$30b(u))}});this.$k.$z(i)},$99H:function(n){_js.Trace.logInfo(_d.$Ey.$1b,"Fetching user online meeting configuration succeeded.");var t=n;this.$3TP[t.$c.SipUri]=t.$c.IsUcwaSupported;this.$3uY=""},$4Ic:function(n){_js.Trace.logInfo(_d.$Ey.$1b,"Fetching user online meeting configuration failed.");this.$3uY=_d.$1Jb.$6w.$iV(n)}};_d.$U5=function(n,t,i){_d.$U5.initializeBase(this);this.$VJ=i;this.$l0=n;this.$k=t};_d.$U5.prototype={$VJ:null,$l0:null,$k:null,$7dY:function(n,t,i){var r=new _c.$13G(this.$l0.get_$2RQ(),n);var u=this;r.add_$2C(function(n){_js.Trace.logInfo(_d.$U5.$1b,"Create meet now succeeded.");var i=n;t(i.$Df.WebUrl)});var f=this;r.add_$1x(function(n){_js.Trace.logInfo(_d.$U5.$1b,"Create meet now failed.");i()});this.$k.$z(r)},$7qe:function(n,t){return t?String.format(_nbs.NonBootStrings.l_PlainTextMeetNowPost_Text,_nbs.NonBootStrings.l_MeetNow_Announcement_Text,n,t):""},$49:function(n){var t=this;this.$l0.$49(function(){n&&n()})},get_$2PP:function(){return this.$l0.get_$2PP()}};_d.$19N=function(n,t,i){this.$l0=n;this.$k=t;this.$VJ=i};_d.$19N.prototype={$l0:null,$k:null,$VJ:null,$8A:function(){return new _d.$U5(this.$l0,this.$k,this.$VJ)}};_d.$UB=function(n,t,i,r){this.$$d_$4Tp=Function.createDelegate(this,this.$4Tp);this.$2E=n;this.$qz=t;this.$3s=i;this.$1G6=r};_d.$UB.prototype={$2E:null,$1G6:null,$qz:null,$3s:null,$24G:null,$aS:null,$4Tp:function(){$6(this.$24G)||(this.$24G.$cB!==this?this.$24G.set_$3lb(this):this.$24G.$558&&this.$24G.set_$3lb(null))}};_d.$UC=function(n,t,i,r,u,f){_d.$UC.initializeBase(this,[n,t,null,f]);this.$2ma=n;$6ui(this,r);this.set_$3lb(u);this.$3GG=i};function $6ui(n,t){for(var f=t.length,u=new Array(f),r=0;r<f;r++){var i=t[r];i.$24G=n;u[r]=new _0365m.$8w(i.$2E,i.$qz,new _C(i.$$d_$4Tp,_a.$0.$Cs),n.$cB===i,!1,null,i.$1G6,i.$3s);u[r].set_$6bJ(!1);i.$aS=u[r]}n.set_$2AF(new _0365m.$2b(u))}function $4n3(n){!n.$3OI||$6(n.$cB)||_js.$9.$18(n.$cB.$2E)?n.set_$1P(n.$2ma):_js.$9.$18(n.$2ma)?n.set_$1P(n.$cB.$2E):n.set_$1P(String.format("{0}: {1}",n.$2ma,n.$cB.$2E))}_d.$UC.prototype={$2ma:null,$cB:null,$3GG:null,$3OI:!0,$558:!0,$3np:!1,get_$3lb:function(){return this.$cB},set_$3lb:function(n){if(this.$cB!==n){$6(this.$cB)||this.$3np||this.$cB.$aS.set_$79(!1);this.$cB=n;$6(this.$cB)||this.$3np||this.$cB.$aS.set_$79(!0);$N(this,"CurrentOption");$4n3(this);$6(this.$3GG)||($6(this.$cB)?this.$3GG(null):this.$3GG(this.$cB.$3s));this.$3np&&(this.$cB=null)}return n},get_$6Vs:function(){return this.$3OI},set_$6Vs:function(n){if(this.$3OI===n)return n;this.$3OI=n;$4n3(this);return n}};_d.$eQ=function(n,t){this.$$d_$9Kh=Function.createDelegate(this,this.$9Kh);_d.$eQ.initializeBase(this);this.$M=n;this.$PV=new _d.$WO(t);$6uq(this)};function $6uq(n){var t=new _y.$Lc;t.set_$4v(_nbs.NonBootStrings.l_OpenAnotherMailbox_Text);t.set_$DP(n);var i=this;n.$k4=new _C(n.$$d_$9Kh,_a.$0.$2to,n.$PV,"Persona",function(){return!!n.$PV.$14});t.$7J.$D(new _a.$2G(n.$k4,_nbs.NonBootStrings.l_OpenButtonText_Text));t.$7J.$D(new _a.$2G(t.$4d,_u.Strings.l_CancelButtonText_Text));n.set_$iE(t)}_d.$eQ.prototype={$M:null,$k4:null,$9d:null,$PV:null,get_$iE:function(){return this.$9d},set_$iE:function(n){if(this.$9d!==n){this.$9d=n;$3(this,"DialogViewModel")}return n},$bL:function(){this.$PV.$1r();this.$9d.set_$1O(!0)},$9Kh:function(){if(this.$PV.$14){this.$M.$9Yf(_y.$oO,new _y.$oO(this.$PV.$14.get_$1s().get_$1l().EmailAddress));this.$9d.$4d.$n();_a.$g.$8r("VM.MailUsage.OpenFromExplicitLogonWindow")}}};_d.$Y0=function(n,t,i,r){this.$$d_$3OQ=Function.createDelegate(this,this.$3OQ);this.$$d_$9yV=Function.createDelegate(this,this.$9yV);_a.$4.$l(n,"offlineSettings");_a.$4.$l(t,"owaShell");_a.$4.$l(r,"eventAggregator");this.$6p=n;this.$C=t;this.$3dL=i;r.$IU(_a.$Mi,this.$$d_$9yV);var u=this;this.$68J=new(_0365f.$4D.$$(_y.$qk))(function(){return new _y.$qk})};function $6up(n){n.get_$3Es().set_$3OQ(!1);n.$C.$7X(n.get_$3Es())}_d.$Y0.prototype={$6p:null,$C:null,$68J:null,$3dL:0,get_$3Es:function(){return this.$68J.get_$1g()},get_$6VR:function(){return!this.$6p.get_$1ma()&&this.$6p.$3Oj(this.$3dL,!1)},$9xU:function(n){if(n&&!n.$Be.$Pf){if(this.$6p.get_$1ma()){$6up(this);return!0}if(this.get_$6VR()){this.$3OQ();return!0}}return!1},$53c:function(n){this.get_$6VR()&&!n.$1cU(9600)&&n.$JC(9600,null,_nbs.NonBootStrings.l_OfflineDiscovery_InfoBarLink_Text,this.$$d_$3OQ)},$9aj:function(n){n.$5S(9600)},$3OQ:function(){this.get_$3Es().set_$3OQ(!0);this.$C.$7X(this.get_$3Es())},$9yV:function(n){var t=n.$c;this.$3dL=t.get_$Ot().AllowOfflineOn}};_d.$4Z=function(n,t){this.$$d_$34s=Function.createDelegate(this,this.$34s);this.$1Ll=new Sys.EventHandlerList;_d.$4Z.initializeBase(this);_a.$4.$7t(n,1,1e3,"pageSize");this.$5Xd=new _h.$8R(0,n);this.$X4=t;this.$7d=0;this.$11=null;this.$pz=_d.$4Z.$2RM;t||this.set_$1Mi(!0)};function $6v9(n){return n.$3m4||_d.$4Z.$24b}function $4nD(n,t){if(n.$21){n.$21.remove_$z1(n.$$d_$34s);_h.$3L.get_$I().$1j5(n.$21)}n.$21=t;n.set_$22(null);n.set_$1zF(!1);n.$21&&n.$21.add_$z1(n.$$d_$34s);$3(n,"Table")}function $4nC(n){if(n.$7d){if(!n.$21)return;$6vA(n,n.$5Xd)}}function $6vA(n,t){n.$7d=2;n.set_$120(_d.$4Z.$2RM);n.set_$1zF(!1);t.$1df=1;n.$21.$OQ(t);n.$34s(n.$21,"Loading")}function $6v8(n,t){if(n.$1Ll){var i=n.$1Ll.getHandler(t);i&&i()}}_d.$4Z.prototype={$5Xd:null,$11:null,$pz:null,$3m4:null,$X4:0,$21:null,$7d:0,$Zl:null,$1zE:!1,$1xs:!1,$40p:!1,$Ey:!1,add_$6RY:function(n){this.$Y("SelectedItem",n)},remove_$6RY:function(n){this.$u("SelectedItem",n)},get_$Ho:function(){return this.$21},set_$Ho:function(n){_a.$4.$J(n,"Table");$4nD(this,n);$4nC(this);return n},get_$22:function(){return this.$11},set_$22:function(n){this.$9Aq();this.$11=n;this.$99d();this.$40p=!1;$3(this,"SelectedItem");return n},get_$1Mi:function(){return this.$Ey},set_$1Mi:function(n){this.$Ey=n;$3(this,"FocusItemOnSelect");return n},get_$1tJ:function(){return this.$Zl},set_$1tJ:function(n){this.$Zl=n;$3(this,"EnterKeyCommand");return n},get_$120:function(){return this.$pz},set_$120:function(n){if(this.$pz!==n){this.$pz=n;$45(this,_d.$4Z.$1Yc,_d.$4Z.$6WH)}return n},get_$1kr:function(){return this.$pz===_d.$4Z.$2RM||this.$pz===_d.$4Z.$45d?!1:!0},get_$1zF:function(){return this.$1zE},set_$1zF:function(n){if(this.$1zE!==n){this.$1zE=n;$3(this,_d.$4Z.$2QX)}return n},get_$8BD:function(){return this.$1xs},set_$8BD:function(n){if(this.$1xs!==n){this.$1xs=n;$3(this,_d.$4Z.$2PO)}return n},get_$aE:function(){return this.$pz===_d.$4Z.$2RM},$5dt:function(n){var t=$6(n);var i=$6(this.$21);return t&&i?!0:t||i?!1:n.get_$R()===this.$21.$4J.get_$R()},$5j:function(){if(!this.$7d){this.$7d=1;$4nC(this)}},$7H:function(){if(this.$7d===1){this.$7d=0;$4nD(this,null)}},$99d:function(){},$9Aq:function(){},$9Io:function(){},$1um:function(){return _d.$4Z.$cH},$34s:function(n,t){if(n===this.$21){this.set_$8BD(this.$21.$cp);if(!this.$21.$cp){if(this.$21.$1t.get_$B()){this.set_$120(_d.$4Z.$45d);if(this.$X4===1&&!this.$11&&!this.$40p){this.set_$22(this.$21.$1t.get_$3q(0));this.set_$1Mi(!0)}}else{this.$21.$1PF?this.set_$120(this.$1um()):this.set_$120($6v9(this));this.$X4===1&&this.$11&&this.set_$22(null)}this.$7d=1;this.set_$1zF(!0);$6v8(this,"LoadCompleted");this.$9Io()}}}};_d.$9q=function(n,t){this.$$d_$2Xg=Function.createDelegate(this,this.$2Xg);_d.$9q.initializeBase(this);this.$C=t;this.$7s=n;this.$177=_d.$9q.$2wJ();this.$Op=new _C(this.$$d_$2Xg,_a.$0.$EO);$4nk(this);if(this.$7s.get_$1H3()&&this.$7s.get_$1H3()!==1)throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.$7s.get_$1H3()));};_d.$9q.$5Bx=function(n,t){_a.$4.$l(n,"object1");_a.$4.$l(t,"object2");var i=n.$7s;var r=t.$7s;return i.get_$8q().$2R(r.get_$8q())};_d.$9q.$2wJ=function(){var n=_a.$7.get_$29();return new _a.$7(n.get_$3l(),n.get_$2z(),n.get_$51(),n.get_$DV(),n.get_$GJ(),0)};function $4nk(n){var i=null;n.$7s.get_$1H3()?n.$7s.get_$1H3()===1&&(i=n.$7s.get_$1H5()):i=n.$7s.get_$8q();var t=Math.floor(i.$5z(n.$177)/1e3);var r=_a.$7.$5QQ(t<0?-t:t,!0,!0);n.$32Z=t<0;if(t&&r.length){n.$2ej=r[1];n.$2ek=r[0]}else{n.$2ej=_nbs.NonBootStrings.l_Reminders_Now_UpperCase_Text;n.$2ek=""}$PB(n,"TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")}_d.$9q.prototype={$C:null,$Op:null,$7s:null,$177:null,$32Z:!1,$2ej:null,$2ek:null,get_$4aN:function(){var n="";this.$7s.get_$1H3()?this.$7s.get_$1H3()===1&&(n=this.$7s.get_$1H5().$2Z(18)):n=_a.$7.$118(this.$7s.get_$8q(),this.$177)&&_a.$7.$118(this.$7s.get_$8q(),this.$7s.get_$1Bd())?String.format(_nbs.NonBootStrings.l_Reminder_DurationLabel_Text,this.$7s.get_$8q().$2Z(18),this.$7s.get_$1Bd().$2Z(18)):String.format(_nbs.NonBootStrings.l_Reminder_DurationLabel_DifferentDay_Text,this.$7s.get_$8q().$2Z(18),this.$7s.get_$8q().$2Z(3));return n},get_$6ME:function(){return this.$177},set_$6ME:function(n){_a.$4.$l(n,"ReferenceDateTime");this.$177=n;return n},$6eP:function(){this.set_$6ME(_d.$9q.$2wJ());$4nk(this)},$2Xg:function(){if(this.$7s.get_$1H3()){if(this.$7s.get_$1H3()===1){var t={};t.ItemID=this.$7s.get_$i().Id;this.$C.$62(_d.$gk,null,t,_y.$48.get_$UP())}}else{var n=new _y.$Ax;n.$V5(this.$7s.get_$i());this.$C.$62(_d.$JU,null,n.$3K,_y.$48.get_$UP())}}};_d.$s1=function(n){_d.$s1.initializeBase(this);this.$C=n};_d.$s1.prototype={$C:null,$8A:function(n){return new _d.$9q(n,this.$C)}};_d.$5Z=function(n,t,i,r,u,f){this.$$d_$7x6=Function.createDelegate(this,this.$7x6);this.$$d_$9N9=Function.createDelegate(this,this.$9N9);this.$$d_$6B1=Function.createDelegate(this,this.$6B1);this.$$d_$5C5=Function.createDelegate(this,this.$5C5);this.$$d_$16E=Function.createDelegate(this,this.$16E);this.$$d_$5Bw=Function.createDelegate(this,this.$5Bw);_d.$5Z.initializeBase(this);_a.$4.$l(i,"nativeBridge");_a.$4.$l(i.$HA,"nativeBridge.Reminder");_a.$4.$l(r,"offlineSettings");_a.$4.$l(u,"userAgent");this.$4QE=n;this.$Lc=new _c.$LC;this.$Wv={};this.$6p=r;this.$13=u;this.$c=f;this.$Ep=new _a.$RL(this.$$d_$5Bw);this.$Ep.add_$1Z(this.$$d_$16E);this.$PW=new _a.$RL(this.$$d_$5C5);this.$12=i;if(t){var e=this;t.$IU(_a.$Dr,function(n){n.$2PS&&e.$4KQ()})}};function $4nm(n,t){for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=t[i].$7s;return r}function $4nl(n,t){var r=n.$Ep.$34(t);n.$Lc.$34(t.$7s);var i=t.$7s;!$6(i.get_$176())&&i.get_$176().Id in n.$Wv&&delete n.$Wv[i.get_$176().Id];return r}function $6ws(n,t){$CY(n,"BeforeRemindersRefresh",n,null);n.$167=_js.$J.get_$I().$4z(n.$167);n.$PW.$1r();n.$1tu=!1;var o=n.$Lc;n.$Lc=t.$2a0;for(var s=n.$Ep.get_$B(),u=0;u<s;u++)n.$Ep.get_$3q(u)&&n.$Ep.get_$3q(u).$1Q();n.$Ep.$1r();n.$Wv={};for(var h=_a.$7.get_utcNow(),i,f=-1,r=!1,e=n.$Lc.get_$B()-1;e>=0;e--){i=n.$Lc.get_$3q(e);if(i.get_$1H5().$J8().$2R(h)>0)n.$PW.$D(i);else{n.$Ep.get_$B()||(f=o.$71(i));var c=!!i.get_$176();if(!c||!(i.get_$176().Id in n.$Wv)){var l=n.$4QE.$8A(i);n.$Ep.$D(l);c&&(n.$Wv[i.get_$176().Id]=l);if(r)continue;r=f<0||!o.get_$3q(f).$4e(i)}f--}}r=!!(r|s!==n.$Ep.get_$B());r&&$CY(n,"ActiveRemindersChanged",n.$Ep,new _js.$II(4,0,[],[]));n.$PW.get_$B()>0&&$2hh(n,h);$2hi(n,t);n.$1tu=!0;$CY(n,"AfterRemindersRefresh",n,null)}function $6wr(n,t){_js.Trace.logInfo(_a.$0.$EO,"Scheduling reminders in PAL...");if(!n.$12.$HA.$Co)return!1;for(var i=t.get_$gq().Body.Reminders,u=[],f=i,o=f.length,r=0;r<o;++r){var e=f[r];e.ReminderGroup||Array.add(u,e)}_js.Trace.logInfo(_a.$0.$EO,"Serializing {0} reminders...",i.length);var s=JsonParser.serialize(u);_js.Trace.logInfo(_a.$0.$EO,"Scheduling {0} reminders on PAL...",i.length);var h=this,c=this;n.$12.$HA.$9fP(s,function(){_js.Trace.logInfo(_a.$0.$EO,"Schedule reminders on PAL succeeded.");$2hi(n,t)},function(i){_js.Trace.logError(_a.$0.$EO,"Failed to schedule reminders on PAL : {0}",i.message);$2hi(n,t)});return!0}function $2hi(n,t){n.$1AC&&(n.$1AC=_js.$J.get_$I().$4z(n.$1AC));if(n.$6p.get_$Lx()){_js.Trace.logInfo(_a.$0.$EO,"Offline is enabled and so no need to schedule reminders timer");return}if(t){if(!t.$17F||t.$17F===1){var u=_a.$7.get_utcNow();var i=null;n.$Lc.get_$B()===t.$xp&&n.$Lc.get_$B()>=1&&(i=n.$Lc.get_$3q(n.$Lc.get_$B()-1).get_$1H5().$J8());var f=u.$9K(288e5);var r=288e5;if(i)if(i.$2R(u)<=0)r=6e5;else if(i.$2R(f)<0){r=i.$5z(u);r=Math.max(r,6e5)}$4nn(n,r)}}else $4nn(n,6e5)}function $4nn(n,t){_js.Trace.logInfo(_a.$0.$EO,"Scheduling next GetReminers call to happen in {0} milliseconds",t);n.$1AC=_js.$J.get_$I().$1w(_a.$0.$EO,"GetReminders",n.$$d_$7x6,t)}function $2hh(n,t){n.$167=_js.$J.get_$I().$4z(n.$167);if(n.$PW.get_$B()){var i=n.$PW.get_$3q(n.$PW.get_$B()-1);var r=i.get_$1H5().$J8().$5z(t);var u=this;n.$167=_js.$J.get_$I().$1w(_a.$0.$EO,"ActivateReminders",function(){n.$53C(_a.$7.get_utcNow())},r)}}_d.$5Z.prototype={$6p:null,$4QE:null,$13:null,$c:null,$Lc:null,$Ep:null,$Wv:null,$PW:null,$167:null,$1AC:null,$q6:null,$1tu:!0,$12:null,add_$53H:function(n){this.$2N("ActiveRemindersChanged",n)},remove_$53H:function(n){this.$2P("ActiveRemindersChanged",n)},add_$57c:function(n){this.$2N("BeforeRemindersRefresh",n)},remove_$57c:function(n){this.$2P("BeforeRemindersRefresh",n)},add_$54w:function(n){this.$2N("AfterRemindersRefresh",n)},remove_$54w:function(n){this.$2P("AfterRemindersRefresh",n)},$4KQ:function(){var n=this.$c.get_$1I().get_$1tC();var t=this.$c.get_$6H().get_$1k();var i=this.$c.get_$6H().get_$2eU();var r;r=this.$13.get_$67()?this.$c.get_$6H().get_$1k():n&&(t||i);if(!r){_js.Trace.logInfo(_a.$0.$EO,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",n,this.$13.get_$67(),t,i);return}this.$9sg();if(this.$6p.get_$Lx())_js.Trace.logInfo(_a.$0.$EO,"Fetch reminders on OwaStarted event skipped as offline is enabled.");else{_js.Trace.logInfo(_a.$0.$EO,"Fetch reminders on OwaStarted event.");this.$wc(0,null)}},$wc:function(n,t){_js.Trace.logInfo(_a.$0.$EO,"Calling GetReminders. ReminderType = {0}",n);n&&n!==1||$2hi(this,null);this.$q6=_js.$J.get_$I().$4z(this.$q6);var i=new _c.$X0(this.$13.get_$67(),this.$c.get_$6H());i.$17F=n;i.set_$5jq(this.$13.get_$L5()?64:200);var r=_a.$7.get_$29();switch(n){case 0:i.$8B=r.$2o(10);break;case 1:i.$1pl=r.$9K(_d.$5Z.$4IV);i.$8B=i.$8B=r.$2o(10);break;case 2:i.$8B=r.$9K(_d.$5Z.$4IV);break}i.add_$2C(this.$$d_$6B1);if(t){var u=this;i.add_$2m(function(n){t()})}OwaApplication.$1W.$z(i)},$2sH:function(n){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$EO,"DismissReminders called with no reminder to dismiss");return}var i=new _c.$vF(this.$Lc,$4nm(this,n),this.$12.$HA);OwaApplication.$1W.$z(i);for(var t=0;t<n.length;t++){$4nl(this,n[t]);n[t].$1Q()}$2hh(this,_a.$7.get_utcNow())},$2sB:function(){this.$2sH(this.$Ep.$6Z())},$3Pb:function(n,t){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$EO,"SnoozeReminders called with no reminders to snooze");return}var u=new _c.$109($4nm(this,n),t,this.$12.$HA);OwaApplication.$1W.$z(u);for(var f=_a.$7.get_utcNow(),i,r=0;r<n.length;r++){i=n[r];$4nl(this,i);this.$PW.$D(i.$7s);this.$Lc.$D(i.$7s)}$2hh(this,f)},$53C:function(n){for(var t=[],i,r,u,f=this.$PW.get_$B()-1;f>=0;f--){i=this.$PW.get_$3q(f);r=this.$4QE.$8A(i);if(i.get_$1H5().$J8().$2R(n)<=0){var e=i.get_$176()?i.get_$176().Id:"";if(this.$Wv[e]){u=this.$Wv[e];this.$Ep.$34(u);u.$1Q();this.$Wv[e]=r}Array.add(t,r)}else break}if(t.length>0){this.$Ep.$69(t);this.$PW.$V3(this.$PW.get_$B()-t.length,t.length)}$2hh(this,n)},$9sg:function(){_js.Trace.logInfo(_a.$0.$EO,"Subscribe for reminders notifications.");var n=new _g.$At;n.NotificationType="ReminderNotification";var t=new _h.$BS(n);t.$IU(_a.$0.$EO,"ReminderNotification",this.$$d_$9N9,0)},$5C5:function(n,t){return _c.$LC.$2or(t,n)},$5Bw:function(n,t){return _d.$9q.$5Bx(t,n)},$16E:function(n,t){this.$1tu&&$CY(this,"ActiveRemindersChanged",n,t)},$9N9:function(n){_a.$4.$J(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_js.Trace.logInfo(_a.$0.$EO,"Received reminder notification");var t=n;if(t.shouldGetReminders){this.$q6&&(this.$q6=_js.$J.get_$I().$4z(this.$q6));var i=this;this.$q6=_js.$J.get_$I().$1w(_a.$0.$EO,"ReminderNotification",function(){i.$wc(0,null)},8e3)}},$6B1:function(n){var t=n;_js.Trace.logInfo(_a.$0.$EO,"GetReminders succeeded. Received {0} reminders",t.$2a0.get_$B());$6wr(this,t)||$6ws(this,t)},$7x6:function(){_js.Trace.logInfo(_a.$0.$EO,"GetReminers timer expired");this.$wc(0,null)}};_d.$7V=function(n){this.$$d_$6FM=Function.createDelegate(this,this.$6FM);this.$$d_$6dg=Function.createDelegate(this,this.$6dg);this.$$d_$2sB=Function.createDelegate(this,this.$2sB);this.$$d_$5JJ=Function.createDelegate(this,this.$5JJ);this.$$d_$6EF=Function.createDelegate(this,this.$6EF);this.$$d_$6E0=Function.createDelegate(this,this.$6E0);this.$$d_$68X=Function.createDelegate(this,this.$68X);this.$$d_$68y=Function.createDelegate(this,this.$68y);this.$$d_$16E=Function.createDelegate(this,this.$16E);_d.$7V.initializeBase(this);this.$Oy=n;n.$Ep.add_$1Z(this.$$d_$16E);n.add_$57c(this.$$d_$68y);n.add_$54w(this.$$d_$68X);this.$FO=new _js.$Z;this.$FO.$Y("Count",this.$$d_$6E0);this.$tR=[];var t=this;this.$2dS=new _C(this.$$d_$6EF,_d.$7V.$A,this,"CanActOnSelectedReminders",function(){return t.get_$1qQ()});var i=this;this.$2JQ=new _C(this.$$d_$5JJ,_d.$7V.$A,this,"CanActOnSelectedReminders",function(){return i.get_$1qQ()});this.$2sC=new _C(this.$$d_$2sB,_d.$7V.$A);this.$e9=new _C(this.$$d_$6dg,_d.$7V.$A);this.$3Gk=new _C(this.$$d_$6FM,_d.$7V.$A);this.$BE=new _js.$Z;$6wt(this);$3XH(this,!1);if(_y.$v.$v.get_$L()!=="Mouse"){var r=[new _y.$2W(_y.$c.get_$gm(),_y.$c.get_$277(),_nbs.NonBootStrings.l_Snooze_Text,this.$2dS),new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_u.Strings.l_Dismiss_Text,this.$2JQ)];this.set_$7D(_y.$26.$E(this,r,null))}};function $6wv(n){for(var i,r=n.$Oy.$Ep,t=0;t<r.get_$B();t++){i=r.get_$3q(t);i.$6eP()}}function $3XH(n,t){var i=[];if(n.$GT&&n.$FO.get_$B()===1){var u=_a.$7.get_$29();var f=n.$GT.$7s.get_$8q().$BX(-15);u.$2R(f)<=0&&Array.add(i,-15);u.$2R(f.$BX(5))<=0&&Array.add(i,-10);u.$2R(f.$BX(10))<=0&&Array.add(i,-5);u.$2R(n.$GT.$7s.get_$8q())<=0&&Array.add(i,0)}if(!i.length||i[0]!==n.$BE.get_$3q(0)){for(var r=0;r<n.$BE.get_$B();r++)if(n.$BE.get_$3q(r)===5)break;n.$BE.$V3(0,r);i.length>0&&n.$BE.$a5(0,i)}(n.$tt<n.$BE.get_$3q(0)||t)&&n.set_$3Ma(n.$BE.get_$3q(0))}function $6wt(n){n.$BE.$D(5);n.$BE.$D(10);n.$BE.$D(15);n.$BE.$D(30);n.$BE.$D(60);n.$BE.$D(120);n.$BE.$D(240);n.$BE.$D(480);n.$BE.$D(720);n.$BE.$D(1440);n.$BE.$D(2880);n.$BE.$D(4320);n.$BE.$D(5760);n.$BE.$D(10080);n.$BE.$D(20160)}function $6wu(n,t){if(t>0)n.$Oy.$3Pb(n.$FO.$6Z(),_a.$7.get_$29().$BX(t));else{var i=n.$GT.$7s.get_$8q().$BX(t);n.$Oy.$3Pb([n.$GT],i)}}_d.$7V.prototype={$e9:null,$Oy:null,$GT:null,$FO:null,$BE:null,$tt:0,$2dS:null,$2JQ:null,$2sC:null,$3Gk:null,$tR:null,get_$Ld:function(){return _y.$v.$v.get_$L()!=="Mouse"?_y.$1KT.prototype.get_$Ld.call(this):0},add_$6Mn:function(n){this.$2N("ReminderOpened",n)},remove_$6Mn:function(n){this.$2P("ReminderOpened",n)},get_$dg:function(){return this.$GT},set_$dg:function(n){if(this.$GT!==n){this.$GT=n;$3(this,"SelectedReminder");$3XH(this,!0)}return n},get_$3Ma:function(){return this.$tt},set_$3Ma:function(n){if(n!==this.$tt){this.$tt=n;$3(this,"SelectedSnoozeTime")}return n},get_$6Rh:function(){return this.$FO},set_$6Rh:function(n){this.$FO!==n&&(this.$FO=n);return n},get_$MM:function(){return 2},get_$1qQ:function(){return this.$FO.get_$B()>0},$6dg:function(){$6wv(this);$3XH(this,!1)},$6FM:function(){if(this.$GT&&this.$GT.$Op.$2M){this.$GT.$Op.$n();$CY(this,"ReminderOpened",this.$GT,null)}},$6E0:function(n,t){$3(this,"CanActOnSelectedReminders")},$68y:function(n,t){Array.clear(this.$tR);for(var r,u,i=0;i<this.$FO.get_$B();i++){r=this.$FO.get_$3q(i);u=r.$7s.get_$i().Id;Array.add(this.$tR,u)}this.set_$dg(null);this.$FO.$1r();return},$68X:function(n,t){var i=n.$Ep;var e;var u;var r;if($6(this.$GT)){for(var f=0;f<this.$tR.length;f++){e=this.$tR[f];var o=this;u=i.$DY(function(n){return _d.$9q.isInstanceOfType(n)&&n.$7s.get_$i().Id===e});if(u<i.get_$B()){r=i.get_$3q(u);$6(this.$GT)&&this.set_$dg(r);this.$FO.$71(r)===-1&&this.$FO.$D(r)}}$6(this.$GT)&&this.set_$dg(i.get_$3q(0));Array.clear(this.$tR)}},$16E:function(n,t){var u=!1;var f=!1;var i=n;switch(t.$2v){case 0:return;case 2:for(var r=0;r<t.$38.length;r++){u=!!(u|this.$FO.$34(t.$38[r]));f=!!(f|t.$38[r]===this.$GT)}if(f||u&&!this.$FO.get_$B()){var e=t.$4V+t.$38.length-1;i.get_$B()>e?this.set_$dg(i.get_$3q(e)):i.get_$B()>0?this.set_$dg(i.get_$3q(i.get_$B()-1)):this.set_$dg(null)}break;case 3:this.$16E(n,new _js.$II(2,t.$4V,null,t.$38));this.$16E(n,new _js.$II(0,t.$4V,t.$2l,null));break;case 4:this.set_$dg(null);this.$FO.$1r();break;default:throw Error.argumentOutOfRange("evtArgs.Action");}},$6EF:function(){$6wu(this,this.$tt)},$5JJ:function(){this.$Oy.$2sH(this.$FO.$6Z())},$2sB:function(){this.$Oy.$2sB()}};_d.$1Bh=function(n,t,i,r,u){this.$$d_$870=Function.createDelegate(this,this.$870);_d.$1Bh.initializeBase(this,[u]);this.$35u=n;this.$2eb=t;this.$9O=i;this.$1p=r};_d.$1Bh.prototype={$35u:0,$2eb:0,$kU:1,$9O:null,$3vh:!1,$1p:null,$y:function(){_js.Trace.logInfo(_a.$0.$5d,"RetryTimer.Start");this.$3vh=!1;this.$1w(this.$$d_$870,this.$2eb,this.$1p)},$1u:function(){_js.Trace.logInfo(_a.$0.$5d,"RetryTimer.End");this.$3vh=!0;this.$kU=this.$35u;this.$3h1()},$870:function(){_js.Trace.logInfo(_a.$0.$5d,"RetryTimer.Callback: count {0}",this.$kU);this.$9O();if(this.$kU<this.$35u){this.$kU++;this.$1w(this.$$d_$870,this.$2eb,this.$1p)}else{_js.Trace.logInfo(_a.$0.$5d,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$kU,this.$35u);this.$1u()}}};_d.$Q0=function(n,t,i,r){this.$2I6=this.$$gta["_d.$Q0"].T===Number||Type.isEnum(this.$$gta["_d.$Q0"].T)?0:this.$$gta["_d.$Q0"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.$2I6=n;this.$5du=t;this.$6UJ=i;this.$6d5=r};_d.$Q0.$$=function(n){var t="$Q0"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Q0"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Q0.apply(this,i)};r.registerClass("_d."+t);var u=_d.$Q0.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$Q0.prototype={$5du:null,$6UJ:null,$6d5:null,$6I:function(n){if(!this.$5du(this.$2I6)){var t=this;n.$3JI(function(n){n?t.$2I6=t.$6UJ():t.$6d5(t.$2I6)})}}};_d.$12g=function(n,t){_d.$12g.initializeBase(this,[t]);this.$5Bn=n};_d.$12g.prototype={$5Bn:null,$9N2:function(){if(this.$Yr.get_$B()===1){var n=this.$Yr.get_$3q(0);this.$5Bn.$9CW(n)}},$7ev:function(){this.$wq.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint1_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint2_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint3_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint4_Text);this.$V9=new _d.$39(new(_d.$V3.$$(_c.$12f))(this.$QS),_nbs.NonBootStrings.l_SpeechCombinedScenarioListening_Text,_nbs.NonBootStrings.l_SpeechCombinedScenarioWithExample_Text,this.$wq);this.$V9.$2zd=_nbs.NonBootStrings.l_SpeechInvalidRequest_Text}};_d.$1AS=function(n,t,i){this.$$d_$1RZ=Function.createDelegate(this,this.$1RZ);this.$$d_$9Pq=Function.createDelegate(this,this.$9Pq);_d.$1AS.initializeBase(this,[i]);this.$53D=n;this.$69B=t;if(this.get_$43E()){this.$V9.set_$2dj(new _C(this.$$d_$9Pq,_a.$0.$S3));this.$V9.add_$5f8(this.$$d_$1RZ)}};_d.$1AS.prototype={$53D:null,$69B:null,$9N2:function(){},$7ev:function(){this.$wq.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint1_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint2_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint3_Text);this.$wq.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint4_Text);this.$V9=new _d.$39(new(_d.$V3.$$(_c.$14h))(this.$QS),_nbs.NonBootStrings.l_SpeechSayAContactName_Text,_nbs.NonBootStrings.l_SpeechSayAContactNameWithExample_Text,this.$wq);this.$V9.set_$67D(_nbs.NonBootStrings.l_SpeechFindPeopleNoResultsAvailable_Text)},$5j:function(){this.$V9.$5j()},$9Pq:function(){this.$5j();this.$53D()},$1RZ:function(n,t){if(!n.get_$DX()){this.$V9.$4Ok||this.$69B();this.$V9.$7H()}}};_d.$yp=function(){this.$1VO=""};_d.$yp.prototype={$3tY:function(n){return new _c.$1AT(this.$1VO,n)}};_d.$1Ka=function(n){this.$$d_$1RZ_4=Function.createDelegate(this,this.$1RZ_4);this.$$d_$5j=Function.createDelegate(this,this.$5j);_d.$1Ka.initializeBase(this);_a.$4.$l(n,"speechManager");this.$QS=n;if(this.get_$43E()){this.$wq=new _js.$Z;this.$Yr=new _js.$Z;this.$7ev();this.$V9.set_$2dj(new _C(this.$$d_$5j,_a.$0.$S3));this.$V9.add_$5f8(this.$$d_$1RZ_4)}else this.$V9=null};_d.$1Ka.prototype={$QS:null,$V9:null,$Yr:null,$xh:null,$wq:null,get_$43E:function(){return this.$QS.get_$43E()&&_g.$V.get_$I().get_$31().get_$5ey()},$5j:function(){this.$Yr.$1r();this.$xh=this.$V9.$3tY(this.$Yr);this.$V9.$5j();this.$xh&&OwaApplication.$1W.$z(this.$xh)},$1RZ_4:function(n,t){if(!n.get_$DX()){this.$9N2();this.$V9.$7H()}}};_d.$V3=function(n){_a.$4.$l(n,"speechManager");this.$QS=n};_d.$V3.$$=function(n){var t="$V3"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$V3"]={TAction:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$V3.apply(this,i)};r.registerClass("_d."+t,null,_y.$17Y);var u=_d.$V3.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$V3.prototype={$QS:null,$3tY:function(n){var t=new this.$$gta["_d.$V3"].TAction;t.$49(this.$QS,n);return t}};_d.$39=function(n,t,i,r){this.$$d_$9Pn=Function.createDelegate(this,this.$9Pn);this.$$d_$9Po=Function.createDelegate(this,this.$9Po);this.$$d_$3Ew=Function.createDelegate(this,this.$3Ew);this.$$d_$3Q9=Function.createDelegate(this,this.$3Q9);this.$$d_$83O=Function.createDelegate(this,this.$83O);this.$$d_$9b=Function.createDelegate(this,this.$9b);_d.$39.initializeBase(this);this.set_$DP(this);this.$4eE=t;this.$6gW=i;this.$6YO=r;this.$1oR=n;this.set_$G1(new _C(this.$$d_$9b,_a.$0.$S3));this.set_$83K(new _C(this.$$d_$83O,_a.$0.$S3));this.$2xo=!1;this.set_$6ZD(new _C(this.$$d_$3Q9,_a.$0.$S3));this.set_$2kS(new _js.$Z);this.$2zd=_nbs.NonBootStrings.l_SpeechInvalidRequest_Text;this.set_$3P0(!0)};_d.$39.$9Hj=function(n){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnIsErrorChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$3LL.set_$q(!n.newValue);t.$11j.set_$q(!n.newValue)};_d.$39.$9Hq=function(n){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnIsListeningChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$VU.set_$q(!n.newValue);t.$2wl.set_$q(!n.newValue)};_d.$39.$9Hv=function(n){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnIsThinkingChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$VU.set_$q(!n.newValue)};function $6xe(n,t){$4o8(n);switch(_a.$4d.$3s8(t).$24L){case 1e3:$3XQ(n);n.set_$4v(n.get_$67D());n.set_$3P0(!1);break;case 1:$3XQ(n);n.set_$4v(_nbs.NonBootStrings.l_SpeechHintTitle_Text);n.set_$3P0(!1);n.$2xo=!1;break;case 1003:$3XQ(n);n.set_$4v(n.$2zd);break;case 5:n.set_$4v(_nbs.NonBootStrings.l_SpeechNoNetworkAccess_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text);break;case 4:case 3:n.set_$4v(_nbs.NonBootStrings.l_SpeechRecordingError_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechNoMicrophone_Text);break;case 1002:n.set_$4v(_nbs.NonBootStrings.l_SpeechRecordingError_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechNoSpeech_Text);break;case 1006:n.set_$4v(_nbs.NonBootStrings.l_SpeechNoResultsAvailable_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechNoContactWithEmailAddress_Text);break;case 6:n.set_$4v(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechServerBusy_Text);break;case 1005:n.set_$4v(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$uC(_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text);break;case 1004:n.set_$4v(n.$2zd);n.set_$uC(_nbs.NonBootStrings.l_SpeechMaxRequestsExceeded_Text);break;default:n.set_$4v(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$uC(t.message);break}}function $3XQ(n){n.set_$uC(n.$6gW);n.set_$2kS(n.$6YO)}function $4o8(n){n.set_$uC("");n.set_$4v("");n.set_$2kS(null);n.$4Ok=!1;n.set_$3P0(!0)}function $6xf(n){n.set_$Sc(new _js.$Z);n.$3LL=new _a.$2G(n.get_$2dj(),_u.Strings.l_Retry_Text);n.$3LL.set_$q(!0);n.$7J.$D(n.$3LL);n.$2wl=new _a.$2G(n.get_$6ZD(),_nbs.NonBootStrings.l_Go_Text);n.$2wl.set_$q(!0);n.$7J.$D(n.$2wl);n.$VU=new _a.$2G(n.$4d,_u.Strings.l_ConfirmDialog_Cancel_Text);n.$VU.set_$q(!0);n.$7J.$D(n.$VU);n.$11j=new _a.$2G(n.$4d,_u.Strings.l_Close_Text);n.$11j.set_$q(!0);n.$7J.$D(n.$11j)}_d.$39.prototype={$Wn:null,$3LL:null,$2wl:null,$VU:null,$11j:null,$6YO:null,$4eE:null,$6gW:null,$2zd:null,$4Ok:!1,$3Oz:!1,$2xk:null,$1oR:null,$2xo:!1,add_$5f8:function(n){this.$Y(_d.$39.$2QM.$1n,n)},remove_$5f8:function(n){this.$u(_d.$39.$2QM.$1n,n)},get_$2dj:function(){return this.$U(_d.$39.$4Xs)},set_$2dj:function(n){this.$K(_d.$39.$4Xs,n);return n},get_$6ZD:function(){return this.$U(_d.$39.$4Y6)},set_$6ZD:function(n){this.$K(_d.$39.$4Y6,n);return n},get_$1xV:function(){return this.$U(_d.$39.$40I)},set_$1xV:function(n){this.$K(_d.$39.$40I,n);return n},get_$DX:function(){return this.$U(_d.$39.$2QM)},set_$DX:function(n){this.$K(_d.$39.$2QM,n);return n},get_$41I:function(){return this.$U(_d.$39.$41J)},set_$41I:function(n){this.$K(_d.$39.$41J,n);return n},get_$43X:function(){return this.$U(_d.$39.$43Y)},set_$43X:function(n){this.$K(_d.$39.$43Y,n);return n},get_$42r:function(){return this.$U(_d.$39.$42s)},set_$42r:function(n){this.$K(_d.$39.$42s,n);return n},get_$uC:function(){return this.$U(_d.$39.$4Xy)},set_$uC:function(n){this.$K(_d.$39.$4Xy,n);return n},get_$67D:function(){return this.$U(_d.$39.$4Hi)},set_$67D:function(n){this.$K(_d.$39.$4Hi,n);return n},get_$2kS:function(){return this.$U(_d.$39.$3cd)},set_$2kS:function(n){this.$K(_d.$39.$3cd,n);return n},get_$6YQ:function(){return this.$U(_d.$39.$4Xc)},set_$6YQ:function(n){this.$K(_d.$39.$4Xc,n);return n},get_$6YN:function(){return this.$Wn},set_$6YN:function(n){if(n){if(this.$Wn)throw Error.invalidOperation("SpeechAction cannot be set while another speech action is active");this.$Wn=n;this.$Wn.add_$2m(this.$$d_$3Ew);this.$Wn.$QS.add_$6Z0(this.$$d_$9Po);this.$Wn.$QS.add_$5h2(this.$$d_$9Pn)}else if(this.$Wn){this.$Wn.remove_$2m(this.$$d_$3Ew);this.$Wn.$QS.remove_$6Z0(this.$$d_$9Po);this.$Wn.$QS.remove_$5h2(this.$$d_$9Pn);this.$Wn=null}return n},get_$3P0:function(){return this.$3Oz},set_$3P0:function(n){if(this.$3Oz!==n){this.$3Oz=n;$3(this,"ShowShortPanelSize")}return n},get_$83K:function(){return this.$2xk},set_$83K:function(n){if(this.$2xk!==n){this.$2xk=n;$3(this,"HelpCommand")}return n},$3tY:function(n){this.set_$6YN(this.$1oR.$3tY(n));return this.$Wn},$5j:function(){$6xf(this);this.set_$4v(this.$4eE)},$7H:function(){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.Deactivate");this.$9b()},$9Po:function(n){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnSpeechStateChanged: {0}",_a.$sZ.toString(n));$4o8(this);this.set_$41I(n===1);this.set_$43X(n===2);if(this.get_$41I()){this.set_$1xV(!1);this.set_$42r(!1);this.set_$4v(this.$4eE);this.set_$DX(!0)}else if(this.get_$43X()){this.set_$4v(_nbs.NonBootStrings.l_SpeechThinkingState_Text);this.set_$uC(_nbs.NonBootStrings.l_SpeechPleaseWait_Text);this.$Wn.$5iF("Thinking")}},$9Pn:function(n){this.set_$6YQ(n)},$3Q9:function(){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.StopListening");this.$Wn.$3Q9()},$9b:function(){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.Cancel");this.set_$DX(!1);if(this.$Wn){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.Cancel: speechAction != null calling SpeechAction.Cancel()");this.$Wn.$9b()}},$83O:function(){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.HelpPressed");this.$2xo=!0;this.$Wn.$9b()},$3Ew:function(n){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnActionCompleted");var t=this.$Wn.$1f;this.$Wn.$Yr.get_$B()>0&&(this.$4Ok=!0);this.set_$6YN(null);this.set_$1xV(!1);if(!$6(t)){_js.Trace.logInfo(_a.$0.$S3,"SpeechInputViewModel.OnActionCompleted: Error:{0}",t.message);if(!_a.$4d.$UH(t)||this.$2xo){this.set_$1xV(!0);$6xe(this,t);this.set_$42r(_a.$4d.$42r(t))}}this.set_$DX(this.get_$1xV())}};_d.$OR=function(n){_d.$OR.initializeBase(this);this.$NA=n};function $6xy(n){var t=!1;switch(n.$7n){case 1:n.$2E=n.$W6.$2Z(10);t=n.$W6.get_$8B7();n.set_$3wg(!t);n.$NA==="Mouse"?n.set_$43u(n.$W6.$2Z(3)):n.$NA==="TouchWide"&&n.set_$4UN(t?_a.$7.$3sV(n.$W6.$2o(1).get_$2z(),1):null);break;case 2:n.$2E=_a.$7.$3sV(n.$W6.get_$2z(),1);t=n.$W6.get_$2z()===11;n.set_$3wg(!t);n.$NA==="Mouse"?n.set_$43u(n.$W6.$2Z(2)):n.$NA==="TouchWide"&&n.set_$4UN(t?n.$W6.$HM(1).$2Z(13,1):null);break;case 3:var i=_a.$7.$Ky(n.$W6);var r=i.$2o(6);n.$2E=_a.$7.$7xy(i,r);n.set_$3wg(!0);n.set_$4UN(null);n.$NA==="Mouse"&&n.set_$43u(_a.$7.$2Lo(i,r));break;default:throw Error.argumentOutOfRange("mode",n.$7n,"GenerateTextValue() should not be called before the TimeStripMode has been set.");}if(n.$NA==="Mouse"){var u=n.$2E.replace(" ","");if(n.$2E!==u){n.$2E=u;if(!_d.$OR.$45t){_js.Trace.logWarning(_a.$0.$1k,"Removing space character from localized time strip item. This is only expected for for pesudo-localized builds.");_d.$OR.$45t=!0}}}}_d.$OR.prototype={$2E:null,$1kM:null,$43t:null,$2yI:!0,$7n:0,$W6:null,$NA:0,get_$43u:function(){return this.$43t},set_$43u:function(n){this.$43t=n;$3(this,"ItemAriaLabel");return n},get_$51:function(){return this.$W6},set_$51:function(n){this.$W6=n;$6xy(this);return n},get_$3wg:function(){return this.$2yI},set_$3wg:function(n){if(n!==this.$2yI){this.$2yI=n;$3(this,"HideSeparator")}return n},get_$4UN:function(){return this.$1kM},set_$4UN:function(n){if(n!==this.$1kM){this.$1kM=n;$3(this,"SeparatorText")}return n}};_d.$10e=function(n){this.$2D=n};_d.$10e.prototype={$2D:null,$1NO:null,$1w:function(n,t,i){this.$1NO=_js.$J.get_$I().$1w(i,this.$2D,n,t)},$3h1:function(){this.$1NO&&(this.$1NO=_js.$J.get_$I().$4z(this.$1NO))}};_d.$WE=function(n,t,i,r,u,f,e){this.$$d_$8GJ=Function.createDelegate(this,this.$8GJ);this.$C=n;this.$c=t;this.$M=i;this.$BA=r;this.$2L=u;this.$7L=f;this.$OG=e};function $6rn(n){var i="archiverecoverableitemsdeletions";var t=new _h.$jF("GetFolderAction_DumpsterPopOutViewModelFactory_"+i,!1);t.$1aH=new _h.$WR;t.$fK=[new _g.$7P(i)];t.add_$2m(n.$$d_$8GJ);OwaApplication.$1W.$z(t)}_d.$WE.prototype={$BA:null,$2L:null,$7L:null,$C:null,$c:null,$M:null,$1ZW:null,$OG:null,$bC:function(n,t){var i=n.IsArchive.toString()==="true";this.$1ZW=new _d.$vN(new _d.$DI(this.$C,this.$c,this.$M,this.$BA,this.$2L,this.$7L,this.$OG));if(i&&!_g.$h.$1i.nameToId("archiverecoverableitemsdeletions"))$6rn(this);else{var r=i?_g.$2X.$Bi("archiverecoverableitemsdeletions"):_g.$2X.$Bi("recoverableitemsdeletions");this.$1ZW.$f6.set_$2x(r);this.$1ZW.$f6.$US(0)}return this.$1ZW},$vo:function(n,t){throw Error.notImplemented("Creating from context is not supported");},$62:function(n){var t={};t.IsArchive=n;this.$C.$62(_d.$WE,null,t,_y.$48.get_$w9())},$8GJ:function(n){var t=n;t.remove_$2m(this.$$d_$8GJ);if(t.$1f){this.$1ZW.$f6.set_$Rz(11);return}this.$1ZW.$f6.set_$2x(t.$1aH.get_$3q(0));this.$1ZW.$f6.$US(0)}};_d.$WE.$4O4=function(n){this.$fG=n;var t=this;this.$fG.$M.$IU(_y.$sW,function(n){t.$fG.$62(n.$2G.get_$BK()==="archivedeleteditems")})};_d.$WE.$4O4.prototype={$fG:null};_d.$oQ=function(n,t,i){this.$1i=n;this.$OE=t;this.$1J=i||null};_d.$oQ.prototype={$1i:null,$OE:null,$1J:null,$5FJ:function(n,t){return new _d.$Bh(n,this.$1i,t,this.$OE)},$5EH:function(n){return new _d.$14Y(this.$OE,n,this.$1J)}};_d.$14Y=function(n,t,i){this.$OE=n;this.$1Ms=t;this.$1J=i||null};_d.$14Y.prototype={$OE:null,$1J:null,$1Ms:0,$7mK:function(n,t){_a.$6.stPT(_a.$0.$5d,"AppActivationInComposeForm",5);for(var a=_a.$6.$1c(_a.$0.$5d,"AppActivationInComposeForm",!0),v=_a.$7.get_$29(),u=new(_0365f.$o.$$(_d.$G3)),r=0;r<n.length;r++){var f=n[r];var i;var e,o;if(o=_d.$G3.$6cX(f,new _d.$vS(this.$OE,this.$1Ms),e={val:i}),i=e.val,o){var s=null;var y=_a.$7.get_$29();var h,c;var l=i.$1W5?(c=i.$1W5.$2tV(null,i.$mG,h={val:s}),s=h.val,c):!1;var p=_a.$7.get_$29();l&&u.$D(i);this.$OE.$6c1(f.Id,p.$5z(y),l)}}this.$OE.$6c7(_a.$7.get_$29().$5z(v));t(u);this.$Au();this.$OE.$5Nb();_a.$6.$1E(a,"AppActivationInComposeForm");_a.$6.endPT("AppActivationInComposeForm")},$9mK:function(){return!!this.$1J&&this.$1J.$3u("ComposeApps")},$Au:function(){}};_d.$Bh=function(n,t,i,r){this.$P=n;this.$5aI=i;this.$OE=r;this.$1i=t};function $6s5(n,t){if(!_d.$Bh.$2Wg){_d.$Bh.$2Wg={};for(var i=0;i<_d.$Bh.$4HY.length;i++){var u=_d.$Bh.$4HY[i];var r=n.$1i.nameToId(u);r&&(_d.$Bh.$2Wg[r.Id]=!0)}}return!(t in _d.$Bh.$2Wg)}function $4lS(n,t){if(n.$1tX){_a.$6.stPT(_a.$0.$5d,"AppActivationInReadingPane",5);var h=_a.$6.$1c(_a.$0.$5d,"AppActivationInReadingPane",!0);var u=new(_0365f.$o.$$(_d.$G3));n.$OE.$6c3(n.$P.get_$3J6(),n.$P.get_$12l());for(var c=_a.$7.get_$29(),f=null,r=0;r<n.$1tX.get_$B();r++){var i=n.$1tX.get_$3q(r);var l=_a.$7.get_$29();var e,o;var s=(o=$6s6(n,i,e={val:f}),f=e.val,o);var a=_a.$7.get_$29();if(s){u.$D(i);i.$9jJ(n.$P.get_$12l())}n.$OE.$6c1(i.$6b.Id,a.$5z(l),s)}n.$OE.$6c7(_a.$7.get_$29().$5z(c));t(u);n.$Au();n.$OE.$5Nb();_a.$6.$1E(h,"AppActivationInReadingPane","");_a.$6.endPT("AppActivationInReadingPane")}}function $6s6(n,t,i){if($6(t)||$6(t.$1W5))return!1;var r=!1;t.$mG.$2Zu={};r=!!(r|t.$1W5.$2tV(n.$P,t.$mG,i));return r}function $6s4(n,t){var i=new _c.$vw(n.$P);var r=this;i.add_$2C(function(i){$4lS(n,t)});OwaApplication.$1W.$z(i)}_d.$Bh.prototype={$5aI:!1,$P:null,$OE:null,$1tX:null,$1i:null,$7mK:function(n,t){var u=!0;this.$1tX=new(_0365f.$o.$$(_d.$G3));for(var r=0;r<n.length;r++){var s=n[r];var f=new _d.$vS(this.$OE,1);f.$mj=this.$5aI;var i;var e,o;if(o=_d.$G3.$6cX(s,f,e={val:i}),i=e.val,o){this.$1tX.$D(i);i.$1W5&&(i.$1W5.$5bs(this.$P,i.$mG)||(u=!1))}}u?$4lS(this,t):$6s4(this,t)},$9mK:function(){if(this.$P.get_$5n()||this.$P.get_$Cx())return!1;if(this.$P.get_$8n()){var n=this.$P.get_$8n().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$P.get_$28()&&!$6s5(this,this.$P.get_$28().Id)?!1:!0},$Au:function(){this.$1tX=null}};_d.$tU=function(n,t,i,r){this.$$d_$A1S=Function.createDelegate(this,this.$A1S);this.$$d_$7RT=Function.createDelegate(this,this.$7RT);_d.$tU.initializeBase(this,[i,r]);this.$Cd=n;this.$1KD=t};_d.$tU.$7tf=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_d.$tU.prototype={$Cd:null,$1KD:null,$1K8:null,$7mk:function(){var n;if(!this.$9xc()){$pB(this);return}var t,i,r;if(r=this.$9x3(t={val:n},i={val:this.$1K8}),n=t.val,this.$1K8=i.val,r){this.$1K8.add_$7q(this.$$d_$7RT);this.$1K8.add_$1Rd(this.$$d_$A1S)}else{$pA(this,n,null);return}},$A1S:function(n){this.$1K8.remove_$1Rd(this.$$d_$A1S);if(n.get_$6FQ()){var t=_d.$tU.$7tf(n.get_$2FG());$pA(this,t,null);return}var i=this.$1KD.$D(this.$1K8);$hR(this,i,null)},$7RT:function(n,t){if(t==="IsDeleted"&&this.$1K8.get_$146()){this.$1K8.remove_$7q(this.$$d_$7RT);$pA(this,9006,null)}}};_d.$11B=function(n,t,i,r){_d.$11B.initializeBase(this,[n,t,i,r])};_d.$11B.prototype={get_$WR:function(){return"AddItemAttachment"},get_$6He:function(){return 3},$9xc:function(){var n=this.$10.itemId;var t=this.$10.name;if(_js.$9.$a(n)||_js.$9.$a(t)){_js.Trace.logError(_a.$0.$5d,"AddItemAttachment got null or empty itemId or name");return!1}else if(n.length>200||t.length>255){_js.Trace.logError(_a.$0.$5d,"AddItemAttachment got too long itemId or name");return!1}else return!0},$9x3:function(n,t){var r=this.$10.itemId;var u=this.$10.name;var i=new _g.$8z;i.set_$i(new _g.$1q(r));i.set_$1L(u);i.set_$6D(!1);i.set_$4k(0);t.val=this.$Cd.$53q(i,n);return!!t.val}};_d.$119=function(n,t,i,r){_d.$119.initializeBase(this,[n,t,i,r])};_d.$119.prototype={get_$WR:function(){return"AddFileAttachment"},get_$6He:function(){return 3},$9xc:function(){var n=this.$10.uri;var t=this.$10.name;if(_js.$9.$a(n)||_js.$9.$a(t)){_js.Trace.logError(_a.$0.$5d,"AddFileAttachment got null or empty uri or name");return!1}else if(n.length>2048||t.length>255){_js.Trace.logError(_a.$0.$5d,"AddFileAttachment got too long uri or name");return!1}else return!0},$9x3:function(n,t){var i=this.$10.uri;var r=this.$10.name;t.val=this.$Cd.$53h(i,r,n);return!!t.val}};_d.$tV=function(n,t,i,r){_d.$tV.initializeBase(this,[t,i]);this.$Cd=n;this.$3i7=r};_d.$tV.prototype={$Cd:null,$3i7:!1,get_$WR:function(){return this.$3i7?"SetRecipients":"AddRecipients"},get_$6He:function(){return 3},$9x7:function(n,t){t.val=new(_0365f.$o.$$(_g.$1l));if($6(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$5d,"Add/SetRecipientsAsync null for both displayName and address");$pB(this);return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$5d,"Add/SetRecipientsAsync got displayName lengths over the limit");$pB(this);return!1}if(_a.$3t.$Xv(f)){var i=new _g.$1l;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$D(i)}}if(t.val.get_$B()>0)return!0;else{$pA(this,9013,null);return!1}},$7mk:function(){var t=this.$10.recipientField;var i=this.$10.recipientArray;var n;if(i.length>100){_js.Trace.logError(_a.$0.$5d,"Add/SetRecipientsAsync got more recipients in the list than the limit.");$pB(this);return}var r,u;if(u=this.$9x7(i,r={val:n}),n=r.val,u){if(this.$3i7)this.$Cd.$9kQ(t,n);else if(!this.$Cd.$9wy(t,n)){$pA(this,9012,null);return}$hR(this,null,null)}}};_d.$3p=function(n,t){this.$10=n;this.$27Y=t};function $hR(n,t,i){n.$27Y(_d.$2c.$7f1(t));_a.$6.$1E(n.$Iy,n.get_$WR(),"",i);_a.$6.endPT(n.get_$WR())}function $pA(n,t,i){n.$27Y(_d.$2c.$7cK(t));_a.$6.$1E(n.$Iy,n.get_$WR(),_d.$Qi.$8IM(t),i);_a.$6.endPT(n.get_$WR())}function $2gs(n,t,i){n.$27Y(t);_a.$6.$1E(n.$Iy,n.get_$WR(),"",i);_a.$6.endPT(n.get_$WR())}function $6oM(n,t,i,r){n.$27Y(t);_a.$6.$1E(n.$Iy,n.get_$WR(),i,r);_a.$6.endPT(n.get_$WR())}function $pB(n){n.$27Y(null);_a.$6.$1E(n.$Iy,n.get_$WR(),"NonAPI",null);_a.$6.endPT(n.get_$WR())}function $6oL(n,t){return t===2?!0:n.get_$6He()===2?!1:t>=n.get_$6He()}_d.$3p.prototype={$10:null,$27Y:null,$Iy:null,$n:function(n){if(!$6oL(this,n)){_js.Trace.logError(_a.$0.$5d,String.format("API call failing due to insufficient permission {0}",this.get_$WR()));$pB(this);return}_a.$6.stPT(_a.$0.$5d,this.get_$WR(),5);this.$Iy=_a.$6.$1c(_a.$0.$5d,this.get_$WR(),!0);this.$7mk()}};_d.$124=function(n,t,i,r){_d.$124.initializeBase(this,[n,t,i,r])};_d.$124.prototype={get_$WR:function(){return"BodySetSelectedData"},get_$6He:function(){return 3},$2zQ:function(n){this.$Cd.$86k(n);$hR(this,null,null)}};_d.$123=function(n,t,i,r){_d.$123.initializeBase(this,[n,t,i,r])};_d.$123.prototype={get_$WR:function(){return"BodyPrepend"},get_$6He:function(){return 3},$2zQ:function(n){this.$Cd.$9W5(n);$hR(this,null,null)}};_d.$ix=function(){};_d.$WL=function(){};_d.$14X=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9jp=Function.createDelegate(this,this.$9jp);this.$$d_$7v5=Function.createDelegate(this,this.$7v5);this.$$d_$9kv=Function.createDelegate(this,this.$9kv);this.$$d_$7yf=Function.createDelegate(this,this.$7yf);_d.$14X.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$fE=n};_d.$14X.prototype={$fE:null,$7Oh:function(n,t){n.itemType=5;var i=this;_d.$1Jj.prototype.$7Oh.call(this,n,function(){t()})},$3cF:function(n){n.$69([_d.$57.$E("GetTimeAsync",this.$$d_$7yf),_d.$57.$E("SetTimeAsync",this.$$d_$9kv),_d.$57.$E("GetLocationAsync",this.$$d_$7v5),_d.$57.$E("SetLocationAsync",this.$$d_$9jp)]);_d.$1Jj.prototype.$3cF.call(this,n)},$7yf:function(n,t){new _d.$16E(this.$fE,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$9kv:function(n,t){new _d.$1Cj(this.$fE,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$9jp:function(n,t){new _d.$1CW(this.$fE,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$7v5:function(n,t){new _d.$15b(this.$fE,n,t).$n(this.$C0.$6b.RequestedCapabilities)}};_d.$oR=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_d.$oR.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p])};function $6rz(n,t,i){if(!n.get_$1Nx()){_d.$6F.$1oq(i,"to",t.get_$7S(),t.get_$FE());_d.$6F.$1oq(i,"cc",t.get_$8W(),null);_d.$6F.$1oq(i,"resources",t.get_$9F(),null);t.get_$FE()&&_d.$6F.$3ca(i,"organizer",t.get_$FE())}t.get_$4j()&&(i.location=t.get_$4j().get_$1o());t.get_$y()&&(i.start=t.get_$y().$13J().getTime());t.get_$1u()&&(i.end=t.get_$1u().$13J().getTime())}_d.$oR.prototype={$7Oh:function(n,t){var i=this.$P.get_$8n()?this.$P.get_$8n().toLowerCase():"";if(_d.$M4.$5Zc(i)){n.itemType=2;var r=this.$P;$6rz(this,r,n)}var u=this;_d.$6F.prototype.$7Oh.call(this,n,function(){t()})}};_d.$1Jj=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$7rt=Function.createDelegate(this,this.$7rt);this.$$d_$5Ls=Function.createDelegate(this,this.$5Ls);this.$$d_$5Lq=Function.createDelegate(this,this.$5Lq);this.$$d_$9W6=Function.createDelegate(this,this.$9W6);this.$$d_$9kg=Function.createDelegate(this,this.$9kg);this.$$d_$9ko=Function.createDelegate(this,this.$9ko);this.$$d_$7yG=Function.createDelegate(this,this.$7yG);this.$$d_$9kR=Function.createDelegate(this,this.$9kR);this.$$d_$7OF=Function.createDelegate(this,this.$7OF);this.$$d_$7wv=Function.createDelegate(this,this.$7wv);this.$$d_$1H6=Function.createDelegate(this,this.$1H6);this.$$d_$53h=Function.createDelegate(this,this.$53h);this.$$d_$53q=Function.createDelegate(this,this.$53q);_d.$1Jj.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$Cd=n};_d.$1Jj.prototype={$Cd:null,$1KD:null,get_$3ec:function(){this.$1KD||(this.$1KD=new(_d.$bQ.$$(_y.$jM))(this.$C0.$6b.Id));return this.$1KD},$53q:function(n,t){new _d.$11B(this.$Cd,this.get_$3ec(),n,t).$n(this.$C0.$6b.RequestedCapabilities)},$53h:function(n,t){new _d.$119(this.$Cd,this.get_$3ec(),n,t).$n(this.$C0.$6b.RequestedCapabilities)},$1H6:function(n,t){new _d.$1BS(this.get_$3ec(),n,t).$n(this.$C0.$6b.RequestedCapabilities)},$7wv:function(n,t){new _d.$or(this.$Cd,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$9kR:function(n,t){new _d.$tV(this.$Cd,n,t,!0).$n(this.$C0.$6b.RequestedCapabilities)},$7OF:function(n,t){new _d.$tV(this.$Cd,n,t,!1).$n(this.$C0.$6b.RequestedCapabilities)},$7yG:function(n,t){new _d.$16A(this.$Cd,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$9ko:function(n,t){new _d.$1Cg(this.$Cd,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$9kg:function(n,t){new _d.$124(this.$Cd,n,t,this.$k).$n(this.$C0.$6b.RequestedCapabilities)},$9W6:function(n,t){new _d.$123(this.$Cd,n,t,this.$k).$n(this.$C0.$6b.RequestedCapabilities)},$7rt:function(n,t){new _d.$158(this.$Cd,n,t).$n(this.$C0.$6b.RequestedCapabilities)},$7Oh:function(n,t){t()},$3cF:function(n){_d.$2c.prototype.$3cF.call(this,n);n.$69([_d.$57.$E("AddItemAttachmentAsync",this.$$d_$53q),_d.$57.$E("AddFileAttachmentAsync",this.$$d_$53h),_d.$57.$E("RemoveAttachmentAsync",this.$$d_$1H6),_d.$57.$E("GetRecipientsAsync",this.$$d_$7wv),_d.$57.$E("AddRecipientsAsync",this.$$d_$7OF),_d.$57.$E("SetRecipientsAsync",this.$$d_$9kR),_d.$57.$E("GetSubjectAsync",this.$$d_$7yG),_d.$57.$E("SetSubjectAsync",this.$$d_$9ko),_d.$57.$E("BodySetSelectedDataAsync",this.$$d_$9kg),_d.$57.$E("BodyPrependAsync",this.$$d_$9W6),_d.$57.$E("LoadCustomProperties",this.$$d_$5Lq),_d.$57.$E("SaveCustomProperties",this.$$d_$5Ls),_d.$57.$E("GetBodyTypeAsync",this.$$d_$7rt)])},$5Ls:function(n,t){new _d.$Uq(this.$Cd,n,this.$C0.$6b.Id,t).$n(this.$C0.$6b.RequestedCapabilities)},$5Lq:function(n,t){new _d.$18p(this.$Cd,n,this.$C0.$6b.Id,this.$k,t).$n(this.$C0.$6b.RequestedCapabilities)}};_d.$2c=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8FW=Function.createDelegate(this,this.$8FW);this.$$d_$7mp=Function.createDelegate(this,this.$7mp);this.$$d_$7mo=Function.createDelegate(this,this.$7mo);this.$$d_$7mq=Function.createDelegate(this,this.$7mq);this.$$d_$7my=Function.createDelegate(this,this.$7my);this.$$d_$9wN=Function.createDelegate(this,this.$9wN);this.$$d_$9ZC=Function.createDelegate(this,this.$9ZC);this.$$d_$9ZA=Function.createDelegate(this,this.$9ZA);this.$$d_$7n8=Function.createDelegate(this,this.$7n8);this.$$d_$7mv=Function.createDelegate(this,this.$7mv);this.$$d_$7uV=Function.createDelegate(this,this.$7uV);this.$$d_$9G2=Function.createDelegate(this,this.$9G2);this.$C=n;this.$10T=t;this.$1VH=i;this.$ZC=r;this.$VI=u;this.$Eu=f;this.$Kl=e;this.$I5=o;this.$6h=s;this.$N8=h;this.$xX=c;this.$9Q=a;this.$k=v};_d.$2c.$5Rn=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_d.$2c.$7f1=function(n){return{error:0,data:n}};_d.$2c.$7cK=function(n){return{error:1,errorCode:n}};function $10m(n,t,i,r){if(t>i){_js.Trace.logWarning(_a.$0.$5d,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",r,n.$C0.$6b.DisplayName,i,t);return!0}return!1}function $1nb(n,t,i){if(n.$4Lr<3){var r=t.val;var u=this;t.val=function(t){$6s0(n);r(t)};n.$4Lr++;return!0}t.val(i);return!1}function $6s0(n){n.$4Lr--}function $4lN(n,t,i){var r="";_c.$DB.get_$I().$3j3(t)&&(r=_c.$DB.get_$I().$7z1(t).TokenValue);i({wasSuccessful:!0,token:r})}function $4lK(n,t,i,r){for(var e=new(_0365f.$o.$$(String)),u=0;u<n.$XU.Extensions.length;u++){var o=n.$XU.Extensions[u];(t==="CallerIdentity"&&o.RequestedCapabilities>=1||t==="ExtensionCallback"&&o.RequestedCapabilities===2)&&e.$D(n.$XU.Extensions[u].Id)}var f=new _c.$vt(e.$6Z(),t);f.add_$2C(i);f.add_$1x(r);n.$k.$z(f)}function $4lM(n,t,i,r){var e=i;var o=e.body;var f="";if(_c.$DB.get_$I().$3j1(t.Id)){f=_c.$DB.get_$I().$7tg(t.Id).TokenValue;var u=new _c.$vU(o,f,t.Id);var s=this;u.add_$2C(function(t){r({wasProxySuccessful:u.get_$gq().WasProxySuccessful,errorMessage:u.get_$gq().ErrorMessage,statusCode:u.get_$gq().StatusCode,statusDescription:u.get_$gq().StatusDescription,body:u.get_$gq().Body});n.$Kv(n.$1Zp,"ExecuteEwsRequest","",u)});var h=this;u.add_$1x(function(t){r({wasProxySuccessful:!1,errorMessage:u.$1f.message,statusCode:500,statusDescription:u.$1f.message,body:null});n.$Kv(n.$1Zp,"ExecuteEwsRequest",u.$1f.message,u)});n.$k.$z(u)}else r({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})}function $6s1(n,t){var i=new _d.$Vu;if("requiredAttendees"in t){i.set_$7S(new _js.$Z);var r=t.requiredAttendees;if($10m(n,r.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var u=0;u<r.length;u++)i.get_$7S().$D(_g.$3i.$5Or(r[u]))}if("optionalAttendees"in t){i.set_$8W(new _js.$Z);var f=t.optionalAttendees;if($10m(n,f.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var e=0;e<f.length;e++)i.get_$8W().$D(_g.$3i.$5Or(f[e]))}if("start"in t&&!$6(t.start)){var a=t.start;var v=new Date(a);i.set_$y(_a.$7.$5Oo(v))}else{var y=_a.$2D.$3k5(_a.$7.get_$29());i.set_$y(y)}if("end"in t){var p=t.end;var w=new Date(p);i.set_$DS(_a.$7.$5Oo(w).$5z(i.get_$y()))}else i.set_$DS(_d.$ix.$3me);if("subject"in t){var s=t.subject;if($10m(n,s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;i.set_$2i(s)}if("body"in t){var o=t.body;if($10m(n,o.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var h;h=n.$C.get_$L()==="Mouse"?new _g.$6R("HTML",_a.$1b.$3jW(o)):new _g.$6R("Text",o);var b=new _g.$6L(h);i.set_$3C(b)}var c=_g.$3Y.$vn();if("location"in t){var l=t.location;if($10m(n,l.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;c.set_$1o(l)}i.set_$4j(c);return i}function $6s2(n,t,i){var u=_h.$1O.get_$I();var r=u.$3x(t);if($6(r)||$6(r.get_$3C()))if(!$6(r)&&r.get_$Cx())$4lL(n,t,r.get_$gS(),i);else{var e=this;var f=function(r){r.get_$Cx()?$4lL(n,t,r.get_$gS(),i):i(r)};$4lP(n,t,_h.$15.get_$xY(),"ItemNormalizedBody",f)}else i(r)}function $4lL(n,t,i,r){var u;u=n.$C.get_$L()==="Mouse"&&i!==1?_h.$15.get_$206():_h.$15.get_$35R();$4lP(n,t,u,"MailCompose",r)}function $4lP(n,t,i,r,u){var e=new _g.$1q(t);var f=new _h.$ol(100,[e],i,r,0,!1);var o=this;f.add_$2C(function(n){var i=_h.$1O.get_$I().$3x(t);u(i)});n.$k.$z(f)}function $4lO(n,t){n.$C.$7X(t)}_d.$2c.prototype={$C:null,$10T:null,$1VH:null,$ZC:null,$VI:null,$XU:null,$mG:null,$C0:null,$4Lr:0,$3N8:null,$6h:null,$k:null,$Eu:null,$Kl:null,$I5:null,$N8:null,$xX:null,$3Mg:null,$3qV:!1,$1Zp:null,$1tR:null,$1tT:null,$1PD:null,$2xe:!1,$9Q:null,get_$1Nx:function(){return!this.$C0.$6b.RequestedCapabilities},$49:function(n,t,i){this.$C0=n;this.$XU=t;this.$mG=i},$7uV:function(n,t){var u=_a.$6.acsa(_a.$0.$5d,"GetInitialData",!0);var i={};i.permissionLevel=this.$C0.$6b.RequestedCapabilities;i.timeZoneOffsets=this.$7yi();i.hostVersion=this.$C.get_$2Bs();i.owaView=_d.$2c.$5Rn(this.$C.get_$L());i.overrideWindowOpen=this.$9Q.get_$1M9().get_$2R4();if(!this.get_$1Nx()){i.userDisplayName=this.$ZC;i.userEmailAddress=this.$VI;i.userTimeZone=this.$1VH;i.ewsUrl=this.$XU.EwsUrl}var r=this;this.$7Oh(i,function(){_a.$6.acea(u);t(i);r.$3qV=!0;r.$3pS()})},$9Zr:function(){if(!this.$2xe){if(!this.$1PD){this.$1PD=new(_0365f.$o.$$(_d.$57));this.$3cF(this.$1PD)}for(var n=0;n<this.$1PD.get_$B();n++){var t=this.$1PD.get_$3q(n);this.$3N8.registerMethod(t.$RI,t.$aT,0,t.$57q)}this.$9Q&&this.$9Q.get_$1M9().get_$2R4()&&this.$3N8.unregisterMethod("ContextActivationManager_openWindowInHost");this.$2xe=!0}},$9yB:function(){if(this.$2xe&&this.$1PD){for(var n=0;n<this.$1PD.get_$B();n++){var t=this.$1PD.get_$3q(n);this.$3N8.unregisterMethod(t.$RI)}this.$2xe=!1}},$7mv:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteEwsRequest",5);this.$1Zp=_a.$6.$1c(_a.$0.$5d,"ExecuteEwsRequest",!0);var i=this.$C0.$6b;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$5d,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_d.$2c.$1uX);this.$Kv(this.$1Zp,"ExecuteEwsRequest","Failed",null);return}var s=n;var r=s.body;var u=_c.$DB.get_$I();if($6(r)||$10m(this,r.length,_d.$WL.$35q,"ExecuteEwsRequest")){t(_d.$2c.$1uX);this.$Kv(this.$1Zp,"ExecuteEwsRequest","Failed",null);return}var f,e;if(!(e=$1nb(this,f={val:t},_d.$2c.$56Y),t=f.val,e)){this.$Kv(this.$1Zp,"ExecuteEwsRequest",_d.$2c.$11C,null);return}if(!u.$3j1(i.Id)||u.$888()){var h=this,o=this;$4lK(this,"ExtensionCallback",function(r){$4lM(h,i,n,t)},function(n){t({wasProxySuccessful:!1});o.$Kv(o.$1Zp,"ExecuteEwsRequest","Failed",n)})}else $4lM(this,i,n,t)},$7n8:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteSaveSettingsRequest",5);this.$1tT=_a.$6.$1c(_a.$0.$5d,"ExecuteSaveSettingsRequest",!0);var u=this.$C0;var c=n;var f=c[0];var e=JsonParser.serialize(f);if($10m(this,e.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$Kv(this.$1tT,"ExecuteSaveSettingsRequest","Failed",null);return}var o,s;if(!(s=$1nb(this,o={val:t},_d.$2c.$56Z),t=o.val,s)){this.$Kv(this.$1tT,"ExecuteSaveSettingsRequest",_d.$2c.$11C,null);return}var i=new _c.$zf(u.$6b.Id,u.$6b.Version,e);var r=this;i.add_$2C(function(n){if(i.get_$gq().WasSuccessful){u.set_$6UV(f);t({error:0});r.$Kv(r.$1tT,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$gq().ErrorMessage,error:1});r.$Kv(r.$1tT,"ExecuteSaveSettingsRequest",i.get_$gq().ErrorMessage,n)}});var h=this;i.add_$1x(function(n){t({errorMessage:i.$1f.message,error:1});h.$Kv(h.$1tT,"ExecuteSaveSettingsRequest",i.$1f.message,n)});this.$k.$z(i)},$7my:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteGetUserIdentityTokenRequest",5);this.$1tR=_a.$6.$1c(_a.$0.$5d,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1Nx()){_js.Trace.logInfo(_a.$0.$5d,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$C0.$6b.DisplayName);t(_d.$2c.$1uX);this.$Kv(this.$1tR,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_c.$DB.get_$I();var i=this.$C0.$6b.Id;if(!u.$3j3(i)||u.$88C()){var f,e;if(!(e=$1nb(this,f={val:t},_d.$2c.$2FC),t=f.val,e)){this.$Kv(this.$1tR,"ExecuteGetUserIdentityTokenRequest",_d.$2c.$11C,null);return}var r=this,o=this;$4lK(this,"CallerIdentity",function(n){$4lN(r,i,t);r.$Kv(r.$1tR,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});o.$Kv(o.$1tR,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{$4lN(this,i,t);this.$Kv(this.$1tR,"ExecuteGetUserIdentityTokenRequest","",null)}},$7mq:function(n,t){var r=n;var i=$6s1(this,r);if(!i){t(null);return}if(this.$C.get_$L()==="Mouse"){var u=this.$Eu.$2v6(i);this.$C.$MH(Object.getType(this.$Eu),null,null,_y.$48.get_$fF(),u,!1)}else{var f=this.$Eu.$bC(i.$3K,null);$4lO(this,f)}t(null)},$7mo:function(n,t){var u=n;var r=u.itemId;if(_js.$9.$a(r)){t(null);return}var i=new _y.$Ax;i.$V5(new _g.$1q(r));if(this.$C.get_$L()==="Mouse")this.$C.$MH(Object.getType(this.$Kl),null,i.$3K,_y.$48.get_$fF(),null,!1);else{var f=this.$Kl.$bC(i.$3K,null);$4lO(this,f)}t(null)},$7mp:function(n,t){var i=n;$6s2(this,i.itemId,this.$$d_$9G2);t(null)},$8FW:function(n,t){if(this.$9Q){var i=n.launchUrl;i&&this.$9Q.$1zZ(i)}t(null)},$9ZA:function(n,t){var r=n;if(this.$C0.$6b.Origin===3){var i=new _d.$14b(this.$C0.$6b.DisplayName.replace(_d.$2c.$1mu,""));i.$6J4(r);i.$z()}t(null)},$9ZC:function(n,t){var i=n;if(this.$C0.$6b.Origin!==3){t(null);return}var r=_a.$0.$5d;var u="[{0}] {1}";var f=this.$C0.$6b.DisplayName.replace(_d.$2c.$1mu,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(r,u,f,i.Message);break;case"Error":_js.Trace.logError(r,u,f,i.Message);break;default:break}t(null)},$9wN:function(n,t){var i=n;if(this.$C0.$6b.Origin!==3){t(null);return}var r=this.$C0.$6b.DisplayName.replace(_d.$2c.$1mu,"")+"."+i.Name.replace(_d.$2c.$1mu,"");var u=i.Event;switch(u){case"Start":_a.$6.$1c(_a.$0.$5d,r);break;case"End":_a.$6.$1E(null,r);break;default:break}t(null)},$9ki:function(n){this.$3N8=n},$7yi:function(){return this.$10T.$2M9(this.$1VH)},$9rR:function(){this.$3qV=!1;_a.$6.stPT(_a.$0.$5d,"AppSelection",5);this.$3Mg=_a.$6.$1c(_a.$0.$5d,"AppSelection",!0)},$3pS:function(){if(this.$3Mg){var n=new _a.$6U;n.$7a("Id",this.$C0.$6b.Id);n.$7a("Name",this.$C0.$6b.DisplayName);var t=n.toString();var i=this.$3qV?"":"Failed";_a.$6.$1E(this.$3Mg,"AppSelection",i,null,t);_a.$6.endPT("AppSelection");this.$3Mg=null}},$Kv:function(n,t,i,r){i||(i="");var u=null;r&&(_c.$vU.isInstanceOfType(r)&&r.$5s?u=r.$5s.correlationId:_c.$zf.isInstanceOfType(r)&&r.$5s?u=r.$5s.correlationId:_c.$qB.isInstanceOfType(r)&&r.$5s?u=r.$5s.correlationId:_c.$ze.isInstanceOfType(r)&&r.$5s?u=r.$5s.correlationId:_c.$vt.isInstanceOfType(r)&&r.$5s?u=r.$5s.correlationId:_c.$os.isInstanceOfType(r)&&r.$5s&&(u=r.$5s.correlationId));n?_a.$6.$1E(n,t,i,u):_a.$6.$1E(null,t,i,u);_a.$6.endPT(t)},$3cF:function(n){n.$69([_d.$57.$7bE("GetInitialData",this.$$d_$7uV),_d.$57.$E("EwsRequest",this.$$d_$7mv),_d.$57.$E("saveSettingsAsync",this.$$d_$7n8),_d.$57.$E("RecordDataPoint",this.$$d_$9ZA),_d.$57.$E("RecordTrace",this.$$d_$9ZC),_d.$57.$E("TrackCtq",this.$$d_$9wN),_d.$57.$E("GetUserIdentityToken",this.$$d_$7my),_d.$57.$E("DisplayNewAppointmentForm",this.$$d_$7mq),_d.$57.$E("DisplayExistingAppointmentForm",this.$$d_$7mo),_d.$57.$E("DisplayExistingMessageForm",this.$$d_$7mp),_d.$57.$E("LaunchPalUrl",this.$$d_$8FW)])},$9G2:function(n){if(n.get_$Cx()){var t=this.$6h.$G3(!0,!1);t.$3xu(n);var r=this;this.$C.$MH(IMailComposeViewModelFactory,function(){return r.$I5},null,_y.$48.get_$fF(),t,!1)}else{var i=this.$N8.$E(!1);i.set_$3q(n);var u=this;this.$C.$MH(_y.$HN,function(){return u.$xX},null,_y.$48.get_$fF(),i,!1)}}};_d.$oS=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$10T=n;this.$ZC=t;this.$VI=i;this.$1VH=r;this.$C=u;this.$N8=f;this.$xX=e;this.$6h=o;this.$13=s;this.$9Q=h;this.$k=c;this.$1J=l};_d.$oS.prototype={$10T:null,$ZC:null,$VI:null,$1VH:null,$C:null,$6h:null,$N8:null,$xX:null,$1J:null,$Kl:null,$I5:null,$Eu:null,$13:null,$9Q:null,$k:null,$3kW:function(n,t){return new _d.$TE(this.$C,this.$10T,this.$1VH,this.$ZC,this.$VI,t,this.$Eu,this.$Kl,this.$I5,this.$6h,this.$N8,this.$xX,n,this.$13,this.$9Q,this.$k,this.$1J)},$5ED:function(n){return new _d.$oR(this.$C,this.$10T,this.$1VH,this.$ZC,this.$VI,this.$Eu,this.$Kl,this.$I5,this.$6h,this.$N8,this.$xX,n,this.$13,this.$9Q,this.$k,this.$1J)},$5F3:function(n){return new _d.$14a(n,this.$C,this.$10T,this.$1VH,this.$ZC,this.$VI,this.$Eu,this.$Kl,this.$I5,this.$6h,this.$N8,this.$xX,this.$13,this.$9Q,this.$k)},$5EA:function(n){return new _d.$14X(n,this.$C,this.$10T,this.$1VH,this.$ZC,this.$VI,this.$Eu,this.$Kl,this.$I5,this.$6h,this.$N8,this.$xX,this.$13,this.$9Q,this.$k)}};_d.$14a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_d.$14a.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$5MF=n};_d.$14a.prototype={$5MF:null,$7Oh:function(n,t){n.itemType=4;n.conversationId=this.$5MF.$3ss();var i=this;_d.$1Jj.prototype.$7Oh.call(this,n,function(){t()})}};_d.$TE=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_d.$TE.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w])};function $4lR(n,t){var i=n.$P;if(!n.get_$1Nx()){_d.$6F.$3ca(t,"from",i.get_$3O());_d.$6F.$3ca(t,"sender",i.get_$8X());_d.$6F.$53p(t,"to",i.get_$4B());_d.$6F.$53p(t,"cc",i.get_$4T())}t.conversationId=i.get_$3S()?i.get_$3S().Id:null;t.internetMessageId=i.get_$Aq()}function $6s3(n,t){var i=n.$P;if(!n.get_$1Nx()){_d.$6F.$1oq(t,"to",i.get_$KB().get_$7S(),i.get_$KB().get_$FE());_d.$6F.$1oq(t,"cc",i.get_$KB().get_$8W(),null);_d.$6F.$1oq(t,"resources",i.get_$KB().get_$9F(),null)}i.get_$KB().get_$4j()&&(t.location=i.get_$KB().get_$4j().get_$1o());i.get_$KB().get_$y()&&(t.start=i.get_$KB().get_$y().$13J().getTime());i.get_$KB().get_$1u()&&(t.end=i.get_$KB().get_$1u().$13J().getTime())}_d.$TE.prototype={$7Oh:function(n,t){var i=this.$P.get_$8n()?this.$P.get_$8n().toLowerCase():"";if(_g.$CC.isInstanceOfType(this.$P)&&_d.$M4.$41j(i)){n.itemType=3;var r=this.$P;$4lR(this,n);$6s3(this,n)}else if(_d.$M4.$41j(i)){n.itemType=1;$4lR(this,n)}var u=this;_d.$6F.prototype.$7Oh.call(this,n,function(){t()})}};_d.$bQ=function(n){this.$2X0={};this.$57U=n};_d.$bQ.$$=function(n){var t="$bQ"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$bQ"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$bQ.apply(this,i)};r.registerClass("_d."+t);var u=_d.$bQ.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$bQ.prototype={$wt:0,$57U:null,$D:function(n){var t=this.$57U+(new Date).getTime().toString()+this.$wt.toString();this.$2X0[t]=n;this.$wt++;return t},$A4l:function(n,t){this.$2X0[n]=t;return n},$A4m:function(n,t){var i=this.$2X0[n];t&&delete this.$2X0[n];return i}};_d.$6F=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$7mr=Function.createDelegate(this,this.$7mr);this.$$d_$7ms=Function.createDelegate(this,this.$7ms);this.$$d_$5Ls=Function.createDelegate(this,this.$5Ls);this.$$d_$5Lq=Function.createDelegate(this,this.$5Lq);this.$$d_$7mx=Function.createDelegate(this,this.$7mx);_d.$6F.initializeBase(this,[n,t,i,r,u,e,o,s,h,c,l,v,y,p]);this.$mj=f;this.$P=a;this.$1J=w};_d.$6F.$3ca=function(n,t,i){$6(i)||(n[t]=_d.$6F.$5FL(i.Mailbox))};_d.$6F.$53p=function(n,t,i){if(!$6(i)&&i.get_$B()>0){for(var u=[],r=0;r<i.get_$B()&&r<100;r++){var f=i.get_$3q(r);$6(f)||(u[r]=_d.$6F.$5FL(f))}n[t]=u}};_d.$6F.$1oq=function(n,t,i,r){var u=null;var e=0;var s=!1;if(r&&r.Mailbox){s=!0;u=new Array(0);u[e++]=_d.$6F.$5E7(r.Mailbox,"Organizer")}if(!$6(i)&&i.get_$B()>0){u||(u=new Array(0));for(var o=0;o<i.get_$B()&&e<100;o++){var f=i.get_$3q(o);if(f&&f.get_$7B()){if(s&&r.Mailbox.EmailAddress&&f.get_$7B().EmailAddress&&f.get_$7B().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;u[e++]=_d.$6F.$5E7(f.get_$7B(),f.get_$TM())}}}n[t]=u};_d.$6F.$5FL=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_d.$6F.$46V(n.MailboxType);return t};_d.$6F.$46V=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_d.$6F.$7Nn=function(n,t){if(!$6(t)&&t.get_$B()>0){for(var f=[],u=0;u<t.get_$B();u++){var i=t.get_$3q(u);var r={};if(i){r.id=i.get_$3i().Id;r.name=i.get_$1L();r.contentType=i.get_$Bf();r.size=i.get_$4k();r.attachmentType=_g.$4x.isInstanceOfType(i)?0:1;r.isInline=i.get_$6D();f[u]=r}}n.attachments=f}};_d.$6F.$5E7=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_d.$6F.$46V(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};function $6s8(n){if(n.$P.get_$12l())return!1;var t=n.$P.get_$3J6();return t?t.ExtractedAddresses||t.ExtractedContacts||t.ExtractedEmails||t.ExtractedMeetings||t.ExtractedPhones||t.ExtractedTasks||t.ExtractedUrls:!1}function $6sB(n,t,i){var r=new _c.$vw(n.$P);var u=this;r.add_$2C(function(r){n.$3cO(t);i()});var f=this;r.add_$1x(function(u){_js.Trace.logWarning(_a.$0.$5d,"GetItem to fetch entities failed "+r.$1f);n.$3cO(t);i()});OwaApplication.$1W.$z(r)}function $6s7(n,t){var i={};i.Addresses=_d.$5o.$1N3(t.Addresses,3,n.$mj);i.Urls=_d.$5o.$1N3(t.Urls,4,n.$mj);i.PhoneNumbers=_d.$5o.$1N3(t.PhoneNumbers,5,n.$mj);if(!n.get_$1Nx()){i.Contacts=_d.$5o.$1N3(t.Contacts,7,n.$mj);i.EmailAddresses=_d.$5o.$1N3(t.EmailAddresses,6,n.$mj);i.MeetingSuggestions=_d.$5o.$1N3(t.MeetingSuggestions,1,n.$mj);i.TaskSuggestions=_d.$5o.$1N3(t.TaskSuggestions,2,n.$mj)}return i}function $4lT(n,t,i){var r=n.$6h.$G3(!0,!1);r.set_$40(t);r.$13p(n.$P);var e=r.$1LR(!0);var u;if(t===1)u=new _g.$lK;else if(t===2)u=new _g.$lJ;else return;u.$2fY(e.get_$64());u.set_$1R5(new _g.$6L(new _g.$6R("HTML",i)));u.set_$2Zq(n.$P.get_$i());r.$5XZ(u);var f=_d.$Ak.$3kz(r,u,n.$1J);f.$Ee=0;var o=this;f.add_$2C(function(n){_js.Trace.logInfo(_a.$0.$5d,"Create response action succeeded");var t=n;if(t.$59===r.get_$7g()){r.$Au();r.set_$61(0);r.set_$40(4);r.set_$A3(t.$5N);var i=new _y.$CS;i.$T7(r)}});OwaApplication.$1W.$z(f)}function $6s9(n){return n.$P?_g.$33.isInstanceOfType(n.$P)?n.$P.get_$hr():!0:!1}function $6sA(n){return n.$P?_g.$33.isInstanceOfType(n.$P)?n.$P.get_$ej():!0:!1}function $6sC(n,t,i){var r="";i&&_c.$os.isInstanceOfType(i)&&i.$VF&&(r=i.$VF.TokenValue);t({wasSuccessful:!0,token:r})}_d.$6F.prototype={$mj:!1,$1J:null,$P:null,$7Oh:function(n,t){if($6s8(this))$6sB(this,n,t);else{this.$3cO(n);t()}},$3cF:function(n){_d.$2c.prototype.$3cF.call(this,n);n.$69([_d.$57.$E("GetCallbackToken",this.$$d_$7mx),_d.$57.$E("LoadCustomProperties",this.$$d_$5Lq),_d.$57.$E("SaveCustomProperties",this.$$d_$5Ls),_d.$57.$E("DisplayReplyForm",this.$$d_$7ms),_d.$57.$E("DisplayReplyAllForm",this.$$d_$7mr)])},$7mx:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteGetCallbackTokenRequest",5);var i=_a.$6.$1c(_a.$0.$5d,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1Nx()){_js.Trace.logInfo(_a.$0.$5d,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$C0.$6b.DisplayName);t(_d.$2c.$1uX);this.$Kv(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var u,f;if(!(f=$1nb(this,u={val:t},_d.$2c.$2FC),t=u.val,f)){this.$Kv(i,"ExecuteGetCallbackTokenRequest",_d.$2c.$11C,null);return}var r=new _c.$os(this.$C0.$6b.Id,String.format("ParentItemId:{0}",this.$P.get_$i().Id));var e=this;r.add_$2C(function(n){$6sC(e,t,n);e.$Kv(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$1x(function(n){t({wasSuccessful:!1});o.$Kv(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$1W.$z(r)},$5Lq:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteLoadCustomPropRequest",5);var r=_a.$6.$1c(_a.$0.$5d,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _c.$qB(this.$C0.$6b.Id,this.$P.get_$i().Id);var u,f;if(!(f=$1nb(this,u={val:t},_d.$2c.$2FC),t=u.val,f)){this.$Kv(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2C(function(n){t({errorMessage:i.get_$gq().ErrorMessage,wasSuccessful:i.get_$gq().WasSuccessful,customProperties:i.get_$gq().CustomProperties});e.$Kv(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$1x(function(n){t({errorMessage:i.$1f.message,wasSuccessful:!1,customProperties:null});o.$Kv(r,"ExecuteLoadCustomPropRequest",i.$1f.message,n)});OwaApplication.$1W.$z(i)},$5Ls:function(n,t){_a.$6.stPT(_a.$0.$5d,"ExecuteSaveCustomPropRequest",5);var r=_a.$6.$1c(_a.$0.$5d,"ExecuteSaveCustomPropRequest",!0);var o=n;var s=o.customProperties;var u=JsonParser.serialize(s);if($10m(this,u.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_d.$2c.$1uX);this.$Kv(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var f,e;if(!(e=$1nb(this,f={val:t},_d.$2c.$2FC),t=f.val,e)){this.$Kv(r,"ExecuteSaveCustomPropRequest",_d.$2c.$11C,null);return}var i=new _c.$ze(this.$C0.$6b.Id,this.$P.get_$i().Id,u);var h=this;i.add_$2C(function(n){t({errorMessage:i.get_$gq().ErrorMessage,wasSuccessful:i.get_$gq().WasSuccessful});h.$Kv(r,"ExecuteSaveCustomPropRequest","",n)});var c=this;i.add_$1x(function(n){t({errorMessage:i.$1f.message,wasSuccessful:!1});c.$Kv(r,"ExecuteSaveCustomPropRequest",i.$1f.message,n)});OwaApplication.$1W.$z(i)},$7ms:function(n,t){if(!$6sA(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($10m(this,i.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}$4lT(this,1,i);t(null)},$7mr:function(n,t){if(!$6s9(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($10m(this,i.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}$4lT(this,2,i);t(null)},$3cO:function(n){n.id=this.$P.get_$i().Id;n.itemClass=this.$P.get_$8n();this.$P.get_$129()&&(n.dateTimeCreated=this.$P.get_$129().$13J().getTime());this.$P.get_$As()&&(n.dateTimeModified=this.$P.get_$As().$13J().getTime());this.$P.get_$q2()&&(n.dateTimeSent=this.$P.get_$q2().$13J().getTime());$6(this.$P.get_$12l())||(n.entities=$6s7(this,this.$P.get_$12l()));var t=this.$mG.$wI.$7t6();t&&(n.filteredEntities=t);if(!_d.$2c.prototype.get_$1Nx.call(this)){n.subject=this.$P.get_$2i();n.normalizedSubject=this.$P.get_$nk();var i=this.$mG.$2Zu;$6(i)||(n.regExMatches=i);_d.$6F.$7Nn(n,this.$P.get_$92())}}};_d.$158=function(n,t,i){_d.$158.initializeBase(this,[t,i]);this.$Cd=n};_d.$158.prototype={$Cd:null,get_$WR:function(){return"GetBodyType"},get_$6He:function(){return 1},$7mk:function(){var t=this.$Cd.$2vN();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");$hR(this,n,null)}};_d.$15b=function(n,t,i){_d.$15b.initializeBase(this,[t,i]);this.$fE=n};_d.$15b.prototype={$fE:null,get_$WR:function(){return"GetLocation"},get_$6He:function(){return 1},$7mk:function(){var n=this.$fE.$2Lm();$hR(this,n,null)}};_d.$or=function(n,t,i){_d.$or.initializeBase(this,[t,i]);this.$Cd=n};_d.$or.$7px=function(n){var r=[];if(!n)return r;for(var f=n.get_$B()>100?100:n.get_$B(),t=0;t<f;t++){var u=n.get_$3q(t).$CA;var i={};i.recipientType=_d.$6F.$46V(u.get_$1l().MailboxType);i.address=u.get_$1l().EmailAddress||null;i.name=u.get_$1o();r[t]=i}return r};_d.$or.prototype={$Cd:null,get_$WR:function(){return"GetRecipients"},get_$6He:function(){return 1},$7mk:function(){var n=this.$10.recipientField;var t=this.$Cd.$7wt(n);var i=_d.$or.$7px(t);$hR(this,i,null)}};_d.$16A=function(n,t,i){_d.$16A.initializeBase(this,[t,i]);this.$Cd=n};_d.$16A.prototype={$Cd:null,get_$WR:function(){return"GetSubject"},get_$6He:function(){return 1},$7mk:function(){var n=this.$Cd.$13P();$hR(this,n||"",null)}};_d.$16E=function(n,t,i){_d.$16E.initializeBase(this,[t,i]);this.$fE=n};_d.$16E.prototype={$fE:null,get_$WR:function(){return"GetTime"},get_$6He:function(){return 1},$7mk:function(){var n=null;var t=this.$10.TimeProperty;t===1?n=this.$fE.$2wS():t===2&&(n=this.$fE.$2vf());$hR(this,n.$13J().getTime(),null)}};_d.$18p=function(n,t,i,r,u){this.$$d_$34q=Function.createDelegate(this,this.$34q);this.$$d_$34x=Function.createDelegate(this,this.$34x);_d.$18p.initializeBase(this,[t,u]);this.$iL=i;this.$Cd=n;this.$k=r};_d.$18p.prototype={$iL:null,$Cd:null,$k:null,get_$WR:function(){return"ExecuteLoadCustomPropRequestCompose"},get_$6He:function(){return 0},$7mk:function(){var n=this.$Cd.$3t5();if(n)for(var t=n.get_$B()-1;t>=0;t--)if(_h.$7z.$5aN(n.get_$3q(t),this.$iL)){$2gs(this,{wasSuccessful:!0,customProperties:n.get_$3q(t).get_$1g()},null);return}var r=this.$Cd.$2Ll();if(!r){$2gs(this,{wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$10;var i=new _c.$qB(this.$iL,this.$Cd.$2Ll());i.add_$2C(this.$$d_$34x);i.add_$1x(this.$$d_$34q);this.$k.$z(i)},$34x:function(n){var t=n;var i={wasSuccessful:t.get_$gq().WasSuccessful,customProperties:t.get_$gq().CustomProperties};if(!_js.$9.$a(t.get_$gq().CustomPropertyNames)){var r=this.$Cd.$3t5();_h.$7z.$54A(r,t.get_$gq().CustomPropertyNames)}$2gs(this,i,n.$59)},$34q:function(n){_js.Trace.logError(_a.$0.$5d,"custom properties load failed with "+n.$1f);var t={errorMessage:n.$1f.message,wasSuccessful:!1,customProperties:null};$6oM(this,t,n.$1f.message,n.$59)}};_d.$1BS=function(n,t,i){this.$$d_$5Hw=Function.createDelegate(this,this.$5Hw);_d.$1BS.initializeBase(this,[t,i]);this.$1KD=n};_d.$1BS.prototype={$1KD:null,$1Wl:null,$2FI:null,get_$WR:function(){return"RemoveAttachment"},get_$6He:function(){return 3},$7mk:function(){this.$2FI=this.$10.attachmentIndex;if(this.$2FI.length>200){_js.Trace.logError(_a.$0.$5d,"RemoveFileAttachment got too long attachmentId");$pB(this);return}if(!this.$2FI){_js.Trace.logError(_a.$0.$5d,"RemoveAttachment got null or empty attachmentIndex");$pB(this);return}this.$1Wl=this.$1KD.$A4m(this.$2FI,!0);if(!this.$1Wl){$pA(this,9008,null);return}if(this.$1Wl.get_$146()){$hR(this,null,null);return}this.$1Wl.add_$1RX(this.$$d_$5Hw);this.$1Wl.get_$1Z4().$n()},$5Hw:function(n){this.$1Wl.remove_$1RX(this.$$d_$5Hw);if(n.get_$6FQ()){this.$1KD.$A4l(this.$2FI,this.$1Wl);$pA(this,9009,null);return}$hR(this,null,null)}};_d.$Uq=function(n,t,i,r){_d.$Uq.initializeBase(this,[t,r]);this.$iL=i;this.$Cd=n};function $6x5(n,t,i){t.$D(i);_h.$7z.$54A(t,i.get_$DU().get_$E4())}_d.$Uq.prototype={$iL:null,$Cd:null,get_$WR:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$6He:function(){return 0},$7mk:function(){var f=this.$10;var e=f.customProperties;var i=JsonParser.serialize(e);if(i.length>2500){$pB(this);return}for(var r=_h.$7z.$7cN(this.$iL,i),n=this.$Cd.$3t5(),u=!1,t=0;t<n.get_$B();t++)if(_h.$7z.$5aN(n.get_$3q(t),this.$iL)){n.set_$3q(t,r);u=!0;break}u||$6x5(this,n,r);this.$Cd.$8IS();$2gs(this,_d.$Uq.$5Gh,null)}};_d.$li=function(n,t,i,r){this.$$d_$9ez=Function.createDelegate(this,this.$9ez);this.$$d_$9f0=Function.createDelegate(this,this.$9f0);_d.$li.initializeBase(this,[t,i]);this.$Cd=n;this.$k=r};function $6xc(n,t){t.val=t.val.trim();t.val.substr(0,5).toLowerCase()==="<div>"&&t.val.substr(t.val.length-6,6).toLowerCase()==="</div>"&&(t.val=t.val.substring(5,t.val.length-6))}function $6xd(n,t,i){var r=n.$Cd.$2vN();i.val=t;if(!$6(t)){if(r==="Text"&&i.val===3){$pA(n,2006,null);return!1}return!0}$pB(n);return!1}_d.$li.prototype={$Cd:null,$k:null,$7mk:function(){var r=this.$10;var n=r.data;if(n.length>1e6){$pB(this);return}var t;var u,f;if(f=$6xd(this,r.coercionType,u={val:t}),t=u.val,f)if(t===3)if(_js.$9.$a(n))this.$2zQ("");else{var i=new _c.$1Bk(n);i.add_$2C(this.$$d_$9f0);i.add_$1x(this.$$d_$9ez);this.$Cd.$9sA();this.$k.$z(i)}else this.$Cd.$2vN()==="HTML"?this.$2zQ(_a.$3D.$EX(n)):this.$2zQ(n)},$9ez:function(n){_js.Trace.logError(_a.$0.$5d,"Sanitize html failed with "+n.$1f);$pA(this,9011,null)},$9f0:function(n){_js.Trace.logInfo(_a.$0.$5d,"Sanitize html succeeded.");if(this.$Cd.$2vN()==="HTML"){var u=n;var t=u.get_$gq();var i;$6xc(this,i={val:t});t=i.val;var r=this;this.$Cd.$7Vb(function(n){n?$pA(r,9014,null):r.$2zQ(t)})}else $pA(this,2006,null)}};_d.$1CW=function(n,t,i){_d.$1CW.initializeBase(this,[t,i]);this.$fE=n};_d.$1CW.prototype={$fE:null,get_$WR:function(){return"SetLocation"},get_$6He:function(){return 3},$7mk:function(){var n=this.$10.location;if(n.length>255)$pB(this);else{this.$fE.$9jo(n);$hR(this,null,null)}}};_d.$1Cg=function(n,t,i){_d.$1Cg.initializeBase(this,[t,i]);this.$Cd=n};_d.$1Cg.prototype={$Cd:null,get_$WR:function(){return"SetSubject"},get_$6He:function(){return 3},$7mk:function(){var n=this.$10.subject;if(n.length>255){$pB(this);return}this.$Cd.$9kn(n);$hR(this,null,null)}};_d.$1Cj=function(n,t,i){_d.$1Cj.initializeBase(this,[t,i]);this.$fE=n};_d.$1Cj.prototype={$fE:null,get_$WR:function(){return"SetTime"},get_$6He:function(){return 3},$7mk:function(){var n=this.$10.TimeProperty;var r=this.$10.time;var t=_a.$7.$1Bz(new Date(r));var i=!0;n===1?this.$fE.$9kl(t):n===2&&(i=this.$fE.$9xT(t));i?$hR(this,null,null):$pA(this,9010,null)}};_d.$57=function(n,t,i){this.$RI=n;this.$aT=t;this.$57q=i};_d.$57.$E=function(n,t){return new _d.$57(n,t,!1)};_d.$57.$7bE=function(n,t){return new _d.$57(n,t,!0)};_d.$57.prototype={$RI:null,$57q:!1,$aT:null};_d.$10q=function(n,t){this.$2Bf=n;this.$1n=t};_d.$10q.prototype={$2Bf:null,$1n:null,get_$A1a:function(){return this.$2Bf},get_$1L:function(){return this.$1n},get_$4k:function(){return 0},get_$4l:function(){return""}};_d.$2k=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$7Vo=Function.createDelegate(this,this.$7Vo);this.$$d_$9Fy=Function.createDelegate(this,this.$9Fy);this.$$d_$9Ep=Function.createDelegate(this,this.$9Ep);this.$$d_$2LY=Function.createDelegate(this,this.$2LY);this.$$d_$811=Function.createDelegate(this,this.$811);this.$$d_$9Ru=Function.createDelegate(this,this.$9Ru);this.$$d_$3GE=Function.createDelegate(this,this.$3GE);_d.$2k.initializeBase(this);this.$Em=n;this.$1Zw=u;this.$9Q=t;this.$13=i;this.$C=r;this.$ZK=new _js.$Z;this.$eG=new _y.$hT;this.$6Fx=_d.$2k.$7vw(o);this.$1HY=new _d.$vY(this.$$d_$3GE,null);this.$6FF=new _C(this.$$d_$9Ru,_a.$0.$5d);this.$4Rv=f;this.$1O1=e;this.$3pr=s;this.$OE=h;this.$P=c;this.$1ob=l;this.$1CZ=a};_d.$2k.add_$3Fg=function(n){_d.$2k.$1N2||(_d.$2k.$1N2=new Sys.EventHandlerList);_d.$2k.$1N2.addHandler(_d.$2k.$3Fh,n)};_d.$2k.remove_$3Fg=function(n){_d.$2k.$1N2&&_d.$2k.$1N2.removeHandler(_d.$2k.$3Fh,n)};_d.$2k.$7vw=function(n){return n?n.replace("osfruntime_strings.js",""):""};function $6sH(n,t){n.$1CZ.$49(t,n.$XU,t.$mG);n.$1CZ.$9Zr()}function $3WQ(n,t){$4lV(n,t)&&n.$3pr.$9Yf(_a.$K3,new _a.$K3(!0,"Extensibility"))}function $3WR(n,t){$4lV(n,t)&&n.$3pr.$9Yf(_a.$K3,new _a.$K3(!1,"Extensibility"))}function $4lU(n,t){var i=new OSF.ContextActivationManager({appName:64,appVersion:t,clientMode:1,appUILocale:n.$Em,dataLocale:"",hostControl:n.$1CZ,localizedScriptsUrl:n.$6Fx,docUrl:""});var r={frameBorder:"0"};n.$13.get_$L5()&&n.$13.get_$67()&&(r.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(r);return i}function $4lV(n,t){return!n.$13.get_$31O()&&!n.$13.get_$31Q()?!1:!t||n.$FM&&!n.$FM.get_$1tW().Type?!0:!1}function $6sI(n){$3(n,"ActiveExtensions")}function $3WO(n){n.$1CZ.$9yB()}function $3WP(n){if((!_d.$2k.$311||n.$3Nr)&&!n.$1O1){_a.$6.stPT(_a.$0.$5d,"GetListOfApps",5);n.$1un=_a.$6.$1c(_a.$0.$5d,"GetListOfApps",!0);_d.$2k.$311=!0;n.$2LY();if(n.$4Rv){n.$1ja=new _d.$1Bh(3,3e4,n.$$d_$2LY,_a.$0.$5d,"GetExtensibilityContext");n.$1ja.$y()}}}function $6sG(n){n.$2Gm&&n.$2Gm.$3h1()}function $6sK(n){if(!n.$2Gm){n.$2Gm=new _d.$10e("CheckNewApp");$4lW(n)}}function $4lW(n){n.$2Gm.$1w(n.$$d_$7Vo,5e3,_a.$0.$5d)}function $6sJ(n,t){if(_d.$2k.$1N2){var i=_d.$2k.$1N2.getHandler(_d.$2k.$3Fh);$6(i)||i(t)}}_d.$2k.prototype={$C:null,$13:null,$1HY:null,$1Zw:null,$OE:null,$Em:null,$6FF:null,$eG:null,$9Q:null,$6Fx:null,$1ob:null,$1CZ:null,$2Gm:null,$1ja:null,$XU:null,$3Nr:!1,$16U:null,$2HL:null,$3j6:null,$3j7:null,$ZK:null,$FM:null,$P:null,$2y3:!0,$3EH:!0,$20J:null,$4Rv:!1,$1O1:!1,$3pr:null,$1un:null,get_$7We:function(){switch(this.$C.get_$L()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$8Ai:function(){return this.$XU?this.$XU.IsInOrgMarketplaceRole:!1},get_$9Sc:function(){return this.$16U},set_$9Sc:function(n){this.$16U!==n&&(this.$16U=n);$3(this,"OverflowMenuViewModel");return n},get_$6Fw:function(){return this.$2HL},set_$6Fw:function(n){if(this.$2HL!==n){this.$2HL=n;$3(this,"OsfContextActivationManager")}return n},get_$1k2:function(){return this.$FM},set_$1k2:function(n){if(this.$FM!==n){$6(n)||this.$OE.$9wQ(n.get_$1tW().Id);this.$FM=n;$3(this,"SelectedExtension")}return n},get_$3wS:function(){return this.$2y3},set_$3wS:function(n){if(this.$2y3!==n){this.$2y3=n;$3(this,_d.$2k.$5Vn)}return n},get_$1gk:function(){return this.$3EH},set_$1gk:function(n){if(this.$3EH!==n){this.$3EH=n;$3(this,_d.$2k.$2Wh)}return n},get_$8Ig:function(){return this.$20J},set_$8Ig:function(n){this.$20J=n;$3(this,_d.$2k.$2S2);return n},$3GE:function(n){n&&this.$FM===n||this.$1CZ.$3pS();n&&this.$1CZ.$9rR();if(n){var i=!(!n.get_$1tW().Type&&_d.$6F.isInstanceOfType(this.$1CZ));var r=_a.$6.acsa(_a.$0.$5d,"ContextActivationManager",!0);$3WQ(this,!1);var t;if(i){this.$3j7||(this.$3j7=$4lU(this,"15.01"));t=this.$3j7}else{this.$3j6||(this.$3j6=$4lU(this,"15"));t=this.$3j6}this.$2HL!==t&&$3WO(this);this.set_$6Fw(t);$3WR(this,!1);_a.$6.acea(r)}n?$6sH(this,n):$3WO(this);this.set_$3wS(this.$7iW(n));this.set_$1k2(n)},$7H:function(){_d.$2k.remove_$3Fg(this.$$d_$811);this.$1CZ.$3pS();$3WO(this);this.set_$1k2(null);this.$16U&&this.$16U.$ZZ();this.$16U=null;this.set_$3wS(!0);this.$ZK.$1r();this.set_$1gk(!0);this.$1ob.$Au();$6sG(this)},$5j:function(){if(this.$13.get_$98o()){this.$ZK.$1r();if(this.$1ob.$9mK())if(_a.$Co.$5da()){_a.$Co.$6OD();_d.$2k.$311=!1;_d.$2k.add_$3Fg(this.$$d_$811);$3WP(this)}else if($6(this.$XU)&&$6(_c.$8j.$mH)){_d.$2k.add_$3Fg(this.$$d_$811);$3WP(this)}else{$6(this.$XU)&&!$6(_c.$8j.$mH)&&(this.$XU=_c.$8j.$mH);this.$53B()}}},$9Ep:function(n){if(this.$4Rv&&this.$1ja){this.$1ja.$1u();this.$1ja=null}$6sJ(this,n);if(this.$1un){var t=null;_c.$8j.isInstanceOfType(n)&&n.$5s&&(t=n.$5s.correlationId);_a.$6.$1E(this.$1un,"GetListOfApps","",t);_a.$6.endPT("GetListOfApps");this.$1un=null}},$53B:function(){if(this.$1ob){this.$C.get_$L()==="Mouse"&&this.$XU.MarketplaceUrl&&this.set_$8Ig(this.$XU.MarketplaceUrl);if(!$6(this.$XU.Extensions)&&this.$XU.Extensions.length){var n=this;this.$1ob.$7mK(this.$XU.Extensions,function(t){if(n.$1ob){if(t.get_$B()>0){n.$ZK.$69(t.$6Z());$6sI(n);n.set_$9Sc(new _d.$I1(n.$ZK,n.$1HY));n.$16U.$ZZ();n.set_$1gk(!1);$3(n,_d.$2k.$5MI)}else n.set_$1gk(!0);$3(n,_d.$2k.$53G)}})}}},$9Ru:function(){if(this.$20J){_a.$6.stPT(_a.$0.$5d,"GetMoreApps",3);var n=_a.$6.$1c(_a.$0.$5d,"GetMoreApps",!0);this.$eG.$Re(this.$20J);$6sK(this);_a.$6.$1E(n,"GetMoreApps","");_a.$6.endPT("GetMoreApps")}},$2LY:function(){var n=new _c.$8j;n.add_$2C(this.$$d_$9Ep);n.add_$1x(this.$$d_$9Fy);n.$n(this.get_$7We(),this.$Em)},$9Fy:function(n){if(this.$1ja&&this.$1ja.$3vh&&this.$1un){var t=null;_c.$8j.isInstanceOfType(n)&&n.$5s&&(t=n.$5s.correlationId);_a.$6.$1E(this.$1un,"GetListOfApps","Failed",t);_a.$6.endPT("GetListOfApps")}},$7Vo:function(){if(_a.$Co.$5da()){_a.$Co.$6OD();this.$3Nr=!0;$3WP(this)}$4lW(this)},$811:function(n){_d.$2k.remove_$3Fg(this.$$d_$811);if(this.$XU){if(this.$3Nr){this.$3Nr=!1;_c.$8j.$34H=n.$3jC}}else{_c.$8j.$34H=n.$3jC;this.$XU=_c.$8j.$mH;this.$53B()}}};_d.$H9=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$9Eq=Function.createDelegate(this,this.$9Eq);this.$$d_$6DK=Function.createDelegate(this,this.$6DK);this.$$d_$5NA=Function.createDelegate(this,this.$5NA);this.$$d_$6Cy=Function.createDelegate(this,this.$6Cy);this.$$d_$9Ab=Function.createDelegate(this,this.$9Ab);this.$$d_$9Gx=Function.createDelegate(this,this.$9Gx);this.$$d_$9nM=Function.createDelegate(this,this.$9nM);_d.$H9.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p]);this.$EE=t;this.set_$3dp(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3wT(!1);this.set_$2F1(!0);this.$3do=i;this.$1kl=new _C(this.$$d_$9nM,n);this.$1kl.set_$5u(!1);this.$5Vg=new _C(this.$$d_$9Gx,n);this.$57R=new _C(this.$$d_$9Ab,n)};function $6rC(n){n.$Y(_d.$2k.$2Wh,n.$$d_$9Eq);n.$Y(_d.$2k.$2S2,n.$$d_$9Eq);n.$Y("ForceHideAppsButton",n.$$d_$9Eq);n.$3dx=!0}function $6rD(n){if(n.$3dx){n.$u(_d.$2k.$2Wh,n.$$d_$9Eq);n.$u(_d.$2k.$2S2,n.$$d_$9Eq);n.$u("ForceHideAppsButton",n.$$d_$9Eq);n.$3dx=!1}}function $4l2(n,t){n.$3do&&n.$3do(t)}function $4l1(n){return!n.$2uo&&(!n.$3EH||!!n.$20J)}_d.$H9.prototype={$1PE:null,$2lm:null,$2y5:!1,$3do:null,$29H:!1,$2uo:!1,$1WU:!1,$2ll:0,$1kl:null,$5Vg:null,$57R:null,$3dx:!1,$EE:null,$dS:null,add_$24s:function(n){this.$2N("OnAppsPaneOpened",n)},remove_$24s:function(n){this.$2P("OnAppsPaneOpened",n)},add_$3F3:function(n){this.$2N("OnAppsPaneClosed",n)},remove_$3F3:function(n){this.$2P("OnAppsPaneClosed",n)},add_$252:function(n){this.$2N("OnExtensionOpened",n)},remove_$252:function(n){this.$2P("OnExtensionOpened",n)},add_$3F7:function(n){this.$2N("BackToList",n)},remove_$3F7:function(n){this.$2P("BackToList",n)},get_$5OE:function(){return this.$2uo},set_$5OE:function(n){if(this.$2uo!==n){this.$2uo=n;$3(this,"ForceHideAppsButton")}return n},get_$6Vg:function(){return this.$29H},set_$6Vg:function(n){if(this.$29H!==n){this.$29H=n;$3(this,"ShowAppsButton")}return n},get_$562:function(){return this.$2ll},set_$562:function(n){if(this.$2ll!==n){this.$2ll=n;$3(this,"AppPaneSize")}return n},get_$2F1:function(){return this.$1WU},set_$2F1:function(n){if(this.$1WU!==n){this.$1WU=n;$3(this,"AppPaneIsHidden")}return n},get_$mm:function(){return this.$EE.$Q6===1},get_$8Dr:function(){return this.$C.get_$L()==="TouchNarrow"},get_$5hH:function(){return this.$1PE},set_$5hH:function(n){this.$1PE=n;if(n.$Sa===3){var t=this.$1PE.$3pw.get_$20().extensionViewModel;this.$3GE(t)}return n},get_$3dp:function(){return this.$2lm},set_$3dp:function(n){if(this.$2lm!==n){this.$2lm=n;$3(this,"AppPaneTitle")}return n},get_$3wT:function(){return this.$2y5},set_$3wT:function(n){if(this.$2y5!==n){this.$2y5=n;$3(this,"HideExtensionsList")}return n},get_$1yy:function(){return this.$C.get_$L()!=="Mouse"},$5j:function(){this.set_$6Vg($4l1(this));this.$1kl.set_$5u(this.$29H);this.set_$2F1(!0);$6rC(this);this.$EE&&this.$EE.$Y("Orientation",this.$$d_$6Cy);_d.$2k.prototype.$5j.call(this)},$7H:function(){$6rD(this);this.$EE&&this.$EE.$u("Orientation",this.$$d_$6Cy);_d.$2k.prototype.$7H.call(this)},$3GE:function(n){if(n){this.set_$3wT(!0);this.set_$3wS(!1);this.set_$3dp(n.get_$1tW().DisplayName);if(this.$13.get_$67()){var t=this;this.$9Q.$5LD(n.get_$5LG(),n.get_$1tW().DisplayName,function(){t.$6Ox(n)},this.$$d_$5NA)}else this.$6Ox(n)}else this.$13.get_$67()?this.$9Q.$5Lz():this.$5NA()},$9nM:function(){_a.$6.stPT(_a.$0.$5d,"ShowAppPane",3);var n=_a.$6.$1c(_a.$0.$5d,"ShowAppPane",!0);if(_y.$v.$v.get_$L()==="Mouse"){if(this.$1WU){this.set_$562(342);this.set_$2F1(!1);$4l2(this,1)}}else if(_y.$v.$v.get_$L()!=="TouchNarrow"&&this.$EE.$Q6)this.set_$2F1(!1);else{this.$dS=this.$1Zw.$7bd(this,_y.$v.$v.get_$L());this.$dS.set_$69N(this.$$d_$6DK);_y.$v.$v.$7X(this.$dS)}$6C(this,"OnAppsPaneOpened");_a.$6.$1E(n,"ShowAppPane","");_a.$6.endPT("ShowAppPane")},$6Cy:function(n,t){this.get_$mm()?this.$dS&&this.$dS.$4X():this.$1vn(!1);$6C(this,"OnAppsPaneClosed")},$9Gx:function(){this.$C.get_$L()!=="TouchWide"||this.get_$mm()?this.$1vn(!0):this.$dS&&this.$dS.$4X()},$1vn:function(n){if(!this.$1WU){var t=null;if(n){_a.$6.stPT(_a.$0.$5d,"HideAppPane",3);t=_a.$6.$1c(_a.$0.$5d,"HideAppPane",!0)}this.$3fQ(!1);this.set_$562(0);this.set_$2F1(!0);$6C(this,"OnAppsPaneClosed");$4l2(this,2);if(n){_a.$6.$1E(t,"HideAppPane","");_a.$6.endPT("HideAppPane")}}},$9Ab:function(){this.$3fQ(!0)},$3fQ:function(n){var t=null;if(n){_a.$6.stPT(_a.$0.$5d,"CloseComposeApp",3);t=_a.$6.$1c(_a.$0.$5d,"CloseComposeApp",!0)}this.$3GE(null);if(n){_a.$6.$1E(t,"CloseComposeApp","");_a.$6.endPT("CloseComposeApp")}},$7iW:function(n){return!n},$6Ox:function(n){$6C(this,"OnExtensionOpened");_d.$2k.prototype.$3GE.call(this,n);$3WQ(this,!0)},$5NA:function(){$3WR(this,!0);this.set_$3dp(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3wT(!1);$6C(this,"BackToList");_d.$2k.prototype.$3GE.call(this,null)},$9Eq:function(n,t){if(t===_d.$2k.$2Wh||t===_d.$2k.$2S2||t==="ForceHideAppsButton"){this.set_$6Vg($4l1(this));this.$1kl.set_$5u(this.$29H)}},$6DK:function(n){this.$3GE(null);n()}};_d.$uj=function(n,t){this.$$d_$2uF=Function.createDelegate(this,this.$2uF);this.$$d_$5UL=Function.createDelegate(this,this.$5UL);_d.$uj.initializeBase(this);this.$6a=n;this.$NA=t;if(this.$NA==="TouchNarrow"){this.set_$7D(_y.$26.$Bg(this));var i=this;var r=new _C(function(){i.$4X()},_a.$0.$5d);this.$3w.set_$J0([new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_Close_LowerCase_Text,r)])}};_d.$uj.prototype={$NA:0,$Et:null,$6a:null,$1bt:!1,$1rC:null,$16I:null,get_$69N:function(){return this.$16I},set_$69N:function(n){this.$16I=n;return n},get_$1iT:function(){return 2},get_$2MT:function(){return this.$$d_$5UL},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$7iz:function(){return!0},get_$Ld:function(){return this.$NA==="TouchNarrow"?1:0},$5UL:function(n,t){if(this.$1bt)return!1;if(this.$16I){this.$1rC=n;this.$16I(this.$$d_$2uF);return!0}this.$2uF();return!1},$4X:function(){if(!this.$1bt&&this.get_$89()){this.get_$89()();this.$6a.$3fQ(!1)}},$2uF:function(){this.$1bt=!0;this.$1rC&&this.$1rC()}};_d.$Qi=function(){};_d.$Qi.$8IM=function(n){var i=n.toString();var t=_d.$Qi.$Dx[i];if(!t){t=_js.$1g.$9a(_d.$Qi.$1MQ,n);_d.$Qi.$Dx[i]=t}return t};_d.$Qi.$1MQ=function(){};_d.$Qi.$1MQ.prototype={};_d.$Qi.$1MQ.registerEnum("_d.$Qi.$1MQ",!1);_d.$14Z=function(){_d.$14Z.initializeBase(this,[1,"VM.Extensibility.Stats"])};_d.$14Z.prototype={get_$7Zn:function(){return this.$U("ContextRetrievalTime")},set_$7Zn:function(n){$1M(this,"ContextRetrievalTime",n);return n},get_$7Zl:function(){return this.$U("ContextExtensionsCount")},set_$7Zl:function(n){$1M(this,"ContextExtensionsCount",n);return n},get_$8Ir:function(){return this.$U("MaxCountOfActiveExtensions")},set_$8Ir:function(n){$1M(this,"MaxCountOfActiveExtensions",n);return n},get_$7N0:function(){return this.$U("ActivationTime")},set_$7N0:function(n){$1M(this,"ActivationTime",n);return n},get_$9vu:function(){return this.$U("TotalActivationStatistics")},set_$9vu:function(n){$1M(this,"TotalActivationStatistics",n);return n},get_$9Zi:function(){return this.$U("RegExStatistics")},set_$9Zi:function(n){$1M(this,"RegExStatistics",n);return n},get_$9U2:function(){return this.$U("PerExtensionStatistics")},set_$9U2:function(n){$1M(this,"PerExtensionStatistics",n);return n},get_$a6:function(){return this.$U("Interval")},set_$a6:function(n){$1M(this,"Interval",n);return n},get_$7qC:function(){return this.$U("FromHtmlStatistics")},set_$7qC:function(n){$1M(this,"FromHtmlStatistics",n);return n},get_$86e:function(){return this.$U("InnerTextStatistics")},set_$86e:function(n){$1M(this,"InnerTextStatistics",n);return n},get_$84U:function(){return this.$U("HtmlBodyLengthStatistics")},set_$84U:function(n){$1M(this,"HtmlBodyLengthStatistics",n);return n},get_$7aA:function(){return this.$U("ConvertedBodyLengthStatistics")},set_$7aA:function(n){$1M(this,"ConvertedBodyLengthStatistics",n);return n},get_$7m2:function(){return this.$U("EntityStatistics")},set_$7m2:function(n){$1M(this,"EntityStatistics",n);return n}};_d.$Im=function(){this.$$d_$5QE=Function.createDelegate(this,this.$5QE);this.$3mE=6e5;this.$44d=_a.$7.$an;this.$1Jd=[];this.$1Zy={};this.$1Zz={}};function $6sD(n,t){for(var i=new Sys.StringBuilder,r=0;r<_c.$8j.$mH.Extensions.length;r++){var u=_c.$8j.$mH.Extensions[r];var f=$6(n.$1Zy[u.Id])?0:n.$1Zy[u.Id];var e=$6(n.$1Zz[u.Id])?0:n.$1Zz[u.Id];i.append("[");i.append(t[r]?t[r].$1Hc():"");i.append(",");i.append(f.toString());i.append(",");i.append(e.toString());i.append("]")}return i.toString()}function $2Cg(n){return n.$1Jd.length>=n.$8Ip||!_js.Trace.$2t}_d.$Im.prototype={$8Ip:100,$19S:null,$pb:null,$iK:null,$1tK:null,$6c6:function(n,t){if(!$2Cg(this)){this.$iK||(this.$iK=new _d.$Im.$5MH);if(!this.$iK.$3K1){this.$iK.$3K1=[];this.$iK.$2Zv=[]}Array.add(this.$iK.$3K1,n);Array.add(this.$iK.$2Zv,t)}},$9wQ:function(n){this.$1Zz[n]=$6(this.$1Zz[n])?1:this.$1Zz[n]+1},$6c1:function(n,t,i){i&&(this.$1Zy[n]=$6(this.$1Zy[n])?1:this.$1Zy[n]+1);if(!$2Cg(this)){this.$iK||(this.$iK=new _d.$Im.$5MH);this.$iK.$6YK=t;this.$iK.$53E=i;this.$19S||(this.$19S=new _d.$Im.$53F);Array.add(this.$19S.$2z0,this.$iK);this.$iK=null}},$6c3:function(n,t){if(!$2Cg(this)){this.$1tK||(this.$1tK=new _d.$Im.$7nd);this.$1tK.$6c3(n,t)}},$6c7:function(n){if(!$2Cg(this)){this.$19S||(this.$19S=new _d.$Im.$53F);this.$19S.$6bl=n;Array.add(this.$1Jd,this.$19S);this.$19S=null}},$9wM:function(n,t,i,r){if(!$2Cg(this)){this.$pb||(this.$pb=new _d.$Im.$7SY);this.$pb.$3x6.$6I(n,null);this.$pb.$3yF.$6I(r,null);this.$pb.$3s9.$6I(i,null);this.$pb.$3jR.$6I(t,null)}},$5Nb:function(){var n=_a.$7.get_$29();if(n.$5z(this.$44d)>=this.$3mE){_a.$g.$8s.$7N5(this.$$d_$5QE);this.$9cm();this.$44d=n}},$9cm:function(){this.$1Jd=[];this.$1Zy={};this.$1Zz={};this.$19S=null;this.$iK=null;this.$pb=null;this.$1tK=null},$fM:function(n){var t=new Sys.StringBuilder;if($6(_c.$8j.$mH))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$5QE().$9a(n));n&&t.append("</TABLE>")}return new _a.$Lf("Pending Extensibility Statistics",t.toString())},$5QE:function(){var s=_c.$8j.$mH.Extensions.length;var n=new _d.$14Z;n.set_$7Zn(_c.$8j.$34H);n.set_$7Zl(s);if(this.$1Jd.length>0){for(var r=0,h=new _d.$V4,i=new Array(s),c=new _d.$V4,u=0;u<this.$1Jd.length;u++){var f=this.$1Jd[u];h.$6I(f.$6bl,null);for(var e=0,t=0;t<f.$2z0.length;t++){var o=f.$2z0[t];o.$53E&&e++;$6(i[t])&&(i[t]=new _d.$V4);var l=_c.$8j.$mH.Extensions[t];var a=$6(l)?null:l.DisplayName;i[t].$6I(o.$6YK,a);o.$A0d(c)}e>r&&(r=e)}n.set_$8Ir(r);n.set_$7N0(this.$1Jd.length);n.set_$9vu(h.$1Hc());n.set_$9U2($6sD(this,i));n.set_$9Zi(c.$1Hc());n.set_$a6(this.$3mE/1e3);if(this.$pb){n.set_$7qC(this.$pb.$3s9.$1Hc());n.set_$86e(this.$pb.$3yF.$1Hc());n.set_$84U(this.$pb.$3x6.$1Hc());n.set_$7aA(this.$pb.$3jR.$1Hc())}this.$1tK&&n.set_$7m2(this.$1tK.$1Hc())}return n}};_d.$Im.$53F=function(){this.$2z0=[]};_d.$Im.$53F.prototype={$6bl:0};_d.$Im.$7SY=function(){this.$3s9=new _d.$V4;this.$3yF=new _d.$V4;this.$3x6=new _d.$V4;this.$3jR=new _d.$V4};_d.$Im.$5MH=function(){};_d.$Im.$5MH.prototype={$3K1:null,$2Zv:null,$6YK:0,$53E:!1,$A0d:function(n){if(this.$2Zv)for(var t=0;t<this.$2Zv.length;t++)n.$6I(this.$2Zv[t],this.$3K1[t])}};_d.$Im.$7nd=function(){};_d.$Im.$7nd.prototype={$65U:0,$65V:0,$65W:0,$65X:0,$65Y:0,$65Z:0,$65a:0,$1gC:null,$6c3:function(n,t){this.$1gC=null;var i=!t;if(n){var r=new(_0365f.$o.$$(_g.$jv));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1W9(3);this.$65U++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1W9(7);this.$65V++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1W9(6);this.$65W++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1W9(1);this.$65X++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1W9(5);this.$65Y++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1W9(2);this.$65Z++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1W9(4);this.$65a++}}},$1Hc:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$65U,this.$65V,this.$65W,this.$65X,this.$65Y,this.$65Z,this.$65a));if(this.$1gC){n.append("MissingOnLastMessage:");for(var t=0;t<this.$1gC.get_$B();t++){n.append(_g.$jv.toString(this.$1gC.get_$3q(t)));n.append(",")}}return n.toString()},$1W9:function(n){this.$1gC||(this.$1gC=new(_0365f.$o.$$(_g.$jv)));this.$1gC.$D(n)}};_d.$I1=function(n,t){this.$$d_$9gJ=Function.createDelegate(this,this.$9gJ);this.$$d_$9Va=Function.createDelegate(this,this.$9Va);_d.$I1.initializeBase(this);this.$ZK=n;this.$1HY=t;this.$3IT=new _C(this.$$d_$9Va,_a.$0.$5d);this.$2KN=new _0365m.$2b(new Array(0));this.$1MV=new _js.$Z};function $4lQ(n){var r=n.$ZK.get_$B();if(r>n.$1E0){var t=0;n.$2KN.$1C.$1r();while(t<r){var i=n.$ZK.get_$3q(t);if(n.$1MV.$71(i)<0){var u=new _0365m.$m(i.$6b.DisplayName,null,new _d.$vY(n.$$d_$9gJ,i),!0);n.$2KN.$1C.$D(u)}t++}n.set_$5Vo(!1)}else{n.$2KN.$1C.$1r();n.set_$5Vo(!0)}}_d.$I1.prototype={$1E0:0,$ZK:null,$1MV:null,$2KN:null,$1HY:null,$2y4:!0,$1la:null,$1PE:null,$3IT:null,get_$5Vo:function(){return this.$2y4},set_$5Vo:function(n){if(this.$2y4!==n){this.$2y4=n;$3(this,_d.$I1.$5Vp)}return n},get_$3Qn:function(){return this.$1la},set_$3Qn:function(n){if(this.$1la!==n){this.$1la=n;$6(n)||$3(this,_d.$I1.$4Ze)}return n},get_$5hH:function(){return this.$1PE},set_$5hH:function(n){this.$1PE=n;if(n.$Sa===3){var t=this.$1PE.$3pw.get_$20().extensionViewModel;if($6(t)||this.$1la===t){this.$1HY.$C0=null;this.$1HY.$n();this.$ZZ()}else{this.$1HY.$C0=t;this.$1HY.$n();this.set_$3Qn(t)}}return n},$ZZ:function(){this.$1la=null;$3(this,_d.$I1.$4Ze)},$9Va:function(){if(!(this.$1E0<1)){var n=0;var i=this.$ZK.get_$B();var u=!1;var t=this.$1la;var r=this.$1E0;this.$1MV.$1r();while(n<r&&n<i){var o=this.$ZK.get_$3q(n);var f=n+1===r||n+1===i;($6(t)||o.$6b.Id===t.$6b.Id)&&(u=!0);var e=f&&!u?t:this.$ZK.get_$3q(n);this.$1MV.$D(e);e.set_$5bw(f&&i<=r);n++}this.set_$3Qn(t);$4lQ(this)}},$9gJ:function(n){n.set_$5bw(!1);this.$1MV.$68(this.$1MV.get_$B()-1);this.$1MV.$D(n);this.$1HY.$C0=n;this.$1HY.$n();this.set_$3Qn(n);$4lQ(this)}};_d.$vX=function(n,t,i){this.$$d_$5NC=Function.createDelegate(this,this.$5NC);this.$$d_$2uF=Function.createDelegate(this,this.$2uF);this.$$d_$5UL=Function.createDelegate(this,this.$5UL);_d.$vX.initializeBase(this);this.$6a=n;this.$NA=i;if(i!=="Mouse"){this.set_$7D(_y.$26.$Bg(this));var e=this;var o=new _C(function(){e.$4X()},_a.$0.$5d);this.$3w.set_$J0([new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$1dA())if(_g.$33.isInstanceOfType(this.$6a.$P))this.set_$442(this.$6a.$P.get_$3C().get_$1g());else if(this.$6a.$P.get_$Ir()&&this.$6a.$P.get_$Ir().get_$1g())this.set_$442(this.$6a.$P.get_$Ir().get_$1g());else{var r=_0365f.$2t.$3p(_h.$15.get_$xY());r.MaximumBodySize=0;var u=new _h.$Ip(100,[this.$6a.$P.get_$i()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2C(function(n){f.set_$442(f.$6a.$P.get_$Ir().get_$1g())});OwaApplication.$1W.$z(u)}};_d.$vX.prototype={$Et:null,$6a:null,$16I:null,$441:null,$1bt:!1,$1rC:null,$NA:0,get_$442:function(){return this.$441},set_$442:function(n){this.$441=n;$3(this,"ItemBodyValue");return n},get_$1iT:function(){return 4},get_$2MT:function(){return this.$$d_$5UL},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$7iz:function(){return!0},get_$Ld:function(){return this.$NA!=="Mouse"?1:0},get_$69N:function(){return this.$16I},set_$69N:function(n){this.$16I=n;return n},$5UL:function(n,t){if(this.$1bt)return!1;if(this.$16I){this.$1rC=n;this.$16I(this.$$d_$2uF);return!0}this.$2uF();return!1},$4X:function(){this.$1bt||(this.$NA==="TouchNarrow"?this.$16I?this.$16I(this.$$d_$5NC):this.$5NC():this.get_$89()&&this.get_$89()())},$5NC:function(){this.$1bt=!0;this.get_$89()&&this.get_$89()()},$2uF:function(){this.$1bt=!0;this.$1rC&&this.$1rC()}};_d.$oT=function(){};_d.$oT.prototype={$7cO:function(n,t,i){return new _d.$vX(n,t,i)},$7bd:function(n,t){return new _d.$uj(n,t)}};_d.$TF=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6DK=Function.createDelegate(this,this.$6DK);this.$$d_$5NB=Function.createDelegate(this,this.$5NB);this.$$d_$6HG=Function.createDelegate(this,this.$6HG);_d.$TF.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a])};function $6sF(n){"Mouse"!==n.$C.get_$L()&&n.$FM&&(n.$13.get_$67()?n.$9Q.$5LD(n.$FM.get_$5LG(),n.$FM.get_$1tW().DisplayName,n.$$d_$6HG,n.$$d_$5NB):n.$6HG())}function $6sE(n){n.$dS=n.$1Zw.$7cO(n,n.$13,n.$C.get_$L());n.$dS.set_$69N(n.$$d_$6DK);n.$C.$7X(n.$dS)}_d.$TF.prototype={$dS:null,$3r4:null,$3GE:function(n){_d.$2k.prototype.$3GE.call(this,n);$6sF(this)},$7H:function(){_d.$2k.prototype.$7H.call(this);this.$dS&&this.$dS.$4X()},$7iW:function(n){return"Mouse"!==this.$C.get_$L()||!n},$6HG:function(){$3WQ(this,!0);$6sE(this)},$6DK:function(n){this.$16U&&this.$16U.$ZZ();this.$3r4=n;$3WR(this,!0);this.$13.get_$67()?this.$9Q.$5Lz():this.$5NB()},$5NB:function(){this.$3r4&&this.$3r4()}};_d.$14b=function(n){_d.$14b.initializeBase(this,[1,"VM.Extensibility."+n])};_d.$14b.prototype={$z:function(){_a.$g.$8s.$AN(this)},$6J4:function(n){var t=n;for(var i in t){var r={key:i,value:t[i]};$1M(this,r.key,r.value)}}};_d.$vY=function(n,t){this.$$d_$7nD=Function.createDelegate(this,this.$7nD);_d.$vY.initializeBase(this);this.set_$5u(!0);this.set_$OD(this.$$d_$7nD);this.$5Yd=n;this.$C0=t;this.$1p=_a.$0.$5d};_d.$vY.prototype={$5Yd:null,$C0:null,$7nD:function(){this.$5Yd(this.$C0)}};_d.$TG=function(n,t,i,r,u,f,e,o,s,h,c){this.$EE=n;this.$1Zw=t;this.$Em=i;this.$25b=r;this.$9Q=u;this.$13=f;this.$C=e;this.$M=o;this.$2KK=s;this.$2KM=h;this.$OE=c};function $4lX(n,t,i,r){return new _d.$TF(n.$Em,n.$9Q,n.$13,n.$C,n.$1Zw,!0,_a.$Cp.$x7(),n.$25b,n.$M,n.$OE,t,i,r)}_d.$TG.prototype={$Em:null,$25b:null,$9Q:null,$13:null,$C:null,$1Zw:null,$M:null,$2KK:null,$2KM:null,$OE:null,$EE:null,$3kW:function(n,t){return $4lX(this,n,this.$2KK.$5FJ(n,t),this.$2KM.$3kW(n,t))},$5ED:function(n){return $4lX(this,n,this.$2KK.$5FJ(n,!1),this.$2KM.$5ED(n))},$5F3:function(n,t){return new _d.$H9(_a.$0.$j,this.$EE,t,this.$Em,this.$9Q,this.$13,this.$C,this.$1Zw,!0,_a.$Cp.$x7(),this.$25b,this.$M,this.$OE,null,this.$2KK.$5EH(2),this.$2KM.$5F3(n))},$5EA:function(n,t){return new _d.$H9(_a.$0.$1k,this.$EE,t,this.$Em,this.$9Q,this.$13,this.$C,this.$1Zw,!0,_a.$Cp.$x7(),this.$25b,this.$M,this.$OE,null,this.$2KK.$5EH(3),this.$2KM.$5EA(n))}};_d.$G3=function(n,t){this.$$d_$54Y=Function.createDelegate(this,this.$54Y);this.$2N6=[];_d.$G3.initializeBase(this);this.$6b=n;this.$mG=t;this.$1W5=_d.$Ci.$E(n.Rule,this.$mG)};_d.$G3.$6cX=function(n,t,i){i.val=null;var r=new _d.$G3(n,t);var u=null;var f=0;var e,o,s;if(s=_d.$G3.$9xA(n,t.$1Ms,e={val:u},o={val:f}),u=e.val,f=o.val,s){r.$3pf=u;r.$5HX=f;i.val=r;return!0}return!1};_d.$G3.$9xA=function(n,t,i,r){i.val=null;r.val=0;var u;if(t===1)u=0;else if(t===2||t===3)u=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,f=0;f<s;++f){var e=o[f];if(e.SettingsType===u){i.val=e.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=e.RequestedHeight;return!0}}return!1};_d.$G3.prototype={$3pf:null,$5HX:0,$6b:null,$1W5:null,$mG:null,$41F:!1,$2NI:null,get_$1tW:function(){return this.$6b},get_$Kf:function(){return this.$6b.AppStatus},get_$2tF:function(){return this.$6b.EndNodeUrl},get_$1o:function(){return this.$6b.DisplayName},get_$8Fs:function(){return this.$6b.LicenseType},get_$9Y9:function(){return this.$6b.ProviderName},get_$6UV:function(){return _js.$9.$18(this.$6b.Settings)?{}:JsonParser.deserialize(this.$6b.Settings)},set_$6UV:function(n){this.$6b.Settings=n?JsonParser.serialize(n):"";return n},get_$84Z:function(){if(!_js.$9.$18(this.$2NI))return this.$2NI;this.$2NI=_d.$G3.$2ys?_js.$9.$18(this.$6b.HighResolutionIconUrl)?this.$6b.IconUrl:this.$6b.HighResolutionIconUrl:_js.$9.$18(this.$6b.IconUrl)?this.$6b.HighResolutionIconUrl:this.$6b.IconUrl;return this.$2NI},get_$5LG:function(){return this.$3pf},get_$5bw:function(){return this.$41F},set_$5bw:function(n){if(n!==this.$41F){this.$41F=n;$3(this,"IsLastExtension")}return n},get_$2yN:function(){return this.$2N6},set_$2yN:function(n){this.$2N6=n;return n},$9jJ:function(n){var u=this.$mG.$46j;var s=this.$mG.$2Zu;Array.clear(this.$2N6);if(!this.$6b.DisableEntityHighlighting){var t={};var f=s;for(var e in f)for(var h={key:e,value:f[e]},o=h.value,i=0;i<o.length;i++)this.$54Y(o[i],null,t);for(var r=0;r<u.length;r++){var c=u[r];switch(c){case 3:_d.$5o.$1Bv(n.Addresses,"Address",t,this.$$d_$54Y);break;case 6:_d.$5o.$1Bv(n.EmailAddresses,"EmailAddress",t,this.$$d_$54Y);break;case 4:_d.$5o.$1Bv(n.Urls,"Url",t,this.$$d_$54Y);break;case 1:_d.$5o.$1Bv(n.MeetingSuggestions,"MeetingString",t,this.$$d_$54Y);break;case 2:_d.$5o.$1Bv(n.TaskSuggestions,"TaskString",t,this.$$d_$54Y);break;case 5:_d.$5o.$1Bv(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$54Y);break;case 7:_d.$5o.$1Bv(n.Contacts,"ContactString",t,this.$$d_$54Y);break}}this.$mG.$wI.$7pb(t,this.$$d_$54Y)}},$54Y:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$2N6,n);r[n]=!0}}};_d.$Ci=function(){};_d.$Ci.$E=function(n,t){var i=_d.$Ci.$5FB(n,t);if(!$6(i)){t.$5Gg>7&&$1nX(i,"Number of custom pattern rules exceeds the limit of "+7+".");t.$6Q2>15&&$1nX(i,"Number of rules exceeds the limit of "+15+".");if(i.$N7)return i}return null};_d.$Ci.$42X=function(n){return n.$1Ms===1};_d.$Ci.$5FB=function(n,t){return $6(n)?null:++t.$6Q2>15?null:n.Type==="Collection"?new _d.$12e(n,t):n.Type==="ItemIs"?new _d.$M4(n):n.Type==="ItemHasKnownEntity"?new _d.$5o(n):n.Type==="ItemHasRegularExpressionMatch"?new _d.$I9(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _d.$18S:null};function $1nX(n,t){_js.Trace.logError(_a.$0.$5d,t);n.$N7=!1}_d.$Ci.prototype={$N7:!0,$5bs:function(n,t){return!0}};_d.$12e=function(n,t){_d.$12e.initializeBase(this);if($6(n.Mode)){$1nX(this,"Collection rule with no required 'mode' attribute found.");return}if($6(n.Rules)||!n.Rules.length){$1nX(this,"Collection rule with no required 'rule' attribute found.");return}this.$3z8="And"===n.Mode;this.$1qi=new _js.$Z;for(var i=0;i<n.Rules.length;i++){var r=_d.$Ci.$5FB(n.Rules[i],t);$6(r)||this.$1qi.$D(r)}};_d.$12e.prototype={$3z8:!1,$1qi:null,$2tV:function(n,t,i){for(var r=this.$3z8,u=0;u<this.$1qi.get_$B();u++){var f=this.$1qi.get_$3q(u);r=this.$3z8?!!(r&f.$2tV(n,t,i)):!!(r|f.$2tV(n,t,i))}return r},$5bs:function(n,t){for(var i=0;i<this.$1qi.get_$B();i++){var r=this.$1qi.get_$3q(i);if(!r.$5bs(n,t))return!1}return!0}};_d.$vS=function(n,t){this.$46j=[];this.$wI=new _d.$7a;this.$OE=n;this.$1Ms=t};_d.$vS.prototype={$5Gg:0,$6Q2:0,$2Zu:null,$mj:!1,$OE:null,$1Ms:0};_d.$7a=function(){};_d.$7a.$1aM=function(n,t,i,r){if(n){var u=n;for(var f in u){var e={key:f,value:u[f]};_d.$5o.$1Bv(e.value,t,i,r)}}};_d.$7a.$1WC=function(n,t,i){i&&(n[t]=i)};_d.$7a.$1WB=function(n,t,i){n.val||(n.val={});n.val[t]=i};_d.$7a.prototype={$77:null,$1AZ:null,$Qy:null,$1eG:null,$16l:null,$1lh:null,$18i:null,$7t6:function(){var n={};_d.$7a.$1WC(n,"Addresses",this.$77);_d.$7a.$1WC(n,"Contacts",this.$1AZ);_d.$7a.$1WC(n,"EmailAddresses",this.$Qy);_d.$7a.$1WC(n,"MeetingSuggestions",this.$1eG);_d.$7a.$1WC(n,"PhoneNumbers",this.$16l);_d.$7a.$1WC(n,"TaskSuggestions",this.$1lh);_d.$7a.$1WC(n,"Urls",this.$18i);return n},$53d:function(n,t,i){switch(n){case 3:var r;_d.$7a.$1WB(r={val:this.$77},t,i);this.$77=r.val;break;case 7:var u;_d.$7a.$1WB(u={val:this.$1AZ},t,i);this.$1AZ=u.val;break;case 6:var f;_d.$7a.$1WB(f={val:this.$Qy},t,i);this.$Qy=f.val;break;case 1:var e;_d.$7a.$1WB(e={val:this.$1eG},t,i);this.$1eG=e.val;break;case 5:var o;_d.$7a.$1WB(o={val:this.$16l},t,i);this.$16l=o.val;break;case 2:var s;_d.$7a.$1WB(s={val:this.$1lh},t,i);this.$1lh=s.val;break;case 4:var h;_d.$7a.$1WB(h={val:this.$18i},t,i);this.$18i=h.val;break;default:break}},$7pb:function(n,t){_d.$7a.$1aM(this.$77,"Address",n,t);_d.$7a.$1aM(this.$1AZ,"ContactString",n,t);_d.$7a.$1aM(this.$Qy,"EmailAddress",n,t);_d.$7a.$1aM(this.$1eG,"MeetingString",n,t);_d.$7a.$1aM(this.$16l,"OriginalPhoneString",n,t);_d.$7a.$1aM(this.$1lh,"TaskString",n,t);_d.$7a.$1aM(this.$18i,"Url",n,t)}};_d.$18S=function(){_d.$18S.initializeBase(this)};_d.$18S.prototype={$2tV:function(n,t,i){return _d.$Ci.$42X(t)?n.get_$G9()!==undefined&&n.get_$G9():!1}};_d.$5o=function(n){this.$$d_$7mQ=Function.createDelegate(this,this.$7mQ);_d.$5o.initializeBase(this);$6(n.EntityType)?$1nX(this,"ItemHasKnownEntity rule contains null entity type."):this.$FJ=n};_d.$5o.$1Bv=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_d.$5o.$1N3=function(n,t,i){if($6(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_d.$5o.$89d(i,e,t)){f[r]=_d.$5o.$7tj(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$5d,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$5d,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_d.$5o.$89d=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_d.$5o.$5dG(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_d.$5o.$5dG=function(n){return n===7||n===1||n===2};_d.$5o.$7tj=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$7.$42(i.StartTime,!0).$5R());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$7.$42(i.EndTime,!0).$5R());return i;default:return n}};function $1Vc(n,t,i,r){var u=null;!$6(i)&&i.length>0&&(u=_d.$5o.$1N3(i,n.$FJ.EntityType,t.$mj));if(u){if(!n.$279){Array.add(t.$46j,n.$FJ.EntityType);return!0}var f=_a.$7.get_$29();_d.$5o.$1Bv(u,r,null,n.$$d_$7mQ);t.$OE.$6c6(n.$FJ.FilterName,_a.$7.get_$29().$5z(f));if(n.$wI){t.$wI.$53d(n.$FJ.EntityType,n.$FJ.FilterName,n.$wI);return!0}}n.$279&&t.$wI.$53d(n.$FJ.EntityType,n.$FJ.FilterName,null);return!1}function $6t4(n,t){return t?n.$FJ.EntityType===3&&t.ExtractedAddresses||n.$FJ.EntityType===7&&t.ExtractedContacts||n.$FJ.EntityType===6&&t.ExtractedEmails||n.$FJ.EntityType===1&&t.ExtractedMeetings||n.$FJ.EntityType===5&&t.ExtractedPhones||n.$FJ.EntityType===2&&t.ExtractedTasks||n.$FJ.EntityType===4&&t.ExtractedUrls:!1}_d.$5o.prototype={$FJ:null,$279:null,$wI:null,$5bs:function(n,t){return n.get_$12l()?!0:$6t4(this,n.get_$3J6())?this.$279?!1:t.$mj?!1:!_d.$5o.$5dG(this.$FJ.EntityType):!0},$2tV:function(n,t,i){if(!_d.$Ci.$42X(t))return!1;this.$wI=null;var r=n.get_$12l();if($6(r))return!1;if(this.$FJ.RegExFilter){var f,e;if(!(e=_d.$I9.$6cY(this.$FJ.RegExFilter,this.$FJ.IgnoreCase,f={val:this.$279}),this.$279=f.val,e))return!1}var u=!1;switch(this.$FJ.EntityType){case 3:u=$1Vc(this,t,r.Addresses,null);break;case 7:u=$1Vc(this,t,r.Contacts,"ContactString");break;case 6:u=$1Vc(this,t,r.EmailAddresses,null);break;case 1:u=$1Vc(this,t,r.MeetingSuggestions,"MeetingString");break;case 5:u=$1Vc(this,t,r.PhoneNumbers,"OriginalPhoneString");break;case 2:u=$1Vc(this,t,r.TaskSuggestions,"TaskString");break;case 4:u=$1Vc(this,t,r.Urls,null);break}return u},$7mQ:function(n,t,i){var r=n.match(this.$279);if(r&&r.length>0){this.$wI||(this.$wI=[]);Array.add(this.$wI,t)}}};_d.$I9=function(n,t,i){this.$5ZG=16e3;this.$3yv=64e3;this.$5Oy=5e5;_d.$I9.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$FJ=n;t.$5Gg++}else $1nX(this,"Invalid ItemHasRegularExpressionMatchRule rule.");this.$13=i};_d.$I9.$6cY=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$5d,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_d.$I9.$9al=function(n){for(var t=n.length-1;t>=0;t--){var i=!1;if(t>=50||n[t].length>3072)i=!0;else for(var r=t-1;r>=0;r--)if(n[t]===n[r]){i=!0;break}i&&Array.removeAt(n,t)}return n};_d.$I9.$7uK=function(n,t){if(t){if(n.get_$Lb())return n.get_$Lb().get_$1g()}else if(n.get_$Ir())return n.get_$Ir().get_$1g();else if(n.get_$3C())return n.get_$3C().get_$1g();_js.Trace.logWarning(_a.$0.$5d,"Skipping regex eval: no body for item with Id: {0}.",n.get_$i()?n.get_$i().Id:"'null id'");return null};function $6t5(n,t,i,r){if(n.$FJ.PropertyName===1)return t.get_$2i();else if(n.$FJ.PropertyName===4){var u=null;if(_g.$7g.isInstanceOfType(t))t.get_$8X()&&(u=t.get_$8X().Mailbox);else if(_g.$33.isInstanceOfType(t)){var o=t.get_$FE();o&&(u=o.Mailbox)}if(u&&u.EmailAddress)return u.EmailAddress}else if(n.$FJ.PropertyName===3){var s=null;t.get_$gS()===3&&(s=$4lj(n,t,i.$mj));return s}else if(n.$FJ.PropertyName===2){if(r.val)return r.val;var f=$4lj(n,t,i.$mj);var c=_a.$7.get_$29();var e=$(f);var h=_a.$7.get_$29();e[0]&&(r.val=e[0].innerText);$6(r.val)&&(r.val=e.text());var l=_a.$7.get_$29();i.$OE.$9wM(f?f.length:0,r.val?r.val.length:0,h.$5z(c),l.$5z(h));return r.val}return null}function $4lj(n,t,i){var r=_d.$I9.$7uK(t,i);if(r){if(r.length>n.$5Oy){_js.Trace.logInfo(_a.$0.$5d,"Body size exceeds general activation size limit");r=null}if(n.$13.get_$31O()||n.$13.get_$31Q())if(n.$FJ.PropertyName===2){if(r.length>n.$5ZG){_js.Trace.logInfo(_a.$0.$5d,"Body size exceeds IPhone/IPad activation size limit");r=null}}else if(n.$FJ.PropertyName===3&&r.length>n.$3yv){_js.Trace.logInfo(_a.$0.$5d,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");r=r.substr(0,n.$3yv)}}return r}_d.$I9.prototype={$FJ:null,$13:null,$2tV:function(n,t,i){if(!_d.$Ci.$42X(t))return!1;var r=null;var f=$6t5(this,n,t,i);if(f){var u;var e,o;if(!(o=_d.$I9.$6cY(this.$FJ.RegExValue,this.$FJ.IgnoreCase,e={val:u}),u=e.val,o))return!1;var s=_a.$7.get_$29();r=f.match(u);t.$OE.$6c6(this.$FJ.RegExName,_a.$7.get_$29().$5z(s));if(r&&r.length>0){r=_d.$I9.$9al(r);if(r.length>0){t.$2Zu[this.$FJ.RegExName]=r;return!0}}}t.$2Zu[this.$FJ.RegExName]=new Array(0);return!1}};_d.$M4=function(n){_d.$M4.initializeBase(this);this.$5XH=n.IncludeSubClasses;this.$xa=n.ItemType;this.$2QW=n.FormType;$6(n.ItemClass)||(this.$33g=n.ItemClass.toLowerCase())};_d.$M4.$41j=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_d.$M4.$5Zc=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_d.$M4.prototype={$33g:null,$5XH:!1,$xa:0,$2QW:0,$2tV:function(n,t,i){if(t.$1Ms===1&&(this.$2QW===2||this.$2QW===3)){if(!$6(n.get_$8n())){var r=n.get_$8n().toLowerCase();if(this.$xa===1&&_g.$7g.isInstanceOfType(n)&&_d.$M4.$41j(r)||this.$xa===2&&_g.$33.isInstanceOfType(n)&&_d.$M4.$5Zc(r)){if(!this.$33g)return!0;if(this.$5XH){if(r.startsWith(this.$33g))return!0}else if(r===this.$33g)return!0}}}else if(t.$1Ms===2&&this.$xa===1||t.$1Ms===3&&this.$xa===2)return this.$2QW===1||this.$2QW===3;return!1}};_d.$H7=function(n,t,i,r){this.$$d_$57d=Function.createDelegate(this,this.$57d);this.$$d_$9L3=Function.createDelegate(this,this.$9L3);this.$$d_$4Kn=Function.createDelegate(this,this.$4Kn);_d.$H7.initializeBase(this);this.$b3=r;this.$7E=n;this.$GU=new _C(this.$$d_$4Kn,_a.$0.$4W);this.set_$25z(i.$Tu(1,_y.$w.$Mf,this.$7E.get_$Or(),0));this.$7E.get_$Or().add_$1Z(this.$$d_$9L3);t.add_$Tm(this.$$d_$57d);if(r.get_mainWindowInstance()&&!r.get_mainWindowInstance().closed){var u=this;_a.$40.$GA(r.get_mainWindowInstance(),function(n){n.chatWindowReady(u.$7E.get_$R())})}};_d.$H7.prototype={$b3:null,$7E:null,$GU:null,$Ih:null,$4PL:null,get_$25z:function(){return this.$U(_d.$H7.$4MQ)},set_$25z:function(n){this.$K(_d.$H7.$4MQ,n);return n},get_$2bb:function(){return this.$U(_d.$H7.$4UI)},set_$2bb:function(n){this.$K(_d.$H7.$4UI,n);return n},get_$NV:function(){return this.$4PL},set_$NV:function(n){this.$4PL=n;$3(this,"RawEditorContent");return n},$9L3:function(n,t){switch(t.$2v){case 0:for(var i=0;i<t.$2l.length;i++){var f=t.$2l[i];this.get_$25z().$1ov(f)}return;case 2:for(var r=t.$38.length-1;r>=0;r--){var e=t.$38[r];var o=this;var u=this.get_$25z().$1T.$DY(function(n){var t=n;return t.$CA.get_$A6()===e.get_$A6()});u<this.get_$25z().$1T.get_$B()&&this.get_$25z().$1T.$68(u)}return}},$4Kn:function(){if(!_js.$9.$a(this.get_$2bb())){this.$7E.$9oN(this.get_$2bb());var n=this;_a.$40.$GA(this.$b3.get_mainWindowInstance(),function(t){t.sendChatMessage(n.$7E.get_$1y().Id,n.get_$2bb())})}},$57d:function(n){_js.Trace.logInfo(_a.$0.$4W,"ChatViewModel.BeforeUnload invoked.");this.$7E.get_$Or().remove_$1Z(this.$$d_$9L3);var t=this;_a.$40.$GA(this.$b3.get_mainWindowInstance(),function(n){_js.Trace.logInfo(_a.$0.$4W,"ChatViewModel.BeforeUnload calling into main window.");n.endChat(t.$7E.get_$R())})}};_d.$a7=function(n,t,i){this.$C=n;this.$6Q=t;this.$b3=i};_d.$a7.prototype={$C:null,$6Q:null,$b3:null,$9S1:function(n){var i={};i.ItemID=n.get_$i();var r=new _d.$QU;r.set_$4W(n);var t=_y.$48.get_$84q();if(n.$3UG!==-1&&n.$3UK!==-1){t.$3UF=n.$3UG;t.$3UJ=n.$3UK}_js.Trace.logInfo(_a.$0.$4W,"ChatViewModelFactory: Chat.BodyText: {0}",n.get_$1X3());var u=this;this.$C.$MH(_d.$a7,function(){return u},i,t,r,!1)},$bC:function(n,t){return null},$vo:function(n,t){var i=n.get_$4W();return new _d.$H7(i,this.$C,this.$6Q,this.$b3)}};_d.$QU=function(){_d.$QU.initializeBase(this)};_d.$QU.prototype={get_$4W:function(){return this.$U(_d.$QU.$3hc)},set_$4W:function(n){this.$K(_d.$QU.$3hc,n);return n},get_$241:function(){return[this.get_$4W()]},get_$4O6:function(){return null}};_d.$1D8=function(n){this.$b3=n};_d.$1D8.prototype={$b3:null,$6Yj:function(n,t,i){for(var u=new Array(n.get_$B()),f=new Array(n.get_$B()),r=0;r<n.get_$B();r++){var e=n.get_$3q(r);u[r]=e.get_$1o();f[r]=e.get_$A6()}var o=$6(t)?null:t.get_$R();var s=this;_a.$40.$GA(this.$b3.get_mainWindowInstance(),function(n){n.startChat(u,f,o,i)})}};_d.$TL=function(){_d.$TL.initializeBase(this);this.$Rh=_pc.$14.$1S1;this.$3I6=_d.$TL.$5Hf;this.$1Gi=2};_d.$TL.prototype={$2G:null,$Rh:null,$19Y:null,$3I6:null,$3tY:function(n){return _pc.$14.$1LN(this.$2s,this.$2G,n,this.$Rh,null,this.$19Y,this.$3I6,1)}};_d.$vg=function(n){_d.$vg.initializeBase(this);this.$2ZQ=n;switch(this.$2ZQ){case 2:case 6:this.$1Gi=1;break;case 1:this.$1Gi=3;break;default:throw Error.argumentOutOfRange("querySources",n,"Unsupported source for places action provider");}};_d.$vg.prototype={$3tY:function(n){var t=new _g.$TN;t.Query=this.$2s;t.Sources=this.$2ZQ;t.MaxResults=12;t.Culture=_g.$V.get_$I().get_$31().get_$7Z();if(this.$26n.$HQ.$W3()){t.Latitude=this.$26n.$HQ.$Pp;t.Longitude=this.$26n.$HQ.$Ps}return new _c.$oY(t,n)}};_d.$bd=function(n,t,i,r){this.$$d_$1Rc=Function.createDelegate(this,this.$1Rc);this.$$d_$5gl=Function.createDelegate(this,this.$5gl);this.$$d_$6fM=Function.createDelegate(this,this.$6fM);_d.$bd.initializeBase(this,[n,t,!1,null,!1,r,null,null]);this.$26M=t;this.$6f=i;this.set_$7oG("");this.$6fN=new _C(this.$$d_$6fM,_a.$0.$4j);this.$5gr=new _C(this.$$d_$5gl,_a.$0.$4j);this.$1DO=!0;this.$Y("QueryString",this.$$d_$1Rc)};function $4lZ(n,t,i){var u=t.$3ta();i.val=-1;for(var r=0;r<n.$26M.$1t.get_$B();r++){var f=n.$26M.$1t.get_$3q(r);if(f.$3ta()===u){i.val=r;return!0}}return!1}_d.$bd.prototype={$26M:null,$6f:null,$1cO:!1,$5gr:null,$6fN:null,$2fm:null,$4Ww:!0,$1DO:!1,get_$A1d:function(){return!1},get_$8Fc:function(){return"http://go.microsoft.com/fwlink/?LinkId=260597"},get_$9od:function(){return!this.$26M.$1t.get_$B()},get_$8B8:function(){return this.$1cO},set_$8B8:function(n){if(this.$1cO!==n){this.$1cO=n;this.$1cO&&this.$h0(_nbs.NonBootStrings.l_LearnMore_Aria_Text);$N(this,"IsLearnMoreButtonHighlighted")}return n},get_$8Fb:function(){return this.$5gr},get_$9pm:function(){return this.$4Ww},set_$9pm:function(n){if(this.$4Ww!==n){this.$4Ww=n;$N(this,"ShowUseThisLocationButton")}return n},get_$A1y:function(){return this.$2fm},set_$A1y:function(n){if(this.$2fm!==n){this.$2fm=n;this.$1DO&&this.$h0(this.$2fm);$N(this,"UseThisLocationString")}return n},get_$A1x:function(){return this.$6fN},get_$8E9:function(){return this.$1DO},set_$8E9:function(n){if(this.$1DO!==n){this.$1DO=n;this.$1DO&&this.$h0(this.$2fm);$N(this,"IsUseThisLocationButtonHighlighted")}return n},$6cW:function(n){n&&!this.$8CW(n)&&this.$26M.$1t.$D(n)},$6OE:function(){this.set_$8B8(!1);this.set_$ip(!1);this.set_$i7(-1);this.set_$Iz(-1);this.set_$8E9(!0)},$7hv:function(n){var t;var i,r;if(n&&(r=$4lZ(this,n,i={val:t}),t=i.val,r)){this.$26M.$1t.$68(t);var u=new _g.$az;u.Id=n.$3ta();var f=new _c.$13p(u);this.$1W.$z(f)}},$8CW:function(n){var t;var i,r;return r=$4lZ(this,n,i={val:t}),t=i.val,r},$2py:function(n){var t=new _d.$8a(n,_y.$w.$1dY,!1);t.$dk(1,_d.$ED.$352,"");if($6(n.get_$2w()))return t;t.$9VZ();return t},$9Oc:function(){this.set_$da(!1);this.set_$Iz(-1);this.set_$i7(-1)},$9n9:function(){return!1},$59f:function(){if(this.$1DO)return!0;else if(!this.$AE.get_$B()&&this.$r7){this.set_$ip(!1);this.set_$8E9(!0);return!0}else if(this.$Fr){if(this.$1cO){this.set_$8B8(!1);this.set_$ip(!0);return!0}}else{this.set_$i7(-1);this.set_$Iz(-1);this.set_$8E9(!0);return!0}return _d.$2C.prototype.$59f.call(this)},$59e:function(){if(this.$1DO){this.set_$8E9(!1);if(this.$AE.get_$B()){this.set_$i7(0);this.set_$Iz(0);return!0}else{this.set_$ip(!0);return!0}}else if(this.$r7&&this.get_$9od()){this.set_$ip(!1);this.set_$8B8(!0);return!0}else if(this.$1cO)return!0;return _d.$2C.prototype.$59e.call(this)},get_$6Qk:function(){return _nbs.NonBootStrings.l_LocationWellSearchForMoreLocations_Text},$4TG:function(){this.$1DO?this.$6fM():this.$1cO?this.$5gl():_d.$2C.prototype.$4TG.call(this)},$5gl:function(){this.$6f.$Re(this.get_$8Fc())},$6fM:function(){this.set_$da(!1)},$1Rc:function(n,t){this.set_$A1y(_js.$9.$4R(_nbs.NonBootStrings.l_UseThisLocation_Text,this.$2s))}};_d.$5z=function(n,t,i,r){this.$$d_$9nU=Function.createDelegate(this,this.$9nU);this.$$d_$9nI=Function.createDelegate(this,this.$9nI);this.$$d_$9nS=Function.createDelegate(this,this.$9nS);this.$$d_$9pK=Function.createDelegate(this,this.$9pK);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$52v=Function.createDelegate(this,this.$52v);this.$$d_$9vj=Function.createDelegate(this,this.$9vj);this.$$d_$9vi=Function.createDelegate(this,this.$9vi);this.$$d_$1vA=Function.createDelegate(this,this.$1vA);this.$9x=-1;this.$1bJ=-1;this.$1PQ=new _a.$A8;this.$1PS=new _a.$A8;this.$1e5=new _a.$A8;this.$xm=_a.$7o.$1Yv;this.$1e7=10;this.$4G=new Sys.EventHandlerList;_d.$5z.initializeBase(this);_a.$4.$l(i,"locationManager");this.$xn=n;this.$Ox=t;this.$n0=i;this.$6f=r;if(this.$Ox){var u=n.get_$3q(0);if($6(u))throw Error.argument("mapPoints","mapPoints should contain at least one IMappable object.");if(n.get_$B()===1){var f=u.get_$20F().get_$UT()==="PhonebookServices"?u.get_$20F().get_$14i():"";this.$vA=new _a.$Oc(_g.$V.get_$I().get_$PE().get_$5Ix(),_a.$7o.$1Yv,_g.$V.get_$I().get_$31().get_$7Z(),u.get_$2Rz(),u.get_$20F().get_$1di(),u.get_$35e(),f)}}else n.get_$B()||(this.$1e7=1);this.set_$3ng(new _C(this.$$d_$1vA,_d.$5z.$A));this.set_$3lX(new _C(this.$$d_$9vi,_d.$5z.$A));this.set_$4bS(new _C(this.$$d_$9vj,_d.$5z.$A));_y.$v.$v.get_$L()!=="Mouse"&&$197(this)};function $6tJ(n){n.$6OP();n.$Ox&&n.$xn.get_$B()===1&&n.set_$35c(!1);n.get_$2OF()&&$197(n)}function $6tK(n,t){if(!t){n.set_$2cg(t);return}var i=this,r=this;n.$n0.$5QC(function(i){n.set_$8Hy(i);n.set_$2cg(t)},function(n){if(_y.$v.$v.get_$L()==="Mouse")switch(n.$5Be){case 2:case 3:_a.$4b.$32(_nbs.NonBootStrings.l_CurrentLocationError_Text,1);break;case 1:break}})}function $6tI(n){if(!n.$9t1){var t=n.$vA.get_$7q0();_a.UserAgent.getInstance().get_$67()&&(_a.UserAgent.getInstance().$iq?t=n.$vA.get_$7Pe():_a.UserAgent.getInstance().get_$L5()&&(t=n.$vA.get_$7Pt()));n.$6f.$Re(t)}}function $197(n){n.$Ox?n.$xn.get_$B()===1?n.set_$7D($6tH(n)):n.set_$7D(_y.$26.$E(n)):n.set_$7D($6tG(n))}function $6tH(n){var t=[new _y.$2W(_y.$c.get_$7ig(),_y.$c.get_$7il(),_nbs.NonBootStrings.l_GetDirectionsMobile_Text,n.$12J)];return _y.$26.$E(n,t,$3WY(n))}function $6tG(n){if(_y.$v.$v.get_$L()==="TouchNarrow"){var t=null;if(!n.$5Ve){var u=this;t=new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItemMobile_Text,new _C(n.$$d_$52v,_d.$5z.$A,n,"SelectedIndex",function(){return n.$9x!==-1}))}var i=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItemMobile_Text,new _C(n.$$d_$iF,_d.$5z.$A));var r=n.$5Ve?[i]:[t,i];return _y.$26.$Bg(n,r,$3WY(n))}else return _y.$26.$E(n,null,$3WY(n))}function $3WY(n){var i=new _y.$2v(n.$1Tt?_nbs.NonBootStrings.l_HideCurrentLocation_Text:_nbs.NonBootStrings.l_ShowCurrentLocation_Text,n.$1At);var r=new _y.$2v(n.$1U5?_nbs.NonBootStrings.l_HideTraffic_Text:_nbs.NonBootStrings.l_ShowTraffic_Text,n.$1IV);var t=[i,r];if(n.$xm!=="r"){var u=new _C(n.$$d_$9pK,_d.$5z.$A);var f=new _y.$2v(_nbs.NonBootStrings.l_RoadView_Text,u);Array.add(t,f)}if(n.$xm!=="auto"){var e=new _C(n.$$d_$9nS,_d.$5z.$A);var o=new _y.$2v(_nbs.NonBootStrings.l_AutomaticView_Text,e);Array.add(t,o)}if(n.$xm!=="a"){var s=new _C(n.$$d_$9nI,_d.$5z.$A);var h=new _y.$2v(_nbs.NonBootStrings.l_AerialView_Text,s);Array.add(t,h)}if(n.$xm!=="be"){var c=new _C(n.$$d_$9nU,_d.$5z.$A);var l=new _y.$2v(_nbs.NonBootStrings.l_BirdsEyeView_Text,c);Array.add(t,l)}return t}_d.$5z.prototype={$Ox:!1,$xn:null,$n0:null,$vM:!0,$35b:!1,$vA:null,$9t1:!1,$2eD:!1,$1Tt:!1,$1U5:!1,$5Ve:!1,$12J:null,$1At:null,$1IV:null,$6f:null,get_$Ld:function(){return _y.$v.$v.get_$L()!=="Mouse"?_y.$1KT.prototype.get_$Ld.call(this):0},add_$8IC:function(n){this.$4G.addHandler("MapPointAccepted",n)},remove_$8IC:function(n){this.$4G.removeHandler("MapPointAccepted",n)},add_$4TP:function(n){this.$Y("SelectedIndex",n)},remove_$4TP:function(n){this.$u("SelectedIndex",n)},add_$3wz:function(n){this.$Y("HoveredIndex",n)},remove_$3wz:function(n){this.$u("HoveredIndex",n)},add_$5j7:function(n){this.$Y("MapCenter",n)},remove_$5j7:function(n){this.$u("MapCenter",n)},get_$1iT:function(){return 1},get_$2MT:function(){return null},get_$QP:function(){return this.$9x},set_$QP:function(n){if(this.$9x!==n){(n>this.$xn.get_$B()-1||n<-1)&&(n=-1);this.$9x=n;$3(this,"SelectedIndex")}return n},get_$3wy:function(){return this.$1bJ},set_$3wy:function(n){if(this.$1bJ!==n){(n>this.$xn.get_$B()-1||n<-1)&&(n=-1);this.$1bJ=n;$3(this,"HoveredIndex")}return n},get_$5j6:function(){return this.$1PQ},set_$5j6:function(n){if(!$6(n)&&!this.$1PQ.$HQ.$1b3(n.$HQ)){this.$1PQ=n;$3(this,"MapCenter")}return n},get_$46X:function(){return this.$1PS},set_$46X:function(n){if(!$6(n)&&!this.$1PS.$HQ.$1b3(n.$HQ)){this.$1PS=n;$3(this,"MapViewCenter")}return n},get_$8Hy:function(){return this.$1e5},set_$8Hy:function(n){if(!$6(n)&&!this.$1e5.$HQ.$1b3(n.$HQ)){this.$1e5=n;$3(this,"MapCurrentLocation")}return n},get_$1e6:function(){return this.$xm},set_$1e6:function(n){if(n!==this.$xm){this.$xm=n;$6(this.$vA)||this.$vA.set_$2S0(this.$xm);this.$2eD||$3(this,"MapDisplayType")}return n},get_$5jC:function(){return this.$1e7},set_$5jC:function(n){if(n!==this.$1e7){this.$1e7=n;$3(this,"MapZoomLevel")}return n},get_$35c:function(){return this.$35b},set_$35c:function(n){this.$35b=n;$3(this,"MapBestViewSet");return n},get_$2cg:function(){return this.$1Tt},set_$2cg:function(n){if(n!==this.$1Tt){this.$1Tt=n;$6(this.$vA)||this.$vA.set_$9rh(this.$1Tt?this.$1e5:null);this.get_$2OF()&&$197(this);this.$2eD||$3(this,"ShowCurrentLocationOnMap")}return n},get_$6XP:function(){return this.$1U5},set_$6XP:function(n){if(n!==this.$1U5){this.$1U5=n;$6(this.$vA)||this.$vA.set_$2d9(this.$1U5);this.get_$2OF()&&$197(this);this.$2eD||$3(this,"ShowTrafficOnMap")}return n},get_$3ng:function(){return this.$12J},set_$3ng:function(n){this.$12J=n;$3(this,"DirectionsCommand");return n},get_$3lX:function(){return this.$1At},set_$3lX:function(n){this.$1At=n;$3(this,"CurrentLocationCommand");return n},get_$4bS:function(){return this.$1IV},set_$4bS:function(n){this.$1IV=n;$3(this,"TrafficCommand");return n},$1vA:function(){if($6(this.$vA)){_a.$4b.$32(_nbs.NonBootStrings.l_GiveDirectionsError_Text,1);return}$6tI(this)},$6OP:function(){this.$2eD=!0;this.set_$2cg(!1);this.set_$6XP(!1);this.set_$1e6(_a.$7o.$1Yv);this.$2eD=!1},$GN:function(){_y.$1KT.prototype.$GN.call(this);this.get_$2OF()&&$197(this)},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);$6tJ(this)},$iF:function(){this.get_$4i().$Bs()},$52v:function(){if(this.$9x!==-1){var n=this.$4G.getHandler("MapPointAccepted");$6(n)||n()}},$9vi:function(){$6tK(this,!this.$1Tt)},$9vj:function(){this.set_$6XP(!this.$1U5)},$9nI:function(){this.set_$1e6("a");$197(this)},$9nS:function(){this.set_$1e6("auto");$197(this)},$9nU:function(){this.set_$1e6("be");$197(this)},$9pK:function(){this.set_$1e6("r");$197(this)}};_d.$dR=function(n,t){this.$6f=t;this.$n0=n};_d.$dR.prototype={$n0:null,$6f:null,$3kF:function(n,t){var i=new _js.$Z;i.$D(n);return this.$E(i,t)},$E:function(n,t){return new _d.$5z(n,t,this.$n0,this.$6f)}};_d.$R7=function(n,t,i,r,u){this.$$d_$81c=Function.createDelegate(this,this.$81c);this.$$d_$1vA=Function.createDelegate(this,this.$1vA);_d.$R7.initializeBase(this);_a.$4.$J(r,"locationManager");this.$3m=n;this.$54=t;this.$n0=r;this.$6f=u;this.$xn=new _js.$Z;this.get_$W3()&&this.$xn.$D(t);if(i!=="Mouse"){var f=this;this.$6Ee=new _C(this.$$d_$81c,_a.$0.$4j,this,"IsResolved",function(){return f.get_$W3()})}};_d.$R7.prototype={$3m:null,$54:null,$1Dl:null,$6Ee:null,$xn:null,$n0:null,$6f:null,get_$1o:function(){return this.$54.get_$1o()},get_$hf:function(){return this.$54.get_$hf()},get_$1uJ:function(){return this.$54.get_$2w().get_$ZL()},get_$W3:function(){return this.$54?this.$54.$W3():!1},get_$1zt:function(){this.$1Dl||(this.$1Dl=new _d.$5z(this.$xn,!0,this.$n0,this.$6f));return this.$1Dl},$1vA:function(){this.get_$1zt().$1vA()},$81c:function(){this.$3m.$Bt(this.get_$1zt())}};_d.$qC=function(n,t){this.$n0=n;this.$6f=t};_d.$qC.prototype={$n0:null,$6f:null,$E:function(n,t,i){return new _d.$R7(n,t,i,this.$n0,this.$6f)}};_d.$ED=function(n,t,i,r,u){this.$$d_$9LU=Function.createDelegate(this,this.$9LU);this.$$d_$9Ld=Function.createDelegate(this,this.$9Ld);_d.$ED.initializeBase(this);this.$54=n;this.$4Lq=t;if(this.get_$3vi()){var e=_pc.$i.$2LD(n);this.$2RN=_d.$ED.$3kT(e,i,r);if(u&&this.$54.get_$2w().get_$UT()==="Resource"){_js.Trace.logInfo(_a.$0.$9k,"Creating ReadCard for LocationViewModel.");var f=this.$2RN.$PL;f.get_$QC().add_$1Gp(this.$$d_$9Ld);f.$2q0()}}};_d.$ED.$3kT=function(n,t,i,r,u,f){if(!n.$3w2())throw Error.invalidOperation("Cannot create persona view model for a persona that does not have a valid location identifier");var e=t.$SR(n,4,!1,0);var s=i.get_$L()!=="Mouse";switch(r){case 0:e.set_$er(!0);e.set_$2tO(!0);e.set_$DJ(!1);e.set_$1BT(!1);break;case 1:e.set_$er(!0);e.set_$2tO(!0);e.set_$DJ(!1);e.set_$1BT(!s);break;case 2:default:e.set_$er(!0);e.set_$2tO(!0);e.set_$DJ(!0);e.set_$1BT(!s);break}if(u&&u.length>0){for(var h=new Array(u.length),o=0;o<u.length;o++)h[o]=u[o].$3p();_d.$ED.$9Vw(e,h,f)}e.$dk(0,_d.$ED.$352,null,2);return e};_d.$ED.$9Vw=function(n,t,i){var r=[];Array.addRange(r,t);!$6(n.$i2)&&i&&Array.addRange(r,n.$i2);n.set_$1YK(r)};_d.$ED.prototype={$4Lq:null,$2RN:null,$54:null,add_$9J1:function(n){this.$2N("OnLocationUpdated",n)},remove_$9J1:function(n){this.$2P("OnLocationUpdated",n)},get_$3vi:function(){return!$6(this.$54)&&this.$54.$3vo()&&(this.$54.$W3()||this.$54.get_$2w().get_$UT()==="Resource")},get_$82q:function(){return this.$54===this.$4Lq},$9Ld:function(){var n=this.$2RN.$PL;if(n.get_$QC().$7R){n.get_$QC().$7R.add_$2YT(this.$$d_$9LU);n.get_$QC().remove_$1Gp(this.$$d_$9Ld)}},$9LU:function(){var t=this.$2RN.$PL.get_$QC().$7R;t.remove_$2YT(this.$$d_$9LU);var n=t.$14;if(n.get_$2w()){this.$54.get_$2w().set_$Pp(n.get_$2w().get_$Pp());this.$54.get_$2w().set_$Ps(n.get_$2w().get_$Ps());this.$54.get_$2w().set_$uz(n.get_$2w().get_$uz());$6C(this,"OnLocationUpdated")}}};_d.$9T=function(n,t,i,r,u,f,e){this.$$d_$1Rc=Function.createDelegate(this,this.$1Rc);this.$$d_$4Kk=Function.createDelegate(this,this.$4Kk);this.$$d_$6EU=Function.createDelegate(this,this.$6EU);this.$$d_$9Lx=Function.createDelegate(this,this.$9Lx);this.$$d_$9S0=Function.createDelegate(this,this.$9S0);this.$$d_$7hm=Function.createDelegate(this,this.$7hm);this.$$d_$8Gt=Function.createDelegate(this,this.$8Gt);_d.$9T.initializeBase(this);this.$2rR=new _C(this.$$d_$7hm,_d.$9T.$A);this.$452=new _C(this.$$d_$9S0,_d.$9T.$A);this.$3U5=[new _0365m.$m(_nbs.NonBootStrings.l_RemoveLocation_LowerCase_Text,null,this.$2rR)];this.$2Yi=i;this.$6IY=t;this.$C=r;this.$3m=u;this.$5C=f;this.$6f=e;this.$7cS();$6tO(this);$6tM(this,n)};function $6tL(n){n.$Yh=n.$2Yi.$E(9,n.$6IY);n.$Yh.add_$4TQ(n.$$d_$9Lx);if(n.$C.get_$L()==="Mouse"&&!n.$C.get_$9A()){var t=this;n.$Yh.add_$2k6(function(){n.$Yh.$3qB(n.$Yh.$bF,n.$Yh.$1HP)})}$3(n,"PlacePickerViewModel")}function $6tO(n){n.$EY.set_$1IK(n.$2rR);n.$EY.add_$33A(n.$$d_$6EU);n.$EY.add_$gw(n.$$d_$4Kk);n.$EY.$Y("QueryString",n.$$d_$1Rc);if(n.get_$2Yj()){n.$EY.set_$2q9(n.$452);n.$EY.set_$532(n.$452)}else n.$EY.set_$2q9(null)}function $4ln(n,t){n.$EY.set_$Ac(t);n.$1cQ=!1}function $6tM(n,t){n.$54=t?t.$3p():_g.$3Y.$vn();n.$54.set_$1o(n.$54.get_$1o()||"");$3WZ(n,_pc.$i.$2LD(n.$54))}function $3WZ(n,t){if(n.$54.get_$2w().get_$UT()==="Resource"){var r=n.$54.get_$1o();if(!_js.$9.$a(n.$54.get_$hf())){var i=new(_a.$3X.$$(String));i.$D(n.$54.get_$1o());i.$D(n.$54.get_$hf());r=_d.$13.$3tZ(i)}$4lp(n,r)}else n.$54.$3vo()?$6tN(n,t):$4lp(n,n.$54.get_$5JT())}function $4lp(n,t){$4ln(n,t);n.set_$1iG(null);n.$EY.set_$R8(n.get_$2Yj())}function $6tN(n,t){n.$EY.set_$NS(_nbs.NonBootStrings.l_LocationWellAnnotationWatermark_Text);n.$EY.set_$R8(!1);$4ln(n,n.$54.get_$hf()||"");n.$1cQ=!1;n.set_$1iG(_d.$ED.$3kT(t,n.$5C,n.$C,1,n.$3U5,!0))}function $4lo(n){n.$EY.set_$R8(n.get_$2Yj());n.set_$4j(_g.$3Y.$11t(n.$EY.$2s))}_d.$9T.prototype={$6f:null,$6e:null,$54:null,$EY:null,$2rR:null,$452:null,$3U5:null,$6IY:null,$Yh:null,$2Yi:null,$5C:null,$3m:null,$C:null,$1cQ:!1,get_$1iN:function(){this.$Yh||$6tL(this);return this.$Yh},get_$1iG:function(){return this.$6e},set_$1iG:function(n){if(this.$6e!==n){this.$6e=n;$3(this,"PersonaViewModel")}return n},get_$4j:function(){return this.$54},set_$4j:function(n){if(this.$54!==n&&!this.$54.$4e(n)){this.$54=n;$3(this,"Location")}return n},get_$5cA:function(){return this.$1cQ},set_$5cA:function(n){if(this.$1cQ!==n){this.$1cQ=n;$3(this,"IsLocationDirty")}return n},get_$2Yj:function(){return _g.$V.get_$I().get_$Ot().PlacesEnabled},get_$4i:function(){return this.$3m},set_$4i:function(n){this.$3m=n;return n},$9S0:function(){if(!this.get_$2Yj())throw Error.invalidOperation("Places must be enabled to use the place picker");if($6(this.$6e)&&!_js.$9.$18(this.$EY.$2s)){this.$EY.set_$da(!1);this.$EY.set_$HW(!1);this.get_$1iN().$3qB(this.$EY.$2s);this.$3m.$Bt(this.get_$1iN())}},$53l:function(n){this.set_$4j(n.$3RZ());$3WZ(this,n)},$4cg:function(){if(this.$1cQ){if($6(this.$6e)){if(!$6(this.$54)&&this.$54.get_$2w().get_$UT()==="Resource"&&this.$54.get_$1o()===this.$EY.$2s)return;$4lo(this)}else if(!$6(this.$54)&&!this.$EY.$fm){this.$54.set_$hf(this.$EY.$2s);$3(this,"Location")}this.set_$5cA(!1)}},$8Gt:function(n,t){var i=n.get_$4j();if(!this.$54.$4e(i)){var r=i||_g.$3Y.$vn();this.$54=r.$3p();$3WZ(this,_pc.$i.$2LD(this.$54));this.$EY.set_$2Mq(!1);$3(this,"Location")}},$7Od:function(n){!$6(n)&&n.$3vo()&&n.get_$2w().get_$UT()!=="Resource"&&this.$EY.$6cW(_pc.$i.$2LD(n))},$7cS:function(){this.$EY=new _d.$bd(_c.$Km.$5EY,_c.$Km.$7wX(),this.$6f,this.$5C);this.$EY.set_$1jW("PlaceDetailedView");if(this.get_$2Yj()){this.$EY.$11N();this.$EY.set_$R8(!0)}else this.$EY.set_$R8(!1);this.$EY.set_$q(!1);this.$EY.set_$tx(!1);this.$EY.set_$1gB(0);this.$EY.set_$18b(100)},$1Rc:function(n,t){this.set_$5cA(!0)},$7hm:function(){this.$EY.set_$NS("");this.set_$1iG(null);$4lo(this);this.$EY.set_$2Mq(!1)},$6EU:function(n,t){this.$EY.$mt||this.$4cg()},$4Kk:function(n,t){$6(this.$EY.get_$Wh())||this.$53l(this.$EY.get_$Wh().get_$1s())},$9Lx:function(n){$6(n)||this.$53l(n)}};_d.$qD=function(n,t,i){this.$2Yi=n;this.$C=t;this.$6f=i};_d.$qD.prototype={$2Yi:null,$5C:null,$C:null,$6f:null,$E:function(n,t,i){return new _d.$9T(n.$t.get_$4j(),t,this.$2Yi,this.$C,i,this.$5C,this.$6f)}};_d.$8l=function(n,t){_d.$8l.initializeBase(this,[n]);if(t){this.set_$28A(t.$bF);this.set_$6Qs(t.$1HP.$HQ.$Pp);this.set_$6Qt(t.$1HP.$HQ.$Ps);this.set_$Rt(t.$CB);t.$1TW&&this.set_$1k4(t.$1TW.get_$1s().$3RZ())}};_d.$8l.prototype={get_$28A:function(){return this.$U(_d.$8l.$4T6)},set_$28A:function(n){this.$K(_d.$8l.$4T6,n);return n},get_$6Qs:function(){return this.$U(_d.$8l.$4Sz)},set_$6Qs:function(n){this.$K(_d.$8l.$4Sz,n);return n},get_$6Qt:function(){return this.$U(_d.$8l.$4T0)},set_$6Qt:function(n){this.$K(_d.$8l.$4T0,n);return n},get_$Rt:function(){return this.$U(_d.$8l.$4TU)},set_$Rt:function(n){this.$K(_d.$8l.$4TU,n);return n},get_$1k4:function(){return this.$U(_d.$8l.$4TR)},set_$1k4:function(n){this.$K(_d.$8l.$4TR,n);return n},$5Dp:function(n){n.set_$28A(this.get_$28A());var t=_a.$A8.$7qD(this.get_$6Qs(),this.get_$6Qt());n.$1HP=t;n.set_$Rt(this.get_$Rt());this.get_$1k4()&&n.set_$1k4(n.$5FR(_pc.$i.$2LD(this.get_$1k4())))}};_d.$YC=function(n,t){this.$$d_$9LZ=Function.createDelegate(this,this.$9LZ);this.$$d_$9LY=Function.createDelegate(this,this.$9LY);this.$$d_$9gx=Function.createDelegate(this,this.$9gx);this.$$d_$9h2=Function.createDelegate(this,this.$9h2);this.$3Tn=_y.$w.$KH;_d.$YC.initializeBase(this);this.$11p=n;this.$C=t||_y.$v.$v;this.$W4=this.$C.get_$L()!=="Mouse";this.$6S5=new _C(this.$$d_$9h2,_a.$0.$4j);this.$6Rz=new _C(this.$$d_$9gx,_a.$0.$4j);this.set_$120("");this.set_$2RM("");this.set_$cH(_nbs.NonBootStrings.l_ErrorRetrievingData_Text)};function $4nS(n,t){if(t&&n.$4NA){var i=t.$PL.get_$D3();i.$2ZV=n.get_$8Gr();if(!i.$7R){var r=null;var u=this;r=function(){if(i.$7R){i.$7R.$6v.set_$Bq(0);i.remove_$1Gp(r)}};i.add_$1Gp(r);i.$1Hu(t.get_$1s())}}}_d.$YC.prototype={$W4:!1,$11p:null,$C:null,$1rA:!1,$4NA:!1,$6S5:null,$6Rz:null,get_$7of:function(){var n=this.get_$3T().get_$B()>0?this.get_$3T().get_$3q(0):null;$4nS(this,n);return n},get_$8Gr:function(){switch(this.$C.get_$L()){case"Mouse":case"TouchWide":return 0;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value for OwaShell.CurrentLayout: "+this.$C.get_$L());}},$A0D:function(){var n=this.get_$A6N();if(n&&!_js.$9.$18(n.$2s)){var t=_nbs.NonBootStrings.l_NoSearchResultsString_Text;switch(n.$1Gi){case 1:t=_nbs.NonBootStrings.l_NoSearchResultsFromBingString_Text;break;case 2:t=_nbs.NonBootStrings.l_NoSearchResultsFromPeopleString_Text;break;case 3:t=_nbs.NonBootStrings.l_NoSearchResultsFromHistoryString_Text;break}this.set_$24b(String.format(t,n.$2s))}},$5Fe:function(n){var t=new _d.$8a(n,this.$3Tn,!1,null,this.$W4?2:1,this.$11p,this.$C);t.$dk(1,_d.$ED.$352,"");t.set_$9Up((this.get_$A6M().$71(n)+1).toString());t.set_$1BT(!1);t.set_$3x1(!1);t.set_$er(this.$1rA);t.set_$3Mf(this.$1rA);if(!this.$W4){t.set_$3x1(!0);t.$Y("IsHovered",this.$$d_$9LY)}t.$Y("IsSelected",this.$$d_$9LZ);t.get_$5CS().set_$Ye(_d.$Ha.get_$9Ux());return t},$9h2:function(){var n=this.$A6P();n<=0||n>=this.get_$3T().get_$B()||this.set_$22(this.get_$3T().get_$3q(n-1))},$9gx:function(){var n=this.$A6P();!this.get_$3T().get_$B()||n>=this.get_$3T().get_$B()-1||(n===-1?this.set_$22(this.get_$3T().get_$3q(0)):this.set_$22(this.get_$3T().get_$3q(n+1)))},$9LY:function(n,t){var i=n;i.$2PB?this.set_$2yT(this.get_$A6M().$71(i.get_$1s())):this.set_$2yT(-1)},$9LZ:function(n,t){var i=n;i.$3G&&$4nS(this,i)}};_d.$kt=function(n,t,i,r,u){this.$$d_$9Lu=Function.createDelegate(this,this.$9Lu);this.$$d_$9JI=Function.createDelegate(this,this.$9JI);this.$$d_$9JL=Function.createDelegate(this,this.$9JL);this.$$d_$9Lv=Function.createDelegate(this,this.$9Lv);this.$$d_$9JK=Function.createDelegate(this,this.$9JK);this.$$d_$9JG=Function.createDelegate(this,this.$9JG);this.$4G=new Sys.EventHandlerList;_d.$kt.initializeBase(this,[n,i,r]);this.$Br.$3Tn=24;this.$Br.$4NA=!1;this.$RE=new _d.$z1(this.$Br.get_$3T(),!1,t,u);this.$RE.add_$5j7(this.$$d_$9JG);this.$RE.add_$4TP(this.$$d_$9JK);this.$Br.add_$6RY(this.$$d_$9Lv);if(_y.$v.$v.get_$L()!=="Mouse")this.$6CK=new _C(this.$$d_$9JL,_a.$0.$4j);else{this.$RE.add_$3wz(this.$$d_$9JI);this.$Br.add_$A6K(this.$$d_$9Lu)}};_d.$kt.prototype={$6CK:null,$RE:null,add_$5j7:function(n){this.$4G.addHandler("MapCenterChanged",n)},remove_$5j7:function(n){this.$4G.removeHandler("MapCenterChanged",n)},get_$4i:function(){return _d.$1Ak.prototype.get_$4i.call(this)},set_$4i:function(n){_d.$1Ak.prototype.set_$4i.call(this,n);$6(this.$RE)||this.$RE.set_$4i(n);return n},$9d1:function(){this.$RE.set_$35c(!1)},$6OM:function(){_d.$1Ak.prototype.$6OM.call(this);this.$RE.$6OP()},$9JL:function(){this.get_$4i().$Bt(this.$RE)},$9JK:function(n,t){this.$Br.remove_$6RY(this.$$d_$9Lv);this.$RE.$9x>-1&&this.$RE.$9x<this.$Br.get_$3T().get_$B()&&this.$Br.set_$22(this.$Br.get_$3T().get_$3q(this.$RE.$9x));this.$Br.add_$6RY(this.$$d_$9Lv)},$9Lv:function(n,t){this.$RE.remove_$4TP(this.$$d_$9JK);this.$RE.set_$QP(this.$Br.$A6P());this.$RE.add_$4TP(this.$$d_$9JK)},$9JI:function(n,t){this.$Br.remove_$A6K(this.$$d_$9Lu);this.$Br.get_$2yT()>-1&&this.$Br.get_$2yT()<this.$Br.get_$3T().get_$B()&&this.$Br.get_$3T().get_$3q(this.$Br.get_$2yT()).set_$Fk(!1);this.$Br.set_$2yT(this.$RE.$1bJ);this.$Br.get_$2yT()>-1&&this.$Br.get_$2yT()<this.$Br.get_$3T().get_$B()&&this.$Br.get_$3T().get_$3q(this.$Br.get_$2yT()).set_$Fk(!0);this.$Br.add_$A6K(this.$$d_$9Lu)},$9Lu:function(n,t){this.$RE.remove_$3wz(this.$$d_$9JI);this.$RE.set_$3wy(this.$Br.get_$2yT());this.$RE.add_$3wz(this.$$d_$9JI)},$9JG:function(n,t){if(!this.$41S){var i=n;var r=this.$4G.getHandler("MapCenterChanged");$6(r)||r(i.$1PQ);this.$2fS(this.$bF,i.$1PQ)}}};_d.$z1=function(n,t,i,r){_d.$z1.initializeBase(this,[n,t,i,r])};_d.$z1.prototype={get_$Ld:function(){return 1}};_d.$YD=function(n,t,i){_d.$YD.initializeBase(this,[n,t,i]);_y.$v.$v.get_$L()==="TouchNarrow"?this.$Br.$1rA=!0:this.$Br.$4NA=!0};_d.$1Ak=function(n,t,i){this.$$d_$9Lw=Function.createDelegate(this,this.$9Lw);this.$$d_$6Dz=Function.createDelegate(this,this.$6Dz);this.$4G_4=new Sys.EventHandlerList;_d.$1Ak.initializeBase(this);if(!n)throw Error.argumentNull("provider");this.$4Vm=!i||i.get_$L()!=="Mouse";this.$Br=new _d.$YC(t,i);this.$Br.$3Tn=_y.$w.$1dY;this.$Br.add_$6RY(this.$$d_$6Dz);this.$Br.add_$A6I(this.$$d_$9Lw);this.$1oR=n;this.$Br.$A6O(n)};_d.$1Ak.prototype={$3m:null,$bF:null,$Br:null,$1oR:null,$41S:!1,$1xr:!0,$4Vm:!1,add_$4TW:function(n){this.$4G_4.addHandler("SelectedPlaceChanged",n)},remove_$4TW:function(n){this.$4G_4.removeHandler("SelectedPlaceChanged",n)},add_$4OA:function(n){this.$4G_4.addHandler("PopulatedItemCountChanged",n)},remove_$4OA:function(n){this.$4G_4.removeHandler("PopulatedItemCountChanged",n)},get_$8CY:function(){return!!this.$Br.get_$3T().get_$B()},get_$8BC:function(){return this.$1xr},set_$8BC:function(n){if(this.$1xr!==n){this.$1xr=n;$3(this,"IsLoadingFirstTime")}return n},get_$4i:function(){return this.$3m},set_$4i:function(n){this.$3m=n;return n},get_$28A:function(){return this.$bF},set_$28A:function(n){this.$bF=n;$3(this,"SearchTerm");return n},get_$5c5:function(){return this.$41S},set_$5c5:function(n){this.$41S=n;$3(this,"IsLoadingSuggestionsFromWS");return n},$9d1:function(){},$6OM:function(){this.$1xr=!0},$2fS:function(n,t){this.set_$28A(n);this.$1oR.set_$Ac(n);$6(t)||this.$1oR.set_$9YQ(t);this.$Br.$A0D();if(!_js.$9.$18(n)||_js.$9.$18(n)&&this.$1oR.$2ZQ===1){this.set_$5c5(!0);this.$Br.get_$4S()?this.$Br.$gm():this.$Br.$5j()}else this.$Br.$Au();$3(this,"IsPopulated")},$6Dz:function(n,t){if(this.$Br.get_$22()){var i=this.$4G_4.getHandler("SelectedPlaceChanged");$6(i)||i(this.$Br.get_$22())}},$9Lw:function(){this.set_$5c5(!1);this.set_$8BC(!1);$3(this,"IsPopulated");var n=this.$4G_4.getHandler("PopulatedItemCountChanged");$6(n)||n(this.$Br.get_$3T().get_$B())}};_d.$6I=function(n,t,i,r,u,f,e){this.$$d_$9Au=Function.createDelegate(this,this.$9Au);this.$$d_$9At=Function.createDelegate(this,this.$9At);this.$$d_$9Mt=Function.createDelegate(this,this.$9Mt);this.$$d_$9LG=Function.createDelegate(this,this.$9LG);this.$$d_$6Dz=Function.createDelegate(this,this.$6Dz);this.$$d_$81l=Function.createDelegate(this,this.$81l);this.$$d_$80o=Function.createDelegate(this,this.$80o);this.$$d_$4RH=Function.createDelegate(this,this.$4RH);this.$$d_$iF=Function.createDelegate(this,this.$iF);this.$$d_$52v=Function.createDelegate(this,this.$52v);this.$$d_$A0p=Function.createDelegate(this,this.$A0p);this.$$d_$45e=Function.createDelegate(this,this.$45e);this.$2YJ=-1;this.$2Zc=-1;this.$2Fj=-1;this.$bF="";this.$1TJ="";this.$1HP=new _a.$A8;this.$4G=new Sys.EventHandlerList;_d.$6I.initializeBase(this);this.$6IS=n;this.$n0=i;this.$11p=r;this.$5C=u;this.$C=f;this.$6f=e;this.$2cV=this.$C.get_$L()!=="TouchNarrow";this.$1kg=this.$C.get_$L()==="Mouse";var s=this;this.$1tq=new _C(this.$$d_$45e,_a.$0.$4j,this,"SearchDisplayText",function(){return!_js.$9.$18(s.$1TJ)});this.$6eS=new _C(this.$$d_$A0p,_a.$0.$4j);var h=this;this.$2jt=new _C(this.$$d_$52v,_a.$0.$4j,this,"SelectedLocation",function(){return!$6(h.$1TW)});this.$2s6=new _C(this.$$d_$iF,_a.$0.$4j);this.$4Qb=new _C(this.$$d_$4RH,_a.$0.$4j);this.$3U5=[new _0365m.$m(_nbs.NonBootStrings.l_RemoveLocation_LowerCase_Text,null,this.$4Qb)];var o=[];$198(this,1)&&Array.add(o,new _a.$5M(_nbs.NonBootStrings.l_BingPivotLabel_Text,$6w2(this)));$198(this,4)&&Array.add(o,new _a.$5M(_nbs.NonBootStrings.l_PeoplePivotLabel_Text,$6w3(this)));$198(this,8)&&Array.add(o,new _a.$5M(_nbs.NonBootStrings.l_RecentPivotLabel_Text,$6w4(this)));this.set_$NP(o);this.set_$8DT(this.$Hg.length<=1);this.$Hg.length||this.set_$Rt(-1);var c=!!t&&f.get_$L()==="Mouse"&&f.get_$9A();var y=this;this.$b4=new _d.$Pk(t||function(){},c);if(!this.$1kg){var l=new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItemMobile_Text,this.$2jt);var a=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItemMobile_Text,this.$2s6);var v=[l,a];this.set_$7D(_y.$26.$Bg(this,v,null))}};function $3X9(n){n.set_$6V(!0);$6w6(n);_js.$9.$18(n.$bF)&&$198(n,8)&&n.set_$Rt(n.$Hg.length-1);var t=this;$1nh(n,function(t){t.$2fS(n.$bF,n.$1HP)})}function $6w6(n){n.$2Fj=_js.$9.$18(n.$bF)||!($198(n,1)||$198(n,2))?0:-1;n.$2YJ=_js.$9.$18(n.$bF)||!$198(n,4)?0:-1;n.$2Zc=$198(n,8)?-1:0;$3(n,"TotalResults");n.$4RH(n.get_$3TU())}function $6w5(n){var t=this;$1nh(n,function(t){t.$Br.get_$22()&&t.$Br.get_$22()!==n.$1k8&&t.$Br.set_$22(null)})}function $4nT(n){n.$CB=0;n.set_$4TV(null);n.set_$1k4(null);var t=this;$1nh(n,function(n){n.$6OM()});$6(n.get_$89())?n.get_$4i().$1GV(_d.$6I.isInstanceOfType(n.get_$4i().get_$7u())?1:2):n.get_$89()()}function $1nh(n,t){for(var r=n.$Hg,u=r.length,i=0;i<u;++i){var f=r[i];var e=f.$10;t(e)}}function $198(n,t){return(n.$6IS&t)===t}function $6w3(n){var t=new _d.$TL;t.$Rh=_pc.$14.$vp(0,12);t.$19Y=_pc.$14.$1v2();t.$3I6=new _g.$Rf("Default");t.$3I6.AdditionalProperties=[new _g.$1X("PersonaOfficeLocations"),new _g.$1X("PersonaBusinessAddresses"),new _g.$1X("PersonaHomeAddresses"),new _g.$1X("PersonaOtherAddresses")];var i=new _d.$YD(t,n.$11p,n.$C);i.add_$4TW(n.$$d_$6Dz);i.add_$4OA(n.$$d_$9LG);return i}function $6w4(n){var t=new _d.$YD(new _d.$vg(1),n.$11p,n.$C);t.add_$4TW(n.$$d_$6Dz);t.add_$4OA(n.$$d_$9Mt);return t}function $6w2(n){var i;i=$198(n,2)?2:6;var t=new _d.$kt(new _d.$vg(i),n.$n0,n.$11p,n.$C,n.$6f);t.add_$4TW(n.$$d_$6Dz);t.add_$4OA(n.$$d_$9At);t.add_$5j7(n.$$d_$9Au);n.get_$3TU()||t.$RE.add_$8IC(n.$$d_$52v);return t}_d.$6I.prototype={$2jt:null,$2s6:null,$4Qb:null,$1tq:null,$6eS:null,$3U5:null,$b4:null,$6IS:0,$Hg:null,$CB:0,$2Q4:!1,$1k8:null,$1TW:null,$8J:!1,$n0:null,$11p:null,$5C:null,$C:null,$KA:null,$6f:null,$2cV:!1,$1kg:!1,add_$4TQ:function(n){this.$4G.addHandler("SelectedLocationChanged",n)},remove_$4TQ:function(n){this.$4G.removeHandler("SelectedLocationChanged",n)},add_$2k6:function(n){this.$4G.addHandler("Activated",n)},remove_$2k6:function(n){this.$4G.removeHandler("Activated",n)},add_$3iF:function(n){this.$4G.addHandler("Closed",n)},remove_$3iF:function(n){this.$4G.removeHandler("Closed",n)},get_$4TV:function(){return this.$1k8},set_$4TV:function(n){this.$1k8&&this.$1k8.set_$2O(!1);this.$1k8=n;$6w5(this);this.$1k8&&this.$1k8.set_$2O(!0);$3(this,"SelectedPlace");return n},get_$1k4:function(){return this.$1TW},set_$1k4:function(n){this.$1TW=n;$3(this,"SelectedLocation");return n},get_$NP:function(){return this.$Hg},set_$NP:function(n){this.$Hg=n;$3(this,"Options");return n},get_$Rt:function(){return this.$CB},set_$Rt:function(n){this.$CB=n;this.get_$3TU()||this.$4RH();this.set_$2b8(this.$bF);$3(this,"SelectedOptionIndex");return n},get_$8DT:function(){return this.$2Q4},set_$8DT:function(n){if(this.$2Q4!==n){this.$2Q4=n;$3(this,"IsSingleOption")}return n},get_$4i:function(){return _y.$1KT.prototype.get_$4i.call(this)},set_$4i:function(n){_y.$1KT.prototype.set_$4i.call(this,n);var t=this;$1nh(this,function(t){t.set_$4i(n)});return n},get_$1iT:function(){return 1},get_$2MT:function(){return null},get_$89:function(){return this.$KA},set_$89:function(n){this.$KA=n;return n},get_$7iz:function(){return!1},get_$Ld:function(){return this.$1kg?0:1},get_$9pa:function(){return this.$1kg},set_$9pa:function(n){if(this.$1kg===n)return n;this.$1kg=n;$3(this,"ShowToolbar");return n},get_$9p7:function(){return this.$2cV},set_$9p7:function(n){if(this.$2cV===n)return n;this.$2cV=n;$3(this,"ShowPreviewPanel");return n},get_$3TU:function(){return!this.$2Q4&&this.$C.get_$L()!=="TouchNarrow"},get_$do:function(){return this.$b4.get_$do()},get_$1GW:function(){return this.$b4.get_$1GW()},get_$2b8:function(){return this.$1TJ},set_$2b8:function(n){if(this.$1TJ!==n){this.$1TJ=n;$3(this,"SearchDisplayText")}return n},get_$28A:function(){return this.$bF},set_$28A:function(n){if(this.$bF!==n){var t=this;$1nh(this,function(n){n.$9d1()})}this.$bF=n;this.set_$2b8(this.$bF);return n},get_$9wA:function(){if(this.$2Fj>=0&&this.$2YJ>=0&&this.$2Zc>=0){this.set_$6V(!1);var n=this.$2Fj+this.$2YJ+this.$2Zc;var t=n===1?_nbs.NonBootStrings.l_TotalResults_OnlyOne_Uppercase_Text:_nbs.NonBootStrings.l_TotalResults_ZeroOrMoreThanOne_Uppercase_Text;return String.format(t,n)}return _nbs.NonBootStrings.l_Searching_Text},get_$6V:function(){return this.$8J},set_$6V:function(n){if(this.$8J!==n){this.$8J=n;$3(this,"IsBusy")}return n},$9kj:function(n){var t=this;$1nh(this,function(t){t.$4Vm=n})},$GN:function(){_y.$1KT.prototype.$GN.call(this);var n=this.$4G.getHandler("Activated");$6(n)||n()},$52v:function(){if(this.$1TW){var n=this.$4G.getHandler("SelectedLocationChanged");$6(n)||n(this.$1TW.get_$1s());$4nT(this)}},$iF:function(){$4nT(this)},$5FR:function(n){return _d.$ED.$3kT(n,this.$5C,this.$C,0,this.$3U5,!1)},$3qB:function(n,t){this.set_$6V(!0);if(!_js.$9.$18(n)&&$6(t))if(_y.$v.$v.get_$L()==="Mouse")this.$45e(n);else{this.set_$28A(n);this.$n0.$5QC(this.$$d_$80o,this.$$d_$81l)}else this.$45e(n,t)},$45e:function(n,t){this.set_$28A(n||this.$1TJ);t&&(this.$1HP=t);$3X9(this)},$A0p:function(){_js.$9.$18(this.$1TJ)&&this.set_$2b8(this.$bF)},$4RH:function(n){this.set_$4TV(null);n||this.set_$1k4(null)},$Uz:function(){var n=this.$4G.getHandler("Closed");$6(n)||n()},$6Dz:function(n){this.set_$4TV(n);this.set_$1k4(this.$5FR(n.get_$1s()))},$9At:function(n){this.$2Fj=n;$3(this,"TotalResults")},$9LG:function(n){this.$2YJ=n;$3(this,"TotalResults")},$9Mt:function(n){this.$2Zc=n;$3(this,"TotalResults")},$80o:function(n){this.$1HP=n;$3X9(this)},$81l:function(n){$3X9(this)},$9Au:function(n){this.$1HP=n;this.set_$2b8(this.$bF);this.set_$6V(!0)}};_d.$eh=function(n,t,i){this.$n0=n;this.$C=t;this.$6f=i};_d.$eh.prototype={$n0:null,$11p:null,$5C:null,$C:null,$6f:null,$E:function(n,t){return new _d.$6I(n,t,this.$n0,this.$11p,this.$5C,this.$C,this.$6f)}};_d.$1Ja=function(){this.$2s="";this.$26n=new _a.$A8;this.$2ZQ=0;this.$1Gi=0};_d.$1Ja.prototype={get_$Ac:function(){return this.$2s},set_$Ac:function(n){this.$2s=n||"";return n},get_$9YQ:function(){return this.$26n},set_$9YQ:function(n){this.$26n=n||new _a.$A8;return n}};_d.$9c=function(){_d.$9c.initializeBase(this)};_d.$9c.prototype={get_$y:function(){return this.$U(_d.$9c.$3Pv)},set_$y:function(n){this.$K(_d.$9c.$3Pv,n);return n},get_$1u:function(){return this.$U(_d.$9c.$2tG)},set_$1u:function(n){this.$K(_d.$9c.$2tG,n);return n},get_$LT:function(){return this.$U(_d.$9c.$3Ju)},set_$LT:function(n){this.$K(_d.$9c.$3Ju,n);return n},get_$Pk:function(){return this.$U(_d.$9c.$42b)},set_$Pk:function(n){this.$K(_d.$9c.$42b,n);return n}};_d.$qI=function(n,t){this.$5Jt=n;this.$5iZ=t};_d.$qI.prototype={$5Jt:null,$5iZ:null};_d.$x7=function(n){this.$571=n};_d.$x7.prototype={$571:null};_d.$pn=function(n,t){this.$10=n;this.$6Na=t};_d.$pn.prototype={$10:null,$6Na:!1};_d.$re=function(n){this.$10=n};_d.$re.prototype={$10:null};_d.$Al=function(n,t,i,r,u){this.$$d_$5YE=Function.createDelegate(this,this.$5YE);this.$$d_$4SZ=Function.createDelegate(this,this.$4SZ);this.$$d_$9fI=Function.createDelegate(this,this.$9fI);this.$$d_$9EV=Function.createDelegate(this,this.$9EV);this.$$d_$sx=Function.createDelegate(this,this.$sx);this.$$d_$16G=Function.createDelegate(this,this.$16G);this.$$d_$1pL=Function.createDelegate(this,this.$1pL);_d.$Al.initializeBase(this,[5,n]);this.$5B=i;this.$1Bl=u;this.$D8=t;this.$lQ=new _C(this.$$d_$1pL,this.get_$1b());this.$1J=r};function $6tP(n){if(!n.get_$LF()){var t=[];var i=new _0365m.$m(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,null,n.$lQ,!1,null,_nbs.NonBootStrings.l_InsertAttachment_AT_MenuItem_Text);Array.add(t,i);if(n.$1J.get_$BQ()){n.$1Ni=new _C(n.$$d_$5YE,n.get_$1b());n.$3IG=new _0365m.$m(_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text,null,n.$1Ni,!1,null,_nbs.NonBootStrings.l_InsertPicture_AT_MenuItem_Text);Array.add(t,n.$3IG);n.$4Wg(n.$17.$f.$d.get_$3n()==="HTML")}n.set_$LF(new _0365m.$2b(t))}}function $4lt(n,t){t.get_$92()||t.set_$92(new _js.$Z)}function $4lv(n){var i=n.$17.$f;var t=i.$d;if($6(t)||!t.get_$EH()){_js.Trace.logInfo(_a.$0.$j,"Show not allowed to add attachment due to context="+(t?"non-null":"null")+"; Upgraded="+t.get_$EH());i.$1z.$32(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0}function $6tQ(n,t){if(n.$1Bl){var i=this;n.$1Bl.$E(function(i){n.$3qs=i;n.$3qs&&n.$3qs.$bL(n.get_$5o(),t)})}}function $4lu(n){return n.$5B.$3u("AttachmentsFilePicker")}_d.$Al.prototype={$5B:null,$1J:null,$1Bl:null,$D8:null,$lQ:null,$1Ni:null,$3IG:null,$1rH:null,$1d9:!1,$3qs:null,get_$LF:function(){return this.$U(_d.$Al.$1E4)},set_$LF:function(n){this.$K(_d.$Al.$1E4,n);return n},add_$4Il:function(n){this.$2N("AttachmentWellInitialized",n)},remove_$4Il:function(n){this.$2P("AttachmentWellInitialized",n)},get_$5o:function(){return this.$U(_d.$Al.$3eg)},set_$5o:function(n){this.$K(_d.$Al.$3eg,n);return n},get_$CM:function(){return this.get_$5o()?this.get_$5o().get_$CM():!1},get_$G9:function(){return this.get_$5o()&&this.get_$5o().get_$1N()?this.get_$5o().get_$1N().get_$B()>0:!1},get_$5Dn:function(){return this.$1rH},set_$5Dn:function(n){this.$1rH=n;$N(this,"CopyPasteViewModel");return n},$49:function(){var n=this.$17.$f.$d;$6tP(this);var i=!n.get_$EH()||n.get_$2Mz();var r=n.get_$92();var u=!((n.get_$40()===4||n.get_$40()===13)&&!this.$1J.get_$BQ());if(this.get_$5o()){this.get_$5o().$2Zx(n.get_$A3(),r,i,n.get_$7g(),n.get_$1Wp());this.$5Bu(n,i)}else{var t=this;this.$D8.$E(function(f){_y.$v.$v.get_$L()==="TouchNarrow"?t.set_$5o(f.$1LU(n.get_$A3(),r,i,u,n.get_$1Wp(),!0,t.$17.$f.$w,n.get_$7g())):t.set_$5o(f.$1LT(n.get_$A3(),r,i,_y.$v.$v.get_$L()==="Mouse"?3:0,u,n.get_$1Wp(),!0,t.$17.$f.$w,n.get_$7g()));t.get_$5o().add_$16G(t.$$d_$16G);t.get_$5o().add_$sx(t.$$d_$sx);t.get_$5o().apcl("EditorCallContext",t.$$d_$9EV);var e=t.$17.$3c(14);e&&t.get_$5o().add_$4db(e.$$d_$bB);$JB(t,"AttachmentWellInitialized",t);t.$5Bu(n,i)})}},$9EV:function(n,t){if(t==="EditorCallContext"){var i=this.$17.$3c(27);i.set_$JO(this.get_$5o().get_$JO())}},$4Wg:function(n){this.$3IG&&this.$3IG.set_$q(!n)},$sx:function(n){if(_a.$5t.$2t){var t=this;_js.$J.get_$I().$3r(_a.$0.$IL,"TriggerPolicyTipsIfNeeded",function(){var n=t.$17.$3c(25);n.$1IX(8)})}},$16G:function(){var t=this.$17.$f;var n=t.$d;if(n.get_$A3()){$4lt(this,n);this.get_$5o()&&this.get_$5o().$1Gz(n.get_$A3(),n.get_$92(),n.get_$1Wp())}else{var i=this.$17.$3c(8);i.$1wg("Attach",this.$$d_$9fI,this.$$d_$4SZ,!1)}},$6eh:function(){if(!this.$1d9&&this.get_$5o()){var n=this.$17.$f.$d;this.get_$5o().$1Gz(n.get_$A3(),n.get_$92(),n.get_$1Wp());if(n.$Vv)if(n.get_$92()){var t=new _js.$Z;t.$69(n.get_$92().$6Z());n.$Vv.set_$92(t);n.get_$Ia()&&n.get_$Ia().set_$92(t)}else{n.$Vv.set_$92(null);n.get_$Ia()&&n.get_$Ia().set_$92(null)}this.get_$5o().set_$Pl(n.get_$Pl());if(this.get_$G9()&&this.get_$5o().get_$Pl()){var u=this;var r=function(){_js.Trace.logInfo(_a.$0.$4A,"MoveAttachmentsFromServerToClient will be started when MailComposeAttachmentComponent is upgraded.");var n=u.get_$5o();_js.$J.get_$I().$1w(_a.$0.$aP,"MailComposeAttachmentComponent.Upgrade",n.$$d_$3DP||(n.$$d_$3DP=Function.createDelegate(n,n.$3DP)),800)};if(n.$cc&&n.$2Ot)r();else{var i=null;var f=this;i=function(t,u){if(n.$cc&&n.$2Ot){n.remove_$7q(i);r()}};n.add_$7q(i)}}this.$1d9=!0}},$Au:function(){var n=this.get_$5o();if(n){n.remove_$16G(this.$$d_$16G);n.remove_$sx(this.$$d_$sx);n.rpcl("EditorCallContext",this.$$d_$9EV);_d.$4p.$Ek(this.$17)}this.$1d9=!1;_d.$Bp.prototype.$Au.call(this)},$7rN:function(){var n=null;if(_a.UserAgent.getInstance().get_$2FH()&&!_a.UserAgent.getInstance().get_$67()){n=[];Array.add(n,new _y.$2v(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,this.$lQ));this.$1J.get_$BQ()&&this.$17.$f.$d.get_$3n()==="HTML"&&Array.add(n,new _y.$2v(_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text,this.$1Ni))}return n},$86o:function(){if(this.get_$G9()&&$4lu(this)&&this.$1J.get_$BQ()&&this.$17.$f.$d.get_$3n()==="HTML"){for(var n=new(_a.$3X.$$(_y.$jM)),t=0;t<this.get_$5o().get_$1N().get_$B();t++){var i=this.get_$5o().get_$1N().get_$3q(t);_g.$BA.isInstanceOfType(i.get_$9L())&&n.$D(i)}if(n.get_$B()>0){var r=new _d.$x7(n);var u=this.$17.$3c(27);u.set_$JO(r)}}},$1pL:function(){var n=this.$17.$f;var t=n.$d;_js.Trace.logInfo(_a.$0.$j,"Insert attachment start");if($4lv(this)&&this.get_$5o())if(t.get_$Pl()){_js.Trace.logInfo(_a.$0.$4A,"Opening S/MIME's file picker to attach file.");this.get_$5o().$6FN(!1)}else if(this.$5B&&$4lu(this)&&_y.$v.$v.get_$L()!=="TouchNarrow"){var i=_a.$6.$1c(_a.$0.$1N,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$j,"Opening OWA's file picker");$6tQ(this,i)}else{_js.Trace.logInfo(_a.$0.$j,"Opening OS's file picker");this.get_$5o().$z3(!1,null,null)}_js.Trace.logInfo(_a.$0.$j,"Insert attachment end")},$5YE:function(){var n=this.$17.$f;var t=n.$d;_js.Trace.logInfo(_a.$0.$j,"Insert picture start");if($4lv(this)&&this.get_$5o())if(t.get_$Pl()){_js.Trace.logInfo(_a.$0.$4A,"Opening S/MIME's file picker to insert picture.");this.get_$5o().$6FN(!0)}else this.get_$5o().$z3(!0,null,null);_js.Trace.logInfo(_a.$0.$j,"Insert picture end")},$5Bu:function(n,t){this.get_$5o().set_$3zq(!n.get_$EH());_js.Trace.logInfo(_a.$0.$j,"Attachment component initialized, ReadOnly={0}",t);this.set_$5Dn(_d.$aD.$5Ep(_y.$v.$v,this.$D8,this.get_$5o(),this.get_$1b()));n.get_$EH()&&this.$6eh();_d.$Bp.prototype.$49.call(this)},$9fI:function(n){var i=this.$17.$f;var t=i.$d;if(n.$59===t.get_$7g()){$4lt(this,t);this.get_$5o()&&this.get_$5o().$1Gz(t.get_$A3(),t.get_$92(),t.get_$1Wp())}},$4SZ:function(n){var t=this.$17.$f;var i=t.$d;if(this.get_$5o()&&n.$59===i.get_$7g()){this.get_$5o().$6Mv();t.$1z.$32(0,_nbs.NonBootStrings.l_WarningFileCanNotBeAttachedDisconnected_Text,null)}}};_d.$191=function(n,t,i){this.$$d_$7Rp=Function.createDelegate(this,this.$7Rp);this.$$d_$7Rq=Function.createDelegate(this,this.$7Rq);this.$$d_$9A1=Function.createDelegate(this,this.$9A1);this.$$d_$7Ro=Function.createDelegate(this,this.$7Ro);_d.$191.initializeBase(this,[n,t,i]);this.$1lu=new _d.$199(this.$$d_$7Ro,6e4)};_d.$191.prototype={$1lu:null,$49:function(){var n=this.$17.$f;var t=n.$d;if(!t.$2cY){this.$y();_js.Trace.logInfo(_a.$0.$j,"Auto save timer started")}_d.$Bp.prototype.$49.call(this);n.$M.$IU(_a.$ZO,this.$$d_$9A1)},$7Ro:function(){var t=this.$17;var i=t.$f;var n=i.$d;if(!n.$2cY){if(!n.get_$42v()){_js.Trace.logInfo(_a.$0.$j,"Auto Save not supported for the current operation {0}",n.get_$40());return}var f=t.$3c(5);_js.Trace.logInfo(_a.$0.$j,"Checking dirty before auto save");var r=i.$F4();var u=f.get_$CM();if(r&&!u){_js.Trace.logInfo(_a.$0.$j,"AutoSave:Context:"+n.toString());this.$1lu.$1r();this.$1wg("AutoSave",this.$$d_$7Rq,this.$$d_$7Rp,!1)}else{this.$1lu.$y();_js.Trace.logInfo(_a.$0.$j,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",r,u)}}},$y:function(){var n=this.$17.$f.$d;!n.$2cY&&n.get_$42v()&&this.$1lu.$y()},$Au:function(){this.$1lu.$1r();var n=this.$17.$f;n.$M.$18g(_a.$ZO,this.$$d_$9A1);_d.$7m.prototype.$Au.call(this)},$4c:function(){var n=this.$17.$f;n.$M.$18g(_a.$ZO,this.$$d_$9A1)},$9A1:function(n){_js.$J.get_$I().$3r(_a.$0.$j,"Autosave triggered for PAL OnPause event",this.$$d_$7Ro)},$7Rq:function(n){var t=this.$17;var i=t.$f;var r=i.$d;r.$2cY||this.$1lu.$y()},$7Rp:function(n){_js.Trace.logInfo(_a.$0.$j,"AutoSaveActionFailed: Error: {0}",n.$1f.message);this.$17.$f.$d.$2cY||this.$1lu.$y()}};_d.$DQ=function(n){this.$$d_$9jy=Function.createDelegate(this,this.$9jy);this.$$d_$9ob=Function.createDelegate(this,this.$9ob);this.$$d_$9Fp=Function.createDelegate(this,this.$9Fp);this.$$d_$4ch=Function.createDelegate(this,this.$4ch);_d.$DQ.initializeBase(this,[3,n])};_d.$DQ.$5E2=function(n,t){return new _y.$2v(n,t)};_d.$DQ.$2pt=function(n,t){return new _0365m.$m(n,null,t,!0)};function $6ta(n){if("Mouse"===_y.$v.$v.get_$L()){var r=n.$A5w(_0365m.$m,_d.$DQ.$2pt);r&&(n.$DA=new _0365m.$2b(r))}else if(!n.$1cI){if(!n.$bl){var u=n.$A5w(_y.$2v,_d.$DQ.$5E2);u&&(n.$bl=new _y.$2v(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,u))}if(n.$bl){var f=n.$17.$f.$3w;var i=f.$1C;if(i)for(var t=0;t<i.length;t++)if(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text===i[t].$2E){f.$2kT(n.$bl,t+1);n.$1cI=!0}}}}function $4lx(n,t){var i=this;return function(){_a.$6.stPT(_a.$0.$j,"MailComposeSetIRM",3);var h=_a.$6.$1c(_a.$0.$j,"MailComposeSetIRM",!0);var e=n.$17.$f;var i=e.$d;i.set_$PK(t);if(i.get_$L3()){e.$w.$5S(3800);_d.$4p.$Ek(n.$17);i.set_$L3(!1);i.set_$Qi(null);i.set_$PI(null);i.set_$Tp(null)}for(var s=e.$Za.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(t.toLowerCase()===u.Id.toLowerCase()){$6(i.get_$5n())&&i.set_$5n(new _g.$fQ);var r=i.get_$5n();r.set_$4S4(t);r.set_$1L9(_g.$V.get_$I().get_$31().get_$Aj());r.set_$Ar(!0);r.set_$HC(0);r.set_$1ll(u.Name);r.set_$1lj(u.Description);r.set_$3n(i.get_$3n());if("Mouse"===_y.$v.$v.get_$L()){var f=e.$vq();f.$5S(4499);f.$5S(4500);f.$2a.apply(f,[4499].concat([u.Name,u.Description]));f.$2a.apply(f,[4500].concat([r.get_$1L9()]))}n.set_$2PJ(!0);_js.Trace.logInfo(_a.$0.$j,"Set IRM "+u.Name);break}}_a.$6.$1E(h);_a.$6.endPT("MailComposeSetIRM")}}function $4lw(n,t){var i=this;return function(){var u=n.$17.$f;var i=u.$d;i.set_$PK(t);if(!$6(i.get_$5n())&&"Mouse"===_y.$v.$v.get_$L()){var o=u.$vq();o.$5S(4499);o.$5S(4500);i.set_$5n(null);n.set_$2PJ(!1)}for(var s=u.$Za.MessageClassifications,f=0;f<s.length;f++){var r=s[f];if(t.toLowerCase()===r.Id.toLowerCase()){i.set_$L3(!0);i.set_$Qi(r.Name);i.set_$PI(r.Description);i.set_$Tp(r.Id);var e=u.$vq();e.$5S(3800);e.$2a.apply(e,[3800].concat([r.Name,r.Description]));_js.Trace.logInfo(_a.$0.$j,"Set class "+r.Name);break}}}}function $6tb(n,t,i,r){if($6(n.$9d)){n.set_$iE(new _y.$Lc);n.$9d.$7J.$D(new _a.$2G(n.$9d.$4d,_nbs.NonBootStrings.l_Close1_Text))}n.$9d.set_$4v(t);$6(n.$2OA)&&(n.$2OA=new _d.$xS);n.$2OA.set_$mB(i);n.$2OA.set_$7Zy(String.format(_nbs.NonBootStrings.l_IrmConversationOwner_Text,r));n.$9d.set_$DP(n.$2OA);n.$9d.set_$1O(!0)}_d.$DQ.prototype={$DA:null,$bl:null,$1O8:!1,$2cm:null,$9d:null,$2OA:null,$1cI:!1,get_$2PJ:function(){return this.$1O8},set_$2PJ:function(n){if(this.$1O8!==n){this.$1O8=n;$N(this,"IsIrmProtected")}return n},get_$9oc:function(){return this.$2cm},set_$9oc:function(n){if(this.$2cm!==n){this.$2cm=n;$N(this,"ShowIrmInformationCommand")}return n},get_$iE:function(){return this.$9d},set_$iE:function(n){if(this.$9d!==n){this.$9d=n;$N(this,"DialogViewModel")}return n},$49:function(){var n=this.$17.$f;var i=n.$d;var e=n.$3w;var r=n.$Za;if(this.$3hJ())if(_g.$1U.$MG){_js.Trace.logInfo(_a.$0.$j,"Checking main window for compliance configuration");this.$bl=_d.$DQ.$45j;_g.$1U.$MG.$7vC(this.$$d_$4ch)}else if(r.WasLoadedFromServer)this.$4ch(r);else{_js.Trace.logInfo(_a.$0.$j,"Adding the loading permissions menu item");this.$bl=_d.$DQ.$45j;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$j,"Submitting GetComplianceConfigurationAction");var o=n.$M;o.$IU(_a.$Wf,this.$$d_$9Fp);var s=new _h.$We(r,n.$M);s.$n()}}else if(this.$bl&&this.$1cI&&e.$1C){n.$3w.$3KO(this.$bl);this.$1cI=!1}var t=i.get_$5n();this.set_$2PJ(!!t&&!t.get_$HC());if(this.$1O8&&"Mouse"===_y.$v.$v.get_$L()){var u=n.$vq();u.$2a.apply(u,[4499].concat([t.get_$1ll(),t.get_$1lj()]));u.$2a.apply(u,[4500].concat([t.get_$1L9()]))}else if(i.get_$L3()){var f=n.$vq();f.$2a.apply(f,[3800].concat([i.get_$Qi(),i.get_$PI()]))}"Mouse"===_y.$v.$v.get_$L()||this.$2cm||this.set_$9oc(new _C(this.$$d_$9ob,this.get_$1b()));_d.$Bp.prototype.$49.call(this)},$Au:function(){this.set_$2PJ(!1);_d.$Bp.prototype.$Au.call(this)},$3hJ:function(){var t=_g.$V.get_$I();if(!$6(t.get_$6H())&&!t.get_$6H().get_$1wq()){_js.Trace.logInfo(_a.$0.$j,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$17.$f.$d.get_$5n();var i=!n||!!n.get_$HC()||n.get_$Ar()||n.get_$2tp();_js.Trace.logInfo(_a.$0.$j,"CanSetCompliance="+i);return i},$A5w:function(n,t){var i=this.$17.$f.$Za;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$j,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var u=0;r[u++]=t(_nbs.NonBootStrings.l_NoRestriction_Text,new _C(this.$$d_$9jy,this.get_$1b()));for(var f=0,e=0;f<o||e<s;)if(f===o){var l=i.MessageClassifications[e++];r[u++]=t(l.Name,new _C($4lw(this,l.Id),this.get_$1b()))}else if(e===s){var a=i.RmsTemplates[f++];r[u++]=t(a.Name,new _C($4lx(this,a.Id),this.get_$1b()))}else{var h=i.MessageClassifications[e];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[u++]=t(h.Name,new _C($4lw(this,h.Id),this.get_$1b()));e++}else{r[u++]=t(c.Name,new _C($4lx(this,c.Id),this.get_$1b()));f++}}return r},$9Fp:function(n){var t=this.$17.$f;this.$4ch(t.$Za);t.$M.$18g(_a.$Wf,this.$$d_$9Fp)},$4ch:function(n){var i=this.$17.$f;i.$Za=n;_js.Trace.logInfo(_a.$0.$j,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$v.$v.get_$L()){this.$bl&&i.$3w.$3KO(this.$bl);this.$bl=null;this.$1cI=!1}n.WasLoadedFromServer&&$6ta(this);if("Mouse"===_y.$v.$v.get_$L()){var t=this.$17.$3c(18);if(t.get_$LF()){var r=t.$1ut(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text);r>=0&&t.get_$LF().$1C.$68(r);n.WasLoadedFromServer&&t.$7OR()}}},$9jy:function(){var i=this.$17.$f;var n=i.$d;_js.Trace.logInfo(_a.$0.$j,"Set no restriction");n.set_$PK("0");var t=i.$vq();if($6(n.get_$5n())){if(n.get_$L3()){t.$5S(3800);n.set_$L3(!1);n.set_$Qi(null);n.set_$PI(null);n.set_$Tp(null)}}else{if("Mouse"===_y.$v.$v.get_$L()){t.$5S(4499);t.$5S(4500)}n.set_$5n(null);this.set_$2PJ(!1)}},$9ob:function(){var t=this.$17.$f.$d;if(t.get_$5n()){var n=t.get_$5n();$6tb(this,n.get_$1ll(),n.get_$1lj(),n.get_$1L9())}else _js.Trace.logError(_a.$0.$j,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")}};_d.$Bp=function(n,t){_d.$Bp.initializeBase(this);this.$7Xj=n;this.$17=t;if(t&&t.$f){this.$f=t.$f;this.$d_2=this.$f.$d;this.$cX=this.$f.$w}};function $1nd(n){n.$cX.$9bY();n.$cX.$DG(_d.$7m.$TE);n.$cX.$DG(_d.$8V.$TE);n.$cX.$DG(_d.$Bq.$TE);n.$f.$1RU.$9aj(n.$cX);_d.$4p.$Ek(n.$17)}function $3Wa(n){if(!n.$d_2.$Vv)return!0;_js.Trace.logInfo(_a.$0.$j,"Comparing initial baseline to baseline. Context:"+n.$d_2.toString());if(!n.$d_2.$Vv.$4e(n.$d_2.get_$Ia()))return!0;_js.Trace.logInfo(_a.$0.$j,"Checking dirty before showing discard confirmation.");return n.$f.$F4()?!0:n.$d_2.get_$qn()?!0:!1}function $6tc(n,t,i){try{var u=_a.$s.$16p(n.$f.$C.get_$L()==="Mouse",!0,!0,!1,!1,!1);if(u)if(_a.$2H.$14S(u))n.$1ot(u);else throw u;_js.Trace.logInfo(_a.$0.$4A,"S/MIME choosing a cert...");var s=_a.$s.$qh();var f;var e=_g.$V.get_$I();f=e.get_$TX().AllowUserChoiceOfSigningCertificate&&e.get_$1I().get_$35a()?e.get_$1I().get_$2dH():null;_js.Trace.logInfo(_a.$0.$4A,"Choosing a cert. KeyUsage={0}, KeyIdentifier={1}",t,f);var o=JsonParser.deserialize(s.GetSigningCertificate(f));if(o.ErrorCode)throw _a.$2H.$E(_u.Strings.l_Smime_CannotGetSubjectCertFromStore_Text,o.ErrorCode);else return o.Data}catch(r){_js.Trace.logWarning(_a.$0.$4A,r.message);if(_a.$2H.$xP(r)){_a.$2H.$Wk(r,i);n.$1ot(r);return null}else{_js.Trace.logException(_a.$0.$4A,r,"An error occurred when choosing cert.");throw r;}}}function $4ly(n){try{var l=_a.$s.$16p(n.$f.$C.get_$L()==="Mouse",!0,!0,!1,!1,!1);if(l&&!_a.$2H.$14S(l)){$6td(n,l);throw l;}_js.Trace.logInfo(_a.$0.$4A,"Building S/MIME data package...");var u=_g.$V.get_$I().get_$TX();_js.Trace.logInfo(_a.$0.$4A,"Admin.AlwaysEncrypt="+u.AlwaysEncrypt);_js.Trace.logInfo(_a.$0.$4A,"Admin.AlwaysSign="+u.AlwaysSign);_js.Trace.logInfo(_a.$0.$4A,"Admin.IsClearSign="+u.ClearSign);_js.Trace.logInfo(_a.$0.$4A,"Admin.TripleWrap="+u.TripleWrapSignedEncryptedMail);_js.Trace.logInfo(_a.$0.$4A,"User.AlwaysEncrypt="+_g.$V.get_$I().get_$1I().get_$2dM());_js.Trace.logInfo(_a.$0.$4A,"User.AlwaysSign="+_g.$V.get_$I().get_$1I().get_$2dR());_js.Trace.logInfo(_a.$0.$4A,"User.SigningCert="+_g.$V.get_$I().get_$1I().get_$3PH());_js.Trace.logInfo(_a.$0.$4A,"User.SigningCertId="+_g.$V.get_$I().get_$1I().get_$2dH());_js.Trace.logInfo(_a.$0.$4A,"Context.Encrypt="+n.$d_2.get_$GW());_js.Trace.logInfo(_a.$0.$4A,"Context.Sign="+n.$d_2.get_$IT());var f=_a.$s.$qh();var o=null;var s=n.$d_2.$5E8();s.get_$3n()==="HTML"&&s.set_$1g(_a.$3N.$4Qd(s.get_$1g(),!0));var p=null;var w=n.$f.get_$bp();var b=w.get_$5o();if(b.get_$1N()&&b.get_$1N().get_$B()>0){var a=new(_0365f.$o.$$(String));var ut=this;w.get_$5o().get_$1N().$Bh(function(n){var r=n;var t=r.get_$9L();if(!t.get_$xO())if(_g.$4x.isInstanceOfType(t)){var i=t;i.set_$Bf(i.get_$Bf()||"application/octet-stream");var u=i.get_$6D()?i.get_$Ge():"";var f=i.get_$Ca();a.$D(u+">"+i.get_$1L()+">"+i.get_$Bf()+">"+f)}else if(_g.$8z.isInstanceOfType(t)){var e=t;a.$D(">>>"+e.get_$IH())}else if(_g.$8F.isInstanceOfType(t)){var o=t;var s=o.get_$IH();a.$D(">>>"+s)}});p=a.get_$3T().join("|")}var t=new MimeHeader;var k,d,g;n.$f.get_$LS().$7wu(k={val:t.From},d={val:t.To},g={val:t.Cc});t.From=k.val;t.To=d.val;t.Cc=g.val;t.Subject=n.$d_2.get_$2i();switch(n.$d_2.get_$6U()){case"Normal":t.Importance="Normal";t.Priority=3;break;case"High":t.Importance="High";t.Priority=1;break;case"Low":t.Importance="Low";t.Priority=5;break;default:t.Importance=n.$d_2.get_$6U();t.Priority=3;break}switch(n.$d_2.get_$84()){case"Normal":t.Sensitivity="Normal";break;case"Confidential":t.Sensitivity="Confidential";break;case"Personal":t.Sensitivity="Personal";break;case"Private":t.Sensitivity="Private";break;default:t.Sensitivity=n.$d_2.get_$84();break}t.Date=_a.$7.$5P4(_a.$7.get_$29());t.IsReadReceiptRequested=n.$d_2.get_$F6();t.IsDeliveryReceiptRequested=n.$d_2.get_$Fj();if(n.$d_2.get_$L3()){t.IsClassified=n.$d_2.get_$L3();t.ClassificationKeep=n.$d_2.get_$1Kk();t.ClassificationGuid=n.$d_2.get_$Tp();t.Classification=n.$d_2.get_$Qi();t.ClassificationDescription=n.$d_2.get_$PI()}var i=new SmimeInfo;i.Header=t;i.BodyType=s.get_$3n()==="HTML"?2:1;i.Body=s.get_$1g();i.Attachments=p;var e=_d.$7m.isInstanceOfType(n);if(n.$d_2.get_$IT()&&!n.$d_2.get_$GW()){_js.Trace.logInfo(_a.$0.$4A,"Signing only...");var nt=u.ClearSign?f.ClearSign(JsonParser.serialize(i),e?null:n.$d_2.get_$1Hz()):f.OpaqueSign(JsonParser.serialize(i),e?null:n.$d_2.get_$1Hz());var v=JsonParser.deserialize(nt);if(v.ErrorCode)throw _a.$2H.$Wk(_a.$2H.$E(_u.Strings.l_Smime_CannotSign_Text,v.ErrorCode),13);else o=v.Data}else if(!n.$d_2.get_$IT()&&n.$d_2.get_$GW()){_js.Trace.logInfo(_a.$0.$4A,"Encrypting only...");var tt=n.$d_2.get_$2dQ()?n.$d_2.get_$2dQ().join("|"):null;var it=f.Encrypt(JsonParser.serialize(i),e?null:tt);var y=JsonParser.deserialize(it);if(y.ErrorCode)throw _a.$2H.$Wk(_a.$2H.$E(_u.Strings.l_Smime_CannotEncrypt_Text,y.ErrorCode),14);else o=y.Data}else if(n.$d_2.get_$IT()&&n.$d_2.get_$GW()){_js.Trace.logInfo(_a.$0.$4A,"Signing... 1st round");var h=f.OpaqueSign(JsonParser.serialize(i),e?null:n.$d_2.get_$1Hz());var r=JsonParser.deserialize(h);if(r.ErrorCode)throw _a.$2H.$Wk(_a.$2H.$E(_u.Strings.l_Smime_CannotSign_Text,r.ErrorCode),13);else{i.Body=r.Data;i.BodyType=3;i.Attachments=null;var rt=n.$d_2.get_$2dQ()?n.$d_2.get_$2dQ().join("|"):null;_js.Trace.logInfo(_a.$0.$4A,"Encrypting... 2nd round");h=f.Encrypt(JsonParser.serialize(i),e?null:rt);r=JsonParser.deserialize(h);if(r.ErrorCode)throw _a.$2H.$Wk(_a.$2H.$E(_u.Strings.l_Smime_CannotEncrypt_Text,r.ErrorCode),14);else if(u.TripleWrapSignedEncryptedMail){i.Body=r.Data;i.BodyType=3;i.Attachments=null;_js.Trace.logInfo(_a.$0.$4A,"Signing... 3rd round");h=f.OpaqueSign(JsonParser.serialize(i),e?null:n.$d_2.get_$1Hz());r=JsonParser.deserialize(h);if(r.ErrorCode)throw _a.$2H.$Wk(_a.$2H.$E(_u.Strings.l_Smime_CannotSign_Text,r.ErrorCode),13);else o=r.Data}else o=r.Data}}_js.Trace.logInfo(_a.$0.$4A,"S/MIME data package built successfully.");n.$d_2.set_$6Xw(o);return!0}catch(c){_js.Trace.logWarning(_a.$0.$4A,c.message);if(_a.$2H.$xP(c)){n.$1ot(c);return!1}else{_js.Trace.logException(_a.$0.$4A,c,"Unknown exception occurred when building S/MIME content.");n.$1ot(_a.$2H.$E(c.message,11));return!1}}}function $6td(n,t){_d.$8V.isInstanceOfType(n)?_a.$2H.$Wk(t,2):_d.$7m.isInstanceOfType(n)&&_a.$2H.$Wk(t,3)}_d.$Bp.prototype={$7Xj:0,$17:null,$f:null,$d_2:null,$cX:null,$7A:!1,get_$Cf:function(){return this.$7A},set_$Cf:function(n){this.$7A=n;return n},get_$1b:function(){return _a.$0.$j},$49:function(){this.$7A=!0},$Au:function(){this.$7A=!1},$53e:function(n){var t=this.$7tX(n);this.$cX.$2a(t,null);(t===55||t===50)&&this.$f.$1RU.$53c(this.$cX);_d.$4p.$Ek(this.$17)},$1ot:function(n){this.$cX.$113(n);_d.$4p.$Ek(this.$17)},$3cY:function(n,t){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];var u;(u=this.$cX).$MZ.apply(u,[t,n].concat(r));_d.$4p.$Ek(this.$17)},$7tX:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_d.$PM=function(n,t,i,r,u,f,e){this.$$d_$9ci=Function.createDelegate(this,this.$9ci);this.$$d_$5XT=Function.createDelegate(this,this.$5XT);this.$1YA=[];this.$5CD=new _d.$192(this,t,i,r,u,f,e);this.$f=n};function $4lz(n,t,i){if($6(i)||!i)for(var r=0;r<n.$1YA.length;r++)$4m0(n,t,r);else for(var u=n.$1YA.length-1;u>=0;u--)$4m0(n,t,u)}function $4m0(n,t,i){var r=n.$1YA[i];$6(r)||t(r,i)}_d.$PM.prototype={$1YA:null,$f:null,$5CD:null,$3c:function(n){var t=n;$6(this.$1YA[t])&&(this.$1YA[t]=this.$5CD.$7bb(n,this.$f.$C.get_$L()));return this.$1YA[t]},$49:function(){$4lz(this,this.$$d_$5XT)},$Au:function(){_js.Trace.logInfo(_a.$0.$j,"Component Map Reset start.");$4lz(this,this.$$d_$9ci,!0);_js.Trace.logInfo(_a.$0.$j,"Component Map Reset end.")},$5XT:function(n,t){_d.$8U.isInstanceOfType(n)||n.get_$Cf()||n.$49()},$9ci:function(n,t){var i=Object.getType(n).getName();if(n.get_$Cf()){_js.Trace.logInfo(_a.$0.$j,"Reset "+i+" at index "+t);n.$Au()}else _js.Trace.logInfo(_a.$0.$j,"Skip uninitialized "+i+" at index "+t)}};_d.$PN=function(n){this.$$d_$9vp=Function.createDelegate(this,this.$9vp);this.$$d_$9vm=Function.createDelegate(this,this.$9vm);this.$$d_$9vo=Function.createDelegate(this,this.$9vo);_d.$PN.initializeBase(this,[17,n])};function $4m1(n){var t=null;var i,r;if(r=_a.$1b.$1YO(_a.UserAgent.getInstance(),n.$17.$f.$d.get_$Cu(),i={val:t}),t=i.val,r){n.$17.$f.$d.set_$NV(t);n.set_$4Yu(t);n.set_$4Yu(null);n.$17.$f.get_$1Ab().$6XN();var u=n.$17.$3c(5);u.$4Wg(!1);u.get_$5o().$9oY();n.$17.$f.$d.set_$3n("Text");_js.Trace.logInfo(n.get_$1b(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(n.get_$1b(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")}function $4m2(n,t){_js.Trace.logInfo(n.get_$1b(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!n.$17.$f.$d.get_$EH()){n.$17.$f.$1z.$32(0,t,null);_js.Trace.logInfo(n.get_$1b(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}_d.$PN.prototype={$4av:null,$4b0:null,$4Yt:null,$4Yr:null,get_$4Yu:function(){return this.$4Yt},set_$4Yu:function(n){this.$4Yt=n;$N(this,"SwitchToPlainTextContent");return n},get_$4Ys:function(){return this.$4Yr},set_$4Ys:function(n){this.$4Yr=n;$N(this,"SwitchToHtmlContent");return n},$49:function(){this.$4b0||(this.$4b0=new _C(this.$$d_$9vo,this.get_$1b()));this.$4av||(this.$4av=new _C(this.$$d_$9vm,this.get_$1b()));_d.$Bp.prototype.$49.call(this)},$9vp:function(n,t){n&&$4m1(this)},$9vo:function(){_js.Trace.logInfo(this.get_$1b(),"User chose to convert to plain text");if($4m2(this,_nbs.NonBootStrings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$17.$f.$d.$Ih.$n();var t=this.$17.$f.$d.get_$Cu();var n;var i,r;var u=(r=_a.$1b.$3jV(t,i={val:n}),n=i.val,r);if(!u){n=t;_js.Trace.logInfo(this.get_$1b(),"Using html due to failed conversion")}if(n.length>0){var f=this.$17.$f.$1z;f.$32(1,_nbs.NonBootStrings.l_ConvertToPlainTextWarning_Text,this.$$d_$9vp)}else $4m1(this)}},$9vm:function(){_js.Trace.logInfo(this.get_$1b(),"User chose to convert to html");if($4m2(this,_nbs.NonBootStrings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var i=this.$17;var n=i.$f;var t=n.$d;t.$2wY.$n();var u=n.$d.get_$18L();t.set_$3n("HTML");var r=_a.$1b.$1Af(u);t.set_$NV(r);this.set_$4Ys(r);this.set_$4Ys(null);n.get_$1Ab().$6XO();var f=i.$3c(5);f.$4Wg(!0);_js.Trace.logInfo(this.get_$1b(),"MailComposeContentConversionComponent.ToHtml succeeded.")}}};_d.$R9=function(n){_d.$R9.initializeBase(this,[18,n]);this.$58=_g.$V.get_$I().get_$1I();this.$d=this.$17.$f.$d};_d.$R9.prototype={$3Rc:null,$3RW:null,$58:null,$d:null,get_$LF:function(){return this.$U(_d.$R9.$1E4)},set_$LF:function(n){this.$K(_d.$R9.$1E4,n);return n},$6XN:function(){this.$3RW.set_$q(!1);this.$3Rc.set_$q(!0)},$6XO:function(){this.$3RW.set_$q(!0);this.$3Rc.set_$q(!1)},$49:function(){if("Mouse"===_y.$v.$v.get_$L()){var t=[];var n;if(this.$d.get_$40()!==8&&!this.$d.get_$iz()&&!_y.$v.$v.get_$Vm()){var e=this.$17.$3c(8);n=new _0365m.$m(_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,null,e.$El);Array.add(t,n)}var i=this.$17.$3c(1);if(!this.$d.get_$iz()){n=new _0365m.$m(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$3OB);_g.$V.get_$I().get_$1I().get_$1WM()&&n.set_$q(!0);Array.add(t,n);n=new _0365m.$m(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,null,i.$3wN);_g.$V.get_$I().get_$1I().get_$1WM()||n.set_$q(!0);Array.add(t,n)}if(this.$d.get_$2Q1()||this.$d.get_$Pl()){var l=this.$17.$3c(1);n=new _0365m.$m(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$2cj);(_g.$V.get_$I().get_$1I().get_$lF()||this.$d.get_$UK())&&n.set_$q(!0);Array.add(t,n);i.$2cj.set_$5u(!this.$d.get_$Pl());n=new _0365m.$m(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,null,i.$3wU);_g.$V.get_$I().get_$1I().get_$lF()||this.$d.get_$UK()||n.set_$q(!0);Array.add(t,n)}if(!this.$d.get_$iz()&&!_y.$v.$v.get_$Vm()){n=new _0365m.$m(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$17I);Array.add(t,n)}var u=this.$17.$3c(6);if(!$6(u.$DA)){n=new _0365m.$Gv(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,u.$DA);Array.add(t,n)}var r=this.$17.$3c(3);if(r.$DA){n=new _0365m.$Gv(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r.$DA);Array.add(t,n)}else if(r.$3hJ()&&this.$17.$f.$Za.IsLoadingFromServer){n=new _0365m.$m(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$v.$v.get_$Vm()){var o=this.$17.$3c(12);var s=this.$17.$3c(5);n=new _0365m.$m(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,null,o.$3cr);s.get_$LF().$1C.$D(n)}var f=this.$17.$3c(17);this.$3Rc=new _0365m.$m(_nbs.NonBootStrings.l_ConvertToPlainText_LowerCase_Text,null,f.$4b0);Array.add(t,this.$3Rc);this.$3RW=new _0365m.$m(_nbs.NonBootStrings.l_ConvertToHtml_Text,null,f.$4av,!0);Array.add(t,this.$3RW);this.$d.get_$3n()==="HTML"?this.$6XO():this.$6XN();if(!this.$d.get_$iz()){var h=this.$17.$3c(10);n=new _0365m.$m(_nbs.NonBootStrings.l_ShowMessageOptions_Text,null,h.$29S);Array.add(t,n)}var c=this.$17.$3c(18);c.set_$LF(new _0365m.$2b(t))}_d.$Bp.prototype.$49.call(this)},$A13:function(){var n=this.get_$LF().$1C.get_$3q(this.$1ut(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text));var t=this.get_$LF().$1C.get_$3q(this.$1ut(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text));n.set_$q(this.$d.get_$mh());t.set_$q(!this.$d.get_$mh())},$6eV:function(){var n=this.get_$LF().$1C.get_$3q(this.$1ut(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text));var t=this.get_$LF().$1C.get_$3q(this.$1ut(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text));n.set_$q(this.$d.get_$UK());t.set_$q(!this.$d.get_$UK())},$1ut:function(n){var i=this.get_$LF().$1C;if(i)for(var t=0;t<i.get_$B();t++)if(n===i.get_$3q(t).$2E)return t;return-1},$7OR:function(){var n=this.$17.$3c(3);if(!$6(n.$DA)){var t=this.$1ut(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text);if(t>=0){var i=new _0365m.$Gv(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,n.$DA);this.get_$LF().$1C.$72(t+1,i)}}}};_d.$Tz=function(n){this.$$d_$2y0=Function.createDelegate(this,this.$2y0);this.$$d_$3nr=Function.createDelegate(this,this.$3nr);this.$$d_$9o1=Function.createDelegate(this,this.$9o1);_d.$Tz.initializeBase(this,[21,n]);this.$EW=new _C(this.$$d_$9o1,this.get_$1b());this.$Gk=n.$f.$Gk};function $4mC(n,t,i){n.$2y0();var r=n.$17.$f;var u=r.$d.get_$1D2()||r.$d.get_$qn();n.$Gk.$2s8(t,i,r.$k,u)}function $6tm(n){if($6(n.$12O)){_js.Trace.logInfo(_a.$0.$j,"Creating discard confirm dialog.");var t=new _js.$Z;t.$D(new _a.$2G(new _C(n.$$d_$3nr,n.get_$1b()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$D(new _a.$2G(new _C(n.$$d_$2y0,n.get_$1b()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$5JC(t)}}_d.$Tz.prototype={$EW:null,$Gk:null,$12O:null,$1Cu:!1,get_$5JC:function(){return this.$12O},set_$5JC:function(n){if(n!==this.$12O){this.$12O=n;$N(this,"DiscardConfirmDialogButtonData")}return n},get_$1xK:function(){return this.$1Cu},set_$1xK:function(n){if(n!==this.$1Cu){this.$1Cu=n;$N(this,"IsDiscardConfirmDialogShown")}return n},$3nr:function(){var i=this.$17;var t=i.$f;var n=t.$d;_js.Trace.logInfo(_a.$0.$j,"Discard and close");t.set_$xE(!0);if(n.get_$40()||!n.get_$40()&&(n.get_$A3()||t.get_$1TD().$Dv)){_js.Trace.logInfo(_a.$0.$j,"Discard");$4mC(this,n.get_$7g(),n.get_$A3())}n.set_$Ia(null);var r=i.$3c(2);r.get_$4i().$2WQ(t,!1);_js.Trace.logInfo(_a.$0.$j,"Navigated away from compose")},$3LG:function(n,t){if(this.$Gk.$if(n)){_js.Trace.logInfo(_a.$0.$j,"Resuming discard of "+_h.$Dn.$wZ(t));$4mC(this,n,t)}else _js.Trace.logInfo(_a.$0.$j,"User had already discarded.")},$9o1:function(){var t=this.$17.$f;var n=t.$d;_js.Trace.logInfo(_a.$0.$j,"User chose to discard");if($3Wa(this)){$6tm(this);_js.Trace.logInfo(_a.$0.$j,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$1xK(!0)}else{_js.Trace.logInfo(_a.$0.$j,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$3nr()}},$2y0:function(){_js.Trace.logInfo(_a.$0.$j,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$17.$f.$d.toString());this.set_$1xK(!1)}};_d.$194=function(n){_d.$194.initializeBase(this,[27,n])};_d.$194.prototype={$Zk:null,get_$JO:function(){return this.$Zk},set_$JO:function(n){this.$Zk=n;$N(this,"EditorCallContext");return n}};_d.$Js=function(n){this.$$d_$9jq=Function.createDelegate(this,this.$9jq);this.$$d_$9jz=Function.createDelegate(this,this.$9jz);this.$$d_$9jH=Function.createDelegate(this,this.$9jH);_d.$Js.initializeBase(this,[6,n])};_d.$Js.$5E2=function(n,t){return new _y.$2v(n,t)};_d.$Js.$2pt=function(n,t){return new _0365m.$m(n,null,t,!0)};function $2hM(n,t){n.$17.$f.$d.set_$6U(t);n.set_$8AF("High"===t);n.set_$8Bu("Normal"===t);n.set_$8BM("Low"===t)}_d.$Js.prototype={$DA:null,$bl:null,$40q:!1,$31x:!1,$41V:!1,get_$8AF:function(){return this.$40q},set_$8AF:function(n){if(n!==this.$40q){this.$40q=n;$N(this,"IsHighImportance")}return n},get_$8Bu:function(){return this.$31x},set_$8Bu:function(n){if(n!==this.$31x){this.$31x=n;$N(this,"IsNormalImportance")}return n},get_$8BM:function(){return this.$41V},set_$8BM:function(n){if(n!==this.$41V){this.$41V=n;$N(this,"IsLowImportance")}return n},$49:function(){var n=this.$17.$f.$d.get_$6U();$2hM(this,n);_js.Trace.logInfo(_a.$0.$j,"Importance component initialized and importance set to {0}",n);if("Mouse"===_y.$v.$v.get_$L()){if(!this.$DA){var t=this.$A5w(_0365m.$m,_d.$Js.$2pt);t&&(this.$DA=new _0365m.$2b(t))}}else if(!this.$bl){var i=this.$A5w(_y.$2v,_d.$Js.$5E2);i&&(this.$bl=new _y.$2v(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,i))}_d.$Bp.prototype.$49.call(this)},$9jH:function(){var n=_a.$6.$1c(_a.$0.$j,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$j,"User sets high importance");$2hM(this,"High");_a.$6.$1E(n)},$9jz:function(){_js.Trace.logInfo(_a.$0.$j,"User sets normal importance");$2hM(this,"Normal")},$9jq:function(){var n=_a.$6.$1c(_a.$0.$j,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$j,"User sets low importance");$2hM(this,"Low");_a.$6.$1E(n)},$A5w:function(n,t){return[t(_nbs.NonBootStrings.l_HighImportanceButtonText_Text,new _C(this.$$d_$9jH,this.get_$1b())),t(_nbs.NonBootStrings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$9jz,this.get_$1b())),t(_nbs.NonBootStrings.l_LowImportanceButtonText_Text,new _C(this.$$d_$9jq,this.get_$1b()))]}};_d.$qH=function(n,t){this.$$d_$2rz=Function.createDelegate(this,this.$2rz);this.$$d_$4Uw=Function.createDelegate(this,this.$4Uw);this.$$d_$4Wz=Function.createDelegate(this,this.$4Wz);_d.$qH.initializeBase(this,[26,n]);this.$L6=_h.$4C.$3tS(t)};function $6tp(n){if(_h.$4C.$2OB){_js.Trace.logInfo(_a.$0.$4o,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",n.$Xc.Url);n.$2rz();return}if(n.$Xc){var i=1;var r=_a.$6.$1c(_a.$0.$4o,"GetComposeLinkPreview",!0);var t=[];Array.add(t,n.$Xc);_js.Trace.logInfo(_a.$0.$4o,"Preparing GetLinkPreview action for {0}",n.$Xc.Url);n.$Xc.Autoplay=!0;var u=new _h.$4C(n.$Xc);_js.Trace.logInfo(_a.$0.$4o,"Submitting GetLinkPreview action for {0}",n.$Xc.Url);var f=this,e=this;n.$17.$f.$k.$oj(u,function(u){_h.$4C.$6Tr(u,n.$$d_$4Uw,n.$$d_$2rz,i,r,"GetComposeLinkPreview",t)},function(n){_h.$4C.$5Lh(n,i,r,"GetComposeLinkPreview",t)},null)}}_d.$qH.prototype={$Xc:null,$1Dg:null,$L6:!1,$u6:!1,$uj:null,$Nm:null,get_$1OA:function(){return this.$L6},set_$1OA:function(n){if(n!==this.$L6){this.$L6=n;$N(this,"IsLinkPreviewEnabled")}return n},get_$3tW:function(){return this.$Xc},set_$3tW:function(n){if(n!==this.$Xc){this.$Xc=n;$6tp(this)}return n},get_$1zg:function(){return this.$1Dg},set_$1zg:function(n){this.$1Dg=n;$N(this,"LinkPreviewResponse");return n},get_$18v:function(){return this.$Nm},set_$18v:function(n){if(n!==this.$Nm){this.$Nm=n;this.$Nm&&_h.$4C.$3vV(this.$Nm,null,this.$$d_$4Wz,null)}return n},get_$29f:function(){return this.$u6},set_$29f:function(n){if(this.$u6!==n){this.$u6=n;$N(this,"ShowYouTubePlayer")}return n},get_$4eY:function(){return this.$uj},set_$4eY:function(n){this.$uj=n;$N(this,"YouTubePlayerUrl");return n},$4Uw:function(n){this.set_$1zg(n)},$2rz:function(){this.set_$1OA(!1)},$4Wz:function(n){this.set_$4eY(n);this.set_$29f(!!this.$uj)}};_d.$DP=function(n){_d.$DP.initializeBase(this,[16,n])};function $6tZ(n){n.$w.$DG(_d.$DP.$6JG);$6tR(n)}function $6tV(n){var t=n.$17.$f.$d;var i=t.get_$E3()||t.get_$Vi();return i&&t.get_$W0()?i:null}function $6tY(n){if(_g.$33.isInstanceOfType(n.$vE))return n.$vE.get_$Lf();else if(_g.$RD.isInstanceOfType(n.$vE)){var t=n.$vE;return t.get_$KB().get_$Lf()==="RecurringMaster"?t.get_$Pk()?"RecurringMaster":"Occurrence":t.get_$KB().get_$Lf()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(n.$vE).getName());}function $6tR(n){if(n.$vE){$6tT(n);if(!_g.$PV.isInstanceOfType(n.$vE)){n.$w.$2a(6800);switch($6tY(n)){case"Occurrence":case"Exception":$6tU(n);break;case"RecurringMaster":$6tS(n);break}}}}function $6tW(n,t){var i;switch(t){case 8:i=3200;break;case 3:i=3205;break;case 5:i=3210;break;case 6:i=3215;break;case 7:i=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+t);}return i}function $6tX(n,t){var i;switch(t){case 8:i=3100;break;case 3:i=3105;break;case 5:i=3110;break;case 6:i=3115;break;case 7:i=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+t);}return i}function $6tS(n){var t=$6tX(n,n.$2p4);n.$w.$2a(t)}function $6tU(n){var t=new _d.$GQ;var i=t.$36(n.$vE,null);var r=$6tW(n,n.$2p4);n.$w.$2a(r,i)}function $6tT(n){if(_g.$CC.isInstanceOfType(n.$vE)){var i=n.$vE;var r=i.get_$30L()&&!!i.get_$1Sb();if(r){var t=-1;switch(n.$2p4){case 5:t=3250;break;case 7:t=3260;break;case 6:t=3255;break}t!==-1&&n.$w.$2a(t,i.get_$1Sb().Mailbox.Name)}}}_d.$DP.prototype={$w:null,$2p4:0,$vE:null,$49:function(){_d.$Bp.prototype.$49.call(this);this.$vE=$6tV(this);var n=this.$17.$f;this.$w=n.$vq();this.$2p4=n.$d.get_$40();_d.$90.$5eT(n.$d)&&!n.$d.get_$42u()&&$6tZ(this)}};_d.$8U=function(n,t){this.$$d_$7xQ=Function.createDelegate(this,this.$7xQ);this.$$d_$9Ft=Function.createDelegate(this,this.$9Ft);this.$$d_$7nI=Function.createDelegate(this,this.$7nI);this.$$d_$7oN=Function.createDelegate(this,this.$7oN);this.$$d_$9GA=Function.createDelegate(this,this.$9GA);this.$$d_$68Q=Function.createDelegate(this,this.$68Q);this.$$d_$9G9=Function.createDelegate(this,this.$9G9);this.$$d_$3Ew=Function.createDelegate(this,this.$3Ew);this.$$d_$9Fr=Function.createDelegate(this,this.$9Fr);this.$$d_$9Cs=Function.createDelegate(this,this.$9Cs);_d.$8U.initializeBase(this,[0,n]);this.$Gk=n.$f.$Gk;this.$1J=t;this.set_$3h8(!0)};function $4mF(n,t){if(n.$d_2.get_$1DF()&&n.$d_2.get_$p8()){_js.Trace.logInfo(_a.$0.$j,"Capture initial baseline for a loaded draft.");n.$d_2.$Vv=_d.$1m.$1qZ(n.$d_2)}_js.Trace.logInfo(_a.$0.$j,"Finish 1st init for a loaded draft.");$2Cj(n);var i=this;_js.$J.get_$I().$3r(_a.$0.$j,"TriggerPolicyTipsIfNeeded",function(){var t=n.$17.$3c(25);t.$1IX(32)})}function $2Cj(n){var t=n.$17;var r=t.$f;var i=r.$d;var u=i.get_$40();t.$3c(7).$49();t.$3c(8).$49();t.$3c(1).$49();i.get_$W0()&&t.$3c(16).$49();var f=_y.$v.$v.get_$L();u&&u!==11||!n.$1J.get_$BQ()||i.get_$NV()||i.set_$NV("");i.get_$Na()&&t.$3c(12).$49();f!=="Mouse"?t.$3c(11).$49():t.$3c(24).$49();if(r.$Sm){_js.Trace.logInfo(_a.$0.$j,"Begin 2nd init in finish 1st because we are already in view.");n.$57e()}n.set_$Cf(!0);_a.$6.aces(n.$5iX)}function $3We(n,t){var r=n.$17.$f;var i=r.$d;var e=r.$k;if(i.get_$1DF()){if(i.get_$p8()){_js.Trace.logInfo(_a.$0.$j,"Capture initial baseline since message was a clean new message before popout, context: "+i.toString());i.$Vv=_d.$1m.$1qZ(i)}i.get_$rU()&&!i.get_$EH()&&$3Wc(n,!0)}else i.set_$1D2(!0);r.$w.$5S(3400);r.$w.$2a(3400,null);i.get_$2PZ()&&r.$w.$2a(3480);var u=n.$1J.get_$BQ()&&i.get_$3n()==="HTML"?_h.$15.get_$206():_h.$15.get_$35R();var o="MailCompose";var f=_d.$Ak.$3kK(t,u,o);f.$59=i.get_$7g();e.$oj(f,n.$$d_$9Ft,n.$$d_$9Fr,n.$$d_$3Ew);_js.Trace.logInfo(_a.$0.$j,"Loading draft with ID="+_h.$Dn.$wZ(t)+"; Shape="+u.BodyType+"; Layout="+_y.$v.$v.get_$L()+"; ContextBodyType="+i.get_$3n())}function $3Wc(n,t){if(t!==n.$4cu){var i=n.$17.$f.$w;i.$5S(3440);t&&i.$2a(3440,null);_d.$4p.$Ek(n.$17);n.$4cu=t}}function $3Wd(n){var r=n.$17;var i=r.$f.$d;var t=i.get_$40();var u=1===t||2===t||3===t||12===t;if(u&&!i.get_$A3()&&!i.get_$EH()){var f=r.$3c(13);f.$7SD()}}function $4mG(n){var t=n.$17.$f.$d.get_$7g();_js.Trace.logInfo(_a.$0.$j,"Calling main window to process save result "+t);_g.$1U.$MG.$7xP(t,_a.$40.$1mv,n.$$d_$7xQ)}_d.$8U.prototype={$Gk:null,$32o:!1,$2nr:!1,$4cu:!1,$5iX:null,$1J:null,get_$Cf:function(){return _d.$Bp.prototype.get_$Cf.call(this)},set_$Cf:function(n){if(n!==_d.$Bp.prototype.get_$Cf.call(this)){_d.$Bp.prototype.set_$Cf.call(this,n);$N(this,"IsInitialized")}this.$17.$f.$d.$5f6=n;return n},get_$5e5:function(){return this.$32o},set_$5e5:function(n){if(n!==this.$32o){this.$32o=n;$N(this,"IsSecondInitializationComplete")}return n},get_$3h8:function(){return this.$2nr},set_$3h8:function(n){if(this.$2nr!==n){this.$2nr=n;$N(this,"CanLoadPopoutSuccessfully")}return n},$49:function(){this.$5iX=_a.$6.acss(_a.$0.$j,"VM.MailCompose.FirstInit");var i=this.$17.$f;var n=i.$d;if(!n.$Vv&&!n.get_$A3()){_js.Trace.logInfo(_a.$0.$j,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$Vv=_d.$1m.$1qZ(n);n.get_$1DF()||n.set_$p8(!0)}if(n.get_$fa()){_js.Trace.logInfo(_a.$0.$j,"Finish 1st init for complete context");$2Cj(this);_js.Trace.logInfo(_a.$0.$j,"Check begin upgrade for complete context");$3Wd(this)}else{var u=i.$k;var r=n.get_$A3();var t=n.get_$dJ();var f=n.get_$6ZJ();if(!r&&f){var o;var e=_g.$V.get_$I().get_$31();o=_js.$9.$a(e.get_$ob())?e.get_$Aj()||"":e.get_$aN()||"";var c=new _g.$SU("StoreId",f,o);var l=new _c.$ut([c],"EwsId");u.$oj(l,this.$$d_$9Cs,this.$$d_$9Fr,this.$$d_$3Ew);_js.Trace.logInfo(_a.$0.$j,"Calling server to convert id, storeId="+f)}else if(r)if(n.get_$2C7()&&n.get_$1DF()){_js.Trace.logInfo(_a.$0.$j,"The message was saving prior to popout, check for save result from main window");$4mG(this)}else{_js.Trace.logInfo(_a.$0.$j,"Load draft "+_h.$Dn.$wZ(r));$3We(this,r)}else if((4===n.get_$40()||13===n.get_$40())&&n.get_$1DF()){_js.Trace.logInfo(_a.$0.$j,"Loading draft without id for the popout from inline case, check id from main window");$4mG(this)}else if(t){i.$w.$5S(3400);i.$w.$2a(3400,null);if(n.get_$14D()){var a=_cc.$GW.$G3(t,n.get_$rN());var s=new _cc.$GW(200,a);s.$59=n.get_$7g();u.$oj(s,this.$$d_$9G9,this.$$d_$68Q,this.$$d_$3Ew);_js.Trace.logInfo(_a.$0.$j,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=_d.$Ak.$3kK(t);h.$59=n.get_$7g();u.$oj(h,this.$$d_$9GA,this.$$d_$68Q,this.$$d_$3Ew);_js.Trace.logInfo(_a.$0.$j,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$40()||11===n.get_$40()){n.set_$EH(!0);n.set_$fa(!0);_js.Trace.logInfo(_a.$0.$j,"Finish 1st init for new mail");$2Cj(this)}else{_y.$2S.$1E(n.get_$QB(),null,"ErrorNoDraftOrOriginalItemId");n.set_$QB(null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$1g.$9a(_y.$Iw,n.get_$40())));}}_js.$9.$a(_g.$V.get_$I().get_$31().get_$ob())||i.$w.$2a(95,null)},$Au:function(){this.set_$Cf(!1);this.set_$5e5(!1);this.set_$3h8(!0);this.$4cu=!1},$57e:function(){var i=this.$17;var r=i.$f;var t=r.$d;var u=t.get_$40();var n=null;switch(u){case 0:n="MailComposeNew";break;case 1:n="MailComposeReply";break;case 2:n="MailComposeReplyAll";break;case 3:n="MailComposeForward";break;case 4:n="MailComposeEditDraft";break;case 12:n="MailComposePostReply";break}n&&_a.$6.endPT(n);if(t.get_$QB()){_y.$2S.$1E(t.get_$QB());t.set_$QB(null)}_js.Trace.logInfo(_a.$0.$j,"Queue 2nd init task, context:"+t.toString());_js.$J.get_$I().$3r(_a.$0.$j,"Delayed MailCompose Secondary Init",this.$$d_$7oN);if(r.get_$2OF()&&!r.$3w.$1C){var f=i.$3c(11);_js.Trace.logInfo(_a.$0.$j,"Queue appbar setup task");_js.$J.get_$I().$3r(_a.$0.$j,"SetupApplicationBarMenu",f.$$d_$9l6)}var e=i.$3c(19);_js.Trace.logInfo(_a.$0.$j,"Queue GetMailTips if needed task");_js.$J.get_$I().$3r(_a.$0.$j,"TriggerMailTipsIfNeeded",e.$$d_$9ws)},$9Ft:function(n){var u=this.$17.$f.$d;var c=this.$f.get_$5JB();var i=n;var r=n.$59;_js.Trace.logInfo(_a.$0.$j,"Got draft, checking pending discards for "+r);if(this.$Gk.$if(r))c.$3LG(r,i.get_$i());else if(r===this.$d_2.get_$7g()){var t=i.$G6;if(_g.$V0.isInstanceOfType(t)){this.$d_2.$5XZ(t);$3Wc(this,!0);$4mF(this,i)}else{var s=this;var e=function(){u.$A16(t.get_$1qs());u.$3xu(t);$3Wc(s,!1);$4mF(s,i)};if(_a.$s.$2t&&t.get_$GD()){_js.Trace.logInfo(_a.$0.$4A,"The draft is a S/MIME message.");var l=this;var h=function(n){_js.Trace.logWarning(_a.$0.$j,n.message);if(_a.$2H.$xP(n)){l.$1ot(n);_y.$2S.$1E(u.get_$QB(),null,n.message,i.$A6R());u.set_$QB(null)}e()};var f=_a.$s.$16p(this.$f.$C.get_$L()==="Mouse",!0,!0,!1,!1,!1);f&&(_a.$2H.$14S(f)?f=null:h(f));var o=new _h.$G0(200,t);var v=this,y=this;this.$f.$k.$oj(o,function(){t.set_$8X(null);t.set_$3O(null);t.set_$40b(!0);e()},function(){_a.$2H.$Wk(o.$1f,4);h(o.$1f)},null)}else e()}if(_a.$5t.$2t){var a=this;_js.$J.get_$I().$3r(_a.$0.$j,"TriggerPolicyTipsIfNeeded",function(){var n=a.$17.$3c(25);n.$1IX(32)})}}else _js.Trace.logInfo(_a.$0.$j,"Skipping get draft processing since action context "+r+" doesn't match current context "+this.$d_2.toString())},$9G9:function(n){var r=this.$17;var u=r.$f;var t=u.$d;var i=n.$59;if(i===t.get_$7g()&&!this.$Gk.$if(i)){var f=n;t.$13p(f.$t);t.set_$rN(!1);_js.Trace.logInfo(_a.$0.$j,"Got original cal item, finish 1st init with context:"+t.toString());$2Cj(this);_js.Trace.logInfo(_a.$0.$j,"Check begin upgrade on original cal item");$3Wd(this)}},$9GA:function(n){var r=this.$17;var u=r.$f;var t=u.$d;var i=n.$59;if(i===t.get_$7g()&&!this.$Gk.$if(i)){var f=n;t.$13p(f.$G6);_js.Trace.logInfo(_a.$0.$j,"Got original message, finish 1st init with context: "+t.toString());$2Cj(this);_js.Trace.logInfo(_a.$0.$j,"Check begin upgrade on original message item");$3Wd(this)}},$9Fr:function(n){var u=this.$17;var i=u.$f;var t=i.$d;var r=n.$59;r!==t.get_$7g()||this.$Gk.$if(r)||i.$k.$17i(n,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessageDisconnected_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_u.Strings.l_ErrorRequestTimeout_Text,this.$$d_$7nI);var f=_d.$6s.$1uo(n.$1f)||"GetDraftFailure_UnknownError";var e=_d.$6s.$1up(n.$1f);_y.$2S.$1E(t.get_$QB(),null,f,n.$A6R(),e);t.set_$QB(null);_a.$6.endPT("MailComposeEditDraft")},$68Q:function(n){var u=this.$17;var i=u.$f;var t=i.$d;var r=n.$59;r!==t.get_$7g()||this.$Gk.$if(r)||i.$k.$6Va(n,this.$$d_$7nI);var f=_d.$6s.$1uo(n.$1f)||"GetItemFailure_UnknownError";var e=_d.$6s.$1up(n.$1f);_y.$2S.$1E(t.get_$QB(),null,f,n.$A6R(),e);t.set_$QB(null)},$7nI:function(n,t){var i=this.$17.$3c(2);i.get_$4i().$2WQ(this.$17.$f,!1);_js.Trace.logInfo(_a.$0.$j,"Navigate away on action failure")},$3Ew:function(n){var t=this.$17.$f;var i=t.$d;if(n.$59===i.get_$7g()){t.$w.$5S(3400);_d.$4p.$Ek(this.$17)}},$7oN:function(){var i=_a.$6.acss(_a.$0.$j,"VM.MailCompose.SecondInit");var t=this.$17;var r=t.$f;var n=r.$d;n.get_$40()||n.get_$NV()||n.set_$NV("");t.$3c(2);t.$49();n.get_$Ia()||n.$5LR();this.set_$5e5(!0);_a.$6.aces(i);_a.$6.endPT(null);_js.Trace.logInfo(_a.$0.$j,"Finish 2nd init, context:"+n.toString())},$9Cs:function(n){var i=n;var t=new _g.$1q(i.get_$5DW().Id);this.$17.$f.$d.set_$A3(t);$3We(this,t)},$7xQ:function(n){var t=this.$17.$f.$d;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$j,"Resume loading draft after main window successfully saved item: "+i.Id);t.get_$rU()&&!t.get_$EH()&&t.set_$EH(!0);$3We(this,i)}else{_js.Trace.logInfo(_a.$0.$j,"Save failed on the main window for this popout, show failure message.");this.set_$3h8(!1);_y.$2S.$1E(t.get_$QB(),null,"ErrorSaveFailedOnMainWindow");t.set_$QB(null)}}};_d.$Bq=function(n,t){this.$$d_$5MR=Function.createDelegate(this,this.$5MR);this.$$d_$9fH=Function.createDelegate(this,this.$9fH);this.$$d_$9VE=Function.createDelegate(this,this.$9VE);this.$$d_$4SZ=Function.createDelegate(this,this.$4SZ);this.$$d_$6QP=Function.createDelegate(this,this.$6QP);this.$$d_$96b=Function.createDelegate(this,this.$96b);this.$$d_$9Ri=Function.createDelegate(this,this.$9Ri);_d.$Bq.initializeBase(this,[9,n]);this.$6F4=new _C(this.$$d_$9Ri,this.get_$1b());this.$Gk=n.$f.$Gk;this.$1J=t};function $4mH(n,t){var i=n.$17.$f;i.set_$6ba(_nbs.NonBootStrings.l_Saving_Text);i.set_$6VT(t);i.set_$9mI(t)}function $4mI(n){var t=n.$17.$f;var i=n.$17.$3c(5);if(i.get_$CM()){if(!t.$1z.$2y){_js.Trace.logInfo(_a.$0.$j,"Show attachment in progress error dialog");t.$1z.$32(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1}function $4mJ(n){var r=n.$17.$f;var t=r.$d;var i=new _d.$R;n.$1J&&i.set_$BQ(n.$1J.get_$BQ());i.set_$61(0);i.set_$Na(!1);if(t.get_$40()===11||t.get_$40()===12){i.set_$40(13);i.set_$o0(t.get_$o0());i.set_$1hz(t.get_$1hz())}else i.set_$40(4);i.set_$A3(t.get_$A3());i.set_$3n(t.get_$3n());var u=n.$7dj();i.set_$1DF(!0);i.set_$EH(t.get_$EH());i.set_$1Ii(t.get_$1Ii());i.set_$rU(t.get_$rU());i.set_$1D2(t.get_$1D2());i.set_$qn(t.get_$qn());i.set_$p8(t.get_$p8());i.set_$2C7(t.get_$2C7());i.set_$7g(t.get_$7g());i.set_$2i(t.get_$2i());i.set_$QB(t.get_$QB());t.get_$EH()||t.get_$40()!==3||t.$42l()||!t.get_$E3().get_$1N()||i.set_$92(t.get_$E3().get_$1N().get_$A5d());u.$T7(i);if(!t.get_$2C7()){r.set_$xE(!0);$3Wf(n);n.set_$2Pn(!1)}}function $3Wf(n){var t=n.$17;var i=t.$3c(2);i.get_$4i().$2WQ(t.$f,!1);_js.Trace.logInfo(_a.$0.$j,"Navigated away from inline compose")}_d.$Bq.prototype={$Gk:null,$1J:null,$6F4:null,$2Pm:!1,$32i:!1,$1yc:!1,$2fv:!1,$3vw:!1,$1be:null,get_$9Rj:function(){return this.$6F4},get_$2Pn:function(){return this.$2Pm},set_$2Pn:function(n){this.$2Pm!==n&&(this.$2Pm=n);return n},get_$2Q0:function(){return this.$32i},set_$2Q0:function(n){if(this.$32i!==n){this.$32i=n;$4mH(this,n)}return n},get_$32h:function(){return this.$1yc},set_$32h:function(n){if(this.$1yc!==n){this.$1yc=n;$4mH(this,n)}return n},$59d:function(){var n=!0;var r=this.$17;var i=r.$f;var t=i.$d;var u=i.get_$1Hb();var f=i.get_$1TD();var e=t.get_$7g();var s=t.get_$40();if(this.$Gk.$if(e))_js.Trace.logInfo(_a.$0.$j,"User had chose to discard, simply navigate away.");else if(t.get_$rU()&&this.$Gk.$5JF(r,!1))_js.Trace.logInfo(_a.$0.$j,"User had navigated away on an unused response, the unused response was discarded.");else if($4mI(this))n=!1;else if(u.$LA){_js.Trace.logInfo(_a.$0.$j,"We're sending the message, can't exit yet.");n=!1}else if(u.$32c){_js.Trace.logInfo(_a.$0.$j,"We're resolving the recipients, can't exit yet.");u.$5M0();n=!1}else if(t.get_$iz()){var o=r.$3c(21);o.$EW.$n();n=!1}else{_js.Trace.logInfo(_a.$0.$j,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$F4()){this.$3vw=!1;_js.$J.get_$I().$1w(_a.$0.$j,"NavigatingAwaySaveTimeout",this.$$d_$96b,1e4);$1nd(this);if(f.$1wg("InlineExit",this.$$d_$6QP,this.$$d_$4SZ,!1)){this.set_$32h(!0);_js.Trace.logInfo(_a.$0.$j,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$7dj:function(){return new _y.$CS},$9Ri:function(){var i=this.$17;var t=i.$f;var n=t.$d;var r=n.get_$7g();var l=i.$3c(7);_js.$J.get_$I().$17w(_a.$0.$j,"MailComposePopOut");if(this.$2Pm){_js.Trace.logInfo(_a.$0.$j,"Skipped pop out because another pop out is in progress.");return}if(l.$LA){_js.Trace.logInfo(_a.$0.$j,"Skipped pop out because send is in progress.");return}if($4mI(this)||this.$Gk.$if(r)){_js.Trace.logInfo(_a.$0.$j,"Skipped pop out because attachment is currently uploading or user had discarded");return}n.set_$QB(this.$1be=_y.$2S.$1c(_a.$0.$j,"MailComposeInlinePopOut",!0));this.set_$2Pn(!0);var e=!1;try{var a=this.$17.$f.$w;a.$DG(_d.$Bq.$TE);_d.$4p.$Ek(i);var u=i.$3c(8);_js.Trace.logInfo(_a.$0.$j,"Checking dirty before popping out from inline. Context:"+n.toString());var o=t.$F4();var s=t.$d.$30P;var v=i.$3c(12);if(!n.get_$A3()||o||v.$4Va||s){this.set_$2Q0(!0);(n.get_$A3()&&!s||o||u.$x6)&&n.set_$p8(!1);_js.Trace.logInfo(_a.$0.$j,"Set WasCleanNewMessageBeforePopout = "+n.get_$p8());this.$2fv=!1;_js.$J.get_$I().$1w(_a.$0.$j,"PopoutSaveTimeout",this.$$d_$9VE,1e4);n.set_$2C7(!0);$1nd(this);t.$gj.get_$tk()[r]=new _y.$1AJ;$4mJ(this);u.$1wg("Popout",this.$$d_$9fH,this.$$d_$5MR,!1)}else{if(n.get_$1D2())n.set_$p8(!1);else if(n.get_$qn())n.set_$p8(!1);else if(u.$x6)n.set_$p8(!1);else if(n.$Vv){_js.Trace.logInfo(_a.$0.$j,"Comparing initial baseline with baseline. Context:"+n.toString());n.$Vv.$4e(n.get_$Ia())||n.set_$p8(!1)}else n.set_$p8(!1);n.set_$2C7(!1);_a.$4.$l(t.$gj,"PopoutManager");_a.$4.$l(t.$gj.get_$tk(),"PopoutManager.SaveForPopoutMap");delete t.$gj.get_$tk()[r];$4mJ(this)}var h=t.get_$24O();if(h){var c=h.get_$4i();if(c){_js.Trace.logInfo(_a.$0.$j,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");c.set_$82n(!0)}}e=!0}catch(f){_y.$2S.$1E(this.$1be,null,f.toString(),null,f.message);n.set_$QB(this.$1be=null);throw f;}finally{if(!e){this.set_$2Pn(!1);this.set_$2Q0(!1)}}},$9fH:function(n){this.set_$2Q0(!1);if(this.$2fv){_js.Trace.logInfo(_a.$0.$j,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$2S.$1E(this.$1be,null,_d.$Bq.$Ka.toString(3));this.$1be=null}else{var i=n.$59;var t=this.$17.$f;if(i in t.$gj.get_$tk()){var u=_d.$7m.$5MP(n);var r=t.$gj.get_$tk()[i];if(r.$1qh.length){var f=JsonParser.serialize(u);t.$gj.pushSaveResultToPopout(f,r.$1qh);delete t.$gj.get_$tk()[i]}else r.$i=u}if(t.$d.get_$7g()===i){_js.Trace.logInfo(_a.$0.$j,"Save succeeded for popout, navigating away from the main window.");t.set_$xE(!0);$3Wf(this);this.set_$2Pn(!1)}else _js.Trace.logInfo(_a.$0.$j,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$d.get_$7g())}},$6QP:function(n){this.$1yc&&this.set_$32h(!1);if(this.$3vw){_js.Trace.logInfo(_a.$0.$j,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$17.$f.set_$xE(!0);$3Wf(this)},$4SZ:function(n){if(this.$1yc){_js.Trace.logInfo(_a.$0.$j,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$32h(!1)}},$5MR:function(n){if(this.$2Pm){this.set_$2Pn(!1);this.set_$2Q0(!1);var u=this.$17;var t=u.$f;var i;i=n?n.$59:t.$d.get_$7g();if(i in t.$gj.get_$tk()){var r=t.$gj.get_$tk()[i];r.$1qh.length>0&&t.$gj.pushSaveResultToPopout(null,r.$1qh);delete t.$gj.get_$tk()[i]}}var f=this.$2fv?2:1;_y.$2S.$1E(this.$1be,null,_d.$Bq.$Ka.toString(f));this.$1be=null},$9VE:function(){_js.Trace.logInfo(_a.$0.$j,"Attempt to popout expired since save did not come back in time");if(this.$32i){this.$2fv=!0;this.$5MR(null);var n=this.$17;var t=n.$f.$w;$1nd(this);t.$2a(84);_d.$4p.$Ek(n)}},$96b:function(){_js.Trace.logInfo(_a.$0.$j,"Attempt to navigate away expired since save did not come back in time");if(this.$1yc){this.$3vw=!0;this.$4SZ(null);var n=this.$17;var t=n.$f.$w;$1nd(this);t.$2a(86);_d.$4p.$Ek(n)}}};_d.$Bq.$Ka=function(){};_d.$Bq.$Ka.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3};_d.$Bq.$Ka.registerEnum("_d.$Bq.$Ka",!1);_d.$90=function(n){_d.$90.initializeBase(this,[4,n])};_d.$90.$5eT=function(n){switch(n.get_$40()){case 4:return n.get_$42u();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_d.$90.prototype={get_$2ux:function(){return this.$U(_d.$90.$3s6)},set_$2ux:function(n){this.$K(_d.$90.$3s6,n);return n},get_$1kH:function(){return this.$U(_d.$90.$4U7)},set_$1kH:function(n){this.$K(_d.$90.$4U7,n);return n},get_$355:function(){return this.$U(_d.$90.$45q)},set_$355:function(n){this.$K(_d.$90.$45q,n);return n},get_$41c:function(){return this.$U(_d.$90.$41d)},set_$41c:function(n){this.$K(_d.$90.$41d,n);return n},$49:function(){var n=this.$17.$f.$d;var o=this.$17.$f.$C;var t=this.$17.$f.$5C;n.get_$1vY()?this.set_$355(new _d.$ED(n.get_$4j(),null,this.$17.$f.$5C,this.$17.$f.$C)):this.set_$355(null);if(n.get_$W0()&&n.get_$1D5()){var i=0;var r=_pc.$i.$5Ee(n.get_$3O());var u=t.$SR(r,_y.$w.$Mf,!0,i);this.set_$2ux(u);this.set_$41c(!!n.get_$8X()&&!!n.get_$8X().Mailbox&&!!n.get_$3O()&&!!n.get_$3O().Mailbox&&!_g.$2L.$4e(n.get_$3O().Mailbox,n.get_$8X().Mailbox));if(this.get_$41c()){var f=_pc.$i.$5Ee(n.get_$8X());var e=t.$SR(f,_y.$w.$Mf,!0,i);this.set_$1kH(e)}else this.get_$1kH()&&this.set_$1kH(null)}else{this.get_$2ux()&&this.set_$2ux(null);this.get_$1kH()&&this.set_$1kH(null)}_js.Trace.logInfo(_a.$0.$j,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$W0(),n.get_$1D5());_d.$Bp.prototype.$49.call(this)}};_d.$Gc=function(n){this.$$d_$3DP=Function.createDelegate(this,this.$3DP);this.$$d_$4Ge=Function.createDelegate(this,this.$4Ge);this.$$d_$7N1=Function.createDelegate(this,this.$7N1);this.$$d_$11k=Function.createDelegate(this,this.$11k);this.$$d_$2Yq=Function.createDelegate(this,this.$2Yq);this.$$d_$9og=Function.createDelegate(this,this.$9og);_d.$Gc.initializeBase(this,[10,n])};function $4mL(n,t,i){return!t&&!i?!0:i==="IsInProgress"&&!t.get_$CM()}function $3Wg(n){_js.Trace.logInfo(_a.$0.$j,"User hit OK on message options dialog, setting Sensitivity="+n.$d_2.get_$84()+"; DeliveryReceipt="+n.$d_2.get_$Fj()+"; ReadReceipt="+n.$d_2.get_$F6()+"; SmimeEncryptMessage="+n.$d_2.get_$GW()+"; SmimeSignMessage="+n.$d_2.get_$IT());n.$11k()}function $6tq(n){var i=n.$17.$f;var t=i.$vq();switch(i.$d.get_$84()){case"Personal":t.$5S(8900);break;case"Confidential":t.$5S(8901);break;case"Private":t.$5S(8902);break}_d.$4p.$Ek(n.$17)}function $4mK(n){var i=n.$17.$f;var t=i.$vq();switch(i.$d.get_$84()){case"Personal":t.$2a(8900,null);break;case"Confidential":t.$2a(8901,null);break;case"Private":t.$2a(8902,null);break}_d.$4p.$Ek(n.$17)}_d.$Gc.prototype={$29S:null,$9d:null,$UW:null,$7J:null,get_$9oh:function(){return this.$29S},set_$9oh:function(n){if(this.$29S!==n){this.$29S=n;$N(this,"ShowMessageOptionsCommand")}return n},get_$iE:function(){return this.$9d},set_$iE:function(n){if(this.$9d!==n){this.$9d=n;$N(this,"DialogViewModel")}return n},$49:function(){this.$29S||this.set_$9oh(new _C(this.$$d_$9og,this.get_$1b()));$4mK(this);_d.$Bp.prototype.$49.call(this)},$9og:function(){_js.Trace.logInfo(_a.$0.$j,"User chose to show message options");$6(this.$UW)&&(this.$UW=new _d.$kI);this.$UW.$13o(this.$d_2);if($6(this.$9d)){this.set_$iE(new _y.$Lc);this.$9d.set_$4v(_nbs.NonBootStrings.l_MessageOptions_Text);this.$7J=[new _a.$2G(new _C(this.$$d_$2Yq,this.get_$1b()),_nbs.NonBootStrings.l_Ok_LowerCase_Text,null),new _a.$2G(new _C(this.$$d_$11k,this.get_$1b()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$9d.$7J.$69(this.$7J)}this.$9d.set_$DP(this.$UW);if("TouchNarrow"===_y.$v.$v.get_$L()){var n=this.$17.$f.get_$4i();this.$UW.set_$4i(n);n.get_$8t().add_$1Z(this.$$d_$7N1)}this.$9d.set_$1O(!0)},$2Yq:function(){if(this.$9d.$8J){_js.Trace.logInfo(_a.$0.$j,"User tried to click OK button more than once.");return}var u=this.$17.$f;var n=u.$d;var t=this.$f.get_$bp();var i=t.get_$5o();if(n.get_$84()!==this.$UW.$1kJ){"Normal"!==n.get_$84()&&$6tq(this);n.set_$84(this.$UW.$1kJ);"Normal"!==n.get_$84()&&$4mK(this)}n.set_$Fj(this.$UW.$1xH);n.set_$F6(this.$UW.$1yT);if(n.get_$GW()!==this.$UW.$10C){n.set_$GW(this.$UW.$10C);$N(this,"SmimeEncryptMessage");_js.Trace.logInfo(_a.$0.$4A,"SmimeEncryptMessage option is changed to {0} by user.",this.$UW.$10C)}if(n.get_$IT()!==this.$UW.$10D){n.set_$IT(this.$UW.$10D);$N(this,"SmimeSignMessage");_js.Trace.logInfo(_a.$0.$4A,"SmimeSignMessage option is changed to {0} by user.",this.$UW.$10D)}var r=this.$UW.$10C||this.$UW.$10D;r&&u.$6XG();i&&i.set_$Pl(n.get_$Pl());if(this.$UW.$4dx&&!r&&t.get_$G9())if(t.get_$CM()){_js.Trace.logInfo(_a.$0.$4A,"Waiting to move attachments because the attachment well is currently in progress.");this.$9d.set_$6V(!0);i.add_$7q(this.$$d_$4Ge)}else this.$4Ge(null,null);else if(!this.$UW.$4dx&&r&&t.get_$G9())if(t.get_$CM()){_js.Trace.logInfo(_a.$0.$4A,"Waiting to move attachments because the attachment well is currently in progress.");this.$9d.set_$6V(!0);i.add_$7q(this.$$d_$3DP)}else this.$3DP(null,null);else $3Wg(this)},$4Ge:function(n,t){if($4mL(this,n,t)){_js.Trace.logInfo(_a.$0.$4A,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.remove_$7q(this.$$d_$4Ge);this.$9d.set_$6V(!1)}this.$f.get_$bp().get_$5o().$4Ge();$3Wg(this)}},$3DP:function(n,t){if($4mL(this,n,t)){_js.Trace.logInfo(_a.$0.$4A,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.remove_$7q(this.$$d_$3DP);this.$9d.set_$6V(!1)}this.$f.get_$bp().get_$5o().$3DP();$3Wg(this)}},$11k:function(){if(this.$9d.$8J){_js.Trace.logInfo(_a.$0.$j,"User tried to close dialog when busy.");return}var n=this.$17.$f.$d;var i=this.$f.$vq();if(n.get_$Pl()&&n.get_$UK()){_a.$4b.$32(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i.$2a(750)}else i.$5S(750);this.$f.get_$LS().$2cj.set_$5u(!n.get_$Pl());var t=this.$f.get_$bp();if(t.get_$5o()){t.get_$5o().remove_$7q(this.$$d_$4Ge);t.get_$5o().remove_$7q(this.$$d_$3DP)}"TouchNarrow"===_y.$v.$v.get_$L()&&this.$UW.$3m.get_$8t().remove_$1Z(this.$$d_$7N1);_js.Trace.logInfo(_a.$0.$j,"Close message options dialog");this.$9d.$4d.$n()},$7N1:function(n,t){_d.$Am.isInstanceOfType(this.$17.$f.get_$4i().get_$7u())?this.$9d.set_$1O(!0):this.$9d.set_$1O(!1)}};_d.$196=function(n){this.$$d_$6OJ=Function.createDelegate(this,this.$6OJ);this.$$d_$3GU=Function.createDelegate(this,this.$3GU);this.$$d_$3is=Function.createDelegate(this,this.$3is);_d.$196.initializeBase(this,[2,n]);this.$Gk=n.$f.$Gk};_d.$196.prototype={$Gk:null,$3m:null,$17g:!1,get_$4i:function(){$6(this.$3m)&&(this.$3m=new _y.$CS);return this.$3m},set_$4i:function(n){this.$3m=n;return n},$49:function(){var n=_y.$v.$v;n.remove_$Tm(this.$$d_$3is);n.add_$Tm(this.$$d_$3is);_js.Trace.logInfo(_a.$0.$j,"Before unload handler has been hooked up");"Mouse"!==n.get_$L()||n.get_$9A()||n.add_$18e(this.$$d_$3GU);_d.$Bp.prototype.$49.call(this)},$3is:function(n){this.$17.$f.$iy&&(this.$17g=!0);if(!this.$17g){_js.Trace.logInfo(_a.$0.$j,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$17.$f.$d.toString());this.$17.$f.$F4()&&n.$1Jw(_nbs.NonBootStrings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$17g=!0;_js.$J.get_$I().$1w(_a.$0.$j,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$6OJ,100)},$Au:function(){_y.$v.$v.remove_$Tm(this.$$d_$3is);_d.$Bp.prototype.$Au.call(this)},$6OJ:function(){this.$17g=!1},$3GU:function(){_y.$v.$v.remove_$18e(this.$$d_$3GU);this.$Gk.$5JF(this.$17,!0)}};_d.$197=function(n,t){this.$$d_$z3=Function.createDelegate(this,this.$z3);_d.$197.initializeBase(this,[15,n]);this.$4L8=new _C(this.$$d_$z3,this.get_$1b());this.$4L8.set_$5u(t.get_$ao().get_$3Di())};_d.$197.prototype={$4L8:null,$z3:function(){_js.Trace.logInfo(_a.$0.$j,"OpenFilePicker on PAL.");var n=this.$17.$3c(5);if(!n){_js.Trace.logError(_a.$0.$j,"Unable to open file picker, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$j,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_d.$PO.$31W(this.$17.$f)){_js.Trace.logError(_a.$0.$j,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$5o().$9Rv();_js.Trace.logInfo(_a.$0.$j,"OpenFilePicker on PAL end.")}};_d.$PO=function(n,t){this.$$d_$56h=Function.createDelegate(this,this.$56h);this.$$d_$3eI=Function.createDelegate(this,this.$3eI);_d.$PO.initializeBase(this,[15,n]);this.$19n=new _C(this.$$d_$3eI,this.get_$1b());this.$19n.set_$5u(t.get_$ao().get_$2GF());this.$19o=new _C(this.$$d_$56h,this.get_$1b());this.$19o.set_$5u(t.get_$ao().get_$2v5())};_d.$PO.$31W=function(n){var t=n.$d;if($6(t)||!t.get_$EH()){_js.Trace.logInfo(_a.$0.$j,"Show attachment not allowed dialog, Upgraded="+t.get_$EH());n.$1z.$32(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_d.$PO.prototype={$19n:null,$19o:null,$3eI:function(){_js.Trace.logInfo(_a.$0.$j,"User chose to attach from camera");var n=this.$17.$3c(5);if(!n){_js.Trace.logError(_a.$0.$j,"Unable to open camera, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$j,"Unable to open camera, attachment well ViewModel is null.");return}if(!_d.$PO.$31W(this.$17.$f)){_js.Trace.logError(_a.$0.$j,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$5o().$4L5();_js.Trace.logInfo(_a.$0.$j,"Attach from camera end")},$56h:function(){_js.Trace.logInfo(_a.$0.$j,"User chose to attach from gallery");var n=this.$17.$3c(5);if(!n){_js.Trace.logError(_a.$0.$j,"Unable to open gallery, attachment component is null.");return}if(!n.get_$5o()){_js.Trace.logError(_a.$0.$j,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_d.$PO.$31W(this.$17.$f)){_js.Trace.logError(_a.$0.$j,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$5o().$6FB();_js.Trace.logInfo(_a.$0.$j,"Attach from gallery end")}};_d.$3z=function(n){this.$$d_$7ku=Function.createDelegate(this,this.$7ku);this.$$d_$9N1=Function.createDelegate(this,this.$9N1);this.$$d_$2uq=Function.createDelegate(this,this.$2uq);this.$$d_$5OG=Function.createDelegate(this,this.$5OG);this.$$d_$2XR=Function.createDelegate(this,this.$2XR);this.$$d_$16O=Function.createDelegate(this,this.$16O);this.$$d_$5OH=Function.createDelegate(this,this.$5OH);this.$$d_$9LI=Function.createDelegate(this,this.$9LI);this.$$d_$4Kk=Function.createDelegate(this,this.$4Kk);this.$$d_$7OC=Function.createDelegate(this,this.$7OC);this.$$d_$9NX=Function.createDelegate(this,this.$9NX);this.$$d_$9gn=Function.createDelegate(this,this.$9gn);this.$$d_$7hc=Function.createDelegate(this,this.$7hc);this.$$d_$83o=Function.createDelegate(this,this.$83o);this.$$d_$9oE=Function.createDelegate(this,this.$9oE);this.$$d_$83Y=Function.createDelegate(this,this.$83Y);this.$$d_$9nT=Function.createDelegate(this,this.$9nT);_d.$3z.initializeBase(this,[1,n]);this.$Ah=this.$3kv();this.$An=this.$3kv();this.$BZ=this.$3kv();this.$3OB=new _C(this.$$d_$9nT,this.get_$1b());this.$3wN=new _C(this.$$d_$83Y,this.get_$1b());this.$2cj=new _C(this.$$d_$9oE,this.get_$1b());this.$3wU=new _C(this.$$d_$83o,this.get_$1b());this.$5I4=new _C(this.$$d_$7hc,this.get_$1b());this.$5B5=new _C(this.$$d_$9gn,this.get_$1b());this.$17I=new _C(this.$$d_$9NX,this.get_$1b());this.$1Gw=new(_0365f.$o.$$(_y.$2T));this.$2dO=new _y.$106(this.$17.$f.$6Q);$6ts(this)};_d.$3z.$9Vc=function(n,t){n.set_$4B(t)};_d.$3z.$9VQ=function(n,t){n.set_$4T(t)};_d.$3z.$9VN=function(n,t){n.set_$60(t)};_d.$3z.$9Vb=function(n,t){n.set_$bX(t)};_d.$3z.$9VP=function(n,t){n.set_$ZX(t)};_d.$3z.$9VM=function(n,t){n.set_$VQ(t)};function $6tv(n){n.$Ah.$L9?n.$Ah.$1uF():n.$5OH(!0)}function $3Wj(n,t){t.$4b?n.$1Gw.$D(t.$4b):t.$Wb&&n.$1Gw.$D(t.$Wb)}function $6ts(n){n.$Ah.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$An.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$BZ.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$Ah.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9N1);n.$An.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9N1);n.$BZ.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9N1)}function $6tw(n){n.$Ah.$u("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$An.$u("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$BZ.$u("ReadWriteRecipientWellViewModel",n.$$d_$9N1);n.$Ah.$u("ReadOnlyRecipientWellViewModel",n.$$d_$9N1);n.$An.$u("ReadOnlyRecipientWellViewModel",n.$$d_$9N1);n.$BZ.$u("ReadOnlyRecipientWellViewModel",n.$$d_$9N1)}function $6tt(n){n.$Ah.$4b&&n.$Ah.$4b.$2GJ();n.$An.$4b&&n.$An.$4b.$2GJ();n.$BZ.$4b&&n.$BZ.$4b.$2GJ()}function $4mR(n){if(n.$Ah.$4b){n.$Ah.$4b.remove_$np(n.$$d_$5OH);n.$Ah.$4b.remove_$16O(n.$$d_$16O);n.$Ah.$4b.$1T.remove_$1Z(n.$$d_$2XR)}if(n.$An.$4b){n.$An.$4b.remove_$np(n.$$d_$5OG);n.$An.$4b.remove_$16O(n.$$d_$16O);n.$An.$4b.$1T.remove_$1Z(n.$$d_$2XR)}if(n.$BZ.$4b){n.$BZ.$4b.remove_$np(n.$$d_$2uq);n.$BZ.$4b.remove_$16O(n.$$d_$16O);n.$BZ.$4b.$1T.remove_$1Z(n.$$d_$2XR)}}function $4mU(n){if(_y.$v.$v.get_$L()==="Mouse"){var i=n.$17.$3c(18);i.$A13()}else{var t=n.$17.$f.$d;var r=t.get_$mh()?n.get_$3wM():n.get_$4WD();var u=t.get_$mh()?n.get_$4WD():n.get_$3wM();var f=n.$17.$f.$3w;f.$4Qk(u,r)}}function $4mT(n,t){if("Mouse"!==_y.$v.$v.get_$L()){var e=n.$17;var f=e.$f;var r=f.$3w;if(r){var u=r.$1C;if(u)if(t.get_$2Q1()){if(!n.$1cw)for(var i=0;i<u.length;i++)if(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text===u[i].$2E){r.$2kT(n.get_$29M(),i+1);n.$1cw=!0}}else if(n.$1cw){f.$3w.$3KO(n.get_$29M());n.$1cw=!1}}}}function $2hN(n){var r=n.$17.$f.$d;var t=null;if(r.get_$UK()){var i=null;n.$XY?i=n.$XY.get_$1s().get_$1l():n.$qb&&!_js.$9.$a(n.$qb.$2s)&&(i=$3Wh(n,n.$qb.$2s));t=new _g.$BY;t.Mailbox=i;r.set_$3O(t);n.get_$30x()||n.$17.$f.$w.$5S(66)}return t}function $3Wh(n,t){var i=new _g.$1l;i.MailboxType="Mailbox";i.RoutingType="SMTP";i.EmailAddress=t;return i}function $6tu(n){var i=_d.$Jt.$26x;var t=[];(i&4)==4&&Array.add(t,new _0365m.$m(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(n.$$d_$7ku,_a.$0.$j)));(i&2)==2&&Array.add(t,new _0365m.$m(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(n.$$d_$7hc,_a.$0.$j)));$6(n.$XY.$i2)||(i&1)!=1||Array.addRange(t,n.$XY.$i2);n.$XY.set_$1YK(t)}function $4mP(n){var t=n.$17.$f.$d;var r=null;var i=_g.$V.get_$I().get_$31();r=_js.$9.$a(i.get_$ob())||_js.$9.$a(i.get_$aN())?null!==t.get_$3O()&&t.get_$3O().Mailbox?t.get_$3O().Mailbox.EmailAddress:_h.$3F.$2vb(null)||i.get_$Aj():i.get_$aN();n.$2bx(r,!1);t.set_$UK(!0);var f=$2hN(n);t.get_$Ia()&&t.get_$Ia().set_$3O(f);var u=n.$17.$3c(20);$6(u.get_$LF())&&u.$49()}function $6tr(n){var t=n.get_$13A().get_$Wh();if($6(t)||$6(t.get_$1s())||$6(t.get_$1s().get_$1l()))_js.Trace.logWarning(_a.$0.$j,"User selected from but the SelectedResultItem persona is invalid");else{var i=t.get_$1s().get_$1l().EmailAddress;_js.Trace.logInfo(_a.$0.$j,"User selected from="+i);n.$2bx(i,!0)}}function $6tx(n){if(_y.$v.$v.get_$L()==="Mouse"){var i=n.$17.$3c(18);i.$6eV()}else{var t=n.$17.$f.$d;var r=t.get_$UK()?n.get_$2y7():n.get_$29M();var u=t.get_$UK()?n.get_$29M():n.get_$2y7();var f=n.$17.$f.$3w;f.$4Qk(u,r)}}function $3Wi(n,t,i,r,u){var f=n.$L9?i.$4b:i.$Wb;if(!$6(f)){r(t,f.$77);if(_d.$32.isInstanceOfType(f)){var e=f;u(t,e.$2r.$2s)}}}function $4mS(n,t){var e=n.$17.$f.$d;var i=!1;var f=e.$2vo();if(f){var r=n.$An.$4b.$77;if(r)for(var u=0;u<r.get_$B();u++){var o=r.get_$3q(u);if(f.EmailAddress.toLowerCase()===o.EmailAddress.toLowerCase()){i=!0;break}}}if(t&&i){n.$17.$f.$w.$5S(4450);n.$17.$f.$w.$2a(4450)}else t||i||n.$17.$f.$w.$5S(4450)}function $4mQ(n,t){var i=new(_0365f.$o.$$(String));var r=this;t.$Bh(function(n){var t=n;if(_js.$9.$a(t.Name)||_js.$9.$a(t.EmailAddress))if(_js.$9.$a(t.EmailAddress))return;else i.$D(t.EmailAddress);else i.$D('"'+t.Name+'" <'+t.EmailAddress+">")});return i.get_$B()?i.get_$3T().join("; "):null}function $4mN(n,t){if(!t||!t.length)return"";for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=$4mO(n,t[i]);return r.join("; ")}function $4mO(n,t){if(t){var i=t.Name||t.OriginalDisplayName||"_";var r=(t.EmailAddress||"_")+"|"+(t.MailboxType||"_")+"|"+(t.RoutingType||"_");return i+" <"+r+">"}else return"_"}_d.$3z.prototype={$Ah:null,$An:null,$BZ:null,$3OB:null,$3wN:null,$2cj:null,$3wU:null,$5I4:null,$5B5:null,$17I:null,$4WR:null,$3wV:null,$4WC:null,$3wL:null,$XY:null,$qb:null,$3Nq:!1,$L9:!1,$40a:!1,$56L:!1,$QM:null,$2I2:null,$3wk:null,$1cw:!1,$42E:!1,$6VQ:!1,$1Gw:null,$2dO:null,add_$6Df:function(n){this.$2N("ResolveOperationSucceeded",n)},remove_$6Df:function(n){this.$2P("ResolveOperationSucceeded",n)},add_$6De:function(n){this.$2N("ResolveOperationCanceled",n)},remove_$6De:function(n){this.$2P("ResolveOperationCanceled",n)},get_$2uz:function(){return this.$XY},set_$2uz:function(n){if(this.$XY!==n){this.$XY=n;$N(this,"FromPersonaViewModel")}return n},get_$13A:function(){if(!this.$qb){var n=new _d.$2C(_pc.$14.$wX,_pc.$14.$iZ(),!0);_d.$DJ.$1YD(n);n.set_$1jW("PersonaDetailedView");n.$11N();n.set_$tx(!0);n.set_$4a6(new _C(this.$$d_$7OC,_a.$0.$j));_y.$v.$v.get_$L()!=="Mouse"&&n.set_$If(new _C(this.$$d_$7OC,_a.$0.$j));n.add_$gw(this.$$d_$4Kk);this.$qb=n}return this.$qb},get_$6VE:function(){return this.$3Nq},set_$6VE:function(n){if(this.$3Nq!==n){this.$3Nq=n;$N(this,"ShouldHighlightFromAsInvalid")}return n},get_$1ww:function(){var n=this.$17.$f.$d.get_$UK()&&(!!this.$XY&&this.$XY.get_$1ww()||!!this.$qb&&this.$qb.get_$1ww());return n||this.$Ah.get_$1ww()||this.$An.get_$1ww()||this.$BZ.get_$1ww()},get_$8Ct:function(){return this.$L9},set_$8Ct:function(n){this.$L9=n;$N(this,"IsReadWrite");return n},get_$5d0:function(){return this.$42E},set_$5d0:function(n){this.$42E=n;$N(this,"IsPeoplePickerShown");return n},get_$30x:function(){var n=this.$17.$f.$d;return!!n.get_$3O()&&!!n.get_$3O().Mailbox&&!_a.$3t.$Xv(n.get_$3O().Mailbox.EmailAddress)},get_$29M:function(){this.$4WR||(this.$4WR=new _y.$2v(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,this.$2cj));return this.$4WR},get_$2y7:function(){this.$3wV||(this.$3wV=new _y.$2v(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,this.$3wU));return this.$3wV},get_$4WD:function(){this.$4WC||(this.$4WC=new _y.$2v(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,this.$3OB));return this.$4WC},get_$3wM:function(){this.$3wL||(this.$3wL=new _y.$2v(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,this.$3wN));return this.$3wL},get_$88e:function(){return!this.$17.$f.$d.get_$iz()},get_$8Dp:function(){return!this.$17.$f.$d.get_$iz()},get_$8CZ:function(){return this.$17.$f.$d.get_$iz()},$2BW:function(){this.$Ah.$2BW();this.$An.$2BW();this.$BZ.$2BW()},$9jK:function(n){this.$3wk=n},$7So:function(n,t,i){if(this.$QM){this.$QM.remove_$1jh(this.$2I2);this.$QM.add_$1jh(i);this.$2I2=i;this.$QM.set_$6M1(t);this.$QM.$6eO(n)}else{this.$QM=this.$17.$f.$1T0.$5FN(n,t);this.$QM.add_$1jh(i);this.$QM.add_$6IG(this.$$d_$9LI);this.$2I2=i}this.set_$5d0(!0);this.$17.$f.$C.$7X(this.$QM)},$7OH:function(){if(this.$Ah.$4b){this.$Ah.$4b.remove_$np(this.$$d_$5OH);this.$Ah.$4b.remove_$16O(this.$$d_$16O);this.$Ah.$4b.$1T.remove_$1Z(this.$$d_$2XR);this.$Ah.$4b.add_$np(this.$$d_$5OH);this.$Ah.$4b.add_$16O(this.$$d_$16O);this.$Ah.$4b.$1T.add_$1Z(this.$$d_$2XR)}if(this.$An.$4b){this.$An.$4b.remove_$np(this.$$d_$5OG);this.$An.$4b.remove_$16O(this.$$d_$16O);this.$An.$4b.$1T.remove_$1Z(this.$$d_$2XR);this.$An.$4b.add_$np(this.$$d_$5OG);this.$An.$4b.add_$16O(this.$$d_$16O);this.$An.$4b.$1T.add_$1Z(this.$$d_$2XR)}},get_$Ym:function(){return this.$1Gw},$49:function(){var n=this.$17.$f.$d;var t=n.get_$5n();this.set_$8Ct(!t||!!t.get_$HC()||t.get_$4GR()||t.get_$Ar());if(n.get_$2dc()&&n.get_$2dc().get_$B()>0){this.$Ah.$863(n.get_$2dc(),this.$L9,_u.Strings.l_ToRecipientsLabel_Text);n.set_$2dc(null)}else this.$Ah.$49(n.get_$4B(),n.get_$bX(),this.$L9,_u.Strings.l_ToRecipientsLabel_Text);this.$An.$49(n.get_$4T(),n.get_$ZX(),this.$L9,_u.Strings.l_CcRecipientsLabel_Text);_y.$v.$v.get_$Vm()&&$4mS(this,!0);this.$7OH();var i=_g.$V.get_$I().get_$31();if(!_js.$9.$a(i.get_$ob())&&!_js.$9.$a(i.get_$aN())){var r=new _g.$BY;r.Mailbox=$3Wh(this,i.get_$aN());n.set_$3O(r)}("Mouse"===_y.$v.$v.get_$L()||n.get_$3O()||_g.$V.get_$I().get_$1I().get_$lF()||!$6(n.get_$60())&&n.get_$60().get_$B()>0||_g.$V.get_$I().get_$1I().get_$1WM())&&this.$12k();$4mT(this,n);_g.$V.get_$I().get_$1I().get_$lF()&&n.get_$Pl()&&this.$17.$f.$w.$2a(750);_d.$Bp.prototype.$49.call(this)},$Au:function(){if(this.$XY){this.$XY.$1Q();this.$XY=null}if(this.$QM){this.$QM.remove_$1jh(this.$2I2);this.$QM.remove_$6IG(this.$$d_$9LI);this.$QM.$1Q();this.$QM=null;this.$2I2=null}$4mR(this);if(this.$qb){this.$qb.remove_$gw(this.$$d_$4Kk);this.$qb.$1Q();this.$qb=null}$4mR(this);$6tw(this);this.$1Gw.$1r();this.$Ah.$1Q();this.$An.$1Q();this.$BZ.$1Q();_d.$Bp.prototype.$Au.call(this)},$2fT:function(){this.$12k();var n=this.$17.$f.$d;$2hN(this);$3Wi(this,n,this.$Ah,_d.$3z.$9Vc,_d.$3z.$9Vb);$3Wi(this,n,this.$An,_d.$3z.$9VQ,_d.$3z.$9VP);$3Wi(this,n,this.$BZ,_d.$3z.$9VN,_d.$3z.$9VM)},$2bx:function(n,t){var u=_a.$3t.$Xv(n);if(u){this.get_$13A().set_$Ac("");var f=$3Wh(this,n);var e=_pc.$i.$DQ(f);var o=this.$17.$f.$6Q.$12B;var i=o.$lx(e,4,!0,0);i.set_$AP(this.$5B5);i.set_$DJ(!0);i.$1HZ=!0;this.set_$2uz(i);$6tu(this)}else{this.get_$13A().set_$Ac(n);this.set_$2uz(null)}if(t){var r=this.$17.$f.get_$46O();r.get_$Cf()||r.$49();r.$2e1()}this.set_$6VE(!u);this.$2fT()},$1CF:function(){this.$12k();return this.$Ah.$1CF()+this.$An.$1CF()+this.$BZ.$1CF()},$7ym:function(){this.$12k();return this.$Ah.$1CF()},$7yl:function(){this.$12k();return this.$An.$1CF()},$7yk:function(){this.$12k();return this.$BZ.$1CF()},$3L4:function(n){this.$12k();$2hN(this);$6tt(this);this.$6VQ=n;$6tv(this)},$7rE:function(){var n=new(_0365f.$o.$$(String));n.$69(this.$Ah.$4b.$3sX());n.$69(this.$An.$4b.$3sX());n.$69(this.$BZ.$4b.$3sX());return n.$6Z()},$5OH:function(n){n?this.$An.$L9?this.$An.$1uF():this.$5OG(!0):this.$2uq(!1)},$5OG:function(n){n?this.$BZ.$L9?this.$BZ.$1uF():this.$2uq(!0):this.$2uq(!1)},$2uq:function(n){if(this.$6VQ)if(n){_js.Trace.logInfo(_a.$0.$j,"Force resolve completed");$eM(this,"ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$j,"Force resolve cancelled");$eM(this,"ResolveOperationCanceled")}},$1Bw:function(){this.$12k();$2hN(this);this.$Ah.$1Bw();this.$An.$1Bw();this.$BZ.$1Bw()},$12k:function(){if(!this.$56L){this.$56L=!0;var n=this.$17.$f.$d;this.$BZ.$49(n.get_$60(),n.get_$VQ(),this.$L9,_u.Strings.l_BccRecipientsLabel_Text);if(!$6(n.get_$60())&&0<n.get_$60().get_$B()||!_js.$9.$a(n.get_$VQ())||_g.$V.get_$I().get_$1I().get_$1WM()){n.set_$mh(!0);_js.Trace.logInfo(_a.$0.$j,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$6(n.get_$60())?0:n.get_$60().get_$B(),!_js.$9.$a(n.get_$VQ()),_g.$V.get_$I().get_$1I().get_$1WM())}if(this.$BZ.$4b){this.$BZ.$4b.remove_$np(this.$$d_$2uq);this.$BZ.$4b.remove_$16O(this.$$d_$16O);this.$BZ.$4b.$1T.remove_$1Z(this.$$d_$2XR);this.$BZ.$4b.add_$np(this.$$d_$2uq);this.$BZ.$4b.add_$16O(this.$$d_$16O);this.$BZ.$4b.$1T.add_$1Z(this.$$d_$2XR)}_js.Trace.logInfo(_a.$0.$j,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$3O()||!n.get_$3O().Mailbox?"<not set>":n.get_$3O().Mailbox.EmailAddress,$6(n.get_$4B())?0:n.get_$4B().get_$B(),$6(n.get_$4T())?0:n.get_$4T().get_$B(),$6(n.get_$60())?0:n.get_$60().get_$B());$4mT(this,n);if(n.get_$2Q1()&&(n.get_$3O()||_g.$V.get_$I().get_$1I().get_$lF())){$4mP(this);_js.Trace.logInfo(_a.$0.$j,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$3O()||!n.get_$3O().Mailbox?"<not set>":n.get_$3O().Mailbox.EmailAddress,_g.$V.get_$I().get_$1I().get_$lF())}else if(_g.$V.get_$I().get_$1I().get_$lF()&&!$6(n.get_$5n())&&!n.get_$5n().get_$Ar()){var t=this.$17.$f.$w;t.$5S(4525);t.$2a(4525);_d.$4p.$Ek(this.$17)}}},$35C:function(){this.$Ah.$35C();this.$An.$35C();this.$BZ.$35C()},$7wu:function(n,t,i){var r=this.$d_2.$2vo();if(!r){var u=_g.$V.get_$I().get_$31();r=new _g.$1l;r.Name=u.get_$FS();r.EmailAddress=u.get_$Aj()||u.get_$aN()}n.val='"'+r.Name+'" <'+r.EmailAddress+">";var f=this.$L9?this.$Ah.$4b.$77:this.$Ah.$Wb.$77;t.val=f.get_$B()>0?$4mQ(this,f):null;var e=this.$L9?this.$An.$4b.$77:this.$An.$Wb.$77;i.val=e.get_$B()>0?$4mQ(this,e):null},$6Oz:function(n,t,i){var a=this.$17.$f;var c=a.$d;var r;var f=c.$2vo();if(!f){var l=_g.$V.get_$I().get_$31();f=new _g.$1l;f.Name=l.get_$FS();f.EmailAddress=l.get_$Aj()||l.get_$aN();f.MailboxType="Mailbox";f.RoutingType="SMTP"}var u=new(_0365f.$o.$$(_g.$1l));u.$D(f);var s=null;var h=null;var o=null;switch(i){case 0:s=this.$L9?this.$Ah.$4b.$77:this.$Ah.$Wb.$77;h=this.$L9?this.$An.$4b.$77:this.$An.$Wb.$77;o=this.$L9?this.$BZ.$4b.$77:this.$BZ.$Wb.$77;break;case 1:s=this.$L9?this.$Ah.$4b.$77:this.$Ah.$Wb.$77;h=this.$L9?this.$An.$4b.$77:this.$An.$Wb.$77;break;case 2:case 3:o=this.$L9?this.$BZ.$4b.$77:this.$BZ.$Wb.$77;break;default:break}s&&u.$69(s.$6Z());h&&u.$69(h.$6Z());o&&(i===2?u.$D(o.get_$3q(c.$1LW)):u.$69(o.$6Z()));_js.Trace.logInfo(_a.$0.$4A,"Retrieving certs of recipients: "+$4mN(this,u.get_$3T()));r=new _h.$15M(200,u.get_$3T());var e=this,v=this,y=this;a.$k.$oj(r,function(){c.set_$2dQ(r.get_$2oD());if(r.get_$2oD()&&r.get_$2oD().length)if(r.get_$1wo()&&r.get_$1wo().length){_js.Trace.logWarning(_a.$0.$4A,r.get_$1wo().length+" recipients have no cert. Details:");for(var f=0;f<r.get_$1wo().length;f++){var o=r.get_$1wo()[f];o&&_js.Trace.logWarning(_a.$0.$4A,$4mO(e,u.get_$3q(f))+": "+$4mN(e,o))}var s=function(){e.$2dO.set_$1O(!1);e.$6Oz(n,t,i)};e.$2dO.$49(r.$1T,r.get_$1wo(),s,n,t);e.$2dO.set_$1O(!0)}else{_js.Trace.logInfo(_a.$0.$4A,"Retrieving certs completed. Count = "+r.get_$2oD().length);n()}else{_js.Trace.logWarning(_a.$0.$4A,"All recipients have no cert.");e.$3cY(_u.Strings.l_Smime_CannotEncrypt_Text,741);t()}},function(){_js.Trace.logWarning(_a.$0.$4A,"Retrieving certs failed. "+r.$1f.message);if(_a.$2H.$xP(r.$1f)){_a.$2H.$Wk(r.$1f,14);v.$1ot(r.$1f)}else{_js.Trace.logException(_a.$0.$4A,r.$1f,"GetCerts action failed.");v.$3cY(_u.Strings.l_Smime_CannotEncrypt_Text,729)}t()},function(){if(r.get_$2KB()&&r.get_$2KB().length>0){_js.Trace.logWarning(_a.$0.$4A,r.get_$2KB().length+" errors occurred in GetCerts OWS call:");for(var n=0;n<r.get_$2KB().length;n++)_js.Trace.logError(_a.$0.$4A,"#"+n+": "+r.get_$2KB()[n])}})},$9gn:function(){if(this.$XY){_js.Trace.logInfo(_a.$0.$j,"User selected from persona");this.$XY.set_$2O(!0);this.$3wk&&this.$3wk()}else _js.Trace.logInfo(_a.$0.$j,"User tries to select from persona, but it is null")},$9NX:function(){this.$3L4(!1)},$7hc:function(){_js.Trace.logInfo(_a.$0.$j,"User chose to delete from persona");this.set_$2uz(null);this.get_$13A().set_$HW(!0)},$7OC:function(){this.$2bx(this.get_$13A().$2s,!0)},$4Kk:function(n,t){$6tr(this)},$3kv:function(){return new _d.$Jt(this.$17.$f.$6Q,this)},$9N1:function(n,t){this.$1Gw.$1r();$3Wj(this,this.$Ah);$3Wj(this,this.$An);$3Wj(this,this.$BZ)},$2XR:function(n,t){this.$Ah.get_$mU()||this.$An.get_$mU()||this.$BZ.get_$mU()||this.$17.$f.$w.$5S(65);this.$Ah.get_$CL()&&this.$An.get_$CL()&&this.$BZ.get_$CL()||this.$17.$f.$w.$5S(70);_y.$v.$v.get_$Vm()&&$4mS(this,!1);if(t&&t.$2v===2){var i=this.$17.$f.get_$46O();i.get_$Cf()||i.$49();i.$6N8();if(_a.$5t.$2t){var r=this;_js.$J.get_$I().$3r(_a.$0.$IL,"TriggerPolicyTipsIfNeeded",function(){if(r.$17&&r.$17.$f){var n=r.$17.$f.get_$6Iq();n.$1IX(1)}})}}},$9LI:function(){this.set_$5d0(!1)},$16O:function(){_d.$4p.$Ek(this.$17)},$9nT:function(){_a.$6.stPT(_a.$0.$j,"MailComposeShowBcc",3);var t=_a.$6.$1c(_a.$0.$j,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$j,"User chose to show bcc");this.$12k();var n=this.$17.$f.$d;if(!n.get_$mh()){n.set_$mh(!0);_d.$4p.$Ek(this.$17);$4mU(this)}_a.$6.$1E(t);_a.$6.endPT("MailComposeShowBcc")},$83Y:function(){_a.$6.stPT(_a.$0.$j,"MailComposeHideBcc",3);var t=_a.$6.$1c(_a.$0.$j,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$j,"User chose to hide bcc");this.$12k();var n=this.$17.$f.$d;if(n.get_$mh()){n.set_$mh(!1);_d.$4p.$Ek(this.$17);$4mU(this)}_a.$6.$1E(t);_a.$6.endPT("MailComposeHideBcc")},$7ku:function(){var n=this.$XY.get_$1s().get_$1l().EmailAddress;this.set_$2uz(null);this.get_$13A().set_$Ac(n);this.get_$13A().set_$HW(!0)},$9oE:function(){_a.$6.stPT(_a.$0.$j,"MailComposeShowFrom",3);var t=_a.$6.$1c(_a.$0.$j,"MailComposeShowFrom",!0);var n=this.$17.$f.$d;if(n.get_$UK())_js.Trace.logInfo(_a.$0.$j,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$j,"User chose to show from");this.$40a=!0;$4mP(this);_d.$4p.$Ek(this.$17);$6tx(this)}n.get_$Pl()&&this.$17.$f.$w.$2a(750);_a.$6.$1E(t);_a.$6.endPT("MailComposeShowFrom")},$83o:function(){_a.$6.stPT(_a.$0.$j,"MailComposeHideFrom",3);var t=_a.$6.$1c(_a.$0.$j,"MailComposeHideFrom",!0);var n=this.$17.$f.$d;if(n.get_$UK()){n.set_$UK(!1);this.$40a=!1;_d.$4p.$Ek(this.$17);if(_y.$v.$v.get_$L()==="Mouse"){var i=this.$17.$3c(18);i.$6eV()}else{var r=this.$17.$f.$3w;r.$4Qk(this.get_$2y7(),this.get_$29M())}}else _js.Trace.logInfo(_a.$0.$j,"Skip hide from since it is already hidden");this.$17.$f.$w.$5S(750);_a.$6.$1E(t);_a.$6.endPT("MailComposeHideFrom")}};_d.$Jt=function(n,t){this.$$d_$4KT=Function.createDelegate(this,this.$4KT);this.$$d_$5gm=Function.createDelegate(this,this.$5gm);_d.$Jt.initializeBase(this);this.$6Q=n;this.$5iY=t};_d.$Jt.prototype={$6Q:null,$4Ry:null,$4b:null,$Wb:null,$L9:!1,$5iY:null,$175:null,get_$b8:function(){return this.$4b},set_$b8:function(n){if(this.$4b!==n){this.$4b=n;$N(this,"ReadWriteRecipientWellViewModel")}return n},get_$9e5:function(){this.$4Ry||(this.$4Ry=new _C(this.$$d_$5gm,_a.$0.$dO));return this.$4Ry},get_$9Yx:function(){return this.$Wb},set_$9Yx:function(n){if(n!==this.$Wb){this.$Wb=n;$N(this,"ReadOnlyRecipientWellViewModel")}return n},get_$CL:function(){var o=this.$L9&&_y.$2T.$CL(this.$4b);if(this.$L9){var i;var n;var s="";var t="";var r="";var u="";if(this.$4b){for(var f=0;f<this.$4b.$1T.get_$B();f++){i=this.$4b.$1T.get_$3q(f);if(i){s=i.$5A.$GQ;r=r+" "+s}}for(var e=0;e<this.$4b.$77.get_$B();e++){n=this.$4b.$77.get_$3q(e);if(n){t="";_js.$9.$18(n.EmailAddress)?_js.$9.$18(n.Name)||(t=n.Name):t=n.EmailAddress;u=u+" "+t}}}_js.Trace.logInfo(_a.$0.$dW,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$175,o,r,u)}return o},get_$mU:function(){return this.$L9&&!$6(this.$4b)&&this.$4b.$1Nt},$1IY:function(){this.$L9&&this.$4b&&this.$4b.$9xW()},$863:function(n,t,i){this.$L9=t;this.$4b?this.$4b.$2Zx(null):this.set_$b8(this.$5FK(null));var r=this.$4b.$2r;r.set_$Ac("");r.$81x(n);this.$175=i},$49:function(n,t,i,r){this.$L9=i;if(i){if(this.$4b){this.$4b.$2Zx(n);var u=this.$4b.$2r;!_js.$9.$a(u.$2s)&&_js.$9.$a(t)&&u.set_$Ac(t)}else this.set_$b8(this.$5FK(n));_js.$9.$a(t)||this.$4b.$2r.set_$Ac(t);this.$175=r}else this.$Wb?this.$Wb.$2Zx(n):this.set_$9Yx(this.$7eO(n))},$1uF:function(){$6(this.$4b)||this.$4b.$1uF()},$1Bw:function(){this.$4b&&this.$4b.$1Bw()},$2BW:function(){if(!$6(this.$4b)){this.$4b.set_$2BW(!0);this.$4b.set_$2BW(!1)}},$1CF:function(){var n;n=this.$L9?$6(this.$4b)?0:_js.$9.$a(this.$4b.$2r.$2s)?this.$4b.$77.get_$B():this.$4b.$77.get_$B()+1:$6(this.$Wb)?0:this.$Wb.$77.get_$B();return n},$35C:function(){if(this.$4b){for(var u="",f="",i="",r,n,t=0,e=this.$4b.$1T.get_$B();t<e;t++){r=this.$4b.$1T.get_$3q(t);if(r&&!r.$N7){n=this.$4b.$77.get_$3q(t);if(n){f=_js.$9.$18(n.Name)?"":n.Name;u=_js.$9.$18(n.EmailAddress)?"":n.EmailAddress;var o=String.format("( {0} , {1} ),",f,u);i+=o}}}i!==""&&_js.Trace.logInfo(_a.$0.$j,"{0} Well Invalid Recipients are: {1} \n",this.$175,i)}},$4c:function(){if(!$6(this.$4b)){this.$4b.set_$4Vx(!1);this.$4b.$1Q();this.$4b=null}},$5FK:function(n){return this.$6Q.$2q1(_d.$Jt.$26x,_y.$w.$Mf,n)},$7eO:function(n){return this.$6Q.$Tu(_d.$Jt.$6Lv,_y.$w.$Mf,n,0)},$5gm:function(){if(this.$L9){_js.Trace.logInfo(_a.$0.$j,"User chose to launch rich people picker");this.$4b.$1Bw();_a.$g.$8s.$D("VM.PeoplePicker.Launched",_a.$7.get_$29());_a.$6.stPT(_a.$0.$dO,"PeoplePicker",3);_a.$6.$1c(_a.$0.$dO,"PeoplePicker");this.$5iY.$7So(this.$4b.$1T,this.$175,this.$$d_$4KT)}},$4KT:function(n){_y.$v.$v.get_$L()!=="TouchNarrow"&&this.$4b.$1T.$1r();var t=this;n.$Bh(function(n){var i=n;i.$N7?t.$4b.$1ov(i.$CA):t.$4b.$2EC(i.$CA)})}};_d.$4p=function(n){this.$$d_$4Jk=Function.createDelegate(this,this.$4Jk);this.$$d_$bB=Function.createDelegate(this,this.$bB);_d.$4p.initializeBase(this,[14,n])};_d.$4p.$Ek=function(n){var t=n.$3c(14);t&&t.$bB();var i=n.$3c(1);i&&i.$2BW()};_d.$4p.prototype={$4du:!1,get_$1jO:function(){return this.$U(_d.$4p.$4RP)},set_$1jO:function(n){this.$K(_d.$4p.$4RP,n);return n},$49:function(){var n=this.$17.$f;var t=n.$d;if(!this.$4du){_y.$v.$v.add_$kT(this.$$d_$bB);this.$4du=!0;_g.$V.get_$I().get_$5M().add_$1aJ(this.$$d_$4Jk)}this.$bB();_js.Trace.logInfo(_a.$0.$j,"Resize editor component initialized and resize editor called");_d.$Bp.prototype.$49.call(this)},$bB:function(){this.$87O()},$Au:function(){_y.$v.$v.remove_$kT(this.$$d_$bB);this.$4du=!1;_g.$V.get_$I().get_$5M().remove_$1aJ(this.$$d_$4Jk);_js.Trace.logInfo(_a.$0.$j,"Editor resize component reset");_d.$Bp.prototype.$Au.call(this)},$87O:function(){!$6(this.get_$1jO())&&this.get_$1jO().$2M&&this.get_$1jO().$n()},$4Jk:function(n,t){this.$bB()}};_d.$7m=function(n,t,i){this.$$d_$7j7=Function.createDelegate(this,this.$7j7);this.$$d_$7j8=Function.createDelegate(this,this.$7j8);this.$$d_$FK=Function.createDelegate(this,this.$FK);this.$IN={};_d.$7m.initializeBase(this,[8,n]);this.$2L=t;this.$El=new _C(this.$$d_$FK,this.get_$1b());this.$Gk=n.$f.$Gk;this.$1J=i};_d.$7m.$5MP=function(n){var t=null;_h.$4Q.isInstanceOfType(n)?t=n.$5N:_h.$4v.isInstanceOfType(n)&&(t=n.$5N);return t};function $4mY(n,t){var f=n.$17;var o=f.$f;var e=o.$d;var i=t.$59;var r=!1;if(n.$Gk.$if(i)){e.get_$7g()===i&&(n.$IN={});$2Ck(n,t);var s=_d.$7m.$5MP(t);if(s){_js.Trace.logInfo(_a.$0.$j,"Resume discard for context "+i);f.$3c(21).$3LG(i,s)}r=!0}else if(i===e.get_$7g()){if(n.$1kd){n.$1kd=!1;_js.Trace.logInfo(_a.$0.$j,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+i);n.$IN={};$2Ck(n,t);var u=null;_h.$4Q.isInstanceOfType(t)?u=t.$5N:_h.$4v.isInstanceOfType(t)&&(u=t.$5N);u&&e.set_$A3(u);var h=f.$3c(7);h.$2ba();r=!0}else if(n.$2xL){_js.Trace.logInfo(_a.$0.$j,"Saving new content per user's request. ContextId="+i);n.$3LI();r=!0}}else _js.Trace.logInfo(_a.$0.$j,"Skipping default save processing due to ContextId="+i+"; viewModelId="+o.$d.get_$7g());return r}function $4mX(n){var t="";var i=n.$IN;for(var r in i){var u={key:r,value:i[r]};t+=u.key+":"}_js.Trace.logInfo(_a.$0.$j,"ProcessorKeys:"+t)}function $6ty(n,t){var i=n.$17;var u=i.$f;var r=u.$d;var f=t.$59;var o=n.$x6;if(f===r.get_$7g()){$6tz(n,t);r.$30P=!1}$eM(n,"MailSaveSucceeded");if(f===r.get_$7g()&&o){var s=_a.$7.get_$29();var e=u.$w;e.$DG(_d.$7m.$TE);e.$2a(1001,s.$2Z(0));_d.$4p.$Ek(i)}if(_a.$5t.$2t){var h=i.$3c(25);h.$1IX(n.$x6?4:2)}$2Ck(n,t)}function $4mV(n,t){_js.Trace.logInfo(_a.$0.$j,"SaveActionFailed: Error: {0}",t.$1f.message);t.$59===n.$17.$f.$d.get_$7g()&&n.$53e(t);var i=n.$17.$f;i.$iy&&i.set_$xE(!1);$2Ck(n,t)}function $2Ck(n,t){var i=n.$17;var r=i.$f.$d;if(t.$59===r.get_$7g()){n.set_$Dw(!1);n.$x6=!1}_a.$6.endPT("MailComposeSave")}function $4mW(n,t){var i=null;_h.$4Q.isInstanceOfType(t)&&t.$5s?i=t.$5s.correlationId:_h.$4v.isInstanceOfType(t)&&t.$5s&&(i=t.$5s.correlationId);return i}function $6tz(n,t){var i=n.$17.$f.$d;i.set_$Ia(n.$3Pa);if(n.$x6){i.set_$qn(!0);n.$x6=!1;_js.Trace.logInfo(_a.$0.$j,"Explicit save recorded. ContextId="+i.get_$7g())}if(_h.$3F.isInstanceOfType(t)){var r=t;var u=r.$5N;r.$P.set_$i(u);i.set_$A3(u);i.set_$Vi(r.$P);_js.Trace.logInfo(_a.$0.$j,"Updated context from create action. Context:"+i.toString());n.$2L.$7k8(u)}else if(_h.$4v.isInstanceOfType(t)){var f=t;var e=f.$5N;f.$6i.set_$i(e);i.set_$A3(e);i.set_$Vi(f.$6i);_js.Trace.logInfo(_a.$0.$j,"Updated context from update action. Context:"+i.toString())}else if(_h.$DF.isInstanceOfType(t)){var s=t;var h=s.$5N;i.set_$A3(h);_js.Trace.logInfo(_a.$0.$j,"Updated context from create response action. Context:"+i.toString())}else if(_c.$Qc.isInstanceOfType(t)){var o=t;var c=o.meetingResponseMessageId;i.set_$A3(c);i.set_$Vi(o.$G6);_js.Trace.logInfo(_a.$0.$j,"Updated context from create meeting response message. Context:"+i.toString())}else if(_c.$aW.isInstanceOfType(t)){var l=t;var a=l.$5N;i.set_$A3(a);_js.Trace.logInfo(_a.$0.$j,"Updated context from create approval response action. Context:"+i.toString())}}_d.$7m.prototype={$Gk:null,$El:null,$1J:null,$Dv:!1,$x6:!1,$2xL:!1,$3Pa:null,$1kd:!1,$kX:null,$2L:null,get_$Dw:function(){return this.$Dv},set_$Dw:function(n){if(n!==this.$Dv){this.$Dv=n;$N(this,"IsSaving")}return n},$FK:function(){this.$4d7(null)},$4d7:function(n){var t=this.$17;var r=t.$3c(5);var u=t.$f.$1z;var i=t.$f.$d;_js.Trace.logInfo(_a.$0.$j,"SaveStart:Context:"+i.toString());$1nd(this);if(!i.get_$42v()){_js.Trace.logInfo(_a.$0.$j,"Save not supported for the current operation {0}",i.get_$40());return}if(r.get_$CM()){_js.Trace.logInfo(_a.$0.$j,"Skip save and show attachment in progress dialog");u.$32(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$x6=!0;this.$1wg("Save",n,null,!1)},$1wg:function(n,t,i,r){var f=this.$17;var e=f.$f;var u=e.$d;var a=e.$w;var o=u.get_$7g();var p=this.$17.$f.get_$bp();var v=f.$3c(7);if(v.$LA&&!r){_js.Trace.logInfo(_a.$0.$j,"Send is in progress, this "+n+" save is ignored. ContextId="+o);return!0}if(this.$Gk.$if(o)){_js.Trace.logInfo(_a.$0.$j,"User already discarded, clearing all save processors to ignore save effects. ContextId="+o);this.$IN={};return!1}var h=f.$3c(1);h.$1Bw();if(_g.$V.get_$I().get_$46x()<h.$1CF()){a.$2a(800,null);_d.$4p.$Ek(f);return!0}h.$2fT();u.$Ih.$n();this.$IN[n]=new _d.$1AK(t,i);if(!this.$Dv||r){this.$3Pa=_d.$1m.$1qZ(u);this.set_$Dw(!0)}else{this.$2xL=!this.$3Pa.$5LH(u);return!0}if(!u.get_$EH()&&!u.get_$A3()&&!u.get_$1Ii()){_js.Trace.logInfo(_a.$0.$j,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+o);return!0}_a.$6.stPT(_a.$0.$j,"MailComposeSave",5);this.$kX=_y.$2S.$1c(_a.$0.$j,"MailComposeSave",!0);_js.$J.get_$I().$17w(_a.$0.$j,"MailComposeSave");_js.Trace.logInfo(_a.$0.$j,"Started new task runner context before starting save.");var l=!0;try{if(u.get_$Pl()){_js.Trace.logInfo(_a.$0.$4A,"Saving a S/MIME message...");if(!$4ly(this))return!0}_js.Trace.logInfo(_a.$0.$aP,"Setup save action, context:"+u.toString()+"; OriParentFolderId="+(u.get_$E3()&&u.get_$E3().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(u.get_$E3().get_$28()):"null"));var s=_d.$Ak.$3jy(e,0,this.$1J);if((_h.$3F.isInstanceOfType(s)||_h.$4v.isInstanceOfType(s))&&("Attach"===n||"Popout"===n)&&u.get_$iz()){var y=s;y.$oM=new _g.$Cd(new _g.$7P("internalsubmission"))}e.$k.$oj(s,this.$$d_$7j8,this.$$d_$7j7,null);l=!1;_js.Trace.logInfo(_a.$0.$j,"Save action submitted");return!0}catch(c){_y.$2S.$1E(this.$kX,null,c.toString(),null,c.message);this.$kX=null;throw c;}finally{if(l){this.set_$Dw(!1);this.$x6=!1;_a.$6.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$j,"Save failed due to an unhandled exception before action was submitted")}}},$Au:function(){this.$Dv=!1;this.$2xL=!1;this.$x6=!1;this.$1kd=!1;this.$IN={};this.$3Pa=null;_d.$Bp.prototype.$Au.call(this)},$3LI:function(){this.$Dv=!1;this.$2xL=!1;_js.Trace.logInfo(_a.$0.$j,"ResumeSave:Context:"+this.$17.$f.$d.toString());var n=this.$IN;for(var t in n){var i={key:t,value:n[t]};var r=i.value;this.$1wg(i.key,r.$2AK,r.$2tw,!0);break}},$7tX:function(n){return this.$17.$f.$k.$3tO(n,40,50,60,700,88,89,43,57)},$53e:function(n){if("InlineExit"in this.$IN||"Popout"in this.$IN){var i=this.$17.$f;var t=i.$w;var r=this.$7tX(n);var f=new _y.$pk;var u=f.$36(r,null);t.$DG(_d.$Bq.$TE);"InlineExit"in this.$IN?t.$2a(87,u):t.$2a(85,u);r===50&&i.$1RU.$53c(t);_d.$4p.$Ek(this.$17)}else"Save"in this.$IN&&_d.$Bp.prototype.$53e.call(this,n)},$7j8:function(n){var i=this.$17;var e=i.$f;var r=e.$d;var o=i.$3c(21);var u=n.$59;_js.Trace.logInfo(_a.$0.$j,"Save action returned success, ContextId="+u+"; Context:"+r.toString());if(!$4mY(this,n)&&u===r.get_$7g()){$6ty(this,n);$4mX(this);var t=null;if("Attach"in this.$IN){if("AutoSave"in this.$IN){t=this.$IN.AutoSave;t&&t.$2AK(n)}t=this.$IN.Attach}else if("Popout"in this.$IN){t=this.$IN.Popout;var f=i.$3c(9);if(f&&f.$2fv&&"InlineExit"in this.$IN){t&&t.$2AK(n);t=this.$IN.InlineExit}}else"InlineExit"in this.$IN?t=this.$IN.InlineExit:"AutoSave"in this.$IN?t=this.$IN.AutoSave:"Save"in this.$IN&&(t=this.$IN.Save);t&&t.$2AK&&t.$2AK(n);this.$IN={}}_y.$2S.$1E(this.$kX,null,"",$4mW(this,n));this.$kX=null},$7j7:function(n){var r=this.$17.$f.$d;var u=n.$59;_js.Trace.logInfo(_a.$0.$j,"Save action returned a failure, ContextId="+u+"; Context:"+r.toString());if(!$4mY(this,n)&&u===r.get_$7g()){$4mX(this);var t=!1;var f=this.$IN;for(var e in f){var i={key:e,value:f[e]};var o=i.value;if(o.$2tw){o.$2tw(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){$4mV(this,n);t=!0}}else if(!t){$4mV(this,n);t=!0}}t||$2Ck(this,n);this.$IN={}}var s=_d.$6s.$1uo(n.$1f)||"SaveFailure_UnknownError";var h=_d.$6s.$1up(n.$1f);_y.$2S.$1E(this.$kX,null,s,$4mW(this,n),h);this.$kX=null}};_d.$Ek=function(n){_d.$Ek.initializeBase(this,[20,n])};_d.$Ek.$2pt=function(n,t){return new _0365m.$m(n,null,t,!0)};function $2hO(n,t){var i=this;return function(){_js.Trace.logInfo(_a.$0.$j,"User chose from="+t);n.$17.$f.get_$LS().$2bx(t,!0)}}_d.$Ek.prototype={get_$LF:function(){return this.$U(_d.$Ek.$1E4)},set_$LF:function(n){this.$K(_d.$Ek.$1E4,n);return n},$49:function(){if($6(this.get_$LF())){var n=this.$A5w(_0365m.$m,_d.$Ek.$2pt);n&&this.set_$LF(new _0365m.$2b(n))}_d.$Bp.prototype.$49.call(this)},$Au:function(){this.get_$LF()&&this.set_$LF(null);_d.$Bp.prototype.$Au.call(this)},$2kT:function(n,t){if(this.get_$LF()){for(var u=_d.$Ek.$2pt(n,new _C($2hO(this,n),this.get_$1b())),i=this.get_$LF().$1C,r=i.get_$B()-1;r>0;r--)if(_0365m.$9y.isInstanceOfType(i.get_$3q(r))){i.$72(r+1,u);var f=i.get_$B()-r-1;f>t&&i.$68(i.get_$B()-1);return}i.$D(new _0365m.$9y);i.$D(u)}},$A5w:function(n,t){var e=_g.$V.get_$I().get_$31().get_$3iw();var c=$6(e)?0:e.get_$B();var o=_g.$V.get_$I().get_$1I().get_$4U3();var u=$6(o)?0:o.get_$B();var l=u>0?1:0;var r=new Array(1+c+u+l);var f=0;var i=_g.$V.get_$I().get_$31().get_$Aj();r[f++]=t(i,new _C($2hO(this,i),this.get_$1b()));for(var s=0;s<c;s++){i=e.get_$3q(s).EmailAddress;r[f++]=t(i,new _C($2hO(this,i),this.get_$1b()))}if(u>0){r[f++]=new _0365m.$9y;for(var h=0;h<u;h++){i=o.get_$3q(h);r[f++]=t(i,new _C($2hO(this,i),this.get_$1b()))}}return r}};_d.$8V=function(n,t){this.$$d_$58J=Function.createDelegate(this,this.$58J);this.$$d_$9hH=Function.createDelegate(this,this.$9hH);this.$$d_$9hQ=Function.createDelegate(this,this.$9hQ);this.$$d_$6SW=Function.createDelegate(this,this.$6SW);this.$$d_$3h0=Function.createDelegate(this,this.$3h0);this.$$d_$9Mz=Function.createDelegate(this,this.$9Mz);this.$$d_$9hX=Function.createDelegate(this,this.$9hX);this.$$d_$9hf=Function.createDelegate(this,this.$9hf);_d.$8V.initializeBase(this,[7,n]);this.$GU=new _C(this.$$d_$9hf,this.get_$1b());this.$19b=new _C(this.$$d_$9hX,this.get_$1b());this.$Gk=n.$f.$Gk;this.$1J=t};function $6u3(n,t,i){var f=t.MessageXml;if(f)for(var e=Sys.Net.XMLDOM(f),u=0;u<e.firstChild.childNodes.length;u++){var r=e.firstChild.childNodes[u];if(r.nodeType===1&&_a.$3P.$Vo(r)==="Value"&&_a.$3P.$5Pf(r,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$3P.$K7(r))){i.val=48;return!0}}i.val=-1;return!1}function $4ma(n){_js.Trace.logInfo(_a.$0.$j,"User chose to send, start force resolve recipients");n.$32c=!0;var t=n.$17.$3c(1);t.$3L4(!0)}function $3Wk(n){n.$d_2.get_$GW()?n.$f.get_$LS().$6Oz(n.$$d_$58J,n.$$d_$3h0,n.$d_2.$ko):n.$58J()}function $6u1(n){var i=!0;var e=n.$17;var u=e.$f;var t=e.$3c(1);var f=e.$3c(5);var o=u.$w;var s=e.$3c(25);var r="InvalidToSend";if(n.$Gk.$if(u.$d.get_$7g())){_js.Trace.logInfo(_a.$0.$j,"User had already discarded, skipping send.");i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"User has already discarded, skipping send");n.$Hl=null}else if(t.get_$30x()){_js.Trace.logInfo(_a.$0.$j,"Not valid to send since sender's address is invalid");o.$2a(66,null);_d.$4p.$Ek(n.$17);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"Sender's address is invalid, not valid to send");n.$Hl=null}else if(!u.$d.get_$iz()&&t.$Ah.get_$CL()&&t.$An.get_$CL()&&t.$BZ.get_$CL()){_js.Trace.logInfo(_a.$0.$j,"Not valid to send since no recipients were specified");o.$2a(70,null);_d.$4p.$Ek(n.$17);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"No recipients were specified, not valid to send");n.$Hl=null}else if(t.$Ah.get_$mU()||t.$An.get_$mU()||t.$BZ.get_$mU()){_js.Trace.logInfo(_a.$0.$j,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$30x(),t.$Ah.get_$mU(),t.$An.get_$mU(),t.$BZ.get_$mU());t.$35C();o.$2a(65,null);_d.$4p.$Ek(n.$17);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"Invalid recipients are present, not valid to send");n.$Hl=null}else if(f.get_$CM()){_js.Trace.logInfo(_a.$0.$j,"Not valid to send since attachment is in progress");var h=u.$1z;h.$32(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"Attachment is in progress, not valid to send");n.$Hl=null}else if(_g.$V.get_$I().get_$46x()<t.$1CF()){o.$2a(800,null);_d.$4p.$Ek(n.$17);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"Max recipients exceeded, not valid to send");n.$Hl=null}else if(_a.$5t.$2t&&s.$8DL()){_js.Trace.logInfo(_a.$0.$j,"Not valid to send since policy violation detected");var c=u.$1z;c.$32(0,s.$7xl(),null);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"PolicyTip violation detected, not valid to send");n.$Hl=null}else if(n.$d_2.get_$UK()&&n.$d_2.get_$Pl()){_a.$4b.$32(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"User attempted to send an S/MIME message using the SendAs (From) feature");n.$Hl=null}else if(f&&f.get_$5o())try{if(n.$qW.$3vl(u.$d,f.get_$5o().get_$1N())){i=!1;_y.$2S.$1E(n.$Hl,null,r,null,"Forgotten attachment detected, not valid to send");n.$Hl=null}}catch(l){_js.Trace.logException(_a.$0.$j,l,"An exception has been caught for FAD check; keep sending",n.$qW,u.$d,f.get_$5o().get_$1N())}i&&s.$9jv();return i}function $4mb(n,t){if(!n.$d_2.get_$Pl()||_g.$V.get_$I().get_$TX().BccEncryptedEmailForking&&_g.$V.get_$I().get_$TX().BccEncryptedEmailForking!==1)return!1;n.$d_2.set_$A3(null);n.$d_2.set_$Vi(null);if(t){if(!n.$2bc)return!1;if(n.$d_2.$1LW>-1){var r=n.$d_2.get_$60().get_$3q(n.$d_2.$1LW);n.$d_2.$bs.length>0&&(n.$d_2.$bs=n.$d_2.$bs+"; ");n.$d_2.$bs=n.$d_2.$bs+r.EmailAddress}else for(var i=0;i<n.$d_2.get_$60().get_$B();i++){var u=n.$d_2.get_$60().get_$3q(i);i>0&&(n.$d_2.$bs=n.$d_2.$bs+"; ");n.$d_2.$bs=n.$d_2.$bs+u.EmailAddress}}if(n.$d_2.get_$GW()&&_g.$V.get_$I().get_$TX().BccEncryptedEmailForking!==2)if(_g.$V.get_$I().get_$TX().BccEncryptedEmailForking===1){if(n.$2bc<1&&n.$d_2.get_$60().get_$B()>0){n.$d_2.$ko=3;$3Wk(n);n.$2bc++;return!0}}else if(n.$d_2.$1LW<n.$d_2.get_$60().get_$B()-1&&n.$d_2.get_$60().get_$B()>0){n.$d_2.$ko=2;n.$d_2.$1LW++;$3Wk(n);n.$2bc++;return!0}return!1}function $4mZ(n,t){var i=null;_h.$4Q.isInstanceOfType(t)&&t.$5s?i=t.$5s.correlationId:_h.$4v.isInstanceOfType(t)&&t.$5s&&(i=t.$5s.correlationId);return i}function $6u2(n){var r=n.$f.get_$LS();var i=n.$f.get_$bp();_js.Trace.logInfo(_a.$0.$j,"Check to see if we have attachments to set permissions for");var t=i.get_$5o().$7re();if(t&&t.length>0){_js.Trace.logInfo(_a.$0.$j,"Set permissions for the recipient well users to access shared attachments");i.get_$5o().$9i9(r.$7rE(),t)}}function $6u0(n,t){if(!t)return null;var u=t.get_$3n()==="HTML"?"html":"text";var r;r=t.get_$40()===1||t.get_$40()===2||t.get_$40()===3?t.get_$EH()?"yes":"no":"na";var f=t.$47T;var i=new _a.$6U;i.$7a("BT",u);i.$7a("U",r);i.$5Z("S",f);return i.toString()}_d.$8V.prototype={$Gk:null,$19b:null,$1J:null,$GU:null,$LA:!1,$32c:!1,$qW:null,$Hl:null,$2bc:0,get_$fj:function(){return this.$LA},set_$fj:function(n){if(n!==this.$LA){this.$LA=n;$N(this,"IsSending");var t=this.$17.$f;t.set_$6ba(_nbs.NonBootStrings.l_Sending_Text);t.set_$6VT(n)}return n},$49:function(){if(!this.$qW){var t=this.$17.$f;this.$qW=t.$1uH.$5EV(t.$1z,this.$GU)}var n=this.$17.$3c(1);if(n){n.remove_$6Df(this.$$d_$9Mz);n.remove_$6De(this.$$d_$3h0);n.add_$6Df(this.$$d_$9Mz);n.add_$6De(this.$$d_$3h0)}_d.$Bp.prototype.$49.call(this)},$Au:function(){this.set_$fj(!1);_d.$Bp.prototype.$Au.call(this)},$2ba:function(){var t=this.$17;var i=t.$f;var n=i.$d;var r=t.$3c(8);if(r.$Dv){r.$1kd=!0;_js.Trace.logInfo(_a.$0.$j,"Send deferred due to in progress save.")}if(n.get_$EH()||n.get_$A3()||n.get_$1Ii()){if(!r.$1kd){var f=t.$3c(5);f.$86o();var e=this.$17.$3c(1);e.$2fT();_js.Trace.logInfo(_a.$0.$j,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$E3()&&n.get_$E3().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(n.get_$E3().get_$28()):"null"));var o=_d.$Ak.$3jy(i,1,this.$1J);_js.Trace.logInfo(_a.$0.$j,"Submitting send action");i.$k.$oj(o,this.$$d_$6SW,this.$$d_$9hQ,this.$$d_$9hH);_js.Trace.logInfo(_a.$0.$j,"Send action submitted")}}else{var u=n.get_$7g();_js.Trace.logInfo(_a.$0.$j,"Send was attempted during upgrade for context "+u+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$5M0:function(){var n=this;_js.$J.get_$I().$1w(_a.$0.$j,"ExitResolvingRecipientsMode",function(){n.$32c=!1},2e3)},$7OQ:function(n){if(n&&n.Mailbox){var i=n.Mailbox.EmailAddress;if(i!==_g.$V.get_$I().get_$31().get_$Aj()&&!_h.$3F.$2vU(n)){var r=_g.$V.get_$I().get_$1I().get_$4U3();if($6(r)||!r.$7G(i)){var t=new(_a.$W.$$(String));t.$D(i);t.$3jd(r);t.get_$B()>_d.$8V.$46y&&t.$68(t.get_$B()-1);_g.$V.get_$I().get_$1I().set_$4U3(t);_h.$2J.$Cq(_g.$V.get_$I().get_$1I().$Do,OwaApplication.$1W);var u=this.$17.$3c(20);u.$2kT(i,_d.$8V.$46y)}}}},$7tX:function(n){var t;var i=_d.$6s.$2vh(n.$1f);if(i==="ErrorSendAsDenied")t=80;else{var r,u;i==="ErrorRightsManagementPermanentException"&&(u=$6u3(this,n.$1f,r={val:t}),t=r.val,u)||(t=i==="ErrorSubmissionQuotaExceeded"?47:this.$17.$f.$k.$3tO(n,45,55,62,700,88,89,46,58))}return t},$9hf:function(){_a.$6.stPT(_a.$0.$j,"VM.MailCompose.Send",5);this.$Hl=_y.$2S.$1c(_a.$0.$j,"MailComposeSend",!0);_js.Trace.logInfo(_a.$0.$j,"SendStart:Context:"+this.$d_2.toString());$1nd(this);if(this.$d_2.get_$IT()){var n=this;var t=function(t){_y.$2S.$1E(n.$Hl,null,_js.$1g.$9a(_y.InfoBarMessageId,t));n.$Hl=null;_a.$6.endPT("VM.MailCompose.Send");n.$d_2.set_$1Hz(null);n.$3h0();t!==-1&&n.$3cY(_u.Strings.l_Smime_CannotSend_Text,t)};var i=!1;this.$d_2.get_$1Hz()||this.$d_2.set_$1Hz($6tc(this,2,13));if(this.$d_2.get_$1Hz()){var r=new _h.$jB(200,this.$d_2.get_$1Hz(),!0);var u=this,f=this;this.$17.$f.$k.$oj(r,function(){_js.Trace.logInfo(_a.$0.$4A,"Retrieving certs info completed.");i=r.get_$gq().IsValid;if(i)$4ma(u);else{_js.Trace.logWarning(_a.$0.$4A,"Retrieving certs info determined the certificate is INVALID.");t(744)}},function(){i=!1;_js.Trace.logWarning(_a.$0.$4A,"Retrieving certs info failed. "+r.$1f.message);t(743)},null)}else{t(-1);_js.Trace.logWarning(_a.$0.$4A,"The send is canceled due to unavailable cert.")}}else $4ma(this)},$3h0:function(){var i=this.$17.$f.$w;var t=this.$17.$f.get_$LS();var n=null;this.set_$fj(!1);if(t.$Ah.get_$mU()||t.$An.get_$mU()||t.$BZ.get_$mU()){i.$2a(65,null);n=_js.$1g.$9a(_y.InfoBarMessageId,65);OwaApplication.get_$XS().$9Yf(_a.$GD,new _a.$GD(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}if(t.get_$30x()){i.$2a(66,null);n=_js.$1g.$9a(_y.InfoBarMessageId,66)}_d.$4p.$Ek(this.$17);this.$5M0();if(this.$Hl){n=n||"CancelSend_UnknownError";_y.$2S.$1E(this.$Hl,null,n);this.$Hl=null}},$9Mz:function(){var n=this.$f.get_$LS();if(this.$LA){_js.Trace.logInfo(_a.$0.$j,"Skip send since another send is in progress");return}this.set_$fj(!0);this.$32c=!0;_js.$J.get_$I().$17w(_a.$0.$j,"MailComposeSend");_js.Trace.logInfo(_a.$0.$j,"Started new task runner context before starting send.");var i=!0;try{if($6u1(this))if(this.$d_2.get_$Pl()){this.$2bc=0;this.$d_2.$1LW=-1;this.$d_2.$bs="";if(this.$d_2.get_$GW())switch(_g.$V.get_$I().get_$TX().BccEncryptedEmailForking){case 0:case 1:if(n.$7ym()>0||n.$7yl()>0)this.$d_2.$ko=1;else if(n.$7yk()>0)if(_g.$V.get_$I().get_$TX().BccEncryptedEmailForking)this.$d_2.$ko=3;else{this.$d_2.$ko=2;this.$d_2.$1LW=0}break;case 2:this.$d_2.$ko=0;break;default:this.$d_2.$ko=0;break}else this.$d_2.$ko=0;_js.Trace.logInfo(_a.$0.$4A,"SmimeBccMode is set to "+this.$d_2.$ko);$3Wk(this)}else this.$2ba();else this.set_$fj(!1);i=!1}catch(t){_y.$2S.$1E(this.$Hl,null,t.toString(),null,t.message);this.$Hl=null;throw t;}finally{if(i){this.set_$fj(!1);_js.Trace.logWarning(_a.$0.$j,"Send failed due to an unhandled exception thrown before the action was submitted")}}},$58J:function(){$4ly(this)?this.$2ba():this.$3h0()},$6SW:function(n){var e=this.$17;var i=e.$f;var t=i.$d;var u=n.$59;_js.Trace.logInfo(_a.$0.$j,"Send action succeeded, ContextId="+u+"; Context:"+t.toString());$6u2(this);if(!$4mb(this,!1)){t.get_$2Q1()&&this.$7OQ(t.get_$3O());if(t.$bs&&t.$bs.length>0){var o=this.$17.$f.$w;o.$2a(742,t.$bs);_js.Trace.logInfo(_a.$0.$j,"Showing infobar message for Bcc forking failed");this.set_$fj(!1);i.$k.$4PG(n);_y.$2S.$1E(this.$Hl,null,_js.$1g.$9a(_y.InfoBarMessageId,742));this.$Hl=null}else{if(u===t.get_$7g()){t.set_$Ia(null);_js.Trace.logInfo(_a.$0.$j,"Context match, navigating away from compose at the end of send success. ContextId="+u);var s=e.$3c(2);i.set_$xE(!0);s.get_$4i().$2WQ(i,!0)}else _js.Trace.logInfo(_a.$0.$j,"Context does not match, skipping navigating away from compose.");$eM(this,"MailSendSucceeded");var f=!i.get_$bp()||!i.get_$bp().get_$5o()?null:i.get_$bp().get_$5o().$7rd();var r=$6u0(this,t);r?f&&(r=r+"|"+f):r=f;_y.$2S.$1E(this.$Hl,null,"",$4mZ(this,n),r);this.$Hl=null}OwaApplication.get_$XS().$9Yf(_a.$GD,new _a.$GD(_nbs.NonBootStrings.l_MailComposeSendComponent_AT_LiveRegion_Text))}},$9hQ:function(n){var r=this.$17.$f;var t=r.$d;var u=n.$59;_js.Trace.logInfo(_a.$0.$j,"Send action failed, ContextId="+u+"; Context:"+t.toString());if(!$4mb(this,!0)){var i=_d.$6s.$1uo(n.$1f)||"SendFailure_UnknownError";var f=_d.$6s.$1up(n.$1f);if(u===t.get_$7g()){if(t.$bs&&t.$bs.length>0){var e=this.$17.$f.$w;e.$2a(65,t.$bs)}this.set_$fj(!1);_js.Trace.logInfo(_a.$0.$j,"Context match. Showing infobar message for ResponseCode="+i);this.$53e(n)}else _js.Trace.logInfo(_a.$0.$j,"Context does not match. Skip showing infobar message for ResponseCode="+i);_y.$2S.$1E(this.$Hl,null,i,$4mZ(this,n),f);this.$Hl=null;r.$k.$4PG(n)}},$9hH:function(n){_a.$6.endPT("VM.MailCompose.Send")},$9hX:function(){this.$17.$f.get_$5Jc()&&this.$GU.$2M&&this.$GU.$n()}};_d.$198=function(n,t,i){_d.$198.initializeBase(this,[23,n]);this.$3E=t;this.$dn=i};_d.$198.prototype={$3E:null,$dn:null,$49:function(){if(!this.get_$Cf()&&this.$3E.get_$7w().get_$2dk()===2&&this.$dn.get_$9m3().get_$82w()){var n=this.$17.$3c(5);_d.$PO.$31W(this.$17.$f)&&!$6(n)&&($6(n.get_$5o())||n.get_$5o().$7OS())}_d.$Bp.prototype.$49.call(this)}};_d.$EF=function(n,t){this.$$d_$54R=Function.createDelegate(this,this.$54R);_d.$EF.initializeBase(this,[12,n]);this.$3cr=new _C(this.$$d_$54R,this.get_$1b());this.$1J=t;this.$13=_a.UserAgent.getInstance();this.$4t=_a.$7G.$E()};_d.$EF.$3uE=function(n,t){return t?n.get_$4X3():n.get_$17s()};function $6u4(n){var t=_g.$V.get_$I().get_$1I();return"Mouse"===_y.$v.$v.get_$L()?t.get_$11H():n.$13.get_$67()?n.$4t.$3x("MOWA.IsSignatureChanged")==="true"?n.$4t.$3x("MOWA.AutoAddSignature")==="true":!0:t.get_$3er()}function $4mc(n,t,i){if("Mouse"===_y.$v.$v.get_$L())return _d.$EF.$3uE(t,i);if(n.$13.get_$67()){if(n.$4t.$3x("MOWA.IsSignatureChanged")==="true")if(n.$4t.$3x("MOWA.UseDesktopSignature")==="true")return _d.$EF.$3uE(t,i);else{var r=n.$4t.$3x("MOWA.SignatureText")||"";return i?_a.$1b.$1Af(r):r}return i?_a.$1b.$1Af(_c.$Ji.$2w1(n.$13)):_c.$Ji.$2w1(n.$13)}if(t.get_$p3())return _d.$EF.$3uE(t,i);else{var u=t.get_$4X4()||"";return i?_a.$1b.$1Af(u):u}}_d.$EF.prototype={$3cr:null,$1J:null,$2dE:null,$4Va:!1,$wv:null,$13:null,$4t:null,get_$3PE:function(){return this.$2dE},set_$3PE:function(n){if(this.$2dE!==n){this.$2dE=n;$N(this,"Signature")}return n},get_$Na:function(){return this.$4Va},set_$Na:function(n){this.$4Va=n;$N(this,"ShouldAutoAddSignature");return n},$49:function(){if(this.$17.$f.$d.get_$Na()&&$6u4(this)){_a.$6.stPT(_a.$0.$j,"MailComposeAutoSig",5);var n=_a.$6.$1c(_a.$0.$j,"MailComposeAutoSig",!0);this.set_$Na(!0);this.$54R(!0);_a.$6.$1E(n);_a.$6.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$j,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_d.$Bp.prototype.$49.call(this)},$7rn:function(){var t;var n=_a.UserAgent.getInstance();t=n.$8l?this.$wv?_js.$9.$4R("{0}{0}","<P></P>"):"":n.$141||n.$L2?"<P><BR></P>":_js.$9.$4R("{0}{0}","<P><BR></P>");return t},$54R:function(n){var u=null;var f=this.$17.$f.$d;var e=_g.$V.get_$I().get_$1I();if(n)f.$30P=!0;else{_a.$6.stPT(_a.$0.$j,"MailComposeInsertSig",3);u=_a.$6.$1c(_a.$0.$j,"MailComposeInsertSig",!0)}var t=f.get_$3n()==="HTML"&&this.$1J.get_$BQ();if(t){var i=$4mc(this,e,t);if(_js.$9.$a(i))_js.Trace.logInfo(_a.$0.$j,"Skipping inserting blank signature in HTML format.");else{var l=n?this.$7rn():_d.$EF.$6Xb;var o=l+i.replace(_d.$EF.$6MO," ");_js.Trace.logInfo(_a.$0.$j,"Insert signature for mouse html OriSig="+i+"; FormattedSig="+o);this.set_$3PE(o)}}else{var r=$4mc(this,e,t);if(_js.$9.$a(r))_js.Trace.logInfo(_a.$0.$j,"Skipping inserting blank signature in text format.");else{var s="\n\n"+r;_js.Trace.logInfo(_a.$0.$j,"Insert signature for touch text OriSig="+r+"; FormattedSig="+s);this.set_$3PE(s)}}var h=!_js.$9.$a(this.$2dE);var c=!!this.$wv;h&&c?this.$wv.$n():_js.Trace.logInfo(_a.$0.$j,"Skip insert signature due to HasSignature="+h+"; HasCommand="+c);if(!n){_a.$6.$1E(u);_a.$6.endPT("MailComposeInsertSig")}}};_d.$Gd=function(n,t){this.$$d_$2MT=Function.createDelegate(this,this.$2MT);this.$$d_$6QP=Function.createDelegate(this,this.$6QP);this.$$d_$3wO=Function.createDelegate(this,this.$3wO);this.$$d_$3mt=Function.createDelegate(this,this.$3mt);this.$$d_$3Lm=Function.createDelegate(this,this.$3Lm);this.$$d_$6Vp=Function.createDelegate(this,this.$6Vp);this.$$d_$9l6=Function.createDelegate(this,this.$9l6);_d.$Gd.initializeBase(this,[11,n]);this.$4d=new _C(this.$$d_$6Vp,this.get_$1b());this.$5B=t||null};_d.$Gd.$7b4=function(n){return new _y.$2W(_y.$c.get_$2lo(),_y.$c.get_$569(),_nbs.NonBootStrings.l_AppsTouch_Text,n.$6a.$1kl)};function $4md(n){var t=n.$17.$3c(7);return t.$LA}function $6u5(n){var i=n.$17;var f=i.$f;var e=f.$d;var c=i.$3c(7);var l=i.$3c(24);var o=!!n.$5B&&n.$5B.$3u("ComposeApps");var t;var a=new _y.$2W(_y.$c.get_$1Tf(),_y.$c.get_$3N0(),_nbs.NonBootStrings.l_SendItemMobile_Text,c.$GU);var r=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_Close1_Text,n.$4d);var s=_d.$Gd.$7b4(l);var u=$6u6(n,e,i);if(u&&o){t=new Array(4);t[1]=s;t[2]=r;t[3]=u}else if(u){t=new Array(3);t[1]=r;t[2]=u}else if(o){t=new Array(3);t[1]=s;t[2]=r}else{t=new Array(2);t[1]=r}t[0]=a;_js.Trace.logInfo(_a.$0.$j,"Creating appbar. ContextId="+e.get_$7g());var h=_y.$26.$Bg(f,t,null);h.set_$2P4("TouchNarrow"===_y.$v.$v.get_$L());f.$9i6(h)}function $6u7(n){if($6(n.$vP)){_js.Trace.logInfo(_a.$0.$j,"Create close confirm dialog.");var t=new _js.$Z;t.$D(new _a.$2G(new _C(n.$$d_$3Lm,n.get_$1b()),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,_nbs.NonBootStrings.l_SaveConfirmDialogButtonDescription_Text));t.$D(new _a.$2G(new _C(n.$$d_$3mt,n.get_$1b()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$D(new _a.$2G(new _C(n.$$d_$3wO,n.get_$1b()),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$5BN(t)}}function $4me(n){var t=n.$17;t.$f.set_$xE(!0);var i=t.$3c(2);i.get_$4i().$2WQ(t.$f,!1)}function $6u6(n,t,i){if(t.get_$2Mz())return null;var r=new(_0365f.$o.$$(_y.$2v));var u=i.$3c(15);var o=i.$3c(22);if(u){u.$19n.$2M&&r.$D(new _y.$2v(_nbs.NonBootStrings.l_NewPhotoSubmenuItemText_Text,u.$19n));u.$19o.$2M&&r.$D(new _y.$2v(_nbs.NonBootStrings.l_PhotoFromGallerySubmenuItemText_Text,u.$19o))}else if(o)r.$D(new _y.$2v(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,o.$4L8));else{var h=i.$3c(5);var f=h.$7rN();if(f&&f.length>0)for(var s=f,c=s.length,e=0;e<c;++e){var l=s[e];r.$D(l)}}var a=i.$3c(12);r.$D(new _y.$2v(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,a.$3cr));return new _y.$2W(_y.$c.get_$1pL(),_y.$c.get_$7RV(),_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,r.get_$3T())}_d.$Gd.prototype={$4d:null,$vP:null,$144:!1,$5B:null,$3zF:!1,get_$5BN:function(){return this.$vP},set_$5BN:function(n){if(n!==this.$vP){this.$vP=n;$N(this,"CloseConfirmDialogButtonData")}return n},get_$1bs:function(){return this.$144},set_$1bs:function(n){if(n!==this.$144){this.$144=n;$N(this,"IsCloseConfirmDialogShown")}return n},get_$88E:function(){return this.$3zF},set_$88E:function(n){if(n!==this.$3zF){this.$3zF=n;$N(this,"IsAppBarSetup")}return n},$9l6:function(){var i=this.$17;var u=i.$f.$d;_js.Trace.logInfo(_a.$0.$j,"Setup appbar menu. Context: "+u.toString());var n=new(_0365f.$o.$$(_y.$2v));var t=i.$3c(1);_g.$V.get_$I().get_$1I().get_$1WM()?n.$D(t.get_$3wM()):n.$D(t.get_$4WD());if(u.get_$2Q1())if(_g.$V.get_$I().get_$1I().get_$lF()){n.$D(t.get_$2y7());t.$1cw=!1}else{n.$D(t.get_$29M());t.$1cw=!0}else t.$1cw=!1;n.$D(new _y.$2v(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,t.$17I));var f=i.$3c(6);n.$D(f.$bl);var r=i.$3c(3);if(r.$bl&&r.$3hJ()){n.$D(r.$bl);r.$1cI=!0}else r.$1cI=!1;var e=i.$3c(10);n.$D(new _y.$2v(_nbs.NonBootStrings.l_ShowMessageOptions_Text,e.$29S));i.$f.$3w.set_$aR(n.get_$3T());this.set_$88E(!0)},$49:function(){var n=this.$17;var t=n.$f;var i=t.$d;_js.Trace.logInfo(_a.$0.$j,"InitTouchComponent:Context:"+i.toString());if(!t.$3w){var r=n.$3c(24);$6u5(this)}n.$3c(23);_d.$Bp.prototype.$49.call(this)},$2MT:function(n,t){if(this.$17.$f.$iy)return!1;else if($3Wa(this)){this.$144||this.$6Vp();return!0}else if(this.$17.$f.$d.get_$rU()&&!$4md(this)){_js.Trace.logInfo(_a.$0.$j,"Removing unedited reply forward draft if user clicks outside the form.");this.$3mt();return!0}else{this.$17.$f.set_$xE(!0);var r=this.$17;var i=r.$3c(2);i&&i.get_$4i()&&i.get_$4i().set_$31u(!0);return!1}},$6Vp:function(){var t=this.$17;var i=t.$f;var n=i.$d;_js.Trace.logInfo(_a.$0.$j,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if($4md(this)){_js.Trace.logInfo(_a.$0.$j,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if($3Wa(this)){$6u7(this);_js.Trace.logInfo(_a.$0.$j,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$1bs(!0)}else if(n.get_$rU()){_js.Trace.logInfo(_a.$0.$j,"Removing unedited reply forward draft on close.");this.$3mt()}else{_js.Trace.logInfo(_a.$0.$j,"Navigate away due to unmodified message.");$4me(this)}},$3wO:function(){_js.Trace.logInfo(_a.$0.$j,"Hide close confirm dialog");this.set_$1bs(!1)},$3Lm:function(){_js.Trace.logInfo(_a.$0.$j,"User select save and close");var n=this.$17;n.$f.set_$xE(!0);this.$3wO();var t=n.$3c(8);t.$4d7(this.$$d_$6QP)},$6QP:function(n){$4me(this)},$3mt:function(){_js.Trace.logInfo(_a.$0.$j,"User select discard and close");var n=this.$17;n.$f.set_$xE(!0);this.$3wO();var t=n.$3c(21);t.$3nr()}};_d.$PP=function(n,t){this.$$d_$9RF=Function.createDelegate(this,this.$9RF);this.$$d_$7Vw=Function.createDelegate(this,this.$7Vw);this.$$d_$5C9=Function.createDelegate(this,this.$5C9);_d.$PP.initializeBase(this,[13,n]);this.$Gk=this.$17.$f.$Gk;this.$1J=t};function $6u8(n,t){t.$42l()&&n.$17.$f.$w.$2a(3050)}function $3Wl(n,t){t.$5S(3440);t.$2a(3440,null);_d.$4p.$Ek(n.$17)}_d.$PP.prototype={$Gk:null,$1J:null,$5gM:null,$hE:null,$7SD:function(){_a.$6.stPT(_a.$0.$j,"MailComposeUpgrade",3);this.$hE=_y.$2S.$1c(_a.$0.$j,"MailComposeUpgrade",!0);var i=this.$17.$f;var n=i.$d;var r=n.get_$7g();this.$5gM=r;if(!n.get_$EH()){var u=this;_js.$J.get_$I().$1w(_a.$0.$j,"ShowUpgradeMessage",function(){n.get_$EH()||n.get_$1Ii()||r!==u.$5gM||$3Wl(u,i.$w)},5e3);var f;f=this.$1J.get_$BQ()||n.get_$3n()!=="HTML"?n.get_$3n()==="Text"?_h.$15.get_$35R():_h.$15.get_$206():_h.$15.get_$8HW();var t=_d.$Ak.$7eU(n,f,this.$1J);n.get_$40()===12&&(t.$oM=new _g.$Cd(new _g.$7P("internalsubmission")));t.add_$4Rk(this.$$d_$5C9);_js.Trace.logInfo(_a.$0.$aP,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$E3()&&n.get_$E3().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(n.get_$E3().get_$28()):"null"));t.$Eo="MailComposeUpgrade";i.$k.$oj(t,this.$$d_$7Vw,this.$$d_$9RF,null)}},$7Vw:function(n){var s=this.$17;var e=s.$f;var i=e.$d;var t=n;var c=s.$3c(21);var u=t.$5N;var r=n.$59;var o=t.$5s?t.$5s.correlationId:null;var l=!!t.$E6;if(this.$Gk.$if(r)){_js.Trace.logInfo(_a.$0.$aP,"Check upgrade callback, resume discard for context "+r);c.$3LG(r,u)}else if(r===i.get_$7g()){i.set_$A3(u);_js.Trace.logInfo(_a.$0.$aP,"Context match, updated the draft id. Context:"+i.toString()+"; ResponseMessageBodyType="+(l&&t.$E6.get_$3C()?t.$E6.get_$3C().get_$3n():"null"));var f=e.get_$1TD();var h=e.get_$1Hb();if(!f.$Dv&&h.$LA){_js.Trace.logInfo(_a.$0.$aP,"Skipping upgrade for contextId "+r+" since send was triggered during upgrade");_y.$2S.$1E(this.$hE,null,"SkipUpgrade",o,"Skip upgrade since send is in progress");this.$hE=null;_a.$6.endPT("MailComposeUpgrade");h.$2ba();return}if(f.$Dv&&f.$1kd){_js.Trace.logInfo(_a.$0.$aP,"Skipping upgrade for contextId "+r+" since save and then send was triggered during upgrade");_y.$2S.$1E(this.$hE,null,"SkipUpgrade",o,"SkipUpgrade since saving is in progress");this.$hE=null;_a.$6.endPT("MailComposeUpgrade");f.$3LI();return}}if(t.$E6){_js.Trace.logInfo(_a.$0.$aP,"Check upgrade, action has response message, call complete upgrade. context: "+i.toString()+"; ActionItemId="+_h.$Dn.$wZ(u));this.$5C9(n)}else if(n.$59===i.get_$7g()){_js.Trace.logInfo(_a.$0.$aP,"Check upgrade: action has id only, updated draft id. context: "+i.toString()+"; ActionItemId="+_h.$Dn.$wZ(u));_y.$2S.$1E(this.$hE,null,"",o);this.$hE=null}},$5C9:function(n){var h=this.$17;var r=h.$f;var t=r.$d;var i=n;var c=i.$5s?i.$5s.correlationId:null;var u=n.$59;i.remove_$4Rk(this.$$d_$5C9);if(u===t.get_$7g()){var f=!1;if(this.$1J.get_$BQ()){if(t.get_$Ia()){t.$Ih.$n();t.get_$Cu()===t.get_$Ia().get_$Cu()&&(f=!0)}else t.$4HF=!0;t.$30P=!0}if(this.$1J.get_$BQ()||t.get_$3n()!=="HTML"){var e=i.$E6.get_$3C().get_$1g();t.set_$1Gk(!this.$1J.get_$BQ()&&t.get_$3n()==="Text"?_a.$1b.$7aP(e):e)}else t.set_$1Gk(i.$E6.get_$Ir().get_$1g());if(f){t.$Ih.$n();t.get_$Ia().set_$Cu(t.get_$Cu());var l=t.$Vv;l&&t.$Vv.set_$Cu(t.get_$Cu())}t.set_$Vi(i.$E6);t.$9za(i.$E6.get_$6U());i.$E6.get_$1N()&&t.set_$92(i.$E6.get_$1N().get_$A5d());var a=r.get_$bp();a.$6eh();t.set_$EH(!0);r.$w.$5S(3440);$6u8(this,t);_d.$4p.$Ek(this.$17);_js.Trace.logInfo(_a.$0.$aP,"Complete upgrade context:"+t.toString());var o=r.get_$1TD();if(o.$Dv)o.$3LI();else if(_a.$5t.$2t){var s=this.$17.$3c(25);var v=this;_js.$J.get_$I().$3r(_a.$0.$j,"TriggerPolicyTipsIfNeeded",function(){s&&s.$1IX(32)})}r.$M.$9Yf(_d.$qI,new _d.$qI(t.get_$Vi().get_$i().Id,r))}else _js.Trace.logInfo(_a.$0.$aP,"MailComposeUpgrade failed since user switched view model context. ContextId="+u+"; Context="+t.toString());_y.$2S.$1E(this.$hE,null,"",c);this.$hE=null;_a.$6.endPT("MailComposeUpgrade")},$9RF:function(n){var o=this.$17;var i=o.$f;var r=i.$d;var c=o.$3c(21);var u=n;var f=u.$5s?u.$5s.correlationId:null;var t=n.$59;if(this.$Gk.$if(t)){_js.Trace.logInfo(_a.$0.$aP,"Resume discard for context "+t);c.$3LG(t,u.$5N)}else if(t===r.get_$7g()){r.set_$1Ii(!0);var e=i.get_$1TD();var s=i.get_$1Hb();if(e.$Dv){if(e.$1kd){_js.Trace.logInfo(_a.$0.$aP,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");_y.$2S.$1E(this.$hE,null,"SkipUpgrade",f,"Skip upgrade since saving is in progress");this.$hE=null;_a.$6.endPT("MailComposeUpgrade");e.$3LI();return}$3Wl(this,i.$w)}else if(s.$LA){_js.Trace.logInfo(_a.$0.$aP,"Skipping upgrade for context "+t+" since send was triggered during upgrade");_y.$2S.$1E(this.$hE,null,"SkipUpgrade",f,"Skip upgrade since send is in progress");this.$hE=null;_a.$6.endPT("MailComposeUpgrade");s.$2ba();return}else $3Wl(this,i.$w)}var l=_d.$6s.$1uo(n.$1f)||"UpgradeFailure_UnknownError";var h=_d.$6s.$1up(n.$1f);_js.Trace.logWarning(_a.$0.$aP,String.format("Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r.toString(),h));_y.$2S.$1E(this.$hE,null,l,f,h);this.$hE=null;_a.$6.endPT("MailComposeUpgrade")}};_d.$195=function(n,t,i,r,u){this.$$d_$9JC=Function.createDelegate(this,this.$9JC);this.$$d_$9ws=Function.createDelegate(this,this.$9ws);_d.$195.initializeBase(this,[19,n]);this.$w=r;this.$2Rs=new _d.$46(t,i,n.$f.$w,u);this.$2Rs.set_$4K4(this.$$d_$9JC)};_d.$195.prototype={$w:null,$2Rs:null,$9JC:function(){_d.$4p.$Ek(this.$17)},$49:function(){this.$2Rs.$49();_d.$Bp.prototype.$49.call(this)},$2e1:function(){_js.Trace.logInfo(_a.$0.$j,"Prepares to submit mailtips action");this.$2Rs.$2e1()},$9ws:function(){var t=this.$17;var i=t.$f;var n=i.$d;if(n.get_$2Pu()){this.$w.$5S(4400);this.$w.$2a(4400);_d.$4p.$Ek(this.$17)}if(n.get_$40()&&n.get_$40()!==3&&n.get_$40()!==11){this.get_$Cf()||this.$49();this.$2e1()}},$6N8:function(){this.$2Rs.$6N8()}};_d.$dZ=function(n,t,i){this.$$d_$6DI=Function.createDelegate(this,this.$6DI);this.$$d_$6DH=Function.createDelegate(this,this.$6DH);this.$$d_$6DF=Function.createDelegate(this,this.$6DF);this.$$d_$9M4=Function.createDelegate(this,this.$9M4);_d.$dZ.initializeBase(this,[25,n]);if(_a.$5t.$2t){this.$w=i;this.$WW=new _d.$3U(t,this.$17.$3c(1),this.$17.$3c(5),n.$f.$w,this.$17.$f.$C);this.$WW.set_$4KU(this.$$d_$9M4);this.$WW.set_$3G2(this.$$d_$6DF);this.$WW.set_$3G1(this.$$d_$6DH);this.$WW.set_$6DJ(this.$$d_$6DI)}};function $4mM(n){n.get_$Cf()||n.$49();return n.$WW?n.$WW.$2vI():0}_d.$dZ.prototype={$1dF:null,$w:null,$WW:null,$49:function(){if(!_a.$5t.$2t){_d.$Bp.prototype.$49.call(this);return}this.$WW.$49();_d.$Bp.prototype.$49.call(this)},$4c:function(){this.$1dF&&(this.$1dF=_js.$J.get_$I().$4z(this.$1dF));_js.$8.prototype.$4c.call(this)},$8DL:function(){if(!_a.$5t.$2t)return!1;switch($4mM(this)){case 1:return!1;case 2:case 3:return $6(this.$17.$f.$d.get_$Vg())&&$6(this.$17.$f.$d.get_$Tw());case 4:case 5:return $6(this.$17.$f.$d.get_$Tw());default:return!1}},$7xl:function(){if(!_a.$5t.$2t)return"";switch($4mM(this)){case 2:case 3:return _nbs.NonBootStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _nbs.NonBootStrings.l_PolicyTipsBlockSend_Text;default:return""}},$9jv:function(){if(_a.$5t.$2t){this.$WW.$5kh=!0;if(!$6(this.$17.$f.$d.get_$Vg())){var n=_a.$6.$1c(_a.$0.$IL,"DlpPolicyTipOverridden",!0);_a.$6.$1E(n,"DlpPolicyTipOverridden","",null)}}},$1IX:function(n){if(_a.$5t.$2t){var r=this.$17;var u=r.$f;var i=u.$d;this.get_$Cf()||this.$49();this.$1dF&&(this.$1dF=_js.$J.get_$I().$4z(this.$1dF));var t=i.get_$A3();if(t){_bc.$Bd.$1x6(t)&&(t=_g.$1U.$v.$qi(t));if(_bc.$Bd.$1x6(t)){var f=this;this.$1dF=_js.$J.get_$I().$1w(_a.$0.$IL,"TriggerPolicyTipsIfNeeded",function(){f.$1IX(n)},5e3)}else this.$2e2(i,n)}}},$2e2:function(n,t){_js.Trace.logInfo(_a.$0.$j,"Prepares to submit policyTips action");var r;var u;if(n.get_$Ia()){r=_a.$3N.$1ub(n.get_$Ia().get_$2i());u=_a.$3N.$1ub(n.get_$Ia().get_$Cu())}else{r=_a.$3N.$1ub(n.get_$2i());u=_a.$3N.$1ub(n.get_$Cu())}var i=n.get_$A3();_bc.$Bd.$1x6(i)&&(i=_g.$1U.$v.$qi(i));this.$WW.$2e2(i,n.get_$92(),r,u,t)},$9M4:function(){_d.$4p.$Ek(this.$17)},$6DF:function(n){var t=this.$17;var i=t.$f;var r=i.$d;r.set_$Vg(n)},$6DH:function(n){var t=this.$17;var i=t.$f;var r=i.$d;r.set_$Tw(n)},$6DI:function(){this.$1IX(64)}};_d.$EE=function(n,t){this.$$d_$68d=Function.createDelegate(this,this.$68d);this.$$d_$68f=Function.createDelegate(this,this.$68f);this.$$d_$7Xf=Function.createDelegate(this,this.$7Xf);this.$$d_$7pJ=Function.createDelegate(this,this.$7pJ);this.$$d_$563=Function.createDelegate(this,this.$563);_d.$EE.initializeBase(this,[24,n]);this.$1vD=!1;this.$6a=t.$5F3(this,this.$$d_$563)};function $2hL(n,t){var i=n.$17.$3c(27);i.set_$JO(t)}function $4mE(n,t,i,r){var u=$4mD(n,t);r&&u.$Au();var e=i.get_$B();if(e+u.$1T.get_$B()>100)return!1;t===2&&n.$17.$f.get_$LS().$3OB.$n();for(var f=0;f<e;f++){var o=i.get_$3q(f);u.$2EF(o)}return!0}function $6tn(n){var t=n.$17.$3c(14);t&&t.$bB()}function $4mD(n,t){var i=n.$17.$f.get_$LS();return t?t===1?i.$An.$4b:t===2?i.$BZ.$4b:null:i.$Ah.$4b}function $6to(n){var t=n.$17.$3c(3);n.$6a.set_$5OE(t.$1O8);t.$1O8&&n.$6a.$1vn(!1)}_d.$EE.prototype={$1vD:!1,$6a:null,$49:function(){if(!this.get_$Cf()){var n=this.$17.$3c(3);this.$6a.set_$5OE(n.$1O8);var t=this.$17.$f.$M;t.$IU(_a.$WS,this.$$d_$7pJ);this.$6a.$5j();n.$Y("IsIrmProtected",this.$$d_$7Xf);this.$6a.add_$24s(this.$$d_$68f);this.$6a.add_$3F3(this.$$d_$68d)}_d.$Bp.prototype.$49.call(this)},$Au:function(){if(this.get_$Cf()){var n=this.$17.$3c(3);n.$u("IsIrmProtected",this.$$d_$7Xf);this.$6a.remove_$24s(this.$$d_$68f);this.$6a.remove_$3F3(this.$$d_$68d);this.$6a.$7H();var t=this.$17.$f.$M;t.$18g(_a.$WS,this.$$d_$7pJ)}_d.$Bp.prototype.$Au.call(this)},$2vN:function(){return _y.$v.$v.get_$L()==="Mouse"?this.$17.$f.$d.get_$3n():this.$17.$f.$d.get_$BQ()?"HTML":"Text"},$13P:function(){return this.$17.$f.$d.get_$2i()},$9kn:function(n){this.$17.$f.$d.set_$2i(n)},$7wt:function(n){var t=$4mD(this,n);return t.$1T},$9wy:function(n,t){return $4mE(this,n,t,!1)},$9kQ:function(n,t){$4mE(this,n,t,!0)},$53q:function(n,t){t.val=0;if(!this.$17.$f.$d.get_$EH()){_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$17.$3c(5);var u=_y.$AT.$3kD(n);if(r.get_$5o()){var i=new(_0365f.$o.$$(_y.$jM));r.get_$5o().$1op(u,i);if(!i.get_$B()){_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$3q(0)}else{_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - max number exceeded.");t.val=9001;return null}},$53h:function(n,t,i){i.val=0;if(!this.$17.$f.$d.get_$EH()){_js.Trace.logInfo(_a.$0.$5d,"Attachment not added - well not upgraded.");i.val=9005;return null}var u=this.$17.$3c(5);var r=u.get_$5o();if(r){var f=new _d.$10q(n,t);return r.$53i(f)}_js.Trace.logError(_a.$0.$5d,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},$3ss:function(){return this.$17.$f.$d.get_$3S()?this.$17.$f.$d.get_$3S().Id:null},$86k:function(n){var t=new _d.$pn(n,!0);$2hL(this,t)},$9W5:function(n){var t=new _d.$re(n);$2hL(this,t)},$68f:function(){if(_y.$v.$v.get_$L()==="TouchWide"&&this.$6a.get_$mm()){var n=this.$17.$f;n.set_$1iT(6)}},$68d:function(){var n=this.$17.$f;n.set_$1iT(4)},$2Ll:function(){return this.$17.$f.$d.get_$A3()?this.$17.$f.$d.get_$A3().Id:null},$3t5:function(){this.$17.$f.$d.get_$U1()||this.$17.$f.$d.set_$U1(new _js.$Z);return this.$17.$f.$d.get_$U1()},$8IS:function(){},$9sA:function(){var n=new _y.$a8(null);$2hL(this,n)},$7Vb:function(n){var t=new _y.$a8(n);$2hL(this,t)},$7pJ:function(n){if(this.$1vD){this.$1vD=!1;this.$6a.$1vn(!1)}},$563:function(n){if(n===1){var t=window.document.body.clientWidth;if(t<1367){var i=this.$17.$f.$M;i.$9Yf(_a.$dW,new _a.$dW(!0));this.$1vD=!0}}else if(n===2&&this.$1vD){var r=this.$17.$f.$M;r.$9Yf(_a.$dW,new _a.$dW(!1));this.$1vD=!1}$6tn(this)},$7Xf:function(n,t){t==="IsIrmProtected"&&$6to(this)}};_d.$Gq=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$846=Function.createDelegate(this,this.$846);this.$$d_$4KO=Function.createDelegate(this,this.$4KO);this.$$d_$9Qx=Function.createDelegate(this,this.$9Qx);this.$$d_$9Kz=Function.createDelegate(this,this.$9Kz);this.$$d_$9Dq=Function.createDelegate(this,this.$9Dq);this.$$d_$9Js=Function.createDelegate(this,this.$9Js);this.$$d_$9Ev=Function.createDelegate(this,this.$9Ev);this.$$d_$6Bn=Function.createDelegate(this,this.$6Bn);this.$$d_$69J=Function.createDelegate(this,this.$69J);this.$$d_$2XR=Function.createDelegate(this,this.$2XR);this.$2ml=_nbs.NonBootStrings.l_PolicyTipsBlock_Text;this.$3EY=_u.Strings.l_PolicyTipsNotify_Text;this.$3HB=_nbs.NonBootStrings.l_PolicyTipsOverride_Text;_d.$Gq.initializeBase(this,[n,o,5]);this.$eP=t;this.$C=h;this.$1T=i;this.$1T.add_$1Z(this.$$d_$2XR);this.$pj=r;this.$pj.add_$1Z(this.$$d_$69J);this.$6NJ=u;this.$25j=f;this.$27P=e;this.$Rj=new _d.$ky(this.$C,this.$$d_$6Bn,this.$$d_$9Ev,r);this.$1ZA=new _d.$ky(this.$C,this.$$d_$6Bn,this.$$d_$9Ev,r);this.$65u=new _C(this.$$d_$9Js,_a.$0.$IL);this.$5IP=new _C(this.$$d_$9Dq,_a.$0.$IL);this.$2Xy=new _C(this.$$d_$9Kz,_a.$0.$IL);this.$6d0=s;this.$6d2=new _C(this.$$d_$9Qx,_a.$0.$IL);this.$147=!1;this.set_$1Og(!0);this.$6eA();this.$C.get_$L()==="TouchNarrow"?$3XF(this):this.$4Ny=new _d.$kx(this.$$d_$4KO,this.$$d_$9Ev)};function $6wQ(n){for(var i="",t=0;t<n.$1T.get_$B();t++){i+=n.$1T.get_$3q(t).get_$1o()||n.$1T.get_$3q(t).get_$ZL();t<n.$1T.get_$B()-1&&(i+=_nbs.NonBootStrings.l_MessageNameSeparator_Text)}return i}function $6wP(n){return n.$1T.get_$B()===1?_nbs.NonBootStrings.l_PolicyTipsRecipientInfo_Text:_nbs.NonBootStrings.l_PolicyTipsRecipientsInfo_Text}function $3XF(n){_js.Trace.logInfo(_a.$0.$IL,"Create policy tips more info dialog.");var t=new _js.$Z;n.$1Kz&&t.$D(new _a.$2G(new _C(n.$$d_$6Bn,_a.$0.$IL),_nbs.NonBootStrings.l_PolicyTipsDialogLearnMoreButtonCaption_Text,_nbs.NonBootStrings.l_PolicyTipsDialogLearnMoreButtonDescription_Text));n.$fi||t.$D(new _a.$2G(new _C(n.$$d_$9Ev,_a.$0.$IL),_nbs.NonBootStrings.l_PolicyTipsDialogReportButtonCaption_Text,_nbs.NonBootStrings.l_PolicyTipsDialogReportButtonDescription_Text));t.$D(new _a.$2G(new _C(n.$$d_$846,_a.$0.$IL),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_PolicyTipsDialogCancelButtonDescription_Text));n.set_$95u(t)}_d.$Gq.prototype={$65u:null,$5IP:null,$2Xy:null,$6d2:null,$C:null,$1T:null,$6d0:null,$31p:!1,$3DM:null,$Rj:null,$1ZA:null,$1Sc:null,$6NJ:null,$1DB:!1,$fi:!1,$25j:null,$27P:null,$31q:!1,$329:!1,$eP:0,$6G7:null,$4Ny:null,$1Kz:null,$pj:null,$el:null,get_$7SV:function(){return this.$2ml},set_$7SV:function(n){this.$2ml=n;this.$6eA();return n},get_$97t:function(){return this.$3EY},set_$97t:function(n){this.$3EY=n;this.$6eA();return n},get_$9Sd:function(){return this.$3HB},set_$9Sd:function(n){this.$3HB=n;this.$6eA();return n},get_$7Mx:function(){return this.$eP},set_$7Mx:function(n){if(this.$eP!==n){this.$eP=n;this.$6eA()}return n},get_$328:function(){return this.$1DB},set_$328:function(n){if(this.$1DB!==n){this.$1DB=n;this.$25j&&this.$25j(this.$1DB?this.$6G7:null)}return n},get_$2Pv:function(){return this.$fi},set_$2Pv:function(n){if(this.$fi!==n){this.$fi=n;this.$Rj.set_$2Pv(n);this.$1ZA.set_$2Pv(n);this.$C.get_$L()==="TouchNarrow"&&$3XF(this);this.$27P&&this.$27P(this.$fi?"":null);$3(this,"IsReportedFalsePositive")}return n},get_$8Bd:function(){return this.$31q},set_$8Bd:function(n){if(this.$31q!==n){this.$31q=n;$3(this,"IsMoreInfoLinkHidden")}return n},get_$88i:function(){return this.$C.get_$L()!=="TouchNarrow"},get_$8CE:function(){return this.$329},set_$8CE:function(n){if(this.$329!==n){this.$329=n;$3(this,"IsOverrideLinkHidden")}return n},get_$PI:function(){return this.$el},set_$PI:function(n){if(this.$el!==n){this.$el=n;$3(this,"ClassificationDescription")}return n},$69J:function(n,t){for(var r="",i=0;i<this.$pj.get_$B();i++){var u=this.$pj.get_$3q(i);r+=String.format("{0}<br>",u)}this.set_$PI(r)},get_$1cx:function(){return _d.$13v.prototype.get_$1cx.call(this)},set_$1cx:function(n){_d.$13v.prototype.set_$1cx.call(this,this.$1DB||this.$fi||n);return n},$9iP:function(n){this.$1Kz=n;this.$Rj.set_$5CB(n);this.$1ZA.set_$5CB(n);this.$6eA();$3XF(this)},$4c:function(){this.$1T&&this.$1T.remove_$1Z(this.$$d_$2XR);this.$pj&&this.$pj.remove_$1Z(this.$$d_$69J);_a.$1.prototype.$4c.call(this)},$89E:function(){return(!!this.$1T&&this.$1T.get_$B()>0&&this.$eP!==1||this.$eP===2||this.$eP===3||this.$C.get_$L()==="TouchNarrow")&&!this.$1DB&&!this.$fi},$6eA:function(){_d.$13v.prototype.$6eA.call(this);this.set_$8Bd(!this.get_$1cx()||this.$C.get_$L()==="TouchNarrow"&&this.$fi&&!this.$1Kz);this.set_$8CE(this.get_$1cx()||this.$eP===1||this.$eP===4||this.$eP===5);if(this.$1Sc&&this.$eP===1){this.$P6.$34(this.$1Sc);this.$1Sc=null}$6C(this,"MessageUpdated")},$7qT:function(){},$7qc:function(){if(this.$1DB||this.$fi)this.$fi?this.set_$ro(_nbs.NonBootStrings.l_PolicyTipsFalsePositive_Text):this.$1DB&&this.set_$ro(this.$3HB);else switch(this.$eP){case 1:this.set_$ro(this.$3EY);break;case 2:case 3:case 4:case 5:this.set_$ro(this.$2ml);break}},$9Js:function(){this.$C.get_$L()==="TouchNarrow"?this.set_$2PX(!0):this.$Rj.set_$1O(!this.$Rj.$2y)},$9Dq:function(){this.$C.get_$L()==="TouchNarrow"?this.set_$2PX(!0):this.$1ZA.set_$1O(!this.$1ZA.$2y)},$9Kz:function(){this.$eP===2||this.$C.get_$L()==="TouchNarrow"?this.$4KO(""):this.$4Ny.set_$1O(!0)},$4KO:function(n){this.$6G7=n;this.set_$328(!0);this.set_$HV(!0);this.$6eA()},$9Qx:function(){this.set_$2Pv(!1);this.$6eA();this.$6d0()},$9Ev:function(){this.$Rj.set_$1O(!1);this.$1ZA.set_$1O(!1);this.set_$2PX(!1);this.set_$2Pv(!0);this.set_$HV(!0);this.$6eA()},$2XR:function(n,t){if(this.$1Sc){this.$P6.$34(this.$1Sc);this.$1Sc=null}if(this.$1T.get_$B()>0&&this.$eP!==1){this.$1Sc=new _d.$rZ($6wQ(this),"",$6wP(this),"",this.$6NJ,this.$1T.get_$B()>1,!1);this.$P6.$D(this.$1Sc)}this.$6eA();$6C(this,"MessageUpdated")},get_$2PX:function(){return this.$31p},set_$2PX:function(n){if(this.$31p!==n){this.$31p=n;$3(this,"IsMoreInfoDialogShown")}return n},get_$95u:function(){return this.$3DM},set_$95u:function(n){if(n!==this.$3DM){this.$3DM=n;$3(this,"MoreInfoDialogButtonData")}return n},$846:function(){_js.Trace.logInfo(_a.$0.$IL,"Hide more info dialog");this.set_$2PX(!1)},$6Bn:function(){this.$1Kz&&window.open(this.$1Kz,"_blank","width=800,height=700,toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes")}};_d.$kx=function(n,t){this.$$d_$1h8=Function.createDelegate(this,this.$1h8);this.$$d_$4KO=Function.createDelegate(this,this.$4KO);_d.$kx.initializeBase(this);this.$25j=n;this.$27P=t;this.$2Xy=new _C(this.$$d_$4KO,_a.$0.$IL);this.$7V=new _C(this.$$d_$1h8,_a.$0.$IL);this.set_$DP(this);var i=new _js.$Z;i.$D(new _a.$2G(this.$2Xy,_nbs.NonBootStrings.l_PolicyTipsOverrideButtonCaption_Text));i.$D(new _a.$2G(this.$7V,_u.Strings.l_CancelButtonLabel_LowerCase_Text));this.set_$Sc(i);this.set_$6G8(1);this.set_$2Qd("")};_d.$kx.prototype={$2Xy:null,$7V:null,$25j:null,$27P:null,$2Qc:null,$25k:0,get_$6G8:function(){return this.$25k},set_$6G8:function(n){if(this.$25k!==n){this.$25k=n;$3(this,"OverrideType")}return n},get_$2Qd:function(){return this.$2Qc},set_$2Qd:function(n){this.$2Qc=n;$3(this,"Justification");return n},$4KO:function(){if(this.$25k===1&&this.$25j&&!_js.$9.$a(this.$2Qc)){this.$25j(this.$2Qc);this.set_$2Qd("");this.$4d.$n()}if(this.$25k===2&&this.$27P){this.$27P();this.set_$2Qd("");this.$4d.$n()}},$1h8:function(){this.set_$2Qd("");this.$4d.$n()}};_d.$ky=function(n,t,i,r){this.$$d_$69J=Function.createDelegate(this,this.$69J);_d.$ky.initializeBase(this);this.$C=n;this.$1P7=new _C(t,_a.$0.$IL);this.$6Nj=new _C(i,_a.$0.$IL);this.$pj=r;this.$pj.add_$1Z(this.$$d_$69J)};_d.$ky.prototype={$C:null,$1P7:null,$6Nj:null,$pj:null,$2y:!1,$el:null,$1Kz:null,$fi:!1,get_$1O:function(){return this.$2y},set_$1O:function(n){if(this.$2y===n)return n;this.$2y=n;$3(this,"IsShown");return n},get_$PI:function(){return this.$el},set_$PI:function(n){if(this.$el===n)return n;this.$el=n;$3(this,"ClassificationDescription");return n},get_$5jl:function(){return 420},get_$yg:function(){return 320},get_$5aP:function(){return this.$C.get_$L()!=="TouchNarrow"},get_$5CB:function(){return this.$1Kz},set_$5CB:function(n){this.$1Kz=n;$3(this,"ComplianceUrl");return n},get_$2Pv:function(){return this.$fi},set_$2Pv:function(n){this.$fi=n;$3(this,"IsReportedFalsePositive");return n},$4c:function(){this.$pj&&this.$pj.remove_$1Z(this.$$d_$69J);_a.$1.prototype.$4c.call(this)},$69J:function(n,t){for(var i="<ul>",r=0;r<this.$pj.get_$B();r++){var u=this.$pj.get_$3q(r);i+=String.format("<li>{0}</li>",u)}i+="</ul>";this.set_$PI(i)}};_d.$rZ=function(n,t,i,r,u,f,e){_d.$rZ.initializeBase(this,[n,t,i,r,e]);u&&(this.$6NK=new _C(u,_a.$0.$IL));this.$5cZ=f};_d.$rZ.prototype={$6NK:null,$5cZ:!1,get_$9bL:function(){return this.$5cZ?_nbs.NonBootStrings.l_MessageRemoveAll_Text:_nbs.NonBootStrings.l_MessageRemoveRecipient_Text}};_d.$Ak=function(){};_d.$Ak.$3jy=function(n,t,i){var r=n.$d;var u=r.get_$40();var s=3===u||2===u||1===u;var h=i.get_$BQ()&&r.get_$EH();var e=null;if(s&&!h){_js.Trace.logInfo(_a.$0.$j,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$v.$v.get_$L()+"; disposition="+t);var c=r.$1LR();var o=_d.$Ak.$3kz(r,c,i);o.$Ee=t;o.$2Fm=r.$3uO(100);o.$208=_y.$Iw.toString(r.get_$40());e=o}else if(r.get_$42u()){_js.Trace.logInfo(_a.$0.$j,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);e=_d.$Ak.$7fJ(t,r,i)}else if(8===r.get_$40()){_js.Trace.logInfo(_a.$0.$j,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);e=_d.$Ak.$7qd(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$j,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);e=_d.$Ak.$3sM(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$j,"CreateComposeAction: ApprovalRequestAction");e=_d.$Ak.$7qP(r,t,i)}else{_js.Trace.logInfo(_a.$0.$j,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var f=null;if(u===11||u===12){f=new _h.$3F(r.$3kr(),r.get_$1hz());f.$Ee=0}else{f=new _h.$3F(r.$1LR(),null);f.$Ee=t}f.$1Ks=!i.get_$BQ();$6(r.get_$PK())||(f.$pp=r.get_$PK());f.$2Fm=r.$3uO(100);f.$208=_y.$Iw.toString(r.get_$40());e=f}e.$59=r.get_$7g();return e};_d.$Ak.$3kK=function(n,t,i){var r=new _c.$15f(200,n);r.$Po=t||_h.$15.get_$206();r.$Rx=$6(i)?"MailCompose":i;return r};_d.$Ak.$7c4=function(n,t){var i=t?"HardDelete":"MoveToDeletedItems";return new _h.$v6([n],i,2)};_d.$Ak.$7qP=function(n,t,i){var u=n.get_$E3();var r=new _c.$aW(u,n.$1LR(),n.get_$40()===9,t);r.$1Ks=!i.get_$BQ();return r};_d.$Ak.$7eU=function(n,t,i){var u=null;u=n.get_$iz()?n.$3kr(!0):n.$1LR(!0);var r=_d.$Ak.$3kz(n,u,i);r.$Po=t;r.$Rx=!i.get_$BQ()&&n.get_$3n()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$1Uo=_g.$V.get_$I().get_$1I().get_$MW();return r};_d.$Ak.$7qd=function(n,t){var i=new _c.$i9(n.get_$dJ(),1,n.get_$3qS());i.$G6=n.$1LR();n.get_$PK()&&(i.$pp=n.get_$PK());return i};_d.$Ak.$3kz=function(n,t,i){var u=n.get_$rN()?new _h.$7U(n.get_$dJ()):n.get_$dJ();var r=null;r=new _h.$DF(_d.$Ak.$3uF(n.get_$40()),u,i);r.set_$52(t);r.$2Zp=n.get_$3Gz();r.$1Ks=!i.get_$BQ();n.get_$PK()&&(r.$pp=n.get_$PK());r.$Cr_7=n.get_$3S();r.$Yd=n.get_$25u();r.$59=n.get_$7g();n.get_$E3()&&_g.$7g.isInstanceOfType(n.get_$E3())&&n.get_$E3().get_$F6()&&(r.$32S=!0);switch(n.get_$40()){case 1:case 2:r.$3QC=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$3QC=_nbs.NonBootStrings.l_ForwardPrefix_Text;break}return r};_d.$Ak.$3sM=function(n,t){return _d.$1t.$3sM(n.get_$E3(),_d.$1t.$1an(n.get_$40()),n.$1LR(),t,n.$16w)};_d.$Ak.$7fJ=function(n,t,i){var r=null;if(t.get_$iz()){r=new _h.$4v(t.$3kr());r.$oM=_g.$28.$Z7(t.get_$1hz());r.$Ee=0}else{r=new _h.$4v(t.$1LR());r.$Ee=n}r.$5ew=!i.get_$BQ();t.get_$PK()&&(r.$pp=t.get_$PK());r.$2Fm=t.$3uO(100);r.$2HI="AlwaysOverwrite";r.$208=_y.$Iw.toString(t.get_$40());return r};_d.$Ak.$3uF=function(n){switch(n){case 1:return new _g.$Hh;case 2:return new _g.$Gr;case 3:return new _g.$HK;case 12:return new _g.$YG;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$Iw.toString(n));}};_d.$192=function(n,t,i,r,u,f,e){_a.$4.$l(e,"nativeBridge");this.$17=n;this.$5B=i;this.$1J=r;this.$1Bl=u;this.$D8=t;this.$2L=f;this.$12=e};_d.$192.prototype={$17:null,$5B:null,$1J:null,$1Bl:null,$D8:null,$2L:null,$12:null,$7bb:function(n,t){switch(n){case 0:return new _d.$8U(this.$17,this.$1J);case 1:return new _d.$3z(this.$17);case 2:return new _d.$196(this.$17);case 3:return new _d.$DQ(this.$17);case 4:return new _d.$90(this.$17);case 5:return new _d.$Al(this.$17,this.$D8,this.$5B,this.$1J,this.$1Bl);case 6:return new _d.$Js(this.$17);case 7:return new _d.$8V(this.$17,this.$1J);case 8:return new _d.$191(this.$17,this.$2L,this.$1J);case 9:if(1===this.$17.$f.$d.get_$61())return new _d.$Bq(this.$17,this.$1J);break;case 10:return new _d.$Gc(this.$17);case 11:if("Mouse"!==t)return new _d.$Gd(this.$17,this.$5B);break;case 12:return new _d.$EF(this.$17,this.$1J);case 13:return new _d.$PP(this.$17,this.$1J);case 14:if(t==="Mouse")return new _d.$4p(this.$17);break;case 15:if(this.$12.$AD.get_$ao().get_$2mE())return new _d.$PO(this.$17,this.$12.$AD);break;case 22:if(this.$12.$AD.get_$ao().get_$3Di())return new _d.$197(this.$17,this.$12.$AD);break;case 16:return new _d.$DP(this.$17);case 17:if("Mouse"===t)return new _d.$PN(this.$17);break;case 18:if("Mouse"===t)return new _d.$R9(this.$17);break;case 20:return new _d.$Ek(this.$17);case 19:return new _d.$195(this.$17,OwaApplication.$1W,this.$17.$3c(1),this.$17.$f.$w,this.$1J);case 25:return new _d.$dZ(this.$17,OwaApplication.$1W,this.$17.$f.$w);case 21:return new _d.$Tz(this.$17);case 23:if(this.$12.$dn.$Co)return new _d.$198(this.$17,this.$12.$3E,this.$12.$dn);break;case 24:return new _d.$EE(this.$17,this.$17.$f.$R0);case 26:if(this.$1J.get_$BQ())return new _d.$qH(this.$17,this.$5B);break;case 27:return new _d.$194(this.$17)}return null}};_d.$193=function(n,t){this.$46D=n.$5QA();this.$1J=t};_d.$193.prototype={$1J:null,$46D:0,$G3:function(n,t){var i=new _d.$R;this.$1J&&i.set_$BQ(this.$1J.get_$BQ());i.set_$61(n?0:this.$46D);return i},$3k2:function(n,t,i,r){var u=this.$G3(!1,!1);u.set_$61(this.$46D);u.set_$40(4);u.set_$Na(!1);u.set_$A3(n);u.set_$2PZ(t);r&&!r.get_$HC()?u.set_$3n(r.get_$3n()):u.set_$3n(i===1?"Text":"HTML");return u}};_d.$Xl=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_a.$4.$l(b,"nativeBridge");this.$R0=n;this.$6Q=t;this.$1uH=i;this.$1T0=r;this.$6h=u;this.$5C=f;this.$C=e;this.$1RU=o;this.$Gk=s;this.$gj=h;this.$M=c;this.$5B=a;this.$1J=v;this.$1Bl=y;this.$D8=l;this.$2L=p;this.$Za=w;this.$12=b};function $6u9(n,t,i){var r=n.$6h.$G3(!1,!1);r.$3xv(t);return n.$5YW(r,i)}_d.$Xl.prototype={$R0:null,$6Q:null,$1uH:null,$1T0:null,$6h:null,$M:null,$5C:null,$C:null,$1RU:null,$Gk:null,$gj:null,$5B:null,$1J:null,$1Bl:null,$D8:null,$Za:null,$2L:null,$12:null,$bC:function(n,t){return $6u9(this,n,null)},$vo:function(n,t){return this.$5YW(n,null)},$5YW:function(n,t){var i=new _d.$Am(n,t,this.$R0,this.$6Q,this.$1uH,this.$1T0,this.$5C,this.$C,this.$1RU,this.$Gk,this.$gj,this.$M,this.$D8,this.$5B,this.$1J,this.$1Bl,this.$2L,this.$Za,this.$12);i.$49();return i}};_d.$xS=function(){_d.$xS.initializeBase(this)};_d.$xS.prototype={$Qt:null,$2pS:null,get_$mB:function(){return this.$Qt},set_$mB:function(n){if(this.$Qt!==n){this.$Qt=n;$3(this,"Description")}return n},get_$7Zy:function(){return this.$2pS},set_$7Zy:function(n){if(this.$2pS!==n){this.$2pS=n;$3(this,"ConversationOwner")}return n}};_d.$11s=function(n,t,i,r,u,f){_d.$11s.initializeBase(this,[n,t,i,r,u,f]);this.$147=!1;this.set_$1Og(!0);this.$2aN();this.$6eA();this.$1J=f};_d.$11s.prototype={$1J:null,$5PC:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1T.get_$3q(i);var u=new _d.$PS(this.$13N(i),"",r.$3ev,"",r,this.get_$3KS(),!1,this.$1J);this.$P6.$D(u)}},$7qc:function(){this.set_$ro(this.$1y2()?String.format(_nbs.NonBootStrings.l_InfoMailtipAutomaticReplyMultiple_Text,this.$1T.get_$B()):String.format(_u.Strings.l_InfoMailtipAutomaticReply_Text,this.$13N(0),this.$1T.get_$3q(0).$3ev))}};_d.$13Y=function(n,t,i,r,u,f){_d.$13Y.initializeBase(this,[n,t,i,r,u,f]);this.$1J=f;this.$147=!1;this.set_$31h(!0);this.set_$1Og(!0);this.set_$HV(!1);this.$2aN();this.$6eA()};_d.$13Y.prototype={$1J:null,$5PC:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1T.get_$3q(i);var u=new _d.$PS(this.$13N(i),"",r.$5Gf,"",r,null,!1,this.$1J);this.$P6.$D(u)}},$1y2:function(){return!0}};_d.$14c=function(n,t,i,r,u,f){_d.$14c.initializeBase(this,[n,t,i,r,u,f]);this.$1J=f;this.$147=!0;this.set_$1Og(!0);this.$2aN();this.$6eA()};_d.$14c.prototype={$1J:null,$2tt:0,get_$3qY:function(){return this.$2tt},set_$3qY:function(n){this.$2tt=n;this.$6eA();return n},$5PC:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1T.get_$3q(i);if(r.$zQ>1){var u=new _d.$PS(this.$13N(i),"",String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,r.$2tu),_nbs.NonBootStrings.l_SubmessageEndSeparator_Text,r,this.get_$3KS(),!0,this.$1J);this.$P6.$D(u)}}},$1y2:function(){return this.$2tt>1||this.$2tt===1&&!!this.$1T.get_$3q(0)&&this.$1T.get_$3q(0).$zQ>1},$7qc:function(){this.set_$ro(this.$1y2()?_nbs.NonBootStrings.l_InfoMailTipExternalRecipientsMultiple_Text:String.format(_u.Strings.l_InfoMailTipExternalRecipients_Text,this.$13N(0)))},$7qT:function(){for(var n="",t=0;t<this.$1T.get_$B();t++){var r=this.$1T.get_$3q(t);if(r.$zQ<=1){var i=this.$13N(t);_js.$9.$a(n)?n=i:n+=_nbs.NonBootStrings.l_MessageNameSeparator_Text+i}}this.set_$2ra(n)}};_d.$18e=function(n,t,i,r,u,f){_d.$18e.initializeBase(this,[n,t,i,r,u,f]);this.$1J=f;this.$147=!0;this.set_$1Og(!0);this.$5f9=!0;this.set_$5dg(!0);this.$2aN();this.$6eA()};_d.$18e.prototype={$1J:null,$2yz:0,$2er:0,$33E:!1,get_$3xk:function(){return this.$2yz},set_$3xk:function(n){this.$2yz=n;this.$7qT();return n},get_$4b9:function(){return this.$2er},set_$4b9:function(n){this.$2er=n;this.$7qc();return n},$5PC:function(n,t){for(var r=n;r<n+t;r++){var i=this.$1T.get_$3q(r);if(i.$zQ>1){var u;if(i.$zQ>100){this.$33E=!0;u=String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,i.$zQ)}else u=i.$zQ.toString();var f=new _d.$PS(this.$13N(r),"",u,_nbs.NonBootStrings.l_SubmessageEndSeparator_Text,i,this.get_$3KS(),!0,this.$1J);this.$P6.$D(f)}}},$6NR:function(n){_d.$MB.prototype.$6NR.call(this,n);if(!$6(this.$1T)&&this.$1T.get_$B()){for(var t=!1,i=0;i<this.$1T.get_$B();i++){var r=this.$1T.get_$3q(i);if(r.$zQ>100){t=!0;break}}t!==this.$33E&&(this.$33E=t)}},$1y2:function(){return!0},$7qc:function(){if(this.$2er<1e3){var n=this.$33E?String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,this.$2er):this.$2er.toString();this.set_$ro(String.format(_u.Strings.l_InfoMailTipLargeAudience_Text,n))}else this.set_$ro(String.format(_nbs.NonBootStrings.l_InfoMailTipExtraLargeAudience_Text,1e3))},$7qT:function(){if(this.$2yz>0){this.set_$2ra(String.format(_nbs.NonBootStrings.l_InfoMailTipLargeAudienceIndividual_Text,this.$2yz));!this.$A7&&this.$405&&this.set_$406(!1)}else{this.set_$2ra("");this.set_$406(!0)}}};_d.$MB=function(n,t,i,r,u,f){this.$$d_$WQ=Function.createDelegate(this,this.$WQ);this.$$d_$9aU=Function.createDelegate(this,this.$9aU);_d.$MB.initializeBase(this,[n,r,u]);this.$6Mt=new _C(this.$$d_$9aU,_a.$0.$j);this.$6NI=i;this.$1T=t;this.$1J_6=f;this.$1T.add_$1Z(this.$$d_$WQ)};_d.$MB.$6F3=function(n,t){var r=n.get_$oD().get_$N1();n.get_$oD().$9v();if(r){var i=new _d.$R;t&&i.set_$BQ(t.get_$BQ());i.set_$61(0);i.set_$40(0);i.set_$3n("Html"===_g.$V.get_$I().get_$1I().get_$vY()?"HTML":"Text");if(_y.$3T.$3SL(r,i,t.get_$BQ())){var u=new _y.$CS;u.$T7(i)}else _js.Trace.logInfo(_a.$0.$n7,"Cannot parse the mailto link in the mailtip message. The original link address is [{0}]",r)}};_d.$MB.prototype={$1J_6:null,$1T:null,$6NI:null,$1yW:!1,$6Mt:null,$32r:!1,$4QV:null,get_$9b6:function(){return this.$4QV},set_$9b6:function(n){this.$4QV=n;$3(this,"RemoveLinkText");return n},get_$3KS:function(){return this.$6NI},$Lu:null,get_$5dg:function(){return this.$1yW},set_$5dg:function(n){this.$1yW=n;this.set_$434(this.$1yW||this.get_$1cx()||this.get_$31h());$3(this,"IsRemoveLinkHidden");return n},get_$434:function(){return this.$32r},set_$434:function(n){this.$32r=n;$3(this,"IsSeparatorHidden");return n},$13N:function(n){var t=this.$1T.get_$3q(n);return $6(t.get_$1o())||_js.$9.$18(t.get_$1o())?t.get_$ZL():t.get_$1o()},$1y2:function(){return this.$1T.get_$B()>1},get_$a0:function(){return this.$Lu},set_$a0:function(n){if(n!==this.$Lu){this.$Lu=n;_d.$MB.$6F3(this.$Lu,this.$1J_6)}return n},get_$1cx:function(){return _d.$13v.prototype.get_$1cx.call(this)},set_$1cx:function(n){this.set_$434(n||this.$1yW||this.get_$31h());_d.$13v.prototype.set_$1cx.call(this,n);return n},get_$31h:function(){return _d.$13v.prototype.get_$31h.call(this)},set_$31h:function(n){this.set_$5dg(this.$1yW||n);this.set_$434(this.$32r||n);_d.$13v.prototype.set_$31h.call(this,n);return n},get_$lG:function(){return _d.$MB.$1Ju},$6NR:function(n){for(var i=0;i<n.length;i++)for(var r=n[i],t=0;t<this.$P6.get_$B();t++){var u=this.$P6.get_$3q(t);u.$4Pa===r&&this.$P6.$68(t)}},$WQ:function(n,t){if(this.$43J)switch(t.$2v){case 0:this.$5PC(t.$4V,t.$2l.length);break;case 2:this.$6NR(t.$38);break;case 4:this.$2aN();break;default:break}(this.$1T.get_$B()>0||this.$5f9)&&this.$6eA();this.$89E()||this.$A7||this.set_$HV(!0);$6C(this,"MessageUpdated")},$89E:function(){return this.$1y2()},$2aN:function(){this.$P6.$1r();this.$5PC(0,this.$1T.get_$B())},$5PC:function(n,t){},$6eA:function(){_d.$13v.prototype.$6eA.call(this);this.get_$31h()||this.set_$9b6(this.$1y2()?_nbs.NonBootStrings.l_MessageRemoveAll_Text:_nbs.NonBootStrings.l_MessageRemoveRecipient_Text)},$9aU:function(){while(this.$1T.get_$B()>0){var n=this.$1T.get_$3q(0).get_$ZL();this.get_$3KS()(n)}},$7qT:function(){for(var t="",n=0;n<this.$1T.get_$B();n++){var i=$6(this.$1T.get_$3q(n).get_$1o())?this.$1T.get_$3q(n).get_$ZL():this.$1T.get_$3q(n).get_$1o();n?t+=_nbs.NonBootStrings.l_MessageNameSeparator_Text+i:t=i}this.set_$2ra(t)},$7qc:function(){}};_d.$PS=function(n,t,i,r,u,f,e,o){_d.$PS.initializeBase(this,[n,t,i,r,e]);this.$4Pa=u;this.$1J=o;if($6(f))this.$5df=!0;else{var s=this;this.$1Sl=new _C(function(){f(s.$4Pa.get_$ZL())},_a.$0.$j)}};_d.$PS.prototype={$5df:!1,$1J:null,$1Sl:null,$4Pa:null,$Lu:null,get_$lG:function(){return _d.$PS.$1Ju},get_$a0:function(){return this.$Lu},set_$a0:function(n){if(n!==this.$Lu){this.$Lu=n;_d.$MB.$6F3(this.$Lu,this.$1J)}return n},get_$9bJ:function(){return _d.$3.get_$pl()}};_d.$19U=function(n,t,i,r,u,f){_d.$19U.initializeBase(this,[n,t,i,r,u,f]);this.$147=!0;this.set_$1Og(!1);this.$6eA()};_d.$19U.prototype={$7qc:function(){this.set_$ro(this.$1y2()?String.format(_nbs.NonBootStrings.l_WarningMailTipModeratedMessageMultiple_Text,this.$1T.get_$B()):String.format(_u.Strings.l_WarningMailTipModeratedMessage_Text,this.$13N(0)))}};_d.$O3=function(n){_d.$O3.initializeBase(this);this.$2Zf=n};_d.$O3.prototype={$2Zf:null,$3ev:null,$5Gf:null,$zQ:0,$2tu:0,get_$1o:function(){var t=_d.$32.$2Ly(this.$2Zf);var n=t.match(_d.$O3.$5OQ);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());n=t.match(_d.$O3.$2t0);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());return t},get_$ZL:function(){return this.$2Zf.$CA.get_$1l().EmailAddress}};_d.$1BI=function(n,t,i,r,u,f){_d.$1BI.initializeBase(this,[n,t,i,r,u,f]);this.$147=!0;this.set_$1Og(!1);this.$6eA()};_d.$1BI.prototype={$7qc:function(){this.set_$ro(this.$1y2()?String.format(_nbs.NonBootStrings.l_WarningMailTipMailBoxFullMultiple_Text,this.$1T.get_$B()):this.set_$ro(String.format(_u.Strings.l_WarningMailTipMailBoxFull_Text,this.$13N(0))))}};_d.$1Bg=function(n,t,i,r,u,f){_d.$1Bg.initializeBase(this,[n,t,i,r,u,f]);this.$147=!0;this.set_$1Og(!1);this.$6eA()};_d.$1Bg.prototype={$7qc:function(){this.set_$ro(this.$1y2()?String.format(_nbs.NonBootStrings.l_WarningMailTipNoPermissionToSendMultiple_Text,this.$1T.get_$B()):String.format(_u.Strings.l_WarningMailTipNoPermissionToSend_Text,this.$13N(0)))}};_d.$13v=function(n,t,i){_d.$13v.initializeBase(this,[n]);this.$454=t;this.$3OZ=this.$A7?_nbs.NonBootStrings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text;this.$AK=i};_d.$13v.prototype={$P6:null,$AK:0,$A7:!0,$454:null,$5eB:!1,$3OZ:null,$405:!0,$5f9:!1,$5cG:!1,$43J:!1,$147:!1,$2Rv:null,$2rZ:null,get_$ro:function(){return this.$2Rv},set_$ro:function(n){this.$2Rv=n;$3(this,"MainEntryText");return n},get_$2ra:function(){return this.$2rZ},set_$2ra:function(n){this.$2rZ=n;$3(this,"DetailEntryText");return n},get_$9oL:function(){return this.$3OZ},set_$9oL:function(n){this.$3OZ=n;$3(this,"ShowHideText");return n},get_$HV:function(){return this.$A7},set_$HV:function(n){this.$A7=n;this.set_$406(!this.$147||this.$A7||_js.$9.$a(this.$2rZ));this.set_$9oL(this.$A7?_nbs.NonBootStrings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text);$3(this,"IsCollapsed");return n},get_$1Og:function(){return this.$43J},set_$1Og:function(n){this.$43J=n;this.$P6=new _js.$Z;return n},get_$1cx:function(){return this.$5eB},set_$1cx:function(n){this.$5eB=n;$3(this,"IsShowHideLinkHidden");return n},get_$31h:function(){return this.$5cG},set_$31h:function(n){this.set_$1cx(this.get_$1cx()||n);this.$5cG=n;$3(this,"IsMainEntryHidden");return n},get_$406:function(){return this.$405},set_$406:function(n){this.$405=n;$3(this,"IsDetailEntryHidden");return n},add_$25F:function(n){this.$2N("MessageUpdated",n)},remove_$25F:function(n){this.$2P("MessageUpdated",n)},$1Gy:function(){this.$454&&this.$454()},$6eA:function(){if(!this.get_$31h()){this.$7qc();this.set_$1cx(!this.$89E())}this.$147&&this.$7qT()}};_d.$6s=function(n){this.$$d_$68Q=Function.createDelegate(this,this.$68Q);_d.$6s.initializeBase(this);this.$k=OwaApplication.$1W;this.$1z=n};_d.$6s.$2vh=function(n){if(!n)return null;var t=n.responseCode;return $6(t)?null:t.toString()};_d.$6s.$1uo=function(n){var t=null;if(n){t=_d.$6s.$2vh(n);if(!t){var i=n.__type;if(i&&i===_g.$DN._dataContractName){var r=n.ErrorCode;t="HTTP_"+_js.$1g.$9a(_0365f.$NT,r)}}}return t};_d.$6s.$1up=function(n){var t=null;if(n){t=n.message;if(!t){var i=n.__type;i&&i===_g.$DN._dataContractName&&(t=n.FaultMessage)}}return t};function $4lq(n,t){var r=t.__type;if(r&&r===_g.$DN._dataContractName){var i=t.ErrorCode;if(!_g.$7Y.$10J(i)&&i!==408){_js.Trace.logInfo(_a.$0.$j,"Action failure: status code {0}",i);return!0}}return!1}function $4lr(n,t){var i=t.__type;if(i&&i===_g.$DN._dataContractName){var r=t.ErrorCode;if(r===408){_js.Trace.logInfo(_a.$0.$j,"Action failure: status code {0}",r);return!0}}return!1}function $4ls(n,t){var i=t.__type;if(i&&i===_g.$DN._dataContractName){var r=t.ErrorCode;if(r===503){_js.Trace.logInfo(_a.$0.$j,"Action failure: status code {0}",r);return!0}}return!1}_d.$6s.prototype={$k:null,$1z:null,$oj:function(n,t,i,r){$6(t)||n.add_$2C(t);n.add_$1x(i||this.$$d_$68Q);$6(r)||n.add_$2m(r);this.$k.$z(n)},$9sR:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$9sR(n,t,i,r,u,f):r(e)};var h=this,c=this;this.$oj(e,function(){o()},function(){u(e);i&&o()},f)},$6Va:function(n,t){var i=_nbs.NonBootStrings.l_MailComposeActionFailed_Text;this.$17i(n,i,null,i,null,t)},$1um:function(n,t,i,r,u,f){var e=t;if($4ls(this,n.$1f))e=_u.Strings.l_ErrorServiceUnavailable_Text;else if(u&&$4lr(this,n.$1f))e=u;else if(i&&$4lq(this,n.$1f))e=i;else{var o=_d.$6s.$2vh(n.$1f);if(o)r&&o==="ErrorItemNotFound"?e=r:o==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&o==="ErrorQuotaExceeded"&&(e=f);else{var s=$6(n.$1f)||_js.$9.$18(n.$1f.message)?"none":n.$1f.message;_js.Trace.logWarning(_a.$0.$j,"MailComposeActionSubmitter.GetErrorMessage: The error type is not expected. Showing error {0} for action error message {1}",e,s)}}_js.Trace.logInfo(_a.$0.$j,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$3tO:function(n,t,i,r,u,f,e,o,s){var h=t;s!==undefined&&(s=t);if(_a.$4.$8CO(n.$1f))h=s;else if($4ls(this,n.$1f))h=e;else if($4lr(this,n.$1f))h=f;else if($4lq(this,n.$1f))h=i;else{var c=_d.$6s.$2vh(n.$1f);if(c)c==="ErrorItemNotFound"?h=r:c==="ErrorAccessDenied"?h=u:c==="ErrorQuotaExceeded"&&(h=o);else{var l=$6(n.$1f)||_js.$9.$18(n.$1f.message)?"none":n.$1f.message;_js.Trace.logWarning(_a.$0.$j,"MailComposeActionSubmitter.GetInfoBarErrorMessage: The error type is not expected. Showing error {0} for action error message {1}",h,l)}}_js.Trace.logInfo(_a.$0.$j,"MailComposeActionSubmitter.GetInfoBarErrorMessage: showing error {0}",h);return h},$17i:function(n,t,i,r,u,f){var e=this.$1um(n,t,i,r,u,null);this.$1z.$32(0,e,f)},$68Q:function(n){this.$6Va(n,null);this.$4PG(n)},$4PG:function(n){$JB(this,"MailComposeActionFailed",n)}};_d.$R=function(){this.$$d_$7oc=Function.createDelegate(this,this.$7oc);_d.$R.initializeBase(this);this.set_$3n("Html"===_g.$V.get_$I().get_$1I().get_$vY()?"HTML":"Text");this.$Y(_d.$R.$2Xm.$1n,this.$$d_$7oc);this.$Y(_d.$R.$31k.$1n,this.$$d_$7oc);if(_a.$s.$2t&&_a.$s.get_$2ON()){this.set_$GW(_g.$V.get_$I().get_$1I().get_$2dM());this.set_$IT(_g.$V.get_$I().get_$1I().get_$2dR())}};_d.$R.$$cctor=function(){_d.$R.$1IR.set_$Gu(new _a.$EC(_g.$1l));_d.$R.$1AL.set_$Gu(new _a.$EC(_g.$1l));_d.$R.$19y.set_$Gu(new _a.$EC(_g.$1l));_d.$R.$3Po.set_$Gu(new _a.$EC(_pc.$i));_d.$R.$1Wm.set_$Gu(new _a.$EC(_g.Attachment));_d.$R.$1Zv.set_$Gu(new _a.$EC(_g.$Kj))};_d.$R.$A5x=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$9.$a(u)?r:_js.$1g.$Q9(n,u)};_d.$R.$6Gp=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$9.$a(r)?i:Boolean.parse(r)};_d.$R.$54E=function(n,t,i,r){if(n)for(var f=0;f<n.get_$B();f++){var u=n.get_$3q(f);if(_g.$2L.$4e(u,i)){_js.Trace.logInfo(_a.$0.$j,"Excluding original from {0}",i);continue}if(_d.$R.$1yg(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$j,"Excluding self address {0}",_d.$R.$101||"null");continue}if(r&&r.get_$B()!==r.$DY(function(n){return _g.$2L.$4e(u,n)})){_js.Trace.logInfo(_a.$0.$j,"Excluding address {0} already in to",u);continue}t.$D(u)}};_d.$R.$1yg=function(n){return!_js.$9.$18(_d.$R.$101)&&!_js.$9.$18(n)&&(_d.$R.$101===n||_d.$R.$101.toLowerCase()===n.toLowerCase())};_d.$R.$45z=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$B();u++){r.val+=_g.$2L.$wZ(t.get_$3q(u));u!==t.get_$B()-1&&(r.val+="|")}r.val+=" QS="+i+")"};function $4m8(n,t,i){i.val=$6(i.val)?!1:i.val;t.set_$2i(n.get_$2i());t.set_$6U(n.get_$6U());t.set_$i(n.get_$A3());t.set_$1N(new(_a.$1s.$$(_g.Attachment,_g.$Df)));if(n.get_$Pl()){var o=_g.$V.get_$I().get_$TX().ClearSign;t.set_$8n(n.get_$GW()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");t.get_$8n()==="IPM.Note.SMIME.MultipartSigned"?t.set_$3C($4m4(n,i.val)):t.set_$3C(new _g.$6L(new _g.$6R(n.get_$3n(),"")));t.set_$IH(new _g.$du(_a.$9N.$EX(n.get_$6Xw())))}else{t.set_$3C($4m4(n,i.val));(n.get_$Vi()&&n.get_$Vi().get_$GD()||n.get_$E3()&&n.get_$E3().get_$GD())&&t.set_$8n("IPM.Note");n.get_$92()&&t.get_$1N().$69(n.get_$92().$6Z())}t.set_$5n(n.get_$5n());t.set_$84(n.get_$84());t.set_$L3(n.get_$L3());t.set_$Qi(n.get_$Qi());t.set_$PI(n.get_$PI());t.set_$Tp(n.get_$Tp());t.set_$Vg(n.get_$Vg());t.set_$Tw(n.get_$Tw());if(n.get_$U1()){t.set_$Gm(new(_a.$1s.$$(_g.$Kj,_g.$Cq)));t.get_$Gm().$69(n.get_$U1().$6Z())}if(_g.$7g.isInstanceOfType(t)){var r=t;r.set_$3O(n.get_$3O());if(n.get_$Pl()&&n.$ko){if(n.$ko===1){r.set_$4B(new(_a.$W.$$(_g.$1l)));n.get_$4B()&&r.get_$4B().$69(n.get_$4B().$6Z());r.set_$4T(new(_a.$W.$$(_g.$1l)));n.get_$4T()&&r.get_$4T().$69(n.get_$4T().$6Z())}else if(n.$ko===2){r.set_$60(new(_a.$W.$$(_g.$1l)));n.get_$60()&&r.get_$60().$D(n.get_$60().get_$3q(n.$1LW))}else if(n.$ko===3){r.set_$60(new(_a.$W.$$(_g.$1l)));n.get_$60()&&r.get_$60().$69(n.get_$60().$6Z())}}else{r.set_$4B(new(_a.$W.$$(_g.$1l)));n.get_$4B()&&r.get_$4B().$69(n.get_$4B().$6Z());r.set_$4T(new(_a.$W.$$(_g.$1l)));n.get_$4T()&&r.get_$4T().$69(n.get_$4T().$6Z());r.set_$60(new(_a.$W.$$(_g.$1l)));n.get_$60()&&r.get_$60().$69(n.get_$60().$6Z())}r.set_$Fj(n.get_$Fj());r.set_$F6(n.get_$F6());r.set_$GW(n.get_$GW());r.set_$IT(n.get_$IT())}else{var u=t;u.set_$28(n.get_$1hz());var f=_g.$V.get_$I().get_$31();var e=null;e=_js.$9.$a(f.get_$aN())?null!==n.get_$3O()&&n.get_$3O().Mailbox?n.get_$3O().Mailbox.EmailAddress:_h.$3F.$2vb(null)||f.get_$Aj():f.get_$aN();if(e){u.set_$3O(new _g.$BY);u.get_$3O().Mailbox=new _g.$1l;u.get_$3O().Mailbox.EmailAddress=e}}}function $6tj(n,t){var i=$6tk(n,t);switch(n.get_$40()){case 0:case 4:n.set_$A3(i);break;case 1:case 2:case 3:n.set_$dJ(i);break}}function $4m6(n,t){if(t.get_$Gm()){n.set_$U1(new _js.$Z);n.get_$U1().$69(t.get_$Gm().$6Z())}}function $6tk(n,t){var i=null;if(!$6(t)&&"Id"in t){i=new _g.$1q(t.Id);"ChangeKey"in t&&(i.ChangeKey=t.ChangeKey)}return i}function $4mB(n,t,i){0===t.get_$gS()&&t.set_$gS(i&&i.get_$3n()==="Text"?1:3)}function $6ti(n,t){var u=_h.$3F.$2vb(t);if(u){n.set_$3O(new _g.$BY);n.get_$3O().Mailbox=new _g.$1l;n.get_$3O().Mailbox.EmailAddress=u}n.set_$14D(!1);n.get_$5n()&&!n.get_$5n().get_$HC()?n.set_$3n(t.get_$5n().get_$3n()):t.get_$V7()?n.set_$3n(t.get_$V7().get_$3n()):t.get_$3C()&&n.set_$3n(t.get_$3C().get_$3n());switch(n.get_$40()){case 1:case 2:case 12:$2hJ(n,t);if(_g.$7g.isInstanceOfType(t)){var i=t;i.get_$IY()?n.$1Hg(i.get_$3O()||i.get_$8X(),null,null,null):n.$1Hg(i.get_$3O()||i.get_$8X(),i.get_$4B()?i.get_$4B().get_$A5d():null,i.get_$4T()?i.get_$4T().get_$A5d():null,i.get_$3Kd()?i.get_$3Kd().get_$A5d():null);n.set_$2Pu(n.get_$40()===2&&t.get_$36D());n.set_$3Gz(t.get_$2JY())}else if(_g.$MQ.isInstanceOfType(t)){var f=t;n.$1Hg(f.get_$3O()||f.get_$8X(),null,null,null)}$3Wb(n,t);break;case 5:case 6:case 7:if(_g.$7g.isInstanceOfType(t)){var r=t;n.$1Hg(r.get_$3O()||r.get_$8X(),r.get_$4B()?r.get_$4B().get_$A5d():null,r.get_$4T()?r.get_$4T().get_$A5d():null,r.get_$3Kd()?r.get_$3Kd().get_$A5d():null)}break;case 3:_g.$RD.isInstanceOfType(t)||$2hJ(n,t);n.set_$3Gz(t.get_$2JY());$4m3(n);$3Wb(n,t);break;case 9:case 10:_g.$7g.isInstanceOfType(t)?n.$1Hg(t.get_$8X(),null,null,null):_g.$MQ.isInstanceOfType(t)&&n.$1Hg(t.get_$8X(),null,null,null);$3Wb(n,t);break;default:$4m9(n);break}_js.Trace.logInfo(_a.$0.$j,"Initialized context with original email message, context:"+n.toString())}function $6tg(n,t){n.set_$dJ(t.get_$i());var i=n.$42l();n.set_$5n(i?null:t.get_$5n());$6tl(n,t.get_$nk());n.set_$84(t.get_$84());n.set_$NV(n.get_$NV()||"");n.get_$5n()&&!n.get_$5n().get_$HC()?n.set_$3n(n.get_$5n().get_$3n()):t.get_$V7()?n.set_$3n(t.get_$V7().get_$3n()):n.set_$3n(t.get_$gS()===1?"Text":"HTML");if(!n.get_$EH()){n.set_$EH(!(n.get_$40()===1||n.get_$40()===2||n.get_$40()===3||n.get_$40()===12));n.get_$40()!==3||_a.$s.$2t&&t.get_$GD()||i||n.get_$5n()&&n.get_$5n().get_$HC()||n.set_$92(t.get_$1N()?t.get_$1N().get_$A5d():null)}if(_g.ICalendaring.isInstanceOfType(t)){var r=t;r.$3NN();$6th(n,r)}else if(_g.$7g.isInstanceOfType(t)||_g.$MQ.isInstanceOfType(t)){if(3===n.get_$40()&&!n.get_$EH()){n.set_$6U(t.get_$6U());_js.Trace.logInfo(_a.$0.$j,"Setting importance to "+n.get_$6U()+" since we are forwarding item "+_h.$Dn.$wZ(t.get_$i())+" with that importance")}$6ti(n,t)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(t).getName()));$4mA(n);n.set_$fa(!0)}function $6tf(n,t){var i=null;_g.$PV.isInstanceOfType(t)||_g.$IB.isInstanceOfType(t)?i=t.get_$3O():t.get_$FE()?i=t.get_$FE():_js.Trace.logError(_a.$0.$j,"ICalendaring doesnt have an organizer");return i}function $4mA(n){var t=new(_0365f.$o.$$(String));n.get_$1D5()&&t.$69(_g.$CC.$5Qk(n.get_$92()));if(n.$5Y&&_a.$s.$2t&&n.$5Y.get_$GD()&&n.$5Y.get_$1b4()){var i=n.$5Y.get_$1N().get_$3q(0).get_$3i().Id;t.$D(i)}n.set_$1Wp(t.$6Z())}function $6th(n,t){n.set_$14D(!0);t.get_$3C()&&n.set_$3n(t.get_$3C().get_$3n());var u=$6tf(n,t);var i;var r;if(_g.$PV.isInstanceOfType(t)||_g.$IB.isInstanceOfType(t)){i=t.get_$4B()?_g.$2L.$2LA(t.get_$4B().get_$A5d()):null;r=t.get_$4T()?_g.$2L.$2LA(t.get_$4T().get_$A5d()):null}else{i=t.get_$7S()?_g.$2L.$2LA(_g.$3i.$4am(t.get_$7S().get_$A5d())):null;r=t.get_$8W()?_g.$2L.$2LA(_g.$3i.$4am(t.get_$8W().get_$A5d())):null}switch(n.get_$40()){case 1:case 2:n.$1Hg(u,i,r,null);break;case 5:case 6:case 7:n.$1Hg(u,i,r,null);$2hK(n,t);n.set_$2Mz(!0);break;case 8:var f=t.get_$7S().$3p();f.$69(t.get_$9F().$6Z());i=_g.$2L.$2LA(_g.$3i.$4am(f.get_$A5d()));n.$1Hg(u,i,r,null);$2hK(n,t);n.set_$2Mz(!0);break;case 3:if(_g.$CC.isInstanceOfType(t)||_g.$33.isInstanceOfType(t)){n.set_$1D5(!0);n.set_$3O(u);$2hK(n,t)}break;default:$4m9(n);break}n.set_$W0(!0);_js.Trace.logInfo(_a.$0.$j,"Initialized context from original calendar item, context:"+n.toString())}function $2hK(n,t){n.set_$14u($6te(n,t));n.set_$4j(t.get_$4j());n.set_$1vY(!!n.get_$4j()&&!_js.$9.$a(n.get_$4j().get_$1o()))}function $6te(n,t){var i=new _d.$9c;i.set_$y(t.get_$y());i.set_$1u(t.get_$1u());i.set_$LT(t.get_$LT());i.set_$Pk(t.get_$Pk());i.$bA();return i}function $6tl(n,t){var i="";switch(n.get_$40()){case 1:case 2:case 12:i=_u.Strings.l_ReplyPrefix_Text;break;case 3:i=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:i=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:i=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:i=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:i=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:i=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:i=_nbs.NonBootStrings.l_RejectPrefix_Text;break}n.get_$2xV()&&(i=_nbs.NonBootStrings.l_NewTimeProposedPrefix_Text);var r=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,i,t);_js.Trace.logInfo(_a.$0.$j,"Formatted subject with Prefix="+i+"; Operation="+n.get_$40());if(255<r.length){n.set_$2i(r.substr(0,255));_js.Trace.logInfo(_a.$0.$j,"Truncated subject from "+r+" to "+n.get_$2i()+" to meet the "+255+" characters rule.")}else n.set_$2i(r)}function $3Wb(n,t){n.set_$3S(t.get_$3S());_g.$7g.isInstanceOfType(t)?n.set_$25u(t.get_$Aq()):_g.$MQ.isInstanceOfType(t)&&n.set_$25u(t.get_$Aq())}function $4m9(n){var t=_js.$1g.$9a(_y.$Iw,n.get_$40());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",t));}function $2hJ(n,t){n.set_$L3(t.get_$L3());n.set_$Tp(t.get_$Tp());n.set_$Qi(t.get_$Qi());n.set_$PI(t.get_$PI());n.set_$1Kk(t.get_$1Kk())}function $4m4(n,t){return t?$4m5(n):n.$5E8()}function $4m5(n){var t=new _g.$6L(new _g.$6R("HTML",""));t.set_$1g("");if(4!==n.get_$40()&&13!==n.get_$40()||n.get_$BQ()){_js.Trace.logInfo(_a.$0.$j,"Create new body for action email message, setting body type to context body type: "+n.get_$3n());t.set_$3n(n.get_$3n())}else{_js.Trace.logInfo(_a.$0.$j,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");t.set_$3n("Text")}return t}function $4m3(n){if(_y.$v.$v.get_$Vm()){var t=n.$2vo();if(t){var r=!1;if(n.get_$4T())for(var i=0;i<n.get_$4T().get_$B();i++){var u=n.get_$4T().get_$3q(i);if(t.EmailAddress.toLowerCase()===u.EmailAddress.toLowerCase()){r=!0;break}}if(!r){n.get_$4T()||n.set_$4T(new _js.$Z);n.get_$4T().$D(t);_js.Trace.logInfo(_a.$0.$j,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$j,"Could not add self to CC as the address was missing")}}function $4m7(n,t){if(_js.$9.$a(t.get_$8n())||t.get_$8n()==="IPM.Note"||t.get_$GD())return!0;else{var i=n.get_$40()===1||n.get_$40()===2;var r=i||n.get_$40()===3;return i&&t.get_$8n().startsWith("IPM.Schedule.Meeting")?!0:r&&t.get_$8n().startsWith("REPORT.IPM.Note")?!0:r&&t.get_$8n()==="IPM.Post"?!0:!1}}_d.$R.prototype={$Ih:null,$5Y:null,$Hy:null,$2wY:null,$cc:!1,$2Ot:!1,$5f6:!1,$Vv:null,$4HF:!1,$2cY:!1,$30P:!1,$88W:!1,$ko:0,$1LW:0,$bs:null,$16w:null,$47T:0,get_$9Xz:function(){return this.$16w},set_$9Xz:function(n){this.$16w=n;return n},get_$2xV:function(){return!!this.$16w},get_$9Y0:function(){if(this.get_$2xV()){var n=new _d.$9c;n.set_$y(this.$16w.get_$y());n.set_$1u(this.$16w.get_$1u());return n}return null},get_$A2t:function(){return this.get_$2xV()?_nbs.NonBootStrings.l_CurrentMeetingTime_Short_Text:_nbs.NonBootStrings.l_WhenLabel_Text},get_$7g:function(){return this.$U(_d.$R.$4dX)},set_$7g:function(n){this.$K(_d.$R.$4dX,n);return n},get_$40:function(){return this.$U(_d.$R.$2Xm)},set_$40:function(n){this.$K(_d.$R.$2Xm,n);return n},get_$61:function(){return this.$U(_d.$R.$15y)},set_$61:function(n){this.$K(_d.$R.$15y,n);return n},get_$dJ:function(){return this.$U(_d.$R.$4La)},set_$dJ:function(n){this.$K(_d.$R.$4La,n);return n},get_$3Gz:function(){return this.$U(_d.$R.$4LZ)},set_$3Gz:function(n){this.$K(_d.$R.$4LZ,n);return n},get_$E3:function(){this.$5Y||(this.$5Y=this.$U(_d.$R.$4Lb));return this.$5Y},set_$E3:function(n){this.$5Y=n;this.$K(_d.$R.$4Lb,this.$5Y);return n},get_$A3:function(){return this.$U(_d.$R.$3oZ)},set_$A3:function(n){if($6(this.get_$A3())||!n)this.$K(_d.$R.$3oZ,n);else{this.get_$A3().Id=n.Id;this.get_$A3().ChangeKey=n.ChangeKey}return n},get_$42u:function(){return!!this.get_$A3()},get_$6ZJ:function(){return this.$U(_d.$R.$4YC)},set_$6ZJ:function(n){this.$K(_d.$R.$4YC,n);return n},get_$2i:function(){return this.$U(_d.$R.$Z4)},set_$2i:function(n){this.$K(_d.$R.$Z4,n);return n},get_$Cu:function(){return this.$U(_d.$R.$1t2)},set_$Cu:function(n){this.$K(_d.$R.$1t2,n);return n},get_$1uk:function(){return this.$Ih},set_$1uk:function(n){this.$Ih=n;return n},get_$NV:function(){return this.$U(_d.$R.$4PM)},set_$NV:function(n){this.$K(_d.$R.$4PM,n);return n},get_$18L:function(){return this.$U(_d.$R.$4a7)},set_$18L:function(n){this.$K(_d.$R.$4a7,n);return n},get_$3n:function(){return this.$U(_d.$R.$3fe)},set_$3n:function(n){this.$K(_d.$R.$3fe,n);return n},get_$4B:function(){return this.$U(_d.$R.$1IR)},set_$4B:function(n){this.$K(_d.$R.$1IR,n);return n},get_$2dc:function(){return this.$U(_d.$R.$3Po)},set_$2dc:function(n){this.$K(_d.$R.$3Po,n);return n},get_$bX:function(){return this.$U(_d.$R.$2B9)},set_$bX:function(n){this.$K(_d.$R.$2B9,n);return n},get_$4T:function(){return this.$U(_d.$R.$1AL)},set_$4T:function(n){this.$K(_d.$R.$1AL,n);return n},get_$ZX:function(){return this.$U(_d.$R.$1qd)},set_$ZX:function(n){this.$K(_d.$R.$1qd,n);return n},get_$60:function(){return this.$U(_d.$R.$19y)},set_$60:function(n){this.$K(_d.$R.$19y,n);return n},get_$VQ:function(){return this.$U(_d.$R.$1pk)},set_$VQ:function(n){this.$K(_d.$R.$1pk,n);return n},get_$Na:function(){return this.$U(_d.$R.$3Nd)},set_$Na:function(n){this.$K(_d.$R.$3Nd,n);return n},get_$6U:function(){return this.$U(_d.$R.$1wH)},set_$6U:function(n){this.$K(_d.$R.$1wH,n);return n},get_$1Gk:function(){return this.$U(_d.$R.$4PE)},set_$1Gk:function(n){this.$K(_d.$R.$4PE,n);return n},get_$6Xw:function(){return this.$U(_d.$R.$4XE)},set_$6Xw:function(n){this.$K(_d.$R.$4XE,n);return n},get_$3PW:function(){return this.$U(_d.$R.$4XF)},set_$3PW:function(n){this.$K(_d.$R.$4XF,n);return n},get_$2dQ:function(){return this.$U(_d.$R.$4XG)},set_$2dQ:function(n){this.$K(_d.$R.$4XG,n);return n},get_$fa:function(){return this.$U(_d.$R.$3zp)},set_$fa:function(n){this.$K(_d.$R.$3zp,n);return n},get_$W0:function(){return this.$U(_d.$R.$31k)},set_$W0:function(n){this.$K(_d.$R.$31k,n);return n},get_$1D5:function(){return this.$U(_d.$R.$41e)},set_$1D5:function(n){this.$K(_d.$R.$41e,n);return n},get_$2Pu:function(){return this.$U(_d.$R.$42k)},set_$2Pu:function(n){this.$K(_d.$R.$42k,n);return n},get_$4j:function(){return this.$U(_d.$R.$1zv)},set_$4j:function(n){this.$K(_d.$R.$1zv,n);return n},get_$1vY:function(){return this.$U(_d.$R.$3vp)},set_$1vY:function(n){this.$K(_d.$R.$3vp,n);return n},get_$14u:function(){return this.$U(_d.$R.$47A)},set_$14u:function(n){this.$K(_d.$R.$47A,n);return n},get_$3O:function(){return this.$U(_d.$R.$1aQ)},set_$3O:function(n){this.$K(_d.$R.$1aQ,n);return n},get_$8X:function(){return this.$U(_d.$R.$3My)},set_$8X:function(n){this.$K(_d.$R.$3My,n);return n},get_$EH:function(){return this.$U(_d.$R.$43j)},set_$EH:function(n){this.$K(_d.$R.$43j,n);return n},get_$UK:function(){return this.$U(_d.$R.$40c)},set_$UK:function(n){this.$K(_d.$R.$40c,n);return n},get_$mh:function(){return this.$U(_d.$R.$3zR)},set_$mh:function(n){this.$K(_d.$R.$3zR,n);return n},get_$o0:function(){return this.$U(_d.$R.$25w)},set_$o0:function(n){this.$K(_d.$R.$25w,n);return n},get_$1hz:function(){return this.$U(_d.$R.$4MH)},set_$1hz:function(n){this.$K(_d.$R.$4MH,n);return n},get_$14D:function(){return this.$U(_d.$R.$42A)},set_$14D:function(n){this.$K(_d.$R.$42A,n);return n},get_$rN:function(){return this.$U(_d.$R.$425)},set_$rN:function(n){this.$K(_d.$R.$425,n);return n},get_$3qS:function(){return this.$U(_d.$R.$3qT)},set_$3qS:function(n){this.$K(_d.$R.$3qT,n);return n},get_$5XF:function(){return this.$U(_d.$R.$3xc)},set_$5XF:function(n){this.$K(_d.$R.$3xc,n);return n},get_$qn:function(){return this.$U(_d.$R.$3vZ)},set_$qn:function(n){this.$K(_d.$R.$3vZ,n);return n},get_$rU:function(){return this.$U(_d.$R.$42m)},set_$rU:function(n){this.$K(_d.$R.$42m,n);return n},get_$Vi:function(){return this.$U(_d.$R.$3oa)},set_$Vi:function(n){this.$K(_d.$R.$3oa,n);return n},get_$1Wp:function(){return this.$U(_d.$R.$3ea)},set_$1Wp:function(n){this.$K(_d.$R.$3ea,n);return n},get_$92:function(){return this.$U(_d.$R.$1Wm)},set_$92:function(n){var t=null;if(n){t=new _js.$Z;for(var i=0;i<n.get_$B();i++)t.$D(n.get_$3q(i))}this.$K(_d.$R.$1Wm,t);$4mA(this);return n},get_$1Ii:function(){return this.$U(_d.$R.$4ct)},set_$1Ii:function(n){this.$K(_d.$R.$4ct,n);return n},get_$Ia:function(){return this.$U(_d.$R.$3fR)},set_$Ia:function(n){this.$K(_d.$R.$3fR,n);return n},get_$5n:function(){return this.$U(_d.$R.$4S2)},set_$5n:function(n){if(n!==this.get_$5n()){this.$K(_d.$R.$4S2,n);$45(this,"IsCopyRestricted","IsPrintRestricted")}return n},get_$PK:function(){return this.$U(_d.$R.$1r0)},set_$PK:function(n){this.$K(_d.$R.$1r0,n);return n},get_$1xS:function(){return this.$cc},set_$1xS:function(n){this.$cc=n;n&&!this.get_$Ia()&&this.$5LR();$3(this,"IsEditorInitialized");return n},get_$89R:function(){return this.$2Ot},set_$89R:function(n){this.$2Ot=n;$3(this,"IsEditorReady");return n},get_$470:function(){return 255},get_$1D2:function(){return this.$U(_d.$R.$41N)},set_$1D2:function(n){this.$K(_d.$R.$41N,n);return n},get_$p8:function(){return this.$U(_d.$R.$4dt)},set_$p8:function(n){this.$K(_d.$R.$4dt,n);return n},get_$2Mz:function(){return this.$U(_d.$R.$3wX)},set_$2Mz:function(n){this.$K(_d.$R.$3wX,n);return n},get_$2PZ:function(){return this.$U(_d.$R.$41u)},set_$2PZ:function(n){this.$K(_d.$R.$41u,n);return n},get_$2C7:function(){return this.$U(_d.$R.$4dw)},set_$2C7:function(n){this.$K(_d.$R.$4dw,n);return n},get_$8Cd:function(){return!!this.get_$5n()&&!this.get_$5n().get_$HC()&&!this.get_$5n().get_$2ZA()&&!this.get_$5n().get_$Ar()},get_$6WP:function(){return this.get_$W0()&&_d.$90.$5eT(this)},get_$145:function(){return!!this.get_$5n()&&0===this.get_$5n().get_$HC()&&!this.get_$5n().get_$2KQ()&&!this.get_$5n().get_$Ar()},get_$241:function(){return null},get_$4O6:function(){return null},get_$L3:function(){return this.$U(_d.$R.$3zj)},set_$L3:function(n){this.$K(_d.$R.$3zj,n);return n},get_$Tp:function(){return this.$U(_d.$R.$3ht)},set_$Tp:function(n){this.$K(_d.$R.$3ht,n);return n},get_$Vg:function(){return this.$U(_d.$R.$3oF)},set_$Vg:function(n){this.$K(_d.$R.$3oF,n);return n},get_$Tw:function(){return this.$U(_d.$R.$3oE)},set_$Tw:function(n){this.$K(_d.$R.$3oE,n);return n},get_$Qi:function(){return this.$U(_d.$R.$3hv)},set_$Qi:function(n){this.$K(_d.$R.$3hv,n);return n},get_$PI:function(){return this.$U(_d.$R.$3hs)},set_$PI:function(n){this.$K(_d.$R.$3hs,n);return n},get_$1Kk:function(){return this.$U(_d.$R.$3hu)},set_$1Kk:function(n){this.$K(_d.$R.$3hu,n);return n},get_$84:function(){return this.$U(_d.$R.$1kL)},set_$84:function(n){this.$K(_d.$R.$1kL,n);return n},get_$Fj:function(){return this.$U(_d.$R.$1c3)},set_$Fj:function(n){this.$K(_d.$R.$1c3,n);return n},get_$F6:function(){return this.$U(_d.$R.$1cp)},set_$F6:function(n){this.$K(_d.$R.$1cp,n);return n},get_$1Hz:function(){return this.$U(_d.$R.$4XD)},set_$1Hz:function(n){this.$K(_d.$R.$4XD,n);return n},get_$Pl:function(){return _a.$s.$2t&&(this.get_$GW()||this.get_$IT())},get_$GW:function(){if(!_a.$s.$2t||!_a.$s.get_$2ON()||!this.$43C()||_g.$V.get_$I().get_$1I().get_$lF())return!1;var n=_g.$V.get_$I().get_$TX();return!!n&&n.AlwaysEncrypt||this.$U(_d.$R.$29q)},set_$GW:function(n){this.$K(_d.$R.$29q,n);_js.Trace.logInfo(_a.$0.$4A,"Context.SmimeEncryptMessage is set to "+n);return n},get_$IT:function(){if(!_a.$s.$2t||!_a.$s.get_$2ON()||!this.$43C()||_g.$V.get_$I().get_$1I().get_$lF())return!1;var n=_g.$V.get_$I().get_$TX();return!!n&&n.AlwaysSign||this.$U(_d.$R.$29r)},set_$IT:function(n){this.$K(_d.$R.$29r,n);_js.Trace.logInfo(_a.$0.$4A,"Context.SmimeSignMessage is set to "+n);return n},get_$6Xx:function(){return _g.$V.get_$I().get_$TX()&&(_g.$V.get_$I().get_$TX().AlwaysEncrypt||_g.$V.get_$I().get_$1I().get_$lF())||this.get_$UK()?!1:!0},get_$6Xy:function(){return _g.$V.get_$I().get_$TX()&&(_g.$V.get_$I().get_$TX().AlwaysSign||_g.$V.get_$I().get_$1I().get_$lF())||this.get_$UK()?!1:!0},get_$3S:function(){return this.$U(_d.$R.$1rD)},set_$3S:function(n){this.$K(_d.$R.$1rD,n);return n},get_$25u:function(){return this.$U(_d.$R.$4ME)},set_$25u:function(n){this.$K(_d.$R.$4ME,n);return n},get_$2Q1:function(){if(this.get_$W0()||_y.$v.$v.get_$Vm()||this.get_$Pl())return!1;var n=this.get_$5n();return!n||!!n.get_$HC()||n.get_$Ar()},get_$42v:function(){return OwaApplication.$13D?!1:this.get_$40()!==8&&!this.get_$iz()},get_$1DF:function(){return this.$U(_d.$R.$42L)},set_$1DF:function(n){this.$K(_d.$R.$42L,n);return n},get_$iz:function(){return this.get_$40()===11||this.get_$40()===12||this.get_$40()===13},get_$QB:function(){return this.$U(_d.$R.$4Mv)},set_$QB:function(n){this.$K(_d.$R.$4Mv,n);return n},get_$BQ:function(){return this.$U(_d.$R.$4Rz)},set_$BQ:function(n){this.$K(_d.$R.$4Rz,n);return n},get_$U1:function(){return this.$U(_d.$R.$1Zv)},set_$U1:function(n){this.$K(_d.$R.$1Zv,n);return n},$3xv:function(n){this.set_$61(_d.$R.$A5x(_y.$xs,n,_d.$R.$15y.$1n,0));this.set_$40(_d.$R.$A5x(_y.$Iw,n,_d.$R.$2Xm.$1n,0));this.set_$Na(_d.$R.$6Gp(n,_d.$R.$3Nd.$1n,!0));this.set_$14D(_d.$R.$6Gp(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$fa(!1);this.set_$6ZJ(n.StoreId)}$6tj(this,n);this.set_$EH(0===this.get_$40()||4===this.get_$40())},$5XZ:function(n){_g.$lK.isInstanceOfType(n)?this.set_$40(1):_g.$lJ.isInstanceOfType(n)?this.set_$40(2):_g.$od.isInstanceOfType(n)&&this.set_$40(3);$4mB(this,n,n.get_$1R5());this.set_$dJ(n.get_$2Zq());this.set_$3Gz(n.get_$3Jx());this.set_$A3(n.get_$i());this.set_$2i(n.get_$2i());this.set_$NV(n.get_$1R5().get_$1g());this.set_$3O(n.get_$3O());this.set_$4B(n.get_$4B()?n.get_$4B().get_$A5d():null);this.set_$4T(n.get_$4T()?n.get_$4T().get_$A5d():null);this.set_$60(n.get_$60()?n.get_$60().get_$A5d():null);this.set_$Na(!1);this.set_$6U(n.get_$6U());$2hJ(this,n);this.set_$5n(n.get_$5n());this.set_$84(n.get_$84());this.set_$Fj(n.get_$Fj());this.set_$F6(n.get_$F6());this.get_$5n()&&!this.get_$5n().get_$HC()?this.set_$3n(this.get_$5n().get_$3n()):$6(n.get_$1R5())||(n.get_$V7()?this.set_$3n(n.get_$V7().get_$3n()):this.set_$3n(n.get_$gS()===1?"Text":"HTML"));$4m6(this,n);this.set_$EH(!1);this.set_$fa(!0);_js.Trace.logInfo(_a.$0.$j,"Initialized context with smart response, context:"+this.toString())},$3xu:function(n){if($6(n))throw Error.argumentNull("message");$4mB(this,n,n.get_$3C());this.set_$Vi(n);this.set_$A3(n.get_$i());this.set_$2i(n.get_$2i());this.set_$NV(n.get_$V7()?n.get_$V7().get_$1g():n.get_$3C().get_$1g());this.set_$3S(n.get_$3S());if(_g.$7g.isInstanceOfType(n)){var t=n;this.set_$3O(t.get_$3O());this.set_$4B(t.get_$4B()?t.get_$4B().$A5e():null);this.set_$4T(t.get_$4T()?t.get_$4T().$A5e():null);this.set_$60(t.get_$60()?t.get_$60().$A5e():null);this.set_$Fj(t.get_$Fj());this.set_$F6(t.get_$F6())}else if(_g.$MQ.isInstanceOfType(n)){var u=n;this.set_$3O(u.get_$3O())}this.set_$Na(!1);this.set_$6U(n.get_$6U());$2hJ(this,n);this.set_$5n(n.get_$5n());this.set_$84(n.get_$84());n.get_$5n()&&!n.get_$5n().get_$HC()?this.set_$3n(n.get_$5n().get_$3n()):n.get_$V7()?this.set_$3n(n.get_$V7().get_$3n()):this.set_$3n(n.get_$gS()===1?"Text":"HTML");this.set_$W0(_g.$RD.isInstanceOfType(n));if(this.get_$W0()){var i=n;$2hK(this,i.get_$KB());this.set_$1D5(_g.$CC.isInstanceOfType(i));i.get_$3O()&&this.set_$3O(i.get_$3O());i.get_$8X()&&this.set_$8X(i.get_$8X())}n.get_$h2()&&n.get_$h2().get_$B()?this.set_$92(n.get_$h2()?n.get_$h2().get_$A5d():null):(!this.get_$1DF()||this.get_$EH())&&this.set_$92(n.get_$1N()?n.get_$1N().get_$A5d():null);if(this.get_$92()&&n.get_$3C().get_$3n()==="Text")for(var r=0;r<this.get_$92().get_$B();r++)this.get_$92().get_$3q(r)&&this.get_$92().get_$3q(r).get_$6D()&&this.get_$92().get_$3q(r).set_$6D(!1);$4m6(this,n);this.set_$EH(!0);this.set_$fa(!0);_js.Trace.logInfo(_a.$0.$j,"Initialized context with draft, context:"+this.toString())},$13p:function(n){this.set_$E3(n);$6tg(this,n)},$1LR:function(n){var t=new _g.$7g;var i;$4m8(this,t,i={val:n});n=i.val;return t},$3kr:function(n){var t=new _g.$MQ;var i;$4m8(this,t,i={val:n});n=i.val;return t},$5E8:function(){var t=$4m5(this);_a.$4.$l(this.$Hy,"GetRawEditorContentCommand");this.$Hy.$n();var n=this.get_$NV();t.set_$1g(n);this.$47T=_js.$9.$a(n)?0:n.length;_js.Trace.logInfo(_a.$0.$j,"MailComposeContext.CreateBodyFromEditor, RawContentLength: "+this.$47T.toString());return t},$9za:function(n){var t=this.get_$Ia();if(!t||this.get_$6U()===t.get_$6U()){this.set_$6U(n);t&&t.set_$6U(n)}},$5LR:function(){if(this.$cc&&this.$5f6){this.$Ih.$n();if($6(this.get_$Ia())){this.set_$Ia(_d.$1m.$1qZ(this));_js.Trace.logInfo(_a.$0.$j,"Captured baseline for the first time, context:"+this.toString());if(this.$4HF&&this.$Vv){this.$Vv.set_$Cu(this.get_$Ia().get_$Cu());this.$4HF=!1}if(!this.get_$A3()||this.get_$1DF()&&this.get_$p8()){this.$Vv=_d.$1m.$1qZ(this);_js.Trace.logInfo(_a.$0.$j,"Captured initial baseline for context:"+this.toString())}}else{_d.$1m.$6I(this.get_$Ia(),this);_js.Trace.logInfo(_a.$0.$j,"Updated baseline, context:"+this.toString())}}},$F4:function(){if($6(this.get_$Ia()))return!1;this.$Ih.$n();return!this.get_$Ia().$5LH(this)},$3uO:function(n){this.$2wY.$n();var t=this.get_$18L();t=t?t.length>n?this.get_$18L().substr(0,n)+"...":t:"";return t},$1Hg:function(n,t,i,r){this.set_$4B(new _js.$Z);var u=n?n.Mailbox:null;if(!_d.$R.$101){var f=_g.$V.get_$I().get_$31();_d.$R.$101=_js.$9.$a(f.get_$ob())?f.get_$Aj()||"":f.get_$aN()||""}if(this.get_$5XF()||this.get_$40()!==8&&(!r||!r.get_$B())&&u&&(2!==this.get_$40()||!_d.$R.$1yg(u.EmailAddress))){this.get_$4B().$D(u);_js.Trace.logInfo(_a.$0.$j,"Adding original From to To, Operation="+this.get_$40()+"; From="+_g.$2L.$wZ(n)+"; Self="+_d.$R.$101)}if(this.get_$40()===2||this.get_$40()===8){_js.Trace.logInfo(_a.$0.$j,"Adding "+(t?t.get_$B():0)+" To recipients to To.");_d.$R.$54E(t,this.get_$4B(),u,null);_js.Trace.logInfo(_a.$0.$j,"Adding "+(i?i.get_$B():0)+" Cc recipients to Cc");this.set_$4T(new _js.$Z);_d.$R.$54E(i,this.get_$4T(),u,this.get_$4B())}$4m3(this);if(r&&r.get_$B()>0)if(this.get_$40()===1){this.get_$4B().$1r();for(var e=0;e<r.get_$B();e++){var c=r.get_$3q(e);this.get_$4B().$D(c)}}else if(this.get_$40()===2)for(var o=0;o<r.get_$B();o++){var s=r.get_$3q(o);var l=this;if(this.get_$4B().get_$B()===this.get_$4B().$DY(function(n){return _g.$2L.$4e(s,n)})){var a=this;var h=this.get_$4T().$DY(function(n){return _g.$2L.$4e(s,n)});h!==this.get_$4T().get_$B()&&this.get_$4T().$68(h);this.get_$4B().$D(s)}}if(this.get_$40()!==8&&u&&0===this.get_$4B().get_$B()&&(!this.get_$4T()||0===this.get_$4T().get_$B())){this.get_$4B().$D(u);_js.Trace.logInfo(_a.$0.$j,"Adding original From since there are no recipients left, From="+_g.$2L.$wZ(n))}},toString:function(){var n="Id="+this.get_$7g()+"; Op="+this.get_$40()+"; Mode="+this.get_$61()+"; Oid=";n+=this.get_$dJ()?this.get_$dJ().Id+":"+this.get_$dJ().ChangeKey+";":this.$5Y&&this.$5Y.get_$i()?this.$5Y.get_$i().Id+":"+this.$5Y.get_$i().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$A3()?this.get_$A3().Id+":"+this.get_$A3().ChangeKey+";":this.get_$Vi()&&this.get_$Vi().get_$i()?this.get_$Vi().get_$i().Id+":"+this.get_$Vi().get_$i().ChangeKey+";":"null;";n+=" Subject="+this.get_$2i()+"; RawContentLength="+(_js.$9.$a(this.get_$NV())?"0":this.get_$NV().length.toString())+"; ContentLength="+(_js.$9.$a(this.get_$Cu())?"0":this.get_$Cu().length.toString())+"; TextEditorContentLength="+(_js.$9.$a(this.get_$18L())?"0":this.get_$18L().length.toString())+"; BodyType="+this.get_$3n()+";";var t;_d.$R.$45z("To",this.get_$4B(),this.get_$bX(),t={val:n});n=t.val;var i;_d.$R.$45z("Cc",this.get_$4T(),this.get_$ZX(),i={val:n});n=i.val;var r;_d.$R.$45z("Bcc",this.get_$60(),this.get_$VQ(),r={val:n});n=r.val;n+=" AutoSig="+this.get_$Na()+"; Imp="+this.get_$6U()+"; QuotedBodyLength="+(_js.$9.$a(this.get_$1Gk())?"0":this.get_$1Gk().length.toString())+"; IsComplete="+this.get_$fa()+"; IsMeeting="+this.get_$W0()+"; IsMeetingForward="+this.get_$1D5()+"; IsReplyBcc="+this.get_$2Pu()+"; HasLocation="+this.get_$1vY()+"; MeetingTime="+(this.get_$14u()?this.get_$14u().get_$Pk()+":"+(this.get_$14u().get_$y()?this.get_$14u().get_$y().$99():"null")+":"+(this.get_$14u().get_$1u()?this.get_$14u().get_$1u().$99():"null"):"null")+"; From="+_g.$2L.$wZ(this.get_$3O())+"; Sender="+_g.$2L.$wZ(this.get_$8X())+"; IsFromShown="+this.get_$UK()+"; IsBccShown="+this.get_$mh()+"; AttachmentCount="+(this.get_$92()?this.get_$92().get_$B().toString():"0")+"; UpgradeFailed="+this.get_$1Ii()+"; HasBaseline="+(!!this.get_$Ia()).toString()+"; HasInitBaseline="+(!!this.$Vv).toString()+"; UserSaved="+this.get_$qn()+"; IsReplyForward="+this.get_$rU()+"; HasDraft="+(!!this.get_$Vi()).toString()+"; HasRMLD="+(!!this.get_$5n()).toString()+"; Classified="+this.get_$L3()+"; Class="+this.get_$Qi()+"; Sensitivity="+this.get_$84()+"; DeliveryReceipt="+this.get_$Fj()+"; ReadReceipt="+this.get_$F6()+"; SmimeEncryptMessage="+this.get_$GW()+"; SmimeSignMessage="+this.get_$IT()+"; ConversationId="+(this.get_$3S()?this.get_$3S().Id+":"+this.get_$3S().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$25u()+"; IsOriCalId="+this.get_$14D()+"; OccurrenceRefMaster="+this.get_$rN()+"; IsLoadedDraft="+this.get_$1D2()+"; IsMovedToDraftFromOutbox="+this.get_$2PZ()+"; IsUpgraded="+this.get_$EH()+"; IsCached="+this.$88W+";";return n},$Au:function(){_js.Trace.logInfo(_a.$0.$j,"Context reset start.");this.set_$7g(null);this.get_$40()&&this.set_$40(0);this.get_$61()&&this.set_$61(0);this.get_$dJ()&&this.set_$dJ(null);this.get_$E3()&&this.set_$E3(null);this.get_$A3()&&this.set_$A3(null);_js.$9.$a(this.get_$2i())||this.set_$2i(null);_js.$9.$a(this.get_$NV())||this.set_$NV("");_js.$9.$a(this.get_$Cu())||this.set_$Cu("");_js.$9.$a(this.get_$18L())||this.set_$18L("");this.set_$3n("Html"===_g.$V.get_$I().get_$1I().get_$vY()?"HTML":"Text");this.get_$4B()&&this.set_$4B(null);_js.$9.$a(this.get_$bX())||this.set_$bX(null);this.get_$4T()&&this.set_$4T(null);_js.$9.$a(this.get_$ZX())||this.set_$ZX(null);this.get_$60()&&this.set_$60(null);_js.$9.$a(this.get_$VQ())||this.set_$VQ(null);this.get_$Na()||this.set_$Na(!0);this.get_$6U()!=="Normal"&&this.set_$6U("Normal");_js.$9.$a(this.get_$1Gk())||this.set_$1Gk(null);this.get_$fa()&&this.set_$fa(!1);this.get_$W0()&&this.set_$W0(!1);this.get_$1D5()&&this.set_$1D5(!1);this.get_$2Pu()&&this.set_$2Pu(!1);this.get_$4j()&&this.set_$4j(null);this.get_$1vY()&&this.set_$1vY(!1);this.get_$14u()&&this.set_$14u(null);this.get_$3O()&&this.set_$3O(null);this.get_$8X()&&this.set_$8X(null);this.get_$EH()&&this.set_$EH(!1);this.get_$UK()&&this.set_$UK(!1);this.get_$mh()&&this.set_$mh(!1);this.get_$92()&&this.set_$92(null);this.get_$1Ii()&&this.set_$1Ii(!1);this.get_$Ia()&&this.set_$Ia(null);this.get_$qn()&&this.set_$qn(!1);this.get_$rU()&&this.set_$rU(!1);this.get_$Vi()&&this.set_$Vi(null);this.get_$5n()&&this.set_$5n(null);_js.$9.$a(this.get_$PK())||this.set_$PK(null);this.get_$L3()&&this.set_$L3(!1);_js.$9.$a(this.get_$Tp())||this.set_$Tp(null);_js.$9.$a(this.get_$Qi())||this.set_$Qi(null);_js.$9.$a(this.get_$PI())||this.set_$PI(null);this.get_$1Kk()&&this.set_$1Kk(!1);this.get_$84()!=="Normal"&&this.set_$84("Normal");this.get_$Fj()&&this.set_$Fj(!1);this.get_$F6()&&this.set_$F6(!1);this.get_$GW()&&this.set_$GW(!1);this.get_$IT()&&this.set_$IT(!1);this.get_$3S()&&this.set_$3S(null);_js.$9.$a(this.get_$25u())||this.set_$25u(null);this.get_$14D()&&this.set_$14D(!1);this.get_$rN()&&this.set_$rN(!1);this.get_$1D2()&&this.set_$1D2(!1);this.get_$2PZ()&&this.set_$2PZ(!1);this.get_$U1()&&this.set_$U1(null);_js.Trace.logInfo(_a.$0.$j,"Context reset end.")},$42l:function(){return!!this.get_$E3().get_$5n()&&0===this.get_$E3().get_$5n().get_$HC()&&!this.get_$E3().get_$5n().get_$3oq()&&!this.get_$E3().get_$5n().get_$2tp()},$2vo:function(){var n=null;if(this.get_$3O()&&this.get_$3O().Mailbox&&!_js.$9.$a(this.get_$3O().Mailbox.EmailAddress))n=this.get_$3O().Mailbox;else if(this.get_$8X()&&this.get_$8X().Mailbox&&!_js.$9.$a(this.get_$8X().Mailbox.EmailAddress))n=this.get_$8X().Mailbox;else if(!_js.$9.$a(_d.$R.$101)){n=new _g.$1l;n.EmailAddress=_d.$R.$101;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$43C:function(){if(!_a.$s.$2t)return!1;switch(this.get_$40()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$Vi()&&!$4m7(this,this.get_$Vi())?!1:this.get_$E3()&&!$4m7(this,this.get_$E3())?!1:!0},$A16:function(n){_js.Trace.logInfo(_a.$0.$4A,"Updating S/MIME options...");if(_a.$s.$2t)switch(n){case 6:this.set_$GW(!0);this.set_$IT(!1);break;case 10:case 11:this.set_$GW(!1);this.set_$IT(!0);break;case 12:case 13:case 14:this.set_$GW(!0);this.set_$IT(!0);break;case-1:case 0:default:this.set_$GW(!1);this.set_$IT(!1);break}},$A1P:function(n){_js.Trace.logInfo(_a.$0.$4A,"Upgrading S/MIME options...");if(_a.$s.$2t)switch(n){case 6:this.set_$GW(!0);break;case 10:case 11:this.set_$IT(!0);break;case 12:case 13:case 14:this.set_$GW(!0);this.set_$IT(!0);break;case-1:case 0:default:break}},$7oc:function(n,t){$3(this,"ShowMeetingReadonlyFields")}};_d.$qG=function(){this.$17z={}};_d.$qG.prototype={$if:function(n){return n in this.$17z},$6U2:function(n,t){if(n in this.$17z){var i=this.$17z[n];!i.$4Vk&&t&&(this.$17z[n]=new _d.$rI(t))}else this.$17z[n]=new _d.$rI(t)},$5JF:function(n,t){var u=n.$f;var i=u.$d;var r=i.get_$7g();var o=i.get_$A3();var f=!1;if(i.get_$1D2())_js.Trace.logInfo(_a.$0.$j,"Not discarding a loaded draft for context "+r);else if(i.get_$qn())_js.Trace.logInfo(_a.$0.$j,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$1TD().$x6)_js.Trace.logInfo(_a.$0.$j,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$1Hb().$LA)_js.Trace.logInfo(_a.$0.$j,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$j,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$j,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$F4()}if(e)_js.Trace.logInfo(_a.$0.$j,"Not discarding a dirty draft for context "+r);else if(i.$Vv)if(i.$Vv.$4e(i.get_$Ia())){if(_g.$1U.$MG&&i.get_$rU()&&!i.get_$A3()){_js.Trace.logInfo(_a.$0.$j,"Calling main window to remember the pending discard for context "+r);_g.$1U.$MG.$6U2(r,!i.get_$qn());f=!0}else if(!i.get_$iz()){_js.Trace.logInfo(_a.$0.$j,"Discarding unused draft for context "+r);this.$2s8(r,o,u.$k,i.get_$qn());f=!0}}else _js.Trace.logInfo(_a.$0.$j,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$j,"Not discarding without an initial baseline for context "+r)}return f},$2s8:function(n,t,i,r){i||(i=new _d.$6s(new _y.$4c));var u;if(this.$17z[n]){var f=this.$17z[n];u=f.$4Vk}else u=!r;if(t){var e=_d.$Ak.$7c4(t,u);i.$oj(e,null,null,null);delete this.$17z[n];_js.Trace.logInfo(_a.$0.$j,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$17z[n]=new _d.$rI(u);_js.Trace.logInfo(_a.$0.$j,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$7iv:function(n,t){this.$2s8(n,t,new _d.$6s(new _y.$4c),!1)}};_d.$1m=function(){_d.$1m.initializeBase(this)};_d.$1m.$$cctor=function(){_d.$1m.$1IR.set_$Gu(_d.$1m.$2sy);_d.$1m.$1AL.set_$Gu(_d.$1m.$2sy);_d.$1m.$19y.set_$Gu(_d.$1m.$2sy)};_d.$1m.$1qZ=function(n){var t=new _d.$1m;_d.$1m.$6I(t,n);return t};_d.$1m.$6I=function(n,t){n.set_$2i(t.get_$2i());n.set_$Cu(t.get_$Cu());if(t.get_$4B()){n.set_$4B(new _js.$Z);n.get_$4B().$69(t.get_$4B().$6Z())}else n.set_$4B(null);n.set_$bX(t.get_$bX());if(t.get_$4T()){n.set_$4T(new _js.$Z);n.get_$4T().$69(t.get_$4T().$6Z())}else n.set_$4T(null);n.set_$ZX(t.get_$ZX());if(t.get_$60()){n.set_$60(new _js.$Z);n.get_$60().$69(t.get_$60().$6Z())}else n.set_$60(null);if(t.get_$92()){n.set_$92(new _js.$Z);n.get_$92().$69(t.get_$92().$6Z())}else n.set_$92(null);if(t.get_$U1()){n.set_$U1(new _js.$Z);n.get_$U1().$69(t.get_$U1().$6Z())}else n.set_$U1(null);n.set_$VQ(t.get_$VQ());n.set_$6U(t.get_$6U());n.set_$3O(t.get_$3O());n.set_$PK(t.get_$PK());n.set_$84(t.get_$84());n.set_$Fj(t.get_$Fj());n.set_$F6(t.get_$F6());n.set_$GW(t.get_$GW());n.set_$IT(t.get_$IT())};_d.$1m.$1pF=function(n,t,i,r){if(i!==r&&!(_js.$9.$a(i)&&_js.$9.$a(r))||!_d.$1m.$5JY(n,t))return!1;if($6(n)||$6(t))return!0;for(var u=0;u<n.get_$B();u++){var f=n.get_$3q(u);var e=t.get_$3q(u);if(!_d.$1m.$3dw(f,e))return!1}return!0};_d.$1m.$3dw=function(n,t){return $6(n)&&!$6(t)||$6(t)&&!$6(n)?!1:$6(n)&&$6(t)?!0:_g.$2L.$4e(n,t)};_d.$1m.$5JY=function(n,t){var i=_d.$1m.$5Px(n);var r=_d.$1m.$5Px(t);return i===r};_d.$1m.$5Px=function(n){return $6(n)?0:n.get_$B()};_d.$1m.$56B=function(n,t){if(!_d.$1m.$5JY(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$B();i++){var r=n.get_$3q(i);var u=t.get_$3q(i);if(!_d.$1m.$7Qa(r,u))return!1}return!0};_d.$1m.$7QX=function(n,t){return _h.$WK.$56D(n,t)};_d.$1m.$7Qa=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$3i()&&t.get_$3i()||!t.get_$3i()&&n.get_$3i()?!1:n.get_$3i()&&n.get_$3i().Id!==t.get_$3i().Id?!1:n.get_$1L()!==t.get_$1L()?!1:n.get_$Bf()!==t.get_$Bf()?!1:n.get_$Ge()!==t.get_$Ge()?!1:n.get_$1r8()!==t.get_$1r8()?!1:n.get_$4k()!==t.get_$4k()?!1:!n.get_$As()&&t.get_$As()||!t.get_$As()&&n.get_$As()?!1:n.get_$As()&&!n.get_$As().$4e(t.get_$As())?!1:n.get_$6D()!==t.get_$6D()?!1:!0};_d.$1m.prototype={get_$2i:function(){return this.$U(_d.$1m.$Z4)},set_$2i:function(n){this.$K(_d.$1m.$Z4,n);return n},get_$Cu:function(){return this.$U(_d.$1m.$1t2)},set_$Cu:function(n){this.$K(_d.$1m.$1t2,n);return n},get_$4B:function(){return this.$U(_d.$1m.$1IR)},set_$4B:function(n){this.$K(_d.$1m.$1IR,n);return n},get_$bX:function(){return this.$U(_d.$1m.$2B9)},set_$bX:function(n){this.$K(_d.$1m.$2B9,n);return n},get_$4T:function(){return this.$U(_d.$1m.$1AL)},set_$4T:function(n){this.$K(_d.$1m.$1AL,n);return n},get_$ZX:function(){return this.$U(_d.$1m.$1qd)},set_$ZX:function(n){this.$K(_d.$1m.$1qd,n);return n},get_$60:function(){return this.$U(_d.$1m.$19y)},set_$60:function(n){this.$K(_d.$1m.$19y,n);return n},get_$VQ:function(){return this.$U(_d.$1m.$1pk)},set_$VQ:function(n){this.$K(_d.$1m.$1pk,n);return n},get_$6U:function(){return this.$U(_d.$1m.$1wH)},set_$6U:function(n){this.$K(_d.$1m.$1wH,n);return n},get_$3O:function(){return this.$U(_d.$1m.$1aQ)},set_$3O:function(n){this.$K(_d.$1m.$1aQ,n);return n},get_$PK:function(){return this.$U(_d.$1m.$1r0)},set_$PK:function(n){this.$K(_d.$1m.$1r0,n);return n},get_$84:function(){return this.$U(_d.$1m.$1kL)},set_$84:function(n){this.$K(_d.$1m.$1kL,n);return n},get_$Fj:function(){return this.$U(_d.$1m.$1c3)},set_$Fj:function(n){this.$K(_d.$1m.$1c3,n);return n},get_$F6:function(){return this.$U(_d.$1m.$1cp)},set_$F6:function(n){this.$K(_d.$1m.$1cp,n);return n},get_$GW:function(){return this.$U(_d.$1m.$29q)},set_$GW:function(n){this.$K(_d.$1m.$29q,n);return n},get_$IT:function(){return this.$U(_d.$1m.$29r)},set_$IT:function(n){this.$K(_d.$1m.$29r,n);return n},get_$92:function(){return this.$U(_d.$1m.$1Wm)},set_$92:function(n){this.$K(_d.$1m.$1Wm,n);return n},get_$U1:function(){return this.$U(_d.$1m.$1Zv)},set_$U1:function(n){this.$K(_d.$1m.$1Zv,n);return n},$5LH:function(n){if(this.get_$6U()!==n.get_$6U()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$6U(),n.get_$6U());return!1}if(this.get_$2i()!==n.get_$2i()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$6(this.get_$2i())?0:this.get_$2i().length,$6(n.get_$2i())?0:n.get_$2i().length);return!1}if(this.get_$PK()!==n.get_$PK()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$PK(),n.get_$PK());return!1}if(this.get_$84()!==n.get_$84()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$84(),n.get_$84());return!1}if(this.get_$Fj()!==n.get_$Fj()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$Fj(),n.get_$Fj());return!1}if(this.get_$F6()!==n.get_$F6()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$F6(),n.get_$F6());return!1}if(this.get_$GW()!==n.get_$GW()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$GW(),n.get_$GW());return!1}if(this.get_$IT()!==n.get_$IT()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$IT(),n.get_$IT());return!1}var t=this.get_$3O()?this.get_$3O().Mailbox:null;var i=n.get_$3O()?n.get_$3O().Mailbox:null;if(!_d.$1m.$3dw(t,i)){_js.Trace.logInfo(_a.$0.$j,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1m.$1pF(this.get_$4B(),n.get_$4B(),this.get_$bX(),n.get_$bX())){_js.Trace.logInfo(_a.$0.$j,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$6(this.get_$4B())?0:this.get_$4B().get_$B(),$6(n.get_$4B())?0:n.get_$4B().get_$B(),$6(this.get_$bX())?0:this.get_$bX().length,$6(n.get_$bX())?0:n.get_$bX().length);return!1}if(!_d.$1m.$1pF(this.get_$4T(),n.get_$4T(),this.get_$ZX(),n.get_$ZX())){_js.Trace.logInfo(_a.$0.$j,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$6(this.get_$4T())?0:this.get_$4T().get_$B(),$6(n.get_$4T())?0:n.get_$4T().get_$B(),$6(this.get_$ZX())?0:this.get_$ZX().length,$6(n.get_$ZX())?0:n.get_$ZX().length);return!1}if(!_d.$1m.$1pF(this.get_$60(),n.get_$60(),this.get_$VQ(),n.get_$VQ())){_js.Trace.logInfo(_a.$0.$j,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$6(this.get_$60())?0:this.get_$60().get_$B(),$6(n.get_$60())?0:n.get_$60().get_$B(),$6(this.get_$VQ())?0:this.get_$VQ().length,$6(n.get_$VQ())?0:n.get_$VQ().length);return!1}if(!_d.$1m.$56B(this.get_$92(),n.get_$92())){_js.Trace.logInfo(_a.$0.$j,"snapshotAttachmentCount="+(this.get_$92()?this.get_$92().get_$B():0)+", contextAttachmentCount="+(n.get_$92()?n.get_$92().get_$B():0));return!1}if(!_d.$1m.$7QX(this.get_$U1(),n.get_$U1())){_js.Trace.logInfo(_a.$0.$j,"snapshotExtendedPropertyCount="+(this.get_$U1()?this.get_$U1().get_$B():0)+", contextExtendedPropertyCount="+(n.get_$U1()?n.get_$U1().get_$B():0));return!1}if(this.get_$Cu()!==n.get_$Cu()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$6(this.get_$Cu())?0:this.get_$Cu().length,$6(n.get_$Cu())?0:n.get_$Cu().length);return!1}_js.Trace.logInfo(_a.$0.$j,"Context is clean");return!0},$4e:function(n){if(!n){_js.Trace.logInfo(_a.$0.$j,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$6U()!==n.get_$6U()){_js.Trace.logInfo(_a.$0.$j,"sourceImportance={0}, targetImportance={1}",this.get_$6U(),n.get_$6U());return!1}if(this.get_$2i()!==n.get_$2i()){_js.Trace.logInfo(_a.$0.$j,"sourceSubject={0}, targetSubject={1}",this.get_$2i(),n.get_$2i());return!1}if(this.get_$PK()!==n.get_$PK()){_js.Trace.logInfo(_a.$0.$j,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$PK(),n.get_$PK());return!1}if(this.get_$84()!==n.get_$84()){_js.Trace.logInfo(_a.$0.$j,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$84(),n.get_$84());return!1}if(this.get_$Fj()!==n.get_$Fj()){_js.Trace.logInfo(_a.$0.$j,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$Fj(),n.get_$Fj());return!1}if(this.get_$F6()!==n.get_$F6()){_js.Trace.logInfo(_a.$0.$j,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$F6(),n.get_$F6());return!1}var t=this.get_$3O()?this.get_$3O().Mailbox:null;var i=n.get_$3O()?n.get_$3O().Mailbox:null;if(!_d.$1m.$3dw(t,i)){_js.Trace.logInfo(_a.$0.$j,"sourceFrom={0}, targetFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1m.$1pF(this.get_$4B(),n.get_$4B(),this.get_$bX(),n.get_$bX())){_js.Trace.logInfo(_a.$0.$j,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4B()?this.get_$4B().get_$B():0,n.get_$4B()?n.get_$4B().get_$B():0,this.get_$bX(),n.get_$bX());return!1}if(!_d.$1m.$1pF(this.get_$4T(),n.get_$4T(),this.get_$ZX(),n.get_$ZX())){_js.Trace.logInfo(_a.$0.$j,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4T()?this.get_$4T().get_$B():0,n.get_$4T()?n.get_$4T().get_$B():0,this.get_$ZX(),n.get_$ZX());return!1}if(!_d.$1m.$1pF(this.get_$60(),n.get_$60(),this.get_$VQ(),n.get_$VQ())){_js.Trace.logInfo(_a.$0.$j,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$60()?this.get_$60().get_$B():0,n.get_$60()?n.get_$60().get_$B():0,this.get_$VQ(),n.get_$VQ());return!1}if(!_d.$1m.$56B(this.get_$92(),n.get_$92())){_js.Trace.logInfo(_a.$0.$j,"sourceAttachmentCount="+(this.get_$92()?this.get_$92().get_$B():0)+", targetAttachmentCount="+(n.get_$92()?n.get_$92().get_$B():0));return!1}if(this.get_$Cu()!==n.get_$Cu()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$Cu()?this.get_$Cu().length:0,n.get_$Cu()?n.get_$Cu().length:0);return!1}_js.Trace.logInfo(_a.$0.$j,"snapshot is clean");return!0}};_d.$199=function(n,t){this.$$d_$7mm=Function.createDelegate(this,this.$7mm);if($6(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$2eb=t;this.$9O=n};_d.$199.prototype={$2eb:0,$9O:null,$18N:null,$8Dm:!0,$y:function(){!this.$18N&&this.$8Dm&&(this.$18N=_js.$J.get_$I().$1w(_a.$0.$j,"MailComposeTimer",this.$$d_$7mm,this.$2eb))},$1r:function(){if(this.$18N){_js.Trace.logInfo(_a.$0.$j,"Clearing timer.");this.$18N=_js.$J.get_$I().$4z(this.$18N)}},$7mm:function(){_js.Trace.logInfo(_a.$0.$j,"Executing timer callback.");this.$1r();this.$9O()}};_d.$Am=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){_d.$Am.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Am.initializeBase(this);_a.$4.$l(k,"nativeBridge");this.$1SJ=4;this.$d=n;this.$1z=t||new _y.$4c;this.$w=this.$vq();this.$R0=i;this.$6Q=r;this.$1uH=u;this.$k=new _d.$6s(this.$1z);this.$1T0=f;this.$1RU=s;this.$5C=e;this.$C=o;this.$Gk=h;this.$gj=c;this.$M=l;this.$5B=v;this.$1Bl=p;this.$D8=a;this.$2L=w;this.$Za=b;this.$1J=y;this.$12=k;_js.Trace.logInfo(_a.$0.$j,"ViewModel created")};_d.$Am.$7qY=function(){return(new Date).getTime()+":"+Math.random()};_d.$Am.prototype={$R0:null,$d:null,$6Q:null,$1uH:null,$1T0:null,$5C:null,$1RU:null,$1z:null,$C:null,$5B:null,$1Bl:null,$Gk:null,$M:null,$gj:null,$1J:null,$12:null,$2L:null,$Za:null,$17:null,$k:null,$KA:null,$w:null,$2Q2:!1,$Sm:!1,$3O3:!1,$3Rb:null,$3Ne:!1,$iy:!1,$D8:null,$1SJ:0,get_$fX:function(){return this.$w},set_$fX:function(n){if(this.$w!==n){this.$w=n;$3(this,"InfoBarViewModel")}return n},get_$1Ng:function(){return this.$17.$3c(0)},get_$3Rp:function(){return this.$17.$3c(11)},get_$24O:function(){return this.$17.$3c(2)},get_$7l0:function(){return this.$17.$3c(14)},get_$bp:function(){return this.$17.$3c(5)},get_$9q1:function(){return this.$17.$3c(12)},get_$7Zi:function(){return this.$17.$3c(17)},get_$8J2:function(){return this.$17.$3c(4)},get_$LS:function(){return this.$17.$3c(1)},get_$856:function(){return this.$17.$3c(6)},get_$1Hb:function(){return this.$17.$3c(7)},get_$1TD:function(){return this.$17.$3c(8)},get_$1bd:function(){return this.$17.$3c(9)},get_$20k:function(){return this.$17.$3c(10)},get_$1Ab:function(){return this.$17.$3c(18)},get_$9hA:function(){return this.$17.$3c(20)},get_$7Xe:function(){return this.$17.$3c(3)},get_$46O:function(){return this.$17.$3c(19)},get_$6Iq:function(){return this.$17.$3c(25)},get_$5JB:function(){return this.$17.$3c(21)},get_$2KL:function(){return this.$17.$3c(24)},get_$8Fz:function(){return this.$17.$3c(26)},get_$7ky:function(){return this.$17.$3c(27)},get_$5d9:function(){return!this.$C.get_$9A()},get_$9p5:function(){return!!this.get_$1bd()&&!this.$C.get_$Vm()},get_$1iT:function(){return this.$1SJ},set_$1iT:function(n){if(this.$1SJ!==n){this.$1SJ=n;$3(this,"PopupPanelSize")}return n},get_$2MT:function(){return this.get_$3Rp()?this.get_$3Rp().$$d_$2MT:null},get_$89:function(){return this.$KA},set_$89:function(n){_js.Trace.logInfo(_a.$0.$j,"Shell setting ClosePopupCommand from "+(this.$KA?"non-null":"null")+" to "+(n?"non-null":"null"));this.$KA=n;return n},get_$7iz:function(){return!0},get_$2OS:function(){return _a.UserAgent.getInstance().$141},get_$xM:function(){return _a.UserAgent.getInstance().$is},get_$UJ:function(){return _a.UserAgent.getInstance().$L2},get_$N4:function(){return _a.UserAgent.getInstance().$8l},get_$Ld:function(){return this.$C.get_$L()==="Mouse"?0:1},get_$433:function(){return this.$2Q2},set_$433:function(n){this.$2Q2=n;return n},get_$5bp:function(){return this.$Sm},set_$5bp:function(n){if(this.$Sm!==n){this.$Sm=n;$3(this,"IsInView")}return n},get_$6VT:function(){return this.$3O3},set_$6VT:function(n){var t=this.get_$6V7();if(this.$3O3!==t){this.$3O3=t;$3(this,"ShouldShowToolbarMessage")}return n},get_$6ba:function(){return this.$3Rb},set_$6ba:function(n){if(this.$3Rb!==n){this.$3Rb=n;$3(this,"ToolbarMessage")}return n},get_$9mI:function(){return this.$3Ne},set_$9mI:function(n){var t=this.get_$6V7();if(t!==this.$3Ne){this.$3Ne=t;$3(this,"ShouldBlockView")}return n},get_$xE:function(){return this.$iy},set_$xE:function(n){if(this.$iy!==n){this.$iy=n;$3(this,"IsNavigatingAway")}return n},get_$6V7:function(){return this.get_$1bd()&&(this.get_$1bd().get_$2Q0()||this.get_$1bd().get_$32h())?!0:this.get_$1Hb()&&this.get_$1Hb().$LA?!0:!1},get_$5Jc:function(){return!_a.$10.get_$7Z()||_a.$10.get_$7Z().toLowerCase()!=="pl-pl"},$49:function(){this.$d.get_$7g()&&this.$d.get_$1DF()||this.$d.set_$7g(_d.$Am.$7qY());_js.Trace.logInfo(_a.$0.$j,"Init:Context:"+this.$d.toString());this.$17||(this.$17=new _d.$PM(this,this.$D8,this.$5B,this.$1J,this.$1Bl,this.$2L,this.$12));if(this.$w){this.$w.$Au();this.$d.get_$3PW()&&this.$w.$113(this.$d.get_$3PW());this.$d.get_$Pl()&&this.$6XG()}this.set_$xE(!1);this.$17.$3c(0).$49()},$9i6:function(n){this.set_$7D(n);_js.Trace.logInfo(_a.$0.$j,"Set screen view model appbar. ContextId="+this.$d.get_$7g())},$GN:function(){_y.$1KT.prototype.$GN.call(this);var n=this.get_$1Ng();if(n.get_$Cf()){_js.Trace.logInfo(_a.$0.$j,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$57e()}else _js.Trace.logInfo(_a.$0.$j,"PostTransitionIn view model, not initialized yet");this.set_$5bp(!0);_a.$6.acea(null,"VM.MailCompose.Navigate")},$Uz:function(){_js.Trace.logInfo(_a.$0.$j,"Post transition out, context:"+this.$d.toString());if(this.$17){var t=this.get_$24O();if(t){var n=t.get_$4i();if(n&&n.get_$31u()){this.$17.$Au();this.$d&&this.$d.$Au();this.$w&&this.$w.$9e.$1r();this.get_$2KL()&&this.get_$2KL().$6a.$1vn(!1);n.set_$31u(!1)}else _js.Trace.logInfo(_a.$0.$j,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$j,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$j,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2Q2=!1;this.set_$5bp(!1);_y.$1KT.prototype.$Uz.call(this)},$F4:function(){var n=this.$17.$3c(5);if(n.get_$CM()){_js.Trace.logInfo(_a.$0.$j,"Dirty due to attachment in progress");return!0}var t=this.$17.$3c(1);t.$2fT();return this.$d.$F4()},$vq:function(){$6(this.$w)&&this.set_$fX(new _y.$6J);return this.$w},$9Tj:function(){_h.$4V.$9Th()},$9dl:function(){_h.$4V.$6Ov()},$6XG:function(){var n=_a.$s.$16p(this.$C.get_$L()==="Mouse",!0,!0,this.$d.get_$40()===1||this.$d.get_$40()===2||this.$d.get_$40()===3,this.$d.get_$40()===3,!!this.$d.get_$E3()&&this.$d.get_$E3().get_$14J());n&&this.$w.$113(n)},$4c:function(){_js.Trace.logInfo(_a.$0.$j,"Disposing view model, context: "+(this.$d?this.$d.toString():"null"));if(this.$17){this.$17.$Au();this.$17=null}_a.$1.prototype.$4c.call(this)}};_d.$AU=function(n,t,i,r){this.$$d_$7vK=Function.createDelegate(this,this.$7vK);this.$$d_$3l1=Function.createDelegate(this,this.$3l1);this.$$d_$7eX=Function.createDelegate(this,this.$7eX);_d.$AU.initializeBase(this);this.$5Bs=r;this.$5Y=r.$5Y;this.$2L=n;this.$c=t;this.$37=r.$37;this.$6h=i};function $2hP(n,t,i){n.$nu=t;var f=t===1||t===2||t===3;var e=_a.$s.$2t&&n.$5Y.get_$GD()&&!n.$5Y.get_$I3()&&f;if(e){_js.Trace.logInfo(_a.$0.$4A,"Decoding S/MIME item before response...");var r=_a.$s.$16p(_y.$v.$v.get_$L()==="Mouse",n.$5Y.get_$1b4(),!0,!0,t===3,n.$5Y.get_$14J());if(!r||_a.$2H.$14S(r)){var u=new _h.$G0(200,n.$5Y);var o=this;u.add_$1x(function(){r=u.$1f});var s=this;u.add_$2m(function(){$3Wn(n,i,r)});OwaApplication.$1W.$z(u)}else $3Wn(n,i,r)}else $3Wn(n,i,null)}function $3Wn(n,t,i){var e=_g.$33.isInstanceOfType(n.$5Y);t||(t=!_y.$v.$v.get_$9A());var r=n.$6h.$G3(t,!1);t&&r.set_$61(0);if(i){_js.Trace.logInfo(_a.$0.$4A,"An error occurred when decoding the S/MIME item before response: "+i.message);r.set_$3PW(i)}var u=null;switch(n.$nu){case 1:u=!r.get_$61()||e?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:u=!r.get_$61()||e?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:u=!r.get_$61()||e?"MailComposeForwardPopOut":"MailComposeForward";break;case 12:u="MailComposePostReply";break;default:break}u&&r.set_$QB(_y.$2S.$1c(_a.$0.$I6,u,!0));r.set_$1hz(n.$5Y.get_$28());n.$37&&r.set_$o0(n.$37.get_$o0());r.set_$40(n.$nu);r.set_$Na(!0);r.set_$rU(!0);var f=new _g.$BY;f.Mailbox=new _g.$1l;f.Mailbox.EmailAddress=n.$c.get_$31().get_$Aj();f.Mailbox.Name=n.$c.get_$31().get_$FS();f.Mailbox.MailboxType="Mailbox";f.Mailbox.RoutingType="SMTP";r.set_$8X(f);if(e){var o=n.$5Y;if(o.get_$x8())r.$13p(o);else{r.set_$14D(!0);r.set_$dJ(n.$5Y.get_$i());r.set_$rN(_g.$33.$rN(o))}}else r.$13p(n.$5Y);if(_g.$7g.isInstanceOfType(n.$5Y)){var s=_a.$s.get_$mr();s&&r.$A1P(n.$5Y.get_$1qs());n.$5Y.get_$I3()||r.get_$Pl()&&s?$6uG(n,r):n.get_$4i().$T7(r)}else n.get_$4i().$T7(r)}function $6uG(n,t){_js.Trace.logInfo(_a.$0.$4A,"S/MIME context upgrading started.");if(n.$5Y.get_$I3()||n.$5Y.get_$Ir())$4mj(n,t);else{_js.Trace.logInfo(_a.$0.$4A,"The original item's NormalizedBody is not available, fetch it now.");var i=new _h.$Ip(200,[n.$5Y.get_$i()],_h.$15.get_$xY(),"ItemNormalizedBody",2,!1);var r=this;i.add_$1x(function(){_js.Trace.logWarning(_a.$0.$4A,"The original item's NormalizedBody cannot be retrieved.");t.set_$3PW(_a.$2H.$E(_u.Strings.l_Smime_QuotedBodyIsNotComplete_Text,30))});var u=this;i.add_$2m(function(){$4mj(n,t)});OwaApplication.$1W.$z(i)}}function $4mj(n,t){var i=t.get_$3n()==="HTML";var r;if(n.$5Y.get_$V7())r=n.$5Y.get_$V7().get_$1g();else{var u=n.$5Y.get_$Ir()||n.$5Y.get_$Lb();if(u)r=i?u.get_$1g():$6uI(n,u);else{_js.Trace.logError(_a.$0.$4A,"The body of original message is not available.");r=""}}i&&(r=_a.$3N.$9b9(r));var f=new _d.$CY(i,n.$5Y);t.set_$NV($6uH(n,i,r,f.toString()));t.set_$Na(!1);_a.$s.$2t&&n.$5Y.get_$GD()?t.set_$92($4mi(n,i,!1,n.$5Y.get_$h2())):t.set_$92($4mi(n,i,!0,n.$5Y.get_$1N()));t.set_$EH(!0);_js.Trace.logInfo(_a.$0.$4A,"S/MIME context upgrading completed.");n.get_$4i().$T7(t)}function $6uI(n,t){var i=t.get_$1g();if(t.get_$3n()==="Text")return i;else{i=i.replace(new RegExp("\\r|\\n","g"),"");i=i.replace(new RegExp("<br[\\s\\S]*?>|</?\\s*p[\\s\\S]*?>","gim"),"\r\n");i=i.replace(new RegExp("<img[\\s\\S]*?>|<image[\\s\\S]*?>","gim"),"[X]");i=i.replace(new RegExp("<[\\s\\S]*?>","gm"),"");return i}}function $6uH(n,t,i,r){var e=n.$c.get_$1I();var f=e.get_$11H()?(t?e.get_$4X3():e.get_$17s())||"":"";if(t){r=_js.$9.$a(f)?"<p></p><p></p>"+r:"<p></p><p></p>"+f+"<p></p>"+r;var u=i.indexOf("<body");if(u<0)return r+i;else{while(u<i.length&&i.charAt(u++)!==">");i=i.substring(0,u)+r+i.substring(u,i.length);return i}}else{r=_js.$9.$a(f)?"\r\n"+r:"\r\n\r\n"+f.trim()+"\r\n"+r;return r+i}}function $4mi(n,t,i,r){if(!r||!r.get_$B())return null;if(n.$nu===3){var u=new _js.$Z;var e=this;r.$Bh(function(n){var t=n;t=t.$3p();i&&!_g.$4x.isInstanceOfType(t)&&(t=_g.$4x.$5Om(t,t.get_$IH()));u.$D(t)});return u.get_$B()>0?u:null}else if(n.$nu===1||n.$nu===2){var f=new _js.$Z;var o=this;r.$Bh(function(n){if(_g.$4x.isInstanceOfType(n)&&n.get_$6D()&&t){var i=n;i=i.$3p();f.$D(i)}});return f.get_$B()>0?f:null}else return null}_d.$AU.prototype={$c:null,$2L:null,$5Y:null,$37:null,$5Bs:null,$6h:null,$3m:null,$nu:0,get_$4i:function(){$6(this.$3m)&&(this.$3m=new _y.$CS);return this.$3m},set_$4i:function(n){this.$3m=n;return n},$1hT:function(n){_a.$6.stPT(_a.$0.$I6,"MailComposeReply",3);this.$2L.$4bQ("Inference.Reply",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$37?this.$37.get_$ML():null);$2hP(this,1,n)},$1hU:function(n){_a.$6.stPT(_a.$0.$I6,"MailComposeReplyAll",3);this.$2L.$4bQ("Inference.ReplyAll",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$37?this.$37.get_$ML():null);$2hP(this,2,n)},$4KV:function(n){_a.$6.stPT(_a.$0.$I6,"MailComposePostReply",3);this.$2L.$SA("Inference.PostReply",this.$5Y.get_$i());$2hP(this,12,n)},$1hE:function(n){_a.$6.stPT(_a.$0.$I6,"MailComposeForward",3);this.$2L.$4bQ("Inference.Forward",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$37?this.$37.get_$ML():null);$2hP(this,3,n)},$6E3:function(){if(!this.$5Bs.get_$2o3())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$h.$1i.nameToId("drafts");var n=new _c.$13R(this.$5Y.get_$i().Id,t.Id);n.add_$2C(this.$$d_$7eX);n.add_$1x(this.$$d_$3l1);OwaApplication.$1W.$z(n)},$7eX:function(n){var i=n.$1gd;if(i.length>0){var t=_d.$Ak.$3kK(_g.$1q.$2Hc(i));t.add_$2C(this.$$d_$7vK);t.add_$1x(this.$$d_$3l1);OwaApplication.$1W.$z(t)}else this.$3l1(n)},$3l1:function(n){this.$37.get_$fX().$5S(9500);this.$37.get_$fX().$2a(9500)},$7vK:function(n){var t=n;if(t.$G6){this.$37.get_$fX().$5S(9500);var i=this.$6h.$3k2(t.get_$i(),!1,t.$G6.get_$gS(),t.$G6.get_$5n());_y.$v.$v.get_$9A()||i.set_$61(0);this.get_$4i().$T7(i)}else this.$3l1(n)}};_d.$qK=function(n,t,i){this.$2L=n;this.$c=t;this.$6h=i};_d.$qK.prototype={$2L:null,$c:null,$6h:null,$8A:function(n){return new _d.$AU(this.$2L,this.$c,this.$6h,n)}};_d.$kI=function(){_d.$kI.initializeBase(this)};_d.$kI.prototype={$1kK:null,$1kJ:"Normal",$1xH:!1,$1yT:!1,$10C:!1,$10D:!1,$3PV:!1,$3PY:!1,$3m:null,$3P2:!1,$4dx:!1,$4ds:!1,get_$9hi:function(){if($6(this.$1kK)){this.$1kK=new _js.$Z;this.$1kK.$D("Normal");this.$1kK.$D("Personal");this.$1kK.$D("Private");this.$1kK.$D("Confidential")}return this.$1kK},get_$84:function(){return this.$1kJ},set_$84:function(n){if(this.$1kJ!==n){this.$1kJ=n;$3(this,"Sensitivity")}return n},get_$Fj:function(){return this.$1xH},set_$Fj:function(n){if(this.$1xH!==n){this.$1xH=n;$3(this,"IsDeliveryReceiptRequested")}return n},get_$9nw:function(){return!OwaApplication.$13D},get_$F6:function(){return this.$1yT},set_$F6:function(n){if(this.$1yT!==n){this.$1yT=n;$3(this,"IsReadReceiptRequested")}return n},get_$9pE:function(){return!OwaApplication.$13D},get_$9pX:function(){return this.$3P2},set_$9pX:function(n){if(this.$3P2!==n){this.$3P2=n;$3(this,"ShowSmimeOptions")}return n},get_$GW:function(){return this.$10C},set_$GW:function(n){if(this.$10C!==n){this.$10C=n;$3(this,"SmimeEncryptMessage")}return n},get_$IT:function(){return this.$10D},set_$IT:function(n){if(this.$10D!==n){this.$10D=n;$3(this,"SmimeSignMessage")}return n},get_$6Xx:function(){return this.$3PV},set_$6Xx:function(n){if(this.$3PV!==n){this.$3PV=n;$3(this,"SmimeEncryptMessageIsEnabled")}return n},get_$6Xy:function(){return this.$3PY},set_$6Xy:function(n){if(this.$3PY!==n){this.$3PY=n;$3(this,"SmimeSignMessageIsEnabled")}return n},get_$A2g:function(){return this.$4ds},set_$A2g:function(n){if(this.$4ds!==n){this.$4ds=n;$3(this,"WaitingForPreviousAction")}return n},get_$4i:function(){return this.$3m},set_$4i:function(n){if(this.$3m!==n){this.$3m=n;$3(this,"Conductor")}return n},$13o:function(n){this.$4dx=n.get_$Pl();this.set_$9pX(_a.$s.$2t&&_a.$s.get_$2ON()&&n.$43C());this.set_$A2g(!1);this.set_$84(n.get_$84());this.set_$Fj(n.get_$Fj());this.set_$F6(n.get_$F6());this.set_$GW(n.get_$GW());this.set_$IT(n.get_$IT());this.set_$6Xx(n.get_$6Xx());this.set_$6Xy(n.get_$6Xy())}};_d.$CY=function(n,t){this.$40v=n;this.$k6=t};function $4no(n,t){if(!t||!t.get_$B())return null;var i=new(_0365f.$o.$$(String));var r=this;t.$Bh(function(t){i.$D($3XI(n,t))});return i.$6Z()}function $3XI(n,t){return t?t.Name||t.OriginalDisplayName||t.EmailAddress||"":""}function $1Vh(n,t,i){return n.$40v?"<b>"+t+"</b> "+i:t+" "+i}_d.$CY.prototype={$k6:null,$40v:!1,toString:function(){_js.Trace.logInfo(_a.$0.$j,"Building message headers for reply/fwd. locally.");var t=this.$k6.get_$3O()?$3XI(this,this.$k6.get_$3O().Mailbox):null;var i=this.$k6.get_$8X()?$3XI(this,this.$k6.get_$8X().Mailbox):null;var f=this.$k6.get_$q2()||this.$k6.get_$129();var h=(f?f.toString():this.$k6.get_$9Yp())||null;var e=$4no(this,this.$k6.get_$4B());var o=$4no(this,this.$k6.get_$4T());var c=this.$k6.get_$nk()||this.$k6.get_$2i()||_u.Strings.l_EmptySubjectMask_Text;var r=null;var u=null;if(_g.$RD.isInstanceOfType(this.$k6)){var n=this.$k6;if(n.get_$3xA()){var l=new _d.$GQ;r=l.$36(n.get_$3xA(),null)}n.get_$KB()&&n.get_$KB().get_$4j()&&(u=n.get_$KB().get_$4j().get_$1o())}i&&i.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.Strings.l_OnBehalfOf_Text,i,t));var a=$1Vh(this,_nbs.NonBootStrings.l_FromLabel_Text,t);var v=$1Vh(this,_nbs.NonBootStrings.l_SentLabel_Text,h);var y=e?$1Vh(this,_u.Strings.l_ToRecipientsLabel_Text,e.join("; ")):null;var p=o?$1Vh(this,_u.Strings.l_CcRecipientsLabel_Text,o.join("; ")):null;var w=$1Vh(this,_nbs.NonBootStrings.l_SubjectLabel_Text,c);var b=r?$1Vh(this,_nbs.NonBootStrings.l_WhenLabel_Text,r):null;var k=u?$1Vh(this,_nbs.NonBootStrings.l_WhereLabel_Text,u):null;var s=this.$7Sw(a,v,y,p,w,b,k);return this.$40v?'<p style="border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+s.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",s.join("\r\n"))},$7Sw:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];for(var r=new(_0365f.$o.$$(String)),u=i,e=u.length,t=0;t<e;++t){var f=u[t];_js.$9.$a(f)||r.$D(f)}return r.$6Z()}};_d.$1KX=function(n,t,i,r,u){_d.$1KX.initializeBase(this);this.$66e=n;this.$5MT=i;this.$5L1=r;this.$6Sb=_js.$9.$a(t)?_nbs.NonBootStrings.l_SubmessageSeparator_Text:t;this.$5WA=u};_d.$1KX.prototype={$66e:null,$5MT:null,$5L1:null,$6Sb:null,$5WA:!1};_d.$XR=function(n,t){this.$2L=n;this.$fv=t;this.$1UO=new _c.$FZ;this.$3hr=new(_a.$7q.$$(_c.$C9))(5)};function $4lh(n,t,i,r,u,f){n.$1UO.set_$9g0(u);var e=new _c.$C9(t,n.$1UO,i,r,f,n.$fv);n.$3hr.$D(e);return e}_d.$XR.prototype={$2L:null,$fv:null,$1UO:null,$3hr:null,$85g:function(n,t){return new _d.$pp(n,t)},$3l5:function(n,t,i){return $4lh(this,n,t,this.$2L,i,null)},$7eS:function(n,t,i,r){return $4lh(this,n,t,null,i,r)},$7t5:function(){for(var t=new(_0365f.$o.$$(_c.$Bo)),i=this.$3hr.$6Z(),r=i.length,n=0;n<r;++n){var u=i[n];t.$69(u.$7t3())}return t.$6Z()},$5FP:function(n,t){return new _d.$x9(n,t)}};_d.$pp=function(n,t){_d.$pp.initializeBase(this);this.$1Mu=new _d.$Ut;this.$1Mu.$Y("SelectedRefiner",n);this.$1Uw=new _d.$Ut;this.$1Uw.$Y("SelectedRefiner",n);this.$1Mm=new _d.$Ut;this.$1Mm.$Y("SelectedRefiner",n);this.$1KC=new _d.$Ut;this.$1KC.$Y("SelectedRefiner",n);this.$1Lp=new _d.$Ut;this.$1Lp.$Y("SelectedRefiner",n)};_d.$pp.$7bw=function(){var n=new _js.$Z;n.$D(_d.$pp.$XO.$4IX);n.$D(_d.$pp.$XO.$4IW);n.$D(_d.$pp.$XO.$4IY);return n};_d.$pp.prototype={$1Mu:null,$1Uw:null,$1Mm:null,$1KC:null,$1Lp:null,$Ce:null,$6g:!1,get_$7qG:function(){return this.$1Mu},get_$9Z7:function(){return this.$1Uw},get_$7pP:function(){return this.$1Mm},get_$7RQ:function(){return this.$1KC},get_$7gE:function(){return this.$1Lp},get_$q:function(){return this.$6g},set_$q:function(n){this.$6g=n;$N(this,"IsHidden");return n},get_$7fg:function(){return this.$Ce},set_$7fg:function(n){this.$Ce=n;return n},$9ja:function(n){for(var r=n,u=r.length,i=0;i<u;++i){var t=r[i];_js.Trace.logInfo(_a.$0.$N2,"PropertyPath: {0} ",t.RefinerCategory,t.RefinerDataEntryTypes.length);switch(t.RefinerCategory){case 4:this.$1KC.$2c4(_d.$pp.$178.$7ra(t.RefinerDataEntryTypes));break;case 5:this.$1Mm.$2c4(_d.$pp.$178.$7tw(this.$Ce,t.RefinerDataEntryTypes));break;case 3:this.$1Mu.$2c4(_d.$pp.$178.$5S6(t.RefinerDataEntryTypes));break;case 2:this.$1Uw.$2c4(_d.$pp.$178.$5S6(t.RefinerDataEntryTypes));break}}this.$1Lp.$2c4(_d.$pp.$7bw());this.set_$q(!1)},$7x1:function(){var t=[];var n=null;if(this.$1KC.$df){n=this.$1KC.$df.$2Zr;Array.add(t,n)}if(this.$1Mm.$df){n=this.$1Mm.$df.$2Zr;Array.add(t,n)}if(this.$1Mu.$df){n=this.$1Mu.$df.$2Zr;Array.add(t,n)}if(this.$1Uw.$df){n=this.$1Uw.$df.$2Zr;Array.add(t,n)}if(t.length){var i=new _g.$f8;i.RefinerQueries=t;return i}else return null},$7sp:function(){if(!this.$1Lp.$df)return null;var i=this.$1Lp.$df;var n=_a.$7.get_$29();if(i===_d.$pp.$XO.$4IX)n=n.$2o(-7);else if(i===_d.$pp.$XO.$4IW)n=n.$HM(-1);else if(i===_d.$pp.$XO.$4IY)n=n.$hb(-1);else return null;var t=new _g.$XZ;t.Item=new _g.$1X("DateTimeReceived");t.FieldURIOrConstant=new _g.$In;var r=new _g.$Ih;r.Value=n.$99();t.FieldURIOrConstant.Item=r;return new _g.$J9(t)},$6OC:function(){this.set_$q(!0);this.$1Mu&&this.$1Mu.$2aM();this.$1Uw&&this.$1Uw.$2aM();this.$1KC&&this.$1KC.$2aM();this.$1Lp&&this.$1Lp.$2aM();this.$1Mm&&this.$1Mm.$2aM()}};_d.$pp.$XO=function(){};_d.$pp.$178=function(){};_d.$pp.$178.$7tw=function(n,t){for(var f=new _js.$Z,e=0,o=t,s=o.length,i=0;i<s;++i){var r=o[i];if(e++>=10)break;var u=null;n&&(u=n.$R2(r.FolderId));if(u){f.$D(new _d.$YK(u.get_$1o(),r.HitCount,r.RefinementQuery));e++}}return f};_d.$pp.$178.$7ra=function(n){for(var r=new _js.$Z,u=n,f=u.length,t=0;t<f;++t){var i=u[t];i.WithAttachments&&r.$D(new _d.$YK(_nbs.NonBootStrings.l_AttachmentRefiner_Text,i.HitCount,i.RefinementQuery))}return r};_d.$pp.$178.$5S6=function(n){for(var r=new _js.$Z,f=0,u=n,e=u.length,i=0;i<e;++i){var t=u[i];if(f++>=10)break;var o=_d.$pp.$178.$SR(t.DisplayName,t.SmtpAddress);var s=new _d.$yo(o,t.HitCount,t.RefinementQuery);r.$D(s)}return r};_d.$pp.$178.$SR=function(n,t){var i=new _g.$1l;i.EmailAddress=t;var r=_h.$41.$DQ(i);r.set_$1F(1);var u=new _y.$w(r,6,!1,0,null,null,_y.$v.$v);u.$KW(0,n,0);return u};_d.$x9=function(n,t){_d.$x9.initializeBase(this);this.$1lI=t;if(this.$1lI.$1lK.toLocaleUpperCase().startsWith(n.toLocaleUpperCase())){this.$4T1=n;this.$4T5=this.$1lI.$1lK.substr(n.length)}else{this.$4T1="";this.$4T5=this.$1lI.$1lK}};_d.$x9.prototype={$1lI:null,$4T1:null,$4T5:null,get_$2bB:function(){return this.$1lI.$1lK},get_$Ac:function(){return this.$1lI.$1lK},get_$8AG:function(){return this.$1lI.$Bw===3}};_d.$yo=function(n,t,i){_d.$yo.initializeBase(this,[n.$14.get_$1o(),t,i]);this.$6e=n};_d.$yo.prototype={$6e:null};_d.$YK=function(n,t,i){_d.$YK.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$YK.initializeBase(this);this.$12U=n;this.$67n=t;this.$2Zr=i};_d.$YK.prototype={$12U:null,$67n:0,$2Zr:null};_d.$Ut=function(){this.$$d_$9on=Function.createDelegate(this,this.$9on);this.$275=new _js.$Z;this.$2sN=new _js.$Z;_d.$Ut.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Ut.initializeBase(this);this.$9oo=new _C(this.$$d_$9on,_a.$0.$Aw)};_d.$Ut.prototype={$df:null,$9oo:null,$6WL:!1,get_$6WM:function(){return this.$6WL},set_$6WM:function(n){this.$6WL=n;$N(this,"ShowLoadMoreButton");return n},get_$97K:function(){return!this.$275||!this.$275.get_$B()},get_$6MJ:function(){return this.$275},set_$6MJ:function(n){this.$275=n;this.set_$3ny(n);$N(this,"NoRefinersAvailable");return n},get_$3ny:function(){return this.$2sN},set_$3ny:function(n){this.$2sN=n;this.$df=null;$N(this,"DisplayedRefinerValues");return n},get_$9gh:function(){return this.$df},set_$9gh:function(n){this.$df=n;$N(this,"SelectedRefiner");return n},$2aM:function(){this.$df=null;this.set_$6WM(!1);this.set_$3ny(new _js.$Z);this.set_$6MJ(new _js.$Z)},$2c4:function(n){this.$df||this.set_$6MJ(n)},$9on:function(){this.set_$3ny(this.$275);this.set_$6WM(!1)}};_d.$Dd=function(n,t,i,r,u,f,e,o){this.$$d_$9IN=Function.createDelegate(this,this.$9IN);this.$$d_$7Wt=Function.createDelegate(this,this.$7Wt);this.$$d_$9ER=Function.createDelegate(this,this.$9ER);this.$$d_$9EQ=Function.createDelegate(this,this.$9EQ);this.$$d_$9N5=Function.createDelegate(this,this.$9N5);this.$$d_$9A4=Function.createDelegate(this,this.$9A4);_d.$Dd.initializeBase(this);_a.$4.$J(n,"message");this.$lK=n;this.$5H=t;this.$5CI=f;this.$1W=i;this.$C=r;this.$Jm=u;this.$6h=e;this.$13=o;this.$3ds=new _C(this.$$d_$9A4,_a.$0.$1WW);this.$4Q4=new _C(this.$$d_$9N5,_a.$0.$1WW);this.$5K7=new _C(this.$$d_$9EQ,_a.$0.$1WW);this.$5K8=new _C(this.$$d_$9ER,_a.$0.$1WW);this.$vQ=new _C(this.$$d_$7Wt,_a.$0.$1WW);this.$13=_a.UserAgent.getInstance();this.$3dr=$4jU(this,!0);this.$4Q2=$4jU(this,!1);this.$3dr||(this.$566=this.$3ds);this.$4Q2||(this.$6Ma=this.$4Q4);$4jX(this);this.$lK.$Y("LastVerbExecuted",this.$$d_$9IN);this.$lK.get_$IY().$Y("IsUndecidedApprovalRequest",this.$$d_$9IN)};function $4jX(n){n.set_$9nN(!!n.$lK.get_$IY()&&n.$lK.get_$IY().get_$43g()&&n.$lK.get_$mx()!==1&&n.$lK.get_$mx()!==2)}function $4jU(n,t){var i=t?0:1;if(n.$lK.get_$Jt()&&n.$lK.get_$Jt().UserOptions&&n.$lK.get_$Jt().UserOptions.length>=i&&n.$lK.get_$Jt().UserOptions[i].SendPrompt==="Send")return null;var r=[new _0365m.$m(_nbs.NonBootStrings.l_EditResponseBeforeSending_LowerCase_Text,null,t?n.$5K7:n.$5K8),new _0365m.$m(_nbs.NonBootStrings.l_SendResponseNow_LowerCase_Text,null,t?n.$3ds:n.$4Q4)];n.$C.get_$L()==="TouchNarrow"&&Array.add(r,new _0365m.$m(_nbs.NonBootStrings.l_TNarrowCloseMenuItemLabel_Text,null,n.$vQ));return new _0365m.$2b(r)}function $4jW(n,t){if(!n.$5H){var i=new _c.$aW(n.$lK,null,t,1);n.$1W.$z(i);$6oK(n)}}function $4jV(n,t){if(!n.$5H){var i=n.$6h.$G3(!1,!1);i.set_$40(t?9:10);i.set_$Na(!0);i.set_$61(n.$C.get_$L()==="Mouse"?1:2);i.$13p(n.$lK);n.$5CI().$T7(i)}}function $6oK(n){switch(n.$C.get_$L()){case"TouchNarrow":n.$Jm.$Bs();break;case"TouchWide":break;case"Mouse":if(!n.$C.get_$9A()){var t=window.self;_js.$J.get_$I().$3r(_a.$0.$62,"ApprovalRequestHeaderViewModel.PopOutClose",t.$$d_close||(t.$$d_close=Function.createDelegate(t,t.close)))}break}}_d.$Dd.prototype={$lK:null,$C:null,$6h:null,$5CI:null,$1W:null,$3ds:null,$4Q4:null,$5K7:null,$5K8:null,$566:null,$6Ma:null,$vQ:null,$Jm:null,$5H:!1,$13:null,$3dr:null,$4Q2:null,$3O8:!1,get_$9nN:function(){return this.$3O8},set_$9nN:function(n){if(n!==this.$3O8){this.$3O8=n;$3(this,"ShowApproveRejectButtons")}return n},get_$j2:function(){return this.$13.get_$ZS().get_$j2()},$9IN:function(n,t){$4jX(this)},$9A4:function(){$4jW(this,!0)},$9N5:function(){$4jW(this,!1)},$9EQ:function(){$4jV(this,!0)},$9ER:function(){$4jV(this,!1)},$7Wt:function(){}};_d.$mw=function(n,t,i,r,u){this.$C=n;this.$Jm=t;this.$k=i;this.$6h=r;this.$13=u};_d.$mw.prototype={$C:null,$Jm:null,$k:null,$6h:null,$13:null,$E:function(n,t,i){t||(t=_y.$CS.$5HT);return new _d.$Dd(n,i,this.$k,this.$C,this.$Jm,t,this.$6h,this.$13)}};_d.$o1=function(n){this.$3w6=n};_d.$o1.prototype={$3w6:null,get_$42g:function(){return!1},$Bj:function(){return!0},$5Pa:function(n,t){var i=$6(t);return new _0365m.$cl(new _cc.$S3(this.$3w6,this.$3w6),i)}};_d.$BM=function(n,t,i,r){this.$$d_$3Ew=Function.createDelegate(this,this.$3Ew);this.$$d_$4Ic=Function.createDelegate(this,this.$4Ic);this.$$d_$99G=Function.createDelegate(this,this.$99G);this.$$d_$6P0=Function.createDelegate(this,this.$6P0);this.$$d_$9VH=Function.createDelegate(this,this.$9VH);this.$$d_$9Ql=Function.createDelegate(this,this.$9Ql);_d.$BM.initializeBase(this);_a.$4.$J(n,"meetingRequest");this.$In=n;this.$1W=i;this.$2U=t;this.$C=r;this.set_$3zr(!1);this.$1iX=new _js.$Z;this.$ve=new _js.$Z;this.$1aL=new _js.$Z;var u=this;this.$1m1=new _C(this.$$d_$9Ql,_a.$0.$1k,this,"ShowConflicts",function(){return u.get_$9nh()});this.$6J3=new _C(this.$$d_$9VH,_a.$0.$1k)};function $6re(n,t){var i=this;n.$2U.$1Mx(function(){var r=n.$In.get_$1Sb().Mailbox.EmailAddress;var i=n.$2U.$3sg(r);i?n.$2U.$5hh(i,function(){t()},function(){$4l9(n,_nbs.NonBootStrings.l_UnableToGetConflicts_Text)}):$4l9(n,String.format(_nbs.NonBootStrings.l_ConflictsFormSubscribedCalendarOnly_Text,n.$In.get_$1Sb().Mailbox.Name))})}function $4l9(n,t){n.set_$1CV(t);n.set_$Cf(!0)}function $6rh(n,t){t.add_$2C(n.$$d_$99G);t.add_$1x(n.$$d_$4Ic);t.add_$2m(n.$$d_$3Ew)}function $6ri(n,t){t.remove_$2C(n.$$d_$99G);t.remove_$1x(n.$$d_$4Ic);t.remove_$2m(n.$$d_$3Ew)}function $6rd(n){if(!n.get_$3vX()&&!n.get_$1vU()){n.set_$1CV(_nbs.NonBootStrings.l_NoConflicts_Text);return}n.$2OW?n.get_$1vU()?n.set_$1CV(_nbs.NonBootStrings.l_HideConflicts_Text):n.set_$1CV(_nbs.NonBootStrings.l_HideAdjacents_Text):n.get_$1vU()?n.set_$1CV(_nbs.NonBootStrings.l_ShowConflicts_Text):n.set_$1CV(_nbs.NonBootStrings.l_ShowAdjacents_Text)}function $4lA(n,t){return t.get_$9S()!=="Free"}function $6rf(n){var i=new _js.$Z;if(!$6(n.$In.get_$1L6()))for(var t=0;t<n.$In.get_$1L6().Items.length;t++){var r=new _g.$33(n.$In.get_$1L6().Items[t]);$4lA(n,r)&&i.$D(r)}n.set_$7ZV(i)}function $6rg(n){var r=new _js.$Z;var u=new _js.$Z;if(!$6(n.$In.get_$1Jm()))for(var i=0;i<n.$In.get_$1Jm().Items.length;i++){var t=new _g.$33(n.$In.get_$1Jm().Items[i]);$4lA(n,t)&&(t.get_$y().$2R(n.$In.get_$y())>0?u.$D(t):r.$D(t))}n.set_$9Vq(r);n.set_$7pS(u)}_d.$BM.prototype={$1W:null,$2U:null,$C:null,$1m1:null,$In:null,$1iX:null,$ve:null,$1aL:null,$3rn:null,$3MV:null,$3iu:null,$4OP:null,$2OW:!1,$7A:!1,$2xh:null,$6J3:null,get_$9Vq:function(){return this.$1iX},set_$9Vq:function(n){if(this.$1iX!==n){this.$1iX=n;$3(this,"PrecedingEvents")}return n},get_$7ZV:function(){return this.$ve},set_$7ZV:function(n){if(this.$ve!==n){this.$ve=n;$3(this,"ConflictingEvents")}return n},get_$7pS:function(){return this.$1aL},set_$7pS:function(n){if(this.$1aL!==n){this.$1aL=n;$3(this,"FollowingEvents")}return n},get_$9nh:function(){return this.get_$6VN()&&this.$7A&&(this.get_$3vX()||this.get_$1vU())},get_$3zr:function(){return this.$2OW},set_$3zr:function(n){this.$2OW=n;$6rd(this);$3(this,"IsConflictDetailsExpanded");return n},get_$1CV:function(){return this.$2xh},set_$1CV:function(n){if(this.$2xh!==n){this.$2xh=n;$3(this,"HeaderString")}return n},get_$1vU:function(){return this.$ve&&this.$ve.get_$B()>0?!0:this.$In.get_$2HH()>0},get_$3vX:function(){return this.$1iX&&this.$1iX.get_$B()>0||this.$1aL&&this.$1aL.get_$B()>0?!0:this.$In.get_$2EM()>0},get_$9nF:function(){return this.get_$3vX()&&!this.get_$1vU()},get_$7ZU:function(){$6(this.$3iu)&&(this.$3iu=new _d.$o1(_nbs.NonBootStrings.l_ConflictingEvents_Text));return this.$3iu},get_$9Vr:function(){$6(this.$4OP)&&(this.$4OP=new _d.$o1(_nbs.NonBootStrings.l_PrecedingEvents_Text));return this.$4OP},get_$7pT:function(){$6(this.$3rn)&&(this.$3rn=new _d.$o1(_nbs.NonBootStrings.l_FollowingEvents_Text));return this.$3rn},get_$Cf:function(){return this.$7A},set_$Cf:function(n){if(this.$7A!==n){this.$7A=n;$JA(this,["HasConflictingMeetings","ShowAdjacentMeetingsText","IsInitialized","ShowConflicts"])}return n},get_$6VN:function(){return this.$In.get_$20c()==="Outdated"||_d.$6k.$1xn(this.$In)||$6(this.$In.get_$19m())?!1:!0},get_$899:function(){return this.$In.get_$30L()&&!!this.$In.get_$1Sb()},$49:function(){if(this.get_$6VN())this.get_$899()?$6re(this,this.$$d_$6P0):this.$6P0();else{this.$In.get_$20c()==="Outdated"||_d.$6k.$1xn(this.$In)?this.set_$1CV(_nbs.NonBootStrings.l_ConflictsNotFetchedForOutOfDateMeeting_Text):this.set_$1CV(_nbs.NonBootStrings.l_UnableToGetConflicts_Text);this.set_$Cf(!0)}},$6P0:function(){var n=new _c.$tB(300,this.$In);$6rh(this,n);this.$1W.$z(n)},$9Ql:function(){this.set_$3zr(!this.$2OW)},$99G:function(n){_a.$4.$Js(this.$In,n.$In,"MeetingRequest");if(!this.$In.get_$Pk()){$6rf(this);$6rg(this)}this.set_$3zr(!1)},$4Ic:function(n){this.set_$1CV(_nbs.NonBootStrings.l_UnableToGetConflicts_Text)},$3Ew:function(n){$6ri(this,n);this.set_$Cf(!0)},$9VH:function(){if(this.$3MV){var n=new _y.$Ax;n.$V5(this.$3MV.get_$i());this.$C.$62(_d.$JU,null,n.$3K,_y.$48.get_$fF())}}};_d.$vN=function(n){this.$$d_$t0=Function.createDelegate(this,this.$t0);this.$$d_$9Pt=Function.createDelegate(this,this.$9Pt);_d.$vN.initializeBase(this);this.$f6=n;var i=this;this.$6M5=new _C(function(){$4lJ(i.$f6)},_a.$0.$w9);var r=this;this.$6LJ=new _C(function(){$4lI(r.$f6)},_a.$0.$w9);var t=this;this.$f6.$Y("SelectedItemsCount",function(n,i){t.set_$7QW(t.$f6.get_$7Y()>0)});this.set_$4T7(new _y.$6b("Mouse"));this.$1m.set_$q(!1);this.$1m.set_$R8(!0);this.$1m.set_$1gB(1);this.$1m.set_$tx(!0);this.$1m.$1MO=!1;this.$1m.set_$If(new _C(this.$$d_$9Pt,_a.$0.$w9));this.$1m.set_$VV(new _C(this.$$d_$t0,_a.$0.$w9))};_d.$vN.prototype={$6M5:null,$6LJ:null,$f6:null,$1m:null,$2lt:!1,get_$7QW:function(){return this.$2lt},set_$7QW:function(n){if(this.$2lt===n)return n;this.$2lt=n;$3(this,"AreActionCommandsEnabled");return n},get_$4T7:function(){return this.$1m},set_$4T7:function(n){if(this.$1m!==n){this.$1m=n;$3(this,"SearchVM")}return n},$9Pt:function(){if(!_js.$9.$a(this.$1m.$2s)&&this.$1m.$2s.trim().length>0){this.$1m.set_$1DI(!0);this.$f6.$Aw(this.$1m,!0)}},$t0:function(){_a.$g.$4bO("VM.FindMail.Search");this.$1m.$To();if(this.$f6.$6q){this.$f6.set_$aA(!0);var n=this;_js.$J.get_$I().$3r(_a.$0.$w9,"LoadItemsOnCancelSearch",function(){n.$f6.$US(0)})}}};_d.$DI=function(n,t,i,r,u,f,e){this.$$d_$7n5=Function.createDelegate(this,this.$7n5);this.$$d_$7n6=Function.createDelegate(this,this.$7n6);_d.$DI.initializeBase(this,[n,null,t,i,u,r,f,null,e]);this.$85h();this.set_$dr(new _h.$Cb("DateTimeReceived","Descending"))};function $4lJ(n){if(n.get_$7Y()){var t=new _a.$4a([_nbs.NonBootStrings.l_RecoverItemsPontDescription_Text,_nbs.NonBootStrings.l_RecoverItemsPointMailItems_Text,_nbs.NonBootStrings.l_RecoverItemsPointCalendarItems_Text,_nbs.NonBootStrings.l_RecoverItemsPointContacts_Text,_nbs.NonBootStrings.l_RecoverItemsPointTasks_Text],1,n.$$d_$7n6,1,!1,_nbs.NonBootStrings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_nbs.NonBootStrings.l_RecoverItemsPontHeader_Text);n.$M.$9Yf(_a.$4a,t)}}function $4lI(n){if(n.get_$7Y()){var t=new _a.$4a([_nbs.NonBootStrings.l_ConfirmPurgeDescription_Text],1,n.$$d_$7n5,1,!1,_nbs.NonBootStrings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_nbs.NonBootStrings.l_ConfirmPurgePontHeader_Text);n.$M.$9Yf(_a.$4a,t)}}function $4lH(n,t,i){if(t&&!(n.get_$7Y()<=0)){var r=$up(n,$ur(n));i();$bf(n,null);$bf(n,r);$pE(n)}}function $2h6(n,t,i){if(!(t.length<=0)){var r=new _h.$MG(t,i.get_$r(),0);OwaApplication.$1W.$z(r)}}_d.$DI.prototype={$7n5:function(n,t){var i=this;$4lH(this,n,function(){i.$Ie("HardDelete");_a.$g.$8r("VM.MailUsage.PurgeFromDumpster")})},$7n6:function(n,t){var i=this;$4lH(this,n,function(){for(var r=i.$2f,u=[],f=[],e=[],o=[],t=0;t<r.get_$B();t++){var n=r.get_$3q(t);switch(n.get_$7j()){case 2:Array.add(u,n);break;case 3:Array.add(o,n);break;case 4:Array.add(e,n);break;case 1:case 0:default:Array.add(f,n);break}}$2h6(i,f,_g.$2X.$Bi("inbox"));$2h6(i,u,_g.$2X.$Bi("calendar"));$2h6(i,e,_g.$2X.$Bi("tasks"));$2h6(i,o,_g.$2X.$Bi("contacts"));_a.$g.$8r("VM.MailUsage.RecoverFromDumpster")})},$25L:function(n,t){$3(this,"SelectedItems")},$85h:function(){var n=[];var t=this;Array.add(n,new _0365m.$m(_nbs.NonBootStrings.l_RecoverItemMenuOption_Text,null,new _C(function(){$4lJ(t)},_a.$0.$w9)));var i=this;Array.add(n,new _0365m.$m(_nbs.NonBootStrings.l_PurgeItemMenuOption_Text,null,new _C(function(){$4lI(i)},_a.$0.$w9)));this.$9g=new _0365m.$2b(n)}};_d.$14t=function(n){this.$2k=n};_d.$14t.prototype={$2k:null};_d.$18M=function(n,t,i,r){this.$C=n;this.$fr=t;this.$uI=r;this.$Kl=i};_d.$18M.prototype={$fr:null,$uI:null,$C:null,$Kl:null,$bC:function(n,t){var i=n.AttachmentItemID;return new _d.$CR(this.$C,this.$fr,this.$Kl,this.$uI,i,t)},$vo:function(n,t){throw Error.notImplemented("Creating from context is not supported");}};_d.$CR=function(n,t,i,r,u,f){this.$$d_$5Qw=Function.createDelegate(this,this.$5Qw);this.$$d_$7ui=Function.createDelegate(this,this.$7ui);_d.$CR.initializeBase(this);this.$1z=new _y.$4c;this.$C=n;this.$MB=f;this.$C.get_$L()==="TouchNarrow"&&this.set_$7D(_y.$26.$E(this));this.$fr=t;this.$uI=r;this.$Kl=i;this.$8e=_g.$1q.$2Hc(u);if(u.startsWith("smime-"))$6t3(this,u);else{var e=new _at.$bn(u);e.add_$2C(this.$$d_$7ui);e.add_$1x(this.$$d_$5Qw);OwaApplication.$1W.$z(e)}};function $4li(n,t){n.set_$33p(n.$fr.$8A(t,!1,!0,!1,null,null,!1,n.$MB));n.set_$41A(!0)}function $3WW(n){var t=this;n.$1z.$32(0,_nbs.NonBootStrings.l_ItemAttachmentOpenFailure_Text,function(n,t){window.close()})}function $6t2(n,t){var i=this;n.$uI.$E(function(i){n.$oq||n.set_$9uO(i.$E());t&&t(n.$oq)})}function $6t3(n,t){var u=window.opener.getSmimeCachedContent(t);if(!u){_js.Trace.logError(_d.$CR.$A,"Cannot get attachment content of {0} from window.opener.",t);$3WW(n);return}var h=u[0];var o=u[1];var c=_a.$s.$qh();_js.Trace.logInfo(_a.$0.$4A,"Start to parse MIME content of a ItemAttachment into ItemType.");var l=c.ConvertMimeToItem(o);var f=JsonParser.deserialize(l);if(f.ErrorCode){_js.Trace.logException(_a.$0.$62,_a.$2H.$E(_u.Strings.l_Smime_CannotParseMimeContent_Text,f.ErrorCode),"An error occurred when parsing MIME content.");$3WW(n)}else{var e=JsonParser.deserialize(f.Data);_js.Trace.logInfo(_a.$0.$4A,"MIME content of the ItemAttachment has been parsed into ItemType.");var s=e;s.DateTimeReceived=h;var a=e;a.ItemCategory=1;var r=new _g.$7g(s);r.$5kZ(e);if(r.get_$14J()){var i=new _g.$Li;i.AttachmentId=new _g.$Ae(_a.$s.$WM());i.Name="smime.p7m";i.ContentType="application/x-pkcs7-mime";i.Content=_a.$9N.$EX(o);r.get_$2h().Attachments=[i]}n.set_$5fO(1);$4li(n,r)}}_d.$CR.prototype={$419:!1,$Kl:null,$C:null,$fr:null,$uI:null,$1z:null,$Bk:null,$oq:null,$33e:0,$8e:null,$yu:null,$MB:null,get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?_y.$1KT.prototype.get_$Ld.call(this):0},get_$33p:function(){return this.$Bk},set_$33p:function(n){this.$Bk=n;$3(this,"ItemReadingPaneViewModel");return n},get_$9uO:function(){return this.$oq},set_$9uO:function(n){this.$oq=n;$3(this,"TaskReadingPaneViewModel");return n},get_$83T:function(){return this.$C.get_$L()==="Mouse"},get_$41A:function(){return this.$419},set_$41A:function(n){this.$419=n;$3(this,"IsItemAttachmentLoaded");return n},get_$5fO:function(){return this.$33e},set_$5fO:function(n){this.$33e=n;$3(this,"ItemAttachmentCategory");return n},get_$4J6:function(){return this.$yu},set_$4J6:function(n){this.$yu=n;return n},$2mc:function(){},$7ui:function(n){var t=n.$2qS;this.set_$5fO(t.get_$7j());_js.Trace.logInfo(_d.$CR.$A,"GetItemAttachment succeeded for {0}",this.$33e);switch(t.get_$7j()){case 4:var r=this;$6t2(this,function(n){n.set_$2I9(t);n.set_$8At(!0);r.set_$41A(!0)});break;case 2:t.set_$i(this.$8e);var i=t;i.set_$1Kb(!0);i.set_$4S(2);var u=this;var f=function(){u.set_$41A(!0)};var e=this.$Kl.$3kG(i,f);this.$C.$fC(e,1,!0);break;default:t.set_$i(this.$8e);$4li(this,t);break}},$5Qw:function(n){_js.Trace.logWarning(_d.$CR.$A,"Open ItemAttachment failed with Error: {0}",n.$1f?n.$1f.message:"No further details");$3WW(this)}};_d.$M6=function(n,t,i,r,u,f,e,o){this.$$d_$5Qw=Function.createDelegate(this,this.$5Qw);this.$$d_$5R7=Function.createDelegate(this,this.$5R7);_d.$M6.initializeBase(this);this.$fr=n;this.$C=t;this.$5N=i;this.$9f=r;this.$5br=u;this.$5h=f;this.$6O=e;this.$MB=o;this.$1z=new _y.$4c;this.$C.get_$L()==="TouchNarrow"&&this.set_$7D(_y.$26.$E(this));var s=new _h.$Ip(200,[new _g.$1q(i)],_h.$15.get_$xY(),"ItemNormalizedBody",0,r);s.add_$2C(this.$$d_$5R7);s.add_$1x(this.$$d_$5Qw);OwaApplication.$1W.$z(s)};_d.$M6.prototype={$41E:!1,$5N:null,$9f:!1,$5br:!1,$5h:"All",$6O:null,$fr:null,$1z:null,$Bk:null,$C:null,$MB:null,$yu:null,get_$33p:function(){return this.$Bk},set_$33p:function(n){this.$Bk=n;$3(this,"ItemReadingPaneViewModel");return n},get_$8Av:function(){return this.$41E},set_$8Av:function(n){this.$41E=n;$3(this,"IsItemLoaded");return n},get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?_y.$1KT.prototype.get_$Ld.call(this):0},get_$4J6:function(){return this.$yu},set_$4J6:function(n){this.$yu=n;return n},$2mc:function(){_y.$xH.isInstanceOfType(this.$Bk)&&this.$Bk.$2mc()},$5R7:function(n){var i=_h.$1O.get_$I().$3x(this.$5N);var t=this.$fr.$8A(i,this.$9f,!1,this.$5br,null,this.$6O,!1,this.$MB);_y.$xH.isInstanceOfType(t)&&t.set_$4J6(this.$yu);t.set_$9z(this.$5h);this.set_$33p(t);this.set_$8Av(!0)},$5Qw:function(n){var t=_nbs.NonBootStrings.l_ItemAttachmentOpenFailure_Text;if(n.$1f){var i=n.$1f.responseCode;if(i==="ErrorItemNotFound"){t=_u.Strings.l_ErrorItemNotFound_Text;_js.Trace.logWarning(_d.$M6.$A,"Open Item failed with Error: {0}",t)}else _js.Trace.logError(_d.$M6.$A,"Open Item failed with Error: {0}",n.$1f.message)}else _js.Trace.logError(_d.$M6.$A,"Open Item failed with Error: {0}","No further details");var r=this;this.$1z.$32(0,t,function(n,t){window.close()})}};_d.$xc=function(n,t,i,r,u,f,e,o){this.$5k7=n;this.$59D=t;this.$565=i;this.$zD=u;this.$k=r;this.$65j=f;this.$1J=e;this.$12=o};_d.$xc.prototype={$5k7:null,$59D:null,$565:null,$zD:null,$k:null,$65j:null,$1J:null,$12:null,$5Er:function(n,t,i,r,u,f){if(_g.$RD.isInstanceOfType(n))return this.$5k7.$E(n,t,i,r,f);else if(_g.$7g.isInstanceOfType(n)&&n.get_$IY()&&n.get_$IY().get_$43g()&&!u)return this.$565.$E(n,t,r);return null},$5FI:function(n,t,i){return _g.$gr.isInstanceOfType(n)?new _d.$CI(n,this.$12):this.$1J&&this.$1J.$3u("ModernGroups")&&_g.$y.$8BY(n)?new _d.$RJ(n,this.$k,this.$zD.$E(new _d.$Ha,1),this.$65j):_g.$y.$88b(n)?this.$59D.$E(n):null}};_d.$xd=function(){};_d.$xd.prototype={$E:function(n){return new _y.$4h(n)}};_d.$18U=function(n,t,i,r){this.$fr=n;this.$3h=t;this.$C=i;this.$c=r};_d.$18U.prototype={$fr:null,$3h:null,$C:null,$c:null,$bC:function(n,t){var i=!1;var r=!1;var u="All";"IsPrintView"in n&&this.$C.set_$Pj(n.IsPrintView===1);"IsDiscoveryView"in n&&(i=n.IsDiscoveryView==="1");"ViewFilter"in n&&(u=n.ViewFilter);"IsArchive"in n&&(r=n.IsArchive==="1");var f=n.ItemID;var o=new _g.$1q(f);var e=this.$c?this.$c.get_$HY():null;return new _d.$M6(this.$fr,this.$C,f,i,r,u,e,t)},$vo:function(n,t){var i=n;var u=i.get_$3q();this.$C.set_$Pj(i.get_$Pj());var r=this.$fr.$8A(u,i.get_$1xL(),!1,i.get_$2zq(),null,i.get_$HY(),i.get_$14B(),t);r.get_$xb()&&r.get_$xb().set_$o0(i.get_$o0());r.set_$9z(i.get_$9z());r.set_$AR(i.get_$AR());_g.$1U.$MG&&_g.$1U.$MG.$3xr(this.$3h);return r}};_d.$RB=function(n){this.$M=n};function $6uA(n,t){switch(t){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":$6uB(n);return;case"ErrorFolderExists":$6uC(n);return}}function $6uC(n){var t=new _a.$4a([_u.Strings.l_SameNameFolderExists_Text],0,null);n.$M.$9Yf(_a.$4a,t)}function $6uB(n){var t=new _a.$4a([_u.Strings.l_SharedFolderNoPermissionMessage_Sentencecase_Text],0,null,0,!1,null,null,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text);n.$M.$9Yf(_a.$4a,t)}_d.$RB.prototype={$M:null,$qm:function(n){if(n){if(_h.$T1.isInstanceOfType(n)){var i=n;var t=_h.$j.$JP(i.$VD);if(!t||!t.$AX)return}_h.$xR.isInstanceOfType(n)&&$6uA(this,n.get_$2aS())}}};_d.$k3=function(n,t){this.$$d_$11k=Function.createDelegate(this,this.$11k);this.$$d_$54e=Function.createDelegate(this,this.$54e);_d.$k3.initializeBase(this);this.$PV=new _d.$WO(n);this.$54f=t};function $6uD(n){var t=new _y.$Lc;t.set_$4v(_nbs.NonBootStrings.l_FolderPermissionsAddUser_Lowercase_Text);t.set_$DP(n);var e=this;var r=new _C(n.$$d_$54e,_a.$0.$8i,n.$PV,"Persona",function(){return!!n.$PV.$14});var i=new _C(n.$$d_$11k,_a.$0.$8i);t.set_$G1(i);var u=new _a.$2G(r,_nbs.NonBootStrings.l_FolderPermissionsAddButton_Lowercase_Text);var f=new _a.$2G(i,_u.Strings.l_CancelButtonLabel_LowerCase_Text);t.$7J.$D(u);t.$7J.$D(f);n.set_$iE(t)}_d.$k3.prototype={$9d:null,$54f:null,$PV:null,get_$iE:function(){this.$9d||$6uD(this);return this.$9d},set_$iE:function(n){if(this.$9d!==n){this.$9d=n;$3(this,"DialogViewModel")}return n},$54e:function(){if(this.$PV.$14){var n=new _g.$Z1;n.DisplayName=this.$PV.$14.get_$1s().get_$1o();n.PrimarySmtpAddress=this.$PV.$14.get_$1s().get_$1l().EmailAddress;n.DistinguishedUser="None";this.$11k();this.$54f(n)}},$11k:function(){this.get_$iE().set_$1O(!1);this.$PV.$1r()}};_d.$5E=function(n,t){this.$$d_$9RA=Function.createDelegate(this,this.$9RA);this.$$d_$9RB=Function.createDelegate(this,this.$9RB);this.$$d_$54e=Function.createDelegate(this,this.$54e);this.$$d_$9NI=Function.createDelegate(this,this.$9NI);this.$$d_$99S=Function.createDelegate(this,this.$99S);this.$$d_$4KK=Function.createDelegate(this,this.$4KK);_d.$5E.initializeBase(this);this.set_$DP(this);this.set_$1D6(!0);this.$k=t;this.$YZ=new _C(this.$$d_$4KK,_d.$5E.$Lg);this.$546=new _C(this.$$d_$99S,_d.$5E.$Lg);this.$6NE=new _C(this.$$d_$9NI,_d.$5E.$Lg);this.$U5=new _js.$Z;this.$w=new _y.$6J;this.$46H=new _d.$k3(n,this.$$d_$54e);var i=new _a.$2G(this.$YZ,_nbs.NonBootStrings.l_MailFolderPermissionsDialogButtonOK_Text);var r=new _a.$2G(this.$4d,_nbs.NonBootStrings.l_MailFolderPermissionsDialogButtonCancel_Text);this.set_$Sc(new _js.$Z);this.$7J.$D(i);this.$7J.$D(r);this.set_$4v(_nbs.NonBootStrings.l_MailFolderPermissionsDialogTitle_Text)};_d.$5E.$$cctor=function(){_d.$5E.$2pK=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};function $um(n){var t=n.$11.$7ZF();if(t!==n.$11.get_$Fo()){n.$11.set_$Fo(t);$3(n,"PermissionLevel")}}function $6uF(n){var t=new _h.$1Ew;t.$Uu=new _g.$db;t.$Uu.set_$4N3(new(_a.$1s.$$(_g.$45,_g.$Re)));for(var i=0;i<n.$U5.get_$B();i++){var r=n.$U5.get_$3q(i);var u=r.$3p();u.set_$1Il($6uE(n,r.get_$1Il()));t.$Uu.get_$4N3().$D(u)}t.$2G=n.$2G;t.add_$2m(n.$$d_$9RB);t.add_$1x(n.$$d_$9RA);n.$k.$z(t)}function $6uE(n,t){var i=new _g.$Z1;i.DistinguishedUser=t.DistinguishedUser;i.ExternalUserIdentity=t.ExternalUserIdentity;i.PrimarySmtpAddress=t.PrimarySmtpAddress;i.SID=t.SID;return i}function $4mh(n){if(n.$11){for(var t=0;t<_d.$5E.$2pK.length;t++)$3(n,_d.$5E.$2pK[t]);$3Wm(n)}}function $3Wm(n){if(n.$11){n.set_$7l1(n.$11.get_$Ku()!=="All");n.set_$8A2(!$4mg(n,n.$11.get_$1Il()))}}function $4mg(n,t){return t.DistinguishedUser==="Anonymous"||t.DistinguishedUser==="Default"}function $4mf(n){n.$U5.$1r();n.set_$F4(!1);n.$4d.$n()}_d.$5E.prototype={$k:null,$YZ:null,$546:null,$6NE:null,$46H:null,$1z:null,$U5:null,$tH:null,$11:null,$w:null,$2G:null,$KF:!1,$2QI:!1,$2sv:!1,$30t:!1,get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},get_$9U9:function(){if($6(this.$tH)){this.$tH=new _js.$Z;this.$tH.$D("Owner");this.$tH.$D("PublishingEditor");this.$tH.$D("Editor");this.$tH.$D("PublishingAuthor");this.$tH.$D("Author");this.$tH.$D("NoneditingAuthor");this.$tH.$D("Reviewer");this.$tH.$D("Contributor");this.$tH.$D("None")}return this.$tH},get_$22:function(){return this.$11},set_$22:function(n){if(this.$11===n)return n;this.$11=n;$3(this,"SelectedItem");$4mh(this);return n},get_$Fo:function(){return this.$11.get_$Fo()},set_$Fo:function(n){if(this.$11.get_$Fo()!==n){this.$11.set_$Fo(n);this.set_$F4(!0);this.$11.$7QB();$3(this,"PermissionLevel");$4mh(this)}return n},get_$6Ln:function(){return this.$11.get_$b7()},set_$6Ln:function(n){if(this.$11.get_$b7()!==n){this.$11.set_$b7(n);this.set_$F4(!0);$um(this);$3(this,"ReadAccess")}return n},get_$5Hn:function(){return this.$11.get_$Ie()},set_$5Hn:function(n){if(this.$11.get_$Ie()!==n){this.$11.set_$Ie(n);this.set_$F4(!0);$um(this);$3(this,"DeleteAccess")}return n},get_$VW:function(){return this.$11.get_$VW()},set_$VW:function(n){if(this.$11.get_$VW()!==n){this.$11.set_$VW(n);this.set_$F4(!0);$um(this);$3(this,"CanCreateItems")}return n},get_$59V:function(){return this.$11.get_$ZV()},set_$59V:function(n){if(this.$11.get_$ZV()!==n){this.$11.set_$ZV(n);this.set_$F4(!0);$um(this);$3(this,"CanCreateSubfolders")}return n},get_$5KL:function(){return this.$11.get_$Ku()==="Owned"||this.$11.get_$Ku()==="All"},set_$5KL:function(n){if(n){if(this.$11.get_$Ku()==="None"){this.$11.set_$Ku("Owned");this.set_$F4(!0);$um(this);$45(this,"EditOwn","EditAll")}}else if(this.$11.get_$Ku()==="None"){this.set_$F4(!0);$um(this);$45(this,"EditOwn","EditAll")}else this.$11.get_$Ku()==="All"&&$3(this,"EditOwn");$3Wm(this);return n},get_$7l1:function(){return this.$2sv},set_$7l1:function(n){if(this.$2sv!==n){this.$2sv=n;$3(this,"EditOwnEnabled")}return n},get_$5K6:function(){return this.$11.get_$Ku()==="All"},set_$5K6:function(n){if(n){(this.$11.get_$Ku()==="None"||this.$11.get_$Ku()==="Owned")&&this.$11.set_$Ku("All");this.set_$F4(!0);$um(this);$45(this,"EditOwn","EditAll")}else if(this.$11.get_$Ku()==="All"){this.set_$F4(!0);this.$11.set_$Ku("None");$um(this);$45(this,"EditOwn","EditAll")}$3Wm(this);return n},get_$Vy:function(){return this.$11.get_$Vy()},set_$Vy:function(n){if(this.$11.get_$Vy()!==n){this.$11.set_$Vy(n);this.set_$F4(!0);$um(this);$3(this,"IsFolderOwner")}return n},get_$R6:function(){return this.$11.get_$R6()},set_$R6:function(n){if(this.$11.get_$R6()!==n){this.$11.set_$R6(n);this.set_$F4(!0);$um(this);$3(this,"IsFolderContact")}return n},get_$8A2:function(){return this.$30t},set_$8A2:function(n){if(this.$30t!==n){this.$30t=n;$3(this,"IsFolderContactEnabled")}return n},get_$Sl:function(){return this.$11.get_$Sl()},set_$Sl:function(n){if(this.$11.get_$Sl()!==n){this.$11.set_$Sl(n);this.set_$F4(!0);$um(this);$3(this,"IsFolderVisible")}return n},get_$7pN:function(){return this.$U5},set_$7pN:function(n){if(this.$U5!==n){this.$U5=n;$3(this,"FolderPermissionList")}return n},get_$iE:function(){return this},get_$F4:function(){return this.$KF},set_$F4:function(n){if(this.$KF!==n){this.$KF=n;$3(this,"IsDIrty")}return n},$bL:function(n,t){this.$2G=n;this.set_$4v(String.format(_nbs.NonBootStrings.l_MailFolderPermissionsDialogTitle_Text,n.get_$1o()));this.$U5.$1r();this.$U5.$69(t.get_$4N3().$6Z());this.set_$22(this.$U5.get_$3q(0));this.set_$F4(!1);this.$2QI=!1;this.set_$1O(!0)},$54e:function(n){var r=this;var i=this.$U5.$DY(function(t){return t.$7m4(n)});if(i!==this.$U5.get_$B()){this.get_$Cg().$32(0,String.format(_nbs.NonBootStrings.l_CannotAddDuplicateUser_Text,n.DisplayName),null);return}var t=_g.$45.$Q2.$3p();t.set_$1Il(n);this.$U5.$D(t);this.set_$F4(!0);this.set_$22(this.$U5.get_$3q(this.$U5.get_$B()-1))},$9bc:function(){var n=this.$U5.$71(this.$11);if(n!==-1){if($4mg(this,this.$11.get_$1Il())){this.get_$Cg().$32(0,_nbs.NonBootStrings.l_CannotDeleteAnonymousOrDefaultUser_Text,null);return}var t=n===this.$U5.get_$B()-1?n-1:n;this.$U5.$34(this.$11);this.set_$F4(!0);var i=this.$U5.get_$3q(t);this.set_$22(i)}},$4KK:function(){if(!this.$2QI)if(this.$KF){$6uF(this);this.$2QI=!0}else $4mf(this)},$99S:function(){this.$46H.get_$iE().set_$1O(!0)},$9NI:function(){this.$9bc()},$9RB:function(n){this.$2QI=!1;n.$1f||$4mf(this)},$9RA:function(n){this.$2QI=!1;var t=n.$2G.get_$1o();this.get_$Cg().$32(0,String.format(_nbs.NonBootStrings.l_CannotUpdatePermissionsForFolder_Text,t),null)}};_d.$RC=function(n,t,i,r,u,f,e){this.$$d_$9NE=Function.createDelegate(this,this.$9NE);this.$$d_$9at=Function.createDelegate(this,this.$9at);_d.$RC.initializeBase(this,[n,i,r,f,e]);this.$Jm=t;this.$1W=u||OwaApplication.$1W;var o=this;this.$6N5=new _C(this.$$d_$9at,_a.$0.$1k,this,"CanRemove",function(){return o.get_$VX()});Object.getType(n)===_g.$CC;this.$1x1=!0;this.set_$5Zf(!this.$P.get_$19m())};function $6uZ(n){if(n.$18n){var t=n.$P.get_$19m();return t?new _h.$Kf([t],"SoftDelete",1):null}return new _c.$1BU(n.$P.get_$KB())}function $6uY(n){switch(n.$C.get_$L()){case"TouchNarrow":n.$Jm.$Bs();break;case"TouchWide":case"Mouse":break}}_d.$RC.prototype={$1W:null,$6N5:null,$Jm:null,$42i:!1,$2zs:!1,get_$VX:function(){return this.$18n?this.$P.get_$VX()&&!this.$2zs:this.$P.get_$VX()},get_$5de:function(){return this.$42i},set_$5de:function(n){if(this.$42i!==n){this.$42i=n;$3(this,"IsRemoveFromCalendarActionInProgress")}return n},get_$5Zf:function(){return this.$2zs},set_$5Zf:function(n){if(this.$2zs!==n){this.$2zs=n;$45(this,"IsAssociatedCalendarItemRemoved","CanRemove")}return n},$9at:function(){var n=$6uZ(this);if(n){n.add_$1x(_cc.$5g.$1C0);var t=this;n.add_$2C(function(){t.set_$5Zf(!0);$6uY(t)});n.add_$3qF(this.$$d_$9NE);var i=this;n.add_$2m(function(){i.set_$5de(!1)});this.$1W.$z(n)}},$9NE:function(n){this.set_$5de(!0)},$85f:function(){this.$L0=new _d.$19M(this.$P,this.$w);this.$L0.$18h()}};_d.$dp=function(n,t,i,r,u,f,e,o,s,h){this.$1E2=n;this.$5C=t;this.$Jm=i;this.$C=r;this.$k=u;this.$1i=f;this.$Eu=e;this.$2pA=o;this.$96=s;this.$13=h};_d.$dp.$85n=function(n){n&&n.$49()};_d.$dp.prototype={$1E2:null,$5C:null,$Jm:null,$C:null,$k:null,$1i:null,$96:null,$Eu:null,$2pA:null,$13:null,$E:function(n,t,i,r,u){var f=null;if(this.$96.get_$1k()){_g.$IB.isInstanceOfType(n)&&(f=new _d.$RC(n,this.$Jm,i,this.$C,this.$k,this.$5C,u));if(_g.$CC.isInstanceOfType(n))if(n.get_$UH())f=new _d.$RC(n,this.$Jm,i,this.$C,this.$k,this.$5C,u);else{this.$1E2.$5Hb=t();f=new _d.$Jv(n,i,this.$1E2,this.$C,this.$Jm,this.$1i,this.$k,this.$5C,this.$2pA,r,u)}_g.$PV.isInstanceOfType(n)&&(f=new _d.$xz(n,i,this.$C,this.$5C,this.$Eu,this.$13,u))}else f=new _d.$zN(n,i,this.$C,this.$5C,u);_d.$dp.$85n(f);return f}};_d.$o2=function(n,t,i){this.$2U=n;this.$1W=t;this.$C=i};_d.$o2.prototype={$1W:null,$2U:null,$C:null,$E:function(n){return new _d.$BM(n,this.$2U,this.$1W,this.$C)}};_d.$19M=function(n,t){_d.$19M.initializeBase(this,[t]);this.$Io=n};_d.$19M.prototype={$Io:null,$8Gf:function(){this.$TE=[1200]},$7qZ:function(){if(!this.$Io.get_$VX()&&!$6(this.$Io.get_$As())){var n=this.$Io.get_$As().$2Z(5);var t=this.$Io.get_$As().$2Z(0);this.$w.$2a(1200,n,t)}}};_d.$do=function(n,t,i,r,u){_d.$do.initializeBase(this);this.$w=t;this.$P=n;this.$C=i;this.$5C=r;this.$18n=u};function $6ua(n){var i=n.$1XY.$5V0?n.$1XY.$54:null;var t=n.$P.get_$KB().get_$4j();n.$aM=new _d.$ED(t,n.get_$5cq()?t:i,n.$5C,n.$C)}_d.$do.prototype={$5C:null,$C:null,$w:null,$P:null,$18n:!1,$aM:null,$L0:null,$1XY:null,$1x1:!1,get_$5cq:function(){return this.$18n&&(this.$P.get_$5cr()||this.$1x1)},get_$82r:function(){return this.$1XY.$5VE||this.$1XY.$5Up},$49:function(){this.$85R();this.$85T();this.$85f();$6ua(this)},$85T:function(){this.$1XY=new _d.$uc(null)},$85f:function(){},$85R:function(){}};_d.$PU=function(n,t,i,r){this.$$d_$7kt=Function.createDelegate(this,this.$7kt);_d.$PU.initializeBase(this,[t]);this.$Io=n;this.$C=i;this.$Eu=r};_d.$PU.$3sP=function(n,t,i,r){for(var u=0,f=0;f<r.get_$B();f++){var o=r.get_$3q(f);o.get_$TM()===n&&u++}var e=null;u===1?e=t:u>1&&(e=_js.$9.$4R(i,u));return e};function $6ud(n){if(n.$Io.get_$I2()&&_d.$6k.$3uR(n.$Io)){var i=new _js.$Z;n.$Io.$EP&&i.$69(n.$Io.$EP.$6Z());n.$Io.$EN&&i.$69(n.$Io.$EN.$6Z());var t=[];Array.add(t,_d.$PU.$3sP("Accept",_nbs.NonBootStrings.l_OneAttendeeAccepted_Text,_nbs.NonBootStrings.l_AttendeesAccepted_Text,i));Array.add(t,_d.$PU.$3sP("Tentative",_nbs.NonBootStrings.l_OneAttendeeTentative_Text,_nbs.NonBootStrings.l_AttendeesTentative_Text,i));Array.add(t,_d.$PU.$3sP("Decline",_nbs.NonBootStrings.l_OneAttendeeDeclined_Text,_nbs.NonBootStrings.l_AttendeesDeclined_Text,i));while(Array.remove(t,null));var r;r=t.length?t.join(", "):_nbs.NonBootStrings.l_NoAttendeeAnswered_Text;n.$w.$2a(6700,r)}}_d.$PU.prototype={$Io:null,$C:null,$Eu:null,$8Gf:function(){this.$TE=[6700,6701]},$7qZ:function(){$6ud(this);if(!$6(this.$Io.get_$6L6())&&!$6(this.$Io.get_$6L5())){var r=new _d.$GQ;var n=new _d.$9c;n.set_$y(this.$Io.get_$6L6());n.set_$1u(this.$Io.get_$6L5());var t=_js.$9.$a(this.$Io.get_$3O().Mailbox.Name)?this.$Io.get_$3O().Mailbox.EmailAddress:this.$Io.get_$3O().Mailbox.Name;var i=r.$36(n,null);this.$Io.get_$I2()?this.$w.$JC(6701,[t,i],_nbs.NonBootStrings.l_EditEventInfobar_Text,this.$$d_$7kt):this.$w.$2a(6701,t,i)}},$7kt:function(){_a.$6.$1c(_a.$0.$1k,"OpenCalendarItemOnComposeForm");var n=new _y.$Ax;n.$V5(this.$Io.get_$19m());if(this.$C.get_$9A())this.$C.$62(_d.$C4,null,n.$3K,_y.$48.get_$fF());else{var t=this.$Eu.$bC(n.$3K,null);this.$C.$fC(t,1,!0)}_a.$6.$1E(null,"OpenCalendarItemOnComposeForm")}};_d.$qP=function(n,t){_d.$qP.initializeBase(this,[t]);this.$Io=n};function $6ub(n){n.$Io.get_$30L()&&n.$Io.get_$1Sb()&&n.$w.$2a(3010,n.$Io.get_$1Sb().Mailbox.Name)}_d.$qP.prototype={$Io:null,$8Gf:function(){this.$TE=[3010,5100,5800,1300,1400,2200,1100]},$7qZ:function(){$6ub(this);switch(this.$Io.get_$20c()){case"FullUpdate":case"NewMeetingRequest":$4k3(this,this.$Io);break;case"InformationalUpdate":this.$w.$2a(5800);break;case"Outdated":_d.$6k.$1xn(this.$Io)||this.$w.$2a(5100);break}$3W4(this,this.$Io);$4k6(this,this.$Io,!0)}};_d.$Jv=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$4K6=Function.createDelegate(this,this.$4K6);this.$$d_$iD=Function.createDelegate(this,this.$iD);this.$4cN=["sentitems","archivedeleteditems","archivemsgfolderroot","archiverecoverableitemsdeletions","archiverecoverableitemspurges","archiverecoverableitemsroot","archiverecoverableitemsversions","archiveroot"];_d.$Jv.initializeBase(this,[n,t,r,o,c]);this.$4R9=n.get_$20c();this.$1E2=i;this.$2pA=s;this.$1i=f;this.$Jm=u;this.$1W=e||OwaApplication.$1W;this.$5H=h;var l=this;this.$Gj=new _C(this.$$d_$iD,_a.$0.$1k,this,"CanDelete",function(){return l.get_$1AF()})};function $6uc(n,t){if(!n.$P.get_$28())return!0;for(var i=0;i<n.$4cN.length;i++){var r=t.nameToId(n.$4cN[i]);if(r&&r.Id===n.$P.get_$28().Id)return!0}return!1}function $4ms(n){switch(n.$C.get_$L()){case"TouchNarrow":n.$Jm.$Bs();break;case"TouchWide":break;case"Mouse":if(!n.$C.get_$9A()){var t=this;_js.$J.get_$I().$3r(_a.$0.$62,"PopOutClose",function(){window.self.close()})}break}}_d.$Jv.prototype={$1W:null,$4R9:"None",$1E2:null,$2pA:null,$1i:null,$5H:!1,$Gj:null,$Jm:null,$RF:null,$417:!1,$3iv:null,get_$1AF:function(){return this.get_$412()},get_$59l:function(){return this.$4R9!=="Outdated"&&!this.$417&&!this.$5H},get_$7Uz:function(){return this.$RF.get_$1AE()&&this.get_$59l()},get_$7V0:function(){return this.$RF.get_$1qX()&&!this.get_$412()&&this.get_$59l()},get_$7ir:function(){return this.$417||this.$5H},get_$412:function(){return this.$4R9==="InformationalUpdate"&&(this.$P.get_$TM()==="Accept"||this.$P.get_$TM()==="Tentative"||this.$P.get_$TM()==="Decline")},$85T:function(){this.$1XY=new _d.$uc(this.$P.get_$7VI())},$85f:function(){if(!this.get_$7ir()){this.$L0=new _d.$qP(this.$P,this.$w);this.$L0.$18h()}},$85R:function(){this.$RF=this.$1E2.$8A(this.$P.get_$KB(),0);this.$RF.$2Ds=0;this.$RF.add_$1W3(this.$$d_$4K6);this.$417=$6uc(this,this.$1i);this.$3iv=this.$2pA.$E(this.$P);this.$3iv.$49()},$iD:function(){var n=new _h.$Kf([this.$P.get_$i()],"MoveToDeletedItems",0);n.$GP=this.$P.get_$28();n.add_$1x(_cc.$5g.$1C0);var t=this;n.add_$2C(function(n){$4ms(t)});this.$1W.$z(n)},$4K6:function(n){$4ms(this)}};_d.$xz=function(n,t,i,r,u,f,e){_d.$xz.initializeBase(this,[n,t,i,r,e]);this.$Eu=u;this.$13=f};_d.$xz.prototype={$Eu:null,$13:null,get_$6Om:function(){var n="";switch(this.$P.get_$TM()){case"Accept":n=this.$18n?_nbs.NonBootStrings.l_EventResponse_Added_Text:_nbs.NonBootStrings.l_MeetingResponse_Accepted_Text;break;case"Tentative":n=this.$18n?_nbs.NonBootStrings.l_EventResponse_TentativelyAdded_Text:_nbs.NonBootStrings.l_MeetingResponse_TentativelyAccepted_Text;break;case"Decline":n=this.$18n?_nbs.NonBootStrings.l_EventResponse_Declined_Text:_nbs.NonBootStrings.l_MeetingResponse_Declined_Text;break;default:throw Error.argument("Item.ResponseType","This response type is not expected.");}var t=null;if(this.$18n)if(this.$P.get_$Pk())t=_u.Strings.l_EventResponseMeetingType_Series_Text;else if(this.$P.get_$2Zi()){var i=String.format(_nbs.NonBootStrings.l_EventResponseMeetingType_OccurrenceValue_Text,_d.$GQ.$2wh(this.$P.get_$KB().get_$y(),this.$P.get_$KB().get_$1u()));t=String.format(_u.Strings.l_EventResponseMeetingType_Occurrence_Text,i)}return this.$18n?String.format(_nbs.NonBootStrings.l_EventResponseFormatString_Text,n,t):String.format(_nbs.NonBootStrings.l_MeetingResponseFormatString_Text,this.$P.get_$8X().Mailbox.Name,n)},$85f:function(){if(!this.$P.get_$Cx()){this.$L0=new _d.$PU(this.$P,this.$w,this.$C,this.$Eu);this.$L0.$18h()}}};_d.$RJ=function(n,t,i,r){this.$$d_$9XM=Function.createDelegate(this,this.$9XM);this.$$d_$9Dr=Function.createDelegate(this,this.$9Dr);this.$$d_$9Ds=Function.createDelegate(this,this.$9Ds);this.$$d_$9Dt=Function.createDelegate(this,this.$9Dt);_d.$RJ.initializeBase(this);_a.$4.$J(n,"message");_a.$4.$J(i,"personaCardFacade");this.$k=t;this.$G6=n;this.$IJ=i;this.$2N4=!0;this.$C2=!1;if(r){var u=this;r.$E(function(n){u.$65i=n;$6uh(u)})}};function $6uh(n){if(!n.$2ZD){var t=n.$65i.$7dd(n.$G6.get_$i());t.add_$2C(n.$$d_$9Dt);t.add_$1x(n.$$d_$9Ds);t.add_$2m(n.$$d_$9Dr);n.set_$aE(!0);n.$k.$z(t);n.set_$9XN(new _C(n.$$d_$9XM,_d.$RJ.$A))}}_d.$RJ.prototype={$IJ:null,$G6:null,$k:null,$13S:null,$2N4:!1,$C2:!1,$2ZD:null,$65i:null,$8w:null,get_$9XN:function(){return this.$2ZD},set_$9XN:function(n){if(this.$2ZD!==n){this.$2ZD=n;$3(this,"ProcessMembershipCommand")}return n},get_$56r:function(){return new Array(0)},$j6:function(){},get_$5W3:function(){return this.$2N4},set_$5W3:function(n){if(this.$2N4!==n){this.$2N4=n;$3(this,"HideProcessMembershipButton")}return n},get_$cH:function(){return this.$8w},set_$cH:function(n){if(this.$8w!==n){this.$8w=n;$3(this,"ErrorMessage")}return n},get_$aE:function(){return this.$C2},set_$aE:function(n){if(this.$C2!==n){this.$C2=n;$3(this,"IsLoading")}return n},$9Dr:function(n){this.set_$aE(!1)},$9Ds:function(n){this.set_$5W3(!0);this.set_$cH(_nbs.NonBootStrings.l_ModernGroupRequest_ProcessRequestInfoFail_Text)},$9Dt:function(n){var t=n;this.$13S=_pc.$i.$1LP(t.get_$1HA().GroupPersona,2);this.set_$cH("");this.set_$5W3(!t.get_$1HA().IsOwner||this.$G6.get_$3O().Mailbox.EmailAddress===_g.$V.get_$I().get_$31().get_$Aj())},$9XM:function(){var t=_pc.$i.$DQ(this.$G6.get_$3O().Mailbox);var n=new _d.$QX;n.get_$qP().$2SG=[t];n.get_$qP().$25D=!0;this.$IJ.$1t4(this.$13S,n)}};_d.$zN=function(n,t,i,r,u){_d.$zN.initializeBase(this,[n,t,i,r,u])};_d.$Uw=function(n,t){this.$$d_$7OU=Function.createDelegate(this,this.$7OU);this.$$d_$7OV=Function.createDelegate(this,this.$7OV);this.$$d_$9bV=Function.createDelegate(this,this.$9bV);this.$$d_$6NP=Function.createDelegate(this,this.$6NP);this.$$d_$7xv=Function.createDelegate(this,this.$7xv);this.$$d_$11k=Function.createDelegate(this,this.$11k);this.$$d_$D=Function.createDelegate(this,this.$D);_d.$Uw.initializeBase(this);this.$PV=new _d.$WO(n);this.$k=t};function $4o7(n){n.get_$Cg().$32(0,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text,null,!1,null,null,_nbs.NonBootStrings.l_SharedFolderFailedMessage_Sentencecase_Text)}_d.$Uw.prototype={$9d:null,$1z:null,$k:null,$PV:null,$2wP:null,$2kc:null,$3KV:null,get_$iE:function(){if(!this.$9d){this.$9d=new _y.$Lc;this.$9d.set_$4v(_nbs.NonBootStrings.l_AddSharedFolder_Lowercase_Text);this.$9d.set_$DP(this);var t=this;var i=new _C(this.$$d_$D,_a.$0.$8i,this.$PV,"Persona",function(){return!!t.$PV.$14});var n=new _C(this.$$d_$11k,_a.$0.$8i);this.$9d.set_$G1(n);var r=new _a.$2G(i,_nbs.NonBootStrings.l_AddSharedFolderButton_Lowercase_Text);var u=new _a.$2G(n,_u.Strings.l_CancelButtonLabel_LowerCase_Text);this.$9d.$7J.$D(r);this.$9d.$7J.$D(u)}return this.$9d},get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},get_$7xw:function(){return this.$2wP},set_$7xw:function(n){this.$2wP=n;return n},get_$7OW:function(){return this.$2kc},set_$7OW:function(n){this.$2kc=n;return n},get_$9bW:function(){return this.$3KV},set_$9bW:function(n){this.$3KV=n;return n},$13L:function(){var n=new _c.$15q;n.add_$2C(this.$$d_$7xv);this.$k.$z(n)},$34:function(n){if(n){var t=new _c.$1BX(n);t.add_$2C(this.$$d_$6NP);t.add_$1x(this.$$d_$9bV);this.$k.$z(t)}},$D:function(){if(this.$PV.$14){var t=this.$PV.$14.get_$1s().get_$1o();var i=this.$PV.$14.get_$1s().get_$1l().EmailAddress;var n=new _c.$11J(t,i);n.add_$2C(this.$$d_$7OV);n.add_$1x(this.$$d_$7OU);this.$k.$z(n);this.$11k()}},$11k:function(){this.get_$iE().set_$1O(!1);this.$PV.$1r()},$7xv:function(n){this.$2wP&&this.$2wP(n.$6GG)},$7OU:function(n){$4o7(this)},$7OV:function(n){if(this.$2kc){var t=n;this.$2kc(t.$7i,t.$1Gc)}},$9bV:function(n){$4o7(this)},$6NP:function(n){if(this.$3KV){var t=n;this.$3KV(t.$1Gc)}}};_d.$Ie=function(n){this.$$d_$5Wp=Function.createDelegate(this,this.$5Wp);this.$$d_$3bu=Function.createDelegate(this,this.$3bu);this.$$d_$5AL=Function.createDelegate(this,this.$5AL);_d.$Ie.initializeBase(this);this.$9c=n;this.$9c.$B5.add_$1Z(this.$$d_$5AL);this.$B5=new _js.$Z;this.$1iU=6e4};function $6qU(n,t){_js.Trace.logInfo(_a.$0.$4W,"Notification provider: adding invitation.");var i=new _d.$Vr(t,n.$$d_$3bu,n.$$d_$5Wp);if(!n.$MP){n.$MP=!0;$3(n,"ShowNotificationInTray")}n.$B5.$D(i);$3(n,"NotificationCount");$1ne(n)}function $3W8(n,t){_js.Trace.logInfo(_a.$0.$4W,"Notification provider: removing invitation.");n.$B5.$34(t);$3(n,"NotificationCount");if(!n.$B5.get_$B()){n.$MP=!1;$3(n,"ShowNotificationInTray")}}_d.$Ie.prototype={$B5:null,$9c:null,$MP:!1,get_$3xB:function(){return _d.$3.get_$7VQ()},get_$84R:function(){return _d.$3.get_$4W()},get_$5WX:function(){return _nbs.NonBootStrings.l_Chat_Notification_Title_Text},get_$1kw:function(){return this.$MP},get_$4Np:function(){return!0},get_$3IY:function(){return"ChatInvitationNotificationView"},get_$1go:function(){return this.$B5.get_$B()},get_$9os:function(){return!0},get_$3ET:function(){return"im_notify.mp3"},get_$9Ve:function(){return!0},get_$Z:function(){return this},$3bu:function(n){this.$9c.$3br(n.$7E);$3W8(this,n)},$5Wp:function(n){this.$9c.$3xI(n.$7E);$3W8(this,n)},$5AL:function(n,t){if(t.$2v){if(t.$2v===2)for(var f=t.$38[0],e=this.$B5.get_$B(),i=0;i<e;i++){var r=this.$B5.get_$3q(i);if(r.$7E===f){$3W8(this,r);break}}}else{var u=t.$2l[0];$6qU(this,u)}}};_d.$Vr=function(n,t,i){this.$$d_$1Na=Function.createDelegate(this,this.$1Na);this.$$d_$1Vz=Function.createDelegate(this,this.$1Vz);_d.$Vr.initializeBase(this);this.$7E=n;this.$1oN=t;this.$2yj=i;this.$1oO=new _0365f.$TB(this.$$d_$1Vz,_a.$0.$4W);this.$2yk=new _C(this.$$d_$1Na,_a.$0.$4W);this.$Wj=new _d.$8Z(this.$7E.$3RI,_y.$w.$3If,!1);this.$HG=new _d.$8Z(this.$7E.$3RI,4,!1)};_d.$Vr.prototype={$7E:null,$Wj:null,$HG:null,$1oO:null,$2yk:null,$1oN:null,$2yj:null,get_$52:function(){return this.$7E.$4aj},$1Vz:function(n){_js.Trace.logInfo(_a.$0.$4W,"ChatInvitationViewModel: Accepting session {0}.",this.$7E.get_$RC());if(n){this.$7E.$3UG=n.get_$TC();this.$7E.$3UK=n.get_$gg()}this.$1oN(this)},$1Na:function(){_js.Trace.logInfo(_a.$0.$4W,"ChatInvitationViewModel: Ignoring session {0}.",this.$7E.get_$RC());this.$2yj(this)}};_d.$Mu=function(n){this.$$d_$7gj=Function.createDelegate(this,this.$7gj);this.$$d_$3bu=Function.createDelegate(this,this.$3bu);this.$$d_$99I=Function.createDelegate(this,this.$99I);_d.$Mu.initializeBase(this);_a.$4.$l(n,"chatManager");this.$9c=n;this.$9c.$hj.add_$1Z(this.$$d_$99I);this.$B5=new _js.$Z;this.$1iU=0};function $6oX(n,t){_a.$4.$l(t,"persona");_js.Trace.logInfo(_a.$0.$4W,"Notification provider: adding buddy request invitation.");var i=new _d.$nM(t,n.$$d_$3bu,n.$$d_$7gj);if(!n.$MP){n.$MP=!0;$3(n,"ShowNotificationInTray")}n.$B5.$D(i);$3(n,"NotificationCount");$6(n.$3MX)&&n.set_$4TY(n.$B5.get_$3q(0));$1ne(n)}function $6oY(n,t){_js.Trace.logInfo(_a.$0.$4W,"Notification provider: removing buddy request invitation.");n.$B5.$34(t);$3(n,"NotificationCount");if(n.$B5.get_$B())n.set_$4TY(n.$B5.get_$3q(0));else{n.$MP=!1;$3(n,"ShowNotificationInTray")}}_d.$Mu.prototype={$B5:null,$9c:null,$MP:!1,$3MX:null,get_$3xB:function(){return _d.$3.get_$543()},get_$84R:function(){return _d.$3.get_$543()},get_$5WX:function(){return _nbs.NonBootStrings.l_BuddyRequest_Notification_Title_Text},get_$1kw:function(){return this.$MP},get_$4Np:function(){return!0},get_$3IY:function(){return"BuddyRequestNotificationView"},get_$Z:function(){return this},get_$1go:function(){return this.$B5.get_$B()},get_$9os:function(){return!0},get_$9Ve:function(){return!1},get_$4TY:function(){return this.$3MX},set_$4TY:function(n){this.$3MX=n;$3(this,"SelectedRequest");return n},$3bu:function(n){_a.$4.$l(n,"invitationViewModel");this.$9c.$7Me(n.$1Th.get_$1s())},$7gj:function(n){_a.$4.$l(n,"invitationViewModel");this.$9c.$7gi(n.$1Th.get_$1s())},$99I:function(n,t){if(t.$2v){if(t.$2v===2)for(var f=t.$38[0],e=this.$B5.get_$B(),i=0;i<e;i++){var r=this.$B5.get_$3q(i);if(!r.$1Th.get_$1s().get_$A6().localeCompare(f.get_$A6())){$6oY(this,r);break}}}else{var u=t.$2l[0];$6oX(this,u)}}};_d.$Da=function(){this.$65T=new _js.$Z;this.$1Jf=new _js.$Z;_d.$Da.initializeBase(this);this.$1iU=0};function $4oD(n,t){n.$1Jf.$D(t);$3(n,"NotificationCount");if(n.$1Jf.get_$B()===1){$3(n,"ShowNotificationInTray");$1ne(n)}}function $4oC(n,t){n.$1Jf.$34(t);$3(n,"NotificationCount");n.$1Jf.get_$B()||$3(n,"ShowNotificationInTray")}function $4oB(n,t){n.$65T.$D(t)}_d.$Da.prototype={get_$3xB:function(){return _d.$3.get_$9SY()},get_$84R:function(){return _d.$3.get_$9SX()},get_$5WX:function(){return _nbs.NonBootStrings.l_System_Notification_Title_Text},get_$1kw:function(){return this.$1Jf.get_$B()>0},get_$3IY:function(){return"SystemNotificationsView"},get_$1go:function(){return this.$1Jf.get_$B()},get_$9os:function(){return!0},get_$9Ve:function(){return!0},get_$4Np:function(){return!1}};_d.$Bv=function(n,t,i){this.$$d_$81B=Function.createDelegate(this,this.$81B);this.$$d_$80d=Function.createDelegate(this,this.$80d);this.$$d_$80x=Function.createDelegate(this,this.$80x);this.$$d_$66b=Function.createDelegate(this,this.$66b);this.$$d_$81U=Function.createDelegate(this,this.$81U);_d.$Bv.initializeBase(this);this.$M=n;this.$c=t;if($6(i)||!i){var r=new _g.$At;r.NotificationType="NewMailNotification";r.InferenceEnabled=$4n4(this);var u=new _h.$BS(r);u.$IU(_a.$0.$5q,"NewMailNotification",this.$$d_$81U,0)}this.$3Dn=new _C(this.$$d_$66b,_a.$0.$5q);$6uk(this)};function $2hV(n){n.$MP=!1;$3(n,"ShowNotificationInTray");n.set_$5h4("");n.set_$5h5("");n.set_$6K2("");n.$1gd=null}function $6uk(n){n.$M.$IU(_d.$14t,n.$$d_$80x);n.$M.$IU(_y.$aH,n.$$d_$80d);n.$M.$IU(_y.$dD,n.$$d_$81B)}function $6uj(n,t){return $4n4(n)&&t.IsClutter}function $4n4(n){return n.$c.get_$6H().get_$V0()&&n.$c.get_$1I().get_$MO()}_d.$Bv.prototype={$MP:!1,$34a:null,$34c:null,$3Ir:null,$1gd:null,$66r:null,$3Dn:null,$M:null,$c:null,get_$3xB:function(){return _d.$3.get_$8Hg()},get_$84R:function(){return _d.$3.get_$8He()},get_$5WX:function(){return _nbs.NonBootStrings.l_NewMail_Notification_Title_Text},get_$1kw:function(){return this.$MP},get_$4Np:function(){return!!(this.$c.get_$1I().get_$4HL()&1)},get_$3IY:function(){return"NewMailNotificationView"},get_$1go:function(){return 0},get_$9os:function(){return!1},get_$3ET:function(){return"email_notify.mp3"},get_$9Ve:function(){return!0},get_$5h4:function(){return this.$34a},set_$5h4:function(n){if(this.$34a!==n){this.$34a=n;$3(this,"Line1")}return n},get_$5h5:function(){return this.$34c},set_$5h5:function(n){if(this.$34c!==n){this.$34c=n;$3(this,"Line2")}return n},get_$6K2:function(){return this.$3Ir},set_$6K2:function(n){if(this.$3Ir!==n){this.$3Ir=n;$3(this,"PreviewText")}return n},$81U:function(n){var t=n;if(n.EventType!=="Reload"&&!$6uj(this,t)){this.$M.$9Yf(_c.$yE,new _c.$yE);this.set_$5h4(t.Sender);this.set_$5h5(t.Subject);this.set_$6K2(t.PreviewText);this.$1gd=t.ItemId;this.$66r=t.ConversationId;this.$MP=!0;$3(this,"ShowNotificationInTray");$1ne(this)}},$66b:function(){if(!$6(this.$1gd)){var n=new _g.$1q(this.$1gd);this.$M.$9Yf(_y.$qd,new _y.$qd(n));$2hV(this)}},$80x:function(n){this.$MP&&_g.$h.$1i.doesIdEqualName(n.$2k,"inbox")&&$2hV(this)},$80d:function(n){this.$MP&&n.$Cr.Id===this.$66r&&$2hV(this)},$81B:function(n){this.$MP&&n.$5N.Id===this.$1gd&&$2hV(this)}};_d.$Pa=function(n){this.$$d_$3we=Function.createDelegate(this,this.$3we);this.$$d_$9vd=Function.createDelegate(this,this.$9vd);this.$$d_$4Ko=Function.createDelegate(this,this.$4Ko);this.$$d_$81X=Function.createDelegate(this,this.$81X);this.$$d_$5UQ=Function.createDelegate(this,this.$5UQ);_d.$Pa.initializeBase(this);this.$16x=n;this.$16x.add_$67S(this.$$d_$5UQ);this.$16x.add_$97Y(this.$$d_$81X);this.$16x.$Y("ShowNotificationInTray",this.$$d_$4Ko)};function $6um(n){n.$16x.$1iU&&(n.$ig=_js.$J.get_$I().$1w(_a.$0.$5q,"PopOutHide",n.$$d_$3we,n.$16x.$1iU))}function $6ul(n){n.$ig&&(n.$ig=_js.$J.get_$I().$4z(n.$ig))}_d.$Pa.prototype={$16x:null,$W1:!1,$ig:null,$4Vb:!1,add_$67S:function(n){this.$2N("NotificationRaised",n)},remove_$67S:function(n){this.$2P("NotificationRaised",n)},get_$9ve:function(){return new _C(this.$$d_$9vd,_a.$0.$5q)},get_$2Po:function(){return this.$W1},set_$2Po:function(n){if(this.$W1!==n){this.$W1=n;$3(this,"IsPopupShown");this.$W1||$6ul(this)}return n},get_$970:function(){return _a.UserAgent.getInstance().$is?_nbs.NonBootStrings.l_NewNotificationButtonSafari_Text:_nbs.NonBootStrings.l_NewNotificationButton_Text},$3we:function(){this.set_$2Po(!1)},$9vd:function(){this.$W1||(this.$4Vb=!0);this.set_$2Po(!this.$W1)},$5UQ:function(n){n.get_$9Ve()&&this.set_$2Po(!0);$6um(this);$CY(this,"NotificationRaised",this,this)},$81X:function(n){this.$W1&&this.$3we()},$4Ko:function(n,t){this.$16x.get_$1kw()||this.$3we()}};_d.$8Y=function(){_d.$8Y.initializeBase(this)};function $1ne(n){$CY(n,"NotificationRaised",n,n)}function $6un(n){$CY(n,"NotificationDismissed",n,n)}_d.$8Y.prototype={$1iU:2e3,add_$67S:function(n){this.$2N("NotificationRaised",n)},remove_$67S:function(n){this.$2P("NotificationRaised",n)},add_$97Y:function(n){this.$2N("NotificationDismissed",n)},remove_$97Y:function(n){this.$2P("NotificationDismissed",n)},get_$3ET:function(){return"calendar_notify.mp3"}};_d.$Kx=function(n){this.$$d_$4Ko=Function.createDelegate(this,this.$4Ko);this.$$d_$5UQ=Function.createDelegate(this,this.$5UQ);this.$$d_$7PS=Function.createDelegate(this,this.$7PS);_d.$Kx.initializeBase(this);this.$gV=new _js.$Z;this.$3hj=$6(n)?this.$$d_$7PS:n};function $4n5(n,t){var i=t.get_$1kw();if(!i){var r=this;n.$gV.$Bh(function(n){i=i||n.$16x.get_$1kw()})}n.$2y!==i&&n.set_$1O(i)}function $6uo(n,t){n.set_$3ET(new _d.$n9(null,_y.$v.$v.$7y7(t)+"?UA=0",null));n.set_$4Vs(!0)}_d.$Kx.prototype={$gV:null,$44u:null,$2y:!1,$3ES:null,$4Vr:!1,$3hj:null,get_$67L:function(){return this.$gV},set_$67L:function(n){if(this.$gV!==n){this.$gV=n;$3(this,"NotificationEntries")}return n},get_$3ET:function(){return this.$3ES},set_$3ET:function(n){if(this.$3ES!==n){this.$3ES=n;$3(this,"NotificationSoundSource")}return n},get_$4Vs:function(){return this.$4Vr},set_$4Vs:function(n){if(this.$4Vr!==n){this.$4Vr=n;$3(this,"ShouldPlayNotificationSound")}return n},get_$1O:function(){return this.$2y},set_$1O:function(n){if(this.$2y!==n){this.$2y=n;$3(this,"IsShown")}return n},$110:function(n){var t=new _d.$Pa(n);t.add_$67S(this.$$d_$5UQ);n.$Y("ShowNotificationInTray",this.$$d_$4Ko);$4n5(this,n);this.$gV.$D(t)},$4Ko:function(n,t){var i=n;$4n5(this,i)},$5UQ:function(n){var t=n.$16x;this.$3hj()&&t.get_$1kw()&&t.get_$4Np()&&($6(t.get_$3ET())||$6uo(this,t.get_$3ET()))},$7PS:function(){if($6(this.$44u)||_a.$7.get_$29().$5z(this.$44u)>5e3){this.$44u=_a.$7.get_$29();return!0}else return!1}};_d.$yP=function(){this.$67j=new _js.$Z};_d.$yP.prototype={get_$67L:function(){return this.$67j},set_$67L:function(n){return n},get_$4Vs:function(){return!1},set_$4Vs:function(n){return n},get_$1O:function(){return!1},set_$1O:function(n){return n}};_d.$rH=function(n,t){this.$$d_$80C=Function.createDelegate(this,this.$80C);this.$$d_$85r=Function.createDelegate(this,this.$85r);this.$$d_$9ZM=Function.createDelegate(this,this.$9ZM);this.$$d_$2sD=Function.createDelegate(this,this.$2sD);this.$2IU=-1;_d.$rH.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$rH.initializeBase(this);this.$M=n;this.$1Qv=t;this.$2sE=new _C(this.$$d_$2sD,_a.$0.$5q);this.$6MD=new _C(this.$$d_$9ZM,_a.$0.$5q);$4oB(this.$1Qv,this);_js.$J.get_$I().$3r(_a.$0.$5q,"PasswordExpirationNotificationProvider::ctor",this.$$d_$85r)};_d.$rH.prototype={$2sE:null,$6MD:null,$M:null,$1Qv:null,get_$3w9:function(){return _nbs.NonBootStrings.l_PasswordExpiresHeader_Text},get_$9vL:function(){return this.$2IU?_js.$9.$4R(_nbs.NonBootStrings.l_PasswordExpiresInNDaysTitle_Text,this.$2IU):_nbs.NonBootStrings.l_PasswordExpiresTodayTitle_Text},get_$9sl:function(){return _nbs.NonBootStrings.l_PasswordExpiresSubTitle_Text},get_$7TB:function(){return _u.Strings.l_Yes_Text},get_$7TA:function(){return this.$6MD},get_$7TD:function(){return _u.Strings.l_No_Text},get_$7TC:function(){return this.$2sE},$85r:function(){var n=new _c.$15R;n.add_$2C(this.$$d_$80C);OwaApplication.$1W.$z(n)},$80C:function(n){var t=n;this.$2IU=t.$3mR;this.$2IU>=0&&$4oD(this.$1Qv,this)},$2sD:function(){$4oC(this.$1Qv,this)},$9ZM:function(){this.$2sD();var n=new _y.$Q1("PersonalSettings/Password.aspx");this.$M.$9Yf(_y.$Q1,n)}};_d.$Rs=function(n){this.$$d_$16E=Function.createDelegate(this,this.$16E);this.$$d_$6DW=Function.createDelegate(this,this.$6DW);_d.$Rs.initializeBase(this);this.$Oy=n;this.$27D=new _d.$7V(this.$Oy);this.$27D.add_$6Mn(this.$$d_$6DW);this.$Oy.add_$53H(this.$$d_$16E);this.$1iU=0};_d.$Rs.prototype={$Oy:null,$27D:null,$4Wa:!1,get_$3xB:function(){return _d.$3.get_$7mZ()},get_$84R:function(){return _d.$3.get_$7mY()},get_$5WX:function(){return String.format(_nbs.NonBootStrings.l_Reminder_Notification_Title_Text,this.get_$1go())},get_$1kw:function(){return this.$4Wa},get_$4Np:function(){return _g.$V.get_$I().get_$1I().get_$5Km()},get_$3IY:function(){return"RemindersNotificationView"},get_$1go:function(){return this.$Oy.$Ep.get_$B()},get_$9os:function(){return!0},get_$9Ve:function(){return!0},$6DW:function(n){$6un(this)},$16E:function(n,t){this.$4Wa=this.$Oy.$Ep.get_$B()>0;$PB(this,"ShowNotificationInTray","NotificationCount","IconTitleText");(!t.$2v||t.$2v===4)&&this.$4Wa&&$1ne(this)}};_d.$tI=function(n){this.$$d_$9k4=Function.createDelegate(this,this.$9k4);this.$$d_$7xr=Function.createDelegate(this,this.$7xr);this.$$d_$7vo=Function.createDelegate(this,this.$7vo);this.$$d_$7it=Function.createDelegate(this,this.$7it);this.$$d_$2sD=Function.createDelegate(this,this.$2sD);_d.$tI.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$tI.initializeBase(this);this.$1Qv=n;this.$FT=new _c.$10t;this.$2sE=new _C(this.$$d_$2sD,_a.$0.$5q);this.$5J8=new _C(this.$$d_$7it,_a.$0.$5q);$4oB(this.$1Qv,this);_js.$J.get_$I().$3r(_a.$0.$5q,"UserOofNotificationProvider::ctor",this.$$d_$7vo)};_d.$tI.prototype={$FT:null,$2sE:null,$5J8:null,$1Qv:null,get_$3w9:function(){return _nbs.NonBootStrings.l_OofNotificationHeader_Text},get_$9vL:function(){return this.$FT.$1yd&&this.$FT.$8B?String.format(_nbs.NonBootStrings.l_OofScheduledUntilXNotificationTitle_Text,this.$FT.$8B):_nbs.NonBootStrings.l_UnscheduledOofNotificationTitle_Text},get_$9sl:function(){return _nbs.NonBootStrings.l_UnscheduledOofNotificationSubTitle_Text},get_$7TB:function(){return _u.Strings.l_Yes_Text},get_$7TA:function(){return this.$5J8},get_$7TD:function(){return _u.Strings.l_No_Text},get_$7TC:function(){return this.$2sE},$7vo:function(){var n=new _c.$w8(this.$FT);n.add_$2C(this.$$d_$7xr);OwaApplication.$1W.$z(n)},$7xr:function(n){this.$FT.$rP&&$4oD(this.$1Qv,this)},$2sD:function(){$4oC(this.$1Qv,this)},$7it:function(){this.$2sD();this.$FT.set_$1y8(!1);var n=new _c.$100(this.$FT);n.add_$1x(this.$$d_$9k4);OwaApplication.$1W.$z(n)},$9k4:function(n){_a.$4b.$32(_nbs.NonBootStrings.l_SetUserOOFSettingsError_Text,0)}};_d.$Nr=function(n,t,i,r,u){this.$$d_$9o8=Function.createDelegate(this,this.$9o8);_d.$Nr.initializeBase(this,[n,t,i]);this.set_$aE(!1);this.set_$1cP(!0);this.set_$1xp(!1);this.set_$9Sl(r);this.$6f=u;this.$Kn=new _C(this.$$d_$9o8,_d.$Nr.$A)};_d.$Nr.$E=function(n,t,i,r,u){_a.$4.$l(n,"owaShell");return new _d.$Nr(n,t,i,r,u)};_d.$Nr.prototype={$16V:null,$6GD:null,$6f:null,$Kn:null,$7co:function(){return null},$7ep:function(){return null},$5EN:function(){return{}},get_$9Sl:function(){return this.$16V},set_$9Sl:function(n){this.$16V=n;this.$6GD=this.$16V.$3t8();return n},$1YQ:function(){var n=[new _y.$2W(_y.$c.get_$11A(),_y.$c.get_$19k(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(this.$$d_$9b,_d.$Nr.$A))];return _y.$26.$Bg(this,n,null)},$9o8:function(){this.$6f.$Re(this.$6GD)}};_d.$K0=function(n,t,i,r,u,f){this.$$d_$9pY=Function.createDelegate(this,this.$9pY);this.$$d_$9oe=Function.createDelegate(this,this.$9oe);this.$$d_$9pA=Function.createDelegate(this,this.$9pA);this.$$d_$9p9=Function.createDelegate(this,this.$9p9);_d.$K0.initializeBase(this,[n,t,i]);this.set_$aE(!1);this.set_$1cP(!0);this.set_$1xp(!1);this.$13=f;this.$6f=u;this.$5B7=new _C(this.$$d_$9p9,_a.$0.$KR);this.$5B8=new _C(this.$$d_$9pA,_a.$0.$KR);this.$5B6=new _C(this.$$d_$9oe,_a.$0.$KR);this.$5B9=new _C(this.$$d_$9pY,_a.$0.$KR);this.get_$Xp()&&r&&(this.$3L=r.$3L)};_d.$K0.$E=function(n,t,i,r,u,f){_a.$4.$l(n,"owaShell");return new _d.$K0(n,t,i,r,u,f)};_d.$K0.prototype={$3L:null,$6f:null,$13:null,$5B6:null,$5B8:null,$5B9:null,$5B7:null,get_$Xp:function(){return _g.$V.get_$I().get_$31().get_$Xp()},get_$6KF:function(){return this.$13.get_$67()?null:this.$3L?this.$3L.get_$16t().get_$6M():"http://go.microsoft.com/fwlink/p/?LinkId=260597"},get_$6al:function(){return this.$13.get_$L5()&&this.$13.get_$67()?"http://go.microsoft.com/fwlink/?LinkId=299663":this.$13.get_$2QO()&&this.$13.get_$67()?"http://go.microsoft.com/fwlink/?LinkId=301830":null},get_$16t:function(){return this.$13.get_$L5()&&this.$13.get_$67()?"http://go.microsoft.com/fwlink/?LinkId=299665":this.$13.get_$2QO()&&this.$13.get_$67()?"http://go.microsoft.com/fwlink/?LinkId=301831":null},get_$6au:function(){return this.$13.get_$L5()&&this.$13.get_$67()?"http://go.microsoft.com/fwlink/?LinkId=299664":null},$9cx:function(n){n.set_$1d2(!1);n.set_$1d3(!0)},$1YQ:function(){var n=[new _y.$2W(_y.$c.get_$11A(),_y.$c.get_$19k(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(this.$$d_$9b,_d.$K0.$A))];return _y.$26.$Bg(this,n,null)},$7co:function(){return null},$7ep:function(){return null},$5EN:function(){return{}},$9p9:function(){this.$6f.$Re(this.get_$6KF())},$9pA:function(){this.$6f.$Re(this.get_$16t())},$9oe:function(){this.$6f.$Re(this.get_$6al())},$9pY:function(){this.$6f.$Re(this.get_$6au())}};_d.$L1=function(n,t,i){this.$$d_$59P=Function.createDelegate(this,this.$59P);this.$$d_$5Cb=Function.createDelegate(this,this.$5Cb);_d.$L1.initializeBase(this,[n,t,i]);this.$FT=new _c.$10t;this.set_$M8(this.$FT);var r=new _js.$Z;r.$D(new _a.$2G(new _C(this.$$d_$5Cb,_d.$L1.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));r.$D(new _a.$2G(new _C(this.$$d_$59P,_d.$L1.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.set_$6GB(r)};_d.$L1.$E=function(n,t,i){_a.$4.$l(n,"owaShell");return new _d.$L1(n,t,i)};_d.$L1.prototype={$rP:!1,$2Jz:!1,$2aD:0,$2Js:null,$2Jr:null,$FT:null,$1xq:!1,$1Ri:null,$1OM:!1,get_$5c2:function(){return this.$1xq},set_$5c2:function(n){if(this.$1xq!==n){this.$1xq=n;$3(this,"IsLoadingFinished")}return n},get_$1y8:function(){return this.$rP},set_$1y8:function(n){if(this.$rP===n)return n;this.$rP=n;$3(this,"IsOofOn");return n},get_$2tB:function(){return this.$2Jz},set_$2tB:function(n){if(this.$2Jz===n)return n;this.$2Jz=n;$3(this,"EnableExternalReply");return n},get_$3Ke:function(){return this.$2aD},set_$3Ke:function(n){if(this.$2aD===n)return n;this.$2aD=n;$3(this,"ReplyToExternalPeopleType");return n},get_$3ow:function(){return this.$2Js},set_$3ow:function(n){if(this.$2Js===n)return n;this.$2Js=n;$3(this,"EditorInternalReplyMessage");return n},get_$3ov:function(){return this.$2Jr},set_$3ov:function(n){if(this.$2Jr===n)return n;this.$2Jr=n;$3(this,"EditorExternalReplyMessage");return n},get_$6GB:function(){return this.$1Ri},set_$6GB:function(n){if(n!==this.$1Ri){this.$1Ri=n;$3(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1cc:function(){return this.$1OM},set_$1cc:function(n){if(n!==this.$1OM){this.$1OM=n;$3(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$7Wm:function(){return this.$FT.$1yd&&!this.get_$1Om()?_nbs.NonBootStrings.l_OverwriteOofScheduleSettingConfirmMessageWhenCloseOptionWithoutSave_Text:_d.$En.prototype.get_$7Wm.call(this)},get_$6Zr:function(){return"Oof"},$2XW:function(){this.set_$1y8(!1);this.set_$3ow("");this.set_$3ov("");this.$3Kw();_d.$En.prototype.$2XW.call(this)},$FK:function(n){this.$FT.$1yd?n&&!this.get_$1Om()?this.$3oQ():this.set_$1cc(!0):this.$3oQ()},$7co:function(){return new _c.$w8(this.$FT)},$7ep:function(){return new _c.$100(this.$FT)},$5EN:function(){var n={};n.IsOofOn=!0;n.EnableExternalReply=!0;n.ReplyToExternalPeopleType=!0;n.EditorInternalReplyMessage=!0;n.EditorExternalReplyMessage=!0;return n},$1Fw:function(n){switch(this.$FT.$2KO){case 2:this.set_$2tB(!0);this.set_$3Ke(2);break;case 1:this.set_$2tB(!0);this.set_$3Ke(1);break;default:this.set_$2tB(!1);this.set_$3Ke(2);break}this.set_$1y8(this.$FT.$rP);this.set_$3ow(this.$FT.$2O0);this.set_$3ov(this.$FT.$2KP);this.set_$5c2(!0);_d.$En.prototype.$1Fw.call(this,n)},$1hX:function(n){this.set_$1UQ(this.$rP);_d.$En.prototype.$1hX.call(this,n)},$7aO:function(n){return n?_nbs.NonBootStrings.l_OofOn_Text:_nbs.NonBootStrings.l_OofOff_Text},$5Cb:function(){this.set_$1cc(!1);this.$3oQ()},$59P:function(){this.set_$1cc(!1)},$3oQ:function(){this.$FT.set_$1y8(this.$rP);this.$2Jz?this.$FT.set_$3qW(this.$2aD):this.$FT.set_$3qW(0);this.$FT.set_$5Yr(this.$2Js);this.$FT.set_$5MM(this.$2Jr);_d.$En.prototype.$FK.call(this,!1);this.$FT.set_$5dw(!1)}};_d.$MJ=function(n,t,i,r){this.$$d_$1Fw=Function.createDelegate(this,this.$1Fw);this.$$d_$59P=Function.createDelegate(this,this.$59P);this.$$d_$5Cb=Function.createDelegate(this,this.$5Cb);_d.$MJ.initializeBase(this,[n,t,r]);this.$vf=new _c.$12w;this.set_$M8(this.$vf);var u=new _js.$Z;u.$D(new _a.$2G(new _C(this.$$d_$5Cb,_d.$MJ.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));u.$D(new _a.$2G(new _C(this.$$d_$59P,_d.$MJ.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.$Wx=i;var f=this.$7co();f.add_$2C(this.$$d_$1Fw);f.add_$1x(this.$$d_$9Fi);OwaApplication.$1W.$z(f);this.set_$6GB(u)};_d.$MJ.$E=function(n,t,i,r){_a.$4.$l(n,"owaShell");return new _d.$MJ(n,t,i.$Wx,r)};_d.$MJ.prototype={$j1:!1,$vf:null,$1xq:!1,$1Ri:null,$1OM:!1,$Wx:null,get_$338:function(){return this.$j1},set_$338:function(n){if(this.$j1===n)return n;this.$j1=n;$3(this,"IsSyncContactsToDeviceEnabled");return n},get_$5c2:function(){return this.$1xq},set_$5c2:function(n){if(this.$1xq!==n){this.$1xq=n;$3(this,"IsLoadingFinished")}return n},get_$6GB:function(){return this.$1Ri},set_$6GB:function(n){if(n!==this.$1Ri){this.$1Ri=n;$3(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1cc:function(){return this.$1OM},set_$1cc:function(n){if(n!==this.$1OM){this.$1OM=n;$3(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$6Zr:function(){return null},get_$9i0:function(){return _nbs.NonBootStrings.l_OptionContactSyncFail_Text},$2XW:function(){this.$j1=!1;this.$3Kw();_d.$En.prototype.$2XW.call(this)},$FK:function(n){this.$vf.set_$338(this.$j1);_d.$En.prototype.$FK.call(this,n)},$7co:function(){return new _c.$15O(this.$vf,this.$Wx)},$7ep:function(){return new _c.$1CR(this.$vf,this.$Wx)},$5EN:function(){var n={};n.IsSyncContactsToDeviceEnabled=!0;return n},$1Fw:function(n){this.set_$338(this.$vf.$j1);this.set_$1UQ(this.$j1);this.set_$5c2(!0);_d.$En.prototype.$1Fw.call(this,n)},$1hX:function(n){this.set_$1UQ(this.$vf.$j1);_d.$En.prototype.$1hX.call(this,n)},$7aO:function(n){return n?_nbs.NonBootStrings.l_OofOn_Text:_nbs.NonBootStrings.l_OofOff_Text},$9cx:function(n){this.set_$1UQ(this.$j1);n.set_$1d2(!1);n.set_$1d3(!0)},$5Cb:function(){this.set_$1cc(!1);this.$FK(!1)},$59P:function(){this.set_$1cc(!1)}};_d.$qn=function(n,t,i){_d.$qn.initializeBase(this);_a.$4.$l(n,"saveAndNavigateAwayCommand");_a.$4.$l(t,"dontSaveAndNavigateAwayCommand");_a.$4.$l(i,"cancelCommand");this.$6QE=n;this.$5Jh=t;this.$7V=i};function $6uv(n){if($6(n.$vP)){var t=new _js.$Z;t.$D(new _a.$2G(n.$6QE,_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));t.$D(new _a.$2G(n.$5Jh,_u.Strings.l_ConfirmDialog_Discard_Text,null));t.$D(new _a.$2G(n.$7V,_u.Strings.l_ConfirmDialog_Cancel_Text,null));n.set_$5BN(t)}}_d.$qn.prototype={$6QE:null,$5Jh:null,$7V:null,$vP:null,$144:!1,get_$5BN:function(){return this.$vP},set_$5BN:function(n){if(n!==this.$vP){this.$vP=n;$N(this,"CloseConfirmDialogButtonData")}return n},get_$1bs:function(){return this.$144},set_$1bs:function(n){if(n!==this.$144){this.$144=n;$N(this,"IsCloseConfirmDialogShown")}return n},$bL:function(){$6uv(this);this.set_$1bs(!0)},$Zz:function(){this.set_$1bs(!1)}};_d.$En=function(n,t,i){this.$$d_$691=Function.createDelegate(this,this.$691);this.$$d_$1Fw=Function.createDelegate(this,this.$1Fw);this.$$d_$9Fh=Function.createDelegate(this,this.$9Fh);this.$$d_$9P3=Function.createDelegate(this,this.$9P3);this.$$d_$1hX=Function.createDelegate(this,this.$1hX);this.$$d_$4SV=Function.createDelegate(this,this.$4SV);this.$$d_$1gX=Function.createDelegate(this,this.$1gX);this.$$d_$9Ko=Function.createDelegate(this,this.$9Ko);this.$$d_$7UN=Function.createDelegate(this,this.$7UN);this.$$d_$3oM=Function.createDelegate(this,this.$3oM);this.$$d_$3Lm=Function.createDelegate(this,this.$3Lm);this.$$d_$9Fi=Function.createDelegate(this,this.$9Fi);this.$$d_$9b=Function.createDelegate(this,this.$9b);_d.$En.initializeBase(this);_a.$4.$l(n,"owaShell");this.$C=n;this.$7i=t;this.$M_5=i;this.$1Xv=new _d.$qn(new _C(this.$$d_$3Lm,_d.$En.$A),new _C(this.$$d_$3oM,_d.$En.$A),new _C(this.$$d_$7UN,_d.$En.$A));this.$dS=new _y.$FW;this.$1z=new _y.$4c;this.add_$7q(this.$$d_$9Ko);if(this.$C.get_$L()==="TouchNarrow"){this.set_$7D(this.$1YQ());this.add_$4Ue(this.$$d_$1gX)}this.$El=new _C(this.$$d_$4SV,_d.$En.$A)};_d.$En.$7in=function(n,t){if(!$6(n.$Pq))for(var e=n.$Pq,c=e.length,i=0;i<c;++i){var l=e[i];l.get_$P3().set_$5u(!t)}if(!$6(n.$Qg))for(var o=n.$Qg,a=o.length,r=0;r<a;++r){var v=o[r];v.get_$P3().set_$5u(!t)}if(!$6(n.$P0))for(var s=n.$P0,y=s.length,u=0;u<y;++u){var p=s[u];p.get_$P3().set_$5u(!t)}$6(n.$yp)||n.$yp.get_$P3().set_$5u(!t);if(!$6(n.$1C))for(var h=n.$1C,w=h.length,f=0;f<w;++f){var b=h[f];b.get_$P3().set_$5u(!t)}};function $6uw(n){if(!$6(n.$Ls_5)){n.$Ls_5.remove_$2m(n.$$d_$9Fh);n.$Ls_5.remove_$2C(n.$$d_$1Fw);n.$Ls_5.remove_$1x(n.$$d_$9Fi)}n.get_$1Om()&&n.remove_$24t(n.$$d_$691);n.set_$1cP(!1);n.set_$1xp(!1);n.set_$aE(!1)}function $6ux(n){n.set_$Dw(!1);$6C(n,"ValidationOnSaveFailed")}_d.$En.prototype={$C:null,$1Xv:null,$7i:null,$4d:null,$2JC:null,$6Zs:null,$184:null,$Ls_5:null,$1kN:null,$3P:null,$C2:!1,$41U:!1,$31c:!1,$Dv:!1,$3zE:!1,$dS:null,$El:null,$1z:null,$M_5:null,$3gr:null,add_$4In:function(n){this.$2N("OnBack",n)},remove_$4In:function(n){this.$2P("OnBack",n)},add_$24t:function(n){this.$2N("OnBusy",n)},remove_$24t:function(n){this.$2P("OnBusy",n)},add_$4Ue:function(n){this.$2N("SetActionSuccess",n)},remove_$4Ue:function(n){this.$2P("SetActionSuccess",n)},add_$6T7:function(n){this.$2N("SetActionFailure",n)},remove_$6T7:function(n){this.$2P("SetActionFailure",n)},add_$6fc:function(n){this.$2N("ValidationOnSaveFailed",n)},remove_$6fc:function(n){this.$2P("ValidationOnSaveFailed",n)},get_$7Wm:function(){return _nbs.NonBootStrings.l_ConfirmMessageWhenCloseOptionWithoutSave_Text},get_$9i0:function(){return _u.Strings.l_SaveOptionFailureMessage_Text},get_$6Zr:function(){return null},get_$1lL:function(){return this.$184},set_$1lL:function(n){this.$184=n;$3(this,"Summary");return n},get_$1UQ:function(){return this.$6Zs},set_$1UQ:function(n){this.$6Zs=n;this.set_$1lL(this.$7aO(n));$3(this,"SummaryRaw");return n},get_$1iT:function(){return 1},get_$2MT:function(){return null},get_$7iz:function(){return!0},get_$89:function(){return this.$4d},set_$89:function(n){this.$4d=n;return n},get_$5ZX:function(){return this.$3zE},get_$1Om:function(){return this.$C.get_$L()==="TouchNarrow"},get_$aE:function(){return this.$C2},set_$aE:function(n){this.$C2=n;$6C(this,"OnBusy");return n},get_$1cP:function(){return this.$41U},set_$1cP:function(n){this.$41U=n;$3(this,"IsLoadSucceeded");return n},get_$1xp:function(){return this.$31c},set_$1xp:function(n){this.$31c=n;$3(this,"IsLoadFailed");return n},get_$Dw:function(){return this.$Dv},set_$Dw:function(n){this.$Dv=n;$6C(this,"OnBusy");return n},get_$Fb:function(){return this.$C2?_u.Strings.l_LoadingOption_Text:this.$Dv?_nbs.NonBootStrings.l_SavingOption_Text:""},get_$6V:function(){return this.$C2||this.$Dv},get_$u1:function(){return this.get_$1Om()?this.get_$6V():!1},get_$Ld:function(){return 1},get_$M8:function(){return this.$3P},set_$M8:function(n){this.$3P=n;return n},$9Ko:function(n,t){if(!$6(this.$2JC)&&!$6(this.$2JC[t])){this.$3zE=!0;this.$2JC[t]=!0}},$3Kw:function(){this.$3zE=!1},$7X:function(){this.$C.$7X(this)},$4SV:function(){this.$FK(!1)},$FK:function(n){if(!this.$Dv&&!this.$31c){if(!$6(this.$1kN)){this.$1kN.remove_$2C(this.$$d_$1hX);this.$1kN.remove_$1x(this.$$d_$9P3)}this.$1kN=this.$7ep();this.$1kN.add_$2C(this.$$d_$1hX);this.$1kN.add_$1x(this.$$d_$9P3);this.set_$Dw(!0);OwaApplication.$1W.$z(this.$1kN)}},$2XW:function(){if(!$6(this.$Ls_5)){this.$Ls_5.remove_$2m(this.$$d_$9Fh);this.$Ls_5.remove_$2C(this.$$d_$1Fw);this.$Ls_5.remove_$1x(this.$$d_$9Fi)}this.get_$1Om()&&this.add_$24t(this.$$d_$691);this.$Ls_5=this.$7co();if(this.$Ls_5){this.$Ls_5.add_$2m(this.$$d_$9Fh);this.$Ls_5.add_$2C(this.$$d_$1Fw);this.$Ls_5.add_$1x(this.$$d_$9Fi);this.set_$1cP(!1);this.set_$1xp(!1);this.set_$aE(!0);OwaApplication.$1W.$z(this.$Ls_5)}},$9cx:function(n){},$3F6:function(){this.$C2&&$6uw(this);$6C(this,"OnBack")},$1Fw:function(n){this.$2JC=this.$5EN();this.set_$aE(!1);this.set_$1cP(!0);this.set_$1xp(!1);$6C(this,"GetActionSuccess")},$9Fi:function(n){this.$2JC=this.$5EN();this.set_$aE(!1);this.set_$1cP(!1);this.set_$1xp(!0);$6C(this,"GetActionFailure")},$1hX:function(n){this.set_$Dw(!1);this.$3Kw();this.$C.get_$L()==="TouchNarrow"&&this.$1gX();$6C(this,"SetActionSuccess")},$9P3:function(n){this.set_$Dw(!1);var t=this;this.$1Hp(this.get_$9i0(),function(n,i){$6C(t,"SetActionFailure")})},$1Hp:function(n,t){this.$1z.$32(0,n,t,!1,null,null,_nbs.NonBootStrings.l_OptionActionErrorDialogTitle_Text)},$7aO:function(n){return n},$9Fh:function(n){this.$3Kw()},$1YQ:function(){this.$3gr=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItemMobile_Text,new _C(this.$$d_$9b,_d.$En.$A),null,_u.Strings.l_CancelItemMobileAria_Text);var n=[new _y.$2W(_y.$c.get_$FK(),_y.$c.get_$1jj(),_nbs.NonBootStrings.l_SaveItemMobile_Text,new _C(this.$$d_$4SV,_d.$En.$A),null,_u.Strings.l_SaveItemMobileAria_Text),this.$3gr];return _y.$26.$Bg(this,n,null)},$9b:function(){this.get_$5ZX()?this.$1Xv.$bL():this.$1gX()},$3Lm:function(){this.$1Xv.$Zz();this.$4SV()},$3oM:function(){this.$1Xv.$Zz();this.$1gX()},$7UN:function(){this.$1Xv.$Zz()},$1gX:function(){this.get_$1Om()&&this.remove_$24t(this.$$d_$691);this.$3F6();$6(this.get_$89())||this.get_$89()()},$691:function(){_d.$En.$7in(this.$3w,this.get_$u1());this.$C2&&this.$3gr.get_$P3().set_$5u(!0);$3(this,"BusyText");$3(this,"ShowActivityIndicator")}};_d.$L2=function(n,t,i){this.$$d_$8GW=Function.createDelegate(this,this.$8GW);this.$$d_$8GX=Function.createDelegate(this,this.$8GX);this.$$d_$34s=Function.createDelegate(this,this.$34s);_d.$L2.initializeBase(this);_a.$4.$J(t,"listViewItemsFactory");this.$5hL=t;this.$M=n;this.$5ej=i};function $6uy(n){for(var i=n.$5hL.$7dx(n.$M),t=0;t<i.get_$B();t++)n.get_$3T().$D(i.get_$3q(t))}_d.$L2.prototype={$3P:null,$1Dj:null,$M:null,$5hL:null,$5ej:!1,get_$UR:function(){return this.$U(_d.$L2.$44x)},set_$UR:function(n){this.$K(_d.$L2.$44x,n);return n},$49:function(n,t){_a.$4.$l(n,"onSelectItemChangedHandler");this.set_$2FT(t?1:0);this.add_$6RY(n);$6uy(this)},$8Gl:function(){if(this.get_$3T().get_$B()>0&&!this.get_$3T().get_$3q(0).$31d){for(var n=0;n<this.get_$3T().get_$B();n++){this.get_$3T().get_$3q(n).set_$5c6(!0);this.get_$3T().get_$3q(n).set_$1d3(!1);this.get_$3T().get_$3q(n).set_$1d2(!1)}if(!$6(this.$1Dj)){this.$1Dj.remove_$2m(this.$$d_$34s);this.$1Dj.remove_$2C(this.$$d_$8GX);this.$1Dj.remove_$1x(this.$$d_$8GW)}this.$3P=new _c.$1A0;this.$1Dj=new _c.$15o(this.$3P);this.$1Dj.add_$2m(this.$$d_$34s);this.$1Dj.add_$2C(this.$$d_$8GX);this.$1Dj.add_$1x(this.$$d_$8GW);OwaApplication.$1W.$z(this.$1Dj)}},$5Fe:function(n){return null},$34s:function(n){for(var t=0;t<this.get_$3T().get_$B();t++){var i=this.get_$3T().get_$3q(t);i.set_$5c6(!1)}},$8GX:function(n){for(var i=0;i<this.get_$3T().get_$B();i++){var t=this.get_$3T().get_$3q(i);if(!$6(t.get_$Rf().get_$6Zr())){var r=this.$3P.$184[t.get_$Rf().get_$6Zr()];t.get_$Rf().set_$1UQ(r)}t.set_$1d2(!1);t.set_$1d3(!0)}},$8GW:function(n){for(var i=0;i<this.get_$3T().get_$B();i++){var t=this.get_$3T().get_$3q(i);t.set_$1d2(!0);t.set_$1d3(!1);t.get_$Rf().$9cx(t)}}};_d.$K1=function(n,t){_d.$K1.initializeBase(this);_a.$4.$J(n,"text");_a.$4.$J(t,"optionPageCreator");this.$2E=n;this.$6FW=t};_d.$K1.prototype={$2E:null,$6FW:null,$4LL:null,$31d:!1,$43N:!1,$43M:!1,get_$Rf:function(){this.$4LL||(this.$4LL=this.$6FW());return this.$4LL},get_$5c6:function(){return this.$31d},set_$5c6:function(n){this.$31d=n;$3(this,"IsLoadingSummary");return n},get_$1d3:function(){return this.$43N},set_$1d3:function(n){this.$43N=n;$3(this,"IsSummaryLoadSucceeded");return n},get_$1d2:function(){return this.$43M},set_$1d2:function(n){this.$43M=n;$3(this,"IsSummaryLoadFailed");return n}};_d.$yZ=function(n,t){this.$$d_$6Dx=Function.createDelegate(this,this.$6Dx);_d.$yZ.initializeBase(this);this.$M=n;this.$He=new _d.$L2(this.$M,t,this.get_$9mS());this.$He.$49(this.$$d_$6Dx,!1)};_d.$yZ.prototype={$He:null,$M:null,get_$Ld:function(){return 1},get_$9mS:function(){return!1},$GN:function(){_y.$1KT.prototype.$GN.call(this);this.$He.$5j();this.$He.$8Gl()}};_d.$9X=function(n,t,i,r,u){this.$$d_$691=Function.createDelegate(this,this.$691);this.$$d_$A2B=Function.createDelegate(this,this.$A2B);this.$$d_$1gX=Function.createDelegate(this,this.$1gX);this.$$d_$81j=Function.createDelegate(this,this.$81j);this.$$d_$9CA=Function.createDelegate(this,this.$9CA);_d.$9X.initializeBase(this,[n,t]);this.$13=u;this.$12=i;this.$3Dh=r;this.$2zx=!1;$6uz(this);this.get_$2RA().$MN(this.$He)};function $6uz(n){if(n.get_$3zP()){n.set_$7D(_y.$26.$Bg(n,null,null));n.$3w.set_$4W8(!0);n.$3w.$hY(new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$vN(),_nbs.NonBootStrings.l_SaveItemMobile_Text,n.get_$57L()),0)}}function $4n8(n,t){if(t.get_$5ZX()){_js.Trace.logInfo(_d.$9X.$A,"Found the options vm dirty so saving before exit.");$6v0(n)}else{_js.Trace.logInfo(_d.$9X.$A,"Navigating away without saving.");n.$1gX()}}function $6v0(n){var t=n.$He.get_$UR().get_$Rf();t.add_$4Ue(n.$$d_$1gX);t.add_$6T7(n.$$d_$1gX);t.add_$6fc(n.$$d_$A2B);t.$FK(!0)}function $4n9(n,t){if(!$6(n.$He.get_$UR())){t&&n.$He.get_$UR().get_$Rf().$3F6();n.$He.get_$UR().get_$Rf().remove_$4Ue(n.$$d_$1gX);n.$He.get_$UR().get_$Rf().remove_$6T7(n.$$d_$1gX);n.$He.get_$UR().get_$Rf().remove_$24t(n.$$d_$691);n.$He.get_$UR().get_$Rf().remove_$6fc(n.$$d_$A2B)}}_d.$9X.prototype={$jA:null,$4LM:null,$Nx:null,$3la:0,$zx:null,$Et:null,$12:null,$2zx:!1,$3Dh:null,$13:null,get_$57L:function(){$6(this.$Nx)&&(this.$Nx=new _C(this.$$d_$9CA,_d.$9X.$A));return this.$Nx},get_$4LN:function(){this.$4LM||(this.$4LM=new _y.$FB);return this.$4LM},get_$2RA:function(){this.$jA||(this.$jA=new _y.$FB);return this.$jA},get_$6V:function(){return $6(this.$He.get_$UR())?!1:this.$He.get_$UR().get_$Rf().get_$6V()},get_$Fb:function(){return $6(this.$He.get_$UR())?"":this.$He.get_$UR().get_$Rf().get_$Fb()},get_$3zP:function(){return!this.$12.$3E.get_$7w().get_$1gV()},get_$9mS:function(){return!0},$gk:function(){_y.$1KT.prototype.$gk.call(this);if(this.$3Dh){this.$3Dh.set_$2kB(!0);this.$3Dh.$2ZK(!0,null,null,null,null)}},$GN:function(){_d.$yZ.prototype.$GN.call(this);this.$He.set_$22(this.$He.get_$3T().get_$3q(0))},get_$1iT:function(){return this.$13.get_$L5()?1:4},get_$2MT:function(){return this.$$d_$81j},get_$89:function(){return this.$Et},set_$89:function(n){this.$Et=n;return n},get_$7iz:function(){return!0},$81j:function(n,t){_js.Trace.logInfo(_d.$9X.$A,"HandlePopupPanelClosing with reason = {0}",t);if(!t){this.$5BV();return!0}return!1},get_$Ld:function(){return this.get_$3zP()?_d.$yZ.prototype.get_$Ld.call(this):0},$6Dx:function(n,t){_js.Trace.logInfo(_d.$9X.$A,"OnSelectedOptionChanged {0}",t);var i=n;if(!$6(this.$He.get_$22())){this.$zx=i.get_$22();this.$3la=0;if($6(this.$He.get_$UR()))this.$1gX();else if(this.$He.get_$UR()!==this.$He.get_$22()){var r=this.$He.get_$UR().get_$Rf();$4n8(this,r)}}},$5BV:function(){_js.Trace.logInfo(_d.$9X.$A,"CloseOptionPagePopup");this.$3la=1;this.$zx=this.$He.get_$22();var n=this.$zx.get_$Rf();$4n8(this,n)},$9CA:function(){this.$2zx=!0;this.$5BV()},$A2B:function(){$4n9(this,!1);this.$He.set_$22(this.$He.get_$UR())},$1gX:function(){_js.Trace.logInfo(_d.$9X.$A,"NavigateAway");$4n9(this,!0);this.$He.set_$UR(this.$zx);switch(this.$3la){case 1:this.$He.set_$UR(null);this.$He.set_$22(null);$6(this.$zx)&&this.$zx.get_$Rf().remove_$24t(this.$$d_$691);this.$zx=null;this.get_$89()();this.$12.$3E.get_$7w().get_$1gV()&&this.$2zx&&this.$12.$3E.$9pS();this.$2zx=!1;break;case 0:this.get_$4LN().get_$7u()!==this.$zx.get_$Rf()&&this.get_$4LN().$MN(this.$zx.get_$Rf());this.$zx.get_$Rf().add_$24t(this.$$d_$691);this.$zx.get_$Rf().$2XW();break;default:break}},$691:function(){_js.Trace.logInfo(_d.$9X.$A,"OnBusy");$3(this,"BusyText");$3(this,"IsBusy")}};_d.$yY=function(n,t){this.$$d_$9AY=Function.createDelegate(this,this.$9AY);_d.$yY.initializeBase(this,[n,t]);this.set_$7D(_y.$26.$E(this))};_d.$yY.prototype={$9AY:function(){this.$He.get_$22().get_$Rf().remove_$4In(this.$$d_$9AY);this.$He.set_$22(null)},$6Dx:function(n,t){var r=n;if(r.get_$22()){var u=r.get_$22();var i=u.get_$Rf();i.add_$4In(this.$$d_$9AY);i.$7X();i.$2XW()}}};_d.$UM=function(n,t,i){this.$$d_$9SN=Function.createDelegate(this,this.$9SN);this.$2qX=-1;_d.$UM.initializeBase(this,[n,t,i]);this.$2B1=new _c.$1Eb;this.set_$M8(this.$2B1);this.add_$4In(this.$$d_$9SN)};_d.$UM.$E=function(n,t,i){_a.$4.$l(n,"owaShell");return new _d.$UM(n,t,i)};_d.$UM.prototype={$ow:null,$1Aw:null,$2B3:!1,$2B1:null,get_$6Zr:function(){return"TimeZone"},get_$9vH:function(){return this.$ow},set_$9vH:function(n){this.$ow=n;$3(this,"TimeZoneList");return n},get_$3lo:function(){return this.$1Aw},set_$3lo:function(n){this.set_$3lp(this.$ow.$71(n));if(this.$1Aw===n)return n;this.$1Aw=n;$3(this,"CurrentTimeZone");return n},get_$3lp:function(){return this.$2qX},set_$3lp:function(n){this.$2qX=n;$3(this,"CurrentTimeZoneIndex");return n},get_$4ag:function(){return this.$2B3},set_$4ag:function(n){this.$2B3=n;$3(this,"TimeZoneReloaded");return n},$7co:function(){return new _c.$16F(this.$2B1)},$7ep:function(){return new _c.$1Cl(this.$2B1,this.$1Aw.$3s)},$5EN:function(){var n={};n.CurrentTimeZone=!0;return n},$1Fw:function(n){this.set_$1cP(!0);if($6(this.$ow)||!this.$ow.get_$B()){for(var r=new _js.$Z,u=this.$2B1.$ow,f=u.length,i=0;i<f;++i){var e=u[i];r.$D(new _d.$Yn(e))}this.set_$9vH(r)}for(var t=0;t<this.$ow.get_$B();t++)if(this.$ow.get_$3q(t).$3s===this.$2B1.$1Aw){this.set_$3lo(this.$ow.get_$3q(t));this.set_$4ag(!0)}_d.$En.prototype.$1Fw.call(this,n)},$1hX:function(n){this.set_$1UQ(this.$1Aw.$5Ou);_d.$En.prototype.$1hX.call(this,n);var t=new _y.$mU(1);this.$M_5.$9Yf(_y.$mU,t)},$9SN:function(){this.set_$3lp(-1);this.set_$4ag(!1)}};_d.$Yn=function(n){_d.$Yn.initializeBase(this);_a.$4.$J(n,"TimeZoneEntry");this.$5Ou=n.Name;this.$7i=n.Name;var i=new RegExp(_d.$Yn.$6fQ,"g");var t=i.exec(n.Name);if(t&&t.length>0){this.$2Bn=t[0];this.$7i=n.Name.replace(this.$2Bn,"").trim();this.$2Bn.indexOf("GMT")!==-1&&(this.$2Bn=this.$2Bn.replace("GMT","UTC"))}this.$3s=n.Value};_d.$Yn.prototype={$7i:null,$5Ou:null,$2Bn:null,$3s:null};_d.$Np=function(n,t,i){this.$$d_$9Fq=Function.createDelegate(this,this.$9Fq);_d.$Np.initializeBase(this,[n,t,i]);this.$iI=new _g.$14K;this.set_$M8(this.$iI)};_d.$Np.$E=function(n,t,i){_a.$4.$l(n,"owaShell");return new _d.$Np(n,t,i)};function $4n6(n,t,i){if(t){n.$Ls=new _h.$NI;n.$Ls.add_$2C(n.$$d_$9Fq);OwaApplication.$1W.$z(n.$Ls)}else n.set_$1lL(i)}_d.$Np.prototype={$1d0:!1,$2Bh:!1,$1Za:null,$2Jq:null,$iI:null,$3MZ:0,$Ls:null,get_$5eE:function(){return this.$1d0},set_$5eE:function(n){if(this.$1d0===n)return n;this.$1d0=n;$3(this,"IsSignatureOn");return n},get_$p3:function(){return this.$2Bh},set_$p3:function(n){if(this.$2Bh===n)return n;this.$2Bh=n;$3(this,"UseDesktopSignature");return n},get_$5KI:function(){return this.$1Za},set_$5KI:function(n){if(this.$1Za===n)return n;this.$1Za=n;$3(this,"EditorSignatureMessage");return n},get_$7kz:function(){return this.$2Jq},set_$7kz:function(n){if(this.$2Jq===n)return n;this.$2Jq=n;$3(this,"EditorDesktopSignatureMessage");return n},get_$6Rm:function(){return this.$3MZ},set_$6Rm:function(n){if(this.$3MZ===n)return n;this.$3MZ=n;this.set_$p3(n===1?!0:!1);$3(this,"SelectedSignatureType");return n},get_$6Zr:function(){return"Signature"},get_$32B:function(){return _a.UserAgent.getInstance().get_$67()},$FK:function(n){this.$iI.set_$11H(this.$1d0);this.$iI.set_$17s(this.$1Za);this.$iI.set_$p3(this.$2Bh);_d.$En.prototype.$FK.call(this,n)},$6OK:function(n){if(this.get_$32B()){var t=_a.$7G.$E();var i=t.$3x("MOWA.IsSignatureChanged")==="true"?!0:!1;var r=i?Boolean.parse(t.$3x("MOWA.AutoAddSignature")):!0;var u=i?t.$3x("MOWA.SignatureText"):_c.$Ji.$2w1(_a.UserAgent.getInstance());var f=i?Boolean.parse(t.$3x("MOWA.UseDesktopSignature")):!1;r?$4n6(this,f,u):this.set_$1lL(_nbs.NonBootStrings.l_EmailSignatureOff_Text)}else n.AutoAddSignature?$4n6(this,n.UseDesktopSignature,n.SignatureText):this.set_$1lL(_nbs.NonBootStrings.l_EmailSignatureOff_Text);return this.$184},$9cx:function(n){if(this.get_$32B()){this.$6OK(null);n.set_$1d2(!1);n.set_$1d3(!0)}},$7co:function(){return this.get_$32B()?new _c.$Ji(this.$iI):new _c.$15U(this.$iI)},$7ep:function(){return this.get_$32B()?new _c.$fn(this.$iI):new _c.$1CS(this.$iI)},$5EN:function(){var n={};n.IsSignatureOn=!0;n.UseDesktopSignature=!0;n.EditorSignatureMessage=!0;n.SelectedSignatureType=!0;return n},$1Fw:function(n){this.set_$5eE(this.$iI.get_$11H());this.set_$p3(this.$iI.get_$p3());this.set_$5KI(this.$iI.get_$17s());this.set_$7kz(this.$iI.get_$2rW());this.set_$6Rm(this.$iI.get_$p3()?1:2);_d.$En.prototype.$1Fw.call(this,n)},$1hX:function(n){this.set_$1lL(this.$1d0?this.$2Bh?this.$2Jq:this.$1Za:_nbs.NonBootStrings.l_EmailSignatureOff_Text);var t=_g.$V.get_$I().get_$1I();t.set_$p3(this.$2Bh);t.set_$3er(this.$1d0);t.set_$4X4(this.$1Za);_d.$En.prototype.$1hX.call(this,n)},$7aO:function(n){var t=n;return this.$6OK(t)},$9Fq:function(n){this.set_$1lL(this.$Ls.$c.UserOptions.SignatureText)}};_d.$CW=function(n,t,i,r,u,f){this.$$d_$9C3=Function.createDelegate(this,this.$9C3);this.$$d_$8A1=Function.createDelegate(this,this.$8A1);this.$$d_$6QM=Function.createDelegate(this,this.$6QM);_d.$CW.initializeBase(this,[n,t,i]);_a.$4.$J(n,"owaShell shouldn't be null");_a.$4.$J(i,"eventAggregator shouldn't be null");_a.$4.$J(r,"syncFoldersProcessorLazy shouldn't be null");_a.$4.$J(u,"conductor shouldn't be null");_a.$4.$J(f,"taskRunner shouldn't be null");this.$1UU=r;this.$M=i;this.$3m=u;this.$4P=f;$6uu(this);$6ut(this)};function $6ut(n){var t=this;n.$1UU.$E(function(t){n.$E9=t;$6us(n);n.$3NY()})}function $6uu(n){_h.$27.$jI||_h.$27.$4RJ(n.$C.get_$L());n.$1Dz=5>=_h.$27.$jI?_h.$27.$jI:5}function $6us(n){_js.Trace.logInfo(_d.$CW.$5y,"Initialize folder controllers with maxSyncFolders={0}",n.$1Dz);n.$Lr=new Array(0);for(var r=0;r<n.$1Dz;r++)Array.add(n.$Lr,new _d.$NH("","",new _d.$Bi(n.$M,n.$4P,n.$C),n.$C,n.$$d_$8A1,n.$3m));for(var u=n.$Lr,f=u.length,t=0;t<f;++t){var e=u[t];e.$Y("FolderId",n.$$d_$9C3)}for(var i=1;i<=n.$1Dz;i++)$3(n,String.format("FolderController{0}",i))}function $4n7(n,t){for(;t<n.$1Dz;t++){n.$Lr[t].set_$Kw("");n.$Lr[t].set_$r("")}}_d.$CW.prototype={$M:null,$1UU:null,$3m:null,$4P:null,$1Dz:0,$E9:null,$Lr:null,$4VB:!1,$2fk:!1,get_$6UT:function(){return this.$4VB},set_$6UT:function(n){if(this.$4VB!==n){this.$4VB=n;$3(this,"SettingChanged")}return n},get_$18l:function(){return this.$2fk},set_$18l:function(n){if(n!==this.$2fk){this.$2fk=n;$3(this,"UserSelected")}return n},get_$7pQ:function(){var n;switch(this.$1Dz){case 1:n=_nbs.NonBootStrings.l_One_Text;break;case 2:n=_nbs.NonBootStrings.l_Two_Text;break;case 3:n=_nbs.NonBootStrings.l_Three_Text;break;case 4:n=_nbs.NonBootStrings.l_Four_Text;break;case 5:n=_nbs.NonBootStrings.l_Five_Text;break;default:throw Error.create("MaxSyncFolders can't be bigger than 5");}return String.format(_nbs.NonBootStrings.l_OfflineFoldersComment_Text,n)},get_$7p8:function(){return this.$Lr&&this.$Lr.length>=1?this.$Lr[0]:null},get_$7p9:function(){return this.$Lr&&this.$Lr.length>=2?this.$Lr[1]:null},get_$7pA:function(){return this.$Lr&&this.$Lr.length>=3?this.$Lr[2]:null},get_$7pB:function(){return this.$Lr&&this.$Lr.length>=4?this.$Lr[3]:null},get_$7pC:function(){return this.$Lr&&this.$Lr.length>=5?this.$Lr[4]:null},$2XW:function(){this.$3NY();_d.$En.prototype.$2XW.call(this)},$FK:function(n){_js.Trace.logInfo(_d.$CW.$5y,"Save isSavedFromDirty={0}",n);this.$6QM();_d.$En.prototype.$FK.call(this,n)},$3NY:function(){if(this.$E9){this.set_$18l(this.$E9.get_$18l());var n=0;if(this.$E9.get_$18l()){var u=this.$E9.get_$5ih();var t=u.get_$1Mj();var i=0;if(t){i=t.length>this.$1Dz?this.$1Dz:t.length;for(;n<i;n++){var r=_h.$j.$JP(new _g.$3S(t[n]));if(r){this.$Lr[n].set_$Kw(_g.$2X.$fN(r));this.$Lr[n].set_$r(t[n])}else{_js.Trace.logWarning(_d.$CW.$5y,"Can't find folder based on FolderId {0}",t[n]);this.$Lr[n].set_$Kw("");this.$Lr[n].set_$r("")}}}$4n7(this,n)}else $4n7(this,n)}},$7co:function(){return new _c.$10M},$7ep:function(){return new _c.$10N(this.$$d_$6QM)},$5EN:function(){var n={};n.SettingChanged=!0;n.UserSelected=!0;return n},$9C3:function(n,t){this.set_$6UT(!1);this.set_$6UT(!0)},$8A1:function(n){if(this.$E9.$5ce(n))return!0;else{var t;t=_h.$27.$8A3(n)?_nbs.NonBootStrings.l_FolderAlreadyInDefaultSyncListError_Text:_nbs.NonBootStrings.l_FolderNotAllowedToSync_Text;var i=new _a.$4a([t],0,null,0,!1,_u.Strings.l_OK_Text,null,_nbs.NonBootStrings.l_SelectAFolderError_Text);this.$M.$9Yf(_a.$4a,i);return!1}},$6QM:function(){_js.Trace.logInfo(_d.$CW.$5y,"SaveOfflineFolders");if(this.$E9){this.$E9.set_$18l(this.$2fk);if(this.$E9.get_$18l()){for(var i=this.$E9.get_$5ih(),t=new Array(0),n=0;n<this.$1Dz;n++)_js.$9.$a(this.$Lr[n].$2k)||Array.add(t,this.$Lr[n].$2k);_js.Trace.logInfo(_d.$CW.$5y,"Setting MailFolderIds={0}",t);i.set_$1Mj(t)}}}};_d.$Ok=function(n,t,i,r,u){this.$$d_$9G7=Function.createDelegate(this,this.$9G7);_d.$Ok.initializeBase(this);this.$14=n;this.$ln=t;this.$k=r;this.$C=i;u&&this.set_$Is(n.get_$Is().get_$3q(0).get_$1g())};function $6qT(n){for(var i=n.$14.get_$Is().get_$B(),t=0;t<i;t++)n.$14.get_$Is().get_$3q(t).get_$UN()&&_d.$6t.$8Gz(_a.$0.$9k,"TruncatedNotesShown","Contact #"+t)}_d.$Ok.prototype={$C:null,$k:null,$14:null,$ln:null,$1OG:!1,$mp:!1,$WO:null,get_$31z:function(){return this.$mp},set_$31z:function(n){if(this.$mp!==n){this.$mp=n;$3(this,"IsNotesAvailable")}return n},get_$424:function(){return this.$1OG},set_$424:function(n){if(this.$1OG!==n){this.$1OG=n;$3(this,"IsNotesLoaded")}return n},get_$Is:function(){return this.$WO},set_$Is:function(n){this.$WO=n;$3(this,"Notes");this.set_$31z(!_js.$9.$a(this.$WO));this.set_$424(!0);return n},get_$8Iv:function(){var n;switch(this.$C.get_$L()){case"TouchNarrow":n=51200;break;case"TouchWide":case"Mouse":default:n=512e3;break}return n},$LC:function(n){if(this.$14.get_$6G()&&this.$14.get_$6G().Id&&(!this.$1OG||n)){this.set_$31z(!1);this.set_$424(!1);var t=new _pc.$oq(this.$14.get_$6G().Id,this.get_$8Iv());t.add_$2m(this.$$d_$9G7);t.$F1=this.$ln.$9u;this.$k.$z(t)}},$9G7:function(n){var t=n;if(t.$26I&&t.$26I.get_$Is()&&t.$26I.get_$Is().get_$B()>0){this.$14.set_$Is(t.$26I.get_$Is());this.set_$Is(t.$26I.get_$Is().get_$3q(0).get_$1g());$6qT(this)}else this.$14.get_$Is()&&this.$14.get_$Is().get_$B()?this.set_$31z(!0):this.set_$31z(!1);this.set_$424(!0)}};_d.$1Jg=function(n){this.$2V=n};_d.$1Jg.prototype={$2V:null,get_$1s:function(){return this.$2V.$14},get_$2js:function(){return""},get_$61:function(){return this.$2V.$7n},get_$40G:function(){return!1},set_$40G:function(n){return n},get_$5HS:function(){return null},get_$31A:function(){return!1},get_$18t:function(){return new Array(0)},set_$18t:function(n){return n},get_$7NY:function(){return""},set_$7NY:function(n){return n},get_$1CX:function(){return!0},get_$5Vs:function(){return!0},get_$1wG:function(){return!0},get_$1wv:function(){return!1},set_$1wv:function(n){return n},get_$25m:function(){return this.$2V.$C},get_$2p7:function(){return this.$2V.$8I},get_$2R3:function(){return null},$fN:function(n){return n?this.get_$1s().get_$1sf():this.get_$1s().get_$1o()},$4LF:function(n){},$4NS:function(n){},$3xY:function(n){},$2oz:function(n){}};_d.$nw=function(n){_d.$nw.initializeBase(this,[n])};_d.$nw.prototype={get_$18t:function(){return this.get_$vV().$6go},set_$18t:function(n){this.get_$vV().$6go=n;return n},get_$7NY:function(){return this.get_$vV().$3cP},set_$7NY:function(n){this.get_$vV().$3cP=n;return n},get_$40G:function(){return this.get_$vV().$2Ox},set_$40G:function(n){this.get_$vV().set_$40G(n);return n},get_$1wv:function(){return this.get_$vV().$KE},set_$1wv:function(n){this.get_$vV().$KE=n;return n},get_$vV:function(){return this.$2V}};_d.$Ig=function(n,t,i,r){this.$$d_$2ni=Function.createDelegate(this,this.$2ni);this.$$d_$4O0=Function.createDelegate(this,this.$4O0);this.$$d_$FK=Function.createDelegate(this,this.$FK);_d.$Ig.initializeBase(this);this.$C=i;this.$5C=r;(n.get_$1F()===5||t!==2)&&(this.$6e=$6rH(this,n));this.$2o9=n.get_$1F()};function $6rH(n,t){return n.$5C?n.$5C.$SR(t,t.get_$1F()===5?2:_y.$w.$3If,!1,t.get_$1F()===5?2:3,!0,null):new _d.$8Z(t,t.get_$1F()===5?2:_y.$w.$3If,!1,t.get_$1F()===5?2:3,null,n.$C,!0,null,null)}_d.$Ig.prototype={$C:null,$6e:null,$2o9:0,$5C:null,$1SH:null,$El:null,$7V:null,$Dv:!1,$14E:!1,add_$6Ix:function(n){this.$2N("PopoutClicked",n)},remove_$6Ix:function(n){this.$2P("PopoutClicked",n)},add_$9f6:function(n){this.$2N("SaveClicked",n)},remove_$9f6:function(n){this.$2P("SaveClicked",n)},add_$7UM:function(n){this.$2N("CancelClicked",n)},remove_$7UM:function(n){this.$2P("CancelClicked",n)},get_$tj:function(){$6(this.$El)&&(this.$El=new _C(this.$$d_$FK,_d.$Ig.$A));return this.$El},get_$4O1:function(){$6(this.$1SH)&&(this.$1SH=new _C(this.$$d_$4O0,_d.$Ig.$A));return this.$1SH},get_$VV:function(){$6(this.$7V)&&(this.$7V=new _C(this.$$d_$2ni,_d.$Ig.$A));return this.$7V},get_$29U:function(){return!!this.$6e},get_$fl:function(){return this.$C.get_$L()!=="Mouse"},get_$6Wi:function(){return!1},get_$6Iv:function(){return this.$2o9===4?_nbs.NonBootStrings.l_LocationPopoutCardAction_AT_Tooltip_Text:_nbs.NonBootStrings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$Dw:function(){return this.$Dv},set_$Dw:function(n){if(this.$Dv!==n){this.$Dv=n;$3(this,"IsSaving")}return n},get_$1yM:function(){return this.$14E},set_$1yM:function(n){if(this.$14E!==n){this.$14E=n;$3(this,"ShowPopoutControl")}return n},$4O0:function(){$6C(this,"PopoutClicked")},$FK:function(){if(!this.$Dv){this.set_$Dw(!0);$6C(this,"SaveClicked")}},$2ni:function(){$6C(this,"CancelClicked")}};_d.$12q=function(n){_d.$12q.initializeBase(this,[n])};_d.$12q.prototype={get_$3il:function(){return this.$2V},$fN:function(n){var r=_d.$1Jg.prototype.$fN.call(this,n);if(!_js.$9.$a(r))return r;var u=this.get_$3il().$dP.$2Ko;var h=u?u.$HI:null;var f=this.get_$3il().$dP.$2Vu;var c=f?f.$HI:null;var e=this.get_$3il().$dP.$2Qu;var l=e?e.$HI:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$6u.$3gA(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$kp=function(n,t,i,r,u,f,e,o,s,h){this.$C=n;this.$k=t;this.$3h=i;this.$jD=r;this.$pq=u;this.$6h=f;this.$96=e;this.$6f=o;this.$5C=s;this.$2H5=h};_d.$kp.prototype={$6f:null,$C:null,$k:null,$3h:null,$jD:null,$pq:null,$96:null,$6h:null,$5C:null,$2H5:null,$7e9:function(n,t,i,r){return new _d.$A9(n,t,i,this.$C,this.$k,this.$3h,this.$jD,this.$pq,this.$6h,this.$96,this.$6f,r,this.$5C,this.$2H5)},$7eA:function(n,t){return new _d.$Ig(n,t,this.$C,this.$5C)}};_d.$A9=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$4O0=Function.createDelegate(this,this.$4O0);this.$$d_$9IO=Function.createDelegate(this,this.$9IO);this.$$d_$9I6=Function.createDelegate(this,this.$9I6);this.$$d_$99Q=Function.createDelegate(this,this.$99Q);this.$$d_$Zi=Function.createDelegate(this,this.$Zi);_d.$A9.initializeBase(this);this.$2S=!0;this.$1O0=!0;this.$46E=l;this.$C=r;this.$k=u;this.$3h=f;this.$jD=e;this.$pq=o;this.$6h=s;this.$96=h;this.$6f=c;this.$5C=a;this.$2H5=v;this.$7n=t;this.$8I=i;this.$14=n;this.$6e=$6wh(this,n);this.$2o9=n.get_$1F();this.$2N0=!0;this.$2y8=!0;this.$2Mx=!0;this.$2Mw=!0;this.set_$7ko(_nbs.NonBootStrings.l_PersonaEditMgmtAction_AT_Tooltip_Text);this.set_$5KB(_nbs.NonBootStrings.l_PersonaEditMgmtAction_Text)};function $6wh(n,t){if(n.get_$2PM())return null;var i=$6wg(n,t);i&&n.$8I.$1M2&&i.set_$1CX(!0);var r=_y.$w.$KH;n.$14.get_$1F()===4&&(r=_y.$w.$1dY);return n.$5C?n.$5C.$SR(t,r,!1,3,!0,i):new _d.$8Z(t,r,!1,3,null,n.$C,!0,i,null)}function $6wg(n,t){return n.$2H5?n.$2H5.$7bZ(t,n.$7n,n.$46E,n.$8I):new _d.$H8(t,n.$C,n.$3h,n.$96,n.$jD,n.$k,n.$pq,n.$6h,n.$6f,n.$7n,n.$46E,n.$8I)}_d.$A9.prototype={$6f:null,$C:null,$k:null,$3h:null,$jD:null,$pq:null,$96:null,$6h:null,$5C:null,$2H5:null,$46E:null,$6e:null,$2o9:0,$7n:0,$8I:null,$Vz:!1,$2S:!1,$1O0:!1,$IW:null,$Hg:null,$LP:0,$1SH:null,$Zj:null,$3cg:null,$j7:null,$20j:null,$x3:!1,$C2:!1,$366:null,$2y1:!1,$3wG:!1,$2xu:!1,$2N0:!1,$2y8:!1,$14E:!1,$2Mw:!1,$4WQ:!1,$14:null,$2sp:null,$1MG:null,$4WS:!1,$85F:null,$2Mx:!1,add_$6Ix:function(n){this.$2N("PopoutClicked",n)},remove_$6Ix:function(n){this.$2P("PopoutClicked",n)},add_$9Ut:function(n){this.$2N("PivotOptionClicked",n)},remove_$9Ut:function(n){this.$2P("PivotOptionClicked",n)},add_$5KC:function(n){this.$2N("EditClicked",n)},remove_$5KC:function(n){this.$2P("EditClicked",n)},add_$9vQ:function(n){this.$2N("ToggleClicked",n)},remove_$9vQ:function(n){this.$2P("ToggleClicked",n)},add_$53v:function(n){this.$2N("AddMembersClicked",n)},remove_$53v:function(n){this.$2P("AddMembersClicked",n)},add_$8Eh:function(n){this.$2N("JoinClicked",n)},remove_$8Eh:function(n){this.$2P("JoinClicked",n)},add_$8Fg:function(n){this.$2N("LeaveClicked",n)},remove_$8Fg:function(n){this.$2P("LeaveClicked",n)},get_$1s:function(){return this.$14},set_$1s:function(n){this.$14=n;this.$6e&&this.$6e.set_$1s(n);return n},get_$Ww:function(){return this.$IW},set_$Ww:function(n){if(this.$IW!==n){this.$IW=n;$3(this,"ActivityStatusViewModel")}return n},get_$9o7:function(){return!this.get_$fl()&&this.$4WQ},set_$9o7:function(n){if(this.$4WQ!==n){this.$4WQ=n;$3(this,"ShowExpandButton")}return n},get_$83z:function(){return this.$8I.$2JN||this.$x3||this.get_$1yH()||this.get_$2PM()||this.get_$42J()},get_$2y2:function(){return this.$2y1},set_$2y2:function(n){if(this.$2y1!==n){this.$2y1=n;$3(this,"HideEditButton")}return n},get_$83V:function(){return this.$2Mx},set_$83V:function(n){if(this.$2Mx!==n){this.$2Mx=n;$3(this,"HideAddMembersButton")}return n},get_$5KB:function(){return this.$1MG},set_$5KB:function(n){if(this.$1MG!==n){this.$1MG=n;$3(this,"EditButtonText")}return n},get_$7ko:function(){return this.$2sp},set_$7ko:function(n){if(this.$2sp!==n){this.$2sp=n;$3(this,"EditButtonToolTip")}return n},get_$1t0:function(){this.$Zj||(this.$Zj=new _C(this.$$d_$Zi,_d.$A9.$A));return this.$Zj},get_$7Ns:function(){this.$3cg||(this.$3cg=new _C(this.$$d_$99Q,_d.$A9.$A));return this.$3cg},get_$33y:function(){this.$j7||(this.$j7=new _C(this.$$d_$9I6,_d.$A9.$A));return this.$j7},get_$4O1:function(){this.$1SH||(this.$1SH=new _C(this.$$d_$4O0,_d.$A9.$A));return this.$1SH},get_$29U:function(){return this.$6e?!!this.$6e.$NA:!1},get_$fl:function(){return this.$C.get_$L()!=="Mouse"},get_$6Iv:function(){return this.$2o9===4?_nbs.NonBootStrings.l_LocationPopoutCardAction_AT_Tooltip_Text:_nbs.NonBootStrings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$8JF:function(){return this.$20j},set_$8JF:function(n){this.$20j=n;$3(this,"MenuAddContactsViewModelPropertyName");return n},get_$47M:function(){return this.$366},set_$47M:function(n){if(this.$366!==n){this.$366=n;$3(this,"MenuAffordanceViewModel")}return n},get_$6Wi:function(){return!1},get_$kG:function(){return this.$Hg},set_$kG:function(n){if(this.$Hg!==n){this.$Hg=n;$3(this,"PivotOptions")}return n},get_$Bq:function(){return this.$LP},set_$Bq:function(n){this.$LP=n;$3(this,"PivotSelectedOptionIndex");$Dp(this,"PivotOptionClicked",n);return n},get_$N3:function(){return this.$x3},set_$N3:function(n){if(this.$x3!==n){this.$x3=n;this.$6e&&this.$6e.set_$5aQ(n);$45(this,"IsCardLoading","HideManagementActions")}return n},get_$1vm:function(){return this.$C2||this.$3wG},set_$1vm:function(n){if(this.$3wG!==n){this.$3wG=n;$3(this,"HideAddContactsMenu")}return n},get_$2xv:function(){return this.$2xu},set_$2xv:function(n){if(this.$2xu!==n){this.$2xu=n;$3(this,"HideAffordanceMenu")}return n},get_$83t:function(){return this.$2N0},set_$83t:function(n){if(this.$2N0!==n){this.$2N0=n;$3(this,"HideJoinButton")}return n},get_$83v:function(){return this.$2y8},set_$83v:function(n){if(this.$2y8!==n){this.$2y8=n;$3(this,"HideLeaveButton")}return n},get_$2xs:function(){return this.$2Mw},set_$2xs:function(n){if(this.$2Mw!==n){this.$2Mw=n;$3(this,"HideActivityStatusViewModel")}return n},get_$4L:function(){return this.$2S},set_$4L:function(n){if(this.$2S!==n){this.$2S=n;$Dp(this,"ToggleClicked",n);$45(this,"IsExpanded","ShowPersonCardExpandToggleButton")}return n},get_$9UQ:function(){return this.get_$fl()?this.get_$1DL():this.$1O0||this.get_$1yH()},get_$1yH:function(){return!this.$8I.$9u},get_$5cz:function(){return this.get_$1yH()&&!this.$Vz},get_$42J:function(){return this.$8I.$9u===1},get_$5cx:function(){return this.$8I.$9u===2&&!this.$Vz},get_$2PM:function(){return this.$8I.$9u===9},get_$fc:function(){return this.$1O0},set_$fc:function(n){if(this.$1O0!==n){this.$1O0=n;$3(this,"IsExpandable")}return n},get_$1DL:function(){return this.$Vz&&this.$C.get_$L()==="TouchWide"},get_$8Bf:function(){return this.$Vz&&this.$C.get_$L()==="Mouse"},get_$31A:function(){return this.$Vz},set_$31A:function(n){this.$Vz=n;$PB(this,"IsHoverCard","IsTouchWideHover","IsMouseHover");return n},get_$aE:function(){return this.$C2},set_$aE:function(n){if(this.$C2!==n){this.$C2=n;$3(this,"IsLoading")}return n},get_$1yM:function(){return this.$14E},set_$1yM:function(n){if(this.$14E!==n){this.$14E=n;$3(this,"ShowPopoutControl")}return n},get_$9oW:function(){return this.$4WS},set_$9oW:function(n){this.$4WS=n;$3(this,"ShowIndicator");return n},$4O0:function(){$6C(this,"PopoutClicked")},$Zi:function(){$6C(this,"EditClicked")},$9I6:function(){$6C(this,"JoinClicked")},$99Q:function(){$6C(this,"AddMembersClicked")},$9IO:function(){$6C(this,"LeaveClicked")}};_d.$nM=function(n,t,i){this.$$d_$5H6=Function.createDelegate(this,this.$5H6);this.$$d_$1Vz=Function.createDelegate(this,this.$1Vz);_d.$nM.initializeBase(this);$6(n)&&(n=new _pc.$i);if($6(t))throw Error.argumentNull("acceptCallback");if($6(i))throw Error.argumentNull("declineCallback");this.$1oN=t;this.$5H8=i;this.$1oO=new _C(this.$$d_$1Vz,_a.$0.$4W);this.$5H9=new _C(this.$$d_$5H6,_a.$0.$4W);this.$1Th=new _d.$8Z(n,_y.$w.$1ph,!1);this.$1Th.$5ea=!0};_d.$nM.prototype={$1Th:null,$1oO:null,$5H9:null,$1oN:null,$5H8:null,$1Vz:function(){_js.Trace.logInfo(_a.$0.$4W,"BuddyRequest: Accepting buddy request {0}.",this.$1Th.get_$1s().get_$1l());this.$1oN(this)},$5H6:function(){_js.Trace.logInfo(_a.$0.$4W,"BuddyRequest: declining buddy request {0}.",this.$1Th.get_$1s().get_$1l());this.$5H8(this)}};_d.$WF=function(n,t,i){this.$$d_$9vW=Function.createDelegate(this,this.$9vW);_d.$WF.initializeBase(this);_a.$4.$l(n,"personaViewModelFactory");this.$5C=n;this.$5A=$6ro(this,t);this.$2sm=i;this.$OM=!1};function $6ro(n,t){var i=n.$5C.$SR(t,_y.$w.$KH,!1,1);var r=[1];i.$dk(1,r,"");i.set_$er(!0);return i}_d.$WF.prototype={$5C:null,$2sm:null,$5A:null,$4as:null,$OM:!1,get_$146:function(){return this.$OM},set_$146:function(n){if(this.$OM!==n){this.$OM=n;$3(this,"IsDeleted")}return n},get_$6bO:function(){this.$4as||(this.$4as=new _C(this.$$d_$9vW,_a.$0.$1s));return this.$4as},$9vW:function(){this.set_$146(!this.$OM);this.$2sm.$6dr(this)}};_d.$ox=function(n,t){this.$iP=n;this.$6Q=t};_d.$ox.prototype={$iP:null,$6Q:null,$5C:null,$5Ei:function(n,t,i){return new _d.$FM(i,this.$iP,this.$6Q,this.$5C,n,t)}};_d.$p1=function(n,t,i){_d.$p1.initializeBase(this,[n,0]);_a.$4.$l(t,"personaViewModelFactory");this.$5C=t;this.$2sm=i};_d.$p1.prototype={$5C:null,$2sm:null,get_$6Ho:function(){return this},$4bT:function(n){return _pc.$i.isInstanceOfType(n)?this.$7cE(n):n},$3LO:function(n){return _d.$WF.isInstanceOfType(n)?n.$5A.$14:n},$3oA:function(n){var t=n;t&&t.$1Q()},$7rR:function(n){var u=n;var t=u.$5A;var i=t.$GQ;var r=t.$17S;_js.$9.$a(r)||(i+=" "+r);return i},$7cE:function(n){return new _d.$WF(this.$5C,n,this.$2sm)}};_d.$p2=function(){};_d.$p2.prototype={$5C:null,$7cx:function(n,t){return new _d.$p1(n,this.$5C,t)}};_d.$ow=function(){};_d.$ow.prototype={$5C:null,$E:function(n){return new _d.$PC(n,this.$5C)}};_d.$TY=function(n,t){_d.$TY.initializeBase(this);this.$2V=n;this.$1D7=!!t&&t.$3u("ModernGroups");this.$vb()};function $6so(n){var t;var i,r;var u=(r=_d.$1K.$A6g(String,n.$2V.get_$1s().get_$1M5(),"",n.$2V,i={val:t}),t=i.val,r);t&&_js.$9.$a(t.get_$1g())&&t.set_$1g(n.$2V.get_$1s().get_$1o());$6(n.$2V.get_$1s().get_$1M5())&&n.$2V.get_$1s().set_$1M5(u);n.set_$5Tn(new _d.$2h(n.$2V,t,"PersonaDisplayNames",n.$1D7?_nbs.NonBootStrings.l_ContactListName_Text:_nbs.NonBootStrings.l_GroupName_Text,!0))}function $6sp(n){var t;var i=new _g.$6L;i.set_$1g("");i.set_$3n("Text");var r,u;var f=(u=_d.$1K.$A6g(_g.$6L,n.$2V.get_$1s().get_$Is(),i,n.$2V,r={val:t}),t=r.val,u);$6(n.$2V.get_$1s().get_$Is())&&n.$2V.get_$1s().set_$Is(f);n.set_$Is(new _d.$2h(n.$2V,t,"PersonaBodies",_nbs.NonBootStrings.l_GroupCardNotes_ProfileField_Text,!0))}function $6sq(n){n.$2V.get_$1s().set_$1M5(_d.$1K.$A6h(String,n.$2V.get_$1s().get_$1M5(),!0));n.$2V.get_$1s().set_$Is(_d.$1K.$A6h(_g.$6L,n.$2V.get_$1s().get_$Is(),!0))}_d.$TY.prototype={$1D7:!1,$1vL:null,$WO:null,$2V:null,get_$5Tn:function(){return this.$1vL},set_$5Tn:function(n){if(this.$1vL!==n){this.$1vL=n;$3(this,"GroupNameField")}return n},get_$Is:function(){return this.$WO},set_$Is:function(n){if(this.$WO!==n){this.$WO=n;$3(this,"Notes")}return n},$vb:function(){this.set_$5Tn(null);this.set_$Is(null);if(this.$2V.get_$61()){_d.$1K.$6Uf(this.$2V);$6so(this);$6sp(this)}},$1Jx:function(){var n=[];n=_d.$1K.$1pB(this.$1vL,n);n=_d.$1K.$1pB(this.$WO,n);return n},$iF:function(){$6sq(this)}};_d.$1Kf=function(n){this.$$d_$A2o=Function.createDelegate(this,this.$A2o);this.$$d_$9Ud=Function.createDelegate(this,this.$9Ud);_d.$1Kf.initializeBase(this);this.$2V=n;this.$2GE=this.$2V.get_$25m().get_$L()==="TouchNarrow"&&!this.$2V.get_$1CX()};_d.$1Kf.prototype={$2V:null,$2GE:!1,$5Fe:function(n){throw Error.notImplemented();},$9Ud:function(n){var t=n.$AO.get_$1g();this.$2V.$4NS(t)},$A2o:function(n){var t=n.$AO.get_$1g();if(!_js.$9.$18(t)){var i=t.trimStart().toLowerCase();i.startsWith("http://")||i.startsWith("https://")||(t="http://"+t);this.$2V.$4LF(t)}}};_d.$H8=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$9hc=Function.createDelegate(this,this.$9hc);this.$$d_$9Uc=Function.createDelegate(this,this.$9Uc);this.$$d_$1vA=Function.createDelegate(this,this.$1vA);this.$$d_$855=Function.createDelegate(this,this.$855);this.$$d_$5CM=Function.createDelegate(this,this.$5CM);this.$$d_$7Y4=Function.createDelegate(this,this.$7Y4);_d.$H8.initializeBase(this);this.$C=t;this.$3h=i;this.$96=r;this.$jD=u;this.$k=f;this.$pq=e;this.$6h=o;this.$14n=c;this.$6f=s;this.$7n=h;this.$8I=l;this.$aF=this.$C.get_$L()==="Mouse";this.set_$1s(n)};function $4kb(n){if(!n.$7n){if(n.$2yE){n.$vX&&n.$vX.$1r();n.$vZ&&n.$vZ.$1r();n.$1Cc&&n.$1Cc.$1r();n.$tI&&n.$tI.$1r();n.$oW&&n.$oW.$1r();n.$w2&&n.$w2.$1r();return}n.$vX||(n.$vX=new(_d.$Ao.$$(_g.$1l))(n.$$d_$7Y4));n.$vZ||(n.$vZ=new(_d.$Ao.$$(_g.$1l))(n.$$d_$5CM));n.$1Cc||(n.$1Cc=new(_d.$Ao.$$(String))(n.$$d_$855));if(n.$14.get_$66()&&n.$14.get_$66().length>0){var u=_d.$5V.$$(_g.$1l).$A40(n.$14);n.$vX.$A6Q(u);n.$vZ.$A6Q(u)}else{n.$vX.$1r();n.$vZ.$1r()}var f=n.$3h&&n.$3h.get_$CG()&&!_js.$9.$18(n.$3h.get_$CG().get_$1rj())?n.$3h.get_$CG().get_$1rj().trim().toLowerCase():"";var i=_d.$5V.$$(String).$A41(n.$14,f);if(i&&i.length>0){var e=this;n.$1Cc.$A6Q(i,function(n,t,i){return new _d.$1B3(n,t,i)})}else n.$1Cc.$1r();$JA(n,["ComposeMailActionCommand","ComposeMeetingActionCommand","IMActionCommand","ComposeMailActionMenuViewModel","ComposeMeetingActionMenuViewModel","IMActionMenuViewModel","EmailsNotAvailable","ScheduleMeetingNotAvailable","IMNotAvailable"]);if(n.$14.get_$3vr()){n.$w2||(n.$w2=new(_d.$Ao.$$(_g.$3Y))(n.$$d_$1vA));if(n.$14.get_$1F()===4||n.$14.get_$1F()===3||n.$14.get_$1F()===1){var r=[new(_d.$5V.$$(_g.$3Y))(n.get_$1Dw().get_$3q(0),"")];r&&r.length>0&&n.$w2.$A6Q(r)}else n.$w2.$1r();$45(n,"DirectionsActionCommand","DirectionsNotAvailable")}if(n.$C.get_$L()==="TouchNarrow"){n.$tI||(n.$tI=new(_d.$Ao.$$(_g.$3C))(n.$$d_$9Uc));n.$oW||(n.$oW=new(_d.$Ao.$$(_g.$3C))(n.$$d_$9hc));var t=_d.$5V.$$(_g.$3C).$A42(n.$14);if(t&&t.length>0){n.$tI.$A6Q(t);n.$14.get_$1F()!==4?n.$oW.$A6Q(t):n.$oW.$1r()}else{n.$tI.$1r();n.$oW.$1r()}$JA(n,["SendSmsActionCommand","PhoneCallActionCommand","SendSmsActionMenuViewModel","PhoneCallActionMenuViewModel","PhonesNotAvailable","SmsNotAvailable","IsFiveIconsOnTnarrow"])}}}function $4ka(n,t){n.$14.get_$1F()===2&&t.MailboxType==="Mailbox"&&(t.MailboxType="PublicDL");n.$14.get_$A6()&&(t.SipUri=n.$14.get_$A6())}function $3W9(n){n.get_$fl()||$6C(n,"ActionClicked")}_d.$H8.prototype={$6h:null,$k:null,$6f:null,$pq:null,$jD:null,$C:null,$3h:null,$96:null,$7n:0,$8I:null,$aF:!1,$25T:null,$1hf:null,$1Ny:!1,$14n:null,$20G:null,$1Dl:null,$2yE:!1,$14:null,$vX:null,$vZ:null,$tI:null,$oW:null,$1Cc:null,$w2:null,add_$99D:function(n){this.$2N("ActionClicked",n)},remove_$99D:function(n){this.$2P("ActionClicked",n)},get_$3Ge:function(){return this.$25T},set_$3Ge:function(n){this.$25T=n;return n},get_$4L6:function(){return this.$1hf},set_$4L6:function(n){this.$1hf=n;return n},get_$5aQ:function(){return this.$1Ny},set_$5aQ:function(n){if(this.$1Ny!==n){this.$1Ny=n;$3(this,"HidePersonaActions")}return n},get_$1CX:function(){return this.$1Ny?!0:this.$2yE},set_$1CX:function(n){if(this.$2yE!==n){this.$2yE=n;$4kb(this);$3(this,"HidePersonaActions")}return n},get_$1s:function(){return this.$14},set_$1s:function(n){this.$14=n;$4kb(this);return n},get_$5CL:function(){return this.$vX?this.$vX.get_$3T():null},get_$5CN:function(){return this.$vZ?this.$vZ.get_$3T():null},get_$2p0:function(){return this.$vX?this.$vX.get_$2Dr():null},get_$2ym:function(){return this.$1Cc?this.$1Cc.get_$2Dr():null},get_$9Ua:function(){return this.$tI?this.$tI.get_$2Dr():null},get_$2p2:function(){return this.$vZ?this.$vZ.get_$2Dr():null},get_$9hd:function(){return this.$oW?this.$oW.get_$2Dr():null},get_$5It:function(){return this.$w2?this.$w2.get_$2Dr():null},get_$7Y3:function(){return this.$vX.get_$4TD()},get_$84r:function(){return this.$1Cc.get_$4TD()},get_$9Ub:function(){return this.$tI.get_$4TD()},get_$7Y5:function(){return this.$vZ.get_$4TD()},get_$9he:function(){return this.$oW.get_$4TD()},get_$3pF:function(){return!this.$14.get_$66()||!this.$14.get_$66().length||!this.get_$5CL()||!this.get_$5CL().length},get_$6QQ:function(){return!!this.$1hf||this.get_$3pF()||!this.$96.get_$1k()||!this.get_$5CN()||!this.get_$5CN().length},get_$5Iw:function(){return!this.$w2||!this.$w2.get_$3T()||!this.$w2.get_$3T().length},get_$4NT:function(){return this.$C.get_$L()!=="TouchNarrow"||!this.$tI||!this.$tI.get_$3T()||!this.$tI.get_$3T().length},get_$6Xz:function(){return _a.UserAgent.getInstance().$D9.get_$25W().$1iO===2||this.$14.get_$1F()!==1||this.get_$4NT()||!this.$oW||!this.$oW.get_$3T()||!this.$oW.get_$3T().length},get_$1wG:function(){return this.get_$3Ge()?!1:this.get_$fl()?!0:!this.$14.get_$fW()||!this.$14.get_$fW().get_$B()?!0:!this.$3h||!this.$3h.$Ph||!this.$3h.get_$CG()||!this.$3h.get_$CG().get_$xN()||!this.$3h.get_$CG().$1XR(this.$14.get_$A6())},get_$7U3:function(){return _d.$3.get_$9UY()},get_$7U4:function(){return _d.$3.get_$9UZ()},get_$9fM:function(){return _d.$3.get_$6I4()},get_$9fN:function(){return this.$aF?_d.$3.get_$6I5():_d.$3.get_$9UV()},get_$9fL:function(){return this.$aF?_d.$3.get_$6I5():_d.$3.get_$6I4()},get_$9hF:function(){return _d.$3.get_$6I9()},get_$9hG:function(){return this.$aF?_d.$3.get_$6IA():_d.$3.get_$9UX()},get_$9hE:function(){return this.$aF?_d.$3.get_$6IA():_d.$3.get_$6I9()},get_$7ii:function(){return _d.$3.get_$5hy()},get_$7ij:function(){return this.$aF?_d.$3.get_$5hz():_d.$3.get_$8Gq()},get_$7ih:function(){return this.$aF?_d.$3.get_$5hz():_d.$3.get_$5hy()},get_$853:function(){return _d.$3.get_$6I7()},get_$854:function(){return this.$aF?_d.$3.get_$6I8():_d.$3.get_$9UW()},get_$852:function(){return this.$aF?_d.$3.get_$6I8():_d.$3.get_$6I7()},get_$1Dw:function(){this.$20G||(this.$20G=this.$14.$5RM());return this.$20G},get_$1zt:function(){!this.$1Dl&&this.get_$1Dw()&&(this.$1Dl=this.$jD.$3kF(this.get_$1Dw().get_$3q(0),!0));return this.$1Dl},get_$89x:function(){return this.$C.get_$L()==="TouchNarrow"&&!this.get_$3pF()&&!this.get_$6QQ()&&!this.get_$4NT()&&!this.get_$6Xz()&&!this.get_$5Iw()},$1mU:function(n){this.set_$1s(n)},$2oz:function(n){$3W9(this);if(!$6(this.get_$4L6())){this.get_$4L6()(n.EmailAddress);return}var t=this.$6h.$G3(!1,!0);t.set_$61(0);t.set_$40(0);t.set_$4B(new _js.$Z);$4ka(this,n);t.get_$4B().$D(n);this.$14n||(this.$14n=new _y.$CS);this.$14n.$T7(t)},$3xY:function(n){$3W9(this);if(!$6(this.get_$3Ge())){this.get_$3Ge()(n);return}var t=this;this.$3h.add_$av(function(){if(t.$3h.$Ph){var i=t.$3h.get_$lh().$3kM(t.$14,n);t.$k.$z(i)}})},$4NS:function(n){var t=_js.$9.$18(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6f.$Re(String.format("tel:{0}",encodeURIComponent(t)))},$5eF:function(n,t){$3(this,"IMNotAvailable")},$1vA:function(n){if(this.$14.get_$1F()===4||this.$14.get_$1F()===3||this.$14.get_$1F()===1)this.get_$1zt().$1vA();else{var t=this.$jD.$3kF(n,!0);t.$1vA()}_d.$6t.$fw(5,this.$8I.$9u,this.$14.get_$1F())},get_$fl:function(){return this.$C.get_$L()!=="Mouse"},$7Y4:function(n){this.$2oz(n);_d.$6t.$fw(0,this.$8I.$9u,this.$14.get_$1F())},$9Uc:function(n){this.$4NS(n);_d.$6t.$fw(3,this.$8I.$9u,this.$14.get_$1F())},$855:function(n){this.$3xY(n);_d.$6t.$fw(2,this.$8I.$9u,this.$14.get_$1F())},$5CM:function(n){$3W9(this);_a.$6.$1c(_a.$0.$1k,"CreateItemFromPersonaCard");_d.$6t.$fw(1,this.$8I.$9u,this.$14.get_$1F());var t=new _d.$Vu;t.set_$y(_a.$2D.$3k5(_a.$7.get_$29()));t.set_$DS(36e5);t.set_$QH(!0);t.set_$3O9("Busy");$4ka(this,n);var i=new _js.$Z;var r=_g.$3i.$wR(n);i.$D(r);t.set_$7S(i);var u=this.$pq.$2v6(t);this.$C.$MH(Object.getType(this.$pq),null,null,_y.$48.get_$fF(),u,!1);_a.$6.$1E(null,"CreateItemFromPersonaCard")},$9hc:function(n){var t=_js.$9.$18(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6f.$Re(String.format("sms:{0}",encodeURIComponent(t)));_d.$6t.$fw(4,this.$8I.$9u,this.$14.get_$1F())}};_d.$iF=function(n,t,i,r,u,f,e,o){this.$C=n;this.$k=t;this.$3h=i;this.$jD=r;this.$pq=u;this.$6h=f;this.$96=e;this.$6f=o};_d.$iF.prototype={$6f:null,$C:null,$k:null,$3h:null,$jD:null,$pq:null,$96:null,$6h:null,$7bZ:function(n,t,i,r){return new _d.$H8(n,this.$C,this.$3h,this.$96,this.$jD,this.$k,this.$pq,this.$6h,this.$6f,t,i,r)}};_d.$um=function(n,t,i){_d.$um.initializeBase(this,[n,t,i])};_d.$um.prototype={$5QO:function(n,t){if(_g.$3M.isInstanceOfType(this.get_$1g())){var i=this.get_$1g();switch(i.get_$UT()){case"PhonebookServices":case"Contact":return $2jl(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$14.get_$1o(),n);default:return n}}else{switch(this.$3Tc){case 11:return $2jl(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$14.get_$1o(),n)}return _y.$Eo.prototype.$5QO.call(this,n,t)}},$5Pj:function(n){if(_pc.$i.isInstanceOfType(this.$14)){var t=this.$14;switch(n){case 2:return t.get_$lm();case 3:return t.get_$2YZ();case 4:return t.get_$lV()?t.get_$lV().get_$7h4():null;case 6:return t.get_$qu()?t.get_$qu().get_$7h4():null;case 5:return t.get_$sj()?t.get_$sj().get_$7h4():null;case 7:return t.get_$2w();case 8:return t.get_$2JS();case 9:return t.get_$1sf();case 10:return t.get_$1Bk();case 11:return t.get_$sv()?t.get_$sv().get_$7h4():null}}return _y.$Eo.prototype.$5Pj.call(this,n)}};_d.$JZ=function(n,t,i){this.$$d_$9Ys=Function.createDelegate(this,this.$9Ys);this.$$d_$9UL=Function.createDelegate(this,this.$9UL);this.$$d_$9UK=Function.createDelegate(this,this.$9UK);this.$$d_$6D5=Function.createDelegate(this,this.$6D5);_d.$JZ.initializeBase(this);_a.$4.$J(t,"basePersonaViewModel");this.$C=n;this.$ZQ=t;this.$o9=i;this.$4NO=0;$6rY(this)};function $6rb(n){n.$ZQ.set_$rR(!0)}function $6ra(n){if(n.get_$QC().$7R){var u=n.$ZQ.$2Lx();var f=_pc.$i.$1LO(u);n.get_$QC().$7R.set_$4L(!0);n.get_$QC().$1Hu(f)}else{var t=_a.$6.acss(n.$Lg,"CreatePersonaCard");var i=n.$ZQ.$2Lx();var r=_pc.$i.$1LO(i);n.get_$QC().$1Hu(r);_a.$6.aces(t)}}function $6rc(n){n.get_$Ye().$2S=!0;switch(n.$ZQ.$z6){case 5:n.get_$Ye().$9u=2;break;case 1:n.get_$Ye().$9u=4;break;case 2:n.get_$Ye().$9u=5;break;case 3:n.get_$Ye().$9u=6;break;case 6:n.get_$Ye().$9u=3;break;case 4:n.get_$Ye().$9u=7;break;case 7:n.get_$Ye().$9u=11;break;case 0:default:n.get_$Ye().$9u&&n.get_$Ye().$9u!==1&&(n.get_$Ye().$9u=8);break}}function $6rY(n){switch(n.$ZQ.$14.get_$1F()){case 1:n.$Lg=_a.$0.$9k;break;case 2:n.$Lg=_a.$0.$1vH;break;case 5:n.$Lg=_a.$0.$sl;break;default:n.$Lg=_a.$0.$4Ll;break}}function $6rZ(n){return _js.$9.$4R("{0}_{1}",n.get_$Ye().$9u,n.$ZQ.$14.get_$1F())}_d.$JZ.prototype={$C:null,$o9:null,$ZQ:null,$3Hz:null,$32F:!1,$o7:null,$WT:null,$4NO:0,$Lg:null,get_$Ye:function(){if(!this.$o7){this.$o7=new _d.$Ha;this.$o7.$1M2=!1;this.$o7.$1ZE=!0}return this.$o7},set_$Ye:function(n){if(this.$o7!==n){this.$o7=n;this.$WT&&(this.$WT.$ln=n);$3(this,"PersonaCardConfig")}return n},get_$6Lp:function(){switch(this.$C.get_$L()){case"Mouse":return 0;case"TouchWide":return 1;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value given for OwaShell.CurrentLayout: "+this.$C.get_$L());}},get_$D3:function(){return this.get_$QC()},get_$QC:function(){if(!this.$WT){var n=_a.$6.acss(this.$Lg,"CreatePersonaCardFacade");$6rc(this);this.$WT=this.$o9.$E(this.get_$Ye(),this.get_$6Lp());_a.$6.aces(n);if(this.get_$Ye().$9u!==1){this.$WT.add_$2ox(this.$$d_$6D5);this.$WT.add_$1Gp(this.$$d_$9UK);this.$WT.add_$2ZU(this.$$d_$9UL)}$45(this,"PersonaCardFacadeViewModel","PersonaCardFacade")}return this.$WT},get_$rR:function(){return this.$32F},get_$3I5:function(){return this.$4NO},set_$3I5:function(n){this.$4NO=n;return n},get_$8CP:function(){return!!this.$WT},$2q0:function(){var n=_a.$6.acss(this.$Lg,"CreatePersonaCard");var t=this.$ZQ.$2Lx();var i=_pc.$i.$1LO(t);this.get_$QC().$2q0(i);_a.$6.aces(n)},$9p2:function(){if(!this.$C.get_$Vm()){var n=_a.$6.$1c(this.$Lg,"ShowPersonaCardExpanded",!0);$6rb(this);_a.$6.$1E(n,"ShowPersonaCardExpanded",null,null,$6rZ(this));_d.$6t.$8H6(4,this.get_$Ye().$9u,this.$ZQ.$14.get_$1F())}},$9cw:function(){this.$3Hz=null;this.get_$8CP()&&this.get_$QC().$1qj()},$9kE:function(n){n&&$6ra(this);if(this.$32F!==n){var t=!1;this.get_$QC()&&(t=!0);if(this.$32F){!n&&this.get_$QC().$7R&&this.get_$QC().$7R.get_$4L()&&this.get_$QC().$7R.set_$4L(!1);this.get_$QC().$7R&&(this.$ZQ.$14.get_$1F()===1||this.$ZQ.$14.get_$1F()===2||this.$ZQ.$14.get_$1F()===5)&&!_pc.$i.$1pH(this.get_$QC().$7R.$14,this.$3Hz)&&this.get_$QC().$1qj();this.$3Hz=null}else this.$3Hz=this.$ZQ.$14;this.$32F=n;return t}return!1},$4c:function(){if(this.$WT){this.$WT.remove_$2ox(this.$$d_$6D5);this.$WT.remove_$1Gp(this.$$d_$9UK);this.$WT.remove_$2ZU(this.$$d_$9UL)}_a.$1.prototype.$4c.call(this)},$9UL:function(){var n=this.get_$QC().$7R;n&&n.remove_$69M(this.$$d_$9Ys)},$9UK:function(){var n=this.get_$QC().$7R;if(n){if(_pc.$i.$1pH(this.$ZQ.$14,n.$14)){var t=this.$ZQ.$2Lx();n.set_$5HS(t.get_$1l())}n.set_$31A(!0);n.set_$4L(!0);this.$C.get_$L()!=="Mouse"?n.set_$fc(!1):n.set_$fc(!0);n.add_$69M(this.$$d_$9Ys)}},$9Ys:function(){this.$ZQ.set_$rR(!1)},$6D5:function(){this.$WT&&this.$C.get_$L()==="Mouse"&&this.$ZQ.set_$rR(!1)}};_d.$St=function(n,t){this.$C=n;this.$o9=t};_d.$St.prototype={$C:null,$o9:null,$5EI:function(n){return new _d.$JZ(this.$C,n,this.$o9.get_$1g())}};_d.$iL=function(){_d.$iL.initializeBase(this);this.$S=new _js.$Z;this.$1z=new _y.$4c};_d.$iL.prototype={$S:null,$1z:null,$nj:null,$z4:null,$Ce:null,$JV:!1,get_$66P:function(){return this.$nj},set_$66P:function(n){_a.$4.$Js(this.$nj,null,"MyContactsTreeNode");this.$nj=n;return n},get_$6G0:function(){return this.$z4},set_$6G0:function(n){_a.$4.$Js(this.$z4,null,"OtherContactsTreeNode");this.$z4=n;return n},$2ZL:function(n){this.$1z.$32(0,n,null)}};_d.$4s=function(n,t,i,r,u,f,e){this.$$d_$7bi=Function.createDelegate(this,this.$7bi);this.$$d_$7bj=Function.createDelegate(this,this.$7bj);this.$$d_$95y=Function.createDelegate(this,this.$95y);this.$$d_$95z=Function.createDelegate(this,this.$95z);this.$$d_$9bi=Function.createDelegate(this,this.$9bi);this.$$d_$9bj=Function.createDelegate(this,this.$9bj);this.$$d_$7hX=Function.createDelegate(this,this.$7hX);this.$$d_$7hW=Function.createDelegate(this,this.$7hW);this.$$d_$867=Function.createDelegate(this,this.$867);this.$$d_$9Xo=Function.createDelegate(this,this.$9Xo);this.$$d_$86I=Function.createDelegate(this,this.$86I);this.$$d_$2rN=Function.createDelegate(this,this.$2rN);this.$$d_$967=Function.createDelegate(this,this.$967);this.$$d_$3k1=Function.createDelegate(this,this.$3k1);this.$$d_$9bf=Function.createDelegate(this,this.$9bf);this.$$d_$9C4=Function.createDelegate(this,this.$9C4);_d.$4s.initializeBase(this);_a.$4.$l(i,"rootNode");this.$BC=i;this.$C=n;this.$Pb=e;$6(r)||(this.$mV=r);this.$Hw=t;this.$S=new _js.$Z;this.$S.add_$1Z(this.$$d_$9C4);this.$3zt=!1;this.$30F=u||this.$C.get_$L()!=="Mouse";this.set_$1bw(f);if(!this.$30F){this.$6NT=new _C(this.$$d_$9bf,_d.$4s.$A);this.$5EK=new _C(this.$$d_$3k1,_d.$4s.$A);this.$66C=new _C(this.$$d_$967,_d.$4s.$A);this.$7hL=new _C(this.$$d_$2rN,_d.$4s.$A);$4lC(this)}};function $6rm(n,t){return new _0365m.$m($6rl(n,t),null,n.$66C)}function $6rk(n){n.$8Z=new _0365m.$2b([]);n.$Hw&&$4lB(n,n.$8Z,n.$Hw.get_$1DG());if($6rj(n)){n.$8Z.$1C.get_$B()>0&&n.$8Z.$1C.$D(new _0365m.$9y);n.$8Z.$1C.$D(n.get_$96p())}}function $4lB(n,t,i){var r=t.$1C;if(n.$Hw){(n.$Hw.$Nd===5||n.$Hw.$Nd===10)&&r.$69([n.get_$9bg(),n.get_$7hM(),$6rm(n,i)]);n.$Hw.get_$5cb()&&r.$D(n.get_$86B())}}function $6rj(n){return!n.$Hw||n.$Hw.get_$1OE()?!0:!1}function $6rl(n,t){return String.format(_nbs.NonBootStrings.l_ContactFolderMoveToGroupMenuTitle_LowerCase_Text,t?_nbs.NonBootStrings.l_OtherFiltersTitle_LowerCase_Text:_nbs.NonBootStrings.l_MyContactsFolderDisplayName_LowerCase_Text)}function $2Cf(n){n.set_$CW(1)}function $4lD(n,t){n.$BC.$nj.set_$2O(!0);n.$8Z=new _0365m.$2b([]);$4lB(n,n.$8Z,t);if(t){n.$BC.$z4.$S.$34(n);n.$BC.$nj.$S.$D(n)}else{n.$BC.$nj.$S.$34(n);n.$BC.$z4.$S.$D(n);n.$BC.$z4.set_$HV(!1)}$3(n,"IsChildOfOtherContactsFolder")}function $4lC(n){_a.$4.$9n(!n.$3zt,"Context menu commands are already hooked up. Can NOT HookupContextMenu() second time!");if(!n.$30F&&n.$2OX){$6rk(n);n.$3zt=!0}}_d.$4s.prototype={$Hw:null,$mV:null,$C:null,$BC:null,$30F:!1,$Pb:!1,$6NT:null,$5EK:null,$66C:null,$7hL:null,$266:null,$8Z:null,$163:null,$BU:0,$S:null,$3G:!1,$A7:!1,$N0:!1,$3zt:!1,$2OX:!1,$2pg:null,$4HJ:null,$zc:null,$5Hy:null,$2WD:null,$3zs:!1,$4We:!1,get_$2P9:function(){return!$6(this.$mV)},get_$5aF:function(){return this.$3zs||this.get_$5co()&&!this.$N0},set_$5aF:function(n){if(this.$3zs!==n){this.$3zs=n;$3(this,"IsContactFolderHidden")}return n},get_$1bw:function(){return this.$2OX},set_$1bw:function(n){if(this.$2OX!==n){this.$2OX=n;$3(this,"IsContactFolderReadyForUsage")}return n},get_$5co:function(){return this===this.$BC.$z4},get_$6HS:function(){this.$266||(this.$266=new _C(_d.$Nw.$4LB,_d.$4s.$A));return this.$266},get_$6Wf:function(){return this.$4We&&!this.$A7},set_$6Wf:function(n){if(this.$4We!==n){this.$4We=n;$3(this,"ShowPeopleConnectAsLastChild")}return n},get_$HV:function(){return this.$A7},set_$HV:function(n){if(n!==this.$A7){this.$Hw&&this.$Hw.get_$1OE()&&this.$BC.$z4&&this.$BC.$z4.set_$5aF(n);this.$A7=n;$45(this,"IsCollapsed","ShowPeopleConnectAsLastChild")}return n},get_$2O:function(){return this.$3G},set_$2O:function(n){if(n!==this.$3G){this.$3G=n;$3(this,"IsSelected")}return n},get_$96o:function(){return this.$163},set_$96o:function(n){if(n!==this.$163){this.$163=n;$3(this,"NewContactFolderName")}return n},get_$Pa:function(){return this.$N0},set_$Pa:function(n){if(n!==this.$N0){this.$N0=n;$45(this,"HasChildren","IsContactFolderHidden")}return n},get_$CW:function(){return this.$BU},set_$CW:function(n){if(n!==this.$BU){this.$BU=n;$3(this,"TreeNodeMode")}return n},get_$9bg:function(){return new _0365m.$m(_u.Strings.l_Rename_LowerCase_Text,null,new _C(this.$$d_$86I,_d.$4s.$A))},get_$7hM:function(){return new _0365m.$m(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$9Xo,_d.$4s.$A))},get_$86B:function(){return new _0365m.$m(_nbs.NonBootStrings.l_PeopleConnect_ManageContactFolder_Text,null,new _C(_d.$Nw.$4LB,_d.$4s.$A))},get_$96p:function(){return new _0365m.$m(_nbs.NonBootStrings.l_ContactFolderNewFolderMenuTitle_LowerCase_Text,null,new _C(this.$$d_$867,_d.$4s.$A))},$9C4:function(n,t){this.set_$Pa(this.$S.get_$B()>0)},$9Xo:function(){var n=this;this.$BC.$1z.$32(2,_nbs.NonBootStrings.l_ContactFolderDeleteFolderPromptText_Text,function(t,i){t&&n.$2rN()},!1,null,null,String.format(_nbs.NonBootStrings.l_ContactFolderDeleteFolderTitle_Text,this.$Hw.$7i))},$2rN:function(){if(!this.$BC.$JV&&_d.$P3.isInstanceOfType(this.$Hw)){var n=this.$5Hy;if(!$6(n)){n.remove_$1x(this.$$d_$7hW);n.remove_$2C(this.$$d_$7hX)}n=this.$5Hy=new _pc.$13l(this.$Hw.$7W);this.set_$1bw(!1);n.add_$2C(this.$$d_$7hX);n.add_$1x(this.$$d_$7hW);this.$BC.$JV=!0;OwaApplication.$1W.$z(n)}},$7hW:function(n){this.$BC.$2ZL(_nbs.NonBootStrings.l_ContactFolderDeleteGenericError_Text);this.$BC.$JV=!1;this.set_$1bw(!0)},$7hX:function(n){this.$BC.$JV=!1;var t=this.$3G;this.set_$2O(!1);this.$Hw.get_$1DG()?this.$BC.$nj.$S.$34(this):this.$BC.$z4.$S.$34(this);t&&this.$BC.$nj.set_$2O(!0)},$86I:function(){this.set_$CW(4)},$9bf:function(){if(this.$BC.$JV){$2Cf(this);return}if(_js.$9.$18(this.$163)||this.$163.trim()===this.$Hw.$7i){$2Cf(this);return}if(_h.$j.$5bA(this.$Hw.$7W,this.$163)){this.$BC.$2ZL(_u.Strings.l_SameNameFolderExists_Text);$2Cf(this);return}var n;if(!$6(this.$zc)){n=this.$zc;n.remove_$2C(this.$$d_$9bj);n.remove_$1x(this.$$d_$9bi);this.$zc=null}n=this.$zc=new _h.$s3;n.$2G=this.$Hw.$7W;n.$3E5=this.$163;n.add_$2C(this.$$d_$9bj);n.add_$1x(this.$$d_$9bi);this.set_$CW(2);this.set_$1bw(!1);this.$BC.$JV=!0;OwaApplication.$1W.$z(n)},$9bi:function(n){this.$BC.$2ZL(_nbs.NonBootStrings.l_ContactFolderRenameGenericError_Text);$2Cf(this);this.$BC.$JV=!1;this.set_$1bw(!0)},$9bj:function(n){var t=this.$3G;this.set_$2O(!1);t&&this.$BC.$nj.set_$2O(!0);$2Cf(this);this.$BC.$JV=!1;this.set_$1bw(!0)},$967:function(){if(!this.$BC.$JV&&_d.$P3.isInstanceOfType(this.$Hw)){var t=this.$Hw;var n=this.$2WD;if(!$6(n)){n.remove_$2C(this.$$d_$95z);n.remove_$1x(this.$$d_$95y);this.$2WD=null}n=this.$Hw.get_$1DG()?this.$2WD=new _pc.$y8(t.$7W,10):this.$2WD=new _pc.$y8(t.$7W,1);n.add_$2C(this.$$d_$95z);n.add_$1x(this.$$d_$95y);$4lD(this,!this.$Hw.get_$1DG());this.$BC.$JV=!0;OwaApplication.$1W.$z(n)}},$95y:function(n){this.$BC.$JV=!1;$4lD(this,this.$Hw.get_$1DG());this.$BC.$2ZL(this.$2WD.$8w)},$95z:function(n){this.$BC.$JV=!1},$867:function(){if(!this.$BC.$JV){var n=!$6(this.$Hw)&&this.$Hw.get_$1DG()?this.$BC.$nj:this.$BC.$z4;n.set_$CW(3)}},$3k1:function(){if(this.get_$2P9()||this.$Hw.get_$1OE()){if(this.$BC.$JV){this.set_$CW(1);return}if(_js.$9.$18(this.$163)){this.set_$CW(1);return}var n=this.$2pg;if(!$6(n)){n.remove_$2C(this.$$d_$7bj);n.remove_$1x(this.$$d_$7bi);this.$2pg=null}n=this.$2pg=new _pc.$13D(this.$163,this.get_$2P9()?10:1,_g.$h.$1i.nameToId("contacts"),this.$BC.$Ce);var t=new _d.$P3(n.$1R6);var i=this.$4HJ=new _d.$4s(this.$C,t,this.$BC,null,this.$30F,!1);n.add_$2C(this.$4HJ.$$d_$7bj);n.add_$1x(this.$$d_$7bi);this.$S.$D(i);this.$BC.$JV=!0;this.set_$CW(1);OwaApplication.$1W.$z(n)}},$7bi:function(n){this.$BC.$2ZL(this.$2pg.$8w);this.$S.$34(this.$4HJ);this.$BC.$JV=!1},$7bj:function(n){this.set_$1bw(!0);$4lC(this);this.$BC.$JV=!1;$3(this,"ContextMenuViewModel")}};_d.$bC=function(){this.$3rD=new _d.$WD(0,new _h.$Cb("PersonaDisplayNameFirstLast","Ascending"),_nbs.NonBootStrings.l_DisplayPreferences_FirstOption_LowerCase_Text);this.$44m=new _d.$WD(1,new _h.$Cb("PersonaDisplayNameLastFirst","Ascending"),_nbs.NonBootStrings.l_DisplayPreferences_SecondOption_LowerCase_Text);_d.$bC.initializeBase(this);this.set_$4v(_d.$bC.$1s5);this.set_$2FT(1);this.get_$3T().$D(this.$3rD);this.get_$3T().$D(this.$44m)};_d.$bC.prototype={$5Fe:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$WD=function(n,t,i){_d.$WD.initializeBase(this);_a.$4.$l(n,"displayOption");_a.$4.$l(t,"sortBy");_a.$4.$l(i,"contextMenuDisplayName");this.$2sQ=n;this.$GX=t;this.$1Ac=i};_d.$WD.prototype={$2sQ:0,$GX:null,$1Ac:null,toString:function(){return _d.$vG.toString(this.$2sQ)}};_d.$L9=function(){};_d.$L9.$5Rs=function(n){return n===1?_d.$L9.$6I0:_d.$L9.$6Hz};_d.$14d=function(){};_d.$14d.prototype={$3tY:function(n){return new _pc.$15y(n)}};_d.$8i=function(n,t,i,r,u){this.$$d_$9LD=Function.createDelegate(this,this.$9LD);this.$$d_$3IP=Function.createDelegate(this,this.$3IP);this.$$d_$9Kx=Function.createDelegate(this,this.$9Kx);this.$$d_$9K7=Function.createDelegate(this,this.$9K7);this.$$d_$9Qs=Function.createDelegate(this,this.$9Qs);this.$$d_$7nZ=Function.createDelegate(this,this.$7nZ);this.$$d_$6A9=Function.createDelegate(this,this.$6A9);this.$$d_$9Pj=Function.createDelegate(this,this.$9Pj);_d.$8i.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$8i.initializeBase(this);this.$C=n;this.set_$4v(_d.$8i.$1s5);this.$Pb=u;this.$1SP=new _js.$Z;this.$1TO=new _js.$Z;this.$CV=new _d.$V2;this.$CV.add_$6RY(this.$$d_$9Pj);this.$w6=new _d.$bC;this.$w6.add_$6RY(this.$$d_$6A9);this.$2bC=!0;this.$28o(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text);this.$A6O(new _d.$14d);this.$5M8=new _C(this.$$d_$7nZ,_d.$8i.$A);this.$6RI=new _C(this.$$d_$9Qs,_d.$8i.$A);this.$gf=this.$C.get_$L();this.$1z7=_y.$4T.$j3(this.$C);this.$gf==="TouchNarrow"&&this.set_$7D($6sL(this));this.set_$rW(i);this.$5Mo=t;this.$2OY=r;var f=_g.$V.get_$I();this.$3Om=f.get_$31().get_$Xp()&&(f.get_$6H().get_$3qb()||f.get_$6H().get_$45H());if(this.$3Om){var e=_a.$6.$1c(_a.$0.$9t,"PeopleConnectLinkShown",!0);$6sM(this);_a.$6.$1E(e,"PeopleConnectLinkShown",null,null,_js.$9.$4R("FB={0},LI={1}",f.get_$6H().get_$3qb(),f.get_$6H().get_$45H()))}};_d.$8i.$9mB=function(n,t){return!n&&t==="TouchWide"||n===1&&t!=="TouchNarrow"};function $2h9(n,t,i,r){var u;var f=r?n.$1SP:n.$1TO;switch(i.$2v){case 0:for(var e=0;e<i.$2l.length;e++){u=i.$2l[e].$Hw;f.$D(u);n.get_$3T().$D(u)}break;case 2:for(var o=0;o<i.$38.length;o++){u=i.$38[o].$Hw;f.$D(u);n.get_$3T().$34(u)}break;case 3:$2h9(n,t,new _js.$II(2,i.$4V,null,i.$38),r);$2h9(n,t,new _js.$II(0,i.$4V,i.$2l,null),r);break;case 4:f.$1r();n.get_$3T().$1r();break}}function $6sL(n){var t=_y.$26.$Bg(n,null,null);t.$hX(new _C(n.$$d_$3IP,_d.$8i.$A));return t}function $6sM(n){_js.Trace.logInfo(_d.$8i.$A,"Subscribing to people connect notifications.");var t=new _g.$At;t.NotificationType="RowNotification";t.FolderId=_g.$2X.$Bi("peopleconnect").get_$r().Id;_js.Trace.logInfo(_a.$0.$5q,"[FilterListVM::SubscribeToNotifications] FolderId: {0}",t.FolderId);var i=new _h.$BS(t);i.$IU(_d.$8i.$A,"FilterListVM:RowNotification",n.$$d_$9LD,2)}_d.$8i.prototype={$5Mo:0,$6RI:null,$5M8:null,$1SP:null,$1TO:null,$C:null,$CV:null,$w6:null,$2OY:!1,$3Om:!1,$gf:0,$1z7:!1,$Pb:!1,$266:null,$J1:null,$AI:null,$11w:null,$Sn:!1,$2bC:!1,$2Ke:null,$2uJ:null,$1I1:null,$3De:null,$3w:null,$3m:null,$i0:null,$4W1:!0,$DW:!1,$1Qx:null,$3Nw:!0,add_$4Ji:function(n){this.$2N("OnFolderSelected",n)},remove_$4Ji:function(n){this.$2P("OnFolderSelected",n)},get_$7pH:function(){return this.$gf==="Mouse"?_y.$3.get_$1Xe():this.$gf==="TouchWide"?_y.$3.get_$2oN():_y.$3.get_$O1()},get_$7pI:function(){return this.$gf==="Mouse"?_y.$3.get_$1Xf():this.$gf==="TouchWide"?_y.$3.get_$2oN():_y.$3.get_$O1()},get_$7pK:function(){return this.$gf==="Mouse"?_y.$3.get_$1Xg():this.$gf==="TouchWide"?_y.$3.get_$2oO():_y.$3.get_$O1()},get_$7pL:function(){return this.$gf==="Mouse"?_y.$3.get_$1Xh():this.$gf==="TouchWide"?_y.$3.get_$2oO():_y.$3.get_$O1()},get_$97F:function(){return this.$gf==="Mouse"?10:20},get_$22:function(){return _y.$FS.prototype.get_$22.call(this)},set_$22:function(n){_y.$FS.prototype.set_$22.call(this,n);n&&n.$7W.get_$r()?this.set_$5Fr(n.$3sw(this.$CV.get_$22().$V8,this.$i0)):this.set_$5Fr(null);$3(this,"IsMailboxFilterSelected");return n},get_$1xv:function(){return!this.get_$22()||this.get_$22().get_$31g()},get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?2:0},get_$3GX:function(){return null},get_$3GZ:function(){return null},get_$4i:function(){return this.$3m},set_$4i:function(n){this.$3m=n;return n},get_$7D:function(){return this.$3w},set_$7D:function(n){if(this.$3w!==n){this.$3w=n;$3(this,"ApplicationBarViewModel")}return n},get_$ch:function(){return this.$DW},set_$ch:function(n){if(n!==this.$DW){this.$DW=n;$3(this,"IsTransitionedIn")}return n},get_$7ZX:function(){return this.$i0},set_$7ZX:function(n){this.$i0=n;this.$11w=this.get_$22().$3sw(this.$CV.get_$22().$V8,this.$i0);return n},get_$5Fr:function(){return this.$11w},set_$5Fr:function(n){this.$11w=n;this.$3So();$3(this,"CurrentConfiguration");return n},get_$2ag:function(){return this.$J1},set_$2ag:function(n){if(n!==this.$J1){this.$J1=n;$3(this,"RootTreeNode")}return n},get_$7od:function(){return this.$2uJ},set_$7od:function(n){if(this.$2uJ!==n){this.$2uJ=n;$3(this,"FirstFilterOptionDisplayName")}return n},get_$7nw:function(){return this.$2Ke},set_$7nw:function(n){if(this.$2Ke!==n){this.$2Ke=n;$45(this,"FilterOptionDisplayName","AriaFilterOptionDisplayName")}return n},get_$2dW:function(){return this.$1I1},set_$2dW:function(n){if(this.$1I1!==n){this.$1I1=n;$45(this,"SortOptionDisplayName","AriaSortOptionDisplayName")}return n},get_$7Qe:function(){return String.format(_nbs.NonBootStrings.l_PeopleFilterOption_AT_Text,this.$2Ke)},get_$7Qj:function(){return String.format(_nbs.NonBootStrings.l_PeopleSortOption_AT_Text,this.$1I1)},get_$dh:function(){return this.$AI},set_$dh:function(n){if(n!==this.$AI){this.$AI=n;$3(this,"SelectedTreeNode");$6(n)||this.set_$22(n.$Hw)}return n},get_$9g3:function(){return this.$2bC},set_$9g3:function(n){if(n!==this.$2bC){this.$2bC=n;$3(this,"SecondaryListIsEmpty")}return n},get_$1l0:function(){if(this.$gf==="Mouse")return this.$Pb?this.$Sn?214:58:this.$Sn?214:60;else if(this.$gf==="TouchWide")return this.$Sn?this.$1z7?244:260:60;return 0},get_$6XY:function(){return 60},get_$6XX:function(){return 274},get_$7pM:function(){return this.$Sn?_nbs.NonBootStrings.l_PeopleCollapseFolder_AT_Text:_nbs.NonBootStrings.l_PeopleExpandFolder_AT_Text},get_$rW:function(){return this.$Sn},set_$rW:function(n){if(n!==this.$Sn){this.$Sn=n;$PB(this,"IsSidePanelExpanded","FolderPanePaneButtonAriaLabel","SidePanelWidth")}return n},get_$66O:function(){if(!this.$3De){this.$3De=_g.$2X.$Bi("mycontacts");this.$3De.set_$1o(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text)}return this.$3De},get_$6HS:function(){this.$266||(this.$266=new _C(_d.$Nw.$4LB,_d.$8i.$A));return this.$266},$28o:function(n){this.set_$7nw(String.format(_nbs.NonBootStrings.l_PeopleFilterOptionDisplayName_Text,n,this.$CV.get_$22().$7i));this.set_$7od(n);this.get_$1xv()?this.set_$2dW(String.format(_nbs.NonBootStrings.l_PeopleFilterOptionDisplayNameSort_Text,this.$CV.get_$22().$7i)):this.set_$2dW(_nbs.NonBootStrings.l_PeopleDirectoryBrowseSortByDisplayName_Text)},$3So:function(){this.$4W1&&($6(this.get_$22())?this.$28o(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text):this.$28o(this.get_$22().$7i))},$5QB:function(){return $6(this.$11w)?this.get_$66O():this.$11w.$2G},$3IP:function(){this.get_$4i().$Bs()},$gk:function(){},$GN:function(){this.set_$ch(!0)},$kK:function(){this.set_$ch(!1)},$Uz:function(){},$5Fe:function(n){return new _d.$P3(n,this.$Pb)},$9Jk:function(n,t){_y.$FS.prototype.$9Jk.call(this,n,t);this.$7bS()},$7bS:function(){this.$1SP.$1r();this.$1TO.$1r();this.$1Qx=null;var n=new _d.$iL;n.$Ce=_h.$j.$cN("msgfolderroot");for(var i=null,u=new _d.$4s(this.$C,null,n,_nbs.NonBootStrings.l_OtherFiltersTitle_Text,this.$2OY,!0,this.$Pb),r=null,e=new _js.$Z,f=0;f<this.get_$3T().get_$B();f++){var t=this.get_$3T().get_$3q(f);if(!t.get_$89o()){if(t.get_$1OE()){i=new _d.$4s(this.$C,t,n,null,this.$2OY,!0,this.$Pb);this.$1SP.$D(t);continue}if(t.get_$31g())if(t.get_$1DG()){i.$S.$D(new _d.$4s(this.$C,t,n,null,this.$2OY,!0,this.$Pb));this.$1SP.$D(t)}else{u.$S.$D(new _d.$4s(this.$C,t,n,null,this.$2OY,!0,this.$Pb));this.$1TO.$D(t)}else if(t.get_$312())r=new _d.$4s(this.$C,t,n,null,!0,!0,this.$Pb);else{r||(r=new _d.$4s(this.$C,null,n,_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text,!0,!0,this.$Pb));var o=new _d.$4s(this.$C,t,n,null,!0,!0,this.$Pb);e.$D(o);t.get_$5cS()&&(this.$1Qx=o)}}}if(i){n.set_$66P(i);n.$S.$D(i);i.set_$HV(this.$Pb);this.$3Nw&&i.set_$2O(!0);i.set_$6Wf(this.$Pb?this.$3Om:!1);n.set_$6G0(u);n.$nj.$S.$D(u);i.$S.add_$1Z(this.$$d_$9K7);u.$S.add_$1Z(this.$$d_$9Kx);u.set_$HV(!0)}if(r){r.$S.$69(e.$6Z());n.$S.$D(r);r.set_$HV(this.$Pb)}this.set_$2ag(n);this.$2bC=!this.$1TO.get_$B()},$9K7:function(n,t){$2h9(this,n,t,!0)},$9Kx:function(n,t){$2h9(this,n,t,!1)},$7nZ:function(){this.set_$rW(!this.$Sn)},$9Qs:function(){$6C(this,"OnFolderSelected");this.$gf==="TouchNarrow"?this.$3IP():this.set_$rW(!_d.$8i.$9mB(this.$5Mo,this.$gf))},$9Pj:function(n,t){this.$3So();this.get_$22()&&(this.$11w=this.get_$22().$3sw(this.$CV.get_$22().$V8,this.$i0));$3(this,"SortOptionPropertyChanged")},$6A9:function(n,t){this.$CV.$A18(n);$3(this,"DisplayOptionPropertyChanged")},$9LD:function(n){if(n.EventType==="RowAdded"){var i=n;var r=i;var t=r.Item;$6(t)||t.ItemClass!==_d.$Nw.get_$9Ts()&&t.ItemClass!==_d.$Nw.get_$9Tt()||this.$gm()}}};_d.$K2=function(n,t,i,r){_d.$K2.initializeBase(this,[n,t,i,r])};function $4nB(n){return!(n.$1Fz||n.$1Rb||n.$1Fy)}function $6v6(n,t,i,r){if((n.$1Fz||n.$1Fy)&&t.$7W.$Nd===1002){n.$3dM=new _d.$4s(r,t,i,null,!0,!0);return!1}if(n.$1Fz&&!n.$1Fy&&t.$7W.$Nd===1004){n.$3dE=new _d.$4s(r,t,i,null,!0,!0);return!1}if((n.$1Rb||n.$1Fy)&&t.$7W.$Nd===1003){n.$3dH=new _d.$4s(r,t,i,null,!0,!0);return!1}return(n.$1Fz||n.$1Rb||n.$1Fy)?!1:!0}function $6v5(n){return!n.$1hJ}function $6v4(n){return!n.$2XM}function $6v3(n,t){n.$1hJ&&t.$N0&&n.set_$22(t.$S.get_$3q(0).$Hw)}_d.$K2.prototype={$2XM:!1,$1hJ:!1,$1Fz:!1,$1Rb:!1,$1Fy:!1,$3dM:null,$3dH:null,$3dE:null,$7bS:function(){this.$1SP.$1r();this.$1TO.$1r();var f=this.$C.get_$L()==="TouchNarrow";var n=new _d.$iL;n.$Ce=_h.$j.$cN("msgfolderroot");for(var r=null,u=new _d.$4s(this.$C,null,n,_nbs.NonBootStrings.l_OtherFiltersTitle_Text,f,!0),i=null,e=new _d.$4s(this.$C,null,n,_nbs.NonBootStrings.l_OtherAddressListsFiltersTitle_Text,!0,!0),o=0;o<this.get_$3T().get_$B();o++){var t=this.get_$3T().get_$3q(o);if(t.get_$1OE()){r=new _d.$4s(this.$C,t,n,null,f,!0);this.$1SP.$D(t);continue}if(t.get_$31g())if(t.get_$1DG()){r.$S.$D(new _d.$4s(this.$C,t,n,null,f,!0));this.$1SP.$D(t)}else{u.$S.$D(new _d.$4s(this.$C,t,n,null,f,!0));this.$1TO.$D(t)}else if(t.get_$312()){i||(i=new _d.$4s(this.$C,null,n,_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text,!0,!0));$4nB(this)&&i.$S.$D(new _d.$4s(this.$C,t,n,null,!0,!0))}else $6v6(this,t,n,this.$C)&&e.$S.$D(new _d.$4s(this.$C,t,n,null,!0,!0))}if(!$6(r)&&$6v5(this)){n.set_$66P(r);n.$S.$D(r);r.set_$HV(!1);r.set_$2O(!0);n.set_$6G0(u);r.$S.$D(u);r.$S.add_$1Z(this.$$d_$9K7);u.$S.add_$1Z(this.$$d_$9Kx);u.set_$HV(!0)}if(!$6(i)&&$6v4(this)){n.$S.$D(i);if($4nB(this)){i.$S.$D(e);e.set_$HV(!0)}else{this.$3dM&&i.$S.$D(this.$3dM);this.$3dE&&i.$S.$D(this.$3dE);this.$3dH&&i.$S.$D(this.$3dH)}$6v3(this,i)}this.set_$2ag(n);this.set_$9g3(!this.$1TO.get_$B())}};_d.$1KQ=function(n,t){this.$7i="";_d.$1KQ.initializeBase(this);if(!n)throw Error.argumentNull("displayName");this.set_$1o(n);this.$Nd=t};_d.$1KQ.prototype={$Nd:0,get_$1o:function(){return this.$7i},set_$1o:function(n){this.$7i=n;$3(this,"DisplayName");return n},get_$1OE:function(){return _pc.$Ds.$5ca(this.$Nd)},get_$89o:function(){return _pc.$Ds.$5ax(this.$Nd)},get_$8Cl:function(){return _pc.$Ds.$8Cm(this.$Nd)},get_$312:function(){return _pc.$Ds.$8A9(this.$Nd)},get_$1DG:function(){return _pc.$Ds.$5ca(this.$Nd)||_pc.$Ds.$9mD(this.$Nd)},get_$31g:function(){return!_pc.$Ds.$9mC(this.$Nd)},get_$5cb:function(){return _pc.$Ds.$5cc(this.$Nd)},get_$5cS:function(){return _pc.$Ds.$8Bb(this.$Nd)}};_d.$DJ=function(n,t,i){this.$1W=n;this.$1J=t;this.$M=i};_d.$DJ.$1YD=function(n){n.set_$R8(!0);n.set_$q(!1);n.set_$18b(100);n.set_$1gB(0)};_d.$DJ.prototype={$1W:null,$1J:null,$M:null,$E:function(n,t,i,r,u,f){var e=new _d.$2C(n,t,i,this.$1W,!$6(u)&&u,f,this.$1J,this.$M);e.set_$1jW(r);return e}};_d.$Jf=function(n,t){this.$$d_$9B9=Function.createDelegate(this,this.$9B9);this.$$d_$9NZ=Function.createDelegate(this,this.$9NZ);this.$1Nd=-1;this.$iQ={};_d.$Jf.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Jf.initializeBase(this,[_pc.$14.$wX,_pc.$14.$iZ(),!0,n,!1,t,null,null]);this.set_$1jW("PersonaDetailedView");this.$11N();this.set_$q(!1);this.set_$R8(!0);this.set_$tx(!0)};function $6sP(n){var u=n.$2s;if(_js.$9.$18(u))return!0;var i=_d.$32.$6Gs(u);var f=i.length;if(f===1){var t;var e,o;var s=(o=_d.$32.$2pl(i[0],e={val:t}),t=e.val,o);if(!s||!t)return!0;n.$1iF=new _js.$Z;n.$1VJ=new _js.$Z;n.$1iF.$D(s);n.$1VJ.$D(t)}else{n.$1iF=new _js.$Z;n.$1VJ=new _js.$Z;n.$Z9=new _js.$Z;for(var r=0;r<f;r++)$6sO(n,i[r])}if(n.$1iF.get_$B()>0){$JB(n,"BulkResolvePersonasReady",n.$1iF);return!1}return!0}function $6sO(n,t){var i;var u,f;var r=(f=_d.$32.$2pl(t,u={val:i}),i=u.val,f);if(r){n.$1iF.$D(r);n.$1VJ.$D(i);if(!i){var e=r.get_$1l().Name;n.$Z9.get_$B()||n.$5iv(e);n.$Z9.$D(e)}}}function $4la(n,t){var i=n.get_$7eH()(t);if(!Object.getType(i).implementsInterface(_pc.$xJ))throw Error.argument("The server search action must implement IQueryAction interface");n.$2mu=i;n.$2mu.add_$2m(n.$$d_$9B9);n.$1W.$z(n.$2mu)}function $6sQ(n,t,i){if($6(t.$1f)){var r=t.get_$17M();n.$iQ[n.$26y]=r}else{n.set_$18S(_nbs.NonBootStrings.l_ServerSearchError_Text);n.set_$1jV("")}}_d.$Jf.prototype={$2mu:null,$1iF:null,$1VJ:null,$Z9:null,$26y:null,$2nj:!1,add_$690:function(n){this.$2N("BulkResolvePersonasReady",n)},remove_$690:function(n){this.$2P("BulkResolvePersonasReady",n)},add_$6Xk:function(n){this.$2N("SingleActionResultsReady",n)},remove_$6Xk:function(n){this.$2P("SingleActionResultsReady",n)},get_$9yF:function(){return this.$Z9},set_$9yF:function(n){this.$Z9!==n&&(this.$Z9=n);return n},get_$3gx:function(){return this.$2nj},set_$3gx:function(n){this.$2nj!==n&&(this.$2nj=n);return n},$6O2:function(){this.$Z9=null;this.$1iF=null;this.$1VJ=null;var n=this.$iQ;for(var t in n){var i={key:t,value:n[t]};delete this.$iQ[i.key]}},$5iv:function(n){this.$1Nd=0;this.$26y=n;$4la(this,n)},$81x:function(n){_a.$4.$J(n,"HandleResultsFromSpeech");var i=$2Ch(this,n);if(!(i===1&&$4lb(this,n.get_$3q(0)))){var t=this;_js.$J.get_$I().$1w(_a.$0.$XW,"ResultVisible",function(){t.set_$da(!0);t.set_$2Mq(!0)},1e3)}},$4c:function(){if(!$6(this.$iQ)){var n=this.$iQ;for(var t in n){var i={key:t,value:n[t]};var r=i.key;delete this.$iQ[r]}}_y.$6b.prototype.$4c.call(this)},$7WV:function(){},$9mc:function(){if(this.$2s in this.$iQ){var n=this.$iQ[this.$2s];$4ld(this);$2Ch(this,n);return!1}if(this.$1CU){this.set_$2xc(!1);if($6(this.$Z9)||!this.$Z9.get_$B())return $6sP(this)}if(this.$Z9&&this.$Z9.get_$B()>0){$3WU(this);var t=this.$Z9.$71(this.$2s);if(t!==-1){this.set_$32s(!1);this.set_$3JN(!0);this.set_$1jV("");this.set_$18S(String.format(_nbs.NonBootStrings.l_SearchingForResultsString_Text,this.$2s));$2hD(this);this.$3vG();this.set_$HW(!0);this.add_$6Xk(this.$$d_$9NZ);return!1}}return!0},$9n9:function(){if(this.$2s in this.$iQ){var n=this.$iQ[this.$2s];$2Ch(this,n);return!1}return!0},$9B9:function(n){if($6(n.$1f)&&$6(n.get_$17M()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2mu){var i;$6sQ(this,n,i={val:t});t=i.val;$eM(this,"SingleActionResultsReady")}n.remove_$2m(this.$$d_$9B9);if(!$6(this.$Z9)){do this.$1Nd++;while(this.$1Nd<this.$Z9.get_$B()&&this.$Z9.get_$3q(this.$1Nd)in this.$iQ);if(this.$1Nd<this.$Z9.get_$B()){this.$26y=this.$Z9.get_$3q(this.$1Nd);$4la(this,this.$26y)}else this.$1Nd=-1}},$9NZ:function(){if(this.$2s in this.$iQ){var n=this.$iQ[this.$2s];$2Ch(this,n)}this.remove_$6Xk(this.$$d_$9NZ)}};_d.$P3=function(n,t){this.$$d_$6Y9=Function.createDelegate(this,this.$6Y9);this.$$d_$9zB=Function.createDelegate(this,this.$9zB);_d.$P3.initializeBase(this,[_d.$P3.$3g9(n,t),n.$Nd]);this.$7W=n;this.$7W.add_$7jG(this.$$d_$9zB);this.$7W.add_$9vz(this.$$d_$9zB);this.$7W.add_$6Y9(this.$$d_$6Y9);this.$Pb=t;this.$9vy=n.get_$J7()};_d.$P3.$3g9=function(n,t){if(!n)throw Error.argumentNull("folder");if(!n.get_$1o())throw Error.argumentNull("displayName");var i=null;i=n.$Nd===1?t?_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text:_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Capitalized_Text:n.$Nd===1e3?t?_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text:_nbs.NonBootStrings.l_PeopleDirectoryContainer_LowerCase_Text:n.get_$1o();return i};_d.$P3.prototype={$9vy:0,$Pb:!1,$7W:null,$3sw:function(n,t){return new _pc.$Y7(this.$7W,n,t)},$9zB:function(n,t){this.set_$1o(_d.$P3.$3g9(this.$7W,this.$Pb))},$6Y9:function(n,t){this.$Nd=this.$7W.$Nd}};_d.$1Jc=function(){};_d.$18a=function(){this.$$d_$9Gt=Function.createDelegate(this,this.$9Gt);_d.$18a.initializeBase(this)};_d.$18a.prototype={$wm:null,$4TO:null,$3w4:null,add_$837:function(n){this.$2N("HeaderClicked",n)},remove_$837:function(n){this.$2P("HeaderClicked",n)},get_$Sh:function(){if(!this.$wm){var t=_a.$10.get_$DB().culture().people.headerDisplayValues;var r=_a.$10.get_$DB().culture().people.headerSeekToValues;this.$wm=new _js.$Z;for(var u=Math.floor((t.length-1)/4)*4,n=0;n<t.length;n++){var i=t[n];var f=r[n];var e=!((n+1)%4);var o=n>=u;var s=new _d.$xh(i,f,e,o);this.$wm.$D(s);if(i==="*")break}}return this.$wm},get_$838:function(){this.$3w4||(this.$3w4=new _C(this.$$d_$9Gt,_a.$0.$9t));return this.$3w4},$9Gt:function(){$Dp(this,"HeaderClicked",this.$4TO)}};_d.$xh=function(n,t,i,r){_d.$xh.initializeBase(this);_a.$4.$1G(n,"displayValue");_a.$4.$J(t,"seekToValue");this.$5JU=n;this.$6RB=t;this.$5bv=i;this.$5by=r};_d.$xh.prototype={$5JU:null,$6RB:null,$5bv:!1,$5by:!1};_d.$18b=function(n,t){_d.$18b.initializeBase(this,[n,t])};_d.$18b.prototype={$2y:!1,get_$5jl:function(){return this.$C.get_$L()==="Mouse"?348:this.get_$3w8()?420:410},get_$yg:function(){return this.$C.get_$L()==="Mouse"?this.get_$3w8()?216:198:233},get_$5aP:function(){return this.get_$59w()},get_$1O:function(){return this.$2y},set_$1O:function(n){if(this.$2y!==n){this.$2y=n;$3(this,"IsShown")}return n},$4Jy:function(n){_d.$xi.prototype.$4Jy.call(this,n);this.set_$1O(!1)}};_d.$dG=function(n,t){this.$$d_$3IP=Function.createDelegate(this,this.$3IP);this.$$d_$9Ge=Function.createDelegate(this,this.$9Ge);_d.$dG.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$dG.initializeBase(this,[n,t])};function $6t6(n){var t=_y.$26.$Bg(n,null,null);t.$hX(new _C(n.$$d_$3IP,_a.$0.$9t));return t}_d.$dG.prototype={$3ux:null,$3w:null,$3m:null,$DW:!1,get_$3GX:function(){return null},get_$3GZ:function(){return null},get_$Ld:function(){return this.$C.get_$L()==="Mouse"?0:2},get_$4i:function(){return this.$3m},set_$4i:function(n){this.$3m=n;return n},get_$7D:function(){this.$3w||(this.$3w=$6t6(this));return this.$3w},get_$ch:function(){return this.$DW},set_$ch:function(n){if(n!==this.$DW){this.$DW=n;$3(this,"IsTransitionedIn")}return n},get_$7zt:function(){this.$3ux||(this.$3ux=new _C(this.$$d_$9Ge,_a.$0.$9t));return this.$3ux},$gk:function(){},$GN:function(){this.$DW=!0},$kK:function(){this.$DW=!1},$Uz:function(){},$4Jy:function(n){_d.$xi.prototype.$4Jy.call(this,n);this.$3IP()},$9Ge:function(){this.get_$59w()&&this.$C.$7X(this)},$3IP:function(){this.$3m.$Bs()}};_d.$xi=function(n,t){this.$$d_$4Jy=Function.createDelegate(this,this.$4Jy);_d.$xi.initializeBase(this);_a.$4.$J(n,"owaShell");_a.$4.$J(t,"groupGenerator");this.$C=n;this.$2xg=new _d.$18a;this.$2xg.add_$837(this.$$d_$4Jy);this.$I0=t};_d.$xi.$7T1=function(n,t){var i=new _g.$XY;i.Item=new _g.$1X(t);i.FieldURIOrConstant=new _g.$In;var r=new _g.$Ih;r.Value=n;i.FieldURIOrConstant.Item=r;return new _g.$J9(i)};_d.$xi.prototype={$2xg:null,$I0:null,$C:null,add_$6R8:function(n){this.$2N("SeekToConditionRequested",n)},remove_$6R8:function(n){this.$2P("SeekToConditionRequested",n)},get_$3w8:function(){return this.$2xg.get_$Sh().get_$B()>28},get_$59w:function(){return this.$I0.$2zk},$4Jy:function(n){var t=_d.$xi.$7T1(n.$6RB,this.$I0.$Bv);$Dp(this,"SeekToConditionRequested",t)}};_d.$jx=function(n){this.$C=n};_d.$jx.prototype={$C:null,$zD:null,$E:function(n,t,i,r){return new _d.$dL(this.$C,this.$zD,n,t,i,r)}};_d.$jy=function(n,t){this.$C=n;this.$34g=t};_d.$jy.prototype={$C:null,$34g:null,$E:function(n){return new _d.$Xh(this.$C,this.$34g,n)}};_d.$Tv=function(n){_d.$Tv.initializeBase(this,[n])};function $6tD(n,t,i,r){if(t&&t.get_$B()>0){var u=new _d.$2h(n.$2V,t.$7Rg(0),i,"",!0);if(!_js.$9.$18(u.$HI)){n.$2GE&&u.add_$11i(n.$$d_$9Ud);var f=new _d.$4z(n.$2V,r);f.get_$3T().$D(u);n.get_$3T().$D(f)}}}function $4lm(n,t,i,r){if(t&&t.get_$B()>0){var u=new _d.$2h(n.$2V,t.$7Rg(0),i,"",!0);u.add_$11i(n.$$d_$A2o);var f=new _d.$4z(n.$2V,r);f.get_$3T().$D(u);n.get_$3T().$D(f)}}_d.$Tv.prototype={$9iq:function(n){var t=this.$2GE?_nbs.NonBootStrings.l_CallActionTitle_Text:"{0}";$6tD(this,n.get_$lV(),"PersonaBusinessPhoneNumbers",String.format(t,_nbs.NonBootStrings.l_Phone_Text));$4lm(this,n.get_$1KQ(),"PersonaBusinessHomePages",_nbs.NonBootStrings.l_ViewWebPage_Text);$4lm(this,n.get_$1S5(),"PersonaPersonalHomePages",_nbs.NonBootStrings.l_ViewLocalWebPage_Text)}};_d.$3u=function(n,t,i,r,u,f,e,o){this.$$d_$9P6=Function.createDelegate(this,this.$9P6);this.$$d_$9P7=Function.createDelegate(this,this.$9P7);this.$$d_$9Lc=Function.createDelegate(this,this.$9Lc);this.$$d_$9EW=Function.createDelegate(this,this.$9EW);this.$$d_$9Bt=Function.createDelegate(this,this.$9Bt);this.$$d_$9q5=Function.createDelegate(this,this.$9q5);this.$$d_$9q4=Function.createDelegate(this,this.$9q4);this.$1wP=-1;_d.$3u.initializeBase(this,[[]]);_a.$4.$J(n,"sessionSettings");_a.$4.$J(t,"chatManager");_a.$4.$J(i,"personaViewModelFactory");_a.$4.$J(r,"actionSubmitter");_a.$4.$J(o,"signOutCommand");this.$9c=t;this.$85o(n,i);this.$k=r;this.$C=u;this.$1J=f;this.$AD=e;var h=this;this.$5YN=new _C(this.$$d_$9q4,_a.$0.$4W,this,_d.$3u.$2oJ,function(){return h.get_$5AN()!=="AttemptingSignIn"});var c=this;this.$5YO=new _C(this.$$d_$9q5,_a.$0.$4W,this,_d.$3u.$2oJ,function(){return c.get_$5AN()!=="AttemptingSignOut"});this.$6Xg=o;this.$9c.$Y(_c.$2M.$1l2,this.$$d_$9Bt);var s=_g.$V.get_$I();this.$1ko=$6(s)||$6(s.get_$6H())?!1:s.get_$6H().get_$2JT()&&s.get_$6H().get_$2c2();this.$5KM=this.$1ko?new _C(this.$$d_$9EW,_d.$3u.$A):null;$6uW(this)};function $6uV(n,t){if(n.$1J.$3u("O365Header"))switch(t){case 2:return 42;case 3:return 43;case 5:return 44;case 4:return 45;case 6:return 46;case 1:return 47;case 0:default:return 48}else switch(t){case 2:return 1;case 3:return 7;case 5:return 13;case 4:return 19;case 6:return 25;case 1:return 31;case 0:default:return 37}}function $6uW(n){if(n.$1ko){var t=new _0365m.$m(_nbs.NonBootStrings.l_OwaChangePhoto_Text,null,n.$5KM,!1,null,_nbs.NonBootStrings.l_OwaChangePhotoAriaLabel_Text,"MeCardView.EditPhoto");n.$1C.$D(t)}n.$9c.get_$2n()&&$6uT(n);$6uS(n)}function $6uT(n){n.$1C.$D(new _0365m.$m(_nbs.NonBootStrings.l_IMSignIn_Text,null,n.$5YN,!0));n.$1C.$D($2Cl(n,_u.Strings.l_IMAvailablePresenceState_Text,"Online"));n.$1C.$D($2Cl(n,_u.Strings.l_IMBusyPresenceState_Text,"Busy"));n.$1C.$D($2Cl(n,_u.Strings.l_IMDnDPresenceState_Text,"DoNotDisturb"));n.$1C.$D($2Cl(n,_nbs.NonBootStrings.l_IMBeRightBackPresenceState_Text,"BeRightBack"));n.$1C.$D($2Cl(n,_nbs.NonBootStrings.l_IMAppearAwayPresenceState_Text,"Away"));var t=new _0365m.$m(_nbs.NonBootStrings.l_IMSignOut_Text,null,n.$5YO,!0);t.set_$q(!0);n.$1C.$D(t);n.$1C.$D(new _0365m.$9y);$4mr(n)}function $6uS(n){n.$1C.$D(new _0365m.$m(_nbs.NonBootStrings.l_OwaSignOut_Text,null,new _C(n.$6Xg,_d.$3u.$A)))}function $2Cl(n,t,i){var r=new _0365m.$m(t,_y.$Rk.$3u2(_h.$84.$2Lp(i)),new _C($6uU(n,i),_a.$0.$4W),!0);r.set_$q(!0);return r}function $6uU(n,t){var i=this;return function(){var r=_h.$84.$ib(n.$rw.get_$1s().get_$A6());n.$9c.$4cn("SetPresence",r,_h.$84.$2Lp(t));var i=new _c.$1Cf(r,t);i.add_$2C(n.$$d_$9P7);i.add_$1x(n.$$d_$9P6);n.$k.$z(i)}}function $4mr(n){var t=!1;var i=!1;n.set_$cH("");switch(n.$9c.$S2){case"AttemptingSignIn":$2hR(n,!0,_nbs.NonBootStrings.l_IMSigningIn_Text);break;case"SignedIn":$2hR(n,!1,null);i=!0;break;case"unknown":case"AttemptingSignOut":case"Disabled":case"SignedOut":$2hR(n,!1,null);t=!0;break;case"Error":n.set_$cH(_nbs.NonBootStrings.l_IMSigningInError_Text);$2hR(n,!1,null);t=!0;break;default:throw Error.invalidOperation("MeCardViewModel.UpdateChatMenuItemState: Unexpected SignInState: "+n.$9c.$S2+")");}$6uX(n,t,i)}function $2hR(n,t,i){n.set_$7T8(i);n.set_$6V(t)}function $6uX(n,t,i){var u=n.get_$86v();var r=n.$1C.get_$3q(u++);r.set_$q(!t);for(var f=0;f<_d.$3u.$67p-1;f++){r=n.$1C.get_$3q(u++);r.set_$q(!i)}}_d.$3u.prototype={$9c:null,$k:null,$6Xg:null,$5YN:null,$5YO:null,$5KM:null,$1ko:!1,$AD:null,$C:null,$1J:null,$eA:null,$rw:null,$8J:!1,$2mw:null,$8w:null,get_$8JK:function(){return this.$rw},set_$8JK:function(n){this.$rw=n;return n},get_$26Y:function(){return $6uV(this,this.$rw.get_$1s().$MI)},get_$5AN:function(){return this.$9c.$S2},get_$31C:function(){return this.$9c.get_$2n()},get_$5ba:function(){return this.$9c.$S2==="SignedIn"&&!!this.$rw.get_$1s().$MI},get_$6V:function(){return this.$8J},set_$6V:function(n){this.$8J=n;$N(this,_d.$3u.$5Zw);return n},get_$7T8:function(){return this.$2mw},set_$7T8:function(n){this.$2mw=n;$N(this,_d.$3u.$58L);return n},get_$cH:function(){return this.$8w},set_$cH:function(n){this.$8w=n;$N(this,_d.$3u.$3pl);return n},get_$8Cb:function(){return(this.$rw.$NA&1)==1},get_$86v:function(){return this.$1ko?1:0},get_$p2:function(){if(!this.$eA){this.$eA=_d.$5T.$5EU(this.$C,this.$k,this.$AD);var n=this;this.$eA.add_$3T8(function(){n.$rw.$9aF()})}return this.$eA},$pS:function(n){_a.$4.$J(n,"menuItem");if(this.$1wP===-1){this.$1wP=this.$1C.get_$B()-1;this.$1C.$72(this.$1wP,new _0365m.$9y)}this.$1C.$72(this.$1wP,n);this.$1wP+=1},$85o:function(n,t){var i=new _g.$1l;i.MailboxType="OneOff";i.EmailAddress=n.get_$Aj();i.RoutingType="SMTP";i.Name=n.get_$FS();i.SipUri=n.get_$1VG()||null;var r=_pc.$i.$DQ(i);r.$Y("Presence",this.$$d_$9Lc);this.$rw=t.$SR(r,_y.$w.$KH,!1,2);var u=[1];this.$rw.$dk(1,u,"");if(this.$9c.get_$2n()){var f=this.$rw.$14;f.$3K7()}},$9P7:function(n){var t=n;_js.Trace.logInfo(_a.$0.$4W,"Set presence to {0} succeeded.",t.$3EA)},$9P6:function(n){var t=n;_js.Trace.logWarning(_a.$0.$4W,"Set presence to {0} failed: {1}",t.$3EA,n.$1f.message)},$9q4:function(){this.$9c.$4X5(!0)},$9q5:function(){this.$9c.$6Xf(!0)},$9Bt:function(n,t){$4mr(this);$N(this,_d.$3u.$2oJ);$N(this,_d.$3u.$40x)},$9Lc:function(n,t){$N(this,_d.$3u.$6Jn);$N(this,_d.$3u.$40x)},$9EW:function(){this.$1J.$3u("UploadPhoto")&&this.get_$p2().get_$2GP()?this.$C.$7X(this.get_$p2()):window.open(_a.$Co.$1N1(window.location.pathname,_d.$3u.$5KN),_d.$3u.$5KP,_d.$3u.$5KO);this.set_$1O(!1)}};_d.$xx=function(n,t,i,r,u,f,e){this.$Ax=n;this.$9c=t;this.$5C=i;this.$k=r;this.$C=u;this.$1J=f;this.$12=e};_d.$xx.prototype={$Ax:null,$9c:null,$5C:null,$k:null,$12:null,$C:null,$1J:null,$3kU:function(n){return new _d.$3u(this.$Ax,this.$9c,this.$5C,this.$k,this.$C,this.$1J,this.$12.$AD,n)}};_d.$qt=function(){};_d.$qt.prototype={$2Xq:null,$E:function(n,t){return new _d.$4f(n,t,this.$2Xq)}};_d.$qs=function(){};_d.$qs.prototype={$5C:null,$E:function(n,t){return new _d.$UN(n,t,this.$5C)}};_d.$Nw=function(){};_d.$Nw.get_$9Ts=function(){return"IPM.Note.PeopleConnect.Notification.Connected"};_d.$Nw.get_$9Tt=function(){return"IPM.Note.PeopleConnect.Notification.Disconnected"};_d.$Nw.$4LB=function(){var n=_a.$Co.$1N1(window.location.pathname,"Connect/PeopleConnections.aspx");var t=_a.$6.$1c(_a.$0.$9t,"PeopleConnectLinkClicked",!0);window.open(n,"_blank","width=580,height=300,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no");_a.$6.$1E(t)};_d.$UU=function(n,t,i,r){_d.$UU.initializeBase(this);this.$2E=n;this.$1CN=t;this.$5fG=i;this.$6VF=r};_d.$UU.prototype={$2E:null,$5fG:!1,$1CN:null,$6VF:!1,$6g:!1,get_$8k:function(){return this.$1CN},get_$q:function(){return this.$6g},set_$q:function(n){this.$6g=n;return n}};_d.$MO=function(n){this.$13Y={};this.$5dI=n};_d.$MO.$7Vh=function(n){switch(n){case"PersonaDisplayNameFirstLast":case"PersonaDisplayNameLastFirst":return!0;case"PersonaCompanyName":case"PersonaHomeCity":case"PersonaWorkCity":case"PersonaCreationTime":return!1;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};function $6vB(n,t){var r=$3Wz(n,t);var i=r+n.$Bv;if(i in n.$13Y)return n.$13Y[i];else{var f=n.$2zk&&n.$5dI;var u=new _d.$UU(r,i,!n.$2zk,f);n.$13Y[i]=u;return u}}function $3Wz(n,t){if($6(t))throw Error.invalidOperation("The persona to have a header generated should not be null");var i="";switch(n.$Bv){case"PersonaDisplayNameFirstLast":i=t.get_$1se();break;case"PersonaDisplayNameLastFirst":i=t.get_$1sg();break;case"PersonaCompanyName":i=_nbs.NonBootStrings.l_PeopleHeaderNoCompany_Text;_js.$9.$a(t.get_$lm())||(i=t.get_$lm().toLocaleUpperCase());break;case"PersonaHomeCity":i=_nbs.NonBootStrings.l_PeopleHeaderNoCity_Text;_js.$9.$a(t.get_$1bE())||(i=t.get_$1bE().toLocaleUpperCase());break;case"PersonaWorkCity":i=_nbs.NonBootStrings.l_PeopleHeaderNoCity_Text;_js.$9.$a(t.get_$1mw())||(i=t.get_$1mw().toLocaleUpperCase());break;case"PersonaCreationTime":i=_nbs.NonBootStrings.l_PeopleHeaderNoCreationTime_Text;if(!$6(t.get_$2q5())){var r=_y.$X5.$A4d(_y.$Mh,t.get_$2q5(),n.$3JV);i=r.$mV.toLocaleUpperCase()}break;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n.$Bv));}return i}_d.$MO.prototype={$13Y:null,$5dI:!1,$3JV:null,$2B5:null,$Bv:"FolderId",$2zk:!1,get_$5GL:function(){return this.$Bv},set_$5GL:function(n){this.$Bv=n;if(this.$Bv==="PersonaCreationTime"){var t,i;this.$3JV=(i=_y.$Ce.$$(_a.$9I).$7yg(_a.$7.get_$29(),t={val:this.$2B5}),this.$2B5=t.val,i)}this.$2zk=_d.$MO.$7Vh(this.$Bv);return n},get_$42g:function(){return this.$Bv==="PersonaCreationTime"},$Bj:function(){return this.get_$42g()?this.$2B5.$5dR():!0},$5Pa:function(n,t){var i=n;var r=t;var u=$6(r)||$3Wz(this,i)!==$3Wz(this,r);var f=$6vB(this,i);return new _0365m.$cl(f,u)}};_d.$K5=function(n,t,i,r){this.$C=n;this.$1J=t;this.$3h=i;this.$o9=r};_d.$K5.prototype={$C:null,$1J:null,$3h:null,$o9:null,$E:function(n,t){return new _d.$7n(n,t,this.$o9,this.$1J,this.$C)},$bC:function(n,t){throw Error.notImplemented();},$vo:function(n,t){var r=n;var i=this.$E(new _d.$Ha,3);i.$8GS(r);this.$3xr();return i},$3xr:function(){_g.$1U.$MG.$3xr(this.$3h)}};_d.$1AQ=function(n,t,i){this.$$d_$6I3=Function.createDelegate(this,this.$6I3);_d.$1AQ.initializeBase(this,[n]);this.$k=t;this.$dN=i};_d.$1AQ.prototype={$k:null,$dN:null,add_$2YX:function(n){this.$2N("PersonaPickedCompleted",n)},remove_$2YX:function(n){this.$2P("PersonaPickedCompleted",n)},get_$5Cq:function(){return _nbs.NonBootStrings.l_PeoplePickerSearchPersonaList_AT_Text},$SR:function(n){var t=new _d.$HZ(n,_y.$w.$KH,!1,this.$dQ,this.$k,this.$dN,this);$4nN(this,t);t.add_$2YX(this.$$d_$6I3);return t},$6I3:function(n){$Dp(this,"PersonaPickedCompleted",n)}};_d.$Rb=function(n,t,i,r){this.$$d_$69o=Function.createDelegate(this,this.$69o);_d.$Rb.initializeBase(this,[i,null,"NavigationTreeTemplates.GroupItemViewWithoutUnseenCount",r]);this.$C=n;this.$Bu=t;this.$4E=new _d.$8i(n,0,n.get_$L()==="Mouse",n.get_$L()==="TouchNarrow",!0);this.set_$4L(this.$4E.$Sn);this.$4E.$3Nw=!1;this.$4E.$Y("CurrentConfiguration",this.$$d_$69o);var u=this;this.$4E.$Y("IsSidePanelExpanded",function(){u.set_$4L(u.$4E.$Sn)})};_d.$Rb.$7e2=function(n,t,i,r){return n.get_$L()==="Mouse"&&r&&i&&i.$3u("ModernGroups")?new _d.$Rb(n,t,_u.Strings.l_NewString_LowerCase_Text,r):null};_d.$Rb.prototype={$C:null,$4E:null,$Bu:null,$6AI:function(){_y.$J1.prototype.$6AI.call(this);this.$C.get_$L()==="Mouse"&&this.$4E.$5j()},$6AJ:function(){_y.$J1.prototype.$6AJ.call(this);this.$C.get_$L()==="Mouse"&&this.$4E.$5j();this.$4E.set_$dh(null)},$9Ce:function(n){if(n){this.$Bu.$aq(_a.$A5.$qd(2));this.$Gp&&this.$Gp.$1Hh(null)}},$4Kj:function(n,t){_y.$J1.prototype.$4Kj.call(this,n,t);if(this.$Gp.get_$oS()){this.$Bu.$aq(_a.$A5.$2v8(this.$Gp.get_$oS().get_$7T(),2));this.$4E.set_$dh(null)}},$255:function(){_y.$J1.prototype.$255.call(this);this.$4E.set_$rW(this.$2S)},$69o:function(n,t){this.$9Ce(this.$4E.$AI)}};_d.$1AR=function(n,t,i,r){this.$$d_$6I3=Function.createDelegate(this,this.$6I3);_d.$1AR.initializeBase(this,[n,t,i]);this.$dN=r};_d.$1AR.prototype={$dN:null,add_$2YX:function(n){this.$2N("PersonaPickedCompleted",n)},remove_$2YX:function(n){this.$2P("PersonaPickedCompleted",n)},get_$5Cq:function(){return _nbs.NonBootStrings.l_PeoplePickerPersonaList_AT_Text},get_$9UR:function(){return 41},$SR:function(n){var t=this.$5C.$7e6(n,this.$2YS,!1,this.$dQ,this.$dN,this);$4nO(this,t);t.add_$2YX(this.$$d_$6I3);return t},$6I3:function(n){$Dp(this,"PersonaPickedCompleted",n)}};_d.$HZ=function(n,t,i,r,u,f,e){this.$$d_$6Az=Function.createDelegate(this,this.$6Az);this.$$d_$4JT=Function.createDelegate(this,this.$4JT);this.$$d_$99P=Function.createDelegate(this,this.$99P);this.$$d_$9Ot=Function.createDelegate(this,this.$9Ot);_d.$HZ.initializeBase(this,[n,t,i,r]);this.$k=u;this.$dN=f;this.$4NM=e;if(this.$C.get_$L()!=="TouchNarrow"){this.set_$1BT(!0);this.set_$Vh(new _C(this.$$d_$9Ot,_d.$HZ.$A))}};function $3X0(n){n.$9VU();var t=n.get_$1t6().$1C;if(t.get_$B()<2){n.get_$1t6().set_$1O(!1);t.$1r();n.$4JT(n.get_$1s().get_$1l())}else n.get_$1t6().set_$1O(!0)}_d.$HZ.prototype={$k:null,$dN:null,$4NM:null,$3pA:null,$3cU:null,get_$43d:function(){return this.$C.get_$L()==="TouchNarrow"},get_$7O5:function(){return String.format(_nbs.NonBootStrings.l_PeoplePickerAddContactButton_AT_Text,this.$GQ)},get_$7NZ:function(){this.$3cU||(this.$3cU=new _C(this.$$d_$99P,_a.$0.$dO));return this.$3cU},add_$2YX:function(n){this.$2N("PersonaPickedCompleted",n)},remove_$2YX:function(n){this.$2P("PersonaPickedCompleted",n)},get_$1t6:function(){this.$3pA||(this.$3pA=new _0365m.$2b([]));return this.$3pA},$9VU:function(){if(this.get_$1s().get_$66()){var i=this.get_$1s().get_$66().length;var n=[];this.get_$1t6().$1C.$1r();for(var t=0;t<i;t++)if(this.get_$1s().get_$66()[t]){var r=new(_a.$CF.$$(_g.$1l))(this.get_$1s().get_$66()[t],this.$$d_$4JT);Array.add(n,new _0365m.$m(this.get_$1s().get_$66()[t].Name,null,new _C(r.$$d_$A3h,_d.$HZ.$A)));Array.add(n,new _0365m.$9y)}n.length>0&&Array.removeAt(n,n.length-1);this.get_$1t6().$1C.$69(n)}},$4JT:function(n){var t=new _pc.$i;t.$QR(this.get_$1s().$OH());t.set_$1l($3bI(this,n));$Dp(this,"PersonaPickedCompleted",t)},$99P:function(){if(this.$4NM.get_$22()===this.get_$1s()&&this.$dN.get_$D3().$7R&&this.$dN.get_$D3().$7R.$14.get_$BB()===3){this.set_$1s(this.$dN.get_$D3().$7R.$14);this.$4NM.$292(this)}if(this.get_$1s().get_$1F()!==1||this.get_$1s().get_$BB()===3||_js.$9.$a(this.get_$1s().get_$qc()))$3X0(this);else{var n=null;this.get_$1s().get_$6G()?n=_pc.$Jj.$5Fi(this.get_$1s().get_$6G(),this.get_$1s().get_$qc()):this.get_$1s().get_$1l()&&this.get_$1s().get_$1l().EmailAddress&&_a.$3t.$Xv(this.get_$1s().get_$1l().EmailAddress)&&(n=_pc.$Jj.$5Fh(this.get_$1s().get_$1l()));if(n){n.add_$2m(this.$$d_$6Az);n.$F1=0;this.$k.$z(n)}else $3X0(this)}},$6Az:function(n){var t=n;t.$1f||this.set_$1s(t.$14);$3X0(this)},$9Ot:function(){this.$4JT(this.get_$1s().get_$1l())}};_d.$rR=function(){this.$2Hr="";_d.$rR.initializeBase(this)};_d.$rR.prototype={$1Tb:0,get_$1k6:function(){return this.$1Tb},set_$1k6:function(n){if(this.$1Tb!==n){this.$1Tb=n;$3(this,"SelectedPeopleSearchRefiner")}return n},get_$5Fv:function(){return this.$2Hr},set_$5Fv:function(n){if(this.$2Hr!==n){this.$2Hr=n;$3(this,"CurrentFolderRefinerDisplayName")}return n},$9iX:function(n,t){!n||n.get_$312()||n.get_$1OE()?this.set_$5Fv(""):this.set_$5Fv(String.format(_nbs.NonBootStrings.l_PeopleCurrentFolderContainer_Text,t.get_$1o()))}};_d.$Rd=function(n,t){this.$$d_$9F7=Function.createDelegate(this,this.$9F7);this.$kE=-1;_d.$Rd.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$Rd.initializeBase(this);this.$C=n;this.$Uv=new _js.$Z;this.$4NH=t};function $4nE(n){for(var t=0;t<n.$Uv.get_$B()&&n.$28L;t++)if(n.$28L===n.$Uv.get_$3q(t)){n.set_$1D8(!1);n.$6e=n.$28L;n.set_$HX(t);break}}function $6vG(n,t){n.$6e=t;n.$6e.set_$rR(!0)}_d.$Rd.prototype={$12v:null,$2S:!1,$40O:!1,$1Oi:!1,$2Q9:!1,$1Qt:0,$C:null,$4NG:null,$Uv:null,$6e:null,$2s:null,$28L:null,$4NH:null,get_$5IR:function(){return!!this.$6e&&this.$6e.get_$rR()},get_$1yr:function(){return this.$40O},set_$1yr:function(n){if(this.$40O!==n){this.$40O=n;$N(this,"IsSuggestionPopulationInProgress");this.set_$31n(!n)}return n},get_$1D8:function(){return this.$1Oi},set_$1D8:function(n){if(this.$1Oi!==n){this.$1Oi=n;$N(this,"IsModuleLinkSelected")}return n},get_$31n:function(){return this.$2Q9},set_$31n:function(n){if(this.$2Q9!==n){this.$2Q9=n;$N(this,"IsPeopleModuleSuggestionVisible");if(this.$1Oi&&!n){this.set_$1D8(!1);this.set_$HX(-1)}}return n},get_$HX:function(){return this.$kE},set_$HX:function(n){if(this.$kE!==n){this.$kE=n;$N(this,"ItemHighlightedIndex");this.$kE>=0&&this.$kE<this.$Uv.get_$B()&&$6vG(this,this.$Uv.get_$3q(this.$kE))}return n},get_$3T:function(){return this.$Uv},get_$4GK:function(){return-1},set_$4GK:function(n){return n},get_$Ac:function(){return this.$2s},set_$Ac:function(n){this.$2s=n;return n},get_$22:function(){return this.$28L},set_$22:function(n){if(this.$28L!==n){this.$28L=n;$N(this,"SelectedItem");$4nE(this)}return n},get_$3Tk:function(){return this.$4NG},set_$3Tk:function(n){if(this.$4NG!==n){this.$4NG=n;$4nE(this)}return n},$5B1:function(){this.$6e=null;this.$12v=null;this.$Uv.$1r();this.set_$HX(-1);this.set_$1yr(!1);this.set_$31n(!1);this.set_$1D8(!1);this.$2S=!1},$wK:function(){if(!_js.$9.$a(this.$2s)&&this.$2S)if(this.$2s.trim().length>=4&&this.$Uv.get_$B()<5){this.$12v=_pc.$14.$1LN(this.$2s,_g.$2X.$Bi("directory"),null,_pc.$14.$vp(0,5),null,null,_pc.$14.$mA,4);this.$12v.add_$2m(this.$$d_$9F7);OwaApplication.$1W.$z(this.$12v)}else this.set_$1yr(!1)},$4Tl:function(n){this.$6e&&this.$6e.set_$rR(!1);var t=1;(n||this.$2Q9)&&(t=0);this.$1Oi&&this.set_$1D8(!1);this.$kE<this.$Uv.get_$B()-t&&this.set_$HX(this.$kE+1);this.$kE===this.$Uv.get_$B()&&this.$2Q9&&this.set_$1D8(!0);return this.$kE<this.$Uv.get_$B()||this.$1Oi},$4Tr:function(n){this.$6e&&this.$6e.set_$rR(!1);var t=n?1:0;this.$1Oi&&this.set_$1D8(!1);this.$kE>=t&&this.set_$HX(this.$kE-1);return this.$kE>=0},$2d8:function(){var n=this.$2s.trim().length;this.$Uv.$1r();this.set_$HX(-1);if(this.$C.get_$L()==="Mouse"){this.$2S=!0;var i=[1];var r=_d.$5j.$3tx(this.$2s,5,0,null);var t=this;Array.forEach(r,function(n){var r=t.$4NH.$SR(n,_y.$w.$KH,!1,1);r.$dk(1,i,"");r.set_$DJ(!0);r.$PL.set_$3I5(1);t.$Uv.$D(r)});this.$Uv.get_$B()<5&&n>=this.$1Qt&&n>=4?this.set_$1yr(!0):this.set_$31n(!0)}},$9F7:function(n){n.remove_$2m(this.$$d_$9F7);if(this.$12v===n){if(this.$Uv.get_$B()<5&&$6(n.$1f)){for(var u=n.get_$17M(),o=[1],s=this.$Uv.get_$B(),i=0;i<u.get_$B()&&this.$Uv.get_$B()<5;i++){for(var f=u.get_$3q(i),e=!0,r=0;r<s;r++)if(_pc.$i.$2xD(f,this.$Uv.get_$3q(r).get_$1s())){e=!1;break}if(e){var t=this.$4NH.$SR(f,_y.$w.$KH,!1,1);t.$dk(1,o,"");t.set_$DJ(!0);t.$PL.set_$3I5(1);this.$Uv.$D(t)}}this.$1Oi&&this.set_$HX(this.$Uv.get_$B())}this.set_$1yr(!1)}}};_d.$4z=function(n,t){this.$$d_$9PC=Function.createDelegate(this,this.$9PC);_d.$4z.initializeBase(this);this.$1iJ=-1;this.$2V=n;this.set_$4v(t);this.$1dB=!1};_d.$4z.$A6Z=function(n,t,i){var u="";if(i.get_$18t().length)if(t&&t.get_$B()){for(var e={},a=t.get_$B(),o=0;o<a;o++){var s=t.$7Rg(o);if(s.get_$3t())for(var v=s.get_$3t().length,h=0;h<v;h++){var f=i.get_$1s().$13F(s.get_$3t()[h]);!f||!f.get_$rb()||f.get_$1y()in e||(e[f.get_$1y()]=1)}else return""}for(var y=i.get_$18t().length,c=0;c<y;c++){var l=i.get_$18t()[c].get_$1y();if(!(l in e)){u=l;break}}}else u=i.get_$18t()[0].get_$1y();else{i.get_$1s().get_$3t()||i.get_$1s().set_$3t(new _js.$Z);var r=new _pc.$64;r.set_$rb(!0);r.set_$1o("Outlook");r.set_$1y(i.get_$1s().get_$3t().get_$B().toString());r.set_$q(!1);u=r.get_$1y();i.set_$7NY(r.get_$1y());i.set_$18t([r]);i.get_$1s().get_$3t().$D(r)}return u};function $3X2(n){n.get_$pJ().$1C.$1r();n.get_$pJ().$1C.$69(n.get_$PC())}function $6vK(n,t){var r=-1;var i=null;if(t in n.get_$1Bj()||t in n.get_$2Ka())if(t===_nbs.NonBootStrings.l_BusinessPhoneNumber_Text||t===_nbs.NonBootStrings.l_HomePhoneNumber_Text||t===_nbs.NonBootStrings.l_MobilePhoneNumber_Text){r=n.get_$1Bj()[t];--n.$1iJ;n.set_$PC($3X3(n,n.get_$PC(),r,n.get_$1Bj()))}else{i=n.get_$PC()[n.$1iJ];r=n.get_$2Ka()[t];i.$Hm.$1C.$68(r);for(var f=0,o=i.$Hm.$1C.get_$B(),u=0;u<o;u++){var e=i.$Hm.$1C.get_$3q(u);e.$2E in n.get_$2Ka()&&(n.get_$2Ka()[e.$2E]=f);f++}i.$Hm.$1C.get_$B()||n.set_$PC($3X3(n,n.get_$PC(),n.$1iJ,n.get_$1Bj()))}}function $3X3(n,t,i,r){for(var o=[],f=0,s=t.length,u=0;u<s;u++)if(t[u]&&u!==i){var e=t[u];e.$2E in r&&(r[e.$2E]=f);o[f]=e;f++}return o}function $6vJ(n,t){if(n.get_$4v()===_nbs.NonBootStrings.l_Phone_Text){$6vK(n,t);return}var i=-1;if(t in n.get_$1Bj()){i=n.get_$1Bj()[t];n.set_$PC($3X3(n,n.get_$PC(),i,n.get_$1Bj()))}}_d.$4z.prototype={$2V:null,$1dB:!1,$1iJ:0,$3qp:null,$3qq:null,$2kQ:null,$2kP:null,$4W4:null,get_$8C1:function(){return this.get_$4v()!==_nbs.NonBootStrings.l_LinkItem_Text},get_$8Bq:function(){return this.$1dB&&this.get_$3T().get_$B()>0},get_$7Ne:function(){return this.$2V.get_$25m().get_$L()==="Mouse"?_d.$3.get_$53X():_d.$3.get_$53W()},get_$7Nd:function(){return this.$2V.get_$25m().get_$L()==="Mouse"?_d.$3.get_$53Y():_d.$3.get_$53W()},get_$7Nc:function(){return this.$2V.get_$25m().get_$L()==="Mouse"?_d.$3.get_$7NI():_d.$3.get_$7NJ()},get_$7Nf:function(){return this.$2V.get_$25m().get_$L()==="Mouse"?_d.$3.get_$53Y():_d.$3.get_$7NH()},get_$9nB:function(){if(!this.$4W4){var n=this;this.$4W4=new _C(this.$$d_$9PC,_d.$4z.$A,this,"CanDisplayAddFieldMenu",function(){return n.get_$7Ug()})}return this.$4W4},get_$7Ug:function(){return this.get_$PC().length>0},get_$pJ:function(){this.$2kQ||(this.$2kQ=new _0365m.$2b(this.get_$PC()));return this.$2kQ},set_$pJ:function(n){this.$2kQ=n;$PB(this,"AddFieldsMenuViewModel","CanDisplayAddFieldMenu","ShowAddFieldMenuCommand");return n},get_$AP:function(){if(this.get_$1x5()){var n=this.get_$3T().get_$3q(0);return n.get_$AP()}return null},get_$1x5:function(){if(this.$2V.get_$61())return!0;if(this.get_$3T().get_$B()!==1||this.$2V.get_$1CX()&&this.$2V.get_$2p7().$2s2)return!1;var n=this.get_$3T().get_$3q(0);return n.get_$1x5()},get_$7NB:function(){return _js.$9.$4R(_nbs.NonBootStrings.l_PersonaAddField_AT_Tooltip_Text,this.get_$4v())},get_$PC:function(){this.$2kP||(this.$2kP=[]);return this.$2kP},set_$PC:function(n){this.$2kP=n;$3X2(this);return n},get_$1Bj:function(){this.$3qp||(this.$3qp={});return this.$3qp},get_$2Ka:function(){this.$3qq||(this.$3qq={});return this.$3qq},$5PZ:function(){var n=this.get_$4v();this.$1dB&&(n+=_nbs.NonBootStrings.l_PersonaCardGroupHeaderGroupLabel_Text);n+=".";return n},$A6a:function(n,t,i){if(this.$2V.get_$61()){_a.$4.$1Ul(t,"profileFields");var r=this;var e=new(_d.$4z.$2YQ.$$(n))(this.$2V,i,t,function(n,t,u){var e=r.$2V.get_$61()===2||r.$2V.get_$61()===3;r.$2V.get_$61()===1&&r.$1dB&&(e=!0);var f=new _d.$2h(r.$2V,t,n.get_$26k(),n.get_$4v(),e);r.$2V.get_$61()===1&&n.get_$26k()==="PersonaAssistantNames"&&f.set_$1Cq(!1);r.$1dB&&n.get_$26k()!=="PersonaTitles"||f.set_$J4(!0);i===_nbs.NonBootStrings.l_Email_Text&&r.$2V.get_$61()===2&&f.set_$J4(!1);r.get_$3T().$D(f);if(!u.get_$A4t()){$6vJ(r,u.get_$A4s());$3X2(r)}});if(e.get_$A4t()){var u=this.get_$PC().length;var o=new _0365m.$m(i,null,new _C(e.$$d_$A4u,_d.$4z.$A));if(this.get_$4v()===_nbs.NonBootStrings.l_Phone_Text&&i!==_nbs.NonBootStrings.l_BusinessPhoneNumber_Text&&i!==_nbs.NonBootStrings.l_HomePhoneNumber_Text&&i!==_nbs.NonBootStrings.l_MobilePhoneNumber_Text){var f=null;if(this.$1iJ===-1){var s=[];f=new _0365m.$Gv(_nbs.NonBootStrings.l_OtherPhoneNumber_Text,null,new _0365m.$2b(s));this.get_$PC()[u]=f;this.$1iJ=u;this.get_$1Bj()[_nbs.NonBootStrings.l_OtherPhoneNumber_Text]=u}else f=this.get_$PC()[this.$1iJ];this.get_$2Ka()[i]=f.$Hm.$1C.get_$B();f.$Hm.$1C.$D(o)}else{this.get_$PC()[u]=o;this.get_$1Bj()[i]=u}$3X2(this)}}},$6dm:function(){$45(this,"IsClickable","ClickCommand")},$7Ng:function(){this.get_$PC().length>0&&this.get_$PC()[0].$Pn.$n()},$5Fe:function(n){throw Error.notImplemented();},$9PC:function(){if(this.get_$PC().length>0)if(this.get_$4v()===_nbs.NonBootStrings.l_Phone_Text)if(this.get_$PC().length===1)if(this.get_$PC()[0].$2E===_nbs.NonBootStrings.l_OtherPhoneNumber_Text){var n=this.get_$PC()[0];if(n.$Hm.$1C.get_$B()===1){this.get_$pJ().set_$1O(!1);this.get_$pJ().$1C.$1r();n.$Hm.$1C.get_$3q(0).$Pn.$n();$3(this,"CanDisplayAddFieldMenu")}else this.get_$pJ().set_$1O(!0)}else{this.get_$pJ().set_$1O(!1);this.get_$pJ().$1C.$1r();this.get_$PC()[0].$Pn.$n();$3(this,"CanDisplayAddFieldMenu")}else this.get_$pJ().set_$1O(!0);else if(this.get_$PC().length>1)this.get_$pJ().set_$1O(!0);else{this.get_$pJ().set_$1O(!1);this.get_$pJ().$1C.$1r();this.get_$PC()[0].$Pn.$n();$3(this,"CanDisplayAddFieldMenu")}}};_d.$4z.$2YQ=function(n,t,i,r){this.$$d_$A4u=Function.createDelegate(this,this.$A4u);this.$2V=n;this.$5Ts=t;this.$6Ks=i;this.$548=r};_d.$4z.$2YQ.$$=function(n){var t="$2YQ"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d.$4z[t]){var r=_d.$4z[t]=function(){(this.$$gta=this.$$gta||{})["_d.$4z.$2YQ"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$4z.$2YQ.apply(this,i)};r.registerClass("_d.PersonaCardProfileFieldsGroupListViewModel."+t);var u=_d.$4z.$2YQ.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d.$4z[t]};_d.$4z.$2YQ.prototype={$2V:null,$6Ks:null,$548:null,$5Ts:null,get_$9k:function(){return this.$2V},get_$A4s:function(){return this.$5Ts},get_$2ZF:function(){return this.$6Ks},get_$7O8:function(){return this.$548},get_$A4t:function(){for(var t=this.get_$2ZF().length,n=0;n<t;n++){var i=_d.$4z.$A6Z(this.$$gta["_d.$4z.$2YQ"].T,this.get_$2ZF()[n].get_$A4n(),this.get_$9k());if(!_js.$9.$a(i))return!0}return!1},$A4u:function(){var i=null;var r=!1;var t=0;var f=this.get_$2ZF().length;for(t=0;t<f;t++){var n=this.get_$2ZF()[t];r||n.get_$26k()!=="PersonaTitles"||(r=!0);var u=_d.$4z.$A6Z(this.$$gta["_d.$4z.$2YQ"].T,n.get_$A4n(),this.get_$9k());if(!_js.$9.$a(u)){this.get_$9k().set_$40G(!1);if(!n.get_$A4n()){var e=n.$A4o(this.get_$9k().get_$1s());n.set_$A4n(e)}i=n.$A4q(n.$A4p(),[u]);if(i)this.get_$7O8()(this.get_$2ZF()[t],i,this);else throw Error.invalidOperation("Trying to add field when no new field can be added");if(!r)break}}}};_d.$1K=function(n,t){this.$$d_$84s=Function.createDelegate(this,this.$84s);this.$$d_$7lF=Function.createDelegate(this,this.$7lF);this.$$d_$9F6=Function.createDelegate(this,this.$9F6);_d.$1K.initializeBase(this,[n]);this.$2u2=t;this.$vb()};_d.$1K.$1pB=function(n,t){if(!n)return t;var i=n.$1Jx();i&&(t=t.concat.apply(t,i));return t};_d.$1K.$A6g=function(n,t,i,r,u){if(!r.get_$1s().$A6V(n,t,u)){var f=_d.$4z.$A6Z(n,t,r);t||(t=new(_pc.$1E.$$(n)));t.$D(i,f);u.val=t.$7Rg(0)}return t};_d.$1K.$A6h=function(n,t,i){if(!t)return null;for(var u=new(_pc.$1E.$$(n)),e=t.get_$B(),f=0;f<e;++f){var r=t.$7Rg(f);_d.$2h.$14P(r.get_$1g())||(i?u.$53w(r.get_$1g(),r.get_$3t()):u.$A58(r.get_$1g(),r.get_$3t()))}return u.get_$B()?u:null};_d.$1K.$6Uf=function(n){var t=n.get_$1s().get_$3t();var r=[];var u=0;if(t)for(var e=t.get_$B(),i=0;i<e;i++){var f=t.get_$3q(i);if(f.get_$rb()){r[u]=f;u++}}n.set_$18t(r)};_d.$1K.$A6i=function(n,t){if(!t)return!1;var r=t.length;if(!r)return!1;for(var u=new(_pc.$1E.$$(n)),i=0;i<r;i++)u.$A57(t[i].get_$A4n());return _d.$1K.$A6j(n,u)};_d.$1K.$A6j=function(n,t){if(!t)return!1;for(var f={},e=t.get_$B(),i=0;i<e;i++)for(var o=t.$7Rg(i).get_$3t(),s=o.length,r=0;r<s;r++)f[o[r]]=!0;for(var h=_0365f.$58.$B(f),u=0;u<e;u++){var c=t.$7Rg(u);if(c.get_$3t().length!==h)return!0}return!1};function $6vY(n,t,i){if(!t.$AO||!t.$AO.get_$1g())return!1;if(_g.$2L.$Xr(t.$AO.get_$1g())){i?t.remove_$11i(n.$$d_$7lF):t.add_$11i(n.$$d_$7lF);return!0}if(_g.$LA.$1yJ(t.$AO.get_$1g())&&n.$2GE){i?t.remove_$11i(n.$$d_$9Ud):t.add_$11i(n.$$d_$9Ud);return!0}if(t.$MF==="PersonaPersonalHomePages"||t.$MF==="PersonaBusinessHomePages"){var r=t.$AO.get_$3t()[0];var u=n.$2V.get_$1s().$13F(r);(t.get_$5ci()||r===_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text||u.get_$1o()==="Facebook"||u.get_$1o()==="LinkedIn")&&(i?t.remove_$11i(n.$$d_$A2o):t.add_$11i(n.$$d_$A2o));return!0}t.$MF==="PersonaImAddresses"&&(i?t.remove_$11i(n.$$d_$84s):n.$2V.get_$1wG()||i||t.add_$11i(n.$$d_$84s));return!1}function $6vP(n){if(n.$2V.get_$61()){var t=n.$2V.get_$1s();var i;var f,e;var l=(e=_d.$1K.$A6g(String,t.get_$1NF(),"",n.$2V,f={val:i}),i=f.val,e);t.get_$1NF()||t.set_$1NF(l);n.$2Ko=new _d.$2h(n.$2V,i,"PersonaGivenNames",_nbs.NonBootStrings.l_GivenName_Text,!0);var r;var o,s;var a=(s=_d.$1K.$A6g(String,t.get_$1Qs(),"",n.$2V,o={val:r}),r=o.val,s);t.get_$1Qs()||t.set_$1Qs(a);n.$2Vu=new _d.$2h(n.$2V,r,"PersonaMiddleNames",_nbs.NonBootStrings.l_MiddleName_Text,!0);var u;var h,c;var v=(c=_d.$1K.$A6g(String,t.get_$1I8(),"",n.$2V,h={val:u}),u=h.val,c);t.get_$1I8()||t.set_$1I8(v);n.$2Qu=new _d.$2h(n.$2V,u,"PersonaSurnames",_nbs.NonBootStrings.l_Surname_Text,!0);$PB(n,"FirstName","MiddleName","LastName")}}function $6va(n){var t=null;if(n.$2V.get_$61()){t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_YOMI_Text);n.$OF[n.$OF.length]=t}var i=n.$2V.get_$1s();n.$A6m(String,t,[new _d.$Gn(_nbs.NonBootStrings.l_Company_Text,"PersonaYomiCompanyNames",i.get_$2g5())],_nbs.NonBootStrings.l_Company_Text,!1);n.$A6m(String,t,[new _d.$Gn(_nbs.NonBootStrings.l_Surname_Text,"PersonaYomiLastNames",i.get_$1n7())],_nbs.NonBootStrings.l_Surname_Text,!1);n.$A6m(String,t,[new _d.$Gn(_nbs.NonBootStrings.l_GivenName_Text,"PersonaYomiFirstNames",i.get_$1n5())],_nbs.NonBootStrings.l_GivenName_Text,!1)}function $6vL(n){var t=null;var f=n.$2V.get_$61();var r;if(f){t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_Email_Text);n.$OF[n.$OF.length]=t;r=""}else r=String.format(_nbs.NonBootStrings.l_SendActionTitle_Text,_nbs.NonBootStrings.l_Email_Text);var i=[];if(f){var u=n.$2V.get_$1s();i=[new _d.$kr(_nbs.NonBootStrings.l_Email_ProfileField_Text,"PersonaEmails1",u.get_$U0(),n.$2V),new _d.$kr(_nbs.NonBootStrings.l_Email2_Text,"PersonaEmails2",u.get_$12g(),n.$2V),new _d.$kr(_nbs.NonBootStrings.l_Email3_Text,"PersonaEmails3",u.get_$12h(),n.$2V)]}else{var e=$6vd(n);i[i.length]=new _d.$kr(n.$2V.get_$1CX()?_nbs.NonBootStrings.l_Email_Text:r,"PersonaEmailAddress",e,n.$2V)}n.$A6m(_g.$1l,t,i,_nbs.NonBootStrings.l_Email_Text,!0);n.$2V.get_$61()===2&&t.$7Ng()}function $6vd(n){var i=n.$2V.get_$1s();var t=new(_pc.$1E.$$(_g.$1l));n.$A6n(_g.$1l,i.get_$U0(),t);n.$A6n(_g.$1l,i.get_$12g(),t);n.$A6n(_g.$1l,i.get_$12h(),t);return t}function $3X4(n,t,i){var r=new(_pc.$1E.$$(_g.$3C));n.$A6n(_g.$3C,t,r);n.$A6n(_g.$3C,i,r);return r}function $6vN(n){var t=null;var r=n.$2V.get_$61();var u=n.$2V.get_$1s();if(r){t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_IMAddress_Text);n.$OF[n.$OF.length]=t}var i=_nbs.NonBootStrings.l_IMAddress_Text;r?i=_nbs.NonBootStrings.l_IMAddress_ProfileField_Text:n.$2V.get_$1wG()||(i=String.format(_nbs.NonBootStrings.l_SendActionTitle_Text,_nbs.NonBootStrings.l_IMAddress_Text));var f=[new _d.$Gn(i,"PersonaImAddresses",u.get_$fW())];n.$A6m(String,t,f,_nbs.NonBootStrings.l_IMAddress_Text,!0)}function $6vT(n){var i=null;var t=n.$2V.get_$1s();var r=!n.$2V.get_$61();if(!r){i=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_Phone_Text);n.$OF[n.$OF.length]=i}var u=n.$2GE?_nbs.NonBootStrings.l_CallActionTitle_Text:"{0}";var f=[];if(r){var e=$3X4(n,t.get_$lV(),t.get_$11Q());f[f.length]=new _d.$Ep(String.format(u,_nbs.NonBootStrings.l_BusinessPhoneNumber_Text),"PersonaBusinessPhoneNumbers",e)}else f=[new _d.$Ep(_nbs.NonBootStrings.l_BusinessPhoneNumber_ProfileField_Text,"PersonaBusinessPhoneNumbers",t.get_$lV()),new _d.$Ep(_nbs.NonBootStrings.l_BusinessPhoneNumber2_ProfileField_Text,"PersonaBusinessPhoneNumbers2",t.get_$11Q())];n.$A6m(_g.$3C,i,f,_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,!1);f=[];if(r){var o=$3X4(n,t.get_$qu(),t.get_$13b());f[f.length]=new _d.$Ep(String.format(u,_nbs.NonBootStrings.l_HomePhoneNumber_Text),"PersonaHomePhones",o)}else f=[new _d.$Ep(_nbs.NonBootStrings.l_HomePhoneNumber_ProfileField_Text,"PersonaHomePhones",t.get_$qu()),new _d.$Ep(_nbs.NonBootStrings.l_HomePhoneNumber2_ProfileField_Text,"PersonaHomePhones2",t.get_$13b())];n.$A6m(_g.$3C,i,f,_nbs.NonBootStrings.l_HomePhoneNumber_Text,!1);f=[];if(r){var s=$3X4(n,t.get_$sj(),t.get_$15w());f[f.length]=new _d.$Ep(String.format(u,_nbs.NonBootStrings.l_MobilePhoneNumber_Text),"PersonaMobilePhones",s)}else f=[new _d.$Ep(_nbs.NonBootStrings.l_MobilePhoneNumber_ProfileField_Text,"PersonaMobilePhones",t.get_$sj()),new _d.$Ep(_nbs.NonBootStrings.l_MobilePhoneNumber2_ProfileField_Text,"PersonaCarPhones",t.get_$15w())];n.$A6m(_g.$3C,i,f,_nbs.NonBootStrings.l_MobilePhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_OtherPhoneNumber_Text):_nbs.NonBootStrings.l_OtherPhoneNumber_ProfileField_Text,"PersonaOtherTelephones",t.get_$1GB())],_nbs.NonBootStrings.l_OtherPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text):_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_ProfileField_Text,"PersonaWorkFaxes",t.get_$1J0())],_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text):_nbs.NonBootStrings.l_HomeFaxPhoneNumber_ProfileField_Text,"PersonaHomeFaxes",t.get_$1CY())],_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text):_nbs.NonBootStrings.l_OtherFaxPhoneNumber_ProfileField_Text,"PersonaOtherFaxes",t.get_$1GA())],_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text):_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_ProfileField_Text,"PersonaOrganizationMainPhones",t.get_$1G7())],_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_AssistantPhoneNumber_Text):_nbs.NonBootStrings.l_AssistantPhoneNumber_ProfileField_Text,"PersonaAssistantPhoneNumbers",t.get_$19l())],_nbs.NonBootStrings.l_AssistantPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_CallbackPhoneNumber_Text):_nbs.NonBootStrings.l_CallbackPhoneNumber_ProfileField_Text,"PersonaCallbackPhones",t.get_$1AB())],_nbs.NonBootStrings.l_CallbackPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_PagerPhoneNumber_Text):_nbs.NonBootStrings.l_PagerPhoneNumber_ProfileField_Text,"PersonaPagers",t.get_$1GE())],_nbs.NonBootStrings.l_PagerPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_RadioPhoneNumber_Text):_nbs.NonBootStrings.l_RadioPhoneNumber_ProfileField_Text,"PersonaRadioPhones",t.get_$1Gl())],_nbs.NonBootStrings.l_RadioPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_TelexPhoneNumber_Text):_nbs.NonBootStrings.l_TelexPhoneNumber_ProfileField_Text,"PersonaTelexNumbers",t.get_$1IH())],_nbs.NonBootStrings.l_TelexPhoneNumber_Text,!1);n.$A6m(_g.$3C,i,[new _d.$Ep(r?String.format(u,_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text):_nbs.NonBootStrings.l_TTYTDDPhoneNumber_ProfileField_Text,"PersonaTTYTDDPhoneNumbers",t.get_$1IZ())],_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text,!1)}function $6vU(n){n.$2V.get_$61()?$6vW(n):$6vV(n)}function $6vV(n){var t=n.$2V.get_$1s();n.$A6k(_g.$3M,null,_nbs.NonBootStrings.l_BusinessAddress_Text,"PhysicalAddresses",t.get_$hk(),!1,_d.$1K.$A6j(_g.$3M,t.get_$hk()));n.$A6k(_g.$3M,null,_nbs.NonBootStrings.l_HomeAddress_Text,"PhysicalAddresses",t.get_$ih(),!1,_d.$1K.$A6j(_g.$3M,t.get_$ih()));n.$A6k(_g.$3M,null,_nbs.NonBootStrings.l_OtherAddress_Text,"PhysicalAddresses",t.get_$k8(),!1,_d.$1K.$A6j(_g.$3M,t.get_$k8()))}function $6vW(n){var t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_Address_Text);n.$OF[n.$OF.length]=t;var i=n.$2V.get_$1s();n.$A6m(_g.$3M,t,[new _d.$rW(_nbs.NonBootStrings.l_BusinessAddressSuffix_LowerCase_Text,"PersonaBusinessAddresses",i.get_$hk())],_nbs.NonBootStrings.l_BusinessAddressSuffix_LowerCase_Text,!1);n.$A6m(_g.$3M,t,[new _d.$rW(_nbs.NonBootStrings.l_HomeAddressSuffix_LowerCase_Text,"PersonaHomeAddresses",i.get_$ih())],_nbs.NonBootStrings.l_HomeAddressSuffix_LowerCase_Text,!1);n.$A6m(_g.$3M,t,[new _d.$rW(_nbs.NonBootStrings.l_OtherAddressSuffix_LowerCase_Text,"PersonaOtherAddresses",i.get_$k8())],_nbs.NonBootStrings.l_OtherAddressSuffix_LowerCase_Text,!1)}function $6vS(n){var t=null;var r=n.$2V.get_$1s();var i=!n.$2V.get_$61();if(!i){t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_Other_Text);n.$OF[n.$OF.length]=t}n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_BusinessWebPage_Text:_nbs.NonBootStrings.l_BusinessWebPage_ProfileField_Text,"PersonaBusinessHomePages",n.$4Hf)],_nbs.NonBootStrings.l_BusinessWebPage_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_Schools_Text:_nbs.NonBootStrings.l_Schools_ProfileField_Text,"PersonaSchools",r.get_$2b0())],_nbs.NonBootStrings.l_Schools_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_PersonalWebPage_Text:_nbs.NonBootStrings.l_PersonalWebPage_ProfileField_Text,"PersonaPersonalHomePages",r.get_$1S5())],_nbs.NonBootStrings.l_PersonalWebPage_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_Profession_Text:_nbs.NonBootStrings.l_Profession_ProfileField_Text,"PersonaProfessions",r.get_$1ih())],_nbs.NonBootStrings.l_Profession_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_Spouse_Text:_nbs.NonBootStrings.l_Spouse_ProfileField_Text,"PersonaSpouseNames",r.get_$1l8())],_nbs.NonBootStrings.l_Spouse_Text,!1);i&&n.$A6m(Array,t,[new _d.$1Ai(_nbs.NonBootStrings.l_Children_Text,"PersonaChildren",r.get_$1Xi())],_nbs.NonBootStrings.l_Children_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_Hobbies_Text:_nbs.NonBootStrings.l_Hobbies_ProfileField_Text,"PersonaHobbies",r.get_$1bB())],_nbs.NonBootStrings.l_Hobbies_Text,!1);n.$A6m(_a.$7,t,[new _d.$yv(i?_nbs.NonBootStrings.l_Anniversary_Text:_nbs.NonBootStrings.l_Anniversary_ProfileField_Text,"PersonaWeddingAnniversariesLocal",r.get_$1mq())],_nbs.NonBootStrings.l_Anniversary_Text,!1);n.$A6m(_a.$7,t,[new _d.$yv(i?_nbs.NonBootStrings.l_Birthday_Text:_nbs.NonBootStrings.l_Birthday_ProfileField_Text,"PersonaBirthdaysLocal",r.get_$1Wz())],_nbs.NonBootStrings.l_Birthday_Text,!1);n.$A6m(String,t,[new _d.$Gn(i?_nbs.NonBootStrings.l_LocationInPersonCard_Text:_nbs.NonBootStrings.l_LocationInPersonCard_ProfileField_Text,"PersonaLocations",r.get_$1dl())],_nbs.NonBootStrings.l_LocationInPersonCard_Text,!1)}function $6vO(n){var r=n.$2R5.get_$B();if(r>0&&!n.$2V.get_$61()&&n.$2V.get_$1s().get_$1F()===1){var u=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_LinkItem_Text);n.$OF[n.$OF.length]=u;for(var t=0;t<r;t++){var f=n.$2R5.$7Rg(t);var i=new(_pc.$1E.$$(String));i.$D(f.get_$1g().toString(),f.get_$3t()[0]);n.$A6l(String,u,null,"PersonaBusinessHomePages",i,!0,_d.$1K.$A6j(String,i),!0)}}}function $6vX(n){if(!n.$2V.get_$61()&&n.$2V.get_$1s().get_$1F()===1&&!_js.$9.$a(n.$2V.get_$2js())){var t=n.$2V.get_$1s().$7u8();if(!_js.$9.$a(t)){var u=_js.$9.$4R("{0}/?user={1}",n.$2V.get_$2js(),encodeURIComponent(t));var i=new(_pc.$1E.$$(String));i.$D(u,_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text);var r=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_ProfileSection_Text);n.$OF[n.$OF.length]=r;n.$A6l(String,r,null,"PersonaBusinessHomePages",i,!0,!1,!0)}}}function $6vf(n,t){var e=n.$2V.get_$1s();n.$2R5=new(_pc.$1E.$$(String));n.$4Hf=new(_pc.$1E.$$(String));var i=[];if(t)for(var v=t.get_$B(),o=0;o<v;o++)for(var u=t.$7Rg(o),y=u.get_$3t().length,s=0;s<y;s++)for(var l=e.get_$3t(),p=l.get_$B(),h=0;h<p;++h){var r=l.get_$3q(h);if(r.get_$1y()===u.get_$3t()[s])switch(r.get_$1o()){case"Facebook":case"LinkedIn":n.$2R5.$D(u.get_$1g().toString(),r.get_$1y());i[i.length]=r.get_$1o();break;default:n.$4Hf.$D(u.get_$1g().toString(),r.get_$1y());break}}if(e.$7zA()>0)for(var a=e.$3ub(),w=a.length,c=0;c<w;c++){var f=a[c];if(!Array.contains(i,f.get_$1aS())){n.$2R5.$D(f.get_$1aS(),f.get_$1y());i[i.length]=f.get_$1aS()}}}function $4nJ(n){var t=null;var f=n.$2V.get_$1s();t=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text);n.$OF[n.$OF.length]=t;var i=f.get_$Is();if(i)for(var e=i.get_$B(),s=e===1,h=f.get_$3t(),r=0;r<e;r++){var u=i.$7Rg(r);if(!_js.$9.$18(u.get_$1g().get_$eb().Value)){var o=new _d.$2h(n.$2V,u,"PersonaBodies",n.$2V.get_$61()?_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text:"",s);var c=this;h.$DY(function(n){if(n.get_$1y()===u.get_$3t()[0]){o.set_$1pZ(n.get_$1aS());return!0}else return!1});t.get_$3T().$D(o)}}return t}function $6vR(n){var t=$4nJ(n);var o=n.$2V.get_$1s();var i=o.get_$Is();if(n.$2V.get_$61()&&t)if(i&&t.get_$3T().get_$B()>0){for(var r=new(_pc.$1E.$$(_g.$6L)),s=i.get_$B(),h=o.get_$3t(),u=0;u<s;u++)for(var f=i.$7Rg(u),c=f.get_$3t().length,e=0;e<c;e++){var v=this;h.$DY(function(n){if(n.get_$1y()===f.get_$3t()[e]&&n.get_$1o()==="Outlook"){var t=new _g.$6L;t.set_$3n("Text");t.set_$1g(f.get_$1g().get_$1g());r.$D(t,n.get_$1y());return!0}else return!1})}if(r.get_$B()>0){var l=[new _d.$yt(_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",r)];t.$A6a(_g.$6L,l,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text)}}else{var a=[new _d.$yt(_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",null)];t.$A6a(_g.$6L,a,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text)}}function $6vZ(n){var t=!1;var r=n.$2V.get_$1s();var i=new _d.$4z(n.$2V,_nbs.NonBootStrings.l_Work_Text);i.$1dB=!0;var s=!1;var f=n.$2V.get_$61();if(f!==2){if(!r.get_$3t()||!r.get_$3t().get_$B())return;for(var e=null,v=",",h,c,y=(c=$6ve(n,h={val:e}),e=h.val,c),p=e.length,o=0;o<p;o++){var l=e[o];if(_js.$9.$a(l))s=!0;else{var w=y.get_$3q(l);var u=w.split(v);t=$1nf(n,i,r.get_$ox(),u,"PersonaTitles",_nbs.NonBootStrings.l_JobTitle_Text,!0)||t;t=$1nf(n,i,r.get_$w1(),u,"PersonaDepartments",_nbs.NonBootStrings.l_Department_Text,!0)||t;t=$1nf(n,i,r.get_$vT(),u,"PersonaCompanyNames",_nbs.NonBootStrings.l_Company_Text,!0)||t;t=$1nf(n,i,r.get_$sv(),u,"PersonaOfficeLocations",_nbs.NonBootStrings.l_OfficeLocation_Text,!0)||t;t=$1nf(n,i,r.get_$14r(),u,"PersonaManagers",_nbs.NonBootStrings.l_Manager_Text,!0)||t;t=$1nf(n,i,r.get_$11B(),u,"PersonaAssistantNames",_nbs.NonBootStrings.l_Assistant_Text,!0)||t;var a=i.get_$3T().get_$B();a>0&&i.get_$3T().get_$3q(a-1).set_$1Cq(!1)}}(f===1||f===3)&&s&&(t=$4nI(n,i))}else t=$4nI(n,i);(!f&&t||f)&&(n.$OF[n.$OF.length]=i)}function $6ve(n,t){t.val=[];for(var f=_a.$3n.$$(String).$8A(),i=n.$2V.get_$1s(),s=i.get_$3t().get_$B(),o=0;o<s;++o){var r=i.get_$3t().get_$3q(o);var u=new Sys.StringBuilder;if(!i.$13F(r.get_$1y()).get_$q()){u.append($1ng(n,i.get_$ox(),r.get_$1y()));u.append($1ng(n,i.get_$w1(),r.get_$1y()));u.append($1ng(n,i.get_$vT(),r.get_$1y()));u.append($1ng(n,i.get_$sv(),r.get_$1y()));u.append($1ng(n,i.get_$14r(),r.get_$1y()));u.append($1ng(n,i.get_$11B(),r.get_$1y()));var e=u.toString().toLowerCase();if(f.$Mj(e))f.set_$3q(e,f.get_$3q(e)+","+r.get_$1y());else{f.set_$3q(e,r.get_$1y());t.val[o]=e}}}return f}function $1ng(n,t,i){var u="";var r=t?$4nK(n,t,i):null;r&&r.get_$1g()&&(u=r.get_$1g().toString());return u}function $1nf(n,t,i,r,u,f,e){var l=$6vM(n,t,i,r,u,f,e);var s=n.$2V.get_$61();if(!l&&(s===1||s===3)){for(var h=!1,a=r.length,o=0;o<a;o++){var c=r[o];if(n.$2V.get_$1s().$13F(c).get_$rb()||$6vb(n,i,c)){h=!0;break}}h&&$6vQ(n,t,i,r,u,f,e);return!1}return!0}function $6vb(n,t,i){if(!t)return!1;for(var o=t.get_$B(),r=0;r<o;++r){var f=t.$7Rg(r);if(f)for(var e=f.get_$3t(),s=e.length,u=0;u<s;u++){var h=e[u];if(h===i)return!0}}return!1}function $6vM(n,t,i,r,u,f,e){if(!i||!i.get_$B())return!1;var o=$4nK(n,i,r[0]);if(!o)return!1;var s=new _g.$3J(o.get_$1g().toString());s.Attributions=r;var h=new _d.$2h(n.$2V,new _pc.$tz(s),u,f,e);h.set_$576(r.join(","));t.get_$3T().$D(h);return!0}function $6vQ(n,t,i,r,u,f,e){if(!i){var o=n.$2V.get_$1s();switch(u){case"PersonaTitles":i=o.set_$ox(new(_pc.$1E.$$(String)));break;case"PersonaDepartments":i=o.set_$w1(new(_pc.$1E.$$(String)));break;case"PersonaCompanyNames":i=o.set_$vT(new(_pc.$1E.$$(String)));break;case"PersonaOfficeLocations":i=o.set_$sv(new(_pc.$1E.$$(String)));break;case"PersonaManagers":i=o.set_$14r(new(_pc.$1E.$$(String)));break;case"PersonaAssistantNames":i=o.set_$11B(new(_pc.$1E.$$(String)));break}}i.$A58("",r);var h=i.$7Rg(i.get_$B()-1);var s=new _d.$2h(n.$2V,h,u,f,e);s.set_$576(r.join(","));s.set_$J4(!0);t.get_$3T().$D(s)}function $4nI(n,t){var i=n.$2V.get_$1s();var r=n.$2V.get_$61();var u=[new _d.$Gn(_nbs.NonBootStrings.l_JobTitle_Text,"PersonaTitles",i.get_$ox()),new _d.$Gn(_nbs.NonBootStrings.l_Department_Text,"PersonaDepartments",i.get_$w1()),new _d.$Gn(_nbs.NonBootStrings.l_Company_Text,"PersonaCompanyNames",i.get_$vT()),new _d.$Gn(_nbs.NonBootStrings.l_OfficeLocation_Text,"PersonaOfficeLocations",i.get_$sv()),new _d.$Gn(_nbs.NonBootStrings.l_Manager_Text,"PersonaManagers",i.get_$14r()),new _d.$Gn(_nbs.NonBootStrings.l_Assistant_Text,"PersonaAssistantNames",i.get_$11B())];r===2||r===3?n.$A6m(String,t,u,_nbs.NonBootStrings.l_Work_Text,!1):t.$A6a(String,u,_nbs.NonBootStrings.l_Work_Text);return!0}function $4nK(n,t,i){for(var e=null,s=t.get_$B(),r=0;r<s;++r){var u=t.$7Rg(r);if(u)for(var o=u.get_$3t(),h=o.length,f=0;f<h;f++)if(o[f]===i){e=u;break}}return e}function $6vc(n){var t=n.$2V.get_$1s();switch(n.$2u2){case 0:t.set_$1NF(_d.$1K.$A6h(String,t.get_$1NF(),!0));t.set_$1Qs(_d.$1K.$A6h(String,t.get_$1Qs(),!0));t.set_$1I8(_d.$1K.$A6h(String,t.get_$1I8(),!0));t.set_$U0(_d.$1K.$A6h(_g.$1l,t.get_$U0(),!1));t.set_$12g(_d.$1K.$A6h(_g.$1l,t.get_$12g(),!1));t.set_$12h(_d.$1K.$A6h(_g.$1l,t.get_$12h(),!1));t.set_$lV(_d.$1K.$A6h(_g.$3C,t.get_$lV(),!0));t.set_$11Q(_d.$1K.$A6h(_g.$3C,t.get_$11Q(),!0));t.set_$qu(_d.$1K.$A6h(_g.$3C,t.get_$qu(),!0));t.set_$13b(_d.$1K.$A6h(_g.$3C,t.get_$13b(),!0));t.set_$sj(_d.$1K.$A6h(_g.$3C,t.get_$sj(),!0));t.set_$15w(_d.$1K.$A6h(_g.$3C,t.get_$15w(),!0));t.set_$1GB(_d.$1K.$A6h(_g.$3C,t.get_$1GB(),!0));t.set_$1CY(_d.$1K.$A6h(_g.$3C,t.get_$1CY(),!0));t.set_$1GA(_d.$1K.$A6h(_g.$3C,t.get_$1GA(),!0));t.set_$1G7(_d.$1K.$A6h(_g.$3C,t.get_$1G7(),!0));t.set_$19l(_d.$1K.$A6h(_g.$3C,t.get_$19l(),!0));t.set_$1AB(_d.$1K.$A6h(_g.$3C,t.get_$1AB(),!0));t.set_$1GE(_d.$1K.$A6h(_g.$3C,t.get_$1GE(),!0));t.set_$1Gl(_d.$1K.$A6h(_g.$3C,t.get_$1Gl(),!0));t.set_$1IH(_d.$1K.$A6h(_g.$3C,t.get_$1IH(),!0));t.set_$1IZ(_d.$1K.$A6h(_g.$3C,t.get_$1IZ(),!0));t.set_$1J0(_d.$1K.$A6h(_g.$3C,t.get_$1J0(),!0));t.set_$fW(_d.$1K.$A6h(String,t.get_$fW(),!0));break;case 1:t.set_$2g5(_d.$1K.$A6h(String,t.get_$2g5(),!0));t.set_$1n5(_d.$1K.$A6h(String,t.get_$1n5(),!0));t.set_$1n7(_d.$1K.$A6h(String,t.get_$1n7(),!0));t.set_$ox(_d.$1K.$A6h(String,t.get_$ox(),!0));t.set_$w1(_d.$1K.$A6h(String,t.get_$w1(),!0));t.set_$vT(_d.$1K.$A6h(String,t.get_$vT(),!0));t.set_$sv(_d.$1K.$A6h(String,t.get_$sv(),!0));t.set_$14r(_d.$1K.$A6h(String,t.get_$14r(),!0));t.set_$11B(_d.$1K.$A6h(String,t.get_$11B(),!0));t.set_$1KQ(_d.$1K.$A6h(String,t.get_$1KQ(),!0));t.set_$1S5(_d.$1K.$A6h(String,t.get_$1S5(),!0));t.set_$1ih(_d.$1K.$A6h(String,t.get_$1ih(),!0));t.set_$1l8(_d.$1K.$A6h(String,t.get_$1l8(),!0));t.set_$1Xi(_d.$1K.$A6h(Array,t.get_$1Xi(),!0));t.set_$1bB(_d.$1K.$A6h(String,t.get_$1bB(),!0));t.set_$1mq(_d.$1K.$A6h(_a.$7,t.get_$1mq(),!0));t.set_$1Wz(_d.$1K.$A6h(_a.$7,t.get_$1Wz(),!0));t.set_$1dl(_d.$1K.$A6h(String,t.get_$1dl(),!0));t.set_$2b0(_d.$1K.$A6h(String,t.get_$2b0(),!0));t.set_$hk(_d.$1K.$A6h(_g.$3M,t.get_$hk(),!0));t.set_$ih(_d.$1K.$A6h(_g.$3M,t.get_$ih(),!0));t.set_$k8(_d.$1K.$A6h(_g.$3M,t.get_$k8(),!0));break;case 2:t.set_$Is(_d.$1K.$A6h(_g.$6L,t.get_$Is(),!0));break}}_d.$1K.prototype={$2u2:0,$OF:null,$2R5:null,$4Hf:null,$2Ko:null,$2Vu:null,$2Qu:null,get_$7zq:function(){return this},$vb:function(){this.get_$3T().$1r();this.$OF=[];this.$2V.get_$61()&&_d.$1K.$6Uf(this.$2V);switch(this.$2u2){case 0:$6vP(this);$6vL(this);$6vT(this);$6vN(this);break;case 1:_g.$V.get_$I().get_$31().get_$7Z()==="ja-JP"&&$6va(this);$6vX(this);$6vf(this,this.$2V.get_$1s().get_$1KQ());$6vZ(this);$6vU(this);$6vS(this);$6vO(this);break;case 2:this.$2V.get_$61()?$6vR(this):$4nJ(this);break}this.get_$3T().$69(this.$OF)},$1Jx:function(){var n=[];if(!this.$2u2){n=_d.$1K.$1pB(this.$2Ko,n);n=_d.$1K.$1pB(this.$2Vu,n);n=_d.$1K.$1pB(this.$2Qu,n)}for(var u=this.get_$3T().get_$B(),t=0;t<u;t++)for(var r=this.get_$3T().get_$3q(t),f=r.get_$3T().get_$B(),i=0;i<f;i++)n=_d.$1K.$1pB(r.get_$3T().get_$3q(i),n);return n},$iF:function(){$6vc(this)},$4bT:function(n){return n},$3LO:function(n){return n},$3oA:function(n){var t=n;t&&t.$1Q()},$7rR:function(n){for(var t=n,r=t.$5PZ(),i=0;i<t.get_$3T().get_$B();i++){var u=t.get_$3T().get_$3q(i);r+=u.$5PZ()}return r},$A6k:function(n,t,i,r,u,f,e){return this.$A6l(n,t,i,r,u,f,e,!1)},$A6l:function(n,t,i,r,u,f,e,o){if(!u)return!1;var y=u.get_$B();if(!y)return!1;var w=!this.$2V.get_$61()&&(f||!e);var c=!1;var l=!t;var h=null;var p="";if(!l){h=new Array(0);p=i}for(var a=0;a<y;++a){var v=u.$7Rg(a);if(this.$2V.get_$1s().$88K(v)){var s=new _d.$2h(this.$2V,v,r,p,w,o);if(_g.$3M.isInstanceOfType(v.get_$1g())){if(_js.$9.$18(s.$2A8)&&_js.$9.$18(s.$2A9)&&_js.$9.$18(s.$2AA))continue}else if(_js.$9.$18(s.$HI))continue;c=this.$2V.get_$1CX()?!1:$6vY(this,s,!1);if(l){t=new _d.$4z(this.$2V,i);t.$1dB=s.get_$5fK();t.get_$3T().$D(s);this.$OF[this.$OF.length]=t;c&&t.$6dm()}else Array.add(h,s)}}if(!l&&h.length>0){t.get_$3T().$69(h);c&&t.$6dm()}return!0},$A6m:function(n,t,i,r,u){for(var f=!1,s=_d.$1K.$A6i(n,i),h=i.length,e=0;e<h;e++){var o=i[e];f=this.$A6k(n,t,o.get_$4v(),o.get_$26k(),o.get_$A4n(),u,s)||f}this.$2V.get_$61()&&t&&t.$A6a(n,i,r);return f},$A6n:function(n,t,i){if(t)for(var f=t.get_$B(),r=0;r<f;r++){var u=t.$7Rg(r);i.$53w(u.get_$1g(),u.get_$3t())}},$7lF:function(n){var t=n.$AO.get_$1g();this.$2V.$2oz(t)},$84s:function(n){var t=n.$AO.get_$1g();this.$2V.$3xY(t)},$9F6:function(){if(!this.$2V.get_$61()){var n=this.get_$22();if(n){var t=n.get_$3T().get_$3q(0);_g.$2L.$Xr(t.$AO.get_$1g())&&t.get_$AP().$n()}}}};_d.$2h=function(n,t,i,r,u,f){this.$$d_$9Ea=Function.createDelegate(this,this.$9Ea);this.$$d_$9EZ=Function.createDelegate(this,this.$9EZ);this.$$d_$9MX=Function.createDelegate(this,this.$9MX);this.$$d_$k2=Function.createDelegate(this,this.$k2);this.$2Gr=new(_js.$DG.$$(_d.$2h));_d.$2h.initializeBase(this);this.$2V=n;this.$AO=t;this.$MF=i;this.$7f=r;this.$1pa="";this.$2OI=u;this.$3OA=f;$4nL(this);this.$2V.get_$61()&&this.get_$CK()||this.$2OI?this.set_$1pZ(""):this.set_$1pZ(_d.$2h.$2LJ(this.$AO,this.$2V.get_$1s(),this.$1pa))};_d.$2h.$2LJ=function(n,t,i){var r=null;var u="";var e=null;if(!n||!n.get_$3t()||!n.get_$3t().length)return u;e=new(_a.$3X.$$(String));for(var s=i.split(","),o=0,h=n.get_$3t().length;o<h;++o){r=t.$13F(n.get_$3t()[o]);if(r&&!r.get_$q()&&(_js.$9.$a(i)||_d.$2h.$88L(r.get_$1y(),s))){var f=r.get_$1aS();_js.$9.$18(f)&&(f=_u.Strings.l_Unknown_Text);if(e.$7G(f))continue;_js.$9.$a(u)||(u+=_nbs.NonBootStrings.l_AttributionsSepartor_Text);u+=f;e.$D(f)}}return u};_d.$2h.$14P=function(n){return n?String.isInstanceOfType(n)?_js.$9.$a(n):Array.isInstanceOfType(n)?!n.length:_g.$2L.$Xr(n)?_g.$2L.$1OZ(n)||_js.$9.$a(n.RoutingType)?_js.$9.$a(n.OriginalDisplayName):_js.$9.$a(n.EmailAddress):_g.$LA.$1yJ(n)?_js.$9.$a(n.Number):_g.$3M.isInstanceOfType(n)?_js.$9.$a(n.get_$ZL())&&!n.$4b1().$HQ.$W3():_g.$6L.isInstanceOfType(n)?_js.$9.$a(n.get_$1g()):!1:!0};_d.$2h.get_$4d9=function(){return _a.$10.get_$7Z()in _a.$1d.$2Qh};_d.$2h.$88L=function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];if(f===n)return!0}return!1};function $6vj(n){return _g.$6L.isInstanceOfType(n.$AO.get_$1g())?n.$AO.get_$1g().get_$UN():!1}function $6vk(n){var t=$2Cm(n);var i=$6vi(n);if(_d.$2h.$14P(t)&&_d.$2h.$14P(i))return!1;else if(n.$2V.get_$61()===3)return!0;else if(_d.$2h.$14P(t)!==_d.$2h.$14P(i))return!0;else{if(n.$OA===_g.$3M){var r=t.get_$ZL();var u=i.get_$ZL();return r!==u}if(n.$OA===_g.$1l){var f=_g.$2L.$qe(t);var e=i.EmailAddress;var o=t.Name;var s=i.Name;return f!==e||o!==s}if(n.$OA===_a.$7){var h=t;var c=i;return!h.$4e(c)}return t!==i}}function $6vi(n){if(n.$OA===_a.$7)return n.$1Lr;if(n.$OA===_g.$3M)return n.$26V;if(n.$OA===_g.$1l){var t=new _g.$1l;t.Name=n.$f9;t.RoutingType=n.$AO.get_$1g().RoutingType;_g.$2L.$1OZ(n.$AO.get_$1g())||_js.$9.$a(t.RoutingType)?t.OriginalDisplayName=n.$HI:t.EmailAddress=n.$HI;return n.set_$7lE(t)}if(n.$MF==="PersonaBodies"){n.$Ih&&n.$Ih.$n();return n.$HI}return n.$HI}function $3X5(n,t,i){if(!t&&(!n.$2V.get_$18t()||!n.$2V.get_$18t().length))return null;var r=[];var s={};var u=0;if(t)for(var f=0;f<t.get_$B();++f)if(n.$2V.get_$1s().$2pF(t.$7Rg(f).get_$3t())){r[u]=new _g.$K6(new _g.$1X(n.$MF));r[u].OldValue=t.$7Rg(f).get_$1g();r[u].NewValue=i;for(var e=0;e<t.$7Rg(f).get_$3t().length;e++)s[t.$7Rg(f).get_$3t()[e]]="1";u++}if(!_js.$9.$a(i))for(var o=0;o<n.$2V.get_$18t().length;o++)if(!s[n.$2V.get_$18t()[o].get_$1y()]){r[u]=new _g.$K6(new _g.$1X(n.$MF));r[u].OldValue="";r[u].NewValue=i;break}return r}function $6vg(n){var i=_g.$2L.$qe(n.$12f);var r=n.$AO.get_$1g().EmailAddress;var f=n.$AO.get_$1g().OriginalDisplayName;var e=_g.$2L.$qe(n.$12f);var t=n.$12f.Name;var o=n.$AO.get_$1g().Name;t===r&&(t=i);var u=[];switch(n.$MF){case"PersonaEmails1":u=$3X6(n,r,i,o,t,f,e,"PersonaEmails1","PersonaEmails1OriginalDisplayNames","PersonaEmails1DisplayNames");break;case"PersonaEmails2":u=$3X6(n,r,i,o,t,f,e,"PersonaEmails2","PersonaEmails2OriginalDisplayNames","PersonaEmails2DisplayNames");break;case"PersonaEmails3":u=$3X6(n,r,i,o,t,f,e,"PersonaEmails3","PersonaEmails3OriginalDisplayNames","PersonaEmails3DisplayNames");break}return u}function $3X6(n,t,i,r,u,f,e,o,s,h){var l=[];var c=0;if(n.$2V.get_$61()===3||t!==i){l[c]=new _g.$K6(new _g.$1X(o));l[c].OldValue=t||null;l[c].NewValue=i||null;++c;l[c]=new _g.$K6(new _g.$1X(s));l[c].OldValue=f||null;l[c].NewValue=e||null;++c}if(n.$2V.get_$61()===3||r!==u){l[c]=new _g.$K6(new _g.$1X(h));l[c].OldValue=r||null;l[c].NewValue=u||null}return l}function $4nL(n){var t=$2Cm(n);if(String.isInstanceOfType(t)){n.$HI=t;n.$OA=String}else if(n.$MF==="PersonaBirthdaysLocal"||n.$MF==="PersonaWeddingAnniversariesLocal"){n.$OA=_a.$7;if(!_d.$2h.$14P(t)){n.$1Lr=t;n.$HI=n.$1Lr.get_$3l()!==1604||n.get_$CK()?t.$2Z(1):t.$2Z(8)}}else if(_g.$3M.isInstanceOfType(t)){n.$26V=$6vh(n,t);var i=n.$26V.get_$5hu();n.$2A8=i.length>0?i[0]:null;n.$2A9=i.length>1?i[1]:null;n.$2AA=i.length>2?i[2]:null;n.$OA=_g.$3M}else if(_g.$2L.$Xr(t)){n.$12f=t;$6vl(n);n.$OA=_g.$1l;n.$7lJ=t.OriginalDisplayName}else if(_g.$6L.isInstanceOfType(t)){n.$HI=t.get_$1g();n.$OA=String}}function $2Cm(n){if(_g.$2L.$Xr(n.$AO.get_$1g()))return n.$AO.get_$1g();else if(_g.$LA.$1yJ(n.$AO.get_$1g()))return n.$AO.get_$1g().Number;else if(_g.$3M.isInstanceOfType(n.$AO.get_$1g()))return n.$AO.get_$1g();else if(_g.$6L.isInstanceOfType(n.$AO.get_$1g()))return n.$AO.get_$1g().get_$eb().Value;else if(n.$MF==="PersonaBirthdaysLocal"||n.$MF==="PersonaWeddingAnniversariesLocal"){_d.$2h.$14P(n.$AO.get_$1g())||(n.$5H0=n.$AO.get_$1g());return n.$5H0}else return n.$MF==="PersonaBusinessHomePages"&&n.$3OA?n.$AO.get_$3t()&&n.$AO.get_$3t().length>0?n.$AO.get_$3t()[0]===_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text?n.$AO.get_$1g():n.$2V.get_$1s().$13F(n.$AO.get_$3t()[0]).get_$1aS():"":Array.isInstanceOfType(n.$AO.get_$1g())?n.$AO.get_$1g().join(", "):n.$AO.get_$1g()?n.$AO.get_$1g():""}function $6vh(n,t){var i=_g.$3M.$vn();i.set_$Nf(t.get_$Nf());i.set_$SM(t.get_$SM());i.set_$4S(t.get_$4S());i.set_$Rl(t.get_$Rl());i.set_$Qn(t.get_$Qn());return i}function $6vl(n){n.$HI=null;n.$f9=null;var t=_g.$2L.$qe(n.$12f);if(_js.$9.$18(t)){n.$f9="";n.$HI="";return}switch(n.$2V.get_$61()){case 2:case 3:case 1:n.$f9=_js.$9.$a(n.$12f.Name)?n.$2LQ(n.$12f.EmailAddress):n.$12f.Name;break}n.$HI=t}_d.$2h.prototype={$2V:null,$AO:null,$7f:null,$MF:"FolderId",$3OA:!1,$1mE:null,$1pa:null,$1pY:null,$2OI:!1,$OA:null,$f9:null,$7lJ:null,$HI:null,$2A8:null,$2A9:null,$2AA:null,$1Lr:null,$26V:null,$12f:null,$Kn:null,$4KW:null,$Ih:null,$4JS:null,$4JK:null,$oZ:!1,$5H0:null,add_$11i:function(n){this.$2Gr.$uw(n)},remove_$11i:function(n){this.$2Gr.$za(n)},get_$N4:function(){return _a.UserAgent.getInstance().$8l},get_$UJ:function(){return _a.UserAgent.getInstance().$L2},get_$2t2:function(){return this.$f9},set_$2t2:function(n){this.$f9=n;this.$2V.set_$1wv(!0);return n},get_$7jA:function(){return _nbs.NonBootStrings.l_DisplayAs_Text},get_$CK:function(){return!!this.$2V.get_$61()&&this.$2V.get_$1s().$2pF(this.$AO.get_$3t())&&!$6vj(this)},get_$1x5:function(){return this.$2Gr.get_$2Me()},get_$9nt:function(){return this.$2V.get_$31A()&&this.$2V.get_$1s().get_$66()&&this.$2V.get_$1s().get_$66().length>1&&_g.$2L.$Xr(this.$AO.get_$1g())&&_g.$2L.$4e(this.$AO.get_$1g(),this.$2V.get_$5HS())?!0:!1},get_$J4:function(){return this.$oZ},set_$J4:function(n){if(this.$oZ!==n){this.$oZ=n;$3(this,"SetFocusOnActive")}return n},get_$8Bx:function(){return this.$OA!==_g.$1l},get_$8C2:function(){return this.$OA!==String||this.$3OA||this.$MF==="PersonaBodies"},get_$5ci:function(){return!this.$3OA},get_$5fK:function(){return this.$MF==="PersonaTitles"||this.$MF==="PersonaDepartments"||this.$MF==="PersonaCompanyNames"||this.$MF==="PersonaManagers"||this.$MF==="PersonaOfficeLocations"||this.$MF==="PersonaAssistantNames"},get_$8C0:function(){return this.$OA!==String||this.$MF!=="PersonaBodies"},get_$8Bw:function(){return this.$OA!==_a.$7||!this.get_$CK()},get_$895:function(){return!this.$2V.get_$61()||this.$OA!==_a.$7||this.get_$CK()},get_$87y:function(){return this.$OA===_g.$3M&&this.get_$1Cq()&&!_js.$9.$a(this.$2A8)&&_js.$9.$a(this.$2A9)&&_js.$9.$a(this.$2AA)},get_$880:function(){return this.$OA===_g.$3M&&this.get_$1Cq()&&!_js.$9.$a(this.$2A8)&&!_js.$9.$a(this.$2A9)&&_js.$9.$a(this.$2AA)},get_$87z:function(){return this.$OA===_g.$3M&&this.get_$1Cq()&&!_js.$9.$a(this.$2A8)&&!_js.$9.$a(this.$2A9)&&!_js.$9.$a(this.$2AA)},get_$423:function(){return this.$OA!==_g.$3M},get_$87x:function(){return!this.get_$423()&&this.get_$1Cq()},get_$9sK:function(){return this.$HI},set_$9sK:function(n){this.$HI=n;this.$2V.set_$1wv(!0);return n},get_$7gG:function(){return this.$1Lr},set_$7gG:function(n){this.$1Lr=n;this.$2V.set_$1wv(!0);return n},get_$7lE:function(){return this.$12f},set_$7lE:function(n){this.$12f=n;this.$2V.set_$1wv(!0);return n},get_$1pZ:function(){return this.$1pY},set_$1pZ:function(n){if(this.$1pY!==n){this.$1pY=n;$3(this,"AttributionDisplayString")}return n},get_$576:function(){return this.$1pa},set_$576:function(n){if(this.$1pa!==n){this.$1pa=n;this.get_$1Cq()||this.set_$1pZ(_d.$2h.$2LJ(this.$AO,this.$2V.get_$1s(),n))}return n},get_$82m:function(){return!!this.$2V.get_$1s().get_$Is()&&this.$2V.get_$1s().get_$Is().get_$B()>1},get_$1Cq:function(){return this.$2OI||_js.$9.$a(this.$1pY)},set_$1Cq:function(n){if(this.$2OI!==n){this.$2OI=n;n?this.set_$1pZ(""):this.set_$1pZ(_d.$2h.$2LJ(this.$AO,this.$2V.get_$1s(),this.$1pa))}return n},get_$AP:function(){this.get_$1x5()?this.$Kn||(this.$Kn=new _C(this.$$d_$k2,_d.$2h.$A)):this.$Kn=null;return this.$Kn},get_$9MW:function(){this.$4KW||(this.$4KW=new _C(this.$$d_$9MX,_d.$2h.$A));return this.$4KW},get_$9EY:function(){this.$4JS||(this.$4JS=new _C(this.$$d_$9EZ,_d.$2h.$A));return this.$4JS},get_$9E1:function(){this.$4JK||(this.$4JK=new _C(this.$$d_$9Ea,_d.$2h.$A));return this.$4JK},$5PZ:function(){var n="";if(this.get_$423())n+=_js.$9.$18(this.$7f)?" "+this.$HI:_js.$9.$4R(_nbs.NonBootStrings.l_PersonaCardProfileFieldConcatenationLabel_Text," "+this.$7f,this.$HI);else for(var i=this.$26V.get_$5hu(),u=i.length,t=0;t<u;++t){var r=i[t];_js.$9.$18(r)||(n+=" "+r)}this.get_$1x5()&&(n+=" "+_nbs.NonBootStrings.l_PersonaCardClickableGroup_Link_Text);n+=".";this.get_$1Cq()||(n=_js.$9.$4R(_nbs.NonBootStrings.l_PersonaCardProfileFieldAttributionConcatenationLabel_Text,n,this.$1pY+"."));return n},$1Jx:function(){if(!this.get_$CK()||!$6vk(this))return null;var n="";var t="";if(this.$OA===_a.$7){_d.$2h.$14P(this.$1Lr)||(n=this.$1Lr.$4F().$5QY());_d.$2h.$14P(this.$AO.get_$1g())||(t=$2Cm(this).$4F().$5QY())}else if(this.$OA===_g.$3M){n=this.$26V.get_$5CU();t=this.$AO.get_$1g().get_$5CU()}else if(this.$OA===_g.$1l)return $6vg(this);else if(this.$OA===String&&this.$MF==="PersonaBodies"){n=this.$HI;_js.$9.$a(this.$AO.get_$1g().get_$1g())||(t=$2Cm(this))}else{n=this.$HI;_d.$2h.$14P(this.$AO.get_$1g())||(t=$2Cm(this))}if(this.$MF==="PersonaGivenNames")return $3X5(this,this.$2V.get_$1s().get_$1NF(),n);else if(this.$MF==="PersonaMiddleNames")return $3X5(this,this.$2V.get_$1s().get_$1Qs(),n);else if(this.$MF==="PersonaSurnames")return $3X5(this,this.$2V.get_$1s().get_$1I8(),n);else{var i=new _g.$K6(new _g.$1X(this.$MF));i.OldValue=t;i.NewValue=n;return[i]}},$k2:function(){this.$2Gr.$1Gm(this)},$9MX:function(){this.$2V.set_$1wv(!0)},$9iA:function(n){this.$AO.set_$1g(n);$4nL(this);$3(this,"StringDisplayValue")},$9EZ:function(){if(!this.$1mE){this.$1mE=new _g.$1l;this.$1mE.EmailAddress=this.$HI;this.$1mE.Name=this.$f9}var n=!1;if(_js.$9.$a(this.$HI)){this.set_$2t2("");n=!0}else{var i=this.$AO.get_$1g();if(_js.$9.$a(this.$f9)||this.$f9===this.$2LQ(_g.$2L.$qe(i))||this.$f9===this.$2LQ(this.$1mE.EmailAddress)){var t=this.$2LQ(this.$HI);if(t!==this.$f9){this.set_$2t2(t);n=!0}}}if(n){this.$1mE.EmailAddress=this.$HI;this.$1mE.Name=this.$f9;$3(this,"EmailDisplayAs")}},$9Ea:function(){if(_js.$9.$a(this.$f9)&&!_js.$9.$a(this.$HI)){this.set_$2t2(this.$2LQ(this.$HI));$3(this,"EmailDisplayAs")}},$2LQ:function(n){if(_js.$9.$18(n))return"";if(!this.get_$CK())return n;var t=this.$2V.$fN(_d.$2h.get_$4d9());return _js.$9.$a(t)?_js.$9.$4R("({0})",n):_js.$9.$4R("{0} ({1})",t,n)}};_d.$5W=function(n,t){_d.$5W.initializeBase(this);if(!$6(n)){this.set_$1s(n.$14);this.set_$61(t)}};_d.$5W.prototype={get_$1s:function(){return this.$U(_d.$5W.$1GP)},set_$1s:function(n){this.$K(_d.$5W.$1GP,n);return n},get_$O5:function(){return this.$U(_d.$5W.$3jD)},set_$O5:function(n){this.$K(_d.$5W.$3jD,n);return n},get_$8FY:function(){return this.$U(_d.$5W.$455)},set_$8FY:function(n){this.$K(_d.$5W.$455,n);return n},get_$61:function(){return this.$U(_d.$5W.$15y)},set_$61:function(n){this.$K(_d.$5W.$15y,n);return n},get_$fc:function(){return this.$U(_d.$5W.$40L)},set_$fc:function(n){this.$K(_d.$5W.$40L,n);return n},get_$Bq:function(){return this.$U(_d.$5W.$4Nh)},set_$Bq:function(n){this.$K(_d.$5W.$4Nh,n);return n},get_$mi:function(){return this.$U(_d.$5W.$3zg)},set_$mi:function(n){this.$K(_d.$5W.$3zg,n);return n},get_$28:function(){return this.$U(_d.$5W.$4MG)},set_$28:function(n){this.$K(_d.$5W.$4MG,n);return n},get_$3kk:function(){return this.$U(_d.$5W.$3kl)},set_$3kk:function(n){this.$K(_d.$5W.$3kl,n);return n},get_$241:function(){return!$6(this.get_$1s())&&!$6(this.get_$1s().get_$6G())?[this.get_$1s()]:null},get_$4O6:function(){return null}};_d.$yu=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$C=n;this.$1J=t;this.$k=i;this.$3h=r;this.$34h=u;this.$2Yi=f;this.$jD=e;this.$2Xs=o;this.$1ax=s;this.$1vI=h;this.$5Tl=c;this.$6h=l;this.$243=a;this.$Ba=v;this.$96=y;this.$6f=p};_d.$yu.prototype={$6f:null,$C:null,$1J:null,$k:null,$3h:null,$2Yi:null,$jD:null,$2Xs:null,$1ax:null,$96:null,$Ba:null,$1vI:null,$5Tl:null,$zF:null,$34h:null,$1BM:!1,$6h:null,$243:null};_d.$GG=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_d.$GG.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p])};function $6vt(n,t,i,r,u,f){var e=this;n.$243.$E(function(e){var o=e.$7bf(t,i,r,n.$C,n.$k,n.$1vI,n.$1BM,n.$6f,n.$zF,u);o.$49();f(o)})}function $6vu(n,t,i,r,u){var f=new _d.$HA(t,i,r,n.$C,n.$k,n.$1BM,n.$6f,n.$zF,u);f.$49();return f}function $6vs(n,t,i,r,u){var f=new _d.$Kb(t,i,r,n.$C,n.$k,n.$1vI,n.$5Tl,n.$1BM,n.$6f,n.$zF,u,n.$1J);f.$49();return f}function $6vw(n,t,i,r,u){var f=new _d.$BQ(t,r,i,n.$C,n.$k,n.$3h,n.$jD,n.$1BM,n.$6f,n.$zF,u);f.$49();return f}function $6vv(n,t,i,r,u){var f=new _d.$5D(t,r,i,n.$C,n.$k,n.$3h,n.$1ax,n.$1BM,n.$6f,n.$zF,u,n.$1J);f.$49();return f}function $6vy(n,t,i,r,u){var f=new _d.$2w(t,r,i,n.$C,n.$1J,n.$k,n.$3h,n.$34h,n.$jD,n.$2Xs,n.$1BM,n.$Ba,n.$6f,n.$zF,n.$243,u);f.$49();return f}function $6vx(n,t,i,r,u,f){var e=this;n.$243.$E(function(e){var o=e.$7db(t,r,i,n.$C,n.$k,n.$3h,n.$1ax,n.$1BM,n.$6f,n.$zF,u);o.$49();f(o)})}_d.$GG.prototype={$7bc:function(n,t,i,r,u,f,e){var o=null;switch(n.get_$1F()){case 5:$6vt(this,n,t,u,f,e);break;case 2:o=$6vs(this,n,t,u,f);break;default:o=$6vu(this,n,t,u,f);break}o&&e(o)},$2q0:function(n,t,i,r,u,f){var e=null;switch(n.get_$1F()){case 2:e=$6vv(this,n,t,r,u);break;case 4:e=$6vw(this,n,t,r,u);break;case 5:$6vx(this,n,t,r,u,f);break;default:e=$6vy(this,n,t,r,u);break}e&&f(e)}};_d.$yv=function(n,t,i){_d.$yv.initializeBase(this,[n,t,i])};_d.$yv.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaWeddingAnniversariesLocal":n.set_$1mq(new(_pc.$1E.$$(_a.$7)));return n.get_$1mq();case"PersonaBirthdaysLocal":n.set_$1Wz(new(_pc.$1E.$$(_a.$7)));return n.get_$1Wz();default:throw this.$A4r();}},$A4p:function(){return null}};_d.$kr=function(n,t,i,r){_d.$kr.initializeBase(this,[n,t,i]);this.$2V=r};_d.$kr.prototype={$2V:null,$1a5:null,get_$A4n:function(){if($6(this.$1a5)&&!$6(_d.$rX.prototype.get_$A4n.call(this))){this.$1a5=new(_pc.$1E.$$(_g.$1l));for(var n=0;n<_d.$rX.prototype.get_$A4n.call(this).get_$B();++n)this.$2V.get_$1s().$2pF(_d.$rX.prototype.get_$A4n.call(this).$7Rg(n).get_$3t())?this.$1a5.$53w(_d.$rX.prototype.get_$A4n.call(this).get_$3q(n),_d.$rX.prototype.get_$A4n.call(this).$7Rg(n).get_$3t()):this.$1a5.$A58(_d.$rX.prototype.get_$A4n.call(this).get_$3q(n),_d.$rX.prototype.get_$A4n.call(this).$7Rg(n).get_$3t())}return this.$1a5},set_$A4n:function(n){this.$1a5=null;_d.$rX.prototype.set_$A4n.call(this,n);return n},$A4o:function(n){switch(this.get_$26k()){case"PersonaEmails1":n.set_$U0(new(_pc.$1E.$$(_g.$1l)));return n.get_$U0();case"PersonaEmails2":n.set_$12g(new(_pc.$1E.$$(_g.$1l)));return n.get_$12g();case"PersonaEmails3":n.set_$12h(new(_pc.$1E.$$(_g.$1l)));return n.get_$12h();default:throw this.$A4r();}},$A4q:function(n,t){_d.$rX.prototype.get_$A4n.call(this).$A58(n,t);this.$1a5=null;return _d.$rX.prototype.get_$A4n.call(this).$7Rg(_d.$rX.prototype.get_$A4n.call(this).get_$B()-1)},$A4p:function(){var n=new _g.$1l;n.EmailAddress="";n.RoutingType="SMTP";return n}};_d.$Pi=function(n){this.$$d_$9Of=Function.createDelegate(this,this.$9Of);_d.$Pi.initializeBase(this);this.set_$120("");this.set_$cH(_u.Strings.l_MailSearchError_Text);this.set_$24b(_u.Strings.l_MailSearchNoResults_Text);this.set_$2RM(_u.Strings.l_MailSearchInProgress_Text);this.add_$A6J(this.$$d_$9Of);this.$dQ=n==="Mouse"?1:2};function $4nN(n,t){n.$292(t);$6vz(n,t)}function $6vz(n,t){var i=t.get_$1s();var r="";_js.$9.$a(i.get_$lm())||_js.$9.$a(i.get_$4v())?_js.$9.$a(i.get_$lm())?_js.$9.$a(i.get_$4v())?i.get_$1l()&&!_js.$9.$a(i.get_$1l().EmailAddress)&&i.get_$1l().RoutingType==="SMTP"?r=i.get_$1l().EmailAddress:i.get_$1l()&&!_js.$9.$a(i.get_$1l().OriginalDisplayName)&&i.get_$1l().RoutingType==="EX"&&(r=i.get_$1l().OriginalDisplayName):r=i.get_$4v():r=i.get_$lm():r=String.format(_nbs.NonBootStrings.l_PeopleModulePersonaInformation_Text,i.get_$lm(),i.get_$4v());t.$dk(1,null,r)}_d.$Pi.prototype={$dQ:0,$1rW:null,$2Hq:null,$Zl:null,$4NJ:null,$Ey:!1,get_$1tJ:function(){return this.$Zl},set_$1tJ:function(n){this.$Zl=n;$3(this,"EnterKeyCommand");return n},get_$9US:function(){return this.$4NJ},set_$9US:function(n){this.$4NJ=n;$3(this,"PersonaItemsRenderedCommand");return n},get_$5Cq:function(){return _nbs.NonBootStrings.l_PeopleSearchPersonaList_AT_Text},get_$2FT:function(){return _y.$FS.prototype.get_$2FT.call(this)},set_$2FT:function(n){if(this.get_$2FT()!==n){n===1?this.set_$1Mi(!1):this.set_$1Mi(!0);_y.$FS.prototype.set_$2FT.call(this,n)}return n},get_$1rX:function(){_a.$4.$l(this.$1rW,"PersonaListVM.CurrentDisplayOption");return this.$1rW},set_$1rX:function(n){_a.$4.$l(n,"PersonaListVM.CurrentDisplayOption");this.$1rW=n;return n},get_$1Mi:function(){return this.$Ey},set_$1Mi:function(n){this.$Ey=n;$3(this,"FocusItemOnSelect");return n},get_$6Ho:function(){return this},$4bT:function(n){return _pc.$i.isInstanceOfType(n)?this.$SR(n):n},$3LO:function(n){return _d.$8Z.isInstanceOfType(n)?n.get_$1s():n},$3oA:function(n){var t=n;t&&t.$1Q()},$7rR:function(n){var t=n;var i=t.$GQ;var r=t.$17S;_js.$9.$a(r)||(i+=" "+r);return i},$292:function(n){n.$dk(0,_d.$L9.$5Rs(this.get_$1rX().$2sQ),_u.Strings.l_NameIsUnavailable_Text);this.$2Hq&&(n.$2Yb=this.$2Hq.get_$4aE())},$SR:function(n){var t=new _d.$8Z(n,_y.$w.$KH,!1,this.$dQ);$4nN(this,t);return t},$5Fe:function(n){return n},$9Of:function(n,t){this.set_$1Mi(!0)}};_d.$ed=function(n,t,i){_a.$4.$l(n,"owaShell");_a.$4.$l(t,"offlineBootstrapper");_a.$4.$l(i,"personaViewModelFactory");this.$C=n;this.$BA=t;this.$5C=i};_d.$ed.prototype={$C:null,$BA:null,$5C:null,$7e7:function(){return new _d.$EK(this.$C,this.$BA,this.$5C)},$7e5:function(n){return new _d.$1AR(this.$C,this.$BA,this.$5C,n)}};_d.$EK=function(n,t,i){this.$$d_$9gY=Function.createDelegate(this,this.$9gY);_d.$EK.initializeBase(this,[n,n.get_$L()==="TouchNarrow"?0:1]);_a.$4.$J(t,"offlineBootstrapper");_a.$4.$J(i,"personaViewModelFactory");this.$BA=t;this.$5C=i;this.$2YS=_y.$w.$1ph;this.$5dJ=(this.$2YS&1)==1&&_y.$w.$31C(n.get_$L(),this.$2YS)};_d.$EK.$88q=function(n){var i=n;if(i.get_$2aS()==="ErrorConnectionFailed")return!0;if(!n.$1f)return!1;var t=n.$1f.ErrorCode;return $6(t)?!1:!_g.$7Y.$10J(t)};function $4nO(n,t){n.$292(t);$6w0(n,t,n.$4ND);t.$6ZX()}function $6w0(n,t,i){if(i){t.set_$er(!0);for(var u=i.length,f=new Array(u),r=0;r<u;r++){var e=new(_a.$CF.$$(_d.$8Z))(t,i[r].get_$pG());f[r]=new _0365m.$m(i[r].get_$1P(),null,new _C(e.$$d_$A3h,_d.$EK.$A))}t.set_$1YK(f)}}_d.$EK.prototype={$5dJ:!1,$BA:null,$5C:null,$2YS:0,$dQ:0,$4NE:!1,$4ND:null,$I0:null,$1rW:null,$313:!0,$44T:null,$44U:null,$1iw:null,get_$5Cq:function(){return _nbs.NonBootStrings.l_PeoplePersonaList_AT_Text},get_$9UR:function(){return this.$C.get_$L()==="Mouse"?41:3},get_$341:function(){this.$44T||(this.$44T=this.get_$8Er().$E());return this.$44T},get_$8Ep:function(){return this.get_$341()},get_$8Eq:function(){return this.get_$341()},get_$1rX:function(){_a.$4.$l(this.$1rW,"PersonaPagedListVM.CurrentDisplayOption");return this.$1rW},set_$1rX:function(n){_a.$4.$l(n,"PersonaPagedListVM.CurrentDisplayOption");this.$1rW=n;return n},get_$5GL:function(){return this.get_$UB().$Bv},set_$5GL:function(n){this.get_$UB().set_$5GL(n);return n},get_$UB:function(){this.$I0||(this.$I0=new _d.$MO(this.$5dJ));return this.$I0},get_$40j:function(){return this.$313},set_$40j:function(n){if(this.$313!==n){this.$313=n;$3(this,"IsGroupHeadersEnabled")}return n},get_$3T:function(){return this.$21.$1t},get_$6Hm:function(){return this.$dQ},set_$6Hm:function(n){if(this.$dQ!==n){this.$dQ=n;$3(this,"PersonaControlSize")}return n},get_$8Er:function(){this.$44U||(this.$44U=new _d.$EK.$8Es(this.$C,this.get_$UB()));return this.$44U},$9gY:function(n,t){$3(this,"SelectedItemModelPropertiesChanged")},$SR:function(n){var t=this.$5C.$SR(n,this.$2YS,this.$4NE,this.$dQ);$4nO(this,t);return t},$7ZP:function(n){this.$4NE=n;n?this.set_$6Hm(this.$C.get_$L()==="TouchWide"?3:2):this.set_$6Hm(this.$C.get_$L()==="Mouse"?1:2)},$292:function(n){n.set_$DJ(this.$4NE);n.$dk(0,_d.$L9.$5Rs(this.get_$1rX().$2sQ),_u.Strings.l_NameIsUnavailable_Text);if(this.$21&&_pc.$K4.isInstanceOfType(this.$21)){var t=this.$21.get_$zE();t&&t.$2G&&_pc.$Ra.isInstanceOfType(t.$2G)&&(n.$2Yb=t.$2G.get_$4aE())}},$9Aq:function(){this.$11&&this.$11.$u("PropertiesChanged",this.$$d_$9gY)},$99d:function(){this.$11&&this.$11.$Y("PropertiesChanged",this.$$d_$9gY)},$9Io:function(){if(this.$C.get_$L()==="TouchNarrow"){_a.$6.$1E(null,"NavigateToPeople");_a.$6.endPT("NavigateToPeopleHub_TouchNarrow");_a.$6.$1E(null,"PeoplePicker");_a.$6.endPT("PeoplePicker")}},$1um:function(){if(this.$BA.get_$a9()&&_d.$EK.$88q(this.$21.$xc)){var n=this.$21.get_$zE();if(n.$i0)return _u.Strings.l_OfflinePivotsError_Text;if(n.get_$2Op())return _u.Strings.l_OfflineUnsupportedFolder_Text}return _d.$4Z.prototype.$1um.call(this)}};_d.$EK.$8Es=function(n,t){_a.$4.$J(n,"owaShell");_a.$4.$J(t,"peopleGroupGenerator");this.$C=n;this.$4Mp=t};_d.$EK.$8Es.prototype={$C:null,$4Mp:null,$E:function(){return this.$C.get_$L()==="TouchNarrow"?new _d.$dG(this.$C,this.$4Mp):new _d.$18b(this.$C,this.$4Mp)}};_d.$Ua=function(n,t){_d.$Ua.initializeBase(this,[_d.$Ua.$3tP(n),t]);_a.$4.$J(n,"owaShell");this.$C=n};_d.$Ua.$3tP=function(n){switch(n.get_$L()){case"Mouse":return 50;case"TouchWide":return 40;case"TouchNarrow":return 25;default:throw Error.argumentOutOfRange("this.owaShell.CurrentLayout",n.get_$L());}};_d.$Ua.prototype={$C:null,get_$6Ho:function(){return this},$4bT:function(n){return _pc.$i.isInstanceOfType(n)?this.$SR(n):n},$3LO:function(n){return _d.$8Z.isInstanceOfType(n)?n.get_$1s():n},$3oA:function(n){var t=n;t&&t.$1Q()},$7rR:function(n){var t=n;var i=t.$GQ;var r=t.$17S;_js.$9.$a(r)||(i+=" "+r);return i},$SR:function(n){var t=new _d.$8Z(n,_y.$w.$KH,!1);var i=[1];t.$dk(1,i,"");return t}};_d.$yt=function(n,t,i){_d.$yt.initializeBase(this,[n,t,i])};_d.$yt.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaBodies":n.set_$Is(new(_pc.$1E.$$(_g.$6L)));return n.get_$Is();default:throw this.$A4r();}},$A4p:function(){var n=new _g.$6L;n.set_$1g("");n.set_$3n("Text");return n}};_d.$Ep=function(n,t,i){_d.$Ep.initializeBase(this,[n,t,i])};_d.$Ep.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaBusinessPhoneNumbers":n.set_$lV(new(_pc.$1E.$$(_g.$3C)));return n.get_$lV();case"PersonaBusinessPhoneNumbers2":n.set_$11Q(new(_pc.$1E.$$(_g.$3C)));return n.get_$11Q();case"PersonaHomePhones":n.set_$qu(new(_pc.$1E.$$(_g.$3C)));return n.get_$qu();case"PersonaHomePhones2":n.set_$13b(new(_pc.$1E.$$(_g.$3C)));return n.get_$13b();case"PersonaMobilePhones":n.set_$sj(new(_pc.$1E.$$(_g.$3C)));return n.get_$sj();case"PersonaCarPhones":n.set_$15w(new(_pc.$1E.$$(_g.$3C)));return n.get_$15w();case"PersonaOtherTelephones":n.set_$1GB(new(_pc.$1E.$$(_g.$3C)));return n.get_$1GB();case"PersonaWorkFaxes":n.set_$1J0(new(_pc.$1E.$$(_g.$3C)));return n.get_$1J0();case"PersonaHomeFaxes":n.set_$1CY(new(_pc.$1E.$$(_g.$3C)));return n.get_$1CY();case"PersonaOtherFaxes":n.set_$1GA(new(_pc.$1E.$$(_g.$3C)));return n.get_$1GA();case"PersonaOrganizationMainPhones":n.set_$1G7(new(_pc.$1E.$$(_g.$3C)));return n.get_$1G7();case"PersonaAssistantPhoneNumbers":n.set_$19l(new(_pc.$1E.$$(_g.$3C)));return n.get_$19l();case"PersonaCallbackPhones":n.set_$1AB(new(_pc.$1E.$$(_g.$3C)));return n.get_$1AB();case"PersonaPagers":n.set_$1GE(new(_pc.$1E.$$(_g.$3C)));return n.get_$1GE();case"PersonaRadioPhones":n.set_$1Gl(new(_pc.$1E.$$(_g.$3C)));return n.get_$1Gl();case"PersonaTelexNumbers":n.set_$1IH(new(_pc.$1E.$$(_g.$3C)));return n.get_$1IH();case"PersonaTTYTDDPhoneNumbers":n.set_$1IZ(new(_pc.$1E.$$(_g.$3C)));return n.get_$1IZ();default:throw this.$A4r();}},$A4p:function(){return new _g.$3C("","Mobile")}};_d.$rW=function(n,t,i){_d.$rW.initializeBase(this,[n,t,i])};_d.$rW.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaBusinessAddresses":n.set_$hk(new(_pc.$1E.$$(_g.$3M)));return n.get_$hk();case"PersonaHomeAddresses":n.set_$ih(new(_pc.$1E.$$(_g.$3M)));return n.get_$ih();case"PersonaOtherAddresses":n.set_$k8(new(_pc.$1E.$$(_g.$3M)));return n.get_$k8();default:throw this.$A4r();}},$A4p:function(){var n=new _g.$3M;n.set_$Nf("");return n}};_d.$rX=function(n,t,i){this.$7f=n;this.$Je=t;this.$1pX=i};_d.$rX.$$=function(n){var t="$rX"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$rX"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$rX.apply(this,i)};r.registerClass("_d."+t);var u=_d.$rX.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$rX.prototype={$7f:null,$Je:"FolderId",$1pX:null,get_$4v:function(){return this.$7f},get_$26k:function(){return this.$Je},get_$A4n:function(){return this.$1pX},set_$A4n:function(n){this.$1pX=n;return n},$A4q:function(n,t){this.$1pX.$A58(n,t);return this.$1pX.$7Rg(this.$1pX.get_$B()-1)},$A4r:function(){return Error.invalidOperation(String.format("Property '{0}' is not supported for {1} fields: ",this.$Je,this.$$gta["_d.$rX"].T.getName()))}};_d.$1Ai=function(n,t,i){_d.$1Ai.initializeBase(this,[n,t,i])};_d.$1Ai.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaChildren":n.set_$1Xi(new(_pc.$1E.$$(Array)));return n.get_$1Xi();default:throw this.$A4r();}},$A4p:function(){return new Array(0)}};_d.$Gn=function(n,t,i){_d.$Gn.initializeBase(this,[n,t,i])};_d.$Gn.prototype={$A4o:function(n){switch(this.get_$26k()){case"PersonaYomiCompanyNames":n.set_$2g5(new(_pc.$1E.$$(String)));return n.get_$2g5();case"PersonaYomiLastNames":n.set_$1n7(new(_pc.$1E.$$(String)));return n.get_$1n7();case"PersonaYomiFirstNames":n.set_$1n5(new(_pc.$1E.$$(String)));return n.get_$1n5();case"PersonaImAddresses":n.set_$fW(new(_pc.$1E.$$(String)));return n.get_$fW();case"PersonaBusinessHomePages":n.set_$1KQ(new(_pc.$1E.$$(String)));return n.get_$1KQ();case"PersonaSchools":n.set_$2b0(new(_pc.$1E.$$(String)));return n.get_$2b0();case"PersonaPersonalHomePages":n.set_$1S5(new(_pc.$1E.$$(String)));return n.get_$1S5();case"PersonaProfessions":n.set_$1ih(new(_pc.$1E.$$(String)));return n.get_$1ih();case"PersonaSpouseNames":n.set_$1l8(new(_pc.$1E.$$(String)));return n.get_$1l8();case"PersonaHobbies":n.set_$1bB(new(_pc.$1E.$$(String)));return n.get_$1bB();case"PersonaOfficeLocations":n.set_$sv(new(_pc.$1E.$$(String)));return n.get_$sv();case"PersonaTitles":n.set_$ox(new(_pc.$1E.$$(String)));return n.get_$ox();case"PersonaDepartments":n.set_$w1(new(_pc.$1E.$$(String)));return n.get_$w1();case"PersonaCompanyNames":n.set_$vT(new(_pc.$1E.$$(String)));return n.get_$vT();case"PersonaManagers":n.set_$14r(new(_pc.$1E.$$(String)));return n.get_$14r();case"PersonaAssistantNames":n.set_$11B(new(_pc.$1E.$$(String)));return n.get_$11B();case"PersonaLocations":n.set_$1dl(new(_pc.$1E.$$(String)));return n.get_$1dl();default:throw this.$A4r();}},$A4p:function(){return""}};_d.$8Z=function(n,t,i,r,u,f,e,o,s){_d.$8Z.initializeBase(this,[n,t,i,r,null,u,f,e,o,s]);u||this.set_$3io(new _d.$JZ(f,this,null))};function $4nP(n,t,i,r,u){var f=null;if(!$6(i)&&!$6(r)){for(var e=0,l=r.get_$B();e<l;e++){f=r.$7Rg(e);if(f.get_$1g().toString()===u)break;f=null}for(var h=i.get_$3t(),a=h.length,o=0;o<a;++o)for(var v=h[o],c=f.get_$3t(),y=c.length,s=0;s<y;++s){var p=c[s];if(p===v)return _js.$9.$4R(_nbs.NonBootStrings.l_PersonCard_Title_Text,t.get_$4v(),u)}}return t.get_$4v()}_d.$8Z.prototype={$2Yb:null,get_$1s:function(){return this.$14},set_$1s:function(n){this.set_$3fS(n);this.$Tq&&this.$Tq.$1mU(n);return n},get_$5CS:function(){return this.$PL},get_$2Rz:function(){return this.get_$1s().get_$2w().$4b1()},get_$35e:function(){return this.get_$1s().get_$1o()},get_$20F:function(){return this.get_$1s().get_$2w()},$2pw:function(n,t){return new _d.$um(this.get_$1s(),n,t)},$5SJ:function(){var n=this.get_$1s();if(n.get_$BB()===2)return" ";var f=n.get_$4v();var i=n.get_$2Iw();var r=n.get_$lm();if(_js.$9.$a(f))return _js.$9.$a(i)?_js.$9.$a(r)?" ":r:i;else{var t=null;if(!$6(n.get_$ox()))for(var u=0,e=n.get_$ox().get_$B();u<e;u++){t=n.get_$ox().$7Rg(u);if(t.get_$1g().toString()===n.get_$4v())break;t=null}return _js.$9.$a(i)?_js.$9.$a(r)?f:$4nP(this,n,t,n.get_$vT(),r):$4nP(this,n,t,n.get_$w1(),i)}},$5QN:function(){var t=null;if(this.$2Yb&&this.get_$1s().get_$4aF()&&this.get_$1s().get_$3t())for(var i=0,f=this.get_$1s().get_$4aF().get_$B();i<f;i++){var n=this.get_$1s().get_$4aF().$7Rg(i);if(n.get_$1g()&&n.get_$3t()){for(var r=0,e=n.get_$3t().length;r<e;r++){var u=this.get_$1s().$13F(n.get_$3t()[r]);if(u&&u.get_$1o()===this.$2Yb){t=n.get_$1g();break}}if(!_js.$9.$a(t))break}}if(_js.$9.$a(t)){if(!this.$2Yb)return _y.$w.prototype.$5QN.call(this)}else return t;return null}};_d.$8a=function(n,t,i,r,u,f,e){this.$Fr=-1;_d.$8a.initializeBase(this,[n,t,i,u,f,e,!1,null,r]);$6(n.get_$1l())||this.set_$4TM(n.get_$1l());$6(n.get_$2w())||this.set_$6Rg(n.get_$2w())};function $3X7(n,t,i,r){if(i)for(var u=0;u<i.get_$B();++u)r.$4e(i.get_$3q(u))||t.$D(i.get_$3q(u))}function $4nR(n,t){if($3X8(n,t)){n.set_$Iz(n.$Fr+1);return!0}n.set_$Iz(-1);return!1}function $3X8(n,t){return n.$Fr<t.get_$B()-1&&n.$rS?!0:!1}function $4nQ(n,t){if(n.$Fr===-1&&n.$rS){n.set_$Iz(t.get_$B()-1);return!0}n.set_$Iz(-1);return!1}function $6w1(n){if(n.$Fr>0&&n.$rS){n.set_$Iz(n.$Fr-1);return!0}n.set_$Iz(-1);return!1}_d.$8a.prototype={$ME:null,$gi:null,$17X:null,$4TX:null,$rS:!1,add_$5d2:function(n){this.$Y("IsPersonaDetailsShown",n)},remove_$5d2:function(n){this.$u("IsPersonaDetailsShown",n)},get_$6Hs:function(){return this.$ME},set_$6Hs:function(n){if(this.$ME!==n){this.$ME=n;$3(this,"PersonaEmailAddresses")}return n},get_$9UT:function(){return this.$gi},set_$9UT:function(n){if(this.$gi!==n){this.$gi=n;$3(this,"PersonaPostalAddresses")}return n},get_$82b:function(){return this.get_$3vg()&&!this.get_$1vb()},get_$3vg:function(){return!!this.$ME},get_$Iz:function(){return this.$Fr},set_$Iz:function(n){if(this.$Fr!==n){this.$Fr=n;$3(this,"ResultItemHighlightedIndex")}return n},get_$4TM:function(){return this.$17X},set_$4TM:function(n){if(this.$17X!==n){this.$17X=n;$3(this,"SelectedEmailItem")}return n},get_$6Rg:function(){return this.$4TX},set_$6Rg:function(n){if(this.$4TX!==n){this.$4TX=n;$3(this,"SelectedPostalAddressItem")}return n},get_$32G:function(){return this.$rS},set_$32G:function(n){if(this.$rS!==n){this.$rS=n;$3(this,"IsPersonaDetailsShown")}return n},$6cd:function(){return $6(this.$ME)?$6(this.$gi)?!1:$4nR(this,this.$gi):$4nR(this,this.$ME)},$Zu:function(){return $6(this.$17X)?_y.$w.prototype.$Zu.call(this):$3bI(this,this.$17X)},$7Uk:function(){return $6(this.$ME)?$6(this.$gi)?!1:$3X8(this,this.$gi):$3X8(this,this.$ME)},$9xI:function(){return $6(this.$ME)?$6(this.$gi)?!1:$4nQ(this,this.$gi):$4nQ(this,this.$ME)},$9xJ:function(){return!$6(this.$ME)||!$6(this.$gi)?$6w1(this):!1},$9jI:function(){$6(this.$ME)?$6(this.$gi)||this.$Fr>-1&&this.$Fr<this.$gi.get_$B()&&this.set_$6Rg(this.$gi.get_$3q(this.$Fr)):this.$Fr>-1&&this.$Fr<this.$ME.get_$B()&&this.set_$4TM(this.$ME.get_$3q(this.$Fr))},$6J5:function(){if(!$6(this.$gi))throw Error.invalidOperation("Email Addresses should not be populated when PostallAddresses are already populated!");if(this.get_$1s().get_$66()&&this.$Gr(8)){for(var t=new _js.$Z,n=0;n<this.get_$1s().get_$66().length;++n)this.get_$1s().get_$1l()&&this.get_$1s().get_$66()[n]&&this.get_$1s().get_$1l().EmailAddress!==this.get_$1s().get_$66()[n].EmailAddress&&t.$D(this.get_$1s().get_$66()[n]);if(t.get_$B()>0){this.set_$6Hs(new _js.$Z);this.set_$6Hs(t)}}},$3vf:function(){return!$6(this.$ME)||!$6(this.$gi)?!0:!1},$9VZ:function(){if(!$6(this.$ME))throw Error.invalidOperation("Postal Addresses should not be populated when EmailAddresses are already populated!");if(this.$Gr(8)){var n=new _js.$Z;$3X7(this,n,this.get_$1s().get_$ih(),this.get_$1s().get_$2w());$3X7(this,n,this.get_$1s().get_$hk(),this.get_$1s().get_$2w());$3X7(this,n,this.get_$1s().get_$k8(),this.get_$1s().get_$2w());n.get_$B()>0&&this.set_$9UT(n)}}};_d.$1B3=function(n,t,i){this.$$d_$6DM=Function.createDelegate(this,this.$6DM);_d.$1B3.initializeBase(this,[n,null,i,!0]);_a.$4.$1G(t,"sipUri");this.$14=_h.$41.$3kE(n,t);this.$14.$Y("Presence",this.$$d_$6DM);this.set_$CJ(_y.$Rk.$3u2(this.$14.$MI))};_d.$1B3.prototype={$14:null,$4c:function(){this.$14.$u("Presence",this.$$d_$6DM);this.$14.$1Q();_js.$8.prototype.$4c.call(this)},$6DM:function(n,t){this.set_$CJ(_y.$Rk.$3u2(this.$14.$MI))}};_d.$zL=function(n){_d.$zL.initializeBase(this,[n])};_d.$zL.prototype={get_$5HS:function(){return this.get_$kN().$2r9},get_$31A:function(){return this.get_$kN().$Vz},get_$1wG:function(){return this.get_$kN().get_$1wG()},get_$1CX:function(){return this.get_$kN().get_$1CX()},get_$kN:function(){return this.$2V},$4LF:function(n){this.get_$kN().$4LF(n)},$4NS:function(n){if(this.get_$kN().get_$4NF()){this.get_$kN().get_$4NF().$Tq.$4NS(n);_d.$6t.$fw(11,this.get_$2p7().$9u,this.get_$1s().get_$1F())}},$3xY:function(n){if(this.get_$kN().get_$4NF()){this.get_$kN().get_$4NF().$Tq.$3xY(n);_d.$6t.$fw(12,this.get_$2p7().$9u,this.get_$1s().get_$1F())}},$2oz:function(n){if(this.get_$kN().get_$4NF()){this.get_$kN().get_$4NF().$Tq.$2oz(n);_d.$6t.$fw(10,this.get_$2p7().$9u,this.get_$1s().get_$1F())}}};_d.$rt=function(n){_d.$rt.initializeBase(this,[n])};_d.$rt.prototype={get_$2js:function(){return this.get_$26w().get_$2js()},get_$5Vs:function(){return this.get_$26w().get_$5Vs()},get_$2R3:function(){return this.get_$26w().get_$2R3()},get_$26w:function(){return this.$2V},$fN:function(n){var r=_d.$1Jg.prototype.$fN.call(this,n);if(!_js.$9.$a(r))return r;var u=this.get_$26w().$dP.$2Ko;var h=u?u.$HI:null;var f=this.get_$26w().$dP.$2Vu;var c=f?f.$HI:null;var e=this.get_$26w().$dP.$2Qu;var l=e?e.$HI:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$6u.$3gA(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$V2=function(){this.$3rF=new _d.$MZ([new _h.$Cb("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListFirstName_Text,_nbs.NonBootStrings.l_FolderSortListFirstName_LowerCase_Text);this.$44t=new _d.$MZ([new _h.$Cb("PersonaDisplayNameLastFirst","Ascending")],_nbs.NonBootStrings.l_FolderSortListLastName_Text,_nbs.NonBootStrings.l_FolderSortListLastName_LowerCase_Text);this.$5Bv=new _d.$MZ([new _h.$Cb("PersonaCompanyName","Ascending"),new _h.$Cb("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListCompanyName_Text,_nbs.NonBootStrings.l_FolderSortListCompanyName_LowerCase_Text);this.$5WG=new _d.$MZ([new _h.$Cb("PersonaHomeCity","Ascending"),new _h.$Cb("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListHomeCity_Text,_nbs.NonBootStrings.l_FolderSortListHomeCity_LowerCase_Text);this.$6gh=new _d.$MZ([new _h.$Cb("PersonaWorkCity","Ascending"),new _h.$Cb("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListWorkCity_Text,_nbs.NonBootStrings.l_FolderSortListWorkCity_LowerCase_Text);this.$6Lz=new _d.$MZ([new _h.$Cb("PersonaCreationTime","Descending"),new _h.$Cb("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListRecentlyAdded_Text,_nbs.NonBootStrings.l_FolderSortListRecentlyAdded_LowerCase_Text);_d.$V2.initializeBase(this);this.set_$4v(_d.$V2.$1s5);this.set_$2FT(1);this.get_$3T().$D(this.$3rF);this.get_$3T().$D(this.$44t);this.get_$3T().$D(this.$5Bv);this.get_$3T().$D(this.$5WG);this.get_$3T().$D(this.$6gh);this.get_$3T().$D(this.$6Lz)};_d.$V2.prototype={$A18:function(n){for(var t=0;t<this.get_$3T().get_$B();t++){var i=this.get_$3T().get_$3q(t);i.$V8.length>1&&(i.$V8[1]=n.get_$22().$GX)}},$5Fe:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$MZ=function(n,t,i){_d.$MZ.initializeBase(this);_a.$4.$J(n,"sortByProperties");_a.$4.$7t(n.length,1,2,"sortByProperties");_a.$4.$J(t,"displayName");_a.$4.$J(i,"contextMenuDisplayName");this.$V8=n;this.$7i=t;this.$1Ac=i};_d.$MZ.prototype={$V8:null,$7i:null,$1Ac:null,get_$1o:function(){return this.$7i},toString:function(){return this.$7i}};_d.$32=function(n,t,i,r,u,f,e){this.$$d_$7OD=Function.createDelegate(this,this.$7OD);this.$$d_$7hz=Function.createDelegate(this,this.$7hz);this.$$d_$9Le=Function.createDelegate(this,this.$9Le);this.$$d_$9L5=Function.createDelegate(this,this.$9L5);this.$$d_$4Kk=Function.createDelegate(this,this.$4Kk);this.$$d_$9Nb=Function.createDelegate(this,this.$9Nb);this.$$d_$9Na=Function.createDelegate(this,this.$9Na);this.$1Cf=-1;_d.$32.initializeBase(this,[n,t,i,r,0,u,!1,f]);this.$9l8(e,f)};_d.$32.$2pl=function(n,t){t.val=!1;if(_js.$9.$18(n))return null;var i="";var s="";var l="SMTP";var r=n.indexOf("[");var u=n.lastIndexOf("]");var f=n.indexOf(":");if(r>=0&&u>=0&&f>=0&&f>r&&f<u){s=n.substring(0,r);l=n.substring(r+1,f);i=n.substring(f+1,u).trim();if(_js.$9.$18(i))return null;t.val=!0}else{var a=n.indexOf("<");var v=n.indexOf(">");var y=n.indexOf("(");var p=n.indexOf(")");if(r>=0&&u>=0&&u>r||a>=0&&v>=0&&v>a||y>=0&&p>=0&&p>y){var e=n.match(_d.$32.$2t0);if(e&&e.length>0){if(!_js.$9.$18(e[0])){var c=n.indexOf(e[0]);if(c!==-1){i=e[0];var w=i.replace(_d.$32.$5LP,"\\$1");var b=new RegExp(String.format("\\(\\s*{0}\\s*\\)|\\<\\s*{0}\\s*\\>|\\[\\s*{0}\\s*\\]",w));var h=n.match(b);h&&h.length>0&&!_js.$9.$18(h[0])&&(c=n.indexOf(h[0]));s=n.substring(0,c).trimEnd()}}}else i=n}else i=n;if(_js.$9.$18(i))return null;i=i.trim();t.val=_a.$3t.$Xv(i)}var o=new _g.$1l;o.MailboxType="OneOff";o.RoutingType=l.trim();o.EmailAddress=i;o.Name=_js.$9.$18(s)?i:s.trim();return _pc.$i.$DQ(o)};_d.$32.$6Gs=function(n){for(var f=[],t=0,i=0,u=!1,r=!1;t<n.length;){switch(n.charAt(t)){case"[":r||(u=!0);break;case"]":u&&!r&&(u=!1);break;case";":if(!u&&!r){var e=n.substr(i,t-i);Array.add(f,e);i=t+1}break;case'"':r=r?!1:!0;break;default:break}t++}i<t&&Array.add(f,n.substr(i,n.length-i));return f};_d.$32.$2Ly=function(n){var t=n.$5A.$GQ;_js.$9.$18(t)||(t=t.substr(0,t.length-1));return t};function $199(n){return n.$1Cf!==-1}function $4nh(n){$199(n)?n.$2GJ():$4ni(n)}function $4ng(n,t,i){i&&n.$2r.$6cW(t.get_$1s())}function $6wi(n){var t=n.$2r.get_$Wh();var i=$6wl(n,t);i&&i.$17X&&t.get_$1s().set_$1l(i.$17X);var r=$1Vu(n,t.get_$1s());r.$1HZ=!0;n.$2kX(r,n.$Wu,!0)}function $6wl(n,t){return _d.$8a.isInstanceOfType(t)?t:null}function $2hf(n){n.$2r.set_$Ac("");n.$1Gy()}function $4ni(n){var i=n.$2r.$2s;if(!_js.$9.$18(i)){for(var r=_d.$32.$6Gs(i),t=0,u=r.length;t<u;t++)$2hg(n,r[t]);$2hf(n)}}function $2hg(n,t){var i;var r,u;var f=(u=_d.$32.$2pl(t,r={val:i}),i=r.val,u);if(f){var e=$1Vu(n,f);n.$2kX(e,n.$Wu,i);$4ng(n,e,i)}}function $6wj(n,t,i){var r=$1Vu(n,t);var u=n.$2kX(r,n.$Wu,i);$4ng(n,r,i);$2hf(n);if(!i){n.$18f.$D(u);$199(n)||$4nj(n,u)}}function $4nj(n,t){n.$1Cf=0;n.$6M0=t;n.$26y=_d.$32.$2Ly(t)}function $6wn(n){for(var t=!1,r=n.$1T.get_$B(),i=0;i<r;i++){t=!n.$1T.get_$3q(i).$N7;if(t)break}n.set_$5Za(t)}function $3XG(n){if(!$199(n)){n.$2r.set_$1IK(n.$1IJ);n.set_$1Ui("");n.set_$1Gv(null);return}n.$2r.set_$3gx(!1);var t=n.$18f.get_$3q(n.$1Cf);var i=t.$5A.$GQ;n.$18f.$68(n.$1Cf);if(n.$1Cf<n.$18f.get_$B()){t=n.$18f.get_$3q(n.$1Cf);n.set_$1Ui(_d.$32.$2Ly(t));n.set_$1Gv(t)}else{n.$18f=null;n.$1Cf=-1;n.$2r.$6O2();n.set_$2rw(!1);n.$2r.set_$1IK(n.$1IJ);n.$2r.remove_$13W(n.$$d_$9Nb);n.set_$1Ui("");n.set_$1Gv(null);if(n.$1vX){$Dp(n,"BulkResolveOperationComplete",!0);n.$1vX=!1}}}function $6wk(n,t){for(var i=0,f=n.$1T.get_$B();i<f;i++){var r=n.$1T.get_$3q(i);var u=r.$5A;u.set_$er(!t);u.$1HZ=!t;u.set_$3Mf(!t);t?r.$4QZ():r.$549()}}function $6wm(n,t,i){var r=t;i||(r^=1);return r}_d.$32.prototype={$2eX:null,$tZ:null,$1Nt:!1,$2r:null,$18f:null,$6M0:null,$26y:null,$1M1:!1,$3Nz:!1,$3Sp:!1,$1vX:!1,$1IJ:null,add_$np:function(n){this.$2N("BulkResolveOperationComplete",n)},remove_$np:function(n){this.$2P("BulkResolveOperationComplete",n)},get_$1Gv:function(){return this.$tZ},set_$1Gv:function(n){if(this.$tZ!==n){this.$tZ&&!$199(this)&&this.$2r.remove_$13W(this.$$d_$9Na);this.$tZ=n;this.$tZ&&!$199(this)&&this.$2r.add_$13W(this.$$d_$9Na);$3(this,"RecipientBeingEdited")}return n},get_$mK:function(){return this.$2r},set_$mK:function(n){if(this.$2r!==n){this.$2r=n;$3(this,"FindRecipientViewModel")}return n},get_$5Za:function(){return this.$1Nt},set_$5Za:function(n){if(this.$1Nt!==n){this.$1Nt=n;$3(this,"IsAnyRecipientInvalid")}return n},get_$1Ui:function(){return this.$2eX},set_$1Ui:function(n){if(this.$2eX!==n){this.$2eX=n;$3(this,"TextBeingEdited")}return n},get_$2rw:function(){return this.$1M1},set_$2rw:function(n){if(this.$1M1!==n){this.$1M1=n;$6wk(this,n);$3(this,"DisableActionsOnAllRecipients")}return n},get_$6VS:function(){return this.$3Nz},set_$6VS:function(n){if(this.$3Nz!==n){this.$3Nz=n;$3(this,"ShouldShowHiddenRecipient")}return n},get_$2BW:function(){return this.$3Sp},set_$2BW:function(n){if(this.$3Sp!==n){this.$3Sp=n;$3(this,"UpdateFindControlPopupPosition")}return n},get_$UJ:function(){return _a.UserAgent.getInstance().$L2},$1Bw:function(){$4nh(this)},$9xW:function(){this.$2r&&this.$2r.set_$da(!1)},$1uF:function(){$4nh(this);this.$1vX=!0;if(this.$1Nt){this.$18f=new _js.$Z;this.$2r.set_$9yF(new _js.$Z);for(var t=0,r=this.$1T.get_$B();t<r;t++){var n=this.$1T.get_$3q(t);if(!n.$N7){this.$18f.$D(n);var i=_d.$32.$2Ly(n);this.$2r.$Z9.$D(i);if(!$199(this)){this.$2r.$5iv(i);this.set_$2rw(!0);this.$2r.set_$1IK(null);$4nj(this,n);this.set_$1Ui(i);this.set_$1Gv(n);this.$2r.add_$13W(this.$$d_$9Nb)}}}}else{$Dp(this,"BulkResolveOperationComplete",!0);this.$1vX=!1}},$2a6:function(n){for(var i=[],t=0,f=this.$1T.get_$B();t<f;t++){var u=this.$1T.get_$3q(t).$CA.get_$1l();$6(u.EmailAddress)||u.EmailAddress!==n||Array.add(i,t)}for(var r=i.length-1;r>=0;r--)this.$1T.$68(i[r])},$3sX:function(){for(var t=new(_0365f.$o.$$(String)),n=0,r=this.$1T.get_$B();n<r;n++){var i=this.$1T.get_$3q(n).$CA.get_$1l();$6(i.EmailAddress)||t.$D(i.EmailAddress)}return t.$6Z()},$Au:function(){_y.$2T.prototype.$Au.call(this);this.$2r&&this.$2r.set_$Ac(null)},$2GJ:function(){if($199(this)){this.$1Cf=-1;this.$2r.$6O2();this.set_$2rw(!1);this.$2r.remove_$13W(this.$$d_$9Nb);this.$2r.set_$1IK(this.$1IJ);if(this.$2r.$2s===this.$2eX)this.set_$6VS(!0);else{var n=this.$2r.$2s;_js.$9.$a(n)||$2hg(this,n)}this.set_$1Ui("");this.set_$1Gv(null);this.set_$6VS(!1);if(this.$1vX){$Dp(this,"BulkResolveOperationComplete",!1);this.$1vX=!1}}},$2EF:function(n){return this.$54D(n)},$54D:function(n){var i;var r;var t=!1;if(this.$6VX){var u=n.EmailAddress;var f=n.Name;if(_js.$9.$a(u))if(_js.$9.$a(f))throw Error.argumentNull("Address and Name parameters are set to null in emailAddress");else if(n.RoutingType!=="MAPIPDL"){var e,o;i=(o=_d.$32.$2pl(f,e={val:t}),t=e.val,o)}else{t=!0;i=_pc.$i.$DQ(n)}else{t=_g.$2L.$1OZ(n)?!0:_a.$3t.$Xv(u);i=_pc.$i.$DQ(n)}}else{t=!0;i=_pc.$i.$DQ(n)}r=$1Vu(this,i);this.$2kX(r,this.$Wu,t);this.set_$5Za(!!(this.$1Nt|!t));return r},$4c:function(){this.$2r.remove_$gw(this.$$d_$4Kk);this.$2r.remove_$690(this.$$d_$9L5);this.$2r.remove_$6Hy(this.$$d_$9Le);this.set_$1Gv(null);$199(this)&&this.$2r.remove_$13W(this.$$d_$9Nb);_y.$2T.prototype.$4c.call(this)},$9l8:function(n,t){var i=new _d.$Jf(n,t);this.$1IJ=new _C(this.$$d_$7hz,_d.$32.$A);i.set_$9Zf(new _C(this.$$d_$1Gy,_d.$32.$A));i.set_$1IK(this.$1IJ);i.set_$4a6(new _C(this.$$d_$7OD,_d.$32.$A));i.add_$gw(this.$$d_$4Kk);i.add_$690(this.$$d_$9L5);i.add_$6Hy(this.$$d_$9Le);this.set_$mK(i)},$7hz:function(){var n=this.$1T.get_$B();if(n>0){var t=this.$1T.get_$3q(n-1);$1oI(this,t)}},$4Kk:function(n,t){var i=this.$2r.get_$Wh();if(i){$6wi(this);this.$tZ||$2hf(this)}},$7OD:function(){$199(this)?$2hg(this,this.$2r.$2s):$4ni(this);this.$tZ||$2hf(this)},$9Mw:function(n,t){var i=n;if(i.$1wz){this.$2r.set_$1IK(null);this.set_$1Ui(_d.$32.$2Ly(i));this.set_$1Gv(i)}},$2XR:function(n,t){_y.$2T.prototype.$2XR.call(this,n,t);$6wn(this)},$2kX:function(n,t,i){if(!n)throw Error.argument("personaViewModel");var f=$6wm(this,t,i);var r=this.$3ku(n,f,i);this.$2m6(r,f);if(this.$tZ){var e=this.$1T.$71(this.$tZ);$1oI(this,this.$1T.get_$3q(e));var u=r.$5A;u.set_$er(!this.$1M1);u.$1HZ=!this.$1M1;u.set_$3Mf(!this.$1M1);this.$1M1&&r.$4QZ();this.$1T.$72(e,r);$3XG(this)}else this.$1T.$D(r);this.$1Gy();return r},$9L5:function(n){if(!$6(n)&&n.get_$B()&&!$6(this.$2r.$1VJ)&&this.$2r.$1VJ.get_$B()){this.$18f=new _js.$Z;for(var t=0,i=n.get_$B();t<i;t++)$6wj(this,n.get_$3q(t),this.$2r.$1VJ.get_$3q(t));if(this.$18f.get_$B()>0){this.set_$2rw(!0);this.$2r.set_$1IK(null);this.set_$1Ui(this.$26y);this.set_$1Gv(this.$6M0);this.$2r.add_$13W(this.$$d_$9Nb)}}},$9Le:function(n,t){for(var r=0,f=this.$1T.get_$B();r<f;r++){var i=this.$1T.get_$3q(r);var u=i.$5A.$14;if(i.$N7&&u.get_$BB()===1&&!_js.$9.$18(u.get_$1l().EmailAddress)&&u.get_$1l().EmailAddress.toLowerCase()===n.toLowerCase()){i.$5A.set_$3fS(t);$526(this,i.$5A)}}},$9Na:function(n,t){var r=n;if(!r.$oI){var i=this.$1T.$71(this.$tZ);if(i>=0){var u=this.$2r.$2s;if(_js.$9.$a(u)){$1oI(this,this.$1T.get_$3q(i));$3XG(this)}else $2hg(this,this.$2r.$2s)}}},$9Nb:function(n,t){var r=n;if(!r.$oI){var i=this.$1T.$71(this.$tZ);if(i>=0){var u=this.$2r.$2s;if(_js.$9.$a(u)){$1oI(this,this.$1T.get_$3q(i));$3XG(this)}else this.$2r.$2nj&&this.$2GJ()}}}};_d.$2C=function(n,t,i,r,u,f,e,o){this.$$d_$4Je=Function.createDelegate(this,this.$4Je);this.$$d_$9LV=Function.createDelegate(this,this.$9LV);this.$$d_$54S=Function.createDelegate(this,this.$54S);this.$$d_$9bU=Function.createDelegate(this,this.$9bU);this.$$d_$9x0=Function.createDelegate(this,this.$9x0);this.$$d_$6cZ=Function.createDelegate(this,this.$6cZ);this.$$d_$9G6=Function.createDelegate(this,this.$9G6);this.$$d_$4Ky=Function.createDelegate(this,this.$4Ky);this.$$d_$9gL=Function.createDelegate(this,this.$9gL);this.$$d_$4TG=Function.createDelegate(this,this.$4TG);this.$$d_$9Lh=Function.createDelegate(this,this.$9Lh);this.$3FZ={};this.$Fr=-1;this.$Gg=-1;this.$2SB=8;this.$20U=20;_d.$2C.initializeBase(this,[_y.$v.$v.get_$L()]);this.set_$R8(!0);this.$1tr=this.$1yz?"Email":"Text";this.$2nh=!$6(i)&&i;this.$1W=$6(r)?OwaApplication.$1W:r;this.$5N4=!$6(u)&&u;this.$M=o?o:OwaApplication.get_$XS();this.$3ks=n;this.$1GO=t;this.$5C=f;this.$1J=e};function $6sX(n){$2hB(n);$3WU(n);var t=_a.$6.acss(_a.$0.$XW,"GetPersonasFromCache");var i=_d.$5j.$5Rt(n.$1GO,n.$2s,n.$2SB,0);_a.$6.aces(t);i.length>0&&_d.$6t.$8H8(_js.$9.$18(n.$2s)?-1:n.$2s.length,i.length);t=_a.$6.acss(_a.$0.$XW,"CreatePersonaViewModels");var r=new(_0365f.$o.$$(Object));var u=this;Array.forEach(i,function(t){r.$D(n.$2py(t))});n.$AE.$69(r.get_$3T());_a.$6.aces(t);n.set_$32s(!0);n.$17f=!0;n.$2cR=!1;$6sa(n);t=_a.$6.acss(_a.$0.$XW,"ToggleResultVisible");$3WV(n);_a.$6.aces(t);n.$6OE();$2hA(n);$4le(n);$N(n,"ShouldHideBordersForUseThisLocationButton")}function $6sa(n){n.set_$1jV(n.get_$6Qk());n.$AE.get_$B()===n.$2SB?n.set_$18S(String.format(_nbs.NonBootStrings.l_ResultsDisplayedString_Text,n.$2SB)):n.set_$18S("");$2hD(n);if(n.$2nh){n.set_$7OZ(String.format(_nbs.NonBootStrings.l_AddRecipient_Text,n.$2s));$4ld(n)}}function $2Ch(n,t){$3WU(n);n.$2cR=!0;if(t.get_$B()===1){var u=t.get_$3q(0);if($4lb(n,u)){n.$17f=n.$mt;n.set_$Wh(n.$2py(u));return 1}}for(var i=0,f=new Array(Math.min(t.get_$B(),n.$20U)),r=0;r<t.get_$B()&&i<n.$20U;r++){f[r]=n.$2py(t.get_$3q(r));i++}n.$AE.$69(f);n.$AE.get_$B()===n.$20U?n.set_$18S(String.format(_nbs.NonBootStrings.l_ServerResultsDisplayedString_Text,n.$20U)):n.$AE.get_$B()?n.set_$18S(""):n.set_$18S(_nbs.NonBootStrings.l_NoMatchFound_Text);n.set_$1jV("");$4lc(n);i===1&&n.$6cZ();$4le(n);$N(n,"ShouldHideBordersForUseThisLocationButton");return i}function $4lb(n,t){return!!t.get_$66()&&t.get_$66().length===1}function $6sS(n){n.set_$18S(_nbs.NonBootStrings.l_ServerSearchError_Text);n.set_$1jV("");$4lc(n)}function $2hD(n){n.set_$9oX(n.$2aX!==""||n.$2B8!==""||n.$1ir)}function $4ld(n){n.set_$9nE(n.$2nh&&_a.$3t.$Xv(n.$2s))}function $3WU(n){var t=this;n.$AE.$Bh(function(t){t.remove_$5d2(n.$$d_$9LV)});n.$AE.$1r()}function $6sU(n){n.$2Zt&&n.$2Zt.$n()}function $4le(n){if(n.$AE.get_$B()>0&&n.$AE.get_$3q(0).$3vf()){var t=n.$AE.get_$3q(0);if(!_d.$5j.$889(t.get_$1s(),n.$2s)){t.set_$32G(!0);var i=_d.$5j.$7wK(t.$ME,n.$2s);if(i!==-1){t.set_$Iz(i);n.set_$i7(n.$Fr);n.set_$Iz(-1)}}}}function $4lc(n){n.set_$3JN(!1);$2hD(n);n.$mt&&$3WV(n);n.$6OE();$2hA(n)}function $2Ci(n){n.set_$9mX(n.get_$A1d()&&n.$oI&&(n.$AE.get_$B()>0&&n.$Gg<n.$AE.get_$B()||n.$1Oc&&n.$r7||n.$13y))}function $2hA(n){if(!_js.$9.$a(n.$2s)){var t=_a.$6.acss(_a.$0.$XW,"ApplyHitHighlight");n.get_$3wi().$5WC(n.$2s,".searchHitHighlight");_a.$6.aces(t)}}function $6sT(n){n.set_$i7(0);n.set_$Iz(0);n.set_$ip(!1);n.set_$1No(!1)}function $6sV(n){n.set_$da(!1);$2hB(n);n.set_$Iz(-1);n.set_$i7(-1);n.set_$ip(!1);n.set_$1No(!1);n.$2cR=!1;n.$7WV()}function $3WV(n){!_js.$9.$18(n.$2s)&&n.$fm&&(n.$AE.get_$B()>0||n.$1Hq)?n.set_$da(!0):n.set_$da(!1)}function $6sZ(n){if(n.$Gg>=0&&n.$Gg<n.$AE.get_$B()){var t=n.$AE.get_$3q(n.$Gg);t.$9jI();n.set_$Wh(t)}}function $6sY(n,t,i){if($6(t.$1f)){var r=t.get_$17M();var u=_a.$6.acss(_a.$0.$XW,"HandleServerResults");i.val=$2Ch(n,r);_a.$6.aces(u)}else $6sS(n)}function $6sW(n){n.$AE.get_$B()>0?n.$AE.get_$B()===n.$Gg?n.set_$Iz(n.$Gg-1):n.set_$Iz(n.$Gg):n.$3vG()}function $2hB(n){if(n.$1ir){n.set_$3JN(!1);n.$2be=null;n.set_$1jV(_u.Strings.l_SearchOutlookDirectory_Text);n.set_$18S("");n.set_$32s(!0)}}function $6sR(n){return n.$3ks(n.$2s)}function $2hE(n){return $2hC(n)?n.$AE.get_$3q(n.$Gg):null}function $2hC(n){return n.$Gg>-1&&n.$Gg<n.$AE.get_$B()}_d.$2C.prototype={$1W:null,$2nh:!1,$1GO:null,$5N4:!1,$M:null,$3ks:null,$1J:null,$5C:null,$54T:null,$4TZ:null,$10P:null,$2QC:!0,$2Zt:null,$1IJ:null,$3R1:null,$1tr:null,$2aX:null,$2B8:null,$10s:null,$1Hq:!0,$oI:!1,$2X5:!1,$3w3:!1,$AE:null,$2be:null,$r7:!1,$13y:!1,$2EJ:null,$1Oc:!0,$1ir:!1,$3LF:null,$29E:!1,$2cN:!1,$1kj:!1,$oJ:null,$aJ:null,$2Hj:null,$JN:null,$R4:null,$2cR:!1,$17f:!1,$1CU:!1,$7pn:!1,add_$gw:function(n){this.$Y("SelectedResultItem",n)},remove_$gw:function(n){this.$u("SelectedResultItem",n)},add_$13W:function(n){this.$Y("ResultVisible",n)},remove_$13W:function(n){this.$u("ResultVisible",n)},add_$6Hy:function(n){this.$2N("PersonaResolutionCompleted",n)},remove_$6Hy:function(n){this.$2P("PersonaResolutionCompleted",n)},get_$Wh:function(){return this.$4TZ},set_$Wh:function(n){if(n&&_pc.$i.isInstanceOfType(n.$14)&&n.get_$1s().get_$BB()!==1){var t=new _pc.$i;t.$QR(n.get_$1s().$OH());n.set_$1s(t)}this.$4TZ=n;$N(this,"SelectedResultItem");n&&this.$9Oc();return n},get_$A1d:function(){return!0},get_$8Fc:function(){return null},get_$6ch:function(){return _y.$v.$v.get_$L()==="Mouse"?3:_y.$v.$v.get_$L()==="TouchWide"?11:10},get_$A1y:function(){return""},set_$A1y:function(n){return n},get_$9od:function(){return!_js.$9.$a(this.get_$8Fc())},get_$8E9:function(){return!1},set_$8E9:function(n){return n},get_$9pm:function(){return!1},set_$9pm:function(n){return n},get_$A1x:function(){return null},get_$9mO:function(){return!this.$AE.get_$B()&&this.get_$2OM()},get_$9mX:function(){return this.$29E},set_$9mX:function(n){if(this.$29E!==n){this.$29E=n;$N(this,"ShouldPreventDefaultOnTab")}return n},get_$6V4:function(){return this.$17f},set_$6V4:function(n){this.$17f=n;return n},get_$3Nh:function(){return!this.$1Hq||!$2hC(this)},get_$4Vt:function(){return this.$2cN},set_$4Vt:function(n){if(this.$2cN!==n){this.$2cN=n;$N(this,"ShouldPreventDefaultOnLeftArrow")}return n},get_$1jW:function(){return this.$3LF},set_$1jW:function(n){if(this.$3LF!==n){this.$3LF=n;$N(this,"ResultItemTemplateId")}return n},get_$9Zf:function(){return this.$2Zt},set_$9Zf:function(n){if(this.$2Zt!==n){this.$2Zt=n;$N(this,"RefreshLayoutCommand")}return n},get_$1IK:function(){return this.$1IJ},set_$1IK:function(n){if(this.$1IJ!==n){this.$1IJ=n;$N(this,"TextBoxBackspaceCommand")}return n},get_$4a6:function(){return this.$3R1},set_$4a6:function(n){this.$3R1!==n&&(this.$3R1=n);return n},get_$2q9:function(){return this.$2Hj},set_$2q9:function(n){if(this.$2Hj!==n){this.$2Hj=n;$N(this,"CtrlKCommand")}return n},get_$532:function(){return this.$10s},set_$532:function(n){this.$10s!==n&&(this.$10s=n);return n},get_$8Fb:function(){return null},get_$4S0:function(){return this.$oJ},set_$4S0:function(n){this.$oJ!==n&&(this.$oJ=n);return n},get_$458:function(){return this.$aJ},set_$458:function(n){this.$aJ!==n&&(this.$aJ=n);return n},get_$4ZH:function(){return this.$10P},set_$4ZH:function(n){this.$10P!==n&&(this.$10P=n);return n},get_$1jV:function(){return this.$2aX},set_$1jV:function(n){if(this.$2aX!==n){this.$2aX=n;$N(this,"ResultInformation")}return n},get_$18S:function(){return this.$2B8},set_$18S:function(n){if(this.$2B8!==n){this.$2B8=n;$N(this,"TopResultInformation")}return n},get_$9oX:function(){return this.$1Hq},set_$9oX:function(n){if(this.$1Hq!==n){this.$1Hq=n;$9J(this,"ShowInformationButton","ShouldDeleteKeyBeIgnored")}return n},get_$8Dj:function(){return this.$2QC},set_$8Dj:function(n){if(n!==this.$2QC){this.$2QC=n;$N(this,"IsTextBoxEnabled")}return n},get_$9Ap:function(){return this.$2X5},set_$9Ap:function(n){if(this.$2X5!==n){this.$2X5=n;$N(this,"OnBeforeResultsVisible")}return n},get_$da:function(){return this.$oI},set_$da:function(n){OwaApplication.$13D&&(n=!1);if(this.$oI!==n){this.$oI=n;$2Ci(this);this.set_$9Ap(n);n||this.$h0("");$N(this,"ResultVisible")}return n},get_$2Mq:function(){return this.$3w3},set_$2Mq:function(n){this.$3w3=n;$N(this,"HaveInvokedTypedownForQueryString");return n},get_$Iz:function(){return this.$Fr},set_$Iz:function(n){var t=$2hE(this);if(t){this.set_$4Vt(t.$rS);var i="";t.$ME&&t.$ME.get_$B()>0&&!t.$rS&&(i=" "+_nbs.NonBootStrings.l_FindRecipient_AT_MultipleEmailAddresses_Text);this.$oI?this.$AE.get_$B()===1?this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SingleResult_Text,t.$GQ)+i):this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_MultipleResults_Text,t.$GQ)+i):this.$h0("")}else this.set_$4Vt(!1);if(this.$Fr!==n){this.$Fr=n;$N(this,"ResultItemHighlightedIndex")}return n},get_$3JN:function(){return this.$1ir},set_$3JN:function(n){if(this.$1ir!==n){this.$1ir=n;$N(this,"QueryInProgress")}return n},get_$ip:function(){return this.$r7},set_$ip:function(n){n&&(this.$1Oc?this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_Search_Text,this.get_$6Qk(),this.$2s)):this.$h0(_nbs.NonBootStrings.l_NoMatchFound_Text));if(this.$r7!==n){this.$r7=n;$2Ci(this);$N(this,"IsActionButtonHighlighted")}return n},get_$8B8:function(){return!1},set_$8B8:function(n){return n},get_$1No:function(){return this.$13y},set_$1No:function(n){n&&this.$h0(this.$2EJ);if(this.$13y!==n){this.$13y=n;$2Ci(this);$N(this,"IsAddSmtpAddressAsPersonaButtonHighlighted")}return n},get_$32s:function(){return this.$1Oc},set_$32s:function(n){if(this.$1Oc!==n){this.$1Oc=n;$2Ci(this);$N(this,"IsServerSearchAllowed")}return n},get_$9nE:function(){return this.$1kj},set_$9nE:function(n){if(this.$1kj!==n){this.$1kj=n;$N(this,"ShowAddSmtpAddressAsPersonaButton")}return n},get_$7OZ:function(){return this.$2EJ},set_$7OZ:function(n){if(this.$2EJ!==n){this.$2EJ=n;$N(this,"AddSmtpAddressAsPersonaString")}return n},get_$7oG:function(){return this.$1tr},set_$7oG:function(n){if(this.$1tr!==n){this.$1tr=n;$N(this,"FindTextBoxType")}return n},get_$2xc:function(){return this.$1CU},set_$2xc:function(n){if(this.$1CU!==n){this.$1CU=n;$N(this,"HasTextBeenPasted")}return n},get_$7z:function(){return _a.UserAgent.getInstance().$8l},get_$2OM:function(){return!_a.UserAgent.getInstance().$cU},get_$6Qk:function(){return this.$5N4?_nbs.NonBootStrings.l_SearchDirectory_Text:_u.Strings.l_SearchOutlookDirectory_Text},get_$7eH:function(){return this.$3ks},get_$i7:function(){return this.$Gg},set_$i7:function(n){if(this.$Gg!==n){this.$Gg=n;$2Ci(this);$N(this,"ShouldDeleteKeyBeIgnored")}return n},get_$3wi:function(){this.$R4||(this.$R4=new _a.$8D("psearchHighlight"));return this.$R4},$11N:function(){this.$1GO.$Rh=_pc.$14.$vp(0,220);this.$1GO.$OQ(null)},$6cW:function(n){var t=_d.$5j.$9xE(n,this.$1GO);if(t){if(n.get_$BB()===1&&t.get_$BB()!==1){var i=new _pc.$i;i.$QR(t.$OH());i.set_$1l(n.get_$1l());$Ju(this,"PersonaResolutionCompleted",n.get_$1l().EmailAddress,i)}}else if(this.$1GO.$mz)if(n.get_$BB()===1){this.$3FZ[n.get_$1l().EmailAddress]=n;var r=_pc.$14.$5EX(n.get_$1l().EmailAddress,_pc.$14.$mA);r.add_$2m(this.$$d_$9Lh);this.$1W.$z(r)}else _d.$5j.$547(n,this.$1GO)},$7hv:function(n){_d.$5j.$7hw(n,this.$1GO);if(n.get_$BB()!==1){var t=new _pc.$v7(n.get_$6G(),"recipientcache");this.$1W.$z(t)}},$h0:function(n){this.$M.$9Yf(_a.$GD,new _a.$GD(n))},$5Xc:function(){_y.$6b.prototype.$5Xc.call(this);this.set_$If(new _C(this.$$d_$4TG,_d.$2C.$A));this.set_$4ZH(new _C(this.$$d_$9gL,_d.$2C.$A));this.set_$1Ia(new _C(this.$$d_$4Ky,_d.$2C.$A));this.set_$532(new _C(this.$$d_$9G6,_d.$2C.$A));this.set_$4S0(new _C(this.$$d_$6cZ,_d.$2C.$A));this.set_$458(new _C(this.$$d_$9x0,_d.$2C.$A));this.$2Hj=new _C(this.$$d_$9G6,_d.$2C.$A);this.$JN=new _C(this.$$d_$9bU,_d.$2C.$A);this.$54T=new _C(this.$$d_$54S,_d.$2C.$A);this.$AE=new _js.$Z},$9Oc:function(){this.$2cR&&this.$6cW(this.$4TZ.get_$1s());_d.$6t.$8HA(_js.$9.$18(this.$2s)?-1:this.$2s.length,this.$AE.get_$B(),this.$Fr!==-1?this.$Fr:this.$Gg);$6sV(this)},$7WV:function(){this.set_$Ac("")},$6OE:function(){this.$AE.get_$B()>0?$6sT(this):this.$3vG()},$2py:function(n){var t;t=this.$5C?this.$5C.$7e8(n,_y.$w.$KH,!1):new _d.$8a(n,_y.$w.$KH,!1,this.$1J);var i=[1];t.$dk(1,i,"");t.$6J5();t.add_$5d2(this.$$d_$9LV);return t},$9QV:function(){if(this.$fm){this.$17f=!0;this.$1yz||this.set_$2sJ(!1);if($6(this.$2s)||this.$2s.trim()==="")this.set_$da(!1);else if(!this.$3w3&&this.$kz.$2M)this.$4Ky();else{var n=this.$oI;$3WV(this);n||$2hA(this)}}},$6EU:function(){if(this.$fm&&!this.$1yz)if(this.$1y0){var n=this;_js.$J.get_$I().$3r(_a.$0.$3I3,"TextBox.SetFocus",function(){n.set_$HW(!0)})}else this.set_$da(!1)},$9A8:function(){if(this.$oI&&!this.$59f()&&this.$Gg>=0&&this.$AE.get_$B()>0){var n=this.$AE.get_$3q(this.$Gg);if(this.$Fr!==-1&&this.$Gg){var t=this.$AE.get_$3q(this.$Gg-1);if(t.$9xI()){this.set_$i7(this.$Gg-1);this.set_$Iz(-1);var r=t.$ME.get_$3q(t.$Fr).EmailAddress;this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,r,t.$GQ))}else{this.set_$i7(this.$Gg-1);this.set_$Iz(this.$Gg)}}else if(n.$9xJ()){if(this.$Fr!==-1){this.set_$i7(this.$Fr);var i=n.$ME.get_$3q(n.$Fr).EmailAddress;this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,i,n.$GQ))}this.set_$Iz(-1)}else this.set_$Iz(this.$Gg)}},$9A7:function(){if(this.$oI&&!this.$59e()&&$2hC(this)){var n=this.$AE.get_$3q(this.$Gg);if(n.$6cd()){if(this.$Fr!==-1){this.set_$i7(this.$Fr);this.set_$Iz(-1);var t=n.$ME.get_$3q(n.$Fr).EmailAddress;this.$h0(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,t,n.$GQ))}}else{this.set_$i7(this.$Gg+1);this.set_$Iz(this.$Gg)}}},$9mc:function(){return!0},$9Ek:function(){this.set_$da(!1);$2hB(this)},$9n9:function(){return!0},$3vG:function(){if(this.$1kj){this.set_$1No(!0);this.set_$ip(!1)}else{this.set_$1No(!1);this.$1Hq?this.set_$ip(!0):this.set_$ip(!1)}this.set_$i7(-1);this.set_$Iz(-1)},$59e:function(){if(this.$r7)return!0;if(this.$13y&&this.$1Hq){this.set_$1No(!1);this.set_$ip(!0);return!0}if(this.$Gg===this.$AE.get_$B()-1){var n=this.$AE.get_$3q(this.$Gg);if(!n.$7Uk()){this.$1kj?this.set_$1No(!0):this.$1Hq&&this.set_$ip(!0);if(this.$13y||this.$r7){n.$6cd();this.set_$i7(this.$AE.get_$B());this.set_$Iz(this.$Gg)}return!0}}return!1},$59f:function(){if(this.$r7)if(this.$1kj){this.set_$1No(!0);this.set_$ip(!1)}else this.$AE.get_$B()>0&&this.set_$ip(!1);else this.$13y&&this.$AE.get_$B()>0&&this.set_$1No(!1);return this.$r7||this.$13y},$4TG:function(){this.$r7?this.$1Oc&&this.$10s.$2M&&this.$10s.$n():this.$13y&&this.$2nh&&_a.$3t.$Xv(this.$2s)?this.$54S():this.$oI&&this.$AE.get_$B()>0&&(this.$Fr!==-1?this.set_$Wh(this.$AE.get_$3q(this.$Fr)):$6sZ(this))},$9gL:function(){this.$29E?this.$4TG():this.set_$da(!1)},$9G6:function(){var t=this.$9n9();if(t){if(!this.$1Oc||$6(this.$2s)||this.$2s.trim()==="")return;_a.$6.stPT(_a.$0.$XW,"VM.FindRecipient.Search",3);_a.$6.$1c(_a.$0.$XW,"ServerSearch");this.set_$32s(!1);this.set_$3JN(!0);this.set_$1jV("");this.set_$18S(String.format(_nbs.NonBootStrings.l_SearchingForResultsString_Text,this.$2s));$2hD(this);this.set_$HW(!0);this.$h0(this.$2B8);var n=$6sR(this);if(!Object.getType(n).implementsInterface(_pc.$xJ))throw Error.argument("The server search action must implement IQueryAction interface");this.$2be=n;this.$2be.add_$2m(this.$$d_$4Je);this.$1W.$z(this.$2be);_d.$6t.$8H9(_js.$9.$18(this.$2s)?-1:this.$2s.length,this.$AE.get_$B())}},$9Lh:function(n){var t=n;if($6(t.$1f)){var u=this.$3FZ[t.$2s];if(t.$Cm.get_$B()>0){var i=t.$Cm.get_$3q(0);var f=null;if(!$6(i.get_$66()))for(var r=0;r<i.get_$66().length;r++)i.get_$66()[r]&&i.get_$66()[r].EmailAddress&&i.get_$66()[r].EmailAddress.toLowerCase()===t.$2s.toLowerCase()&&(f=i.get_$66()[r]);if(f){u=i;var e=new _pc.$i;e.$QR(u.$OH());e.set_$1l(f);$Ju(this,"PersonaResolutionCompleted",t.$2s,e)}}_d.$5j.$547(u,this.$1GO)}delete this.$3FZ[t.$2s];n.remove_$2m(this.$$d_$4Je)},$54S:function(){var n=new _g.$1l;n.MailboxType="OneOff";n.RoutingType="SMTP";n.EmailAddress=this.$2s;n.Name=this.$2s;this.$2cR=!0;this.set_$Wh(this.$2py(_pc.$i.$DQ(n)))},$4Ky:function(){if(this.$mt||this.$7pn){$6sU(this);if(!this.$fm||_js.$9.$18(this.$2s)){this.set_$da(!1);this.set_$Iz(-1);$2hB(this);return}var n=this.$9mc();if(n){_a.$6.stPT(_a.$0.$XW,"VM.FindRecipient.TypeDown",3);var t=_a.$6.$1c(_a.$0.$XW,"NicknameCacheSearch",!0);$6sX(this);_a.$6.$1E(t,null,null,null,this.$AE.get_$B().toString());_a.$6.endPT("VM.FindRecipient.TypeDown")}this.set_$2Mq(!0)}},$4Je:function(n){if($6(n.$1f)&&$6(n.get_$17M()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2be){var i;$6sY(this,n,i={val:t});t=i.val}n.remove_$2m(this.$$d_$4Je);_a.$6.$1E(null,"ServerSearch",null,null,t.toString());_a.$6.endPT("VM.FindRecipient.Search")},$9bU:function(){if($2hC(this)){var n=this.$AE.get_$3q(this.$Gg).get_$1s();this.$7hv(n);this.set_$Iz(-1);this.$AE.$68(this.$Gg);$6sW(this)}},$6cZ:function(){var n=$2hE(this);n&&n.$3vf()&&n.set_$32G(!0)},$9x0:function(){var n=$2hE(this);if(n&&n.$3vf()){n.set_$32G(!1);n.set_$Iz(-1);this.set_$Iz(this.$Gg)}},$9LV:function(n,t){var r=$2hE(this);if(r){var i=n;if(r===i){this.set_$4Vt(i.$rS);if(!i.$rS){r.set_$Iz(-1);this.set_$Iz(this.$Gg)}}if(i.$rS){var u=this;_js.$J.get_$I().$3r(_d.$2C.$A,"FindRecipientViewModel.ApplyHitHighlight",function(){$2hA(u)})}}}};_d.$1FB=function(n,t,i,r,u,f,e,o){_d.$1FB.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$1FB.prototype={$3ku:function(n,t,i){return new _d.$sE(n,t,i)}};_d.$1FC=function(n,t,i,r,u,f,e,o){_d.$1FC.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$1FC.prototype={$2kX:function(n,t,i){if($6(n))throw Error.argument("personaViewModel is invalid");n.set_$1BT(!1);n.$dk(1,new Array(0),n.$14.get_$1l().EmailAddress);var r=this.$3ku(n,2,i);this.$2m6(r,2);this.$1T.$D(r);return r}};_d.$Eq=function(n,t,i,r){this.$1YC_0=n;this.$C_0=t;this.$1J=i;this.$k=r};_d.$Eq.prototype={$C_0:null,$1J:null,$1YC_0:null,$k:null,$SR:function(n,t,i,r,u,f){u=u?!0:!1;return new _d.$8Z(n,t,i,r,this.$1YC_0,this.$C_0,u,f,this.$1J)},$7e8:function(n,t,i){return new _d.$8a(n,t,i,this.$1J)},$7e6:function(n,t,i,r,u,f){return new _d.$HZ(n,t,i,r,this.$k,u,f)},$lx:function(n,t,i,r){return _pc.$i.isInstanceOfType(n)?this.$SR(n,t,i,r):this.$SR(_pc.$i.$1LO(n),t,i,r)}};_d.$KA=function(){this.$$d_$9Sa=Function.createDelegate(this,this.$9Sa);_d.$KA.initializeBase(this);this.$6G4=new _C(this.$$d_$9Sa,_d.$KA.$A);this.$AE=new _js.$Z};function $6wo(n,t){var i=new _d.$8a(t,_y.$w.$KH,!1);var r=[1];i.$dk(1,r,"");i.$6J5();return i}function $6wp(n,t){var i=new Sys.StringBuilder;i.append("Name,Main Email,Secondary Email"+t);for(var f=0;f<n.$AE.get_$B();f++){var r=n.$AE.get_$3q(f);i.append("Name: "+r.$GQ+",");i.append("Email: "+r.$17S);if(!$6(r.$ME))for(var u=0;u<r.$ME.get_$B();u++){i.append(",");var e=r.$ME.get_$3q(u);i.append("Email "+(u+1).toString()+": "+e.EmailAddress)}i.append(t)}return i.toString()}_d.$KA.prototype={$AE:null,$6G4:null,$3Ro:null,get_$9wB:function(){return this.$3Ro},set_$9wB:function(n){if(this.$3Ro!==n){this.$3Ro=n;$3(this,"TotalResultsInRecipientCache")}return n},$GN:function(){this.$AE.$1r();for(var n=_pc.$14.$iZ(),t=0;t<n.$1t.get_$B();t++)this.$AE.$D($6wo(this,n.$1t.get_$3q(t)));this.set_$9wB(String.format(_nbs.NonBootStrings.l_RecipientCacheTotalItems_Text,n.$1t.get_$B()))},$gk:function(){},$Uz:function(){},$kK:function(){},$9Sa:function(){console.log($6wp(this,"\r\n"))}};_d.$Ui=function(n,t,i){_d.$Ui.initializeBase(this,[n,t]);this.$k=i};_d.$Ui.prototype={$k:null,$2q1:function(n,t,i,r){$6(r)&&(r=!0);return new _d.$32(this.$C.get_$L(),n,t,i,r,this.$12B,this.$k)}};_d.$VI=function(n,t){this.$C=n;this.$5C=t};_d.$VI.prototype={$C:null,$5C:null,$1YW:function(n,t,i){return new _d.$1FB(this.$C.get_$L(),i,n,t,1,!1,!1,this.$5C)},$7fN:function(n,t){return new _d.$1FC(this.$C.get_$L(),3,n,t,1,!1,!1,this.$5C)}};_d.$nn=function(n,t,i,r){if(n==="Mouse"&&t){var u=this;i.$uu.add_$1Z(function(n,t){if(!t.$2v)for(var i=0;i<t.$2l.length;i++){var u=t.$2l[i];r.$9S1(u)}})}};_d.$o3=function(n){n.$z(new _h.$iJ(!0))};_d.$rO=function(n){var t=new _pc.$PB;n.$z(t)};_d.$rv=function(){var n=_pc.$14.$iZ();n.$Rh=_pc.$14.$vp(0,220);n.$OQ(null)};_d.$C0=function(){this.$$d_$5UN=Function.createDelegate(this,this.$5UN);this.$$d_$11k=Function.createDelegate(this,this.$11k);this.$$d_$7hC=Function.createDelegate(this,this.$7hC);this.$$d_$7hq=Function.createDelegate(this,this.$7hq);_d.$C0.initializeBase(this);this.$1z=new _y.$4c;this.$2Zh=new _js.$Z;this.$2Zh.$D(new _a.$2G(new _C(this.$$d_$7hq,_d.$C0.$A),_nbs.NonBootStrings.l_TaskDeleteOneOccurrence_Text));this.$2Zh.$D(new _a.$2G(new _C(this.$$d_$7hC,_d.$C0.$A),_nbs.NonBootStrings.l_TaskDeleteAllOccurrences_Text));this.$2Zh.$D(new _a.$2G(new _C(this.$$d_$11k,_d.$C0.$A),_u.Strings.l_ConfirmDialog_Cancel_Text))};function $6xp(n,t){for(var i=0;i<t.get_$B();i++){var r=t.get_$3q(i);if(_g.$9t.isInstanceOfType(r)&&r.get_$2zr())return!0}return!1}function $6xq(n,t){var i="";t===2?i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedMessage_Text:t===4?i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedContacts_Text:t===8&&(i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedItems_Text);n.$6Is=t;n.$1z.$32(2,i,n.$$d_$5UN,!0,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_u.Strings.l_Warning_Text)}function $4oG(n){while(n.$1Lb<n.$1dJ.get_$B()){var t=n.$1dJ.get_$3q(n.$1Lb);if(_g.$9t.isInstanceOfType(t)&&t.get_$W2()){n.set_$9ZI(String.format(_nbs.NonBootStrings.l_TaskDeleteRecurringPrompt_Text,t.get_$2i()));n.set_$3Jr(!0);return}Array.add(n.$2Ec,t.get_$i());n.$1Lb++}n.$2Ec.length>0&&$4oF(n,n.$2Ec,0,!n.$2db.length);n.$2db.length>0&&$4oF(n,n.$2db,1,!0);n.$1Lb=0}function $4oE(n,t){var i=n.$1dJ.get_$3q(n.$1Lb);Array.add(t,i.get_$i());n.set_$3Jr(!1);n.$1Lb++;$4oG(n)}function $4oF(n,t,i,r){var u=new _h.$Kf(t,"MoveToDeletedItems",0);u.$3d8=i;u.$GP=n.$2k;u.$1Z0=1;if(r){var f=this;u.add_$2m(function(t){$6(n.$3nM)||n.$3nM()})}OwaApplication.$1W.$z(u);r&&($6(n.$3nN)||n.$3nN())}_d.$C0.prototype={$3Js:null,$2Zh:null,$3Jq:!1,$1z:null,$2k:null,$1dJ:null,$2Ec:null,$2db:null,$1Lb:0,$3nN:null,$3nM:null,$6Is:0,get_$3Jr:function(){return this.$3Jq},set_$3Jr:function(n){if(this.$3Jq!==n){this.$3Jq=n;$3(this,"RecurrenceDeletionDialogIsShow")}return n},get_$9ZI:function(){return this.$3Js},set_$9ZI:function(n){if(this.$3Js!==n){this.$3Js=n;$3(this,"RecurrenceDialogMessage")}return n},$Ie:function(n,t,i,r){if(!this.$1Lb){if($6xp(this,n)){_a.$4b.$32(_u.Strings.l_AssignedTaskInformation_Text,1);return}this.$1dJ=n;this.$2k=t;this.$3nN=i;this.$3nM=r;var e=n.get_$B();if(e){var u=0;if(n.get_$B()===1){var o=n.get_$3q(0);_pc.$i.isInstanceOfType(o)?u=4:_g.$9t.isInstanceOfType(o)||(u=2)}else for(var f=0;f<e;f++){var s=n.get_$3q(f);_g.$9t.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.$V.get_$I().get_$1I().get_$164())===u){$6xq(this,u);return}this.$5UN(!0,!1)}}},$5UN:function(n,t){if(t){var i;(i=_g.$V.get_$I().get_$1I()).set_$164(i.get_$164()&~this.$6Is);_h.$2J.$Cq(_g.$V.get_$I().get_$1I().$Do,OwaApplication.$1W)}if(n){this.$2Ec=[];this.$2db=[];this.$1Lb=0;$4oG(this)}},$7hq:function(){$4oE(this,this.$2db)},$7hC:function(){$4oE(this,this.$2Ec)},$11k:function(){this.set_$3Jr(!1)}};_d.$OO=function(n){this.$$d_$25K=Function.createDelegate(this,this.$25K);_d.$OO.initializeBase(this);this.set_$DP(this);this.set_$1D6(!0);this.$Jr=new _d.$sl(n,!0);this.$Jr.$49();this.$Jr.$Y("SelectedTreeNode",this.$$d_$25K)};function $6xs(n){n.$11j||(n.$11j=new _a.$2G(n.$4d,_u.Strings.l_CancelButtonLabel_LowerCase_Text));return n.$11j}function $6xr(n,t,i){n.$2Dq?n.$2Dq.$Kn!==t&&n.$2Dq.set_$AP(t):n.$2Dq=new _a.$2G(t,i);return n.$2Dq}_d.$OO.prototype={$Jr:null,$4XS:null,$2Dq:null,$11j:null,get_$2GN:function(){return this.$Jr.get_$28Q()?this.$4XS?!_g.$28.$4N(this.$4XS,this.$Jr.get_$28Q().get_$r())&&this.$Jr.get_$28Q().get_$BK()!=="todosearch":!1:!1},$bL:function(n,t,i,r){var u=this,f=this;var e=new _C(function(){n.$n();u.set_$1O(!1)},_d.$OO.$A,this,"CanExecuteAction",function(){return f.get_$2GN()});this.set_$Sc(new _js.$Z);this.$7J.$D($6xr(this,e,i));this.$7J.$D($6xs(this));this.set_$4v(t);this.$4XS=r;$3(this,"CanExecuteAction");this.$Jr.$49();this.set_$1O(!0)},$25K:function(n,t){$3(this,"CanExecuteAction")}};_d.$1EJ=function(n){_d.$1EJ.initializeBase(this,[n])};_d.$1EJ.prototype={get_$2P9:function(){return!0},get_$6XQ:function(){return!1}};_d.$Q6=function(n){_d.$Q6.initializeBase(this);_a.$4.$J(n,"parentTaskFolderPicker");this.$S=new _js.$Z;this.$Jr=n;this.$1z=n.$1z};function $3XS(n,t){n.$1z.$32(0,t,null,!1,null,null,_nbs.NonBootStrings.l_TaskActionErrorDialogTitle_Text)}_d.$Q6.prototype={$hq:null,$1wY:null,$1sK:null,$zb:null,$vm:null,$BU:0,$S:null,$3G:!1,$12M:!1,$rI:!1,$1R9:null,$1z:null,$fp:!1,$8Z:null,$Jr:null,$A7:!1,get_$UI:function(){return this.$rI},set_$UI:function(n){if(n!==this.$rI){this.$rI=n;$3(this,"IsEdit")}return n},get_$Pa:function(){return this.$S.get_$B()>0},get_$2O:function(){return this.$3G},set_$2O:function(n){if(this.$3G!==n){this.$3G=n;$3(this,"IsSelected")}return n},get_$qC:function(){return this.$12M},set_$qC:function(n){if(n!==this.$12M){this.$12M=n;$3(this,"DisableSelection")}return n},get_$CW:function(){return this.$BU},set_$CW:function(n){if(n!==this.$BU){this.$BU=n;$3(this,"TreeNodeMode")}return n},get_$24T:function(){return this.$1R9},set_$24T:function(n){if(n!==this.$1R9){this.$1R9=n;$3(this,"NewNodeViewModel")}return n},get_$1LL:function(){return this.$vm},set_$1LL:function(n){if(n!==this.$vm){this.$vm=n;$3(this,"CreateCommand")}return n},get_$1Sn:function(){return this.$zb},set_$1Sn:function(n){if(n!==this.$zb){this.$zb=n;$3(this,"RenameCommand")}return n},get_$7i9:function(){return this.$1sK},set_$7i9:function(n){if(n!==this.$1sK){this.$1sK=n;$3(this,"DeleteTaskFolderPromptCommand")}return n},get_$86L:function(){return this.$1wY},set_$86L:function(n){if(n!==this.$1wY){this.$1wY=n;$3(this,"InitiateRenameTaskFolderCommand")}return n},get_$2nl:function(){return this.$hq},set_$2nl:function(n){if(n!==this.$hq){this.$hq=n;$3(this,"CancelRenameCommand")}return n},get_$HV:function(){return this.$A7},set_$HV:function(n){if(n!==this.$A7){this.$A7=n;$3(this,"IsCollapsed")}return n}};_d.$sl=function(n,t){this.$$d_$6ER=Function.createDelegate(this,this.$6ER);_d.$sl.initializeBase(this);this.$5H=t;this.$1z=new _y.$4c;this.$S7=n;this.$S7.add_$2nC(this.$$d_$6ER);this.$49()};_d.$sl.prototype={$1z:null,$5H:!1,$3mn:null,$AI:null,$J1:null,$9h4:null,$S7:null,get_$dh:function(){return this.$AI},set_$dh:function(n){if(this.$AI!==n){this.$AI=n;$3(this,"SelectedTreeNode")}return n},get_$28Q:function(){if(!this.$AI||!this.$S7.$aD)return null;var n=this.$AI;return this.$S7.$5Sq(n.$1Uc.get_$18F())},get_$2ag:function(){return this.$J1},set_$2ag:function(n){if(n!==this.$J1){this.$J1=n;$3(this,"RootTreeNode")}return n},$49:function(){this.$S7.$aD&&this.$6ER(this.$S7)},$6ER:function(n){for(var r=null,h=n.$2Eh,u=new _d.$1EJ(this),t,i,f,e,o=0;o<h.get_$B();o++){t=h.get_$3q(o);if(!$6(t)){i=new _d.$SC(t,this);if(!$6(t.get_$1IF())){for(var s=0;s<t.get_$1IF().get_$B();s++){e=t.get_$1IF().get_$3q(s);f=new _d.$Hn(e,i,this);e.get_$2AZ()===1&&(r=f);i.$S.$D(f)}u.$S.$D(i)}}}if(!u.$S.get_$B())throw Error.invalidOperation("Unable to get task folders");if($6(r))throw Error.argumentNull("Couldn't get default task folder");this.set_$2ag(u);this.$3mn=r;this.$3mn.set_$2O(!0)}};_d.$Hn=function(n,t,i){this.$$d_$7i7=Function.createDelegate(this,this.$7i7);this.$$d_$7i6=Function.createDelegate(this,this.$7i6);this.$$d_$9bl=Function.createDelegate(this,this.$9bl);this.$$d_$9bk=Function.createDelegate(this,this.$9bk);this.$$d_$7UZ=Function.createDelegate(this,this.$7UZ);this.$$d_$4Qh=Function.createDelegate(this,this.$4Qh);this.$$d_$3nL=Function.createDelegate(this,this.$3nL);this.$$d_$7i8=Function.createDelegate(this,this.$7i8);this.$$d_$86K=Function.createDelegate(this,this.$86K);_d.$Hn.initializeBase(this,[i]);this.$1Uc=n;this.$Di=t;this.$JR=n.get_$Kw();this.set_$CW(1);this.set_$86L(new _C(this.$$d_$86K,_d.$Hn.$A));this.set_$7i9(new _C(this.$$d_$7i8,_d.$Hn.$A));this.$5IC=new _C(this.$$d_$3nL,_d.$Hn.$A);if(n.get_$2AZ()){this.$1wY.set_$5u(!1);this.$1sK.set_$5u(!1)}this.set_$1Sn(new _C(this.$$d_$4Qh,_d.$Hn.$A));this.set_$2nl(new _C(this.$$d_$7UZ,_d.$Hn.$A));this.$Jr.$5H||(this.$8Z=new _0365m.$2b([new _0365m.$m(_u.Strings.l_Rename_LowerCase_Text,null,this.$1wY),new _0365m.$m(_u.Strings.l_Delete_LowerCase_Text,null,this.$1sK)]))};_d.$Hn.prototype={$zc:null,$1sJ:null,$5IC:null,$2Is:0,$1Uc:null,$JR:null,$Di:null,$6gF:!1,get_$Kw:function(){return this.$JR},set_$Kw:function(n){if(n!==this.$JR){this.$JR=n;$3(this,"FolderName")}return n},get_$2P9:function(){return!1},get_$6XQ:function(){return!1},$86K:function(){if(!this.$fp){this.set_$24T(this);this.set_$UI(!0);this.set_$CW(4)}},$7UZ:function(){this.set_$UI(!1);this.set_$Kw(this.$1Uc.get_$Kw());this.set_$CW(1)},$4Qh:function(){if(_js.$9.$18(this.$JR)){this.set_$Kw(this.$1Uc.get_$Kw());this.set_$UI(!1);return}if(this.$JR.trim()===this.$1Uc.get_$Kw()){this.set_$UI(!1);return}if(!$6(this.$zc)){this.$zc.remove_$1x(this.$$d_$9bk);this.$zc.remove_$2C(this.$$d_$9bl);this.$zc=null}var n=this.$zc=new _c.$1BZ(this.$1Uc,this.$JR,this.$Jr.$S7);n.add_$1x(this.$$d_$9bk);n.add_$2C(this.$$d_$9bl);this.$fp=!0;OwaApplication.$1W.$z(n);this.set_$UI(!1)},$9bl:function(n){this.$fp=!1},$9bk:function(n){this.$fp=!1;this.set_$Kw(this.$1Uc.get_$Kw());$3XS(this,this.$zc.$1f.message)},$7i8:function(){var n=this;this.$1z.$32(1,String.format(_u.Strings.l_DeleteFolderConfirmation_Text,this.$JR),function(t,i){t&&n.$5IC.$n()},!1,null,null,_u.Strings.l_DeleteFolderDialogTitle_Text)},$3nL:function(){if(!this.$fp){if(!$6(this.$1sJ)){this.$1sJ.remove_$1x(this.$$d_$7i6);this.$1sJ.remove_$2C(this.$$d_$7i7);this.$1sJ=null}var n=this.$1sJ=new _c.$13r(this.$1Uc,this.$Di.$BM,this.$Jr.$S7);n.add_$1x(this.$$d_$7i6);n.add_$2C(this.$$d_$7i7);this.$fp=!0;this.$Di.$fp=!0;OwaApplication.$1W.$z(n);this.$6gF=this.$3G;this.set_$2O(!1);this.$2Is=this.$Di.$S.$71(this);this.$2Is>=0&&this.$Di.$S.$68(this.$2Is)}},$7i7:function(n){this.$Di.$fp=!1;this.$fp=!1;this.$6gF&&this.$Jr.$3mn.set_$2O(!0)},$7i6:function(n){this.$2Is>=0&&this.$Di.$S.$72(this.$2Is,this);this.$Di.$fp=!1;this.$fp=!1;$3XS(this,this.$1sJ.$1f.message)}};_d.$SC=function(n,t){this.$$d_$7fB=Function.createDelegate(this,this.$7fB);this.$$d_$7fC=Function.createDelegate(this,this.$7fC);this.$$d_$869=Function.createDelegate(this,this.$869);this.$$d_$3l7=Function.createDelegate(this,this.$3l7);_d.$SC.initializeBase(this,[t]);this.$BM=n;this.$UC=n.get_$Vr();this.set_$1LL(new _C(this.$$d_$3l7,_d.$SC.$A));var i=new _C(this.$$d_$869,_d.$SC.$A);this.set_$qC(!0);this.set_$CW(1);if(!this.$Jr.$5H){this.$973=new _0365m.$m(null,_d.$3.get_$53X(),i);this.$8Z=new _0365m.$2b([new _0365m.$m(_u.Strings.l_CreateNewFolder_LowerCase_Text,null,i)])}};_d.$SC.prototype={$BM:null,$973:null,$1RC:null,$vr:null,$UC:null,get_$2P9:function(){return!0},get_$6XQ:function(){return!0},$869:function(){if(!this.$fp){if(!$6(this.$vr)){this.$vr.remove_$2C(this.$$d_$7fC);this.$vr.remove_$1x(this.$$d_$7fB);this.$vr=null}this.$vr=new _c.$13T(this.$BM,this.$Jr.$S7);this.$vr.add_$2C(this.$$d_$7fC);this.$vr.add_$1x(this.$$d_$7fB);var n=new _d.$Hn(this.$vr.$1RB,this,this.$Jr);n.set_$UI(!0);n.set_$qC(!0);this.set_$24T(this.$1RC=n);this.set_$CW(3)}},$3l7:function(){if(!_js.$9.$18(this.$1RC.$JR)){this.$1RC.set_$UI(!1);this.$1RC.set_$CW(2);this.$vr.$9jx(this.$1RC.$JR);this.$fp=!0;OwaApplication.$1W.$z(this.$vr);this.$S.$D(this.$1RC)}},$7fB:function(n){this.$S.$34(this.$1RC);this.$fp=!1;$3XS(this,this.$vr.get_$cH())},$7fC:function(n){this.$1RC.set_$CW(1);this.$fp=!1}};_d.$1EM=function(n,t){_d.$1EM.initializeBase(this,[n,t])};_d.$VA=function(n,t,i,r,u,f,e,o){this.$$d_$9Hz=Function.createDelegate(this,this.$9Hz);this.$$d_$9FG=Function.createDelegate(this,this.$9FG);this.$$d_$8Ii=Function.createDelegate(this,this.$8Ii);_d.$VA.initializeBase(this,[n,t,i,r,u,f,e,null,o]);this.$46a=new _C(this.$$d_$8Ii,_d.$VA.$A);this.$1le=new _d.$C0};_d.$VA.prototype={$46a:null,$4Q8:null,$1le:null,$3tU:function(n,t){if((n&1)==1)throw Error.notImplemented();var f=new _c.$1EL(this.$G7(),this.$5h,this.$Vd);var i=_h.$12.$7wp(_c.$gj,f);var r=i.$1t.get_$B();r||(r=this.get_$2Wx());var u=new _h.$8R(0,this.get_$2Wx());u.$1df=1;i.$OQ(u);return i},$7ct:function(n){this.set_$Dt(!0);var t=new _y.$U2(!1);var i=new _y.$Ju;switch(this.$Vd.$Bv){case"TaskStartDate":var r=this;return new(_y.$Ce.$$(_a.$9I))(t,function(n){if(_g.$9t.isInstanceOfType(n)&&n.get_$8q())return n.get_$8q();else if(n.get_$70())return n.get_$70().get_$8q();return null},n);case"TaskDueDate":var u=this;return new(_y.$Ce.$$(_a.$9I))(t,function(n){if(_g.$9t.isInstanceOfType(n)&&n.get_$Ct())return n.get_$Ct();else if(n.get_$70())return n.get_$70().get_$Ct();return null},n);case"ItemClass":var f=this,e=this;return new(_y.$BB.$$(_g.$y))(i,function(n){return n.get_$8n()},function(n){return $6(n)?"":n.startsWith("IPM.Note")?_nbs.NonBootStrings.l_ItemClassMessage_Text:n.startsWith("IPM.Task")?_nbs.NonBootStrings.l_ItemClassTask_Text:_nbs.NonBootStrings.l_ItemClassOther_Text},_u.Strings.l_EmptyGroupHeader_Text);case"TaskStatus":var o=this,s=this;return new(_y.$BB.$$(_a.$9I))(i,function(n){if(_g.$9t.isInstanceOfType(n))return n.get_$BG();else if(n.get_$70())return n.get_$70().get_$JJ()?"Completed":"NotStarted";return null},function(n){var t=new _d.$mF;return t.$36(n,!1)},_u.Strings.l_EmptyGroupHeader_Text);default:return _lv.$53.prototype.$7ct.call(this,n)}},$Ie:function(n){var i=$up(this,$ur(this));var t=this;this.$1le.$Ie(this.$2f,this.$G7(),function(){$bf(t,null);$bf(t,i);$pE(t)},null)},$5Yn:function(){if(!$6(this.$Mn)){if(!_g.$28.$4N(this.$21.get_$r(),this.$Mn)){var n=$ur(this);if(n&&n.length>0){var t=$up(this,n);var i=new _h.$MG(n,this.$Mn,0);$bf(this,null);$bf(this,t);OwaApplication.$1W.$z(i)}}$pE(this)}},$4aq:function(){if(this.$11)if(_g.$9t.isInstanceOfType(this.$11)){var n=this.$11;var t=n.get_$BG()==="Completed"?"Today":"MarkComplete";this.$tw(t)}else _lv.$53.prototype.$4aq.call(this)},$tw:function(n){if(this.$2f){var o=this.get_$7Y();if(!o)return;for(var r=[],u=[],f=0;f<o;f++){var t=this.$2f.get_$3q(f);if(_g.$9t.isInstanceOfType(t)){if(t.get_$2zr()){_a.$4b.$32(_u.Strings.l_AssignedTaskInformation_Text,1);return}Array.add(r,t)}else Array.add(u,t)}if(r.length>0){var i=new _c.$bg(n,this.$G7());i.set_$3T(r);this.$12w=i;i.add_$2m(this.$$d_$9FG);OwaApplication.$1W.$z(i)}if(u.length){var e=new _h.$WP(n,this.$G7());e.set_$3T(u);this.$12w=e;OwaApplication.$1W.$z(e);$1JJ(this)}else $1JJ(this)}},$7y3:function(){return"Sort by"},$85h:function(){this.$9g=new _0365m.$2b([new _0365m.$m(_u.Strings.l_Move_LowerCase_Text,null,this.$1Ch),this.$O0.$1YV()]);this.$9g.$Y("IsShown",this.$$d_$9Hz)},$5XW:function(){_lv.$f.prototype.$5XW.call(this);var n=this;this.$Zo.$Y("IsShown",function(t,i){if(n.$Zo.$2y&&n.$11){var r=n.$Zo.$1C.get_$3q(n.$Zo.$1C.get_$B()-1);r.set_$q(_g.$9t.isInstanceOfType(n.$11))}})},$6eC:function(){this.set_$1qU(!0)},$9Hz:function(n,t){if(this.$9g.$2y){var i=this.$9g.$1C.get_$3q(0);_g.$28.$4N(this.$G7(),_g.$2X.$Bi("todosearch").get_$r())?i.set_$q(!0):i.set_$q(!1);this.$O0.$1r3(this.$7xh(),this.get_$7Y())}},$8Ii:function(){this.$2f&&this.$tw("MarkComplete")},$9FG:function(n){$6(this.$4Q8)||this.$4Q8.get_$OD()()}};_d.$sn=function(n,t,i,r,u,f,e,o){this.$C=n;this.$3h=t;this.$c=i;this.$M=r;this.$2L=u;this.$BA=f;this.$7L=e;this.$OG=o};_d.$sn.prototype={$C:null,$3h:null,$c:null,$M:null,$BA:null,$2L:null,$7L:null,$OG:null,$7fD:function(){return new _d.$VA(this.$C,this.$3h,this.$c,this.$M,this.$2L,this.$BA,this.$7L,this.$OG)}};_d.$OP=function(n,t){_d.$OP.initializeBase(this);this.set_$4L(!1);this.$S7=t};_d.$OP.prototype={$76:0,$2S:!1,$12r:null,$Jr:null,$S7:null,get_$3rg:function(){return this.$2S?_u.Strings.l_CollapseFolderPane_AT_Text:_u.Strings.l_ExpandFolderPane_AT_Text},get_$4L:function(){return this.$2S},set_$4L:function(n){if(this.$2S!==n){this.$2S=n;$45(this,"IsExpanded","FolderPaneExpandCollapseButtonLabel")}this.set_$Wt(this.$2S?_d.$OP.$3Rr:_d.$OP.$3Rq);return n},get_$Wt:function(){return this.$76},set_$Wt:function(n){if(this.$76!==n){this.$76=n;$3(this,"Width")}return n},$49:function(){this.$Jr=new _d.$sl(this.$S7,!1);this.$Jr.$49()}};_d.$1ER=function(){_d.$1ER.initializeBase(this,[!1])};_d.$1ER.prototype={$2Hg:function(){var n=this.$Ic.$6aW;return new _h.$Cb(n,this.$ev)},$7c2:function(){this.$CV.$D(new _d.$SD(_nbs.NonBootStrings.l_SortBy_TaskDueDate_Text,_nbs.NonBootStrings.l_SortBy_TaskDueDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",11,"TaskDueDate",!0));this.$CV.$D(new _d.$SD(_nbs.NonBootStrings.l_SortBy_TaskStartDate_Text,_nbs.NonBootStrings.l_SortBy_TaskStartDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",10,"TaskStartDate",!0));this.$CV.$D(new _d.$SD(_nbs.NonBootStrings.l_SortBy_TaskStatus_Text,_nbs.NonBootStrings.l_SortBy_TaskStatus_UpperCase_Text,_nbs.NonBootStrings.l_NotStartedOnTop_Text,_nbs.NonBootStrings.l_NotStartedOnBottom_Text,"Ascending",12,"TaskStatus",!0));this.$CV.$D(new _d.$SD(_u.Strings.l_SortBy_Subject_Text,_u.Strings.l_SortBy_Subject_UpperCase_Text,_u.Strings.l_AOnTop_Text,_u.Strings.l_ZOnTop_Text,"Ascending",8,"Subject",!0));this.$CV.$D(new _d.$SD(_u.Strings.l_SortBy_Attachments_Text,_u.Strings.l_SortBy_Attachments_UpperCase_Text,_u.Strings.l_WithOnTop_Text,_u.Strings.l_WithoutOnTop_Text,"Descending",4,"HasAttachments",!0));this.$CV.$D(new _d.$SD(_u.Strings.l_SortBy_Importance_Text,_u.Strings.l_SortBy_Importance_UpperCase_Text,_u.Strings.l_HighOnTop_Text,_u.Strings.l_LowOnTop_Text,"Descending",5,"Importance",!0));this.$CV.$D(new _d.$SD(_u.Strings.l_SortBy_Type_Text,_u.Strings.l_SortBy_Type_UpperCase_Text,_u.Strings.l_MessagesOnTop_Text,_u.Strings.l_MessagesOnBottom_Text,"Ascending",6,"ItemClass",!0))}};_d.$SD=function(n,t,i,r,u,f,e,o){_d.$SD.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.$6aW=e};_d.$SD.prototype={$6aW:"FolderId"};_d.$98=function(){_d.$98.initializeBase(this)};_d.$98.prototype={get_$fb:function(){return this.$U(_d.$98.$40E)},set_$fb:function(n){this.$K(_d.$98.$40E,n);return n},get_$xF:function(){return this.$U(_d.$98.$41y)},set_$xF:function(n){this.$K(_d.$98.$41y,n);return n},get_$5KD:function(){return this.$U(_d.$98.$3os)},set_$5KD:function(n){this.$K(_d.$98.$3os,n);return n},get_$dz:function(){return this.$U(_d.$98.$4Zp)},set_$dz:function(n){this.$K(_d.$98.$4Zp,n);return n},get_$Cx:function(){return this.$U(_d.$98.$1xO)},set_$Cx:function(n){this.$K(_d.$98.$1xO,n);return n},get_$241:function(){return this.get_$xF()?null:[this.get_$dz()]},get_$4O6:function(){return null}};_d.$56=function(n,t){this.$$d_$6DV=Function.createDelegate(this,this.$6DV);this.$$d_$6BZ=Function.createDelegate(this,this.$6BZ);this.$$d_$9R9=Function.createDelegate(this,this.$9R9);this.$$d_$1AK=Function.createDelegate(this,this.$1AK);this.$$d_$9EN=Function.createDelegate(this,this.$9EN);this.$$d_$9DP=Function.createDelegate(this,this.$9DP);this.$$d_$7yR=Function.createDelegate(this,this.$7yR);this.$$d_$9DD=Function.createDelegate(this,this.$9DD);this.$$d_$bB=Function.createDelegate(this,this.$bB);this.$$d_$3is=Function.createDelegate(this,this.$3is);this.$$d_$2Gq=Function.createDelegate(this,this.$2Gq);this.$$d_$7i5=Function.createDelegate(this,this.$7i5);this.$$d_$8Ic=Function.createDelegate(this,this.$8Ic);this.$$d_$7N7=Function.createDelegate(this,this.$7N7);this.$$d_$9VI=Function.createDelegate(this,this.$9VI);this.$$d_$7Wn=Function.createDelegate(this,this.$7Wn);this.$$d_$4Sd=Function.createDelegate(this,this.$4Sd);this.$$d_$7l6=Function.createDelegate(this,this.$7l6);_d.$56.initializeBase(this);this.$M=n||null;this.$D8=t;this.$Zj=new _C(this.$$d_$7l6,_d.$56.$A);this.$El=new _C(this.$$d_$4Sd,_d.$56.$A);this.$4d=new _C(this.$$d_$7Wn,_d.$56.$A);this.$26R=new _C(this.$$d_$9VI,_d.$56.$A);this.$lQ=new _C(this.$$d_$7N7,_d.$56.$A);this.$46c=new _C(this.$$d_$8Ic,_d.$56.$A);this.$JN=new _C(this.$$d_$7i5,_d.$56.$A);this.$hv=new _C(this.$$d_$2Gq,_d.$56.$A);this.$1z=new _y.$4c;this.$1le=new _d.$C0;this.get_$1DE()&&$4oH(this);_y.$v.$v.add_$Tm(this.$$d_$3is);_y.$v.$v.add_$Jk(this.$$d_$bB)};function $6xu(n){var t={};if(n.$Gh.get_$6J()&&n.$Gh.get_$6J().get_$B()>0){var i=n.$Gh.get_$6J().$6Z();t["Tasks reading pane item categories"]=i}return t}function $4oI(n){n.set_$9q(!1);n.set_$fb(!1);n.$rM?$2hl(n):n.$Gh?!n.$Gh.get_$1Fh()&&n.$Gh.get_$Ir()&&n.$Gh.get_$Ir().get_$1g()?$2hl(n):n.$34l():n.set_$3Qw(null)}function $2hl(n){n.set_$3Qw(new _d.$Mg(n.$Gh,n.$D8));n.set_$439(n.$B0.get_$5V2());n.$B0.$Y("DueDate",n.$$d_$9DP);n.$B0.$Y("Status",n.$$d_$9DP);n.$B0.$Y("ReminderIsSet",n.$$d_$9EN);n.$B0.$Y("ReminderDueBy",n.$$d_$9EN);n.$B0.$Y("IsPrivate",n.$$d_$9EN);$6xw(n);n.$rM?_a.$6.$1E(null,"TasksCompose.New"):_a.$6.$1E(null,"TasksOpen.ItemOpen")}function $6xv(n){n.$O0=new _y.$Fw(n.get_$5jb(),n.$$d_$1AK,n.$hv,n.$1wW)}function $6xt(n){var i=n.$B0.get_$65e();var t=new _c.$iY(i,n.$GL);var r=this;t.add_$2C(function(i){n.set_$3Qw(null);n.set_$fb(!1);n.set_$xF(!1);n.set_$Dw(!1);n.set_$9q(!0);n.get_$1DE()?n.get_$89()&&n.get_$89()():$CY(n,"NewTaskClosed",n,t.$5N)});t.add_$1x(n.$$d_$9R9);OwaApplication.$1W.$z(t)}function $6xx(n,t){var r=n.$B0.get_$65e();var i=new _c.$tC(r);var u=this;i.add_$2C(function(i){n.set_$fb(!1);n.set_$Dw(!1);n.set_$9q(!0);if(n.get_$1DE()){n.$Gh&&_h.$12.$A47(_g.$9t,Boolean,n.$Gh,"NeedsUpdate",n.$Gh.get_$1Fh(),!0,function(n,t){n.set_$1Fh(t)});n.get_$89()&&n.get_$89()()}else if(t){var r=n.$B0?n.$B0.$Jq.get_$i():null;$CY(n,"NewTaskClosed",n,r)}else n.$34l()});i.add_$1x(n.$$d_$9R9);OwaApplication.$1W.$z(i)}function $2hk(n,t){n.set_$fb(!1);if(n.$B0&&n.$B0.$cb&&!t){var i=new _js.$Z;i.$D(n.$B0.$Jq);n.$1le.$Ie(i,null,null,null)}if(n.$rM){n.set_$3Qw(null);$CY(n,"NewTaskClosed",n,null)}else $2hl(n);n.set_$xF(!1);n.get_$1DE()&&n.get_$89()&&n.get_$89()()}function $4oH(n){$6xv(n);n.$2Za=new _0365m.$2b([new _0365m.$m(_u.Strings.l_Delete_LowerCase_Text,null,n.$JN),n.$O0.$1YV()]);n.get_$1DE()||n.$2Za.$1C.$D(new _0365m.$m(_u.Strings.l_OpenInSeparateWindowMenuItem_LowerCase_Text,null,n.$26R));n.$2sr=new _0365m.$2b([new _0365m.$m(_u.Strings.l_Delete_LowerCase_Text,null,n.$JN),n.$O0.$1YV(),new _0365m.$m(_nbs.NonBootStrings.l_TaskFormMarkCompleteButton_LowerCase_Text,null,n.$46c)]);n.$2Za.$Y("IsShown",n.$$d_$6BZ);n.$2sr.$Y("IsShown",n.$$d_$6BZ)}function $6xw(n){n.set_$3im(new _d.$4M(n.$B0.$BP,_g.$V.get_$I().get_$1I().get_$Nl(),new _y.$4c,_y.$v.$v));n.$EA.$Y("RecurrenceSelected",n.$$d_$6DV);n.$EA.set_$1O(!1)}_d.$56.prototype={$M:null,$KA:null,$rM:!1,$Sm:!1,$B0:null,$Gh:null,$Sr:!1,$ON:!1,$17g:!1,$2Q3:!1,$Zj:null,$El:null,$4d:null,$26R:null,$lQ:null,$46c:null,$JN:null,$hv:null,$1wW:null,$1UI:null,$26d:null,$1ZY:null,$1z:null,$Ih:null,$Hy:null,$2M0:null,$cc:!1,$2Za:null,$2sr:null,$EA:null,$1le:null,$6fy:null,$GL:null,$2Oq:!1,$31S:!1,$Dv:!1,$O0:null,$D8:null,add_$972:function(n){this.$2N("NewTaskClosed",n)},remove_$972:function(n){this.$2P("NewTaskClosed",n)},add_$9uK:function(n){this.$2N("TaskDelete",n)},remove_$9uK:function(n){this.$2P("TaskDelete",n)},get_$5jb:function(){return _g.$V.get_$I().get_$HY()},get_$1wR:function(){return this.$B0?this.$B0.$w:null},get_$Dw:function(){return this.$Dv},set_$Dw:function(n){if(this.$Dv!==n){this.$Dv=n;$3(this,"IsSaving")}return n},get_$9q:function(){return this.$Sr},set_$9q:function(n){if(this.$Sr!==n){this.$Sr=n;$3(this,"Loading")}return n},get_$fb:function(){return this.$ON},set_$fb:function(n){if(this.$ON!==n){this.$ON=n;$3(this,"IsEditMode");this.$Hy&&this.$Hy.$n();if(this.$ON){this.$Sm&&this.$bB();this.$B0&&(this.$6fy=new _a.$l3(this.$B0))}}return n},get_$xF:function(){return this.$rM},set_$xF:function(n){if(this.$rM!==n){this.$rM=n;$3(this,"IsNewTask");if(this.$rM){this.$Gh=null;$4oI(this);this.set_$fb(!0)}}return n},get_$439:function(){return this.$2Q3},set_$439:function(n){if(this.$2Q3!==n){this.$2Q3=n;$3(this,"IsShowDetails");this.$bB()}return n},get_$83S:function(){return _y.$v.$v.get_$L()!=="Mouse"},get_$2I9:function(){return this.$Gh},set_$2I9:function(n){if(this.$Gh!==n){_a.$6.$1c(_d.$56.$A,"TasksOpen.ItemOpen");this.$Gh&&this.$Gh.remove_$1h6(this.$$d_$9DD);this.$Gh=n;$3(this,"CurrentTask");this.$Gh&&this.$Gh.add_$1h6(this.$$d_$9DD);this.set_$xF(!1);$4oI(this)}return n},get_$3Qw:function(){return this.$B0},set_$3Qw:function(n){if(this.$B0!==n){this.$B0=n;$3(this,"TaskViewModel");$3(this,"IsReadOnly")}return n},get_$1xS:function(){return this.$cc},set_$1xS:function(n){if(this.$cc!==n){this.$cc=n;$3(this,"IsEditorInitialized")}return n},get_$9s0:function(){if(!this.$1UI){this.$1UI=new _js.$Z;this.$1UI.$D("NotStarted");this.$1UI.$D("InProgress");this.$1UI.$D("Completed");this.$1UI.$D("WaitingOnOthers");this.$1UI.$D("Deferred")}return this.$1UI},get_$9X3:function(){if(!this.$26d){this.$26d=new _js.$Z;this.$26d.$D("Low");this.$26d.$D("Normal");this.$26d.$D("High")}return this.$26d},get_$7kc:function(){if(!this.$1ZY){this.$1ZY=new _js.$Z;this.$1ZY.$D(0);this.$1ZY.$D(1);this.$1ZY.$D(2);this.$1ZY.$D(3)}return this.$1ZY},get_$1DE:function(){return!_y.$v.$v.get_$9A()},get_$407:function(){return this.$2Oq},set_$407:function(n){if(this.$2Oq!==n){this.$2Oq=n;$3(this,"IsDiscoveryMode");$3(this,"IsReadOnly")}return n},get_$8At:function(){return this.$31S},set_$8At:function(n){if(this.$31S!==n){this.$31S=n;$3(this,"IsItemAttachment");$3(this,"IsReadOnly")}return n},get_$Cz:function(){var n=!1;this.$B0&&this.$B0.$Jq&&this.$B0.$Jq.get_$2zr()&&(n=!0);return this.$2Oq||n||this.$31S},get_$89:function(){return this.$KA},set_$89:function(n){this.$KA=n;return n},get_$7iz:function(){return!1},get_$3im:function(){return this.$EA},set_$3im:function(n){if(this.$EA!==n){this.$EA=n;$3(this,"ComposeRecurrenceViewModel")}return n},get_$1iT:function(){return 1},get_$2MT:function(){return null},get_$5bI:function(){if(this.$ON){this.$Hy&&this.$Hy.$n();return this.$6fy.$88B()||this.$B0.$1Ji.get_$15u()!==this.$B0.$Jq.get_$2E7()||this.$B0.$1Uy.get_$15u()!==this.$B0.$Jq.get_$2eu()||!_g.$D.$4N(this.$B0.$BP.get_$M8(),this.$B0.$Jq.get_$1Se())||this.$B0.$qO.get_$F4()||this.$B0.$cb}else return!1},get_$28:function(){return this.$GL},set_$28:function(n){this.$GL=n;return n},$3JI:function(n){if(!this.$1z.$2y)if(this.get_$5bI()){var t=this;this.$1z.$32(2,_nbs.NonBootStrings.l_DiscardTaskEntryMessage_Text,function(i,r){if(i){t.get_$1DE()&&(t.$17g=!0);$2hk(t)}n&&n(i)},!1,_u.Strings.l_Discard_Text,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text,_nbs.NonBootStrings.l_DiscardTaskEntryTitle_Text)}else if(n){this.$ON&&$2hk(this);n(!0)}},$oY:function(n){this.$1wW=n;$4oH(this)},$34l:function(){var n=new _c.$DL(500,[this.$Gh.get_$i()],0,this.$2Oq);n.add_$2m(this.$$d_$7yR);this.set_$9q(!0);OwaApplication.$1W.$z(n)},$GN:function(){_y.$1KT.prototype.$GN.call(this);this.$Sm=!0;this.$rM&&this.$bB()},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);this.$Sm=!1},$9DD:function(n,t){var i=t;i.$E4!=="NeedsUpdate"||this.$ON||this.$34l()},$7yR:function(n){var t=n;if(this.$Gh&&t.$BN.length===1&&t.$BN[0].Id===this.$Gh.get_$i().Id){var i=_h.$1O.get_$I().$3x(this.$Gh.get_$i().Id);this.$Gh=i;this.$Gh.set_$1Fh(!1);$2hl(this);this.set_$9q(!1)}},$9EN:function(n,t){this.get_$Cz()||this.$ON||this.$4Sd()},$9DP:function(n,t){this.$B0.$6Tl()},$2Gq:function(){this.$1AK(null,null,!0)},$1AK:function(n,t,i){var r=_g.$Bs.$1mR(this.$Gh.get_$6J(),i,t,n);if(r){var u=new _h.$QR([r],null);u.set_$3T([this.$Gh]);OwaApplication.$1W.$z(u)}},$7l6:function(){this.set_$fb(!0)},$4Sd:function(){if(this.$B0.get_$Bj())if(this.$Dv){_js.Trace.logInfo(_d.$56.$A,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.set_$Dw(!0);else{this.$1z.$32(0,this.$B0.$p4,null);return}this.$Hy&&this.$Hy.$n();this.$rM&&!this.$B0.$cb?$6xt(this):$6xx(this,this.$B0.$cb)},$9R9:function(n){var t=n;if(t&&t.$1f){this.get_$1wR().$DG(this.$B0.get_$6aV());var i=new _d.$6s(this.$1z);var r=i.$3tO(t,41,51,63,700,88,89,42);this.get_$1wR().$2a(r);this.set_$Dw(!1)}},$7Wn:function(){var n=this;this.$3JI(function(t){t&&$2hk(n)})},$9VI:function(){if(this.$B0.$qO.get_$CM()){this.$1z.$32(0,_nbs.NonBootStrings.l_TaskValidationAttachmentInProgress_Text,null);return}var t={};this.$rM||(t.ItemID=this.$Gh.get_$i());var n=new _d.$98;n.set_$dz(this.$Gh);n.set_$fb(this.$ON);n.set_$xF(this.$rM);if(this.$ON){this.$Hy&&this.$Hy.$n();n.set_$5KD(this.$B0.$9fJ());n.set_$Cx(this.$B0.$cb);if(n.get_$Cx()){n.set_$xF(!1);n.set_$dz(this.$B0.$Jq)}}_y.$v.$v.$MH(_d.$gk,null,t,_y.$48.get_$UP(),n,!1);$2hk(this,!0)},$7N7:function(){this.$B0.$qO.$z3(!1,null,null)},$8Ic:function(){this.$B0.set_$JJ(_a.$7.get_$29().$4F());this.$4Sd()},$6BZ:function(n,t){(this.$2Za.$2y||this.$2sr.$2y)&&this.$O0.$1r3($6xu(this),1)},$7i5:function(){if(!this.get_$Cz())if(this.get_$1DE()){var n=new _js.$Z;n.$D(this.$Gh);this.$1le.$Ie(n,this.$Gh.get_$28(),null,this.get_$89())}else $CY(this,"TaskDelete",this,this.$Gh)},$6DV:function(n,t){this.$EA.$Yn&&!_d.$To.isInstanceOfType(this.$EA.$Yn)&&this.$EA.set_$1O(!0)},$3is:function(n){if(!this.$17g&&this.get_$5bI()){n.$1Jw(_nbs.NonBootStrings.l_DiscardTaskEntryMessage_Text);!this.get_$1DE()&&this.$M&&this.$M.$9Yf(_y.$Gi,new _y.$Gi(3,null))}else this.$17g=!1},$bB:function(){this.$2M0&&this.$2M0.$2M&&this.$2M0.$n()}};_d.$10Y=function(n,t){this.$M=n;this.$D8=t};_d.$10Y.prototype={$M:null,$D8:null,$E:function(){return new _d.$56(this.$M,this.$D8)}};_d.$gk=function(n,t){this.$M=n;this.$D8=t};_d.$gk.prototype={$M:null,$D8:null,$bC:function(n,t){var r=n.ItemID;var i=new _d.$56(this.$M,this.$D8);if($6(r))i.set_$xF(!0);else{var e=new _g.$1q(r);var u=new _g.$9t;u.set_$i(e);_h.$1O.get_$I().$IX(r,u);i.set_$2I9(u)}var f=n.DiscoveryMode;!$6(f)&&Boolean.parse(f)&&i.set_$407(!0);return i},$vo:function(n,t){var r=n;var i=new _d.$56(this.$M,this.$D8);var u=this;i.$Y("TaskViewModel",function(n,t){if(r.get_$fb()&&i.$B0){i.set_$fb(r.get_$fb());i.$B0.$9db(r.get_$5KD());i.$B0.$cb=r.get_$Cx();i.set_$439(i.$B0.get_$5V2())}});i.set_$2I9(r.get_$dz());i.set_$xF(r.get_$xF());return i}};_d.$Mg=function(n,t){this.$$d_$9N8=Function.createDelegate(this,this.$9N8);this.$$d_$9EK=Function.createDelegate(this,this.$9EK);this.$$d_$6EI=Function.createDelegate(this,this.$6EI);this.$$d_$9CZ=Function.createDelegate(this,this.$9CZ);this.$$d_$9LJ=Function.createDelegate(this,this.$9LJ);this.$$d_$1hZ=Function.createDelegate(this,this.$1hZ);this.$$d_$16G=Function.createDelegate(this,this.$16G);_d.$Mg.initializeBase(this);this.$Jq=n?n:_d.$Mg.$7c3();$4oJ(this,this.$Jq);this.set_$fX(new _y.$6J);this.$6Tl();this.$sk=new _a.$l3(this.$Jq);var i=this;t.$E(function(n){i.$5t=n.$1LU(i.$Jq.get_$i(),i.$Jq.get_$1N()?i.$Jq.get_$1N().get_$A5d():new _js.$Z,!0,!0,null,!0,null,null);i.$qO=n.$1LT(i.$Jq.get_$i(),i.$Jq.get_$1N()?i.$Jq.get_$1N().get_$A5d():new _js.$Z,!1,3,!0,null,!0,new _y.$6J,null);i.$qO.add_$16G(i.$$d_$16G)});this.$Y("Status",this.$$d_$1hZ);this.$Y("PercentComplete",this.$$d_$9LJ);this.$Y("CompleteDate",this.$$d_$9CZ);this.$Y("StartDate",this.$$d_$6EI);this.$Y("DueDate",this.$$d_$9EK);this.$Y("ReminderIsSet",this.$$d_$9N8)};_d.$Mg.$7c3=function(){var n=new _g.$9t;n.set_$6U("Normal");n.set_$3C(new _g.$6L(new _g.$6R("Text","")));return n};function $4oJ(n,t){n.$Z3=t.get_$2i();n.$BL=t.get_$Ct()?t.get_$Ct().$3p():null;n.$65=t.get_$8q()?t.get_$8q().$3p():null;n.$Dn=t.get_$BG();n.$1bR=t.get_$6U();n.$K0=t.get_$JJ()?t.get_$JJ().$3p():null;n.$GM=t.get_$kC()?t.get_$kC():"0";isNaN(_a.$CD.$z7(n.$GM))&&(n.$GM="0");n.$1cn=t.get_$84()==="Private";n.$1Sg=t.get_$QH();n.$go=t.get_$1H2()?t.get_$1H2().$3p():null;n.$1g6=t.get_$2Vw();n.$1Wx=t.get_$2Fe();var r=t.get_$3C()?t.get_$3C().get_$1g():null;_js.$9.$a(r)&&(r="<html><head></head></html>");n.set_$3C(r);n.set_$Cu("");var u=new Sys.StringBuilder;if(!$6(t.get_$vS()))for(var i=0;i<t.get_$vS().get_$B();i++){u.append(t.get_$vS().get_$3q(i));i!==t.get_$vS().get_$B()-1&&u.append(" ")}n.$eo=u.toString();n.$1Uy=new _d.$hU(t.get_$2eu());n.$1Ji=new _d.$hU(t.get_$2E7());n.$BP=new _d.$zP(t.$3p(),new _g.$1EN,_a.$7.get_$29(),null)}function $4oK(n,t){t.set_$2i(n.$Z3);t.set_$Ct(n.$BL);t.set_$8q(n.$65);t.set_$BG(n.$Dn);t.set_$6U(n.$1bR);t.set_$JJ(n.$K0);t.set_$kC(n.$GM.toString());t.set_$84(n.$1cn?"Private":"Normal");t.set_$QH(n.$1Sg);t.set_$1H2(n.$go);t.set_$2Vw(n.$1g6);t.set_$2Fe(n.$1Wx);var i;i="Mouse"!==_y.$v.$v.get_$L()?new _g.$6R("Text",n.$3j):new _g.$6R("HTML",n.$3j);var u=new _g.$6L(i);t.set_$3C(u);var r=new(_a.$W.$$(String));_js.$9.$a(n.$eo)||r.$D(n.$eo);t.set_$vS(r);t.set_$2eu(n.$1Uy.get_$15u());t.set_$2E7(n.$1Ji.get_$15u());t.get_$BG()!=="Completed"&&n.$sk.$zh("CompleteDate");if(n.$sk.$fg("CompleteDate")){n.$sk.$zh("Status");n.$sk.$zh("PercentComplete")}t.set_$1Se(n.$BP.get_$M8())}_d.$Mg.prototype={$cb:!1,$mE:null,$3j:null,$eo:null,$1Wx:null,$1g6:null,$go:null,$1Sg:!1,$1cn:!1,$GM:null,$K0:null,$1bR:"Low",$Dn:"NotStarted",$65:null,$BL:null,$Jq:null,$1Uy:null,$1Ji:null,$Z3:null,$4Zl:null,$w:null,$5t:null,$qO:null,$BP:null,$p4:null,$sk:null,get_$2i:function(){return this.$Z3},set_$2i:function(n){if(this.$Z3!==n){this.$Z3=n;$3(this,"Subject")}return n},get_$fX:function(){return this.$w},set_$fX:function(n){if(this.$w!==n){this.$w=n;$3(this,"InfoBarViewModel")}return n},get_$Ct:function(){return this.$BL},set_$Ct:function(n){if(!_a.$7.$4N(this.$BL,n)){this.$BL=n;$3(this,"DueDate")}return n},get_$8q:function(){return this.$65},set_$8q:function(n){if(!_a.$7.$4N(this.$65,n)){this.$65=n;$3(this,"StartDate")}return n},get_$BG:function(){return this.$Dn},set_$BG:function(n){if(this.$Dn!==n){this.$Dn=n;$3(this,"Status")}return n},get_$6U:function(){return this.$1bR},set_$6U:function(n){if(this.$1bR!==n){this.$1bR=n;$3(this,"Importance")}return n},get_$JJ:function(){return this.$K0},set_$JJ:function(n){if(!_a.$7.$4N(this.$K0,n)){this.$K0=n;$3(this,"CompleteDate")}return n},get_$kC:function(){return this.$GM},set_$kC:function(n){if(this.$GM!==n){this.$GM=n;$3(this,"PercentComplete")}return n},get_$cg:function(){return this.$1cn},set_$cg:function(n){if(this.$1cn!==n){this.$1cn=n;$3(this,"IsPrivate")}return n},get_$QH:function(){return this.$1Sg},set_$QH:function(n){if(this.$1Sg!==n){this.$1Sg=n;$3(this,"ReminderIsSet")}return n},get_$1H2:function(){return this.$go},set_$1H2:function(n){if(!_a.$7.$4N(this.$go,n)){this.$go=n;$3(this,"ReminderDueBy")}return n},get_$2Vw:function(){return this.$1g6},set_$2Vw:function(n){if(this.$1g6!==n){this.$1g6=n;$3(this,"Mileage")}return n},get_$2Fe:function(){return this.$1Wx},set_$2Fe:function(n){if(this.$1Wx!==n){this.$1Wx=n;$3(this,"BillingInformation")}return n},get_$vS:function(){return this.$eo},set_$vS:function(n){if(this.$eo!==n){this.$eo=n;$3(this,"Companies")}return n},get_$3C:function(){return this.$3j},set_$3C:function(n){if(this.$3j!==n){this.$3j=n;$3(this,"Body")}return n},get_$Cu:function(){return this.$mE},set_$Cu:function(n){if(this.$mE!==n){this.$mE=n;$3(this,"EditorContent")}return n},get_$5V2:function(){return!!this.$65||this.$Dn!=="NotStarted"||this.$1bR!=="Normal"||!!this.$K0||_a.$CD.$z7(this.$GM)>0||this.$1cn||this.$1Sg||!!this.$go||this.$1Uy.get_$15u()>0||this.$1Ji.get_$15u()>0||!_js.$9.$a(this.$1g6)||!_js.$9.$a(this.$1Wx)||!_js.$9.$a(this.$eo)||!!this.$BP.get_$M8()},get_$Bj:function(){var t=!0;if(this.$qO.get_$CM()){this.$p4=_nbs.NonBootStrings.l_TaskValidationAttachmentInProgress_Text;return!1}if(_js.$9.$18(this.$Z3)){this.$p4=_nbs.NonBootStrings.l_TaskValidationEmptySubject_Text;return!1}if(this.$BL&&this.$65&&this.$65.$2R(this.$BL)>0){this.$p4=_nbs.NonBootStrings.l_TaskValidationEarlyDueDate_Text;return!1}var n=_a.$CD.$z7(this.$GM);if(isNaN(n)||n<0||n>100){this.$p4=_nbs.NonBootStrings.l_TaskValidationPercentInvalid_Text;return!1}if(isNaN(_a.$CD.$z7(this.$1Uy.$p9))||_a.$CD.$z7(this.$1Uy.$p9)<0){this.$p4=_nbs.NonBootStrings.l_TaskValidationTotalWorkInvalid_Text;return!1}if(isNaN(_a.$CD.$z7(this.$1Ji.$p9))||_a.$CD.$z7(this.$1Ji.$p9)<0){this.$p4=_nbs.NonBootStrings.l_TaskValidationActualWorkInvalid_Text;return!1}if(this.$1Uy.get_$15u()>1525252319){this.$p4=_nbs.NonBootStrings.l_TaskValidationMaxTotalWork_Text;return!1}if(this.$1Ji.get_$15u()>1525252319){this.$p4=_nbs.NonBootStrings.l_TaskValidationMaxActualWork_Text;return!1}return t},get_$65e:function(){$4oK(this,this.$Jq);return this.$sk},$9fJ:function(){var n=this.$Jq.$3p();$4oK(this,n);return n},$9db:function(n){$4oJ(this,n)},get_$6aV:function(){this.$4Zl||(this.$4Zl=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.$4Zl},$6Tl:function(){this.$w.$DG(this.get_$6aV());this.$Jq.get_$2zr()&&this.$w.$2a(10010);if(this.$Dn==="Completed")this.$w.$2a(10080,this.$K0.$2Z(1));else if(this.$BL){var t=new _a.$ML(_a.$7.get_$29().$4F(),this.$BL.$4F()).get_$uP();var n=Math.floor(t);n?n===1?this.$w.$2a(10040):n>1&&n<15?this.$w.$2a(10050,n.toString()):n===-1?this.$w.$2a(10030):n<-1&&n>-15?this.$w.$2a(10070,Math.abs(n).toString()):n<-14&&this.$w.$2a(10060):this.$w.$2a(10020)}},$1hZ:function(n,t){if(this.$Dn==="Completed"){this.$K0||this.set_$JJ(_a.$7.get_$29().$4F());this.set_$kC("100")}else{this.set_$JJ(null);(this.$Dn==="NotStarted"||_a.$CD.$z7(this.$GM)===100)&&this.set_$kC("0")}},$9LJ:function(n,t){var i=_a.$CD.$z7(this.$GM);i?i>0&&i<100?this.set_$BG("InProgress"):i===100&&this.set_$BG("Completed"):this.set_$BG("NotStarted")},$9CZ:function(n,t){this.$K0?this.set_$BG("Completed"):this.set_$BG("NotStarted")},$6EI:function(n,t){this.$65&&(!this.$BL||this.$BL.$2R(this.$65)<0)&&this.set_$Ct(this.$65)},$9EK:function(n,t){this.$BL||this.set_$8q(null)},$9N8:function(n,t){if(this.$1Sg&&!this.$go){var i=_a.$7.get_$29();this.$BL?this.$BL.$93(i)<=0?this.set_$1H2(new _a.$7(i.get_$3l(),i.get_$2z(),i.get_$51(),8,0,0)):this.set_$1H2(new _a.$7(this.$BL.get_$3l(),this.$BL.get_$2z(),this.$BL.get_$51(),8,0,0)):this.set_$1H2(new _a.$7(i.get_$3l(),i.get_$2z(),i.get_$51(),8,0,0).$2o(1))}},$16G:function(){if($6(this.$Jq.get_$i())){var i=new _a.$l3(this.$Jq);var t=new _c.$iY(i);var n=this;t.add_$2m(function(i){n.$Jq.set_$i(t.$5N);n.$cb=!0;$6(n.$qO)||n.$qO.$1Gz(n.$Jq.get_$i(),n.$Jq.get_$1N()?n.$Jq.get_$1N().get_$A5d():new _js.$Z,null)});OwaApplication.$1W.$z(t)}else this.$cb&&($6(this.$qO)||this.$qO.$1Gz(this.$Jq.get_$i(),this.$Jq.get_$1N().get_$A5d(),null))}};_d.$hU=function(n){_d.$hU.initializeBase(this);$6y8(this,n)};function $6y8(n,t){n.$p9=t.toString();n.$18s=0;if(t){if(t>0){for(var r=[1,60,480,2400],f=[10,4],i=0;i<r.length-1&&t>=r[i+1];)i++;while(i>0){for(var u=0;u<f.length;u++)for(var e=1;e<=f[u];e++)if(!(t%(r[i]*e/f[u]))){n.$p9=(t/r[i]).toString();n.$18s=i;return}i--}}}else n.$18s=1}_d.$hU.prototype={$18s:0,$p9:null,get_$A34:function(){return this.$p9},set_$A34:function(n){if(this.$p9!==n){this.$p9=n;$N(this,"WorkAmount")}return n},get_$A37:function(){return this.$18s},set_$A37:function(n){if(this.$18s!==n){this.$18s=n;$N(this,"WorkUnit")}return n},get_$15u:function(){var n=_a.$CD.$z7(this.$p9);switch(this.$18s){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.$vO;var t=_a.$CD.$z7(this.$p9)===1?n.$36(this.$18s,1):n.$36(this.$18s,2);return String.format(_nbs.NonBootStrings.l_WorkUnitFormatString_Text,this.$p9,t)},$4e:function(n){if(!n||!_d.$hU.isInstanceOfType(n))return!1;var t=n;return this.get_$15u()===t.get_$15u()}};_d.$4U=function(n){this.$$d_$7ix=Function.createDelegate(this,this.$7ix);this.$$d_$12R=Function.createDelegate(this,this.$12R);this.$$d_$539=Function.createDelegate(this,this.$539);this.$$d_$9V1=Function.createDelegate(this,this.$9V1);this.$$d_$9Lz=Function.createDelegate(this,this.$9Lz);this.$$d_$6Ii=Function.createDelegate(this,this.$6Ii);this.$$d_$26N=Function.createDelegate(this,this.$26N);_d.$4U.initializeBase(this);this.$P=n;this.set_$6Ig(new _C(this.$$d_$26N,_d.$4U.$A));this.set_$6Ij(new _C(this.$$d_$6Ii,_d.$4U.$A));this.set_$6If(new _C(this.$$d_$9Lz,_d.$4U.$A));this.$1z=new _y.$4c;this.set_$2ro(_g.$V.get_$I().get_$31().get_$6Ih());$3XA(this)};function $6w7(n,t){switch(t){case"Idle":case"Disconnected":return"";case"Connecting":return _nbs.NonBootStrings.l_PlayOnPhoneDialing_Text;case"Connected":return _nbs.NonBootStrings.l_PlayOnPhoneConnected_Text;default:throw Error.invalidOperation("Invalid Call State.");}}function $3XA(n){if(!$6(n.$1iI)){n.$9yJ();n.$1iI=""}n.set_$2np(!0);n.set_$20l("");n.set_$2Pi(!1)}_d.$4U.prototype={$1iI:null,$P:null,$1z:null,get_$6Ig:function(){return this.$U(_d.$4U.$4Ns)},set_$6Ig:function(n){this.$K(_d.$4U.$4Ns,n);return n},get_$6Ij:function(){return this.$U(_d.$4U.$4Nt)},set_$6Ij:function(n){this.$K(_d.$4U.$4Nt,n);return n},get_$6If:function(){return this.$U(_d.$4U.$4Nq)},set_$6If:function(n){this.$K(_d.$4U.$4Nq,n);return n},get_$2np:function(){return this.$U(_d.$4U.$3h5)},set_$2np:function(n){this.$K(_d.$4U.$3h5,n);return n},get_$2Pi:function(){return this.$U(_d.$4U.$42I)},set_$2Pi:function(n){this.$K(_d.$4U.$42I,n);return n},get_$6Ie:function(){return this.$U(_d.$4U.$4Nr)},set_$6Ie:function(n){this.$K(_d.$4U.$4Nr,n);return n},get_$2ro:function(){return this.$U(_d.$4U.$3nd)},set_$2ro:function(n){this.$K(_d.$4U.$3nd,n);return n},get_$20l:function(){return this.$U(_d.$4U.$47W)},set_$20l:function(n){this.$K(_d.$4U.$47W,n);return n},$7WF:function(){$6(this.$1iI)||this.$6Ii()},$9V1:function(n){if(n.EventType!=="Reload"){var t=n;this.set_$20l($6w7(this,t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&$3XA(this)}},$4YS:function(){var n=new _g.$At;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1iI;var t=new _h.$BS(n);t.$IU(_d.$4U.$A,"PlayOnPhoneNotification",this.$$d_$9V1,2)},$9yJ:function(){var n=new _g.$At;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1iI;var t=new _h.$BS(n);t.$2BR()},$26N:function(){this.set_$20l(_nbs.NonBootStrings.l_PlayOnPhoneDialing_Text);var n=new _c.$1Am(this.$P.get_$i().Id,this.get_$2ro());this.set_$2Pi(!0);n.add_$2C(this.$$d_$539);n.add_$1x(this.$$d_$12R);OwaApplication.$1W.$z(n)},$6Ii:function(){var n=new _c.$1Ao(this.$1iI);this.set_$20l(_nbs.NonBootStrings.l_PlayOnPhoneDisconnecting_Text);n.add_$2m(this.$$d_$7ix);OwaApplication.$1W.$z(n)},$9Lz:function(){this.set_$6Ie(!0)},$539:function(n){this.$1iI=n.$E6.PhoneCallId.Id;this.set_$2np(!1);this.$4YS()},$12R:function(n){var i=n;var t=_nbs.NonBootStrings.l_PLayOnPhoneFailed_Text;if(i.get_$gq()&&i.get_$gq().Body){var r=i.get_$gq().Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_nbs.NonBootStrings.l_ErrorUMInvalidObjectID_Text;break;case"ErrorPhoneNumberNotDialable":t=_nbs.NonBootStrings.l_ErrorUMDialingRules_Text;break;case"ErrorIPGatewayNotFound":t=_nbs.NonBootStrings.l_ErrorUMIPGateway_Text;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_nbs.NonBootStrings.l_InvalidPhoneNumber_Text;break}}this.set_$20l("");this.$1z.$32(0,t,null);this.set_$2np(!0);this.set_$2Pi(!1)},$7ix:function(n){$3XA(this)}};_d.$CI=function(n,t){_d.$CI.initializeBase(this);_a.$4.$l(t,"nativeBridge");this.set_$3q(n);this.$33X=!1;this.$5dl=_g.$V.get_$I().get_$31().get_$1yX();this.$12=t;this.set_$4Nu(new _d.$4U(n));$6xz(this)};function $6xz(n){if(n.get_$3q().get_$1N())for(var i=0;i<n.get_$3q().get_$1N().get_$B();i++){var t=n.get_$3q().get_$1N().get_$3q(i);if(t.get_$1L()===n.get_$3q().get_$4dk()){if(!n.get_$1yX()){n.set_$Bw(new _d.$n9(t,_y.$8s.$2vL(t.get_$3i(),!1),n.get_$3q().get_$i().Id));n.$33X=_g.$y.$42T(n.get_$3q().get_$8n())?!0:t.get_$Bf()==="audio/mp3"?!0:!1}if(n.get_$4WB()||n.get_$6WK()){n.$X1=new Array(1);n.$X1[0]=t.get_$3i().Id}break}}}_d.$CI.prototype={$5dl:!1,$12:null,$33X:!1,$4X2:!1,$X1:null,get_$3q:function(){return this.$U(_d.$CI.$14Y)},set_$3q:function(n){this.$K(_d.$CI.$14Y,n);return n},get_$Bw:function(){return this.$U(_d.$CI.$4XV)},set_$Bw:function(n){this.$K(_d.$CI.$4XV,n);return n},get_$4Nu:function(){return this.$U(_d.$CI.$4Nv)},set_$4Nu:function(n){this.$K(_d.$CI.$4Nv,n);return n},get_$4WB:function(){var n=!1;this.get_$43l()&&this.$33X&&!this.get_$1yX()&&(this.get_$8AK()||this.$12.$2FU.$Co)&&(n=!0);return n},get_$6WK:function(){return!this.get_$1yX()&&this.get_$43l()&&!this.get_$4WB()&&_a.UserAgent.getInstance().$5h0},get_$56r:function(){return this.$X1},get_$43l:function(){return _g.$y.$5et(this.get_$3q().get_$8n())},get_$9q0:function(){return this.$4X2},set_$9q0:function(n){this.$4X2=n;$3(this,"SignalCleanup");return n},get_$1yX:function(){return this.$5dl&&_g.$y.$42T(this.get_$3q().get_$8n())},get_$8AK:function(){return _a.UserAgent.getInstance().$3x3},$j6:function(){this.set_$9q0(!0);this.get_$4Nu().$7WF()}};_d.$1Jb=function(){};_d.$1Jb.$1k=function(){};_d.$1Jb.$1k.$9rW=function(n){var t="";t=n?"RemoveGroupCalendarItem":"RemoveCalendarItem";return _a.$6.$1c(_a.$0.$1k,t,!0)};_d.$1Jb.$1k.$XF=function(){};_d.$1Jb.$1k.$XF.$2II=function(n,t,i,r,u,f){var e=new _a.$6U;t&&e.$5Z("N",1);n&&e.$5Z("K",1);var o=0;if(!$6(r.$t.get_$7S())&&r.$t.get_$7S().get_$B()>0){o+=r.$t.get_$7S().get_$B();e.$5Z("RC",r.$t.get_$7S().get_$B())}if(!$6(r.$t.get_$8W())&&r.$t.get_$8W().get_$B()>0){o+=r.$t.get_$8W().get_$B();e.$5Z("OC",r.$t.get_$8W().get_$B())}o>0&&e.$5Z("TC",o);!$6(r.$t.get_$5V())&&r.$t.get_$5V()&&e.$5Z("A",1);!$6(r.$t.get_$9F())&&r.$t.get_$9F().get_$B()>0&&e.$5Z("R",r.$t.get_$9F().get_$B());$6(u)||u.get_$DS()/6e4==30||e.$5Z("DU",u.get_$DS()/6e4);r.get_$gp()!==15&&e.$5Z("RM",r.get_$gp());$6(r.$t.get_$9S())||r.$t.get_$9S()==="Busy"||e.$7a("F",r.$t.get_$9S());!$6(r.$t.get_$cg())&&r.$t.get_$cg()&&e.$5Z("P",1);i&&e.$7a("RP",f.$E5.get_$Hi().$2B7());!$6(r.$t.get_$323())&&r.$t.get_$323()&&e.$5Z("OM",1);$6(r.$t.get_$Du())||r.$t.get_$Du()||e.$5Z("NR",1);return e.toString()};_d.$1Jb.$1k.$XF.$6Yo=function(n,t,i,r,u,f,e){_a.$6.stPT(_a.$0.$1k,"PersistCalendarItemChangesPerfTrace",3);var o="";o=e?i?r==="Mouse"?u?t?"GroupCalendar_CreateRecurringEventOnPopout":"GroupCalendar_UpdateRecurringEventOnPopout":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":f?t?"GroupCalendar_CreateRecurringEventOnQuickCompose":"GroupCalendar_UpdateRecurringEventOnQuickCompose":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":r==="Mouse"?u?t?"GroupCalendar_CreateEventOnPopout":"GroupCalendar_UpdateEventOnPopout":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":f?t?"GroupCalendar_CreateEventOnQuickCompose":"GroupCalendar_UpdateEventOnQuickCompose":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":n?i?r==="Mouse"?u?t?"SendRecurringMeetingOnPopout":"UpdateRecurringMeetingOnPopout":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":f?t?"SendRecurringMeetingOnQuickCompose":"UpdateRecurringMeetingOnQuickCompose":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":r==="Mouse"?u?t?"SendMeetingOnPopout":"UpdateMeetingOnPopout":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":f?t?"SendMeetingOnQuickCompose":"UpdateMeetingOnQuickCompose":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":i?r==="Mouse"?u?t?"SaveRecurringAppointmentOnPopout":"UpdateRecurringAppointmentOnPopout":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":f?t?"SaveRecurringAppointmentOnQuickCompose":"UpdateRecurringAppointmentOnQuickCompose":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":r==="Mouse"?u?t?"SaveAppointmentOnPopout":"UpdateAppointmentOnPopout":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose":f?t?"SaveAppointmentOnQuickCompose":"UpdateAppointmentOnQuickCompose":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose";return _a.$6.$1c(_a.$0.$1k,o,!0)};_d.$1Jb.$1k.$XF.$2tE=function(n,t,i,r){_a.$6.$1E(n,null,t,i,r);_a.$6.endPT("PersistCalendarItemChangesPerfTrace")};_d.$1Jb.$1k.$XF.$9rX=function(n,t){var i="";i=t?n?"GroupCalendar_SaveNaturalInputAllDayItem":"GroupCalendar_SaveNaturalInputItem":n?"SaveNaturalInputAllDayItem":"SaveNaturalInputItem";return _a.$6.$1c(_a.$0.$1k,i,!0)};_d.$1Jb.$1k.$Hj=function(){};_d.$1Jb.$1k.$Hj.$9rU=function(n){var t=n?"OpenSchedulingAssistantFormOnPopout":"OpenSchedulingAssistantForm";_a.$6.$1c(_d.$1Jb.$1k.$Hj.$2ay,t);return t};_d.$1Jb.$1k.$Hj.$6Ym=function(n){var t=n?"ApplySchedulingAssistantChangesOnPopout":"ApplySchedulingAssistantChanges";return _a.$6.$1c(_d.$1Jb.$1k.$Hj.$2ay,t,!0)};_d.$1Jb.$1k.$Hj.$6Yn=function(n){var t=n?"DiscardSchedulingAssistantChangesOnPopout":"DiscardSchedulingAssistantChanges";return _a.$6.$1c(_d.$1Jb.$1k.$Hj.$2ay,t,!0)};_d.$1Jb.$1k.$Hj.$9rV=function(){return _a.$6.$1c(_d.$1Jb.$1k.$Hj.$2ay,"PopoutSchedulingAssistantForm",!0)};_d.$1Jb.$1k.$Hj.$2K4=function(n,t,i,r){_a.$6.$1E(n,null,t,i,r)};_d.$1Jb.$1k.$I8=function(){};_d.$1Jb.$1k.$I8.$7tF=function(n){return n?3:0};_d.$1Jb.$1k.$I8.$7tL=function(n){return n?4:1};_d.$1Jb.$1k.$I8.$7xp=function(n){return n?5:2};_d.$1Jb.$1k.$I8.$7TZ=function(n,t){switch(n){case"Accept":switch(t){case 0:return"AcceptMeetingOnMailReadingPane";case 1:return"AcceptMeetingOnCalendarPeek";case 2:return"AcceptMeetingOnCalendarReadingPane";case 3:return"AcceptMeetingOnCalendarContextMenu"}break;case"Tentative":switch(t){case 0:return"TentativelyAcceptMeetingOnMailReadingPane";case 1:return"TentativelyAcceptMeetingOnCalendarPeek";case 2:return"TentativelyAcceptMeetingOnCalendarReadingPane";case 3:return"TentativelyAcceptMeetingOnCalendarContextMenu"}break;case"Decline":switch(t){case 0:return"DeclineMeetingOnMailReadingPane";case 1:return"DeclineMeetingOnCalendarPeek";case 2:return"DeclineMeetingOnCalendarReadingPane";case 3:return"DeclineMeetingOnCalendarContextMenu"}break}_js.Trace.logError(_d.$1Jb.$1k.$I8.$360,"Expected Accept, Tentatively Accept or Decline as valid Meeting Responses. But it is {0}",n);return null};_d.$1Jb.$1k.$I8.$4Xp=function(n,t){_a.$6.stPT(_d.$1Jb.$1k.$I8.$360,"ATDPerfTrace",3);var i=_d.$1Jb.$1k.$I8.$7TZ(n,t);return i?_a.$6.$1c(_d.$1Jb.$1k.$I8.$360,i,!0):null};_d.$1Jb.$1k.$I8.$3pT=function(n,t,i,r,u,f,e){var o=new _a.$6U;r?o.$5Z("R",1):o.$5Z("R",0);u?o.$5Z("C",1):o.$5Z("C",0);f?o.$5Z("O",1):o.$5Z("O",0);o.$7a("S",_d.$1Jb.$1k.$I8.$6SU.toString(e));_a.$6.$1E(n,null,t,i,o.toString());_a.$6.endPT("ATDPerfTrace")};_d.$1Jb.$1k.$I8.$6SU=function(){};_d.$1Jb.$1k.$I8.$6SU.prototype={dontSendResponse:0,editBeforeSendResponse:1,sendResponseDirectly:2,dontSendResponse_MasterFromOccurrence:3,editBeforeSendResponse_MasterFromOccurrence:4,sendResponseDirectly_MasterFromOccurrence:5};_d.$1Jb.$1k.$I8.$6SU.registerEnum("_d.$1Jb.$1k.$I8.$6SU",!1);_d.$1Jb.$1k.$2na=function(){};_d.$1Jb.$1k.$2na.$7Sr=function(n,t,i,r,u){var f=new _a.$6U;f.$5Z("CI",n);f.$5Z("ID",t-n);f.$7a("CSI",i);f.$7a("NSI",r);f.$7a("TSM",u);return f.toString()};_d.$1Jb.$1k.$2na.$7Ss=function(n,t,i,r,u){var f=new _a.$6U;f.$5Z("CI",i);f.$5Z("ID",r-i);f.$7a("DIR",n);f.$5Z("DIS",t);f.$7a("TSM",u);return f.toString()};_d.$1Jb.$6w=function(){};_d.$1Jb.$6w.$PX=function(n){var t=null;var i=null;_h.$pF.isInstanceOfType(n)&&(t=n.get_$1Jc())&&(i=t.correlationId);return i};_d.$1Jb.$6w.$iV=function(n){return!n||!n.$1f||_js.$9.$18(n.$1f.message)?"Failed":n.$1f.message};_d.$Mm=function(n,t){_d.$Mm.initializeBase(this);this.$ls=n;this.$5bO=t};_d.$Mm.prototype={$5bO:!1,$ls:0,$6bB:3e3,$3Oh:!1,$53N:!1,$L4:!1,$2Dw:null,$4Hr:null,get_$hW:function(){return this.$2Dw},set_$hW:function(n){if(this.$2Dw!==n){this.$2Dw=n;$45(this,"ActionMessage","HideDefaultMessage")}return n},get_$3Oi:function(){return this.$3Oh},set_$3Oi:function(n){this.$3Oh=n;n&&this.set_$CM(!1);$45(this,"HideDefaultMessage","ShowNotification");return n},get_$7N3:function(){return this.$53N},set_$7N3:function(n){this.$53N=n;this.set_$97c(n?_d.$3.get_$7Mv():_d.$3.get_$7Mu());$3(this,"ActivitySucceeded");return n},get_$97c:function(){return this.$4Hr},set_$97c:function(n){this.$4Hr=n;$3(this,"NotificationIcon");return n},get_$CM:function(){return this.$L4},set_$CM:function(n){this.$L4=n;n&&this.set_$3Oi(!1);$3(this,"IsInProgress");return n},get_$8B3:function(){return this.$ls===1},get_$5Vk:function(){return this.$3Oh||!this.$2Dw},$28z:function(n,t){this.set_$3Oi(!0);this.set_$7N3(n);this.set_$hW(t)},$9i2:function(n,t){this.set_$CM(!0);this.set_$hW(t)},$9ic:function(n){this.set_$3Oi(!1);this.set_$CM(!1);this.set_$hW(n)},$2C3:function(n){if(this.$6bB>0){var t=this;_js.$J.get_$I().$1w(_a.$0.$53M,"ActivityStatusViewModelTimer",function(){t.$Au();n&&n()},this.$6bB)}else{this.$Au();n()}},$Au:function(){this.set_$hW(null);this.set_$3Oi(!1);this.set_$CM(!1)}};_d.$dt=function(n,t){_a.$4.$1G(n,"text");_a.$4.$J(t,"action");this.$2E=n;this.$2v=t};_d.$dt.$$=function(n){var t="$dt"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$dt"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$dt.apply(this,i)};r.registerClass("_d."+t);var u=_d.$dt.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$dt.prototype={$2E:null,$2v:null,get_$1P:function(){return this.$2E},get_$pG:function(){return this.$2v}};_d.$14E=function(){};_d.$14E.prototype={singular:1,plural:2};_d.$14E.registerEnum("_d.$14E",!1);_d.$11V=function(){};_d.$11V.prototype={$36:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if($6(n))return"";if(!_js.$Z.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$Z,"Value must be an ObservableCollection");if(!n.get_$B())return"";for(var f=n,i=null,r=0;r<f.get_$B();r++){i=f.get_$3q(r);i.get_$Ry()||u.append(_js.$9.$4R(e,i.get_$9L().get_$1L()))}return u.toString()},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$uI=function(){};_d.$uI.prototype={$36:function(n,t){var r=n;var i=null;switch(r){case 0:i=_nbs.NonBootStrings.l_ZeroMinutesDuration_Text;break;case 18e5:i=_nbs.NonBootStrings.l_ThirtyMinutesDuration_Text;break;case 36e5:i=_nbs.NonBootStrings.l_OneHourDuration_Text;break;case 54e5:i=_nbs.NonBootStrings.l_NinetyMinutesDuration_Text;break;case 72e5:i=_nbs.NonBootStrings.l_TwoHoursDuration_Text;break;case-1:i=_nbs.NonBootStrings.l_AllDayDuration_Text;break;case-2:i=_nbs.NonBootStrings.l_CustomDuration_Text;break;default:i="";break}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$12I=function(){};_d.$12I.prototype={$36:function(n,t){var r=n;var i=null;switch(r){case 0:i="";break;case 1:i=_nbs.NonBootStrings.l_CalendarLayoutTypeStandard_Text;break;case 2:i=_nbs.NonBootStrings.l_CalendarLayoutTypeHorizontalAgenda_Text;break;case 3:i=_nbs.NonBootStrings.l_CalendarLayoutTypeVerticalAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$Z,String.format("Value '{0}' is not a supported CalendarLayoutType.",n));}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$12F=function(){};_d.$12F.prototype={$36:function(n,t){if(Number.isInstanceOfType(n)){var i=Math.abs(n)%24;return new _a.$7(1,1,1,i,0,0).$2Z(0)}throw Error.argument(String.format("Expected an int for the hour value. Actual type was '{0}'",n?Object.getType(n).getName():"null"));},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$KV=function(){};_d.$KV.$7uM=function(n){if(_g.$33.isInstanceOfType(n)){var t=n;return t.get_$435()?"RecurringMaster":t.get_$Lf()}else return n.get_$Lf()};_d.$KV.$5S8=function(n,t){switch(_d.$KV.$7uM(n)){case"RecurringMaster":switch(t){case 1:return _nbs.NonBootStrings.l_RemoveSeriesFromCalendar_LowerCase_Text;case 3:return _nbs.NonBootStrings.l_RemoveSeriesFromCalendar_SentenceCase_Text;default:return _nbs.NonBootStrings.l_RemoveSeriesFromCalendar_UpperCase_Text}case"Occurrence":case"Exception":switch(t){case 1:return _nbs.NonBootStrings.l_RemoveOccurrenceFromCalendar_LowerCase_Text;case 3:return _nbs.NonBootStrings.l_RemoveOccurrenceFromCalendar_SentenceCase_Text;default:return _nbs.NonBootStrings.l_RemoveOccurrenceFromCalendar_UpperCase_Text}default:switch(t){case 1:return _nbs.NonBootStrings.l_RemoveFromCalendar_LowerCase_Text;case 3:return _nbs.NonBootStrings.l_RemoveFromCalendar_SentenceCase_Text;default:return _nbs.NonBootStrings.l_RemoveFromCalendar_UpperCase_Text}}};_d.$KV.prototype={$36:function(n,t){if(!n)return"";var i=n;var r=$6(t)?_d.$KV.$5Hj:t;return _d.$KV.$5S8(i,r)},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$GQ=function(){};_d.$GQ.$2wh=function(n,t){var i="";if(!n||!t)return i;i=n.$4F().$4e(t.$4F())?String.format(_nbs.NonBootStrings.l_WhenStartEndsSameDay_Text,n.$2Z(5),n.$2Z(0),t.$2Z(0)):String.format(_nbs.NonBootStrings.l_WhenStartsEndsDifferentDay_Text,n.$2Z(5),n.$2Z(0),t.$2Z(5),t.$2Z(0));return i};_d.$GQ.$7zG=function(n,t,i,r){if(!n.$93(t))return String.format(_nbs.NonBootStrings.l_WhenStartEndsSameDay_Long_AT_Text,n.$2Z(3),n.$2Z(0),t.$2Z(0));if(i&&r&&t.$2R(n)===864e5)return n.$2Z(3);if(i&&r){var u=t.$9K(-1).$2Z(3);return String.format(_nbs.NonBootStrings.l_WhenStartsEndsDifferentDayDateOnly_Long_AT_Text,n.$2Z(3),u)}return String.format(_nbs.NonBootStrings.l_WhenStartsEndsDifferentDay_Long_AT_Text,n.$2Z(3),n.$2Z(0),t.$2Z(3),t.$2Z(0))};function $6qP(n,t,i){if(!t||!i)return"";var r=i.$5z(t);if(r<=864e5)return String.format(_nbs.NonBootStrings.l_WhenStartsEndsSameDayAllDAyEvent_Text,t.$2Z(5));var u=i.$2o(-1).$2Z(5);return String.format(_nbs.NonBootStrings.l_WhenStartsEndsDifferentDayMultiDayEvent_Text,t.$2Z(5),u)}_d.$GQ.prototype={$4Ph:null,get_$9ZG:function(){$6(this.$4Ph)&&(this.$4Ph=new _d.$1BK);return this.$4Ph},$36:function(n,t){if($6(n))return"";if(!_g.ICalendarTimePeriod.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.ICalendarTimePeriod,"Value must be an ICalendarTimePeriod");var i=n;return i.get_$Pk()?this.get_$9ZG().$36(_d.$He.$4Pj(i.get_$LT(),i.get_$y(),i.get_$1u()),t):_g.$wU.isInstanceOfType(n)&&n.get_$5V()?$6qP(this,i.get_$y(),i.get_$1u()):_d.$GQ.$2wh(i.get_$y(),i.get_$1u())},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$ub=function(){};_d.$ub.prototype={$36:function(n,t){return _g.$Sj.isInstanceOfType(n)?n.get_$1o():n},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$12U=function(){};_d.$12U.prototype={$36:function(n,t){var r=n;var i=null;switch(r){case 1:i=_nbs.NonBootStrings.l_CalendarViewTypeDay_Text;break;case 2:i=_nbs.NonBootStrings.l_CalendarViewTypeWeek_Text;break;case 3:i=_nbs.NonBootStrings.l_CalendarViewTypeWorkWeek_Text;break;case 4:i=_nbs.NonBootStrings.l_CalendarViewTypeMonth_Text;break;case 5:i=_nbs.NonBootStrings.l_CalendarViewTypeAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$Z,String.format("Value '{0}' is not a supported CalendarViewType.",n));}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$13e=function(){};_d.$13e.prototype={$36:function(n,t){switch(n){case 1:return _nbs.NonBootStrings.l_Sunday_Text;case 2:return _nbs.NonBootStrings.l_Monday_Text;case 4:return _nbs.NonBootStrings.l_Tuesday_Text;case 8:return _nbs.NonBootStrings.l_Wednesday_Text;case 16:return _nbs.NonBootStrings.l_Thursday_Text;case 32:return _nbs.NonBootStrings.l_Friday_Text;case 64:return _nbs.NonBootStrings.l_Saturday_Text;default:return""}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$13w=function(){};_d.$13w.prototype={$36:function(n,t){switch(n){case 0:return _d.$5x;case 1:return _d.$LO;case 2:return _d.$R7;default:throw Error.invalidOperation("Not supported CalendarItemDetailsPivotType: "+n.toString());}},$5DQ:function(n,t){var i=n;if(i===_d.$5x)return 0;if(i===_d.$LO)return 1;if(i===_d.$R7)return 2;throw Error.invalidOperation("Not supported Type: "+i);}};_d.$oL=function(){};_d.$oL.prototype={$36:function(n,t){var i=_js.$9W.$U(Number,n);if(i===_d.$6k.$1RH)return _nbs.NonBootStrings.l_ReminderPickerDurationNone_Text;var r=i*60;return _a.$7.$2vd(r)},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$vO=function(){};_d.$vO.prototype={$36:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_js.$1g.$o2(_d.$14E,t.toString());switch(n){case 0:i=r===1?_nbs.NonBootStrings.l_DurationUnitMinute_Text:_nbs.NonBootStrings.l_DurationUnitMinutes_Text;break;case 1:i=r===1?_nbs.NonBootStrings.l_DurationUnitHour_Text:_nbs.NonBootStrings.l_DurationUnitHours_Text;break;case 2:i=r===1?_nbs.NonBootStrings.l_DurationUnitDay_Text:_nbs.NonBootStrings.l_DurationUnitDays_Text;break;case 3:i=r===1?_nbs.NonBootStrings.l_DurationUnitWeek_Text:_nbs.NonBootStrings.l_DurationUnitWeeks_Text;break}}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$vp=function(){};_d.$vp.prototype={$36:function(n,t){if($6(n))return"calendarFree";var i=n;switch(i){case"NoData":case"Free":return"calendarFree";case"Busy":return"calendarBusy";case"Tentative":return"calendarTentative";case"WorkingElsewhere":return"calendarOutside";case"OOF":return!$6(t)&&t?"calendarAwayEmphasis":"calendarAway";default:return"calendarFree"}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$jA=function(){};_d.$jA.prototype={$36:function(n,t){var i=n;switch(i){case"Free":return _nbs.NonBootStrings.l_FreeBusyFree_Text;case"Busy":return _nbs.NonBootStrings.l_FreeBusyBusy_Text;case"Tentative":return _nbs.NonBootStrings.l_FreeBusyTentative_Text;case"WorkingElsewhere":return _nbs.NonBootStrings.l_FreeBusyWorkingElsewhere_Text;case"OOF":return _nbs.NonBootStrings.l_FreeBusyOof_Text;case"NoData":return _nbs.NonBootStrings.l_NoDataAvailable_Text;default:return""}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$qX=function(){};_d.$qX.prototype={$36:function(n,t){t===null&&(t=!0);var i=n;return i>=0&&i<=11?t?_a.$7.$5RW(i):_js.$1g.$9a(_a.$qW,i):""},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1Af=function(){};_d.$1Af.prototype={$36:function(n,t){if(!_js.$Z.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$Z,"Value must be an ObservableCollection");var r=n;var i=new _js.$Z;var f=this;r.$Bh(function(n){var t=n;_js.$9.$18(t.get_$1o())?_js.$9.$18(t.get_$A6())&&i.$D(t.get_$A6()):i.$D(t.get_$1o())});var u=new _d.$1C9;return u.$36(i,null)},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1BK=function(){};_d.$1BK.prototype={$36:function(n,t){var i=n;var r="";$6(i)||(r=i.$9vs());return r},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1BM=function(){};_d.$1BM.prototype={$36:function(n,t){switch(n){case"None":return _nbs.NonBootStrings.l_None_Text;case"First":return _nbs.NonBootStrings.l_First_Text;case"Second":return _nbs.NonBootStrings.l_Second_Text;case"Third":return _nbs.NonBootStrings.l_Third_Text;case"Fourth":return _nbs.NonBootStrings.l_Fourth_Text;case"Last":return _nbs.NonBootStrings.l_Last_Text;default:return""}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$zO=function(){};_d.$zO.prototype={$36:function(n,t){if(String.isInstanceOfType(n))return n;var i=n;var r="";$6(i)||(r=i.$2B7());return r},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$zX=function(){};_d.$zX.prototype={$36:function(n,t){var r=n;var i=null;switch(r){case-15:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FifteenMinutesBeforeStart_Text;break;case-10:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TenMinutesBeforeStart_Text;break;case-5:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FiveMinutesBeforeStart_Text;break;case 0:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ZeroMinutesBeforeStart_Text;break;case 5:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FiveMinutes_Text;break;case 10:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TenMinutes_Text;break;case 15:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FifteenMinutes_Text;break;case 30:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ThirtyMinutes_Text;break;case 60:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneHour_Text;break;case 120:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoHours_Text;break;case 240:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FourHours_Text;break;case 480:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_EightHours_Text;break;case 720:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_HalfDay_Text;break;case 1440:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneDay_Text;break;case 2880:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoDays_Text;break;case 4320:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ThreeDays_Text;break;case 5760:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FourDays_Text;break;case 10080:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneWeek_Text;break;case 20160:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoWeeks_Text;break;default:i="";break}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1Bf=function(){};_d.$1Bf.prototype={$36:function(n,t){var i=n;switch(i){case"Accept":return _nbs.NonBootStrings.l_Accepted_Text;case"Tentative":return _nbs.NonBootStrings.l_Tentative_Text;case"Decline":return _nbs.NonBootStrings.l_Declined_Text;case"Unknown":case"NoResponseReceived":return _nbs.NonBootStrings.l_NoResponseReceived_Text;case"Organizer":default:return""}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1C9=function(){};_d.$1C9.prototype={$36:function(n,t){var e="...";var o=30;var s=27;if(!_js.$Z.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$Z,"Value must be an ObservableCollection");var u=n;var i=new Sys.StringBuilder;if(!u)return null;for(var f=0;f<u.get_$B();f++){i.isEmpty()||i.append("; ");i.append(u.get_$3q(f))}var r=i.toString();return _js.$9.$18(r)||r.length<=o?r:r.substring(0,s)+e},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1CC=function(){};_d.$1CC.prototype={$36:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.NonBootStrings.l_Normal_Text;break;case"Personal":i=_nbs.NonBootStrings.l_Personal_Text;break;case"Private":i=_nbs.NonBootStrings.l_Private_Text;break;case"Confidential":i=_nbs.NonBootStrings.l_Confidential_Text;break;default:i=_nbs.NonBootStrings.l_Normal_Text;break}return i},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$mF=function(){};_d.$mF.prototype={$36:function(n,t){if($6(n))return"";else switch(n){case"NotStarted":return _u.Strings.l_TaskStatusNotStarted_Text;case"InProgress":return _u.Strings.l_TaskStatusInProgress_Text;case"Completed":return _u.Strings.l_TaskStatusCompleted_Text;case"Deferred":return _u.Strings.l_TaskStatusDeferred_Text;case"WaitingOnOthers":return _u.Strings.l_TaskStatusWaitingOnOthers_Text;default:return""}},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$12B=function(){};_d.$12B.prototype={$36:function(n,t){if($6(n))return"";if(!_g.$33.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.$33,"Value must be an CalendarItemModel");var u=n;var i=u.get_$y();var r=u.get_$1u();var f="";var e=i.$4F().$4e(r.$4F());f=u.get_$5V()?e?String.format(_nbs.NonBootStrings.l_ConflictAllSameDay_Text,i.$2Z(1)):String.format(_nbs.NonBootStrings.l_ConflictAllDifferentDay_Text,i.$2Z(1),r.$2Z(1)):e?String.format(_nbs.NonBootStrings.l_ConflictStartEndsSameDay_Text,i.$2Z(18),r.$2Z(18)):String.format(_nbs.NonBootStrings.l_ConflictStartEndsDifferentDay_Text,i.$2Z(1),i.$2Z(18),r.$2Z(1),r.$2Z(18));return f},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$1FN=function(){};_d.$1FN.prototype={$36:function(n,t){var i=n;return i?i.toLocaleString():""},$5DQ:function(n,t){throw Error.notImplemented();}};_d.$D8=function(n){_d.$D8.initializeBase(this);this.$C=n};function $6y0(n){}function $6y1(n){if(n.$C.get_$L()==="TouchNarrow"){var t=_y.$26.$Bg(n);t.$hX(new _C(n.$$d_$1Fv,_a.$0.$H9));n.set_$7D(t)}}_d.$D8.prototype={$C:null,$JN:null,$yn:null,$2J:null,$3zx:!1,$3DQ:null,$3mg:null,$33l:null,$7gf:null,$4u:null,get_$97:function(){return this.$2J},set_$97:function(n){if(n===this.$2J)return n;this.$2J=n;$3(this,_d.$D8.$5G2);return n},get_$2ZZ:function(){return this.$4u},set_$2ZZ:function(n){this.$4u=n;return n},get_$44A:function(){return this.$33l},set_$44A:function(n){if(n===this.$33l)return n;this.$33l=n;$3(this,_d.$D8.$5fW);return n},get_$661:function(){return this.$3DQ},set_$661:function(n){if(n===this.$3DQ)return n;this.$3DQ=n;$3(this,_d.$D8.$662);return n},get_$Ld:function(){return this.$C.get_$L()==="TouchNarrow"?_y.$1KT.prototype.get_$Ld.call(this):0},$GN:function(){_js.Trace.logInfo(_a.$0.$H9,"UIRPVM ->PostTransitionIn");_y.$1KT.prototype.$GN.call(this);$6y0(this)},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);this.$4u&&this.$4u.set_$2PK(!1)},$oY:function(n,t){this.$JN=n;this.$yn=t},$6TO:function(n,t){if($6(n))throw Error.argumentNull("item");if(n!==this.$2J){this.set_$97(n);this.$3zx=t;var i=this.$2J.$2LR();this.$3mg=_h.$j.$JP(i);$6(this.$3mg)?this.set_$661(_u.Strings.l_Move_UpperCase_Text):this.set_$661(String.format(_nbs.NonBootStrings.l_MoveToFolder_UpperCase_Text,this.$3mg.get_$1o()));this.$2J.get_$7j()?this.$2J.get_$7j()===3&&this.$3zx?this.set_$44A(_nbs.NonBootStrings.l_ContactMustBeViewedFromPeopleModule_Text):this.set_$44A(_nbs.NonBootStrings.l_ItemMustBeMoved_Text):this.set_$44A(_nbs.NonBootStrings.l_ItemNotSupported_Text);$6y1(this)}}};_d.$wf=function(){};_d.$wf.registerInterface("_d.$wf");_d.$14w=function(n,t){_d.$14w.initializeBase(this,[1,"ForgottenAttachment.AttachmentEvent"]);this.set_$5LU(n);this.set_$9eu(t)};_d.$14w.prototype={get_$5LU:function(){return this.$U("Event")},set_$5LU:function(n){$1M(this,"Event",n);return n},get_$9eu:function(){return this.$U("RuleNum")},set_$9eu:function(n){$1M(this,"RuleNum",n);return n}};_d.$FJ=function(){};_d.$FJ.$$cctor=function(){_d.$FJ.$3QV={};_d.$FJ.$3QV.en=!0};_d.$FJ.$7pt=function(n){return typeof window.NLG!="undefined"&&typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&!!window.Microsoft_NaturalLanguage_AttachmentRes[n]};_d.$FJ.$34w=function(n){var t=document.createElement("script");t.type="text/javascript";t.src=String.format("{0}/{1}",_y.$v.$v.get_$1jn(),n).toLowerCase();document.getElementsByTagName("head")[0].appendChild(t)};_d.$FJ.$5RC=function(n){return n.substr(0,2)};_d.$FJ.prototype={$LC:function(n){if($6(n))return!1;var t=_d.$FJ.$5RC(n);if(!(t in _d.$FJ.$3QV))return!1;typeof window.NLG=="undefined"&&_d.$FJ.$34w("microsoft.naturallanguage.clientruntime.js");typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&window.Microsoft_NaturalLanguage_AttachmentRes[t]||_d.$FJ.$34w("microsoft.naturallanguage.attachmentres."+t+".js");return!0},$3vl:function(n,t,i,r,u){u.val=null;if($6(r)||r.length<2)return!1;$6(t)&&(t="");$6(n)&&(n="");var f=_d.$FJ.$5RC(r);if(!_d.$FJ.$7pt(f))return!1;var o=_a.$6.$1c(_a.$0.$I6,"ForgottenAttachment.Start",!0);var s=this.$7u2();var h=i?NLG.PlainTextConverter.getPlainText(t):t;var e=new NLG.EmailData;e.body=NLG.PlainTextConverter.getLastMessage(h,f);e.subject=n;u.val=s.hasAttachments(e,f);_a.$6.$1E(o);return u.val.hasAttachment},$3Jn:function(n,t){OwaApplication.$78.$D(new _d.$14w(n,t.ruleNumber))},$7u2:function(){return new NLG.FAD.ForgottenAttachmentDetector}};_d.$TR=function(n,t,i,r,u){this.$$d_$810=Function.createDelegate(this,this.$810);this.$1z=t;this.$GU=i;this.$c=r;var f=_a.UserAgent.getInstance();this.$3Nf=n.get_$L()==="Mouse"&&!!r.get_$PE()&&r.get_$PE().get_$5AO()&&!!r.get_$1I()&&r.get_$1I().get_$3hf()&&!(f.$8l&&f.$D9.get_$39()<9);this.$qW=u;this.$3Nf&&u.$LC(r.get_$31().get_$7Z())};function $6sg(n,t){var r=document.createElement("div");var i=$(r);i.html(t);i.find("#divRplyFwdMsg").nextAll().remove();var u=String.format('img[src*="{0}"]',_d.$TR.$570);var f=i.find(u).first();return f.size()>0}_d.$TR.prototype={$3Nf:!1,$qW:null,$5IT:!1,$2Qm:null,$5Wo:!1,$1z:null,$GU:null,$c:null,$3vl:function(n,t){if(!this.$3Nf||this.$5Wo)return!1;var f=!1;if($6(t)){t=n.get_$92();f=!0}if(!$6(n.get_$1uk())){n.get_$1uk().$n();var i=!1;if(t)if(f)i=t.get_$B()>0;else for(var r=0;r<t.get_$B();r++){var h=t.get_$3q(r);if(!h.get_$Ry()){i=!0;break}}var e=n.get_$3n()==="HTML";if(i||e&&$6sg(this,n.get_$Cu()))this.$5IT&&this.$qW.$3Jn(2,this.$2Qm);else{var u;var o,s;if(s=this.$qW.$3vl(n.get_$2i(),n.get_$Cu(),e,this.$c.get_$31().get_$7Z(),o={val:u}),u=o.val,s){this.$2Qm=u;this.$5IT=!0;this.$1z.$32(1,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentMessage_Text,this.$$d_$810,!0,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentTitle_Text);return!0}}}return!1},$810:function(n,t){if(t){this.$c.get_$1I().set_$3hf(!1);_h.$2J.$Cq(this.$c.get_$1I().$Do,OwaApplication.$1W);this.$qW.$3Jn(3,this.$2Qm);this.$3Nf=!1}if(n){this.$5Wo=!0;this.$qW.$3Jn(0,this.$2Qm);this.$GU.$n()}else this.$qW.$3Jn(1,this.$2Qm)}};_d.$j8=function(n,t,i){this.$C=n;this.$c=t;this.$5OL=i};_d.$j8.prototype={$C:null,$c:null,$5OL:null,$5EV:function(n,t){return new _d.$TR(this.$C,n,t,this.$c,this.$5OL)}};_d.$1Ii=function(){};_d.$1Ii.registerInterface("_d.$1Ii");_d.$1Ih=function(){};_d.$1Ih.registerInterface("_d.$1Ih");_d.$K7=function(){this.$oB=new(_0365f.$o.$$(_g.$bD));this.$1T=new(_0365f.$o.$$(_g.$1l));this.$Mc=new _js.$Z};function $4nU(n,t){switch(t){case 1:return 0;case 4:return 1;case 2:return 1;case 3:return 1;case 5:return 2;default:return 3}}function $4nV(n,t){for(var i=n.$oB.get_$B()-1;i>=0;i--)$6w8(n,n.$oB.get_$3q(i),t)||n.$oB.$68(i)}function $6w8(n,t,i){if(t&&t.Recipients&&t.Recipients.length>0){for(var f=t.Recipients,r=new(_0365f.$o.$$(_g.$1l)),u=0;u<f.length;u++){var e=f[u];_g.$2L.$5Ct(i,e)&&r.$D(e)}if(!r.get_$B())return!1;t.Recipients=r.$6Z()}return!0}_d.$K7.prototype={$5N:null,$10K:0,$vg:0,$Mc:null,$1T:null,$oB:null,$2tc:0,$1r:function(){this.$oB.$1r();this.$1T.$1r();this.$Mc.$1r();this.$10K=0;this.$vg=0},$7O7:function(n){this.$oB.$1r();this.$oB.$69(n)},$A0X:function(n){this.$1T.$1r();this.$1T.$69(n);$4nV(this,n)},$2yK:function(){for(var n=null,t=0;t<this.$oB.get_$B();t++)(!n||$4nU(this,n.Action)<$4nU(this,this.$oB.get_$3q(t).Action))&&(n=this.$oB.get_$3q(t));return n},$87c:function(n){$4nV(this,n)}};_d.$3U=function(n,t,i,r,u){this.$$d_$9M1=Function.createDelegate(this,this.$9M1);this.$$d_$9M2=Function.createDelegate(this,this.$9M2);this.$$d_$9M3=Function.createDelegate(this,this.$9M3);this.$$d_$7U9=Function.createDelegate(this,this.$7U9);this.$$d_$3gn=Function.createDelegate(this,this.$3gn);this.$$d_$7U7=Function.createDelegate(this,this.$7U7);this.$$d_$7U8=Function.createDelegate(this,this.$7U8);this.$$d_$9bK=Function.createDelegate(this,this.$9bK);this.$k=n;this.$QG=t;this.$w=r;this.$56p=i;this.$C=u;this.$30I=!0};function $6wC(n,t,i,r){return r===8&&t.$Mc.get_$B()>i.$Mc.get_$B()?16:r}function $3XD(n){for(var i=n.$QG.get_$Ym(),f=new(_0365f.$o.$$(_g.$1l)),t=0;t<i.get_$B();t++)for(var r=0;r<i.get_$3q(t).$1T.get_$B();r++){var u=i.get_$3q(t).$1T.get_$3q(r);u.$CA&&u.$N7&&f.$D(u.$CA.get_$1l())}return f.$6Z()}function $3XE(n,t){if(t&&t.Id){n.$1SG=_a.$6.$1c(_a.$0.$IL,"DlpPolicyTipsGeneric",!0);var i=new _g.$c3;i.ItemId=_g.$1q.$uS(t,!0);i.BodyOrSubjectChanged=n.$Vw.$10K!==n.$Kc.$10K||n.$Vw.$vg!==n.$Kc.$vg;i.NeedToReclassify=!n.$Kc.$5N;i.CustomizedStringsNeeded=n.$30I;i.Recipients=$3XD(n);i.EventTrigger=n.$Vw.$2tc;var r=new _c.$15S(i);_js.Trace.logInfo(_a.$0.$IL,"Sending PolicyTip request to server for ItemId: "+t.Id+" CorrelationId: "+r.$A6R());$6wM(n,r,n.$$d_$9M3,n.$$d_$9M2,n.$$d_$9M1)}}function $6wG(n,t){return!t.$Mc.get_$B()&&!t.$10K&&!t.$vg}function $6wF(n,t){return t.$10K!==n.$Kc.$10K||t.$vg!==n.$Kc.$vg}function $6wE(n,t){if(t.$Mc.get_$B()!==n.$Kc.$Mc.get_$B())return!0;for(var i=0;i<n.$Kc.$Mc.get_$B();i++){var r=t.$Mc.get_$3q(i);var u=n.$Kc.$Mc.get_$3q(i);if(r.get_$3i()&&u.get_$3i()&&r.get_$3i().Id!==u.get_$3i().Id)return!0}return!1}function $6wH(n){var t=$3XD(n);return n.$Kc.$1T?!$3XC(n,n.$Kc.$1T.get_$3T(),t)||!$3XC(n,t,n.$Kc.$1T.get_$3T()):!!t&&!!t.length}function $3XC(n,t,i){if(!i||!i.length)return!0;if(!t||!i.length)return!1;for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];if(!_g.$2L.$5Ct(t,e))return!1}return!0}function $6wM(n,t,i,r,u){i&&t.add_$2C(i);t.add_$1x(r);u&&t.add_$2m(u);n.$4R6=!0;n.$k.$z(t)}function $3XB(n){_js.Trace.logInfo(_a.$0.$IL,"Clearing Existing PolicyTips");n.$w.$DG(_d.$3U.$TE);n.$1GU.$1r();n.$1SE.$1r();n.$1SF.$1r();n.$kI.set_$328(!1);n.$kI.set_$2Pv(!1);$2hc(n);$2ha(n);n.$3gn()}function $6w9(n){n.get_$6DD()&&n.get_$6DD()(n.$w)}function $6wO(n,t,i){if(t&&i){var r=t.Recipients;var u=i.Recipients;$3XC(n,r,u)||n.$kI.set_$328(!1);t.Action!==i.Action&&n.$kI.set_$328(!1)}}function $6wN(n,t){if(t){t.ComplianceURL&&n.$kI.$9iP(t.ComplianceURL);t.PolicyTipMessageBlockString&&n.$kI.set_$7SV(t.PolicyTipMessageBlockString);t.PolicyTipMessageNotifyString&&n.$kI.set_$97t(t.PolicyTipMessageNotifyString);t.PolicyTipMessageOverrideString&&n.$kI.set_$9Sd(t.PolicyTipMessageOverrideString)}}function $2hZ(n){var t=new _a.$6U;if(n.$1SE.get_$B()>0){for(var i="",u=0;u<n.$1SE.get_$B();u++){var e=n.$1SE.get_$3q(u);i+=e.ContentType}t.$7a("A",i.length>=20?i.substring(0,20):i)}if(n.$1SF.get_$B()>0){for(var r="",f=0;f<n.$1SF.get_$B();f++)r+=n.$1SF.get_$3q(f);t.$7a("C",r.length>=20?r.substring(0,20):r)}t.$5Z("T",n.$2vI());t.$7a("MS",n.$5kh?"T":"F");return t.toString()}function $2hb(n){var t=n.$Kc.$2yK();if(t){_js.Trace.logInfo(_a.$0.$IL,"PolicyTipResponse: Action:{0}, Recipients:{1}",t.Action,t.Recipients);n.$kI.set_$7Mx(t.Action);$6wK(n,t);$6wI(n,t);$6wJ(n,t);$2hc(n);$2ha(n);n.$w.$5S(91);n.$w.$10z(91,n.$kI);n.$3gn()}else $3XB(n)}function $6wL(n,t){for(var i=0;i<n.$QG.get_$Ym().get_$B();i++){var r=n.$QG.get_$Ym().get_$3q(i);if(_d.$32.isInstanceOfType(r)){r.$2r.$17f=!1;r.$2a6(t)}}}function $6wK(n,t){n.$1GU.$1r();if(t.Recipients)for(var u=t.Recipients,f=u.length,i=0;i<f;++i){var e=u[i];var r=$6wD(n,e);r&&($4nW(n,n.$1GU,r)||n.$1GU.$D(new _d.$O3(r)))}}function $4nW(n,t,i){if(i&&i.$CA&&i.$CA.get_$1l()){var u=this;var r=t.$DY(function(n){var t=n.$2Zf;return t&&t.$CA&&t.$CA.get_$1l()?t.$CA.get_$1l().EmailAddress===i.$CA.get_$1l().EmailAddress:!1});return r<t.get_$B()}return!1}function $6wA(n,t,i){if(i&&i.$1B&&i.$1B.get_$Am()&&i.$1B.get_$Am().AttachmentId){var u=this;var r=t.$DY(function(n){return n.AttachmentId.Id===i.$1B.get_$Am().AttachmentId.Id});return r<t.get_$B()}return!1}function $6wI(n,t){n.$1SE.$1r();if(t.AttachmentIds)for(var r=t.AttachmentIds,f=r.length,i=0;i<f;++i){var e=r[i];var u=$6wB(n,n.$Kc.$Mc,e);u&&n.$1SE.$D(u)}}function $6wB(n,t,i){for(var r=0;r<t.get_$B();r++){var u=t.get_$3q(r);if(i.Id===u.get_$Am().AttachmentId.Id)return u.get_$Am()}return null}function $6wJ(n,t){n.$1SF.$1r();if(t.Classifications)for(var r=t.Classifications,u=r.length,i=0;i<u;++i){var f=r[i];n.$1SF.$D(f)}}function $2hc(n){for(var f=n.$kI.$eP===1,t=0;t<n.$QG.get_$Ym().get_$B();t++){var i=n.$QG.get_$Ym().get_$3q(t);if(i.$1T)for(var r=0;r<i.$1T.get_$B();r++){var u=i.$1T.get_$3q(r);u.set_$8Dw(!f&&$4nW(n,n.$1GU,u))}}}function $2ha(n){var t=n.$56p.get_$5o();if(t&&t.get_$1N())for(var i=0;i<t.get_$1N().get_$B();i++){var r=t.get_$1N().get_$3q(i);r.set_$8Dv($6wA(n,n.$1SE,r))}}function $6wD(n,t){if(t)for(var r=0;r<n.$QG.get_$Ym().get_$B();r++){var u=n.$QG.get_$Ym().get_$3q(r);if(u.$1T)for(var f=0;f<u.$1T.get_$B();f++){var i=u.$1T.get_$3q(f);if(i.$CA&&i.$CA.get_$1l()&&t.EmailAddress===i.$CA.get_$1l().EmailAddress)return i}}return null}_d.$3U.prototype={$k:null,$w:null,$QG:null,$56p:null,$C:null,$Vw:null,$Kc:null,$o5:null,$4Ml:!1,$4R6:!1,$3vO:!1,$3Go:0,$1GU:null,$1SF:null,$1SE:null,$6DC:null,$6DB:null,$6DG:null,$6DE:null,$3G3:null,$kI:null,$1SG:null,$5kh:!1,$30I:!1,get_$4KU:function(){return this.$6DB},set_$4KU:function(n){this.$6DB=n;return n},get_$6DD:function(){return this.$6DC},set_$6DD:function(n){this.$6DC=n;return n},get_$3G2:function(){return this.$6DG},set_$3G2:function(n){this.$6DG=n;return n},get_$3G1:function(){return this.$6DE},set_$3G1:function(n){this.$6DE=n;return n},get_$6DJ:function(){return this.$3G3},set_$6DJ:function(n){this.$3G3=n;return n},$49:function(){this.$Vw=new _d.$K7;this.$Kc=new _d.$K7;this.$o5=new _d.$K7;this.$1GU=new _js.$Z;this.$1SE=new _js.$Z;this.$1SF=new _js.$Z;this.$kI=new _d.$Gq("PolicyTipsComplexContent",1,this.$1GU,this.$1SF,this.$$d_$9bK,this.$$d_$7U8,this.$$d_$7U7,this.$$d_$3gn,this.$$d_$7U9,this.$C);this.$3Go=0},$2vI:function(){if(_a.$5t.$2t&&this.$Kc){var n=this.$Kc.$2yK();if(n)return n.Action}return 0},$2e2:function(n,t,i,r,u){if(_a.$5t.$2t&&!this.$3vO){_js.Trace.logInfo(_a.$0.$IL,"Prepares to submit PolicyTips action...");if(this.$4R6){_js.Trace.logInfo(_a.$0.$IL,"PolicyTips action is pending. Wating for the request to be completed before sending the new one.");this.$4Ml=!0;this.$o5.$5N=n;this.$o5.$Mc.$1r();if(t&&t.get_$B()>0)for(var e=0;e<t.get_$B();e++)_at.$2n.isInstanceOfType(t.get_$3q(e))?this.$o5.$Mc.$D(t.get_$3q(e).$1B):_g.Attachment.isInstanceOfType(t.get_$3q(e))&&this.$o5.$Mc.$D(t.get_$3q(e));this.$o5.$10K=i;this.$o5.$vg=r;this.$o5.$2tc=u}else{this.$4Ml=!1;this.$Vw.$5N=n;this.$Vw.$Mc.$1r();this.$Vw.$10K=i;this.$Vw.$vg=r;if(t&&t.get_$B()>0)for(var f=0;f<t.get_$B();f++)_at.$2n.isInstanceOfType(t.get_$3q(f))?this.$Vw.$Mc.$D(t.get_$3q(f).$1B):_g.Attachment.isInstanceOfType(t.get_$3q(f))&&this.$Vw.$Mc.$D(t.get_$3q(f));this.$Vw.$2tc=$6wC(this,this.$Kc,this.$Vw,u);if(this.$kI.$fi)return;if($6wG(this,this.$Vw)){this.$Kc.$1r();$3XB(this);return}var o=$6wH(this);var s=$6wF(this,this.$Vw);var h=$6wE(this,this.$Vw);var c=s||h;o&&c?$3XE(this,n):s&&!this.$kI.$1DB||h?$3XE(this,n):o&&this.$3Go!==2&&$3XE(this,n)}}},$3gn:function(){this.get_$4KU()&&this.get_$4KU()()},$7U8:function(n){if(this.get_$3G2()){this.get_$3G2()(n);$2ha(this);$2hc(this);$2hb(this)}},$7U7:function(n){if(this.get_$3G1()){this.get_$3G1()(n);$2ha(this);$2hc(this);$2hb(this)}},$7U9:function(){this.$3G3&&this.$3G3()},$9M3:function(n){var t=n;_js.Trace.logInfo(_a.$0.$IL,"PolicyTips succeeded: {0}",t.$26P.EvaluationResult+" CorrelationId: "+t.$A6R());var i=this.$Kc.$2yK();this.$Kc.$5N=this.$Vw.$5N;this.$Kc.$Mc.$1r();this.$Kc.$Mc.$69(this.$Vw.$Mc.$6Z());this.$Kc.$10K=this.$Vw.$10K;this.$Kc.$vg=this.$Vw.$vg;this.$Kc.$7O7(t.$oB);this.$Kc.$A0X(t.$4Nz.Recipients);var r=this.$Kc.$2yK();$6wO(this,i,r);this.$3Go=t.$26P.OptimizationResult;this.$3Go===1&&(this.$3vO=!0);if(this.$30I){this.$30I=!1;$6wN(this,t.$26P.CustomizedStrings)}$2hb(this);this.$1SG&&_a.$6.$1E(this.$1SG,"DlpPolicyTipsGeneric","",null,$2hZ(this))},$9M2:function(n){var i=n;var t=i.$26P;if(t){_js.Trace.logWarning(_a.$0.$IL,"PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult+" CorrelationId: "+i.$A6R()+" Diagnostic: "+t.DiagnosticData);this.$1SG&&t.DiagnosticData?_a.$6.$1E(this.$1SG,"DlpPolicyTipsGeneric",_g.$ND.toString(t.EvaluationResult)+":"+t.DiagnosticData,i.$A6R(),$2hZ(this)):t&&!t.DiagnosticData&&_a.$6.$1E(this.$1SG,"DlpPolicyTipsGeneric",i.$1f.message?_g.$ND.toString(t.EvaluationResult)+":"+i.$1f.message:_g.$ND.toString(t.EvaluationResult),i.$A6R(),$2hZ(this))}else{_js.Trace.logWarning(_a.$0.$IL,"PolicyTipsResponse is null (PolicyTipsRequest is timed out) CorrelationId: "+i.$A6R());this.$1SG&&_a.$6.$1E(this.$1SG,"DlpPolicyTipsGeneric","PolicyTipsRequest timed out",i.$A6R(),$2hZ(this));this.$3vO=!0}$3XB(this)},$9M1:function(n){_js.Trace.logInfo(_a.$0.$IL,"PolicyTips completed: {0}",n);this.$4R6=!1;$6w9(this);if(this.$4Ml){_js.Trace.logInfo(_a.$0.$IL,"Submiting pending PolicyTips request...");this.$2e2(this.$o5.$5N,this.$o5.$Mc,this.$o5.$10K,this.$o5.$vg,this.$o5.$2tc)}},$9bK:function(){for(var t=this.$1GU.get_$B()-1;t>=0;t--){var i=this.$1GU.get_$3q(t);var n=i.$2Zf.$CA;n&&n.get_$1l()&&n.get_$1l().EmailAddress&&$6wL(this,n.get_$1l().EmailAddress)}var r=$3XD(this);this.$Kc.$87c(r);$2hb(this)}};_d.$46=function(n,t,i,r){this.$$d_$3gm=Function.createDelegate(this,this.$3gm);this.$$d_$2a6=Function.createDelegate(this,this.$2a6);this.$$d_$9JA=Function.createDelegate(this,this.$9JA);this.$$d_$9JB=Function.createDelegate(this,this.$9JB);this.$$d_$7vB=Function.createDelegate(this,this.$7vB);this.$k=n;this.$QG=t;this.$w=i;this.$1J=r};_d.$46.$9J9=function(n){var t=n.$1e2;var i=t?t.length:-1;_js.Trace.logInfo(_a.$0.$n7,String.format("GetMailTipsAction completed. Number of MailTips Retrieved From Server: {0}",i))};function $4mn(n){var i=[];if(n.$QG.get_$Ym()&&n.$QG.get_$Ym().get_$B()>0)for(var t=0;t<n.$QG.get_$Ym().get_$B();t++)n.$QG.get_$Ym().get_$3q(t)&&$6uK(n,i,n.$QG.get_$Ym().get_$3q(t).$1T);return i}function $6uM(n){var t=null;if(_d.$3z.isInstanceOfType(n.$QG)){var r=n.$QG;if(r){var i=r.$XY;i&&i.get_$1s()&&(t=i.get_$1s().get_$1l())}}if(!t){t=new _g.$1l;t.EmailAddress=_g.$V.get_$I().get_$31().get_$Aj();t.Name=_g.$V.get_$I().get_$31().get_$FS()}return t}function $4mp(n,t){if(!t.length){$3Wo(n);$2hQ(n);return}for(var r=$4mm(n,n.$12q,t),i=0;i<r.length;i++)n.$2a6(r[i].EmailAddress)}function $6uQ(n,t,i,r,u){i&&t.add_$2C(i);t.add_$1x(r);u&&t.add_$2m(u);n.$k.$z(t)}function $6uR(n,t){for(var u=[],r=0;r<t.length;r++){var i=t[r].EmailAddress;if(!Array.contains(u,i)){Array.add(u,i);var f=$4mo(n,i);if(!f)continue;f.$1cS&&n.$5io(i)}}}function $3Wo(n){_js.Trace.logInfo(_a.$0.$n7,"Clearing Existing MailTips...");n.$w.$DG(_d.$46.$TE);n.$1e0.$1r();n.$1gE.$1r();n.$1hd.$1r();n.$1jU.$1r();n.$1a1.$1r();n.$2Qi.$1r();n.$1Yn.$1r();Array.clear(n.$12q);n.$18T=0;n.$1wQ=0;n.$1tY=0;n.$3gm()}function $3Wp(n){if(n.$1Du){for(var c=!n.$1gE.get_$B(),l=!n.$1e0.get_$B(),a=!n.$1jU.get_$B(),v=!n.$1Yn.get_$B(),y=!n.$1hd.get_$B(),p=!n.$1a1.get_$B(),w=n.$18T<_g.$V.get_$I().get_$35U(),f=0;f<n.$1Du.length;f++){for(var r=!1,t=n.$1Du[f],s=!1,e=0;e<n.$12q.length;e++){var b=n.$12q[e];if(b.EmailAddress===t.recipientAddress){s=!0;break}}if(!s){var h=$4mo(n,t.recipientAddress);if(h){var i=new _d.$O3(h);var o=new _g.$1l;o.EmailAddress=i.get_$ZL();o.Name=i.get_$1o();Array.add(n.$12q,o);if(t.isModerated){n.$1gE.$D(i);r=!0}if(t.mailboxFull){n.$1e0.$D(i);r=!0}if(t.totalMemberCount>0){n.$18T+=t.totalMemberCount;if(t.totalMemberCount>1){i.$zQ=t.totalMemberCount;n.$2Qi.$D(i);r=!0}else n.$1wQ+=t.totalMemberCount}if(t.externalMemberCount>0){n.$1tY+=t.externalMemberCount;i.$2tu=t.externalMemberCount;n.$1a1.$D(i);r=!0}if(t.deliveryRestricted){n.$1jU.$D(i);r=!0}if(!_js.$9.$a(t.customMailTip)){i.$5Gf=_y.$3T.$5DO(t.customMailTip);n.$1Yn.$D(i);r=!0}if(!_js.$9.$a(t.outOfOffice)){i.$3ev=_y.$3T.$5DO(t.outOfOffice);n.$1hd.$D(i);r=!0}r&&n.$5io(t.recipientAddress)}}}var u=new _y.$ww;if(n.$1gE.get_$B()>0&&c){var k=new _d.$19U("MailtipsComplexContent",n.$1gE,n.$$d_$2a6,n.$$d_$3gm,u.$36(300,null),n.$1J);n.$w.$5S(300);n.$w.$10z(300,k)}if(n.$1e0.get_$B()>0&&l){var d=new _d.$1BI("MailtipsComplexContent",n.$1e0,n.$$d_$2a6,n.$$d_$3gm,u.$36(100,null),n.$1J);n.$w.$5S(100);n.$w.$10z(100,d)}if(n.$1jU.get_$B()>0&&a){var g=new _d.$1Bg("MailtipsComplexContent",n.$1jU,n.$$d_$2a6,n.$$d_$3gm,u.$36(200,null),n.$1J);n.$w.$5S(200);n.$w.$10z(200,g)}if(n.$1hd.get_$B()>0&&y){var nt=new _d.$11s("MailtipsComplexContent",n.$1hd,n.$$d_$2a6,n.$$d_$3gm,u.$36(4100,null),n.$1J);n.$w.$5S(4100);n.$w.$10z(4100,nt)}if(n.$1Yn.get_$B()>0&&v){var tt=new _d.$13Y("MailtipsComplexContent",n.$1Yn,n.$$d_$2a6,n.$$d_$3gm,u.$36(4e3,null),n.$1J);n.$w.$5S(4e3);n.$w.$10z(4e3,tt)}if(n.$1a1.get_$B()>0)if(p||!n.$1a0){n.$w.$5S(4300);n.$1a0=new _d.$14c("MailtipsComplexContent",n.$1a1,n.$$d_$2a6,n.$$d_$3gm,u.$36(4300,null),n.$1J);n.$1a0.set_$3qY(n.$1tY);n.$w.$10z(4300,n.$1a0)}else n.$1a0.set_$3qY(n.$1tY);if(n.$18T>=_g.$V.get_$I().get_$35U())if(w||!n.$14Z){n.$w.$5S(3900);n.$14Z=new _d.$18e("MailtipsComplexContent",n.$2Qi,n.$$d_$2a6,n.$$d_$3gm,u.$36(3900,null),n.$1J);n.$14Z.set_$3xk(n.$1wQ);n.$14Z.set_$4b9(n.$18T);n.$w.$10z(3900,n.$14Z)}else{n.$14Z.set_$3xk(n.$1wQ);n.$14Z.set_$4b9(n.$18T)}}n.$3gm()}function $2hQ(n){n.get_$6CH()&&n.get_$6CH()(n.$w)}function $6uN(n,t){for(var s=Sys.Net.XMLDOM(t),r=new _h.$19D,u=0;u<s.firstChild.childNodes.length;u++){var i=s.firstChild.childNodes[u];if(i.nodeType===1){var c=_a.$3P.$Vo(i);switch(c){case"RecipientAddress":r.recipientAddress=_a.$3P.$K7(i.childNodes[1]);break;case"OutOfOffice":if(i.childNodes)for(var f=0;f<i.childNodes.length;f++){var h=i.childNodes[f];var l=_a.$3P.$Vo(h);if(l==="ReplyBody"){var e=$4ml(n,_a.$3P.$K7(h));if(e&&!_js.$9.$a(e)){r.outOfOffice=e;break}}}break;case"MailboxFull":r.mailboxFull=Boolean.parse(_a.$3P.$K7(i));break;case"IsModerated":r.isModerated=Boolean.parse(_a.$3P.$K7(i));break;case"CustomMailTip":var o=$4ml(n,_a.$3P.$K7(i));o&&!_js.$9.$a(o)&&(r.customMailTip=o);break;case"TotalMemberCount":r.totalMemberCount=Number.parseInvariant(_a.$3P.$K7(i));break;case"ExternalMemberCount":r.externalMemberCount=Number.parseInvariant(_a.$3P.$K7(i));break;case"MaxMessageSize":r.maxMessageSize=Number.parseInvariant(_a.$3P.$K7(i));break;case"DeliveryRestricted":r.deliveryRestricted=Boolean.parse(_a.$3P.$K7(i));break}}}return r}function $4ml(n,t){var i;var r,u;return(u=_a.$1b.$7aE(_a.UserAgent.getInstance(),t,r={val:i}),i=r.val,u)?i:""}function $4mk(n,t,i){for(var r=0;r<t.length;r++)if(t[r].EmailAddress===i)return!0;return!1}function $6uK(n,t,i){if(i)for(var r=0;r<i.get_$B();r++)if(i.get_$3q(r).$CA.get_$1l()){var f=i.get_$3q(r).$CA.get_$1l().EmailAddress;if(!$4mk(n,t,f)){var u=new _g.$1l;u.EmailAddress=f;u.Name=i.get_$3q(r).$CA.get_$1o();Array.add(t,u)}}}function $4mm(n,t,i){if(!i||!i.length)return t;var r=[];if(!t)return r;for(var u=0;u<t.length;u++){var f=t[u];$4mk(n,i,f.EmailAddress)||Array.add(r,f)}return r}function $6uL(n,t,i){var f=[];if(t)for(var e=_h.$Br.get_$I(),r=0;r<t.length;r++){var u=t[r];e.$5Cv(u.EmailAddress,i.EmailAddress)?Array.add(n.$1Du,e.$5RK(u.EmailAddress,i.EmailAddress)):Array.add(f,u)}return f}function $4mo(n,t){for(var u=null,r=0;r<n.$QG.get_$Ym().get_$B();r++){var f=n.$QG.get_$Ym().get_$3q(r).$1T;if(f){var i=$6uJ(n,t,f);if(i){if(i.$1cS)return i;u=i}}}return u}function $6uJ(n,t,i){for(var r=0;r<i.get_$B();r++){var u=i.get_$3q(r);var f=u.$CA;if(!f){_js.Trace.logInfo(_a.$0.$n7,"skipping null recipients in the current recipient collection during find recipient");continue}var e=f.get_$1l();if(!e){_js.Trace.logInfo(_a.$0.$n7,"skipping recipient with null EmailAddress in the current recipient collection during find recipient");continue}if(e.EmailAddress===t)return u}return null}function $6uP(n,t){for(var i=0;i<n.$QG.get_$Ym().get_$B();i++){var r=n.$QG.get_$Ym().get_$3q(i);if(_d.$32.isInstanceOfType(r)){r.$2r.$17f=!1;r.$2a6(t)}}}function $6uO(n,t){$1Vd(n,t,300,n.$1gE);$1Vd(n,t,100,n.$1e0);$1Vd(n,t,4100,n.$1hd);$1Vd(n,t,200,n.$1jU);$1Vd(n,t,4e3,n.$1Yn);$1Vd(n,t,3900,n.$2Qi);$1Vd(n,t,4300,n.$1a1)}function $1Vd(n,t,i,r){for(var e=!1,o=[],f=0;f<r.get_$B();f++){var u=r.get_$3q(f);if(u.get_$ZL()===t){e=!0;i===3900&&u.$zQ>0&&(n.$18T-=u.$zQ);i===4300&&u.$2tu>0&&(n.$1tY-=u.$2tu);r.get_$B()===1&&i!==3900&&n.$w.$5S(i);Array.add(o,f)}}if(i===3900){if(!e){n.$18T--;n.$1wQ--}if(n.$14Z){n.$14Z.set_$4b9(n.$18T);n.$14Z.set_$3xk(n.$1wQ)}n.$18T<_g.$V.get_$I().get_$35U()&&n.$w.$5S(3900)}i===4300&&e&&n.$1a0&&n.$1a0.set_$3qY(n.$1tY);for(var s=o.length-1;s>=0;s--)r.$68(o[s])}_d.$46.prototype={$1J:null,$6CG:null,$6CF:null,$k:null,$QG:null,$w:null,$1e0:null,$1gE:null,$1hd:null,$1Yn:null,$1jU:null,$1a1:null,$2Qi:null,$14Z:null,$1a0:null,$1Du:null,$12q:null,$2tj:null,$18T:0,$1wQ:0,$1tY:0,$2Rr:null,get_$6CH:function(){return this.$6CG},set_$6CH:function(n){this.$6CG=n;return n},get_$4K4:function(){return this.$6CF},set_$4K4:function(n){this.$6CF=n;return n},$49:function(){this.$1e0=new _js.$Z;this.$1gE=new _js.$Z;this.$1hd=new _js.$Z;this.$1jU=new _js.$Z;this.$1a1=new _js.$Z;this.$2Qi=new _js.$Z;this.$1Yn=new _js.$Z;this.$1Du=[];this.$12q=[];$3Wo(this)},$2e1:function(){_js.Trace.logInfo(_a.$0.$n7,"Prepares to submit mailtips action");var t=$4mn(this);this.$1Du&&Array.clear(this.$1Du);_h.$Br.get_$I().$5B4();var n=$6uM(this);if(this.$2tj){if(n.EmailAddress!==this.$2tj.EmailAddress){this.$2tj=n;$3Wo(this)}}else this.$2tj=n;if(_g.$1U.$MG)for(var r=0;r<t.length;r++){var e=t[r].EmailAddress;_g.$1U.$MG.$5RJ(e,n.EmailAddress,this.$$d_$7vB)}$4mp(this,t);var o=$4mm(this,t,this.$12q);var u=$6uL(this,o,n);if(!u.length){this.$1Du.length&&$3Wp(this);$6uR(this,t);$2hQ(this);return}for(var f=new Array(u.length),i=0;i<f.length;i++)f[i]=u[i];var s=new _c.$15d(n,f,1);this.$2Rr=_a.$6.$1c(_a.$0.$n7,"MailTips");$6uQ(this,s,this.$$d_$9JB,this.$$d_$9JA,_d.$46.$9J9)},$6N8:function(){$4mp(this,$4mn(this))},$5io:function(n){if(this.$QG)for(var t=0;t<this.$QG.get_$Ym().get_$B();t++)for(var u=this.$QG.get_$Ym().get_$3q(t),i=0;i<u.$1T.get_$B();i++){var r=u.$1T.get_$3q(i);if(r.$CA.get_$1l().EmailAddress===n){r.set_$5cF(!0);r.set_$5cF(!0)}}},$9JB:function(n){var t=n;if(t.$1e2)for(var i=0;i<t.$1e2.length;i++){_js.Trace.logInfo(_a.$0.$n7,String.format("Raw XML Mailtip Node: [{0}]",t.$1e2[i]));var r=$6uN(this,t.$1e2[i]);_h.$Br.get_$I().$53u(r,t.$4UB.EmailAddress);Array.add(this.$1Du,r)}$3Wp(this);$2hQ(this);_a.$6.$1E(this.$2Rr,null,"",t.$A6R());this.$2Rr=null},$9JA:function(n){!n.$1f||_js.$9.$18(n.$1f.message)?_js.Trace.logWarning(_a.$0.$n7,"GetMailTips action failed without server error."):_js.Trace.logWarning(_a.$0.$n7,"GetMailTips action failed with server error {0}",n.$1f.message);$3Wp(this);$2hQ(this);var t=_d.$6s.$1uo(n.$1f);t=t||"MailTipsFailure_UnknownError";_a.$6.$1E(this.$2Rr,null,t,n.$A6R(),_d.$6s.$1up(n.$1f));this.$2Rr=null},$3gm:function(){this.get_$4K4()&&this.get_$4K4()()},$2a6:function(n){for(var t=0;t<this.$12q.length;t++)if(this.$12q[t].EmailAddress===n){Array.removeAt(this.$12q,t);break}$6uP(this,n);$6uO(this,n);this.$w.$7oO()},$7vB:function(n,t){var i=JsonParser.deserialize(n);i&&_h.$Br.get_$I().$53u(i,t)}};_d.$1Aa=function(){};_d.$1Aa.prototype={};_d.$1Aa.registerEnum("_d.$1Aa",!1);_d.$QX=function(){};_d.$QX.prototype={$1Aj:!1,$5JS:null,$mp:!1,$5d8:!1,$5i2:!1,$GL:null,$7n:0,$2su:null,get_$qP:function(){this.$2su||(this.$2su=new _d.$14F);return this.$2su},set_$qP:function(n){this.$2su=n;return n}};_d.$Cn=function(n,t,i,r,u,f,e,o,s){this.$$d_$2ni=Function.createDelegate(this,this.$2ni);this.$$d_$FK=Function.createDelegate(this,this.$FK);this.$$d_$1vp=Function.createDelegate(this,this.$1vp);this.$$d_$3oM=Function.createDelegate(this,this.$3oM);this.$$d_$3Lm=Function.createDelegate(this,this.$3Lm);this.$$d_$2p8=Function.createDelegate(this,this.$2p8);_d.$Cn.initializeBase(this,[n,t,i,r,u,f,e,o,s]);_a.$4.$ou(t,0,"mode");this.$C.add_$Tm(this.$$d_$2p8);this.$2Ox=this.$7n===1||this.$7n===3?!0:!1};function $4l0(n,t,i){n.$3FW(t,i)}function $4kz(n,t,i){var r=t;if(r){var u=!!r.$5s&&!!r.$5s.response&&r.$5s.response.responseKind===-2;n.$82J(u,r.get_$gq(),r.$1f,i,Object.getType(r)===_pc.$iX)}}function $4ky(n){n.$87A();n.$3FW(null,null)}function $6r9(n){if(n.$KE){n.set_$1c4(!0);return!0}return!1}function $6r8(n){n.$EV=n.$zF.$7eA(n.$14,n.$7n);n.$EV.add_$9f6(n.$$d_$FK);n.$EV.add_$7UM(n.$$d_$2ni);n.$EV.add_$6Ix(n.$$d_$6Iw)}_d.$Cn.prototype={$EV:null,$4ST:null,$VU:null,$qD:null,$1Ct:!1,$KE:!1,$GL:null,$1Aj:!1,$6go:null,$3cP:null,$2Ox:!1,add_$2sq:function(n){this.$2N("EditCompleted",n)},remove_$2sq:function(n){this.$2P("EditCompleted",n)},get_$tj:function(){return this.$EV.get_$tj()},get_$VV:function(){return this.$EV.get_$VV()},get_$fb:function(){return this.$7n===1},get_$Ld:function(){return this.$C.get_$L()!=="Mouse"?1:0},get_$1c4:function(){return this.$1Ct},set_$1c4:function(n){if(this.$1Ct!==n){this.$1Ct=n;$3(this,"IsDiscardChangesDialogShown")}return n},get_$3ns:function(){if(!this.$qD){this.$qD=new _js.$Z;this.$qD.$D(new _a.$2G(new _C(this.$$d_$3Lm,_d.$Cn.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));this.$qD.$D(new _a.$2G(new _C(this.$$d_$3oM,_d.$Cn.$A),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$qD.$D(new _a.$2G(new _C(this.$$d_$1vp,_d.$Cn.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$qD},get_$mi:function(){return this.$EV.$14E},get_$4NF:function(){return this.$EV.$6e},get_$5bK:function(){return _d.$9L.prototype.get_$5bK.call(this)&&this.$7n!==2},get_$4SU:function(){this.$4ST||(this.$4ST=new _y.$2W(_y.$c.get_$FK(),_y.$c.get_$1jj(),_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,this.get_$tj()));return this.$4ST},get_$3gs:function(){this.$VU||(this.$VU=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,this.get_$VV()));return this.$VU},get_$40G:function(){return this.$2Ox},set_$40G:function(n){this.$2Ox=n;$3(this,"IsEnteringEditMode");return n},$49:function(){$6r8(this);this.get_$4NF()&&this.get_$4NF().set_$83h(!0);_d.$9L.prototype.$49.call(this)},$13o:function(n){if(this.get_$4NF()){this.get_$4NF().set_$2JU(n.$5JS);this.get_$4NF().$1dn=n.$5i2}this.$EV.set_$1yM(n.$5d8);var t=_a.$6.acss(_a.$0.$9k,"SetParentFolderId");if(this.$7n===3||this.$7n===2)if(n.$GL){this.$GL=n.$GL;this.$1Aj=n.$1Aj}else{this.$GL=_g.$2X.$Bi("contacts").get_$r();this.$1Aj=!0}_a.$6.aces(t)},$5XY:function(n){_d.$9L.prototype.$5XY.call(this,n);this.$EV.set_$1yM(n.get_$mi());this.$GL=n.get_$28();this.$1Aj=n.get_$3kk()},$82J:function(n,t,i,r,u){if(this.$EV.$Dv){this.$EV.set_$Dw(!1);if(i){var f=this.$7xO(u);this.get_$Cg().$32(0,f,null)}else if(t){var e=_pc.$i.$1LP(t,r===1?3:2);this.$3FW(e,null)}else r===2?this.$3FW(null,null):n&&this.get_$Cg().$32(0,_nbs.NonBootStrings.l_OfflineErrorInfoMessage_Text,null)}},$5BX:function(){this.$2ni()},$9LS:function(){this.$KE=!1},$2ni:function(){$6r9(this)||$4ky(this)},$3FW:function(n,t){$CY(this,"EditCompleted",n,t)},$87D:function(){},$5PV:function(n,t){n.val=[this.get_$4SU(),this.get_$3gs()];t.val=null},$7xO:function(n){return n?_nbs.NonBootStrings.l_SaveContactFailureMessage_Text:_nbs.NonBootStrings.l_UpdateContactFailureMessage_Text},$1RW:function(n,t){if(this.$EV.$Dv)return!0;if(this.$KE){this.$2ni();return!0}else{this.$1Q();return!1}},$4c:function(){this.$C.remove_$Tm(this.$$d_$2p8);_a.$1.prototype.$4c.call(this)},$2p8:function(n){this.$KE&&n.$1Jw(_nbs.NonBootStrings.l_PersonaCard_BrowserWindowUnloadWarning_Text)},$3Lm:function(){this.$EV.set_$Dw(!0);this.$1vp();this.$FK()},$3oM:function(){this.$1vp();$4ky(this)},$1vp:function(){this.set_$1c4(!1)}};_d.$Kb=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$9z3=Function.createDelegate(this,this.$9z3);this.$$d_$9EM=Function.createDelegate(this,this.$9EM);this.$$d_$6En=Function.createDelegate(this,this.$6En);this.$$d_$6Co=Function.createDelegate(this,this.$6Co);_d.$Kb.initializeBase(this,[n,t,i,r,u,o,s,h,c]);_a.$4.$9n(this.get_$1cj(),"ComposeGroupCard is only supported for PDLs. Specified persona is not a PDL.");_a.$4.$9n(this.$C.get_$L()==="Mouse","ComposeGroupCard is only supported for Mouse Layout.");this.$1vI=f;this.$5Tk=e;this.$1J=l};function $6rG(n){if(_js.$9.$18(n.$wg.$1vL.$HI)){_a.$4b.$32(_nbs.NonBootStrings.l_GroupNamePrompt_Text,0);n.$EV.set_$Dw(!1);return!0}return!1}function $6rF(n){n.set_$7zp(new _d.$TY(new _d.$nw(n),n.$1J));if(n.$1vI){var t=null;n.$7n===1&&(t=n.$14.get_$1l().ItemId);n.set_$9Uj(n.$1vI.$5Ei(t,new _d.$nw(n),_nbs.NonBootStrings.l_GroupCardAddMembersWatermark_Text));n.$1iK.set_$6Vq(n.get_$fb())}n.$1Ao=new _js.$Z}function $6rE(n){if(n.$1Ao)for(var t=0;t<n.$1Ao.get_$B();t++){var i=n.$1Ao.get_$3q(t);if(i&&i.$OM){var f=i.$5A.$14;var e=_d.$FM.$5EO(f);var r=new _g.$K6(new _g.$1X("PersonaMembers"));r.DeleteMemberFromPDL=e;var o=[r];var u;n.$1sF=(u=n.$1sF).concat.apply(u,o)}}}_d.$Kb.prototype={$1vI:null,$5Tk:null,$1J:null,$1Ao:null,$iH:null,$1sF:null,$1Lg:null,$wg:null,$1iK:null,$CF:null,get_$2qN:function(){return this.$1Lg},set_$2qN:function(n){if(this.$1Lg!==n){this.$1Lg=n;$3(this,"CurrentMembersCountLabel")}return n},get_$89P:function(){return this.$iH.$1xs},get_$7kk:function(){return this.$iH},set_$7kk:function(n){if(this.$iH!==n){this.$iH=n;$3(this,"EditableMembers")}return n},get_$7zp:function(){return this.$wg},set_$7zp:function(n){this.$wg=n;$3(this,"GroupCardProfileFieldsListViewModel");return n},get_$9Uj:function(){return this.$1iK},set_$9Uj:function(n){this.$1iK=n;$3(this,"PickerViewModel");return n},get_$1XS:function(){return this.$CF},set_$1XS:function(n){if(this.$CF!==n){this.$CF&&this.$CF.$u("IsNotesLoaded",this.$$d_$6Co);this.$CF=n;this.$CF&&this.$CF.$Y("IsNotesLoaded",this.$$d_$6Co);$3(this,"CardNotesViewModel")}return n},get_$1cj:function(){return!!this.$14.get_$1l()&&this.$14.get_$1l().RoutingType==="MAPIPDL"},$13o:function(n){_d.$Cn.prototype.$13o.call(this,n);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k,n.$mp));this.$7n===1&&this.$CF.$LC();$6rF(this);$1Ve(this)},$6dr:function(n){if(n){n.$OM?this.$1Ao.$D(n):this.$1Ao.$34(n);this.$KE=!0}},$FK:function(){_a.$6.stPT(_a.$0.$9t,"SaveGroup_"+this.$C.get_$L(),3);_a.$6.$1c(_a.$0.$9t,"SaveGroup");_a.$g.$2BF("VM.GroupCard.Save");var n=[];var i=this.$wg.$1Jx();n=n.concat.apply(n,i);$6rE(this);this.$1sF&&this.$1sF.length>0&&(n=n.concat.apply(n,this.$1sF));var r=this.$1iK.$1Jx();n=n.concat.apply(n,r);if(n&&n.length>0){if($6rG(this))return;var t;if(this.$7n===1)t=new _pc.$10o(this.$14.get_$6G(),n,_h.$Ap.toString(2));else{if(!this.$GL)throw Error.argumentNull("parentFolderId","Can't create group when parent folder is undefined");t=new _pc.$iX(this.$14.get_$6G(),n,new _g.$Cd(this.$GL),_h.$Ap.toString(2),this.$1Aj)}t.add_$2C(this.$$d_$6En);t.add_$1x(this.$$d_$6En);this.$k.$z(t)}else{this.$KE=!1;this.$EV.set_$Dw(!1);this.get_$VV().$n()}},$87A:function(){this.$wg&&this.$wg.$iF();this.$KE=!1},$9LS:function(){_d.$Cn.prototype.$9LS.call(this);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k));this.$CF.$LC();this.$wg&&this.$wg.$vb();this.$1iK&&this.$1iK.$9cp()},$7xO:function(n){return n?_nbs.NonBootStrings.l_SaveGroupFailureMessage_Text:_nbs.NonBootStrings.l_UpdateGroupFailureMessage_Text},$87D:function(){this.$7n===1&&this.$7l2()},$7l2:function(){this.$1Ao?this.$1Ao.$1r():this.$1Ao=new _js.$Z;this.$1sF=[];if(this.$iH){if(this.$iH.$21){this.$iH.$21.$u("TableSize",this.$$d_$9z3);this.$iH.$21.$1t.$1r()}}else{this.set_$7kk(this.$5Tk.$7cx(this.$C,this));this.$iH.$Y(_d.$4Z.$2PO,this.$$d_$9EM)}var n=_c.$cn.$E(this.$14,_d.$Ua.$3tP(this.$C));this.$iH.set_$Ho(new _c.$wC(n,null));this.set_$2qN(String.format(_nbs.NonBootStrings.l_GroupCardCurrentMembersCount_Text,0));this.$iH.$21.$Y("TableSize",this.$$d_$9z3);this.$iH.$5j()},$9z3:function(n,t){this.set_$2qN(String.format(_nbs.NonBootStrings.l_GroupCardCurrentMembersCount_Text,this.$iH.$21.$S6))},$9EM:function(n,t){$3(this,"IsEditableMembersListLoading")},$6En:function(n){$4kz(this,n,2)},$6Co:function(n,t){this.$CF.$1OG&&this.$CF.$mp&&this.$wg.$WO&&this.$wg.$WO.$9iA(this.$14.get_$Is().get_$3q(0))}};_d.$HA=function(n,t,i,r,u,f,e,o,s){this.$$d_$6En=Function.createDelegate(this,this.$6En);this.$$d_$6Co=Function.createDelegate(this,this.$6Co);_d.$HA.initializeBase(this,[n,t,i,r,u,f,e,o,s])};function $6rI(n){var t=new _d.$12q(n);n.set_$9UN(new _d.$1K(t,0));n.set_$9UO(new _d.$1K(t,1));n.set_$9UM(new _d.$1K(t,2))}function $6rJ(n){n.$dP.$vb();n.$16k.$vb();n.$o8.$vb()}function $6rK(n){var t=new _pc.$64;t.set_$rb(!0);t.set_$1o("Outlook");t.set_$q(!1);n.$14.get_$3t()||n.$14.set_$3t(new _js.$Z);if(n.$14.$5Ul()){n.$3I1=_h.$41.$2Hh();t.set_$1y(n.$14.get_$3t().get_$B().toString());n.$14.get_$3t().$D(t);n.$14.get_$U0()&&n.$14.get_$U0().$D(n.$14.get_$U0().get_$3q(0),n.$14.get_$3t().get_$B().toString())}else{n.$3I1=n.$14.$82S()?n.$14.get_$6G():_h.$41.$2Hh();for(var r=n.$14.get_$3t().get_$B(),i=0;i<r;i++){var u=n.$14.get_$3t().get_$3q(i);if(u.get_$1o()==="GAL"){t.set_$1y(i.toString());n.$14.get_$3t().set_$3q(i,t);break}}}n.$3cP=t.get_$1y()}_d.$HA.prototype={$dP:null,$16k:null,$o8:null,$CF:null,$3I1:null,get_$844:function(){return _g.$V.get_$I().get_$31().get_$7Z()==="ja-JP"},get_$8Bo:function(){return this.$7n===2&&this.get_$fl()},get_$9UN:function(){return this.$dP},set_$9UN:function(n){this.$dP=n;$3(this,"PersonaCardProfileFieldsListViewModelLeft");return n},get_$9UO:function(){return this.$16k},set_$9UO:function(n){this.$16k=n;$3(this,"PersonaCardProfileFieldsListViewModelRight");return n},get_$9UM:function(){return this.$o8},set_$9UM:function(n){this.$o8=n;$3(this,"PersonaCardProfileFieldsListViewModelBottom");return n},get_$1XS:function(){return this.$CF},set_$1XS:function(n){if(this.$CF!==n){this.$CF&&this.$CF.$u("IsNotesLoaded",this.$$d_$6Co);this.$CF=n;this.$CF&&this.$CF.$Y("IsNotesLoaded",this.$$d_$6Co);$3(this,"CardNotesViewModel")}return n},$49:function(){_d.$Cn.prototype.$49.call(this);$6rI(this);this.$7n===3&&$6rK(this);$1Ve(this)},$13o:function(n){_d.$Cn.prototype.$13o.call(this,n);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k,n.$mp));this.$7n===1&&this.$CF.$LC()},$87A:function(){this.$dP.$iF();this.$16k.$iF();this.$o8.$iF();this.$KE=!1},$9LS:function(){_d.$Cn.prototype.$9LS.call(this);$6rJ(this)},$FK:function(){_a.$6.stPT(_a.$0.$9t,"SavePersona_"+this.$C.get_$L(),3);_a.$6.$1c(_a.$0.$9t,"SaveContact");_a.$g.$2BF("VM.PersonCard.Save");var i=this.$dP.$1Jx();var u=this.$16k.$1Jx();var f=this.$o8.$1Jx();var r=i.concat.apply(i,u);var t=r.concat.apply(r,f);if(!$6(t)&&t.length>0){var n=null;if(this.$7n===1)n=new _pc.$10o(this.$14.get_$6G(),t,_h.$Ap.toString(1));else{if($6(this.$GL))throw Error.argumentNull("parentFolderId","Can't create persona when parent folder is undefined");n=new _pc.$iX(this.$7n===3?this.$3I1:this.$14.get_$6G(),t,new _g.$Cd(this.$GL),_h.$Ap.toString(1),this.$1Aj)}n.add_$2C(this.$$d_$6En);n.add_$1x(this.$$d_$6En);n.$F1=this.$8I.$9u;this.$k.$z(n)}else{this.$KE=!1;this.$EV.set_$Dw(!1);this.get_$VV().$n()}},$6En:function(n){$4kz(this,n,1)},$6Co:function(n,t){this.$CF.$1OG&&this.$CF.$mp&&this.$o8&&this.$o8.$vb()}};_d.$5D=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$9G0=Function.createDelegate(this,this.$9G0);this.$$d_$4Je=Function.createDelegate(this,this.$4Je);this.$$d_$9Ja=Function.createDelegate(this,this.$9Ja);this.$$d_$6Dy=Function.createDelegate(this,this.$6Dy);_d.$5D.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$1ax=e;this.$1D7=!!l&&l.$3u("ModernGroups")};_d.$5D.$5Rr=function(n){return!n.get_$1l()||_js.$9.$a(n.get_$1l().EmailAddress)?"":n.get_$1l().EmailAddress};function $6su(n){return n.get_$1cj()?0:0}function $6sw(n){return 1}function $6sv(n){return n.get_$1cj()?1:2}function $6sx(n,t){var i=new _c.$P7(t.$5N,t.$2EQ,t.$Ao,t.$tW,1);n.set_$N3(!0);i.add_$2m(n.$$d_$9G0);n.$k.$z(i)}function $6st(n,t,i){i.val=null;if(!$6(t)&&t.length>0){i.val=new _js.$Z;for(var r=0;r<t.length;r++)i.val.$D($6ss(n,t[r]))}}function $6ss(n,t){var i=n.$1ax.$E(t);i.add_$4NB(n.$$d_$5EF);return i}function $6sr(n){if(!$6(n.$1Rk)){n.$1Rk.$1r();n.$1Rk=null}}_d.$5D.prototype={$1D7:!1,$1Rk:null,$A9:null,$1ax:null,$CF:null,get_$1XS:function(){return this.$CF},set_$1XS:function(n){if(this.$CF!==n){this.$CF=n;$3(this,"CardNotesViewModel")}return n},get_$2y2:function(){return this.$8I.$2JK?!0:this.$14.$2Ma()||!this.get_$1cj()},get_$5bP:function(){return this.get_$Bq()===$6su(this)},get_$5bQ:function(){return this.get_$Bq()===$6sw(this)},get_$314:function(){return this.get_$Bq()===$6sv(this)},get_$8BU:function(){return this.$A9.$1xs},get_$2H9:function(){var n=_d.$7c.prototype.get_$2H9.call(this);n.$mp=this.$CF.$mp;return n},get_$3OM:function(){return this.$8I.$1ZE?!1:!this.$14.$2Ma()&&this.get_$1cj()},get_$89L:function(){return!!this.$14.get_$1l()&&this.$14.get_$1l().RoutingType.toUpperCase()==="SMTP"},get_$1cj:function(){return!!this.$14.get_$1l()&&this.$14.get_$1l().RoutingType.toUpperCase()==="MAPIPDL"},get_$7hK:function(){return this.$1D7?_nbs.NonBootStrings.l_DeleteContactListConfirmationPromptTile_Text:_nbs.NonBootStrings.l_DeleteGroupConfirmationPromptTile_Text},$49:function(){_d.$7c.prototype.$49.call(this);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k));this.$A9=new _d.$Ua(this.$C,0);this.$A9.add_$6RY(this.$$d_$6Dy);this.$A9.$Y(_d.$4Z.$2PO,this.$$d_$9Ja);var n=_d.$5D.$5Rr(this.$14);this.get_$4NF().$KW(2,n,0);$1Ve(this)},$87K:function(){this.get_$314()&&this.$CF.$LC()},$5Ru:function(){var n=_nbs.NonBootStrings.l_GroupCardMembersWithoutCountPivotOption_Text;var i=_nbs.NonBootStrings.l_GroupCardOwnersWithoutCountPivotOption_Text;var t=_nbs.NonBootStrings.l_GroupCardNotesPivotOption_Text;return this.get_$1cj()?[new _a.$5M(n,null),new _a.$5M(t,null)]:[new _a.$5M(n,null),new _a.$5M(i,null),new _a.$5M(t,null)]},$7wH:function(){return this.get_$5bQ()?24:this.get_$314()?21:this.get_$5bP()?25:100},$9LS:function(){_d.$7c.prototype.$9LS.call(this);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k));var n=_d.$5D.$5Rr(this.$14);this.get_$4NF().$KW(2,n,0)},$8CR:function(){return!0},$9gg:function(){$JA(this,[_d.$5D.$40k,_d.$5D.$40m,_d.$5D.$40l]);this.get_$314()&&this.$CF.$LC()},$87D:function(){if(this.$14.get_$1l()&&this.$14.get_$1l().ItemId||this.$14.get_$6G()){var t=_c.$cn.$E(this.$14,_d.$Ua.$3tP(this.$C));$6sx(this,t);this.$A9.set_$Ho(new _c.$wC(t,null));this.$A9.$5j()}else if(this.$14.get_$1l()&&_a.$3t.$Xv(this.$14.get_$1l().EmailAddress)){this.set_$N3(!0);var n=_pc.$14.$5EX(this.$14.get_$1l().EmailAddress,_pc.$14.$mA);n.add_$2m(this.$$d_$4Je);this.$k.$z(n)}},$6Dy:function(n,t){var i=n;if(i&&i.$11){this.$5EF(i.$11);this.$A9.set_$22(null)}},$4Je:function(n){var t=n;($6(this.$14.get_$1l())||$6(this.$14.get_$1l().ItemId))&&$6(this.$14.get_$6G())&&this.set_$N3(!1);if($6(t.$1f)&&t.$Cm.get_$B()>0){$6(this.get_$4NF())||(this.get_$4NF().$1dn=!0);var i=t.$Cm.get_$3q(0);this.set_$1s(i)}t.remove_$2m(this.$$d_$4Je)},$9G0:function(n){var t=n;this.set_$N3(!1);if(!t.$1f){var r=_a.$6.acss(_a.$0.$1vH,"SetGroupMembers");$6sr(this);var i;$6st(this,t.$1Rk,i={val:this.$1Rk});this.$1Rk=i.val;this.get_$89L()&&this.$CF.set_$Is(t.$WO);t.$CR&&this.$14.set_$6G(t.$CR);this.get_$1cj()&&this.get_$Bq()===1&&this.$CF.$LC();this.get_$4NF().$KW(1,t.$Qt,0);_a.$6.aces(r);_a.$6.$1E(null,"OpenContact");_a.$6.$1E(null,"NavigateToPeople");_a.$6.endPT("OpenPersonCard_"+this.$C.get_$L());_a.$6.endPT("NavigateToPeopleHub_"+this.$C.get_$L());$4nf(this);$2Cn(this);$JA(this,[_d.$5D.$5kN,_d.$5D.$6GR,_d.$5D.$40k,_d.$5D.$40m,_d.$5D.$40l])}},$9Ja:function(n,t){$3(this,"IsMembersListLoading")}};_d.$BQ=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9F8=Function.createDelegate(this,this.$9F8);_d.$BQ.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};function $6tF(n){n.$4Ow=new _d.$Tv(new _d.$zL(n));n.$4Ow.$9iq(n.$14);$3(n,_d.$BQ.$6Kt)}function $6tE(n,t){var i=new _g.$TN;i.Id=t.get_$2w().get_$14i();i.Sources=4;i.MaxResults=1;var r=new _c.$oY(i);r.add_$2m(n.$$d_$9F8);n.$k.$z(r)}_d.$BQ.prototype={$4Ow:null,get_$2y2:function(){return!0},get_$5cB:function(){return this.get_$Bq()===1},get_$3OM:function(){return!1},$49:function(){_d.$Nj.prototype.$49.call(this);$4mq(this,0);$1Ve(this)},$5Ru:function(){var n=new(_0365f.$o.$$(_a.$5M));n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardLocationPivotOption_Text,null));this.$14.get_$2w().get_$UT()==="PhonebookServices"&&n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardLocationInformationPivotOption_Text,null));return n.$6Z()},$87D:function(){var n=this.$14;if(n.get_$2w().get_$UT()==="PhonebookServices"&&!_js.$9.$a(n.get_$2w().get_$14i()))if(n.get_$BB()!==3){this.set_$N3(!0);$6tE(this,n)}else $6tF(this)},$9gg:function(){_d.$Nj.prototype.$9gg.call(this);$3(this,_d.$BQ.$5cC)},$7wH:function(){return this.get_$5cB()?20:this.get_$41a()?26:100},$9F8:function(n){this.set_$N3(!1);var t=n;if(!t.$1f&&t.$Cm.get_$B()===1){var i=t.$Cm.get_$3q(0);i.set_$BB(3);this.set_$1s(i)}}};_d.$12W=function(n,t,i,r){_d.$12W.initializeBase(this,[1,"VM.PersonCard.Open"]);this.set_$pG(n);this.set_$4j(t);this.set_$2NC(i);this.set_$4l(r)};_d.$12W.prototype={get_$pG:function(){return this.$U("a")},set_$pG:function(n){$1M(this,"a",n);return n},get_$4j:function(){return this.$U("loc")},set_$4j:function(n){$1M(this,"loc",n);return n},get_$2NC:function(){return this.$U("h")},set_$2NC:function(n){$1M(this,"h",n);return n},get_$4l:function(){return this.$U("t")},set_$4l:function(n){$1M(this,"t",n);return n},$3RK:function(){var n=new _a.$6U;n.$5Z("a",this.get_$pG()).$5Z("h",this.get_$2NC()).$5Z("loc",this.get_$4j()).$5Z("t",this.get_$4l());return n.toString()}};_d.$ru=function(n,t,i,r){_d.$ru.initializeBase(this,[1,"VM.Recipient.Cache"]);this.set_$pG(n);this.set_$6LR(t);this.set_$58R(i);$6(r)?this.set_$QP(-100):this.set_$QP(r)};_d.$ru.prototype={get_$pG:function(){return this.$U("A")},set_$pG:function(n){$1M(this,"A",n);return n},get_$6LR:function(){return this.$U("QL")},set_$6LR:function(n){$1M(this,"QL",n);return n},get_$58R:function(){return this.$U("CRL")},set_$58R:function(n){$1M(this,"CRL",n);return n},get_$QP:function(){return this.$U("SI")},set_$QP:function(n){$1M(this,"SI",n);return n},$3RK:function(){var n=new _a.$6U;n.$5Z("a",this.get_$pG()).$5Z("ql",this.get_$6LR()).$5Z("crl",this.get_$58R()).$5Z("si",this.get_$QP());return n.toString()}};_d.$14F=function(){};_d.$14F.prototype={$2SG:null,$BM:null,$25D:!1,$1NW:!1};_d.$FM=function(n,t,i,r,u,f){this.$$d_$4KH=Function.createDelegate(this,this.$4KH);this.$$d_$9KE=Function.createDelegate(this,this.$9KE);_d.$FM.initializeBase(this);_a.$4.$l(t,"findRecipientViewModelFactory");_a.$4.$l(i,"recipientWellViewModelFactory");_a.$4.$l(r,"personaViewModelFactory");_a.$4.$l(f,"groupCard");this.$iP=t;this.$5C=r;this.$5Tj=u;this.$3us=f;this.$2r=$6sn(this,n);this.set_$8JE(i.$7cz(_y.$w.$KH));this.$RH.$1T.add_$1Z(this.$$d_$9KE)};_d.$FM.$5EO=function(n){var t=n.get_$1l();t.RoutingType==="MAPIPDL"&&(t.EmailAddress="");t.ItemId&&(t.ItemId.ChangeKey=null);return t};function $6sn(n,t){var r=_pc.$14.$wX;n.$3IF=!1;if(n.$3us.get_$1s().get_$1F()===5){r=_pc.$14.$7tn;n.$3IF=!0}var i=n.$iP.$E(r,_pc.$14.$iZ(),!0,"PersonaDetailedView",n.$3IF,n.$5C);_d.$DJ.$1YD(i);i.$11N();i.set_$NS(t);i.set_$1jW("PersonaDetailedView");i.add_$gw(n.$$d_$4KH);return i}function $6si(n,t){var i=t.$Zu();if(n.$3IF&&!$6sm(n,i))n.get_$Cg().$32(0,_nbs.NonBootStrings.l_RecipientNotInAd_PeoplePicker_Text,null);else if(!$6sj(n,i)){var r=_pc.$i.$DQ(i);r.set_$1F(t.get_$1s().get_$1F());r.set_$6G(t.get_$1s().get_$6G());var u=$6sl(n,r);u.$1HZ=!0;n.$RH.$7Os(u,3)}}function $6sm(n,t){return t.MailboxType==="Mailbox"}function $6sj(n,t){var i=t.ItemId;return i&&t.MailboxType==="PrivateDL"&&i===n.$5Tj?!0:$6sk(n,t)}function $6sk(n,t){if(t){if(!$6(t.ItemId)&&!$6(t.ItemId.Id)){for(var e=t.ItemId.Id.toLowerCase(),r=0;r<n.$RH.$77.get_$B();r++){var i=n.$RH.$77.get_$3q(r);if(i&&!$6(i.ItemId)&&!$6(i.ItemId.Id)&&i.ItemId.Id.toLowerCase()===e)return!0}return!1}if(t.EmailAddress)for(var o=t.EmailAddress.toLowerCase(),u=0;u<n.$RH.$77.get_$B();u++){var f=n.$RH.$77.get_$3q(u);if(f&&f.EmailAddress&&f.EmailAddress.toLowerCase()===o)return!0}}return!1}function $6sl(n,t){var i=n.$5C.$SR(t,n.$RH.$1Sd,!0,1);var r=[1];i.$dk(1,r,"");return i}_d.$FM.prototype={$2r:null,$iP:null,$5C:null,$5Tj:null,$3us:null,$RH:null,$3E8:null,$3IF:!1,$1z:null,$4WH:!1,get_$8JE:function(){return this.$RH},set_$8JE:function(n){this.$RH=n;$3(this,"MembersRecipientWellViewModel");return n},get_$96u:function(){return this.$3E8},set_$96u:function(n){if(this.$3E8!==n){this.$3E8=n;$45(this,"NewlyAddedMembersCountLabel","IsNewlyAddedMembersLabelShown")}return n},get_$Cg:function(){return this.$1z||(this.$1z=new _y.$4c)},get_$8Bm:function(){return!!this.$RH&&!!this.$RH.$1T&&this.$RH.$1T.get_$B()>0},get_$6Vq:function(){return this.$4WH},set_$6Vq:function(n){this.$4WH=n;$3(this,"ShowCompactList");return n},$9cp:function(){this.$RH.$1T.$1r()},$1Jx:function(){var n=[];if(this.$RH&&this.$RH.$1T)for(var t=0;t<this.$RH.$1T.get_$B();t++){var i=this.$RH.$1T.get_$3q(t);if(i){var r=i.$5A.$14;if(r){var f=_d.$FM.$5EO(r);var u=new _g.$K6(new _g.$1X("PersonaMembers"));u.AddMemberToPDL=f;var e=[u];n=n.concat.apply(n,e)}}}return n},$4KH:function(n,t){var i=n.get_$Wh();if(!$6(i)){$6si(this,i);this.$3us.set_$1wv(!0)}},$9KE:function(n,t){this.set_$96u(String.format(_nbs.NonBootStrings.l_GroupCardNewlyAddedMembersCount_Text,this.$RH.$1T.get_$B()))}};_d.$PC=function(n,t){this.$$d_$9LT=Function.createDelegate(this,this.$9LT);_d.$PC.initializeBase(this);$6(n)&&Error.argumentNull("persona");this.$14=n;this.$6e=$6sh(this,t)};function $6sh(n,t){var i=null;i=$6(t)?new _d.$8Z(n.$14,_y.$w.$KH,!1,1):t.$SR(n.$14,_y.$w.$KH,!1,1);i.set_$1BT(!0);i.set_$DJ(!0);i.set_$Vh(new _C(n.$$d_$9LT,_a.$0.$9k));i.set_$AP(i.$1ZP);return i}_d.$PC.prototype={$14:null,$6e:null,add_$4NB:function(n){this.$2N("PersonaClicked",n)},remove_$4NB:function(n){this.$2P("PersonaClicked",n)},$9LT:function(){$Dp(this,"PersonaClicked",this.$14)}};_d.$5V=function(n,t){this.$44I=this.$$gta["_d.$5V"].T===Number||Type.isEnum(this.$$gta["_d.$5V"].T)?0:this.$$gta["_d.$5V"].T===Boolean?!1:null;this.$44I=n;this.$2sR=t};_d.$5V.$$=function(n){var i="$5V"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[i]){var t=_d[i]=function(){(this.$$gta=this.$$gta||{})["_d.$5V"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$5V.apply(this,i)};t.registerClass("_d."+i);var u=_d.$5V.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$A40=function(n){var r=null;var u=new(_0365f.$o.$$(String));if($6(n.get_$66())||!n.get_$66().length)return null;r=[];for(var t=0,e=0,o=n.get_$66().length;t<o;++t){var f=!$6(n.get_$66()[t])&&n.get_$66()[t].RoutingType==="MAPIPDL";if(!$6(n.get_$66()[t])&&(f||!_js.$9.$a(n.get_$66()[t].EmailAddress))){var i=_g.$2L.$1OZ(n.get_$66()[t])?n.get_$66()[t].OriginalDisplayName:n.get_$66()[t].EmailAddress;if(!f&&(_js.$9.$18(i)||u.$7G(i.toLowerCase())))continue;r[e++]=new(_d.$5V.$$(_g.$1l))(n.get_$66()[t],i);n.get_$66()[t].RoutingType!=="MAPIPDL"&&u.$D(i.toLowerCase())}}return r};t.$A41=function(n,t){var s=new(_0365f.$o.$$(String));var r=n.get_$fW();if($6(r)||!r.get_$B())return null;for(var h=[],f=0,c=0,l=r.get_$B();f<l;++f){var e=r.$7Rg(f);if(!$6(e)&&!$6(e.get_$1g())){var o=e.get_$1g();if(!_js.$9.$a(t)&&o.trim().toLowerCase()===t)continue;var u=o.trimStart();var i=u.toLowerCase();if(i.startsWith("sip:")){u=i.substr(4).trimStart();i=u.toLowerCase()}if(s.$71(i)<0){s.$D(i);h[c]=new(_d.$5V.$$(String))(o,u);c++}}}return h};t.$A42=function(n){var i=[];t.$Fw(n.get_$lV(),_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,n,i);t.$Fw(n.get_$11Q(),_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,n,i);t.$Fw(n.get_$sj(),_nbs.NonBootStrings.l_MobilePhoneNumber_Text,n,i);t.$Fw(n.get_$15w(),_nbs.NonBootStrings.l_MobilePhoneNumber_Text,n,i);t.$Fw(n.get_$qu(),_nbs.NonBootStrings.l_HomePhoneNumber_Text,n,i);t.$Fw(n.get_$13b(),_nbs.NonBootStrings.l_HomePhoneNumber_Text,n,i);t.$Fw(n.get_$1GB(),_nbs.NonBootStrings.l_OtherPhoneNumber_Text,n,i);t.$Fw(n.get_$1J0(),_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text,n,i);t.$Fw(n.get_$1CY(),_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text,n,i);t.$Fw(n.get_$1GA(),_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text,n,i);t.$Fw(n.get_$1G7(),_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text,n,i);t.$Fw(n.get_$19l(),_nbs.NonBootStrings.l_AssistantPhoneNumber_Text,n,i);t.$Fw(n.get_$1AB(),_nbs.NonBootStrings.l_CallbackPhoneNumber_Text,n,i);t.$Fw(n.get_$1GE(),_nbs.NonBootStrings.l_PagerPhoneNumber_Text,n,i);t.$Fw(n.get_$1Gl(),_nbs.NonBootStrings.l_RadioPhoneNumber_Text,n,i);t.$Fw(n.get_$1IH(),_nbs.NonBootStrings.l_TelexPhoneNumber_Text,n,i);t.$Fw(n.get_$1IZ(),_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text,n,i);return i};t.$Fw=function(n,t,i,r){if(!$6(n)&&n.get_$B())for(var e=0,s=r.length,h=n.get_$B();e<h;++e){var u=n.$7Rg(e);if(!$6(u)&&!$6(u.get_$1g())){var o=u.get_$1g();if(!_js.$9.$18(o.Number)){var f=h>1?_d.$2h.$2LJ(u,i,""):"";f=_js.$9.$a(f)?"":String.format(" {0}",f);var c=String.format("{0} [{1}{2}]",o.Number,t,f);r[s]=new(_d.$5V.$$(_g.$3C))(o,c);s++}}}};t.$84t="sip:"}return _d[i]};_d.$5V.prototype={$2sR:null,get_$A3z:function(){return this.$44I},get_$1sj:function(){return this.$2sR}};_d.$Pc=function(n,t,i,r,u){this.$$d_$1h8=Function.createDelegate(this,this.$1h8);this.$$d_$9RG=Function.createDelegate(this,this.$9RG);this.$$d_$9Bw=Function.createDelegate(this,this.$9Bw);_d.$Pc.initializeBase(this,[n,t,i]);this.$k=r;this.$AD=u;this.$C.get_$L()==="TouchNarrow"&&this.set_$7D($6ur(this))};_d.$Pc.$E=function(n,t,i,r,u){return new _d.$Pc(n,t,i,r,u)};function $6ur(n){var t;t=n.get_$p2().get_$2GP()?[n.get_$p2().get_$4SU(),n.get_$p2().get_$5Ht(),new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,new _C(n.$$d_$1h8,_a.$0.$1VC))]:[new _y.$2W(_y.$c.get_$11A(),_y.$c.get_$19k(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(n.$$d_$9b,_a.$0.$1VC))];return _y.$26.$Bg(n,t,null)}_d.$Pc.prototype={$k:null,$AD:null,$eA:null,get_$7VJ:function(){return this.get_$p2().get_$2GP()?new _C(this.$$d_$9Bw,_a.$0.$1VC):null},get_$p2:function(){if(!this.$eA){this.$eA=_d.$5T.$5EU(this.$C,this.$k,this.$AD);this.$eA.add_$3T8(this.$$d_$9RG)}return this.$eA},get_$8Ds:function(){return this.$C.get_$L()==="TouchWide"},get_$2sa:function(){return 15},get_$2NO:function(){return this.get_$p2().$1Nb},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);this.get_$p2().$6OB()},$7co:function(){return null},$7ep:function(){return null},$5EN:function(){return{}},$9Bw:function(){this.$C.$7X(this.get_$p2())},$9RG:function(){this.$C.get_$L()==="TouchNarrow"?this.$9b():$3(this,"ImageSource")},$1h8:function(){this.get_$p2().$1h8()||this.$9b()}};_d.$ye=function(n,t,i,r,u,f){_d.$ye.initializeBase(this,[n,t,i,r,u]);this.$2Ee=f};_d.$ye.prototype={$2Ee:!1,$7eP:function(n,t){var i=n.$2q1(2,_y.$w.$Mf,t);i.$2r.set_$R8(!1);return i},$5UV:function(){this.get_$b8().$1Bw();_d.$86.prototype.$5UV.call(this)},$6D6:function(n){this.$2Ee||this.get_$b8().$1T.$1r();_d.$86.prototype.$6D6.call(this,n)}};_d.$18k=function(n,t,i,r){this.$$d_$9Qz=Function.createDelegate(this,this.$9Qz);this.$$d_$3SW=Function.createDelegate(this,this.$3SW);_d.$18k.initializeBase(this,[n,t,i,r]);this.$6dE=new _d.$jw(_nbs.NonBootStrings.l_LinkPersonaCardUnlinkButtonText_Text,this.$$d_$3SW,this)};_d.$18k.prototype={$6dE:null,get_$45K:function(){return 0},$3SW:function(){this.set_$1PA(!0);var n=new _pc.$1El(this.get_$1s().get_$6G(),this.get_$1s().get_$3t().get_$3q(0).get_$u8());n.add_$2m(this.$$d_$9Qz);OwaApplication.$1W.$z(n)},$9Qz:function(n){var t=n;if(t.$1f)$2hG(this,t.$1f,_nbs.NonBootStrings.l_LinkPersonaCardUnlinkFailureText_Text);else{var i=t.$1V7;$2hF(this);$2hH(this,i)}this.set_$1PA(!1)}};_d.$jw=function(n,t,i){var r=this;_d.$jw.initializeBase(this,[t,_a.$0.$1Df,i,_d.$7l.$45J,function(){return!i.$34f}]);this.$2sR=n};_d.$jw.prototype={$2sR:null};_d.$7l=function(n,t,i,r){_d.$7l.initializeBase(this);_a.$4.$l(n,"personaGetter");_a.$4.$l(t,"updatePersona");_a.$4.$l(i,"closeLinkPersonaCard");_a.$4.$l(r,"showErrorMessage");this.$6Hu=n;this.$6eE=t;this.$5BS=i;this.$29L=r};_d.$7l.$3tt=function(n){var i=n.$3ub();var t;switch(i.length){case 0:t="";break;case 1:t=i[0].get_$1aS();break;default:t=String.format(_nbs.NonBootStrings.l_LinkPersonaCardSuggestedPersonaDescription_Text,i.length);break}return t};_d.$7l.$9xG=function(n,t){t.val=n[_d.$7l.$6Z7];return!$6(t.val)};function $2hH(n,t){n.$6eE(t)}function $2hF(n){n.$5BS()}function $2hG(n,t,i){var u=i;var r;var f,e;(e=_d.$7l.$9xG(t,f={val:r}),r=f.val,e)&&(_g.$7Y.$10J(r)||(u=_nbs.NonBootStrings.l_LinkPersonaCardConnectionFailureText_Text));n.$29L(u)}_d.$7l.prototype={$6eE:null,$5BS:null,$29L:null,$6Hu:null,$34f:!1,get_$1PA:function(){return this.$34f},set_$1PA:function(n){if(this.$34f!==n){this.$34f=n;$N(this,_d.$7l.$45J)}return n},get_$1s:function(){return this.$6Hu()}};_d.$R6=function(n,t,i,r,u,f){this.$$d_$7wJ=Function.createDelegate(this,this.$7wJ);this.$$d_$7Ws=Function.createDelegate(this,this.$7Ws);_d.$R6.initializeBase(this);_a.$4.$l(n,"owaShell");_a.$4.$l(i,"parentSummaryCardViewModel");_a.$4.$l(u,"persona");_a.$4.$l(f,"onLinkActionCompleted");this.$C=n;this.$zD=t;this.$2od=new _C(this.$$d_$7Ws,_d.$R6.$A);this.$1vh=new _d.$8Z(u,2,!1,3);this.$1NT=new _d.$8Z(u,8,!1);this.$1NT.$KW(1,_d.$7l.$3tt(u),0);this.$WT=$6t7(this,u);this.$WT.$1Hu(u);this.$PU=new _y.$4c;var o=this;var e=function(n){o.$PU.$32(0,n,null)};r?r===1?this.$14d=new _d.$18m(i.$14,this.$$d_$7wJ,f,this.$$d_$7Ws,e):r===2&&(this.$14d=new _d.$19E(i.$14,this.$$d_$7wJ,f,this.$$d_$7Ws,e)):this.$14d=new _d.$18k(this.$$d_$7wJ,f,this.$$d_$7Ws,e);this.$3HU=i;this.set_$7D(this.$1YQ())};function $6t7(n,t){var i=new _d.$Ha;i.$9u=9;if(n.$C.get_$L()!=="TouchNarrow"){i.$2s1=!0;i.$1ZE=!0}i.$1M2=!0;i.$2JM=!0;return n.$zD.$E(i,0)}_d.$R6.prototype={$C:null,$zD:null,$14d:null,$2od:null,$1vh:null,$1NT:null,$WT:null,$PU:null,$3HU:null,get_$1xz:function(){return this.$C.get_$L()==="Mouse"},get_$8AU:function(){return!this.$14d.get_$45K()},get_$8Aq:function(){return this.$14d.get_$45K()===1},get_$8Ah:function(){return this.$14d.get_$45K()===2},get_$9y5:function(){return this.$14d.$6dE},get_$7Mk:function(){return this.$14d.$52w},get_$8Ht:function(){return this.$14d.$5j3},get_$9a4:function(){return this.$14d.$6Mb},$7Ws:function(){if(_d.$R6.isInstanceOfType(this.$3HU.get_$4i().get_$7u())){this.$WT.$1Q();this.$3HU.$1Xr();this.$3HU.get_$4i().$Bs()}},$7wJ:function(){return this.$WT.$7R.$14}};_d.$dL=function(n,t,i,r,u,f){_d.$dL.initializeBase(this,[n,t,i,r,u,f])};_d.$dL.prototype={get_$Ld:function(){return this.$C.get_$L()==="TouchWide"?1:this.$C.get_$L()==="TouchNarrow"?2:0},$1YQ:function(){if(this.$C.get_$L()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,this.$2od);return _y.$26.$Bg(this,n,null)}else if(this.$C.get_$L()==="TouchNarrow"){var t=_y.$26.$Bg(this);t.$hX(this.$2od);return t}return null}};_d.$18m=function(n,t,i,r,u){this.$$d_$9N6=Function.createDelegate(this,this.$9N6);this.$$d_$99B=Function.createDelegate(this,this.$99B);this.$$d_$9a3=Function.createDelegate(this,this.$9a3);this.$$d_$7Mj=Function.createDelegate(this,this.$7Mj);_d.$18m.initializeBase(this,[t,i,r,u]);_a.$4.$l(n,"originalPersona");this.$2Xv=n;this.$52w=new _d.$jw(_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$7Mj,this);this.$6Mb=new _d.$jw(_nbs.NonBootStrings.l_LinkPersonaCardRejectSuggestionButtonText_Text,this.$$d_$9a3,this)};_d.$18m.prototype={$2Xv:null,$52w:null,$6Mb:null,get_$45K:function(){return 1},$7Mj:function(){this.set_$1PA(!0);var n=new _pc.$112(this.$2Xv.get_$6G(),this.get_$1s().get_$6G());n.add_$2m(this.$$d_$99B);OwaApplication.$1W.$z(n)},$99B:function(n){var t=n;if(t.$1f)$2hG(this,t.$1f,_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionFailureText_Text);else{var i=t.$1V7;$2hF(this);$2hH(this,i)}this.set_$1PA(!1)},$9a3:function(){this.set_$1PA(!0);var n=new _pc.$1BO(this.$2Xv.get_$6G(),this.get_$1s().get_$6G());n.add_$2m(this.$$d_$9N6);OwaApplication.$1W.$z(n)},$9N6:function(n){var t=n;if(t.$1f)$2hG(this,t.$1f,_nbs.NonBootStrings.l_LinkPersonaCardRejectSuggestionFailureText_Text);else{var i=t.$1V7;$2hF(this);$2hH(this,i)}this.set_$1PA(!1)}};_d.$Jr=function(){this.$$d_$9GF=Function.createDelegate(this,this.$9GF);_d.$Jr.initializeBase(this);this.$Au()};function $6t9(n,t,i){_a.$4.$l(t,"personaId");var r=$6(i)||!i.length?3:2;$2hI(n,r,t,i,null)}function $6t8(n,t,i){_a.$4.$l(t,"personaId");$2hI(n,4,t,null,i)}function $2hI(n,t,i,r,u){var f=!1;if(n.$Dn!==t){n.$Dn=t;f=!!(f|!0)}if(n.$CR!==i){n.$CR=i;f=!!(f|!0)}if(n.$P7!==r){n.$P7=r;f=!!(f|!0)}if(n.$1f!==u){n.$1f=u;f=!!(f|!0)}f&&$45(n,"LinkSuggestionIdsStatusText","LinkSuggestionsAvailable")}_d.$Jr.prototype={$Dn:0,$CR:null,$P7:null,$1f:null,get_$8G1:function(){switch(this.$Dn){case 0:case 1:return _u.Strings.l_LoadingWithEllipses_Text;case 2:return _nbs.NonBootStrings.l_PersonaCardSuggestionsAvailable_Text;case 3:return _nbs.NonBootStrings.l_LinkSummaryCardNoSuggestionsText_Text;case 4:return _nbs.NonBootStrings.l_LinkSummaryCardGetSuggestionsFailureText_Text;default:throw Error.invalidOperation("LinkSuggestionIdsViewModel are in an unknown status: "+this.$Dn);}},get_$8G3:function(){return this.$Dn===2},get_$8G2:function(){return this.$Dn===1},$Au:function(){$2hI(this,0,null,null,null)},$7yI:function(n){_a.$4.$l(n,"newPersonaId");if(!this.$Dn||n!==this.$CR){$2hI(this,1,n,null,null);var t=new _pc.$163(n);t.add_$2m(this.$$d_$9GF);OwaApplication.$1W.$z(t)}},$9GF:function(n){var t=n;_0365f.$2t.$4N(t.$CR,this.$CR)&&(t.$1f?$6t8(this,this.$CR,t.$1f):$6t9(this,this.$CR,t.$P7))}};_d.$5J=function(n,t,i){this.$$d_$4Je=Function.createDelegate(this,this.$4Je);this.$$d_$9GN=Function.createDelegate(this,this.$9GN);this.$$d_$6Bs=Function.createDelegate(this,this.$6Bs);this.$$d_$3Pu=Function.createDelegate(this,this.$3Pu);this.$$d_$To=Function.createDelegate(this,this.$To);this.$$d_$5LE=Function.createDelegate(this,this.$5LE);this.$$d_$9OI=Function.createDelegate(this,this.$9OI);this.$$d_$9QB=Function.createDelegate(this,this.$9QB);this.$$d_$9Ca=Function.createDelegate(this,this.$9Ca);this.$$d_$9IW=Function.createDelegate(this,this.$9IW);this.$$d_$3iH=Function.createDelegate(this,this.$3iH);_d.$5J.initializeBase(this);_a.$4.$l(n,"owaShell");_a.$4.$l(t,"linkPersonaCardViewModelFactory");_a.$4.$l(i,"persona");this.$C=n;this.$34g=t;this.$2Gz=new _C(this.$$d_$3iH,_d.$5J.$A);this.$PU=new _y.$4c;this.$2H7=new _js.$Z;this.set_$6Xl(!0);this.$cn=new _d.$Jr;this.$cn.$Y("LinkSuggestionsAvailable",this.$$d_$9IW);this.$kq=new _js.$Z;this.$1jt=new _js.$Z;this.$6U4(i);this.set_$7D(this.$1YQ());this.set_$1rc("");this.$5CC=new _C(this.$$d_$9Ca,_d.$5J.$A);this.$6Zn=new _C(this.$$d_$9QB,_d.$5J.$A);this.$6Qv=new _C(this.$$d_$9OI,_d.$5J.$A)};function $4lk(n){n.$cn.$Au();n.$cn.$7yI(n.$14.get_$6G())}function $4ll(n,t){if(n.$14!==t||!n.$34n){n.$34n=!0;n.$14=t;n.set_$83B(new _d.$8Z(t,2,!1,3));n.set_$83G(new _d.$8Z(t,4,!1));$6tA(n);n.set_$9q8(String.format(_nbs.NonBootStrings.l_LinkSummaryCardSingleComponentText_Text,n.$1NT.$GQ));n.$To()}}function $6tA(n){n.$4NC=new _pc.$UX(n.$14);n.$2H7.$1r();for(var t=0;t<n.$4NC.$1L0.length;t++){var i=n.$4NC.$1L0[t];n.$2H7.$D($3WX(n,i,_d.$7l.$3tt(i),n.$$d_$9Ca))}n.set_$6Xl(n.$2H7.get_$B()===1)}function $6tB(n){if(!n.$cn.get_$8G2()){var f=!1;if($6(n.$cn.$P7))n.$kq.$1r();else{for(var t=0;t<n.$kq.get_$B();t++){for(var c=n.$kq.get_$3q(t),l=c.get_$1s().get_$6G(),e=!1,i=0;i<n.$cn.$P7.length;i++){var a=n.$cn.$P7[i];if(_0365f.$2t.$4N(a,l)){e=!0;break}}if(!e){n.$kq.$68(t);t--}}for(var r=0;r<n.$cn.$P7.length;r++){for(var o=n.$cn.$P7[r],s=!0,u=0;u<n.$kq.get_$B();u++){var v=n.$kq.get_$3q(u);var y=v.get_$1s().get_$6G();if(_0365f.$2t.$4N(o,y)){s=!1;break}}if(s){f=!0;var h=_pc.$Jj.$7fV(o);h.add_$2m(n.$$d_$9GN);OwaApplication.$1W.$z(h)}}}f||_a.$6.$1E(null,"PersonCard.ContactLinking")}}function $6tC(n,t){if($6(t.$1f)){var r=t.get_$17M();n.$1jt.$1r();for(var i=0;i<r.get_$B();i++){var u=r.get_$3q(i);_0365f.$2t.$4N(u.get_$6G(),n.$14.get_$6G())||n.$1jt.$D($3WX(n,u,"",n.$$d_$9OI))}if(n.$1jt.get_$B()){n.set_$1rc("");$6C(n,"SearchCompletedWithResults")}else n.set_$1rc(_nbs.NonBootStrings.l_NoMatchFound_Text)}else n.set_$1rc(_nbs.NonBootStrings.l_ServerSearchError_Text)}function $3WX(n,t,i,r){var u=new _d.$8Z(t,10,!1,1,null,n.$C,!0);u.$KW(1,i,0);u.set_$AP(new _C(r,_d.$5J.$A));u.set_$DJ(!0);return u}function $1nc(n,t){n.get_$4i().$Bt(t)}_d.$5J.prototype={$C:null,$34g:null,$2Gz:null,$5CC:null,$6Zn:null,$6Qv:null,$PU:null,$cn:null,$14:null,$1vh:null,$1NT:null,$4NC:null,$2H7:null,$kq:null,$1jt:null,$3PK:!1,$3PL:null,$34n:!1,$KA:null,$1m:null,$3pd:null,$12v:null,$3lk:null,$28F:null,$28P:null,$28O:null,add_$6Qi:function(n){this.$2N("SearchCompletedWithResults",n)},remove_$6Qi:function(n){this.$2P("SearchCompletedWithResults",n)},get_$83B:function(){return this.$1vh},set_$83B:function(n){if(this.$1vh!==n){this.$1vh=n;$3(this,_d.$5J.$5VT)}return n},get_$83G:function(){return this.$1NT},set_$83G:function(n){if(this.$1NT!==n){this.$1NT=n;$3(this,_d.$5J.$5VX)}return n},get_$7lz:function(){this.$3pd||(this.$3pd=new _C(this.$$d_$5LE,_d.$5J.$A));return this.$3pd},get_$1xz:function(){return this.$C.get_$L()==="Mouse"},get_$Ys:function(){if(!this.$1m){this.$1m=new _y.$6b(this.$C.get_$L());this.$1m.set_$R8(!1);this.$1m.set_$q(!1);this.$1m.set_$NS(_nbs.NonBootStrings.l_LinkSummaryCardFindContact_Text);this.$1m.set_$VV(new _C(this.$$d_$To,_d.$5J.$A));this.$1m.set_$If(new _C(this.$$d_$3Pu,_d.$5J.$A));var n=this;this.$1m.$Y("IsExpanded",function(t,i){n.$1m.$2S||n.get_$Ys().set_$HW(!1)})}return this.$1m},get_$7V8:function(){return _nbs.NonBootStrings.l_LinkSummaryCardDisplayName_Text},get_$6RQ:function(){return this.$28F},set_$6RQ:function(n){if(this.$28F!==n){this.$28F=n;$3(this,"SelectedComponentItem");this.$C.get_$L()==="TouchNarrow"&&n&&$1nc(this,this.$1rP(0,n.get_$1s(),this.$$d_$6Bs))}return n},get_$6Rn:function(){return this.$28P},set_$6Rn:function(n){if(this.$28P!==n){this.$28P=n;$3(this,"SelectedSuggestionItem");this.$C.get_$L()==="TouchNarrow"&&n&&$1nc(this,this.$1rP(1,n.get_$1s(),this.$$d_$6Bs))}return n},get_$6Rl:function(){return this.$28O},set_$6Rl:function(n){if(this.$28O!==n){this.$28O=n;$3(this,"SelectedSearchItem");this.$C.get_$L()==="TouchNarrow"&&n&&$1nc(this,this.$1rP(2,n.get_$1s(),this.$$d_$6Bs))}return n},get_$7V7:function(){return _nbs.NonBootStrings.l_LinkSummaryCardDescription_Text},get_$7Xi:function(){return _nbs.NonBootStrings.l_LinkSummaryCardComponentsHeader_Text},get_$7Xh:function(){return _nbs.NonBootStrings.l_LinkSummaryCardComponentsDescription_Text},get_$6Xl:function(){return this.$3PK},set_$6Xl:function(n){if(this.$3PK!==n){this.$3PK=n;$3(this,_d.$5J.$6Xm)}return n},get_$9q8:function(){return this.$3PL},set_$9q8:function(n){if(this.$3PL!==n){this.$3PL=n;$3(this,_d.$5J.$6Xn)}return n},get_$9sp:function(){return _nbs.NonBootStrings.l_LinkSummaryCardSuggestionsHeader_Text},get_$9so:function(){return _nbs.NonBootStrings.l_LinkSummaryCardSuggestionsDescription_Text},get_$8Hv:function(){return _nbs.NonBootStrings.l_LinkSummaryCardManualLinkTitle_Text},get_$1rc:function(){return this.$3lk},set_$1rc:function(n){this.$3lk=n;$3(this,"CurrentSearchPeopleMessage");return n},get_$1iT:function(){return 0},get_$2MT:function(){return null},get_$89:function(){return this.$KA},set_$89:function(n){this.$KA=n;return n},get_$7iz:function(){return!0},$6U4:function(n){_a.$4.$l(n,"newPersona");$4ll(this,n);$4lk(this)},$1Xr:function(){this.set_$6RQ(null);this.set_$6Rn(null);this.set_$6Rl(null)},$6Bs:function(n){_a.$4.$l(n,"newPersona");$4ll(this,n);$4lk(this)},$3iH:function(){$6(this.get_$89())||_d.$R6.isInstanceOfType(this.get_$4i().get_$7u())?this.get_$4i().$Bs():this.get_$89()()},$9IW:function(n,t){$6tB(this)},$9GN:function(n){var i=n;if(i.$1f){if(this.$34n){this.$PU.$32(0,_nbs.NonBootStrings.l_LinkSummaryCardGetSuggestionsFailureText_Text,null);this.$3iH();this.$34n=!1}return}var f=!1;if(!$6(this.$cn.$P7)&&this.$cn.$P7.length>0)for(var r=0;r<this.$cn.$P7.length;r++){var o=this.$cn.$P7[r];if(_0365f.$2t.$4N(o,i.$CR)){f=!0;break}}if(f){for(var u=i.$14,e=$3WX(this,u,_d.$7l.$3tt(u),this.$$d_$9QB),t=0;t<this.$kq.get_$B();t++){var s=this.$kq.get_$3q(t);if(_0365f.$2t.$4N(s.get_$1s().get_$6G(),u.get_$6G())){this.$kq.$68(t);this.$kq.$72(t,e);return}}this.$kq.$D(e)}this.$cn.$P7.length===this.$kq.get_$B()&&_a.$6.$1E(null,"PersonCard.ContactLinking")},$3Pu:function(){if(!_js.$9.$18(this.get_$Ys().$2s)){var n=_pc.$14.$7tm(this.get_$Ys().$2s);this.$12v=n;this.$12v.add_$2m(this.$$d_$4Je);this.set_$1rc(_u.Strings.l_ListViewModelDefaultLoadingMessage_Text);this.$1jt.$1r();OwaApplication.$1W.$z(this.$12v)}},$4Je:function(n){if($6(n.$1f)&&$6(n.get_$17M()))throw Error.invalidOperation("The response is not processed correctly!");n===this.$12v&&$6tC(this,n);n.remove_$2m(this.$$d_$4Je)},$5LE:function(){this.get_$Ys().set_$4L(!0);this.get_$Ys().set_$HW(!0)},$To:function(){this.set_$1rc("");this.$1jt.$1r();this.get_$Ys().set_$4L(!1);this.get_$Ys().set_$Ac("");this.get_$Ys().set_$HW(!1);this.$12v=null},$9Ca:function(){this.$28F&&this.$C.get_$L()!=="TouchNarrow"&&$1nc(this,this.$1rP(0,this.$28F.get_$1s(),this.$$d_$6Bs))},$9QB:function(){this.$28P&&this.$C.get_$L()!=="TouchNarrow"&&$1nc(this,this.$1rP(1,this.$28P.get_$1s(),this.$$d_$6Bs))},$9OI:function(){this.$28O&&this.$C.get_$L()!=="TouchNarrow"&&$1nc(this,this.$1rP(2,this.$28O.get_$1s(),this.$$d_$6Bs))}};_d.$Xh=function(n,t,i){_d.$Xh.initializeBase(this,[n,t,i])};_d.$Xh.prototype={get_$Ld:function(){return this.$C.get_$L()==="TouchWide"?1:this.$C.get_$L()==="TouchNarrow"?2:0},$1rP:function(n,t,i){return this.$34g.$E(this,n,t,i)},$1YQ:function(){if(this.$C.get_$L()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_u.Strings.l_Discard_Text,this.$2Gz);return _y.$26.$Bg(this,n,null)}else if(this.$C.get_$L()==="TouchNarrow")return _y.$26.$E(this);return null}};_d.$19E=function(n,t,i,r,u){this.$$d_$6Bs=Function.createDelegate(this,this.$6Bs);this.$$d_$8Hu=Function.createDelegate(this,this.$8Hu);_d.$19E.initializeBase(this,[t,i,r,u]);_a.$4.$l(n,"originalPersona");this.$2Xv=n;this.$5j3=new _d.$jw(_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$8Hu,this)};_d.$19E.prototype={$2Xv:null,$5j3:null,get_$45K:function(){return 2},$8Hu:function(){this.set_$1PA(!0);var n=new _pc.$18l(this.$2Xv.get_$6G(),this.get_$1s().get_$6G());n.add_$2m(this.$$d_$6Bs);OwaApplication.$1W.$z(n)},$6Bs:function(n){var t=n;if(t.$1f)$2hG(this,t.$1f,_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionTwoGALContactsFailure_Text);else{var i=t.$1V7;$2hF(this);$2hH(this,i)}this.set_$1PA(!1)}};_d.$Nj=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9JH=Function.createDelegate(this,this.$9JH);this.$35f=_d.$Nj.$4c3;_d.$Nj.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$jD=e};function $4mq(n,t){n.$35f=t}_d.$Nj.prototype={$jD:null,$1Dl:null,$20G:null,$1PS:null,$46U:null,$46S:null,get_$1zt:function(){!this.$1Dl&&this.get_$1Dw()&&(this.$1Dl=this.$jD.$3kF(this.get_$1Dw().get_$3q(0),!0));return this.$1Dl},get_$1Dw:function(){this.$20G||(this.$20G=this.$14.$5RM());return this.$20G},get_$46X:function(){this.get_$1Dw()&&(this.$1PS=this.get_$1Dw().get_$3q(0).get_$2Rz());return this.$1PS},get_$41a:function(){return this.$35f===_d.$Nj.$4c3?!1:this.get_$Bq()===this.$35f},get_$5cH:function(){return!this.get_$fl()&&this.get_$5cw()||this.get_$mi()},get_$5cw:function(){return this.$8I.$9u===2},$49:function(){_d.$7c.prototype.$49.call(this);this.$46S=new _C(this.$$d_$9JH,_a.$0.$4j);this.$46S.set_$5u(!this.get_$1CX()&&!this.get_$5cH());this.$46U="";(this.get_$fc()&&!this.get_$5cw()&&!this.get_$1yH()||this.get_$1DL()||this.$C.get_$L()==="TouchNarrow")&&(this.$46U="mapErrorMessage")},$9gg:function(){$3(this,"IsMapPivotSelected")},$9JH:function(){this.get_$fl()?this.get_$1Dw()&&this.$C.$7X(this.get_$1zt()):this.get_$9VC().$n()}};_d.$UN=function(n,t,i){this.$$d_$9LW=Function.createDelegate(this,this.$9LW);_d.$UN.initializeBase(this);this.$14=n;this.$56S=t;this.$6e=$6v1(this,i)};function $6v1(n,t){var i=null;i=$6(t)?new _d.$8Z(n.$14,_y.$w.$1dY,!1,1):t.$SR(n.$14,_y.$w.$1dY,!1,1);i.set_$1BT(!0);i.set_$DJ(!0);i.set_$Vh(new _C(n.$$d_$9LW,_a.$0.$9k));i.set_$AP(i.$1ZP);i.$KW(1,n.$14.get_$4v(),0);return i}_d.$UN.prototype={$14:null,$6e:null,$56S:0,add_$6Hq:function(n){this.$2N("PersonaDoubleClicked",n)},remove_$6Hq:function(n){this.$2P("PersonaDoubleClicked",n)},get_$7Qm:function(){switch(this.$56S){case 1:return _d.$3.get_$7Qw();case 2:return _d.$3.get_$7Qv();default:return _y.$3.get_$O1()}},$9LW:function(){$Dp(this,"PersonaDoubleClicked",this.$14)}};_d.$4f=function(n,t,i){this.$$d_$6Hq=Function.createDelegate(this,this.$6Hq);this.$$d_$9GE=Function.createDelegate(this,this.$9GE);_d.$4f.initializeBase(this);this.$2V=n;this.$16j=t;this.$2Xq=i;this.$317=!1};function $2hW(n,t){return $6(t)||!t.get_$B()}function $6v2(n){if(!$6(n.$14p)){n.$14p.$1r();n.$14p=null}if(!$6(n.$14q)){n.$14q.$1r();n.$14q=null}if(!$6(n.$16c)){n.$16c.$1r();n.$16c=null}if(!$6(n.$12K)){n.$12K.$1r();n.$12K=null}}function $3Wy(n,t,i,r){r.val=null;if(!$6(t)){r.val=new _js.$Z;for(var u=0;u<t.length;u++){var f=0;switch(i){case 1:u>0&&(f=1);break;case 2:n.$2v4===t[u].get_$qc()&&(f=2);break}r.val.$D($4nA(n,t[u],f))}}}function $4nA(n,t,i){var r=null;r=$6(n.$2Xq)?new _d.$UN(t,i,null):n.$2Xq.$E(t,i);n.$2V.get_$2PM()||r.add_$6Hq(n.$$d_$6Hq);return r}_d.$4f.prototype={$2V:null,$16j:null,$2Xq:null,$327:!1,$2v4:null,$12K:null,$16c:null,$14p:null,$14q:null,$317:!1,get_$9ow:function(){return this.$2V.get_$Bq()===2&&this.$317},get_$5cm:function(){return this.$327},set_$5cm:function(n){if(this.$327!==n){this.$327=n;$3(this,_d.$4f.$5cn)}return n},get_$83i:function(){return $2hW(this,this.$12K)},get_$840:function(){return $2hW(this,this.$14p)},get_$841:function(){return $2hW(this,this.$14q)},get_$84A:function(){return $2hW(this,this.$16c)},add_$6Fb:function(n){this.$2N(_d.$4f.$3Gw,n)},remove_$6Fb:function(n){this.$2P(_d.$4f.$3Gw,n)},$7vt:function(n){this.$2v4=n;if(!_js.$9.$a(n)){var i=_a.$6.acss(_a.$0.$9k,"GetOrganizationHierarchy");this.set_$5cm(!0);var t=new _pc.$Lo(n);t.add_$2m(this.$$d_$9GE);t.$F1=this.$2V.$8I.$9u;OwaApplication.$1W.$z(t);_a.$6.aces(i)}},$9GE:function(n){var t=n;$6v2(this);var i;$3Wy(this,t.$12K,0,i={val:this.$12K});this.$12K=i.val;var r;$3Wy(this,t.$14p,1,r={val:this.$14p});this.$14p=r.val;var u;$3Wy(this,t.$16c,2,u={val:this.$16c});this.$16c=u.val;if(!$6(t.$14q)){this.$14q=new _js.$Z;this.$14q.$D($4nA(this,t.$14q,1))}this.$317=!0;$JA(this,[_d.$4f.$5Iy,_d.$4f.$6HK,_d.$4f.$5j0,_d.$4f.$5j2,_d.$4f.$5bT,_d.$4f.$5W1,_d.$4f.$5Vr,_d.$4f.$5Vu,_d.$4f.$5Vm,_d.$4f.$6Wc]);this.set_$5cm(!1);$6C(this,_d.$4f.$3Gw)},$6Hq:function(n){this.$16j.$1Hu(n)}};_d.$7n=function(n,t,i,r,u){this.$$d_$9V9=Function.createDelegate(this,this.$9V9);this.$$d_$9Cb=Function.createDelegate(this,this.$9Cb);this.$$d_$9LR=Function.createDelegate(this,this.$9LR);this.$$d_$9ES=Function.createDelegate(this,this.$9ES);this.$$d_$9Mi=Function.createDelegate(this,this.$9Mi);this.$$d_$99W=Function.createDelegate(this,this.$99W);this.$$d_$2yA=Function.createDelegate(this,this.$2yA);this.$$d_$3kc=Function.createDelegate(this,this.$3kc);this.$$d_$7dl=Function.createDelegate(this,this.$7dl);this.$$d_$7dk=Function.createDelegate(this,this.$7dk);this.$$d_$7dm=Function.createDelegate(this,this.$7dm);_d.$7n.initializeBase(this);this.$C=u;this.$1J=r;this.$ln=n;this.$2ZV=t;this.$o9=i;this.$6Hj=new _y.$FB};function $3X1(n,t,i,r){var u;switch(i){case 3:u="AddPersonaCardViewModel";break;case 2:u="CreatePersonaCardViewModel";break;case 1:u="EditPersonaCardViewModel";break;default:throw Error.invalidOperation(String.format("Cannot call CreateAndShowComposeCardViewModel with mode not in (Add,Create,Edit). Actual value = {0}",i));}var e=_a.$6.acsa(_a.$0.$9k,u,!0);var f=n.$ln;if(i===1||i===3){f=new _d.$Ha;f.$9u=n.$ln.$9u}r=r||new _d.$QX;r.$7n=i;$Dp(n,"BeforeComposeCardCreate",r);var o=this;n.$o9.$7bc(t,i,null,null,f,n,function(t){$6vI(n,t,r,e)})}function $6vI(n,t,i,r){_a.$6.acea(r);if(n.$d){n.$Ev.$5XY(n.$d);n.$d=null}n.set_$vV(t);n.$Ev.$13o(i);if(n.$C.get_$9A()||t.$7n!==2){var u=_a.$6.acss(_a.$0.$9k,"OwaShell.PopUp");n.$C.$7X(n.$Ev);_a.$6.aces(u)}else n.$6Hj.$MN(n.$Ev);(n.$Ev.$7n===3||n.$Ev.$7n===1)&&n.$1AO(n.$Ev)}function $4nH(n){var t=_a.$6.$1c(_a.$0.$9k,"PersonCard.Popout",!0);if(n.$C.get_$L()!=="Mouse")throw Error.invalidOperation("Persona/Group Card can only be popped out in MUI");var i=$6vH(n);if(n.get_$1Uv().$7n){n.$Ev.$KE=!1;n.$Ev.get_$VV().$n()}n.get_$1Uv().$5BX();n.$C.$MH(_d.$K5,null,null,_y.$48.get_$9k(),i,!1);_a.$6.$1E(t);_d.$6t.$fw(32,8,n.get_$1Uv().$14.get_$1F())}function $6vH(n){var t=new _d.$5W(n.get_$1Uv(),n.get_$1Uv().$7n);if(n.get_$1Uv().get_$4NF()){t.set_$8FY(n.get_$1Uv().get_$4NF().$NA);t.set_$O5(n.get_$1Uv().get_$4NF().get_$O5())}if(n.$Ev){t.set_$28(n.$Ev.$GL);t.set_$3kk(n.$Ev.$1Aj)}else t.set_$Bq(n.$7R.get_$Bq());t.set_$mi(!0);t.set_$fc(!1);return t}function $4nG(n,t,i,r){_a.$6.acea(r);var u=!1;if(n.$d){u=!0;t.$5XY(n.$d);n.$d=null}n.set_$kN(t);i&&$4nF(n,u)}function $4nF(n,t){if(n.$2ZV===3)if(t)n.set_$42W(!0);else{n.$7R.$6v.set_$1yM(!0);n.$7R.$6Iw()}else if(n.$2ZV)if(n.$2ZV===1&&n.get_$8Cr()){var i=_a.$6.acss(_a.$0.$9k,"OwaShell.PopUp");n.$C.$fC(n.$7R,1,!1);_a.$6.aces(i)}else{var r=_a.$6.acss(_a.$0.$9k,"OwaShell.PopUp");n.$C.$7X(n.$7R);_a.$6.aces(r)}else n.set_$42W(!0)}function $2hX(n,t){var i="";t===1?i="NewContact":t===2?i="NewGroup":t===5&&(i="NewModernGroup");_a.$6.stPT(_a.$0.$9t,i,3);_a.$6.$1c(_a.$0.$9t,i);var r=_pc.$i.$3lB();r.set_$1F(t);if(t===2){r.set_$1l(new _g.$1l);r.get_$1l().RoutingType="MAPIPDL"}n.$2cf(r,null)}_d.$7n.prototype={$C:null,$1J:null,$o9:null,$6Hj:null,$1z:null,$7R:null,$Ev:null,$1gc:null,$31v:!1,$2ZV:0,$ln:null,$d:null,$1co:!1,add_$6Hn:function(n){this.$2N("PersonaCreated",n)},remove_$6Hn:function(n){this.$2P("PersonaCreated",n)},add_$2ox:function(n){this.$2N("ComposeCardChanged",n)},remove_$2ox:function(n){this.$2P("ComposeCardChanged",n)},add_$5CG:function(n){this.$2N("ComposeCardChanging",n)},remove_$5CG:function(n){this.$2P("ComposeCardChanging",n)},add_$57a:function(n){this.$2N("BeforeComposeCardCreate",n)},remove_$57a:function(n){this.$2P("BeforeComposeCardCreate",n)},add_$1Gp:function(n){this.$2N("ReadCardChanged",n)},remove_$1Gp:function(n){this.$2P("ReadCardChanged",n)},add_$2ZU:function(n){this.$2N("ReadCardChanging",n)},remove_$2ZU:function(n){this.$2P("ReadCardChanging",n)},get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},get_$96q:function(){if(!this.$1gc){this.$1gc=new _js.$Z;var n=!!this.$1J&&this.$1J.$3u("ModernGroups");this.$1gc.$D(new _a.$2G(new _C(this.$$d_$7dk,_d.$7n.$A),_nbs.NonBootStrings.l_CreateContactString_LowerCase_Text,null));this.$C.get_$L()==="Mouse"&&this.$1gc.$D(new _a.$2G(new _C(this.$$d_$7dl,_d.$7n.$A),n?_nbs.NonBootStrings.l_CreateContactListString_LowerCase_Text:_nbs.NonBootStrings.l_CreateGroupString_LowerCase_Text,null));n&&this.$1gc.$D(new _a.$2G(new _C(this.$$d_$3kc,_d.$7n.$A),_nbs.NonBootStrings.l_CreateGroupString_LowerCase_Text,null));this.$1gc.$D(new _a.$2G(new _C(this.$$d_$2yA,_d.$7n.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$1gc},get_$41x:function(){return this.$31v},set_$41x:function(n){if(this.$31v!==n){this.$31v=n;$3(this,"IsNewDialogShown")}return n},get_$42W:function(){return this.$1co},set_$42W:function(n){if(this.$1co===n)return n;this.$1co=n;$3(this,"IsReadCardVisible");this.$7R.set_$DX(this.$1co);return n},get_$kN:function(){return this.$7R},set_$kN:function(n){if(this.$7R===n)return n;$6C(this,"ReadCardChanging");if(this.$7R){this.set_$42W(!1);this.$7R.remove_$54W(this.$$d_$99W);this.$7R.remove_$2YT(this.$$d_$9Mi);this.$7R.$6v.remove_$5KC(this.$$d_$9ES);this.$7R.$u("IsVisible",this.$$d_$9LR);this.$7R.$1Q()}this.$7R=n;if(this.$7R){this.$7R.$Y("IsVisible",this.$$d_$9LR);this.$7R.add_$54W(this.$$d_$99W);this.$7R.add_$2YT(this.$$d_$9Mi);this.$7R.$6v.add_$5KC(this.$$d_$9ES)}$6C(this,"ReadCardChanged");$45(this,"ReadCard","HideConductor");return n},get_$vV:function(){return this.$Ev},set_$vV:function(n){if(this.$Ev===n)return n;$6C(this,"ComposeCardChanging");if(this.$Ev){this.$Ev.remove_$2sq(this.$$d_$9Cb);this.$Ev.$u("IsVisible",this.$$d_$9LR);this.$Ev.$1Q()}this.$Ev=n;if(this.$Ev){this.$Ev.$Y("IsVisible",this.$$d_$9LR);this.$Ev.add_$2sq(this.$$d_$9Cb)}$6C(this,"ComposeCardChanged");$3(this,"ComposeCard");return n},get_$1Uv:function(){return this.$Ev||this.$7R},get_$8Cr:function(){return _d.$7c.isInstanceOfType(this.$C.$Zs().get_$7u())},$2q0:function(n){var t=_a.$6.acsa(_a.$0.$9k,"CreatePersonaCardViewModel",!0);var i=this;this.$o9.$2q0(n,null,null,this.$ln,this,function(n){$4nG(i,n,!1,t)})},$1Hu:function(n){if(this.$7R&&_pc.$i.$1pH(this.$7R.$14,n)){$4nF(this,!1);return}var t=_a.$6.acsa(_a.$0.$9k,"CreatePersonaCardViewModel",!0);var i=this;this.$o9.$2q0(n,null,null,this.$ln,this,function(n){$4nG(i,n,!0,t)})},$1qj:function(){this.set_$kN(null)},$7dm:function(){this.$C.get_$L()==="Mouse"||this.$C.get_$L()==="TouchWide"&&this.$1J&&this.$1J.$3u("ModernGroups")?this.set_$41x(!0):$2hX(this,1)},$7dk:function(){this.$2yA();$2hX(this,1)},$7dl:function(){this.$2yA();$2hX(this,2)},$3kc:function(){this.$2yA();$2hX(this,5)},$2cf:function(n,t){$3X1(this,n,2,t)},$3cv:function(n){_a.$6.$1c(_a.$0.$9k,"PersonCard.AddToContacts");$3X1(this,n,3)},$1t4:function(n,t){switch(n.get_$1F()){case 1:_a.$6.stPT(_a.$0.$9t,"EditContact",3);_a.$6.$1c(_a.$0.$9t,"EditContact");break;case 2:_a.$6.stPT(_a.$0.$9t,"EditGroup",3);_a.$6.$1c(_a.$0.$9t,"EditGroup");break;case 5:_a.$6.stPT(_a.$0.$9t,"EditModernGroup",3);_a.$6.$1c(_a.$0.$9t,"EditModernGroup");break;default:break}$3X1(this,n,1,t)},$8GS:function(n){this.$d=n;switch(this.$d.get_$61()){case 3:this.$3cv(this.$d.get_$1s());break;case 1:this.$1t4(this.$d.get_$1s(),this.$7R?this.$7R.get_$2H9():new _d.$QX);break;case 2:var t=new _d.$QX;t.$GL=n.get_$28();t.$1Aj=n.get_$3kk();this.$2cf(this.$d.get_$1s(),t);break;default:this.$1Hu(this.$d.get_$1s());break}},$62:function(){this.$Ev&&this.$Ev.$KE?this.get_$Cg().$V6(2,this.$Ev.$14.get_$1F()===5?[_nbs.NonBootStrings.l_ModernGroupCardDirtyPopoutWarning_Text]:[_nbs.NonBootStrings.l_PersonaCardDirtyPopoutWarning_Text],this.$$d_$9V9,!1,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_nbs.NonBootStrings.l_PopoutCardConfirmationPromptTile_Text):$4nH(this)},$4c:function(){this.set_$vV(null);this.set_$kN(null);_a.$1.prototype.$4c.call(this)},$99W:function(){this.$3cv(this.$7R.$14)},$9ES:function(){this.$1t4(this.$7R.$14,this.$7R.get_$2H9())},$9Cb:function(n,t){var i=this.$Ev.$7n;if(n)if(n.get_$1F()===1){_a.$6.$1E(null,"SaveContact");_a.$6.endPT("SavePersona_"+this.$C.get_$L())}else if(n.get_$1F()===2){_a.$6.$1E(null,"SaveGroup");_a.$6.endPT("SaveGroup_"+this.$C.get_$L())}if(this.$Ev.get_$89()){this.$Ev.$KE=!1;this.$Ev.get_$89()()}(i===3||i===1)&&n&&this.$7R&&this.$7R.$9LX(n);this.set_$vV(null);i===2&&$Dp(this,"PersonaCreated",n)},$9V9:function(n,t){n&&$4nH(this)},$1AO:function(n){var u=n.$AY&&(n.$7n===2||n.$7n===3||n.$14.get_$BB()===3);if(u){var t=null;var i=null;var r=n.$14.get_$1F();switch(n.$7n){case 2:switch(r){case 1:t="NewContact";i="NewContact";break;case 2:t="NewGroup";i="NewGroup";break;case 5:t="NewModernGroup";i="NewModernGroup";break}break;case 1:switch(r){case 1:t="EditContact";i="EditContact";break;case 2:t="EditGroup";i="EditGroup";break}break;case 0:t="OpenContact";i="OpenPersonCard_"+this.$C.get_$L();break;case 3:t="PersonCard.AddToContacts";break}t&&_a.$6.$1E(null,t);i&&_a.$6.endPT(i)}},$9LR:function(n,t){if(_d.$9L.isInstanceOfType(n)){var i=n;i.$AY&&this.$1AO(i)}},$9Mi:function(){this.$1AO(this.$7R)},$2yA:function(){this.set_$41x(!1)}};_d.$6t=function(){};_d.$6t.$fw=function(n,t,i){_d.$6t.$45y(0,n,t,i)};_d.$6t.$8H7=function(n,t,i){_d.$6t.$45y(1,n,t,i)};_d.$6t.$8H6=function(n,t,i){_d.$6t.$45y(n,100,t,i)};_d.$6t.$45y=function(n,t,i,r){if(_a.$g.get_$Qz()){var u=new _d.$12W(n,t,i,r);var f=_a.$6.$1c(_a.$0.$1s,"PeopleCard",!0);_a.$6.$1E(f,"PeopleCard","","",u.$3RK())}};_d.$6t.$8H8=function(n,t){if(_a.$g.get_$Qz()){var i=new _d.$ru(0,n,t);var r=_a.$6.$1c(_a.$0.$1s,"RecipientCache",!0);_a.$6.$1E(r,"RecipientCache","","",i.$3RK())}};_d.$6t.$8H9=function(n,t){if(_a.$g.get_$Qz()){var i=new _d.$ru(1,n,t);var r=_a.$6.$1c(_a.$0.$1s,"RecipientCache",!0);_a.$6.$1E(r,"RecipientCache","","",i.$3RK())}};_d.$6t.$8HA=function(n,t,i){if(_a.$g.get_$Qz()){var r=new _d.$ru(2,n,t,i);var u=_a.$6.$1c(_a.$0.$1s,"RecipientCache",!0);_a.$6.$1E(u,"RecipientCache","","",r.$3RK())}};_d.$6t.$8Gz=function(n,t,i){if(!_js.$9.$18(i)){var r=_a.$6.$1c(n,t,!0);_a.$6.$1E(r,t,null,null,i)}};_d.$Ao=function(n){this.$$d_$9pL=Function.createDelegate(this,this.$9pL);this.$$d_$5Ln=Function.createDelegate(this,this.$5Ln);this.$$d_$7n2=Function.createDelegate(this,this.$7n2);this.$$d_$69b=Function.createDelegate(this,this.$69b);_d.$Ao.$$(this.$$gta["_d.$Ao"].T).initializeBase(this);this.$5Lo=n};_d.$Ao.$$=function(n){var t="$Ao"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var i=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Ao"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Ao.apply(this,i)};i.registerClass("_d."+t,_a.$F2);var u=_d.$Ao.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(i.prototype[r.key]=r.value)}i.$7ba=function(n,t,i){return new _0365m.$m(n,null,i,!0)};i.$A=_a.$0.$9k}return _d[t]};_d.$Ao.prototype={$l7:null,$28C:null,$1jw:null,$p:null,$5Lo:null,get_$2Dr:function(){return this.$l7},set_$2Dr:function(n){if(n!==this.$l7){this.$l7=n;$3(this,"ActionCommand")}return n},get_$4TD:function(){return this.$28C},set_$4TD:function(n){if(n!==this.$28C){this.$28C=n;$6(n)||this.$28C.$Y("IsShown",this.$$d_$69b);$3(this,"SelectActionItemMenuViewModel")}return n},get_$3T:function(){return this.$p},$A6Q:function(n,t){t||(t=_d.$Ao.$$(this.$$gta["_d.$Ao"].T).$7ba);if($6(n)||!n.length)this.$1r();else if(n.length===1){this.$1jw=null;this.set_$4TD(null);this.set_$2Dr(new _C(this.$$d_$7n2,_d.$Ao.$$(this.$$gta["_d.$Ao"].T).$A))}else{var r=n.length;this.$1jw=new Array(r);for(var i=0;i<r;++i){var u=new(_a.$CF.$$(_d.$5V.$$(this.$$gta["_d.$Ao"].T)))(n[i],this.$$d_$5Ln);this.$1jw[i]=t(n[i].get_$1sj(),n[i].get_$A3z(),new _C(u.$$d_$A3h,_d.$Ao.$$(this.$$gta["_d.$Ao"].T).$A))}this.set_$4TD(new _0365m.$2b(this.$1jw));this.set_$2Dr(new _C(this.$$d_$9pL,_d.$Ao.$$(this.$$gta["_d.$Ao"].T).$A))}this.$p=n},$1r:function(){if(!$6(this.$1jw))for(var t=this.$1jw,i=t.length,n=0;n<i;++n){var r=t[n];r.$1Q()}this.$1jw=null;this.set_$4TD(null);this.set_$2Dr(null);this.$p=null},$4c:function(){this.$1r();_a.$1.prototype.$4c.call(this)},$9pL:function(){this.$28C.set_$1O(!0)},$5Ln:function(n){this.$5Lo(n.get_$A3z())},$7n2:function(){this.$5Ln(this.$p[0])},$69b:function(n,t){_d.$7c.$2zm=this.$28C.$2y}};_d.$Ha=function(){this.$3nl=!1;this.$2JK=!1;this.$2rx=!1;this.$2JN=!1;this.$1M2=!1;this.$2s3=!1;this.$1ZE=!1;this.$2s1=!1;this.$2JM=!1;this.$2s2=!0;this.$9u=8;this.$3nm=!1};_d.$Ha.get_$9U0=function(){var n=new _d.$Ha;n.$3nl=!0;n.$2JK=!0;n.$2JN=!0;n.$1M2=!0;n.$2s3=!0;n.$2s1=!0;n.$1ZE=!0;n.$2rx=!0;n.$5J1=!0;n.$2s2=!1;n.$9u=0;return n};_d.$Ha.get_$9Ux=function(){var n=new _d.$Ha;n.$3nl=!0;n.$2rx=!0;n.$2JK=!0;n.$2JN=!0;n.$1M2=!0;n.$2s3=!0;n.$1ZE=!0;n.$2s1=!0;n.$2JM=!0;n.$2s2=!0;n.$9u=1;return n};_d.$Ha.prototype={$2s1:!1,$2JM:!1,$2JK:!1,$2rx:!1,$2JN:!1,$3nl:!1,$1M2:!1,$1ZE:!1,$2s3:!1,$5J1:!1,$9u:0,$2S:!0,$2s2:!1,$3nm:!1};_d.$2w=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$6Az=Function.createDelegate(this,this.$6Az);this.$$d_$7Oj=Function.createDelegate(this,this.$7Oj);this.$$d_$99X=Function.createDelegate(this,this.$99X);this.$$d_$8FV=Function.createDelegate(this,this.$8FV);this.$$d_$3cv=Function.createDelegate(this,this.$3cv);this.$$d_$9Lb=Function.createDelegate(this,this.$9Lb);this.$3D3=_d.$2w.$4c4;_d.$2w.initializeBase(this,[n,t,i,r,f,e,s,c,a,v,p]);this.$34h=o;this.$1J=u;this.$2Xs=h;this.$243=y;this.$Ba=l};function $6vm(n,t){return n.$34h.$E(t)}function $6vn(n){n.$dP=new _d.$1K(new _d.$rt(n),0);n.$16k=new _d.$1K(new _d.$rt(n),1);n.$o8=new _d.$1K(new _d.$rt(n),2)}function $6vp(n){n.$dP.$vb();n.$16k.$vb();n.$o8.$vb()}function $2hY(n){var t=new(_0365f.$o.$$(_0365m.$m));n.get_$2xt()||t.$D(n.get_$7NV());n.get_$3wH()||t.$D(n.get_$7Ok());if(n.$6v.$20j){n.$6v.$20j.$1C.$1r();n.$6v.$20j.$1C.$69(t.$6Z())}else n.$6v.set_$8JF(new _0365m.$2b(t.$6Z()))}function $6vo(n,t){if(_a.$3t.$Xv(t.get_$1l().EmailAddress)){var r=_a.$6.acss(_a.$0.$9k,"GetPersonaAction");n.set_$N3(!0);var i=_pc.$Jj.$5Fh(t.get_$1l());i.add_$2m(n.$$d_$6Az);i.$F1=n.$8I.$9u;i.$2S=n.$8I.$2S;n.$k.$z(i);_a.$6.aces(r)}}function $4nM(n,t){var r=_a.$6.acss(_a.$0.$9k,"GetPersonaAction");var i=_pc.$Jj.$5Fi(t.get_$6G(),t.get_$qc());i.add_$2m(n.$$d_$6Az);i.$F1=n.$8I.$9u;i.$2S=n.$8I.$2S;n.$k.$z(i);_a.$6.aces(r)}function $6vr(n){$4nM(n,n.$14)}function $6vq(n){_a.$6.stPT(_a.$0.$9t,"PersonCard.ModernGroupPivot",5);_a.$6.$1c(_a.$0.$9t,"PersonCard.ModernGroupPivot",!1);var t=this;n.$243.$E(function(t){if(!n.$1Qw){n.set_$95i(t.$7dc(n.$14,n.$16j));n.$1Qw.$LC()}})}_d.$2w.prototype={$34h:null,$2Xs:null,$1J:null,$243:null,$dP:null,$16k:null,$o8:null,$3Gx:null,$Ba:null,$86U:null,$1Qw:null,$Pr:null,$CF:null,$3mu:null,$3cN:null,$3d0:null,$3cw:null,$3cx:null,$450:null,$3wI:!1,get_$2Xr:function(){this.$3Gx||(this.$3Gx=this.$2Xs?this.$2Xs.$E(this,this.$16j):new _d.$4f(this,this.$16j));return this.$3Gx},get_$95i:function(){return this.$1Qw},set_$95i:function(n){if(n!==this.$1Qw){this.$1Qw=n;$45(this,_d.$2w.$65f,_d.$2w.$3wY)}return n},get_$1XS:function(){return this.$CF},set_$1XS:function(n){if(this.$CF!==n){this.$CF&&this.$CF.$u("IsNotesLoaded",this.$$d_$9Lb);this.$CF=n;this.$CF&&this.$CF.$Y("IsNotesLoaded",this.$$d_$9Lb);$3(this,"CardNotesViewModel")}return n},get_$2H9:function(){var n=_d.$7c.prototype.get_$2H9.call(this);n.$mp=this.$CF.$mp;return n},get_$2js:function(){return this.$Ba&&this.$Ba.$3L&&this.$Ba.$3L.get_$No()?this.$Ba.$3L.get_$No().get_$6M():""},get_$1vm:function(){return this.get_$2xt()&&this.get_$3wH()?!0:!1},get_$3wH:function(){return this.$8I.$5J1||!this.$6v.get_$29U()||this.get_$1wG()||!(this.$3h.get_$CG()?this.$3h.get_$CG().get_$890():!1)||this.$14.$7jU()||this.$14.get_$BB()!==3?!0:this.$3wI},set_$3wH:function(n){this.$3wI!==n&&(this.$3wI=n);return n},get_$2xt:function(){return this.$8I.$2rx?!0:!this.$6v.get_$29U()||this.get_$mi()&&this.get_$ml()||this.$14.get_$BB()!==1&&(this.$14.get_$BB()!==3||!this.$14.$2Ma())},get_$2y2:function(){return this.$8I.$2JK?!0:!this.$6v.get_$29U()||this.get_$mi()&&this.get_$ml()||this.$14.get_$BB()!==3||this.$14.$2Ma()},get_$5Vs:function(){return this.get_$fc()||!this.$6v.get_$29U()},get_$845:function(){return!this.get_$41m()||!this.$1Qw},get_$8Dx:function(){return this.$Vz&&this.$16k.get_$3T().get_$B()>0&&this.$dP.get_$3T().get_$B()>0},get_$5be:function(){return this.get_$Bq()===0},get_$8Ad:function(){return!1},get_$41m:function(){return this.$14.get_$1F()!==1||this.$3D3===_d.$2w.$4c4?!1:this.get_$Bq()===this.$3D3},get_$321:function(){return this.get_$Bq()===1},get_$8CA:function(){return this.get_$Bq()===2},get_$54X:function(){this.$3cx||(this.$3cx=new _C(this.$$d_$3cv,_d.$2w.$A));return this.$3cx},get_$2R3:function(){this.$450||(this.$450=new _C(this.$$d_$8FV,_d.$2w.$A));return this.$450},get_$3OM:function(){return this.$8I.$1ZE?!1:!this.$14.$2Ma()&&this.$14.get_$BB()===3},get_$8Ba:function(){return!!this.$1J&&this.$1J.$3u("ModernGroups")},get_$9oi:function(){return this.$8I.$3nm?!1:this.$14.get_$1F()!==1?!1:this.get_$8Ba()?this.$14.$3vc():!1},get_$7Oe:function(){this.$3cw||(this.$3cw=new _y.$2W(_y.$c.get_$7NL(),_y.$c.get_$7NR(),_u.Strings.l_AddMenuItem_LowerCase_Text,this.get_$54X()));return this.$3cw},get_$7hD:function(){this.$3mu||(this.$3mu=new _y.$2v(_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$5I6()));return this.$3mu},$49:function(){_d.$Nj.prototype.$49.call(this);this.$6v.set_$1vm(this.get_$1vm());this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k));$2hY(this);$6vn(this);$1Ve(this)},$5XY:function(n){_d.$7c.prototype.$5XY.call(this,n);$3(this,_d.$2w.$4LU)},$6BQ:function(){_d.$7c.prototype.$6BQ.call(this);$2hY(this);$JA(this,[_d.$2w.$43f,_d.$2w.$5Vt])},$9GB:function(){$2hY(this);_d.$7c.prototype.$9GB.call(this)},$7Oj:function(){this.$6v.set_$aE(!0);var i=this.$14.$5Qn();var n=new _g.$XQ;n.GroupType="OtherContacts";var t=new _c.$11A(i,n);t.add_$2m(this.$$d_$99X);this.$k.$z(t)},$9LS:function(){$6vp(this);this.set_$1XS(new _d.$Ok(this.$14,this.$8I,this.$C,this.$k));this.$6v.set_$1vm(this.get_$1vm());_d.$7c.prototype.$9LS.call(this);$3(this,_d.$2w.$43f)},$87D:function(){if(this.$14.get_$BB()===2&&this.$14.get_$6G()){this.set_$N3(!0);$4nM(this,this.$14)}else this.$14.get_$BB()!==1&&this.$14.get_$BB()!==2||$6(this.$14.get_$1l())||$6(this.$14.get_$1l().EmailAddress)||$6vo(this,this.$14)},$87K:function(){this.get_$321()&&this.$CF.$LC();$6vr(this)},$5PV:function(n,t){n.val=[];t.val=null;if(this.$C.get_$L()!=="TouchNarrow"||!this.$8I.$2s3){this.get_$2xt()||this.get_$N3()||(n.val[n.val.length]=this.get_$7Oe());if(this.$14.get_$BB()===3){this.get_$3OM()&&(t.val=[this.get_$7hD()]);this.get_$2xt()&&!this.get_$2y2()&&(n.val[n.val.length]=this.get_$5KA());this.get_$1DL()&&(n.val[n.val.length]=this.get_$3iD())}}},$9gg:function(){_d.$Nj.prototype.$9gg.call(this);$JA(this,[_d.$2w.$5bf,_d.$2w.$5cg,_d.$2w.$4LU,_d.$2w.$5cR,_d.$2w.$3wY]);this.get_$Bq()!==2||this.get_$2Xr().$317||this.get_$2Xr().$7vt(this.$14.get_$qc());this.get_$Bq()===1&&this.$14.get_$BB()===3&&this.$CF.$LC();this.get_$41m()&&(this.$1Qw||$6vq(this))},$5Ru:function(){var n=new(_0365f.$o.$$(_a.$5M));n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardInformationPivotOption_Text,null));n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text,null));this.$14.get_$1F()===1&&this.$14.get_$qc()&&this.$14.$3vc()&&n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardOrganizationPivotOption_Text,null));if(this.$14.get_$3vr()){n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardLocationPivotOption_Text,null));$4mq(this,n.get_$B()-1)}if(this.get_$9oi()){n.$D(new _a.$5M(_nbs.NonBootStrings.l_PersonaCardModernGroupMembershipPivotOption_Text,null));this.$3D3=n.get_$B()-1}return n.$6Z()},$7wH:function(){return this.get_$5be()?20:this.get_$321()?21:this.get_$8CA()?22:this.get_$41m()?27:this.get_$41a()?26:100},get_$7NV:function(){this.$3cN||(this.$3cN=new _0365m.$m(_nbs.NonBootStrings.l_AddToContact_LowerCase_Text,null,this.get_$54X()));return this.$3cN},get_$7Ok:function(){this.$3d0||(this.$3d0=new _0365m.$m(_nbs.NonBootStrings.l_AddToLyncContact_LowerCase_Text,null,new _C(this.$$d_$7Oj,_d.$2w.$A)));return this.$3d0},$3cv:function(){$6C(this,"AddToContactsClicked")},$99X:function(n){var t=n;if(t.$1f)this.get_$Cg().$32(0,_nbs.NonBootStrings.l_AddToLyncContactError_LowerCase_Text,null);else{this.set_$3wH(!0);$2hY(this)}this.$6v.set_$aE(!1)},$6Az:function(n){var t=n;this.set_$N3(!1);if(!t.$1f){$6(this.get_$4NF())||(this.get_$4NF().$1dn=!0);var i=_a.$6.acss(_a.$0.$9k,"SetFullPersona");this.set_$1s(t.$14);this.get_$321()&&this.$14.get_$BB()===3&&this.$CF.$LC();_a.$6.aces(i);_a.$6.$1E(null,"NavigateToPeople");_a.$6.endPT("NavigateToPeopleHub_"+this.$C.get_$L());_a.$6.$1E(null,"PeoplePicker");_a.$6.endPT("PeoplePicker")}this.$9GB()},$9Lb:function(n,t){this.$CF.$1OG&&this.$CF.$mp&&this.$o8&&this.$o8.$vb()},$8FV:function(){_a.$g.$2BF("VM.PersonCard.ContactLinking");if(!this.$14||this.$14.get_$BB()!==3){this.get_$Cg().$32(0,_nbs.NonBootStrings.l_LinkSummaryCardCannotBeLaunched_Text,null);return}this.$Pr?this.$Pr.$6U4(this.$14):this.$Pr=$6vm(this,this.$14);this.$C.$7X(this.$Pr);this.get_$6Hl()==="Mouse"&&this.$5BX()}};_d.$9L=function(n,t,i,r,u,f,e,o,s){this.$$d_$5BX=Function.createDelegate(this,this.$5BX);this.$$d_$1RW=Function.createDelegate(this,this.$1RW);this.$$d_$6Iw=Function.createDelegate(this,this.$6Iw);_d.$9L.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_d.$9L.initializeBase(this);this.$14=n;this.$1BM=f;this.$zF=o;this.$C=r;this.$k=u;this.$8I=i;this.$7n=t;this.$6f=e;this.$16j=s};function $1Ve(n){n.get_$5bK()&&n.$87D()}function $2Cn(n){if(n.$3w){var t;var i;var r,u;n.$5PV(r={val:t},u={val:i});t=r.val;i=u.val;n.$3w.set_$J0(t);n.$3w.set_$aR(i);$3(n,"ApplicationBarViewModel")}}_d.$9L.prototype={$zF:null,$C:null,$6f:null,$k:null,$7n:0,$8I:null,$16j:null,$1BM:!1,$1z:null,$14:null,$3m:null,$KA:null,$3w:null,$AY:!1,$3iK:null,$DW:!1,$7A:!1,add_$69M:function(n){this.$2N("ClosePopup",n)},remove_$69M:function(n){this.$2P("ClosePopup",n)},get_$7D:function(){return this.$3w},set_$7D:function(n){if(this.$3w!==n){this.$3w=n;$3(this,"ApplicationBarViewModel")}return n},get_$Ld:function(){return 2},get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},get_$4bw:function(){return this.$14.get_$1F()},get_$1s:function(){return this.$14},set_$1s:function(n){this.$14=n;this.$9LS();$1Ve(this);$3(this,_d.$9L.$6Hw);return n},get_$6Hl:function(){return this.$C.get_$L()},get_$DX:function(){return this.$AY},set_$DX:function(n){this.$AY!==n&&(this.$AY=n);$3(this,"IsVisible");return n},get_$ml:function(){return!_a.UserAgent.getInstance().$cU},get_$3GX:function(){return null},get_$3GZ:function(){return null},get_$fl:function(){return this.$C.get_$L()!=="Mouse"},get_$1iT:function(){return 0},get_$2MT:function(){return this.$$d_$1RW},get_$4i:function(){return this.$3m},set_$4i:function(n){this.$3m=n;return n},get_$89:function(){return this.$KA},set_$89:function(n){this.$KA=n;return n},get_$7iz:function(){return!0},get_$1qq:function(){this.$3iK||(this.$3iK=new _C(this.$$d_$5BX,_d.$9L.$A));return this.$3iK},get_$ch:function(){return this.$DW},set_$ch:function(n){if(n!==this.$DW){this.$DW=n;$3(this,"IsTransitionedIn")}return n},get_$5bK:function(){return!this.$1BM},$49:function(){if(this.$7A){var n="Initialize should be called on any given instance only once.";_js.Trace.logError(_d.$9L.$A,n)}this.$7A=!0;this.$C.get_$L()!=="Mouse"&&this.set_$7D(this.$1YQ())},$5XY:function(n){this.set_$7D(null)},$6Iw:function(){this.$16j.$62()},$gk:function(){},$GN:function(){this.set_$DX(!0);this.set_$ch(!0)},$kK:function(){this.set_$DX(!1);this.set_$ch(!1)},$Uz:function(){},$1YQ:function(){_js.Trace.logInfo(_a.$0.$9k,"PersonaCardViewModelBase::CreateApplicationBarViewModel - Layout: {0}",this.$C.get_$L());var n;var t;var i,r;this.$5PV(i={val:n},r={val:t});n=i.val;t=r.val;return _y.$26.$Bg(this,n,t)}};_d.$7c=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$7hs=Function.createDelegate(this,this.$7hs);this.$$d_$7ht=Function.createDelegate(this,this.$7ht);this.$$d_$9vP=Function.createDelegate(this,this.$9vP);this.$$d_$9Uu=Function.createDelegate(this,this.$9Uu);this.$$d_$7Rw=Function.createDelegate(this,this.$7Rw);this.$$d_$7hJ=Function.createDelegate(this,this.$7hJ);this.$$d_$5U0=Function.createDelegate(this,this.$5U0);this.$$d_$1Ly=Function.createDelegate(this,this.$1Ly);this.$$d_$5EF=Function.createDelegate(this,this.$5EF);_d.$7c.initializeBase(this,[n,0,t,r,u,e,o,s,h]);this.$3h=f;this.$14n=i;this.$1O0=!0;this.$Vz=!1;this.set_$4L(!0)};function $6wc(n){n.$6v.set_$kG(n.$5Ru())}function $4nf(n){var t=n.$5Ru();$6wb(n,t)&&n.$6v.set_$kG(t)}function $2he(n){n.$6v.set_$47M(new _0365m.$2b(n.$7r8()))}function $6wd(n){n.$6v=n.$zF.$7e9(n.$14,n.$7n,n.$8I,n.$14n);n.$6v.set_$2y2(n.get_$2y2());n.$6v.set_$1vm(!0);n.$6v.set_$2xv(!n.get_$3OM());n.$6v.add_$9Ut(n.$$d_$9Uu);n.$6v.add_$9vQ(n.$$d_$9vP);n.$6v.add_$6Ix(n.$$d_$6Iw)}function $6wb(n,t){return!n.$6v.$Hg&&!t?!1:n.$6v.$Hg&&t?n.$6v.$Hg.length!==t.length:!0}function $6we(n){var t=n.$7wH();_d.$6t.$8H7(t,n.$8I.$9u,n.get_$4bw())}function $6wa(n){return n.$14.$82T()?[String.format(_nbs.NonBootStrings.l_DeletePersonaMessageFirstLine_Text,n.get_$4NF().$GQ),_nbs.NonBootStrings.l_DeletePersonaMessageSecondLine_Text]:[String.format(_nbs.NonBootStrings.l_DeletePersonaMessageFirstLine_Text,n.get_$4NF().$GQ)]}function $6wf(n,t){var i=new _pc.$64;i.set_$rb(!0);i.set_$1o("Outlook");i.set_$q(!1);t.get_$3t()||t.set_$3t(new _js.$Z);if(t.$5Ul()){i.set_$1y(t.get_$3t().get_$B().toString());t.get_$3t().$D(i);t.get_$U0()&&t.get_$U0().$D(t.get_$U0().get_$3q(0),t.get_$3t().get_$B().toString())}else for(var u=t.get_$3t().get_$B(),r=0;r<u;r++){var f=t.get_$3t().get_$3q(r);if(f.get_$1o()==="GAL"){i.set_$1y(r.toString());t.get_$3t().set_$3q(r,i);break}}if(t.get_$1l()){t.set_$U0(new(_pc.$1E.$$(_g.$1l)));t.get_$U0().$D(t.get_$1l(),(t.get_$3t().get_$B()-1).toString())}return t}_d.$7c.prototype={$14n:null,$6v:null,$1sz:null,$11j:null,$JN:null,$2S:!1,$Vz:!1,$3h:null,$2r9:null,$1O0:!1,$x3:!1,add_$54W:function(n){this.$2N("AddToContactsClicked",n)},remove_$54W:function(n){this.$2P("AddToContactsClicked",n)},add_$5IB:function(n){this.$2N("DeleteSucceeded",n)},remove_$5IB:function(n){this.$2P("DeleteSucceeded",n)},add_$3F6:function(n){this.$2N("OnBack",n)},remove_$3F6:function(n){this.$2P("OnBack",n)},add_$2YT:function(n){this.$2N("PersonaInCompletedState",n)},remove_$2YT:function(n){this.$2P("PersonaInCompletedState",n)},get_$7l3:function(){return this.$6v.get_$1t0()},get_$5I6:function(){this.$JN||(this.$JN=new _C(this.$$d_$1Ly,_d.$7c.$A));return this.$JN},get_$9VC:function(){return this.$6v.get_$4O1()},get_$Ld:function(){switch(this.$C.get_$L()){case"TouchWide":return 1;case"TouchNarrow":return 2;default:return 0}},get_$2H9:function(){var n=new _d.$QX;n.$5JS=this.get_$4NF().get_$2JU();n.$5i2=!0;n.$5d8=this.get_$mi();return n},get_$mi:function(){return this.$6v.$14E},get_$4NF:function(){return this.$6v.$6e},get_$4L:function(){return this.$8I.$2JM?!0:this.$2S},set_$4L:function(n){this.$2S=n;this.$6v&&this.$6v.set_$4L(n);this.$Vz&&(_d.$7c.$5ZY=n);$JA(this,["IsExpanded","IsHoverCardExpanded"]);return n},get_$31A:function(){return this.$Vz},set_$31A:function(n){this.$Vz=n;if(this.$6v){this.$6v.set_$9o7(n);this.$6v.set_$31A(n)}$3(this,"IsHoverCard");return n},get_$5bW:function(){return this.get_$fc()&&this.get_$4L()?!0:!1},get_$1DL:function(){return this.$Vz&&this.$C.get_$L()==="TouchWide"},get_$8Dq:function(){return this.$Vz&&this.$C.get_$L()!=="Mouse"},get_$Bq:function(){return this.$6v.$LP},get_$1wG:function(){return this.get_$4NF()?this.get_$4NF().$Tq.get_$1wG():!0},get_$5HS:function(){return this.$2r9},set_$5HS:function(n){if(this.$2r9!==n){this.$2r9=n;$3(this,"DefaultEmailAddress")}return n},get_$fc:function(){return this.$8I.$2JM?!1:this.$1O0},set_$fc:function(n){this.$1O0=n;this.$6BQ();$JA(this,["IsExpandable","IsHoverCardExpanded"]);return n},get_$2PM:function(){return this.$8I.$9u===9},get_$1yH:function(){return!this.$8I.$9u},get_$42J:function(){return this.$8I.$9u===1},get_$N3:function(){return this.$x3},set_$N3:function(n){if(this.$x3!==n){this.$x3=n;$JA(this,["IsCardLoading","HidePersonaActions","HideNameControlForMouse"]);this.$9Hh()}return n},get_$1CX:function(){return this.$8I.$1M2||this.get_$N3()?!0:!1},get_$5KA:function(){this.$1sz||(this.$1sz=new _y.$2W(_y.$c.get_$Zi(),_y.$c.get_$2Jt(),_nbs.NonBootStrings.l_EditMenuItem_LowerCase_Text,this.get_$7l3()));return this.$1sz},get_$3iD:function(){this.$11j||(this.$11j=new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_Close_LowerCase_Text,this.get_$1qq()));return this.$11j},get_$7hK:function(){return _nbs.NonBootStrings.l_DeletePersonaConfirmationPromptTile_Text},$49:function(){$6wd(this);!this.get_$fl()&&this.get_$4NF()&&this.get_$4NF().$Tq.add_$99D(this.$$d_$5U0);$2he(this);$6wc(this);this.$6v.set_$Bq(0);_d.$9L.prototype.$49.call(this)},$5XY:function(n){_d.$9L.prototype.$5XY.call(this,n);this.set_$fc(n.get_$fc());this.$6v.set_$Bq(n.get_$Bq());this.$6v.set_$1yM(n.get_$mi())},$1Ly:function(){if(!this.$8CR()){this.get_$Cg().$32(0,_nbs.NonBootStrings.l_WaitAndRetry_Text,null);return}if(!this.get_$3OM()){this.get_$Cg().$32(0,String.format(_nbs.NonBootStrings.l_DeletePersonaFailed_Text,this.get_$4NF().$GQ),null);return}this.get_$Cg().$V6(2,$6wa(this),this.$$d_$7hJ,!1,_u.Strings.l_Delete_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,this.get_$7hK())},$9GB:function(){$4nf(this);$2he(this);this.$6v.set_$Bq(this.$7h2());$2Cn(this);$6C(this,"PersonaInCompletedState")},$9LX:function(n){this.get_$4NF()&&(this.get_$4NF().$1dn=!0);this.set_$1s(n);$2Cn(this);$2he(this);this.$87K()},$5BX:function(){if(!this.get_$mi()){$6C(this,"ClosePopup");this.get_$89()&&this.get_$89()()}},$6BQ:function(){this.$6v.set_$fc(this.get_$fc());$2he(this)},$4LF:function(n){try{this.$6f.$Re(n);_d.$6t.$fw(14,this.$8I.$9u,this.$14.get_$1F())}catch(t){_js.Trace.logException(_d.$7c.$A,t,"Failed to open URL")}},$7Nm:function(){if(this.$3h&&this.$C.get_$L()==="Mouse"){var n=this;this.$3h.add_$av(function(){if(!n.$AV&&n.$3h.$Ph&&n.get_$4NF()){var t=n.get_$4NF().$Tq;n.$3h.get_$CG().apcl(_c.$2M.$1l2,t.$$d_$5eF||(t.$$d_$5eF=Function.createDelegate(t,t.$5eF)))}})}},$9b2:function(){if(this.$3h&&this.$C.get_$L()==="Mouse"){var n=this;this.$3h.add_$av(function(){if(n.$3h.$Ph&&n.get_$4NF()){var t=n.get_$4NF().$Tq;n.$3h.get_$CG().rpcl(_c.$2M.$1l2,t.$$d_$5eF||(t.$$d_$5eF=Function.createDelegate(t,t.$5eF)))}})}},$9LS:function(){this.$6v.set_$2y2(this.get_$2y2());this.$6v.set_$2xv(!this.get_$3OM());this.$6v.set_$1s(this.$14)},$87K:function(){},$9Hh:function(){this.$6v.set_$N3(this.get_$N3())},$1RW:function(n,t){this.get_$mi()||$6C(this,"ClosePopup");return!1},$5EF:function(n){if(n.get_$1F()!==2&&!n.get_$6G()){n.set_$BB(1);n=$6wf(this,n)}this.$16j.$1Hu(n)},$7h2:function(){return 0},$1YQ:function(){var n=_d.$9L.prototype.$1YQ.call(this);this.$C.get_$L()==="TouchNarrow"&&n.$hX(new _C(this.$$d_$7Rw,_d.$7c.$A));return n},$5PV:function(n,t){n.val=[];t.val=null;this.get_$1DL()&&(n.val[n.val.length]=this.get_$3iD())},$7r8:function(){var n=[];this.get_$3OM()&&(n[n.length]=new _0365m.$m(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$1Ly,_d.$7c.$A)));return n},$8CR:function(){return this.$14.get_$BB()===3},$5U0:function(){this.get_$fl()||$6C(this,"ClosePopup")},$9Uu:function(n){$3(this,"PivotSelectedOptionIndex");this.$9gg();$6we(this)},$7hJ:function(n,t){if(n){var i=new _pc.$v7(this.$14.get_$6G());i.add_$2C(this.$$d_$7ht);i.add_$1x(this.$$d_$7hs);i.$F1=this.$8I.$9u;this.$k.$z(i);this.get_$89()&&this.get_$89()()}},$7ht:function(n){var t=n.$CR;_a.$4.$J(t,"personaId");$CY(this,"DeleteSucceeded",this,t)},$7hs:function(n){n.$1f&&this.get_$Cg().$32(0,String.format(_nbs.NonBootStrings.l_DeletePersonaFailed_Text,this.get_$4NF().$GQ),null)},$9vP:function(n){this.set_$4L(n);_d.$6t.$fw(31,this.$8I.$9u,this.get_$4bw())},$7Rw:function(){$6C(this,"OnBack");if(this.get_$89()){$6C(this,"ClosePopup");this.get_$89()()}}};_d.$86=function(n,t,i,r,u){this.$$d_$2XR=Function.createDelegate(this,this.$2XR);this.$$d_$6QD=Function.createDelegate(this,this.$6QD);this.$$d_$5BY=Function.createDelegate(this,this.$5BY);this.$$d_$6D6=Function.createDelegate(this,this.$6D6);this.$$d_$1RW=Function.createDelegate(this,this.$1RW);_d.$86.initializeBase(this);this.$C=n;this.$1i9=t;this.$6Q=i;this.$D4=r;this.set_$6M1(u);this.set_$7D($6wy(this));this.$PU=new _y.$4c};function $3XJ(n){n.$x4=!1;n.$1Ns=!1;n.get_$b8().$2r.set_$Ac("");n.get_$b8().$2r.set_$HW(!1);n.get_$b8().$2r.set_$da(!1);n.get_$MD().$7H()}function $4np(n){n.$5UV()}function $6wy(n){switch(n.$C.get_$L()){case"TouchWide":return $6wx(n);case"TouchNarrow":return $6ww(n)}return null}function $6ww(n){var t=_y.$26.$Bg(n,null,null);t.set_$14b([t.$hX(n.get_$1ZF()),t.$111()]);t.set_$J0([new _y.$2W(_y.$c.get_$2x(),_y.$c.get_$2ui(),_u.Strings.l_Folders_Text,n.get_$MD().get_$5O2())]);t.set_$aR($6wz(n));t.set_$4T7(n.get_$MD().get_$zt());return t}function $6wx(n){var t=_y.$26.$Bg(n,null,null);t.set_$14b([t.$111()]);t.set_$J0([new _y.$2W(_y.$c.get_$vN(),_y.$c.get_$1Xb(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.get_$tj()),new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_Discard_LowerCase_Text,n.get_$1ZF())]);t.set_$4T7(n.get_$MD().get_$zt());return t}function $6wz(n){return[n.get_$MD().$5FW()]}function $4nq(n,t){t?n.set_$1r6(_nbs.NonBootStrings.l_LeaveConfirmationDialogTitle_PeoplePicker_Text):n.set_$1r6(_nbs.NonBootStrings.l_CancelConfirmationDialogTitle_PeoplePicker_Text);n.set_$7ZT($6x0(n,t));n.set_$1x9(!0)}function $6x0(n,t){var i=new _js.$Z;var r=this;i.$D(new _a.$2G(new _C(function(){n.set_$1x9(!1);t&&$4np(n);n.$x4=!0;n.$4OD()},_d.$86.$A),_nbs.NonBootStrings.l_Ok_LowerCase_Text,""));if(t){var u=this;i.$D(new _a.$2G(new _C(function(){n.set_$1x9(!1);n.$x4=!0;n.$4OD()},_d.$86.$A),_nbs.NonBootStrings.l_DiscardAndCloseDialogButton_PeoplePicker_Text,""))}var f=this;i.$D(new _a.$2G(new _C(function(){n.set_$1x9(!1)},_d.$86.$A),_u.Strings.l_CancelButtonText_Text,""));return i}_d.$86.prototype={$1i9:null,$6Q:null,$C:null,$PU:null,$175:null,$KA:null,$D4:null,$dN:null,$EW:null,$El:null,$4dU:null,$4b:null,$1Ns:!1,$2OV:!1,$vd:null,$2HG:null,$4OD:null,$x4:!1,add_$1jh:function(n){this.$2N("SaveCompleted",n)},remove_$1jh:function(n){this.$2P("SaveCompleted",n)},add_$6IG:function(n){this.$2N("PickerClosed",n)},remove_$6IG:function(n){this.$2P("PickerClosed",n)},get_$1iT:function(){return 1},get_$89:function(){return this.$KA},set_$89:function(n){this.$KA=n;return n},get_$7iz:function(){return!0},get_$2MT:function(){return this.$$d_$1RW},get_$MD:function(){if(!this.$dN){this.$dN=this.$1i9.$7e4();this.$dN.add_$2YX(this.$$d_$6D6)}return this.$dN},get_$1ZF:function(){this.$EW||(this.$EW=new _C(this.$$d_$5BY,_d.$86.$A));return this.$EW},get_$tj:function(){this.$El||(this.$El=new _C(this.$$d_$6QD,_d.$86.$A));return this.$El},get_$6M1:function(){return this.$175},set_$6M1:function(n){if(this.$175!==n){this.$175=n;$3(this,"RecipientWellLabel")}return n},get_$b8:function(){if(!this.$4b){var n=null;this.$D4&&this.$D4.get_$B()>0&&this.$C.get_$L()!=="TouchNarrow"&&(n=this.$D4.$3p());this.$4b=this.$7eP(this.$6Q,n);this.$4b.set_$4Vx(!1);this.$4b.$1T.add_$1Z(this.$$d_$2XR)}return this.$4b},get_$6fx:function(){this.$4dU||(this.$4dU=this.get_$MD().$5T4());return this.$4dU},get_$Ld:function(){return this.$C.get_$L()!=="Mouse"?1:0},get_$1x9:function(){return this.$2OV},set_$1x9:function(n){if(n!==this.$2OV){this.$2OV=n;$3(this,"IsConfirmDialogShown")}return n},get_$7ZT:function(){return this.$2HG},set_$7ZT:function(n){if(n!==this.$2HG){this.$2HG=n;$3(this,"ConfirmDialogButtonData")}return n},get_$1r6:function(){return this.$vd},set_$1r6:function(n){if(n!==this.$vd){this.$vd=n;$3(this,"ConfirmDialogTitle")}return n},get_$UJ:function(){return _a.UserAgent.getInstance().$L2},$gk:function(){_y.$1KT.prototype.$gk.call(this);this.get_$MD().$5j()},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);var n=this;_js.$J.get_$I().$3r(_a.$0.$dO,"RichPeoplePicker.PostTransitionOut",function(){$6C(n,"PickerClosed")})},$6eO:function(n){this.get_$b8().$1T.$1r();if(this.$C.get_$L()!=="TouchNarrow"&&n&&n.get_$B()>0){var t=this;n.$Bh(function(n){if(_y.$Dt.isInstanceOfType(n)){var i=n;i.$N7?t.get_$b8().$1ov(i.$CA):t.get_$b8().$2EC(i.$CA)}})}this.$x4=!1;this.$1Ns=!1},$7eP:function(n,t){return n.$2q1(_d.$Jt.$26x,_y.$w.$Mf,t)},$5UV:function(){this.$1Ns&&$Dp(this,"SaveCompleted",this.get_$b8().$1T)},$6D6:function(n){if(n.get_$1l()){_a.$3t.$Xv(_g.$2L.$qe(n.get_$1l()))||n.get_$1l().RoutingType==="MAPIPDL"?this.get_$b8().$1ov(n):this.get_$b8().$2EC(n);this.$C.get_$L()==="TouchNarrow"&&this.$6QD()}else{if(this.$C.get_$L()==="TouchNarrow"){this.get_$MD().get_$1GQ().set_$22(null);this.get_$MD().get_$oO().set_$22(null)}this.$PU.$32(0,_nbs.NonBootStrings.l_NoEmailAddressError_PeoplePicker_Text,null)}},$4c:function(){if(this.$dN&&Sys.IDisposable.isInstanceOfType(this.$dN)){this.$dN.dispose();this.$dN=null}_a.$1.prototype.$4c.call(this)},$5BY:function(){this.$KA()},$1RW:function(n,t){if(this.$x4){$3XJ(this);return!1}this.$4OD=n;if(this.$1Ns){$4nq(this,!0);return!0}if(t===1||!t){$4nq(this,!1);return!0}$3XJ(this);return!1},$2XR:function(n,t){this.$1Ns=!0},$6QD:function(){this.$x4=!0;$4np(this);this.$5BY();$3XJ(this)}};_d.$lO=function(n,t,i){this.$C=n;this.$1i9=t;this.$6Q=i};_d.$lO.prototype={$C:null,$1i9:null,$6Q:null,$5FN:function(n,t){return new _d.$86(this.$C,this.$1i9,this.$6Q,n,t)}};_d.$5j=function(){};_d.$5j.$5Rt=function(n,t,i,r,u){if(!n)throw Error.argumentNull("cacheTable invalid");if(!t)throw Error.argumentNull("querystring invalid");var f=[];if(""===t.trim()||!i)return f;for(var s=0,e=null,h=0;h<n.$1t.get_$B()&&s<i;h++){var o=n.$1t.get_$3q(h);if(o&&_d.$5j.$8CQ(o,t,r))if(u){e?e.set_$1s(o):e=new _d.$um(o,u,"");for(var l=!1,a=f.length,c=0;c<a;c++)if(f[c].toLowerCase()===e.get_$1sj().toLowerCase()){l=!0;break}if(!l){Array.add(f,e.get_$1sj());s++}}else{Array.add(f,o);s++}}return f};_d.$5j.$3tx=function(n,t,i,r){return _d.$5j.$5Rt(_pc.$14.$iZ(),n,t,i,r)};_d.$5j.$9xE=function(n,t){return t.$mz?_d.$5j.$7wL(n,t):null};_d.$5j.$547=function(n,t){if(n){_a.$4.$J(n.get_$1l(),"Persona with no email address can't be added to the cache");if(n.get_$1l().RoutingType==="SMTP"&&n.get_$1l().EmailAddress&&_a.$3t.$Xv(n.get_$1l().EmailAddress)){t.$1t.$D(n);var i=new Array(0);n.$A28();Array.add(i,_d.$5j.$1N7("PersonaDisplayNames","",n.get_$1o()));Array.add(i,_d.$5j.$1N7("PersonaSurnames","",n.get_$1UR()));Array.add(i,_d.$5j.$1N7("PersonaMiddleNames","",n.get_$2Vv()));Array.add(i,_d.$5j.$1N7("PersonaGivenNames","",n.get_$1vB()));Array.add(i,_d.$5j.$1N7("PersonaEmails1","",n.get_$1l().EmailAddress));Array.add(i,_d.$5j.$1N7("PersonaEmails1DisplayNames","",n.get_$1l().Name));Array.add(i,_d.$5j.$1N7("PersonaType","",_h.$Ap.toString(n.get_$1F())));n.get_$1l().MailboxType==="Mailbox"&&Array.add(i,_d.$5j.$1N7("PersonaImAddresses","",n.get_$A6()));var r=new _pc.$iX(n.get_$6G(),i,new _g.$Cd(new _g.$7P("recipientcache")),_h.$Ap.toString(1));OwaApplication.$1W.$z(r)}}};_d.$5j.$7hw=function(n,t){for(var r=t.$1t.get_$B(),i=0;i<r;i++){var u=t.$1t.get_$3q(i);if(_pc.$i.$1pH(n,u)){t.$1t.$68(i);return}}};_d.$5j.$7wL=function(n,t){if(!t.$mz)throw Error.invalidOperation("IsPersonaInRecipientCache should not be called if the cache was not loaded!");for(var u=t.$1t.get_$B(),i=0;i<u;i++){var r=t.$1t.get_$3q(i);if(_pc.$i.$2xD(n,r))return r}return null};_d.$5j.$889=function(n,t){return _d.$5j.$1cB(n.get_$1o(),t,0)||_d.$5j.$5d3(n,t,0)||_d.$5j.$1cB(n.get_$1l().EmailAddress,t,0)?!0:!1};_d.$5j.$7wK=function(n,t){for(var r=n.get_$B(),i=0;i<r;i++)if(n.get_$3q(i)&&_d.$5j.$1cB(n.get_$3q(i).EmailAddress,t,0))return i;return-1};_d.$5j.$8CQ=function(n,t,i){if(_d.$5j.$1cB(n.get_$1o(),t,i)||_d.$5j.$1cB(n.get_$Mb(),t,i)||_d.$5j.$5d3(n,t,i))return!0;if(n.get_$66())for(var u=n.get_$66().length,r=0;r<u;r++)if(_d.$5j.$1cB(n.get_$66()[r].EmailAddress,t,i))return!0;return!1};_d.$5j.$1cB=function(n,t,i){if(!_js.$9.$18(n)){t=t.toLocaleLowerCase();if(i===1&&n.toLowerCase()===t||!i&&n.toLowerCase().startsWith(t))return!0}return!1};_d.$5j.$5d3=function(n,t,i){if(!_js.$9.$18(n.get_$1o()))for(var u=n.get_$1o().split(" "),f=u.length,r=0;r<f;r++)if(_d.$5j.$1cB(u[r],t,i))return!0;return!1};_d.$5j.$1N7=function(n,t,i){var r=new _g.$K6(new _g.$1X(n));r.OldValue=t;r.NewValue=i;return r};_d.$5j.$52x=function(){};_d.$5j.$52x.prototype={$7ws:function(n,t,i,r){return _d.$5j.$3tx(n,t,i,r)}};_d.$5T=function(n,t,i,r,u,f){this.$$d_$5Mj=Function.createDelegate(this,this.$5Mj);this.$$d_$9F3=Function.createDelegate(this,this.$9F3);this.$$d_$A1V=Function.createDelegate(this,this.$A1V);this.$$d_$A1W=Function.createDelegate(this,this.$A1W);this.$$d_$3HM=Function.createDelegate(this,this.$3HM);this.$$d_$2ED=Function.createDelegate(this,this.$2ED);this.$$d_$1vp=Function.createDelegate(this,this.$1vp);this.$$d_$3oM=Function.createDelegate(this,this.$3oM);this.$$d_$3Lm=Function.createDelegate(this,this.$3Lm);this.$$d_$1RW=Function.createDelegate(this,this.$1RW);this.$$d_$6A0=Function.createDelegate(this,this.$6A0);this.$$d_$2of=Function.createDelegate(this,this.$2of);this.$$d_$6Dn=Function.createDelegate(this,this.$6Dn);this.$$d_$9Lj=Function.createDelegate(this,this.$9Lj);this.$$d_$9Lk=Function.createDelegate(this,this.$9Lk);this.$$d_$9Bi=Function.createDelegate(this,this.$9Bi);this.$XM=0;_d.$5T.initializeBase(this);if(_js.$9.$a(r))throw Error.argumentNull("emailAddress");this.$C=n;this.$k=t;this.$AD=i;this.set_$7D($6y2(this));this.$Ao=r.toLocaleLowerCase();this.$26J=_d.$5T.$7sx(r);this.$33O=u;this.$55H=f;this.set_$2NO(this.$26J+"&isPreview=false")};_d.$5T.$5EU=function(n,t,i){return new _d.$5T(n,t,i,_g.$V.get_$I().get_$31().get_$Aj(),!0,!1)};_d.$5T.$5EW=function(n,t,i,r){return new _d.$5T(t,i,r,n,!1,!0)};_d.$5T.$7sx=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetUserPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};function $6y2(n){var t;t=n.get_$2GP()?[n.get_$4SU(),n.get_$5Ht(),n.get_$3gs()]:[n.get_$3gs()];return _y.$26.$Bg(n,t,null)}function $2Cp(n,t,i,r){return new _pc.$1F4(t,i,r,n.$Ao,!n.$33O)}function $6y4(n,t){var i=new _at.$va;i.$4PO(t,n.$$d_$9F3,n.$$d_$5Mj,_d.$5T.$hF)}function $6y3(n,t){var i=null;switch(t){case 1:i=_nbs.NonBootStrings.l_CannotAttachFilesInSnapView_Text;break;case 0:i=_nbs.NonBootStrings.l_AttachmentFileReadError_Text;break;default:break}_js.$9.$a(i)||n.get_$Cg().$32(0,i,null)}_d.$5T.prototype={$C:null,$k:null,$AD:null,$26J:null,$1Nb:null,$R1:null,$1z:null,$2Xj:null,$fq:!1,$1UG:0,$2Ya:null,$Ao:null,$33O:!1,$55H:!1,$El:null,$7V:null,$JN:null,$qD:null,$1Ct:!1,$x4:!1,add_$3T8:function(n){this.$2N("UploadPhotoClosed",n)},remove_$3T8:function(n){this.$2P("UploadPhotoClosed",n)},get_$2GP:function(){return this.$55H||_g.$V.get_$I().get_$6H().get_$2c2()&&this.get_$5d6()},get_$1xz:function(){return this.$C.get_$L()==="Mouse"},get_$43d:function(){return this.$C.get_$L()==="TouchNarrow"},get_$Cg:function(){this.$1z||(this.$1z=new _y.$4c);return this.$1z},get_$7lR:function(){return!this.get_$40f()&&!this.$AD.get_$ao().get_$3Di()&&_a.UserAgent.getInstance().$hh?!0:!1},get_$1c4:function(){return this.$1Ct},set_$1c4:function(n){if(this.$1Ct!==n){this.$1Ct=n;$3(this,"IsDiscardChangesDialogShown")}return n},get_$j4:function(){return this.$fq},set_$j4:function(n){if(this.$fq!==n){this.$fq=n;$3(this,"IsWorking")}return n},get_$7UC:function(){return this.get_$5a3()&&_g.$V.get_$I().get_$6H().get_$2c2()?new _C(this.$$d_$9Bi,_d.$5T.$hF):null},get_$9Ue:function(){return this.get_$5d6()&&_g.$V.get_$I().get_$6H().get_$2c2()?new _C(this.$$d_$9Lk,_d.$5T.$hF):null},get_$9Ry:function(){return this.$2Xj},set_$9Ry:function(n){this.$2Xj=n;$3(this,"OpenPhotoPickerCommand");return n},get_$7Nx:function(){return new _C(this.$$d_$9Lj,_d.$5T.$hF)},get_$XV:function(){return this.$R1},set_$XV:function(n){this.$R1=n;$3(this,"Files");return n},get_$2sa:function(){return 15},get_$Ld:function(){return this.get_$1xz()?0:1},get_$tj:function(){this.$El||(this.$El=new _C(this.$$d_$6Dn,_d.$5T.$hF));return this.$El},get_$1ZF:function(){this.$7V||(this.$7V=new _C(this.$$d_$2of,_d.$5T.$hF));return this.$7V},get_$1Z4:function(){this.$JN||(this.$JN=new _C(this.$$d_$6A0,_d.$5T.$hF));return this.$JN},get_$4SU:function(){return new _y.$2W(_y.$c.get_$FK(),_y.$c.get_$1jj(),_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,this.get_$tj())},get_$5Ht:function(){return new _y.$2W(_y.$c.get_$12P(),_y.$c.get_$12Q(),_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$1Z4())},get_$1iT:function(){return this.get_$1xz()?2:0},get_$2MT:function(){return this.$$d_$1RW},get_$3gs:function(){return new _y.$2W(_y.$c.get_$9b(),_y.$c.get_$Mh(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,this.get_$1ZF())},get_$40f:function(){return this.$33O&&this.$AD.get_$ao().get_$2v5()},get_$5a3:function(){return this.$33O&&this.$AD.get_$ao().get_$2GF()},get_$5d6:function(){return this.get_$40f()||this.get_$5a3()||_a.UserAgent.getInstance().$hh},get_$2NO:function(){return this.$1Nb},set_$2NO:function(n){this.$1Nb=n!==""?n+String.format("&sc={0}",(new Date).getTime()):n;$3(this,"ImageSource");return n},get_$3ns:function(){if(!this.$qD){this.$qD=new _js.$Z;this.$qD.$D(new _a.$2G(new _C(this.$$d_$3Lm,_d.$5T.$hF),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));this.$qD.$D(new _a.$2G(new _C(this.$$d_$3oM,_d.$5T.$hF),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$qD.$D(new _a.$2G(new _C(this.$$d_$1vp,_d.$5T.$hF),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$qD},$Uz:function(){_y.$1KT.prototype.$Uz.call(this);this.$6OB()},$6OB:function(){this.$XM=0;this.$1UG=0;this.set_$j4(!1);this.set_$2NO(this.$26J+"&isPreview=false");this.$2Ya=this.$1Nb;this.$x4=!1},$9Lk:function(){if(this.get_$40f()){_js.Trace.logInfo(_d.$5T.$hF,"Call to get photo from gallery");this.$AD.$2wE(!1,this.$$d_$2ED,this.$$d_$3HM);return}if(this.$AD.get_$ao().get_$3Di()){_js.Trace.logInfo(_d.$5T.$hF,"Call to native file picker");var n=this,t=this;this.$AD.$3Gi(!1,"*",1,function(t){t.length>0&&n.$2ED(t[0])},function(n){$6y3(t,n)});return}_a.UserAgent.getInstance().$hh&&this.$2Xj&&this.$2Xj.$n()},$9Bi:function(){_js.Trace.logInfo(_d.$5T.$hF,"Call to get photo from camera");this.$AD.$2wD(!1,this.$$d_$2ED,this.$$d_$3HM)},$9Lj:function(){$6y4(this,this.$R1.$3q(0))},$2ED:function(n){var t=$2Cp(this,1,null,n);t.add_$2C(this.$$d_$A1W);t.add_$1x(this.$$d_$A1V);this.$1UG=1;this.$2Ya=this.$26J+"&isPreview=true";this.set_$j4(!0);this.$k.$z(t)},$9F3:function(n){var t=$2Cp(this,1,n,null);t.add_$2C(this.$$d_$A1W);t.add_$1x(this.$$d_$A1V);this.$1UG=1;this.$2Ya=this.$26J+"&isPreview=true";this.set_$j4(!0);this.$k.$z(t)},$A1W:function(n){this.set_$j4(!1);this.set_$2NO(this.$2Ya);this.$XM=this.$1UG;if(this.$1UG===3){this.$x4=!0;$6C(this,"UploadPhotoClosed");this.$2of()}},$A1V:function(n){this.set_$j4(!1);this.get_$Cg().$32(0,n.$1f.message,null)},$6Dn:function(){if(!this.$fq)switch(this.$XM){case 0:this.$2of();break;case 1:var n=$2Cp(this,0,"",null);n.add_$2C(this.$$d_$A1W);n.add_$1x(this.$$d_$A1V);this.$1UG=3;this.set_$j4(!0);this.$k.$z(n);break;case 2:var t=$2Cp(this,2,"",null);t.add_$2C(this.$$d_$A1W);t.add_$1x(this.$$d_$A1V);this.$1UG=3;this.set_$j4(!0);this.$k.$z(t);break}},$1h8:function(){return this.$1RW(null,2)},$6A0:function(){if(!this.$fq)switch(this.$XM){case 0:this.set_$2NO("");this.$XM=2;break;case 1:var n=$2Cp(this,3,"",null);n.add_$2C(this.$$d_$A1W);n.add_$1x(this.$$d_$A1V);this.$1UG=0;this.$2Ya=this.$26J+"&isPreview=false";this.set_$j4(!0);this.$k.$z(n);break;case 2:break}},$1RW:function(n,t){if(this.$fq)return!0;if(this.$x4)return!1;if(this.$XM){this.set_$1c4(!0);return!0}return!1},$3HM:function(n){_js.Trace.logError(_d.$5T.$hF,n.message)},$5Mj:function(){this.get_$Cg().$32(0,"Error when reading the file",null)},$2of:function(){this.get_$4i()&&this.get_$4i().get_$7u()===this&&this.$1Fv()},$3Lm:function(){this.$x4=!0;this.$1vp();this.$6Dn()},$3oM:function(){this.$x4=!0;this.$1vp();this.$2of();this.get_$43d()&&$6C(this,"UploadPhotoClosed")},$1vp:function(){this.set_$1c4(!1)}};_d.$n9=function(n,t,i){this.$1B=n;this.$3Pm=t;this.$6Gm=i};_d.$n9.prototype={$1B:null,$3Pm:null,$6Gm:null};OSF.AppSpecificSetup.registerClass("OSF.AppSpecificSetup");_d.$rI.registerClass("_d.$rI");_d.$1AK.registerClass("_d.$1AK");CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.$1In);_d.$9Z.registerClass("_d.$9Z",_a.$F2,IPopOutViewModel);_d.$D0.registerClass("_d.$D0",null,IPopOutHelper);_d.$Pk.registerClass("_d.$Pk",_js.$8,_d.$1Fc);_d.$V4.registerClass("_d.$V4");_d.$Dz.registerClass("_d.$Dz",_a.$F2);_d.$Zo.registerClass("_d.$Zo");_d.$Fq.registerClass("_d.$Fq",_a.$F2);_d.$IY.registerClass("_d.$IY",_a.$F2);_d.$5e.registerClass("_d.$5e",_0365m.$2b);_d.$6k.registerClass("_d.$6k",_a.$F2);_d.$QP.registerClass("_d.$QP");_d.$5X.registerClass("_d.$5X",_a.$F2);_d.$nX.registerClass("_d.$nX");_d.$CK.registerClass("_d.$CK",_a.$F2);_d.$nW.registerClass("_d.$nW");_d.$LR.registerClass("_d.$LR",_a.$F2);_d.$EX.registerClass("_d.$EX");_d.$1Ki.registerClass("_d.$1Ki",_y.$1KT);_d.$9A.registerClass("_d.$9A");_d.$1KY.registerClass("_d.$1KY",_a.$F2,_g.$Jl,_js.$x6,_g.$PF);_d.$LU.registerClass("_d.$LU",_d.$1KY,_g.$1Hg,_g.$Jl,_js.$x6);_d.$Zy.registerClass("_d.$Zy");_d.$EY.registerClass("_d.$EY",_a.$F2,_y.$1Gh);_d.$sb.registerClass("_d.$sb");_d.$70.registerClass("_d.$70",_y.$Lc);_d.$Cm.registerClass("_d.$Cm");_d.$1EU.registerClass("_d.$1EU",_js.$8,_g.$wU);_d.$JK.registerClass("_d.$JK",_a.$F2);_d.$1r.registerClass("_d.$1r",_a.$F2,_d.$wQ,_d.$16v);_d.$1Kk.registerClass("_d.$1Kk",_d.$1r);_d.$1Kw.registerClass("_d.$1Kw",_d.$1Kk);_d.$mm.registerClass("_d.$mm",_d.$1Kw);_d.$JO.registerClass("_d.$JO",_d.$LU);_d.$ST.registerClass("_d.$ST",null,_0365m.$17M);_d.$nN.registerClass("_d.$nN");_d.$UC.registerClass("_d.$UC",_0365m.$Gv);_d.$129.registerClass("_d.$129",_d.$UC);_d.$nP.registerClass("_d.$nP",_a.$F2);_d.$uN.registerClass("_d.$uN");_d.$12A.registerClass("_d.$12A",_d.$uN);_d.$JS.registerClass("_d.$JS");_d.$Ht.registerClass("_d.$Ht",_a.$F2);_d.$7K.registerClass("_d.$7K",_a.$F2);_d.$7x.registerClass("_d.$7x",_d.$1r);_d.$Fr.registerClass("_d.$Fr",_d.$7x);_d.$QL.registerClass("_d.$QL");_d.$Fs.registerClass("_d.$Fs");_d.$nV.registerClass("_d.$nV");_d.$nc.registerClass("_d.$nc",_a.$F2);_d.$JT.registerClass("_d.$JT",_d.$nc);_d.$AJ.registerClass("_d.$AJ",_d.$JT);_d.$QN.registerClass("_d.$QN",_0365m.$m);_d.$KU.registerClass("_d.$KU",_a.$F2,_y.$d7);_d.$3e.registerClass("_d.$3e",_d.$1Ki,_c.$1IJ);_d.$Og.registerClass("_d.$Og",_js.$8);_d.$Ia.registerClass("_d.$Ia");_d.$nZ.registerClass("_d.$nZ",_d.$1KY);_d.$i1.registerClass("_d.$i1");_d.$na.registerClass("_d.$na",_d.$AJ);_d.$Vk.registerClass("_d.$Vk");_d.$nb.registerClass("_d.$nb");_d.$uS.registerClass("_d.$uS",_d.$nc);_d.$Fu.registerClass("_d.$Fu",_y.$1KT,_y.$pR,ICalendarPickerViewModel);_d.$i3.registerClass("_d.$i3",_d.$JT);_d.$Ic.registerClass("_d.$Ic",_y.$1KT);_d.$a1.registerClass("_d.$a1");_d.$6C.registerClass("_d.$6C",_d.$nc,_y.$17i);_d.$LV.registerClass("_d.$LV",_d.$7x);_d.$12V.registerClass("_d.$12V",_d.$LV);_d.$nl.registerClass("_d.$nl",_d.$LV);_d.$W7.registerClass("_d.$W7",_0365m.$m);_d.$92.registerClass("_d.$92",_d.$1r);_d.$1Ks.registerClass("_d.$1Ks",_d.$92);_d.$y6.registerClass("_d.$y6",_d.$1Ks);_d.$10z.registerClass("_d.$10z",_d.$JK,_d.$wQ,_d.$16v);_d.$hS.registerClass("_d.$hS",_d.$10z);_d.$YM.registerClass("_d.$YM");_d.$1K4.registerClass("_d.$1K4",_js.$8,_d.$1FR,_js.$x6,Sys.IDisposable);_d.$Fp.registerClass("_d.$Fp",_d.$1K4);_d.$9b.registerClass("_d.$9b",_a.$F2);_d.$Vj.registerClass("_d.$Vj",null,_js.$Qw);_d.$nU.registerClass("_d.$nU",null,_js.$Qw);_d.$HD.registerClass("_d.$HD",_d.$1K4);_d.$D9.registerClass("_d.$D9",_a.$Qe,_y.$1GB);_d.$32.registerClass("_d.$32",_y.$2T);_d.$4r.registerClass("_d.$4r",_d.$32);_d.$n7.registerClass("_d.$n7");_d.$ES.registerClass("_d.$ES",_a.$F2);_d.$DD.registerClass("_d.$DD",_d.$ES);_d.$nt.registerClass("_d.$nt");_d.$JY.registerClass("_d.$JY",_a.$F2);_d.$ty.registerClass("_d.$ty",null,_d.$1Ii);_d.$12m.registerClass("_d.$12m",_d.$Cm);_d.$nu.registerClass("_d.$nu");_d.$LX.registerClass("_d.$LX",null,_y.$1GK,_y.$1GH,_y.$1GG);_d.$88.registerClass("_d.$88",_a.$Qe,_y.$1GB);_d.$nv.registerClass("_d.$nv",_d.$Cm);_d.$Vu.registerClass("_d.$Vu");_d.$13.registerClass("_d.$13",_y.$1KT,_y.$pR,_y.$XX,_y.$d6,_y.$wY,_d.$1Fc,_y.$wZ,_d.$1Ih);_d.$C4.registerClass("_d.$C4",null,_y.$183,_y.$xE);_d.$QY.registerClass("_d.$QY");_d.$E5.registerClass("_d.$E5",_a.$F2,_c.$1IL,_g.$wU,_d.$1FV);_d.$Hx.registerClass("_d.$Hx",_a.$F2);_d.$ny.registerClass("_d.$ny");_d.$12r.registerClass("_d.$12r");_d.$4M.registerClass("_d.$4M",_y.$Lc);_d.$4B.registerClass("_d.$4B",_js.$8,_d.$1FQ);_d.$NB.registerClass("_d.$NB");_d.$ka.registerClass("_d.$ka",_js.$8);_d.$qm.registerClass("_d.$qm",_y.$Lc);_d.$Rc.registerClass("_d.$Rc",_a.$F2);_d.$47.registerClass("_d.$47",_d.$Rc);_d.$qz.registerClass("_d.$qz",null,_y.$183);_d.$ex.registerClass("_d.$ex",null,_d.$xI);_d.$fR.registerClass("_d.$fR");_d.$GN.registerClass("_d.$GN");_d.$F0.registerClass("_d.$F0",_js.$8);_d.$Yy.registerClass("_d.$Yy");_d.$Ft.registerClass("_d.$Ft",_a.$F2,ICalendarMiniatureItemViewModel,_js.$x6,Sys.IDisposable);_d.$5U.registerClass("_d.$5U",_a.$F2,ICalendarMiniatureNextAppointmentManager,_js.$x6);_d.$5U.$7Ts.registerClass("_d.$5U.$7Ts",_cc.$Ay);_d.$4Y.registerClass("_d.$4Y",_d.$1Ki,_y.$XX,_y.$d6,_y.$wY);_d.$Po.registerClass("_d.$Po",_a.$F2);_d.$BW.registerClass("_d.$BW",_a.$F2);_d.$B9.registerClass("_d.$B9",_d.$BW);_d.$Rn.registerClass("_d.$Rn",_d.$BW);_d.$Rm.registerClass("_d.$Rm",_d.$Rn);_d.$rh.registerClass("_d.$rh",_d.$1Kw);_d.$l2.registerClass("_d.$l2",_d.$1KY);_d.$MS.registerClass("_d.$MS",_d.$BW);_d.$rk.registerClass("_d.$rk",_d.$Rn);_d.$rl.registerClass("_d.$rl",_d.$Rn);_d.$LN.registerClass("_d.$LN",_a.$F2);_d.$Fm.registerClass("_d.$Fm",_a.$F2);_d.$LO.registerClass("_d.$LO",_a.$F2);_d.$Zf.registerClass("_d.$Zf");_d.$Ms.registerClass("_d.$Ms",_a.$F2);_d.$QO.registerClass("_d.$QO",_a.$Qe,_y.$1GB);_d.$3a.registerClass("_d.$3a",_y.$1KT,_y.$XX,_y.$d6,_y.$wY,_d.$1Fc,_y.$1Iu,_js.$x6,Sys.IDisposable);_d.$JU.registerClass("_d.$JU",null,_y.$183,ICalendarReadingPaneViewModelFactory);_d.$6A.registerClass("_d.$6A",_a.$F2,_y.$16x);_d.$hz.registerClass("_d.$hz");_d.$Od.registerClass("_d.$Od",_d.$Cm);_d.$12J.registerClass("_d.$12J",_y.$CS);_d.$Zu.registerClass("_d.$Zu");_d.$uc.registerClass("_d.$uc",_a.$F2,_g.ICalendarTimePeriod);_d.$bK.registerClass("_d.$bK",_d.$Cm);_d.$5x.registerClass("_d.$5x",_a.$F2);_d.$iu.registerClass("_d.$iu");_d.$1t.registerClass("_d.$1t",_a.$F2);_d.$kB.registerClass("_d.$kB");_d.$yb.registerClass("_d.$yb");_d.$Jc.registerClass("_d.$Jc",null,_d.$To,_y.$17C);_d.$Jx.registerClass("_d.$Jx",null,_d.$To,_y.$17C);_d.$Jy.registerClass("_d.$Jy",null,_d.$To,_y.$17C);_d.$IH.registerClass("_d.$IH",null,_d.$To,_y.$17C);_d.$He.registerClass("_d.$He");_d.$DT.registerClass("_d.$DT",_js.$8);_d.$2r.registerClass("_d.$2r");_d.$zP.registerClass("_d.$zP",_a.$F2);_d.$JM.registerClass("_d.$JM",null,_d.$To,_y.$17C);_d.$KP.registerClass("_d.$KP",null,_d.$To,_y.$17C);_d.$LL.registerClass("_d.$LL",null,_d.$To,_y.$17C);_d.$7C.registerClass("_d.$7C",_a.$F2);_d.$KD.registerClass("_d.$KD",_a.$F2,_y.$16x);_d.$zh.registerClass("_d.$zh",_a.$F2,_g.$Jl,_js.$x6);_d.$8Z.registerClass("_d.$8Z",_y.$w,_g.$1HZ);_d.$LE.registerClass("_d.$LE",_d.$8Z);_d.$Eq.registerClass("_d.$Eq",null,_y.$1GZ);_d.$YT.registerClass("_d.$YT",_d.$Eq);_d.$3Z.registerClass("_d.$3Z",_d.$88);_d.$6a.registerClass("_d.$6a",_a.$F2,_d.$1FP,_g.ICalendarTimePeriod);_d.$4g.registerClass("_d.$4g",_d.$7x,_y.$R5,_d.$1FX);_d.$4g.$3eD.registerClass("_d.$4g.$3eD");_d.$5d.registerClass("_d.$5d",_y.$1KT,_y.$pR);_d.$KE.registerClass("_d.$KE",_a.$F2,_g.$Jl,_js.$x6,_g.$PF);_d.$sE.registerClass("_d.$sE",_y.$Dt);_d.$6g.registerClass("_d.$6g",_y.$1KT,_y.$pR,_y.$d6,_d.$1FW);_d.$Gs.registerClass("_d.$Gs",null,_d.$1FU);_d.$8c.registerClass("_d.$8c",_d.$LV,_y.$R5,Sys.IDisposable,_d.$1FX);_d.$1EZ.registerClass("_d.$1EZ",null,_d.$1FZ);_d.$st.registerClass("_d.$st",_a.$F2);_d.$su.registerClass("_d.$su",_a.$F2);_d.$F1.registerClass("_d.$F1",_a.$F2);_d.$hb.registerClass("_d.$hb");_d.$Fn.registerClass("_d.$Fn",_a.$F2,_d.$1FY,_js.$x6);_d.$GT.registerClass("_d.$GT",_y.$1KT);_d.$Ox.registerClass("_d.$Ox");_d.$IP.registerClass("_d.$IP",_a.$F2,_d.$1Fo,_js.$x6,_d.$1FP);_d.$lP.registerClass("_d.$lP",_a.$F2);_d.$Ev.registerClass("_d.$Ev",_a.$F2,_d.$1G2,_js.$x6);_d.$zc.registerClass("_d.$zc",_a.$F2);_d.$Py.registerClass("_d.$Py",_d.$Fn);_d.$MW.registerClass("_d.$MW",_d.$Fn);_d.$1C6.registerClass("_d.$1C6",_d.$MW);_d.$aD.registerClass("_d.$aD",_a.$F2);_d.$v2.registerClass("_d.$v2",_a.$F2);_d.$WO.registerClass("_d.$WO",_a.$F2);_d.$NH.registerClass("_d.$NH",_a.$F2);_d.$Bi.registerClass("_d.$Bi",_a.$1);_d.$NS.registerClass("_d.$NS",null,IModuleHelpProvider);_d.$3.registerClass("_d.$3");_d.$Ey.registerClass("_d.$Ey",_js.$8);_d.$U5.registerClass("_d.$U5",_js.$8,_y.$1GQ);_d.$19N.registerClass("_d.$19N",null,IMeetNowManagerFactory);_d.$UB.registerClass("_d.$UB");_d.$eQ.registerClass("_d.$eQ",_a.$F2,IOpenAnotherMailboxViewModel);_d.$Y0.registerClass("_d.$Y0",null,_d.$180);_d.$4Z.registerClass("_d.$4Z",_a.$F2);_d.$9q.registerClass("_d.$9q",_a.$F2);_d.$s1.registerClass("_d.$s1",_a.$F2);_d.$5Z.registerClass("_d.$5Z",_a.$F2);_d.$7V.registerClass("_d.$7V",_y.$1KT);_d.$10e.registerClass("_d.$10e",null,_d.$1G3);_d.$1Bh.registerClass("_d.$1Bh",_d.$10e);_d.$1Ka.registerClass("_d.$1Ka",_a.$F2);_d.$12g.registerClass("_d.$12g",_d.$1Ka);_d.$1AS.registerClass("_d.$1AS",_d.$1Ka);_d.$yp.registerClass("_d.$yp",null,_y.$17Y);_d.$39.registerClass("_d.$39",_y.$Lc,_y.$17Y);_d.$OR.registerClass("_d.$OR",_a.$F2);_d.$WE.registerClass("_d.$WE",null,_y.$183);_d.$WE.$4O4.registerClass("_d.$WE.$4O4");_d.$oQ.registerClass("_d.$oQ");_d.$14Y.registerClass("_d.$14Y",null,_d.$1G1);_d.$Bh.registerClass("_d.$Bh",null,_d.$1G1);_d.$3p.registerClass("_d.$3p");_d.$tU.registerClass("_d.$tU",_d.$3p);_d.$11B.registerClass("_d.$11B",_d.$tU);_d.$119.registerClass("_d.$119",_d.$tU);_d.$tV.registerClass("_d.$tV",_d.$3p);_d.$li.registerClass("_d.$li",_d.$3p);_d.$124.registerClass("_d.$124",_d.$li);_d.$123.registerClass("_d.$123",_d.$li);_d.$ix.registerClass("_d.$ix");_d.$WL.registerClass("_d.$WL");_d.$2c.registerClass("_d.$2c");_d.$1Jj.registerClass("_d.$1Jj",_d.$2c);_d.$14X.registerClass("_d.$14X",_d.$1Jj);_d.$6F.registerClass("_d.$6F",_d.$2c);_d.$oR.registerClass("_d.$oR",_d.$6F);_d.$oS.registerClass("_d.$oS");_d.$14a.registerClass("_d.$14a",_d.$1Jj);_d.$TE.registerClass("_d.$TE",_d.$6F);_d.$158.registerClass("_d.$158",_d.$3p);_d.$15b.registerClass("_d.$15b",_d.$3p);_d.$or.registerClass("_d.$or",_d.$3p);_d.$16A.registerClass("_d.$16A",_d.$3p);_d.$16E.registerClass("_d.$16E",_d.$3p);_d.$18p.registerClass("_d.$18p",_d.$3p);_d.$1BS.registerClass("_d.$1BS",_d.$3p);_d.$Uq.registerClass("_d.$Uq",_d.$3p);_d.$1CW.registerClass("_d.$1CW",_d.$3p);_d.$1Cg.registerClass("_d.$1Cg",_d.$3p);_d.$1Cj.registerClass("_d.$1Cj",_d.$3p);_d.$57.registerClass("_d.$57");_d.$10q.registerClass("_d.$10q",null,_y.$js,_a.$17F);_d.$2k.registerClass("_d.$2k",_a.$F2,_y.$1GJ);_d.$H9.registerClass("_d.$H9",_d.$2k);_d.$uj.registerClass("_d.$uj",_y.$1KT,_y.$XX,_y.$d6,_y.$wY,_y.$pR);_d.$Qi.registerClass("_d.$Qi");_d.$14Z.registerClass("_d.$14Z",_a.$T);_d.$14Z.prototype.$9a=_a.$T.prototype.$9a;_d.$Im.registerClass("_d.$Im",null,IExtensibilityStatistics);_d.$Im.$53F.registerClass("_d.$Im.$53F");_d.$Im.$7SY.registerClass("_d.$Im.$7SY");_d.$Im.$5MH.registerClass("_d.$Im.$5MH");_d.$Im.$7nd.registerClass("_d.$Im.$7nd");_d.$I1.registerClass("_d.$I1",_a.$F2);_d.$vX.registerClass("_d.$vX",_y.$1KT,_y.$XX,_y.$d6,_y.$wY,_y.$pR);_d.$oT.registerClass("_d.$oT");_d.$TF.registerClass("_d.$TF",_d.$2k);_d.$14b.registerClass("_d.$14b",_a.$T);_d.$14b.prototype.$9a=_a.$T.prototype.$9a;_d.$vY.registerClass("_d.$vY",_js.$DC);_d.$TG.registerClass("_d.$TG",null,IExtensibilityViewModelFactory);_d.$G3.registerClass("_d.$G3",_a.$F2,_y.$1GF);_d.$Ci.registerClass("_d.$Ci");_d.$12e.registerClass("_d.$12e",_d.$Ci);_d.$vS.registerClass("_d.$vS");_d.$7a.registerClass("_d.$7a");_d.$18S.registerClass("_d.$18S",_d.$Ci);_d.$5o.registerClass("_d.$5o",_d.$Ci);_d.$I9.registerClass("_d.$I9",_d.$Ci);_d.$M4.registerClass("_d.$M4",_d.$Ci);_d.$H7.registerClass("_d.$H7",_a.$F2);_d.$a7.registerClass("_d.$a7",null,_y.$183);_d.$QU.registerClass("_d.$QU",_a.$Qe,_y.$1GB);_d.$1D8.registerClass("_d.$1D8",null,_c.$xX);_d.$1Ja.registerClass("_d.$1Ja",null,_y.$17Y);_d.$TL.registerClass("_d.$TL",_d.$1Ja);_d.$vg.registerClass("_d.$vg",_d.$1Ja);_d.$2C.registerClass("_d.$2C",_y.$6b);_d.$bd.registerClass("_d.$bd",_d.$2C);_d.$5z.registerClass("_d.$5z",_y.$1KT,_y.$d6);_d.$dR.registerClass("_d.$dR");_d.$R7.registerClass("_d.$R7",_a.$F2);_d.$qC.registerClass("_d.$qC");_d.$ED.registerClass("_d.$ED",_a.$F2);_d.$9T.registerClass("_d.$9T",_a.$F2,_y.$wY);_d.$qD.registerClass("_d.$qD");_d.$8l.registerClass("_d.$8l",_d.$88);_d.$YC.registerClass("_d.$YC",_y.$FS.$$(_d.$8Z));_d.$1Ak.registerClass("_d.$1Ak",_a.$F2);_d.$kt.registerClass("_d.$kt",_d.$1Ak);_d.$z1.registerClass("_d.$z1",_d.$5z);_d.$YD.registerClass("_d.$YD",_d.$1Ak);_d.$6I.registerClass("_d.$6I",_y.$1KT,_y.$pR,_y.$XX,_y.$d6,_y.$wY);_d.$eh.registerClass("_d.$eh");_d.$9c.registerClass("_d.$9c",_a.$Qe,_g.ICalendarTimePeriod);_d.$qI.registerClass("_d.$qI");_d.$x7.registerClass("_d.$x7");_d.$pn.registerClass("_d.$pn");_d.$re.registerClass("_d.$re");_d.$Bp.registerClass("_d.$Bp",_js.$8);_d.$Al.registerClass("_d.$Al",_d.$Bp,_d.$1Ih);_d.$7m.registerClass("_d.$7m",_d.$Bp);_d.$191.registerClass("_d.$191",_d.$7m);_d.$DQ.registerClass("_d.$DQ",_d.$Bp);_d.$PM.registerClass("_d.$PM");_d.$PN.registerClass("_d.$PN",_d.$Bp);_d.$R9.registerClass("_d.$R9",_d.$Bp);_d.$Tz.registerClass("_d.$Tz",_d.$Bp);_d.$194.registerClass("_d.$194",_d.$Bp);_d.$Js.registerClass("_d.$Js",_d.$Bp);_d.$qH.registerClass("_d.$qH",_d.$Bp);_d.$DP.registerClass("_d.$DP",_d.$Bp);_d.$8U.registerClass("_d.$8U",_d.$Bp);_d.$Bq.registerClass("_d.$Bq",_d.$Bp,_y.$1GE);_d.$90.registerClass("_d.$90",_d.$Bp);_d.$Gc.registerClass("_d.$Gc",_d.$Bp);_d.$196.registerClass("_d.$196",_d.$Bp,_y.$1GT);_d.$197.registerClass("_d.$197",_d.$Bp);_d.$PO.registerClass("_d.$PO",_d.$Bp);_d.$3z.registerClass("_d.$3z",_d.$Bp,_d.$1Ii);_d.$Jt.registerClass("_d.$Jt",_js.$8);_d.$4p.registerClass("_d.$4p",_d.$Bp);_d.$Ek.registerClass("_d.$Ek",_d.$Bp);_d.$8V.registerClass("_d.$8V",_d.$Bp);_d.$198.registerClass("_d.$198",_d.$Bp);_d.$EF.registerClass("_d.$EF",_d.$Bp);_d.$Gd.registerClass("_d.$Gd",_d.$Bp);_d.$PP.registerClass("_d.$PP",_d.$Bp);_d.$195.registerClass("_d.$195",_d.$Bp);_d.$dZ.registerClass("_d.$dZ",_d.$Bp);_d.$EE.registerClass("_d.$EE",_d.$Bp,_y.$1GL,_y.$1GH,_y.$1GG);_d.$13v.registerClass("_d.$13v",_y.$1KV);_d.$Gq.registerClass("_d.$Gq",_d.$13v);_d.$kx.registerClass("_d.$kx",_y.$Lc);_d.$ky.registerClass("_d.$ky",_a.$F2,_y.$16x);_d.$1KX.registerClass("_d.$1KX",_a.$F2);_d.$rZ.registerClass("_d.$rZ",_d.$1KX);_d.$Ak.registerClass("_d.$Ak");_d.$192.registerClass("_d.$192");_d.$193.registerClass("_d.$193",null,IMailComposeContextFactory);_d.$Xl.registerClass("_d.$Xl",null,IMailComposeViewModelFactory,_y.$183);_d.$xS.registerClass("_d.$xS",_a.$F2);_d.$MB.registerClass("_d.$MB",_d.$13v);_d.$11s.registerClass("_d.$11s",_d.$MB);_d.$13Y.registerClass("_d.$13Y",_d.$MB);_d.$14c.registerClass("_d.$14c",_d.$MB);_d.$18e.registerClass("_d.$18e",_d.$MB);_d.$PS.registerClass("_d.$PS",_d.$1KX);_d.$19U.registerClass("_d.$19U",_d.$MB);_d.$O3.registerClass("_d.$O3",_a.$F2);_d.$1BI.registerClass("_d.$1BI",_d.$MB);_d.$1Bg.registerClass("_d.$1Bg",_d.$MB);_d.$6s.registerClass("_d.$6s",_js.$8,_y.$1Ge);_d.$R.registerClass("_d.$R",_a.$1,_g.$1Ha,_y.$1Gf,_y.$1GB);_d.$qG.registerClass("_d.$qG",null,IMailComposeDiscardManager);_d.$1m.registerClass("_d.$1m",_a.$Qe);_d.$199.registerClass("_d.$199");_d.$Am.registerClass("_d.$Am",_y.$1KT,_y.$Lw,_y.$M1,_y.$wY,_js.$x6,_y.$pm,_y.$pR,_y.$XX,_y.$d6);_d.$AU.registerClass("_d.$AU",_a.$F2,_y.$1Gd);_d.$qK.registerClass("_d.$qK",null,IMailResponseViewModelFactory);_d.$kI.registerClass("_d.$kI",_a.$F2);_d.$CY.registerClass("_d.$CY");_d.$XR.registerClass("_d.$XR",null,IInstantSearchFactory);_d.$pp.registerClass("_d.$pp",_js.$8,IInstantSearchRefinerManager);_d.$pp.$XO.registerClass("_d.$pp.$XO");_d.$pp.$178.registerClass("_d.$pp.$178");_d.$x9.registerClass("_d.$x9",_a.$F2,_y.$1GM);_d.$YK.registerClass("_d.$YK",_a.$F2,IRefinerViewModel,_js.$x6);_d.$yo.registerClass("_d.$yo",_d.$YK);_d.$Ut.registerClass("_d.$Ut",_js.$8,ISearchRefinerCategoryViewModel,_js.$x6);_d.$Dd.registerClass("_d.$Dd",_a.$F2);_d.$mw.registerClass("_d.$mw");_d.$o1.registerClass("_d.$o1",null,_0365m.$17M);_d.$BM.registerClass("_d.$BM",_a.$F2);_d.$vN.registerClass("_d.$vN",_y.$1KT);_d.$DI.registerClass("_d.$DI",_lv.$53);_d.$14t.registerClass("_d.$14t");_d.$18M.registerClass("_d.$18M",null,_y.$pd,_y.$183);_d.$CR.registerClass("_d.$CR",_y.$1KT,_y.$xH);_d.$M6.registerClass("_d.$M6",_y.$1KT,_y.$xH);_d.$xc.registerClass("_d.$xc",null,IItemPartPartnerViewModelFactory);_d.$xd.registerClass("_d.$xd",null,IItemReadingPaneContextFactory);_d.$18U.registerClass("_d.$18U",null,_y.$HN,_y.$183);_d.$RB.registerClass("_d.$RB",null,IMailErrorHandler);_d.$k3.registerClass("_d.$k3",_a.$F2);_d.$5E.registerClass("_d.$5E",_y.$Lc,IMailFolderPermissionsDialogViewModel);_d.$do.registerClass("_d.$do",_a.$F2);_d.$RC.registerClass("_d.$RC",_d.$do);_d.$dp.registerClass("_d.$dp");_d.$o2.registerClass("_d.$o2");_d.$19M.registerClass("_d.$19M",_d.$Cm);_d.$PU.registerClass("_d.$PU",_d.$Cm);_d.$qP.registerClass("_d.$qP",_d.$Cm);_d.$Jv.registerClass("_d.$Jv",_d.$do);_d.$xz.registerClass("_d.$xz",_d.$do);_d.$RJ.registerClass("_d.$RJ",_a.$F2,_y.$1Gh);_d.$zN.registerClass("_d.$zN",_d.$do);_d.$Uw.registerClass("_d.$Uw",_a.$F2,ISharedFolderViewModel);_d.$8Y.registerClass("_d.$8Y",_a.$F2);_d.$Ie.registerClass("_d.$Ie",_d.$8Y);_d.$Vr.registerClass("_d.$Vr",_a.$F2);_d.$Mu.registerClass("_d.$Mu",_d.$8Y);_d.$Da.registerClass("_d.$Da",_d.$8Y);_d.$Bv.registerClass("_d.$Bv",_d.$8Y);_d.$Pa.registerClass("_d.$Pa",_a.$F2);_d.$Kx.registerClass("_d.$Kx",_a.$F2,INotificationTrayViewModel);_d.$yP.registerClass("_d.$yP",null,INotificationTrayViewModel);_d.$rH.registerClass("_d.$rH",_js.$8,_d.$18J,_js.$x6);_d.$Rs.registerClass("_d.$Rs",_d.$8Y);_d.$tI.registerClass("_d.$tI",_js.$8,_d.$18J,_js.$x6);_d.$En.registerClass("_d.$En",_y.$1KT,_y.$XX,_y.$d6,_y.$wY);_d.$Nr.registerClass("_d.$Nr",_d.$En);_d.$K0.registerClass("_d.$K0",_d.$En);_d.$L1.registerClass("_d.$L1",_d.$En);_d.$MJ.registerClass("_d.$MJ",_d.$En);_d.$qn.registerClass("_d.$qn",_js.$8);_d.$K1.registerClass("_d.$K1",_a.$F2);_d.$L2.registerClass("_d.$L2",_y.$FS.$$(_d.$K1));_d.$yZ.registerClass("_d.$yZ",_y.$1KT,IOptionsViewModel);_d.$9X.registerClass("_d.$9X",_d.$yZ,_y.$XX,_y.$d6,_y.$wY);_d.$yY.registerClass("_d.$yY",_d.$yZ);_d.$UM.registerClass("_d.$UM",_d.$En);_d.$Yn.registerClass("_d.$Yn",_a.$F2);_d.$Np.registerClass("_d.$Np",_d.$En);_d.$CW.registerClass("_d.$CW",_d.$En);_d.$Ok.registerClass("_d.$Ok",_a.$F2);_d.$1Jg.registerClass("_d.$1Jg",null,_d.$1Hh);_d.$nw.registerClass("_d.$nw",_d.$1Jg);_d.$Ig.registerClass("_d.$Ig",_a.$F2);_d.$12q.registerClass("_d.$12q",_d.$nw);_d.$kp.registerClass("_d.$kp");_d.$A9.registerClass("_d.$A9",_a.$F2);_d.$nM.registerClass("_d.$nM",_a.$F2);_d.$WF.registerClass("_d.$WF",_a.$F2);_d.$ox.registerClass("_d.$ox");_d.$Ua.registerClass("_d.$Ua",_d.$4Z,_0365f.$jO);_d.$p1.registerClass("_d.$p1",_d.$Ua,_0365f.$jO);_d.$p2.registerClass("_d.$p2");_d.$ow.registerClass("_d.$ow");_d.$TY.registerClass("_d.$TY",_a.$F2);_d.$2h.registerClass("_d.$2h",_a.$F2);_d.$4z.registerClass("_d.$4z",_y.$FS.$$(_d.$2h));_d.$1Kf.registerClass("_d.$1Kf",_y.$FS.$$(_d.$4z));_d.$H8.registerClass("_d.$H8",_a.$F2,_y.$Te);_d.$iF.registerClass("_d.$iF");_d.$um.registerClass("_d.$um",_y.$Eo);_d.$JZ.registerClass("_d.$JZ",_a.$F2,_y.$1Ga);_d.$St.registerClass("_d.$St",null,ICompositePersonaViewModelFactory);_d.$iL.registerClass("_d.$iL",_a.$F2);_d.$4s.registerClass("_d.$4s",_a.$F2);_d.$WD.registerClass("_d.$WD",_a.$F2);_d.$bC.registerClass("_d.$bC",_y.$FS.$$(_d.$WD));_d.$L9.registerClass("_d.$L9");_d.$14d.registerClass("_d.$14d",null,_y.$17Y);_d.$1KQ.registerClass("_d.$1KQ",_a.$F2);_d.$8i.registerClass("_d.$8i",_y.$FS.$$(_d.$1KQ),_y.$M1,_y.$wY,_js.$x6,_y.$pm,_y.$R5);_d.$K2.registerClass("_d.$K2",_d.$8i);_d.$DJ.registerClass("_d.$DJ");_d.$Jf.registerClass("_d.$Jf",_d.$2C,_y.$1GY,_js.$x6);_d.$P3.registerClass("_d.$P3",_d.$1KQ);_d.$1Jc.registerClass("_d.$1Jc");_d.$18a.registerClass("_d.$18a",_a.$F2);_d.$xh.registerClass("_d.$xh",_a.$F2);_d.$xi.registerClass("_d.$xi",_a.$F2);_d.$18b.registerClass("_d.$18b",_d.$xi,_y.$16x);_d.$dG.registerClass("_d.$dG",_d.$xi,_y.$M1,_y.$wY,_js.$x6,_y.$pm,_y.$R5);_d.$jx.registerClass("_d.$jx");_d.$jy.registerClass("_d.$jy");_d.$Tv.registerClass("_d.$Tv",_d.$1Kf);_d.$3u.registerClass("_d.$3u",_0365m.$2b,_y.$wq);_d.$xx.registerClass("_d.$xx",null,IMeCardViewModelFactory);_d.$qt.registerClass("_d.$qt");_d.$qs.registerClass("_d.$qs");_d.$Nw.registerClass("_d.$Nw");_d.$UU.registerClass("_d.$UU",_a.$F2,_0365m.$FQ);_d.$MO.registerClass("_d.$MO",null,_0365m.$17M);_d.$K5.registerClass("_d.$K5",null,_y.$183);_d.$Pi.registerClass("_d.$Pi",_y.$FS.$$(_a.$9I),_0365f.$jO,_d.$1HU);_d.$1AQ.registerClass("_d.$1AQ",_d.$Pi);_d.$Rb.registerClass("_d.$Rb",_y.$J1);_d.$EK.registerClass("_d.$EK",_d.$Ua,_d.$1HU);_d.$1AR.registerClass("_d.$1AR",_d.$EK);_d.$HZ.registerClass("_d.$HZ",_d.$8Z);_d.$rR.registerClass("_d.$rR",_a.$F2);_d.$Rd.registerClass("_d.$Rd",_js.$8,IPeopleSearchSuggestionAdaptorViewModel,_y.$1GR,_js.$x6);_d.$1K.registerClass("_d.$1K",_d.$1Kf,_0365f.$jO);_d.$5W.registerClass("_d.$5W",_a.$Qe,_y.$1GB);_d.$yu.registerClass("_d.$yu");_d.$GG.registerClass("_d.$GG",_d.$yu,IPersonaCardViewModelFactory);_d.$yv.registerClass("_d.$yv",_d.$rX.$$(_a.$7));_d.$kr.registerClass("_d.$kr",_d.$rX.$$(_g.$1l));_d.$ed.registerClass("_d.$ed");_d.$EK.$8Es.registerClass("_d.$EK.$8Es");_d.$yt.registerClass("_d.$yt",_d.$rX.$$(_g.$6L));_d.$Ep.registerClass("_d.$Ep",_d.$rX.$$(_g.$3C));_d.$rW.registerClass("_d.$rW",_d.$rX.$$(_g.$3M));_d.$1Ai.registerClass("_d.$1Ai",_d.$rX.$$(Array));_d.$Gn.registerClass("_d.$Gn",_d.$rX.$$(String));_d.$8a.registerClass("_d.$8a",_d.$8Z);_d.$1B3.registerClass("_d.$1B3",_0365m.$m);_d.$zL.registerClass("_d.$zL",_d.$1Jg);_d.$rt.registerClass("_d.$rt",_d.$zL);_d.$MZ.registerClass("_d.$MZ",_a.$F2,_y.$17C);_d.$V2.registerClass("_d.$V2",_y.$FS.$$(_d.$MZ));_d.$1FB.registerClass("_d.$1FB",_y.$2T);_d.$1FC.registerClass("_d.$1FC",_d.$1FB);_d.$KA.registerClass("_d.$KA",_a.$F2,_y.$R5);_d.$Ui.registerClass("_d.$Ui",_y.$Sa,IRecipientWellViewModelFactory);_d.$VI.registerClass("_d.$VI");_d.$nn.registerClass("_d.$nn");_d.$o3.registerClass("_d.$o3");_d.$rO.registerClass("_d.$rO");_d.$rv.registerClass("_d.$rv");_d.$C0.registerClass("_d.$C0",_a.$F2);_d.$OO.registerClass("_d.$OO",_y.$Lc);_d.$Q6.registerClass("_d.$Q6",_a.$F2);_d.$1EJ.registerClass("_d.$1EJ",_d.$Q6);_d.$sl.registerClass("_d.$sl",_y.$1KT);_d.$Hn.registerClass("_d.$Hn",_d.$Q6);_d.$SC.registerClass("_d.$SC",_d.$Q6);_d.$1EM.registerClass("_d.$1EM",_lv.$qJ);_d.$VA.registerClass("_d.$VA",_lv.$53);_d.$sn.registerClass("_d.$sn");_d.$OP.registerClass("_d.$OP",_y.$1KT);_d.$1ER.registerClass("_d.$1ER",_lv.$67);_d.$SD.registerClass("_d.$SD",_lv.$PR);_d.$98.registerClass("_d.$98",_a.$Qe,_y.$1GB);_d.$56.registerClass("_d.$56",_y.$1KT,_y.$XX,_y.$d6,_y.$wY,_d.$1G4,_y.$18L);_d.$10Y.registerClass("_d.$10Y",null,ITaskReadingPaneViewModelFactory);_d.$gk.registerClass("_d.$gk",null,_y.$183);_d.$Mg.registerClass("_d.$Mg",_a.$F2);_d.$hU.registerClass("_d.$hU",_js.$8,_js.$Qw);_d.$4U.registerClass("_d.$4U",_a.$F2);_d.$CI.registerClass("_d.$CI",_a.$F2,_y.$1Gh);_d.$1Jb.registerClass("_d.$1Jb");_d.$1Jb.$1k.registerClass("_d.$1Jb.$1k");_d.$1Jb.$1k.$XF.registerClass("_d.$1Jb.$1k.$XF");_d.$1Jb.$1k.$Hj.registerClass("_d.$1Jb.$1k.$Hj");_d.$1Jb.$1k.$I8.registerClass("_d.$1Jb.$1k.$I8");_d.$1Jb.$1k.$2na.registerClass("_d.$1Jb.$1k.$2na");_d.$1Jb.$6w.registerClass("_d.$1Jb.$6w");_d.$Mm.registerClass("_d.$Mm",_a.$F2);_d.$11V.registerClass("_d.$11V",null,_js.$1J5);_d.$uI.registerClass("_d.$uI",null,_js.$1J5);_d.$12I.registerClass("_d.$12I",null,_js.$1J5);_d.$12F.registerClass("_d.$12F",null,_js.$1J5);_d.$KV.registerClass("_d.$KV",null,_js.$1J5);_d.$GQ.registerClass("_d.$GQ",null,_js.$1J5);_d.$ub.registerClass("_d.$ub",null,_js.$1J5);_d.$12U.registerClass("_d.$12U",null,_js.$1J5);_d.$13e.registerClass("_d.$13e",null,_js.$1J5);_d.$13w.registerClass("_d.$13w",null,_js.$1J5);_d.$oL.registerClass("_d.$oL",null,_js.$1J5);_d.$vO.registerClass("_d.$vO",null,_js.$1J5);_d.$vp.registerClass("_d.$vp",null,_js.$1J5);_d.$jA.registerClass("_d.$jA",null,_js.$1J5);_d.$qX.registerClass("_d.$qX",null,_js.$1J5);_d.$1Af.registerClass("_d.$1Af",null,_js.$1J5);_d.$1BK.registerClass("_d.$1BK",null,_js.$1J5);_d.$1BM.registerClass("_d.$1BM",null,_js.$1J5);_d.$zO.registerClass("_d.$zO",null,_js.$1J5);_d.$zX.registerClass("_d.$zX",null,_js.$1J5);_d.$1Bf.registerClass("_d.$1Bf",null,_js.$1J5);_d.$1C9.registerClass("_d.$1C9",null,_js.$1J5);_d.$1CC.registerClass("_d.$1CC",null,_js.$1J5);_d.$mF.registerClass("_d.$mF",null,_js.$1J5);_d.$12B.registerClass("_d.$12B",null,_js.$1J5);_d.$1FN.registerClass("_d.$1FN",null,_js.$1J5);_d.$D8.registerClass("_d.$D8",_y.$1KT,IUnsupportedItemReadingPaneViewModel);_d.$14w.registerClass("_d.$14w",_a.$T);_d.$14w.prototype.$9a=_a.$T.prototype.$9a;_d.$FJ.registerClass("_d.$FJ",null,_d.$wf);_d.$TR.registerClass("_d.$TR");_d.$j8.registerClass("_d.$j8");_d.$K7.registerClass("_d.$K7");_d.$3U.registerClass("_d.$3U");_d.$46.registerClass("_d.$46");_d.$QX.registerClass("_d.$QX");_d.$9L.registerClass("_d.$9L",_a.$F2,_y.$M1,_y.$wY,_js.$x6,_y.$pm,_y.$XX,_y.$d6,_y.$R5);_d.$Cn.registerClass("_d.$Cn",_d.$9L,_y.$pR);_d.$Kb.registerClass("_d.$Kb",_d.$Cn,_d.$1Hi);_d.$HA.registerClass("_d.$HA",_d.$Cn);_d.$7c.registerClass("_d.$7c",_d.$9L,_y.$pR);_d.$5D.registerClass("_d.$5D",_d.$7c);_d.$Nj.registerClass("_d.$Nj",_d.$7c);_d.$BQ.registerClass("_d.$BQ",_d.$Nj);_d.$12W.registerClass("_d.$12W",_a.$T);_d.$12W.prototype.$9a=_a.$T.prototype.$9a;_d.$ru.registerClass("_d.$ru",_a.$T);_d.$ru.prototype.$9a=_a.$T.prototype.$9a;_d.$14F.registerClass("_d.$14F");_d.$FM.registerClass("_d.$FM",_a.$F2);_d.$PC.registerClass("_d.$PC",_y.$1KT);_d.$Pc.registerClass("_d.$Pc",_d.$En);_d.$86.registerClass("_d.$86",_y.$1KT,_y.$pR,_y.$XX,_y.$d6,_y.$wY);_d.$ye.registerClass("_d.$ye",_d.$86);_d.$7l.registerClass("_d.$7l",_js.$8);_d.$18k.registerClass("_d.$18k",_d.$7l);_d.$jw.registerClass("_d.$jw",_C);_d.$R6.registerClass("_d.$R6",_y.$1KT);_d.$dL.registerClass("_d.$dL",_d.$R6,_y.$pR);_d.$18m.registerClass("_d.$18m",_d.$7l);_d.$Jr.registerClass("_d.$Jr",_a.$F2);_d.$5J.registerClass("_d.$5J",_y.$1KT,_y.$XX,_y.$d6,_y.$wY);_d.$Xh.registerClass("_d.$Xh",_d.$5J,_y.$pR);_d.$19E.registerClass("_d.$19E",_d.$7l);_d.$UN.registerClass("_d.$UN",_y.$1KT);_d.$4f.registerClass("_d.$4f",_y.$1KT);_d.$7n.registerClass("_d.$7n",_a.$F2,_d.$1Hj,IModernGroupsComposeFactory);_d.$6t.registerClass("_d.$6t");_d.$Ha.registerClass("_d.$Ha");_d.$2w.registerClass("_d.$2w",_d.$Nj);_d.$lO.registerClass("_d.$lO");_d.$5j.registerClass("_d.$5j");_d.$5j.$52x.registerClass("_d.$5j.$52x",null,IPeopleSuggestionLoader);_d.$5T.registerClass("_d.$5T",_y.$1KT,_y.$d6);_d.$n9.registerClass("_d.$n9");_d.$9Z.$6Kw=["ReadMessageItem","ItemAttachment"];_d.$D0.$3Qz=null;_d.$Pk.$A=_a.$0.$62;_d.$Dz.$A=_a.$0.$1k;_d.$Fq.$A=_a.$0.$1k;_d.$5e.$29I=[new _d.$UB(_nbs.NonBootStrings.l_FreeBusyFree_Text,null,"Free"),new _d.$UB(_nbs.NonBootStrings.l_FreeBusyWorkingElsewhere_Text,null,"WorkingElsewhere"),new _d.$UB(_nbs.NonBootStrings.l_FreeBusyTentative_Text,null,"Tentative"),new _d.$UB(_nbs.NonBootStrings.l_FreeBusyBusy_Text,null,"Busy"),new _d.$UB(_nbs.NonBootStrings.l_FreeBusyOof_Text,null,"OOF")];_d.$6k.$1RH=-1;_d.$6k.$A=_a.$0.$1k;_d.$5X.$A=_a.$0.$6y;_d.$CK.$A=_a.$0.$6y;_d.$EY.$A=_a.$0.$3ga;_d.$70.$A=_a.$0.$1k;_d.$JK.$6bh=["TotalEvents0","TotalEvents1","TotalEvents2","TotalEvents3","TotalEvents4","TotalEvents5","TotalEvents6"];_d.$JO.$5H1=["Duration","TimeLabel","IsStartingEvent","IsEndingEvent"];_d.$1r.$69p=["CanOpenItem","CanSelectItem","IsOwnerOfItem","CanUpdateItemDetails"];_d.$1r.$3nn=!1;_d.$7K.$5GQ=6e4;_d.$JT.$2AN=!1;_d.$AJ.$A=_a.$0.$Ny;_d.$3e.$A=_a.$0.$1k;_d.$3e.$4Iy=["CalendarHeaderHeight","CalendarHeadersHidden"];_d.$Og.$1b=_a.$0.$2nU;_d.$nc.$A=_a.$0.$Ny;_d.$Ic.$1b=_a.$0.$2nU;_d.$6C.$A=_a.$0.$Ny;_d.$D9.$1MK=new _H("EmailAddress",_g.$1l,_d.$D9);_d.$D9.$3ej=new _H("AttendeeType",_d.$n8,_d.$D9);_d.$D9.$1z1=new _H("IsValid",Boolean,_d.$D9);_d.$4r.$5HH=0;_d.$88.$1qI=new _H("CalendarItem",_g.$33,_d.$88);_d.$88.$4LW=new _H("OriginalCalendarItem",_g.$33,_d.$88);_d.$88.$2mO=new _H("Attendees",_js.$Z,_d.$88);_d.$88.$1xO=new _H("IsDraft",Boolean,_d.$88);_d.$88.$3rp=new _H("ForceDirty",Boolean,_d.$88);_d.$88.$$cctor();_d.$13.$A=_a.$0.$1k;_d.$Hx.$A=_a.$0.$1k;_d.$4B.$4Gb="OOF";_d.$47.$Hk=null;_d.$47.$dd=null;_d.$GN.$rc="ItemID";_d.$F0.$5Oc="DetailedMerged";_d.$Ft.$2nQ=_a.$0.$2G8;_d.$5U.$2nQ=_a.$0.$2G8;_d.$4Y.$1KZ=null;_d.$4Y.$1dW=null;_d.$QO.$1qI=new _H("CalendarItem",_g.$33,_d.$QO);_d.$3a.$7h1=0;_d.$3a.$A=_a.$0.$1k;_d.$Od.$476=1;_d.$5x.$A=_a.$0.$1k;_d.$1t.$A=_a.$0.$I8;_d.$3Z.$3pz=new _H("EventStart",_a.$7,_d.$3Z);_d.$3Z.$3pt=new _H("EventEnd",_a.$7,_d.$3Z);_d.$3Z.$3ol=new _H("DurationSelectedValue",_d.$12n,_d.$3Z);_d.$3Z.$4dS=new _H("ViewStartDate",_a.$7,_d.$3Z);_d.$3Z.$2ta=new _H("EventRequiredAttendees",_js.$Z,_d.$3Z);_d.$3Z.$2tZ=new _H("EventOptionalAttendees",_js.$Z,_d.$3Z);_d.$3Z.$3H3=new _H("OriginalResourceAttendees",_js.$Z,_d.$3Z);_d.$3Z.$3H2=new _H("OriginalRequiredAttendees",_js.$Z,_d.$3Z);_d.$3Z.$3H1=new _H("OriginalOptionalAttendees",_js.$Z,_d.$3Z);_d.$3Z.$4Ta=new _H("SelectedRoomList",_g.$1l,_d.$3Z);_d.$3Z.$4Tb=new _H("SelectedRoom",_g.$1l,_d.$3Z);_d.$3Z.$3zD=new _H("IsAnyAvailableRoomSelected",Boolean,_d.$3Z);_d.$3Z.$$cctor();_d.$4g.$6Fc=0;_d.$4g.$575=3;_d.$5d.$A=_a.$0.$EQ;_d.$6g.$A=_a.$0.$EQ;_d.$ES.$A=_a.$0.$EQ;_d.$Bi.$5y=_a.$0.$8i;_d.$Ey.$1b=_a.$0.$6cj;_d.$U5.$1b=_a.$0.$5kJ;_d.$4Z.$1Yc="CurrentMessage";_d.$4Z.$2QX="ItemsLoaded";_d.$4Z.$2PO="IsLoadingRows";_d.$4Z.$2RM=_u.Strings.l_ListViewModelDefaultLoadingMessage_Text;_d.$4Z.$24b=_u.Strings.l_MailNoResults_Text;_d.$4Z.$6WH="ShowInfoMessage";_d.$4Z.$45d="";_d.$4Z.$cH=_u.Strings.l_FailedRequestError_Text;_d.$5Z.$4IV=-864e5;_d.$7V.$A=_a.$0.$EO;_d.$39.$2QM=new _H("IsVisible",Boolean,_d.$39,!1);_d.$39.$40I=new _H("IsError",Boolean,_d.$39,!1,null,_d.$39.$9Hj);_d.$39.$42s=new _H("IsRetriable",Boolean,_d.$39,!1);_d.$39.$41J=new _H("IsListening",Boolean,_d.$39,!1,null,_d.$39.$9Hq);_d.$39.$43Y=new _H("IsThinking",Boolean,_d.$39,!1,null,_d.$39.$9Hv);_d.$39.$4Xc=new _H("SpeechLevel",Number,_d.$39,0);_d.$39.$4Xy=new _H("StateDescription",String,_d.$39,"");_d.$39.$3cd=new _H("AdditionalInformation",_js.$Z,_d.$39);_d.$39.$4Hi=new _H("NoResultsAvailableText",String,_d.$39,_nbs.NonBootStrings.l_SpeechNoResultsAvailable_Text);_d.$39.$4Xs=new _H("StartListeningCommand",_js.$DC,_d.$39);_d.$39.$4Y6=new _H("StopListeningCommand",_js.$DC,_d.$39);_d.$OR.$45t=!1;_d.$Bh.$2Wg=null;_d.$Bh.$4HY=["junkemail","drafts"];_d.$ix.$3me=18e5;_d.$WL.$3me=18e5;_d.$WL.$35q=1e6;_d.$2c.$1uX={wasSuccessful:!1};_d.$2c.$56Y={wasProxySuccessful:!1,errorMessage:_d.$2c.$11C};_d.$2c.$2FC={wasSuccessful:!1,errorMessage:_d.$2c.$11C};_d.$2c.$56Z={error:1,errorMessage:_d.$2c.$11C};_d.$2c.$11C=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2c.$1mu=new RegExp(" ","g");_d.$Uq.$5Gh={wasSuccessful:!0};_d.$2k.$5MI="ExtensionBecomeActiveTestOnly";_d.$2k.$2Wh="NoActiveOwaExtensions";_d.$2k.$2S2="MarketplaceUrl";_d.$2k.$3Fh="OnGetExtensibilityContextCompleted";_d.$2k.$5Vn="HideExtensionContainer";_d.$2k.$53G="ActiveExtensionsCount";_d.$2k.$11C=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2k.$311=!1;_d.$2k.$1N2=null;_d.$Qi.$Dx={};_d.$I1.$5Vp="HideExtensionContextMenu";_d.$I1.$4Ze="TabSelectedExtension";_d.$G3.$2ys=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_d.$H7.$4UI=new _H("SendText",String,_d.$H7,"");_d.$H7.$4MQ=new _H("ParticipantsViewModel",_y.$2T,_d.$H7);_d.$QU.$3hc=new _H("Chat",_h.$1k,_d.$QU);_d.$TL.$5Hf=new _g.$Rf("Default");_d.$5z.$A=_a.$0.$4j;_d.$ED.$352=[7,0];_d.$9T.$A=_a.$0.$4j;_d.$8l.$4T6=new _H("SearchTerm",String,_d.$8l);_d.$8l.$4Sz=new _H("SearchPositionLatitude",Number,_d.$8l);_d.$8l.$4T0=new _H("SearchPositionLongitude",Number,_d.$8l);_d.$8l.$4TU=new _H("SelectedOptionIndex",Number,_d.$8l);_d.$8l.$4TR=new _H("SelectedLocation",_g.$3Y,_d.$8l);_d.$9c.$3Ju=new _H("Recurrence",_g.$FY,_d.$9c);_d.$9c.$42b=new _H("IsRecurringMaster",Boolean,_d.$9c);_d.$9c.$3Pv=new _H("Start",_a.$7,_d.$9c);_d.$9c.$2tG=new _H("End",_a.$7,_d.$9c);_d.$Al.$3eg=new _H("AttachmentWellViewModel",_y.$16s,_d.$Al);_d.$Al.$1E4=new _H("Menu",_0365m.$2b,_d.$Bp);_d.$DQ.$45j=new _y.$2v(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text,null,null);_d.$R9.$1E4=new _H("Menu",_0365m.$2b,_d.$R9);_d.$DP.$6JG=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_d.$Bq.$TE=[84,85,86,87];_d.$90.$3s6=new _H("FromDetailsViewModel",_d.$8Z,_d.$90);_d.$90.$4U7=new _H("SenderDetailsViewModel",_d.$8Z,_d.$90);_d.$90.$45q=new _H("LocationViewModel",_d.$ED,_d.$90);_d.$90.$41d=new _H("IsMeetingForwardOnBehalfOf",Boolean,_d.$90);_d.$90.$9ZL=new _H("RecurrencePatternDataObject",_d.$DT,_d.$90);_d.$Jt.$26x=7;_d.$Jt.$6Lv=1;_d.$4p.$4RP=new _H("ResizeEditorCommand",_js.$DC,_d.$4p);_d.$7m.$TE=[60,40,43,1001,700,50,800,88,89];_d.$Ek.$1E4=new _H("Menu",_0365m.$2b,_d.$Ek);_d.$8V.$46y=10;_d.$8V.$TE=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_d.$EF.$6Xb=_a.UserAgent.getInstance().$8l?_js.$9.$4R("{0}{0}","<P></P>"):_js.$9.$4R("{0}{0}","<P><BR></P>");_d.$EF.$6MO=new RegExp("[\n\r]+","g");_d.$MB.$1Ju=["mailto:"];_d.$PS.$1Ju=["mailto:"];_d.$O3.$5OQ=new RegExp("([\\w-\\.@]+)\\s\\<\\s*[\\w-\\.]+@[\\w-\\.]+\\s*\\>");_d.$O3.$2t0=new RegExp("([\\w-\\.]+)@[\\w-\\.]+");_d.$R.$4dX=new _H("ViewModelId",String,_d.$R);_d.$R.$2Xm=new _H("Operation",_y.$Iw,_d.$R);_d.$R.$15y=new _H("Mode",_y.$xs,_d.$R);_d.$R.$4La=new _H("OriginalId",_g.$1q,_d.$R);_d.$R.$4LZ=new _H("OriginalDocumentId",Number,_d.$R);_d.$R.$4Lb=new _H("OriginalItem",_g.$y,_d.$R);_d.$R.$3oZ=new _H("DraftId",_g.$1q,_d.$R);_d.$R.$4YC=new _H("StoreId",String,_d.$R);_d.$R.$Z4=new _H("Subject",String,_d.$R,"");_d.$R.$1t2=new _H("EditorContent",String,_d.$R,"");_d.$R.$4PM=new _H("RawEditorContent",String,_d.$R);_d.$R.$4a7=new _H("TextEditorContent",String,_d.$R);_d.$R.$3fe=new _H("BodyType",String,_d.$R);_d.$R.$1IR=new _H("ToRecipients",_js.$M0,_d.$R);_d.$R.$3Po=new _H("SpeechResultRecipients",_js.$M0,_d.$R);_d.$R.$2B9=new _H("ToQueryString",String,_d.$R);_d.$R.$1AL=new _H("CcRecipients",_js.$M0,_d.$R);_d.$R.$1qd=new _H("CcQueryString",String,_d.$R);_d.$R.$19y=new _H("BccRecipients",_js.$M0,_d.$R);_d.$R.$1pk=new _H("BccQueryString",String,_d.$R);_d.$R.$3Nd=new _H("AutoAddSignature",Boolean,_d.$R,!0);_d.$R.$1wH=new _H("Importance",String,_d.$R,"Normal");_d.$R.$4PE=new _H("QuotedBody",String,_d.$R);_d.$R.$4XE=new _H("SmimeContent",String,_d.$R);_d.$R.$4XF=new _H("SmimeException",Error,_d.$R);_d.$R.$4XG=new _H("SmimeRecipientCerts",Array,_d.$R);_d.$R.$4XD=new _H("SmimeCertRawData",String,_d.$R);_d.$R.$3zp=new _H("IsComplete",Boolean,_d.$R);_d.$R.$31k=new _H("IsMeeting",Boolean,_d.$R);_d.$R.$41e=new _H("IsMeetingForward",Boolean,_d.$R);_d.$R.$42k=new _H("IsReplyAllOnBcc",Boolean,_d.$R);_d.$R.$1zv=new _H("Location",_g.$3Y,_d.$R);_d.$R.$3vp=new _H("HasLocation",Boolean,_d.$R);_d.$R.$47A=new _H("MeetingCalendarTimeBlock",_d.$9c,_d.$R);_d.$R.$1aQ=new _H("From",_g.$BY,_d.$R);_d.$R.$3My=new _H("Sender",_g.$BY,_d.$R);_d.$R.$43j=new _H("IsUpgraded",Boolean,_d.$R);_d.$R.$40c=new _H("IsFromShown",Boolean,_d.$R);_d.$R.$3zR=new _H("IsBccShown",Boolean,_d.$R);_d.$R.$25w=new _H("ParentFolderNameToPost",String,_d.$R);_d.$R.$4MH=new _H("ParentFolderIdToPost",_g.$3S,_d.$R);_d.$R.$1Wm=new _H("AttachmentCollection",_js.$Z,_d.$R);_d.$R.$3ea=new _H("AttachmentsToHide",Array,_d.$R);_d.$R.$4ct=new _H("UpgradeFailed",Boolean,_d.$R);_d.$R.$3fR=new _H("Baseline",_d.$1m,_d.$R);_d.$R.$3vZ=new _H("HasBeenSavedByUser",Boolean,_d.$R);_d.$R.$42m=new _H("IsReplyForward",Boolean,_d.$R);_d.$R.$3oa=new _H("Draft",_g.$y,_d.$R);_d.$R.$4S2=new _H("RightsManagementLicenseData",_g.$fQ,_d.$R);_d.$R.$1r0=new _H("ComplianceId",String,_d.$R);_d.$R.$3zj=new _H("IsClassified",Boolean,_d.$R);_d.$R.$3ht=new _H("ClassificationGuid",String,_d.$R);_d.$R.$3hv=new _H("Classification",String,_d.$R);_d.$R.$3hs=new _H("ClassificationDescription",String,_d.$R);_d.$R.$3hu=new _H("ClassificationKeep",Boolean,_d.$R);_d.$R.$1kL=new _H("Sensitivity",String,_d.$R,"Normal");_d.$R.$1c3=new _H("IsDeliveryReceiptRequested",Boolean,_d.$R);_d.$R.$1cp=new _H("IsReadReceiptRequested",Boolean,_d.$R);_d.$R.$29q=new _H("SmimeEncryptMessage",Boolean,_d.$R);_d.$R.$29r=new _H("SmimeSignMessage",Boolean,_d.$R);_d.$R.$1rD=new _H("ConversationId",_g.$1q,_d.$R);_d.$R.$4ME=new _H("ParentConversationNodeId",String,_d.$R);_d.$R.$42A=new _H("IsOriginalIdCalendarItemId",Boolean,_d.$R);_d.$R.$425=new _H("IsOccurrenceReferencingMaster",Boolean,_d.$R);_d.$R.$42L=new _H("IsPoppedOutFromInline",Boolean,_d.$R);_d.$R.$41N=new _H("IsLoadedDraft",Boolean,_d.$R);_d.$R.$4dt=new _H("WasCleanNewMessageBeforePopout",Boolean,_d.$R);_d.$R.$3wX=new _H("HideIncludeEntrypoint",Boolean,_d.$R,!1);_d.$R.$4dw=new _H("WasSavingBeforePopout",Boolean,_d.$R,!1);_d.$R.$41u=new _H("IsMovedToDraftFromOutbox",Boolean,_d.$R,!1);_d.$R.$4Mv=new _H("PerfContext",_a.$A6,_d.$R,null);_d.$R.$4Rz=new _H("RichTextEditorSupported",Boolean,_d.$R,null);_d.$R.$3oF=new _H("DlpSenderOverride",String,_d.$R,null);_d.$R.$3oE=new _H("DlpFalsePositive",String,_d.$R,null);_d.$R.$3qT=new _H("ExplicitLogonUser",String,_d.$R,null);_d.$R.$3xc=new _H("IncludeOriginalFromInToRecipients",Boolean,_d.$R,!1);_d.$R.$1Zv=new _H("ExtendedPropertyCollection",_js.$Z,_d.$R,null);_d.$R.$101=null;_d.$R.$$cctor();_d.$1m.$Z4=new _H("Subject",String,_d.$1m,"");_d.$1m.$1t2=new _H("EditorContent",String,_d.$1m,"");_d.$1m.$1IR=new _H("ToRecipients",_js.$Z,_d.$1m);_d.$1m.$2B9=new _H("ToQueryString",String,_d.$1m);_d.$1m.$1AL=new _H("CcRecipients",_js.$Z,_d.$1m);_d.$1m.$1qd=new _H("CcQueryString",String,_d.$1m);_d.$1m.$19y=new _H("BccRecipients",_js.$Z,_d.$1m);_d.$1m.$1pk=new _H("BccQueryString",String,_d.$1m);_d.$1m.$1wH=new _H("Importance",String,_d.$1m,"Normal");_d.$1m.$1aQ=new _H("From",_g.$1l,_d.$1m);_d.$1m.$1r0=new _H("ComplianceId",String,_d.$1m);_d.$1m.$1kL=new _H("Sensitivity",String,_d.$1m,"Normal");_d.$1m.$1c3=new _H("IsDeliveryReceiptRequested",Boolean,_d.$1m);_d.$1m.$1cp=new _H("IsReadReceiptRequested",Boolean,_d.$1m);_d.$1m.$29q=new _H("SmimeEncryptMessage",Boolean,_d.$1m);_d.$1m.$29r=new _H("SmimeSignMessage",Boolean,_d.$1m);_d.$1m.$1Wm=new _H("AttachmentCollection",_js.$Z,_d.$1m);_d.$1m.$1Zv=new _H("ExtendedPropertyCollection",_js.$Z,_d.$1m,null);_d.$1m.$2sy=new _a.$EC(_g.$1l);_d.$1m.$$cctor();_d.$AU.$A=_a.$0.$j;_d.$pp.$XO.$4IX=new _d.$YK(_u.Strings.l_MailSearchRefinerDateOlderThan1Week_Text,0);_d.$pp.$XO.$4IW=new _d.$YK(_u.Strings.l_MailSearchRefinerDateOlderThan1Month_Text,0);_d.$pp.$XO.$4IY=new _d.$YK(_u.Strings.l_MailSearchRefinerDateOlderThan1Year_Text,0);_d.$CR.$A=_a.$0.$1N;_d.$M6.$A=_a.$0.$62;_d.$5E.$Lg=_a.$0.$8i;_d.$5E.$2pK=null;_d.$5E.$$cctor();_d.$RJ.$A=_a.$0.$3D2;_d.$Nr.$A=_a.$0.$KR;_d.$K0.$A=_a.$0.$KR;_d.$L1.$A=_a.$0.$KR;_d.$MJ.$A=_a.$0.$KR;_d.$En.$A=_a.$0.$KR;_d.$L2.$44x=new _H("LastSelectedItem",_d.$K1,_d.$L2,null,null,null);_d.$9X.$A=_a.$0.$KR;_d.$Yn.$6fQ="\\((?:UTC|GMT)[\\s\\d\\+\\-:]*\\)";_d.$CW.$5y=_a.$0.$1lR;_d.$Ig.$A=_a.$0.$9k;_d.$A9.$A=_a.$0.$9k;_d.$4s.$A=_a.$0.$8i;_d.$bC.$1s5=_nbs.NonBootStrings.l_DisplayPreferences_LowerCase_Text;_d.$L9.$6Hz=[8,0,2,1];_d.$L9.$6I0=[9,0,2,1];_d.$8i.$A=_a.$0.$9t;_d.$8i.$1s5=_nbs.NonBootStrings.l_PeopleFilterListDefaultTitle_Text;_d.$Jf.$A=_a.$0.$XW;_d.$3u.$2oJ="ChatSignInState";_d.$3u.$40x="IsIMPresenceStateAvailable";_d.$3u.$6Jn="PresenceImageType";_d.$3u.$5Zw="IsBusy";_d.$3u.$58L="BusyMessage";_d.$3u.$3pl="ErrorMessage";_d.$3u.$A=_a.$0.$20b;_d.$3u.$5KN="PersonalSettings/EditAccount.aspx?chgPhoto=1";_d.$3u.$5KP="_blank";_d.$3u.$5KO="width=600,height=400,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no";_d.$3u.$67p=7;_d.$HZ.$A=_a.$0.$2YR;_d.$4z.$A=_a.$0.$9k;_d.$2h.$A=_a.$0.$9k;_d.$5W.$40L=new _H("IsExpandable",Boolean,_d.$5W);_d.$5W.$1GP=new _H("Persona",_pc.$i,_d.$5W);_d.$5W.$15y=new _H("Mode",_d.$1Aa,_d.$5W);_d.$5W.$455=new _H("LayoutType",_y.$rV,_d.$5W);_d.$5W.$3jD=new _H("ControlSize",_y.$1Ag,_d.$5W);_d.$5W.$4Nh=new _H("PivotSelectedOptionIndex",Number,_d.$5W);_d.$5W.$3zg=new _H("IsCardInPopoutState",Boolean,_d.$5W);_d.$5W.$3kl=new _H("CreatePersonaCardUnderMyContactsFolder",Boolean,_d.$5W);_d.$5W.$4MG=new _H("ParentFolderId",_g.$3S,_d.$5W);_d.$EK.$A=_a.$0.$9t;_d.$V2.$1s5=_nbs.NonBootStrings.l_SortOptionsListDefaultTitle_Text;_d.$32.$A=_a.$0.$dW;_d.$32.$2t0=new RegExp("[\\w-\\.!#%&'=~`/\\$\\|\\?\\*\\+\\{\\}]+@[\\w-\\.]+");_d.$32.$5LP=new RegExp("([.*+?${}/])","g");_d.$2C.$A=_a.$0.$XW;_d.$KA.$A=_a.$0.$XW;_d.$C0.$A=_a.$0.$18H;_d.$OO.$A=_a.$0.$18H;_d.$Hn.$A=_a.$0.$18H;_d.$SC.$A=_a.$0.$18H;_d.$VA.$A=_a.$0.$4Zu;_d.$OP.$3Rr=175;_d.$OP.$3Rq=47;_d.$98.$4Zp=new _H("Task",_g.$9t,_d.$98);_d.$98.$3os=new _H("EditedTask",_g.$9t,_d.$98);_d.$98.$41y=new _H("IsNewTask",Boolean,_d.$98);_d.$98.$40E=new _H("IsEditMode",Boolean,_d.$98);_d.$98.$1xO=new _H("IsDraft",Boolean,_d.$98);_d.$56.$A=_a.$0.$18H;_d.$4U.$A=_a.$0.$26N;_d.$4U.$3h5=new _H("CanDial",Boolean,_d.$4U,!0);_d.$4U.$4Nr=new _H("PlayOnPhoneActive",Boolean,_d.$4U,!1);_d.$4U.$3nd=new _H("DialString",String,_d.$4U,"");_d.$4U.$47W=new _H("MessageText",String,_d.$4U,"");_d.$4U.$4Ns=new _H("PlayOnPhoneCommand",_js.$DC,_d.$4U);_d.$4U.$4Nt=new _H("PlayOnPhoneDisconnectCommand",_js.$DC,_d.$4U);_d.$4U.$4Nq=new _H("PlayOnPhoneActiveCommand",_js.$DC,_d.$4U);_d.$4U.$42I=new _H("IsPhoneCallActive",Boolean,_d.$4U,!1);_d.$CI.$14Y=new _H("Item",_g.$gr,_d.$CI);_d.$CI.$4XV=new _H("Source",_d.$n9,_d.$CI,null);_d.$CI.$4Nv=new _H("PlayOnPhoneViewModel",_d.$4U,_d.$CI);_d.$1Jb.$1k.$Hj.$2ay=_a.$0.$EQ;_d.$1Jb.$1k.$I8.$360=_a.$0.$I8;_d.$KV.$5Hj=2;_d.$D8.$5G2="CurrentItem";_d.$D8.$5fW="ItemNotSupported";_d.$D8.$662="MoveButtonText";_d.$D8.$7gg="DebugInfo";_d.$D8.$88y="IsCurrentModuleTasksModule";_d.$FJ.$3QV=null;_d.$FJ.$$cctor();_d.$TR.$570=String.format("service.svc/s/GetFileAttachment?id={0}","");_d.$3U.$TE=[91];_d.$46.$TE=[300,100,200,4100,4300,3900,4e3];_d.$Cn.$A=_a.$0.$9k;_d.$5D.$5kN="Members";_d.$5D.$6GR="Owners";_d.$5D.$40m="IsGroupOwnersPivotSelected";_d.$5D.$40k="IsGroupMembersPivotSelected";_d.$5D.$40l="IsGroupNotesPivotSelected";_d.$BQ.$5cC="IsLocationInformationPivotSelected";_d.$BQ.$6Kt="ProfileFieldsForLocations";_d.$7l.$45J="LinkingActionInProgress";_d.$7l.$6Z7="ErrorCode";_d.$R6.$A=_a.$0.$1Df;_d.$5J.$5VX="HeaderTextViewModel";_d.$5J.$5VT="HeaderImageViewModel";_d.$5J.$6Xm="SingleComponent";_d.$5J.$6Xn="SingleComponentText";_d.$5J.$A=_a.$0.$1Df;_d.$Nj.$4c3=-1;_d.$4f.$6Wc="ShowOrganizationPanel";_d.$4f.$5Vu="HideManagerList";_d.$4f.$5Iy="DirectReports";_d.$4f.$6HK="Peers";_d.$4f.$5j2="Manager";_d.$4f.$5j0="ManagementChain";_d.$4f.$5bT="IsHierarchyAvailable";_d.$4f.$3Gw="OrganizationHierarchyLoadCompleted";_d.$4f.$5Vm="HideDirectReportsList";_d.$4f.$5Vr="HideManagementChainList";_d.$4f.$5W1="HidePeersList";_d.$4f.$5cn="IsOrganizationHierachyLoading";_d.$7n.$A=_a.$0.$9k;_d.$2w.$5Vt="HideManageProfiles";_d.$2w.$3wY="HideModernGroupMembershipPivotContent";_d.$2w.$5bf="IsInformationPivotSelected";_d.$2w.$5cR="IsModernGroupMembershipPivotSelected";_d.$2w.$5cg="IsNotesPivotSelected";_d.$2w.$43f="IsTwoColumnWidth";_d.$2w.$65f="ModernGroupMembershipPivotViewModel";_d.$2w.$4LU="OrganizationHierarchyViewModel";_d.$2w.$A=_a.$0.$9k;_d.$2w.$4c4=-1;_d.$9L.$6Hw="Persona";_d.$9L.$A=_a.$0.$9k;_d.$7c.$A=_a.$0.$9k;_d.$7c.$5ZY=!1;_d.$7c.$2zm=!1;_d.$86.$A=_a.$0.$dO;_d.$5T.$hF=_a.$0.$1VC