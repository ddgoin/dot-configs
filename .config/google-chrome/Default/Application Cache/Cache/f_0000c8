Type.registerNamespace("_c");_c.$xX=function(){};_c.$xX.registerInterface("_c.$xX");_c.$1HB=function(){};_c.$1HB.registerInterface("_c.$1HB");_c.$19V=function(){};_c.$19V.prototype={};_c.$19V.registerEnum("_c.$19V",!1);_c.$1HD=function(){};_c.$1HD.registerInterface("_c.$1HD");_c.$11J=function(n,t){_c.$11J.initializeBase(this);this.$7i=n;this.$1Gc=t};_c.$11J.prototype={$7i:null,$1Gc:null,$5ZC:function(n){n.$54Q(this.$7i,this.$1Gc,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}catch(r){i(r)}}};_c.$16C=function(){_c.$16C.initializeBase(this)};_c.$16C.prototype={$6as:null,$5ZC:function(n){var t=new _g.$16D(this.$2D);n.$5Sv(t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{_a.$4.$l(n,"themeSelectionInfo");this.$6as=n;t()}catch(r){i(r)}}};_c.$1Ch=function(n){_c.$1Ch.initializeBase(this);this.$3EE=n};_c.$1Ch.prototype={$3EE:null,$5ZC:function(n){var t=new _g.$1Ci(this.$2D);n.$6UR(this.$3EE,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}catch(r){i(r)}}};_c.$1Bk=function(n){_c.$1Bk.initializeBase(this);_a.$4.$1G(n,"input");this.$5Y0=n};_c.$1Bk.prototype={$5Y0:null,$5ZC:function(n){var t=new _g.$1Bl(this.$2D);n.$4SS(this.$5Y0,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.$0.$5d,"SanitizeHtml Web Service request successful.");t()}};_c.$1CU=function(n){_c.$1CU.initializeBase(this);this.$3EB=n};_c.$1CU.prototype={$3EB:null,$5ZC:function(n){var t=new _g.$1CV(this.$2D);n.$1kS(this.$3EB,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}catch(r){i(r)}}};_c.$13G=function(n,t){_c.$13G.initializeBase(this);_a.$4.$1G(n,"sipUri");this.$bP=n;this.$Z3=t};_c.$13G.prototype={$bP:null,$Z3:null,$Df:null,$5ZC:function(n){n.$5F0(this.$bP,this.$Z3,new _g.$13H(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if($6(n)){i(Error.argumentNull("onlineMeetingType"));return}this.$Df=n;t()}};_c.$P7=function(n,t,i,r,u){_c.$P7.initializeBase(this);_c.$P7.$6fW(n,t,i,r);this.$5N=n;this.$Ao=i;this.$2EQ=t;this.$tW=r;this.$Cm=u};_c.$P7.$6fW=function(n,t,i,r){if(!n&&(!i||_js.$9.$a(i.EmailAddress))&&_js.$9.$a(t))throw Error.argumentUndefined("itemId, emailAddress or adObjectId","At least one of the three - itemId, emailAddress or adObjectId have to be specified");_a.$4.$l(r,"range")};function $4iJ(n,t){if(!t||!t.length)return[];for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=_pc.$i.$1LP(t[i],2);return r}_c.$P7.prototype={$Ao:null,$5N:null,$2EQ:null,$tW:null,$1Rk:null,$A9:null,$WO:null,$Qt:null,$8JC:0,$Cm:0,$CR:null,$5ZC:function(n){var t=new _g.$C8("Beginning");t.MaxEntriesReturned=this.$tW.$Dl;t.Offset=this.$tW.$FQ;n.$3tK(this.$5N?new _g.$1q(this.$5N.Id):null,this.$2EQ,this.$Ao,t,this.$Cm,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{this.$8JC=n.MembersCount;this.$A9=$4iJ(this,n.Members);this.$1Rk=$4iJ(this,n.Owners);this.$WO=n.Notes;this.$Qt=n.Description;this.$CR=n.PersonaId}catch(r){i(r);return}t()}};_c.$19O=function(n,t,i,r,u){_c.$19O.initializeBase(this,[n,t,i,r,u])};_c.$19O.prototype={$6Kg:function(n,t,i){t()}};_c.$15Z=function(n){_c.$15Z.initializeBase(this,[n])};_c.$15Z.prototype={$1af:function(n){var t=n.EmailAddress;return $6(t)?"":t.EmailAddress}};_c.$LC=function(){_c.$LC.initializeBase(this,[_c.$LC.$2or])};_c.$LC.$2or=function(n,t){_a.$4.$l(n,"object1");_a.$4.$l(t,"object2");var i=n;var r=t;return i.get_$1H5().$2R(r.get_$1H5())};_c.$LC.prototype={$6I:function(n){this.$1r();for(var t=0;t<n.length;t++){var i=new _c.$5q;i.$QR(n[t]);this.$D(i)}}};_c.$18c=function(n){_c.$18c.initializeBase(this,[n])};_c.$18c.prototype={get_$7N2:function(){return"KeepAliveActivityMonitor"},get_$5Oh:function(){return 24e4},get_$7N4:function(){return 3e5},$3Ez:function(n){var t=new Sys.Net.WebRequest;t.set_url(_js.$9.$a(OwaApplication.$1SA)?"ping.owa":OwaApplication.$1SA);t.set_timeout(6e4);t.invoke()}};function CoreModelsComponent(){}CoreModelsComponent.prototype={$1YD:function(n,t,i){var r=this;n.$Ad(_c.$E2).$A5F().$A5G(function(){return new _c.$E2});var u=this;n.$Ad(_a.$IV).$A5F().$A5G(function(){var t=n.$6OW(_c.$2M);var i=n.$6OW(_a.$63);return t.get_$2n()?new _c.$1B2(i,t):new _c.$18c(i)});var f=this;n.$Ad(_c.$2M).$A5E(IChatManager).$A5F().$A5G(function(){var t=i.get_$9p()==="Mouse"&&!_a.$Cp.$x7();return new _c.$2M(t,n.$6OW(_c.$E2),n.$6OW(_a.$43),null,n.$6OW(_0365f.$L),n.$6OW(_g.$V),i.get_$9A())});var e=this;n.$Ad(_c.$UF).$A5G(function(){return new _c.$UF(n.$6OW(_0365f.$L),n.$6OW(_a.NativeBridge))});var o=this;n.$Ad(IChatActionFactory).$A5F().$A5G(function(){var r=n.$6OW(_c.$2M);var t;t=i.get_$1DC()?new _c.$10C(n.$6OW(_c.$2M),n.$6OW(_c.$xX)):new _c.$10C(n.$6OW(_c.$2M),null);return new _c.$12X(t,new _c.$14O(r))});var s=this;n.$Ad(IFindPeopleActionFactory).$A5F().$A5G(function(){return new _pc.$14f});var h=this;n.$Ad(IPopOutMailboxDataContextFactory).$A5F().$A5G(function(){return new _c.$1Ar})},$7sM:function(){return[new _a.$65(_c.$UF,2,-1),new _a.$65(_a.$IV,2,17)]}};_c.DataContracts=function(){};_c.DataContracts.$$cctor=function(){_a.$1G.$Ad(_g.$Sv,_pc.$iK);_a.$1G.$Ad(_g.$Y1,_g.$ql)};_c.$wC=function(n,t){_c.$wC.initializeBase(this,[n,t])};_c.$wC.prototype={get_$1b:function(){return _a.$0.$2ws},get_$47G:function(){return this.$4J},$7cp:function(n){var t=n;this.set_$Y3(t.$1df);return new _c.$19O(this.get_$47G().$5N,this.get_$47G().$2EQ,this.get_$47G().$Ao,t,2)},$3l3:function(n){return _pc.$i.$1LP(n,2)},$3T0:function(n,t){n.$9zY(t,2)},$7yv:function(n){return null},$9yv:function(n){return!1},$6B4:function(n){var t=n;var i=new _c.$15Z(t.get_$gq().Members);this.set_$F7(t.$tW.$FQ);this.set_$P8(t.get_$gq().MembersCount);return i}};_c.$cn=function(n,t,i,r,u){_c.$cn.initializeBase(this,[new _g.$3S(n)]);_c.$P7.$6fW(t,i,r,u);this.$5N=t;this.$2EQ=i;this.$Ao=r;this.$tW=u};_c.$cn.$E=function(n,t){var r=null;var i=null;var u=null;var f=n.get_$qc();n.get_$6G()&&!_js.$9.$a(n.get_$6G().Id)&&(r=n.get_$6G().Id);if(!$6(n.get_$1l())&&!_js.$9.$a(n.get_$1l().EmailAddress)){u=new _g.$1l;u.EmailAddress=n.get_$1l().EmailAddress;u.RoutingType=n.get_$1l().RoutingType}if(_js.$9.$a(f)){$6(n.get_$1l())||$6(n.get_$1l().ItemId)||_js.$9.$a(n.get_$1l().ItemId.Id)||(i=n.get_$1l().ItemId);i||(i=n.get_$6G())}r||!i||_js.$9.$a(i.Id)||(r=i.Id);!r&&u&&(r=u.EmailAddress);return new _c.$cn(r,i,f,u,new _h.$8R(0,t))};_c.$cn.prototype={$5N:null,$2EQ:null,$Ao:null,$tW:null};_c.$111=function(n){_c.$111.initializeBase(this);this.$7E=n};_c.$111.prototype={$7E:null,$5ZC:function(n){this.$7E.set_$11e(1);n.$52r(this.$7E.get_$RC(),null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n===-9){_js.Trace.logInfo(_a.$0.$4W,"AcceptChatAction.ProcessResult: Suppressing 'ConversationEnded' error.");n=0}if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.$7E.set_$11e(3);_js.Trace.logInfo(_a.$0.$4W,"AcceptChatSession web service call succeeded for chat {0}.",this.$7E.get_$RC());t()},$TA:function(){_a.$2p.prototype.$TA.call(this)}};_c.$12X=function(n,t){this.$4Xo=n;this.$5Ku=t};_c.$12X.prototype={$5Ku:null,$4Xo:null,$1rR:function(n,t){return this.$4Xo.$1rR(n,t)},$3kM:function(n,t){return this.$4Xo.$3kM(n,t)},$7eo:function(n,t){return new _c.$1CA(n,t)},$5ES:function(n){return this.$5Ku.$5ES(n)}};_c.$14N=function(n,t){_c.$14N.initializeBase(this);this.$7E=n;this.$9c=t};_c.$14N.prototype={$7E:null,$9c:null,$Yb:function(){_a.$2p.prototype.$Yb.call(this);this.$9c.$9ab(this.$7E)},$5ZC:function(n){if(this.$7E.get_$RC()===-1){this.$7E.set_$11e(4);return}n.$6aj(this.$7E.get_$RC(),null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){this.$7E.set_$11e(4);if(!n){i(Error.create("EndChatAction returned false."));return}t()}};_c.$14O=function(n){this.$9c=n};_c.$14O.prototype={$9c:null,$5ES:function(n){return new _c.$14N(n,this.$9c)}};_c.$165=function(n){_c.$165.initializeBase(this);_a.$4.$1Ul(n,"sipUris");this.$1U8=n};_c.$165.prototype={$1U8:null,$5ZC:function(n){n.$5Ry(this.$1U8,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("GetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_c.$17f=function(n){_c.$17f.initializeBase(this);this.$31i=n};_c.$17f.prototype={$31i:!1,$1ke:!1,$5ZC:function(n){n.$5YP(this.$31i,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){if(n!==-2){_js.Trace.logInfo(_a.$0.$4W,"Sign in failed with code {0}, will retry.",n);this.$1ke=!0}i(Error.create("InstantMessageOperationError: "+n));return}t()}};_c.$17g=function(n){_c.$17g.initializeBase(this);this.$31i=n};_c.$17g.prototype={$31i:!1,$5ZC:function(n){n.$5YQ(this.$31i,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}t()}};_c.$1Bc=function(){_c.$1Bc.initializeBase(this)};_c.$1Bc.prototype={$5ZC:function(n){n.$2aL(null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("ResetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_c.$1CA=function(n,t){_c.$1CA.initializeBase(this);this.$7E=n;this.$2E=t};_c.$1CA.prototype={$2E:null,$7E:null,$Yb:function(){_a.$2p.prototype.$Yb.call(this)},$5ZC:function(n){this.$7E.get_$11e()||this.$7E.set_$11e(1);var t=new _g.$a5(this.$2E);t.ChatSessionId=this.$7E.get_$RC();t.Recipients=this.$7E.$7wA();t.Subject=this.$7E.get_$2i();n.$4U5(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.$7E.set_$RC(n);this.$7E.set_$11e(3);t()},$TA:function(){$6(this.$1f.message)&&this.$7E.$u3(_nbs.NonBootStrings.l_IMDeliveryError_Text);_a.$2p.prototype.$TA.call(this)}};_c.$1Cf=function(n,t){_c.$1Cf.initializeBase(this);_a.$4.$1G(n,"sipUri");this.$bP=n;this.$3EA=t};_c.$1Cf.prototype={$bP:null,$3EA:"None",$5ZC:function(n){var t=new _g.$d3;t.Presence=this.$3EA;n.$6U8(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){var r=n;if(r){i(Error.create("SetPresenceAction failed with InstantMessageOperationError: "+r));return}t()}};_c.$lv=function(n,t,i,r,u){_c.$lv.initializeBase(this);_a.$4.$J(i,"participants");_a.$4.$ou(i.get_$B(),0,"participants.Count");if(!$6(u)){if(i.get_$B()!==1)throw Error.invalidOperation("imAddress can only be used in conjunction with a single participant.");if(!$6(r))throw Error.invalidOperation("imAddress and itemOrConversation are mutually exclusive.");}this.$9c=n;this.$1GH=$6mX(this,i);_a.$4.$ou(this.$1GH.get_$B(),0,"No valid participants.");this.$2A1=t;this.$44B=r;this.$1bP=u};function $6mX(n,t){for(var u=new _js.$Z,f={},o=t.get_$B(),r=0;r<o;r++){var i=t.get_$3q(r);if(i&&n.$9c.$1XR(i.get_$A6())){var e=i.get_$A6();if(!(e in f)){u.$D(i);f[e]=i}}}return u}_c.$lv.prototype={$9c:null,$2A1:null,$1GH:null,$44B:null,$1bP:null,$Yb:function(){_a.$2p.prototype.$Yb.call(this);if(!$6(this.$2A1)){this.$2A1.$6Yj(this.$1GH,this.$44B,this.$1bP);return}this.$9c.$6Yj(this.$1GH,this.$44B,this.$1bP)},$6AP:function(){return 0}};_c.$10C=function(n,t){this.$9c=n;this.$2A1=t};_c.$10C.prototype={$9c:null,$2A1:null,$1rR:function(n,t){return new _c.$lv(this.$9c,this.$2A1,n,t,null)},$3kM:function(n,t){var i=new _js.$Z;i.$D(n);return new _c.$lv(this.$9c,this.$2A1,i,null,t)}};_c.$1DH=function(n){_c.$1DH.initializeBase(this);_a.$4.$1Ul(n,"sipUris");this.$1U8=n};_c.$1DH.prototype={$1U8:null,$5ZC:function(n){n.$6ZY(this.$1U8,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("SubscribeForPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_c.$1Em=function(n){_c.$1Em.initializeBase(this);_a.$4.$1G(n,"sipUri");this.$bP=n};_c.$1Em.prototype={$bP:null,$5ZC:function(n){n.$6dN(this.$bP,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(n<0){i(Error.create("UnsubscribeFromPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_c.$i9=function(n,t,i){_c.$i9.initializeBase(this,[n,0]);this.$Ee=t;this.$Eo="CancelCalendarItemAction";this.$cJ=i};_c.$i9.prototype={$cJ:null,$596:null,$8J1:null,$G3:function(){var n=_h.$4Q.prototype.$G3.call(this);n.explicitLogonUser=this.$cJ;return n},$5Et:function(){var n=new _g.$So;n.ReferenceItemId=_g.$1q.$uS(this.$t9);if(!$6(this.$G6)){$4iG(this,n);$6(this.$G6.get_$3C())||(n.NewBodyContent=new _g.$6R(this.$G6.get_$3C().get_$3n()==="HTML"?"HTML":"Text",this.$G6.get_$3C().get_$1g()))}return[n]},$4Os:function(n){var i=n.Items;if($6(i)||!i.length)throw Error.invalidOperation("Response Item is expected to be non-null when message is saved to drafts.");for(var u=i,e=u.length,r=0;r<e;++r){var f=u[r];if(!$6(f)){var t=_a.$1G.$A4y(_g.$y,f);_g.$IB.isInstanceOfType(t)?this.$8J1=t.get_$i():_g.$33.isInstanceOfType(t)&&(this.$596=t.get_$i())}}}};_c.$11H=function(n){_c.$11H.initializeBase(this);this.$36F=n};_c.$11H.prototype={$36F:null,$66k:null,$5ZC:function(n){var t=new _g.$ZL;t.MessageId=this.$36F;var i=new _g.$11I(this.$2D);n.$3cq(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$66k=n.NewCalendarEntryId}};_c.$hZ=function(n,t){_c.$hZ.initializeBase(this);this.$d=new _g.$118(this.$2D);this.$d.explicitLogonUser=t;this.$DH=n};function $6lh(n){n.$DH.ItemId=_g.$1q.$uS(n.$DH.ItemId,!1)}_c.$hZ.prototype={$DH:null,$d:null,$5ZC:function(n){$6lh(this);n.$3cV(this.$DH,this.$d,this.$$d_$9Hd,this.$$d_$9Hc)}};_c.$1DJ=function(n,t){_c.$1DJ.initializeBase(this);_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"iCalUrl");this.$16Y=n;this.$5WV=t;this.$YV=new _g.$Ej;this.$YV.set_$o1(n.get_$8k())};_c.$1DJ.prototype={$16Y:null,$5WV:null,$YV:null,$5ZC:function(n){var t=new _g.$g8;t.ICalUrl=this.$5WV;t.ParentGroupGuid=this.$16Y.get_$8k();n.$6Za(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$YV.set_$i(n.NewCalendarEntryId);this.$YV.set_$vD(n.NewFolderId)}};_c.$1DI=function(n,t,i){_c.$1DI.initializeBase(this);_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"publisherSmtpAddress");this.$16Y=n;this.$6LG=t;this.$YV=new _g.$9G;this.$YV.set_$o1(n.get_$8k());this.$YV.set_$Xs(i)};_c.$1DI.prototype={$16Y:null,$6LG:null,$YV:null,$5ZC:function(n){var t=new _g.$g7;t.EmailAddress=this.$6LG;t.ParentGroupGuid=this.$16Y.get_$8k();n.$6ZZ(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$YV.set_$i(n.NewCalendarEntryId)}};_c.$13k=function(n,t,i,r){_c.$13k.initializeBase(this,[[_h.$7U.$3tT(n)],t,1]);this.$42c=n.get_$Pk();this.$cJ=r;this.$Qc=i;this.$KG=n;this.$3oP=!0};_c.$13k.prototype={$42c:!1,$cJ:null,$Qc:null,$KG:null,$G3:function(){var n=_h.$Kf.prototype.$G3.call(this);n.isReferencedItemRecurringMaster=this.$42c;n.explicitLogonUser=this.$cJ;n.actionName="DeleteCalendarItemAction";return n},$Yb:function(){_h.$Kf.prototype.$Yb.call(this);var n=this.$Qc;var t;if(n)if(this.$42c)n.$27H(this.$KG.get_$Ea());else{var i,r;(r=n.$2uA(this.$BN[0].Id,i={val:t}),t=i.val,r)&&n.$1t.$68(t)}},$TA:function(){_h.$Kf.prototype.$TA.call(this);var n=this.$Qc;n&&(_cc.$S1.isInstanceOfType(n)?n.$3KF():n.$cl())}};_c.$iV=function(n,t){_c.$iV.initializeBase(this,[t]);this.$t9=n;this.$Ee=1;this.$1OX=!1};function $4iG(n,t){t.Importance=n.$G6.get_$6U();!$6(n.$G6.get_$4B())&&n.$G6.get_$4B().get_$B()>0&&(t.ToRecipients=_h.$4Q.$XI(n.$G6.get_$4B()));!$6(n.$G6.get_$4T())&&n.$G6.get_$4T().get_$B()>0&&(t.CcRecipients=_h.$4Q.$XI(n.$G6.get_$4T()));!$6(n.$G6.get_$60())&&n.$G6.get_$60().get_$B()>0&&(t.BccRecipients=_h.$4Q.$XI(n.$G6.get_$60()));t.Sensitivity=n.$G6.get_$84();t.IsDeliveryReceiptRequested=n.$G6.get_$Fj();t.IsReadReceiptRequested=n.$G6.get_$F6()}_c.$iV.prototype={$t9:null,$G6:null};_c.$Qc=function(n,t,i,r){_c.$Qc.initializeBase(this,[_h.$7U.$3tT(n),4]);this.$Eo="CreateMeetingResponseAction";this.$Ur=n;this.$17K=t;this.$Ee=i;this.$1cq=_g.$CC.isInstanceOfType(n);this.$2Zo=n.get_$Lf();this.$1OX=!0;this.$16w=r;if(this.$1cq){var u=this.$Ur;this.$35z=u.get_$3S()?u.get_$3S().Id:null;this.$Qc=_cc.$6d.$7yQ()}else this.$Qc=_cc.$6d.$2wW(n)};function $4iH(n,t,i){i=i||_a.$7.get_$29();t.set_$9S(n.$17K==="Accept"?"Busy":"Tentative");t.set_$2li(i);t.set_$TM(n.$17K)}function $6m5(n){var t;if(n.$1cq){var i=n.$Ur;t=i.get_$19m();if(!t||!t.Id)return null}else t=n.$Ur.get_$i();return t}_c.$Qc.prototype={$17K:"Unknown",$1cq:!1,$2Zo:"Single",$35z:null,$Qc:null,$3Gy:null,$3Nt:!1,$596:null,$8J4:null,$Ur:null,meetingResponseMessageId:null,$16w:null,get_meetingResponseMessageId:function(){return this.meetingResponseMessageId},$G3:function(){var n=_h.$4Q.prototype.$G3.call(this);n.isReferencedItemMeetingRequest=this.$1cq;n.referencedCalendarItemType=this.$2Zo;n.draftsFolderId=_g.$h.$1i.nameToId("drafts");n.outboxFolderId=_g.$h.$1i.nameToId("outbox");n.deletedItemsFolderId=_g.$h.$1i.nameToId("deleteditems");n.calendarFolderId=_g.$h.$1i.nameToId("calendar");n.userDisplayName=_g.$V.get_$I().get_$31().get_$FS();n.userEmailAddress=_g.$V.get_$I().get_$31().get_$Aj();return n},$5Et:function(){var i;switch(this.$17K){case"Tentative":i=2;break;case"Accept":i=1;break;case"Decline":i=4;break;default:i=0;break}var t=_c.$7B.$E(i);$6(this.$t9)||(t.ReferenceItemId=_g.$1q.$uS(this.$t9));if(!$6(this.$16w)){t.ProposedStart=_a.$7.$Vl(this.$16w.get_$y());t.ProposedEnd=_a.$7.$Vl(this.$16w.get_$1u())}var n=new _g.$Xc;if(this.$Ur.get_$FE()){n.Organizer=new _g.$BY;n.Organizer.Mailbox=this.$Ur.get_$FE().Mailbox}$6(this.$Ur.get_$y())||(n.Start=_a.$7.$Vl(this.$Ur.get_$y()));$6(this.$Ur.get_$1u())||(n.End=_a.$7.$Vl(this.$Ur.get_$1u()));n.Subject=this.$Ur.get_$2i();n.IsResponseRequested=this.$Ur.get_$Du();var u=this.$Ur.get_$3S();u&&(n.ConversationId=this.$Ur.get_$3S());$6(this.$Ur.get_$LT())||(n.Recurrence=_0365f.$2t.$3p(this.$Ur.get_$LT().get_$2Zk()));var r=_g.$3Y.$3fq(this.$Ur.get_$4j());if(!r&&this.$Ur.get_$4j()){r=new _g.$NC;r.DisplayName=this.$Ur.get_$4j().get_$1o()}n.Location=r;t.AdditionalInfo=n;if(!$6(this.$G6)){$4iG(this,t);$6(this.$G6.get_$3C())||(t.Body=new _g.$6R(this.$G6.get_$3C().get_$3n()==="HTML"?"HTML":"Text",this.$G6.get_$3C().get_$1g()))}return[t]},$2He:function(){var n=_h.$4Q.prototype.$2He.call(this);n.Body.GenerateResponseMessageOnFailure=!1;n.Body.GenerateMeetingResponseWithOldLocationIfChanged=!0;n.Body.FailResponseOnImportantUpdate=!0;return n},$Yb:function(){_a.$2p.prototype.$Yb.call(this);this.$1cq&&_h.$12.$3Pt(this.$t9,this.$35z);var t=$6m5(this);if(!t){_js.Trace.logInfo(_a.$0.$1k,"Unable to provide instant surface update on submission of meeting response because AssociatedCalendarItem was not present.");return}if(!this.$Qc||!this.$Qc.$8p){_js.Trace.logInfo(_a.$0.$1k,"Unable to provide instant surface update because query table or range in cache was not present.");return}var n=!1;if(this.$2Zo==="RecurringMaster"){var i=this.$Ur.get_$Ea();if(!i){_js.Trace.logInfo(_a.$0.$1k,"Unable to provide instant surface update on submission of meeting response because InstanceKey was not present.");return}if(this.$17K==="Decline")n=this.$Qc.$27H(i);else if(this.$17K==="Accept"||this.$17K==="Tentative")for(var f=_a.$7.get_$29(),r=0;r<this.$Qc.$1t.get_$B();r++){var u=this.$Qc.$1t.get_$3q(r);if(u.get_$Ea()===i&&u.get_$1y5()){$4iH(this,u,f);n=!0}}}else{this.$3Gy=this.$Qc.$5Mx(t);if(!this.$3Gy){_js.Trace.logInfo(_a.$0.$1k,"CalendarItemModel for meeting response not found - ItemId: {0}",t.Id);return}if(this.$17K==="Accept"||this.$17K==="Tentative"){$4iH(this,this.$3Gy);n=!0}else this.$17K==="Decline"&&(n=this.$Qc.$1t.$34(this.$3Gy))}this.$3Nt=n},$TA:function(){_a.$2p.prototype.$TA.call(this);if(this.$1cq){_h.$12.$1Zk(this.$t9,this.$35z);return}var n=this.$3Nt;this.$3Nt=!1;n&&this.$Qc.$AF()},$4Os:function(n){var i=n.Items;if($6(i)||!i.length)throw Error.invalidOperation("Response Item is expected to be non-null when message is saved to drafts.");for(var u=i,e=u.length,r=0;r<e;++r){var f=u[r];if(!$6(f)){var t=_a.$1G.$A4y(_g.$y,f);if(_g.$PV.isInstanceOfType(t))this.meetingResponseMessageId=t.get_$i();else if(_g.$33.isInstanceOfType(t)){this.$596=t.get_$i();this.$Qc&&_cc.$S1.isInstanceOfType(this.$Qc)&&this.$Qc.$3KF()}else _g.$CC.isInstanceOfType(t)&&(this.$8J4=t.get_$i())}}this.$Ee||(this.$5N=this.meetingResponseMessageId);this.$3Nt=!1;if(this.$1cq){_h.$12.$1Zk(this.$t9,this.$35z);return}}};_c.$13K=function(n,t){_c.$13K.initializeBase(this);_a.$4.$J(n,"item");_a.$4.$J(n.get_$i(),"item.ItemId");_a.$4.$1G(t,"sipUri");this.$P=n;this.$bP=t};_c.$13K.prototype={$bP:null,$P:null,$Df:null,$5ZC:function(n){n.$2pv(this.$bP,new _g.$1q(this.$P.get_$i().Id),new _g.$13L(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if($6(n)){i(Error.argumentNull("onlineMeetingType"));return}if($6(n.ItemId)){i(Error.argumentNull("onlineMeetingType.ItemId"));return}this.$Df=n;var u=new _g.$1q(this.$Df.ItemId.Id);u.ChangeKey=this.$Df.ItemId.ChangeKey;this.$P.set_$i(u);this.$P.set_$2Qa(this.$Df.WebUrl);var r=new _g.$kb;r.set_$45o(this.$Df.LobbyBypass);r.set_$3c1(this.$Df.AccessLevel);r.set_$4OW(this.$Df.Presenters);this.$P.set_$16L(r);t()}};_c.$16J=function(n){_c.$16J.initializeBase(this);this.$bP=n};_c.$16J.prototype={$bP:null,$c:null,$5ZC:function(n){n.$3uU(this.$bP,new _g.$16I(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{this.$c=n;t()}catch(r){i(Error.create("GetUserOnlineMeetingSettingsAction failed"))}}};_c.$166=function(){_c.$166.initializeBase(this);this.$d=new _g.$167(this.$2D)};_c.$166.prototype={$d:null,$1HF:null,$4Os:function(n){this.$1HF=$6(n.RoomLists)?new Array(0):n.RoomLists},$5ZC:function(n){var t=new _g.$cU(this.get_$6u());n.$3u8(t,this.$d,this.$$d_$A6H,this.$$d_$9RZ)}};_c.$168=function(){_c.$168.initializeBase(this);this.$d=new _g.$169(this.$2D)};_c.$168.prototype={$d:null,$2ac:null,$3LQ:null,$6Kg:function(n,t,i){this.$3LQ=new Array(n.length);for(var r=0;r<n.length;r++)this.$3LQ[r]=n[r].Id;t()},$5ZC:function(n){var t=$6(this.$2ac)?null:this.$2ac.EmailAddress;n.$3u9(t,this.$d,this.$$d_$A6H,this.$$d_$9RZ)}};_c.$ou=function(n,t,i,r,u){this.$1VT=new(_a.$3X.$$(_g.$SR));_c.$ou.initializeBase(this);if($6(u)||!u.get_$B())throw Error.argument("requestedUsers","requestedUsers array is either null or empty");this.$mM=i;this.$zg=u;this.$5kX=r;this.$6r=n;this.$8B=t};_c.$ou.prototype={$zg:null,$6r:null,$8B:null,$5kX:0,$mM:"None",$3s4:null,get_$4R3:function(){return this.$zg},get_$6gk:function(){return this.$1VT},$5ZC:function(n){for(var u=new _g.$Lq(this.get_$6u()),i=new Array(this.$zg.get_$B()),t=0;t<this.$zg.get_$B();t++){i[t]=new _g.$M9;i[t].Email=new _g.$Le;i[t].Email.Address=this.$zg.get_$3q(t)}var r=new _g.$Lm;r.MergedFreeBusyIntervalInMinutes=this.$5kX;r.RequestedView=this.$mM;r.TimeWindow=new _g.$Ld(_a.$7.$EZ(this.$6r),_a.$7.$EZ(this.$8B));u.Body.MailboxDataArray=i;u.Body.FreeBusyViewOptions=r;var f=new _g.$w7(this.$2D);n.$2wc(u,f,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){for(var r=new _js.$Z,t=0;t<n.Responses.length;t++){var i=n.Responses[t].ResponseMessage;if($6(i)){i=new _g.$Pt;i.ResponseCode="NoError"}var u=new _c.$G5(this.$zg.get_$3q(t),i.ResponseCode);u.$QR(n.Responses[t]);r.$D(u);if(n.Responses[t].ResponseMessage.ResponseCode==="NoError"){var f=n.Responses[t].CalendarView.WorkingHours;this.$1VT.$D($6(f)?null:new _g.$SR(f))}else{this.$1VT.$D(null);_js.Trace.logWarning(_a.$0.$8G,"Failed to get Free busy info. User:{0} Error:{1}",this.$zg.get_$3q(t),n.Responses[t].ResponseMessage.MessageText)}}this.$3s4=r}};_c.$1BU=function(n){_c.$1BU.initializeBase(this,[n.get_$i(),5]);this.$Ee=1;this.$2Zo=n.get_$Lf();this.$1OX=!0;this.$GL=n.get_$28();var t=n;this.$Cr=t.get_$3S()?t.get_$3S().Id:null;this.$Eo="RemoveItemFromCalendarAction"};_c.$1BU.prototype={$2Zo:"Single",$Cr:null,$G3:function(){var n=_h.$4Q.prototype.$G3.call(this);n.referencedCalendarItemType=this.$2Zo;return n},$5Et:function(){var n=_c.$7B.$E(128);$6(this.$t9)||(n.ReferenceItemId=_g.$1q.$uS(this.$t9));return[n]},$4Os:function(n){_h.$12.$1Zk(this.$t9,this.$Cr)},$Yb:function(){_a.$2p.prototype.$Yb.call(this);_h.$12.$3Pt(this.$t9,this.$Cr)},$TA:function(){_h.$12.$1Zk(this.$t9,this.$Cr)}};_c.$zw=function(n,t){_c.$zw.initializeBase(this);_a.$4.$J(n,"Calendar to modify the color of must be specified.");this.$Jw=n;this.$3E2=t};_c.$zw.prototype={$Jw:null,$3E2:0,$5ZC:function(n){var t=new _g.$1q(this.$Jw.get_$i().Id);t.ChangeKey=this.$Jw.get_$i().ChangeKey;n.$6TE(t,this.$3E2,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$Jw.set_$1K6(this.$3E2);this.$Jw.set_$bv(this.$3E2);this.$Jw.get_$i().ChangeKey=n.NewCalendarEntryId.ChangeKey}};_c.$110=function(n,t){_c.$110.initializeBase(this);_a.$4.$l(n,"imBuddy");_a.$4.$l(t,"imGroup");this.$r1=n;this.$2yr=t};_c.$110.prototype={$r1:null,$2yr:null,$5ZC:function(n){n.$52q(this.$r1,this.$2yr,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(!n){i(Error.create("AcceptBuddyAction failed"));return}_js.Trace.logInfo(_a.$0.$4W,"AcceptBuddy web service call succeeded for chat {0}.",this.$r1.SipUri);t()}};_c.$11A=function(n,t){_c.$11A.initializeBase(this);_a.$4.$l(n,"imBuddy");_a.$4.$l(t,"imGroup");this.$r1=n;this.$2yr=t};_c.$11A.prototype={$r1:null,$2yr:null,$5ZC:function(n){n.$53n(this.$r1,this.$2yr,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(!n){i(Error.create("AddImBuddyAction failed"));return}_js.Trace.logInfo(_a.$0.$4W,"AddImBuddy web service call succeeded for buddy {0}.",this.$r1.SipUri);t()}};_c.$13f=function(n){_c.$13f.initializeBase(this);_a.$4.$l(n,"imBuddy");this.$r1=n};_c.$13f.prototype={$r1:null,$5ZC:function(n){n.$5H7(this.$r1,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(!n){i(Error.create("DeclineBuddyAction failed"));return}_js.Trace.logInfo(_a.$0.$4W,"DeclineBuddy web service call succeeded for buddy {0}.",this.$r1.SipUri);t()}};_c.$1BT=function(n,t){_c.$1BT.initializeBase(this);_a.$4.$l(n,"imBuddy");_a.$4.$l(t,"personaId");this.$r1=n;this.$CR=t};_c.$1BT.prototype={$r1:null,$CR:null,$5ZC:function(n){n.$6Mw(this.$r1,this.$CR,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(!n){i(Error.create("RemoveBuddyAction failed"));return}_js.Trace.logInfo(_a.$0.$4W,"RemoveBuddy web service call succeeded for buddy {0}.",this.$r1.SipUri);t()}};_c.$aW=function(n,t,i,r){_c.$aW.initializeBase(this,[2]);_a.$4.$J(n,"approvalMessage");this.$Ee=r;this.$1OX=!0;this.$Eo="CreateApprovalResponse";this.$v0=n;this.$E6=t;this.$3dq=i};function $6lz(n,t){if(!n.$E6){var u=n.$3dq?_nbs.NonBootStrings.l_ApprovePrefix_Text:_nbs.NonBootStrings.l_RejectPrefix_Text;var f=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,u,n.$v0.get_$nk());t.Subject=f;if(n.$v0.get_$8X()){var i=new(_a.$W.$$(_g.$1l));i.$D(n.$v0.get_$8X().Mailbox);t.ToRecipients=_h.$4Q.$XI(i)}return}var r;_h.$4Q.$4OU(n.$E6.get_$3C(),r={val:n.$1Xs},n.$1Ks);n.$1Xs=r.val;t.Importance=n.$E6.get_$6U();n.$E6.get_$4B()&&n.$E6.get_$4B().get_$B()>0&&(t.ToRecipients=_h.$4Q.$XI(n.$E6.get_$4B()));n.$E6.get_$4T()&&n.$E6.get_$4T().get_$B()>0&&(t.CcRecipients=_h.$4Q.$XI(n.$E6.get_$4T()));n.$E6.get_$60()&&n.$E6.get_$60().get_$B()>0&&(t.BccRecipients=_h.$4Q.$XI(n.$E6.get_$60()));t.Sensitivity=n.$E6.get_$84();t.IsDeliveryReceiptRequested=n.$E6.get_$Fj();t.IsReadReceiptRequested=n.$E6.get_$F6();$6(n.$E6.get_$3C())||(t.Body=new _g.$6R(n.$E6.get_$3C().get_$3n()==="HTML"?"HTML":"Text",n.$E6.get_$3C().get_$1g()));t.Subject=n.$E6.get_$2i()}_c.$aW.prototype={$v0:null,$E6:null,$3dq:!1,$Yb:function(){_a.$2p.prototype.$Yb.call(this);this.$Ee===1&&_h.$12.$3Pt(this.$v0.get_$i(),this.$v0.get_$3S().Id)},$5Et:function(){var n;n=this.$3dq?new _g.$LM:new _g.$Pq;if(this.$Ee){_js.Trace.logInfo(_a.$0.$j,"Set parent folder to outbox for this send and save copy create call");this.$GL=_g.$h.$1i.nameToId("outbox")}else{_js.Trace.logInfo(_a.$0.$j,"Set parent folder to drafts for this save only create call");this.$GL=_g.$h.$1i.nameToId("drafts")}n.ReferenceItemId=_g.$1q.$uS(this.$v0.get_$i());$6lz(this,n);return[n]},$4Os:function(n){!this.$Ee&&n.Items&&n.Items[0]?this.$5N=n.Items[0].ItemId:this.$Ee===1&&_h.$12.$1Zk(this.$v0.get_$i(),this.$v0.get_$3S().Id)},$TA:function(){_a.$2p.prototype.$TA.call(this);this.$Ee===1&&_h.$12.$1Zk(this.$v0.get_$i(),this.$v0.get_$3S().Id)}};_c.$14P=function(n,t,i){_c.$14P.initializeBase(this);this.$TS=n;this.$fy=t;this.$fv=i};_c.$14P.prototype={$TS:null,$fy:null,$fv:null,$5ZC:function(n){var t=new _g.$14Q(new _0365f.$tS);if(this.$fy){t.remoteUserIdentifier=this.$fy;t.explicitLogonUser=this.$fy;t.selfIdentifier=this.$fv}n.$5L0(this.$TS,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){n&&t()}};_c.$13R=function(n,t){_c.$13R.initializeBase(this);this.$66d=n;this.$5Ju=t};_c.$13R.prototype={$66d:null,$5Ju:null,$1gd:null,$5ZC:function(n){var t=new _g.$13S(this.$2D);n.$3l0(this.$66d,this.$5Ju,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){this.$1gd=n;t()}};_c.$vU=function(n,t,i){_c.$vU.initializeBase(this);this.$3j=n;this.$VF=t;this.$iL=i};_c.$vU.prototype={$3j:null,$VF:null,$iL:null,$5ZC:function(n){var i=new _g.$bL(this.$3j,this.$VF,this.$iL);var t=new _g.$14T(this.$2D);t.actionName="Ext_ExecuteEwsProxy";n.$3q9(i,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){t()}};_c.$vF=function(n,t,i){_c.$vF.initializeBase(this,[t,i]);this.$Lc=n};_c.$vF.prototype={$Lc:null,$6J7:function(n){n.ActionType=0},$9Q4:function(n,t){for(var i=0;i<this.$Lc.get_$B();i++){var r=this.$Lc.get_$3q(i);if(_0365f.$2t.$4N(n.get_$i(),r.get_$i())){this.$Lc.$68(i);break}}t.$Co&&t.$7j0(n.get_$i().Id)}};_c.$vt=function(n,t){_c.$vt.initializeBase(this);this.$3RY=new Array(n.length);for(var i=0;i<n.length;i++){this.$3RY[i]=new _g.$Vs(t);this.$3RY[i].Id=n[i]}};_c.$vt.prototype={$3RY:null,$5ZC:function(n){var t=new _g.$Wc(this.get_$6u());t.Body.TokenRequests=this.$3RY;var i=new _g.$vu(this.$2D);i.actionName="Ext_GetUserIdentityToken";n.$2vR(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_c.$DB.get_$I().$7Oi(n.Token)}};_c.$15R=function(){this.$3mR=-1;_c.$15R.initializeBase(this)};_c.$15R.prototype={$6Kg:function(n,t,i){this.$3mR=n;t()},$5ZC:function(n){n.$5QI(null,this.$$d_$A6H,this.$$d_$9RZ)}};_c.$8j=function(){_c.$8j.initializeBase(this)};_c.$8j.prototype={$xQ:!1,$6r:null,$3jC:0,$3K:null,$n:function(n,t){if(!this.$xQ){this.$3K=new _g.$c4(n,t);this.$xQ=!0;this.$6r=_a.$7.get_$29();OwaApplication.$1W.$z(this)}},$5ZC:function(n){var t=new _g.$15V(this.$2D);t.actionName="Ext_LoadApps";n.$2LY(this.$3K,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){this.$3jC=_a.$7.get_$29().$5z(this.$6r);_c.$8j.$mH=n;t()}};_c.$15f=function(n,t){_c.$15f.initializeBase(this,[n,[t],_h.$15.get_$206(),"MailCompose",2,!1]);this.$Eo="GetMessageForCompose"};_c.$15f.prototype={$G6:null,$1yZ:!1,get_$i:function(){return this.$BN[0]},$4Os:function(n){if(this.$1yZ)throw Error.invalidOperation("Expected only one response message.");this.$1yZ=!0;var t=_g.$y.$E(n.Items[0]);this.$G6=t}};_c.$15q=function(){_c.$15q.initializeBase(this)};_c.$15q.prototype={$6GG:null,$5ZC:function(n){n.$13L(new _g.$15r(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{this.$6GG=n;t()}catch(r){i(r)}}};_c.$X0=function(n,t){_c.$X0.initializeBase(this);this.$96=t;this.$2a0=new _c.$LC;this.$1yE=n};function $6m9(n){var t=new _g.$Lp(n.get_$6u());$6(n.$1pl)||(t.Body.BeginTime=_a.$7.$EZ(n.$1pl));$6(n.$8B)||(t.Body.EndTime=_a.$7.$EZ(n.$8B));$6(n.$xp)||n.$xp===200||(t.Body.MaxItems=n.$xp);!$6(n.$17F)&&n.$17F&&(t.Body.ReminderType=n.$17F);n.$1yE||!n.$96.get_$2eU()?t.Body.ReminderGroupType=0:n.$96.get_$1k()||(t.Body.ReminderGroupType=1);return t}_c.$X0.prototype={$2a0:null,$1pl:null,$8B:null,$xp:0,$17F:0,$1yE:!1,$96:null,get_$5jq:function(){return this.$xp},set_$5jq:function(n){if(n<0||n>200)throw Error.argumentOutOfRange("MaxItems",n,"Invalid value");this.$xp=n?n:200;return n},$5ZC:function(n){var t=$6m9(this);var i=new _g.$w4(this.$2D);n.$wc(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{var r=n.Body.Reminders;this.$2a0.$6I(r);_js.Trace.logInfo(_a.$0.$EO,"GetRemindersAction succeeded. Received {0} reminders",this.$2a0.get_$B());t()}catch(u){i(u)}}};_c.$os=function(n,t){_c.$os.initializeBase(this);if(_js.$9.$a(t))throw Error.argument("scope","scope can not be null or empty.");this.$3RX=new _g.$Vs("ScopedToken");this.$3RX.Id=n;this.$3RX.Scope=t};_c.$os.prototype={$3RX:null,$VF:null,$5ZC:function(n){var t=new _g.$Wc(this.get_$6u());t.Body.TokenRequests=[this.$3RX];var i=new _g.$vu(this.$2D);i.actionName="Ext_GetAttachmentToken";n.$2vR(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.$VF=n.Token)}};_c.$qB=function(n,t){_c.$qB.initializeBase(this);this.$iL=n;this.$5N=t};_c.$qB.prototype={$iL:null,$5N:null,$5ZC:function(n){var i=new _g.$dO(this.$iL,this.$5N);var t=new _g.$18r(this.$2D);t.actionName="Ext_LoadExtensionCustomProperties";n.$45h(i,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){t()}};_c.$ze=function(n,t,i){_c.$ze.initializeBase(this);this.$iL=n;this.$5N=t;this.$6Sc=i};_c.$ze.prototype={$iL:null,$5N:null,$6Sc:null,$5ZC:function(n){var i=new _g.$fV(this.$iL,this.$5N,this.$6Sc);var t=new _g.$1Bn(this.$2D);t.actionName="Ext_SaveExtensionCustomProperties";n.$4SX(i,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){t()}};_c.$zf=function(n,t,i){_c.$zf.initializeBase(this);this.$iL=n;this.$5ML=t;this.$6Se=i};_c.$zf.prototype={$iL:null,$5ML:null,$6Se:null,$5ZC:function(n){var i=new _g.$fW(this.$iL,this.$5ML,this.$6Se);var t=new _g.$1Bo(this.$2D);t.actionName="Ext_SaveExtensionSettings";n.$4SY(i,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){t()}};_c.$109=function(n,t,i){_c.$109.initializeBase(this,[n,i]);this.$2dT=t};_c.$109.prototype={$2dT:null,$6J7:function(n){var t=_a.$7.$Vl(this.$2dT);n.ActionType=1;n.NewReminderTime=t},$9Q4:function(n,t){n.set_$1H5(this.$2dT);if(t.$Co){var i=n.$OH();var r=JsonParser.serialize(i);t.$9kT(r)}}};_c.$13p=function(n){_c.$13p.initializeBase(this);this.$DH=n;this.$d=new _g.$13q(this.$2D);this.$d.id=n.Id};_c.$13p.prototype={$DH:null,$d:null,$5ZC:function(n){n.$3nH(this.$DH,this.$d,this.$$d_$9Hd,this.$$d_$9Hc)}};_c.$oY=function(n,t){_c.$oY.initializeBase(this);this.$DH=n;this.$Cm=t?t:new _js.$Z};_c.$oY.prototype={$DH:null,$Cm:null,get_$17M:function(){return this.$Cm},get_$4R2:function(){return"Default"},$5ZC:function(n){var t=new _g.$14j(this.$2D);n.$3r3(this.$DH,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{for(var f=new Array(n.length),u=0;u<n.length;u++){var r=new _pc.$i;r.$QR(n[u]);if($6(r.get_$6G())){r.set_$BB(1);r.set_$6G(_h.$41.$2Hh())}else r.set_$BB(2);f[u]=r}this.$Cm.$1r();f.length>0&&this.$Cm.$69(f);t()}catch(e){i(e)}}};_c.$Km=function(){};_c.$Km.$7wX=function(){var n=new(_h.$CH.$$(_c.$z0))(_c.$Km.$6Ia);return _h.$12.$7wp(_c.$z0,n)};_c.$Km.$5EY=function(n){return _c.$Km.$7ce(n,1)};_c.$Km.$7ce=function(n,t){var i=new _g.$TN;i.Query=n;i.Sources=t;return new _c.$oY(i)};_c.$1Am=function(n,t){_c.$1Am.initializeBase(this);this.$5N=n;this.$5Iq=t};_c.$1Am.prototype={$5N:null,$5Iq:null,$E6:null,$5ZC:function(n){var t=new _g.$1q(this.$5N);var i=new _g.$ek(t,this.$5Iq);var r=new _g.$ei(this.get_$6u(),i);var u=new _g.$1An(this.$2D);n.$26N(r,u,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){this.$E6=n}};_c.$1Ao=function(n){_c.$1Ao.initializeBase(this);this.$6IC=n};_c.$1Ao.prototype={$6IC:null,$5ZC:function(n){var t=new _g.$ef(this.$6IC);var i=new _g.$b8(t);var r=new _g.$b6(this.get_$6u(),i);var u=new _g.$144(this.$2D);n.$5JG(r,u,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){}};_c.$15o=function(n){_c.$15o.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};_c.$15o.prototype={$3P:null,$5ZC:function(n){var t=new _g.$15p(this.$2D);n.$5Rf(t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if($6(n)){i(Error.create(_nbs.NonBootStrings.l_LoadOptionFailureMessage_Text));return}this.$3P.$184=n;t()}catch(r){i(r)}}};_c.$16F=function(n){_c.$16F.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};_c.$16F.prototype={$3P:null,get_$5ei:function(){return $6(this.$3P.$ow)||!this.$3P.$ow.length},$5ZC:function(n){var t=new _g.$16G(this.$2D);n.$3uP(this.get_$5ei(),t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if($6(n)){i(Error.create(_nbs.NonBootStrings.l_LoadOptionFailureMessage_Text));return}this.get_$5ei()&&(this.$3P.$ow=n.TimeZoneList);this.$3P.$1Aw=n.CurrentTimeZone;t()}catch(r){i(r)}}};_c.$w8=function(n){_c.$w8.initializeBase(this);this.$FT=n};_c.$w8.prototype={$FT:null,$5ZC:function(n){var t=new _g.$15t(0);t.timeZone=this.get_$DM();n.$5Rm(t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if($6(n)){i(Error.create(_nbs.NonBootStrings.l_LoadOptionFailureMessage_Text));return}this.$FT.set_$3qW(n.ExternalAudience);this.$FT.set_$5MM(n.ExternalReply);this.$FT.set_$5Yr(n.InternalReply);this.$FT.set_$1y8(n.IsOofOn);this.$FT.set_$5dw(n.IsScheduled);this.$FT.set_$12i(_a.$7.$42(n.EndTime));t()}catch(r){i(r)}}};_c.$1Cl=function(n,t){_c.$1Cl.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n;this.$2Wc=t};_c.$1Cl.prototype={$2Wc:null,$3P:null,$5ZC:function(n){var t=new _g.$1Cm(this.$2D);n.$3NU(this.$2Wc,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}this.$3P.$1Aw=this.$2Wc;t()}catch(r){i(r)}}};_c.$15U=function(n){this.$$d_$1Fw=Function.createDelegate(this,this.$1Fw);_c.$15U.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};_c.$15U.prototype={$3P:null,$Ls:null,$6Zj:null,$5ZC:function(n){var t=new _g.$15s(this.$2D);n.$5Rl(t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{this.$6Zj=t;if($6(n)){i(Error.create(_nbs.NonBootStrings.l_LoadOptionFailureMessage_Text));return}this.$3P.set_$11H(n.AutoAddSignature);this.$3P.set_$17s(n.SignatureText);this.$3P.set_$p3(n.UseDesktopSignature);this.$Ls=new _h.$NI;this.$Ls.add_$2C(this.$$d_$1Fw);OwaApplication.$1W.$z(this.$Ls)}catch(r){i(r)}},$1Fw:function(n){this.$3P.set_$2rW(this.$Ls.$c.UserOptions.SignatureText);this.$6Zj()}};_c.$1CS=function(n){_c.$1CS.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};_c.$1CS.prototype={$3P:null,$5ZC:function(n){var t=new _g.$T9;t.AutoAddSignature=this.$3P.get_$11H();t.SignatureText=this.$3P.get_$17s();t.UseDesktopSignature=this.$3P.get_$p3();var i=new _g.$1Ce(this.$2D);n.$6U0(t,i,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}catch(r){i(r)}}};_c.$Ji=function(n){this.$$d_$1Fw=Function.createDelegate(this,this.$1Fw);_c.$Ji.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};_c.$Ji.$2w1=function(n){_a.$4.$l(n,"UserAgent shouldn't be null.");return n.get_$31O()?_nbs.NonBootStrings.l_EmailSignatureDefaultIPadSignature_Text:n.get_$31Q()?_nbs.NonBootStrings.l_EmailSignatureDefaultIPhoneSignature_Text:_nbs.NonBootStrings.l_EmailSignatureDefaultSignature_Text};function $6m8(n){$Hp(n,null)}function $6m7(n,t){$Hp(n,t)}_c.$Ji.prototype={$3P:null,$Ls:null,$6AP:function(){try{var n=_a.$7G.$E();var t=n.$3x("MOWA.IsSignatureChanged")==="true"?!0:!1;this.$3P.set_$11H(t?Boolean.parse(n.$3x("MOWA.AutoAddSignature")):!0);this.$3P.set_$17s(t?n.$3x("MOWA.SignatureText"):_c.$Ji.$2w1(_a.UserAgent.getInstance()));this.$3P.set_$p3(t?Boolean.parse(n.$3x("MOWA.UseDesktopSignature")):!1);this.$Ls=new _h.$NI;this.$Ls.add_$2C(this.$$d_$1Fw);OwaApplication.$1W.$z(this.$Ls)}catch(i){$6m7(this,i)}return 1},$1Fw:function(n){this.$3P.set_$2rW(this.$Ls.$c.UserOptions.SignatureText);$6m8(this)}};_c.$fn=function(n){_c.$fn.initializeBase(this);if(!n)throw Error.argumentNull("model");this.$3P=n};function $6mU(n){$Hp(n,null)}function $6mT(n,t){$Hp(n,t)}_c.$fn.prototype={$3P:null,$6AP:function(){try{var n=_a.$7G.$E();n.$DI("MOWA.SignatureText",this.$3P.get_$17s());n.$DI("MOWA.AutoAddSignature",this.$3P.get_$11H().toString());n.$DI("MOWA.UseDesktopSignature",this.$3P.get_$p3().toString());n.$DI("MOWA.IsSignatureChanged","true");$6mU(this)}catch(t){$6mT(this,t)}return 0}};_c.$15O=function(n,t){this.$$d_$9Eu=Function.createDelegate(this,this.$9Eu);this.$$d_$9Q8=Function.createDelegate(this,this.$9Q8);_c.$15O.initializeBase(this);this.$Ln=t;this.$vf=n};_c.$15O.prototype={$vf:null,$Ln:null,$6AP:function(){this.$Ln?this.$Ln.$7yL(this.$$d_$9Q8,this.$$d_$9Eu):_js.Trace.logError(_a.$0.$KR,"Action requires an AddressbookDispatcher instance to make the GetSyncContactsToDeviceEnabled call.");return 1},$9Q8:function(n){this.$vf.set_$338(n);$Hp(this,null)},$9Eu:function(n){_js.Trace.logError(_a.$0.$KR,"The call to get contact sync info from the PAL failed."+n.message)}};_c.$1CR=function(n,t){this.$$d_$7Mq=Function.createDelegate(this,this.$7Mq);this.$$d_$539=Function.createDelegate(this,this.$539);_c.$1CR.initializeBase(this);this.$Ln=t;this.$vf=n};_c.$1CR.prototype={$vf:null,$Ln:null,$6AP:function(){this.$Ln?this.$Ln.$4V9(this.$vf.$j1,this.$$d_$539,this.$$d_$7Mq):_js.Trace.logError(_a.$0.$KR,"Action requires an AddressbookDispatcher to make the SetSyncContactsToDeviceEnabled call.");return 1},$7Mq:function(n){$Hp(this,n)},$539:function(){$Hp(this,null)}};_c.$10M=function(){_c.$10M.initializeBase(this)};_c.$10M.prototype={$6AP:function(){$Hp(this,null);return 0}};_c.$10N=function(n){_c.$10N.initializeBase(this);_a.$4.$l(n,"setCallback");this.$9O=n};_c.$10N.prototype={$9O:null,$6AP:function(){this.$9O();return 0}};_c.$100=function(n){_c.$100.initializeBase(this);this.$FT=n};_c.$100.prototype={$FT:null,$5ZC:function(n){var t=new _g.$OT;t.ExternalAudience=this.$FT.$2KO;t.ExternalReply=this.$FT.$2KP;t.InternalReply=this.$FT.$2O0;t.IsOofOn=this.$FT.$rP;n.$6U1(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}};_c.$1BX=function(n){_c.$1BX.initializeBase(this);this.$1Gc=n};_c.$1BX.prototype={$1Gc:null,$5ZC:function(n){n.$6NO(this.$1Gc,null,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{if(!n){i(Error.create(_u.Strings.l_SaveOptionFailureMessage_Text));return}t()}catch(r){i(r)}}};_c.$8I=function(n,t){_c.$8I.initializeBase(this);_a.$4.$l(n,"remindersToPerformAction");_a.$4.$l(t,"reminderDispatcher");this.$17E=n;this.$HA=t};function $6mP(n){var t=new _g.$L7;t.ReminderItemActions=$6mO(n);var i=new _g.$Nx(n.get_$6u());i.Body=t;return i}function $6mO(n){for(var r=new Array(n.$17E.length),t=0;t<n.$17E.length;t++){var u=n.$17E[t];var f=new _g.$1q(u.get_$i().Id);f.ChangeKey=u.get_$i().ChangeKey;var i=new _g.$O5;i.ItemId=f;n.$6J7(i);r[t]=i}return r}_c.$8I.prototype={$17E:null,$HA:null,$5ZC:function(n){var t=$6mP(this);var i=new _g.$1AW(this.$2D);n.$2YL(t,i,this.$$d_$9Hd,this.$$d_$9Hc)},$Yb:function(){_a.$2p.prototype.$Yb.call(this);for(var n=0;n<this.$17E.length;n++)this.$9Q4(this.$17E[n],this.$HA)}};_c.$AW=function(n,t,i){this.$4e0=-1;_c.$AW.initializeBase(this);if(!n)throw Error.argumentNull("request","Request cannot be null");this.$fy=t;this.$fv=i;this.$DH=n};_c.$AW.$7bQ=function(n,t,i,r,u){if(!n)throw Error.argumentNull("sessionId");if(!t||!t.length)throw Error.argumentNull("folderIds");var f=new _g.$UW(n,3,2,_c.$AW.$3sO(),i);f.MaximumResultCount=250;f.FolderScope=t;return new _c.$AW(f,r,u)};_c.$AW.$7dW=function(n,t,i,r,u,f,e,o){if(_js.$9.$a(n))throw Error.argumentNull("sessionId");if(!t)throw Error.argumentNull("folderScope");var h=!1;if(t.Id===_g.$h.$1i.nameToId("inbox").Id){t=_g.$h.$1i.nameToId("msgfolderroot");h=!0}t=new _g.$3S(t.Id);var c=30;var s=new _g.$UW(n,r,c,_c.$AW.$3sO(),i);s.MaximumResultCount=250;s.FolderScope=[t];s.IsDeepTraversal=h;u&&(s.RefinementFilter=u);f&&(s.DateRestriction=f);return new _c.$AW(s,e,o)};_c.$AW.$7ej=function(n,t,i,r,u,f){if(_js.$9.$a(n))throw Error.argumentNull("sessionId");if(!t)throw Error.argumentNull("folderScope");var o=!1;t.Id===_g.$h.$1i.nameToId("inbox").Id&&(t=_g.$h.$1i.nameToId("msgfolderroot"));t===_g.$h.$1i.nameToId("msgfolderroot")&&(o=!0);var e=new _g.$UW(n,r,1,_c.$AW.$3sO(),i);e.IsDeepTraversal=o;e.MaxSuggestionsCount=10;e.FolderScope=[t];return new _c.$AW(e,u,f)};_c.$AW.$3sO=function(){var n=_c.$AW.$34J;return parseInt((_c.$AW.$34J=(new Date).getTime()).toString()+(_c.$AW.$3Ko=n===_c.$AW.$34J?++_c.$AW.$3Ko%10:0).toString(),10)};_c.$AW.prototype={$DH:null,$fy:null,$fv:null,$5ZC:function(n){var t=new _g.$1AV(new _0365f.$tS);if(this.$fy){t.remoteUserIdentifier=this.$fy;t.explicitLogonUser=this.$fy;t.selfIdentifier=this.$fv}this.$4e0=(new Date).getTime();n.$6Hb(this.$DH,t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){}};_c.$iY=function(n,t){_c.$iY.initializeBase(this,[0]);this.$sk=n;var i=_g.$2X.$Bi("todosearch").get_$r();($6(t)||t===i)&&(t=_g.$2X.$Bi("tasks").get_$r());this.$oM=_g.$28.$Z7(t);this.$Eo="CreateTask"};function $6m6(n){for(var t=new _g.$KM,f=n.$sk.$2D,e=n.$sk.$5Pu(),r=e,o=r.length,i=0;i<o;++i){var s=r[i];var u=_c.$5S.$5T1(s);u&&u(t,f)}t.Owner=_g.$V.get_$I().get_$31().get_$FS();return t}_c.$iY.prototype={$sk:null,$5N:null,$5Et:function(){return[$6m6(this)]},$4Os:function(n){this.$5N=n.Items[0].ItemId}};_c.$13T=function(n,t){_c.$13T.initializeBase(this);_a.$4.$l(n,"ParentGroup");this.$16Y=n;var i=new _g.$mD;i.set_$o1(n.get_$8k());this.$1RB=i;this.$24V=new _g.$10Z;this.$S7=t};_c.$13T.prototype={$1RB:null,$24V:null,$16Y:null,$S7:null,$9jx:function(n){if(!_js.$9.$18(n)){this.$1RB.set_$Kw(n);this.$24V.set_$1o(n)}},$5ZC:function(n){n.$3l7(this.$1RB.get_$Kw(),this.$1RB.get_$o1(),null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){var t=new _g.$3S(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.$24V.set_$r(t);this.$24V.set_$28(_g.$2X.$Bi("tasks").get_$r());this.$1RB.set_$18F(t);this.$1RB.set_$i(n.NewTaskFolderEntryId);var i=_h.$j.$cN("msgfolderroot");i.$1t.$D(this.$24V);this.$S7.$7Ob(this.$16Y,this.$1RB,this.$24V)}};_c.$13r=function(n,t,i){_c.$13r.initializeBase(this);_a.$4.$l(n,"taskFolderToDelete");_a.$4.$l(t,"parentGroup");_a.$4.$l(i,"taskGroupsCache");this.$3Qt=n;this.$16Y=t;this.$S7=i};_c.$13r.prototype={$3Qt:null,$16Y:null,$S7:null,$5ZC:function(n){var t=new _g.$1q(this.$3Qt.get_$i().Id);t.ChangeKey=this.$3Qt.get_$i().ChangeKey;n.$3nL(t,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$S7.$9bb(this.$16Y,this.$3Qt)}};_c.$bg=function(n,t){_c.$bg.initializeBase(this,[n,t])};function $4iI(n,t){var i="NotStarted";switch(t.get_$8h()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":i="Completed";break;case"Flagged":i="InProgress";break}return i}_c.$bg.prototype={$7dG:function(){this.$2k&&(this.$1ld=new _g.$Cd(_g.$28.$S9(this.$2k)));var t=[];var f=$4iI(this,this.$8g);var n=new _g.$6z(new _g.$1X("TaskStatus"));n.Item=new _g.$KM;n.Item.Status=f;Array.add(t,n);if(f==="InProgress"){var r=null;if($6(this.$8g.get_$8q())){r=new _g.$Ee(new _g.$1X("TaskStartDate"));Array.add(t,r)}else{n=new _g.$6z(new _g.$1X("TaskStartDate"));n.Item=new _g.$KM;n.Item.StartDate=this.$8g.get_$8q().$99();Array.add(t,n)}if($6(this.$8g.get_$Ct())){r=new _g.$Ee(new _g.$1X("TaskDueDate"));Array.add(t,r)}else{n=new _g.$6z(new _g.$1X("TaskDueDate"));n.Item=new _g.$KM;n.Item.DueDate=this.$8g.get_$Ct().$99();Array.add(t,n)}if($6(this.$8g.get_$JJ())){r=new _g.$Ee(new _g.$1X("TaskCompleteDate"));Array.add(t,r)}else{n=new _g.$6z(new _g.$1X("TaskCompleteDate"));n.Item=new _g.$KM;n.Item.CompleteDate=this.$8g.get_$JJ().$99();Array.add(t,n)}}for(var u=new Array(this.$p.length),i=0;i<this.$p.length;i++){var e=new _g.$1q(this.$p[i].get_$i().Id);e.ChangeKey=this.$p[i].get_$i().ChangeKey;u[i]=new _g.$HP;u[i].ItemId=e;u[i].Updates=t}return u},$Yb:function(){var t=$4iI(this,this.$8g);var n=this.$p;var i=this,r=this;_h.$12.$A48(_g.$9t,String,n,"Status",function(n){return n.get_$BG()},t,function(n,t){n.set_$BG(t)});var u=this,f=this;_h.$12.$A48(_g.$9t,Boolean,n,"IsComplete",function(n){return n.get_$fa()},t==="Completed",function(n,t){n.set_$fa(t)});if(t==="InProgress"){if(!$6(this.$8g.get_$8q())){var e=this,o=this;_h.$12.$A48(_g.$9t,_a.$7,n,"StartDate",function(n){return n.get_$8q()},this.$8g.get_$8q(),function(n,t){n.set_$8q(t)})}if(!$6(this.$8g.get_$Ct())){var s=this,h=this;_h.$12.$A48(_g.$9t,_a.$7,n,"DueDate",function(n){return n.get_$Ct()},this.$8g.get_$Ct(),function(n,t){n.set_$Ct(t)})}if(!$6(this.$8g.get_$JJ())){var c=this,l=this;_h.$12.$A48(_g.$9t,_a.$7,n,"CompleteDate",function(n){return n.get_$JJ()},this.$8g.get_$JJ(),function(n,t){n.set_$JJ(t)})}}else if(t==="Completed"){var a=this,v=this;_h.$12.$A48(_g.$9t,String,n,"PercentComplete",function(n){return n.get_$kC()},"100",function(n,t){n.set_$kC(t)});var y=this,p=this;_h.$12.$A48(_g.$9t,_a.$7,n,"CompleteDate",function(n){return n.get_$JJ()},_a.$7.get_$29().$4F(),function(n,t){n.set_$JJ(t)})}}};_c.$ot=function(){_c.$ot.initializeBase(this)};function $6mA(n,t){$6(t)||(n.$4Zk=t.TaskGroups)}_c.$ot.prototype={$4Zk:null,$5ZC:function(n){var t=new _g.$16B(this.$2D);n.$3uN(t,this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){try{$6mA(this,n)}catch(r){i(r);return}t()}};_c.$w6=function(n,t,i,r,u,f){_c.$w6.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,"All",f,!1,null,null])};_c.$w6.prototype={get_$3Pj:function(){return _h.$mG.$5Sr(this.$Af.$Bv,this.$Af.$MQ,this.$2k)}};_c.$1BZ=function(n,t,i){_c.$1BZ.initializeBase(this);_a.$4.$l(n,"taskFolderToRename");_a.$4.$1G(t,"newTaskFolderName");_a.$4.$l(i,"taskGroupsCache");this.$2Aa=n;this.$3ED=t;this.$S7=i};_c.$1BZ.prototype={$2Aa:null,$3ED:null,$S7:null,$5ZC:function(n){var t=new _g.$1q(this.$2Aa.get_$i().Id);t.ChangeKey=this.$2Aa.get_$i().ChangeKey;n.$4Qh(t,this.$3ED,null,this.$$d_$A6H,this.$$d_$9RZ)},$26f:function(n){this.$2Aa.get_$i().ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.$2Aa.set_$Kw(this.$3ED);if(this.$S7.$aD){var t=this.$S7.$5Sq(this.$2Aa.get_$18F());if(!$6(t)){t.get_$r().ChangeKey=n.NewFolderId.ChangeKey;t.set_$1o(this.$3ED)}}}};_c.$V6=function(){this.$8w=String.format(_nbs.NonBootStrings.l_TaskFolderActionDefaultError_Text,-1);_c.$V6.$$(this.$$gta["_c.$V6"].T).initializeBase(this)};_c.$V6.$$=function(n){var t="$V6"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_c[t]){var i=_c[t]=function(){(this.$$gta=this.$$gta||{})["_c.$V6"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_c.$V6.apply(this,i)};i.registerClass("_c."+t,_h.$F3.$$(n));var u=_c.$V6.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(i.prototype[r.key]=r.value)}i.$3u7=function(n){return _c.$mC.$5Sp(n)}}return _c[t]};_c.$V6.prototype={get_$cH:function(){return this.$8w},$6Kg:function(n,t,i){if(!n.WasSuccessful){this.$8w=_c.$V6.$$(this.$$gta["_c.$V6"].T).$3u7(n.ErrorCode);i(Error.create(this.$8w));return}try{this.$26f(n)}catch(r){i(r);return}t()}};_c.$mC=function(){};_c.$mC.$5Sp=function(n){switch(n){case 11:return _nbs.NonBootStrings.l_TaskFolderActionCannotRename_Text;case 13:return _nbs.NonBootStrings.l_TaskFolderActionCannotDeleteTaskFolder_Text;case 7:return _nbs.NonBootStrings.l_TaskFolderActionTaskFolderAlreadyExists_Text;default:return String.format(_nbs.NonBootStrings.l_TaskFolderActionDefaultError_Text,n)}};_c.$Gw=function(n,t){this.$6L3=n;this.$5I8=t};_c.$Gw.prototype={$6L3:"FolderId",$5I8:!1};_c.$5S=function(){};_c.$5S.$5T1=function(n){_c.$5S.$7lw();return _c.$5S.$TJ[n]};_c.$5S.$7lw=function(){if($6(_c.$5S.$TJ)){_c.$5S.$TJ={};_c.$5S.$TJ.Subject=function(n,t){n.Subject=t.get_$2i();return new _c.$Gw("Subject",!1)};_c.$5S.$TJ.DueDate=function(n,t){var i=$6(t.get_$Ct());i||(n.DueDate=t.get_$Ct().$99());return new _c.$Gw("TaskDueDate",i)};_c.$5S.$TJ.Body=function(n,t){n.Body=new _g.$6R(t.get_$3C().get_$3n()==="HTML"?"HTML":"Text",t.get_$3C().get_$1g());return new _c.$Gw("Body",!1)};_c.$5S.$TJ.StartDate=function(n,t){var i=$6(t.get_$8q());i||(n.StartDate=t.get_$8q().$99());return new _c.$Gw("TaskStartDate",i)};_c.$5S.$TJ.Importance=function(n,t){n.Importance=t.get_$6U();return new _c.$Gw("Importance",!1)};_c.$5S.$TJ.Status=function(n,t){n.Status=t.get_$BG();return new _c.$Gw("TaskStatus",!1)};_c.$5S.$TJ.CompleteDate=function(n,t){var i=$6(t.get_$JJ());i||(n.CompleteDate=t.get_$JJ().$99());return new _c.$Gw("TaskCompleteDate",i)};_c.$5S.$TJ.PercentComplete=function(n,t){n.PercentComplete=t.get_$kC();return new _c.$Gw("TaskPercentComplete",!1)};_c.$5S.$TJ.Sensitivity=function(n,t){n.Sensitivity=t.get_$84();return new _c.$Gw("Sensitivity",!1)};_c.$5S.$TJ.TotalWork=function(n,t){n.TotalWork=t.get_$2eu();return new _c.$Gw("TaskTotalWork",!1)};_c.$5S.$TJ.ActualWork=function(n,t){n.ActualWork=t.get_$2E7();return new _c.$Gw("TaskActualWork",!1)};_c.$5S.$TJ.Mileage=function(n,t){n.Mileage=t.get_$2Vw();return new _c.$Gw("TaskMileage",!1)};_c.$5S.$TJ.BillingInformation=function(n,t){n.BillingInformation=t.get_$2Fe();return new _c.$Gw("TaskBillingInformation",!1)};_c.$5S.$TJ.Companies=function(n,t){var r=$6(t.get_$vS())&&t.get_$vS().get_$B()>0;if(!r){for(var u=new Array(t.get_$vS().get_$B()),i=0;i<t.get_$vS().get_$B();i++)u[i]=t.get_$vS().get_$3q(i);n.Companies=u}return new _c.$Gw("TaskCompanies",r)};_c.$5S.$TJ.ReminderIsSet=function(n,t){n.ReminderIsSet=t.get_$QH();return new _c.$Gw("ReminderIsSet",!1)};_c.$5S.$TJ.ReminderDueBy=function(n,t){var i=$6(t.get_$1H2());i||(n.ReminderDueBy=t.get_$1H2().$99());return new _c.$Gw("ReminderDueBy",i)};_c.$5S.$TJ.Recurrence=function(n,t){var i=$6(t.get_$LT());i||(n.Recurrence=t.get_$LT().get_$2eT());return new _c.$Gw("TaskRecurrence",i)}}};_c.$tC=function(n){_c.$tC.initializeBase(this,[0]);this.$sk=n;var t=n.$2D;$6(t.get_$28())||(this.$oM=_g.$28.$Z7(t.get_$28()));this.$Eo="UpdateTask"};_c.$tC.$Ma=function(n,t,i){if(i){var r=new _g.$KM;var u=i(r,t);var f=new _g.$1X(u.$6L3);if(u.$5I8){var o=new _g.$Ee(f);Array.add(n,o)}else{var e=new _g.$6z(f);e.Item=r;Array.add(n,e)}}};_c.$tC.prototype={$sk:null,$7dG:function(){for(var i=[],r=this.$sk.$2D,f=this.$sk.$5Pu(),u=f,e=u.length,n=0;n<e;++n){var o=u[n];_c.$tC.$Ma(i,r,_c.$5S.$5T1(o))}var t=new _g.$HP;t.ItemId=_g.$1q.$uS(r.get_$i());t.Updates=i;return[t]}};_c.$nk=function(n,t,i){var u=this;_cc.$EV.$$(_g.$F6).$A6b(function(n){(_cc.$uw.isInstanceOfType(n)||_cc.$ux.isInstanceOfType(n)||_cc.$zZ.isInstanceOfType(n)||_cc.$za.isInstanceOfType(n)||_cc.$v4.isInstanceOfType(n)||_cc.$v5.isInstanceOfType(n)||_c.$zw.isInstanceOfType(n))&&t.$9Yf(_h.$eH,new _h.$eH)});var r=null;var f=this;r=function(u){if(u.$2PS){i.$1w(_a.$0.$JF,"PrefetchCalendarList",function(){n.$1Mx()},4e3);t.$18g(_a.$Dr,r)}};t.$IU(_a.$Dr,r)};_c.CalendarTimePeriodSchema=function(){};_c.$uO=function(n){_c.$uO.initializeBase(this,[n])};_c.$nY=function(n){_c.$nY.$$(this.$$gta["_c.$nY"].T).initializeBase(this,[n]);this.$A4G(this.get_$R()+"_Miniature")};_c.$nY.$$=function(n){var t="$nY"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_c[t]){var r=_c[t]=function(){(this.$$gta=this.$$gta||{})["_c.$nY"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_c.$nY.apply(this,i)};r.registerClass("_c."+t,_h.$CH.$$(n));var u=_c.$nY.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _c[t]};_c.$1Cp=function(n){_c.$1Cp.initializeBase(this,[n])};_c.$zk=function(n){this.$3q0=n.get_$2i();this.$1KY=new _c.$zl(n.get_$y(),n.get_$1u(),n.get_$5V());this.$EP=n.get_$7S();this.$EN=n.get_$8W();this.$Jl=n.get_$9F()};_c.$zk.prototype={$1KY:null,$3q0:null,$EP:null,$EN:null,$Jl:null,$3RA:null,$6b8:null,get_$7mc:function(){return this.$3q0},set_$7mc:function(n){this.$3q0=n;return n},get_$2GB:function(){return this.$1KY},get_$7S:function(){return this.$EP},set_$7S:function(n){this.$EP=n;return n},get_$8W:function(){return this.$EN},set_$8W:function(n){this.$EN=n;return n},get_$9F:function(){return this.$Jl},set_$9F:function(n){this.$Jl=n;return n},get_$2eg:function(){return this.$3RA},set_$2eg:function(n){this.$3RA=n;return n},get_$6b9:function(){return this.$6b8},set_$6b9:function(n){this.$6b8=n;return n}};_c.$zl=function(n,t,i){this.$2Q=n;this.$3D=t;this.$13z=i};_c.$zl.prototype={$2Q:null,$3D:null,$13z:!1,get_$y:function(){return this.$2Q},set_$y:function(n){this.$2Q=n;return n},get_$1u:function(){return this.$3D},set_$1u:function(n){this.$3D=n;return n},get_$5V:function(){return this.$13z},set_$5V:function(n){this.$13z=n;return n}};_c.$ss=function(n,t){_c.$ss.initializeBase(this);this.$7f=n;this.$1KY=t};_c.$ss.prototype={$7f:null,$1KY:null};_c.$14i=function(n){_c.$14i.initializeBase(this,[n])};_c.$14i.prototype={$1af:function(n){var i=_js.$1g.$Q9(_h.$Ap,n.PersonaTypeString);var t=null;switch(i){case 4:var r=n.BusinessAddressesArray;t=n.BusinessAddressesArray[0].Value.LocationUri;break;case 1:t=_pc.$ve.prototype.$1af.call(this,n);break}return t}};_c.$5q=function(){_c.$5q.initializeBase(this)};_c.$5q.prototype={get_$2i:function(){return this.$U(_c.$5q.$Z4)},set_$2i:function(n){this.$K(_c.$5q.$Z4,n);return n},get_$4j:function(){return this.$U(_c.$5q.$1zv)},set_$4j:function(n){this.$K(_c.$5q.$1zv,n);return n},get_$1H5:function(){return this.$U(_c.$5q.$4QK)},set_$1H5:function(n){this.$K(_c.$5q.$4QK,n);return n},get_$8q:function(){return this.$U(_c.$5q.$4Xq)},set_$8q:function(n){this.$K(_c.$5q.$4Xq,n);return n},get_$1Bd:function(){return this.$U(_c.$5q.$3pU)},set_$1Bd:function(n){this.$K(_c.$5q.$3pU,n);return n},get_$i:function(){return this.$U(_c.$5q.$xV)},set_$i:function(n){this.$K(_c.$5q.$xV,n);return n},get_$176:function(){return this.$U(_c.$5q.$4Pl)},set_$176:function(n){this.$K(_c.$5q.$4Pl,n);return n},get_$1H3:function(){return this.$U(_c.$5q.$4QD)},set_$1H3:function(n){this.$K(_c.$5q.$4QD,n);return n},$4e:function(n){return!n||!_c.$5q.isInstanceOfType(n)?!1:this===n||_0365f.$2t.$4N(this.get_$i(),n.get_$i())}};_c.$7B=function(n){_c.$7B.initializeBase(this);this.$1n=n};_c.$7B.$E=function(n){switch(n){case 2:return new _g.$OQ;case 1:return new _g.$Ml;case 4:return new _g.$NA;case 128:return new _g.$Pr;case 64:return new _g.$So;default:return null}};_c.$7B.prototype={$1n:null};_c.$DB=function(){this.$1qA={};this.$1q6={}};_c.$DB.get_$I=function(){$6(_c.$DB.$v)&&(_c.$DB.$v=new _c.$DB);return _c.$DB.$v};_c.$DB.prototype={$7Oi:function(n){switch(n.TokenType){case"CallerIdentity":this.$1qA[n.Id]=new _c.$DB.$3g5(n);break;case"ExtensionCallback":this.$1q6[n.Id]=new _c.$DB.$3g5(n);break;default:_js.Trace.logError(_a.$0.$Mw,String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.$1g.$9a(_g.$aA,n)));break}},$3j3:function(n){return n in this.$1qA&&!this.$1qA[n].$1xY()},$3j1:function(n){return n in this.$1q6&&!this.$1q6[n].$1xY()},$7z1:function(n){return this.$3j3(n)?this.$1qA[n].get_$6bW():null},$7tg:function(n){return this.$3j1(n)?this.$1q6[n].get_$6bW():null},$88C:function(){var n=this.$1qA;for(var t in n){var i={key:t,value:n[t]};if(i.value.$1xY())return!0}return!1},$888:function(){var n=this.$1q6;for(var t in n){var i={key:t,value:n[t]};if(i.value.$1xY())return!0}return!1}};_c.$DB.$3g5=function(n){this.$2G1=new Date;this.$VF=n};_c.$DB.$3g5.prototype={$2G1:null,$VF:null,get_$6bW:function(){return this.$VF},$1xY:function(){var n=new Date;var t=n.getTime()-this.$2G1.getTime();return t>=(this.$VF.TTL-15)*6e4}};_c.$a3=function(n){this.$5MC=n.get_$9wC();this.$PS={}};function $4hz(n){var o=n.$1aZ();var i=new(_0365f.$o.$$(String));var r=n.$PS;for(var u in r){var f={key:u,value:r[u]};var s=f.value;var h=s.$19W(n.$5MC);h.$2R(o)<0&&i.$D(f.key)}for(var e=i.$6Z(),c=e.length,t=0;t<c;++t){var l=e[t];delete n.$PS[l]}}_c.$a3.prototype={$5MC:0,$PS:null,$D:function(n){$4hz(this);this.$PS[n.toString()]=this.$1aZ()},$Mj:function(n){$4hz(this);return n.toString()in this.$PS},$1aZ:function(){return _a.$7.get_$29()}};_c.$2M=function(n,t,i,r,u,f,e){this.$$d_$7Mb=Function.createDelegate(this,this.$7Mb);this.$$d_$9PX=Function.createDelegate(this,this.$9PX);this.$$d_$9PY=Function.createDelegate(this,this.$9PY);this.$$d_$9HO=Function.createDelegate(this,this.$9HO);this.$$d_$9q3=Function.createDelegate(this,this.$9q3);this.$$d_$3yi=Function.createDelegate(this,this.$3yi);this.$$d_$9D9=Function.createDelegate(this,this.$9D9);this.$$d_$9NR=Function.createDelegate(this,this.$9NR);this.$$d_$9NS=Function.createDelegate(this,this.$9NS);this.$$d_$9Pa=Function.createDelegate(this,this.$9Pa);this.$$d_$9Pb=Function.createDelegate(this,this.$9Pb);this.$$d_$99K=Function.createDelegate(this,this.$99K);this.$$d_$4J9=Function.createDelegate(this,this.$4J9);this.$$d_$9sk=Function.createDelegate(this,this.$9sk);this.$uu=new _js.$Z;this.$B5=new _js.$Z;this.$hj=new _js.$Z;_c.$2M.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_c.$2M.initializeBase(this);this.$l3("Initialization","unknown");this.$o3=t;this.add_$3Ig(this.$o3.$$d_$A0O);if(!n){this.$l3("Initialization","Disabled");return}this.$k=i;this.$1Sy=!0;this.$26e=!1;this.$3xK=new _c.$a3(_a.$ML.$7qH(30));var o=new _g.$At;o.NotificationType="InstantMessageNotification";this.$ok=new _h.$BS(o,this.$k,r);this.$ok.add_$4YM(this.$$d_$9sk);if(u&&e){this.$5a6=!0;_js.Trace.logInfo(_a.$0.$4W,"ChatManager: Waiting for the pending-get activation event.");var s=this;u.$IU(_a.$Y5,function(n){_js.Trace.logInfo(_a.$0.$4W,"ChatManager: Pending-get activated.");s.$263=!0;$4iB(s)});var h=this;u.$IU(_a.$qw,function(){$4i0(h)});u.$IU(_a.$Su,this.$$d_$4J9);f?$6lt(this,f):this.$S2="Disabled"}this.$uu.add_$1Z(this.$$d_$99K);this.$2Z0=this.$7eE(this.$k)};_c.$2M.$6ca=function(n,t,i){var r;var u,f;if(f=n.$3SK(function(n){return n.get_$RC()===t},u={val:r}),r=u.val,f){i.val=r;return!0}i.val=null;return!1};_c.$2M.$9x9=function(n,t,i){var r;var u,f;var e=(f=n.$3SK(function(n){var i=n;if(i.get_$Or().get_$B()!==1)return!1;var r=i.get_$Or().get_$3q(0);return r.get_$A6()===t?!0:!1},u={val:r}),r=u.val,f);i.val=r;return e};function $6lu(n,t,i,r){if(n.$S2!=="Disabled"){var u=t?"SignedOut":"Disabled";if(_js.$9.$a(r)){_js.Trace.logInfo(_a.$0.$4W,"The currentUserSipUri is null/empty -> Marking SignInState as disabled.");u="Disabled"}else r=_h.$84.$ib(r);n.$l3("Configuration Updated",u)}n.$5GR=i;n.$6dq("InternalSetConfiguration",r);n.$3iq=!0}function $4i8(n,t){var i=new _g.$XP;_a.$4.$l(t,"persona");i.DisplayName=t.get_$1o();i.SipUri=t.get_$A6();return i}function $4i4(n,t,i){_js.Trace.logInfo(_a.$0.$4W,"Creating new Chat.");var r=new _h.$1k(!0);r.get_$Or().add_$1Z(n.$$d_$9D9);r.get_$Or().$3jd(t);r.set_$1y(new _g.$1q("IM:"+Math.random().toString()));if(!i)return r;if(_g.$y.isInstanceOfType(i)){r.set_$5ib(i);return r}if(_g.$7Z.isInstanceOfType(i)){r.set_$5ia(i);return r}var u=_js.$9.$4R("CreateChat: itemOrConversation type {0} is not supported.",Object.getType(i).getName());_js.Trace.logError(_a.$0.$4W,u);throw Error.invalidOperation(u);}function $4i1(n,t){_js.Trace.logInfo(_a.$0.$4W,"Activating chat.");$6(t.get_$1y())||_h.$1O.get_$I().$IX(t.get_$1y().Id,t);var i=$6lr(n,t);n.$uu.$72(i,t)}function $6lw(n,t,i,r){var f=t.PayloadType;switch(f){case"NewChatMessageToast":_js.Trace.logInfo(_a.$0.$4W,"NewChatMessageToast received and mapped to chat {0}.",i.get_$RC());return;case"ParticipantJoined":n.$o3.$541(t);var u;if($6(t.Persona))u=_pc.$i.$3km(r,t.SipUri);else{u=new _pc.$i;u.$QR(t.Persona)}i.$9TL(t.SipUri,u,r);return;case"ParticipantLeft":i.$9TM(t.SipUri,r);return;case"EndChatSession":i.$5V8||n.$B5.$34(i);return;case"NewChatMessage":i.$6CY(r,t.MessageContent);return;case"UserActivity":switch(t.UserActivity){case"FailedDelivery":i.$u3(_nbs.NonBootStrings.l_IMDeliveryError_Text);return;case"Typing":i.$9pd(r);return;case"StoppedTyping":i.set_$BG("");return;case"TwoOrMoreTyping":i.set_$BG(_nbs.NonBootStrings.l_IMActivityMultipleUsersTyping_Text);return;case"DeliveryTimeout":i.$u3(_nbs.NonBootStrings.l_IMDeliveryTimeout_Text);return;default:return}}}function $6ly(n,t){if(t.PayloadType==="NewChatMessageToast"){n.$o3.$541(t);var r=n.$o3.$2w8(t.SipUri,t.DisplayName);var f=$4i5(n,t.Persona,r,t.SipUri,t.ToastMessage,t.MessageSubject,t.ChatSessionId);_js.Trace.logInfo(_a.$0.$4W,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessageToast).",t.ChatSessionId);return!0}if(t.PayloadType==="NewChatMessage"){var i=n.$o3.$2w8(t.SipUri,t.DisplayName);var u=$4i5(n,t.Persona,i,t.SipUri,t.MessageContent,"",t.ChatSessionId);u.$6CY(i,t.MessageContent);_js.Trace.logInfo(_a.$0.$4W,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessage).",t.ChatSessionId);return!0}return!1}function $4i5(n,t,i,r,u,f,e){var s;if($6(t))s=_pc.$i.$3km(i,r);else{s=new _pc.$i;s.$QR(t)}$6(u)&&(u="");var h=new _js.$Z;h.$D(s);var o=$4i4(n,h,null);o.set_$RC(e);o.$3RI=s;o.$4aj=u;_js.$9.$18(f)||o.set_$2i(f);n.$B5.$D(o);return o}function $6ln(n,t){_a.$4.$l(t,"senderInfo");for(var f=t,e=f.length,i=0;i<e;++i){var r=f[i];var u=r.SipUri;_js.Trace.logInfo(_a.$0.$pc,"Adding pending contact to buddy requests list",u);var o=$6ls(n,r.DisplayName,r.Title,u);$4i9(n,u,!1)||n.$hj.$D(o)}}function $6lx(n,t){_a.$4.$l(t,"senderInfo");for(var r=!1,u=t,e=u.length,i=0;i<e;++i){var o=u[i];var f=o.SipUri;_js.Trace.logInfo(_a.$0.$pc,"Examining the AddToBuddyList payload for existing buddy requests",f);r=$4i9(n,f,!0)}return r}function $6lo(n){_js.Trace.logInfo(_a.$0.$pc,"Received empty subscribers notification, we need to hide the pending buddy dialogue");n.$hj.$1r()}function $6ls(n,t,i,r){_a.$4.$l(t,"displayName");_a.$4.$l(r,"buddyImAddress");var u=_pc.$i.$3km(t,r);_js.$9.$a(i)||u.set_$4v(i);return u}function $4i9(n,t,i){for(var r=0;r<n.$hj.get_$B();r++){var u=n.$hj.get_$3q(r);if(!u.get_$A6().localeCompare(t)){if(i){_js.Trace.logInfo(_a.$0.$pc,"Removing already added contact from pending buddyRequests",u.get_$A6());n.$hj.$68(r)}return!0}}return!1}function $6lr(n,t){var i=this;return n.$uu.$DY(function(n){return t.$1zT.$2R(n.$1zT)>=0})}function $1nU(n,t){n.$1l1&&(n.$1l1=_js.$J.get_$I().$4z(n.$1l1));var i=n.$3N7;n.$3N7=t;if(t&&i){_js.Trace.logInfo(_a.$0.$4W,"Service confirmed available.");return}else if(t&&!i){_js.Trace.logInfo(_a.$0.$4W,"Service resumed.");return}else if(!t&&i){_js.Trace.logInfo(_a.$0.$4W,"Service interrupted.");$4i0(n);$4iA(n);return}else if(!t&&!i){_js.Trace.logInfo(_a.$0.$4W,"Service confirmed unavailable.");$4iA(n);return}_js.Trace.logError(_a.$0.$4W,"Unexpected condition in ChatManager.SetServiceAvailability.")}function $6lv(n){n.$l3("SignedOn Succeeded","SignedIn");n.$1Sy=!0;n.$26e=!1}function $4i0(n){n.$uu.$Bh(n.$$d_$7Mb);n.$B5.$Bh(n.$$d_$7Mb);var t=this;n.$uu.$Bh(function(t){t.$9pQ(n.$3N7)})}function $4iA(n){if(n.$S2==="AttemptingSignIn"||n.$S2==="SignedIn"||n.$S2==="Error"){if(n.$1Sy){n.$1Sy=!1;n.$7h7();return}n.$26e=!1;n.$l3("SignIn-GiveUp","Error")}}function $6lq(n,t,i,r,u){var e=n.$o3.$2w8(i,null);var o=new _c.$rf(t,i,e,r,u);var f=n.$iW(_c.$2M.$2Yz);f&&f(o)}function $6lp(n,t){var i=n.$iW(_c.$2M.$2Yz);if(i){var e=t.PayloadType;if(t.PayloadType==="UpdateUserPresence"){var r=t.DisplayName;_js.$9.$18(r)&&(r=n.$5GR);var s=new _c.$rf(e,n.$2IC,r,_h.$84.$2Lp(t.NewUserPresence),!0);i(s);return}if(!$6(t.UserPresenceChanges))for(var h=t.PayloadType!=="QueryUserPresenceChange",o=t.UserPresenceChanges,c=o.length,u=0;u<c;++u){var f=o[u];var l=new _c.$rf(e,f.SipUri,f.UserName,_h.$84.$2Lp(f.Presence),h);i(l)}}}function $4i7(n,t){var r=new(_0365f.$o.$$(String));if(t)for(var u=t,f=u.length,i=0;i<f;++i){var e=u[i];$4i2(n,r,e)}return r}function $4i6(n,t){for(var e=$3Vb(n,n.$uu.$6Z()),r=new(_0365f.$o.$$(String)),u=t.get_$3T(),o=u.length,i=0;i<o;++i){var f=u[i];e.$7G(f)||r.$D(f)}return r}function $3Vb(n,t){var r=new(_0365f.$o.$$(String));if(t)for(var u=t,e=u.length,i=0;i<e;++i){var o=u[i];var f=o;if(f.get_$Or()){var s=this;f.get_$Or().$Bh(function(t){$4i2(n,r,t)})}}return r}function $4i2(n,t,i){var u=i;var r=_h.$84.$ib(u.get_$A6());r.localeCompare(n.$2IC)&&(t.$7G(r)||t.$D(r))}function $4i3(n,t){n.$5a6&&(n.$S2==="unknown"||!n.$3iq)&&_js.Trace.logError(_a.$0.$4W,"ChatManager: Do not access {0} until configuration has loaded.",t)}function $4iB(n){if(n.get_$2n()&&n.$263&&n.$3iq){var t=this;_js.$J.get_$I().$1w(_a.$0.$4W,"ChatManager.SignIn",function(){n.$4X5(!1)},5e3)}}function $6lt(n,t){var i=t.get_$6H().get_$3yW();var r=t.get_$31().get_$FS();var u=t.get_$31().get_$1VG();$6lu(n,i,r,u);$4iB(n)}_c.$2M.prototype={$o3:null,$5a6:!1,$5GR:null,$2IC:null,$263:!1,$3iq:!1,$5aM:!1,$3xK:null,$k:null,$3N7:!1,$1Sy:!1,$4YP:!1,$S2:"unknown",$1l1:null,$26e:!1,$ok:null,$2Z0:null,add_$3Ig:function(n){this.$2N(_c.$2M.$2Yz,n)},remove_$3Ig:function(n){this.$2P(_c.$2M.$2Yz,n)},get_$9q2:function(){return this.$S2},get_$xN:function(){return this.$S2==="SignedIn"},get_$2n:function(){$4i3(this,"IsEnabled");return this.$S2!=="Disabled"},get_$890:function(){return this.$5aM},get_$1rj:function(){$4i3(this,"CurrentUserSipUri");return this.$2IC},set_$1rj:function(n){this.$2IC=n;return n},$4X5:function(n){if(!this.$263){_js.Trace.logInfo(_a.$0.$4W,"Ignoring a SignIn attempt because the pending-get connection is not yet started.");return}this.$1Sy=!0;this.$26e=n;this.$3yi()},$6Xf:function(n){_js.Trace.logInfo(_a.$0.$4W,"Signing out.");var t=new _c.$17g(n);t.add_$2C(this.$$d_$9Pb);t.add_$1x(this.$$d_$9Pa);this.$l3("SignOut:Manual="+n,"AttemptingSignOut");this.$k.$z(t)},$4cn:function(n,t,i){var r;var u,f;var e=(f=this.$o3.$6cb(t,u={val:r}),r=u.val,f);$6lq(this,n,t,i,e)},$l3:function(n,t){t==="Error";_js.Trace.logInfo(_a.$0.$4W,"SignInState: {0} Requesting change from {1} to {2}",n,this.$S2,t);var i=this.get_$xN();if(this.$S2!==t){this.$S2=t;$N(this,_c.$2M.$1l2);this.get_$xN()!==i&&$N(this,_c.$2M.$5eG)}},$6dq:function(n,t){_js.Trace.logInfo(_a.$0.$4W,"Setting current user SIP URI to {0}",t);this.$2IC=t},$2aL:function(){if(this.$S2==="SignedIn"){_js.Trace.logInfo(_a.$0.$4W,"ResetPresence");var n=new _c.$1Bc;n.add_$2C(this.$$d_$9NS);n.add_$1x(this.$$d_$9NR);this.$k.$z(n)}},$6Yj:function(n,t,i){_js.Trace.logInfo(_a.$0.$4W,"Starting chat.");_a.$4.$l(n,"basePersonaParticipants");_a.$4.$ou(n.get_$B(),0,"basePersonaParticipants.Count");$6(i)||_a.$4.$Js(n.get_$B(),1,"When imAddress is specified, participant count must be 1.");for(var u=new _js.$Z,l=n.get_$B(),o=0;o<l;o++){var a=n.get_$3q(o);var v=_pc.$i.$1LO(a);u.$D(v)}var r=null;if(u.get_$B()===1){var e=u.get_$3q(0);var f=null;$6(i)?$6(e.get_$A6())||(f=e.get_$A6()):f=i;if(!$6(f)){var s,h;h=_c.$2M.$9x9(this.$uu,f,s={val:r});r=s.val;h}var c=e.get_$1o();if(!_js.$9.$18(f)&&!_js.$9.$18(c)){var y=_h.$84.$ib(f);this.$o3.$6I("StartChat (single participant)",y,c,e.$MI,!0)}}else{var p=this;u.$Bh(function(n){var t=n;var i=t.get_$A6();var r=t.get_$1o();if(!_js.$9.$18(i)&&!_js.$9.$18(r)){var u=_h.$84.$ib(i);p.$o3.$6I("StartChat (multiple participants)",u,r,t.$MI,!0)}})}if(!r){r=$4i4(this,u,t);$4i1(this,r);if(!$6(i)){var w=u.get_$3q(0);r.$9iV(w,i)}}_g.$y.isInstanceOfType(t)?r.set_$5ib(t):_g.$7Z.isInstanceOfType(t)&&r.set_$5ia(t);return r},$3br:function(n){_js.Trace.logInfo(_a.$0.$4W,"Accepting invitation.");this.$B5.$34(n);$4i1(this,n);var t=new _c.$111(n);this.$k.$z(t)},$3xI:function(n){_js.Trace.logInfo(_a.$0.$4W,"Ignoring invitation.");this.$B5.$34(n);this.$3xK.$D(n.get_$RC())},$7Me:function(n){_js.Trace.logInfo(_a.$0.$pc,"Accepting buddy request {0} ",n.get_$1l());var i=$4i8(this,n);var t=new _g.$XQ;t.GroupType="OtherContacts";var r=new _c.$110(i,t);this.$k.$z(r)},$7gi:function(n){_js.Trace.logInfo(_a.$0.$pc,"Ignoring buddy request {0} ",n.get_$1l());this.$hj.$34(n);var t=$4i8(this,n);var i=new _c.$13f(t);this.$k.$z(i)},$9ab:function(n){_js.Trace.logInfo(_a.$0.$4W,"Removing chat {0}",n.get_$RC());n.set_$11e(4);n.get_$Or().remove_$1Z(this.$$d_$9D9);var t=this.$uu.$34(n);var i=this.$B5.$34(n);$6(n.get_$1y())||_h.$1O.get_$I().$dX(n.get_$1y().Id)},$9HO:function(n){if(n.EventType==="Reload"){_js.Trace.logWarning(_a.$0.$4W,"ChatManager.OnIMNotification: Received a 'Reload' notification from the OWA server, assuming server has rebooted or connection re-established");this.$1Sy=!0;$1nU(this,!1);return}var t=n;var i=t.PayloadType;if($6(i)){_js.Trace.logWarning(_a.$0.$4W,"ChatManager.OnIMNotification: Unexpected notification payload: {0}, {1}",n.EventType,n.toString());return}if(i==="ServiceUnavailable"){if(t.ServiceError==="ClientSignOut"){_js.Trace.logWarning(_a.$0.$4W,"ChatManager.OnIMNotification: Service unavailable, client signed out.  {0}",t.ErrorMessage);this.$l3("IMNotification","SignedOut");return}_js.Trace.logWarning(_a.$0.$4W,"ChatManager.OnIMNotification: Received a 'ServiceUnavailable' notification: {0}, {1}.",t.ServiceError,t.ErrorMessage);$1nU(this,!1);return}if(i==="SignOn")if(t.SignOnStarted){_js.Trace.logInfo(_a.$0.$4W,"ChatManager.OnIMNotification: Sign-on started.");return}else{_js.Trace.logInfo(_a.$0.$4W,"ChatManager.OnIMNotification: Sign-on succeeded.");$1nU(this,!0);$6lv(this);this.$5aM=t.IsUserInUcsMode;return}if(i==="UpdateUserPresence"||i==="UserPresenceChange"||i==="QueryUserPresenceChange"){$6lp(this,t);return}this.$o3.$6de(t);!$6(t.Persona)&&$6(t.Persona.ImAddress)&&(t.Persona.ImAddress=t.SipUri);if(t.PayloadType==="PendingContactList"){if($6(t.PendingContacts)){_js.Trace.logWarning(_a.$0.$pc,"The payload for PendingContacts is empty");return}$6ln(this,t.PendingContacts);return}if(t.PayloadType==="AddToBuddyList"){if($6(t.AddedContacts)){_js.Trace.logWarning(_a.$0.$pc,"The payload for AddedContacts is empty");return}$6lx(this,t.AddedContacts)&&_js.Trace.logInfo(_a.$0.$pc,"Removed already added contact from pending buddyRequests");return}if(t.PayloadType==="EmptySubscribers"){$6lo(this);_js.Trace.logInfo(_a.$0.$pc,"Removed already added contact from pending buddyRequests after receiving emptysubscribers");return}if(!("ChatSessionId"in t)){_js.Trace.logInfo(_a.$0.$4W,"Notification {0} not supported, no session id.",i);return}if(this.$3xK.$Mj(t.ChatSessionId)){_js.Trace.logInfo(_a.$0.$4W,"ChatManager.OnIMNotification: {0} for conversation {1} was ignored.",t.PayloadType,t.ChatSessionId);return}_js.Trace.logInfo(_a.$0.$4W,"ChatManager.OnIMNotification: {0}, Session={1}, SipUri={2}",i,t.ChatSessionId,t.SipUri);var r;var u,f,e,o;if((f=_c.$2M.$6ca(this.$uu,t.ChatSessionId,u={val:r}),r=u.val,f)||(o=_c.$2M.$6ca(this.$B5,t.ChatSessionId,e={val:r}),r=e.val,o)){var s=this.$o3.$2w8(t.SipUri,t.DisplayName);$6lw(this,t,r,s);return}_js.Trace.logInfo(_a.$0.$4W,"No matching chat found for session {0}",t.ChatSessionId);$6ly(this,t)},$2o5:function(n){for(var r=n.get_$B(),t=0;t<r;t++){var i=n.get_$3q(t);if(i&&this.$1XR(i.SipUri))return!0}return!1},$1XR:function(n){return _js.$9.$18(n)?!1:_js.$9.$18(this.get_$1rj())?!1:n.toLowerCase()===this.get_$1rj().toLowerCase()?!1:!0},$7eE:function(n){return new _c.$ev(n)},$7h7:function(){this.$l3("DelayInternalSignIn","AttemptingSignIn");_js.$J.get_$I().$1w(_a.$0.$4W,"ChatManager.InternalSignIn",this.$$d_$3yi,3e4)},$4c:function(){this.remove_$3Ig(this.$o3.$$d_$A0O);_js.$8.prototype.$4c.call(this)},$9PY:function(n){_js.Trace.logInfo(_a.$0.$4W,"Sign-in action succeeded.  Awaiting notification.");this.$1l1=_js.$J.get_$I().$1w(_a.$0.$4W,"ChatManager.SignInNotificationTimeout",this.$$d_$9q3,1e4)},$9PX:function(n){_js.Trace.logInfo(_a.$0.$4W,"Sign-in action failed.");var t=n;if(t.get_$gq()===-11){_js.Trace.logInfo(_a.$0.$4W,"Automatic sign-in rejected because the user was explicitly signed out.");this.$l3("Automatic Sign-In Rejected","SignedOut");return}_js.Trace.logWarning(_a.$0.$4W,"Sign-in failed: {0}",t.$1f.message);$1nU(this,!1)},$9q3:function(){_js.Trace.logWarning(_a.$0.$4W,"Sign-in timeout expired.  Current sign-in state: {0}, ServiceAvailable: {1}.",this.$S2,this.$3N7);this.$S2!=="SignedIn"&&$1nU(this,!1)},$9Pb:function(n){_js.Trace.logInfo(_a.$0.$4W,"Sign-out succeeded.");this.$l3("SignOutSucceeded","SignedOut")},$9sk:function(n,t){if(!this.$4YP){_js.Trace.logInfo(_a.$0.$4W,"Subscribed to notifications.");this.$4YP=!0;this.$3yi()}},$3yi:function(){if(!this.$4YP){_js.Trace.logInfo(_a.$0.$4W,"Subscribing to notifications.");this.$ok.$IU(_a.$0.$4W,"OnIMNotification",this.$$d_$9HO,2);return}_js.Trace.logInfo(_a.$0.$4W,"Signing in. Manual: {0}, will retry: {1}",this.$26e,this.$1Sy);var n=new _c.$17f(this.$26e);n.add_$2C(this.$$d_$9PY);n.add_$1x(this.$$d_$9PX);this.$l3("InternalSignIn","AttemptingSignIn");this.$k.$z(n);this.$1l1&&(this.$1l1=_js.$J.get_$I().$4z(this.$1l1))},$9Pa:function(n){_js.Trace.logWarning(_a.$0.$4W,"Sign-out failed: {0}",n.$1f.message);this.$l3("SignOutFailed","SignedOut")},$9NS:function(n){_js.Trace.logInfo(_a.$0.$4W,"Reset presence succeeded.")},$9NR:function(n){_js.Trace.logWarning(_a.$0.$4W,"Reset presence failed: {1}",n.$1f.message)},$7Mb:function(n){var t=n;t.set_$RC(-2);t.$9pR()},$9D9:function(n,t){switch(t.$2v){case 0:var i=t.$2l;var r=$4i7(this,i);this.$2Z0.$54V(r);break;case 2:var u=t.$38;var f=$4i7(this,u);var e=$4i6(this,f);this.$2Z0.$27I(e);break;case 1:case 3:default:_a.$4.$9n(!1,"Unexpected notification received: "+t.$2v);break}},$99K:function(n,t){switch(t.$2v){case 0:var i=t.$2l;var r=$3Vb(this,i);this.$2Z0.$54V(r);break;case 2:var u=t.$38;var f=$3Vb(this,u);var e=$4i6(this,f);this.$2Z0.$27I(e);break;case 1:case 3:default:_a.$4.$9n(!1,"Unexpected notification received: "+t.$2v);break}},$4J9:function(n){if(!n.$5Cf){this.$1Sy=!1;$1nU(this,!1)}}};_c.$E2=function(){this.$$d_$A0O=Function.createDelegate(this,this.$A0O);_c.$E2.initializeBase(this);this.$JD={}};function $4iD(n,t,i){if(!_js.$9.$18(t.SipUri)){$4iC(n,t.PayloadType,t.SipUri,t.DisplayName,i);if(!$6(t.NewUserPresence)){var r=_h.$84.$2Lp(t.NewUserPresence);$4iF(n,t.PayloadType,t.SipUri,r,i)}}}function $4iC(n,t,i,r,u){var f=this;$4iE(n,t,i,u,function(n){_js.$9.$18(r)||n.set_$1o(r)})}function $4iF(n,t,i,r,u){var f=this;$4iE(n,t,i,u,function(n){$6(r)||n.set_$FG(r)})}function $4iE(n,t,i,r,u){i=_h.$84.$ib(i);var f=n.$JD[i];if($6(f)){if(!r)return;f=new _c.$12Y(i);n.$JD[i]=f}u(f)}_c.$E2.prototype={$JD:null,$2aL:function(){var n=this.$JD;for(var t in n){var i={key:t,value:n[t]};var r=i.value;r.set_$FG(0)}},$6de:function(n){$4iD(this,n,!1)},$541:function(n){$4iD(this,n,!0)},$A0O:function(n){this.$6I(n.$2D,n.$bP,n.$7i,n.$MI,n.$3yw)},$6I:function(n,t,i,r,u){$4iC(this,n,t,i,u);$4iF(this,n,t,r,u)},$2w8:function(n,t){var i=t;if(_js.$9.$18(i)&&!_js.$9.$18(n)){n=_h.$84.$ib(n);var r=this.$JD[n];$6(r)||(i=r.$7i);_js.$9.$18(i)&&(i=_h.$84.$fN(n))}return i},$6cb:function(n,t){t.val=0;n=_h.$84.$ib(n);var i=this.$JD[n];if($6(i))return!1;t.val=i.$MI;return!0}};_c.$12Y=function(n){_c.$12Y.initializeBase(this);_a.$4.$1G(n,"sipUri");this.$bP=n};_c.$12Y.prototype={$bP:null,$7i:null,$MI:0,get_$1o:function(){return this.$7i},set_$1o:function(n){if(this.$7i===n)return n;this.$7i=n;$N(this,"DisplayName");return n},get_$FG:function(){return this.$MI},set_$FG:function(n){if(this.$MI===n)return n;this.$MI=n;$N(this,"Presence");return n},toString:function(){return String.format("SipUri: {0}, DisplayName: {1}, Presence: {2}",this.$bP,$6(this.$7i)?"":this.$7i,this.$MI)}};_c.$z6=function(n,t,i){_c.$z6.initializeBase(this,[n,t,i]);_js.Trace.logInfo(_a.$0.$4W,"PopOutPresenceManager.Ctor.")};_c.$z6.prototype={$7eD:function(){return new _c.$1As(this.$1GZ)},$6DM:function(n){$3Ve(this,n.$bP,n.$MI)},$4cl:function(n){this.$1jK.$542(n)},$A0S:function(){}};_c.$1As=function(n){_c.$1As.initializeBase(this,[n]);_js.Trace.logInfo(_a.$0.$4W,"PopOutPresenceRequestsManager.Ctor")};_c.$1As.prototype={$542:function(n){_a.$4.$1G(n,"sipUri");this.$1GZ.$9YS(n)},$9bN:function(n){_a.$4.$1G(n,"sipUri");return!0},$7WH:function(){}};_c.$1B2=function(n,t){_c.$1B2.initializeBase(this,[n]);this.$9c=t};_c.$1B2.prototype={$9c:null,get_$7N2:function(){return"PresenceActivityMonitor"},get_$5Oh:function(){return 24e4},get_$7N4:function(){return 3e5},$3Ez:function(n){_js.Trace.logInfo(_a.$0.$4W,"PresenceActivityMonitor.OnActivityDetected");this.$9c.$2aL()}};_c.$Hc=function(n,t,i){this.$$d_$9HH=Function.createDelegate(this,this.$9HH);this.$$d_$6DM=Function.createDelegate(this,this.$6DM);this.$$d_$9PZ=Function.createDelegate(this,this.$9PZ);this.$hc={};_c.$Hc.initializeBase(this);_a.$4.$J(n,"chatManager");_a.$4.$J(t,"chatParticipantCache");_a.$4.$J(i,"presenceCrossWindowNotifier");this.$9c=n;this.$JD=t;this.$9c.$Y(_c.$2M.$1l2,this.$$d_$9PZ);this.$9c.add_$3Ig(this.$$d_$6DM);this.$1GZ=i;this.$1jK=this.$7eD();this.$1zR=this.$9c.$S2;_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.Ctor.")};function $3Ve(n,t,i){t=_h.$84.$ib(t);if(!(t in n.$hc))return!1;for(var u=n.$hc[t],r=0;r<u.get_$B();r++){var f=u.get_$3q(r);f.set_$FG(i)}return!0}function $4iP(n,t,i){if(!n.$9c.get_$2n())return!1;t.rpcl("ImAddress",n.$$d_$9HH);if(_js.$9.$18(i))return!1;var r=_h.$84.$ib(i);if(!(r in n.$hc))return!1;var u=n.$hc[r];var f=u.$34(t);if(!u.get_$B()){delete n.$hc[r];n.$1jK.$9bN(r)}return f}function $6mQ(n,t,i){t in n.$hc||(n.$hc[t]=new(_a.$W.$$(_h.$pu)));var r=n.$hc[t];if(!r.$7G(i)){r.$D(i);r.get_$B()>1?i.set_$FG(r.get_$3q(0).get_$FG()):n.get_$xN()||i.set_$FG(0)}}_c.$Hc.prototype={$9c:null,$JD:null,$1GZ:null,$1jK:null,$1zR:"unknown",get_$xN:function(){return this.$9c.$S2==="SignedIn"},$6ce:function(n){_a.$4.$J(n,"persona");if(!this.$9c.get_$2n())return!1;_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.TryRegisterForPresenceUpdates: Registering persona for presence updates: {0}, SIP:{1}",n.get_$6G(),n.get_$A6()||"");n.apcl("ImAddress",this.$$d_$9HH);if(_js.$9.$18(n.get_$A6()))return!0;var t=_h.$84.$ib(n.get_$A6());$6mQ(this,t,n);this.$4cl(t);return!0},$4bq:function(n){_a.$4.$J(n,"persona");_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.TryUnregisterForPresenceUpdates: Unregistering persona for presence updates: {0}, SIP:{1}",n.get_$6G(),n.get_$A6()||"");return $4iP(this,n,n.get_$A6())},$9YR:function(n,t){_a.$4.$1G(n,"sipUri");this.$4cl(n);t.val=0;if(n in this.$hc){var i=this.$hc[n];if(i.get_$B()>0){t.val=i.get_$3q(0).get_$FG();return!0}}return!1},$7eD:function(){return new _c.$MR(this.$1GZ)},$4cl:function(n){if(this.get_$xN()){var t;var i,r;(r=this.$JD.$6cb(n,i={val:t}),t=i.val,r)&&$3Ve(this,n,t);n!==_h.$84.$ib(this.$9c.get_$1rj())&&this.$1jK.$542(n)}},$6DM:function(n){if(this.get_$xN()){$3Ve(this,n.$bP,n.$MI);this.$1GZ.$6eH(n.$bP,n.$MI)}},$A0S:function(){this.$1GZ.$A15(this.$1zR)},$4c:function(){_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.InternalDispose.");this.$9c.$u(_c.$2M.$1l2,this.$$d_$9PZ);this.$9c.remove_$3Ig(this.$$d_$6DM);this.$1jK.$1Q();this.$1jK=null},$9PZ:function(n,t){var c=n;var i=this.$1zR;var l=i==="SignedIn";this.$1zR=c.$S2;var u=this.get_$xN();if(l!==u)if(u){_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Requesting presence for every persona active.",i,this.$1zR);var s=this.$hc;for(var h in s){var v={key:h,value:s[h]};var y=v.key;this.$4cl(y)}}else{_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Resetting presence to Unknown everywhere.",i,this.$1zR);var f=this.$hc;for(var e in f)for(var a={key:e,value:f[e]},o=a.value,r=0;r<o.get_$B();r++)o.get_$3q(r).set_$FG(0);this.$1jK.$7WH();this.$JD.$2aL()}this.$A0S()},$9HH:function(n,t){var i=n;var r=null;var u=this.$hc;for(var f in u){var e={key:f,value:u[f]};var o=e.key;var s=e.value;if(s.$7G(i)){r=o;break}}_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.OnImAddressChangedForAPersona: Unregistering persona {0} for old IM Address {1}",i.get_$6G(),r);$4iP(this,i,r);_js.Trace.logInfo(_a.$0.$FG,"PresenceManager.OnImAddressChangedForAPersona: Re-registering persona {0} for new IM Address {1}",i.get_$6G(),$6(i.get_$A6())?"":i.get_$A6());this.$6ce(i)}};_c.$MR=function(n){this.$$d_$9Qg=Function.createDelegate(this,this.$9Qg);this.$$d_$9GG=Function.createDelegate(this,this.$9GG);this.$$d_$9LB=Function.createDelegate(this,this.$9LB);this.$o4=new(_a.$W.$$(String));_c.$MR.initializeBase(this);_a.$4.$l(n,"presenceCrossWindowNotifier");this.$1GZ=n;this.$o4.add_$1Z(this.$$d_$9LB);_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.Ctor")};function $4iQ(n){if(n.$1pi){_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.CancelBatchGetPresenceRequestsTimer.");n.$1pi=_js.$J.get_$I().$4z(n.$1pi)}}_c.$MR.prototype={$1GZ:null,$1pi:null,$542:function(n){_a.$4.$1G(n,"sipUri");if(!this.$o4.$7G(n)){_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.AddOrUpdatePendingGetRequests: Queuing a presence retrieval request for sip {0}",n);this.$o4.$D(n)}},$9bN:function(n){_a.$4.$1G(n,"sipUri");return this.$o4.$34(n)},$7WH:function(){_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.ClearAll: Clearing all pending get presence requests: {0}",this.$o4.get_$B());this.$o4.$1r()},$4c:function(){_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.InternalDispose.");$4iQ(this)},$9Qg:function(){this.$1pi=null;var n=this.$o4.$6Z();var i=n.join("; ");this.$o4.$1r();var t=new _c.$165(n);t.add_$2m(this.$$d_$9GG);OwaApplication.$1W.$z(t)},$9LB:function(n,t){if(this.$o4.get_$B()>0){if(!this.$1pi){_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Activating timer to run after {0}ms. Current count of pending requests = {1}",_c.$MR.$4ae,this.$o4.get_$B());this.$1pi=_js.$J.get_$I().$1w(_a.$0.$FG,"GetPresence",this.$$d_$9Qg,_c.$MR.$4ae)}}else{_js.Trace.logInfo(_a.$0.$FG,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Cancelling timer. Current count of pending requests = {0}",this.$o4.get_$B());$4iQ(this)}},$9GG:function(n){var t=n;var i=t.$1U8.join("; ");if(t.$1f){_js.Trace.logWarning(_a.$0.$FG,"PresenceRequestsManager.OnGetPresenceActionCompleted: Failed with {0} for {1} SipUris: '{2}'",t.$1f,this.$o4.get_$B(),i);return}}};_c.$ev=function(n){this.$$d_$9R3=Function.createDelegate(this,this.$9R3);this.$$d_$4Kr=Function.createDelegate(this,this.$4Kr);this.$$d_$9Q6=Function.createDelegate(this,this.$9Q6);this.$k=n;this.$1m0=new(_0365f.$o.$$(String));this.$1og=new(_0365f.$o.$$(String));this.$1Us=new(_0365f.$o.$$(String))};function $4iR(n){if(n.$1Us.get_$B()&&!n.$3dQ){n.$3dQ=!0;var t=n.$1Us.get_$3q(0);n.$1Us.$68(0);n.$1og.$34(t);var i=new _c.$1Em(t);i.add_$2m(n.$$d_$9R3);n.$k.$z(i)}}_c.$ev.prototype={$k:null,$1m0:null,$1og:null,$1Us:null,$3dQ:!1,$54V:function(n){for(var i=new(_0365f.$o.$$(String)),f=n.get_$3T(),e=f.length,r=0;r<e;++r){var t=f[r];if(this.$1Us.$7G(t)){this.$1Us.$34(t);continue}this.$1og.$7G(t)||this.$1m0.$7G(t)||i.$7G(t)||i.$D(t)}if(i.get_$B()>0){this.$1m0.$69(i.get_$3T());var u=new _c.$1DH(i.get_$3T());u.add_$2C(this.$$d_$9Q6);u.add_$1x(this.$$d_$4Kr);this.$k.$z(u)}},$27I:function(n){for(var i=0;i<n.get_$B();i++){var t=n.get_$3q(i);if(this.$1m0.$7G(t)){this.$1m0.$34(t);continue}this.$1Us.$7G(t)||this.$1og.$7G(t)&&this.$1Us.$D(t)}$4iR(this)},$9R3:function(n){this.$3dQ=!1;$4iR(this)},$9Q6:function(n){for(var u=n,r=u.$1U8,f=r.length,t=0;t<f;++t){var i=r[t];this.$1og.$7G(i)||this.$1og.$D(i);this.$1m0.$34(i)}_js.Trace.logInfo(_a.$0.$4W,"SubscribeForPresenceUpdates: succeeded.")},$4Kr:function(n){for(var i=n,r=i.$1U8,u=r.length,t=0;t<u;++t){var f=r[t];this.$1m0.$34(f)}var e=i.$1U8.join(";");_js.Trace.logInfo(_a.$0.$4W,"SubscribeForPresenceUpdates: failed to subscribe for: {0}.",e)}};_c.$rf=function(n,t,i,r,u){_a.$4.$1G(n,"source");_a.$4.$1G(t,"sipUri");this.$2D=n;this.$bP=t;this.$7i=i;this.$MI=r;this.$3yw=u};_c.$rf.prototype={$2D:null,$bP:null,$7i:null,$MI:0,$3yw:!1,toString:function(){return String.format("Source: {0}, Sip: {1}, DisplayName: {2}, Presence: {3}, IsAboutMeOrMyBuddy: {4}",this.$2D,this.$bP,$6(this.$7i)?"":this.$7i,this.$MI,this.$3yw)}};_c.$z0=function(n){_c.$z0.initializeBase(this,[n,null])};_c.$z0.prototype={get_$1b:function(){return _a.$0.$4Nm},$6B4:function(n){var t=n;this.$mz=!0;return new _c.$14i(t.get_$gq())},$1wf:function(){return _c.$Km.$5EY("")}};_c.$1A0=function(){_c.$1A0.initializeBase(this)};_c.$1A0.prototype={$184:null};_c.$1Eb=function(){_c.$1Eb.initializeBase(this)};_c.$1Eb.prototype={$ow:null,$1Aw:null};_c.$10t=function(){_c.$10t.initializeBase(this)};_c.$10t.prototype={$2KO:0,$2KP:null,$2O0:null,$rP:!1,$1yd:!1,$8B:null,get_$3qW:function(){return this.$2KO},set_$3qW:function(n){if(n===this.$2KO)return n;this.$2KO=n;$3(this,"ExternalAudience");return n},get_$5MM:function(){return this.$2KP},set_$5MM:function(n){if(n===this.$2KP)return n;this.$2KP=n;$3(this,"ExternalReply");return n},get_$5Yr:function(){return this.$2O0},set_$5Yr:function(n){if(n===this.$2O0)return n;this.$2O0=n;$3(this,"InternalReply");return n},get_$1y8:function(){return this.$rP},set_$1y8:function(n){if(n===this.$rP)return n;this.$rP=n;$3(this,"IsOofOn");return n},get_$5dw:function(){return this.$1yd},set_$5dw:function(n){if(n===this.$1yd)return n;this.$1yd=n;$3(this,"IsScheduled");return n},get_$12i:function(){return this.$8B},set_$12i:function(n){if(n===this.$8B)return n;this.$8B=n;$3(this,"EndTime");return n}};_c.$12w=function(){_c.$12w.initializeBase(this)};_c.$12w.prototype={$j1:!1,get_$338:function(){return this.$j1},set_$338:function(n){if(this.$j1===n)return n;this.$j1=n;$3(this,"IsSyncContactsToDeviceEnabled");return n}};_c.$1Ar=function(){};_c.$1Ar.prototype={$E:function(n,t,i){return new _c.$eo(n,t,new _g.$AA(i),i,_g.$1U.$MG)}};_c.$eo=function(n,t,i,r,u){_c.$eo.initializeBase(this,[null,n,t,i,r]);this.$MG=u};_c.$eo.prototype={$MG:null,get_$3U2:function(){return this.$MG},$2HU:function(n,t,i){},$2HV:function(n,t,i){},$qi:function(n){return n},$2th:function(n,t,i,r,u){_js.Trace.logInfo(_c.$eo.$A,"ExecuteWithActionQueue {0}",n);this.$MG.$2th(n,t,i,r,u);return}};_c.$Ge=function(){_c.$Ge.initializeBase(this)};_c.$Ge.prototype={get_$ob:function(){return this.$U(_c.$Ge.$4VX)},set_$ob:function(n){this.$K(_c.$Ge.$4VX,n);return n},get_$5Ja:function(){return this.$U(_c.$Ge.$3oH)},set_$5Ja:function(n){this.$K(_c.$Ge.$3oH,n);return n}};_c.$12Q=function(n,t,i,r){_c.$12Q.initializeBase(this,[t,i,r]);_js.$4.$l(n,"calendar");this.$Bb=n};_c.$12Q.prototype={$Bb:null,get_$1k:function(){return this.$Bb}};_c.$C9=function(n,t,i,r,u,f){this.$$d_$9KU=Function.createDelegate(this,this.$9KU);this.$$d_$9KV=Function.createDelegate(this,this.$9KV);this.$$d_$9Ee=Function.createDelegate(this,this.$9Ee);this.$$d_$9OP=Function.createDelegate(this,this.$9OP);this.$3QR=new _c.$C9.$9g1;this.$1jH={};_c.$C9.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_c.$C9.initializeBase(this);this.$TS=_c.$C9.$7qX();this.$fy=u;this.$2L=r;this.$2L&&this.$2L.$9fx(this.$TS);this.$fv=f;this.$xa=n;_js.Trace.logInfo(_a.$0.$N2,"Instantiating InstantSearchSession. ItemType {0}, Mailbox:{1}, LoggedInUser:{2}",_g.$x8.toString(n),u||"empty",f||"empty");if(!i)throw Error.argumentNull("folderScope");this.$5Fw=i;this.$1UO=t;$6mL(this)};_c.$C9.$iV=function(n){return!n||!n.$1f||_js.$9.$18(n.$1f.message)?"General Failure":n.$1f.message};_c.$C9.$7qX=function(){return _c.$C9.$1aW()+_c.$C9.$1aW()+"-"+_c.$C9.$1aW()+"-"+_c.$C9.$1aW()+"-"+_c.$C9.$1aW()+"-"+_c.$C9.$1aW()+_c.$C9.$1aW()};_c.$C9.$1aW=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)};function $6mL(n){var t=new _g.$At;t.NotificationType="InstantSearchNotification";t.ChannelId=_a.$1x.$hs;if(n.$fy){n.$1Fp=new _h.$IN(t,null,null,n.$fy,n.$fv);n.$1Fp.add_$4YM(n.$$d_$9KU)}else n.$1Fp=new _h.$BS(t);n.$1Fp.$IU(_a.$0.$Aw,"InstantSearchNotificationStrategy",n.$$d_$9KV,2);n.$1Fp.$14K&&n.set_$rT(!0)}function $6mK(n){n.$N5&&n.$5SQ("")}_c.$C9.prototype={$1UO:null,$TS:null,$1Fp:null,$xa:0,$fy:null,$fv:null,$N5:!1,$ew:null,$5Fw:null,$2L:null,get_$rT:function(){return this.$N5},set_$rT:function(n){if(this.$N5!==n){this.$N5=n;$6mK(this);$N(this,"IsReady")}return n},$7bR:function(n,t){var f=[t.get_$A5()];var i=_c.$AW.$7bQ(this.$TS,f,n,this.$fy,this.$fv);this.$1UO.$54O(n);var r=new _c.$Bo(this.$TS,i.$DH);var u=new _c.$12Q(t,i,r,this.$2L);this.$ew=u;this.$1jH[i.$DH.SearchRequestId.toString()]=r;return u},$7dX:function(n,t,i,r){if(!t)throw Error.argumentNull("folderScope");if(_js.Trace.$2t){_js.Trace.logInfo(_a.$0.$N2,"PerformSearch QS: {0}",n);if(i&&i.RefinerQueries&&i.RefinerQueries.length>0)for(var e=i.RefinerQueries,s=e.length,u=0;u<s;++u){var h=e[u];_js.Trace.logInfo(_a.$0.$N2,"Refiner: {0}",h)}_js.Trace.logInfo(_a.$0.$N2,"FolderId: {0}",t.Id);_js.Trace.logInfo(_a.$0.$N2,"DateRestriction: {0}",r)}this.$1UO.$54O(n);var f=_c.$AW.$7dW(this.$TS,t,n,this.$xa,i,r,this.$fy,this.$fv);var o=new _c.$Bo(this.$TS,f.$DH);this.$ew=new _c.$Jn(f,o,this.$2L);this.$1jH[f.$DH.SearchRequestId.toString()]=o;return this.$ew},$5SQ:function(n){_js.Trace.logInfo(_a.$0.$N2,"Retrieving search subscriptions. SessionId: {0} QueryString: {1}",this.$TS,n);var i=this.$1UO.$5Sl(n);if(this.$3QR.$9mV(n)){_js.Trace.logInfo(_a.$0.$N2,"Making GetSuggestions Server Call for  SessionId: {0} QS: {0}",this.$TS,n);var t=_c.$AW.$7ej(this.$TS,this.$5Fw,n,this.$xa,this.$fy,this.$fv);this.$3QR.$9Zz(t.$DH.SearchRequestId,n);this.$1jH[t.$DH.SearchRequestId.toString()]=new _c.$Bo(this.$TS,t.$DH);t.add_$1x(this.$$d_$9OP);OwaApplication.$1W.$z(t)}return i},$5L4:function(){var n=new _c.$14P(this.$TS,this.$fy,this.$fv);n.add_$2C(this.$$d_$9Ee);OwaApplication.$1W.$z(n);this.$1Fp.$2fQ(this.$$d_$9KV);_h.$IN.isInstanceOfType(this.$1Fp)&&this.$1Fp.remove_$4YM(this.$$d_$9KU);this.$1Fp=null;this.$2L&&this.$2L.$9fw(this.$TS)},$7t3:function(){var n=new(_0365f.$o.$$(_c.$Bo));var t=this.$1jH;for(var i in t){var r={key:i,value:t[i]};n.$D(r.value)}return n.$6Z()},$9OP:function(n){_js.Trace.logWarning(_a.$0.$N2,"GetSearchSuggestion action failed: "+_c.$C9.$iV(n))},$9Ee:function(n){var r=n;if(r){var t=r.get_$gq().RequestIds;var u=r.get_$gq().SearchPathSnapshots;if(!u||!t){_js.Trace.logWarning(_a.$0.$N2,"No diagnostic data from EndSearchSession retrieved");return}for(var e=t.length,i=0;i<t.length;i++){var f=this.$1jH[t[i].toString()];f?f.$4R0=u[i]:_js.Trace.logWarning(_a.$0.$N2,"No requestID found")}}this.$1Q()},$9KU:function(n,t){this.set_$rT(!0)},$9KV:function(n){if(n){var e=n;var t=e.InstantSearchPayload;if(t&&t.SearchSessionId===this.$TS){if(t.ResultType&1){var u=this.$3QR.$7wo(t.SearchRequestId);u?this.$1UO.$5kY(u,t.SearchSuggestions):_js.Trace.logWarning(_a.$0.$N2,"QueryString was null");return}var i=this.$1jH[t.SearchRequestId.toString()];if(this.$ew&&this.$ew.get_$6Qu()===t.SearchRequestId){((t.ResultType&1)==1||(t.ResultType&2)==2||(t.ResultType&4)==4||(t.ResultType&128)==128)&&$2gi(i,"ReceivedSearchResultsNotification");if(!this.$ew.$dv.get_$42y()){if((t.ResultType&2)==2||(t.ResultType&4)==4||(t.ResultType&128)==128){$6mD(this.$ew,t);$2gj(i,"Results",t.PerfMarkers)}if((t.ResultType&8)==8){$6mC(this.$ew,t);$2gj(i,"Refiners",t.PerfMarkers)}if((t.ResultType&16)==16){$6mE(this.$ew,t);$2gj(i,"SearchTerms",t.PerfMarkers)}t.QueryProcessingComplete&&$6mF(this.$ew,t)}}if((t.ResultType&32)==32){$6mH(i,t.Errors);$2gj(i,"Errors",t.PerfMarkers);for(var f=t.Errors,o=f.length,r=0;r<o;++r){var s=f[r];_js.Trace.logError(_a.$0.$N2,"Error Notification received from server {0}.",s)}}(t.ResultType&64)==64&&(i.$4P9=t.QueryStatistics)}}}};_c.$C9.$9g1=function(){this.$3ME={};this.$4R5={}};_c.$C9.$9g1.prototype={$9mV:function(n){if(n in this.$3ME){var t=(new Date).getTime();var i=this.$3ME[n];return i<t-3e4}return!0},$9Zz:function(n,t){var i=(new Date).getTime();this.$4R5[n.toString()]=t;this.$3ME[t]=i},$7wo:function(n){return this.$4R5[n.toString()]}};_c.$Jn=function(n,t,i){this.$$d_$9LK=Function.createDelegate(this,this.$9LK);_c.$Jn.initializeBase(this);this.$q9=t;this.$2L=i;$2gi(t,"SearchInitiated");this.$2v=n;this.$2v.add_$1x(this.$$d_$9LK);this.$6MH=new _c.$1Bz;this.$dv=new _c.$Jn.$2Nz;$6mB(this)};function $6mD(n,t){_a.$6.$1E(n.$6Ot,"InstantSearchResultsTime");if(n.$30N)throw Error.invalidOperation("InstantSearchContext already disposed");if(!n.$dv.get_$32m()){n.$zl.$5kY(t);n.$2L&&n.$2L.$6Qx(n.$q9.$TS,n.$2v.$DH.SearchRequestId,n.$zl.get_$B());n.$1TN.$99Y();n.$dv.$6Qx();n.$1TN.$6Dt();n.$q9.$4Rp=n.$zl.get_$B();$2gi(n.$q9,"PerfStringRenderingComplete")}}function $6mC(n,t){_a.$6.$1E(n.$6MI,"InstantSearchRefinerTime");if(n.$30N)throw Error.invalidOperation("InstantSearchContext already disposed");if(!n.$dv.get_$32m()){n.$dv.$9ZX();n.$6MH.$9ZU=t.RefinerData;var u="";if(t.RefinerData)for(var f=t.RefinerData,s=f.length,i=0;i<s;++i){var r=f[i];var e=r.RefinerCategory;var o=r.RefinerDataEntryTypes?r.RefinerDataEntryTypes.length:0;$6mI(n.$q9,e,o);u+=_g.$lC.toString(e)+":"+o+";"}n.$2L&&n.$2L.$9fr(n.$q9.$TS,n.$2v.$DH.SearchRequestId,u);n.$6MG=t.RefinerData}}function $6mE(n,t){if(n.$30N)throw Error.invalidOperation("InstantSearchContext already disposed");if(!n.$dv.get_$32m()&&t.SearchTerms&&t.SearchTerms.length){for(var u=[],f=t.SearchTerms,e=f.length,i=0;i<e;++i){var o=f[i];var r=new _g.$X7;r.Scope="SearchAllIndexedProps";r.Value=o;Array.add(u,new _g.$Qs(r))}_h.$24.$HT=u}}function $6mF(n,t){var i=null;t.Errors&&t.Errors.length>0&&(i=t.Errors[0]);_a.$6.$1E(n.$5L3,"InstantSearchCallCompleteTime",i);n.$2L&&n.$2L.$9fs(n.$q9.$TS,n.$2v.$DH.SearchRequestId,!i);n.$dv.$9fg();$6mJ(n.$q9,n.$2v);n.$zl.get_$B()>0&&$JB(n,"NewServerRefinersAvailable",n.$6MG)}function $6mG(n){n.$dv.$8IY();_js.Trace.logWarning(_a.$0.$N2,"Search timed out");n.$1TN.$4Kf()}function $6mB(n){switch(n.$2v.$DH.ItemType){case 2:n.$zl=new _c.$sJ;n.$1TN=new _c.$1C1(n.$zl,n.$dv);break;case 3:n.$zl=new _c.$Px;n.$1TN=new _c.$1C0(n.$zl,n.$dv);break;case 1:n.$zl=new _c.$sK;n.$1TN=new _c.$1C2(n.$zl,n.$dv);break;default:throw Error.argumentOutOfRange("itemShape");}}_c.$Jn.prototype={$dv:null,$6MH:null,$1TN:null,$2v:null,$zl:null,$30N:!1,$q9:null,$6Ot:null,$6MI:null,$5L3:null,$2L:null,$6MG:null,add_$9ZV:function(n){this.$2N("NewServerRefinersAvailable",n)},remove_$9ZV:function(n){this.$2P("NewServerRefinersAvailable",n)},get_$6Qy:function(){return this.$1TN},get_$tp:function(){return this.$dv},$6Hc:function(){$2gi(this.$q9,"ActionSubmittalTime");this.$2L&&this.$2L.$9ft(this.$q9.$TS,this.get_$6Qu(),this.$2v.$DH.KqlQuery);this.$dv.$9g2();_js.$J.get_$I().$17w(_a.$0.$N2,"InstantSearch");_js.Trace.logInfo(_a.$0.$N2,"Started new task runner context before starting search.");OwaApplication.$1W.$z(this.$2v);this.$6Ot=_a.$6.$1c(_a.$0.$N2,"InstantSearchResultsTime",!0);this.$6MI=_a.$6.$1c(_a.$0.$N2,"InstantSearchRefinerTime",!0);this.$5L3=_a.$6.$1c(_a.$0.$N2,"InstantSearchCallCompleteTime",!0);var n=this;_js.$J.get_$I().$1w(_a.$0.$N2,"InstantSearchContext::PerformSearch",function(){n.$dv.get_$1ye()&&$6mG(n)},2e4)},get_$6Qu:function(){return this.$2v.$DH.SearchRequestId},$4c:function(){this.$zl.$1Q();this.$30N=!0;_js.$8.prototype.$4c.call(this)},$9LK:function(n){this.$dv.$5jF();_js.Trace.logWarning(_a.$0.$N2,"PerformInstantSearch action failed: "+_c.$C9.$iV(n));this.$1TN.$4Kf()}};_c.$Jn.$2Nz=function(){_c.$Jn.$2Nz.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_c.$Jn.$2Nz.initializeBase(this);this.set_$4S(1)};_c.$Jn.$2Nz.prototype={$7d:0,get_$1ye:function(){return this.get_$4S()===2||this.get_$4S()===4},get_$3dv:function(){return this.get_$4S()===3||this.get_$4S()===6||this.get_$4S()===7||this.get_$4S()===5},get_$42y:function(){return this.get_$4S()===6},get_$32m:function(){return this.get_$4S()===6||this.get_$4S()===7},get_$4S:function(){return this.$7d},set_$4S:function(n){if(this.$7d!==n){this.$7d=n;$uo(this,_c.$Jn.$2Nz.$5GN)}return n},$9g2:function(){this.set_$4S(2)},$9fg:function(){this.set_$4S(5)},$6Qx:function(){this.get_$4S()===2?this.set_$4S(3):this.get_$4S()===4&&this.set_$4S(5)},$9ZX:function(){this.get_$4S()===2?this.set_$4S(4):this.get_$4S()===3&&this.set_$4S(5)},$8IY:function(){this.set_$4S(6)},$5jF:function(){this.set_$4S(7)}};_c.$Bo=function(n,t){this.$1Kr={};this.$4UP={};this.$3pm=new(_0365f.$o.$$(String));this.$4Pr={};this.$TS=n;this.$5YS=t};function $2gi(n,t){n.$1Kr[t]=(new Date).getTime()}function $6mJ(n,t){var f=n.$1Kr.SearchInitiated;var e=n.$1Kr.ActionSubmittalTime;var i=t.$4e0;var r=n.$1Kr.ReceivedSearchResultsNotification;var u=n.$1Kr.PerfStringRenderingComplete;_js.Trace.logInfo(_a.$0.$N2,"EndtoEnd: {0}mS. TimeInQ: {1}mS. TimeBetweenMethodInvocationAndNotification: {2}msS. TimeBetweenNotificationAndRendering: {3}mS.",u-f,i-e,r-i,u-r)}function $6mH(n,t){n.$3pm.$69(t)}function $2gj(n,t,i){n.$4UP[t]=i}function $6mI(n,t,i){n.$4Pr[_g.$lC.toString(t)]=i}_c.$Bo.prototype={$4P9:null,$TS:null,$5YS:null,$4Rp:0,$4R0:null,get_$4Ud:function(){return this.$TS},get_$1Ss:function(){return this.$5YS},get_$7Wg:function(){return this.$1Kr},set_$7Wg:function(n){this.$1Kr=n;return n},get_$7mC:function(){return this.$3pm.$6Z()},get_$9hr:function(){return this.$4UP},get_$9YT:function(){return this.$4P9},set_$9YT:function(n){this.$4P9=n;return n},get_$9di:function(){return this.$4Rp},set_$9di:function(n){this.$4Rp=n;return n},get_$9cE:function(){return this.$4R0},set_$9cE:function(n){this.$4R0=n;return n},get_$9ZT:function(){return this.$4Pr}};_c.$sJ=function(){_c.$sJ.initializeBase(this)};_c.$sJ.prototype={$5kY:function(n){for(var r=n.Conversations,f=r.length,t=0;t<f;++t){var u=r[t];var i=new _g.$7Z(u);i.set_$r(new _g.$7P("inbox"));i.set_$Xe(u.GlobalMessageCount||2);this.$HR.$D(i)}},$1Kn_2:function(){this.$HR.$1r()}};_c.$Px=function(){_c.$Px.initializeBase(this)};_c.$Px.$vU=function(n,t){return _c.$Px.$5By(n.get_$y(),t.get_$y())};_c.$Px.$5By=function(n,t){return t.$2R(n)};function $6mR(n,t){return new _g.$33(t)}_c.$Px.prototype={$5kY:function(n){this.$HR.$1r();for(var i=n.CalendarItems,r=i.length,t=0;t<r;++t){var u=i[t];var f=$6mR(this,u);this.$HR.$D(f)}},$7o8:function(n){if(!this.$HR.get_$B())return 0;var t=this;return _0365f.$F4.$2Ki(function(n){return t.$HR.get_$3q(n).get_$y()},n,_c.$Px.$5By,0,this.$HR.get_$B()-1)},$7bV:function(){return new _a.$RL(_c.$Px.$vU)},$1Kn_2:function(){this.$HR.$1r()}};_c.$1K7=function(){_c.$1K7.initializeBase(this);this.$HR=this.$7bV()};_c.$1K7.prototype={$HR:null,get_$B:function(){return this.$HR.get_$B()},$6N9:function(n){return this.$HR.$34(n)},$7xH:function(n,t){if(t<0||n+t>this.$HR.get_$B())throw Error.argumentOutOfRange("resultCount");if(!t)return new Array(0);for(var r=new Array(t),i=0;i<t;i++)r[i]=this.$HR.get_$3q(i+n);return r},$7bV:function(){return new _js.$Z},$4c:function(){this.$1Kn_2();_js.$8.prototype.$4c.call(this)}};_c.$sK=function(){_c.$sK.initializeBase(this)};function $6mS(n,t){var r=t.ItemId.Id;var i=_h.$1O.get_$I().$3x(r);if(i)_h.$1O.get_$I().$lC(r);else{i=_g.$y.$E(t);_h.$1O.get_$I().$IX(r,i)}return i}_c.$sK.prototype={$5kY:function(n){for(var i=n.Items,r=i.length,t=0;t<r;++t){var u=i[t];var f=$6mS(this,u);this.$HR.$D(f)}},$1Kn_2:function(){for(var n=0;n<this.$HR.get_$B();n++){var t=this.$HR.get_$3q(n);_h.$1O.get_$I().$dX(t.get_$i().Id)}this.$HR.$1r()}};_c.$1Bz=function(){};_c.$1Bz.prototype={$9ZU:null};_c.$FZ=function(){this.$HR={};this.$HR={}};_c.$FZ.$8JZ=function(n,t){if(!n||!n.length)return t;if(!t||!t.length)return n;for(var i={},f=n,a=f.length,r=0;r<a;++r){var e=f[r];i[e.SuggestedQuery]=e}for(var o=t,v=o.length,u=0;u<v;++u){var s=o[u];i[s.SuggestedQuery]=s}var h=[];var c=i;for(var l in c){var y={key:l,value:c[l]};Array.add(h,y.value)}return h};_c.$FZ.$2RW=function(n,t,i){if(_js.Trace.$2t&&i&&!(i.length<=0))for(var e=[],f=i,o=f.length,r=0;r<o;++r){var u=f[r];Array.add(e,String.format("{0}:{1}:{2}",u.SuggestedQuery,u.Weight,u.SuggestionSource))}};_c.$FZ.$7XR=function(n,t){var i=n;var r=t;return i.Weight===r.Weight?0:i.Weight>r.Weight?-1:1};function $4iS(n,t,i){t||(t="");var r=n.$HR[t.toUpperCase()];_c.$FZ.$2RW("DataInCache: ",t,r);_c.$FZ.$2RW("NewData: ",t,i);var u=_c.$FZ.$8JZ(r,i);_c.$FZ.$2RW("MergedData: ",t,u);n.$HR[t.toUpperCase()]=u}_c.$FZ.prototype={$3MD:null,get_$9g0:function(){return this.$3MD},set_$9g0:function(n){this.$3MD=n;return n},$5kY:function(n,t){_c.$FZ.$2RW("New SearchSuggestions Received From Server: ",n,t);if(t&&t.length>0){$4iS(this,n,t);this.$3MD&&this.$3MD(n,this.$5Sl(n))}},$54O:function(n){var i=n.length;if(i&&!(i>=35))for(var r=0;r<i;r++){var u=n.substr(0,r+1);var t=new _g.$fd;t.SuggestedQuery=n;t.SuggestionSource=1;t.Weight=1;$4iS(this,u,[t])}},$5Sl:function(n){n||(n="");var t=this.$HR[n.toUpperCase()];if(!t||!t.length)return null;t.sort(_c.$FZ.$7XR);_c.$FZ.$2RW(String.format("Returning {0} results from cache",t.length),n,t);for(var i=[],f=t,e=f.length,r=0;r<e;++r){var u=f[r];u.SuggestionSource&1?Array.add(i,new _h.$sL(3,u.SuggestedQuery)):Array.add(i,new _h.$sL(4,u.SuggestedQuery))}return i}};_c.$1C0=function(n,t){_c.$1C0.initializeBase(this,[n,t])};_c.$1C0.prototype={$5S1:function(n){if(_h.$lf.isInstanceOfType(n)){var t=n;if(_g.$lg.isInstanceOfType(t.$2HD)){var r=_a.$7.$42(t.$2HD.$2bE);var i=this.$HR.$7o8(r);this.$1TQ=i;this.$10g=!0;i+=t.$8o;return new _h.$8R(i,t.$Dl)}throw Error.invalidOperation("loadRowsArg.Condition");}return _c.$D3.prototype.$5S1.call(this,n)},$99U:function(n){},$6DX:function(n){}};_c.$1C1=function(n,t){this.$$d_$3FM=Function.createDelegate(this,this.$3FM);_c.$1C1.initializeBase(this,[n,t]);if(!_c.$sJ.isInstanceOfType(n))throw Error.argumentType("resultsCache",Object.getType(n),_c.$sJ);};_c.$1C1.prototype={$99U:function(n){var t=n;t.add_$t1(this.$$d_$3FM)},$6DX:function(n){var t=n;t.remove_$t1(this.$$d_$3FM)},$3FM:function(n,t){var i=n;if(i){this.$Y2.$34(i);this.$HR.$6N9(i)}}};_c.$1C2=function(n,t){this.$$d_$4Jv=Function.createDelegate(this,this.$4Jv);_c.$1C2.initializeBase(this,[n,t])};_c.$1C2.prototype={$99U:function(n){var t=n;_h.$1O.get_$I().$1AS.$1W8(t.get_$i().Id,2,this.$$d_$4Jv)},$6DX:function(n){var t=n;_h.$1O.get_$I().$1AS.$1j9(t.get_$i().Id,2,this.$$d_$4Jv)},$4Jv:function(n,t){var i=n;if(i){this.$Y2.$34(i);this.$HR.$6N9(i)}}};_c.$1KL=function(n,t){_c.$1KL.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_c.$1KL.initializeBase(this,[n,t])};_c.$1KL.prototype={$1SK:!1,get_$9z:function(){return"All"},get_$AR:function(){return"All"},get_$6JU:function(){return this.$1SK},set_$6JU:function(n){this.$1SK=n;return n},$6Dt:function(){_c.$D3.prototype.$6Dt.call(this);this.$OQ(new _h.$8R(0,25));$N(this,"SearchStateChanged")},$4Kf:function(){_c.$D3.prototype.$4Kf.call(this);$N(this,"SearchStateChanged")},$mP:function(n){return new Array(0)},$2Lk:function(n,t){return new Array(0)},$5Qs:function(n){return new Array(0)},$3Pt:function(n,t){},$1Zk:function(n,t){},$9Xa:function(n,t){},$7Ou:function(n,t){},$5jK:function(n){}};_c.$D3=function(n,t){this.$RB=0;_c.$D3.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$u;_c.$D3.initializeBase(this);this.$HR=n;this.$Y2=new(_0365f.$FC.$$(_0365m.$Or));this.set_$P8(0);this.$6R1=t;this.$3qg=new _c.$D3.$9fn};function $2gl(n){for(var i=n.$Y2.get_$B(),t=0;t<i;t++)n.$6DX(n.$Y2.get_$3q(t));n.$Y2.$1r()}function $1nV(n,t,i){for(var e=i-t+1,u=n.$HR.$7xH(t,e),f=u,o=f.length,r=0;r<o;++r){var s=f[r];n.$99U(s)}return u}function $4iT(n,t,i){for(var e=t,u=t+i-1,r=t;r<=u;r++){var f=n.$Y2.get_$3q(r);n.$6DX(f)}n.$Y2.$V3(t,i)}_c.$D3.prototype={$HR:null,$C2:!1,$Y2:null,$6ex:!1,$S6:0,$10g:!1,$1TQ:0,$B7:0,$41h:!1,$6R1:null,$3qg:null,get_$r:function(){return this.$3qg.get_$r()},get_$8a:function(){return this.$Y2},get_$NT:function(){return this.$3qg},get_$tp:function(){return this.$6R1},get_$4Su:function(){return new _g.$3S("InstantSearch")},get_$9q:function(){return this.$C2},set_$9q:function(n){if(this.$C2!==n){this.$C2=n;$N(this,"Loading")}return n},get_$F7:function(){return this.$B7},set_$F7:function(n){if(this.$B7!==n){this.$B7=n;$N(this,"LoadedStartIndex")}return n},get_$5aA:function(){return!1},get_$Y3:function(){return this.$RB},set_$Y3:function(n){this.$RB=n;return n},get_$Y8:function(){return this.$41h},set_$Y8:function(n){if(this.$41h!==n){this.$41h=n;$N(this,"Merging")}return n},get_$3c8:function(){return null},get_$5gL:function(){return null},get_$1de:function(){return!1},get_$5hZ:function(){return this.$B7+this.$Y2.get_$B()-1},get_$14M:function(){return this.$AV},get_$A1k:function(){return this.$6ex},set_$A1k:function(n){this.$6ex=n;return n},get_$P8:function(){return this.$S6},set_$P8:function(n){if(this.$S6!==n){this.$S6=n;$N(this,"TableSize")}return n},get_$9gA:function(){return this.$1TQ},set_$9gA:function(n){this.$1TQ=n;return n},get_$6gE:function(){return this.$10g},set_$6gE:function(n){this.$10g=n;return n},$9yv:function(n){return!1},$7yv:function(n){return n},$99Y:function(){this.set_$P8(this.$HR.get_$B())},$6Dt:function(){},$4Kf:function(){},$OQ:function(n){this.set_$Y8(!0);var u=this.$5S1(n);var t=u.$FQ<=0?0:u.$FQ;var i=u.get_$5Kz()>=this.$HR.get_$B()?this.$HR.get_$B()-1:u.get_$5Kz();var r=this.get_$5hZ();if(this.$HR.get_$B())if(this.$Y2.get_$B())if(t===this.$B7&&i===r){$2gl(this);this.$Y2.$69($1nV(this,t,i))}else if(i<this.$B7){$2gl(this);this.$Y2.$69($1nV(this,t,i))}else if(t>r){$2gl(this);this.$Y2.$69($1nV(this,t,i))}else{if(t<this.$B7){var o=$1nV(this,t,this.$B7-1);this.$Y2.$a5(0,o)}else if(t>this.$B7){var s=t-this.$B7;$4iT(this,0,s)}if(i<r){var f=r-i;var h=this.$Y2.get_$B()-f;$4iT(this,h,f)}else if(i>r){var c=$1nV(this,r+1,i);this.$Y2.$69(c)}}else{var e=$1nV(this,t,i);this.$Y2.$69(e)}else $2gl(this);this.set_$F7(t);this.set_$P8(this.$HR.get_$B());this.set_$Y8(!1)},$AF:function(){this.$OQ(new _h.$8R(this.$B7,this.get_$5hZ()))},add_$25M:function(n){this.$2N("Stale",n)},remove_$25M:function(n){this.$2P("Stale",n)},$2vi:function(n,t){},$2oK:function(){return!1},$cl:function(){},$5S1:function(n){if(_h.$8R.isInstanceOfType(n)){this.$10g=!1;return n}throw Error.invalidOperation("loadRowsArg");}};_c.$D3.$9fn=function(){this.$2k=new _g.$7P("inbox")};_c.$D3.$9fn.prototype={$2k:null,get_$r:function(){return this.$2k},get_$R:function(){return""}};_c.$yE=function(){};_c.$1Jt=function(){_c.$1Jt.initializeBase(this)};_c.$1Jt.prototype={callState:null};_c.$1EL=function(n,t,i){_c.$1EL.initializeBase(this,[n]);this.$5h=$6(t)?"All":t;this.$Af=i?i:new _h.$Cb("TaskDueDate","Ascending");this.$A4G(this.get_$R()+"_item_"+this.$5h+"_"+this.$Af.$Bv.toString()+"_"+this.$Af.$MQ.toString()+"_")};_c.$1EL.prototype={$5h:"All",$Af:null,get_$9z:function(){return this.$5h},$2wR:function(){return _h.$mG.$5Sr(this.$Af.$Bv,this.$Af.$MQ,this.get_$r())}};_c.$gj=function(n){_c.$gj.initializeBase(this,[n])};function $4io(n,t,i){return new _c.$w6(n.get_$r(),n.get_$Wa(),_h.$5p.$1ab(i,t),!1,n.get_$9z(),n.get_$dr())}_c.$gj.prototype={get_$1b:function(){return _a.$0.$4Zm},get_$dr:function(){return this.$4J.$Af},get_$Wa:function(){return null},$2vi:function(n,t){var i=this;n.add_$4KI(function(){i.$19P==="ErrorConnectionFailed"&&n.get_$Cf()&&n.get_$a9()?t(6):t(1)})},$9aE:function(){var n=Math.max(this.get_$2zE(),this.$1t.get_$B());this.set_$Y3(4);$eK(this,$4io(this,n,this.$B7))},$7cp:function(n){if(!_h.$8R.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.$8R,"range needs to be an IndexedRange object");return $4io(this,n.$Dl,n.$FQ)},$6VI:function(n){return!1},$5Z1:function(n,t){var i=n;i.$3HX(t)},$5eJ:function(n,t){return!0},$5C2:function(n,t){return-2},$7em:function(n,t){return new _c.$w6(this.get_$r(),this.get_$Wa(),n,!1,this.get_$9z(),this.get_$dr())}};_c.$V8=function(){this.$$d_$9GQ=Function.createDelegate(this,this.$9GQ);this.$$d_$9GR=Function.createDelegate(this,this.$9GR);this.$$d_$9GS=Function.createDelegate(this,this.$9GS);this.$1IE={};this.$2XZ=[];_c.$V8.initializeBase(this)};function $6nN(n){if(!n.$2wX){n.$2wX=!0;$4in(n)}}function $4in(n){var t=new _c.$ot;t.add_$2C(n.$$d_$9GS);t.add_$1x(n.$$d_$9GR);t.add_$2m(n.$$d_$9GQ);OwaApplication.$1W.$z(t)}_c.$V8.prototype={$2Eh:null,$aD:!1,$2wX:!1,$kU:0,add_$2nC:function(n){this.$2N("CachePopulated",n)},remove_$2nC:function(n){this.$2P("CachePopulated",n)},get_$I1:function(){return this.$aD},set_$I1:function(n){if(n!==this.$aD){this.$aD=n;$N(this,"IsLoaded")}return n},$5Sq:function(n){return $6(this.$1IE)?null:(n.Id in this.$1IE)?this.$1IE[n.Id]:null},$3uN:function(n){if(this.$aD){$6(n)||n();return!0}$6(n)||Array.add(this.$2XZ,n);$6nN(this);return!1},$7Ob:function(n,t,i){_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"taskFolderEntry");_a.$4.$J(i,"folder");t.set_$o1(n.get_$8k());n.get_$1IF().$D(t);this.$1IE[t.get_$18F().Id]=i},$9bb:function(n,t){_a.$4.$J(n,"parentGroup");_a.$4.$J(t,"taskFolder");delete this.$1IE[t.get_$18F().Id];n.get_$1IF().$34(t)},$9GS:function(n){var h=n;this.$2Eh=new _js.$Z;this.$1IE={};for(var c=!1,e=0;e<h.$4Zk.length;e++){var t=new _g.$1EK(h.$4Zk[e]);t.get_$ql()||t.set_$Vr(_nbs.NonBootStrings.l_MyTasksGroupName_Text);for(var f=t.get_$1IF().get_$B()-1;f>=0;f--){var i=t.get_$1IF().get_$3q(f);var r=null;if(i.get_$2AZ()===1){r=_g.$2X.$Bi("todosearch");c=!0;i.set_$Kw(_nbs.NonBootStrings.l_ToDoSearchFolderName_Text);r.set_$1o(_nbs.NonBootStrings.l_ToDoSearchFolderName_Text)}else{r=_h.$j.$JP(i.get_$18F());if(i.get_$2AZ()===2){i.set_$Kw(_nbs.NonBootStrings.l_TasksFolderName_Text);r.set_$1o(_nbs.NonBootStrings.l_TasksFolderName_Text)}}r?this.$1IE[i.get_$18F().Id]=r:t.get_$1IF().$68(f)}this.$2Eh.$D(t)}if(!c&&this.$2Eh.get_$B()>0){var l=this.$2Eh.get_$3q(0);var o=_g.$2X.$Bi("todosearch");o.set_$1o(_nbs.NonBootStrings.l_ToDoSearchFolderName_Text);var u=new _g.$mD;u.set_$Kw(_nbs.NonBootStrings.l_ToDoSearchFolderName_Text);u.set_$2AZ(1);u.set_$18F(o.get_$r());u.set_$o1(l.get_$8k());l.get_$1IF().$72(0,u);this.$1IE[u.get_$18F().Id]=o}this.set_$I1(!0);this.$2wX=!1;$Ju(this,"CachePopulated",this,null);for(var s=0;s<this.$2XZ.length;s++)this.$2XZ[s]();this.$2XZ=[]},$9GR:function(n){if(this.$kU<3){var t=this;_js.$J.get_$I().$1w(_a.$0.$18H,"GetTaskFoldersActionRetry",function(){$4in(t)},2e3);this.$kU++}else{this.$kU=0;this.$2wX=!1}},$9GQ:function(n){n.remove_$2C(this.$$d_$9GS);n.remove_$1x(this.$$d_$9GR);n.remove_$2m(this.$$d_$9GQ)}};_c.$15d=function(n,t,i){_c.$15d.initializeBase(this);this.$4UB=n;this.$1T=t;this.$5in=i};_c.$15d.prototype={$4UB:null,$1T:null,$5in:0,$1e2:null,$5ZC:function(n){var t=new _g.$cC(this.$5in);t.SendingAs=this.$4UB;t.Recipients=this.$1T;var i=new _g.$cB(this.get_$6u(),t);n.$3td(i,new _g.$15e(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){if(!$6(n.ResponseMessages)&&n.ResponseMessages.length>0){var i=n.ResponseMessages.length;this.$1e2=new Array(i);for(var t=0;t<i;t++)this.$1e2[t]=n.ResponseMessages[t].MessageText}else _js.Trace.logWarning(_a.$0.$8G,"GetMailtips Action have null ResponseMessages returned.")}};_c.$15S=function(n){_c.$15S.initializeBase(this);this.$4Nz=n};_c.$15S.prototype={$4Nz:null,$oB:null,$26P:null,$5ZC:function(n){this.$oB=null;this.$26P=null;n.$3t3(this.$4Nz,new _g.$15T(this.$2D),this.$$d_$A6H,this.$$d_$9RZ)},$6Kg:function(n,t,i){this.$26P=n;if(n.EvaluationResult&&n.OptimizationResult!==1&&n.EvaluationResult!==2){_js.Trace.logError(_a.$0.$8G,"GetPolicyTips Action returned {0}",_g.$ND.toString(n.EvaluationResult));i(Error.create("GetPolicyTips Action returned "+_g.$ND.toString(n.EvaluationResult)))}else{_js.Trace.logInfo(_a.$0.$8G,"GetPolicyTips Action have non null ResponseMessage returned: "+n);this.$oB=n.Matches;t()}}};_c.$tB=function(n,t){_c.$tB.initializeBase(this,[n,[t.get_$i()],null,"None",0,!1]);this.$In=t;this.$Po=_c.$tB.$7dI(this.$In)};_c.$tB.$7dI=function(n){var t;t=n.get_$Pk()?9:6;var r=new _g.$DM("IdOnly");var i=[];t&1&&Array.add(i,new _g.$1X("ConflictingMeetingCount"));t&2&&Array.add(i,new _g.$1X("ConflictingMeetings"));t&4&&Array.add(i,new _g.$1X("AdjacentMeetings"));t&8&&Array.add(i,new _g.$1X("AdjacentMeetingCount"));r.AdditionalProperties=i;return r};_c.$tB.prototype={$In:null,$4Os:function(n){var t=_g.$y.$E(n.Items[0]);this.$In.set_$2HH(t.get_$2HH());this.$In.set_$2EM(t.get_$2EM());this.$In.set_$1L6(t.get_$1L6());this.$In.set_$1Jm(t.get_$1Jm())}};_c.$ut=function(n,t){_c.$ut.initializeBase(this);this.$29u=n;this.$3nS=t};_c.$ut.prototype={$29u:null,$5DV:null,$3nS:"EwsLegacyId",get_$5DW:function(){return this.$5DV},$5ZC:function(n){var i=new _g.$aO(this.$3nS);i.DestinationFormat=this.$3nS;i.SourceIds=new Array(this.$29u.length);for(var t=0;t<this.$29u.length;t++){var r=new _g.$SU(this.$29u[t].Format,this.$29u[t].Id,this.$29u[t].Mailbox);i.SourceIds[t]=r}var u=new _g.$aM(this.get_$6u(),i);var f=new _g.$135(this.$2D);n.$5DZ(u,f,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){this.$5DV=n.AlternateId}};_c.$vw=function(n){_c.$vw.initializeBase(this);this.$P=n};_c.$vw.prototype={$P:null,$5ZC:function(n){var t=new _g.$P9(_h.$15.get_$12l());t.ItemIds=[new _g.$1q(this.$P.get_$i().Id)];var i=new _g.$Wl(this.$2D);i.clientStoreItem=0;var r=new _g.$P8(this.get_$6u(),t);n.$3x(r,i,this.$$d_$A6H,this.$$d_$9RZ)},$4Os:function(n){var t=n.Items[0];this.$P.set_$12l(t.EntityExtractionResult)}};_c.$DL=function(n,t,i,r){_c.$DL.initializeBase(this,[n,t,_c.$DL.get_$6Ol(),"None",i,r])};_c.$DL.get_$6Ol=function(){if(!_c.$DL.$Rr){_c.$DL.$Rr=new _g.$DM("IdOnly");_c.$DL.$Rr.AddBlankTargetToLinks=!0;_c.$DL.$Rr.ClientSupportsIrm=!0;_c.$DL.$Rr.FilterHtmlContent=!0;_c.$DL.$Rr.InlineImageUrlTemplate=_g.$5r.get_$2zK();_c.$DL.$Rr.MaximumBodySize=0;_c.$DL.$Rr.AdditionalProperties=[new _g.$1X("UID"),new _g.$1X("ItemParentId"),new _g.$1X("InstanceKey"),new _g.$1X("Subject"),new _g.$1X("TaskDueDate"),new _g.$1X("Body"),new _g.$1X("NormalizedBody"),new _g.$1X("HasAttachments"),new _g.$1X("Attachments"),new _g.$1X("TaskStartDate"),new _g.$1X("Importance"),new _g.$1X("TaskStatus"),new _g.$1X("TaskCompleteDate"),new _g.$1X("TaskPercentComplete"),new _g.$1X("Sensitivity"),new _g.$1X("TaskOwner"),new _g.$1X("Categories"),new _g.$1X("TaskTotalWork"),new _g.$1X("TaskActualWork"),new _g.$1X("TaskMileage"),new _g.$1X("TaskBillingInformation"),new _g.$1X("TaskCompanies"),new _g.$1X("TaskRecurrence"),new _g.$1X("ReminderDueBy"),new _g.$1X("ReminderIsSet"),new _g.$1X("ReminderNextTime"),new _g.$1X("ReminderMinutesBeforeStart"),new _g.$1X("ItemLastModifiedTime"),new _g.$1X("TaskIsComplete"),new _g.$1X("TaskIsTaskRecurring"),new _g.$1X("ItemClass"),new _g.$1X("TaskDelegationState")]}return _c.$DL.$Rr};_c.$ZB=function(n,t){_c.$ZB.initializeBase(this,[n,t,_c.$ZB.$A])};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.$A]);_a.$4.$l(i,"nativeBridge");this.$12=i};function $6m1(n,t,i,r,u){t==="Success"?$6m3(n,i,r,u):$6m2(n,i)}function $6m3(n,t,i,r){var u=new _g.$Ae(i.Id);n.$Pu.$2HU(n.get_$BT(),t,u);if(n.get_$A5V()&&n.get_$Lh().clientStoreItem===2){n.get_$BT().get_$1IW().set_$1aT(!1);var f=this;n.get_$A8().get_$52().$1Ih(n.get_$BT(),n.get_$A8().get_$5a().$ii(r.Id),function(i){if($6(i)){_js.Trace.logWarning(n.$1p,"Message with id {0} not found in local store",r.Id);return}$6m4(n,i,t,u)})}}function $6m2(n,t){if(n.get_$A5V()&&n.get_$Lh().clientStoreItem===2){n.get_$BT().get_$1IW().set_$1aT(!1);var r=n.$5s.request.parameters;var i=new _g.$1q(r.Body.Attachments[0].AttachmentId.RootItemId);var u=this;n.get_$A8().get_$52().$1Ih(n.get_$BT(),n.get_$A8().get_$5a().$ii(i.Id),function(r){if($6(r)){_js.Trace.logWarning(n.$1p,"Message with id {0} not found in local store",i.Id);return}$6m0(n,r,t)})}}function $6m4(n,t,i,r){var u=t;if(!u.HasAttachments){_js.Trace.logError(n.$1p,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if($6(u.Attachments)){_js.Trace.logError(n.$1p,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var o=u.Attachments,s=o.length,f=0;f<s;++f){var e=o[f];if(e.AttachmentId.Id===i.Id){_js.Trace.logInfo(n.$1p,"Old attachment id {0}, new id {1}",e.AttachmentId.Id,r.Id);e.AttachmentId.Id=r.Id;return}}_js.Trace.logWarning(n.$1p,"Attachment with id {0} not found in local store",i.Id)}function $6m0(n,t,i){var r=t;if(r.HasAttachments&&!$6(r.Attachments)){for(var u=0;u<r.Attachments.length;u++)if(r.Attachments[u].AttachmentId.Id===i.Id){Array.removeAt(r.Attachments,u);break}_js.Trace.logWarning(n.$1p,"Attachment with id {0} not found in local store",i.Id)}}_c.CreateAttachmentResponseProcessor.prototype={$12:null,$4Os:function(n,t){var i=null;var r=null;if(t.ResponseClass==="Success"){i=t.Attachments[0].AttachmentId;r=new _g.$1q(i.RootItemId);r.ChangeKey=i.RootItemChangeKey;var f=this.get_$1Ss().Body.ParentItemId;this.$Pu.$2HV(this.get_$BT(),f,r)}if(this.get_$Lh()){var e=this.get_$Lh().attachmentIds[n];$6m1(this,t.ResponseClass,e,i,r);if(this.get_$Lh().palContext&&this.get_$Lh().palContext.palActionNeeded){var u=new _a.$8G;u.$QR(this.get_$Lh().dataFile);this.$12.$f0.$12F(u.get_$1B4())}}_h.$SY.prototype.$4Os.call(this,n,t)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.$A])};_c.DeleteAttachmentResponseProcessor.prototype={$4Os:function(n,t){var i=this.get_$Lh().itemContexts[n];if(t.ResponseClass==="Success"){var u=this.$Pu.$qi(i.parentItemId);var r=new _g.$1q(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.$Pu.$2HV(this.get_$BT(),u,r)}else if(this.get_$A5V()&&i.clientStoreItem===2){this.get_$BT().get_$1IW().set_$1aT(!1);var f=this.$Pu.$qi(i.parentItemId);this.get_$A8().get_$52().$4cf(this.get_$BT(),this.get_$A8().get_$5a().$ii(f.Id),i.deletedAttachment)}_h.$SY.prototype.$4Os.call(this,n,t)}};_c.$b0=function(n,t){_c.$b0.initializeBase(this,[n,t,_c.$b0.$A])};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.$A])};_c.$UF=function(n,t){this.$$d_$6Ob=Function.createDelegate(this,this.$6Ob);_a.$4.$l(n,"eventAggregator");_a.$4.$l(t,"nativeBridge");this.$12=t;n.$IU(_g.$YN,this.$$d_$6Ob);n.$A4x(_a.$kV,new _a.$kV)};_c.$UF.prototype={$12:null,$6Ob:function(n){var t=n.$5s;var i=n.$Pu;_js.Trace.logInfo(_c.$UF.$A,"Creating response processors for {0}",_g.$3x.$U9(t));var r=t.request.methodName;switch(r){case"AddEventToMyCalendar":n.$VM(new _c.$ZB(t,i));break;case"CreateAttachment":n.$VM(new _c.CreateAttachmentResponseProcessor(t,i,this.$12));break;case"CreateItem":n.$VM(new _h.CreateItemResponseProcessor(t,i));break;case"CreatePersona":n.$VM(new _pc.CreatePersonaResponseProcessor(t,i));break;case"DeleteAttachment":n.$VM(new _c.DeleteAttachmentResponseProcessor(t,i));break;case"DeletePersona":n.$VM(new _pc.$aw(t,i));break;case"DeletePlace":n.$VM(new _c.$b0(t,i));break;case"PerformReminderAction":n.$VM(new _c.PerformReminderActionResponseProcessor(t,i));break;case"UpdatePersona":n.$VM(new _pc.UpdatePersonaResponseProcessor(t,i));break}}};_c.$1IL=function(){};_c.$1IL.registerInterface("_c.$1IL");_c.$1IK=function(){};_c.$1IK.registerInterface("_c.$1IK");_c.$1IJ=function(){};_c.$1IJ.registerInterface("_c.$1IJ");_c.$12f=function(){_c.$12f.initializeBase(this)};_c.$12f.prototype={get_$86z:function(){return this.$Yr.get_$B()===1?this.$Yr.get_$3q(0).ResultType:""},get_$6FR:function(){return"CombinedScenarios"},$87M:function(n){this.$Yr.$1r();var t=JsonParser.deserialize(n);t.length>0&&this.$Yr.$D(t[0])}};_c.$14h=function(){_c.$14h.initializeBase(this)};_c.$14h.prototype={get_$6FR:function(){return"FindPeople"},$87M:function(n){_c.$Ew.$4Or(n,this.$Yr)}};_c.$1AT=function(n,t){_c.$1AT.initializeBase(this);this.$1VO=n;this.$Yr=t};_c.$1AT.prototype={$1VO:null,$Yr:null,$6AP:function(){_c.$Ew.$4Or(this.$1VO,this.$Yr);return 0}};_c.$lr=function(){this.$$d_$9Pm=Function.createDelegate(this,this.$9Pm);_c.$lr.initializeBase(this)};function $6mV(n){var t=_a.$7.$EZ(_a.$7.get_utcNow());var i=_a.$3R.$3pq(_g.$V.get_$I().get_$1I().get_$DM());var r=_g.$V.get_$I().get_$31().get_$7Z();n.$5iF(String.format("Tag={0}",t));return String.format("operation={0}&culture={1}&tag={2}&timezone={3}",n.get_$6FR(),r,t,i)}function $6mW(n,t,i){if(!i)try{_js.Trace.logInfo(_a.$0.$S3,"SpeechActionBase: Processing response: {0}",t);n.$87M(t);n.$Yr.get_$B()||(i=_a.$4d.$67C.$kv())}catch(r){_js.Trace.logError(_a.$0.$S3,"SpeechActionBase.InternalProcessResponse Exception: {0}",r.toString());i=r}$Hp(n,i)}_c.$lr.prototype={$QS:null,$Yr:null,$d:null,$49:function(n,t){this.$QS=n;this.$Yr=t},$3Q9:function(){this.$QS.$3Q9()},$9b:function(){this.$QS.$9b()},$5iF:function(n){this.$d=n;this.$3yY(1);this.$d=null},$6AP:function(){this.$QS.add_$2m(this.$$d_$9Pm);this.$QS.$9rc($6mV(this));return 1},$3yY:function(n){if(_a.$g.get_$Qz()){var t=new _a.$tR(this.get_$6FR(),this.$Jo,n,this.$d||this.get_$86z());_a.$g.$8s.$AN(t)}_a.$2p.prototype.$3yY.call(this,n)},$9Pm:function(n,t){try{$6mW(this,n,t)}finally{this.$QS.remove_$2m(this.$$d_$9Pm);this.$QS=null}}};_c.$Ew=function(){};_c.$Ew.$4Or=function(n,t){t.$1r();for(var u=JsonParser.deserialize(n),r=0;r<u.length;r++){var i=new _pc.$i;i.$QR(u[r]);i.set_$BB(2);i.set_$1F(1);t.$D(i)}};_c.$Ew.$9X7=function(n){var i=new _c.$1D0;var t=new _js.$Z;_c.$Ew.$5IJ(n,t);t.get_$B()>0&&_c.$Ew.$7QR(i,t);return i};_c.$Ew.$9XC=function(n,t){var i=new _js.$Z;_c.$Ew.$5IJ(n,i);i.get_$B()>0&&_c.$Ew.$7gF(t,i)};_c.$Ew.$5IJ=function(n,t){t.$1r();var i=JsonParser.deserialize(n);i.length>0&&t.$D(i[0])};_c.$Ew.$7QR=function(n,t){if(t.get_$B()===1){var u=n.get_$1u().$5z(n.get_$y());var i=t.get_$3q(0);var r=_a.$7.$42(i.Date);switch(i.ResultType){case"CompleteDate":r=new _a.$7(r.get_$3l(),r.get_$2z(),r.get_$51(),n.get_$y().get_$DV(),n.get_$y().get_$GJ(),n.get_$y().get_$TR());break;case"CompleteDateWithStartTime":break;case"CompleteDateWithStartTimeAndDuration":u=_c.$Ew.$7aI(i.Duration);break;default:throw Error.invalidOperation(String.format("This recognition type '{0}' is not valid in this scenario",i.ResultType));}n.$6dj(r,u,i.AllDayEvent)}};_c.$Ew.$7gF=function(n,t){if(t.get_$B()===1){var i=t.get_$3q(0);var r;switch(i.ResultType){case"CompleteDate":r=0;break;case"PartialDate":r=1;break;default:throw Error.invalidOperation(String.format("This recognition type '{0}' is not valid in this scenario",i.ResultType));}var u=_a.$7.$42(i.Date);n.$9z9(u,r)}};_c.$Ew.$7aI=function(n){return n*6e4};_c.$1D0=function(){this.$2Q=_a.$7.get_$29();this.$3D=this.$2Q.$BX(30);this.$13z=!1};_c.$1D0.prototype={$2Q:null,$3D:null,$13z:!1,get_$y:function(){return this.$2Q},get_$1u:function(){return this.$3D},get_$5V:function(){return this.$13z},get_$DS:function(){return this.$3D.$5z(this.$2Q)},$6dj:function(n,t,i){this.$2Q=n;this.$3D=this.$2Q.$9K(t);this.$13z=i}};_c.$G5=function(n,t){_c.$G5.initializeBase(this);this.$VI=n;this.$Oz=t};_c.$G5.$3k7=function(n){if(_js.$9.$18(n))throw Error.argument("emailaddress","emailAddress is null or empty");var t=new _c.$G5(n,"NoError");t.set_$Fc(new _c.$9j);t.get_$Fc().$K(_c.$9j.$33t,new _js.$Z);t.get_$Fc().$K(_c.$9j.$2SI,"");t.get_$Fc().$K(_c.$9j.$2L7,"None");return t};_c.$G5.$7ag=function(n,t){var i=_c.$G5.$3k7(n.$VI);i.get_$Fc().$K(_c.$9j.$2L7,n.get_$Fc().get_$2uv());i.get_$Fc().$K(_c.$9j.$2SI,n.get_$Fc().get_$rx());for(var r=0;r<n.get_$Fc().get_$3T().get_$B();r++){var u=n.get_$Fc().get_$3T().get_$3q(r);var f=new _h.$4e(u.get_$y(),u.get_$1u());if(_h.$4e.$1Wc(t,f))i.get_$Fc().get_$3T().$D(u);else if(f.$2Q.$2R(t.$3D)>0)break}return i};_c.$G5.prototype={$VI:null,$Oz:"NoError",get_$Fc:function(){return this.$U(_c.$G5.$3gh)},set_$Fc:function(n){this.$K(_c.$G5.$3gh,n);return n}};_c.$9j=function(){_c.$9j.initializeBase(this)};_c.$9j.$$cctor=function(){_c.$9j.$33t.set_$Gu(new _a.$EC(_g.$33))};_c.$9j.prototype={get_$rx:function(){return this.$U(_c.$9j.$2SI)},get_$3T:function(){return this.$U(_c.$9j.$33t)},get_$2uv:function(){return this.$U(_c.$9j.$2L7)}};_c.$1IG=function(){};_c.$1IG.registerInterface("_c.$1IG");_c.$1IF=function(){};_c.$1IF.registerInterface("_c.$1IF");_c.$11J.registerClass("_c.$11J",_h.$F3.$$(Boolean),_a.$jR);_c.$16C.registerClass("_c.$16C",_h.$F3.$$(_g.$gn),_a.$jR);_c.$1Ch.registerClass("_c.$1Ch",_h.$F3.$$(Boolean));_c.$1Bk.registerClass("_c.$1Bk",_h.$F3.$$(String));_c.$1CU.registerClass("_c.$1CU",_h.$F3.$$(Boolean));_c.$13G.registerClass("_c.$13G",_h.$F3.$$(_g.$UK));_c.$P7.registerClass("_c.$P7",_h.$F3.$$(_g.$Wk));_c.$19O.registerClass("_c.$19O",_c.$P7);_c.$15Z.registerClass("_c.$15Z",_pc.$ve);_c.$LC.registerClass("_c.$LC",_a.$RL);_c.$18c.registerClass("_c.$18c",_a.$IV);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.$1In);_c.DataContracts.registerClass("_c.DataContracts");_c.$wC.registerClass("_c.$wC",_pc.$yw);_c.$cn.registerClass("_c.$cn",_h.$CH.$$(_c.$wC));_c.$111.registerClass("_c.$111",_h.$F3.$$(Number));_c.$12X.registerClass("_c.$12X",null,IChatActionFactory);_c.$14N.registerClass("_c.$14N",_h.$F3.$$(Boolean));_c.$14O.registerClass("_c.$14O");_c.$165.registerClass("_c.$165",_h.$F3.$$(Number));_c.$17f.registerClass("_c.$17f",_h.$F3.$$(Number));_c.$17g.registerClass("_c.$17g",_h.$F3.$$(Number));_c.$1Bc.registerClass("_c.$1Bc",_h.$F3.$$(Number));_c.$1CA.registerClass("_c.$1CA",_h.$F3.$$(Number));_c.$1Cf.registerClass("_c.$1Cf",_h.$F3.$$(Number));_c.$lv.registerClass("_c.$lv",_a.$2p);_c.$10C.registerClass("_c.$10C");_c.$1DH.registerClass("_c.$1DH",_h.$F3.$$(Number));_c.$1Em.registerClass("_c.$1Em",_h.$F3.$$(Number));_c.$iV.registerClass("_c.$iV",_h.$4Q);_c.$i9.registerClass("_c.$i9",_c.$iV);_c.$11H.registerClass("_c.$11H",_cc.$EV.$$(_g.$VR));_c.$hZ.registerClass("_c.$hZ",_h.$1KO);_c.$1DJ.registerClass("_c.$1DJ",_cc.$EV.$$(_g.$QJ));_c.$1DI.registerClass("_c.$1DI",_cc.$EV.$$(_g.$QJ));_c.$13k.registerClass("_c.$13k",_h.$Kf);_c.$Qc.registerClass("_c.$Qc",_c.$iV);_c.$13K.registerClass("_c.$13K",_h.$F3.$$(_g.$UK));_c.$16J.registerClass("_c.$16J",_h.$F3.$$(_g.$Yr));_c.$166.registerClass("_c.$166",_h.$JQ.$$(_g.$X1,_g.$cW));_c.$168.registerClass("_c.$168",_h.$F3.$$(Array));_c.$ou.registerClass("_c.$ou",_h.$JQ.$$(_g.$NM,_g.$NN),_cc.$17L);_c.$1BU.registerClass("_c.$1BU",_c.$iV);_c.$zw.registerClass("_c.$zw",_cc.$EV.$$(_g.$Zl));_c.$110.registerClass("_c.$110",_h.$F3.$$(Boolean));_c.$11A.registerClass("_c.$11A",_h.$F3.$$(Boolean));_c.$13f.registerClass("_c.$13f",_h.$F3.$$(Boolean));_c.$1BT.registerClass("_c.$1BT",_h.$F3.$$(Boolean));_c.$aW.registerClass("_c.$aW",_h.$4Q);_c.$14P.registerClass("_c.$14P",_h.$F3.$$(_g.$bJ));_c.$13R.registerClass("_c.$13R",_h.$F3.$$(String));_c.$vU.registerClass("_c.$vU",_h.$F3.$$(_g.$WI));_c.$8I.registerClass("_c.$8I",_h.$1KO);_c.$vF.registerClass("_c.$vF",_c.$8I);_c.$vt.registerClass("_c.$vt",_h.$JQ.$$(_g.$Wd,_g.$jC));_c.$15R.registerClass("_c.$15R",_h.$F3.$$(Number));_c.$8j.registerClass("_c.$8j",_h.$F3.$$(_g.$TD));_c.$15f.registerClass("_c.$15f",_h.$ol);_c.$15q.registerClass("_c.$15q",_h.$F3.$$(_g.$RV),_a.$jR);_c.$X0.registerClass("_c.$X0",_h.$F3.$$(_g.$NJ));_c.$os.registerClass("_c.$os",_h.$JQ.$$(_g.$Wd,_g.$jC));_c.$qB.registerClass("_c.$qB",_h.$F3.$$(_g.$Xi));_c.$ze.registerClass("_c.$ze",_h.$F3.$$(_g.$YR));_c.$zf.registerClass("_c.$zf",_h.$F3.$$(_g.$YS));_c.$109.registerClass("_c.$109",_c.$8I);_c.$13p.registerClass("_c.$13p",_h.$1KO);_c.$oY.registerClass("_c.$oY",_h.$F3.$$(Array),_pc.$xJ,_pc.$1HA);_c.$Km.registerClass("_c.$Km");_c.$1Am.registerClass("_c.$1Am",_h.$JQ.$$(_g.$ej,_g.$el));_c.$1Ao.registerClass("_c.$1Ao",_h.$JQ.$$(_g.$b7,_g.$b9));_c.$15o.registerClass("_c.$15o",_h.$F3.$$(_g.$eS));_c.$16F.registerClass("_c.$16F",_h.$F3.$$(_g.$go));_c.$w8.registerClass("_c.$w8",_h.$F3.$$(_g.$OT));_c.$1Cl.registerClass("_c.$1Cl",_h.$F3.$$(Boolean));_c.$15U.registerClass("_c.$15U",_h.$F3.$$(_g.$T9));_c.$1CS.registerClass("_c.$1CS",_h.$F3.$$(Boolean));_c.$Ji.registerClass("_c.$Ji",_a.$2p);_c.$fn.registerClass("_c.$fn",_a.$2p);_c.$15O.registerClass("_c.$15O",_a.$2p);_c.$1CR.registerClass("_c.$1CR",_a.$2p);_c.$10M.registerClass("_c.$10M",_a.$2p);_c.$10N.registerClass("_c.$10N",_a.$2p);_c.$100.registerClass("_c.$100",_h.$F3.$$(Boolean));_c.$1BX.registerClass("_c.$1BX",_h.$F3.$$(Boolean),_a.$jR);_c.$AW.registerClass("_c.$AW",_h.$F3.$$(_g.$ea));_c.$iY.registerClass("_c.$iY",_h.$1Ku);_c.$13T.registerClass("_c.$13T",_c.$V6.$$(_g.$Yj));_c.$13r.registerClass("_c.$13r",_c.$V6.$$(_g.$gh));_c.$bg.registerClass("_c.$bg",_h.$WP);_c.$ot.registerClass("_c.$ot",_h.$F3.$$(_g.$cX));_c.$w6.registerClass("_c.$w6",_h.$j2);_c.$1BZ.registerClass("_c.$1BZ",_c.$V6.$$(_g.$Yj));_c.$mC.registerClass("_c.$mC");_c.$Gw.registerClass("_c.$Gw");_c.$5S.registerClass("_c.$5S");_c.$tC.registerClass("_c.$tC",_h.$SL);_c.$nk.registerClass("_c.$nk");_c.CalendarTimePeriodSchema.registerClass("_c.CalendarTimePeriodSchema");_c.$uO.registerClass("_c.$uO",_c.$nY.$$(_cc.$Zt));_c.$1Cp.registerClass("_c.$1Cp",_c.$nY.$$(_cc.$S1));_c.$zk.registerClass("_c.$zk",null,_c.$1HB);_c.$zl.registerClass("_c.$zl",null,_g.$wU);_c.$ss.registerClass("_c.$ss",_a.$9I);_c.$14i.registerClass("_c.$14i",_pc.$ve);_c.$5q.registerClass("_c.$5q",_a.$9I,_js.$Qw);_c.$7B.registerClass("_c.$7B",_a.$9I);_c.$DB.registerClass("_c.$DB");_c.$DB.$3g5.registerClass("_c.$DB.$3g5");_c.$a3.registerClass("_c.$a3");_c.$2M.registerClass("_c.$2M",_js.$8,IChatManager,_js.$x6);_c.$E2.registerClass("_c.$E2",_js.$8);_c.$12Y.registerClass("_c.$12Y",_js.$8);_c.$Hc.registerClass("_c.$Hc",_js.$147,IPresenceManager);_c.$z6.registerClass("_c.$z6",_c.$Hc);_c.$MR.registerClass("_c.$MR",_js.$147);_c.$1As.registerClass("_c.$1As",_c.$MR);_c.$1B2.registerClass("_c.$1B2",_a.$IV);_c.$ev.registerClass("_c.$ev");_c.$rf.registerClass("_c.$rf");_c.$z0.registerClass("_c.$z0",_pc.$yw);_c.$1A0.registerClass("_c.$1A0",_a.$9I);_c.$1Eb.registerClass("_c.$1Eb",_a.$9I);_c.$10t.registerClass("_c.$10t",_a.$9I);_c.$12w.registerClass("_c.$12w",_a.$9I);_c.$1Ar.registerClass("_c.$1Ar",null,IPopOutMailboxDataContextFactory);_c.$eo.registerClass("_c.$eo",_g.$1U);_c.$Ge.registerClass("_c.$Ge",_a.$9I);_c.$Jn.registerClass("_c.$Jn",_js.$8,_h.$1HK);_c.$12Q.registerClass("_c.$12Q",_c.$Jn,_h.$1HL,_h.$1HK);_c.$C9.registerClass("_c.$C9",_js.$8,_h.$1HJ,_js.$x6);_c.$C9.$9g1.registerClass("_c.$C9.$9g1");_c.$Jn.$2Nz.registerClass("_c.$Jn.$2Nz",_js.$8,_h.$1HM,_js.$x6);_c.$Bo.registerClass("_c.$Bo",null,_h.$1HP);_c.$1K7.registerClass("_c.$1K7",_js.$8);_c.$sJ.registerClass("_c.$sJ",_c.$1K7);_c.$Px.registerClass("_c.$Px",_c.$1K7);_c.$sK.registerClass("_c.$sK",_c.$1K7);_c.$1Bz.registerClass("_c.$1Bz");_c.$FZ.registerClass("_c.$FZ");_c.$D3.registerClass("_c.$D3",_js.$8,_h.$1G7,_js.$x6);_c.$1C0.registerClass("_c.$1C0",_c.$D3);_c.$1KL.registerClass("_c.$1KL",_c.$D3,_h.$NX,_h.$1G7,_js.$x6);_c.$1C1.registerClass("_c.$1C1",_c.$1KL);_c.$1C2.registerClass("_c.$1C2",_c.$1KL);_c.$D3.$9fn.registerClass("_c.$D3.$9fn",null,_h.$18K);_c.$yE.registerClass("_c.$yE");_c.$1Jt.registerClass("_c.$1Jt",_a.$qf);_c.$1Jt.prototype.toString=_a.$qf.prototype.toString;_c.$gj.registerClass("_c.$gj",_lv.$91);_c.$1EL.registerClass("_c.$1EL",_h.$CH.$$(_c.$gj),_h.$xZ);_c.$V8.registerClass("_c.$V8",_js.$8);_c.$15d.registerClass("_c.$15d",_h.$JQ.$$(_g.$Wq,_g.$cD));_c.$15S.registerClass("_c.$15S",_h.$F3.$$(_g.$Wh));_c.$tB.registerClass("_c.$tB",_h.$ol);_c.$ut.registerClass("_c.$ut",_h.$JQ.$$(_g.$aN,_g.$iT));_c.$vw.registerClass("_c.$vw",_h.$JQ.$$(_g.$Qo,_g.$Xb));_c.$DL.registerClass("_c.$DL",_h.$ol);_c.$ZB.registerClass("_c.$ZB",_h.$VD.$$(_g.$118,Boolean));_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.$SY.$$(_g.$uv,_g.$W1,_g.$T3,_g.$ZZ));_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.$SY.$$(_g.$13i,_g.$aj,_g.$T6,_g.$al));_c.$b0.registerClass("_c.$b0",_h.$VD.$$(_g.$13q,_pc.$i));_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.$SY.$$(_g.$1AW,_g.$Nx,_g.$Ny,_g.$Pt));_c.$UF.registerClass("_c.$UF");_c.$lr.registerClass("_c.$lr",_a.$2p,_a.$jR);_c.$12f.registerClass("_c.$12f",_c.$lr);_c.$14h.registerClass("_c.$14h",_c.$lr);_c.$1AT.registerClass("_c.$1AT",_a.$2p,_a.$jR);_c.$Ew.registerClass("_c.$Ew");_c.$1D0.registerClass("_c.$1D0",null,_c.$1IL);_c.$G5.registerClass("_c.$G5",_a.$9I);_c.$9j.registerClass("_c.$9j",_a.$9I);_c.DataContracts.$$cctor();_c.$i9.$14Y=new _H("Item",_g.ICalendaring,_c.$i9);_c.$8j.$mH=null;_c.$8j.$34H=0;_c.$Km.$6Ia=new _g.$3S("PlaceItemQueryTable");_c.$AW.$3Ko=0;_c.$AW.$34J=0;_c.$5S.$TJ=null;_c.CalendarTimePeriodSchema.$3Pv=new _H("Start",_a.$7,_g.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.$2tG=new _H("End",_a.$7,_g.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.$3Ju=new _H("Recurrence",_g.$FY,_g.ICalendarTimePeriod);_c.$5q.$Z4=new _H("Subject",String,_c.$5q);_c.$5q.$1zv=new _H("Location",String,_c.$5q);_c.$5q.$4QK=new _H("ReminderTime",_a.$7,_c.$5q);_c.$5q.$4Xq=new _H("StartDate",_a.$7,_c.$5q);_c.$5q.$3pU=new _H("EndDate",_a.$7,_c.$5q);_c.$5q.$xV=new _H("ItemId",_g.$1q,_c.$5q);_c.$5q.$4Pl=new _H("RecurringMasterItemId",_g.$1q,_c.$5q);_c.$5q.$4QD=new _H("ReminderGroup",_g.$s0,_c.$5q);_c.$7B.$8ER=new _H("ItemClass",String,_c.$7B);_c.$7B.$1kL=new _H("Sensitivity",String,_c.$7B,"Normal");_c.$7B.$1X2=new _H("Body",_g.$6L,_c.$7B);_c.$7B.$96m=new _H("NewBodyContent",_g.$6L,_c.$7B);_c.$7B.$2FM=new _H("Attachments",_js.$Z,_c.$7B);_c.$7B.$87Z=new _H("InternetMessageHeaders",_js.$Z,_c.$7B);_c.$7B.$3My=new _H("Sender",_g.$1l,_c.$7B);_c.$7B.$1IR=new _H("ToRecipients",_js.$Z,_c.$7B);_c.$7B.$1AL=new _H("CcRecipients",_js.$Z,_c.$7B);_c.$7B.$19y=new _H("BccRecipients",_js.$Z,_c.$7B);_c.$7B.$1cp=new _H("IsReadReceiptRequested",Boolean,_c.$7B);_c.$7B.$1c3=new _H("IsDeliveryReceiptRequested",Boolean,_c.$7B);_c.$7B.$1aQ=new _H("From",_g.$1l,_c.$7B);_c.$7B.$9ZQ=new _H("ReferenceItemId",_g.$1q,_c.$7B);_c.$DB.$v=null;_c.$2M.$1l2="SignInState";_c.$2M.$5eG="IsSignedIn";_c.$2M.$2Yz="Presence";_c.$Hc.$v=null;_c.$MR.$4ae=5e3;_c.$eo.$A=_a.$0.$4O2;_c.$Ge.$4VX=new _H("SharePointUrl",String,_c.$Ge);_c.$Ge.$3oH=new _H("DocumentsUrl",String,_c.$Ge);_c.$Jn.$2Nz.$5GN=["AreAllSearchResultsAvailable","IsSearchInProgress","IsSearchTimedOut","IsSearchError"];_c.$DL.$Rr=null;_c.$ZB.$A=_a.$0.$53f;_c.CreateAttachmentResponseProcessor.$A=_a.$0.$1N;_c.DeleteAttachmentResponseProcessor.$A=_a.$0.$1N;_c.$b0.$A=_a.$0.$3nI;_c.PerformReminderActionResponseProcessor.$A=_a.$0.$4N0;_c.$UF.$A=_a.$0.$3HF;_c.$G5.$3gh=new _H("CalendarView",_c.$9j,_c.$G5);_c.$9j.$2SI=new _H("MergedFreeBusy",String,_c.$9j);_c.$9j.$2L7=new _H("FreeBusyViewType",String,_c.$9j);_c.$9j.$33t=new _H("Items",_js.$Z,_c.$9j);_c.$9j.$$cctor()